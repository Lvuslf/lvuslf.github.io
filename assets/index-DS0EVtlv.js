var CN=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Efe=CN((wl,Sl)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))s(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const _ of g.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&s(_)}).observe(document,{childList:!0,subtree:!0});function i(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function s(d){if(d.ep)return;d.ep=!0;const g=i(d);fetch(d.href,g)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function _S(e){const t=Object.create(null);for(const i of e.split(","))t[i]=1;return i=>i in t}const Fi={},om=[],jr=()=>{},EN=()=>!1,Bb=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),yS=e=>e.startsWith("onUpdate:"),da=Object.assign,bS=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},MN=Object.prototype.hasOwnProperty,Tr=(e,t)=>MN.call(e,t),fn=Array.isArray,rm=e=>E_(e)==="[object Map]",Nb=e=>E_(e)==="[object Set]",ph=e=>E_(e)==="[object Date]",Qn=e=>typeof e=="function",Zn=e=>typeof e=="string",Wc=e=>typeof e=="symbol",Vo=e=>e!==null&&typeof e=="object",Xv=e=>(Vo(e)||Qn(e))&&Qn(e.then)&&Qn(e.catch),f3=Object.prototype.toString,E_=e=>f3.call(e),IN=e=>E_(e).slice(8,-1),Jv=e=>E_(e)==="[object Object]",xS=e=>Zn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Fv=_S(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),$b=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},AN=/-(\w)/g,Ds=$b(e=>e.replace(AN,(t,i)=>i?i.toUpperCase():"")),kN=/\B([A-Z])/g,id=$b(e=>e.replace(kN,"-$1").toLowerCase()),M_=$b(e=>e.charAt(0).toUpperCase()+e.slice(1)),Bv=$b(e=>e?`on${M_(e)}`:""),ch=(e,t)=>!Object.is(e,t),N0=(e,...t)=>{for(let i=0;i<e.length;i++)e[i](...t)},p3=(e,t,i,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:i})},qw=e=>{const t=parseFloat(e);return isNaN(t)?e:t},PN=e=>{const t=Zn(e)?Number(e):NaN;return isNaN(t)?e:t};let $I;const Vb=()=>$I||($I=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function to(e){if(fn(e)){const t={};for(let i=0;i<e.length;i++){const s=e[i],d=Zn(s)?DN(s):to(s);if(d)for(const g in d)t[g]=d[g]}return t}else if(Zn(e)||Vo(e))return e}const RN=/;(?![^(]*\))/g,ON=/:([^]+)/,LN=/\/\*[^]*?\*\//g;function DN(e){const t={};return e.replace(LN,"").split(RN).forEach(i=>{if(i){const s=i.split(ON);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function de(e){let t="";if(Zn(e))t=e;else if(fn(e))for(let i=0;i<e.length;i++){const s=de(e[i]);s&&(t+=s+" ")}else if(Vo(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}function Vc(e){if(!e)return null;let{class:t,style:i}=e;return t&&!Zn(t)&&(e.class=de(t)),i&&(e.style=to(i)),e}const zN="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",FN=_S(zN);function m3(e){return!!e||e===""}function BN(e,t){if(e.length!==t.length)return!1;let i=!0;for(let s=0;i&&s<e.length;s++)i=mm(e[s],t[s]);return i}function mm(e,t){if(e===t)return!0;let i=ph(e),s=ph(t);if(i||s)return i&&s?e.getTime()===t.getTime():!1;if(i=Wc(e),s=Wc(t),i||s)return e===t;if(i=fn(e),s=fn(t),i||s)return i&&s?BN(e,t):!1;if(i=Vo(e),s=Vo(t),i||s){if(!i||!s)return!1;const d=Object.keys(e).length,g=Object.keys(t).length;if(d!==g)return!1;for(const _ in e){const o=e.hasOwnProperty(_),S=t.hasOwnProperty(_);if(o&&!S||!o&&S||!mm(e[_],t[_]))return!1}}return String(e)===String(t)}function g3(e,t){return e.findIndex(i=>mm(i,t))}const v3=e=>!!(e&&e.__v_isRef===!0),wn=e=>Zn(e)?e:e==null?"":fn(e)||Vo(e)&&(e.toString===f3||!Qn(e.toString))?v3(e)?wn(e.value):JSON.stringify(e,_3,2):String(e),_3=(e,t)=>v3(t)?_3(e,t.value):rm(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[s,d],g)=>(i[rw(s,g)+" =>"]=d,i),{})}:Nb(t)?{[`Set(${t.size})`]:[...t.values()].map(i=>rw(i))}:Wc(t)?rw(t):Vo(t)&&!fn(t)&&!Jv(t)?String(t):t,rw=(e,t="")=>{var i;return Wc(e)?`Symbol(${(i=e.description)!=null?i:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let As;class y3{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=As,!t&&As&&(this.index=(As.scopes||(As.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].pause();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].resume();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].resume()}}run(t){if(this._active){const i=As;try{return As=this,t()}finally{As=i}}}on(){As=this}off(){As=this.parent}stop(t){if(this._active){this._active=!1;let i,s;for(i=0,s=this.effects.length;i<s;i++)this.effects[i].stop();for(this.effects.length=0,i=0,s=this.cleanups.length;i<s;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,s=this.scopes.length;i<s;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0}}}function NN(e){return new y3(e)}function b3(){return As}function x3(e,t=!1){As&&As.cleanups.push(e)}let Vi;const iw=new WeakSet;class w3{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,As&&As.active&&As.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,iw.has(this)&&(iw.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||T3(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,VI(this),C3(this);const t=Vi,i=Hc;Vi=this,Hc=!0;try{return this.fn()}finally{E3(this),Vi=t,Hc=i,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)TS(t);this.deps=this.depsTail=void 0,VI(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?iw.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Kw(this)&&this.run()}get dirty(){return Kw(this)}}let S3=0,Nv,$v;function T3(e,t=!1){if(e.flags|=8,t){e.next=$v,$v=e;return}e.next=Nv,Nv=e}function wS(){S3++}function SS(){if(--S3>0)return;if($v){let t=$v;for($v=void 0;t;){const i=t.next;t.next=void 0,t.flags&=-9,t=i}}let e;for(;Nv;){let t=Nv;for(Nv=void 0;t;){const i=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=i}}if(e)throw e}function C3(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function E3(e){let t,i=e.depsTail,s=i;for(;s;){const d=s.prevDep;s.version===-1?(s===i&&(i=d),TS(s),$N(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=d}e.deps=t,e.depsTail=i}function Kw(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(M3(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function M3(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Qv))return;e.globalVersion=Qv;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Kw(e)){e.flags&=-3;return}const i=Vi,s=Hc;Vi=e,Hc=!0;try{C3(e);const d=e.fn(e._value);(t.version===0||ch(d,e._value))&&(e._value=d,t.version++)}catch(d){throw t.version++,d}finally{Vi=i,Hc=s,E3(e),e.flags&=-3}}function TS(e,t=!1){const{dep:i,prevSub:s,nextSub:d}=e;if(s&&(s.nextSub=d,e.prevSub=void 0),d&&(d.prevSub=s,e.nextSub=void 0),i.subs===e&&(i.subs=s,!s&&i.computed)){i.computed.flags&=-5;for(let g=i.computed.deps;g;g=g.nextDep)TS(g,!0)}!t&&!--i.sc&&i.map&&i.map.delete(i.key)}function $N(e){const{prevDep:t,nextDep:i}=e;t&&(t.nextDep=i,e.prevDep=void 0),i&&(i.prevDep=t,e.nextDep=void 0)}let Hc=!0;const I3=[];function Th(){I3.push(Hc),Hc=!1}function Ch(){const e=I3.pop();Hc=e===void 0?!0:e}function VI(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const i=Vi;Vi=void 0;try{t()}finally{Vi=i}}}let Qv=0,VN=class{constructor(t,i){this.sub=t,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Ub{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Vi||!Hc||Vi===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==Vi)i=this.activeLink=new VN(Vi,this),Vi.deps?(i.prevDep=Vi.depsTail,Vi.depsTail.nextDep=i,Vi.depsTail=i):Vi.deps=Vi.depsTail=i,A3(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const s=i.nextDep;s.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=s),i.prevDep=Vi.depsTail,i.nextDep=void 0,Vi.depsTail.nextDep=i,Vi.depsTail=i,Vi.deps===i&&(Vi.deps=s)}return i}trigger(t){this.version++,Qv++,this.notify(t)}notify(t){wS();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{SS()}}}function A3(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)A3(s)}const i=e.dep.subs;i!==e&&(e.prevSub=i,i&&(i.nextSub=e)),e.dep.subs=e}}const ab=new WeakMap,kf=Symbol(""),Zw=Symbol(""),e_=Symbol("");function ls(e,t,i){if(Hc&&Vi){let s=ab.get(e);s||ab.set(e,s=new Map);let d=s.get(i);d||(s.set(i,d=new Ub),d.map=s,d.key=i),d.track()}}function Yu(e,t,i,s,d,g){const _=ab.get(e);if(!_){Qv++;return}const o=S=>{S&&S.trigger()};if(wS(),t==="clear")_.forEach(o);else{const S=fn(e),E=S&&xS(i);if(S&&i==="length"){const I=Number(s);_.forEach((P,F)=>{(F==="length"||F===e_||!Wc(F)&&F>=I)&&o(P)})}else switch((i!==void 0||_.has(void 0))&&o(_.get(i)),E&&o(_.get(e_)),t){case"add":S?E&&o(_.get("length")):(o(_.get(kf)),rm(e)&&o(_.get(Zw)));break;case"delete":S||(o(_.get(kf)),rm(e)&&o(_.get(Zw)));break;case"set":rm(e)&&o(_.get(kf));break}}SS()}function UN(e,t){const i=ab.get(e);return i&&i.get(t)}function Up(e){const t=ei(e);return t===e?t:(ls(t,"iterate",e_),Jl(e)?t:t.map(cs))}function jb(e){return ls(e=ei(e),"iterate",e_),e}const jN={__proto__:null,[Symbol.iterator](){return aw(this,Symbol.iterator,cs)},concat(...e){return Up(this).concat(...e.map(t=>fn(t)?Up(t):t))},entries(){return aw(this,"entries",e=>(e[1]=cs(e[1]),e))},every(e,t){return Wu(this,"every",e,t,void 0,arguments)},filter(e,t){return Wu(this,"filter",e,t,i=>i.map(cs),arguments)},find(e,t){return Wu(this,"find",e,t,cs,arguments)},findIndex(e,t){return Wu(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Wu(this,"findLast",e,t,cs,arguments)},findLastIndex(e,t){return Wu(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Wu(this,"forEach",e,t,void 0,arguments)},includes(...e){return sw(this,"includes",e)},indexOf(...e){return sw(this,"indexOf",e)},join(e){return Up(this).join(e)},lastIndexOf(...e){return sw(this,"lastIndexOf",e)},map(e,t){return Wu(this,"map",e,t,void 0,arguments)},pop(){return Cv(this,"pop")},push(...e){return Cv(this,"push",e)},reduce(e,...t){return UI(this,"reduce",e,t)},reduceRight(e,...t){return UI(this,"reduceRight",e,t)},shift(){return Cv(this,"shift")},some(e,t){return Wu(this,"some",e,t,void 0,arguments)},splice(...e){return Cv(this,"splice",e)},toReversed(){return Up(this).toReversed()},toSorted(e){return Up(this).toSorted(e)},toSpliced(...e){return Up(this).toSpliced(...e)},unshift(...e){return Cv(this,"unshift",e)},values(){return aw(this,"values",cs)}};function aw(e,t,i){const s=jb(e),d=s[t]();return s!==e&&!Jl(e)&&(d._next=d.next,d.next=()=>{const g=d._next();return g.value&&(g.value=i(g.value)),g}),d}const HN=Array.prototype;function Wu(e,t,i,s,d,g){const _=jb(e),o=_!==e&&!Jl(e),S=_[t];if(S!==HN[t]){const P=S.apply(e,g);return o?cs(P):P}let E=i;_!==e&&(o?E=function(P,F){return i.call(this,cs(P),F,e)}:i.length>2&&(E=function(P,F){return i.call(this,P,F,e)}));const I=S.call(_,E,s);return o&&d?d(I):I}function UI(e,t,i,s){const d=jb(e);let g=i;return d!==e&&(Jl(e)?i.length>3&&(g=function(_,o,S){return i.call(this,_,o,S,e)}):g=function(_,o,S){return i.call(this,_,cs(o),S,e)}),d[t](g,...s)}function sw(e,t,i){const s=ei(e);ls(s,"iterate",e_);const d=s[t](...i);return(d===-1||d===!1)&&MS(i[0])?(i[0]=ei(i[0]),s[t](...i)):d}function Cv(e,t,i=[]){Th(),wS();const s=ei(e)[t].apply(e,i);return SS(),Ch(),s}const GN=_S("__proto__,__v_isRef,__isVue"),k3=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Wc));function WN(e){Wc(e)||(e=String(e));const t=ei(this);return ls(t,"has",e),t.hasOwnProperty(e)}class P3{constructor(t=!1,i=!1){this._isReadonly=t,this._isShallow=i}get(t,i,s){if(i==="__v_skip")return t.__v_skip;const d=this._isReadonly,g=this._isShallow;if(i==="__v_isReactive")return!d;if(i==="__v_isReadonly")return d;if(i==="__v_isShallow")return g;if(i==="__v_raw")return s===(d?g?n5:D3:g?L3:O3).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const _=fn(t);if(!d){let S;if(_&&(S=jN[i]))return S;if(i==="hasOwnProperty")return WN}const o=Reflect.get(t,i,vi(t)?t:s);return(Wc(i)?k3.has(i):GN(i))||(d||ls(t,"get",i),g)?o:vi(o)?_&&xS(i)?o:o.value:Vo(o)?d?Dm(o):Pr(o):o}}class R3 extends P3{constructor(t=!1){super(!1,t)}set(t,i,s,d){let g=t[i];if(!this._isShallow){const S=Df(g);if(!Jl(s)&&!Df(s)&&(g=ei(g),s=ei(s)),!fn(t)&&vi(g)&&!vi(s))return S?!1:(g.value=s,!0)}const _=fn(t)&&xS(i)?Number(i)<t.length:Tr(t,i),o=Reflect.set(t,i,s,vi(t)?t:d);return t===ei(d)&&(_?ch(s,g)&&Yu(t,"set",i,s):Yu(t,"add",i,s)),o}deleteProperty(t,i){const s=Tr(t,i);t[i];const d=Reflect.deleteProperty(t,i);return d&&s&&Yu(t,"delete",i,void 0),d}has(t,i){const s=Reflect.has(t,i);return(!Wc(i)||!k3.has(i))&&ls(t,"has",i),s}ownKeys(t){return ls(t,"iterate",fn(t)?"length":kf),Reflect.ownKeys(t)}}class qN extends P3{constructor(t=!1){super(!0,t)}set(t,i){return!0}deleteProperty(t,i){return!0}}const KN=new R3,ZN=new qN,YN=new R3(!0),Yw=e=>e,g0=e=>Reflect.getPrototypeOf(e);function XN(e,t,i){return function(...s){const d=this.__v_raw,g=ei(d),_=rm(g),o=e==="entries"||e===Symbol.iterator&&_,S=e==="keys"&&_,E=d[e](...s),I=i?Yw:t?Xw:cs;return!t&&ls(g,"iterate",S?Zw:kf),{next(){const{value:P,done:F}=E.next();return F?{value:P,done:F}:{value:o?[I(P[0]),I(P[1])]:I(P),done:F}},[Symbol.iterator](){return this}}}}function v0(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function JN(e,t){const i={get(d){const g=this.__v_raw,_=ei(g),o=ei(d);e||(ch(d,o)&&ls(_,"get",d),ls(_,"get",o));const{has:S}=g0(_),E=t?Yw:e?Xw:cs;if(S.call(_,d))return E(g.get(d));if(S.call(_,o))return E(g.get(o));g!==_&&g.get(d)},get size(){const d=this.__v_raw;return!e&&ls(ei(d),"iterate",kf),Reflect.get(d,"size",d)},has(d){const g=this.__v_raw,_=ei(g),o=ei(d);return e||(ch(d,o)&&ls(_,"has",d),ls(_,"has",o)),d===o?g.has(d):g.has(d)||g.has(o)},forEach(d,g){const _=this,o=_.__v_raw,S=ei(o),E=t?Yw:e?Xw:cs;return!e&&ls(S,"iterate",kf),o.forEach((I,P)=>d.call(g,E(I),E(P),_))}};return da(i,e?{add:v0("add"),set:v0("set"),delete:v0("delete"),clear:v0("clear")}:{add(d){!t&&!Jl(d)&&!Df(d)&&(d=ei(d));const g=ei(this);return g0(g).has.call(g,d)||(g.add(d),Yu(g,"add",d,d)),this},set(d,g){!t&&!Jl(g)&&!Df(g)&&(g=ei(g));const _=ei(this),{has:o,get:S}=g0(_);let E=o.call(_,d);E||(d=ei(d),E=o.call(_,d));const I=S.call(_,d);return _.set(d,g),E?ch(g,I)&&Yu(_,"set",d,g):Yu(_,"add",d,g),this},delete(d){const g=ei(this),{has:_,get:o}=g0(g);let S=_.call(g,d);S||(d=ei(d),S=_.call(g,d)),o&&o.call(g,d);const E=g.delete(d);return S&&Yu(g,"delete",d,void 0),E},clear(){const d=ei(this),g=d.size!==0,_=d.clear();return g&&Yu(d,"clear",void 0,void 0),_}}),["keys","values","entries",Symbol.iterator].forEach(d=>{i[d]=XN(d,e,t)}),i}function CS(e,t){const i=JN(e,t);return(s,d,g)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?s:Reflect.get(Tr(i,d)&&d in s?i:s,d,g)}const QN={get:CS(!1,!1)},e5={get:CS(!1,!0)},t5={get:CS(!0,!1)},O3=new WeakMap,L3=new WeakMap,D3=new WeakMap,n5=new WeakMap;function o5(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function r5(e){return e.__v_skip||!Object.isExtensible(e)?0:o5(IN(e))}function Pr(e){return Df(e)?e:ES(e,!1,KN,QN,O3)}function z3(e){return ES(e,!1,YN,e5,L3)}function Dm(e){return ES(e,!0,ZN,t5,D3)}function ES(e,t,i,s,d){if(!Vo(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const g=d.get(e);if(g)return g;const _=r5(e);if(_===0)return e;const o=new Proxy(e,_===2?s:i);return d.set(e,o),o}function im(e){return Df(e)?im(e.__v_raw):!!(e&&e.__v_isReactive)}function Df(e){return!!(e&&e.__v_isReadonly)}function Jl(e){return!!(e&&e.__v_isShallow)}function MS(e){return e?!!e.__v_raw:!1}function ei(e){const t=e&&e.__v_raw;return t?ei(t):e}function uh(e){return!Tr(e,"__v_skip")&&Object.isExtensible(e)&&p3(e,"__v_skip",!0),e}const cs=e=>Vo(e)?Pr(e):e,Xw=e=>Vo(e)?Dm(e):e;function vi(e){return e?e.__v_isRef===!0:!1}function Se(e){return F3(e,!1)}function gi(e){return F3(e,!0)}function F3(e,t){return vi(e)?e:new i5(e,t)}class i5{constructor(t,i){this.dep=new Ub,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?t:ei(t),this._value=i?t:cs(t),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(t){const i=this._rawValue,s=this.__v_isShallow||Jl(t)||Df(t);t=s?t:ei(t),ch(t,i)&&(this._rawValue=t,this._value=s?t:cs(t),this.dep.trigger())}}function y(e){return vi(e)?e.value:e}const a5={get:(e,t,i)=>t==="__v_raw"?e:y(Reflect.get(e,t,i)),set:(e,t,i,s)=>{const d=e[t];return vi(d)&&!vi(i)?(d.value=i,!0):Reflect.set(e,t,i,s)}};function B3(e){return im(e)?e:new Proxy(e,a5)}class s5{constructor(t){this.__v_isRef=!0,this._value=void 0;const i=this.dep=new Ub,{get:s,set:d}=t(i.track.bind(i),i.trigger.bind(i));this._get=s,this._set=d}get value(){return this._value=this._get()}set value(t){this._set(t)}}function l5(e){return new s5(e)}function Ca(e){const t=fn(e)?new Array(e.length):{};for(const i in e)t[i]=N3(e,i);return t}class c5{constructor(t,i,s){this._object=t,this._key=i,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return UN(ei(this._object),this._key)}}class u5{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Vr(e,t,i){return vi(e)?e:Qn(e)?new u5(e):Vo(e)&&arguments.length>1?N3(e,t,i):Se(e)}function N3(e,t,i){const s=e[t];return vi(s)?s:new c5(e,t,i)}class d5{constructor(t,i,s){this.fn=t,this.setter=i,this._value=void 0,this.dep=new Ub(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Qv-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Vi!==this)return T3(this,!0),!0}get value(){const t=this.dep.track();return M3(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function h5(e,t,i=!1){let s,d;return Qn(e)?s=e:(s=e.get,d=e.set),new d5(s,d,i)}const _0={},sb=new WeakMap;let bf;function f5(e,t=!1,i=bf){if(i){let s=sb.get(i);s||sb.set(i,s=[]),s.push(e)}}function p5(e,t,i=Fi){const{immediate:s,deep:d,once:g,scheduler:_,augmentJob:o,call:S}=i,E=G=>d?G:Jl(G)||d===!1||d===0?Xu(G,1):Xu(G);let I,P,F,B,$=!1,z=!1;if(vi(e)?(P=()=>e.value,$=Jl(e)):im(e)?(P=()=>E(e),$=!0):fn(e)?(z=!0,$=e.some(G=>im(G)||Jl(G)),P=()=>e.map(G=>{if(vi(G))return G.value;if(im(G))return E(G);if(Qn(G))return S?S(G,2):G()})):Qn(e)?t?P=S?()=>S(e,2):e:P=()=>{if(F){Th();try{F()}finally{Ch()}}const G=bf;bf=I;try{return S?S(e,3,[B]):e(B)}finally{bf=G}}:P=jr,t&&d){const G=P,Q=d===!0?1/0:d;P=()=>Xu(G(),Q)}const H=b3(),U=()=>{I.stop(),H&&H.active&&bS(H.effects,I)};if(g&&t){const G=t;t=(...Q)=>{G(...Q),U()}}let ie=z?new Array(e.length).fill(_0):_0;const Z=G=>{if(!(!(I.flags&1)||!I.dirty&&!G))if(t){const Q=I.run();if(d||$||(z?Q.some((oe,le)=>ch(oe,ie[le])):ch(Q,ie))){F&&F();const oe=bf;bf=I;try{const le=[Q,ie===_0?void 0:z&&ie[0]===_0?[]:ie,B];S?S(t,3,le):t(...le),ie=Q}finally{bf=oe}}}else I.run()};return o&&o(Z),I=new w3(P),I.scheduler=_?()=>_(Z,!1):Z,B=G=>f5(G,!1,I),F=I.onStop=()=>{const G=sb.get(I);if(G){if(S)S(G,4);else for(const Q of G)Q();sb.delete(I)}},t?s?Z(!0):ie=I.run():_?_(Z.bind(null,!0),!0):I.run(),U.pause=I.pause.bind(I),U.resume=I.resume.bind(I),U.stop=U,U}function Xu(e,t=1/0,i){if(t<=0||!Vo(e)||e.__v_skip||(i=i||new Set,i.has(e)))return e;if(i.add(e),t--,vi(e))Xu(e.value,t,i);else if(fn(e))for(let s=0;s<e.length;s++)Xu(e[s],t,i);else if(Nb(e)||rm(e))e.forEach(s=>{Xu(s,t,i)});else if(Jv(e)){for(const s in e)Xu(e[s],t,i);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&Xu(e[s],t,i)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function I_(e,t,i,s){try{return s?e(...s):e()}catch(d){Hb(d,t,i)}}function qc(e,t,i,s){if(Qn(e)){const d=I_(e,t,i,s);return d&&Xv(d)&&d.catch(g=>{Hb(g,t,i)}),d}if(fn(e)){const d=[];for(let g=0;g<e.length;g++)d.push(qc(e[g],t,i,s));return d}}function Hb(e,t,i,s=!0){const d=t?t.vnode:null,{errorHandler:g,throwUnhandledErrorInProduction:_}=t&&t.appContext.config||Fi;if(t){let o=t.parent;const S=t.proxy,E=`https://vuejs.org/error-reference/#runtime-${i}`;for(;o;){const I=o.ec;if(I){for(let P=0;P<I.length;P++)if(I[P](e,S,E)===!1)return}o=o.parent}if(g){Th(),I_(g,null,10,[e,S,E]),Ch();return}}m5(e,i,d,s,_)}function m5(e,t,i,s=!0,d=!1){if(d)throw e;console.error(e)}const ks=[];let _u=-1;const am=[];let oh=null,Zp=0;const $3=Promise.resolve();let lb=null;function oo(e){const t=lb||$3;return e?t.then(this?e.bind(this):e):t}function g5(e){let t=_u+1,i=ks.length;for(;t<i;){const s=t+i>>>1,d=ks[s],g=t_(d);g<e||g===e&&d.flags&2?t=s+1:i=s}return t}function IS(e){if(!(e.flags&1)){const t=t_(e),i=ks[ks.length-1];!i||!(e.flags&2)&&t>=t_(i)?ks.push(e):ks.splice(g5(t),0,e),e.flags|=1,V3()}}function V3(){lb||(lb=$3.then(j3))}function v5(e){fn(e)?am.push(...e):oh&&e.id===-1?oh.splice(Zp+1,0,e):e.flags&1||(am.push(e),e.flags|=1),V3()}function jI(e,t,i=_u+1){for(;i<ks.length;i++){const s=ks[i];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;ks.splice(i,1),i--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function U3(e){if(am.length){const t=[...new Set(am)].sort((i,s)=>t_(i)-t_(s));if(am.length=0,oh){oh.push(...t);return}for(oh=t,Zp=0;Zp<oh.length;Zp++){const i=oh[Zp];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}oh=null,Zp=0}}const t_=e=>e.id==null?e.flags&2?-1:1/0:e.id;function j3(e){try{for(_u=0;_u<ks.length;_u++){const t=ks[_u];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),I_(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;_u<ks.length;_u++){const t=ks[_u];t&&(t.flags&=-2)}_u=-1,ks.length=0,U3(),lb=null,(ks.length||am.length)&&j3()}}let Ra=null,H3=null;function cb(e){const t=Ra;return Ra=e,H3=e&&e.type.__scopeId||null,t}function at(e,t=Ra,i){if(!t||e._n)return e;const s=(...d)=>{s._d&&nA(-1);const g=cb(t);let _;try{_=e(...d)}finally{cb(g),s._d&&nA(1)}return _};return s._n=!0,s._c=!0,s._d=!0,s}function zo(e,t){if(Ra===null)return e;const i=Yb(Ra),s=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[g,_,o,S=Fi]=t[d];g&&(Qn(g)&&(g={mounted:g,updated:g}),g.deep&&Xu(_),s.push({dir:g,instance:i,value:_,oldValue:void 0,arg:o,modifiers:S}))}return e}function mf(e,t,i,s){const d=e.dirs,g=t&&t.dirs;for(let _=0;_<d.length;_++){const o=d[_];g&&(o.oldValue=g[_].value);let S=o.dir[s];S&&(Th(),qc(S,i,8,[e.el,o,e,t]),Ch())}}const G3=Symbol("_vte"),W3=e=>e.__isTeleport,Vv=e=>e&&(e.disabled||e.disabled===""),HI=e=>e&&(e.defer||e.defer===""),GI=e=>typeof SVGElement<"u"&&e instanceof SVGElement,WI=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Jw=(e,t)=>{const i=e&&e.to;return Zn(i)?t?t(i):null:i},q3={name:"Teleport",__isTeleport:!0,process(e,t,i,s,d,g,_,o,S,E){const{mc:I,pc:P,pbc:F,o:{insert:B,querySelector:$,createText:z,createComment:H}}=E,U=Vv(t.props);let{shapeFlag:ie,children:Z,dynamicChildren:G}=t;if(e==null){const Q=t.el=z(""),oe=t.anchor=z("");B(Q,i,s),B(oe,i,s);const le=(fe,ce)=>{ie&16&&(d&&d.isCE&&(d.ce._teleportTarget=fe),I(Z,fe,ce,d,g,_,o,S))},me=()=>{const fe=t.target=Jw(t.props,$),ce=K3(fe,t,z,B);fe&&(_!=="svg"&&GI(fe)?_="svg":_!=="mathml"&&WI(fe)&&(_="mathml"),U||(le(fe,ce),$0(t,!1)))};U&&(le(i,oe),$0(t,!0)),HI(t.props)?Is(()=>{me(),t.el.__isMounted=!0},g):me()}else{if(HI(t.props)&&!e.el.__isMounted){Is(()=>{q3.process(e,t,i,s,d,g,_,o,S,E),delete e.el.__isMounted},g);return}t.el=e.el,t.targetStart=e.targetStart;const Q=t.anchor=e.anchor,oe=t.target=e.target,le=t.targetAnchor=e.targetAnchor,me=Vv(e.props),fe=me?i:oe,ce=me?Q:le;if(_==="svg"||GI(oe)?_="svg":(_==="mathml"||WI(oe))&&(_="mathml"),G?(F(e.dynamicChildren,G,fe,d,g,_,o),DS(e,t,!0)):S||P(e,t,fe,ce,d,g,_,o,!1),U)me?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):y0(t,i,Q,E,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const pe=t.target=Jw(t.props,$);pe&&y0(t,pe,null,E,0)}else me&&y0(t,oe,le,E,1);$0(t,U)}},remove(e,t,i,{um:s,o:{remove:d}},g){const{shapeFlag:_,children:o,anchor:S,targetStart:E,targetAnchor:I,target:P,props:F}=e;if(P&&(d(E),d(I)),g&&d(S),_&16){const B=g||!Vv(F);for(let $=0;$<o.length;$++){const z=o[$];s(z,t,i,B,!!z.dynamicChildren)}}},move:y0,hydrate:_5};function y0(e,t,i,{o:{insert:s},m:d},g=2){g===0&&s(e.targetAnchor,t,i);const{el:_,anchor:o,shapeFlag:S,children:E,props:I}=e,P=g===2;if(P&&s(_,t,i),(!P||Vv(I))&&S&16)for(let F=0;F<E.length;F++)d(E[F],t,i,2);P&&s(o,t,i)}function _5(e,t,i,s,d,g,{o:{nextSibling:_,parentNode:o,querySelector:S,insert:E,createText:I}},P){const F=t.target=Jw(t.props,S);if(F){const B=Vv(t.props),$=F._lpa||F.firstChild;if(t.shapeFlag&16)if(B)t.anchor=P(_(e),t,o(e),i,s,d,g),t.targetStart=$,t.targetAnchor=$&&_($);else{t.anchor=_(e);let z=$;for(;z;){if(z&&z.nodeType===8){if(z.data==="teleport start anchor")t.targetStart=z;else if(z.data==="teleport anchor"){t.targetAnchor=z,F._lpa=t.targetAnchor&&_(t.targetAnchor);break}}z=_(z)}t.targetAnchor||K3(F,t,I,E),P($&&_($),t,F,i,s,d,g)}$0(t,B)}return t.anchor&&_(t.anchor)}const y5=q3;function $0(e,t){const i=e.ctx;if(i&&i.ut){let s,d;for(t?(s=e.el,d=e.anchor):(s=e.targetStart,d=e.targetAnchor);s&&s!==d;)s.nodeType===1&&s.setAttribute("data-v-owner",i.uid),s=s.nextSibling;i.ut()}}function K3(e,t,i,s){const d=t.targetStart=i(""),g=t.targetAnchor=i("");return d[G3]=g,e&&(s(d,e),s(g,e)),g}const rh=Symbol("_leaveCb"),b0=Symbol("_enterCb");function Z3(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return No(()=>{e.isMounted=!0}),ni(()=>{e.isUnmounting=!0}),e}const Wl=[Function,Array],Y3={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Wl,onEnter:Wl,onAfterEnter:Wl,onEnterCancelled:Wl,onBeforeLeave:Wl,onLeave:Wl,onAfterLeave:Wl,onLeaveCancelled:Wl,onBeforeAppear:Wl,onAppear:Wl,onAfterAppear:Wl,onAppearCancelled:Wl},X3=e=>{const t=e.subTree;return t.component?X3(t.component):t},b5={name:"BaseTransition",props:Y3,setup(e,{slots:t}){const i=jo(),s=Z3();return()=>{const d=t.default&&AS(t.default(),!0);if(!d||!d.length)return;const g=J3(d),_=ei(e),{mode:o}=_;if(s.isLeaving)return lw(g);const S=qI(g);if(!S)return lw(g);let E=n_(S,_,s,i,P=>E=P);S.type!==Sa&&zf(S,E);let I=i.subTree&&qI(i.subTree);if(I&&I.type!==Sa&&!xf(S,I)&&X3(i).type!==Sa){let P=n_(I,_,s,i);if(zf(I,P),o==="out-in"&&S.type!==Sa)return s.isLeaving=!0,P.afterLeave=()=>{s.isLeaving=!1,i.job.flags&8||i.update(),delete P.afterLeave,I=void 0},lw(g);o==="in-out"&&S.type!==Sa?P.delayLeave=(F,B,$)=>{const z=Q3(s,I);z[String(I.key)]=I,F[rh]=()=>{B(),F[rh]=void 0,delete E.delayedLeave,I=void 0},E.delayedLeave=()=>{$(),delete E.delayedLeave,I=void 0}}:I=void 0}else I&&(I=void 0);return g}}};function J3(e){let t=e[0];if(e.length>1){for(const i of e)if(i.type!==Sa){t=i;break}}return t}const x5=b5;function Q3(e,t){const{leavingVNodes:i}=e;let s=i.get(t.type);return s||(s=Object.create(null),i.set(t.type,s)),s}function n_(e,t,i,s,d){const{appear:g,mode:_,persisted:o=!1,onBeforeEnter:S,onEnter:E,onAfterEnter:I,onEnterCancelled:P,onBeforeLeave:F,onLeave:B,onAfterLeave:$,onLeaveCancelled:z,onBeforeAppear:H,onAppear:U,onAfterAppear:ie,onAppearCancelled:Z}=t,G=String(e.key),Q=Q3(i,e),oe=(fe,ce)=>{fe&&qc(fe,s,9,ce)},le=(fe,ce)=>{const pe=ce[1];oe(fe,ce),fn(fe)?fe.every(ye=>ye.length<=1)&&pe():fe.length<=1&&pe()},me={mode:_,persisted:o,beforeEnter(fe){let ce=S;if(!i.isMounted)if(g)ce=H||S;else return;fe[rh]&&fe[rh](!0);const pe=Q[G];pe&&xf(e,pe)&&pe.el[rh]&&pe.el[rh](),oe(ce,[fe])},enter(fe){let ce=E,pe=I,ye=P;if(!i.isMounted)if(g)ce=U||E,pe=ie||I,ye=Z||P;else return;let De=!1;const tt=fe[b0]=Me=>{De||(De=!0,Me?oe(ye,[fe]):oe(pe,[fe]),me.delayedLeave&&me.delayedLeave(),fe[b0]=void 0)};ce?le(ce,[fe,tt]):tt()},leave(fe,ce){const pe=String(e.key);if(fe[b0]&&fe[b0](!0),i.isUnmounting)return ce();oe(F,[fe]);let ye=!1;const De=fe[rh]=tt=>{ye||(ye=!0,ce(),tt?oe(z,[fe]):oe($,[fe]),fe[rh]=void 0,Q[pe]===e&&delete Q[pe])};Q[pe]=e,B?le(B,[fe,De]):De()},clone(fe){const ce=n_(fe,t,i,s,d);return d&&d(ce),ce}};return me}function lw(e){if(Gb(e))return e=td(e),e.children=null,e}function qI(e){if(!Gb(e))return W3(e.type)&&e.children?J3(e.children):e;const{shapeFlag:t,children:i}=e;if(i){if(t&16)return i[0];if(t&32&&Qn(i.default))return i.default()}}function zf(e,t){e.shapeFlag&6&&e.component?(e.transition=t,zf(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function AS(e,t=!1,i){let s=[],d=0;for(let g=0;g<e.length;g++){let _=e[g];const o=i==null?_.key:String(i)+String(_.key!=null?_.key:g);_.type===eo?(_.patchFlag&128&&d++,s=s.concat(AS(_.children,t,o))):(t||_.type!==Sa)&&s.push(o!=null?td(_,{key:o}):_)}if(d>1)for(let g=0;g<s.length;g++)s[g].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function Ze(e,t){return Qn(e)?da({name:e.name},t,{setup:e}):e}function eR(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function ub(e,t,i,s,d=!1){if(fn(e)){e.forEach(($,z)=>ub($,t&&(fn(t)?t[z]:t),i,s,d));return}if(sm(s)&&!d){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&ub(e,t,i,s.component.subTree);return}const g=s.shapeFlag&4?Yb(s.component):s.el,_=d?null:g,{i:o,r:S}=e,E=t&&t.r,I=o.refs===Fi?o.refs={}:o.refs,P=o.setupState,F=ei(P),B=P===Fi?()=>!1:$=>Tr(F,$);if(E!=null&&E!==S&&(Zn(E)?(I[E]=null,B(E)&&(P[E]=null)):vi(E)&&(E.value=null)),Qn(S))I_(S,o,12,[_,I]);else{const $=Zn(S),z=vi(S);if($||z){const H=()=>{if(e.f){const U=$?B(S)?P[S]:I[S]:S.value;d?fn(U)&&bS(U,g):fn(U)?U.includes(g)||U.push(g):$?(I[S]=[g],B(S)&&(P[S]=I[S])):(S.value=[g],e.k&&(I[e.k]=S.value))}else $?(I[S]=_,B(S)&&(P[S]=_)):z&&(S.value=_,e.k&&(I[e.k]=_))};_?(H.id=-1,Is(H,i)):H()}}}Vb().requestIdleCallback;Vb().cancelIdleCallback;const sm=e=>!!e.type.__asyncLoader,Gb=e=>e.type.__isKeepAlive;function kS(e,t){nR(e,"a",t)}function tR(e,t){nR(e,"da",t)}function nR(e,t,i=ja){const s=e.__wdc||(e.__wdc=()=>{let d=i;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(Wb(t,s,i),i){let d=i.parent;for(;d&&d.parent;)Gb(d.parent.vnode)&&w5(s,t,i,d),d=d.parent}}function w5(e,t,i,s){const d=Wb(t,e,s,!0);Eh(()=>{bS(s[t],d)},i)}function Wb(e,t,i=ja,s=!1){if(i){const d=i[e]||(i[e]=[]),g=t.__weh||(t.__weh=(..._)=>{Th();const o=A_(i),S=qc(t,i,e,_);return o(),Ch(),S});return s?d.unshift(g):d.push(g),g}}const ad=e=>(t,i=ja)=>{(!r_||e==="sp")&&Wb(e,(...s)=>t(...s),i)},qb=ad("bm"),No=ad("m"),oR=ad("bu"),Au=ad("u"),ni=ad("bum"),Eh=ad("um"),S5=ad("sp"),T5=ad("rtg"),C5=ad("rtc");function E5(e,t=ja){Wb("ec",e,t)}const PS="components",M5="directives";function Go(e,t){return RS(PS,e,!0,t)||e}const rR=Symbol.for("v-ndc");function Wo(e){return Zn(e)?RS(PS,e,!1)||e:e||rR}function Kb(e){return RS(M5,e)}function RS(e,t,i=!0,s=!1){const d=Ra||ja;if(d){const g=d.type;if(e===PS){const o=d6(g,!1);if(o&&(o===t||o===Ds(t)||o===M_(Ds(t))))return g}const _=KI(d[e]||g[e],t)||KI(d.appContext[e],t);return!_&&s?g:_}}function KI(e,t){return e&&(e[t]||e[Ds(t)]||e[M_(Ds(t))])}function tr(e,t,i,s){let d;const g=i,_=fn(e);if(_||Zn(e)){const o=_&&im(e);let S=!1;o&&(S=!Jl(e),e=jb(e)),d=new Array(e.length);for(let E=0,I=e.length;E<I;E++)d[E]=t(S?cs(e[E]):e[E],E,void 0,g)}else if(typeof e=="number"){d=new Array(e);for(let o=0;o<e;o++)d[o]=t(o+1,o,void 0,g)}else if(Vo(e))if(e[Symbol.iterator])d=Array.from(e,(o,S)=>t(o,S,void 0,g));else{const o=Object.keys(e);d=new Array(o.length);for(let S=0,E=o.length;S<E;S++){const I=o[S];d[S]=t(e[I],I,S,g)}}else d=[];return d}function ec(e,t){for(let i=0;i<t.length;i++){const s=t[i];if(fn(s))for(let d=0;d<s.length;d++)e[s[d].name]=s[d].fn;else s&&(e[s.name]=s.key?(...d)=>{const g=s.fn(...d);return g&&(g.key=s.key),g}:s.fn)}return e}function _t(e,t,i={},s,d){if(Ra.ce||Ra.parent&&sm(Ra.parent)&&Ra.parent.ce)return t!=="default"&&(i.name=t),se(),Rt(eo,null,[Qe("slot",i,s&&s())],64);let g=e[t];g&&g._c&&(g._d=!1),se();const _=g&&iR(g(i)),o=i.key||_&&_.key,S=Rt(eo,{key:(o&&!Wc(o)?o:`_${t}`)+(!_&&s?"_fb":"")},_||(s?s():[]),_&&e._===1?64:-2);return S.scopeId&&(S.slotScopeIds=[S.scopeId+"-s"]),g&&g._c&&(g._d=!0),S}function iR(e){return e.some(t=>Ai(t)?!(t.type===Sa||t.type===eo&&!iR(t.children)):!0)?e:null}function I5(e,t){const i={};for(const s in e)i[Bv(s)]=e[s];return i}const Qw=e=>e?TR(e)?Yb(e):Qw(e.parent):null,Uv=da(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Qw(e.parent),$root:e=>Qw(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>OS(e),$forceUpdate:e=>e.f||(e.f=()=>{IS(e.update)}),$nextTick:e=>e.n||(e.n=oo.bind(e.proxy)),$watch:e=>Z5.bind(e)}),cw=(e,t)=>e!==Fi&&!e.__isScriptSetup&&Tr(e,t),A5={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:i,setupState:s,data:d,props:g,accessCache:_,type:o,appContext:S}=e;let E;if(t[0]!=="$"){const B=_[t];if(B!==void 0)switch(B){case 1:return s[t];case 2:return d[t];case 4:return i[t];case 3:return g[t]}else{if(cw(s,t))return _[t]=1,s[t];if(d!==Fi&&Tr(d,t))return _[t]=2,d[t];if((E=e.propsOptions[0])&&Tr(E,t))return _[t]=3,g[t];if(i!==Fi&&Tr(i,t))return _[t]=4,i[t];e2&&(_[t]=0)}}const I=Uv[t];let P,F;if(I)return t==="$attrs"&&ls(e.attrs,"get",""),I(e);if((P=o.__cssModules)&&(P=P[t]))return P;if(i!==Fi&&Tr(i,t))return _[t]=4,i[t];if(F=S.config.globalProperties,Tr(F,t))return F[t]},set({_:e},t,i){const{data:s,setupState:d,ctx:g}=e;return cw(d,t)?(d[t]=i,!0):s!==Fi&&Tr(s,t)?(s[t]=i,!0):Tr(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(g[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:s,appContext:d,propsOptions:g}},_){let o;return!!i[_]||e!==Fi&&Tr(e,_)||cw(t,_)||(o=g[0])&&Tr(o,_)||Tr(s,_)||Tr(Uv,_)||Tr(d.config.globalProperties,_)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:Tr(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function aa(){return aR().slots}function Mh(){return aR().attrs}function aR(){const e=jo();return e.setupContext||(e.setupContext=ER(e))}function ZI(e){return fn(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let e2=!0;function k5(e){const t=OS(e),i=e.proxy,s=e.ctx;e2=!1,t.beforeCreate&&YI(t.beforeCreate,e,"bc");const{data:d,computed:g,methods:_,watch:o,provide:S,inject:E,created:I,beforeMount:P,mounted:F,beforeUpdate:B,updated:$,activated:z,deactivated:H,beforeDestroy:U,beforeUnmount:ie,destroyed:Z,unmounted:G,render:Q,renderTracked:oe,renderTriggered:le,errorCaptured:me,serverPrefetch:fe,expose:ce,inheritAttrs:pe,components:ye,directives:De,filters:tt}=t;if(E&&P5(E,s,null),_)for(const Ae in _){const Ce=_[Ae];Qn(Ce)&&(s[Ae]=Ce.bind(i))}if(d){const Ae=d.call(i,i);Vo(Ae)&&(e.data=Pr(Ae))}if(e2=!0,g)for(const Ae in g){const Ce=g[Ae],ge=Qn(Ce)?Ce.bind(i,i):Qn(Ce.get)?Ce.get.bind(i,i):jr,Ne=!Qn(Ce)&&Qn(Ce.set)?Ce.set.bind(i):jr,We=te({get:ge,set:Ne});Object.defineProperty(s,Ae,{enumerable:!0,configurable:!0,get:()=>We.value,set:ot=>We.value=ot})}if(o)for(const Ae in o)sR(o[Ae],s,i,Ae);if(S){const Ae=Qn(S)?S.call(i):S;Reflect.ownKeys(Ae).forEach(Ce=>{or(Ce,Ae[Ce])})}I&&YI(I,e,"c");function xe(Ae,Ce){fn(Ce)?Ce.forEach(ge=>Ae(ge.bind(i))):Ce&&Ae(Ce.bind(i))}if(xe(qb,P),xe(No,F),xe(oR,B),xe(Au,$),xe(kS,z),xe(tR,H),xe(E5,me),xe(C5,oe),xe(T5,le),xe(ni,ie),xe(Eh,G),xe(S5,fe),fn(ce))if(ce.length){const Ae=e.exposed||(e.exposed={});ce.forEach(Ce=>{Object.defineProperty(Ae,Ce,{get:()=>i[Ce],set:ge=>i[Ce]=ge})})}else e.exposed||(e.exposed={});Q&&e.render===jr&&(e.render=Q),pe!=null&&(e.inheritAttrs=pe),ye&&(e.components=ye),De&&(e.directives=De),fe&&eR(e)}function P5(e,t,i=jr){fn(e)&&(e=t2(e));for(const s in e){const d=e[s];let g;Vo(d)?"default"in d?g=Un(d.from||s,d.default,!0):g=Un(d.from||s):g=Un(d),vi(g)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>g.value,set:_=>g.value=_}):t[s]=g}}function YI(e,t,i){qc(fn(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,i)}function sR(e,t,i,s){let d=s.includes(".")?yR(i,s):()=>i[s];if(Zn(e)){const g=t[e];Qn(g)&&tn(d,g)}else if(Qn(e))tn(d,e.bind(i));else if(Vo(e))if(fn(e))e.forEach(g=>sR(g,t,i,s));else{const g=Qn(e.handler)?e.handler.bind(i):t[e.handler];Qn(g)&&tn(d,g,e)}}function OS(e){const t=e.type,{mixins:i,extends:s}=t,{mixins:d,optionsCache:g,config:{optionMergeStrategies:_}}=e.appContext,o=g.get(t);let S;return o?S=o:!d.length&&!i&&!s?S=t:(S={},d.length&&d.forEach(E=>db(S,E,_,!0)),db(S,t,_)),Vo(t)&&g.set(t,S),S}function db(e,t,i,s=!1){const{mixins:d,extends:g}=t;g&&db(e,g,i,!0),d&&d.forEach(_=>db(e,_,i,!0));for(const _ in t)if(!(s&&_==="expose")){const o=R5[_]||i&&i[_];e[_]=o?o(e[_],t[_]):t[_]}return e}const R5={data:XI,props:JI,emits:JI,methods:Ov,computed:Ov,beforeCreate:Ms,created:Ms,beforeMount:Ms,mounted:Ms,beforeUpdate:Ms,updated:Ms,beforeDestroy:Ms,beforeUnmount:Ms,destroyed:Ms,unmounted:Ms,activated:Ms,deactivated:Ms,errorCaptured:Ms,serverPrefetch:Ms,components:Ov,directives:Ov,watch:L5,provide:XI,inject:O5};function XI(e,t){return t?e?function(){return da(Qn(e)?e.call(this,this):e,Qn(t)?t.call(this,this):t)}:t:e}function O5(e,t){return Ov(t2(e),t2(t))}function t2(e){if(fn(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function Ms(e,t){return e?[...new Set([].concat(e,t))]:t}function Ov(e,t){return e?da(Object.create(null),e,t):t}function JI(e,t){return e?fn(e)&&fn(t)?[...new Set([...e,...t])]:da(Object.create(null),ZI(e),ZI(t??{})):t}function L5(e,t){if(!e)return t;if(!t)return e;const i=da(Object.create(null),e);for(const s in t)i[s]=Ms(e[s],t[s]);return i}function lR(){return{app:null,config:{isNativeTag:EN,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let D5=0;function z5(e,t){return function(s,d=null){Qn(s)||(s=da({},s)),d!=null&&!Vo(d)&&(d=null);const g=lR(),_=new WeakSet,o=[];let S=!1;const E=g.app={_uid:D5++,_component:s,_props:d,_container:null,_context:g,_instance:null,version:f6,get config(){return g.config},set config(I){},use(I,...P){return _.has(I)||(I&&Qn(I.install)?(_.add(I),I.install(E,...P)):Qn(I)&&(_.add(I),I(E,...P))),E},mixin(I){return g.mixins.includes(I)||g.mixins.push(I),E},component(I,P){return P?(g.components[I]=P,E):g.components[I]},directive(I,P){return P?(g.directives[I]=P,E):g.directives[I]},mount(I,P,F){if(!S){const B=E._ceVNode||Qe(s,d);return B.appContext=g,F===!0?F="svg":F===!1&&(F=void 0),P&&t?t(B,I):e(B,I,F),S=!0,E._container=I,I.__vue_app__=E,Yb(B.component)}},onUnmount(I){o.push(I)},unmount(){S&&(qc(o,E._instance,16),e(null,E._container),delete E._container.__vue_app__)},provide(I,P){return g.provides[I]=P,E},runWithContext(I){const P=lm;lm=E;try{return I()}finally{lm=P}}};return E}}let lm=null;function or(e,t){if(ja){let i=ja.provides;const s=ja.parent&&ja.parent.provides;s===i&&(i=ja.provides=Object.create(s)),i[e]=t}}function Un(e,t,i=!1){const s=ja||Ra;if(s||lm){const d=lm?lm._context.provides:s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(d&&e in d)return d[e];if(arguments.length>1)return i&&Qn(t)?t.call(s&&s.proxy):t}}const cR={},uR=()=>Object.create(cR),dR=e=>Object.getPrototypeOf(e)===cR;function F5(e,t,i,s=!1){const d={},g=uR();e.propsDefaults=Object.create(null),hR(e,t,d,g);for(const _ in e.propsOptions[0])_ in d||(d[_]=void 0);i?e.props=s?d:z3(d):e.type.props?e.props=d:e.props=g,e.attrs=g}function B5(e,t,i,s){const{props:d,attrs:g,vnode:{patchFlag:_}}=e,o=ei(d),[S]=e.propsOptions;let E=!1;if((s||_>0)&&!(_&16)){if(_&8){const I=e.vnode.dynamicProps;for(let P=0;P<I.length;P++){let F=I[P];if(Zb(e.emitsOptions,F))continue;const B=t[F];if(S)if(Tr(g,F))B!==g[F]&&(g[F]=B,E=!0);else{const $=Ds(F);d[$]=n2(S,o,$,B,e,!1)}else B!==g[F]&&(g[F]=B,E=!0)}}}else{hR(e,t,d,g)&&(E=!0);let I;for(const P in o)(!t||!Tr(t,P)&&((I=id(P))===P||!Tr(t,I)))&&(S?i&&(i[P]!==void 0||i[I]!==void 0)&&(d[P]=n2(S,o,P,void 0,e,!0)):delete d[P]);if(g!==o)for(const P in g)(!t||!Tr(t,P))&&(delete g[P],E=!0)}E&&Yu(e.attrs,"set","")}function hR(e,t,i,s){const[d,g]=e.propsOptions;let _=!1,o;if(t)for(let S in t){if(Fv(S))continue;const E=t[S];let I;d&&Tr(d,I=Ds(S))?!g||!g.includes(I)?i[I]=E:(o||(o={}))[I]=E:Zb(e.emitsOptions,S)||(!(S in s)||E!==s[S])&&(s[S]=E,_=!0)}if(g){const S=ei(i),E=o||Fi;for(let I=0;I<g.length;I++){const P=g[I];i[P]=n2(d,S,P,E[P],e,!Tr(E,P))}}return _}function n2(e,t,i,s,d,g){const _=e[i];if(_!=null){const o=Tr(_,"default");if(o&&s===void 0){const S=_.default;if(_.type!==Function&&!_.skipFactory&&Qn(S)){const{propsDefaults:E}=d;if(i in E)s=E[i];else{const I=A_(d);s=E[i]=S.call(null,t),I()}}else s=S;d.ce&&d.ce._setProp(i,s)}_[0]&&(g&&!o?s=!1:_[1]&&(s===""||s===id(i))&&(s=!0))}return s}const N5=new WeakMap;function fR(e,t,i=!1){const s=i?N5:t.propsCache,d=s.get(e);if(d)return d;const g=e.props,_={},o=[];let S=!1;if(!Qn(e)){const I=P=>{S=!0;const[F,B]=fR(P,t,!0);da(_,F),B&&o.push(...B)};!i&&t.mixins.length&&t.mixins.forEach(I),e.extends&&I(e.extends),e.mixins&&e.mixins.forEach(I)}if(!g&&!S)return Vo(e)&&s.set(e,om),om;if(fn(g))for(let I=0;I<g.length;I++){const P=Ds(g[I]);QI(P)&&(_[P]=Fi)}else if(g)for(const I in g){const P=Ds(I);if(QI(P)){const F=g[I],B=_[P]=fn(F)||Qn(F)?{type:F}:da({},F),$=B.type;let z=!1,H=!0;if(fn($))for(let U=0;U<$.length;++U){const ie=$[U],Z=Qn(ie)&&ie.name;if(Z==="Boolean"){z=!0;break}else Z==="String"&&(H=!1)}else z=Qn($)&&$.name==="Boolean";B[0]=z,B[1]=H,(z||Tr(B,"default"))&&o.push(P)}}const E=[_,o];return Vo(e)&&s.set(e,E),E}function QI(e){return e[0]!=="$"&&!Fv(e)}const pR=e=>e[0]==="_"||e==="$stable",LS=e=>fn(e)?e.map(yu):[yu(e)],$5=(e,t,i)=>{if(t._n)return t;const s=at((...d)=>LS(t(...d)),i);return s._c=!1,s},mR=(e,t,i)=>{const s=e._ctx;for(const d in e){if(pR(d))continue;const g=e[d];if(Qn(g))t[d]=$5(d,g,s);else if(g!=null){const _=LS(g);t[d]=()=>_}}},gR=(e,t)=>{const i=LS(t);e.slots.default=()=>i},vR=(e,t,i)=>{for(const s in t)(i||s!=="_")&&(e[s]=t[s])},V5=(e,t,i)=>{const s=e.slots=uR();if(e.vnode.shapeFlag&32){const d=t._;d?(vR(s,t,i),i&&p3(s,"_",d,!0)):mR(t,s)}else t&&gR(e,t)},U5=(e,t,i)=>{const{vnode:s,slots:d}=e;let g=!0,_=Fi;if(s.shapeFlag&32){const o=t._;o?i&&o===1?g=!1:vR(d,t,i):(g=!t.$stable,mR(t,d)),_=t}else t&&(gR(e,t),_={default:1});if(g)for(const o in d)!pR(o)&&_[o]==null&&delete d[o]},Is=n6;function j5(e){return H5(e)}function H5(e,t){const i=Vb();i.__VUE__=!0;const{insert:s,remove:d,patchProp:g,createElement:_,createText:o,createComment:S,setText:E,setElementText:I,parentNode:P,nextSibling:F,setScopeId:B=jr,insertStaticContent:$}=e,z=(Ke,Be,Ht,Ut=null,Nt=null,Et=null,Gt=void 0,ln=null,yn=!!Be.dynamicChildren)=>{if(Ke===Be)return;Ke&&!xf(Ke,Be)&&(Ut=bt(Ke),ot(Ke,Nt,Et,!0),Ke=null),Be.patchFlag===-2&&(yn=!1,Be.dynamicChildren=null);const{type:_n,ref:jn,shapeFlag:yt}=Be;switch(_n){case zm:H(Ke,Be,Ht,Ut);break;case Sa:U(Ke,Be,Ht,Ut);break;case hw:Ke==null&&ie(Be,Ht,Ut,Gt);break;case eo:ye(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn);break;default:yt&1?Q(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn):yt&6?De(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn):(yt&64||yt&128)&&_n.process(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn,Re)}jn!=null&&Nt&&ub(jn,Ke&&Ke.ref,Et,Be||Ke,!Be)},H=(Ke,Be,Ht,Ut)=>{if(Ke==null)s(Be.el=o(Be.children),Ht,Ut);else{const Nt=Be.el=Ke.el;Be.children!==Ke.children&&E(Nt,Be.children)}},U=(Ke,Be,Ht,Ut)=>{Ke==null?s(Be.el=S(Be.children||""),Ht,Ut):Be.el=Ke.el},ie=(Ke,Be,Ht,Ut)=>{[Ke.el,Ke.anchor]=$(Ke.children,Be,Ht,Ut,Ke.el,Ke.anchor)},Z=({el:Ke,anchor:Be},Ht,Ut)=>{let Nt;for(;Ke&&Ke!==Be;)Nt=F(Ke),s(Ke,Ht,Ut),Ke=Nt;s(Be,Ht,Ut)},G=({el:Ke,anchor:Be})=>{let Ht;for(;Ke&&Ke!==Be;)Ht=F(Ke),d(Ke),Ke=Ht;d(Be)},Q=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn)=>{Be.type==="svg"?Gt="svg":Be.type==="math"&&(Gt="mathml"),Ke==null?oe(Be,Ht,Ut,Nt,Et,Gt,ln,yn):fe(Ke,Be,Nt,Et,Gt,ln,yn)},oe=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln)=>{let yn,_n;const{props:jn,shapeFlag:yt,transition:kn,dirs:qn}=Ke;if(yn=Ke.el=_(Ke.type,Et,jn&&jn.is,jn),yt&8?I(yn,Ke.children):yt&16&&me(Ke.children,yn,null,Ut,Nt,uw(Ke,Et),Gt,ln),qn&&mf(Ke,null,Ut,"created"),le(yn,Ke,Ke.scopeId,Gt,Ut),jn){for(const mo in jn)mo!=="value"&&!Fv(mo)&&g(yn,mo,null,jn[mo],Et,Ut);"value"in jn&&g(yn,"value",null,jn.value,Et),(_n=jn.onVnodeBeforeMount)&&gu(_n,Ut,Ke)}qn&&mf(Ke,null,Ut,"beforeMount");const Co=G5(Nt,kn);Co&&kn.beforeEnter(yn),s(yn,Be,Ht),((_n=jn&&jn.onVnodeMounted)||Co||qn)&&Is(()=>{_n&&gu(_n,Ut,Ke),Co&&kn.enter(yn),qn&&mf(Ke,null,Ut,"mounted")},Nt)},le=(Ke,Be,Ht,Ut,Nt)=>{if(Ht&&B(Ke,Ht),Ut)for(let Et=0;Et<Ut.length;Et++)B(Ke,Ut[Et]);if(Nt){let Et=Nt.subTree;if(Be===Et||xR(Et.type)&&(Et.ssContent===Be||Et.ssFallback===Be)){const Gt=Nt.vnode;le(Ke,Gt,Gt.scopeId,Gt.slotScopeIds,Nt.parent)}}},me=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn=0)=>{for(let _n=yn;_n<Ke.length;_n++){const jn=Ke[_n]=ln?ih(Ke[_n]):yu(Ke[_n]);z(null,jn,Be,Ht,Ut,Nt,Et,Gt,ln)}},fe=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{const ln=Be.el=Ke.el;let{patchFlag:yn,dynamicChildren:_n,dirs:jn}=Be;yn|=Ke.patchFlag&16;const yt=Ke.props||Fi,kn=Be.props||Fi;let qn;if(Ht&&gf(Ht,!1),(qn=kn.onVnodeBeforeUpdate)&&gu(qn,Ht,Be,Ke),jn&&mf(Be,Ke,Ht,"beforeUpdate"),Ht&&gf(Ht,!0),(yt.innerHTML&&kn.innerHTML==null||yt.textContent&&kn.textContent==null)&&I(ln,""),_n?ce(Ke.dynamicChildren,_n,ln,Ht,Ut,uw(Be,Nt),Et):Gt||Ce(Ke,Be,ln,null,Ht,Ut,uw(Be,Nt),Et,!1),yn>0){if(yn&16)pe(ln,yt,kn,Ht,Nt);else if(yn&2&&yt.class!==kn.class&&g(ln,"class",null,kn.class,Nt),yn&4&&g(ln,"style",yt.style,kn.style,Nt),yn&8){const Co=Be.dynamicProps;for(let mo=0;mo<Co.length;mo++){const Io=Co[mo],Ho=yt[Io],ur=kn[Io];(ur!==Ho||Io==="value")&&g(ln,Io,Ho,ur,Nt,Ht)}}yn&1&&Ke.children!==Be.children&&I(ln,Be.children)}else!Gt&&_n==null&&pe(ln,yt,kn,Ht,Nt);((qn=kn.onVnodeUpdated)||jn)&&Is(()=>{qn&&gu(qn,Ht,Be,Ke),jn&&mf(Be,Ke,Ht,"updated")},Ut)},ce=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{for(let ln=0;ln<Be.length;ln++){const yn=Ke[ln],_n=Be[ln],jn=yn.el&&(yn.type===eo||!xf(yn,_n)||yn.shapeFlag&70)?P(yn.el):Ht;z(yn,_n,jn,null,Ut,Nt,Et,Gt,!0)}},pe=(Ke,Be,Ht,Ut,Nt)=>{if(Be!==Ht){if(Be!==Fi)for(const Et in Be)!Fv(Et)&&!(Et in Ht)&&g(Ke,Et,Be[Et],null,Nt,Ut);for(const Et in Ht){if(Fv(Et))continue;const Gt=Ht[Et],ln=Be[Et];Gt!==ln&&Et!=="value"&&g(Ke,Et,ln,Gt,Nt,Ut)}"value"in Ht&&g(Ke,"value",Be.value,Ht.value,Nt)}},ye=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn)=>{const _n=Be.el=Ke?Ke.el:o(""),jn=Be.anchor=Ke?Ke.anchor:o("");let{patchFlag:yt,dynamicChildren:kn,slotScopeIds:qn}=Be;qn&&(ln=ln?ln.concat(qn):qn),Ke==null?(s(_n,Ht,Ut),s(jn,Ht,Ut),me(Be.children||[],Ht,jn,Nt,Et,Gt,ln,yn)):yt>0&&yt&64&&kn&&Ke.dynamicChildren?(ce(Ke.dynamicChildren,kn,Ht,Nt,Et,Gt,ln),(Be.key!=null||Nt&&Be===Nt.subTree)&&DS(Ke,Be,!0)):Ce(Ke,Be,Ht,jn,Nt,Et,Gt,ln,yn)},De=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn)=>{Be.slotScopeIds=ln,Ke==null?Be.shapeFlag&512?Nt.ctx.activate(Be,Ht,Ut,Gt,yn):tt(Be,Ht,Ut,Nt,Et,Gt,yn):Me(Ke,Be,yn)},tt=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{const ln=Ke.component=s6(Ke,Ut,Nt);if(Gb(Ke)&&(ln.ctx.renderer=Re),l6(ln,!1,Gt),ln.asyncDep){if(Nt&&Nt.registerDep(ln,xe,Gt),!Ke.el){const yn=ln.subTree=Qe(Sa);U(null,yn,Be,Ht)}}else xe(ln,Ke,Be,Ht,Nt,Et,Gt)},Me=(Ke,Be,Ht)=>{const Ut=Be.component=Ke.component;if(e6(Ke,Be,Ht))if(Ut.asyncDep&&!Ut.asyncResolved){Ae(Ut,Be,Ht);return}else Ut.next=Be,Ut.update();else Be.el=Ke.el,Ut.vnode=Be},xe=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{const ln=()=>{if(Ke.isMounted){let{next:yt,bu:kn,u:qn,parent:Co,vnode:mo}=Ke;{const En=_R(Ke);if(En){yt&&(yt.el=mo.el,Ae(Ke,yt,Gt)),En.asyncDep.then(()=>{Ke.isUnmounted||ln()});return}}let Io=yt,Ho;gf(Ke,!1),yt?(yt.el=mo.el,Ae(Ke,yt,Gt)):yt=mo,kn&&N0(kn),(Ho=yt.props&&yt.props.onVnodeBeforeUpdate)&&gu(Ho,Co,yt,mo),gf(Ke,!0);const ur=dw(Ke),Dt=Ke.subTree;Ke.subTree=ur,z(Dt,ur,P(Dt.el),bt(Dt),Ke,Nt,Et),yt.el=ur.el,Io===null&&t6(Ke,ur.el),qn&&Is(qn,Nt),(Ho=yt.props&&yt.props.onVnodeUpdated)&&Is(()=>gu(Ho,Co,yt,mo),Nt)}else{let yt;const{el:kn,props:qn}=Be,{bm:Co,m:mo,parent:Io,root:Ho,type:ur}=Ke,Dt=sm(Be);if(gf(Ke,!1),Co&&N0(Co),!Dt&&(yt=qn&&qn.onVnodeBeforeMount)&&gu(yt,Io,Be),gf(Ke,!0),kn&&At){const En=()=>{Ke.subTree=dw(Ke),At(kn,Ke.subTree,Ke,Nt,null)};Dt&&ur.__asyncHydrate?ur.__asyncHydrate(kn,Ke,En):En()}else{Ho.ce&&Ho.ce._injectChildStyle(ur);const En=Ke.subTree=dw(Ke);z(null,En,Ht,Ut,Ke,Nt,Et),Be.el=En.el}if(mo&&Is(mo,Nt),!Dt&&(yt=qn&&qn.onVnodeMounted)){const En=Be;Is(()=>gu(yt,Io,En),Nt)}(Be.shapeFlag&256||Io&&sm(Io.vnode)&&Io.vnode.shapeFlag&256)&&Ke.a&&Is(Ke.a,Nt),Ke.isMounted=!0,Be=Ht=Ut=null}};Ke.scope.on();const yn=Ke.effect=new w3(ln);Ke.scope.off();const _n=Ke.update=yn.run.bind(yn),jn=Ke.job=yn.runIfDirty.bind(yn);jn.i=Ke,jn.id=Ke.uid,yn.scheduler=()=>IS(jn),gf(Ke,!0),_n()},Ae=(Ke,Be,Ht)=>{Be.component=Ke;const Ut=Ke.vnode.props;Ke.vnode=Be,Ke.next=null,B5(Ke,Be.props,Ut,Ht),U5(Ke,Be.children,Ht),Th(),jI(Ke),Ch()},Ce=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn=!1)=>{const _n=Ke&&Ke.children,jn=Ke?Ke.shapeFlag:0,yt=Be.children,{patchFlag:kn,shapeFlag:qn}=Be;if(kn>0){if(kn&128){Ne(_n,yt,Ht,Ut,Nt,Et,Gt,ln,yn);return}else if(kn&256){ge(_n,yt,Ht,Ut,Nt,Et,Gt,ln,yn);return}}qn&8?(jn&16&&zt(_n,Nt,Et),yt!==_n&&I(Ht,yt)):jn&16?qn&16?Ne(_n,yt,Ht,Ut,Nt,Et,Gt,ln,yn):zt(_n,Nt,Et,!0):(jn&8&&I(Ht,""),qn&16&&me(yt,Ht,Ut,Nt,Et,Gt,ln,yn))},ge=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn)=>{Ke=Ke||om,Be=Be||om;const _n=Ke.length,jn=Be.length,yt=Math.min(_n,jn);let kn;for(kn=0;kn<yt;kn++){const qn=Be[kn]=yn?ih(Be[kn]):yu(Be[kn]);z(Ke[kn],qn,Ht,null,Nt,Et,Gt,ln,yn)}_n>jn?zt(Ke,Nt,Et,!0,!1,yt):me(Be,Ht,Ut,Nt,Et,Gt,ln,yn,yt)},Ne=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,yn)=>{let _n=0;const jn=Be.length;let yt=Ke.length-1,kn=jn-1;for(;_n<=yt&&_n<=kn;){const qn=Ke[_n],Co=Be[_n]=yn?ih(Be[_n]):yu(Be[_n]);if(xf(qn,Co))z(qn,Co,Ht,null,Nt,Et,Gt,ln,yn);else break;_n++}for(;_n<=yt&&_n<=kn;){const qn=Ke[yt],Co=Be[kn]=yn?ih(Be[kn]):yu(Be[kn]);if(xf(qn,Co))z(qn,Co,Ht,null,Nt,Et,Gt,ln,yn);else break;yt--,kn--}if(_n>yt){if(_n<=kn){const qn=kn+1,Co=qn<jn?Be[qn].el:Ut;for(;_n<=kn;)z(null,Be[_n]=yn?ih(Be[_n]):yu(Be[_n]),Ht,Co,Nt,Et,Gt,ln,yn),_n++}}else if(_n>kn)for(;_n<=yt;)ot(Ke[_n],Nt,Et,!0),_n++;else{const qn=_n,Co=_n,mo=new Map;for(_n=Co;_n<=kn;_n++){const Je=Be[_n]=yn?ih(Be[_n]):yu(Be[_n]);Je.key!=null&&mo.set(Je.key,_n)}let Io,Ho=0;const ur=kn-Co+1;let Dt=!1,En=0;const ft=new Array(ur);for(_n=0;_n<ur;_n++)ft[_n]=0;for(_n=qn;_n<=yt;_n++){const Je=Ke[_n];if(Ho>=ur){ot(Je,Nt,Et,!0);continue}let Mn;if(Je.key!=null)Mn=mo.get(Je.key);else for(Io=Co;Io<=kn;Io++)if(ft[Io-Co]===0&&xf(Je,Be[Io])){Mn=Io;break}Mn===void 0?ot(Je,Nt,Et,!0):(ft[Mn-Co]=_n+1,Mn>=En?En=Mn:Dt=!0,z(Je,Be[Mn],Ht,null,Nt,Et,Gt,ln,yn),Ho++)}const un=Dt?W5(ft):om;for(Io=un.length-1,_n=ur-1;_n>=0;_n--){const Je=Co+_n,Mn=Be[Je],Bn=Je+1<jn?Be[Je+1].el:Ut;ft[_n]===0?z(null,Mn,Ht,Bn,Nt,Et,Gt,ln,yn):Dt&&(Io<0||_n!==un[Io]?We(Mn,Ht,Bn,2):Io--)}}},We=(Ke,Be,Ht,Ut,Nt=null)=>{const{el:Et,type:Gt,transition:ln,children:yn,shapeFlag:_n}=Ke;if(_n&6){We(Ke.component.subTree,Be,Ht,Ut);return}if(_n&128){Ke.suspense.move(Be,Ht,Ut);return}if(_n&64){Gt.move(Ke,Be,Ht,Re);return}if(Gt===eo){s(Et,Be,Ht);for(let yt=0;yt<yn.length;yt++)We(yn[yt],Be,Ht,Ut);s(Ke.anchor,Be,Ht);return}if(Gt===hw){Z(Ke,Be,Ht);return}if(Ut!==2&&_n&1&&ln)if(Ut===0)ln.beforeEnter(Et),s(Et,Be,Ht),Is(()=>ln.enter(Et),Nt);else{const{leave:yt,delayLeave:kn,afterLeave:qn}=ln,Co=()=>s(Et,Be,Ht),mo=()=>{yt(Et,()=>{Co(),qn&&qn()})};kn?kn(Et,Co,mo):mo()}else s(Et,Be,Ht)},ot=(Ke,Be,Ht,Ut=!1,Nt=!1)=>{const{type:Et,props:Gt,ref:ln,children:yn,dynamicChildren:_n,shapeFlag:jn,patchFlag:yt,dirs:kn,cacheIndex:qn}=Ke;if(yt===-2&&(Nt=!1),ln!=null&&ub(ln,null,Ht,Ke,!0),qn!=null&&(Be.renderCache[qn]=void 0),jn&256){Be.ctx.deactivate(Ke);return}const Co=jn&1&&kn,mo=!sm(Ke);let Io;if(mo&&(Io=Gt&&Gt.onVnodeBeforeUnmount)&&gu(Io,Be,Ke),jn&6)Mt(Ke.component,Ht,Ut);else{if(jn&128){Ke.suspense.unmount(Ht,Ut);return}Co&&mf(Ke,null,Be,"beforeUnmount"),jn&64?Ke.type.remove(Ke,Be,Ht,Re,Ut):_n&&!_n.hasOnce&&(Et!==eo||yt>0&&yt&64)?zt(_n,Be,Ht,!1,!0):(Et===eo&&yt&384||!Nt&&jn&16)&&zt(yn,Be,Ht),Ut&&Oe(Ke)}(mo&&(Io=Gt&&Gt.onVnodeUnmounted)||Co)&&Is(()=>{Io&&gu(Io,Be,Ke),Co&&mf(Ke,null,Be,"unmounted")},Ht)},Oe=Ke=>{const{type:Be,el:Ht,anchor:Ut,transition:Nt}=Ke;if(Be===eo){Ct(Ht,Ut);return}if(Be===hw){G(Ke);return}const Et=()=>{d(Ht),Nt&&!Nt.persisted&&Nt.afterLeave&&Nt.afterLeave()};if(Ke.shapeFlag&1&&Nt&&!Nt.persisted){const{leave:Gt,delayLeave:ln}=Nt,yn=()=>Gt(Ht,Et);ln?ln(Ke.el,Et,yn):yn()}else Et()},Ct=(Ke,Be)=>{let Ht;for(;Ke!==Be;)Ht=F(Ke),d(Ke),Ke=Ht;d(Be)},Mt=(Ke,Be,Ht)=>{const{bum:Ut,scope:Nt,job:Et,subTree:Gt,um:ln,m:yn,a:_n}=Ke;eA(yn),eA(_n),Ut&&N0(Ut),Nt.stop(),Et&&(Et.flags|=8,ot(Gt,Ke,Be,Ht)),ln&&Is(ln,Be),Is(()=>{Ke.isUnmounted=!0},Be),Be&&Be.pendingBranch&&!Be.isUnmounted&&Ke.asyncDep&&!Ke.asyncResolved&&Ke.suspenseId===Be.pendingId&&(Be.deps--,Be.deps===0&&Be.resolve())},zt=(Ke,Be,Ht,Ut=!1,Nt=!1,Et=0)=>{for(let Gt=Et;Gt<Ke.length;Gt++)ot(Ke[Gt],Be,Ht,Ut,Nt)},bt=Ke=>{if(Ke.shapeFlag&6)return bt(Ke.component.subTree);if(Ke.shapeFlag&128)return Ke.suspense.next();const Be=F(Ke.anchor||Ke.el),Ht=Be&&Be[G3];return Ht?F(Ht):Be};let Kt=!1;const $t=(Ke,Be,Ht)=>{Ke==null?Be._vnode&&ot(Be._vnode,null,null,!0):z(Be._vnode||null,Ke,Be,null,null,null,Ht),Be._vnode=Ke,Kt||(Kt=!0,jI(),U3(),Kt=!1)},Re={p:z,um:ot,m:We,r:Oe,mt:tt,mc:me,pc:Ce,pbc:ce,n:bt,o:e};let dn,At;return{render:$t,hydrate:dn,createApp:z5($t,dn)}}function uw({type:e,props:t},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:i}function gf({effect:e,job:t},i){i?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function G5(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function DS(e,t,i=!1){const s=e.children,d=t.children;if(fn(s)&&fn(d))for(let g=0;g<s.length;g++){const _=s[g];let o=d[g];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=d[g]=ih(d[g]),o.el=_.el),!i&&o.patchFlag!==-2&&DS(_,o)),o.type===zm&&(o.el=_.el)}}function W5(e){const t=e.slice(),i=[0];let s,d,g,_,o;const S=e.length;for(s=0;s<S;s++){const E=e[s];if(E!==0){if(d=i[i.length-1],e[d]<E){t[s]=d,i.push(s);continue}for(g=0,_=i.length-1;g<_;)o=g+_>>1,e[i[o]]<E?g=o+1:_=o;E<e[i[g]]&&(g>0&&(t[s]=i[g-1]),i[g]=s)}}for(g=i.length,_=i[g-1];g-- >0;)i[g]=_,_=t[_];return i}function _R(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:_R(t)}function eA(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const q5=Symbol.for("v-scx"),K5=()=>Un(q5);function Ha(e,t){return zS(e,null,t)}function tn(e,t,i){return zS(e,t,i)}function zS(e,t,i=Fi){const{immediate:s,deep:d,flush:g,once:_}=i,o=da({},i),S=t&&s||!t&&g!=="post";let E;if(r_){if(g==="sync"){const B=K5();E=B.__watcherHandles||(B.__watcherHandles=[])}else if(!S){const B=()=>{};return B.stop=jr,B.resume=jr,B.pause=jr,B}}const I=ja;o.call=(B,$,z)=>qc(B,I,$,z);let P=!1;g==="post"?o.scheduler=B=>{Is(B,I&&I.suspense)}:g!=="sync"&&(P=!0,o.scheduler=(B,$)=>{$?B():IS(B)}),o.augmentJob=B=>{t&&(B.flags|=4),P&&(B.flags|=2,I&&(B.id=I.uid,B.i=I))};const F=p5(e,t,o);return r_&&(E?E.push(F):S&&F()),F}function Z5(e,t,i){const s=this.proxy,d=Zn(e)?e.includes(".")?yR(s,e):()=>s[e]:e.bind(s,s);let g;Qn(t)?g=t:(g=t.handler,i=t);const _=A_(this),o=zS(d,g.bind(s),i);return _(),o}function yR(e,t){const i=t.split(".");return()=>{let s=e;for(let d=0;d<i.length&&s;d++)s=s[i[d]];return s}}const Y5=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Ds(t)}Modifiers`]||e[`${id(t)}Modifiers`];function X5(e,t,...i){if(e.isUnmounted)return;const s=e.vnode.props||Fi;let d=i;const g=t.startsWith("update:"),_=g&&Y5(s,t.slice(7));_&&(_.trim&&(d=i.map(I=>Zn(I)?I.trim():I)),_.number&&(d=i.map(qw)));let o,S=s[o=Bv(t)]||s[o=Bv(Ds(t))];!S&&g&&(S=s[o=Bv(id(t))]),S&&qc(S,e,6,d);const E=s[o+"Once"];if(E){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,qc(E,e,6,d)}}function bR(e,t,i=!1){const s=t.emitsCache,d=s.get(e);if(d!==void 0)return d;const g=e.emits;let _={},o=!1;if(!Qn(e)){const S=E=>{const I=bR(E,t,!0);I&&(o=!0,da(_,I))};!i&&t.mixins.length&&t.mixins.forEach(S),e.extends&&S(e.extends),e.mixins&&e.mixins.forEach(S)}return!g&&!o?(Vo(e)&&s.set(e,null),null):(fn(g)?g.forEach(S=>_[S]=null):da(_,g),Vo(e)&&s.set(e,_),_)}function Zb(e,t){return!e||!Bb(t)?!1:(t=t.slice(2).replace(/Once$/,""),Tr(e,t[0].toLowerCase()+t.slice(1))||Tr(e,id(t))||Tr(e,t))}function dw(e){const{type:t,vnode:i,proxy:s,withProxy:d,propsOptions:[g],slots:_,attrs:o,emit:S,render:E,renderCache:I,props:P,data:F,setupState:B,ctx:$,inheritAttrs:z}=e,H=cb(e);let U,ie;try{if(i.shapeFlag&4){const G=d||s,Q=G;U=yu(E.call(Q,G,I,P,B,F,$)),ie=o}else{const G=t;U=yu(G.length>1?G(P,{attrs:o,slots:_,emit:S}):G(P,null)),ie=t.props?o:J5(o)}}catch(G){jv.length=0,Hb(G,e,1),U=Qe(Sa)}let Z=U;if(ie&&z!==!1){const G=Object.keys(ie),{shapeFlag:Q}=Z;G.length&&Q&7&&(g&&G.some(yS)&&(ie=Q5(ie,g)),Z=td(Z,ie,!1,!0))}return i.dirs&&(Z=td(Z,null,!1,!0),Z.dirs=Z.dirs?Z.dirs.concat(i.dirs):i.dirs),i.transition&&zf(Z,i.transition),U=Z,cb(H),U}const J5=e=>{let t;for(const i in e)(i==="class"||i==="style"||Bb(i))&&((t||(t={}))[i]=e[i]);return t},Q5=(e,t)=>{const i={};for(const s in e)(!yS(s)||!(s.slice(9)in t))&&(i[s]=e[s]);return i};function e6(e,t,i){const{props:s,children:d,component:g}=e,{props:_,children:o,patchFlag:S}=t,E=g.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&S>=0){if(S&1024)return!0;if(S&16)return s?tA(s,_,E):!!_;if(S&8){const I=t.dynamicProps;for(let P=0;P<I.length;P++){const F=I[P];if(_[F]!==s[F]&&!Zb(E,F))return!0}}}else return(d||o)&&(!o||!o.$stable)?!0:s===_?!1:s?_?tA(s,_,E):!0:!!_;return!1}function tA(e,t,i){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let d=0;d<s.length;d++){const g=s[d];if(t[g]!==e[g]&&!Zb(i,g))return!0}return!1}function t6({vnode:e,parent:t},i){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=i,t=t.parent;else break}}const xR=e=>e.__isSuspense;function n6(e,t){t&&t.pendingBranch?fn(e)?t.effects.push(...e):t.effects.push(e):v5(e)}const eo=Symbol.for("v-fgt"),zm=Symbol.for("v-txt"),Sa=Symbol.for("v-cmt"),hw=Symbol.for("v-stc"),jv=[];let bl=null;function se(e=!1){jv.push(bl=e?null:[])}function o6(){jv.pop(),bl=jv[jv.length-1]||null}let o_=1;function nA(e,t=!1){o_+=e,e<0&&bl&&t&&(bl.hasOnce=!0)}function wR(e){return e.dynamicChildren=o_>0?bl||om:null,o6(),o_>0&&bl&&bl.push(e),e}function Pe(e,t,i,s,d,g){return wR(He(e,t,i,s,d,g,!0))}function Rt(e,t,i,s,d){return wR(Qe(e,t,i,s,d,!0))}function Ai(e){return e?e.__v_isVNode===!0:!1}function xf(e,t){return e.type===t.type&&e.key===t.key}const SR=({key:e})=>e??null,V0=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Zn(e)||vi(e)||Qn(e)?{i:Ra,r:e,k:t,f:!!i}:e:null);function He(e,t=null,i=null,s=0,d=null,g=e===eo?0:1,_=!1,o=!1){const S={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&SR(t),ref:t&&V0(t),scopeId:H3,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:s,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:Ra};return o?(FS(S,i),g&128&&e.normalize(S)):i&&(S.shapeFlag|=Zn(i)?8:16),o_>0&&!_&&bl&&(S.patchFlag>0||g&6)&&S.patchFlag!==32&&bl.push(S),S}const Qe=r6;function r6(e,t=null,i=null,s=0,d=null,g=!1){if((!e||e===rR)&&(e=Sa),Ai(e)){const o=td(e,t,!0);return i&&FS(o,i),o_>0&&!g&&bl&&(o.shapeFlag&6?bl[bl.indexOf(e)]=o:bl.push(o)),o.patchFlag=-2,o}if(h6(e)&&(e=e.__vccOpts),t){t=mh(t);let{class:o,style:S}=t;o&&!Zn(o)&&(t.class=de(o)),Vo(S)&&(MS(S)&&!fn(S)&&(S=da({},S)),t.style=to(S))}const _=Zn(e)?1:xR(e)?128:W3(e)?64:Vo(e)?4:Qn(e)?2:0;return He(e,t,i,s,d,_,g,!0)}function mh(e){return e?MS(e)||dR(e)?da({},e):e:null}function td(e,t,i=!1,s=!1){const{props:d,ref:g,patchFlag:_,children:o,transition:S}=e,E=t?Yo(d||{},t):d,I={__v_isVNode:!0,__v_skip:!0,type:e.type,props:E,key:E&&SR(E),ref:t&&t.ref?i&&g?fn(g)?g.concat(V0(t)):[g,V0(t)]:V0(t):g,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==eo?_===-1?16:_|16:_,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:S,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&td(e.ssContent),ssFallback:e.ssFallback&&td(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return S&&s&&zf(I,S.clone(I)),I}function nr(e=" ",t=0){return Qe(zm,null,e,t)}function St(e="",t=!1){return t?(se(),Rt(Sa,null,e)):Qe(Sa,null,e)}function yu(e){return e==null||typeof e=="boolean"?Qe(Sa):fn(e)?Qe(eo,null,e.slice()):Ai(e)?ih(e):Qe(zm,null,String(e))}function ih(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:td(e)}function FS(e,t){let i=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(fn(t))i=16;else if(typeof t=="object")if(s&65){const d=t.default;d&&(d._c&&(d._d=!1),FS(e,d()),d._c&&(d._d=!0));return}else{i=32;const d=t._;!d&&!dR(t)?t._ctx=Ra:d===3&&Ra&&(Ra.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Qn(t)?(t={default:t,_ctx:Ra},i=32):(t=String(t),s&64?(i=16,t=[nr(t)]):i=8);e.children=t,e.shapeFlag|=i}function Yo(...e){const t={};for(let i=0;i<e.length;i++){const s=e[i];for(const d in s)if(d==="class")t.class!==s.class&&(t.class=de([t.class,s.class]));else if(d==="style")t.style=to([t.style,s.style]);else if(Bb(d)){const g=t[d],_=s[d];_&&g!==_&&!(fn(g)&&g.includes(_))&&(t[d]=g?[].concat(g,_):_)}else d!==""&&(t[d]=s[d])}return t}function gu(e,t,i,s=null){qc(e,t,7,[i,s])}const i6=lR();let a6=0;function s6(e,t,i){const s=e.type,d=(t?t.appContext:e.appContext)||i6,g={uid:a6++,vnode:e,type:s,parent:t,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new y3(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(d.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:fR(s,d),emitsOptions:bR(s,d),emit:null,emitted:null,propsDefaults:Fi,inheritAttrs:s.inheritAttrs,ctx:Fi,data:Fi,props:Fi,attrs:Fi,slots:Fi,refs:Fi,setupState:Fi,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=t?t.root:g,g.emit=X5.bind(null,g),e.ce&&e.ce(g),g}let ja=null;const jo=()=>ja||Ra;let hb,o2;{const e=Vb(),t=(i,s)=>{let d;return(d=e[i])||(d=e[i]=[]),d.push(s),g=>{d.length>1?d.forEach(_=>_(g)):d[0](g)}};hb=t("__VUE_INSTANCE_SETTERS__",i=>ja=i),o2=t("__VUE_SSR_SETTERS__",i=>r_=i)}const A_=e=>{const t=ja;return hb(e),e.scope.on(),()=>{e.scope.off(),hb(t)}},oA=()=>{ja&&ja.scope.off(),hb(null)};function TR(e){return e.vnode.shapeFlag&4}let r_=!1;function l6(e,t=!1,i=!1){t&&o2(t);const{props:s,children:d}=e.vnode,g=TR(e);F5(e,s,g,t),V5(e,d,i);const _=g?c6(e,t):void 0;return t&&o2(!1),_}function c6(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,A5);const{setup:s}=i;if(s){Th();const d=e.setupContext=s.length>1?ER(e):null,g=A_(e),_=I_(s,e,0,[e.props,d]),o=Xv(_);if(Ch(),g(),(o||e.sp)&&!sm(e)&&eR(e),o){if(_.then(oA,oA),t)return _.then(S=>{rA(e,S,t)}).catch(S=>{Hb(S,e,0)});e.asyncDep=_}else rA(e,_,t)}else CR(e,t)}function rA(e,t,i){Qn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Vo(t)&&(e.setupState=B3(t)),CR(e,i)}let iA;function CR(e,t,i){const s=e.type;if(!e.render){if(!t&&iA&&!s.render){const d=s.template||OS(e).template;if(d){const{isCustomElement:g,compilerOptions:_}=e.appContext.config,{delimiters:o,compilerOptions:S}=s,E=da(da({isCustomElement:g,delimiters:o},_),S);s.render=iA(d,E)}}e.render=s.render||jr}{const d=A_(e);Th();try{k5(e)}finally{Ch(),d()}}}const u6={get(e,t){return ls(e,"get",""),e[t]}};function ER(e){const t=i=>{e.exposed=i||{}};return{attrs:new Proxy(e.attrs,u6),slots:e.slots,emit:e.emit,expose:t}}function Yb(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(B3(uh(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in Uv)return Uv[i](e)},has(t,i){return i in t||i in Uv}})):e.proxy}function d6(e,t=!0){return Qn(e)?e.displayName||e.name:e.name||t&&e.__name}function h6(e){return Qn(e)&&"__vccOpts"in e}const te=(e,t)=>h5(e,t,r_);function lo(e,t,i){const s=arguments.length;return s===2?Vo(t)&&!fn(t)?Ai(t)?Qe(e,null,[t]):Qe(e,t):Qe(e,null,t):(s>3?i=Array.prototype.slice.call(arguments,2):s===3&&Ai(i)&&(i=[i]),Qe(e,t,i))}const f6="3.5.13",p6=jr;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let r2;const aA=typeof window<"u"&&window.trustedTypes;if(aA)try{r2=aA.createPolicy("vue",{createHTML:e=>e})}catch{}const MR=r2?e=>r2.createHTML(e):e=>e,m6="http://www.w3.org/2000/svg",g6="http://www.w3.org/1998/Math/MathML",Ku=typeof document<"u"?document:null,sA=Ku&&Ku.createElement("template"),v6={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,s)=>{const d=t==="svg"?Ku.createElementNS(m6,e):t==="mathml"?Ku.createElementNS(g6,e):i?Ku.createElement(e,{is:i}):Ku.createElement(e);return e==="select"&&s&&s.multiple!=null&&d.setAttribute("multiple",s.multiple),d},createText:e=>Ku.createTextNode(e),createComment:e=>Ku.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ku.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,s,d,g){const _=i?i.previousSibling:t.lastChild;if(d&&(d===g||d.nextSibling))for(;t.insertBefore(d.cloneNode(!0),i),!(d===g||!(d=d.nextSibling)););else{sA.innerHTML=MR(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const o=sA.content;if(s==="svg"||s==="mathml"){const S=o.firstChild;for(;S.firstChild;)o.appendChild(S.firstChild);o.removeChild(S)}t.insertBefore(o,i)}return[_?_.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}},Xd="transition",Ev="animation",gm=Symbol("_vtc"),IR={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},AR=da({},Y3,IR),_6=e=>(e.displayName="Transition",e.props=AR,e),Ea=_6((e,{slots:t})=>lo(x5,kR(e),t)),vf=(e,t=[])=>{fn(e)?e.forEach(i=>i(...t)):e&&e(...t)},lA=e=>e?fn(e)?e.some(t=>t.length>1):e.length>1:!1;function kR(e){const t={};for(const ye in e)ye in IR||(t[ye]=e[ye]);if(e.css===!1)return t;const{name:i="v",type:s,duration:d,enterFromClass:g=`${i}-enter-from`,enterActiveClass:_=`${i}-enter-active`,enterToClass:o=`${i}-enter-to`,appearFromClass:S=g,appearActiveClass:E=_,appearToClass:I=o,leaveFromClass:P=`${i}-leave-from`,leaveActiveClass:F=`${i}-leave-active`,leaveToClass:B=`${i}-leave-to`}=e,$=y6(d),z=$&&$[0],H=$&&$[1],{onBeforeEnter:U,onEnter:ie,onEnterCancelled:Z,onLeave:G,onLeaveCancelled:Q,onBeforeAppear:oe=U,onAppear:le=ie,onAppearCancelled:me=Z}=t,fe=(ye,De,tt,Me)=>{ye._enterCancelled=Me,Qd(ye,De?I:o),Qd(ye,De?E:_),tt&&tt()},ce=(ye,De)=>{ye._isLeaving=!1,Qd(ye,P),Qd(ye,B),Qd(ye,F),De&&De()},pe=ye=>(De,tt)=>{const Me=ye?le:ie,xe=()=>fe(De,ye,tt);vf(Me,[De,xe]),cA(()=>{Qd(De,ye?S:g),vu(De,ye?I:o),lA(Me)||uA(De,s,z,xe)})};return da(t,{onBeforeEnter(ye){vf(U,[ye]),vu(ye,g),vu(ye,_)},onBeforeAppear(ye){vf(oe,[ye]),vu(ye,S),vu(ye,E)},onEnter:pe(!1),onAppear:pe(!0),onLeave(ye,De){ye._isLeaving=!0;const tt=()=>ce(ye,De);vu(ye,P),ye._enterCancelled?(vu(ye,F),i2()):(i2(),vu(ye,F)),cA(()=>{ye._isLeaving&&(Qd(ye,P),vu(ye,B),lA(G)||uA(ye,s,H,tt))}),vf(G,[ye,tt])},onEnterCancelled(ye){fe(ye,!1,void 0,!0),vf(Z,[ye])},onAppearCancelled(ye){fe(ye,!0,void 0,!0),vf(me,[ye])},onLeaveCancelled(ye){ce(ye),vf(Q,[ye])}})}function y6(e){if(e==null)return null;if(Vo(e))return[fw(e.enter),fw(e.leave)];{const t=fw(e);return[t,t]}}function fw(e){return PN(e)}function vu(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e[gm]||(e[gm]=new Set)).add(t)}function Qd(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.remove(s));const i=e[gm];i&&(i.delete(t),i.size||(e[gm]=void 0))}function cA(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let b6=0;function uA(e,t,i,s){const d=e._endId=++b6,g=()=>{d===e._endId&&s()};if(i!=null)return setTimeout(g,i);const{type:_,timeout:o,propCount:S}=PR(e,t);if(!_)return s();const E=_+"end";let I=0;const P=()=>{e.removeEventListener(E,F),g()},F=B=>{B.target===e&&++I>=S&&P()};setTimeout(()=>{I<S&&P()},o+1),e.addEventListener(E,F)}function PR(e,t){const i=window.getComputedStyle(e),s=$=>(i[$]||"").split(", "),d=s(`${Xd}Delay`),g=s(`${Xd}Duration`),_=dA(d,g),o=s(`${Ev}Delay`),S=s(`${Ev}Duration`),E=dA(o,S);let I=null,P=0,F=0;t===Xd?_>0&&(I=Xd,P=_,F=g.length):t===Ev?E>0&&(I=Ev,P=E,F=S.length):(P=Math.max(_,E),I=P>0?_>E?Xd:Ev:null,F=I?I===Xd?g.length:S.length:0);const B=I===Xd&&/\b(transform|all)(,|$)/.test(s(`${Xd}Property`).toString());return{type:I,timeout:P,propCount:F,hasTransform:B}}function dA(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,s)=>hA(i)+hA(e[s])))}function hA(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function i2(){return document.body.offsetHeight}function x6(e,t,i){const s=e[gm];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}const fb=Symbol("_vod"),RR=Symbol("_vsh"),Cr={beforeMount(e,{value:t},{transition:i}){e[fb]=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):Mv(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:s}){!t!=!i&&(s?t?(s.beforeEnter(e),Mv(e,!0),s.enter(e)):s.leave(e,()=>{Mv(e,!1)}):Mv(e,t))},beforeUnmount(e,{value:t}){Mv(e,t)}};function Mv(e,t){e.style.display=t?e[fb]:"none",e[RR]=!t}const w6=Symbol(""),S6=/(^|;)\s*display\s*:/;function T6(e,t,i){const s=e.style,d=Zn(i);let g=!1;if(i&&!d){if(t)if(Zn(t))for(const _ of t.split(";")){const o=_.slice(0,_.indexOf(":")).trim();i[o]==null&&U0(s,o,"")}else for(const _ in t)i[_]==null&&U0(s,_,"");for(const _ in i)_==="display"&&(g=!0),U0(s,_,i[_])}else if(d){if(t!==i){const _=s[w6];_&&(i+=";"+_),s.cssText=i,g=S6.test(i)}}else t&&e.removeAttribute("style");fb in e&&(e[fb]=g?s.display:"",e[RR]&&(s.display="none"))}const fA=/\s*!important$/;function U0(e,t,i){if(fn(i))i.forEach(s=>U0(e,t,s));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const s=C6(e,t);fA.test(i)?e.setProperty(id(s),i.replace(fA,""),"important"):e[s]=i}}const pA=["Webkit","Moz","ms"],pw={};function C6(e,t){const i=pw[t];if(i)return i;let s=Ds(t);if(s!=="filter"&&s in e)return pw[t]=s;s=M_(s);for(let d=0;d<pA.length;d++){const g=pA[d]+s;if(g in e)return pw[t]=g}return t}const mA="http://www.w3.org/1999/xlink";function gA(e,t,i,s,d,g=FN(t)){s&&t.startsWith("xlink:")?i==null?e.removeAttributeNS(mA,t.slice(6,t.length)):e.setAttributeNS(mA,t,i):i==null||g&&!m3(i)?e.removeAttribute(t):e.setAttribute(t,g?"":Wc(i)?String(i):i)}function vA(e,t,i,s,d){if(t==="innerHTML"||t==="textContent"){i!=null&&(e[t]=t==="innerHTML"?MR(i):i);return}const g=e.tagName;if(t==="value"&&g!=="PROGRESS"&&!g.includes("-")){const o=g==="OPTION"?e.getAttribute("value")||"":e.value,S=i==null?e.type==="checkbox"?"on":"":String(i);(o!==S||!("_value"in e))&&(e.value=S),i==null&&e.removeAttribute(t),e._value=i;return}let _=!1;if(i===""||i==null){const o=typeof e[t];o==="boolean"?i=m3(i):i==null&&o==="string"?(i="",_=!0):o==="number"&&(i=0,_=!0)}try{e[t]=i}catch{}_&&e.removeAttribute(d||t)}function ah(e,t,i,s){e.addEventListener(t,i,s)}function E6(e,t,i,s){e.removeEventListener(t,i,s)}const _A=Symbol("_vei");function M6(e,t,i,s,d=null){const g=e[_A]||(e[_A]={}),_=g[t];if(s&&_)_.value=s;else{const[o,S]=I6(t);if(s){const E=g[t]=P6(s,d);ah(e,o,E,S)}else _&&(E6(e,o,_,S),g[t]=void 0)}}const yA=/(?:Once|Passive|Capture)$/;function I6(e){let t;if(yA.test(e)){t={};let s;for(;s=e.match(yA);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):id(e.slice(2)),t]}let mw=0;const A6=Promise.resolve(),k6=()=>mw||(A6.then(()=>mw=0),mw=Date.now());function P6(e,t){const i=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=i.attached)return;qc(R6(s,i.value),t,5,[s])};return i.value=e,i.attached=k6(),i}function R6(e,t){if(fn(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(s=>d=>!d._stopped&&s&&s(d))}else return t}const bA=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,O6=(e,t,i,s,d,g)=>{const _=d==="svg";t==="class"?x6(e,s,_):t==="style"?T6(e,i,s):Bb(t)?yS(t)||M6(e,t,i,s,g):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):L6(e,t,s,_))?(vA(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&gA(e,t,s,_,g,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Zn(s))?vA(e,Ds(t),s,g,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),gA(e,t,s,_))};function L6(e,t,i,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&bA(t)&&Qn(i));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const d=e.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return bA(t)&&Zn(i)?!1:t in e}const OR=new WeakMap,LR=new WeakMap,pb=Symbol("_moveCb"),xA=Symbol("_enterCb"),D6=e=>(delete e.props.mode,e),z6=D6({name:"TransitionGroup",props:da({},AR,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=jo(),s=Z3();let d,g;return Au(()=>{if(!d.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!$6(d[0].el,i.vnode.el,_))return;d.forEach(F6),d.forEach(B6);const o=d.filter(N6);i2(),o.forEach(S=>{const E=S.el,I=E.style;vu(E,_),I.transform=I.webkitTransform=I.transitionDuration="";const P=E[pb]=F=>{F&&F.target!==E||(!F||/transform$/.test(F.propertyName))&&(E.removeEventListener("transitionend",P),E[pb]=null,Qd(E,_))};E.addEventListener("transitionend",P)})}),()=>{const _=ei(e),o=kR(_);let S=_.tag||eo;if(d=[],g)for(let E=0;E<g.length;E++){const I=g[E];I.el&&I.el instanceof Element&&(d.push(I),zf(I,n_(I,o,s,i)),OR.set(I,I.el.getBoundingClientRect()))}g=t.default?AS(t.default()):[];for(let E=0;E<g.length;E++){const I=g[E];I.key!=null&&zf(I,n_(I,o,s,i))}return Qe(S,null,g)}}}),DR=z6;function F6(e){const t=e.el;t[pb]&&t[pb](),t[xA]&&t[xA]()}function B6(e){LR.set(e,e.el.getBoundingClientRect())}function N6(e){const t=OR.get(e),i=LR.get(e),s=t.left-i.left,d=t.top-i.top;if(s||d){const g=e.el.style;return g.transform=g.webkitTransform=`translate(${s}px,${d}px)`,g.transitionDuration="0s",e}}function $6(e,t,i){const s=e.cloneNode(),d=e[gm];d&&d.forEach(o=>{o.split(/\s+/).forEach(S=>S&&s.classList.remove(S))}),i.split(/\s+/).forEach(o=>o&&s.classList.add(o)),s.style.display="none";const g=t.nodeType===1?t:t.parentNode;g.appendChild(s);const{hasTransform:_}=PR(s);return g.removeChild(s),_}const vm=e=>{const t=e.props["onUpdate:modelValue"]||!1;return fn(t)?i=>N0(t,i):t};function V6(e){e.target.composing=!0}function wA(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ed=Symbol("_assign"),Xb={created(e,{modifiers:{lazy:t,trim:i,number:s}},d){e[ed]=vm(d);const g=s||d.props&&d.props.type==="number";ah(e,t?"change":"input",_=>{if(_.target.composing)return;let o=e.value;i&&(o=o.trim()),g&&(o=qw(o)),e[ed](o)}),i&&ah(e,"change",()=>{e.value=e.value.trim()}),t||(ah(e,"compositionstart",V6),ah(e,"compositionend",wA),ah(e,"change",wA))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:i,modifiers:{lazy:s,trim:d,number:g}},_){if(e[ed]=vm(_),e.composing)return;const o=(g||e.type==="number")&&!/^0\d/.test(e.value)?qw(e.value):e.value,S=t??"";o!==S&&(document.activeElement===e&&e.type!=="range"&&(s&&t===i||d&&e.value.trim()===S)||(e.value=S))}},mb={deep:!0,created(e,t,i){e[ed]=vm(i),ah(e,"change",()=>{const s=e._modelValue,d=FR(e),g=e.checked,_=e[ed];if(fn(s)){const o=g3(s,d),S=o!==-1;if(g&&!S)_(s.concat(d));else if(!g&&S){const E=[...s];E.splice(o,1),_(E)}}else if(Nb(s)){const o=new Set(s);g?o.add(d):o.delete(d),_(o)}else _(BR(e,g))})},mounted:SA,beforeUpdate(e,t,i){e[ed]=vm(i),SA(e,t,i)}};function SA(e,{value:t,oldValue:i},s){e._modelValue=t;let d;if(fn(t))d=g3(t,s.props.value)>-1;else if(Nb(t))d=t.has(s.props.value);else{if(t===i)return;d=mm(t,BR(e,!0))}e.checked!==d&&(e.checked=d)}const zR={created(e,{value:t},i){e.checked=mm(t,i.props.value),e[ed]=vm(i),ah(e,"change",()=>{e[ed](FR(e))})},beforeUpdate(e,{value:t,oldValue:i},s){e[ed]=vm(s),t!==i&&(e.checked=mm(t,s.props.value))}};function FR(e){return"_value"in e?e._value:e.value}function BR(e,t){const i=t?"_trueValue":"_falseValue";return i in e?e[i]:t}const U6=["ctrl","shift","alt","meta"],j6={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>U6.some(i=>e[`${i}Key`]&&!t.includes(i))},po=(e,t)=>{const i=e._withMods||(e._withMods={}),s=t.join(".");return i[s]||(i[s]=(d,...g)=>{for(let _=0;_<t.length;_++){const o=j6[t[_]];if(o&&o(d,t))return}return e(d,...g)})},H6={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ti=(e,t)=>{const i=e._withKeys||(e._withKeys={}),s=t.join(".");return i[s]||(i[s]=d=>{if(!("key"in d))return;const g=id(d.key);if(t.some(_=>_===g||H6[_]===g))return e(d)})},G6=da({patchProp:O6},v6);let TA;function NR(){return TA||(TA=j5(G6))}const gh=(...e)=>{NR().render(...e)},$R=(...e)=>{const t=NR().createApp(...e),{mount:i}=t;return t.mount=s=>{const d=q6(s);if(!d)return;const g=t._component;!Qn(g)&&!g.render&&!g.template&&(g.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const _=i(d,!1,W6(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},t};function W6(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function q6(e){return Zn(e)?document.querySelector(e):e}var Ps=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var VR={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){var i,s,d;function g(o,S){if(!i)i=S;else if(!s)s=S;else{var E="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",I={};i(I),d=S(I),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}g(["exports"],function(o){function S(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var E,I={},P={};function F(){if(E)return P;E=1,Object.defineProperty(P,"__esModule",{value:!0}),P.setMatrixArrayType=function(m){P.ARRAY_TYPE=n=m},P.toRadian=function(m){return m*u},P.equals=function(m,h){return Math.abs(m-h)<=c*Math.max(1,Math.abs(m),Math.abs(h))},P.RANDOM=P.ARRAY_TYPE=P.EPSILON=void 0;var c=1e-6;P.EPSILON=c;var n=typeof Float32Array<"u"?Float32Array:Array;P.ARRAY_TYPE=n;var a=Math.random;P.RANDOM=a;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)}),P}var B,$={};function z(){if(B)return $;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}B=1,Object.defineProperty($,"__esModule",{value:!0}),$.create=function(){var h=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},$.clone=function(h){var v=new n.ARRAY_TYPE(4);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v},$.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h},$.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},$.fromValues=function(h,v,T,k){var L=new n.ARRAY_TYPE(4);return L[0]=h,L[1]=v,L[2]=T,L[3]=k,L},$.set=function(h,v,T,k,L){return h[0]=v,h[1]=T,h[2]=k,h[3]=L,h},$.transpose=function(h,v){if(h===v){var T=v[1];h[1]=v[2],h[2]=T}else h[0]=v[0],h[1]=v[2],h[2]=v[1],h[3]=v[3];return h},$.invert=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=T*x-L*k;return A?(h[0]=x*(A=1/A),h[1]=-k*A,h[2]=-L*A,h[3]=T*A,h):null},$.adjoint=function(h,v){var T=v[0];return h[0]=v[3],h[1]=-v[1],h[2]=-v[2],h[3]=T,h},$.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},$.multiply=u,$.rotate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=Math.sin(T),M=Math.cos(T);return h[0]=k*M+x*O,h[1]=L*M+A*O,h[2]=k*-O+x*M,h[3]=L*-O+A*M,h},$.scale=function(h,v,T){var k=v[1],L=v[2],x=v[3],A=T[0],O=T[1];return h[0]=v[0]*A,h[1]=k*A,h[2]=L*O,h[3]=x*O,h},$.fromRotation=function(h,v){var T=Math.sin(v),k=Math.cos(v);return h[0]=k,h[1]=T,h[2]=-T,h[3]=k,h},$.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h},$.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},$.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},$.LDU=function(h,v,T,k){return h[2]=k[2]/k[0],T[0]=k[0],T[1]=k[1],T[3]=k[3]-h[2]*T[1],[h,v,T]},$.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h},$.subtract=m,$.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]},$.equals=function(h,v){var T=h[0],k=h[1],L=h[2],x=h[3],A=v[0],O=v[1],M=v[2],R=v[3];return Math.abs(T-A)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(A))&&Math.abs(k-O)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(O))&&Math.abs(L-M)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(M))&&Math.abs(x-R)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(R))},$.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h},$.multiplyScalarAndAdd=function(h,v,T,k){return h[0]=v[0]+T[0]*k,h[1]=v[1]+T[1]*k,h[2]=v[2]+T[2]*k,h[3]=v[3]+T[3]*k,h},$.sub=$.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=a(void 0);if(T&&T.has(h))return T.get(h);var k={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var A=L?Object.getOwnPropertyDescriptor(h,x):null;A&&(A.get||A.set)?Object.defineProperty(k,x,A):k[x]=h[x]}return k.default=h,T&&T.set(h,k),k}(F());function a(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(a=function(k){return k?T:v})(h)}function u(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=T[0],M=T[1],R=T[2],N=T[3];return h[0]=k*O+x*M,h[1]=L*O+A*M,h[2]=k*R+x*N,h[3]=L*R+A*N,h}function m(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h}return $.mul=u,$.sub=m,$}var H,U={};function ie(){if(H)return U;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}H=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var h=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},U.clone=function(h){var v=new n.ARRAY_TYPE(6);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v},U.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h},U.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},U.fromValues=function(h,v,T,k,L,x){var A=new n.ARRAY_TYPE(6);return A[0]=h,A[1]=v,A[2]=T,A[3]=k,A[4]=L,A[5]=x,A},U.set=function(h,v,T,k,L,x,A){return h[0]=v,h[1]=T,h[2]=k,h[3]=L,h[4]=x,h[5]=A,h},U.invert=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],O=v[5],M=T*x-k*L;return M?(h[0]=x*(M=1/M),h[1]=-k*M,h[2]=-L*M,h[3]=T*M,h[4]=(L*O-x*A)*M,h[5]=(k*A-T*O)*M,h):null},U.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},U.multiply=u,U.rotate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=v[4],M=v[5],R=Math.sin(T),N=Math.cos(T);return h[0]=k*N+x*R,h[1]=L*N+A*R,h[2]=k*-R+x*N,h[3]=L*-R+A*N,h[4]=O,h[5]=M,h},U.scale=function(h,v,T){var k=v[1],L=v[2],x=v[3],A=v[4],O=v[5],M=T[0],R=T[1];return h[0]=v[0]*M,h[1]=k*M,h[2]=L*R,h[3]=x*R,h[4]=A,h[5]=O,h},U.translate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=v[4],M=v[5],R=T[0],N=T[1];return h[0]=k,h[1]=L,h[2]=x,h[3]=A,h[4]=k*R+x*N+O,h[5]=L*R+A*N+M,h},U.fromRotation=function(h,v){var T=Math.sin(v),k=Math.cos(v);return h[0]=k,h[1]=T,h[2]=-T,h[3]=k,h[4]=0,h[5]=0,h},U.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h[4]=0,h[5]=0,h},U.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=v[0],h[5]=v[1],h},U.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},U.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},U.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h},U.subtract=m,U.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h},U.multiplyScalarAndAdd=function(h,v,T,k){return h[0]=v[0]+T[0]*k,h[1]=v[1]+T[1]*k,h[2]=v[2]+T[2]*k,h[3]=v[3]+T[3]*k,h[4]=v[4]+T[4]*k,h[5]=v[5]+T[5]*k,h},U.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]},U.equals=function(h,v){var T=h[0],k=h[1],L=h[2],x=h[3],A=h[4],O=h[5],M=v[0],R=v[1],N=v[2],W=v[3],Y=v[4],ne=v[5];return Math.abs(T-M)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(M))&&Math.abs(k-R)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(R))&&Math.abs(L-N)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(N))&&Math.abs(x-W)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(W))&&Math.abs(A-Y)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(Y))&&Math.abs(O-ne)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(ne))},U.sub=U.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=a(void 0);if(T&&T.has(h))return T.get(h);var k={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var A=L?Object.getOwnPropertyDescriptor(h,x):null;A&&(A.get||A.set)?Object.defineProperty(k,x,A):k[x]=h[x]}return k.default=h,T&&T.set(h,k),k}(F());function a(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(a=function(k){return k?T:v})(h)}function u(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=v[4],M=v[5],R=T[0],N=T[1],W=T[2],Y=T[3],ne=T[4],re=T[5];return h[0]=k*R+x*N,h[1]=L*R+A*N,h[2]=k*W+x*Y,h[3]=L*W+A*Y,h[4]=k*ne+x*re+O,h[5]=L*ne+A*re+M,h}function m(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h}return U.mul=u,U.sub=m,U}var Z,G={};function Q(){if(Z)return G;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}Z=1,Object.defineProperty(G,"__esModule",{value:!0}),G.create=function(){var h=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},G.fromMat4=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[4],h[4]=v[5],h[5]=v[6],h[6]=v[8],h[7]=v[9],h[8]=v[10],h},G.clone=function(h){var v=new n.ARRAY_TYPE(9);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v[6]=h[6],v[7]=h[7],v[8]=h[8],v},G.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},G.fromValues=function(h,v,T,k,L,x,A,O,M){var R=new n.ARRAY_TYPE(9);return R[0]=h,R[1]=v,R[2]=T,R[3]=k,R[4]=L,R[5]=x,R[6]=A,R[7]=O,R[8]=M,R},G.set=function(h,v,T,k,L,x,A,O,M,R){return h[0]=v,h[1]=T,h[2]=k,h[3]=L,h[4]=x,h[5]=A,h[6]=O,h[7]=M,h[8]=R,h},G.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},G.transpose=function(h,v){if(h===v){var T=v[1],k=v[2],L=v[5];h[1]=v[3],h[2]=v[6],h[3]=T,h[5]=v[7],h[6]=k,h[7]=L}else h[0]=v[0],h[1]=v[3],h[2]=v[6],h[3]=v[1],h[4]=v[4],h[5]=v[7],h[6]=v[2],h[7]=v[5],h[8]=v[8];return h},G.invert=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],O=v[5],M=v[6],R=v[7],N=v[8],W=N*A-O*R,Y=-N*x+O*M,ne=R*x-A*M,re=T*W+k*Y+L*ne;return re?(h[0]=W*(re=1/re),h[1]=(-N*k+L*R)*re,h[2]=(O*k-L*A)*re,h[3]=Y*re,h[4]=(N*T-L*M)*re,h[5]=(-O*T+L*x)*re,h[6]=ne*re,h[7]=(-R*T+k*M)*re,h[8]=(A*T-k*x)*re,h):null},G.adjoint=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],O=v[5],M=v[6],R=v[7],N=v[8];return h[0]=A*N-O*R,h[1]=L*R-k*N,h[2]=k*O-L*A,h[3]=O*M-x*N,h[4]=T*N-L*M,h[5]=L*x-T*O,h[6]=x*R-A*M,h[7]=k*M-T*R,h[8]=T*A-k*x,h},G.determinant=function(h){var v=h[3],T=h[4],k=h[5],L=h[6],x=h[7],A=h[8];return h[0]*(A*T-k*x)+h[1]*(-A*v+k*L)+h[2]*(x*v-T*L)},G.multiply=u,G.translate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=v[4],M=v[5],R=v[6],N=v[7],W=v[8],Y=T[0],ne=T[1];return h[0]=k,h[1]=L,h[2]=x,h[3]=A,h[4]=O,h[5]=M,h[6]=Y*k+ne*A+R,h[7]=Y*L+ne*O+N,h[8]=Y*x+ne*M+W,h},G.rotate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=v[4],M=v[5],R=v[6],N=v[7],W=v[8],Y=Math.sin(T),ne=Math.cos(T);return h[0]=ne*k+Y*A,h[1]=ne*L+Y*O,h[2]=ne*x+Y*M,h[3]=ne*A-Y*k,h[4]=ne*O-Y*L,h[5]=ne*M-Y*x,h[6]=R,h[7]=N,h[8]=W,h},G.scale=function(h,v,T){var k=T[0],L=T[1];return h[0]=k*v[0],h[1]=k*v[1],h[2]=k*v[2],h[3]=L*v[3],h[4]=L*v[4],h[5]=L*v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},G.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=v[0],h[7]=v[1],h[8]=1,h},G.fromRotation=function(h,v){var T=Math.sin(v),k=Math.cos(v);return h[0]=k,h[1]=T,h[2]=0,h[3]=-T,h[4]=k,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},G.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=0,h[4]=v[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},G.fromMat2d=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=0,h[3]=v[2],h[4]=v[3],h[5]=0,h[6]=v[4],h[7]=v[5],h[8]=1,h},G.fromQuat=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=T+T,O=k+k,M=L+L,R=T*A,N=k*A,W=k*O,Y=L*A,ne=L*O,re=L*M,J=x*A,ue=x*O,ve=x*M;return h[0]=1-W-re,h[3]=N-ve,h[6]=Y+ue,h[1]=N+ve,h[4]=1-R-re,h[7]=ne-J,h[2]=Y-ue,h[5]=ne+J,h[8]=1-R-W,h},G.normalFromMat4=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],O=v[5],M=v[6],R=v[7],N=v[8],W=v[9],Y=v[10],ne=v[11],re=v[12],J=v[13],ue=v[14],ve=v[15],Ie=T*O-k*A,Ge=T*M-L*A,ze=T*R-x*A,$e=k*M-L*O,st=k*R-x*O,Fe=L*R-x*M,rt=N*J-W*re,ht=N*ue-Y*re,pt=N*ve-ne*re,Tt=W*ue-Y*J,Ot=W*ve-ne*J,Ft=Y*ve-ne*ue,Pt=Ie*Ft-Ge*Ot+ze*Tt+$e*pt-st*ht+Fe*rt;return Pt?(h[0]=(O*Ft-M*Ot+R*Tt)*(Pt=1/Pt),h[1]=(M*pt-A*Ft-R*ht)*Pt,h[2]=(A*Ot-O*pt+R*rt)*Pt,h[3]=(L*Ot-k*Ft-x*Tt)*Pt,h[4]=(T*Ft-L*pt+x*ht)*Pt,h[5]=(k*pt-T*Ot-x*rt)*Pt,h[6]=(J*Fe-ue*st+ve*$e)*Pt,h[7]=(ue*ze-re*Fe-ve*Ge)*Pt,h[8]=(re*st-J*ze+ve*Ie)*Pt,h):null},G.projection=function(h,v,T){return h[0]=2/v,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/T,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},G.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},G.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},G.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h[6]=v[6]+T[6],h[7]=v[7]+T[7],h[8]=v[8]+T[8],h},G.subtract=m,G.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h[6]=v[6]*T,h[7]=v[7]*T,h[8]=v[8]*T,h},G.multiplyScalarAndAdd=function(h,v,T,k){return h[0]=v[0]+T[0]*k,h[1]=v[1]+T[1]*k,h[2]=v[2]+T[2]*k,h[3]=v[3]+T[3]*k,h[4]=v[4]+T[4]*k,h[5]=v[5]+T[5]*k,h[6]=v[6]+T[6]*k,h[7]=v[7]+T[7]*k,h[8]=v[8]+T[8]*k,h},G.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]&&h[6]===v[6]&&h[7]===v[7]&&h[8]===v[8]},G.equals=function(h,v){var T=h[0],k=h[1],L=h[2],x=h[3],A=h[4],O=h[5],M=h[6],R=h[7],N=h[8],W=v[0],Y=v[1],ne=v[2],re=v[3],J=v[4],ue=v[5],ve=v[6],Ie=v[7],Ge=v[8];return Math.abs(T-W)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(W))&&Math.abs(k-Y)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Y))&&Math.abs(L-ne)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(ne))&&Math.abs(x-re)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(re))&&Math.abs(A-J)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(J))&&Math.abs(O-ue)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(ue))&&Math.abs(M-ve)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(ve))&&Math.abs(R-Ie)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ie))&&Math.abs(N-Ge)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(Ge))},G.sub=G.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=a(void 0);if(T&&T.has(h))return T.get(h);var k={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var A=L?Object.getOwnPropertyDescriptor(h,x):null;A&&(A.get||A.set)?Object.defineProperty(k,x,A):k[x]=h[x]}return k.default=h,T&&T.set(h,k),k}(F());function a(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(a=function(k){return k?T:v})(h)}function u(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],O=v[4],M=v[5],R=v[6],N=v[7],W=v[8],Y=T[0],ne=T[1],re=T[2],J=T[3],ue=T[4],ve=T[5],Ie=T[6],Ge=T[7],ze=T[8];return h[0]=Y*k+ne*A+re*R,h[1]=Y*L+ne*O+re*N,h[2]=Y*x+ne*M+re*W,h[3]=J*k+ue*A+ve*R,h[4]=J*L+ue*O+ve*N,h[5]=J*x+ue*M+ve*W,h[6]=Ie*k+Ge*A+ze*R,h[7]=Ie*L+Ge*O+ze*N,h[8]=Ie*x+Ge*M+ze*W,h}function m(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h[6]=v[6]-T[6],h[7]=v[7]-T[7],h[8]=v[8]-T[8],h}return G.mul=u,G.sub=m,G}var oe,le={};function me(){if(oe)return le;function c(x){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},c(x)}oe=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var x=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x},le.clone=function(x){var A=new n.ARRAY_TYPE(16);return A[0]=x[0],A[1]=x[1],A[2]=x[2],A[3]=x[3],A[4]=x[4],A[5]=x[5],A[6]=x[6],A[7]=x[7],A[8]=x[8],A[9]=x[9],A[10]=x[10],A[11]=x[11],A[12]=x[12],A[13]=x[13],A[14]=x[14],A[15]=x[15],A},le.copy=function(x,A){return x[0]=A[0],x[1]=A[1],x[2]=A[2],x[3]=A[3],x[4]=A[4],x[5]=A[5],x[6]=A[6],x[7]=A[7],x[8]=A[8],x[9]=A[9],x[10]=A[10],x[11]=A[11],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15],x},le.fromValues=function(x,A,O,M,R,N,W,Y,ne,re,J,ue,ve,Ie,Ge,ze){var $e=new n.ARRAY_TYPE(16);return $e[0]=x,$e[1]=A,$e[2]=O,$e[3]=M,$e[4]=R,$e[5]=N,$e[6]=W,$e[7]=Y,$e[8]=ne,$e[9]=re,$e[10]=J,$e[11]=ue,$e[12]=ve,$e[13]=Ie,$e[14]=Ge,$e[15]=ze,$e},le.set=function(x,A,O,M,R,N,W,Y,ne,re,J,ue,ve,Ie,Ge,ze,$e){return x[0]=A,x[1]=O,x[2]=M,x[3]=R,x[4]=N,x[5]=W,x[6]=Y,x[7]=ne,x[8]=re,x[9]=J,x[10]=ue,x[11]=ve,x[12]=Ie,x[13]=Ge,x[14]=ze,x[15]=$e,x},le.identity=u,le.transpose=function(x,A){if(x===A){var O=A[1],M=A[2],R=A[3],N=A[6],W=A[7],Y=A[11];x[1]=A[4],x[2]=A[8],x[3]=A[12],x[4]=O,x[6]=A[9],x[7]=A[13],x[8]=M,x[9]=N,x[11]=A[14],x[12]=R,x[13]=W,x[14]=Y}else x[0]=A[0],x[1]=A[4],x[2]=A[8],x[3]=A[12],x[4]=A[1],x[5]=A[5],x[6]=A[9],x[7]=A[13],x[8]=A[2],x[9]=A[6],x[10]=A[10],x[11]=A[14],x[12]=A[3],x[13]=A[7],x[14]=A[11],x[15]=A[15];return x},le.invert=function(x,A){var O=A[0],M=A[1],R=A[2],N=A[3],W=A[4],Y=A[5],ne=A[6],re=A[7],J=A[8],ue=A[9],ve=A[10],Ie=A[11],Ge=A[12],ze=A[13],$e=A[14],st=A[15],Fe=O*Y-M*W,rt=O*ne-R*W,ht=O*re-N*W,pt=M*ne-R*Y,Tt=M*re-N*Y,Ot=R*re-N*ne,Ft=J*ze-ue*Ge,Pt=J*$e-ve*Ge,sn=J*st-Ie*Ge,Cn=ue*$e-ve*ze,Jt=ue*st-Ie*ze,Jn=ve*st-Ie*$e,Fn=Fe*Jn-rt*Jt+ht*Cn+pt*sn-Tt*Pt+Ot*Ft;return Fn?(x[0]=(Y*Jn-ne*Jt+re*Cn)*(Fn=1/Fn),x[1]=(R*Jt-M*Jn-N*Cn)*Fn,x[2]=(ze*Ot-$e*Tt+st*pt)*Fn,x[3]=(ve*Tt-ue*Ot-Ie*pt)*Fn,x[4]=(ne*sn-W*Jn-re*Pt)*Fn,x[5]=(O*Jn-R*sn+N*Pt)*Fn,x[6]=($e*ht-Ge*Ot-st*rt)*Fn,x[7]=(J*Ot-ve*ht+Ie*rt)*Fn,x[8]=(W*Jt-Y*sn+re*Ft)*Fn,x[9]=(M*sn-O*Jt-N*Ft)*Fn,x[10]=(Ge*Tt-ze*ht+st*Fe)*Fn,x[11]=(ue*ht-J*Tt-Ie*Fe)*Fn,x[12]=(Y*Pt-W*Cn-ne*Ft)*Fn,x[13]=(O*Cn-M*Pt+R*Ft)*Fn,x[14]=(ze*rt-Ge*pt-$e*Fe)*Fn,x[15]=(J*pt-ue*rt+ve*Fe)*Fn,x):null},le.adjoint=function(x,A){var O=A[0],M=A[1],R=A[2],N=A[3],W=A[4],Y=A[5],ne=A[6],re=A[7],J=A[8],ue=A[9],ve=A[10],Ie=A[11],Ge=A[12],ze=A[13],$e=A[14],st=A[15];return x[0]=Y*(ve*st-Ie*$e)-ue*(ne*st-re*$e)+ze*(ne*Ie-re*ve),x[1]=-(M*(ve*st-Ie*$e)-ue*(R*st-N*$e)+ze*(R*Ie-N*ve)),x[2]=M*(ne*st-re*$e)-Y*(R*st-N*$e)+ze*(R*re-N*ne),x[3]=-(M*(ne*Ie-re*ve)-Y*(R*Ie-N*ve)+ue*(R*re-N*ne)),x[4]=-(W*(ve*st-Ie*$e)-J*(ne*st-re*$e)+Ge*(ne*Ie-re*ve)),x[5]=O*(ve*st-Ie*$e)-J*(R*st-N*$e)+Ge*(R*Ie-N*ve),x[6]=-(O*(ne*st-re*$e)-W*(R*st-N*$e)+Ge*(R*re-N*ne)),x[7]=O*(ne*Ie-re*ve)-W*(R*Ie-N*ve)+J*(R*re-N*ne),x[8]=W*(ue*st-Ie*ze)-J*(Y*st-re*ze)+Ge*(Y*Ie-re*ue),x[9]=-(O*(ue*st-Ie*ze)-J*(M*st-N*ze)+Ge*(M*Ie-N*ue)),x[10]=O*(Y*st-re*ze)-W*(M*st-N*ze)+Ge*(M*re-N*Y),x[11]=-(O*(Y*Ie-re*ue)-W*(M*Ie-N*ue)+J*(M*re-N*Y)),x[12]=-(W*(ue*$e-ve*ze)-J*(Y*$e-ne*ze)+Ge*(Y*ve-ne*ue)),x[13]=O*(ue*$e-ve*ze)-J*(M*$e-R*ze)+Ge*(M*ve-R*ue),x[14]=-(O*(Y*$e-ne*ze)-W*(M*$e-R*ze)+Ge*(M*ne-R*Y)),x[15]=O*(Y*ve-ne*ue)-W*(M*ve-R*ue)+J*(M*ne-R*Y),x},le.determinant=function(x){var A=x[0],O=x[1],M=x[2],R=x[3],N=x[4],W=x[5],Y=x[6],ne=x[7],re=x[8],J=x[9],ue=x[10],ve=x[11],Ie=x[12],Ge=x[13],ze=x[14],$e=x[15];return(A*W-O*N)*(ue*$e-ve*ze)-(A*Y-M*N)*(J*$e-ve*Ge)+(A*ne-R*N)*(J*ze-ue*Ge)+(O*Y-M*W)*(re*$e-ve*Ie)-(O*ne-R*W)*(re*ze-ue*Ie)+(M*ne-R*Y)*(re*Ge-J*Ie)},le.multiply=m,le.translate=function(x,A,O){var M,R,N,W,Y,ne,re,J,ue,ve,Ie,Ge,ze=O[0],$e=O[1],st=O[2];return A===x?(x[12]=A[0]*ze+A[4]*$e+A[8]*st+A[12],x[13]=A[1]*ze+A[5]*$e+A[9]*st+A[13],x[14]=A[2]*ze+A[6]*$e+A[10]*st+A[14],x[15]=A[3]*ze+A[7]*$e+A[11]*st+A[15]):(R=A[1],N=A[2],W=A[3],Y=A[4],ne=A[5],re=A[6],J=A[7],ue=A[8],ve=A[9],Ie=A[10],Ge=A[11],x[0]=M=A[0],x[1]=R,x[2]=N,x[3]=W,x[4]=Y,x[5]=ne,x[6]=re,x[7]=J,x[8]=ue,x[9]=ve,x[10]=Ie,x[11]=Ge,x[12]=M*ze+Y*$e+ue*st+A[12],x[13]=R*ze+ne*$e+ve*st+A[13],x[14]=N*ze+re*$e+Ie*st+A[14],x[15]=W*ze+J*$e+Ge*st+A[15]),x},le.scale=function(x,A,O){var M=O[0],R=O[1],N=O[2];return x[0]=A[0]*M,x[1]=A[1]*M,x[2]=A[2]*M,x[3]=A[3]*M,x[4]=A[4]*R,x[5]=A[5]*R,x[6]=A[6]*R,x[7]=A[7]*R,x[8]=A[8]*N,x[9]=A[9]*N,x[10]=A[10]*N,x[11]=A[11]*N,x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15],x},le.rotate=function(x,A,O,M){var R,N,W,Y,ne,re,J,ue,ve,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt,Ot,Ft,Pt,sn,Cn,Jt=M[0],Jn=M[1],Fn=M[2],Pn=Math.hypot(Jt,Jn,Fn);return Pn<n.EPSILON?null:(Jt*=Pn=1/Pn,Jn*=Pn,Fn*=Pn,R=Math.sin(O),N=Math.cos(O),ne=A[1],re=A[2],J=A[3],ve=A[5],Ie=A[6],Ge=A[7],$e=A[9],st=A[10],Fe=A[11],rt=Jt*Jt*(W=1-N)+N,Tt=Jt*Jn*W-Fn*R,Ot=Jn*Jn*W+N,Ft=Fn*Jn*W+Jt*R,Pt=Jt*Fn*W+Jn*R,sn=Jn*Fn*W-Jt*R,Cn=Fn*Fn*W+N,x[0]=(Y=A[0])*rt+(ue=A[4])*(ht=Jn*Jt*W+Fn*R)+(ze=A[8])*(pt=Fn*Jt*W-Jn*R),x[1]=ne*rt+ve*ht+$e*pt,x[2]=re*rt+Ie*ht+st*pt,x[3]=J*rt+Ge*ht+Fe*pt,x[4]=Y*Tt+ue*Ot+ze*Ft,x[5]=ne*Tt+ve*Ot+$e*Ft,x[6]=re*Tt+Ie*Ot+st*Ft,x[7]=J*Tt+Ge*Ot+Fe*Ft,x[8]=Y*Pt+ue*sn+ze*Cn,x[9]=ne*Pt+ve*sn+$e*Cn,x[10]=re*Pt+Ie*sn+st*Cn,x[11]=J*Pt+Ge*sn+Fe*Cn,A!==x&&(x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x)},le.rotateX=function(x,A,O){var M=Math.sin(O),R=Math.cos(O),N=A[4],W=A[5],Y=A[6],ne=A[7],re=A[8],J=A[9],ue=A[10],ve=A[11];return A!==x&&(x[0]=A[0],x[1]=A[1],x[2]=A[2],x[3]=A[3],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x[4]=N*R+re*M,x[5]=W*R+J*M,x[6]=Y*R+ue*M,x[7]=ne*R+ve*M,x[8]=re*R-N*M,x[9]=J*R-W*M,x[10]=ue*R-Y*M,x[11]=ve*R-ne*M,x},le.rotateY=function(x,A,O){var M=Math.sin(O),R=Math.cos(O),N=A[0],W=A[1],Y=A[2],ne=A[3],re=A[8],J=A[9],ue=A[10],ve=A[11];return A!==x&&(x[4]=A[4],x[5]=A[5],x[6]=A[6],x[7]=A[7],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x[0]=N*R-re*M,x[1]=W*R-J*M,x[2]=Y*R-ue*M,x[3]=ne*R-ve*M,x[8]=N*M+re*R,x[9]=W*M+J*R,x[10]=Y*M+ue*R,x[11]=ne*M+ve*R,x},le.rotateZ=function(x,A,O){var M=Math.sin(O),R=Math.cos(O),N=A[0],W=A[1],Y=A[2],ne=A[3],re=A[4],J=A[5],ue=A[6],ve=A[7];return A!==x&&(x[8]=A[8],x[9]=A[9],x[10]=A[10],x[11]=A[11],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x[0]=N*R+re*M,x[1]=W*R+J*M,x[2]=Y*R+ue*M,x[3]=ne*R+ve*M,x[4]=re*R-N*M,x[5]=J*R-W*M,x[6]=ue*R-Y*M,x[7]=ve*R-ne*M,x},le.fromTranslation=function(x,A){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=A[0],x[13]=A[1],x[14]=A[2],x[15]=1,x},le.fromScaling=function(x,A){return x[0]=A[0],x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=A[1],x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=A[2],x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},le.fromRotation=function(x,A,O){var M,R,N,W=O[0],Y=O[1],ne=O[2],re=Math.hypot(W,Y,ne);return re<n.EPSILON?null:(W*=re=1/re,Y*=re,ne*=re,M=Math.sin(A),R=Math.cos(A),x[0]=W*W*(N=1-R)+R,x[1]=Y*W*N+ne*M,x[2]=ne*W*N-Y*M,x[3]=0,x[4]=W*Y*N-ne*M,x[5]=Y*Y*N+R,x[6]=ne*Y*N+W*M,x[7]=0,x[8]=W*ne*N+Y*M,x[9]=Y*ne*N-W*M,x[10]=ne*ne*N+R,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x)},le.fromXRotation=function(x,A){var O=Math.sin(A),M=Math.cos(A);return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=M,x[6]=O,x[7]=0,x[8]=0,x[9]=-O,x[10]=M,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},le.fromYRotation=function(x,A){var O=Math.sin(A),M=Math.cos(A);return x[0]=M,x[1]=0,x[2]=-O,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=O,x[9]=0,x[10]=M,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},le.fromZRotation=function(x,A){var O=Math.sin(A),M=Math.cos(A);return x[0]=M,x[1]=O,x[2]=0,x[3]=0,x[4]=-O,x[5]=M,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},le.fromRotationTranslation=h,le.fromQuat2=function(x,A){var O=new n.ARRAY_TYPE(3),M=-A[0],R=-A[1],N=-A[2],W=A[3],Y=A[4],ne=A[5],re=A[6],J=A[7],ue=M*M+R*R+N*N+W*W;return ue>0?(O[0]=2*(Y*W+J*M+ne*N-re*R)/ue,O[1]=2*(ne*W+J*R+re*M-Y*N)/ue,O[2]=2*(re*W+J*N+Y*R-ne*M)/ue):(O[0]=2*(Y*W+J*M+ne*N-re*R),O[1]=2*(ne*W+J*R+re*M-Y*N),O[2]=2*(re*W+J*N+Y*R-ne*M)),h(x,A,O),x},le.getTranslation=function(x,A){return x[0]=A[12],x[1]=A[13],x[2]=A[14],x},le.getScaling=v,le.getRotation=function(x,A){var O=new n.ARRAY_TYPE(3);v(O,A);var M=1/O[0],R=1/O[1],N=1/O[2],W=A[0]*M,Y=A[1]*R,ne=A[2]*N,re=A[4]*M,J=A[5]*R,ue=A[6]*N,ve=A[8]*M,Ie=A[9]*R,Ge=A[10]*N,ze=W+J+Ge,$e=0;return ze>0?($e=2*Math.sqrt(ze+1),x[3]=.25*$e,x[0]=(ue-Ie)/$e,x[1]=(ve-ne)/$e,x[2]=(Y-re)/$e):W>J&&W>Ge?($e=2*Math.sqrt(1+W-J-Ge),x[3]=(ue-Ie)/$e,x[0]=.25*$e,x[1]=(Y+re)/$e,x[2]=(ve+ne)/$e):J>Ge?($e=2*Math.sqrt(1+J-W-Ge),x[3]=(ve-ne)/$e,x[0]=(Y+re)/$e,x[1]=.25*$e,x[2]=(ue+Ie)/$e):($e=2*Math.sqrt(1+Ge-W-J),x[3]=(Y-re)/$e,x[0]=(ve+ne)/$e,x[1]=(ue+Ie)/$e,x[2]=.25*$e),x},le.fromRotationTranslationScale=function(x,A,O,M){var R=A[0],N=A[1],W=A[2],Y=A[3],ne=R+R,re=N+N,J=W+W,ue=R*ne,ve=R*re,Ie=R*J,Ge=N*re,ze=N*J,$e=W*J,st=Y*ne,Fe=Y*re,rt=Y*J,ht=M[0],pt=M[1],Tt=M[2];return x[0]=(1-(Ge+$e))*ht,x[1]=(ve+rt)*ht,x[2]=(Ie-Fe)*ht,x[3]=0,x[4]=(ve-rt)*pt,x[5]=(1-(ue+$e))*pt,x[6]=(ze+st)*pt,x[7]=0,x[8]=(Ie+Fe)*Tt,x[9]=(ze-st)*Tt,x[10]=(1-(ue+Ge))*Tt,x[11]=0,x[12]=O[0],x[13]=O[1],x[14]=O[2],x[15]=1,x},le.fromRotationTranslationScaleOrigin=function(x,A,O,M,R){var N=A[0],W=A[1],Y=A[2],ne=A[3],re=N+N,J=W+W,ue=Y+Y,ve=N*re,Ie=N*J,Ge=N*ue,ze=W*J,$e=W*ue,st=Y*ue,Fe=ne*re,rt=ne*J,ht=ne*ue,pt=M[0],Tt=M[1],Ot=M[2],Ft=R[0],Pt=R[1],sn=R[2],Cn=(1-(ze+st))*pt,Jt=(Ie+ht)*pt,Jn=(Ge-rt)*pt,Fn=(Ie-ht)*Tt,Pn=(1-(ve+st))*Tt,Sn=($e+Fe)*Tt,wo=(Ge+rt)*Ot,Xn=($e-Fe)*Ot,io=(1-(ve+ze))*Ot;return x[0]=Cn,x[1]=Jt,x[2]=Jn,x[3]=0,x[4]=Fn,x[5]=Pn,x[6]=Sn,x[7]=0,x[8]=wo,x[9]=Xn,x[10]=io,x[11]=0,x[12]=O[0]+Ft-(Cn*Ft+Fn*Pt+wo*sn),x[13]=O[1]+Pt-(Jt*Ft+Pn*Pt+Xn*sn),x[14]=O[2]+sn-(Jn*Ft+Sn*Pt+io*sn),x[15]=1,x},le.fromQuat=function(x,A){var O=A[0],M=A[1],R=A[2],N=A[3],W=O+O,Y=M+M,ne=R+R,re=O*W,J=M*W,ue=M*Y,ve=R*W,Ie=R*Y,Ge=R*ne,ze=N*W,$e=N*Y,st=N*ne;return x[0]=1-ue-Ge,x[1]=J+st,x[2]=ve-$e,x[3]=0,x[4]=J-st,x[5]=1-re-Ge,x[6]=Ie+ze,x[7]=0,x[8]=ve+$e,x[9]=Ie-ze,x[10]=1-re-ue,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},le.frustum=function(x,A,O,M,R,N,W){var Y=1/(O-A),ne=1/(R-M),re=1/(N-W);return x[0]=2*N*Y,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=2*N*ne,x[6]=0,x[7]=0,x[8]=(O+A)*Y,x[9]=(R+M)*ne,x[10]=(W+N)*re,x[11]=-1,x[12]=0,x[13]=0,x[14]=W*N*2*re,x[15]=0,x},le.perspectiveNO=T,le.perspectiveZO=function(x,A,O,M,R){var N,W=1/Math.tan(A/2);return x[0]=W/O,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=W,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,R!=null&&R!==1/0?(x[10]=R*(N=1/(M-R)),x[14]=R*M*N):(x[10]=-1,x[14]=-M),x},le.perspectiveFromFieldOfView=function(x,A,O,M){var R=Math.tan(A.upDegrees*Math.PI/180),N=Math.tan(A.downDegrees*Math.PI/180),W=Math.tan(A.leftDegrees*Math.PI/180),Y=Math.tan(A.rightDegrees*Math.PI/180),ne=2/(W+Y),re=2/(R+N);return x[0]=ne,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=re,x[6]=0,x[7]=0,x[8]=-(W-Y)*ne*.5,x[9]=(R-N)*re*.5,x[10]=M/(O-M),x[11]=-1,x[12]=0,x[13]=0,x[14]=M*O/(O-M),x[15]=0,x},le.orthoNO=k,le.orthoZO=function(x,A,O,M,R,N,W){var Y=1/(A-O),ne=1/(M-R),re=1/(N-W);return x[0]=-2*Y,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*ne,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=re,x[11]=0,x[12]=(A+O)*Y,x[13]=(R+M)*ne,x[14]=N*re,x[15]=1,x},le.lookAt=function(x,A,O,M){var R,N,W,Y,ne,re,J,ue,ve,Ie,Ge=A[0],ze=A[1],$e=A[2],st=M[0],Fe=M[1],rt=M[2],ht=O[0],pt=O[1],Tt=O[2];return Math.abs(Ge-ht)<n.EPSILON&&Math.abs(ze-pt)<n.EPSILON&&Math.abs($e-Tt)<n.EPSILON?u(x):(J=Ge-ht,ue=ze-pt,ve=$e-Tt,R=Fe*(ve*=Ie=1/Math.hypot(J,ue,ve))-rt*(ue*=Ie),N=rt*(J*=Ie)-st*ve,W=st*ue-Fe*J,(Ie=Math.hypot(R,N,W))?(R*=Ie=1/Ie,N*=Ie,W*=Ie):(R=0,N=0,W=0),Y=ue*W-ve*N,ne=ve*R-J*W,re=J*N-ue*R,(Ie=Math.hypot(Y,ne,re))?(Y*=Ie=1/Ie,ne*=Ie,re*=Ie):(Y=0,ne=0,re=0),x[0]=R,x[1]=Y,x[2]=J,x[3]=0,x[4]=N,x[5]=ne,x[6]=ue,x[7]=0,x[8]=W,x[9]=re,x[10]=ve,x[11]=0,x[12]=-(R*Ge+N*ze+W*$e),x[13]=-(Y*Ge+ne*ze+re*$e),x[14]=-(J*Ge+ue*ze+ve*$e),x[15]=1,x)},le.targetTo=function(x,A,O,M){var R=A[0],N=A[1],W=A[2],Y=M[0],ne=M[1],re=M[2],J=R-O[0],ue=N-O[1],ve=W-O[2],Ie=J*J+ue*ue+ve*ve;Ie>0&&(J*=Ie=1/Math.sqrt(Ie),ue*=Ie,ve*=Ie);var Ge=ne*ve-re*ue,ze=re*J-Y*ve,$e=Y*ue-ne*J;return(Ie=Ge*Ge+ze*ze+$e*$e)>0&&(Ge*=Ie=1/Math.sqrt(Ie),ze*=Ie,$e*=Ie),x[0]=Ge,x[1]=ze,x[2]=$e,x[3]=0,x[4]=ue*$e-ve*ze,x[5]=ve*Ge-J*$e,x[6]=J*ze-ue*Ge,x[7]=0,x[8]=J,x[9]=ue,x[10]=ve,x[11]=0,x[12]=R,x[13]=N,x[14]=W,x[15]=1,x},le.str=function(x){return"mat4("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+", "+x[6]+", "+x[7]+", "+x[8]+", "+x[9]+", "+x[10]+", "+x[11]+", "+x[12]+", "+x[13]+", "+x[14]+", "+x[15]+")"},le.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15])},le.add=function(x,A,O){return x[0]=A[0]+O[0],x[1]=A[1]+O[1],x[2]=A[2]+O[2],x[3]=A[3]+O[3],x[4]=A[4]+O[4],x[5]=A[5]+O[5],x[6]=A[6]+O[6],x[7]=A[7]+O[7],x[8]=A[8]+O[8],x[9]=A[9]+O[9],x[10]=A[10]+O[10],x[11]=A[11]+O[11],x[12]=A[12]+O[12],x[13]=A[13]+O[13],x[14]=A[14]+O[14],x[15]=A[15]+O[15],x},le.subtract=L,le.multiplyScalar=function(x,A,O){return x[0]=A[0]*O,x[1]=A[1]*O,x[2]=A[2]*O,x[3]=A[3]*O,x[4]=A[4]*O,x[5]=A[5]*O,x[6]=A[6]*O,x[7]=A[7]*O,x[8]=A[8]*O,x[9]=A[9]*O,x[10]=A[10]*O,x[11]=A[11]*O,x[12]=A[12]*O,x[13]=A[13]*O,x[14]=A[14]*O,x[15]=A[15]*O,x},le.multiplyScalarAndAdd=function(x,A,O,M){return x[0]=A[0]+O[0]*M,x[1]=A[1]+O[1]*M,x[2]=A[2]+O[2]*M,x[3]=A[3]+O[3]*M,x[4]=A[4]+O[4]*M,x[5]=A[5]+O[5]*M,x[6]=A[6]+O[6]*M,x[7]=A[7]+O[7]*M,x[8]=A[8]+O[8]*M,x[9]=A[9]+O[9]*M,x[10]=A[10]+O[10]*M,x[11]=A[11]+O[11]*M,x[12]=A[12]+O[12]*M,x[13]=A[13]+O[13]*M,x[14]=A[14]+O[14]*M,x[15]=A[15]+O[15]*M,x},le.exactEquals=function(x,A){return x[0]===A[0]&&x[1]===A[1]&&x[2]===A[2]&&x[3]===A[3]&&x[4]===A[4]&&x[5]===A[5]&&x[6]===A[6]&&x[7]===A[7]&&x[8]===A[8]&&x[9]===A[9]&&x[10]===A[10]&&x[11]===A[11]&&x[12]===A[12]&&x[13]===A[13]&&x[14]===A[14]&&x[15]===A[15]},le.equals=function(x,A){var O=x[0],M=x[1],R=x[2],N=x[3],W=x[4],Y=x[5],ne=x[6],re=x[7],J=x[8],ue=x[9],ve=x[10],Ie=x[11],Ge=x[12],ze=x[13],$e=x[14],st=x[15],Fe=A[0],rt=A[1],ht=A[2],pt=A[3],Tt=A[4],Ot=A[5],Ft=A[6],Pt=A[7],sn=A[8],Cn=A[9],Jt=A[10],Jn=A[11],Fn=A[12],Pn=A[13],Sn=A[14],wo=A[15];return Math.abs(O-Fe)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(Fe))&&Math.abs(M-rt)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(rt))&&Math.abs(R-ht)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ht))&&Math.abs(N-pt)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(pt))&&Math.abs(W-Tt)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Tt))&&Math.abs(Y-Ot)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Ot))&&Math.abs(ne-Ft)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Ft))&&Math.abs(re-Pt)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(Pt))&&Math.abs(J-sn)<=n.EPSILON*Math.max(1,Math.abs(J),Math.abs(sn))&&Math.abs(ue-Cn)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(Cn))&&Math.abs(ve-Jt)<=n.EPSILON*Math.max(1,Math.abs(ve),Math.abs(Jt))&&Math.abs(Ie-Jn)<=n.EPSILON*Math.max(1,Math.abs(Ie),Math.abs(Jn))&&Math.abs(Ge-Fn)<=n.EPSILON*Math.max(1,Math.abs(Ge),Math.abs(Fn))&&Math.abs(ze-Pn)<=n.EPSILON*Math.max(1,Math.abs(ze),Math.abs(Pn))&&Math.abs($e-Sn)<=n.EPSILON*Math.max(1,Math.abs($e),Math.abs(Sn))&&Math.abs(st-wo)<=n.EPSILON*Math.max(1,Math.abs(st),Math.abs(wo))},le.sub=le.mul=le.ortho=le.perspective=void 0;var n=function(x,A){if(x&&x.__esModule)return x;if(x===null||c(x)!=="object"&&typeof x!="function")return{default:x};var O=a(void 0);if(O&&O.has(x))return O.get(x);var M={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in x)if(N!=="default"&&Object.prototype.hasOwnProperty.call(x,N)){var W=R?Object.getOwnPropertyDescriptor(x,N):null;W&&(W.get||W.set)?Object.defineProperty(M,N,W):M[N]=x[N]}return M.default=x,O&&O.set(x,M),M}(F());function a(x){if(typeof WeakMap!="function")return null;var A=new WeakMap,O=new WeakMap;return(a=function(M){return M?O:A})(x)}function u(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function m(x,A,O){var M=A[0],R=A[1],N=A[2],W=A[3],Y=A[4],ne=A[5],re=A[6],J=A[7],ue=A[8],ve=A[9],Ie=A[10],Ge=A[11],ze=A[12],$e=A[13],st=A[14],Fe=A[15],rt=O[0],ht=O[1],pt=O[2],Tt=O[3];return x[0]=rt*M+ht*Y+pt*ue+Tt*ze,x[1]=rt*R+ht*ne+pt*ve+Tt*$e,x[2]=rt*N+ht*re+pt*Ie+Tt*st,x[3]=rt*W+ht*J+pt*Ge+Tt*Fe,x[4]=(rt=O[4])*M+(ht=O[5])*Y+(pt=O[6])*ue+(Tt=O[7])*ze,x[5]=rt*R+ht*ne+pt*ve+Tt*$e,x[6]=rt*N+ht*re+pt*Ie+Tt*st,x[7]=rt*W+ht*J+pt*Ge+Tt*Fe,x[8]=(rt=O[8])*M+(ht=O[9])*Y+(pt=O[10])*ue+(Tt=O[11])*ze,x[9]=rt*R+ht*ne+pt*ve+Tt*$e,x[10]=rt*N+ht*re+pt*Ie+Tt*st,x[11]=rt*W+ht*J+pt*Ge+Tt*Fe,x[12]=(rt=O[12])*M+(ht=O[13])*Y+(pt=O[14])*ue+(Tt=O[15])*ze,x[13]=rt*R+ht*ne+pt*ve+Tt*$e,x[14]=rt*N+ht*re+pt*Ie+Tt*st,x[15]=rt*W+ht*J+pt*Ge+Tt*Fe,x}function h(x,A,O){var M=A[0],R=A[1],N=A[2],W=A[3],Y=M+M,ne=R+R,re=N+N,J=M*Y,ue=M*ne,ve=M*re,Ie=R*ne,Ge=R*re,ze=N*re,$e=W*Y,st=W*ne,Fe=W*re;return x[0]=1-(Ie+ze),x[1]=ue+Fe,x[2]=ve-st,x[3]=0,x[4]=ue-Fe,x[5]=1-(J+ze),x[6]=Ge+$e,x[7]=0,x[8]=ve+st,x[9]=Ge-$e,x[10]=1-(J+Ie),x[11]=0,x[12]=O[0],x[13]=O[1],x[14]=O[2],x[15]=1,x}function v(x,A){var O=A[4],M=A[5],R=A[6],N=A[8],W=A[9],Y=A[10];return x[0]=Math.hypot(A[0],A[1],A[2]),x[1]=Math.hypot(O,M,R),x[2]=Math.hypot(N,W,Y),x}function T(x,A,O,M,R){var N,W=1/Math.tan(A/2);return x[0]=W/O,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=W,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,R!=null&&R!==1/0?(x[10]=(R+M)*(N=1/(M-R)),x[14]=2*R*M*N):(x[10]=-1,x[14]=-2*M),x}function k(x,A,O,M,R,N,W){var Y=1/(A-O),ne=1/(M-R),re=1/(N-W);return x[0]=-2*Y,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*ne,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*re,x[11]=0,x[12]=(A+O)*Y,x[13]=(R+M)*ne,x[14]=(W+N)*re,x[15]=1,x}function L(x,A,O){return x[0]=A[0]-O[0],x[1]=A[1]-O[1],x[2]=A[2]-O[2],x[3]=A[3]-O[3],x[4]=A[4]-O[4],x[5]=A[5]-O[5],x[6]=A[6]-O[6],x[7]=A[7]-O[7],x[8]=A[8]-O[8],x[9]=A[9]-O[9],x[10]=A[10]-O[10],x[11]=A[11]-O[11],x[12]=A[12]-O[12],x[13]=A[13]-O[13],x[14]=A[14]-O[14],x[15]=A[15]-O[15],x}return le.perspective=T,le.ortho=k,le.mul=m,le.sub=L,le}var fe,ce={},pe={};function ye(){if(fe)return pe;function c(R){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},c(R)}fe=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.create=u,pe.clone=function(R){var N=new n.ARRAY_TYPE(3);return N[0]=R[0],N[1]=R[1],N[2]=R[2],N},pe.length=m,pe.fromValues=function(R,N,W){var Y=new n.ARRAY_TYPE(3);return Y[0]=R,Y[1]=N,Y[2]=W,Y},pe.copy=function(R,N){return R[0]=N[0],R[1]=N[1],R[2]=N[2],R},pe.set=function(R,N,W,Y){return R[0]=N,R[1]=W,R[2]=Y,R},pe.add=function(R,N,W){return R[0]=N[0]+W[0],R[1]=N[1]+W[1],R[2]=N[2]+W[2],R},pe.subtract=h,pe.multiply=v,pe.divide=T,pe.ceil=function(R,N){return R[0]=Math.ceil(N[0]),R[1]=Math.ceil(N[1]),R[2]=Math.ceil(N[2]),R},pe.floor=function(R,N){return R[0]=Math.floor(N[0]),R[1]=Math.floor(N[1]),R[2]=Math.floor(N[2]),R},pe.min=function(R,N,W){return R[0]=Math.min(N[0],W[0]),R[1]=Math.min(N[1],W[1]),R[2]=Math.min(N[2],W[2]),R},pe.max=function(R,N,W){return R[0]=Math.max(N[0],W[0]),R[1]=Math.max(N[1],W[1]),R[2]=Math.max(N[2],W[2]),R},pe.round=function(R,N){return R[0]=Math.round(N[0]),R[1]=Math.round(N[1]),R[2]=Math.round(N[2]),R},pe.scale=function(R,N,W){return R[0]=N[0]*W,R[1]=N[1]*W,R[2]=N[2]*W,R},pe.scaleAndAdd=function(R,N,W,Y){return R[0]=N[0]+W[0]*Y,R[1]=N[1]+W[1]*Y,R[2]=N[2]+W[2]*Y,R},pe.distance=k,pe.squaredDistance=L,pe.squaredLength=x,pe.negate=function(R,N){return R[0]=-N[0],R[1]=-N[1],R[2]=-N[2],R},pe.inverse=function(R,N){return R[0]=1/N[0],R[1]=1/N[1],R[2]=1/N[2],R},pe.normalize=function(R,N){var W=N[0],Y=N[1],ne=N[2],re=W*W+Y*Y+ne*ne;return re>0&&(re=1/Math.sqrt(re)),R[0]=N[0]*re,R[1]=N[1]*re,R[2]=N[2]*re,R},pe.dot=A,pe.cross=function(R,N,W){var Y=N[0],ne=N[1],re=N[2],J=W[0],ue=W[1],ve=W[2];return R[0]=ne*ve-re*ue,R[1]=re*J-Y*ve,R[2]=Y*ue-ne*J,R},pe.lerp=function(R,N,W,Y){var ne=N[0],re=N[1],J=N[2];return R[0]=ne+Y*(W[0]-ne),R[1]=re+Y*(W[1]-re),R[2]=J+Y*(W[2]-J),R},pe.hermite=function(R,N,W,Y,ne,re){var J=re*re,ue=J*(2*re-3)+1,ve=J*(re-2)+re,Ie=J*(re-1),Ge=J*(3-2*re);return R[0]=N[0]*ue+W[0]*ve+Y[0]*Ie+ne[0]*Ge,R[1]=N[1]*ue+W[1]*ve+Y[1]*Ie+ne[1]*Ge,R[2]=N[2]*ue+W[2]*ve+Y[2]*Ie+ne[2]*Ge,R},pe.bezier=function(R,N,W,Y,ne,re){var J=1-re,ue=J*J,ve=re*re,Ie=ue*J,Ge=3*re*ue,ze=3*ve*J,$e=ve*re;return R[0]=N[0]*Ie+W[0]*Ge+Y[0]*ze+ne[0]*$e,R[1]=N[1]*Ie+W[1]*Ge+Y[1]*ze+ne[1]*$e,R[2]=N[2]*Ie+W[2]*Ge+Y[2]*ze+ne[2]*$e,R},pe.random=function(R,N){N=N||1;var W=2*n.RANDOM()*Math.PI,Y=2*n.RANDOM()-1,ne=Math.sqrt(1-Y*Y)*N;return R[0]=Math.cos(W)*ne,R[1]=Math.sin(W)*ne,R[2]=Y*N,R},pe.transformMat4=function(R,N,W){var Y=N[0],ne=N[1],re=N[2],J=W[3]*Y+W[7]*ne+W[11]*re+W[15];return R[0]=(W[0]*Y+W[4]*ne+W[8]*re+W[12])/(J=J||1),R[1]=(W[1]*Y+W[5]*ne+W[9]*re+W[13])/J,R[2]=(W[2]*Y+W[6]*ne+W[10]*re+W[14])/J,R},pe.transformMat3=function(R,N,W){var Y=N[0],ne=N[1],re=N[2];return R[0]=Y*W[0]+ne*W[3]+re*W[6],R[1]=Y*W[1]+ne*W[4]+re*W[7],R[2]=Y*W[2]+ne*W[5]+re*W[8],R},pe.transformQuat=function(R,N,W){var Y=W[0],ne=W[1],re=W[2],J=N[0],ue=N[1],ve=N[2],Ie=ne*ve-re*ue,Ge=re*J-Y*ve,ze=Y*ue-ne*J,$e=ne*ze-re*Ge,st=re*Ie-Y*ze,Fe=Y*Ge-ne*Ie,rt=2*W[3];return Ge*=rt,ze*=rt,st*=2,Fe*=2,R[0]=J+(Ie*=rt)+($e*=2),R[1]=ue+Ge+st,R[2]=ve+ze+Fe,R},pe.rotateX=function(R,N,W,Y){var ne=[],re=[];return ne[0]=N[0]-W[0],ne[1]=N[1]-W[1],ne[2]=N[2]-W[2],re[0]=ne[0],re[1]=ne[1]*Math.cos(Y)-ne[2]*Math.sin(Y),re[2]=ne[1]*Math.sin(Y)+ne[2]*Math.cos(Y),R[0]=re[0]+W[0],R[1]=re[1]+W[1],R[2]=re[2]+W[2],R},pe.rotateY=function(R,N,W,Y){var ne=[],re=[];return ne[0]=N[0]-W[0],ne[1]=N[1]-W[1],ne[2]=N[2]-W[2],re[0]=ne[2]*Math.sin(Y)+ne[0]*Math.cos(Y),re[1]=ne[1],re[2]=ne[2]*Math.cos(Y)-ne[0]*Math.sin(Y),R[0]=re[0]+W[0],R[1]=re[1]+W[1],R[2]=re[2]+W[2],R},pe.rotateZ=function(R,N,W,Y){var ne=[],re=[];return ne[0]=N[0]-W[0],ne[1]=N[1]-W[1],ne[2]=N[2]-W[2],re[0]=ne[0]*Math.cos(Y)-ne[1]*Math.sin(Y),re[1]=ne[0]*Math.sin(Y)+ne[1]*Math.cos(Y),re[2]=ne[2],R[0]=re[0]+W[0],R[1]=re[1]+W[1],R[2]=re[2]+W[2],R},pe.angle=function(R,N){var W=R[0],Y=R[1],ne=R[2],re=N[0],J=N[1],ue=N[2],ve=Math.sqrt(W*W+Y*Y+ne*ne)*Math.sqrt(re*re+J*J+ue*ue),Ie=ve&&A(R,N)/ve;return Math.acos(Math.min(Math.max(Ie,-1),1))},pe.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},pe.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},pe.exactEquals=function(R,N){return R[0]===N[0]&&R[1]===N[1]&&R[2]===N[2]},pe.equals=function(R,N){var W=R[0],Y=R[1],ne=R[2],re=N[0],J=N[1],ue=N[2];return Math.abs(W-re)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(re))&&Math.abs(Y-J)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(J))&&Math.abs(ne-ue)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ue))},pe.forEach=pe.sqrLen=pe.len=pe.sqrDist=pe.dist=pe.div=pe.mul=pe.sub=void 0;var n=function(R,N){if(R&&R.__esModule)return R;if(R===null||c(R)!=="object"&&typeof R!="function")return{default:R};var W=a(void 0);if(W&&W.has(R))return W.get(R);var Y={},ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in R)if(re!=="default"&&Object.prototype.hasOwnProperty.call(R,re)){var J=ne?Object.getOwnPropertyDescriptor(R,re):null;J&&(J.get||J.set)?Object.defineProperty(Y,re,J):Y[re]=R[re]}return Y.default=R,W&&W.set(R,Y),Y}(F());function a(R){if(typeof WeakMap!="function")return null;var N=new WeakMap,W=new WeakMap;return(a=function(Y){return Y?W:N})(R)}function u(){var R=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function m(R){return Math.hypot(R[0],R[1],R[2])}function h(R,N,W){return R[0]=N[0]-W[0],R[1]=N[1]-W[1],R[2]=N[2]-W[2],R}function v(R,N,W){return R[0]=N[0]*W[0],R[1]=N[1]*W[1],R[2]=N[2]*W[2],R}function T(R,N,W){return R[0]=N[0]/W[0],R[1]=N[1]/W[1],R[2]=N[2]/W[2],R}function k(R,N){return Math.hypot(N[0]-R[0],N[1]-R[1],N[2]-R[2])}function L(R,N){var W=N[0]-R[0],Y=N[1]-R[1],ne=N[2]-R[2];return W*W+Y*Y+ne*ne}function x(R){var N=R[0],W=R[1],Y=R[2];return N*N+W*W+Y*Y}function A(R,N){return R[0]*N[0]+R[1]*N[1]+R[2]*N[2]}pe.sub=h,pe.mul=v,pe.div=T,pe.dist=k,pe.sqrDist=L,pe.len=m,pe.sqrLen=x;var O,M=(O=u(),function(R,N,W,Y,ne,re){var J,ue;for(N||(N=3),W||(W=0),ue=Y?Math.min(Y*N+W,R.length):R.length,J=W;J<ue;J+=N)O[0]=R[J],O[1]=R[J+1],O[2]=R[J+2],ne(O,O,re),R[J]=O[0],R[J+1]=O[1],R[J+2]=O[2];return R});return pe.forEach=M,pe}var De,tt,Me={};function xe(){if(De)return Me;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(M)}De=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.create=u,Me.clone=function(M){var R=new n.ARRAY_TYPE(4);return R[0]=M[0],R[1]=M[1],R[2]=M[2],R[3]=M[3],R},Me.fromValues=function(M,R,N,W){var Y=new n.ARRAY_TYPE(4);return Y[0]=M,Y[1]=R,Y[2]=N,Y[3]=W,Y},Me.copy=function(M,R){return M[0]=R[0],M[1]=R[1],M[2]=R[2],M[3]=R[3],M},Me.set=function(M,R,N,W,Y){return M[0]=R,M[1]=N,M[2]=W,M[3]=Y,M},Me.add=function(M,R,N){return M[0]=R[0]+N[0],M[1]=R[1]+N[1],M[2]=R[2]+N[2],M[3]=R[3]+N[3],M},Me.subtract=m,Me.multiply=h,Me.divide=v,Me.ceil=function(M,R){return M[0]=Math.ceil(R[0]),M[1]=Math.ceil(R[1]),M[2]=Math.ceil(R[2]),M[3]=Math.ceil(R[3]),M},Me.floor=function(M,R){return M[0]=Math.floor(R[0]),M[1]=Math.floor(R[1]),M[2]=Math.floor(R[2]),M[3]=Math.floor(R[3]),M},Me.min=function(M,R,N){return M[0]=Math.min(R[0],N[0]),M[1]=Math.min(R[1],N[1]),M[2]=Math.min(R[2],N[2]),M[3]=Math.min(R[3],N[3]),M},Me.max=function(M,R,N){return M[0]=Math.max(R[0],N[0]),M[1]=Math.max(R[1],N[1]),M[2]=Math.max(R[2],N[2]),M[3]=Math.max(R[3],N[3]),M},Me.round=function(M,R){return M[0]=Math.round(R[0]),M[1]=Math.round(R[1]),M[2]=Math.round(R[2]),M[3]=Math.round(R[3]),M},Me.scale=function(M,R,N){return M[0]=R[0]*N,M[1]=R[1]*N,M[2]=R[2]*N,M[3]=R[3]*N,M},Me.scaleAndAdd=function(M,R,N,W){return M[0]=R[0]+N[0]*W,M[1]=R[1]+N[1]*W,M[2]=R[2]+N[2]*W,M[3]=R[3]+N[3]*W,M},Me.distance=T,Me.squaredDistance=k,Me.length=L,Me.squaredLength=x,Me.negate=function(M,R){return M[0]=-R[0],M[1]=-R[1],M[2]=-R[2],M[3]=-R[3],M},Me.inverse=function(M,R){return M[0]=1/R[0],M[1]=1/R[1],M[2]=1/R[2],M[3]=1/R[3],M},Me.normalize=function(M,R){var N=R[0],W=R[1],Y=R[2],ne=R[3],re=N*N+W*W+Y*Y+ne*ne;return re>0&&(re=1/Math.sqrt(re)),M[0]=N*re,M[1]=W*re,M[2]=Y*re,M[3]=ne*re,M},Me.dot=function(M,R){return M[0]*R[0]+M[1]*R[1]+M[2]*R[2]+M[3]*R[3]},Me.cross=function(M,R,N,W){var Y=N[0]*W[1]-N[1]*W[0],ne=N[0]*W[2]-N[2]*W[0],re=N[0]*W[3]-N[3]*W[0],J=N[1]*W[2]-N[2]*W[1],ue=N[1]*W[3]-N[3]*W[1],ve=N[2]*W[3]-N[3]*W[2],Ie=R[0],Ge=R[1],ze=R[2],$e=R[3];return M[0]=Ge*ve-ze*ue+$e*J,M[1]=-Ie*ve+ze*re-$e*ne,M[2]=Ie*ue-Ge*re+$e*Y,M[3]=-Ie*J+Ge*ne-ze*Y,M},Me.lerp=function(M,R,N,W){var Y=R[0],ne=R[1],re=R[2],J=R[3];return M[0]=Y+W*(N[0]-Y),M[1]=ne+W*(N[1]-ne),M[2]=re+W*(N[2]-re),M[3]=J+W*(N[3]-J),M},Me.random=function(M,R){var N,W,Y,ne,re,J;R=R||1;do re=(N=2*n.RANDOM()-1)*N+(W=2*n.RANDOM()-1)*W;while(re>=1);do J=(Y=2*n.RANDOM()-1)*Y+(ne=2*n.RANDOM()-1)*ne;while(J>=1);var ue=Math.sqrt((1-re)/J);return M[0]=R*N,M[1]=R*W,M[2]=R*Y*ue,M[3]=R*ne*ue,M},Me.transformMat4=function(M,R,N){var W=R[0],Y=R[1],ne=R[2],re=R[3];return M[0]=N[0]*W+N[4]*Y+N[8]*ne+N[12]*re,M[1]=N[1]*W+N[5]*Y+N[9]*ne+N[13]*re,M[2]=N[2]*W+N[6]*Y+N[10]*ne+N[14]*re,M[3]=N[3]*W+N[7]*Y+N[11]*ne+N[15]*re,M},Me.transformQuat=function(M,R,N){var W=R[0],Y=R[1],ne=R[2],re=N[0],J=N[1],ue=N[2],ve=N[3],Ie=ve*W+J*ne-ue*Y,Ge=ve*Y+ue*W-re*ne,ze=ve*ne+re*Y-J*W,$e=-re*W-J*Y-ue*ne;return M[0]=Ie*ve+$e*-re+Ge*-ue-ze*-J,M[1]=Ge*ve+$e*-J+ze*-re-Ie*-ue,M[2]=ze*ve+$e*-ue+Ie*-J-Ge*-re,M[3]=R[3],M},Me.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M[3]=0,M},Me.str=function(M){return"vec4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+")"},Me.exactEquals=function(M,R){return M[0]===R[0]&&M[1]===R[1]&&M[2]===R[2]&&M[3]===R[3]},Me.equals=function(M,R){var N=M[0],W=M[1],Y=M[2],ne=M[3],re=R[0],J=R[1],ue=R[2],ve=R[3];return Math.abs(N-re)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(re))&&Math.abs(W-J)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(J))&&Math.abs(Y-ue)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ue))&&Math.abs(ne-ve)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ve))},Me.forEach=Me.sqrLen=Me.len=Me.sqrDist=Me.dist=Me.div=Me.mul=Me.sub=void 0;var n=function(M,R){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var N=a(void 0);if(N&&N.has(M))return N.get(M);var W={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var re=Y?Object.getOwnPropertyDescriptor(M,ne):null;re&&(re.get||re.set)?Object.defineProperty(W,ne,re):W[ne]=M[ne]}return W.default=M,N&&N.set(M,W),W}(F());function a(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,N=new WeakMap;return(a=function(W){return W?N:R})(M)}function u(){var M=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M}function m(M,R,N){return M[0]=R[0]-N[0],M[1]=R[1]-N[1],M[2]=R[2]-N[2],M[3]=R[3]-N[3],M}function h(M,R,N){return M[0]=R[0]*N[0],M[1]=R[1]*N[1],M[2]=R[2]*N[2],M[3]=R[3]*N[3],M}function v(M,R,N){return M[0]=R[0]/N[0],M[1]=R[1]/N[1],M[2]=R[2]/N[2],M[3]=R[3]/N[3],M}function T(M,R){return Math.hypot(R[0]-M[0],R[1]-M[1],R[2]-M[2],R[3]-M[3])}function k(M,R){var N=R[0]-M[0],W=R[1]-M[1],Y=R[2]-M[2],ne=R[3]-M[3];return N*N+W*W+Y*Y+ne*ne}function L(M){return Math.hypot(M[0],M[1],M[2],M[3])}function x(M){var R=M[0],N=M[1],W=M[2],Y=M[3];return R*R+N*N+W*W+Y*Y}Me.sub=m,Me.mul=h,Me.div=v,Me.dist=T,Me.sqrDist=k,Me.len=L,Me.sqrLen=x;var A,O=(A=u(),function(M,R,N,W,Y,ne){var re,J;for(R||(R=4),N||(N=0),J=W?Math.min(W*R+N,M.length):M.length,re=N;re<J;re+=R)A[0]=M[re],A[1]=M[re+1],A[2]=M[re+2],A[3]=M[re+3],Y(A,A,ne),M[re]=A[0],M[re+1]=A[1],M[re+2]=A[2],M[re+3]=A[3];return M});return Me.forEach=O,Me}function Ae(){if(tt)return ce;function c(Fe){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(rt){return typeof rt}:function(rt){return rt&&typeof Symbol=="function"&&rt.constructor===Symbol&&rt!==Symbol.prototype?"symbol":typeof rt},c(Fe)}tt=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.create=T,ce.identity=function(Fe){return Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=1,Fe},ce.setAxisAngle=k,ce.getAxisAngle=function(Fe,rt){var ht=2*Math.acos(rt[3]),pt=Math.sin(ht/2);return pt>n.EPSILON?(Fe[0]=rt[0]/pt,Fe[1]=rt[1]/pt,Fe[2]=rt[2]/pt):(Fe[0]=1,Fe[1]=0,Fe[2]=0),ht},ce.getAngle=function(Fe,rt){var ht=N(Fe,rt);return Math.acos(2*ht*ht-1)},ce.multiply=L,ce.rotateX=function(Fe,rt,ht){ht*=.5;var pt=rt[0],Tt=rt[1],Ot=rt[2],Ft=rt[3],Pt=Math.sin(ht),sn=Math.cos(ht);return Fe[0]=pt*sn+Ft*Pt,Fe[1]=Tt*sn+Ot*Pt,Fe[2]=Ot*sn-Tt*Pt,Fe[3]=Ft*sn-pt*Pt,Fe},ce.rotateY=function(Fe,rt,ht){ht*=.5;var pt=rt[0],Tt=rt[1],Ot=rt[2],Ft=rt[3],Pt=Math.sin(ht),sn=Math.cos(ht);return Fe[0]=pt*sn-Ot*Pt,Fe[1]=Tt*sn+Ft*Pt,Fe[2]=Ot*sn+pt*Pt,Fe[3]=Ft*sn-Tt*Pt,Fe},ce.rotateZ=function(Fe,rt,ht){ht*=.5;var pt=rt[0],Tt=rt[1],Ot=rt[2],Ft=rt[3],Pt=Math.sin(ht),sn=Math.cos(ht);return Fe[0]=pt*sn+Tt*Pt,Fe[1]=Tt*sn-pt*Pt,Fe[2]=Ot*sn+Ft*Pt,Fe[3]=Ft*sn-Ot*Pt,Fe},ce.calculateW=function(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2];return Fe[0]=ht,Fe[1]=pt,Fe[2]=Tt,Fe[3]=Math.sqrt(Math.abs(1-ht*ht-pt*pt-Tt*Tt)),Fe},ce.exp=x,ce.ln=A,ce.pow=function(Fe,rt,ht){return A(Fe,rt),R(Fe,Fe,ht),x(Fe,Fe),Fe},ce.slerp=O,ce.random=function(Fe){var rt=n.RANDOM(),ht=n.RANDOM(),pt=n.RANDOM(),Tt=Math.sqrt(1-rt),Ot=Math.sqrt(rt);return Fe[0]=Tt*Math.sin(2*Math.PI*ht),Fe[1]=Tt*Math.cos(2*Math.PI*ht),Fe[2]=Ot*Math.sin(2*Math.PI*pt),Fe[3]=Ot*Math.cos(2*Math.PI*pt),Fe},ce.invert=function(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2],Ot=rt[3],Ft=ht*ht+pt*pt+Tt*Tt+Ot*Ot,Pt=Ft?1/Ft:0;return Fe[0]=-ht*Pt,Fe[1]=-pt*Pt,Fe[2]=-Tt*Pt,Fe[3]=Ot*Pt,Fe},ce.conjugate=function(Fe,rt){return Fe[0]=-rt[0],Fe[1]=-rt[1],Fe[2]=-rt[2],Fe[3]=rt[3],Fe},ce.fromMat3=M,ce.fromEuler=function(Fe,rt,ht,pt){var Tt=.5*Math.PI/180;rt*=Tt,ht*=Tt,pt*=Tt;var Ot=Math.sin(rt),Ft=Math.cos(rt),Pt=Math.sin(ht),sn=Math.cos(ht),Cn=Math.sin(pt),Jt=Math.cos(pt);return Fe[0]=Ot*sn*Jt-Ft*Pt*Cn,Fe[1]=Ft*Pt*Jt+Ot*sn*Cn,Fe[2]=Ft*sn*Cn-Ot*Pt*Jt,Fe[3]=Ft*sn*Jt+Ot*Pt*Cn,Fe},ce.str=function(Fe){return"quat("+Fe[0]+", "+Fe[1]+", "+Fe[2]+", "+Fe[3]+")"},ce.setAxes=ce.sqlerp=ce.rotationTo=ce.equals=ce.exactEquals=ce.normalize=ce.sqrLen=ce.squaredLength=ce.len=ce.length=ce.lerp=ce.dot=ce.scale=ce.mul=ce.add=ce.set=ce.copy=ce.fromValues=ce.clone=void 0;var n=v(F()),a=v(Q()),u=v(ye()),m=v(xe());function h(Fe){if(typeof WeakMap!="function")return null;var rt=new WeakMap,ht=new WeakMap;return(h=function(pt){return pt?ht:rt})(Fe)}function v(Fe,rt){if(Fe&&Fe.__esModule)return Fe;if(Fe===null||c(Fe)!=="object"&&typeof Fe!="function")return{default:Fe};var ht=h(rt);if(ht&&ht.has(Fe))return ht.get(Fe);var pt={},Tt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ot in Fe)if(Ot!=="default"&&Object.prototype.hasOwnProperty.call(Fe,Ot)){var Ft=Tt?Object.getOwnPropertyDescriptor(Fe,Ot):null;Ft&&(Ft.get||Ft.set)?Object.defineProperty(pt,Ot,Ft):pt[Ot]=Fe[Ot]}return pt.default=Fe,ht&&ht.set(Fe,pt),pt}function T(){var Fe=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(Fe[0]=0,Fe[1]=0,Fe[2]=0),Fe[3]=1,Fe}function k(Fe,rt,ht){ht*=.5;var pt=Math.sin(ht);return Fe[0]=pt*rt[0],Fe[1]=pt*rt[1],Fe[2]=pt*rt[2],Fe[3]=Math.cos(ht),Fe}function L(Fe,rt,ht){var pt=rt[0],Tt=rt[1],Ot=rt[2],Ft=rt[3],Pt=ht[0],sn=ht[1],Cn=ht[2],Jt=ht[3];return Fe[0]=pt*Jt+Ft*Pt+Tt*Cn-Ot*sn,Fe[1]=Tt*Jt+Ft*sn+Ot*Pt-pt*Cn,Fe[2]=Ot*Jt+Ft*Cn+pt*sn-Tt*Pt,Fe[3]=Ft*Jt-pt*Pt-Tt*sn-Ot*Cn,Fe}function x(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2],Ot=rt[3],Ft=Math.sqrt(ht*ht+pt*pt+Tt*Tt),Pt=Math.exp(Ot),sn=Ft>0?Pt*Math.sin(Ft)/Ft:0;return Fe[0]=ht*sn,Fe[1]=pt*sn,Fe[2]=Tt*sn,Fe[3]=Pt*Math.cos(Ft),Fe}function A(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2],Ot=rt[3],Ft=Math.sqrt(ht*ht+pt*pt+Tt*Tt),Pt=Ft>0?Math.atan2(Ft,Ot)/Ft:0;return Fe[0]=ht*Pt,Fe[1]=pt*Pt,Fe[2]=Tt*Pt,Fe[3]=.5*Math.log(ht*ht+pt*pt+Tt*Tt+Ot*Ot),Fe}function O(Fe,rt,ht,pt){var Tt,Ot,Ft,Pt,sn,Cn=rt[0],Jt=rt[1],Jn=rt[2],Fn=rt[3],Pn=ht[0],Sn=ht[1],wo=ht[2],Xn=ht[3];return(Ot=Cn*Pn+Jt*Sn+Jn*wo+Fn*Xn)<0&&(Ot=-Ot,Pn=-Pn,Sn=-Sn,wo=-wo,Xn=-Xn),1-Ot>n.EPSILON?(Tt=Math.acos(Ot),Ft=Math.sin(Tt),Pt=Math.sin((1-pt)*Tt)/Ft,sn=Math.sin(pt*Tt)/Ft):(Pt=1-pt,sn=pt),Fe[0]=Pt*Cn+sn*Pn,Fe[1]=Pt*Jt+sn*Sn,Fe[2]=Pt*Jn+sn*wo,Fe[3]=Pt*Fn+sn*Xn,Fe}function M(Fe,rt){var ht,pt=rt[0]+rt[4]+rt[8];if(pt>0)ht=Math.sqrt(pt+1),Fe[3]=.5*ht,Fe[0]=(rt[5]-rt[7])*(ht=.5/ht),Fe[1]=(rt[6]-rt[2])*ht,Fe[2]=(rt[1]-rt[3])*ht;else{var Tt=0;rt[4]>rt[0]&&(Tt=1),rt[8]>rt[3*Tt+Tt]&&(Tt=2);var Ot=(Tt+1)%3,Ft=(Tt+2)%3;ht=Math.sqrt(rt[3*Tt+Tt]-rt[3*Ot+Ot]-rt[3*Ft+Ft]+1),Fe[Tt]=.5*ht,Fe[3]=(rt[3*Ot+Ft]-rt[3*Ft+Ot])*(ht=.5/ht),Fe[Ot]=(rt[3*Ot+Tt]+rt[3*Tt+Ot])*ht,Fe[Ft]=(rt[3*Ft+Tt]+rt[3*Tt+Ft])*ht}return Fe}ce.clone=m.clone,ce.fromValues=m.fromValues,ce.copy=m.copy,ce.set=m.set,ce.add=m.add,ce.mul=L;var R=m.scale;ce.scale=R;var N=m.dot;ce.dot=N,ce.lerp=m.lerp;var W=m.length;ce.length=W,ce.len=W;var Y=m.squaredLength;ce.squaredLength=Y,ce.sqrLen=Y;var ne=m.normalize;ce.normalize=ne,ce.exactEquals=m.exactEquals,ce.equals=m.equals;var re,J,ue,ve=(re=u.create(),J=u.fromValues(1,0,0),ue=u.fromValues(0,1,0),function(Fe,rt,ht){var pt=u.dot(rt,ht);return pt<-.999999?(u.cross(re,J,rt),u.len(re)<1e-6&&u.cross(re,ue,rt),u.normalize(re,re),k(Fe,re,Math.PI),Fe):pt>.999999?(Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=1,Fe):(u.cross(re,rt,ht),Fe[0]=re[0],Fe[1]=re[1],Fe[2]=re[2],Fe[3]=1+pt,ne(Fe,Fe))});ce.rotationTo=ve;var Ie,Ge,ze=(Ie=T(),Ge=T(),function(Fe,rt,ht,pt,Tt,Ot){return O(Ie,rt,Tt,Ot),O(Ge,ht,pt,Ot),O(Fe,Ie,Ge,2*Ot*(1-Ot)),Fe});ce.sqlerp=ze;var $e,st=($e=a.create(),function(Fe,rt,ht,pt){return $e[0]=ht[0],$e[3]=ht[1],$e[6]=ht[2],$e[1]=pt[0],$e[4]=pt[1],$e[7]=pt[2],$e[2]=-rt[0],$e[5]=-rt[1],$e[8]=-rt[2],ne(Fe,M(Fe,$e))});return ce.setAxes=st,ce}var Ce,ge={};function Ne(){if(Ce)return ge;function c(O){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},c(O)}Ce=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.create=function(){var O=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0,O[4]=0,O[5]=0,O[6]=0,O[7]=0),O[3]=1,O},ge.clone=function(O){var M=new n.ARRAY_TYPE(8);return M[0]=O[0],M[1]=O[1],M[2]=O[2],M[3]=O[3],M[4]=O[4],M[5]=O[5],M[6]=O[6],M[7]=O[7],M},ge.fromValues=function(O,M,R,N,W,Y,ne,re){var J=new n.ARRAY_TYPE(8);return J[0]=O,J[1]=M,J[2]=R,J[3]=N,J[4]=W,J[5]=Y,J[6]=ne,J[7]=re,J},ge.fromRotationTranslationValues=function(O,M,R,N,W,Y,ne){var re=new n.ARRAY_TYPE(8);re[0]=O,re[1]=M,re[2]=R,re[3]=N;var J=.5*W,ue=.5*Y,ve=.5*ne;return re[4]=J*N+ue*R-ve*M,re[5]=ue*N+ve*O-J*R,re[6]=ve*N+J*M-ue*O,re[7]=-J*O-ue*M-ve*R,re},ge.fromRotationTranslation=v,ge.fromTranslation=function(O,M){return O[0]=0,O[1]=0,O[2]=0,O[3]=1,O[4]=.5*M[0],O[5]=.5*M[1],O[6]=.5*M[2],O[7]=0,O},ge.fromRotation=function(O,M){return O[0]=M[0],O[1]=M[1],O[2]=M[2],O[3]=M[3],O[4]=0,O[5]=0,O[6]=0,O[7]=0,O},ge.fromMat4=function(O,M){var R=a.create();u.getRotation(R,M);var N=new n.ARRAY_TYPE(3);return u.getTranslation(N,M),v(O,R,N),O},ge.copy=T,ge.identity=function(O){return O[0]=0,O[1]=0,O[2]=0,O[3]=1,O[4]=0,O[5]=0,O[6]=0,O[7]=0,O},ge.set=function(O,M,R,N,W,Y,ne,re,J){return O[0]=M,O[1]=R,O[2]=N,O[3]=W,O[4]=Y,O[5]=ne,O[6]=re,O[7]=J,O},ge.getDual=function(O,M){return O[0]=M[4],O[1]=M[5],O[2]=M[6],O[3]=M[7],O},ge.setDual=function(O,M){return O[4]=M[0],O[5]=M[1],O[6]=M[2],O[7]=M[3],O},ge.getTranslation=function(O,M){var R=M[4],N=M[5],W=M[6],Y=M[7],ne=-M[0],re=-M[1],J=-M[2],ue=M[3];return O[0]=2*(R*ue+Y*ne+N*J-W*re),O[1]=2*(N*ue+Y*re+W*ne-R*J),O[2]=2*(W*ue+Y*J+R*re-N*ne),O},ge.translate=function(O,M,R){var N=M[0],W=M[1],Y=M[2],ne=M[3],re=.5*R[0],J=.5*R[1],ue=.5*R[2],ve=M[4],Ie=M[5],Ge=M[6],ze=M[7];return O[0]=N,O[1]=W,O[2]=Y,O[3]=ne,O[4]=ne*re+W*ue-Y*J+ve,O[5]=ne*J+Y*re-N*ue+Ie,O[6]=ne*ue+N*J-W*re+Ge,O[7]=-N*re-W*J-Y*ue+ze,O},ge.rotateX=function(O,M,R){var N=-M[0],W=-M[1],Y=-M[2],ne=M[3],re=M[4],J=M[5],ue=M[6],ve=M[7],Ie=re*ne+ve*N+J*Y-ue*W,Ge=J*ne+ve*W+ue*N-re*Y,ze=ue*ne+ve*Y+re*W-J*N,$e=ve*ne-re*N-J*W-ue*Y;return a.rotateX(O,M,R),O[4]=Ie*(ne=O[3])+$e*(N=O[0])+Ge*(Y=O[2])-ze*(W=O[1]),O[5]=Ge*ne+$e*W+ze*N-Ie*Y,O[6]=ze*ne+$e*Y+Ie*W-Ge*N,O[7]=$e*ne-Ie*N-Ge*W-ze*Y,O},ge.rotateY=function(O,M,R){var N=-M[0],W=-M[1],Y=-M[2],ne=M[3],re=M[4],J=M[5],ue=M[6],ve=M[7],Ie=re*ne+ve*N+J*Y-ue*W,Ge=J*ne+ve*W+ue*N-re*Y,ze=ue*ne+ve*Y+re*W-J*N,$e=ve*ne-re*N-J*W-ue*Y;return a.rotateY(O,M,R),O[4]=Ie*(ne=O[3])+$e*(N=O[0])+Ge*(Y=O[2])-ze*(W=O[1]),O[5]=Ge*ne+$e*W+ze*N-Ie*Y,O[6]=ze*ne+$e*Y+Ie*W-Ge*N,O[7]=$e*ne-Ie*N-Ge*W-ze*Y,O},ge.rotateZ=function(O,M,R){var N=-M[0],W=-M[1],Y=-M[2],ne=M[3],re=M[4],J=M[5],ue=M[6],ve=M[7],Ie=re*ne+ve*N+J*Y-ue*W,Ge=J*ne+ve*W+ue*N-re*Y,ze=ue*ne+ve*Y+re*W-J*N,$e=ve*ne-re*N-J*W-ue*Y;return a.rotateZ(O,M,R),O[4]=Ie*(ne=O[3])+$e*(N=O[0])+Ge*(Y=O[2])-ze*(W=O[1]),O[5]=Ge*ne+$e*W+ze*N-Ie*Y,O[6]=ze*ne+$e*Y+Ie*W-Ge*N,O[7]=$e*ne-Ie*N-Ge*W-ze*Y,O},ge.rotateByQuatAppend=function(O,M,R){var N=R[0],W=R[1],Y=R[2],ne=R[3],re=M[0],J=M[1],ue=M[2],ve=M[3];return O[0]=re*ne+ve*N+J*Y-ue*W,O[1]=J*ne+ve*W+ue*N-re*Y,O[2]=ue*ne+ve*Y+re*W-J*N,O[3]=ve*ne-re*N-J*W-ue*Y,O[4]=(re=M[4])*ne+(ve=M[7])*N+(J=M[5])*Y-(ue=M[6])*W,O[5]=J*ne+ve*W+ue*N-re*Y,O[6]=ue*ne+ve*Y+re*W-J*N,O[7]=ve*ne-re*N-J*W-ue*Y,O},ge.rotateByQuatPrepend=function(O,M,R){var N=M[0],W=M[1],Y=M[2],ne=M[3],re=R[0],J=R[1],ue=R[2],ve=R[3];return O[0]=N*ve+ne*re+W*ue-Y*J,O[1]=W*ve+ne*J+Y*re-N*ue,O[2]=Y*ve+ne*ue+N*J-W*re,O[3]=ne*ve-N*re-W*J-Y*ue,O[4]=N*(ve=R[7])+ne*(re=R[4])+W*(ue=R[6])-Y*(J=R[5]),O[5]=W*ve+ne*J+Y*re-N*ue,O[6]=Y*ve+ne*ue+N*J-W*re,O[7]=ne*ve-N*re-W*J-Y*ue,O},ge.rotateAroundAxis=function(O,M,R,N){if(Math.abs(N)<n.EPSILON)return T(O,M);var W=Math.hypot(R[0],R[1],R[2]);N*=.5;var Y=Math.sin(N),ne=Y*R[0]/W,re=Y*R[1]/W,J=Y*R[2]/W,ue=Math.cos(N),ve=M[0],Ie=M[1],Ge=M[2],ze=M[3];O[0]=ve*ue+ze*ne+Ie*J-Ge*re,O[1]=Ie*ue+ze*re+Ge*ne-ve*J,O[2]=Ge*ue+ze*J+ve*re-Ie*ne,O[3]=ze*ue-ve*ne-Ie*re-Ge*J;var $e=M[4],st=M[5],Fe=M[6],rt=M[7];return O[4]=$e*ue+rt*ne+st*J-Fe*re,O[5]=st*ue+rt*re+Fe*ne-$e*J,O[6]=Fe*ue+rt*J+$e*re-st*ne,O[7]=rt*ue-$e*ne-st*re-Fe*J,O},ge.add=function(O,M,R){return O[0]=M[0]+R[0],O[1]=M[1]+R[1],O[2]=M[2]+R[2],O[3]=M[3]+R[3],O[4]=M[4]+R[4],O[5]=M[5]+R[5],O[6]=M[6]+R[6],O[7]=M[7]+R[7],O},ge.multiply=k,ge.scale=function(O,M,R){return O[0]=M[0]*R,O[1]=M[1]*R,O[2]=M[2]*R,O[3]=M[3]*R,O[4]=M[4]*R,O[5]=M[5]*R,O[6]=M[6]*R,O[7]=M[7]*R,O},ge.lerp=function(O,M,R,N){var W=1-N;return L(M,R)<0&&(N=-N),O[0]=M[0]*W+R[0]*N,O[1]=M[1]*W+R[1]*N,O[2]=M[2]*W+R[2]*N,O[3]=M[3]*W+R[3]*N,O[4]=M[4]*W+R[4]*N,O[5]=M[5]*W+R[5]*N,O[6]=M[6]*W+R[6]*N,O[7]=M[7]*W+R[7]*N,O},ge.invert=function(O,M){var R=A(M);return O[0]=-M[0]/R,O[1]=-M[1]/R,O[2]=-M[2]/R,O[3]=M[3]/R,O[4]=-M[4]/R,O[5]=-M[5]/R,O[6]=-M[6]/R,O[7]=M[7]/R,O},ge.conjugate=function(O,M){return O[0]=-M[0],O[1]=-M[1],O[2]=-M[2],O[3]=M[3],O[4]=-M[4],O[5]=-M[5],O[6]=-M[6],O[7]=M[7],O},ge.normalize=function(O,M){var R=A(M);if(R>0){R=Math.sqrt(R);var N=M[0]/R,W=M[1]/R,Y=M[2]/R,ne=M[3]/R,re=M[4],J=M[5],ue=M[6],ve=M[7],Ie=N*re+W*J+Y*ue+ne*ve;O[0]=N,O[1]=W,O[2]=Y,O[3]=ne,O[4]=(re-N*Ie)/R,O[5]=(J-W*Ie)/R,O[6]=(ue-Y*Ie)/R,O[7]=(ve-ne*Ie)/R}return O},ge.str=function(O){return"quat2("+O[0]+", "+O[1]+", "+O[2]+", "+O[3]+", "+O[4]+", "+O[5]+", "+O[6]+", "+O[7]+")"},ge.exactEquals=function(O,M){return O[0]===M[0]&&O[1]===M[1]&&O[2]===M[2]&&O[3]===M[3]&&O[4]===M[4]&&O[5]===M[5]&&O[6]===M[6]&&O[7]===M[7]},ge.equals=function(O,M){var R=O[0],N=O[1],W=O[2],Y=O[3],ne=O[4],re=O[5],J=O[6],ue=O[7],ve=M[0],Ie=M[1],Ge=M[2],ze=M[3],$e=M[4],st=M[5],Fe=M[6],rt=M[7];return Math.abs(R-ve)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ve))&&Math.abs(N-Ie)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(Ie))&&Math.abs(W-Ge)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ge))&&Math.abs(Y-ze)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ze))&&Math.abs(ne-$e)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs($e))&&Math.abs(re-st)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(st))&&Math.abs(J-Fe)<=n.EPSILON*Math.max(1,Math.abs(J),Math.abs(Fe))&&Math.abs(ue-rt)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(rt))},ge.sqrLen=ge.squaredLength=ge.len=ge.length=ge.dot=ge.mul=ge.setReal=ge.getReal=void 0;var n=h(F()),a=h(Ae()),u=h(me());function m(O){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(m=function(N){return N?R:M})(O)}function h(O,M){if(O&&O.__esModule)return O;if(O===null||c(O)!=="object"&&typeof O!="function")return{default:O};var R=m(M);if(R&&R.has(O))return R.get(O);var N={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Y in O)if(Y!=="default"&&Object.prototype.hasOwnProperty.call(O,Y)){var ne=W?Object.getOwnPropertyDescriptor(O,Y):null;ne&&(ne.get||ne.set)?Object.defineProperty(N,Y,ne):N[Y]=O[Y]}return N.default=O,R&&R.set(O,N),N}function v(O,M,R){var N=.5*R[0],W=.5*R[1],Y=.5*R[2],ne=M[0],re=M[1],J=M[2],ue=M[3];return O[0]=ne,O[1]=re,O[2]=J,O[3]=ue,O[4]=N*ue+W*J-Y*re,O[5]=W*ue+Y*ne-N*J,O[6]=Y*ue+N*re-W*ne,O[7]=-N*ne-W*re-Y*J,O}function T(O,M){return O[0]=M[0],O[1]=M[1],O[2]=M[2],O[3]=M[3],O[4]=M[4],O[5]=M[5],O[6]=M[6],O[7]=M[7],O}function k(O,M,R){var N=M[0],W=M[1],Y=M[2],ne=M[3],re=R[4],J=R[5],ue=R[6],ve=R[7],Ie=M[4],Ge=M[5],ze=M[6],$e=M[7],st=R[0],Fe=R[1],rt=R[2],ht=R[3];return O[0]=N*ht+ne*st+W*rt-Y*Fe,O[1]=W*ht+ne*Fe+Y*st-N*rt,O[2]=Y*ht+ne*rt+N*Fe-W*st,O[3]=ne*ht-N*st-W*Fe-Y*rt,O[4]=N*ve+ne*re+W*ue-Y*J+Ie*ht+$e*st+Ge*rt-ze*Fe,O[5]=W*ve+ne*J+Y*re-N*ue+Ge*ht+$e*Fe+ze*st-Ie*rt,O[6]=Y*ve+ne*ue+N*J-W*re+ze*ht+$e*rt+Ie*Fe-Ge*st,O[7]=ne*ve-N*re-W*J-Y*ue+$e*ht-Ie*st-Ge*Fe-ze*rt,O}ge.getReal=a.copy,ge.setReal=a.copy,ge.mul=k;var L=a.dot;ge.dot=L;var x=a.length;ge.length=x,ge.len=x;var A=a.squaredLength;return ge.squaredLength=A,ge.sqrLen=A,ge}var We,ot,Oe={};function Ct(){if(We)return Oe;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(M)}We=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.create=u,Oe.clone=function(M){var R=new n.ARRAY_TYPE(2);return R[0]=M[0],R[1]=M[1],R},Oe.fromValues=function(M,R){var N=new n.ARRAY_TYPE(2);return N[0]=M,N[1]=R,N},Oe.copy=function(M,R){return M[0]=R[0],M[1]=R[1],M},Oe.set=function(M,R,N){return M[0]=R,M[1]=N,M},Oe.add=function(M,R,N){return M[0]=R[0]+N[0],M[1]=R[1]+N[1],M},Oe.subtract=m,Oe.multiply=h,Oe.divide=v,Oe.ceil=function(M,R){return M[0]=Math.ceil(R[0]),M[1]=Math.ceil(R[1]),M},Oe.floor=function(M,R){return M[0]=Math.floor(R[0]),M[1]=Math.floor(R[1]),M},Oe.min=function(M,R,N){return M[0]=Math.min(R[0],N[0]),M[1]=Math.min(R[1],N[1]),M},Oe.max=function(M,R,N){return M[0]=Math.max(R[0],N[0]),M[1]=Math.max(R[1],N[1]),M},Oe.round=function(M,R){return M[0]=Math.round(R[0]),M[1]=Math.round(R[1]),M},Oe.scale=function(M,R,N){return M[0]=R[0]*N,M[1]=R[1]*N,M},Oe.scaleAndAdd=function(M,R,N,W){return M[0]=R[0]+N[0]*W,M[1]=R[1]+N[1]*W,M},Oe.distance=T,Oe.squaredDistance=k,Oe.length=L,Oe.squaredLength=x,Oe.negate=function(M,R){return M[0]=-R[0],M[1]=-R[1],M},Oe.inverse=function(M,R){return M[0]=1/R[0],M[1]=1/R[1],M},Oe.normalize=function(M,R){var N=R[0],W=R[1],Y=N*N+W*W;return Y>0&&(Y=1/Math.sqrt(Y)),M[0]=R[0]*Y,M[1]=R[1]*Y,M},Oe.dot=function(M,R){return M[0]*R[0]+M[1]*R[1]},Oe.cross=function(M,R,N){var W=R[0]*N[1]-R[1]*N[0];return M[0]=M[1]=0,M[2]=W,M},Oe.lerp=function(M,R,N,W){var Y=R[0],ne=R[1];return M[0]=Y+W*(N[0]-Y),M[1]=ne+W*(N[1]-ne),M},Oe.random=function(M,R){R=R||1;var N=2*n.RANDOM()*Math.PI;return M[0]=Math.cos(N)*R,M[1]=Math.sin(N)*R,M},Oe.transformMat2=function(M,R,N){var W=R[0],Y=R[1];return M[0]=N[0]*W+N[2]*Y,M[1]=N[1]*W+N[3]*Y,M},Oe.transformMat2d=function(M,R,N){var W=R[0],Y=R[1];return M[0]=N[0]*W+N[2]*Y+N[4],M[1]=N[1]*W+N[3]*Y+N[5],M},Oe.transformMat3=function(M,R,N){var W=R[0],Y=R[1];return M[0]=N[0]*W+N[3]*Y+N[6],M[1]=N[1]*W+N[4]*Y+N[7],M},Oe.transformMat4=function(M,R,N){var W=R[0],Y=R[1];return M[0]=N[0]*W+N[4]*Y+N[12],M[1]=N[1]*W+N[5]*Y+N[13],M},Oe.rotate=function(M,R,N,W){var Y=R[0]-N[0],ne=R[1]-N[1],re=Math.sin(W),J=Math.cos(W);return M[0]=Y*J-ne*re+N[0],M[1]=Y*re+ne*J+N[1],M},Oe.angle=function(M,R){var N=M[0],W=M[1],Y=R[0],ne=R[1],re=Math.sqrt(N*N+W*W)*Math.sqrt(Y*Y+ne*ne);return Math.acos(Math.min(Math.max(re&&(N*Y+W*ne)/re,-1),1))},Oe.zero=function(M){return M[0]=0,M[1]=0,M},Oe.str=function(M){return"vec2("+M[0]+", "+M[1]+")"},Oe.exactEquals=function(M,R){return M[0]===R[0]&&M[1]===R[1]},Oe.equals=function(M,R){var N=M[0],W=M[1],Y=R[0],ne=R[1];return Math.abs(N-Y)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(Y))&&Math.abs(W-ne)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ne))},Oe.forEach=Oe.sqrLen=Oe.sqrDist=Oe.dist=Oe.div=Oe.mul=Oe.sub=Oe.len=void 0;var n=function(M,R){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var N=a(void 0);if(N&&N.has(M))return N.get(M);var W={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var re=Y?Object.getOwnPropertyDescriptor(M,ne):null;re&&(re.get||re.set)?Object.defineProperty(W,ne,re):W[ne]=M[ne]}return W.default=M,N&&N.set(M,W),W}(F());function a(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,N=new WeakMap;return(a=function(W){return W?N:R})(M)}function u(){var M=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0),M}function m(M,R,N){return M[0]=R[0]-N[0],M[1]=R[1]-N[1],M}function h(M,R,N){return M[0]=R[0]*N[0],M[1]=R[1]*N[1],M}function v(M,R,N){return M[0]=R[0]/N[0],M[1]=R[1]/N[1],M}function T(M,R){return Math.hypot(R[0]-M[0],R[1]-M[1])}function k(M,R){var N=R[0]-M[0],W=R[1]-M[1];return N*N+W*W}function L(M){return Math.hypot(M[0],M[1])}function x(M){var R=M[0],N=M[1];return R*R+N*N}Oe.len=L,Oe.sub=m,Oe.mul=h,Oe.div=v,Oe.dist=T,Oe.sqrDist=k,Oe.sqrLen=x;var A,O=(A=u(),function(M,R,N,W,Y,ne){var re,J;for(R||(R=2),N||(N=0),J=W?Math.min(W*R+N,M.length):M.length,re=N;re<J;re+=R)A[0]=M[re],A[1]=M[re+1],Y(A,A,ne),M[re]=A[0],M[re+1]=A[1];return M});return Oe.forEach=O,Oe}function Mt(){if(ot)return I;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(M)}ot=1,Object.defineProperty(I,"__esModule",{value:!0}),I.vec4=I.vec3=I.vec2=I.quat2=I.quat=I.mat4=I.mat3=I.mat2d=I.mat2=I.glMatrix=void 0;var n=O(F());I.glMatrix=n;var a=O(z());I.mat2=a;var u=O(ie());I.mat2d=u;var m=O(Q());I.mat3=m;var h=O(me());I.mat4=h;var v=O(Ae());I.quat=v;var T=O(Ne());I.quat2=T;var k=O(Ct());I.vec2=k;var L=O(ye());I.vec3=L;var x=O(xe());function A(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,N=new WeakMap;return(A=function(W){return W?N:R})(M)}function O(M,R){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var N=A(R);if(N&&N.has(M))return N.get(M);var W={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var re=Y?Object.getOwnPropertyDescriptor(M,ne):null;re&&(re.get||re.set)?Object.defineProperty(W,ne,re):W[ne]=M[ne]}return W.default=M,N&&N.set(M,W),W}return I.vec4=x,I}var zt,bt,Kt,$t,Re=Mt(),dn=function(){if(bt)return zt;function c(n,a,u,m){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(m-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=u,this.p2y=m}return bt=1,zt=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,m=0;m<8;m++){var h=this.sampleCurveX(u)-n;if(Math.abs(h)<a)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=h/v}var T=0,k=1;for(u=n,m=0;m<20&&(h=this.sampleCurveX(u),!(Math.abs(h-n)<a));m++)n>h?T=u:k=u,u=.5*(k-T)+T;return u},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},zt}(),At=S(dn);function Ke(){if($t)return Kt;function c(n,a){this.x=n,this.y=a}return $t=1,Kt=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,a){return this.clone()._rotateAround(n,a)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var a=n.x-this.x,u=n.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,a){return Math.atan2(this.x*a-this.y*n,this.x*n+this.y*a)},_matMult:function(n){var a=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=a,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var a=Math.cos(n),u=Math.sin(n),m=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=m,this},_rotateAround:function(n,a){var u=Math.cos(n),m=Math.sin(n),h=a.y+m*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-m*(this.y-a.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},Kt}var Be=S(Ke());function Ht(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let a=0;a<c.length;a++)if(!Ht(c[a],n[a]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const a in c)if(!Ht(c[a],n[a]))return!1;return!0}return c===n}const Ut=Math.PI/180,Nt=180/Math.PI;function Et(c){return c*Ut}function Gt(c){return c*Nt}const ln=[[0,0],[1,0],[1,1],[0,1]];function yn(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,a=n*c;return 4*(c<.5?a:3*(c-n)+a-.75)}function _n(c,n,a,u){const m=new At(c,n,a,u);return function(h){return m.solve(h)}}const jn=_n(.25,.1,.25,1);function yt(c,n,a){return Math.min(a,Math.max(n,c))}function kn(c,n,a){return(a=yt((a-c)/(n-c),0,1))*a*(3-2*a)}function qn(c,n,a){const u=a-n,m=((c-n)%u+u)%u+n;return m===n?a:m}function Co(c,n,a){if(!c.length)return a(null,[]);let u=c.length;const m=new Array(c.length);let h=null;c.forEach((v,T)=>{n(v,(k,L)=>{k&&(h=k),m[T]=L,--u==0&&a(h,m)})})}function mo(c,...n){for(const a of n)for(const u in a)c[u]=a[u];return c}let Io=1;function Ho(){return Io++}function ur(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Dt(c,n){c.forEach(a=>{n[a]&&(n[a]=n[a].bind(n))})}function En(c,n){return c.indexOf(n,c.length-n.length)!==-1}function ft(c,n,a){const u={};for(const m in c)u[m]=n.call(this,c[m],m,c);return u}function un(c,n,a){const u={};for(const m in c)n.call(this,c[m],m,c)&&(u[m]=c[m]);return u}function Je(c){return Array.isArray(c)?c.map(Je):typeof c=="object"&&c?ft(c,Je):c}const Mn={};function Bn(c){Mn[c]||(typeof console<"u"&&console.warn(c),Mn[c]=!0)}function Oo(c,n,a){return(a.y-c.y)*(n.x-c.x)>(n.y-c.y)*(a.x-c.x)}function Rr(c){let n=0;for(let a,u,m=0,h=c.length,v=h-1;m<h;v=m++)a=c[m],u=c[v],n+=(u.x-a.x)*(a.y+u.y);return n}function hi([c,n,a]){const u=Et(n+90),m=Et(a);return{x:c*Math.cos(u)*Math.sin(m),y:c*Math.sin(u)*Math.sin(m),z:c*Math.cos(m),azimuthal:n,polar:a}}function Er(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Nr(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,u,m,h)=>{const v=m||h;return n[u]=!v||v.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n}let Xo=null;function Bi(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function Bs(c,n,a,u){for(;n<a;){const m=n+a>>1;c[m]<u?n=m+1:a=m}return n}function Zt(c,n,a,u){for(;n<a;){const m=n+a>>1;c[m]<=u?n=m+1:a=m}return n}function Ee(c){return c>0?1/(1.001-c):1+c}function ke(c){return c>0?1-1/(1.001-c):-c}const qe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!qe.API_URL)return null;try{const c=new URL(qe.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function mt(c){return qe.API_URL_REGEX.test(c)}function it(c){return qe.API_SPRITE_REGEX.test(c)}let xt,qt,kt,Wt,Qt,nn;function gt(){return xt==null&&(xt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),xt}const Yt={now:()=>Wt!==void 0?Wt:performance.now(),setNow(c){Wt=c},restoreNow(){Wt=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:a,height:u}=c;Qt||(Qt=document.createElement("canvas"));const m=Qt.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(a>Qt.width||u>Qt.height)&&(Qt.width=a,Qt.height=u),m.clearRect(-n,-n,a+2*n,u+2*n),m.drawImage(c,0,0,a,u),m.getImageData(-n,-n,a+2*n,u+2*n)},resolveURL:c=>(qt||(qt=document.createElement("a")),qt.href=c,qt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(kt==null&&(kt=window.matchMedia("(prefers-reduced-motion: reduce)")),kt.matches)},hasCanvasFingerprintNoise(){if(nn!==void 0)return nn;if(!gt())return nn=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let a=0;for(let m=0;m<c.width;++m)n.fillStyle=`rgba(${a++},${a++},${a++}, 255)`,n.fillRect(m,0,1,1);const u=n.getImageData(0,0,c.width,c.height);a=0;for(let m=0;m<u.data.length;++m)if(m%4!=3&&a++!==u.data[m])return nn=!0,!0;return nn=!1,!1}};function In(c,n){const a=c.indexOf("?");if(a<0)return`${c}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(c.slice(a));for(const m in n)u.set(m,n[m]);return`${c.slice(0,a)}?${u.toString()}`}function ho(c,n={persistentParams:[]}){const a=c.indexOf("?");if(a<0)return c;const u=new URLSearchParams,m=new URLSearchParams(c.slice(a));for(const v of n.persistentParams){const T=m.get(v);T&&u.set(v,T)}const h=u.toString();return`${c.slice(0,a)}${h.length>0?`?${h}`:""}`}const co="mapbox-tiles";let Lo=500,Eo=50;const cr=["language","worldview","jobid"];let rr,qo;function cn(){try{return caches}catch{}}function Yn(){const c=cn();c&&rr==null&&(rr=c.open(co))}let To=1/0;const $o={supported:!1,testSupport:function(c){!rl&&yr&&(ps?za(c):Ir=c)}};let Ir,yr,rl=!1,ps=!1;const ms=typeof self<"u"?self:{};function za(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,yr),c.isContextLost())return;$o.supported=!0}catch{}c.deleteTexture(n),rl=!0}ms.document&&(yr=ms.document.createElement("img"),yr.onload=function(){Ir&&za(Ir),Ir=null,ps=!0},yr.onerror=function(){rl=!0,Ir=null},yr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ac={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(ac);class il extends Error{constructor(n,a,u){a===401&&mt(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=a,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const al=Er()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,sc=function(c,n){if(!(/^file:/.test(a=c.url)||/^file:/.test(al())&&!/^\w+:/.test(a))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,m){const h=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:al(),referrerPolicy:u.referrerPolicy,signal:h.signal});let T=!1,k=!1;const L=(x=v.url).indexOf("sku=")>0&&mt(x);var x;u.type==="json"&&v.headers.set("Accept","application/json");const A=(M,R,N)=>{if(k)return;if(M&&M.message!=="SecurityError"&&Bn(M.toString()),R&&N)return O(R);const W=Date.now();fetch(v).then(Y=>{if(Y.ok){const ne=L?Y.clone():null;return O(Y,ne,W)}return m(new il(Y.statusText,Y.status,u.url))}).catch(Y=>{Y.name!=="AbortError"&&m(new Error(`${Y.message} ${u.url}`))})},O=(M,R,N)=>{(u.type==="arrayBuffer"?M.arrayBuffer():u.type==="json"?M.json():M.text()).then(W=>{k||(R&&N&&function(Y,ne,re){if(Yn(),rr==null)return;const J=Nr(ne.headers.get("Cache-Control")||"");if(J["no-store"])return;const ue={status:ne.status,statusText:ne.statusText,headers:new Headers};ne.headers.forEach((Ge,ze)=>ue.headers.set(ze,Ge)),J["max-age"]&&ue.headers.set("Expires",new Date(re+1e3*J["max-age"]).toUTCString());const ve=ue.headers.get("Expires");if(!ve||new Date(ve).getTime()-re<42e4)return;let Ie=ho(Y.url,{persistentParams:cr});if(ne.status===206){const Ge=Y.headers.get("Range");if(!Ge)return;ue.status=200,Ie=In(Ie,{range:Ge})}(function(Ge,ze){if(qo===void 0)try{new Response(new ReadableStream),qo=!0}catch{qo=!1}qo?ze(Ge.body):Ge.blob().then(ze)})(ne,Ge=>{const ze=new Response(($e=ne.status)!==200&&$e!==404&&[101,103,204,205,304].includes($e)?null:Ge,ue);var $e;Yn(),rr!=null&&rr.then(st=>st.put(Ie,ze)).catch(st=>Bn(st.message))})}(v,R,N),T=!0,m(null,W,M.headers.get("Cache-Control"),M.headers.get("Expires")))}).catch(W=>{k||m(new Error(W.message))})};return L?function(M,R){if(Yn(),rr==null)return R(null);rr.then(N=>{let W=ho(M.url,{persistentParams:cr});const Y=M.headers.get("Range");Y&&(W=In(W,{range:Y})),N.match(W).then(ne=>{const re=function(J){if(!J)return!1;const ue=new Date(J.headers.get("Expires")||0),ve=Nr(J.headers.get("Cache-Control")||"");return ue>Date.now()&&!ve["no-cache"]}(ne);N.delete(W),re&&N.put(W,ne.clone()),R(null,ne,re)}).catch(R)}).catch(R)}(v,A):A(null,null),{cancel:()=>{k=!0,T||h.abort()}}}(c,n);if(Er()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var a;return function(u,m){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const v in u.headers)h.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{m(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let v=h.response;if(u.type==="json")try{v=JSON.parse(h.response)}catch(T){return m(T)}m(null,v,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else m(new il(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(c,n)},tu=function(c,n){return sc(mo(c,{type:"arrayBuffer"}),n)};function Ya(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const gs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Xa,fa;Xa=[],fa=0;const vs=function(c,n){if($o.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),fa>=qe.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return Xa.push(h),h}fa++;let a=!1;const u=()=>{if(!a)for(a=!0,fa--;Xa.length&&fa<qe.MAX_PARALLEL_IMAGE_REQUESTS;){const h=Xa.shift(),{requestParameters:v,callback:T,cancelled:k}=h;k||(h.cancel=vs(v,T).cancel)}},m=tu(c,(h,v,T,k)=>{u(),h?n(h):v&&(self.createImageBitmap?function(L,x){const A=new Blob([new Uint8Array(L)],{type:"image/png"});createImageBitmap(A).then(O=>{x(null,O)}).catch(O=>{x(new Error(`Could not load image because of ${O.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(L,x)=>n(L,x,T,k)):function(L,x){const A=new Image;A.onload=()=>{x(null,A),URL.revokeObjectURL(A.src),A.onload=null,requestAnimationFrame(()=>{A.src=gs})},A.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const O=new Blob([new Uint8Array(L)],{type:"image/png"});A.src=L.byteLength?URL.createObjectURL(O):gs}(v,(L,x)=>n(L,x,T,k)))});return{cancel:()=>{m.cancel(),u()}}};var nu,Ph,Rh,Ns={exports:{}},lc={exports:{}},K={exports:{}},he=function(){if(Rh)return Ns.exports;Rh=1;var c=(nu||(nu=1,lc.exports=function(a,u){var m,h,v,T,k,L,x,A;for(h=a.length-(m=3&a.length),v=u,k=3432918353,L=461845907,A=0;A<h;)x=255&a.charCodeAt(A)|(255&a.charCodeAt(++A))<<8|(255&a.charCodeAt(++A))<<16|(255&a.charCodeAt(++A))<<24,++A,v=27492+(65535&(T=5*(65535&(v=(v^=x=(65535&(x=(x=(65535&x)*k+(((x>>>16)*k&65535)<<16)&4294967295)<<15|x>>>17))*L+(((x>>>16)*L&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(x=0,m){case 3:x^=(255&a.charCodeAt(A+2))<<16;case 2:x^=(255&a.charCodeAt(A+1))<<8;case 1:v^=x=(65535&(x=(x=(65535&(x^=255&a.charCodeAt(A)))*k+(((x>>>16)*k&65535)<<16)&4294967295)<<15|x>>>17))*L+(((x>>>16)*L&65535)<<16)&4294967295}return v^=a.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),lc.exports),n=(Ph||(Ph=1,K.exports=function(a,u){for(var m,h=a.length,v=u^h,T=0;h>=4;)m=1540483477*(65535&(m=255&a.charCodeAt(T)|(255&a.charCodeAt(++T))<<8|(255&a.charCodeAt(++T))<<16|(255&a.charCodeAt(++T))<<24))+((1540483477*(m>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),h-=4,++T;switch(h){case 3:v^=(255&a.charCodeAt(T+2))<<16;case 2:v^=(255&a.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&a.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),K.exports);return Ns.exports=c,Ns.exports.murmur3=c,Ns.exports.murmur2=n,Ns.exports}(),Ve=S(he);class wt{constructor(n,...a){mo(this,a[0]||{}),this.type=n}}class Bt extends wt{constructor(n,a={}){super("error",mo({error:n},a))}}function Vt(c,n,a){a[c]&&a[c].indexOf(n)!==-1||(a[c]=a[c]||[],a[c].push(n))}function on(c,n,a){if(a&&a[c]){const u=a[c].indexOf(n);u!==-1&&a[c].splice(u,1)}}class Kn{on(n,a){return this._listeners=this._listeners||{},Vt(n,a,this._listeners),this}off(n,a){return on(n,a,this._listeners),on(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Vt(n,a,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,a){const u=typeof n=="string"?new wt(n,a):n,m=u.type;if(this.listens(m)){u.target=this;const h=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const k of h)k.call(this,u);const v=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const k of v)on(m,k,this._oneTimeListeners),k.call(this,u);const T=this._eventedParent;T&&(mo(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(u))}else u instanceof Bt&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}var so,zn={},yo=function(){if(so)return zn;so=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(h){return(h=Math.round(h))<0?0:h>255?255:h}function a(h){return n(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(v=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:v>1?1:v;var v}function m(h,v,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?h+(v-h)*T*6:2*T<1?v:3*T<2?h+(v-h)*(2/3-T)*6:h}try{zn.parseCSSColor=function(h){var v,T=h.replace(/ /g,"").toLowerCase();if(T in c)return c[T].slice();if(T[0]==="#")return T.length===4?(v=parseInt(T.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:T.length===7&&(v=parseInt(T.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var k=T.indexOf("("),L=T.indexOf(")");if(k!==-1&&L+1===T.length){var x=T.substr(0,k),A=T.substr(k+1,L-(k+1)).split(","),O=1;switch(x){case"rgba":if(A.length!==4)return null;O=u(A.pop());case"rgb":return A.length!==3?null:[a(A[0]),a(A[1]),a(A[2]),O];case"hsla":if(A.length!==4)return null;O=u(A.pop());case"hsl":if(A.length!==3)return null;var M=(parseFloat(A[0])%360+360)%360/360,R=u(A[1]),N=u(A[2]),W=N<=.5?N*(R+1):N+R-N*R,Y=2*N-W;return[n(255*m(Y,W,M+1/3)),n(255*m(Y,W,M)),n(255*m(Y,W,M-1/3)),O];default:return null}}return null}}catch{}return zn}();class Ln{constructor(n,a,u,m=1){this.r=n,this.g=a,this.b=u,this.a=m}static parse(n){if(!n)return;if(n instanceof Ln)return n;if(typeof n!="string")return;const a=yo.parseCSSColor(n);return a?new Ln(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[n,a,u,m]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(a)},${Math.round(u)},${m})`}toRenderColor(n){const{r:a,g:u,b:m,a:h}=this;return new dr(n,a,u,m,h)}}class dr{constructor(n,a,u,m,h){if(n){const v=n.image.height,T=v*v;a=h===0?0:a/h*(v-1),u=h===0?0:u/h*(v-1),m=h===0?0:m/h*(v-1);const k=Math.floor(a),L=Math.floor(u),x=Math.floor(m),A=Math.ceil(a),O=Math.ceil(u),M=Math.ceil(m),R=a-k,N=u-L,W=m-x,Y=n.image.data,ne=4*(k+L*T+x*v),re=4*(k+L*T+M*v),J=4*(k+O*T+x*v),ue=4*(k+O*T+M*v),ve=4*(A+L*T+x*v),Ie=4*(A+L*T+M*v),Ge=4*(A+O*T+x*v),ze=4*(A+O*T+M*v);if(ne<0||ze>=Y.length)throw new Error("out of range");this.r=uo(uo(uo(Y[ne],Y[re],W),uo(Y[J],Y[ue],W),N),uo(uo(Y[ve],Y[Ie],W),uo(Y[Ge],Y[ze],W),N),R)/255*h,this.g=uo(uo(uo(Y[ne+1],Y[re+1],W),uo(Y[J+1],Y[ue+1],W),N),uo(uo(Y[ve+1],Y[Ie+1],W),uo(Y[Ge+1],Y[ze+1],W),N),R)/255*h,this.b=uo(uo(uo(Y[ne+2],Y[re+2],W),uo(Y[J+2],Y[ue+2],W),N),uo(uo(Y[ve+2],Y[Ie+2],W),uo(Y[Ge+2],Y[ze+2],W),N),R)/255*h,this.a=h}else this.r=a,this.g=u,this.b=m,this.a=h}toArray(){const{r:n,g:a,b:u,a:m}=this;return m===0?[0,0,0,0]:[255*n/m,255*a/m,255*u/m,m]}toArray01(){const{r:n,g:a,b:u,a:m}=this;return m===0?[0,0,0,0]:[n/m,a/m,u/m,m]}toArray01Scaled(n){const{r:a,g:u,b:m,a:h}=this;return h===0?[0,0,0]:[a/h*n,u/h*n,m/h*n]}toArray01PremultipliedAlpha(){const{r:n,g:a,b:u,a:m}=this;return[n,a,u,m]}toArray01Linear(){const{r:n,g:a,b:u,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(n/m,2.2),Math.pow(a/m,2.2),Math.pow(u/m,2.2),m]}}function uo(c,n,a){return c*(1-a)+n*a}function hr(c,n,a){return c.map((u,m)=>uo(u,n[m],a))}Ln.black=new Ln(0,0,0,1),Ln.white=new Ln(1,1,1,1),Ln.transparent=new Ln(0,0,0,0),Ln.red=new Ln(1,0,0,1),Ln.blue=new Ln(0,0,1,1);var Ti=Object.freeze({__proto__:null,array:hr,color:function(c,n,a){return new Ln(uo(c.r,n.r,a),uo(c.g,n.g,a),uo(c.b,n.b,a),uo(c.a,n.a,a))},number:uo});function $n(c,...n){for(const a of n)for(const u in a)c[u]=a[u];return c}class ko extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class oi{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[u,m]of a)this.bindings[u]=m}concat(n){return new oi(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const yi={kind:"null"},Hn={kind:"number"},fr={kind:"string"},br={kind:"boolean"},zr={kind:"color"},sa={kind:"object"},xr={kind:"value"},Ja={kind:"collator"},cc={kind:"formatted"},uc={kind:"resolvedImage"};function pa(c,n){return{kind:"array",itemType:c,N:n}}function xi(c){if(c.kind==="array"){const n=xi(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const Oh=[yi,Hn,fr,br,zr,cc,sa,pa(xr),uc];function dc(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!dc(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const a of Oh)if(!dc(a,n))return null}}return`Expected ${xi(c)} but found ${xi(n)} instead.`}function ou(c,n){return n.some(a=>a.kind===c.kind)}function $s(c,n){return n.some(a=>a==="null"?c===null:a==="array"?Array.isArray(c):a==="object"?c&&!Array.isArray(c)&&typeof c=="object":a===typeof c)}class hd{constructor(n,a,u){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ia{constructor(n,a,u,m,h){this.text=n.normalize?n.normalize():n,this.image=a,this.scale=u,this.fontStack=m,this.textColor=h}}class la{constructor(n){this.sections=n}static fromString(n){return new la([new Ia(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary.length!==0)}static factory(n){return n instanceof la?n:la.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const a of this.sections){if(a.image){n.push(["image",a.image.namePrimary]);continue}n.push(a.text);const u={};a.fontStack&&(u["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(u["font-scale"]=a.scale),a.textColor&&(u["text-color"]=["rgba"].concat(a.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class ma{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),this.available=n.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(n,a){return n?new ma({namePrimary:n,nameSecondary:a,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Zf(c,n,a,u){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,n,a,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,n,a,u]:[c,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function El(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Ln||c instanceof hd||c instanceof la||c instanceof ma)return!0;if(Array.isArray(c)){for(const n of c)if(!El(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!El(c[n]))return!1;return!0}return!1}function Ci(c){if(c===null)return yi;if(typeof c=="string")return fr;if(typeof c=="boolean")return br;if(typeof c=="number")return Hn;if(c instanceof Ln)return zr;if(c instanceof hd)return Ja;if(c instanceof la)return cc;if(c instanceof ma)return uc;if(Array.isArray(c)){const n=c.length;let a;for(const u of c){const m=Ci(u);if(a){if(a===m)continue;a=xr;break}a=m}return pa(a||xr,n)}return sa}function ca(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof Ln||c instanceof la||c instanceof ma?c.toString():JSON.stringify(c)}class Qa{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!El(n[1]))return a.error("invalid value");const u=n[1];let m=Ci(u);const h=a.expectedType;return m.kind!=="array"||m.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(m=h),new Qa(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ln?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof la?this.value.serialize():this.value}}class _i{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const fd={string:fr,number:Hn,boolean:br,object:sa};class es{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let u,m=1;const h=n[0];if(h==="array"){let T,k;if(n.length>2){const L=n[1];if(typeof L!="string"||!(L in fd)||L==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);T=fd[L],m++}else T=xr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);k=n[2],m++}u=pa(T,k)}else u=fd[h];const v=[];for(;m<n.length;m++){const T=a.parse(n[m],m,xr);if(!T)return null;v.push(T)}return new es(u,v)}evaluate(n){for(let a=0;a<this.args.length;a++){const u=this.args[a].evaluate(n);if(!dc(this.type,Ci(u)))return u;if(a===this.args.length-1)throw new _i(`The expression ${JSON.stringify(this.args[a].serialize())} evaluated to ${xi(Ci(u))} but was expected to be of type ${xi(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,a=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){a.push(u.kind);const m=n.N;(typeof m=="number"||this.args.length>1)&&a.push(m)}}return a.concat(this.args.map(u=>u.serialize()))}}class ru{constructor(n){this.type=cc,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return a.error("First argument must be an image or text section.");const m=[];let h=!1;for(let v=1;v<=n.length-1;++v){const T=n[v];if(h&&typeof T=="object"&&!Array.isArray(T)){h=!1;let k=null;if(T["font-scale"]&&(k=a.parseObjectValue(T["font-scale"],v,"font-scale",Hn),!k))return null;let L=null;if(T["text-font"]&&(L=a.parseObjectValue(T["text-font"],v,"text-font",pa(fr)),!L))return null;let x=null;if(T["text-color"]&&(x=a.parseObjectValue(T["text-color"],v,"text-color",zr),!x))return null;const A=m[m.length-1];A.scale=k,A.font=L,A.textColor=x}else{const k=a.parse(n[v],v,xr);if(!k)return null;const L=k.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,m.push({content:k,scale:null,font:null,textColor:null})}}return new ru(m)}evaluate(n){return new la(this.sections.map(a=>{const u=a.content.evaluate(n);return Ci(u)===uc?new Ia("",u,null,null,null):new Ia(ca(u),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const a of this.sections){n.push(a.content.serialize());const u={};a.scale&&(u["font-scale"]=a.scale.serialize()),a.font&&(u["text-font"]=a.font.serialize()),a.textColor&&(u["text-color"]=a.textColor.serialize()),n.push(u)}return n}}class Ml{constructor(n,a){this.type=uc,this.inputPrimary=n,this.inputSecondary=a}static parse(n,a){if(n.length<2)return a.error("Expected two or more arguments.");const u=a.parse(n[1],1,fr);if(!u)return a.error("No image name provided.");if(n.length===2)return new Ml(u);const m=a.parse(n[2],1,fr);return m?new Ml(u,m):a.error("Secondary image variant is not a string.")}evaluate(n){const a=ma.fromString(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0);return a&&n.availableImages&&(a.available=n.availableImages.indexOf(a.namePrimary)>-1,a.nameSecondary&&a.available&&n.availableImages&&(a.available=n.availableImages.indexOf(a.nameSecondary)>-1)),a}eachChild(n){n(this.inputPrimary),this.inputSecondary&&n(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Vs(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const Lu={"to-boolean":br,"to-color":zr,"to-number":Hn,"to-string":fr};class Us{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[0],m=[];let h=yi;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const v=n[1].length;if(a.expectedType){if(a.expectedType.kind!=="array")return a.error(`Expected ${a.expectedType.kind} but found array.`);h=pa(a.expectedType.itemType,v)}else{if(!(v>0&&El(n[1][0])))return null;h=pa(Ci(n[1][0]),v)}for(let T=0;T<v;T++){const k=n[1][T];let L;if(Vs(k)==="array")L=a.parse(k,void 0,h.itemType);else{const x=Vs(k);if(x!==h.itemType.kind)return a.error(`Expected ${h.itemType.kind} but found ${x}.`);L=a.registry.literal.parse(["literal",k===void 0?null:k],a)}if(!L)return null;m.push(L)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return a.error("Expected one argument.");h=Lu[u];for(let v=1;v<n.length;v++){const T=a.parse(n[v],v,xr);if(!T)return null;m.push(T)}}return new Us(h,m)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let a,u;for(const m of this.args){if(a=m.evaluate(n),u=null,a instanceof Ln)return a;if(typeof a=="string"){const h=n.parseColor(a);if(h)return h}else if(Array.isArray(a)&&(u=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Zf(a[0],a[1],a[2],a[3]),!u))return new Ln(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new _i(u||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const u of this.args){if(a=u.evaluate(n),a===null)return 0;const m=Number(a);if(!isNaN(m))return m}throw new _i(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?la.fromString(ca(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?ma.fromString(ca(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(a=>a.evaluate(n)):ca(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ru([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ml(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(a=>{n.push(a.serialize())}),n}}const Zm=["Unknown","Point","LineString","Polygon"];class Il{constructor(n,a){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=a}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Zm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-n[0])+this.featureDistanceData.bearing[1]*(m*a-n[1])}return 0}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=Ln.parse(n)),a}getConfig(n){return this.options?this.options.get(n):null}}class va{constructor(n,a,u,m,h){this.name=n,this.type=a,this._evaluate=u,this.args=m,this._overloadIndex=h}evaluate(n){if(!this._evaluate){const a=va.definitions[this.name];this._evaluate=Array.isArray(a)?a[2]:a.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,a){const u=n[0],m=va.definitions[u];if(!m)return a.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(m)?m[0]:m.type,v=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=[];let k=null,L=-1;for(const[x,A]of v){if(Array.isArray(x)&&x.length!==n.length-1)continue;T.push(x),L++,k=new Ws(a.registry,a.path,null,a.scope,void 0,a._scope,a.options);const O=[];let M=!1;for(let R=1;R<n.length;R++){const N=n[R],W=Array.isArray(x)?x[R-1]:x.type,Y=k.parse(N,1+O.length,W);if(!Y){M=!0;break}O.push(Y)}if(!M)if(Array.isArray(x)&&x.length!==O.length)k.error(`Expected ${x.length} arguments, but found ${O.length} instead.`);else{for(let R=0;R<O.length;R++){const N=Array.isArray(x)?x[R]:x.type,W=O[R];k.concat(R+1).checkSubtype(N,W.type)}if(k.errors.length===0)return new va(u,h,A,O,L)}}if(T.length===1)a.errors.push(...k.errors);else{const x=(T.length?T:v.map(([O])=>O)).map(Ym).join(" | "),A=[];for(let O=1;O<n.length;O++){const M=a.parse(n[O],1+A.length);if(!M)return null;A.push(xi(M.type))}a.error(`Expected arguments of type ${x}, but found (${A.join(", ")}) instead.`)}return null}static register(n,a){va.definitions=a;for(const u in a)n[u]=va}}function Ym(c){return Array.isArray(c)?`(${c.map(xi).join(", ")})`:`(${xi(c.type)}...)`}class pd{constructor(n,a,u){this.type=Ja,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return a.error("Collator options argument must be an object.");const m=u["case-sensitive"]===void 0?a.parse(!1,1,br):a.parseObjectValue(u["case-sensitive"],1,"case-sensitive",br);if(!m)return null;const h=u["diacritic-sensitive"]===void 0?a.parse(!1,1,br):a.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",br);if(!h)return null;let v=null;return u.locale&&(v=a.parseObjectValue(u.locale,1,"locale",fr),!v)?null:new pd(m,h,v)}evaluate(n){return new hd(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function md(c,n,a=0,u=c.length-1,m=Al){for(;u>a;){if(u-a>600){const k=u-a+1,L=n-a+1,x=Math.log(k),A=.5*Math.exp(2*x/3),O=.5*Math.sqrt(x*A*(k-A)/k)*(L-k/2<0?-1:1);md(c,n,Math.max(a,Math.floor(n-L*A/k+O)),Math.min(u,Math.floor(n+(k-L)*A/k+O)),m)}const h=c[n];let v=a,T=u;for(js(c,a,n),m(c[u],h)>0&&js(c,a,u);v<T;){for(js(c,v,T),v++,T--;m(c[v],h)<0;)v++;for(;m(c[T],h)>0;)T--}m(c[a],h)===0?js(c,a,T):(T++,js(c,T,u)),T<=n&&(a=T+1),n<=T&&(u=T-1)}}function js(c,n,a){const u=c[n];c[n]=c[a],c[a]=u}function Al(c,n){return c<n?-1:c>n?1:0}function Lh(c){let n=0;for(let a,u,m=0,h=c.length,v=h-1;m<h;v=m++)a=c[m],u=c[v],n+=(u.x-a.x)*(a.y+u.y);return n}function hc(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function _s(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function Xm(c,n,a){const u=c[0]-n[0],m=c[1]-n[1],h=c[0]-a[0],v=c[1]-a[1];return u*v-h*m==0&&u*h<=0&&m*v<=0}function iu(c,n,a=!1){let u=!1;for(let T=0,k=n.length;T<k;T++){const L=n[T];for(let x=0,A=L.length,O=A-1;x<A;O=x++){const M=L[O],R=L[x];if(Xm(c,M,R))return a;(h=M)[1]>(m=c)[1]!=(v=R)[1]>m[1]&&m[0]<(v[0]-h[0])*(m[1]-h[1])/(v[1]-h[1])+h[0]&&(u=!u)}}var m,h,v;return u}function Yf(c,n,a,u){const m=u[0]-a[0],h=u[1]-a[1],v=(c[0]-a[0])*h-m*(c[1]-a[1]),T=(n[0]-a[0])*h-m*(n[1]-a[1]);return v>0&&T<0||v<0&&T>0}function gd(c,n,a,u){return(m=[u[0]-a[0],u[1]-a[1]])[0]*(h=[n[0]-c[0],n[1]-c[1]])[1]-m[1]*h[0]!=0&&!(!Yf(c,n,a,u)||!Yf(a,u,c,n));var m,h}const Fa=8192;function ir(c,n){const a=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,m=Math.pow(2,n.z);return[Math.round(a*m*Fa),Math.round(u*m*Fa)]}function bo(c,n){for(let a=0;a<n.length;a++)if(iu(c,n[a]))return!0;return!1}function sl(c,n,a){for(const u of a)for(let m=0,h=u.length,v=h-1;m<h;v=m++)if(gd(c,n,u[v],u[m]))return!0;return!1}function Do(c,n){for(let a=0;a<c.length;++a)if(!iu(c[a],n))return!1;for(let a=0;a<c.length-1;++a)if(sl(c[a],c[a+1],n))return!1;return!0}function ll(c,n){for(let a=0;a<n.length;a++)if(Do(c,n[a]))return!0;return!1}function kl(c,n,a){const u=[];for(let m=0;m<c.length;m++){const h=[];for(let v=0;v<c[m].length;v++){const T=ir(c[m][v],a);hc(n,T),h.push(T)}u.push(h)}return u}function Po(c,n,a){const u=[];for(let m=0;m<c.length;m++){const h=kl(c[m],n,a);u.push(h)}return u}function Dh(c,n,a,u){if(c[0]<a[0]||c[0]>a[2]){const m=.5*u;let h=c[0]-a[0]>m?-u:a[0]-c[0]>m?u:0;h===0&&(h=c[0]-a[2]>m?-u:a[2]-c[0]>m?u:0),c[0]+=h}hc(n,c)}function fc(c,n,a,u){const m=Math.pow(2,u.z)*Fa,h=[u.x*Fa,u.y*Fa],v=[];if(!c)return v;for(const T of c)for(const k of T){const L=[k.x+h[0],k.y+h[1]];Dh(L,n,a,m),v.push(L)}return v}function pc(c,n,a,u){const m=Math.pow(2,u.z)*Fa,h=[u.x*Fa,u.y*Fa],v=[];if(!c)return v;for(const k of c){const L=[];for(const x of k){const A=[x.x+h[0],x.y+h[1]];hc(n,A),L.push(A)}v.push(L)}if(n[2]-n[0]<=m/2){(T=n)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const k of v)for(const L of k)Dh(L,n,a,m)}var T;return v}class cl{constructor(n,a){this.type=br,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(El(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let m=0;m<u.features.length;++m){const h=u.features[m].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new cl(u,u.features[m].geometry)}else if(u.type==="Feature"){const m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new cl(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new cl(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=kl(u.coordinates,h,v),k=fc(a.geometry(),m,h,v);if(!_s(m,h))return!1;for(const L of k)if(!iu(L,T))return!1}if(u.type==="MultiPolygon"){const T=Po(u.coordinates,h,v),k=fc(a.geometry(),m,h,v);if(!_s(m,h))return!1;for(const L of k)if(!bo(L,T))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=kl(u.coordinates,h,v),k=pc(a.geometry(),m,h,v);if(!_s(m,h))return!1;for(const L of k)if(!Do(L,T))return!1}if(u.type==="MultiPolygon"){const T=Po(u.coordinates,h,v),k=pc(a.geometry(),m,h,v);if(!_s(m,h))return!1;for(const L of k)if(!ll(L,T))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Pl={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},ua=1/298.257223563,vd=ua*(2-ua),mc=Math.PI/180;class gc{static fromTile(n,a,u){const m=Math.PI*(1-2*(n+.5)/Math.pow(2,a)),h=Math.atan(.5*(Math.exp(m)-Math.exp(-m)))/mc;return new gc(h,u)}static get units(){return Pl}constructor(n,a){if(n===void 0)throw new Error("No latitude given.");if(a&&!Pl[a])throw new Error(`Unknown unit ${a}. Use one of: ${Object.keys(Pl).join(", ")}`);const u=6378.137*mc*(a?Pl[a]:1),m=Math.cos(n*mc),h=1/(1-vd*(1-m*m)),v=Math.sqrt(h);this.kx=u*v*m,this.ky=u*v*h*(1-vd)}distance(n,a){const u=wi(n[0]-a[0])*this.kx,m=(n[1]-a[1])*this.ky;return Math.sqrt(u*u+m*m)}bearing(n,a){const u=wi(a[0]-n[0])*this.kx;return Math.atan2(u,(a[1]-n[1])*this.ky)/mc}destination(n,a,u){const m=u*mc;return this.offset(n,Math.sin(m)*a,Math.cos(m)*a)}offset(n,a,u){return[n[0]+a/this.kx,n[1]+u/this.ky]}lineDistance(n){let a=0;for(let u=0;u<n.length-1;u++)a+=this.distance(n[u],n[u+1]);return a}area(n){let a=0;for(let u=0;u<n.length;u++){const m=n[u];for(let h=0,v=m.length,T=v-1;h<v;T=h++)a+=wi(m[h][0]-m[T][0])*(m[h][1]+m[T][1])*(u?-1:1)}return Math.abs(a)/2*this.kx*this.ky}along(n,a){let u=0;if(a<=0)return n[0];for(let m=0;m<n.length-1;m++){const h=n[m],v=n[m+1],T=this.distance(h,v);if(u+=T,u>a)return Aa(h,v,(a-(u-T))/T)}return n[n.length-1]}pointToSegmentDistance(n,a,u){let[m,h]=a,v=wi(u[0]-m)*this.kx,T=(u[1]-h)*this.ky;if(v!==0||T!==0){const k=(wi(n[0]-m)*this.kx*v+(n[1]-h)*this.ky*T)/(v*v+T*T);k>1?(m=u[0],h=u[1]):k>0&&(m+=v/this.kx*k,h+=T/this.ky*k)}return v=wi(n[0]-m)*this.kx,T=(n[1]-h)*this.ky,Math.sqrt(v*v+T*T)}pointOnLine(n,a){let u=1/0,m=n[0][0],h=n[0][1],v=0,T=0;for(let k=0;k<n.length-1;k++){let L=n[k][0],x=n[k][1],A=wi(n[k+1][0]-L)*this.kx,O=(n[k+1][1]-x)*this.ky,M=0;A===0&&O===0||(M=(wi(a[0]-L)*this.kx*A+(a[1]-x)*this.ky*O)/(A*A+O*O),M>1?(L=n[k+1][0],x=n[k+1][1]):M>0&&(L+=A/this.kx*M,x+=O/this.ky*M)),A=wi(a[0]-L)*this.kx,O=(a[1]-x)*this.ky;const R=A*A+O*O;R<u&&(u=R,m=L,h=x,v=k,T=M)}return{point:[m,h],index:v,t:Math.max(0,Math.min(1,T))}}lineSlice(n,a,u){let m=this.pointOnLine(u,n),h=this.pointOnLine(u,a);if(m.index>h.index||m.index===h.index&&m.t>h.t){const L=m;m=h,h=L}const v=[m.point],T=m.index+1,k=h.index;!vc(u[T],v[0])&&T<=k&&v.push(u[T]);for(let L=T+1;L<=k;L++)v.push(u[L]);return vc(u[k],h.point)||v.push(h.point),v}lineSliceAlong(n,a,u){let m=0;const h=[];for(let v=0;v<u.length-1;v++){const T=u[v],k=u[v+1],L=this.distance(T,k);if(m+=L,m>n&&h.length===0&&h.push(Aa(T,k,(n-(m-L))/L)),m>=a)return h.push(Aa(T,k,(a-(m-L))/L)),h;m>n&&h.push(k)}return h}bufferPoint(n,a){const u=a/this.ky,m=a/this.kx;return[n[0]-m,n[1]-u,n[0]+m,n[1]+u]}bufferBBox(n,a){const u=a/this.ky,m=a/this.kx;return[n[0]-m,n[1]-u,n[2]+m,n[3]+u]}insideBBox(n,a){return wi(n[0]-a[0])>=0&&wi(n[0]-a[2])<=0&&n[1]>=a[1]&&n[1]<=a[3]}}function vc(c,n){return c[0]===n[0]&&c[1]===n[1]}function Aa(c,n,a){const u=wi(n[0]-c[0]);return[c[0]+u*a,c[1]+(n[1]-c[1])*a]}function wi(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class Hs{constructor(n=[],a=(u,m)=>u<m?-1:u>m?1:0){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:u}=this,m=a[n];for(;n>0;){const h=n-1>>1,v=a[h];if(u(m,v)>=0)break;a[n]=v,n=h}a[n]=m}_down(n){const{data:a,compare:u}=this,m=this.length>>1,h=a[n];for(;n<m;){let v=1+(n<<1);const T=v+1;if(T<this.length&&u(a[T],a[v])<0&&(v=T),u(a[v],h)>=0)break;a[n]=a[v],n=v}a[n]=h}}var Nn=8192;function Rl(c,n){return n.dist-c.dist}const _c=100,_d=50;function yc(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==c[a])return!1;return!0}function au(c){return c[1]-c[0]+1}function Gs(c,n){const a=c[1]>=c[0]&&c[1]<n;return a||console.warn("Distance Expression: Index is out of range"),a}function yd(c,n){if(c[0]>c[1])return[null,null];const a=au(c);if(n){if(a===2)return[c,null];const u=Math.floor(a/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(a===1)return[c,null];const u=Math.floor(a/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function ka(c,n){const a=[1/0,1/0,-1/0,-1/0];if(!Gs(n,c.length))return a;for(let u=n[0];u<=n[1];++u)hc(a,c[u]);return a}function Ol(c){const n=[1/0,1/0,-1/0,-1/0];for(let a=0;a<c.length;++a)for(let u=0;u<c[a].length;++u)hc(n,c[a][u]);return n}function bc(c,n,a){if(yc(c)||yc(n))return NaN;let u=0,m=0;return c[2]<n[0]&&(u=n[0]-c[2]),c[0]>n[2]&&(u=c[0]-n[2]),c[1]>n[3]&&(m=c[1]-n[3]),c[3]<n[1]&&(m=n[1]-c[3]),a.distance([0,0],[u,m])}function Xf(c){return 360*c-180}function an(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Tn(c,n){const a=Math.pow(2,n.z),u=(c.y/Nn+n.y)/a;return[Xf((c.x/Nn+n.x)/a),an(u)]}function vo(c,n){const a=[];for(let u=0;u<c.length;++u)a.push(Tn(c[u],n));return a}function Jo(c,n,a){const u=a.pointOnLine(n,c).point;return a.distance(c,u)}function Si(c,n,a,u,m){const h=a.slice(u[0],u[1]+1);let v=1/0;for(let T=n[0];T<=n[1];++T)if((v=Math.min(v,Jo(c[T],h,m)))===0)return 0;return v}function Or(c,n,a,u,m){const h=Math.min(m.pointToSegmentDistance(c,a,u),m.pointToSegmentDistance(n,a,u)),v=Math.min(m.pointToSegmentDistance(a,c,n),m.pointToSegmentDistance(u,c,n));return Math.min(h,v)}function Li(c,n,a,u,m){if(!Gs(n,c.length)||!Gs(u,a.length))return NaN;let h=1/0;for(let v=n[0];v<n[1];++v)for(let T=u[0];T<u[1];++T){if(gd(c[v],c[v+1],a[T],a[T+1]))return 0;h=Math.min(h,Or(c[v],c[v+1],a[T],a[T+1],m))}return h}function Hi(c,n,a,u,m){if(!Gs(n,c.length)||!Gs(u,a.length))return NaN;let h=1/0;for(let v=n[0];v<=n[1];++v)for(let T=u[0];T<=u[1];++T)if((h=Math.min(h,m.distance(c[v],a[T])))===0)return h;return h}function ts(c,n,a){if(iu(c,n,!0))return 0;let u=1/0;for(const m of n){const h=m.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[h-1]&&(u=Math.min(u,a.pointToSegmentDistance(c,m[h-1],m[0])))===0||(u=Math.min(u,Jo(c,m,a)))===0)return u}return u}function Zi(c,n,a,u){if(!Gs(n,c.length))return NaN;for(let h=n[0];h<=n[1];++h)if(iu(c[h],a,!0))return 0;let m=1/0;for(let h=n[0];h<n[1];++h)for(const v of a)for(let T=0,k=v.length,L=k-1;T<k;L=T++){if(gd(c[h],c[h+1],v[L],v[T]))return 0;m=Math.min(m,Or(c[h],c[h+1],v[L],v[T],u))}return m}function Gi(c,n){for(const a of c)for(let u=0;u<=a.length-1;++u)if(iu(a[u],n,!0))return!0;return!1}function ys(c,n,a,u=1/0){const m=Ol(c),h=Ol(n);if(u!==1/0&&bc(m,h,a)>=u)return u;if(_s(m,h)){if(Gi(c,n))return 0}else if(Gi(n,c))return 0;let v=u;for(const T of c)for(let k=0,L=T.length,x=L-1;k<L;x=k++)for(const A of n)for(let O=0,M=A.length,R=M-1;O<M;R=O++){if(gd(T[x],T[k],A[R],A[O]))return 0;v=Math.min(v,Or(T[x],T[k],A[R],A[O],a))}return v}function Ba(c,n,a,u,m,h,v){if(h===null||v===null)return;const T=bc(ka(u,h),ka(m,v),a);T<n&&c.push({dist:T,range1:h,range2:v})}function oa(c,n,a,u,m=1/0){let h=Math.min(u.distance(c[0],a[0][0]),m);if(h===0)return h;const v=new Hs([{dist:0,range1:[0,c.length-1],range2:[0,0]}],Rl),T=n?_d:_c,k=Ol(a);for(;v.length;){const L=v.pop();if(L.dist>=h)continue;const x=L.range1;if(au(x)<=T){if(!Gs(x,c.length))return NaN;if(n){const A=Zi(c,x,a,u);if((h=Math.min(h,A))===0)return h}else for(let A=x[0];A<=x[1];++A){const O=ts(c[A],a,u);if((h=Math.min(h,O))===0)return h}}else{const A=yd(x,n);if(A[0]!==null){const O=bc(ka(c,A[0]),k,u);O<h&&v.push({dist:O,range1:A[0],range2:[0,0]})}if(A[1]!==null){const O=bc(ka(c,A[1]),k,u);O<h&&v.push({dist:O,range1:A[1],range2:[0,0]})}}}return h}function Na(c,n,a,u,m,h=1/0){let v=Math.min(h,m.distance(c[0],a[0]));if(v===0)return v;const T=new Hs([{dist:0,range1:[0,c.length-1],range2:[0,a.length-1]}],Rl),k=n?_d:_c,L=u?_d:_c;for(;T.length;){const x=T.pop();if(x.dist>=v)continue;const A=x.range1,O=x.range2;if(au(A)<=k&&au(O)<=L){if(!Gs(A,c.length)||!Gs(O,a.length))return NaN;if(n&&u?v=Math.min(v,Li(c,A,a,O,m)):n||u?n&&!u?v=Math.min(v,Si(a,O,c,A,m)):!n&&u&&(v=Math.min(v,Si(c,A,a,O,m))):v=Math.min(v,Hi(c,A,a,O,m)),v===0)return v}else{const M=yd(A,n),R=yd(O,u);Ba(T,v,m,c,a,M[0],R[0]),Ba(T,v,m,c,a,M[0],R[1]),Ba(T,v,m,c,a,M[1],R[0]),Ba(T,v,m,c,a,M[1],R[1])}}return v}function bs(c,n,a,u,m=1/0){let h=m;const v=ka(c,[0,c.length-1]);for(const T of a)if(!(h!==1/0&&bc(v,ka(T,[0,T.length-1]),u)>=h)&&(h=Math.min(h,Na(c,n,T,!0,u,h)),h===0))return h;return h}function Ll(c,n,a,u,m=1/0){let h=m;const v=ka(c,[0,c.length-1]);for(const T of a){if(h!==1/0&&bc(v,Ol(T),u)>=h)continue;const k=oa(c,n,T,u,h);if(isNaN(k))return k;if((h=Math.min(h,k))===0)return h}return h}function ul(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class ns{constructor(n,a){this.type=Hn,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(El(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let m=0;m<u.features.length;++m)if(ul(u.features[m].geometry.type))return new ns(u,u.features[m].geometry)}else if(u.type==="Feature"){if(ul(u.geometry.type))return new ns(u,u.geometry)}else if(ul(u.type))return new ns(u,u)}return a.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const a=n.geometry(),u=n.canonicalID();if(a!=null&&u!=null){if(n.geometryType()==="Point")return function(m,h,v){const T=[];for(const L of m)for(const x of L)T.push(Tn(x,h));const k=new gc(T[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?Na(T,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",k):v.type==="MultiLineString"?bs(T,!1,v.coordinates,k):v.type==="Polygon"||v.type==="MultiPolygon"?Ll(T,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,k):null}(a,u,this.geometries);if(n.geometryType()==="LineString")return function(m,h,v){const T=[];for(const L of m){const x=[];for(const A of L)x.push(Tn(A,h));T.push(x)}const k=new gc(T[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return bs(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,k);if(v.type==="MultiLineString"){let L=1/0;for(let x=0;x<v.coordinates.length;x++){const A=bs(v.coordinates[x],!0,T,k,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}if(v.type==="Polygon"||v.type==="MultiPolygon"){let L=1/0;for(let x=0;x<T.length;x++){const A=Ll(T[x],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,k,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}return null}(a,u,this.geometries);if(n.geometryType()==="Polygon")return function(m,h,v){const T=[];for(const L of function(x,A){const O=x.length;if(O<=1)return[x];const M=[];let R,N;for(let W=0;W<O;W++){const Y=Lh(x[W]);Y!==0&&(x[W].area=Math.abs(Y),N===void 0&&(N=Y<0),N===Y<0?(R&&M.push(R),R=[x[W]]):R.push(x[W]))}return R&&M.push(R),M}(m)){const x=[];for(let A=0;A<L.length;++A)x.push(vo(L[A],h));T.push(x)}const k=new gc(T[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Ll(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,k);if(v.type==="MultiLineString"){let L=1/0;for(let x=0;x<v.coordinates.length;x++){const A=Ll(v.coordinates[x],!0,T,k,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}return v.type==="Polygon"||v.type==="MultiPolygon"?function(L,x,A){let O=1/0;for(const M of L)for(const R of x){const N=ys(M,R,A,O);if(isNaN(N))return N;if((O=Math.min(O,N))===0)return O}return O}(v.type==="Polygon"?[v.coordinates]:v.coordinates,T,k):null}(a,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function dl(c,n){switch(c){case"string":return ca(n);case"number":return+n;case"boolean":return!!n;case"color":return Ln.parse(n);case"formatted":return la.fromString(ca(n));case"resolvedImage":return ma.fromString(ca(n))}return n}function pr(c,n,a,u){return u!==void 0&&(c=u*Math.round(c/u)),n!==void 0&&c<n&&(c=n),a!==void 0&&c>a&&(c=a),c}class su{constructor(n,a,u){this.type=n,this.key=a,this.scope=u}static parse(n,a){let u=a.expectedType;if(u==null&&(u=xr),n.length<2||n.length>3)return a.error("Invalid number of arguments for 'config' expression.");const m=a.parse(n[1],1);if(!(m instanceof Qa))return a.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const h=a.parse(n[2],2);return h instanceof Qa?new su(u,ca(m.value),ca(h.value)):a.error("Scope of 'config' expression must be a string literal.")}return new su(u,ca(m.value))}evaluate(n){const a=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(a);if(!u)return null;const{type:m,value:h,values:v,minValue:T,maxValue:k,stepValue:L}=u,x=u.default.evaluate(n);let A=x;if(h){const O=n.scope;n.scope=(O||"").split("").slice(1).join(""),A=h.evaluate(n),n.scope=O}return m&&(A=dl(m,A)),A===void 0||T===void 0&&k===void 0&&L===void 0||(typeof A=="number"?A=pr(A,T,k,L):Array.isArray(A)&&(A=A.map(O=>typeof O=="number"?pr(O,T,k,L):O))),h!==void 0&&A!==void 0&&v&&!v.includes(A)&&(A=x,m&&(A=dl(m,A))),(m&&m!==this.type||A!==void 0&&Ci(A)!==this.type)&&(A=dl(this.type.kind,A)),A}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function li(c){if(c instanceof va&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof cl||c instanceof ns)return!1;let n=!0;return c.eachChild(a=>{n&&!li(a)&&(n=!1)}),n}function ri(c){if(c instanceof va&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(a=>{n&&!ri(a)&&(n=!1)}),n}function Dl(c){if(c instanceof su)return new Set([c.key]);let n=new Set;return c.eachChild(a=>{n=new Set([...n,...Dl(a)])}),n}function $a(c,n){if(c instanceof va&&n.indexOf(c.name)>=0)return!1;let a=!0;return c.eachChild(u=>{a&&!$a(u,n)&&(a=!1)}),a}class $r{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const u=n[1];return a.scope.has(u)?new $r(u,a.scope.get(u)):a.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Pa{constructor(n,a=[],u,m=new oi,h=[],v,T){this.registry=n,this.path=a,this.key=a.map(k=>typeof k=="string"?`['${k}']`:`[${k}]`).join(""),this.scope=m,this.errors=h,this.expectedType=u,this._scope=v,this.options=T}parse(n,a,u,m,h={}){return a||u?this.concat(a,null,u,m)._parse(n,h):this._parse(n,h)}parseObjectValue(n,a,u,m,h,v={}){return this.concat(a,u,m,h)._parse(n,v)}_parse(n,a){function u(m,h,v){return v==="assert"?new es(h,[m]):v==="coerce"?new Us(h,[m]):m}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(m){let h=m.parse(n,this);if(!h)return null;if(this.expectedType){const v=this.expectedType,T=h.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else h=u(h,v,a.typeAnnotation||"coerce");else h=u(h,v,a.typeAnnotation||"assert")}if(!(h instanceof Qa)&&h.type.kind!=="resolvedImage"&&qs(h)){const v=new Il(this._scope,this.options);try{h=new Qa(h.type,h.evaluate(v))}catch(T){return this.error(T.message),null}}return h}return Us.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,u,m){let h=typeof n=="number"?this.path.concat(n):this.path;h=typeof a=="string"?h.concat(a):h;const v=m?this.scope.concat(m):this.scope;return new Pa(this.registry,h,u||null,v,this.errors,this._scope,this.options)}error(n,...a){const u=`${this.key}${a.map(m=>`[${m}]`).join("")}`;this.errors.push(new ko(u,n))}checkSubtype(n,a){const u=dc(n,a);return u&&this.error(u),u}}var Ws=Pa;function qs(c){if(c instanceof $r)return qs(c.boundExpression);if(c instanceof va&&c.name==="error"||c instanceof pd||c instanceof cl||c instanceof ns||c instanceof su)return!1;const n=c instanceof Us||c instanceof es;let a=!0;return c.eachChild(u=>{a=n?a&&qs(u):a&&u instanceof Qa}),!!a&&li(c)&&$a(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function zl(c,n){const a=c.length-1;let u,m,h=0,v=a,T=0;for(;h<=v;)if(T=Math.floor((h+v)/2),u=c[T],m=c[T+1],u<=n){if(T===a||n<m)return T;h=T+1}else{if(!(u>n))throw new _i("Input is not a number.");v=T-1}return 0}class Fl{constructor(n,a,u){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[m,h]of u)this.labels.push(m),this.outputs.push(h)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const u=a.parse(n[1],1,Hn);if(!u)return null;const m=[];let h=null;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);for(let v=1;v<n.length;v+=2){const T=v===1?-1/0:n[v],k=n[v+1],L=v,x=v+1;if(typeof T!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(m.length&&m[m.length-1][0]>=T)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const A=a.parse(k,x,h);if(!A)return null;h=h||A.type,m.push([T,A])}return new Fl(h,u,m)}evaluate(n){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=a[0])return u[0].evaluate(n);const h=a.length;return m>=a[h-1]?u[h-1].evaluate(n):u[zl(a,m)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&n.push(this.labels[a]),n.push(this.outputs[a].serialize());return n}}const xc=.95047,Bl=1.08883,zh=4/29,hl=6/29,bd=3*hl*hl,xd=hl*hl*hl,wd=Math.PI/180,Jf=180/Math.PI;function lu(c){return c>xd?Math.pow(c,1/3):c/bd+zh}function cu(c){return c>hl?c*c*c:bd*(c-zh)}function Jm(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Qm(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function W_(c){const n=Qm(c.r),a=Qm(c.g),u=Qm(c.b),m=lu((.4124564*n+.3575761*a+.1804375*u)/xc),h=lu((.2126729*n+.7151522*a+.072175*u)/1);return{l:116*h-16,a:500*(m-h),b:200*(h-lu((.0193339*n+.119192*a+.9503041*u)/Bl)),alpha:c.a}}function q_(c){let n=(c.l+16)/116,a=isNaN(c.a)?n:n+c.a/500,u=isNaN(c.b)?n:n-c.b/200;return n=1*cu(n),a=xc*cu(a),u=Bl*cu(u),new Ln(Jm(3.2404542*a-1.5371385*n-.4985314*u),Jm(-.969266*a+1.8760108*n+.041556*u),Jm(.0556434*a-.2040259*n+1.0572252*u),c.alpha)}function M1(c,n,a){const u=n-c;return c+a*(u>180||u<-180?u-360*Math.round(u/360):u)}const Fh={forward:W_,reverse:q_,interpolate:function(c,n,a){return{l:uo(c.l,n.l,a),a:uo(c.a,n.a,a),b:uo(c.b,n.b,a),alpha:uo(c.alpha,n.alpha,a)}}},Bh={forward:function(c){const{l:n,a,b:u}=W_(c),m=Math.atan2(u,a)*Jf;return{h:m<0?m+360:m,c:Math.sqrt(a*a+u*u),l:n,alpha:c.a}},reverse:function(c){const n=c.h*wd,a=c.c;return q_({l:c.l,a:Math.cos(n)*a,b:Math.sin(n)*a,alpha:c.alpha})},interpolate:function(c,n,a){return{h:M1(c.h,n.h,a),c:uo(c.c,n.c,a),l:uo(c.l,n.l,a),alpha:uo(c.alpha,n.alpha,a)}}};var K_=Object.freeze({__proto__:null,hcl:Bh,lab:Fh});class xs{constructor(n,a,u,m,h){this.type=n,this.operator=a,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(const[v,T]of h)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(n,a,u,m){let h=0;if(n.name==="exponential")h=eg(a,n.base,u,m);else if(n.name==="linear")h=eg(a,1,u,m);else if(n.name==="cubic-bezier"){const v=n.controlPoints;h=new At(v[0],v[1],v[2],v[3]).solve(eg(a,1,u,m))}return h}static parse(n,a){let[u,m,h,...v]=n;if(!Array.isArray(m)||m.length===0)return a.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const L=m[1];if(typeof L!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:L}}else{if(m[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const L=m.slice(1);if(L.length!==4||L.some(x=>typeof x!="number"||x<0||x>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:L}}}if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(h=a.parse(h,2,Hn),!h)return null;const T=[];let k=null;u==="interpolate-hcl"||u==="interpolate-lab"?k=zr:a.expectedType&&a.expectedType.kind!=="value"&&(k=a.expectedType);for(let L=0;L<v.length;L+=2){const x=v[L],A=v[L+1],O=L+3,M=L+4;if(typeof x!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(T.length&&T[T.length-1][0]>=x)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const R=a.parse(A,M,k);if(!R)return null;k=k||R.type,T.push([x,R])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new xs(k,u,m,h,T):a.error(`Type ${xi(k)} is not interpolatable.`)}evaluate(n){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=a[0])return u[0].evaluate(n);const h=a.length;if(m>=a[h-1])return u[h-1].evaluate(n);const v=zl(a,m),T=xs.interpolationFactor(this.interpolation,m,a[v],a[v+1]),k=u[v].evaluate(n),L=u[v+1].evaluate(n);return this.operator==="interpolate"?Ti[this.type.kind.toLowerCase()](k,L,T):this.operator==="interpolate-hcl"?Bh.reverse(Bh.interpolate(Bh.forward(k),Bh.forward(L),T)):Fh.reverse(Fh.interpolate(Fh.forward(k),Fh.forward(L),T))}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,n,this.input.serialize()];for(let u=0;u<this.labels.length;u++)a.push(this.labels[u],this.outputs[u].serialize());return a}}function eg(c,n,a,u){const m=u-a,h=c-a;return m===0?0:n===1?h/m:(Math.pow(n,h)-1)/(Math.pow(n,m)-1)}class Qf{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expectected at least one argument.");let u=null;const m=a.expectedType;m&&m.kind!=="value"&&(u=m);const h=[];for(const T of n.slice(1)){const k=a.parse(T,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!k)return null;u=u||k.type,h.push(k)}const v=m&&h.some(T=>dc(m,T.type));return new Qf(v?xr:u,h)}evaluate(n){let a,u=null,m=0;for(const h of this.args){if(m++,u=h.evaluate(n),u&&u instanceof ma&&!u.available&&(a||(a=u),u=null,m===this.args.length))return a;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class ep{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let h=1;h<n.length-1;h+=2){const v=n[h];if(typeof v!="string")return a.error(`Expected string, but found ${typeof v} instead.`,h);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",h);const T=a.parse(n[h+1],h+1);if(!T)return null;u.push([v,T])}const m=a.parse(n[n.length-1],n.length-1,a.expectedType,u);return m?new ep(u,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[a,u]of this.bindings)n.push(a,u.serialize());return n.push(this.result.serialize()),n}}class tg{constructor(n,a,u){this.type=n,this.index=a,this.input=u}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,Hn),m=a.parse(n[2],2,pa(a.expectedType||xr));return u&&m?new tg(m.type.itemType,u,m):null}evaluate(n){const a=this.index.evaluate(n),u=this.input.evaluate(n);if(a<0)throw new _i(`Array index out of bounds: ${a} < 0.`);if(a>u.length-1)throw new _i(`Array index out of bounds: ${a} > ${u.length-1}.`);if(a===Math.floor(a))return u[a];const m=Math.floor(a),h=Math.ceil(a),v=u[m],T=u[h];if(typeof v!="number"||typeof T!="number")throw new _i(`Cannot interpolate between non-number values at index ${a}.`);const k=a-m;return v*(1-k)+T*k}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ng{constructor(n,a){this.type=br,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,xr),m=a.parse(n[2],2,xr);return u&&m?ou(u.type,[br,fr,Hn,yi,xr])?new ng(u,m):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${xi(u.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!$s(a,["boolean","string","number","null"]))throw new _i(`Expected first argument to be of type boolean, string, number or null, but found ${xi(Ci(a))} instead.`);if(!$s(u,["string","array"]))throw new _i(`Expected second argument to be of type array or string, but found ${xi(Ci(u))} instead.`);return u.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class tp{constructor(n,a,u){this.type=Hn,this.needle=n,this.haystack=a,this.fromIndex=u}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,xr),m=a.parse(n[2],2,xr);if(!u||!m)return null;if(!ou(u.type,[br,fr,Hn,yi,xr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${xi(u.type)} instead`);if(n.length===4){const h=a.parse(n[3],3,Hn);return h?new tp(u,m,h):null}return new tp(u,m)}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!$s(a,["boolean","string","number","null"]))throw new _i(`Expected first argument to be of type boolean, string, number or null, but found ${xi(Ci(a))} instead.`);if(!$s(u,["string","array"]))throw new _i(`Expected second argument to be of type array or string, but found ${xi(Ci(u))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(n);return u.indexOf(a,m)}return u.indexOf(a)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class og{constructor(n,a,u,m,h,v){this.inputType=n,this.type=a,this.input=u,this.cases=m,this.outputs=h,this.otherwise=v}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let u,m;a.expectedType&&a.expectedType.kind!=="value"&&(m=a.expectedType);const h={},v=[];for(let L=2;L<n.length-1;L+=2){let x=n[L];const A=n[L+1];Array.isArray(x)||(x=[x]);const O=a.concat(L);if(x.length===0)return O.error("Expected at least one branch label.");for(const R of x){if(typeof R!="number"&&typeof R!="string")return O.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return O.error("Numeric branch labels must be integer values.");if(u){if(O.checkSubtype(u,Ci(R)))return null}else u=Ci(R);if(h[String(R)]!==void 0)return O.error("Branch labels must be unique.");h[String(R)]=v.length}const M=a.parse(A,L,m);if(!M)return null;m=m||M.type,v.push(M)}const T=a.parse(n[1],1,xr);if(!T)return null;const k=a.parse(n[n.length-1],n.length-1,m);return k?T.type.kind!=="value"&&a.concat(1).checkSubtype(u,T.type)?null:new og(u,m,T,h,v,k):null}evaluate(n){const a=this.input.evaluate(n);return(Ci(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),u=[],m={};for(const v of a){const T=m[this.cases[v]];T===void 0?(m[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[T][1].push(v)}const h=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,T]of u)n.push(T.length===1?h(T[0]):T.map(h)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}class Nh{constructor(n,a,u){this.type=n,this.branches=a,this.otherwise=u}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let u;a.expectedType&&a.expectedType.kind!=="value"&&(u=a.expectedType);const m=[];for(let v=1;v<n.length-1;v+=2){const T=a.parse(n[v],v,br);if(!T)return null;const k=a.parse(n[v+1],v+1,u);if(!k)return null;m.push([T,k]),u=u||k.type}const h=a.parse(n[n.length-1],n.length-1,u);return h?new Nh(u,m,h):null}evaluate(n){for(const[a,u]of this.branches)if(a.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,u]of this.branches)n(a),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class np{constructor(n,a,u,m){this.type=n,this.input=a,this.beginIndex=u,this.endIndex=m}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,xr),m=a.parse(n[2],2,Hn);if(!u||!m)return null;if(!ou(u.type,[pa(xr),fr,xr]))return a.error(`Expected first argument to be of type array or string, but found ${xi(u.type)} instead`);if(n.length===4){const h=a.parse(n[3],3,Hn);return h?new np(u.type,u,m,h):null}return new np(u.type,u,m)}evaluate(n){const a=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!$s(a,["string","array"]))throw new _i(`Expected first argument to be of type array or string, but found ${xi(Ci(a))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(n);return a.slice(u,m)}return a.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function rg(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Z_(c,n,a,u){return u.compare(n,a)===0}function Sd(c,n,a){const u=c!=="=="&&c!=="!=";return class UR{constructor(h,v,T){this.type=br,this.lhs=h,this.rhs=v,this.collator=T,this.hasUntypedArgument=h.type.kind==="value"||v.type.kind==="value"}static parse(h,v){if(h.length!==3&&h.length!==4)return v.error("Expected two or three arguments.");const T=h[0];let k=v.parse(h[1],1,xr);if(!k)return null;if(!rg(T,k.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${xi(k.type)}'.`);let L=v.parse(h[2],2,xr);if(!L)return null;if(!rg(T,L.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${xi(L.type)}'.`);if(k.type.kind!==L.type.kind&&k.type.kind!=="value"&&L.type.kind!=="value")return v.error(`Cannot compare types '${xi(k.type)}' and '${xi(L.type)}'.`);u&&(k.type.kind==="value"&&L.type.kind!=="value"?k=new es(L.type,[k]):k.type.kind!=="value"&&L.type.kind==="value"&&(L=new es(k.type,[L])));let x=null;if(h.length===4){if(k.type.kind!=="string"&&L.type.kind!=="string"&&k.type.kind!=="value"&&L.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(x=v.parse(h[3],3,Ja),!x)return null}return new UR(k,L,x)}evaluate(h){const v=this.lhs.evaluate(h),T=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const k=Ci(v),L=Ci(T);if(k.kind!==L.kind||k.kind!=="string"&&k.kind!=="number")throw new _i(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${k.kind}, ${L.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const k=Ci(v),L=Ci(T);if(k.kind!=="string"||L.kind!=="string")return n(h,v,T)}return this.collator?a(h,v,T,this.collator.evaluate(h)):n(h,v,T)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[c];return this.eachChild(v=>{h.push(v.serialize())}),h}}}const I1=Sd("==",function(c,n,a){return n===a},Z_),Y_=Sd("!=",function(c,n,a){return n!==a},function(c,n,a,u){return!Z_(0,n,a,u)}),X_=Sd("<",function(c,n,a){return n<a},function(c,n,a,u){return u.compare(n,a)<0}),Td=Sd(">",function(c,n,a){return n>a},function(c,n,a,u){return u.compare(n,a)>0}),J_=Sd("<=",function(c,n,a){return n<=a},function(c,n,a,u){return u.compare(n,a)<=0}),Q_=Sd(">=",function(c,n,a){return n>=a},function(c,n,a,u){return u.compare(n,a)>=0});class ig{constructor(n,a,u,m,h,v){this.type=fr,this.number=n,this.locale=a,this.currency=u,this.unit=m,this.minFractionDigits=h,this.maxFractionDigits=v}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const u=a.parse(n[1],1,Hn);if(!u)return null;const m=n[2];if(typeof m!="object"||Array.isArray(m))return a.error("NumberFormat options argument must be an object.");let h=null;if(m.locale&&(h=a.parseObjectValue(m.locale,2,"locale",fr),!h))return null;let v=null;if(m.currency&&(v=a.parseObjectValue(m.currency,2,"currency",fr),!v))return null;let T=null;if(m.unit&&(T=a.parseObjectValue(m.unit,2,"unit",fr),!T))return null;let k=null;if(m["min-fraction-digits"]&&(k=a.parseObjectValue(m["min-fraction-digits"],2,"min-fraction-digits",Hn),!k))return null;let L=null;return m["max-fraction-digits"]&&(L=a.parseObjectValue(m["max-fraction-digits"],2,"max-fraction-digits",Hn),!L)?null:new ig(u,h,v,T,k,L)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class $h{constructor(n){this.type=Hn,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=a.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${xi(u.type)} instead.`):new $h(u):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string"||Array.isArray(a))return a.length;throw new _i(`Expected value to be of type string or array, but found ${xi(Ci(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(a=>{n.push(a.serialize())}),n}}function op(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const Cd={"==":I1,"!=":Y_,">":Td,"<":X_,">=":Q_,"<=":J_,array:es,at:tg,boolean:es,case:Nh,coalesce:Qf,collator:pd,format:ru,image:Ml,in:ng,"index-of":tp,interpolate:xs,"interpolate-hcl":xs,"interpolate-lab":xs,length:$h,let:ep,literal:Qa,match:og,number:es,"number-format":ig,object:es,slice:np,step:Fl,string:es,"to-boolean":Us,"to-color":Us,"to-number":Us,"to-string":Us,var:$r,within:cl,distance:ns,config:su};function ey(c,[n,a,u,m]){n=n.evaluate(c),a=a.evaluate(c),u=u.evaluate(c);const h=m?m.evaluate(c):1,v=Zf(n,a,u,h);if(v)throw new _i(v);return new Ln(n/255*h,a/255*h,u/255*h,h)}function ag(c,[n,a,u,m]){n=n.evaluate(c),a=a.evaluate(c),u=u.evaluate(c);const h=m?m.evaluate(c):1,v=function(L,x,A,O){return typeof L=="number"&&L>=0&&L<=360?typeof x=="number"&&x>=0&&x<=100&&typeof A=="number"&&A>=0&&A<=100?O===void 0||typeof O=="number"&&O>=0&&O<=1?null:`Invalid hsla value [${[L,x,A,O].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof O=="number"?[L,x,A,O]:[L,x,A]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof O=="number"?[L,x,A,O]:[L,x,A]).join(", ")}]: 'h' must be between 0 and 360.`}(n,a,u,h);if(v)throw new _i(v);const T=`hsla(${n}, ${a}%, ${u}%, ${h})`,k=Ln.parse(T);if(!k)throw new _i(`Failed to parse HSLA color: ${T}`);return k}function sg(c,n){return c in n}function lg(c,n){const a=n[c];return a===void 0?null:a}function Du(c){return{type:c}}function ty(c){return{result:"success",value:c}}function wc(c){return{result:"error",value:c}}function rp(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function zu(c){return c["property-type"]==="data-driven"}function ny(c){return rp(c.expression,"measure-light")}function cg(c){return rp(c.expression,"zoom")}function ug(c){return!!c.expression&&c.expression.interpolated}function dg(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function oy(c){return c}function hg(c,n){const a=n.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",m=u||!(u||c.property!==void 0),h=c.type||(ug(n)?"exponential":"interval");if(a&&((c=$n({},c)).stops&&(c.stops=c.stops.map(L=>[L[0],Ln.parse(L[1])])),c.default=Ln.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!K_[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let v,T,k;if(h==="exponential")v=fg;else if(h==="interval")v=k1;else if(h==="categorical"){v=A1,T=Object.create(null);for(const L of c.stops)T[L[0]]=L[1];k=typeof c.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);v=P1}if(u){const L={},x=[];for(let M=0;M<c.stops.length;M++){const R=c.stops[M],N=R[0].zoom;L[N]===void 0&&(L[N]={zoom:N,type:c.type,property:c.property,default:c.default,stops:[]},x.push(N)),L[N].stops.push([R[0].value,R[1]])}const A=[];for(const M of x)A.push([L[M].zoom,hg(L[M],n)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:xs.interpolationFactor.bind(void 0,O),zoomStops:A.map(M=>M[0]),evaluate:({zoom:M},R)=>fg({stops:A,base:c.base},n,M).evaluate(M,R)}}if(m){const L=h==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:xs.interpolationFactor.bind(void 0,L),zoomStops:c.stops.map(x=>x[0]),evaluate:({zoom:x})=>v(c,n,x,T,k)}}return{kind:"source",evaluate(L,x){const A=x&&x.properties?x.properties[c.property]:void 0;return A===void 0?Vh(c.default,n.default):v(c,n,A,T,k)}}}function Vh(c,n,a){return c!==void 0?c:n!==void 0?n:a!==void 0?a:void 0}function A1(c,n,a,u,m){return Vh(typeof a===m?u[a]:void 0,c.default,n.default)}function k1(c,n,a){if(Vs(a)!=="number")return Vh(c.default,n.default);const u=c.stops.length;if(u===1||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[u-1][0])return c.stops[u-1][1];const m=zl(c.stops.map(h=>h[0]),a);return c.stops[m][1]}function fg(c,n,a){const u=c.base!==void 0?c.base:1;if(Vs(a)!=="number")return Vh(c.default,n.default);const m=c.stops.length;if(m===1||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[m-1][0])return c.stops[m-1][1];const h=zl(c.stops.map(x=>x[0]),a),v=function(x,A,O,M){const R=M-O,N=x-O;return R===0?0:A===1?N/R:(Math.pow(A,N)-1)/(Math.pow(A,R)-1)}(a,u,c.stops[h][0],c.stops[h+1][0]),T=c.stops[h][1],k=c.stops[h+1][1];let L=Ti[n.type]||oy;if(c.colorSpace&&c.colorSpace!=="rgb"){const x=K_[c.colorSpace];L=(A,O)=>x.reverse(x.interpolate(x.forward(A),x.forward(O),v))}return typeof T.evaluate=="function"?{evaluate(...x){const A=T.evaluate.apply(void 0,x),O=k.evaluate.apply(void 0,x);if(A!==void 0&&O!==void 0)return L(A,O,v)}}:L(T,k,v)}function P1(c,n,a){return n.type==="color"?a=Ln.parse(a):n.type==="formatted"?a=la.fromString(a.toString()):n.type==="resolvedImage"?a=ma.fromString(a.toString()):Vs(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0),Vh(a,c.default,n.default)}va.register(Cd,{error:[{kind:"error"},[fr],(c,[n])=>{throw new _i(n.evaluate(c))}],typeof:[fr,[xr],(c,[n])=>xi(Ci(n.evaluate(c)))],"to-rgba":[pa(Hn,4),[zr],(c,[n])=>n.evaluate(c).toRenderColor(null).toArray()],rgb:[zr,[Hn,Hn,Hn],ey],rgba:[zr,[Hn,Hn,Hn,Hn],ey],hsl:[zr,[Hn,Hn,Hn],ag],hsla:[zr,[Hn,Hn,Hn,Hn],ag],has:{type:br,overloads:[[[fr],(c,[n])=>sg(n.evaluate(c),c.properties())],[[fr,sa],(c,[n,a])=>sg(n.evaluate(c),a.evaluate(c))]]},get:{type:xr,overloads:[[[fr],(c,[n])=>lg(n.evaluate(c),c.properties())],[[fr,sa],(c,[n,a])=>lg(n.evaluate(c),a.evaluate(c))]]},"feature-state":[xr,[fr],(c,[n])=>lg(n.evaluate(c),c.featureState||{})],properties:[sa,[],c=>c.properties()],"geometry-type":[fr,[],c=>c.geometryType()],id:[xr,[],c=>c.id()],zoom:[Hn,[],c=>c.globals.zoom],pitch:[Hn,[],c=>c.globals.pitch||0],"distance-from-center":[Hn,[],c=>c.distanceFromCenter()],"measure-light":[Hn,[fr],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[Hn,[],c=>c.globals.heatmapDensity||0],"line-progress":[Hn,[],c=>c.globals.lineProgress||0],"raster-value":[Hn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[Hn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[Hn,[],c=>c.globals.skyRadialProgress||0],accumulated:[xr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Hn,Du(Hn),(c,n)=>{let a=0;for(const u of n)a+=u.evaluate(c);return a}],"*":[Hn,Du(Hn),(c,n)=>{let a=1;for(const u of n)a*=u.evaluate(c);return a}],"-":{type:Hn,overloads:[[[Hn,Hn],(c,[n,a])=>n.evaluate(c)-a.evaluate(c)],[[Hn],(c,[n])=>-n.evaluate(c)]]},"/":[Hn,[Hn,Hn],(c,[n,a])=>n.evaluate(c)/a.evaluate(c)],"%":[Hn,[Hn,Hn],(c,[n,a])=>n.evaluate(c)%a.evaluate(c)],ln2:[Hn,[],()=>Math.LN2],pi:[Hn,[],()=>Math.PI],e:[Hn,[],()=>Math.E],"^":[Hn,[Hn,Hn],(c,[n,a])=>Math.pow(n.evaluate(c),a.evaluate(c))],sqrt:[Hn,[Hn],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[Hn,[Hn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[Hn,[Hn],(c,[n])=>Math.log(n.evaluate(c))],log2:[Hn,[Hn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[Hn,[Hn],(c,[n])=>Math.sin(n.evaluate(c))],cos:[Hn,[Hn],(c,[n])=>Math.cos(n.evaluate(c))],tan:[Hn,[Hn],(c,[n])=>Math.tan(n.evaluate(c))],asin:[Hn,[Hn],(c,[n])=>Math.asin(n.evaluate(c))],acos:[Hn,[Hn],(c,[n])=>Math.acos(n.evaluate(c))],atan:[Hn,[Hn],(c,[n])=>Math.atan(n.evaluate(c))],min:[Hn,Du(Hn),(c,n)=>Math.min(...n.map(a=>a.evaluate(c)))],max:[Hn,Du(Hn),(c,n)=>Math.max(...n.map(a=>a.evaluate(c)))],abs:[Hn,[Hn],(c,[n])=>Math.abs(n.evaluate(c))],round:[Hn,[Hn],(c,[n])=>{const a=n.evaluate(c);return a<0?-Math.round(-a):Math.round(a)}],floor:[Hn,[Hn],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[Hn,[Hn],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[br,[fr,xr],(c,[n,a])=>c.properties()[n.value]===a.value],"filter-id-==":[br,[xr],(c,[n])=>c.id()===n.value],"filter-type-==":[br,[fr],(c,[n])=>c.geometryType()===n.value],"filter-<":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],m=a.value;return typeof u==typeof m&&u<m}],"filter-id-<":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a<u}],"filter->":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],m=a.value;return typeof u==typeof m&&u>m}],"filter-id->":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a>u}],"filter-<=":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],m=a.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a<=u}],"filter->=":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],m=a.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a>=u}],"filter-has":[br,[xr],(c,[n])=>n.value in c.properties()],"filter-has-id":[br,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[br,[pa(fr)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[br,[pa(xr)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[br,[fr,pa(xr)],(c,[n,a])=>a.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[br,[fr,pa(xr)],(c,[n,a])=>function(u,m,h,v){for(;h<=v;){const T=h+v>>1;if(m[T]===u)return!0;m[T]>u?v=T-1:h=T+1}return!1}(c.properties()[n.value],a.value,0,a.value.length-1)],all:{type:br,overloads:[[[br,br],(c,[n,a])=>n.evaluate(c)&&a.evaluate(c)],[Du(br),(c,n)=>{for(const a of n)if(!a.evaluate(c))return!1;return!0}]]},any:{type:br,overloads:[[[br,br],(c,[n,a])=>n.evaluate(c)||a.evaluate(c)],[Du(br),(c,n)=>{for(const a of n)if(a.evaluate(c))return!0;return!1}]]},"!":[br,[br],(c,[n])=>!n.evaluate(c)],"is-supported-script":[br,[fr],(c,[n])=>{const a=c.globals&&c.globals.isSupportedScript;return!a||a(n.evaluate(c))}],upcase:[fr,[fr],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[fr,[fr],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[fr,Du(xr),(c,n)=>n.map(a=>ca(a.evaluate(c))).join("")],"resolved-locale":[fr,[Ja],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[Hn,[Hn,Hn,xr],(c,n)=>{const[a,u,m]=n.map(v=>v.evaluate(c));if(a>u||a===u)return a;let h;if(typeof m=="string")h=function(v){let T=0;if(v.length===0)return T;for(let k=0;k<v.length;k++)T=(T<<5)-T+v.charCodeAt(k),T|=0;return T}(m);else{if(typeof m!="number")throw new _i(`Invalid seed input: ${m}`);h=m}return a+op(h)()*(u-a)}]});class pg{constructor(n,a,u,m){this.expression=n,this._warningHistory={},this._evaluator=new Il(u,m),this._defaultValue=a?function(h){return h.type==="color"&&(dg(h.default)||Array.isArray(h.default))?new Ln(0,0,0,0):h.type==="color"?Ln.parse(h.default)||null:h.default===void 0?null:h.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this.configDependencies=Dl(n)}evaluateWithoutErrorHandling(n,a,u,m,h,v,T,k){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(n,a,u,m,h,v,T,k){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=k||null;try{const L=this.expression.evaluate(this._evaluator);if(L==null||typeof L=="number"&&L!=L)return this._defaultValue;if(this._enumValues&&!(L in this._enumValues))throw new _i(`Expected value to be one of ${Object.keys(this._enumValues).map(x=>JSON.stringify(x)).join(", ")}, but found ${JSON.stringify(L)} instead.`);return L}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${L.message}`)),this._defaultValue}}}function ip(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Cd}function Ed(c,n,a,u){const m=new Ws(Cd,[],n?function(v){const T={color:zr,string:fr,number:Hn,enum:fr,boolean:br,formatted:cc,resolvedImage:uc};return v.type==="array"?pa(T[v.value]||xr,v.length):T[v.type]}(n):void 0,void 0,void 0,a,u),h=m.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?ty(new pg(h,n,a,u)):wc(m.errors)}class ap{constructor(n,a,u){this.kind=n,this._styleExpression=a,this.isLightConstant=u,this.isStateDependent=n!=="constant"&&!ri(a.expression),this.configDependencies=Dl(a.expression)}evaluateWithoutErrorHandling(n,a,u,m,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,m,h,v)}evaluate(n,a,u,m,h,v){return this._styleExpression.evaluate(n,a,u,m,h,v)}}class Uh{constructor(n,a,u,m,h){this.kind=n,this.zoomStops=u,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!ri(a.expression),this.isLightConstant=h,this.configDependencies=Dl(a.expression),this.interpolationType=m}evaluateWithoutErrorHandling(n,a,u,m,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,m,h,v)}evaluate(n,a,u,m,h,v){return this._styleExpression.evaluate(n,a,u,m,h,v)}interpolationFactor(n,a,u){return this.interpolationType?xs.interpolationFactor(this.interpolationType,n,a,u):0}}function Fu(c,n,a,u){if((c=Ed(c,n,a,u)).result==="error")return c;const m=c.value.expression,h=li(m);if(!h&&!zu(n))return wc([new ko("","data expressions not supported")]);const v=$a(m,["zoom","pitch","distance-from-center"]);if(!v&&!cg(n))return wc([new ko("","zoom expressions not supported")]);const T=$a(m,["measure-light"]);if(!T&&!ny(n))return wc([new ko("","measure-light expression not supported")]);const k=$a(m,["line-progress"]);if(!k&&!function(A){return rp(A.expression,"line-progress")}(n))return wc([new ko("","line-progress expression not supported")]);const L=n.expression&&n.expression.relaxZoomRestriction,x=lp(m);return x||v||L?x instanceof ko?wc([x]):x instanceof xs&&!ug(n)?wc([new ko("",'"interpolate" expressions cannot be used with this property')]):ty(x?new Uh(h&&k?"camera":"composite",c.value,x.labels,x instanceof xs?x.interpolation:void 0,T):new ap(h&&k?"constant":"source",c.value,T)):wc([new ko("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class sp{constructor(n,a){this._parameters=n,this._specification=a,$n(this,hg(this._parameters,this._specification))}static deserialize(n){return new sp(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function lp(c){let n=null;if(c instanceof ep)n=lp(c.result);else if(c instanceof Qf){for(const a of c.args)if(n=lp(a),n)break}else(c instanceof Fl||c instanceof xs)&&c.input instanceof va&&c.input.name==="zoom"&&(n=c);return n instanceof ko||c.eachChild(a=>{const u=lp(a);u instanceof ko?n=u:n&&u&&n!==u&&(n=new ko("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var mg,gg,ry=function(){if(gg)return mg;gg=1,mg=n;var c=3;function n(a,u,m){var h=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var v=new Int32Array(this.arrayBuffer);a=v[0],this.d=(u=v[1])+2*(m=v[2]);for(var T=0;T<this.d*this.d;T++){var k=v[c+T],L=v[c+T+1];h.push(k===L?null:v.subarray(k,L))}var x=v[c+h.length+1];this.keys=v.subarray(v[c+h.length],x),this.bboxes=v.subarray(x),this.insert=this._insertReadonly}else{this.d=u+2*m;for(var A=0;A<this.d*this.d;A++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=a,this.padding=m,this.scale=u/a,this.uid=0;var O=m/u*a;this.min=-O,this.max=a+O}return n.prototype.insert=function(a,u,m,h,v){this._forEachCell(u,m,h,v,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(h),this.bboxes.push(v)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(a,u,m,h,v,T){this.cells[v].push(T)},n.prototype.query=function(a,u,m,h,v){var T=this.min,k=this.max;if(a<=T&&u<=T&&k<=m&&k<=h&&!v)return Array.prototype.slice.call(this.keys);var L=[];return this._forEachCell(a,u,m,h,this._queryCell,L,{},v),L},n.prototype._queryCell=function(a,u,m,h,v,T,k,L){var x=this.cells[v];if(x!==null)for(var A=this.keys,O=this.bboxes,M=0;M<x.length;M++){var R=x[M];if(k[R]===void 0){var N=4*R;(L?L(O[N+0],O[N+1],O[N+2],O[N+3]):a<=O[N+2]&&u<=O[N+3]&&m>=O[N+0]&&h>=O[N+1])?(k[R]=!0,T.push(A[R])):k[R]=!1}}},n.prototype._forEachCell=function(a,u,m,h,v,T,k,L){for(var x=this._convertToCellCoord(a),A=this._convertToCellCoord(u),O=this._convertToCellCoord(m),M=this._convertToCellCoord(h),R=x;R<=O;R++)for(var N=A;N<=M;N++){var W=this.d*N+R;if((!L||L(this._convertFromCellCoord(R),this._convertFromCellCoord(N),this._convertFromCellCoord(R+1),this._convertFromCellCoord(N+1)))&&v.call(this,a,u,m,h,W,T,k,L))return}},n.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},n.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,u=c+this.cells.length+1+1,m=0,h=0;h<this.cells.length;h++)m+=this.cells[h].length;var v=new Int32Array(u+m+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var T=u,k=0;k<a.length;k++){var L=a[k];v[c+k]=T,v.set(L,T),T+=L.length}return v[c+a.length]=T,v.set(this.keys,T),v[c+a.length+1]=T+=this.keys.length,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer},mg}(),Bu=S(ry);const jh={};function no(c,n,a={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),jh[n]={klass:c,omit:a.omit||[]}}no(Object,"Object"),Bu.serialize=function(c,n){const a=c.toArrayBuffer();return n&&n.add(a),{buffer:a}},Bu.deserialize=function(c){return new Bu(c.buffer)},Object.defineProperty(Bu,"name",{value:"Grid"}),no(Bu,"Grid"),no(Ln,"Color"),no(Error,"Error"),no(la,"Formatted"),no(Ia,"FormattedSection"),no(il,"AJAXError"),no(ma,"ResolvedImage"),no(sp,"StylePropertyFunction"),no(pg,"StyleExpression",{omit:["_evaluator"]}),no(Uh,"ZoomDependentExpression"),no(ap,"ZoomConstantExpression"),no(va,"CompoundExpression",{omit:["_evaluate"]});for(const c in Cd)jh[Cd[c]._classRegistryKey]||no(Cd[c],`Expression${c}`);function cp(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function vg(c){return self.ImageBitmap&&c instanceof ImageBitmap}function Nu(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(cp(c)||vg(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c)){const a=c;return n&&n.add(a.buffer),a}if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const a=[];for(const u of c)a.push(Nu(u,n));return a}if(c instanceof Map){const a={$name:"Map"};for(const[u,m]of c.entries())a[u]=Nu(m);return a}if(c instanceof Set){const a={$name:"Set"};let u=0;for(const m of c.values())a[++u]=Nu(m);return a}if(typeof c=="object"){const a=c.constructor,u=a._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const m=a.serialize?a.serialize(c,n):{};if(!a.serialize){for(const h in c)c.hasOwnProperty(h)&&(jh[u].omit.indexOf(h)>=0||(m[h]=Nu(c[h],n)));c instanceof Error&&(m.message=c.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(m.$name=u),m}throw new Error("can't serialize object of type "+typeof c)}function os(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||cp(c)||vg(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(os);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const m=new Map;for(const h of Object.keys(c))h!=="$name"&&m.set(h,os(c[h]));return m}if(n==="Set"){const m=new Set;for(const h of Object.keys(c))h!=="$name"&&m.add(os(c[h]));return m}const{klass:a}=jh[n];if(!a)throw new Error(`can't deserialize unregistered class ${n}`);if(a.deserialize)return a.deserialize(c);const u=Object.create(a.prototype);for(const m of Object.keys(c))m!=="$name"&&(u[m]=os(c[m]));return u}throw new Error("can't deserialize object of type "+typeof c)}const go={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function _g(c){for(const n of c)if(Md(n.charCodeAt(0)))return!0;return!1}function iy(c){for(const n of c)if(!R1(n.charCodeAt(0)))return!1;return!0}function R1(c){return!(go.Arabic(c)||go["Arabic Supplement"](c)||go["Arabic Extended-A"](c)||go["Arabic Presentation Forms-A"](c)||go["Arabic Presentation Forms-B"](c))}function Md(c){return!(c!==746&&c!==747&&(c<4352||!(go["Bopomofo Extended"](c)||go.Bopomofo(c)||go["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||go["CJK Compatibility Ideographs"](c)||go["CJK Compatibility"](c)||go["CJK Radicals Supplement"](c)||go["CJK Strokes"](c)||!(!go["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||go["CJK Unified Ideographs Extension A"](c)||go["CJK Unified Ideographs"](c)||go["Enclosed CJK Letters and Months"](c)||go["Hangul Compatibility Jamo"](c)||go["Hangul Jamo Extended-A"](c)||go["Hangul Jamo Extended-B"](c)||go["Hangul Jamo"](c)||go["Hangul Syllables"](c)||go.Hiragana(c)||go["Ideographic Description Characters"](c)||go.Kanbun(c)||go["Kangxi Radicals"](c)||go["Katakana Phonetic Extensions"](c)||go.Katakana(c)&&c!==12540||!(!go["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!go["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||go["Unified Canadian Aboriginal Syllabics"](c)||go["Unified Canadian Aboriginal Syllabics Extended"](c)||go["Vertical Forms"](c)||go["Yijing Hexagram Symbols"](c)||go["Yi Syllables"](c)||go["Yi Radicals"](c))))}function yg(c){return!(Md(c)||function(n){return!!(go["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||go["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||go["Letterlike Symbols"](n)||go["Number Forms"](n)||go["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||go["Control Pictures"](n)&&n!==9251||go["Optical Character Recognition"](n)||go["Enclosed Alphanumerics"](n)||go["Geometric Shapes"](n)||go["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||go["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||go["CJK Symbols and Punctuation"](n)||go.Katakana(n)||go["Private Use Area"](n)||go["CJK Compatibility Forms"](n)||go["Small Form Variants"](n)||go["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function Hh(c){return c>=1424&&c<=2303||go["Arabic Presentation Forms-A"](c)||go["Arabic Presentation Forms-B"](c)}function ay(c,n){return!(!n&&Hh(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||go.Khmer(c))}function O1(c){for(const n of c)if(Hh(n.charCodeAt(0)))return!0;return!1}const bg="deferred",Gh="loading",Wh="loaded";let up=null,_a="unavailable",ws=null;const sy=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(_a="error"),up&&up(c)};function xg(){wg.fire(new wt("pluginStateChange",{pluginStatus:_a,pluginURL:ws}))}const wg=new Kn,Sg=function(){return _a},ly=function(){if(_a!==bg||!ws)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_a=Gh,xg(),ws&&tu({url:ws},c=>{c?sy(c):(_a=Wh,xg())})},Ss={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_a===Wh||Ss.applyArabicShaping!=null,isLoading:()=>_a===Gh,setState(c){_a=c.pluginStatus,ws=c.pluginURL},isParsed:()=>Ss.applyArabicShaping!=null&&Ss.processBidirectionalText!=null&&Ss.processStyledBidirectionalText!=null,getPluginURL:()=>ws};class Ei{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch,this.brightness=a.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(a,u){for(const m of a)if(!ay(m.charCodeAt(0),u))return!1;return!0}(n,Ss.isLoaded())}}class dp{constructor(n,a,u,m){this.property=n,this.value=a,this.expression=function(h,v,T,k){if(dg(h))return new sp(h,v);if(ip(h)||Array.isArray(h)&&h.length>0){const L=Fu(h,v,T,k);if(L.result==="error")throw new Error(L.value.map(x=>`${x.key}: ${x.message}`).join(", "));return L.value}{let L=h;return typeof h=="string"&&v.type==="color"&&(L=Ln.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>L}}}(a===void 0?n.specification.default:a,n.specification,u,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,u){return this.property.possiblyEvaluate(this,n,a,u)}}class Tg{constructor(n,a,u){this.property=n,this.value=new dp(n,void 0,a,u)}transitioned(n,a){return new uy(this.property,this.value,a,mo({},n.transition,this.transition),n.now)}untransitioned(){return new uy(this.property,this.value,null,{},0)}}class cy{constructor(n,a,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=a,this._options=u,this.configDependencies=new Set}getValue(n){return Je(this._values[n].value.value)}setValue(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new Tg(this._values[n].property,this._scope,this._options)),this._values[n].value=new dp(this._values[n].property,a===null?void 0:Je(a),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,a){a&&(this._options=a);const u=this._properties.properties;if(n)for(const m in n){const h=n[m];if(En(m,"-transition")){const v=m.slice(0,-11);u[v]&&this.setTransition(v,h)}else u.hasOwnProperty(m)&&this.setValue(m,h)}}getTransition(n){return Je(this._values[n].transition)}setTransition(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new Tg(this._values[n].property)),this._values[n].transition=Je(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u);const m=this.getTransition(a);m!==void 0&&(n[`${a}-transition`]=m)}return n}transitioned(n,a){const u=new dy(this._properties);for(const m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(n,a._values[m]);return u}untransitioned(){const n=new dy(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class uy{constructor(n,a,u,m,h){const v=m.delay||0,T=m.duration||0;h=h||0,this.property=n,this.value=a,this.begin=h+v,this.end=this.begin+T,n.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(n,a,u){const m=n.now||0,h=this.value.possiblyEvaluate(n,a,u),v=this.prior;if(v){if(m>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(m<this.begin)return v.possiblyEvaluate(n,a,u);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,a,u),h,yn(T))}}return h}}class dy{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,u){const m=new Ad(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(n,a,u);return m}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class L1{constructor(n,a,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=a,this._options=u,this.configDependencies=new Set}getValue(n){return Je(this._values[n].value)}setValue(n,a){this._values[n]=new dp(this._values[n].property,a===null?void 0:Je(a),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u)}return n}possiblyEvaluate(n,a,u){const m=new Ad(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(n,a,u);return m}}class Id{constructor(n,a,u){this.property=n,this.value=a,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,u,m){return this.property.evaluate(this.value,this.parameters,n,a,u,m)}}class Ad{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Rn{constructor(n){this.specification=n}possiblyEvaluate(n,a){return n.expression.evaluate(a)}interpolate(n,a,u){const m=Ti[this.specification.type];return m?m(n,a,u):n}}class _o{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,u,m){return new Id(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},u,m)}:n.expression,a)}interpolate(n,a,u){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new Id(this,{kind:"constant",value:void 0},n.parameters);const m=Ti[this.specification.type];return m?new Id(this,{kind:"constant",value:m(n.value.value,a.value.value,u)},n.parameters):n}evaluate(n,a,u,m,h,v){return n.kind==="constant"?n.value:n.evaluate(a,u,m,h,v)}}class kd{constructor(n){this.specification=n}possiblyEvaluate(n,a,u,m){return!!n.expression.evaluate(a,null,{},u,m)}interpolate(){return!1}}class ci{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Ei(0,{});for(const u in n){const m=n[u];m.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new dp(m,void 0),v=this.defaultTransitionablePropertyValues[u]=new Tg(m);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(a)}}}no(_o,"DataDrivenProperty"),no(Rn,"DataConstantProperty"),no(kd,"ColorRampProperty");var Lt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,90],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"rain":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Cg(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function $u(c){if(Array.isArray(c))return c.map($u);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const a in c)n[a]=$u(c[a]);return n}return Cg(c)}function Eg(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!Eg(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function hp(c,n="",a=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Eg(c)||(c=fp(c));const m=c;let h=!0;try{h=function(x){if(!fl(x))return x;let A=$u(x);return Mg(A),A=Sc(A),A}(m)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(m,null,2)}
        `)}let v=null,T=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){T=Lt[`filter_${u}`];const x=Ed(h,T,n,a);if(x.result==="error")throw new Error(x.value.map(A=>`${A.key}: ${A.message}`).join(", "));v=(A,O,M)=>x.value.evaluate(A,O,{},M)}let k=null,L=null;if(h!==m){const x=Ed(m,T,n,a);if(x.result==="error")throw new Error(x.value.map(A=>`${A.key}: ${A.message}`).join(", "));k=(A,O,M,R,N)=>x.value.evaluate(A,O,{},M,void 0,void 0,R,N),L=!li(x.value.expression)}return{filter:v,dynamicFilter:k||void 0,needGeometry:hy(h),needFeature:!!L}}function Sc(c){if(!Array.isArray(c))return c;const n=function(a){if(D1.has(a[0])){for(let u=1;u<a.length;u++)if(fl(a[u]))return!0}return a}(c);return n===!0?n:n.map(a=>Sc(a))}function Mg(c){let n=!1;const a=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)n=n||fl(c[u]),a.push(c[u+1]);a.push(c[c.length-1])}else if(c[0]==="match"){n=n||fl(c[1]);for(let u=2;u<c.length-1;u+=2)a.push(c[u+1]);a.push(c[c.length-1])}else if(c[0]==="step"){n=n||fl(c[1]);for(let u=1;u<c.length-1;u+=2)a.push(c[u+1])}n&&(c.length=0,c.push("any",...a));for(let u=1;u<c.length;u++)Mg(c[u])}function fl(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let a=1;a<c.length;a++)if(fl(c[a]))return!0;return!1}const D1=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function z1(c,n){return c<n?-1:c>n?1:0}function hy(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(hy(c[n]))return!0;return!1}function fp(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?Ig(c[1],c[2],"=="):n==="!="?Vu(Ig(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Ig(c[1],c[2],n):n==="any"?(a=c.slice(1),["any"].concat(a.map(fp))):n==="all"?["all"].concat(c.slice(1).map(fp)):n==="none"?["all"].concat(c.slice(1).map(fp).map(Vu)):n==="in"?Ag(c[1],c.slice(2)):n==="!in"?Vu(Ag(c[1],c.slice(2))):n==="has"?pp(c[1]):n!=="!has"||Vu(pp(c[1]));var a}function Ig(c,n,a){switch(c){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,c,n]}}function Ag(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",c,["literal",n.sort(z1)]]:["filter-in-small",c,["literal",n]]}}function pp(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Vu(c){return["!",c]}const qh="";function mp(c,n){return n?`${c}${qh}${n}`:c}const fy="-transition",Nl=new Set(["fill","line","background","hillshade","raster"]);class Va extends Kn{constructor(n,a,u,m,h){if(super(),this.id=n.id,this.fqid=mp(this.id,u),this.type=n.type,this.scope=u,this.lut=m,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const v=Ed(this.filter,Lt[`filter_${n.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),a.layout&&(this._unevaluatedLayout=new L1(a.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),a.paint){this._transitionablePaint=new cy(a.paint,this.scope,h);for(const v in n.paint)this.setPaintProperty(v,n.paint[v]);for(const v in n.layout)this.setLayoutProperty(v,n.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ad(a.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&Nl.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a){if(this.type==="custom"&&n==="visibility")return void(this.visibility=a);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return En(n,fy)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a){const u=this._transitionablePaint,m=u._properties.properties;if(En(n,fy)){const A=n.slice(0,-11);return m[A]&&u.setTransition(A,a||void 0),!1}if(!m[n])return!1;const h=u._values[n],v=h.value.isDataDriven(),T=h.value;u.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const k=u._values[n].value,L=k.isDataDriven(),x=En(n,"pattern")||n==="line-dasharray";return L||v||x||this._handleOverridablePaintPropertyUpdate(n,T,k)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,a,u){return null}_handleOverridablePaintPropertyUpdate(n,a,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){return un({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof Id&&zu(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=hp(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,a,u,m,h,v,T,k,L){}queryIntersectsMatchingFeature(n,a,u,m){}}const py={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Kh{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ui{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&(n.isTransferred=!0,a.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Mr(c,n=1){let a=0,u=0;return{members:c.map(m=>{const h=py[m.type].BYTES_PER_ELEMENT,v=a=my(a,Math.max(n,h)),T=m.components||1;return u=Math.max(u,h),a+=h*T,{name:m.name,type:m.type,components:T,offset:v}}),size:my(a,Math.max(u,n)),alignment:n}}function my(c,n){return Math.ceil(c/n)*n}class uu extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const m=2*n;return this.int16[m+0]=a,this.int16[m+1]=u,n}}uu.prototype.bytesPerElement=4,no(uu,"StructArrayLayout2i4");class gp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,a,u)}emplace(n,a,u,m){const h=3*n;return this.int16[h+0]=a,this.int16[h+1]=u,this.int16[h+2]=m,n}}gp.prototype.bytesPerElement=6,no(gp,"StructArrayLayout3i6");class Pd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const v=4*n;return this.int16[v+0]=a,this.int16[v+1]=u,this.int16[v+2]=m,this.int16[v+3]=h,n}}Pd.prototype.bytesPerElement=8,no(Pd,"StructArrayLayout4i8");class kg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,m,h)}emplace(n,a,u,m,h,v){const T=5*n;return this.int16[T+0]=a,this.int16[T+1]=u,this.int16[T+2]=m,this.int16[T+3]=h,this.int16[T+4]=v,n}}kg.prototype.bytesPerElement=10,no(kg,"StructArrayLayout5i10");class Zh extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,a,u,m,h,v,T)}emplace(n,a,u,m,h,v,T,k){const L=6*n,x=12*n,A=3*n;return this.int16[L+0]=a,this.int16[L+1]=u,this.uint8[x+4]=m,this.uint8[x+5]=h,this.uint8[x+6]=v,this.uint8[x+7]=T,this.float32[A+2]=k,n}}Zh.prototype.bytesPerElement=12,no(Zh,"StructArrayLayout2i4ub1f12");class Tc extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const v=4*n;return this.float32[v+0]=a,this.float32[v+1]=u,this.float32[v+2]=m,this.float32[v+3]=h,n}}Tc.prototype.bytesPerElement=16,no(Tc,"StructArrayLayout4f16");class du extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,a,u)}emplace(n,a,u,m){const h=3*n;return this.float32[h+0]=a,this.float32[h+1]=u,this.float32[h+2]=m,n}}du.prototype.bytesPerElement=12,no(du,"StructArrayLayout3f12");class Cc extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,m,h)}emplace(n,a,u,m,h,v){const T=6*n,k=3*n;return this.uint16[T+0]=a,this.uint16[T+1]=u,this.uint16[T+2]=m,this.uint16[T+3]=h,this.float32[k+2]=v,n}}Cc.prototype.bytesPerElement=12,no(Cc,"StructArrayLayout4ui1f12");class vp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const v=4*n;return this.uint16[v+0]=a,this.uint16[v+1]=u,this.uint16[v+2]=m,this.uint16[v+3]=h,n}}vp.prototype.bytesPerElement=8,no(vp,"StructArrayLayout4ui8");class Yh extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,m,h,v)}emplace(n,a,u,m,h,v,T){const k=6*n;return this.int16[k+0]=a,this.int16[k+1]=u,this.int16[k+2]=m,this.int16[k+3]=h,this.int16[k+4]=v,this.int16[k+5]=T,n}}Yh.prototype.bytesPerElement=12,no(Yh,"StructArrayLayout6i12");class Rd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T,k,L,x,A,O){const M=this.length;return this.resize(M+1),this.emplace(M,n,a,u,m,h,v,T,k,L,x,A,O)}emplace(n,a,u,m,h,v,T,k,L,x,A,O,M){const R=12*n;return this.int16[R+0]=a,this.int16[R+1]=u,this.int16[R+2]=m,this.int16[R+3]=h,this.uint16[R+4]=v,this.uint16[R+5]=T,this.uint16[R+6]=k,this.uint16[R+7]=L,this.int16[R+8]=x,this.int16[R+9]=A,this.int16[R+10]=O,this.int16[R+11]=M,n}}Rd.prototype.bytesPerElement=24,no(Rd,"StructArrayLayout4i4ui4i24");class Pg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,m,h,v)}emplace(n,a,u,m,h,v,T){const k=10*n,L=5*n;return this.int16[k+0]=a,this.int16[k+1]=u,this.int16[k+2]=m,this.float32[L+2]=h,this.float32[L+3]=v,this.float32[L+4]=T,n}}Pg.prototype.bytesPerElement=20,no(Pg,"StructArrayLayout3i3f20");class Rg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}Rg.prototype.bytesPerElement=4,no(Rg,"StructArrayLayout1ul4");class hu extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const m=2*n;return this.uint16[m+0]=a,this.uint16[m+1]=u,n}}hu.prototype.bytesPerElement=4,no(hu,"StructArrayLayout2ui4");class Og extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T,k,L,x,A,O,M){const R=this.length;return this.resize(R+1),this.emplace(R,n,a,u,m,h,v,T,k,L,x,A,O,M)}emplace(n,a,u,m,h,v,T,k,L,x,A,O,M,R){const N=20*n,W=10*n;return this.int16[N+0]=a,this.int16[N+1]=u,this.int16[N+2]=m,this.int16[N+3]=h,this.int16[N+4]=v,this.float32[W+3]=T,this.float32[W+4]=k,this.float32[W+5]=L,this.float32[W+6]=x,this.int16[N+14]=A,this.uint32[W+8]=O,this.uint16[N+18]=M,this.uint16[N+19]=R,n}}Og.prototype.bytesPerElement=40,no(Og,"StructArrayLayout5i4f1i1ul2ui40");class _p extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,a,u,m,h,v,T)}emplace(n,a,u,m,h,v,T,k){const L=8*n;return this.int16[L+0]=a,this.int16[L+1]=u,this.int16[L+2]=m,this.int16[L+4]=h,this.int16[L+5]=v,this.int16[L+6]=T,this.int16[L+7]=k,n}}_p.prototype.bytesPerElement=16,no(_p,"StructArrayLayout3i2i2i16");class Od extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,m,h)}emplace(n,a,u,m,h,v){const T=4*n,k=8*n;return this.float32[T+0]=a,this.float32[T+1]=u,this.float32[T+2]=m,this.int16[k+6]=h,this.int16[k+7]=v,n}}Od.prototype.bytesPerElement=16,no(Od,"StructArrayLayout2f1f2i16");class Ld extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,m,h,v)}emplace(n,a,u,m,h,v,T){const k=20*n,L=5*n;return this.uint8[k+0]=a,this.uint8[k+1]=u,this.float32[L+1]=m,this.float32[L+2]=h,this.float32[L+3]=v,this.float32[L+4]=T,n}}Ld.prototype.bytesPerElement=20,no(Ld,"StructArrayLayout2ub4f20");class bi extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,a,u)}emplace(n,a,u,m){const h=3*n;return this.uint16[h+0]=a,this.uint16[h+1]=u,this.uint16[h+2]=m,n}}bi.prototype.bytesPerElement=6,no(bi,"StructArrayLayout3ui6");class Dd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y,ne,re,J,ue){const ve=this.length;return this.resize(ve+1),this.emplace(ve,n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y,ne,re,J,ue)}emplace(n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y,ne,re,J,ue,ve){const Ie=30*n,Ge=15*n,ze=60*n;return this.int16[Ie+0]=a,this.int16[Ie+1]=u,this.int16[Ie+2]=m,this.float32[Ge+2]=h,this.float32[Ge+3]=v,this.uint16[Ie+8]=T,this.uint16[Ie+9]=k,this.uint32[Ge+5]=L,this.uint32[Ge+6]=x,this.uint32[Ge+7]=A,this.uint16[Ie+16]=O,this.uint16[Ie+17]=M,this.uint16[Ie+18]=R,this.float32[Ge+10]=N,this.float32[Ge+11]=W,this.uint8[ze+48]=Y,this.uint8[ze+49]=ne,this.uint8[ze+50]=re,this.uint32[Ge+13]=J,this.int16[Ie+28]=ue,this.uint8[ze+58]=ve,n}}Dd.prototype.bytesPerElement=60,no(Dd,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Lg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y,ne,re,J,ue,ve,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt){const Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y,ne,re,J,ue,ve,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt)}emplace(n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y,ne,re,J,ue,ve,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt,Ot){const Ft=20*n,Pt=40*n,sn=80*n;return this.float32[Ft+0]=a,this.float32[Ft+1]=u,this.int16[Pt+4]=m,this.int16[Pt+5]=h,this.int16[Pt+6]=v,this.int16[Pt+7]=T,this.int16[Pt+8]=k,this.int16[Pt+9]=L,this.int16[Pt+10]=x,this.int16[Pt+11]=A,this.int16[Pt+12]=O,this.uint16[Pt+13]=M,this.uint16[Pt+14]=R,this.uint16[Pt+15]=N,this.uint16[Pt+16]=W,this.uint16[Pt+17]=Y,this.uint16[Pt+18]=ne,this.uint16[Pt+19]=re,this.uint16[Pt+20]=J,this.uint16[Pt+21]=ue,this.uint16[Pt+22]=ve,this.uint16[Pt+23]=Ie,this.uint16[Pt+24]=Ge,this.uint16[Pt+25]=ze,this.uint16[Pt+26]=$e,this.uint16[Pt+27]=st,this.uint32[Ft+14]=Fe,this.float32[Ft+15]=rt,this.float32[Ft+16]=ht,this.float32[Ft+17]=pt,this.float32[Ft+18]=Tt,this.uint8[sn+76]=Ot,n}}Lg.prototype.bytesPerElement=80,no(Lg,"StructArrayLayout2f9i15ui1ul4f1ub80");class zd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}zd.prototype.bytesPerElement=4,no(zd,"StructArrayLayout1f4");class Uu extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,m,h)}emplace(n,a,u,m,h,v){const T=5*n;return this.float32[T+0]=a,this.float32[T+1]=u,this.float32[T+2]=m,this.float32[T+3]=h,this.float32[T+4]=v,n}}Uu.prototype.bytesPerElement=20,no(Uu,"StructArrayLayout5f20");class Dg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,a,u,m,h,v,T)}emplace(n,a,u,m,h,v,T,k){const L=7*n;return this.float32[L+0]=a,this.float32[L+1]=u,this.float32[L+2]=m,this.float32[L+3]=h,this.float32[L+4]=v,this.float32[L+5]=T,this.float32[L+6]=k,n}}Dg.prototype.bytesPerElement=28,no(Dg,"StructArrayLayout7f28");class yp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T,k,L,x,A){const O=this.length;return this.resize(O+1),this.emplace(O,n,a,u,m,h,v,T,k,L,x,A)}emplace(n,a,u,m,h,v,T,k,L,x,A,O){const M=11*n;return this.float32[M+0]=a,this.float32[M+1]=u,this.float32[M+2]=m,this.float32[M+3]=h,this.float32[M+4]=v,this.float32[M+5]=T,this.float32[M+6]=k,this.float32[M+7]=L,this.float32[M+8]=x,this.float32[M+9]=A,this.float32[M+10]=O,n}}yp.prototype.bytesPerElement=44,no(yp,"StructArrayLayout11f44");class gy extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T,k,L){const x=this.length;return this.resize(x+1),this.emplace(x,n,a,u,m,h,v,T,k,L)}emplace(n,a,u,m,h,v,T,k,L,x){const A=9*n;return this.float32[A+0]=a,this.float32[A+1]=u,this.float32[A+2]=m,this.float32[A+3]=h,this.float32[A+4]=v,this.float32[A+5]=T,this.float32[A+6]=k,this.float32[A+7]=L,this.float32[A+8]=x,n}}gy.prototype.bytesPerElement=36,no(gy,"StructArrayLayout9f36");class Xh extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,m)}emplace(n,a,u,m,h){const v=6*n;return this.uint32[3*n+0]=a,this.uint16[v+2]=u,this.uint16[v+3]=m,this.uint16[v+4]=h,n}}Xh.prototype.bytesPerElement=12,no(Xh,"StructArrayLayout1ul3ui12");class zg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}zg.prototype.bytesPerElement=2,no(zg,"StructArrayLayout1ui2");class Jh extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const m=2*n;return this.float32[m+0]=a,this.float32[m+1]=u,n}}Jh.prototype.bytesPerElement=8,no(Jh,"StructArrayLayout2f8");class Qh extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W){const Y=this.length;return this.resize(Y+1),this.emplace(Y,n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W)}emplace(n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y){const ne=16*n;return this.float32[ne+0]=a,this.float32[ne+1]=u,this.float32[ne+2]=m,this.float32[ne+3]=h,this.float32[ne+4]=v,this.float32[ne+5]=T,this.float32[ne+6]=k,this.float32[ne+7]=L,this.float32[ne+8]=x,this.float32[ne+9]=A,this.float32[ne+10]=O,this.float32[ne+11]=M,this.float32[ne+12]=R,this.float32[ne+13]=N,this.float32[ne+14]=W,this.float32[ne+15]=Y,n}}Qh.prototype.bytesPerElement=64,no(Qh,"StructArrayLayout16f64");class bp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,a,u,m,h,v,T)}emplace(n,a,u,m,h,v,T,k){const L=10*n,x=5*n;return this.uint16[L+0]=a,this.uint16[L+1]=u,this.uint16[L+2]=m,this.uint16[L+3]=h,this.float32[x+2]=v,this.float32[x+3]=T,this.float32[x+4]=k,n}}bp.prototype.bytesPerElement=20,no(bp,"StructArrayLayout4ui3f20");class xp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.int16[1*n+0]=a,n}}xp.prototype.bytesPerElement=2,no(xp,"StructArrayLayout1i2");class wp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint8[1*n+0]=a,n}}wp.prototype.bytesPerElement=1,no(wp,"StructArrayLayout1ub1");class vy extends Kh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}vy.prototype.size=40;class Sp extends Og{get(n){return new vy(this,n)}}no(Sp,"CollisionBoxArray");class ef extends Kh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}ef.prototype.size=60;class Fg extends Dd{get(n){return new ef(this,n)}}no(Fg,"PlacedSymbolArray");class _y extends Kh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}_y.prototype.size=80;class Bg extends Lg{get(n){return new _y(this,n)}}no(Bg,"SymbolInstanceArray");class yy extends zd{getoffsetX(n){return this.float32[1*n+0]}}no(yy,"GlyphOffsetArray");class Tp extends uu{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}no(Tp,"SymbolLineVertexArray");class by extends Kh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}by.prototype.size=12;class xy extends Xh{get(n){return new by(this,n)}}no(xy,"FeatureIndexArray");class wy extends hu{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}no(wy,"FillExtrusionCentroidArray");class Sy extends Kh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Sy.prototype.size=6;class Ng extends gp{get(n){return new Sy(this,n)}}no(Ng,"FillExtrusionWallArray");const F1=Mr([{name:"a_pos",components:2,type:"Int16"}],4),B1=Mr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ki{constructor(n=[]){this.segments=n}_prepareSegment(n,a,u,m){let h=this.segments[this.segments.length-1];return n>ki.MAX_VERTEX_ARRAY_LENGTH&&Bn(`Max vertices per segment is ${ki.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!h||h.vertexLength+n>ki.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==m)&&(h={vertexOffset:a,primitiveOffset:u,vertexLength:0,primitiveLength:0},m!==void 0&&(h.sortKey=m),this.segments.push(h)),h}prepareSegment(n,a,u,m){return this._prepareSegment(n,a.length,u.length,m)}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,u,m){return new ki([{vertexOffset:n,primitiveOffset:a,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function Ty(c,n){return 256*(c=yt(Math.floor(c),0,255))+yt(Math.floor(n),0,255)}ki.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,no(ki,"SegmentVector");const N1=Mr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),$1=Mr([{name:"a_dash",components:4,type:"Uint16"}]);class tf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,a,u,m){this.ids.push(Cy(n)),this.positions.push(a,u,m)}eachPosition(n,a){const u=Cy(n);let m=0,h=this.ids.length-1;for(;m<h;){const v=m+h>>1;this.ids[v]>=u?h=v:m=v+1}for(;this.ids[m]===u;)a(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(n,a){const u=new Float64Array(n.ids),m=new Uint32Array(n.positions);return Fd(u,m,0,u.length-1),a&&(a.add(u.buffer),a.add(m.buffer)),{ids:u,positions:m}}static deserialize(n){const a=new tf;let u;a.ids=n.ids,a.positions=n.positions;for(const m of a.ids)m!==u&&a.uniqueIds.push(m),u=m;return a.indexed=!0,a}}function Cy(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:Ve(String(c))}function Fd(c,n,a,u){for(;a<u;){const m=c[a+u>>1];let h=a-1,v=u+1;for(;;){do h++;while(c[h]<m);do v--;while(c[v]>m);if(h>=v)break;Cp(c,h,v),Cp(n,3*h,3*v),Cp(n,3*h+1,3*v+1),Cp(n,3*h+2,3*v+2)}v-a<u-v?(Fd(c,n,a,v),a=v+1):(Fd(c,n,v+1,u),u=v)}}function Cp(c,n,a){const u=c[n];c[n]=c[a],c[a]=u}no(tf,"FeaturePositionMap");class Ec{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,a),this.initialized=!0),!!this.location}set(n,a,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ju extends Ec{constructor(n){super(n),this.current=0}set(n,a,u){this.fetchUniformLocation(n,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class Qi extends Ec{constructor(n){super(n),this.current=0}set(n,a,u){this.fetchUniformLocation(n,a)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class $l extends Ec{constructor(n){super(n),this.current=[0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class $g extends Ec{constructor(n){super(n),this.current=[0,0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Ep extends Ec{constructor(n){super(n),this.current=[0,0,0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class Vg extends Ec{constructor(n){super(n),this.current=Ln.transparent.toRenderColor(null)}set(n,a,u){this.fetchUniformLocation(n,a)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const Ey=new Float32Array(16);class nf extends Ec{constructor(n){super(n),this.current=Ey}set(n,a,u){if(this.fetchUniformLocation(n,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let m=1;m<16;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const V1=new Float32Array(9),My=new Float32Array(4);class Mp extends Ec{constructor(n){super(n),this.current=My}set(n,a,u){if(this.fetchUniformLocation(n,a)){for(let m=0;m<4;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function Ug(c){return[Ty(255*c.r,255*c.g),Ty(255*c.b,255*c.a)]}class of{constructor(n,a,u,m){this.value=n,this.uniformNames=a.map(h=>`u_${h}`),this.type=u,this.context=m}setUniform(n,a,u,m,h){const v=m.constantOr(this.value);a.set(n,h,v instanceof Ln?v.toRenderColor(this.context.lut):v)}getBinding(n,a){return this.type==="color"?new Vg(n):new Qi(n)}}class Bd{constructor(n,a){this.uniformNames=a.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,a,u,m,h){const v=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;v&&a.set(n,h,v)}getBinding(n,a){return a==="u_pattern"||a==="u_dash"?new Ep(n):new Qi(n)}}class Mc{constructor(n,a,u,m){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(n,a,u,m,h,v,T){const k=this.paintVertexArray.length,L=this.expression.evaluate(new Ei(0,{brightness:v}),a,{},h,m,T);this.paintVertexArray.resize(n),this._setPaintValue(k,n,L,this.context)}updatePaintArray(n,a,u,m,h,v,T){const k=this.expression.evaluate({zoom:0,brightness:T},u,m,void 0,h);this._setPaintValue(n,a,k,this.context)}_setPaintValue(n,a,u,m){if(this.type==="color"){const h=Ug(u.toRenderColor(m.lut));for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,h[0],h[1])}else{for(let h=n;h<a;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pl{constructor(n,a,u,m,h,v){this.expression=n,this.uniformNames=a.map(T=>`u_${T}_t`),this.type=u,this.useIntegerZoom=m,this.context=h,this.maxValue=0,this.paintVertexAttributes=a.map(T=>({name:`a_${T}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,a,u,m,h,v,T){const k=this.expression.evaluate(new Ei(this.context.zoom,{brightness:v}),a,{},h,m,T),L=this.expression.evaluate(new Ei(this.context.zoom+1,{brightness:v}),a,{},h,m,T),x=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(x,n,k,L,this.context)}updatePaintArray(n,a,u,m,h,v,T){const k=this.expression.evaluate({zoom:this.context.zoom,brightness:T},u,m,void 0,h),L=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},u,m,void 0,h);this._setPaintValue(n,a,k,L,this.context)}_setPaintValue(n,a,u,m,h){if(this.type==="color"){const v=Ug(u.toRenderColor(h.lut)),T=Ug(u.toRenderColor(h.lut));for(let k=n;k<a;k++)this.paintVertexArray.emplace(k,v[0],v[1],T[0],T[1])}else{for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a,u,m,h){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,T=yt(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);a.set(n,h,T)}getBinding(n,a){return new Qi(n)}}class Ic{constructor(n,a,u,m,h){this.expression=n,this.layerId=h,this.paintVertexAttributes=(u==="array"?$1:N1).members;for(let v=0;v<a.length;++v);this.paintVertexArray=new m}populatePaintArray(n,a,u,m){const h=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(h,n,a.patterns&&a.patterns[this.layerId],u)}updatePaintArray(n,a,u,m,h,v,T){this._setPaintValues(n,a,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(n,a,u,m){if(!m||!u)return;const h=m[u];if(!h)return;const{tl:v,br:T,pixelRatio:k}=h;for(let L=n;L<a;L++)this.paintVertexArray.emplace(L,v[0],v[1],T[0],T[1],k)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ac{constructor(n,a,u=()=>!0){this.binders={},this._buffers=[],this.context=a;const m=[];for(const h in n.paint._values){const v=n.paint.get(h);if(!u(h)||!(v instanceof Id&&zu(v.property.specification)))continue;const T=j1(h,n.type),k=v.value,L=v.property.specification.type,x=!!v.property.useIntegerZoom,A=h==="line-dasharray"||h.endsWith("pattern"),O=h==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(k.kind!=="constant"||O)if(k.kind==="source"||O||A){const M=Iy(h,L,"source");this.binders[h]=A?new Ic(k,T,L,M,n.id):new Mc(k,T,L,M),m.push(`/a_${h}`)}else{const M=Iy(h,L,"composite");this.binders[h]=new pl(k,T,L,x,a,M),m.push(`/z_${h}`)}else this.binders[h]=A?new Bd(k.value,T):new of(k.value,T,L,a),m.push(`/u_${h}`)}this.cacheKey=m.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof Mc||a instanceof pl?a.maxValue:0}populatePaintArrays(n,a,u,m,h,v,T){for(const k in this.binders){const L=this.binders[k];L.context=this.context,(L instanceof Mc||L instanceof pl||L instanceof Ic)&&L.populatePaintArray(n,a,u,m,h,v,T)}}setConstantPatternPositions(n){for(const a in this.binders){const u=this.binders[a];u instanceof Bd&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,a,u,m,h,v,T,k){let L=!1;const x=Object.keys(n),A=x.length!==0,O=A?x:a.uniqueIds;this.context.lut=h.lut;for(const M in this.binders){const R=this.binders[M];if(R.context=this.context,(R instanceof Mc||R instanceof pl||R instanceof Ic)&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){const N=h.paint.get(M);R.expression=N.value;for(const W of O){const Y=n[W.toString()];a.eachPosition(W,(ne,re,J)=>{const ue=m.feature(ne);R.updatePaintArray(re,J,ue,Y,v,T,k)})}if(!A)for(const W of u.uniqueIds){const Y=n[W.toString()];u.eachPosition(W,(ne,re,J)=>{const ue=m.feature(ne);R.updatePaintArray(re,J,ue,Y,v,T,k)})}L=!0}}return L}defines(){const n=[];for(const a in this.binders){const u=this.binders[a];(u instanceof of||u instanceof Bd)&&n.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Mc||u instanceof pl||u instanceof Ic)for(let m=0;m<u.paintVertexAttributes.length;m++)n.push(u.paintVertexAttributes[m].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof of||u instanceof Bd||u instanceof pl)for(const m of u.uniformNames)n.push(m)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const a=[];for(const u in this.binders){const m=this.binders[u];if(m instanceof of||m instanceof Bd||m instanceof pl)for(const h of m.uniformNames)a.push({name:h,property:u,binding:m.getBinding(n,h)})}return a}setUniforms(n,a,u,m,h){for(const{name:v,property:T,binding:k}of u)this.binders[T].setUniform(n,k,h,m.get(T),v)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const a=this.binders[n];(a instanceof Mc||a instanceof pl||a instanceof Ic)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(n){for(const a in this.binders){const u=this.binders[a];(u instanceof Mc||u instanceof pl||u instanceof Ic)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof Mc||a instanceof pl||a instanceof Ic)&&a.destroy()}}}class Vl{constructor(n,a,u=()=>!0){this.programConfigurations={};for(const m of n)this.programConfigurations[m.id]=new Ac(m,a,u);this.needsUpload=!1,this._featureMap=new tf,this._featureMapWithoutIds=new tf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,a,u,m,h,v,T,k){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(n,a,m,h,v,T,k);a.id!==void 0?this._featureMap.add(a.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,u,m,h,v){for(const T of u)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,a,T,m,h,v||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const U1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function j1(c,n){return U1[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const H1={"line-pattern":{source:Cc,composite:Cc},"fill-pattern":{source:Cc,composite:Cc},"fill-extrusion-pattern":{source:Cc,composite:Cc},"line-dasharray":{source:vp,composite:vp}},G1={color:{source:Jh,composite:Tc},number:{source:zd,composite:Jh}};function Iy(c,n,a){const u=H1[c];return u&&u[a]||G1[n][a]}no(of,"ConstantBinder"),no(Bd,"PatternConstantBinder"),no(Mc,"SourceExpressionBinder"),no(Ic,"PatternCompositeBinder"),no(pl,"CompositeExpressionBinder"),no(Ac,"ProgramConfiguration",{omit:["_buffers"]}),no(Vl,"ProgramConfigurationSet");const ya=Nn/Math.PI/2,Ay=5,f=6,r=16383,l=64,p=[l,32,16],b=-ya,w=ya;function C(c,n,a,u=ya){return a=Et(a),[c*Math.sin(a)*u,-n*u,c*Math.cos(a)*u]}function D(c,n,a){return C(Math.cos(Et(c)),Math.sin(Et(c)),n,a)}const V=63710088e-1,q=2*Math.PI*V;class j{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new j(qn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,u=this.lat*a,m=n.lat*a,h=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((n.lng-this.lng)*a);return V*Math.acos(Math.min(h,1))}toBounds(n=0){const a=360*n/40075017,u=a/Math.cos(Math.PI/180*this.lat);return new X({lng:this.lng-u,lat:this.lat-a},{lng:this.lng+u,lat:this.lat+a})}toEcef(n){return D(this.lat,this.lng,ya+n*ya/V)}static convert(n){if(n instanceof j)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new j(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new j(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class X{constructor(n,a){if(n)if(a)this.setSouthWest(n).setNorthEast(a);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof j?new j(n.lng,n.lat):j.convert(n),this}setSouthWest(n){return this._sw=n instanceof j?new j(n.lng,n.lat):j.convert(n),this}extend(n){const a=this._sw,u=this._ne;let m,h;if(n instanceof j)m=n,h=n;else{if(!(n instanceof X))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(X.convert(n)):this.extend(j.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(j.convert(n)):this;if(m=n._sw,h=n._ne,!m||!h)return this}return a||u?(a.lng=Math.min(m.lng,a.lng),a.lat=Math.min(m.lat,a.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new j(m.lng,m.lat),this._ne=new j(h.lng,h.lat)),this}getCenter(){return new j((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new j(this.getWest(),this.getNorth())}getSouthEast(){return new j(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:a,lat:u}=j.convert(n);let m=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&m}static convert(n){if(n)return n instanceof X?n:new X(n)}}const ee=0,ae=25.5;function be(c){return q*Math.cos(c*Math.PI/180)}function _e(c){return(180+c)/360}function Te(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function we(c,n){return c/be(n)}function Le(c){return 360*c-180}function Ue(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function je(c,n){return c*be(Ue(n))}const Ye=85.051129;function et(c){return Math.cos(Et(yt(c,-Ye,Ye)))}function Xe(c,n){const a=yt(n,ee,ae),u=Math.pow(2,a);return et(c)*q/(512*u)}function nt(c){return 1/Math.cos(c*Math.PI/180)}function lt(c,n=0){const a=Math.exp(Math.PI*(1-(c.y+n/Nn)/(1<<c.z)*2));return 80150034*a/(a*a+1)/Nn/(1<<c.z)}class vt{constructor(n,a,u=0){this.x=+n,this.y=+a,this.z=+u}static fromLngLat(n,a=0){const u=j.convert(n);return new vt(_e(u.lng),Te(u.lat),we(a,u.lat))}toLngLat(){return new j(Le(this.x),Ue(this.y))}toAltitude(){return je(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/q*nt(Ue(this.y))}}function dt(c,n,a,u,m,h,v,T,k){const L=(n+u)/2,x=(a+m)/2,A=new Be(L,x);T(A),function(O,M,R,N,W,Y){const ne=R-W,re=N-Y;return Math.abs((N-M)*ne-(R-O)*re)/Math.hypot(ne,re)}(A.x,A.y,h.x,h.y,v.x,v.y)>=k?(dt(c,n,a,L,x,h,A,T,k),dt(c,L,x,u,m,A,v,T,k)):c.push(v)}function ct(c,n,a){let u=c[0],m=u.x,h=u.y;n(u);const v=[u];for(let T=1;T<c.length;T++){const k=c[T],{x:L,y:x}=k;n(k),dt(v,m,h,L,x,u,k,n,a),m=L,h=x,u=k}return v}function jt(c,n,a,u){if(u(n,a)){const m=n.add(a)._mult(.5);jt(c,n,m,u),jt(c,m,a,u)}else c.push(a)}function en(c,n){let a=c[0];const u=[a];for(let m=1;m<c.length;m++){const h=c[m];jt(u,a,h,n),a=h}return u}const gn=Math.pow(2,14)-1,An=-gn-1;function Dn(c,n){const a=Math.round(c.x*n),u=Math.round(c.y*n);return c.x=yt(a,An,gn),c.y=yt(u,An,gn),(a<c.x||a>c.x+1||u<c.y||u>c.y+1)&&Bn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function It(c,n,a){const u=c.loadGeometry(),m=c.extent,h=Nn/m;if(n&&a&&a.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:T,x:k,y:L,projection:x}=a,A=O=>{const M=Le((n.x+O.x/m)/v),R=Ue((n.y+O.y/m)/v),N=x.project(M,R);O.x=(N.x*T-k)*m,O.y=(N.y*T-L)*m};for(let O=0;O<u.length;O++)if(c.type!==1)u[O]=ct(u[O],A,1);else{const M=[];for(const R of u[O])R.x<0||R.x>=m||R.y<0||R.y>=m||(A(R),M.push(R));u[O]=M}}for(const v of u)for(const T of v)Dn(T,h);return u}function pn(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?It(c):[]}}function Xt(c,n,a,u,m){c.emplaceBack(2*n+(u+1)/2,2*a+(m+1)/2)}function mn(c,n,a){c.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}class xn{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new uu,this.indexArray=new bi,this.segments=new ki,this.programConfigurations=new Vl(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}updateFootprints(n,a){}populate(n,a,u,m){const h=this.layers[0],v=[];let T=null;h.type==="circle"&&(T=h.layout.get("circle-sort-key"));for(const{feature:L,id:x,index:A,sourceLayerIndex:O}of n){const M=this.layers[0]._featureFilter.needGeometry,R=pn(L,M);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),R,u))continue;const N=T?T.evaluate(R,{},u):void 0,W={id:x,properties:L.properties,type:L.type,sourceLayerIndex:O,index:A,geometry:M?R.geometry:It(L,u,m),patterns:{},sortKey:N};v.push(W)}T&&v.sort((L,x)=>L.sortKey-x.sortKey);let k=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new Yh,k=m.projection);for(const L of v){const{geometry:x,index:A,sourceLayerIndex:O}=L,M=n[A].feature;this.addFeature(L,x,A,a.availableImages,u,k,a.brightness),a.featureIndex.insert(M,x,A,O,this.index)}}update(n,a,u,m,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,a,v?this.stateDependentLayers:this.layers,u,m,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,F1.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,B1.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,a,u,m,h,v,T){for(const k of a)for(const L of k){const x=L.x,A=L.y;if(x<0||x>=Nn||A<0||A>=Nn)continue;if(v){const R=v.projectTilePoint(x,A,h),N=v.upVector(h,x,A),W=this.globeExtVertexArray;mn(W,R,N),mn(W,R,N),mn(W,R,N),mn(W,R,N)}const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),M=O.vertexLength;Xt(this.layoutVertexArray,x,A,-1,-1),Xt(this.layoutVertexArray,x,A,1,-1),Xt(this.layoutVertexArray,x,A,1,1),Xt(this.layoutVertexArray,x,A,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+2,M+3),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},m,h,T)}}function hn(c,n){for(let a=0;a<c.length;a++)if(mr(n,c[a]))return!0;for(let a=0;a<n.length;a++)if(mr(c,n[a]))return!0;return!!ro(c,n)}function Vn(c,n,a){return!!mr(c,n)||!!Wn(n,c,a)}function fo(c,n){if(c.length===1)return Ko(n,c[0]);for(let a=0;a<n.length;a++){const u=n[a];for(let m=0;m<u.length;m++)if(mr(c,u[m]))return!0}for(let a=0;a<c.length;a++)if(Ko(n,c[a]))return!0;for(let a=0;a<n.length;a++)if(ro(c,n[a]))return!0;return!1}function xo(c,n,a){if(c.length>1){if(ro(c,n))return!0;for(let u=0;u<n.length;u++)if(Wn(n[u],c,a))return!0}for(let u=0;u<c.length;u++)if(Wn(c[u],n,a))return!0;return!1}function ro(c,n){if(c.length===0||n.length===0)return!1;for(let a=0;a<c.length-1;a++){const u=c[a],m=c[a+1];for(let h=0;h<n.length-1;h++)if(So(u,m,n[h],n[h+1]))return!0}return!1}function So(c,n,a,u){return Oo(c,a,u)!==Oo(n,a,u)&&Oo(c,n,a)!==Oo(c,n,u)}function Wn(c,n,a){const u=a*a;if(n.length===1)return c.distSqr(n[0])<u;for(let m=1;m<n.length;m++)if(Ro(c,n[m-1],n[m])<u)return!0;return!1}function Ro(c,n,a){const u=n.distSqr(a);if(u===0)return c.distSqr(n);const m=((c.x-n.x)*(a.x-n.x)+(c.y-n.y)*(a.y-n.y))/u;return c.distSqr(m<0?n:m>1?a:a.sub(n)._mult(m)._add(n))}function Ko(c,n){let a,u,m,h=!1;for(let v=0;v<c.length;v++){a=c[v];for(let T=0,k=a.length-1;T<a.length;k=T++)u=a[T],m=a[k],u.y>n.y!=m.y>n.y&&n.x<(m.x-u.x)*(n.y-u.y)/(m.y-u.y)+u.x&&(h=!h)}return h}function mr(c,n){let a=!1;for(let u=0,m=c.length-1;u<c.length;m=u++){const h=c[u],v=c[m];h.y>n.y!=v.y>n.y&&n.x<(v.x-h.x)*(n.y-h.y)/(v.y-h.y)+h.x&&(a=!a)}return a}function Kr(c,n,a,u,m){for(const v of c)if(n<=v.x&&a<=v.y&&u>=v.x&&m>=v.y)return!0;const h=[new Be(n,a),new Be(n,m),new Be(u,m),new Be(u,a)];if(c.length>2){for(const v of h)if(mr(c,v))return!0}for(let v=0;v<c.length-1;v++)if(Sr(c[v],c[v+1],h))return!0;return!1}function Sr(c,n,a){const u=a[0],m=a[2];if(c.x<u.x&&n.x<u.x||c.x>m.x&&n.x>m.x||c.y<u.y&&n.y<u.y||c.y>m.y&&n.y>m.y)return!1;const h=Oo(c,n,a[0]);return h!==Oo(c,n,a[1])||h!==Oo(c,n,a[2])||h!==Oo(c,n,a[3])}function ii(c,n,a,u,m,h){let v=n.y-c.y,T=c.x-n.x;if(h=h||0){const k=v*v+T*T;if(k===0)return!0;const L=Math.sqrt(k);v/=L,T/=L}return!((a.x-c.x)*v+(a.y-c.y)*T-h<0||(u.x-c.x)*v+(u.y-c.y)*T-h<0||(m.x-c.x)*v+(m.y-c.y)*T-h<0)}function Ar(c,n,a,u,m,h,v){return!(ii(c,n,u,m,h,v)||ii(n,a,u,m,h,v)||ii(a,c,u,m,h,v)||ii(u,m,c,n,a,v)||ii(m,h,c,n,a,v)||ii(h,u,c,n,a,v))}function Zr(c,n,a){const u=n.paint.get(c).value;return u.kind==="constant"?u.value:a.programConfigurations.get(n.id).getMaxValue(c)}function sr(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Gr(c,n,a,u,m){if(!n[0]&&!n[1])return c;const h=Be.convert(n)._mult(m);a==="viewport"&&h._rotate(-u);const v=[];for(let T=0;T<c.length;T++)v.push(c[T].sub(h));return v}function Ur(c,n,a,u){const m=Be.convert(c)._mult(u);return n==="viewport"&&m._rotate(-a),m}let Lr,fi;no(xn,"CircleBucket",{omit:["layers"]});var Yi,Ts={exports:{}},Ks=(Yi||(Yi=1,function(c,n){(function(a){function u(h,v,T){var k=m(256*h,256*(v=Math.pow(2,T)-v-1),T),L=m(256*(h+1),256*(v+1),T);return k[0]+","+k[1]+","+L[0]+","+L[1]}function m(h,v,T){var k=2*Math.PI*6378137/256/Math.pow(2,T);return[h*k-2*Math.PI*6378137/2,v*k-2*Math.PI*6378137/2]}a.getURL=function(h,v,T,k,L,x){return x=x||{},h+"?"+["bbox="+u(T,k,L),"format="+(x.format||"image/png"),"service="+(x.service||"WMS"),"version="+(x.version||"1.1.1"),"request="+(x.request||"GetMap"),"srs="+(x.srs||"EPSG:3857"),"width="+(x.width||256),"height="+(x.height||256),"layers="+v].join("&")},a.getTileBBox=u,a.getMercCoords=m,Object.defineProperty(a,"__esModule",{value:!0})})(n)}(0,Ts.exports)),Ts.exports);class ea{constructor(n,a,u){this.z=n,this.x=a,this.y=u,this.key=kr(0,n,n,a,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a){const u=Ks.getTileBBox(this.x,this.y,this.z),m=function(h,v,T){let k,L="";for(let x=h;x>0;x--)k=1<<x-1,L+=(v&k?1:0)+(T&k?2:0);return L}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class wr{constructor(n,a){this.wrap=n,this.canonical=a,this.key=kr(n,a.z,a.z,a.x,a.y)}}class _r{constructor(n,a,u,m,h){this.overscaledZ=n,this.wrap=a,this.canonical=new ea(u,+m,+h),this.key=a===0&&n===u?this.canonical.key:kr(a,n,u,m,h)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const a=this.canonical.z-n;return n>this.canonical.z?new _r(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new _r(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a=!0){if(this.overscaledZ===n&&a)return this.key;if(n>this.canonical.z)return kr(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return kr(this.wrap*+a,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new _r(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new _r(a,this.wrap,a,u,m),new _r(a,this.wrap,a,u+1,m),new _r(a,this.wrap,a,u,m+1),new _r(a,this.wrap,a,u+1,m+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new _r(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new _r(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new wr(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function kr(c,n,a,u,m){const h=1<<Math.min(a,22);let v=h*(m%h)+u%h;return c&&a<22&&(v+=h*h*((c<0?-2*c-1:2*c)%(1<<2*(22-a)))),16*(32*v+a)+(n-a)}const Jr=[c=>{let n=c.canonical.x-1,a=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,a--),new _r(c.overscaledZ,a,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,a=c.wrap;return n===1<<c.canonical.z&&(n=0,a++),new _r(c.overscaledZ,a,c.canonical.z,n,c.canonical.y)},c=>new _r(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new _r(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];no(ea,"CanonicalTileID"),no(_r,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Pi=Mr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:pi}=Pi,ra=Mr([{name:"a_pos_3",components:3,type:"Int16"}]);var Ul=Mr([{name:"a_pos",type:"Int16",components:2}]);class rs{constructor(n,a){this.pos=n,this.dir=a}intersectsPlane(n,a,u){const m=Re.vec3.dot(a,this.dir);if(Math.abs(m)<1e-6)return!1;const h=((n[0]-this.pos[0])*a[0]+(n[1]-this.pos[1])*a[1]+(n[2]-this.pos[2])*a[2])/m;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(n,a,u){if(Re.vec3.equals(this.pos,n)||a===0)return u[0]=u[1]=u[2]=0,!1;const[m,h,v]=this.dir,T=this.pos[0]-n[0],k=this.pos[1]-n[1],L=this.pos[2]-n[2],x=m*m+h*h+v*v,A=2*(T*m+k*h+L*v),O=A*A-4*x*(T*T+k*k+L*L-a*a);if(O<0){const M=Math.max(-A/2,0),R=T+m*M,N=k+h*M,W=L+v*M,Y=Math.hypot(R,N,W);return u[0]=R*a/Y,u[1]=N*a/Y,u[2]=W*a/Y,!1}{const M=(-A-Math.sqrt(O))/(2*x);if(M<0){const R=Math.hypot(T,k,L);return u[0]=T*a/R,u[1]=k*a/R,u[2]=L*a/R,!1}return u[0]=T+m*M,u[1]=k+h*M,u[2]=L+v*M,!0}}}class is{constructor(n,a,u,m,h){this.TL=n,this.TR=a,this.BR=u,this.BL=m,this.horizon=h}static fromInvProjectionMatrix(n,a,u){const m=[-1,1,1],h=[1,1,1],v=[1,-1,1],T=[-1,-1,1],k=Re.vec3.transformMat4(m,m,n),L=Re.vec3.transformMat4(h,h,n),x=Re.vec3.transformMat4(v,v,n),A=Re.vec3.transformMat4(T,T,n);return new is(k,L,x,A,a/u)}}function Zs(c,n,a){let u=1/0,m=-1/0;const h=[];for(const v of c){Re.vec3.sub(h,v,n);const T=Re.vec3.dot(h,a);u=Math.min(u,T),m=Math.max(m,T)}return[u,m]}function ml(c,n){let a=!0;for(let u=0;u<c.planes.length;u++){const m=c.planes[u];let h=0;for(let v=0;v<n.length;v++)h+=Re.vec3.dot(m,n[v])+m[3]>=0;if(h===0)return 0;h!==n.length&&(a=!1)}return a?2:1}function as(c,n){for(const a of c.projections){const u=Zs(n,c.points[0],a.axis);if(a.projection[1]<u[0]||a.projection[0]>u[1])return 0}return 1}function kc(c,n){let a=0;const u=[0,0,0,0];for(let m=0;m<c.length;m++)u[0]=c[m][0],u[1]=c[m][1],u[2]=c[m][2],u[3]=1,Re.vec4.dot(u,n)>=0&&a++;return a}class Ys{constructor(n,a){this.points=n||new Array(8).fill([0,0,0]),this.planes=a||new Array(6).fill([0,0,0,0]),this.bounds=Fr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Re.vec3.sub([],this.points[2],this.points[3]),Re.vec3.sub([],this.points[0],this.points[3]),Re.vec3.sub([],this.points[4],this.points[0]),Re.vec3.sub([],this.points[5],this.points[1]),Re.vec3.sub([],this.points[6],this.points[2]),Re.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const m=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:m,projection:Zs(this.points,this.points[0],m)}),this.projections.push({axis:h,projection:Zs(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(n,a,u,m){const h=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>{const x=Re.vec4.transformMat4([],L,n),A=1/x[3]/a*h;return Re.vec4.mul(x,x,[A,A,m?1/x[3]:A,A])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(L=>{const x=Re.vec3.sub([],v[L[0]],v[L[1]]),A=Re.vec3.sub([],v[L[2]],v[L[1]]),O=Re.vec3.normalize([],Re.vec3.cross([],x,A)),M=-Re.vec3.dot(O,v[L[1]]);return O.concat(M)}),k=[];for(let L=0;L<v.length;L++)k.push([v[L][0],v[L][1],v[L][2]]);return new Ys(k,T)}intersectsPrecise(n,a,u){for(let m=0;m<a.length;m++)if(!kc(n,a[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!kc(n,this.planes[m]))return 0;for(const m of u)for(const h of this.frustumEdges){const v=Re.vec3.cross([],m,h),T=Re.vec3.length(v);if(T===0)continue;Re.vec3.scale(v,v,1/T);const k=Zs(this.points,this.points[0],v),L=Zs(n,this.points[0],v);if(k[0]>L[1]||L[0]>k[1])return 0}return 1}containsPoint(n){for(const a of this.planes){const u=a[3];if(Re.vec3.dot([a[0],a[1],a[2]],n)+u<0)return!1}return!0}}class Fr{static fromPoints(n){const a=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const m of n)Re.vec3.min(a,a,m),Re.vec3.max(u,u,m);return new Fr(a,u)}static fromTileIdAndHeight(n,a,u){const m=1<<n.canonical.z,h=n.canonical.x,v=n.canonical.y;return new Fr([h/m,v/m,a],[(h+1)/m,(v+1)/m,u])}static applyTransform(n,a){const u=n.getCorners();for(let m=0;m<u.length;++m)Re.vec3.transformMat4(u[m],u[m],a);return Fr.fromPoints(u)}static applyTransformFast(n,a){const u=[a[12],a[13],a[14]],m=[...u];for(let h=0;h<3;h++)for(let v=0;v<3;v++){const T=a[4*v+h],k=T*n.min[v],L=T*n.max[v];u[h]+=Math.min(k,L),m[h]+=Math.max(k,L)}return new Fr(u,m)}static projectAabbCorners(n,a){const u=n.getCorners();for(let m=0;m<u.length;++m)Re.vec3.transformMat4(u[m],u[m],a);return u}constructor(n,a){this.min=n,this.max=a,this.center=Re.vec3.scale([],Re.vec3.add([],this.min,this.max),.5)}quadrant(n){const a=[n%2==0,n<2],u=Re.vec3.clone(this.min),m=Re.vec3.clone(this.max);for(let h=0;h<a.length;h++)u[h]=a[h]?this.min[h]:this.center[h],m[h]=a[h]?this.center[h]:this.max[h];return m[2]=this.max[2],new Fr(u,m)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,a=this.max;return[[n[0],n[1],n[2]],[a[0],n[1],n[2]],[a[0],a[1],n[2]],[n[0],a[1],n[2]],[n[0],n[1],a[2]],[a[0],n[1],a[2]],[a[0],a[1],a[2]],[n[0],a[1],a[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?ml(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?ml(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,a){return a||this.intersects(n)?as(n,this.getCorners()):0}intersectsPreciseFlat(n,a){return a||this.intersectsFlat(n)?as(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let a=0;a<3;++a)if(this.min[a]>n.max[a]||n.min[a]>this.max[a])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n.min[a]),this.max[a]=Math.max(this.max[a],n.max[a])}encapsulatePoint(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n[a]),this.max[a]=Math.max(this.max[a],n[a])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function Nd(c){return c*ya/V}no(Fr,"Aabb");const jg=[new Fr([b,b,b],[w,w,w]),new Fr([b,b,b],[0,0,w]),new Fr([0,b,b],[w,0,w]),new Fr([b,0,b],[0,w,w]),new Fr([0,0,b],[w,w,w])];function $d(c,n,a,u=!0){const m=Re.vec3.scale([],c._camera.position,c.worldSize),h=[n,a,1,1];Re.vec4.transformMat4(h,h,c.pixelMatrixInverse),Re.vec4.scale(h,h,1/h[3]);const v=Re.vec3.sub([],h,m),T=Re.vec3.normalize([],v),k=c.globeMatrix,L=[k[12],k[13],k[14]],x=Re.vec3.sub([],L,m),A=Re.vec3.length(x),O=Re.vec3.normalize([],x),M=c.worldSize/(2*Math.PI),R=Re.vec3.dot(O,T),N=Math.asin(M/A);if(N<Math.acos(R)){if(!u)return null;const st=[],Fe=[];Re.vec3.scale(st,T,A/R),Re.vec3.normalize(Fe,Re.vec3.sub(Fe,st,x)),Re.vec3.normalize(T,Re.vec3.add(T,x,Re.vec3.scale(T,Fe,Math.tan(N)*A)))}const W=[];new rs(m,T).closestPointOnSphere(L,M,W);const Y=Re.vec3.normalize([],Bi(k,0)),ne=Re.vec3.normalize([],Bi(k,1)),re=Re.vec3.normalize([],Bi(k,2)),J=Re.vec3.dot(Y,W),ue=Re.vec3.dot(ne,W),ve=Re.vec3.dot(re,W),Ie=Gt(Math.asin(-ue/M));let Ge=Gt(Math.atan2(J,ve));Ge=c.center.lng+function(st,Fe){const rt=(Fe-st+180)%360-180;return rt<-180?rt+360:rt}(c.center.lng,Ge);const ze=_e(Ge),$e=yt(Te(Ie),0,1);return new vt(ze,$e)}class Hg{constructor(n,a,u){this.a=Re.vec3.sub([],n,u),this.b=Re.vec3.sub([],a,u),this.center=u;const m=Re.vec3.normalize([],this.a),h=Re.vec3.normalize([],this.b);this.angle=Math.acos(Re.vec3.dot(m,h))}}function rf(c,n){if(c.angle===0)return null;let a;return a=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),a<0||a>1?null:function(u,m,h,v){const T=Math.sin(h);return u*(Math.sin((1-v)*h)/T)+m*(Math.sin(v*h)/T)}(c.a[n],c.b[n],c.angle,yt(a,0,1))+c.center[n]}function fu(c){if(c.z<=1)return jg[c.z+2*c.y+c.x];const n=W1(ky(c));return Fr.fromPoints(n)}function Hu(c,n,a){return Re.vec3.scale(c,c,1-a),Re.vec3.scaleAndAdd(c,c,n,a)}function wC(c,n,a){for(const u of c)Re.vec3.transformMat4(u,u,n),Re.vec3.scale(u,u,a)}function SC(c,n,a,u){const m=n/c.worldSize,h=c.globeMatrix;if(a.z<=1){const ze=fu(a).getCorners();return wC(ze,h,m),Fr.fromPoints(ze)}const v=ky(a,u),T=W1(v,ya+Nd(c._tileCoverLift));wC(T,h,m);const k=Number.MAX_VALUE,L=[-k,-k,-k],x=[k,k,k];if(v.contains(c.center)){for(const st of T)Re.vec3.min(x,x,st),Re.vec3.max(L,L,st);L[2]=0;const ze=c.point,$e=[ze.x*m,ze.y*m,0];return Re.vec3.min(x,x,$e),Re.vec3.max(L,L,$e),new Fr(x,L)}if(c._tileCoverLift>0){for(const ze of T)Re.vec3.min(x,x,ze),Re.vec3.max(L,L,ze);return new Fr(x,L)}const A=[h[12]*m,h[13]*m,h[14]*m],O=v.getCenter(),M=yt(c.center.lat,-Ye,Ye),R=yt(O.lat,-Ye,Ye),N=_e(c.center.lng),W=Te(M);let Y=N-_e(O.lng);const ne=W-Te(R);Y>.5?Y-=1:Y<-.5&&(Y+=1);let re=0;if(Math.abs(Y)>Math.abs(ne))re=Y>=0?1:3;else{re=ne>=0?0:2;const ze=[h[4]*m,h[5]*m,h[6]*m],$e=-Math.sin(Et(ne>=0?v.getSouth():v.getNorth()))*ya;Re.vec3.scaleAndAdd(A,A,ze,$e)}const J=T[re],ue=T[(re+1)%4],ve=new Hg(J,ue,A),Ie=[rf(ve,0)||J[0],rf(ve,1)||J[1],rf(ve,2)||J[2]],Ge=Vd(c.zoom);if(Ge>0){const ze=function({x:st,y:Fe,z:rt},ht,pt,Tt,Ot){const Ft=1/(1<<rt);let Pt=st*Ft,sn=Pt+Ft,Cn=Fe*Ft,Jt=Cn+Ft,Jn=0;const Fn=(Pt+sn)/2-Tt;return Fn>.5?Jn=-1:Fn<-.5&&(Jn=1),Pt=((Pt+Jn)*ht-(Tt*=ht))*pt+Tt,sn=((sn+Jn)*ht-Tt)*pt+Tt,Cn=(Cn*ht-(Ot*=ht))*pt+Ot,Jt=(Jt*ht-Ot)*pt+Ot,[[Pt,Jt,0],[sn,Jt,0],[sn,Cn,0],[Pt,Cn,0]]}(a,n,c._pixelsPerMercatorPixel,N,W);for(let st=0;st<T.length;st++)Hu(T[st],ze[st],Ge);const $e=Re.vec3.add([],ze[re],ze[(re+1)%4]);Re.vec3.scale($e,$e,.5),Hu(Ie,$e,Ge)}for(const ze of T)Re.vec3.min(x,x,ze),Re.vec3.max(L,L,ze);return x[2]=Math.min(J[2],ue[2]),Re.vec3.min(x,x,Ie),Re.vec3.max(L,L,Ie),new Fr(x,L)}function ky({x:c,y:n,z:a},u=!1){const m=1/(1<<a),h=new j(Le(c*m),n===(1<<a)-1&&u?-90:Ue((n+1)*m)),v=new j(Le((c+1)*m),n===0&&u?90:Ue(n*m));return new X(h,v)}function W1(c,n=ya){const a=Et(c.getNorth()),u=Et(c.getSouth()),m=Math.cos(a),h=Math.cos(u),v=Math.sin(a),T=Math.sin(u),k=c.getWest(),L=c.getEast();return[C(h,T,k,n),C(h,T,L,n),C(m,v,L,n),C(m,v,k,n)]}function Gg(c,n,a,u){const m=1<<a.z,h=(c/Nn+a.x)/m;return D(Ue((n/Nn+a.y)/m),Le(h),u)}function Py({min:c,max:n}){return r/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const TC=new Float64Array(16);function Ry(c){const n=Py(c),a=Re.mat4.fromScaling(TC,[n,n,n]);return Re.mat4.translate(a,a,Re.vec3.negate([],c.min))}function q1(c){const n=Re.mat4.fromTranslation(TC,c.min),a=1/Py(c);return Re.mat4.scale(n,n,[a,a,a])}function K1(c){const n=Nn/(2*Math.PI);return c/(2*Math.PI)/n}function CC(c,n){return Nn/(512*Math.pow(2,c))*Py(fu(n))}function EC(c,n,a,u,m){const h=K1(a),v=[c,n,-a/(2*Math.PI)],T=Re.mat4.identity(new Float64Array(16));return Re.mat4.translate(T,T,v),Re.mat4.scale(T,T,[h,h,h]),Re.mat4.rotateX(T,T,Et(-m)),Re.mat4.rotateY(T,T,Et(-u)),T}function Vd(c){return kn(Ay,f,c)}function MC(c,n){const a=D(n.lat,n.lng),u=function(h){const v=D(h._center.lat,h._center.lng),T=Re.vec3.fromValues(0,1,0);let k=Re.vec3.cross([],T,v);const L=Re.mat4.fromRotation([],-h.angle,v);k=Re.vec3.transformMat4(k,k,L),Re.mat4.fromRotation(L,-h._pitch,k);const x=Re.vec3.normalize([],v);return Re.vec3.scale(x,x,Nd(h.cameraToCenterDistance/h.pixelsPerMeter)),Re.vec3.transformMat4(x,x,L),Re.vec3.add([],v,x)}(c),m=Re.vec3.subtract([],u,a);return Re.vec3.angle(m,a)}function Z1(c,n){return MC(c,n)>Math.PI/2*1.01}const IC=Et(85),q4=Math.cos(IC),K4=Math.sin(IC),Z4=Re.mat4.create(),AC=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function kC(c,n,a,u,m,h,v,T,k){if(h&&c.queryGeometry.isAboveHorizon)return!1;h&&(k*=c.pixelToTileUnitsFactor);const L=c.tileID.canonical,x=a.projection.upVectorScale(L,a.center.lat,a.worldSize).metersToTile;for(const A of n)for(const O of A){const M=O.add(T),R=m&&a.elevation?a.elevation.exaggeration()*m.getElevationAt(M.x,M.y,!0):0,N=a.projection.projectTilePoint(M.x,M.y,L);if(R>0){const re=a.projection.upVector(L,M.x,M.y);N.x+=re[0]*x*R,N.y+=re[1]*x*R,N.z+=re[2]*x*R}const W=h?M:Y4(N.x,N.y,N.z,u),Y=h?c.tilespaceRays.map(re=>J4(re,R)):c.queryGeometry.screenGeometry,ne=Re.vec4.transformMat4([],[N.x,N.y,N.z,1],u);if(!v&&h?k*=ne[3]/a.cameraToCenterDistance:v&&!h&&(k*=a.cameraToCenterDistance/ne[3]),h){const re=Ue((O.y/Nn+L.y)/(1<<L.z));k/=a.projection.pixelsPerMeter(re,1)/we(1,re)}if(Vn(Y,W,k))return!0}return!1}function Y4(c,n,a,u){const m=Re.vec4.transformMat4([],[c,n,a,1],u);return new Be(m[0]/m[3],m[1]/m[3])}const PC=Re.vec3.fromValues(0,0,0),X4=Re.vec3.fromValues(0,0,1);function J4(c,n){const a=Re.vec3.create();return PC[2]=n,c.intersectsPlane(PC,X4,a),new Be(a[0],a[1])}class RC extends xn{}let OC,LC,DC,zC;function FC(c,{width:n,height:a},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==n*a*u)throw new RangeError("mismatched image size")}else m=new Uint8Array(n*a*u);return c.width=n,c.height=a,c.data=m,c}function BC(c,n,a){const{width:u,height:m}=n;u===c.width&&m===c.height||(Y1(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,m)},a,null),c.width=u,c.height=m,c.data=n.data)}function Y1(c,n,a,u,m,h,v,T){if(m.width===0||m.height===0)return n;if(m.width>c.width||m.height>c.height||a.x>c.width-m.width||a.y>c.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>n.width||m.height>n.height||u.x>n.width-m.width||u.y>n.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const k=c.data,L=n.data,x=h===4&&T;for(let A=0;A<m.height;A++){const O=((a.y+A)*c.width+a.x)*h,M=((u.y+A)*n.width+u.x)*h;if(x)for(let R=0;R<m.width;R++){const N=O+R*h+3,W=M+R*h;L[W+0]=255,L[W+1]=255,L[W+2]=255,L[W+3]=k[N]}else if(v)for(let R=0;R<m.width;R++){const N=O+R*h,W=M+R*h,Y=k[N+3],ne=new Ln(k[N+0]/255*Y,k[N+1]/255*Y,k[N+2]/255*Y,Y).toRenderColor(v).toArray();L[W+0]=ne[0],L[W+1]=ne[1],L[W+2]=ne[2],L[W+3]=ne[3]}else for(let R=0;R<m.width*h;R++)L[M+R]=k[O+R]}return n}no(RC,"HeatmapBucket",{omit:["layers"]});class Ud{constructor(n,a){FC(this,n,1,a)}resize(n){BC(this,new Ud(n),1)}clone(){return new Ud({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,m,h){Y1(n,a,u,m,h,1,null)}}class Ua{constructor(n,a){FC(this,n,4,a)}resize(n){BC(this,new Ua(n),4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ua({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,m,h,v,T){Y1(n,a,u,m,h,4,v,T)}}class NC{constructor(n,a){this.width=n.width,this.height=n.height,this.data=a instanceof Uint8Array?new Float32Array(a.buffer):a}}function Wg(c){const n={},a=c.resolution||256,u=c.clips?c.clips.length:1,m=c.image||new Ua({width:a,height:u}),h=(v,T,k)=>{n[c.evaluationKey]=k;const L=c.expression.evaluate(n);L&&(m.data[v+T+0]=Math.floor(255*L.r/L.a),m.data[v+T+1]=Math.floor(255*L.g/L.a),m.data[v+T+2]=Math.floor(255*L.b/L.a),m.data[v+T+3]=Math.floor(255*L.a))};if(c.clips)for(let v=0,T=0;v<u;++v,T+=4*a)for(let k=0,L=0;k<a;k++,L+=4){const x=k/(a-1),{start:A,end:O}=c.clips[v];h(T,L,A*(1-x)+O*x)}else for(let v=0,T=0;v<a;v++,T+=4)h(0,T,v/(a-1));return m}no(Ud,"AlphaImage"),no(Ua,"RGBAImage");const Q4=Mr([{name:"a_pos",components:2,type:"Int16"}],4),{members:eF}=Q4;function qg(c,n,a=2){const u=n&&n.length,m=u?n[0]*a:c.length;let h=$C(c,0,m,a,!0);const v=[];if(!h||h.next===h.prev)return v;let T,k,L;if(u&&(h=function(x,A,O,M){const R=[];for(let N=0,W=A.length;N<W;N++){const Y=$C(x,A[N]*M,N<W-1?A[N+1]*M:x.length,M,!1);Y===Y.next&&(Y.steiner=!0),R.push(lF(Y))}R.sort(iF);for(let N=0;N<R.length;N++)O=aF(R[N],O);return O}(c,n,h,a)),c.length>80*a){T=1/0,k=1/0;let x=-1/0,A=-1/0;for(let O=a;O<m;O+=a){const M=c[O],R=c[O+1];M<T&&(T=M),R<k&&(k=R),M>x&&(x=M),R>A&&(A=R)}L=Math.max(x-T,A-k),L=L!==0?32767/L:0}return Kg(h,v,a,T,k,L,0),v}function $C(c,n,a,u,m){let h;if(m===function(v,T,k,L){let x=0;for(let A=T,O=k-L;A<k;A+=L)x+=(v[O]-v[A])*(v[A+1]+v[O+1]),O=A;return x}(c,n,a,u)>0)for(let v=n;v<a;v+=u)h=jC(v/u|0,c[v],c[v+1],h);else for(let v=a-u;v>=n;v-=u)h=jC(v/u|0,c[v],c[v+1],h);return h&&Oy(h,h.next)&&(Yg(h),h=h.next),h}function af(c,n){if(!c)return c;n||(n=c);let a,u=c;do if(a=!1,u.steiner||!Oy(u,u.next)&&ta(u.prev,u,u.next)!==0)u=u.next;else{if(Yg(u),u=n=u.prev,u===u.next)break;a=!0}while(a||u!==n);return n}function Kg(c,n,a,u,m,h,v){if(!c)return;!v&&h&&function(k,L,x,A){let O=k;do O.z===0&&(O.z=X1(O.x,O.y,L,x,A)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==k);O.prevZ.nextZ=null,O.prevZ=null,function(M){let R,N=1;do{let W,Y=M;M=null;let ne=null;for(R=0;Y;){R++;let re=Y,J=0;for(let ve=0;ve<N&&(J++,re=re.nextZ,re);ve++);let ue=N;for(;J>0||ue>0&&re;)J!==0&&(ue===0||!re||Y.z<=re.z)?(W=Y,Y=Y.nextZ,J--):(W=re,re=re.nextZ,ue--),ne?ne.nextZ=W:M=W,W.prevZ=ne,ne=W;Y=re}ne.nextZ=null,N*=2}while(R>1)}(O)}(c,u,m,h);let T=c;for(;c.prev!==c.next;){const k=c.prev,L=c.next;if(h?nF(c,u,m,h):tF(c))n.push(k.i,c.i,L.i),Yg(c),c=L.next,T=L.next;else if((c=L)===T){v?v===1?Kg(c=oF(af(c),n),n,a,u,m,h,2):v===2&&rF(c,n,a,u,m,h):Kg(af(c),n,a,u,m,h,1);break}}}function tF(c){const n=c.prev,a=c,u=c.next;if(ta(n,a,u)>=0)return!1;const m=n.x,h=a.x,v=u.x,T=n.y,k=a.y,L=u.y,x=m<h?m<v?m:v:h<v?h:v,A=T<k?T<L?T:L:k<L?k:L,O=m>h?m>v?m:v:h>v?h:v,M=T>k?T>L?T:L:k>L?k:L;let R=u.next;for(;R!==n;){if(R.x>=x&&R.x<=O&&R.y>=A&&R.y<=M&&Ip(m,T,h,k,v,L,R.x,R.y)&&ta(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function nF(c,n,a,u){const m=c.prev,h=c,v=c.next;if(ta(m,h,v)>=0)return!1;const T=m.x,k=h.x,L=v.x,x=m.y,A=h.y,O=v.y,M=T<k?T<L?T:L:k<L?k:L,R=x<A?x<O?x:O:A<O?A:O,N=T>k?T>L?T:L:k>L?k:L,W=x>A?x>O?x:O:A>O?A:O,Y=X1(M,R,n,a,u),ne=X1(N,W,n,a,u);let re=c.prevZ,J=c.nextZ;for(;re&&re.z>=Y&&J&&J.z<=ne;){if(re.x>=M&&re.x<=N&&re.y>=R&&re.y<=W&&re!==m&&re!==v&&Ip(T,x,k,A,L,O,re.x,re.y)&&ta(re.prev,re,re.next)>=0||(re=re.prevZ,J.x>=M&&J.x<=N&&J.y>=R&&J.y<=W&&J!==m&&J!==v&&Ip(T,x,k,A,L,O,J.x,J.y)&&ta(J.prev,J,J.next)>=0))return!1;J=J.nextZ}for(;re&&re.z>=Y;){if(re.x>=M&&re.x<=N&&re.y>=R&&re.y<=W&&re!==m&&re!==v&&Ip(T,x,k,A,L,O,re.x,re.y)&&ta(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;J&&J.z<=ne;){if(J.x>=M&&J.x<=N&&J.y>=R&&J.y<=W&&J!==m&&J!==v&&Ip(T,x,k,A,L,O,J.x,J.y)&&ta(J.prev,J,J.next)>=0)return!1;J=J.nextZ}return!0}function oF(c,n){let a=c;do{const u=a.prev,m=a.next.next;!Oy(u,m)&&VC(u,a,a.next,m)&&Zg(u,m)&&Zg(m,u)&&(n.push(u.i,a.i,m.i),Yg(a),Yg(a.next),a=c=m),a=a.next}while(a!==c);return af(a)}function rF(c,n,a,u,m,h){let v=c;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&cF(v,T)){let k=UC(v,T);return v=af(v,v.next),k=af(k,k.next),Kg(v,n,a,u,m,h,0),void Kg(k,n,a,u,m,h,0)}T=T.next}v=v.next}while(v!==c)}function iF(c,n){return c.x-n.x}function aF(c,n){const a=function(m,h){let v=h;const T=m.x,k=m.y;let L,x=-1/0;do{if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){const N=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(N<=T&&N>x&&(x=N,L=v.x<v.next.x?v:v.next,N===T))return L}v=v.next}while(v!==h);if(!L)return null;const A=L,O=L.x,M=L.y;let R=1/0;v=L;do{if(T>=v.x&&v.x>=O&&T!==v.x&&Ip(k<M?T:x,k,O,M,k<M?x:T,k,v.x,v.y)){const N=Math.abs(k-v.y)/(T-v.x);Zg(v,m)&&(N<R||N===R&&(v.x>L.x||v.x===L.x&&sF(L,v)))&&(L=v,R=N)}v=v.next}while(v!==A);return L}(c,n);if(!a)return n;const u=UC(a,c);return af(u,u.next),af(a,a.next)}function sF(c,n){return ta(c.prev,c,n.prev)<0&&ta(n.next,c,c.next)<0}function X1(c,n,a,u,m){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-a)*m|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*m|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function lF(c){let n=c,a=c;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==c);return a}function Ip(c,n,a,u,m,h,v,T){return(m-v)*(n-T)>=(c-v)*(h-T)&&(c-v)*(u-T)>=(a-v)*(n-T)&&(a-v)*(h-T)>=(m-v)*(u-T)}function cF(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(a,u){let m=a;do{if(m.i!==a.i&&m.next.i!==a.i&&m.i!==u.i&&m.next.i!==u.i&&VC(m,m.next,a,u))return!0;m=m.next}while(m!==a);return!1}(c,n)&&(Zg(c,n)&&Zg(n,c)&&function(a,u){let m=a,h=!1;const v=(a.x+u.x)/2,T=(a.y+u.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&v<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(h=!h),m=m.next;while(m!==a);return h}(c,n)&&(ta(c.prev,c,n.prev)||ta(c,n.prev,n))||Oy(c,n)&&ta(c.prev,c,c.next)>0&&ta(n.prev,n,n.next)>0)}function ta(c,n,a){return(n.y-c.y)*(a.x-n.x)-(n.x-c.x)*(a.y-n.y)}function Oy(c,n){return c.x===n.x&&c.y===n.y}function VC(c,n,a,u){const m=Dy(ta(c,n,a)),h=Dy(ta(c,n,u)),v=Dy(ta(a,u,c)),T=Dy(ta(a,u,n));return m!==h&&v!==T||!(m!==0||!Ly(c,a,n))||!(h!==0||!Ly(c,u,n))||!(v!==0||!Ly(a,c,u))||!(T!==0||!Ly(a,n,u))}function Ly(c,n,a){return n.x<=Math.max(c.x,a.x)&&n.x>=Math.min(c.x,a.x)&&n.y<=Math.max(c.y,a.y)&&n.y>=Math.min(c.y,a.y)}function Dy(c){return c>0?1:c<0?-1:0}function Zg(c,n){return ta(c.prev,c,c.next)<0?ta(c,n,c.next)>=0&&ta(c,c.prev,n)>=0:ta(c,n,c.prev)<0||ta(c,c.next,n)<0}function UC(c,n){const a=J1(c.i,c.x,c.y),u=J1(n.i,n.x,n.y),m=c.next,h=n.prev;return c.next=n,n.prev=c,a.next=m,m.prev=a,u.next=a,a.prev=u,h.next=u,u.prev=h,u}function jC(c,n,a,u){const m=J1(c,n,a);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function Yg(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function J1(c,n,a){return{i:c,x:n,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function zy(c,n){const a=c.length;if(a<=1)return[c];const u=[];let m,h;for(let v=0;v<a;v++){const T=Rr(c[v]);T!==0&&(c[v].area=Math.abs(T),h===void 0&&(h=T<0),h===T<0?(m&&u.push(m),m=[c[v]]):m.push(c[v]))}if(m&&u.push(m),n>1)for(let v=0;v<u.length;v++)u[v].length<=n||(md(u[v],n,1,u[v].length-1,uF),u[v]=u[v].slice(0,n));return u}function uF(c,n){return n.area-c.area}function Q1(c,n,a){const u=a.patternDependencies;let m=!1;for(const h of n){const v=h.paint.get(`${c}-pattern`);v.isConstant()||(m=!0);const T=v.constantOr(null);T&&(m=!0,u[T]=!0)}return m}function ex(c,n,a,u,m){const h=m.patternDependencies;for(const v of n){const T=v.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let k=T.evaluate({zoom:u},a,{},m.availableImages);k=k&&k.name?k.name:k,h[k]=!0,a.patterns[v.id]=k}}return a}class tx{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new uu,this.indexArray=new bi,this.indexArray2=new hu,this.programConfigurations=new Vl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ki,this.segments2=new ki,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=n.projection}updateFootprints(n,a){}populate(n,a,u,m){this.hasPattern=Q1("fill",this.layers,a);const h=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:T,id:k,index:L,sourceLayerIndex:x}of n){const A=this.layers[0]._featureFilter.needGeometry,O=pn(T,A);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),O,u))continue;const M=h?h.evaluate(O,{},u,a.availableImages):void 0,R={id:k,properties:T.properties,type:T.type,sourceLayerIndex:x,index:L,geometry:A?O.geometry:It(T,u,m),patterns:{},sortKey:M};v.push(R)}h&&v.sort((T,k)=>T.sortKey-k.sortKey);for(const T of v){const{geometry:k,index:L,sourceLayerIndex:x}=T;if(this.hasPattern){const A=ex("fill",this.layers,T,this.zoom,a);this.patternFeatures.push(A)}else this.addFeature(T,k,L,u,{},a.availableImages,a.brightness);a.featureIndex.insert(n[L].feature,k,L,x,this.index)}}update(n,a,u,m,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,a,v?this.stateDependentLayers:this.layers,u,m,h)}addFeatures(n,a,u,m,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,a,u,m,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,eF),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,a,u,m,h,v=[],T){for(const k of zy(a,500)){let L=0;for(const N of k)L+=N.length;const x=this.segments.prepareSegment(L,this.layoutVertexArray,this.indexArray),A=x.vertexLength,O=[],M=[];for(const N of k){if(N.length===0)continue;N!==k[0]&&M.push(O.length/2);const W=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),Y=W.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(Y+N.length-1,Y),O.push(N[0].x),O.push(N[0].y);for(let ne=1;ne<N.length;ne++)this.layoutVertexArray.emplaceBack(N[ne].x,N[ne].y),this.indexArray2.emplaceBack(Y+ne-1,Y+ne),O.push(N[ne].x),O.push(N[ne].y);W.vertexLength+=N.length,W.primitiveLength+=N.length}const R=qg(O,M);for(let N=0;N<R.length;N+=3)this.indexArray.emplaceBack(A+R[N],A+R[N+1],A+R[N+2]);x.vertexLength+=L,x.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,m,T)}}let HC,GC,WC,qC;no(tx,"FillBucket",{omit:["layers","patternFeatures"]});class nx{constructor(n,a,u,m){if(this.triangleCount=a.length/3,this.min=new Be(0,0),this.max=new Be(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[h,v]=[n[0].clone(),n[0].clone()];for(let A=1;A<n.length;++A){const O=n[A];h.x=Math.min(h.x,O.x),h.y=Math.min(h.y,O.y),v.x=Math.max(v.x,O.x),v.y=Math.max(v.y,O.y)}if(m){const A=Math.ceil(Math.max(v.x-h.x,v.y-h.y)/m);u=Math.max(u,A)}if(u===0)return;this.min=h,this.max=v;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const k=Math.max(T.x,T.y)/u;this.cellsX=Math.max(1,Math.ceil(T.x/k)),this.cellsY=Math.max(1,Math.ceil(T.y/k)),this.xScale=1/k,this.yScale=1/k;const L=[];for(let A=0;A<this.triangleCount;A++){const O=n[a[3*A+0]].sub(this.min),M=n[a[3*A+1]].sub(this.min),R=n[a[3*A+2]].sub(this.min),N=pu(Math.floor(Math.min(O.x,M.x,R.x)),this.xScale,this.cellsX),W=pu(Math.floor(Math.max(O.x,M.x,R.x)),this.xScale,this.cellsX),Y=pu(Math.floor(Math.min(O.y,M.y,R.y)),this.yScale,this.cellsY),ne=pu(Math.floor(Math.max(O.y,M.y,R.y)),this.yScale,this.cellsY),re=new Be(0,0),J=new Be(0,0),ue=new Be(0,0),ve=new Be(0,0);for(let Ie=Y;Ie<=ne;++Ie){re.y=J.y=Ie*k,ue.y=ve.y=(Ie+1)*k;for(let Ge=N;Ge<=W;++Ge)re.x=ue.x=Ge*k,J.x=ve.x=(Ge+1)*k,(Ar(O,M,R,re,J,ve)||Ar(O,M,R,re,ve,ue))&&L.push({cellIdx:Ie*this.cellsX+Ge,triIdx:A})}}if(L.length===0)return;L.sort((A,O)=>A.cellIdx-O.cellIdx||A.triIdx-O.triIdx);let x=0;for(;x<L.length;){const A=L[x].cellIdx,O={start:this.payload.length,len:0};for(;x<L.length&&L[x].cellIdx===A;)++O.len,this.payload.push(L[x++].triIdx);this.cells[A]=O}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,a){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=pu(n.x-this.min.x,this.xScale,this.cellsX),m=pu(n.y-this.min.y,this.yScale,this.cellsY),h=this.cells[m*this.cellsX+u];if(h){this._lazyInitLookup();for(let v=0;v<h.len;v++){const T=this.payload[h.start+v],k=Math.floor(T/8),L=1<<T%8;if(!(this.lookup[k]&L)&&(this.lookup[k]|=L,a.push(T),a.length===this.triangleCount))return}}}query(n,a,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>a.x||n.y>this.max.y||this.min.y>a.y)return;this._lazyInitLookup();const m=pu(n.x-this.min.x,this.xScale,this.cellsX),h=pu(a.x-this.min.x,this.xScale,this.cellsX),v=pu(n.y-this.min.y,this.yScale,this.cellsY),T=pu(a.y-this.min.y,this.yScale,this.cellsY);for(let k=v;k<=T;k++)for(let L=m;L<=h;L++){const x=this.cells[k*this.cellsX+L];if(x)for(let A=0;A<x.len;A++){const O=this.payload[x.start+A],M=Math.floor(O/8),R=1<<O%8;if(!(this.lookup[M]&R)&&(this.lookup[M]|=R,u.push(O),u.length===this.triangleCount))return}}}}function pu(c,n,a){return Math.max(0,Math.min(a-1,Math.floor(c*n)))}no(nx,"TriangleGridIndex");class KC{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.footprints=[]}updateFootprints(n,a){for(const u of this.footprints)a.push({footprint:u,id:n})}populate(n,a,u,m){const h=[];for(const{feature:v,id:T,index:k,sourceLayerIndex:L}of n){const x=this.layers[0]._featureFilter.needGeometry,A=pn(v,x);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),A,u))continue;const O={id:T,properties:v.properties,type:v.type,sourceLayerIndex:L,index:k,geometry:x?A.geometry:It(v,u,m),patterns:{}};h.push(O)}for(const v of h){const{geometry:T,index:k,sourceLayerIndex:L}=v;this.addFeature(v,T,k,u,{},a.availableImages,a.brightness),a.featureIndex.insert(n[k].feature,T,k,L,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,a,u,m,h){}destroy(){}addFeature(n,a,u,m,h,v=[],T){for(const k of zy(a,2)){const L=[],x=[],A=[],O=new Be(1/0,1/0),M=new Be(-1/0,-1/0);for(const W of k)if(W.length!==0){W!==k[0]&&A.push(x.length/2);for(let Y=0;Y<W.length;Y++)x.push(W[Y].x),x.push(W[Y].y),L.push(W[Y]),O.x=Math.min(O.x,W[Y].x),O.y=Math.min(O.y,W[Y].y),M.x=Math.max(M.x,W[Y].x),M.y=Math.max(M.y,W[Y].y)}const R=qg(x,A),N=new nx(L,R,8,256);this.footprints.push({vertices:L,indices:R,grid:N,min:O,max:M})}}}no(KC,"ClipBucket",{omit:["layers"]});const dF=Mr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),hF=Mr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),fF=Mr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),pF=Mr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),mF=Mr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),gF=Mr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:vF}=dF;var ox,ZC,rx,YC,ix,XC,JC,Fy={};function QC(){if(ZC)return ox;ZC=1;var c=Ke();function n(m,h,v,T,k){this.properties={},this.extent=v,this.type=0,this._pbf=m,this._geometry=-1,this._keys=T,this._values=k,m.readFields(a,this,h)}function a(m,h,v){m==1?h.id=v.readVarint():m==2?function(T,k){for(var L=T.readVarint()+T.pos;T.pos<L;){var x=k._keys[T.readVarint()],A=k._values[T.readVarint()];k.properties[x]=A}}(v,h):m==3?h.type=v.readVarint():m==4&&(h._geometry=v.pos)}function u(m){for(var h,v,T=0,k=0,L=m.length,x=L-1;k<L;x=k++)T+=((v=m[x]).x-(h=m[k]).x)*(h.y+v.y);return T}return ox=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,v=m.readVarint()+m.pos,T=1,k=0,L=0,x=0,A=[];m.pos<v;){if(k<=0){var O=m.readVarint();T=7&O,k=O>>3}if(k--,T===1||T===2)L+=m.readSVarint(),x+=m.readSVarint(),T===1&&(h&&A.push(h),h=[]),h.push(new c(L,x));else{if(T!==7)throw new Error("unknown command "+T);h&&h.push(h[0].clone())}}return h&&A.push(h),A},n.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,v=1,T=0,k=0,L=0,x=1/0,A=-1/0,O=1/0,M=-1/0;m.pos<h;){if(T<=0){var R=m.readVarint();v=7&R,T=R>>3}if(T--,v===1||v===2)(k+=m.readSVarint())<x&&(x=k),k>A&&(A=k),(L+=m.readSVarint())<O&&(O=L),L>M&&(M=L);else if(v!==7)throw new Error("unknown command "+v)}return[x,O,A,M]},n.prototype.toGeoJSON=function(m,h,v){var T,k,L=this.extent*Math.pow(2,v),x=this.extent*m,A=this.extent*h,O=this.loadGeometry(),M=n.types[this.type];function R(Y){for(var ne=0;ne<Y.length;ne++){var re=Y[ne];Y[ne]=[360*(re.x+x)/L-180,360/Math.PI*Math.atan(Math.exp((180-360*(re.y+A)/L)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(T=0;T<O.length;T++)N[T]=O[T][0];R(O=N);break;case 2:for(T=0;T<O.length;T++)R(O[T]);break;case 3:for(O=function(Y){var ne=Y.length;if(ne<=1)return[Y];for(var re,J,ue=[],ve=0;ve<ne;ve++){var Ie=u(Y[ve]);Ie!==0&&(J===void 0&&(J=Ie<0),J===Ie<0?(re&&ue.push(re),re=[Y[ve]]):re.push(Y[ve]))}return re&&ue.push(re),ue}(O),T=0;T<O.length;T++)for(k=0;k<O[T].length;k++)R(O[T][k])}O.length===1?O=O[0]:M="Multi"+M;var W={type:"Feature",geometry:{type:M,coordinates:O},properties:this.properties};return"id"in this&&(W.id=this.id),W},ox}function eE(){if(YC)return rx;YC=1;var c=QC();function n(u,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(a,this,m),this.length=this._features.length}function a(u,m,h){u===15?m.version=h.readVarint():u===1?m.name=h.readString():u===5?m.extent=h.readVarint():u===2?m._features.push(h.pos):u===3?m._keys.push(h.readString()):u===4&&m._values.push(function(v){for(var T=null,k=v.readVarint()+v.pos;v.pos<k;){var L=v.readVarint()>>3;T=L===1?v.readString():L===2?v.readFloat():L===3?v.readDouble():L===4?v.readVarint64():L===5?v.readVarint():L===6?v.readSVarint():L===7?v.readBoolean():null}return T}(h))}return rx=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var m=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,m,this.extent,this._keys,this._values)},rx}function tE(){return JC||(JC=1,Fy.VectorTile=function(){if(XC)return ix;XC=1;var c=eE();function n(a,u,m){if(a===3){var h=new c(m,m.readVarint()+m.pos);h.length&&(u[h.name]=h)}}return ix=function(a,u){this.layers=a.readFields(n,{},u)},ix}(),Fy.VectorTileFeature=QC(),Fy.VectorTileLayer=eE()),Fy}var Ap=tE();class sf extends Be{constructor(n,a,u){super(n,a),this.z=u}}class nE extends sf{constructor(n,a,u,m){super(n,a,u),this.w=m}}function By(c,n,a,u){const m=[],h=u===0?(v,T,k,L,x,A)=>{v.push(new Be(A,k+(A-T)/(L-T)*(x-k)))}:(v,T,k,L,x,A)=>{v.push(new Be(T+(A-k)/(x-k)*(L-T),A))};for(const v of c){const T=[];for(const k of v){if(k.length<=2)continue;const L=[];for(let O=0;O<k.length-1;O++){const M=k[O].x,R=k[O].y,N=k[O+1].x,W=k[O+1].y,Y=u===0?M:R,ne=u===0?N:W;Y<n?ne>n&&h(L,M,R,N,W,n):Y>a?ne<a&&h(L,M,R,N,W,a):L.push(k[O]),ne<n&&Y>=n&&h(L,M,R,N,W,n),ne>a&&Y<=a&&h(L,M,R,N,W,a)}let x=k[k.length-1];const A=u===0?x.x:x.y;A>=n&&A<=a&&L.push(x),L.length&&(x=L[L.length-1],L[0].x===x.x&&L[0].y===x.y||L.push(L[0]),T.push(L))}T.length&&m.push(T)}return m}function oE(c,n,a,u){const m=a==="x"?"y":"x",h=(u-c[a])/(n[a]-c[a]);c[m]=c[m]+(n[m]-c[m])*h,c[a]=u,c.hasOwnProperty("z")&&(c.z=uo(c.z,n.z,h)),c.hasOwnProperty("w")&&(c.w=uo(c.w,n.w,h))}function rE(c,n,a,u){const m=a,h=u;for(const v of["x","y"]){let T=c,k=n;T[v]>=k[v]&&(T=n,k=c),T[v]<m&&k[v]>m&&oE(T,k,v,m),T[v]<h&&k[v]>h&&oE(k,T,v,h)}}const Ny=Number.MAX_SAFE_INTEGER;function iE(c,n,a,u){return c.order<n||c.order===Ny||!(c.clipMask&a)||function(m,h){return h.length!==0&&h.find(v=>v===m)===void 0}(u,c.clipScope)}function $y(c,n){return c.x-n.x||c.y-n.y}function aE(c,n){return $y(c.min,n.min)===0&&$y(c.max,n.max)===0}function ax(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function sx(c,n){if(c.length!==n.length)return!1;for(let a=0;a<c.length;a++)if(c[a].sourceId!==n[a].sourceId||!aE(c[a],n[a])||c[a].order!==n[a].order||c[a].clipMask!==n[a].clipMask||!Ht(c[a].clipScope,n[a].clipScope))return!1;return!0}function sE(c,n,a){const u=1/Nn,m=1/(1<<a.canonical.z),h=(n.x*u+a.canonical.x)*m+a.wrap,v=(n.y*u+a.canonical.y)*m;return{min:new Be((c.x*u+a.canonical.x)*m+a.wrap,(c.y*u+a.canonical.y)*m),max:new Be(h,v)}}function _F(c,n,a){const u=1<<a.canonical.z,m=((n.x-a.wrap)*u-a.canonical.x)*Nn,h=(n.y*u-a.canonical.y)*Nn;return{min:new Be(((c.x-a.wrap)*u-a.canonical.x)*Nn,(c.y*u-a.canonical.y)*Nn),max:new Be(m,h)}}function lE(c,n,a,u,m,h,v){const T=c.indices,k=c.vertices,L=[];for(let x=u;x<u+m;x+=3){const A=n[a[x+0]+h],O=n[a[x+1]+h],M=n[a[x+2]+h],R=Math.min(A.x,O.x,M.x),N=Math.max(A.x,O.x,M.x),W=Math.min(A.y,O.y,M.y),Y=Math.max(A.y,O.y,M.y);L.length=0,c.grid.query(new Be(R,W),new Be(N,Y),L);for(let ne=0;ne<L.length;ne++){const re=L[ne];if(Ar(k[T[3*re+0]],k[T[3*re+1]],k[T[3*re+2]],A,O,M,v))return!0}}return!1}function cE(c,n,a,u){if(!c||!a)return!1;let m=c.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(a.vertices.length<c.vertices.length)return cE(a,u,c,n);const h=n.canonical,v=u.canonical,T=Math.pow(2,v.z-h.z);m=c.vertices.map(k=>new Be((k.x+h.x*Nn)*T-v.x*Nn,(k.y+h.y*Nn)*T-v.y*Nn))}return lE(a,m,c.indices,0,c.indices.length,0,0)}function uE(c,n,a,u){const m=Math.pow(2,u.z-a.z);return new Be((c+a.x*Nn)*m-u.x*Nn,(n+a.y*Nn)*m-u.y*Nn)}function dE(c,n){const a=[];n.grid.queryPoint(c,a);const u=n.indices,m=n.vertices;for(let h=0;h<a.length;h++){const v=a[h];if(mr([m[u[3*v+0]],m[u[3*v+1]],m[u[3*v+2]]],c))return!0}return!1}const lx=[new Be(0,0),new Be(Nn,0),new Be(Nn,Nn),new Be(0,Nn)];function hE(c,n){const a=[];let u=[];if(!n||c.length<2)return[c];if(c.length===2)return Sr(c[0],c[1],lx)?[c]:[];for(let m=0;m<c.length+2;m++){const h=c[m%c.length],v=c[(m+1)%c.length],T=Sr(m===0?c[c.length-1]:c[(m-1)%c.length],h,lx),k=Sr(h,v,lx),L=T||k;L&&u.push(h),L&&k||u.length>0&&(u.length>1&&a.push(u),u=[])}return u.length>1&&a.push(u),a}const cx=Ap.VectorTileFeature.types,yF=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],bF=["fill-extrusion-flood-light-ground-radius"],xF=Math.pow(2,13),wF=Math.pow(2,15)-1,fE=new Be(0,1),jd=2147483648;function Xg(c,n,a,u,m,h,v,T){c.emplaceBack((n<<1)+v,(a<<1)+h,(Math.floor(u*xF)<<1)+m,Math.round(T))}function Jg(c,n,a){c.emplaceBack(n.x*Nn,n.y*Nn,a?1:0)}function Vy(c,n,a,u,m,h){c.emplaceBack(n.x,n.y,(a.x<<1)+u,(a.y<<1)+m,h)}function Qg(c,n,a){c.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}class pE{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class mE{constructor(){this.centroidXY=new Be(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Be(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Be(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Be(this.max.x-this.min.x,this.max.y-this.min.y)}}class gE{constructor(){this.acc=new Be(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,a){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=a.x,n.min.y=n.max.y=a.y)}appendEdge(n,a,u){this.accCount++,this.acc._add(a);let m=!!this.borders;a.x<n.min.x?(n.min.x=a.x,m=!0):a.x>n.max.x&&(n.max.x=a.x,m=!0),a.y<n.min.y?(n.min.y=a.y,m=!0):a.y>n.max.y&&(n.max.y=a.y,m=!0),((a.x===0||a.x===Nn)&&a.x===u.x)!=((a.y===0||a.y===Nn)&&a.y===u.y)&&this.processBorderOverlap(a,u),m&&this.checkBorderIntersection(a,u)}checkBorderIntersection(n,a){a.x<0!=n.x<0&&this.addBorderIntersection(0,uo(a.y,n.y,(0-a.x)/(n.x-a.x))),a.x>Nn!=n.x>Nn&&this.addBorderIntersection(1,uo(a.y,n.y,(Nn-a.x)/(n.x-a.x))),a.y<0!=n.y<0&&this.addBorderIntersection(2,uo(a.x,n.x,(0-a.y)/(n.y-a.y))),a.y>Nn!=n.y>Nn&&this.addBorderIntersection(3,uo(a.x,n.x,(Nn-a.y)/(n.y-a.y)))}addBorderIntersection(n,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];a<u[0]&&(u[0]=a),a>u[1]&&(u[1]=a)}processBorderOverlap(n,a){if(n.x===a.x){if(n.y===a.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,a.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,a.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new Be(0,0):new Be(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,a)=>n+ +(a[0]!==Number.MAX_VALUE),0):0}}function vE(c,n){const a=c.add(n)._unit(),u=yt(c.x*a.x+c.y*a.y,-1,1);var m,h,v;return v=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(v)))/4*wF*((m=c).x*(h=n).y-m.y*h.x<0?-1:1)}const SF=[c=>c.x<0,c=>c.x>Nn,c=>c.y<0,c=>c.y>Nn];function TF(c,n,a,u){const m=[4];if(u===0)return m;a._mult(u);const h=c.sub(a),v=n.sub(a),T=[c,n,h,v];for(let k=0;k<4;k++)for(const L of T)if(SF[k](L)){m.push(k);break}return m}class _E{constructor(n){this.vertexArray=new kg,this.indexArray=new bi,this.programConfigurations=new Vl(n.layers,{zoom:n.zoom,lut:n.lut},a=>bF.includes(a)),this._segments=new ki,this.hiddenByLandmarkVertexArray=new wp,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ki}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,a,u,m=!1){const h=n.length;if(h>2){let v=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let k;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const L=n[0],x=n[1];k=vE(L.sub(n[h-1])._perp()._unit(),x.sub(L)._perp()._unit())}for(let L=0;L<h;L++){const x=L===h-1?0:L+1,A=n[L],O=n[x],M=n[x===h-1?0:x+1],R=O.sub(A)._perp()._unit(),N=vE(R,M.sub(O)._perp()._unit()),W=k,Y=N;if(ux(A,O,a)||m&&xE(A,a)&&xE(O,a)){k=N;continue}const ne=T.vertexLength;Vy(this.vertexArray,A,O,1,1,W),Vy(this.vertexArray,A,O,1,0,W),Vy(this.vertexArray,A,O,0,1,Y),Vy(this.vertexArray,A,O,0,0,Y),T.vertexLength+=4;const re=TF(A,O,R,u);for(const J of re)this._segmentToGroundQuads[v].push({id:ne,region:J}),this._segmentToRegionTriCounts[v][J]+=2,T.primitiveLength+=2;k=N}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),a=n.length;for(let u=0;u<a;u++)this._segmentToGroundQuads[u].sort((m,h)=>m.region-h.region);for(let u=0;u<a;u++){const m=this._segmentToGroundQuads[u],h=n[u],v=this._segmentToRegionTriCounts[u];v.reduce((k,L)=>k+L,0);let T=0;for(let k=0;k<=4;k++){const L=v[k];if(L!==0){let x=this.regionSegments[k];x||(x=this.regionSegments[k]=new ki);const A={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+T,vertexLength:h.vertexLength,primitiveLength:L};x.get().push(A)}T+=L}for(let k=0;k<m.length;k++){const L=m[k].id;this.indexArray.emplaceBack(L,L+1,L+3),this.indexArray.emplaceBack(L,L+3,L+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,a,u,m,h,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,a,u,m,h,v)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,hF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,a,u,m,h,v){this.hasData()&&this.programConfigurations.updatePaintArrays(n,a,u,m,h,v)}updateHiddenByLandmark(n){if(!this.hasData())return;const a=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&jd?1:0;for(let m=n.groundVertexArrayOffset;m<a;++m)this.hiddenByLandmarkVertexArray.emplace(m,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,mF.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const a=this.regionSegments[n];a&&a.destroy()}}}}class Uy{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new bi,this.footprintVertices=new uu,this.footprintSegments=[],this.layoutVertexArray=new Pd,this.centroidVertexArray=new wy,this.wallVertexArray=new Ng,this.indexArray=new bi,this.programConfigurations=new Vl(n.layers,{zoom:n.zoom,lut:n.lut},a=>yF.includes(a)),this.segments=new ki,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.groundEffect=new _E(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,a){}populate(n,a,u,m){this.features=[],this.hasPattern=Q1("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=lt(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:v,index:T,sourceLayerIndex:k}of n){const L=this.layers[0]._featureFilter.needGeometry,x=pn(h,L);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),x,u))continue;const A={id:v,sourceLayerIndex:k,index:T,geometry:L?x.geometry:It(h,u,m),properties:h.properties,type:h.type,patterns:{}},O=this.layoutVertexArray.length,M=cx[A.type]==="Polygon";if(this.hasPattern)this.features.push(ex("fill-extrusion",this.layers,A,this.zoom,a));else if(this.wallMode)for(const R of A.geometry)for(const N of hE(R,M))this.addFeature(A,[N],T,u,{},a.availableImages,m,a.brightness);else this.addFeature(A,A.geometry,T,u,{},a.availableImages,m,a.brightness);a.featureIndex.insert(h,A.geometry,T,k,this.index,O)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,a,u,m,h,v){for(const T of this.features){const k=cx[T.type]==="Polygon",{geometry:L}=T;if(this.wallMode)for(const x of L)for(const A of hE(x,k))this.addFeature(T,[A],T.index,a,u,m,h,v);else this.addFeature(T,L,T.index,a,u,m,h,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,a,u,m,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(n,a,T,u,m,h),this.groundEffect.update(n,a,T,u,m,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,vF),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,pF.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,gF.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,fF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,u,m,h,v,T,k){const L=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,x=[new Be(0,0),new Be(Nn,Nn)],A=T.projection,O=A.name==="globe",M=this.wallMode||cx[n.type]==="Polygon",R=new gE;R.centroidDataIndex=this.centroidData.length;const N=new mE,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},m)<=0,Y=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},m);let ne;if(N.height=Y,N.vertexArrayOffset=this.layoutVertexArray.length,N.groundVertexArrayOffset=this.groundEffect.vertexArray.length,O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Yh),this.wallMode){if(O)return void Bn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(a.length!==1)return;ne=function($e){const st=$e[0].x===$e[$e.length-1].x&&$e[0].y===$e[$e.length-1].y;(function(Pn){let Sn=0;const wo=Pn.length;for(let Xn=0;Xn<wo;Xn++)Sn+=(Pn[(Xn+1)%wo].x-Pn[Xn].x)*(Pn[(Xn+1)%wo].y+Pn[Xn].y);return Sn>=0})($e)||($e=$e.reverse());const rt={geometry:[],joinNormals:[],indices:[]},ht=[],pt=[],Tt=[];let Ot=$e.length;if(Ot<(st?3:2))return rt;for(;Ot>=2&&$e[Ot-1].equals($e[Ot-2]);)Ot--;let Ft,Pt,sn,Cn,Jt,Jn=0;for(;Jn<Ot-1&&$e[Jn].equals($e[Jn+1]);)Jn++;st&&(Ft=$e[Ot-2],Jt=$e[Jn].sub(Ft)._unit()._perp());for(let Pn=Jn;Pn<Ot;Pn++){if(sn=Pn===Ot-1?st?$e[Jn+1]:void 0:$e[Pn+1],sn&&$e[Pn].equals(sn))continue;Jt&&(Cn=Jt),Ft&&(Pt=Ft),Ft=$e[Pn],Jt=sn?sn.sub(Ft)._unit()._perp():Cn,Cn=Cn||Jt;let Sn=Cn.add(Jt);Sn.x===0&&Sn.y===0||Sn._unit();const wo=Sn.x*Jt.x+Sn.y*Jt.y,Xn=wo!==0?1/wo:1/0,io=Cn.x*Jt.y-Cn.y*Jt.x>0;let Uo="miter";const Qo=2;Uo==="miter"&&Xn>Qo&&(Uo="bevel"),Uo==="bevel"&&(Xn>100&&(Uo="flipbevel"),Xn<Qo&&(Uo="miter"));const er=(Zo,lr,ar,Qr)=>{const Wr=new Be(Zo.x,Zo.y),Bo=new Be(Zo.x,Zo.y);Wr.x+=lr.x*Qr,Wr.y+=lr.y*Qr,Bo.x-=lr.x*Math.max(ar,1),Bo.y-=lr.y*Math.max(ar,1),Tt.push(lr),ht.push(Wr),pt.push(Bo)};if(Uo==="miter")Sn._mult(Xn),er(Ft,Sn,0,0);else if(Uo==="flipbevel")Sn=Jt.mult(-1),er(Ft,Sn,0,0),er(Ft,Sn.mult(-1),0,0);else{const Zo=-Math.sqrt(Xn*Xn-1),lr=io?Zo:0,ar=io?0:Zo;Pt&&er(Ft,Cn,lr,ar),sn&&er(Ft,Jt,lr,ar)}}rt.geometry=[...ht,...pt.reverse(),ht[0]],rt.joinNormals=[...Tt,...Tt.reverse(),Tt[Tt.length-1]];const Fn=rt.geometry.length-1;for(let Pn=0;Pn<Fn/2;Pn++)if(Pn+1<Fn/2){let Sn=Pn,wo=Pn+1,Xn=Fn-1-Pn,io=Fn-2-Pn;Sn=Sn===0?Fn-1:Sn-1,wo=wo===0?Fn-1:wo-1,Xn=Xn===0?Fn-1:Xn-1,io=io===0?Fn-1:io-1,rt.indices.push(Xn),rt.indices.push(wo),rt.indices.push(Sn),rt.indices.push(Xn),rt.indices.push(io),rt.indices.push(wo)}return rt}(a[0]),a=[ne.geometry]}const re=($e,st)=>$e<(st.length-1)/2||$e===st.length-1,J=this.wallMode?[a]:zy(a,500);for(let $e=J.length-1;$e>=0;$e--){const st=J[$e];(st.length===0||(ue=st[0]).every(Fe=>Fe.x<=0)||ue.every(Fe=>Fe.x>=Nn)||ue.every(Fe=>Fe.y<=0)||ue.every(Fe=>Fe.y>=Nn))&&J.splice($e,1)}var ue;let ve;if(O)ve=CE(J,x,m);else{ve=[];for(const $e of J)ve.push({polygon:$e,bounds:x})}const Ie=M?this.edgeRadius:0,Ge=Ie>0&&this.zoom<17,ze=($e,st)=>{if($e.length===0)return!1;const Fe=$e[$e.length-1];return st.x===Fe.x&&st.y===Fe.y};for(const{polygon:$e,bounds:st}of ve){let Fe=0,rt=0;for(const Ot of $e)M&&!Ot[0].equals(Ot[Ot.length-1])&&Ot.push(Ot[0]),rt+=M?Ot.length-1:Ot.length;const ht=this.segments.prepareSegment((M?5:4)*rt,this.layoutVertexArray,this.indexArray);N.footprintSegIdx<0&&(N.footprintSegIdx=this.footprintSegments.length),N.polygonSegIdx<0&&(N.polygonSegIdx=this.polygonSegments.length);const pt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Tt=new pE;if(Tt.vertexOffset=this.footprintVertices.length,Tt.indexOffset=3*this.footprintIndices.length,Tt.ringIndices=[],M){const Ot=[],Ft=[];Fe=ht.vertexLength;for(let sn=0;sn<$e.length;sn++){const Cn=$e[sn];Cn.length&&sn!==0&&Ft.push(Ot.length/2);const Jt=[];let Jn,Fn;Jn=Cn[1].sub(Cn[0])._perp()._unit(),Tt.ringIndices.push(Cn.length-1);for(let Pn=1;Pn<Cn.length;Pn++){const Sn=Cn[Pn],wo=Cn[Pn===Cn.length-1?1:Pn+1],Xn=Sn.clone();if(Ie){Fn=wo.sub(Sn)._perp()._unit();const io=Jn.add(Fn)._unit(),Uo=Ie*Math.min(4,1/(Jn.x*io.x+Jn.y*io.y));Xn.x+=Uo*io.x,Xn.y+=Uo*io.y,Xn.x=Math.round(Xn.x),Xn.y=Math.round(Xn.y),Jn=Fn}if(!W||Ie!==0&&!Ge||ze(Jt,Xn)||Jt.push(Xn),Xg(this.layoutVertexArray,Xn.x,Xn.y,0,0,1,1,0),this.wallMode){const io=re(Pn,Cn);Jg(this.wallVertexArray,ne.joinNormals[Pn],!io)}ht.vertexLength++,this.footprintVertices.emplaceBack(Sn.x,Sn.y),Ot.push(Sn.x,Sn.y),O&&Qg(this.layoutVertexExtArray,A.projectTilePoint(Xn.x,Xn.y,m),A.upVector(m,Xn.x,Xn.y))}W&&(Ie===0||Ge)&&(Jt.length!==0&&ze(Jt,Jt[0])&&Jt.pop(),this.groundEffect.addData(Jt,st,L))}const Pt=this.wallMode?ne.indices:qg(Ot,Ft);for(let sn=0;sn<Pt.length;sn+=3)this.footprintIndices.emplaceBack(Tt.vertexOffset+Pt[sn+0],Tt.vertexOffset+Pt[sn+1],Tt.vertexOffset+Pt[sn+2]),this.indexArray.emplaceBack(Fe+Pt[sn],Fe+Pt[sn+2],Fe+Pt[sn+1]),ht.primitiveLength++;Tt.indexCount+=Pt.length,Tt.vertexCount+=this.footprintVertices.length-Tt.vertexOffset}for(let Ot=0;Ot<$e.length;Ot++){const Ft=$e[Ot];R.startRing(N,Ft[0]);let Pt=Ft.length>4&&wE(Ft[Ft.length-2],Ft[0],Ft[1]),sn=Ie?CF(Ft[Ft.length-2],Ft[0],Ft[1],Ie):0;const Cn=[];let Jt,Jn,Fn;Jn=Ft[1].sub(Ft[0])._perp()._unit();let Pn=!0;for(let Sn=1,wo=0;Sn<Ft.length;Sn++){let Xn=Ft[Sn-1],io=Ft[Sn];const Uo=Ft[Sn===Ft.length-1?1:Sn+1];if(R.appendEdge(N,io,Xn),ux(io,Xn,st)){Ie&&(Jn=Uo.sub(io)._perp()._unit(),Pn=!Pn);continue}const Qo=io.sub(Xn)._perp(),er=Qo.x/(Math.abs(Qo.x)+Math.abs(Qo.y)),Zo=Qo.y>0?1:0,lr=Xn.dist(io);if(wo+lr>32768&&(wo=0),Ie){Fn=Uo.sub(io)._perp()._unit();let Bo=bE(Xn,io,Uo,yE(Jn,Fn),Ie);isNaN(Bo)&&(Bo=0);const Dr=io.sub(Xn)._unit();Xn=Xn.add(Dr.mult(sn))._round(),io=io.add(Dr.mult(-Bo))._round(),sn=Bo,Jn=Fn,W&&this.zoom>=17&&(ze(Cn,Xn)||Cn.push(Xn),ze(Cn,io)||Cn.push(io))}const ar=ht.vertexLength,Qr=Ft.length>4&&wE(Xn,io,Uo);let Wr=SE(wo,Pt,Pn);if(Xg(this.layoutVertexArray,Xn.x,Xn.y,er,Zo,0,0,Wr),Xg(this.layoutVertexArray,Xn.x,Xn.y,er,Zo,0,1,Wr),this.wallMode){const Bo=re(Sn-1,Ft),Dr=ne.joinNormals[Sn-1];Jg(this.wallVertexArray,Dr,Bo),Jg(this.wallVertexArray,Dr,Bo)}if(wo+=lr,Wr=SE(wo,Qr,!Pn),Pt=Qr,Xg(this.layoutVertexArray,io.x,io.y,er,Zo,0,0,Wr),Xg(this.layoutVertexArray,io.x,io.y,er,Zo,0,1,Wr),this.wallMode){const Bo=re(Sn,Ft),Dr=ne.joinNormals[Sn];Jg(this.wallVertexArray,Dr,Bo),Jg(this.wallVertexArray,Dr,Bo)}if(ht.vertexLength+=4,this.indexArray.emplaceBack(ar+0,ar+1,ar+2),this.indexArray.emplaceBack(ar+1,ar+3,ar+2),ht.primitiveLength+=2,Ie){const Bo=Fe+(Sn===1?Ft.length-2:Sn-2),Dr=Sn===1?Fe:Bo+1;if(this.indexArray.emplaceBack(ar+1,Bo,ar+3),this.indexArray.emplaceBack(Bo,Dr,ar+3),ht.primitiveLength+=2,Jt===void 0&&(Jt=ar),!ux(Uo,Ft[Sn],st)){const Br=Sn===Ft.length-1?Jt:ht.vertexLength;this.indexArray.emplaceBack(ar+2,ar+3,Br),this.indexArray.emplaceBack(ar+3,Br+1,Br),this.indexArray.emplaceBack(ar+3,Dr,Br+1),ht.primitiveLength+=3}Pn=!Pn}if(O){const Bo=this.layoutVertexExtArray,Dr=A.projectTilePoint(Xn.x,Xn.y,m),Br=A.projectTilePoint(io.x,io.y,m),mi=A.upVector(m,Xn.x,Xn.y),Di=A.upVector(m,io.x,io.y);Qg(Bo,Dr,mi),Qg(Bo,Dr,mi),Qg(Bo,Br,Di),Qg(Bo,Br,Di)}}M&&(Fe+=Ft.length-1),W&&Ie&&this.zoom>=17&&(Cn.length!==0&&ze(Cn,Cn[0])&&Cn.pop(),this.groundEffect.addData(Cn,st,L,Ie>0))}this.footprintSegments.push(Tt),pt.triangleCount=this.indexArray.length-pt.triangleArrayOffset,this.polygonSegments.push(pt),++N.footprintSegLen,++N.polygonSegLen}if(N.vertexCount=this.layoutVertexArray.length-N.vertexArrayOffset,N.groundVertexCount=this.groundEffect.vertexArray.length-N.groundVertexArrayOffset,N.vertexCount!==0){if(N.centroidXY=R.borders?fE:this.encodeCentroid(R,N),this.centroidData.push(N),R.borders){this.featuresOnBorder.push(R);const $e=this.featuresOnBorder.length-1;for(let st=0;st<R.borders.length;st++)R.borders[st][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[st].push($e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,m,k),this.groundEffect.addPaintPropertiesData(n,u,h,v,m,k),this.maxHeight=Math.max(this.maxHeight,Y)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((a,u)=>this.featuresOnBorder[a].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let T=0;T<this.centroidData.length;T++){const k=this.centroidData[T],L=+(k.min.y+k.max.y>Nn),x=2*L+(+(k.min.x+k.max.x>Nn)^L);for(let A=0;A<k.polygonSegLen;A++){const O=k.polygonSegIdx+A;n.push({centroidIdx:T,subtile:x,polygonSegmentIdx:O,triangleSegmentIdx:this.polygonSegments[O].triangleSegIdx})}}const a=new bi;n.sort((T,k)=>T.triangleSegmentIdx===k.triangleSegmentIdx?T.subtile-k.subtile:T.triangleSegmentIdx-k.triangleSegmentIdx);let u=0,m=0,h=0;for(const T of n){if(T.triangleSegmentIdx!==u)break;h++}const v=n.length;for(;m!==n.length;){u=n[m].triangleSegmentIdx;let T=0,k=m,L=m;for(let x=k;x<h&&n[x].subtile===T;x++)L++;for(;k!==h;){const x=n[k];T=x.subtile;const A=this.centroidData[x.centroidIdx].min.clone(),O=this.centroidData[x.centroidIdx].max.clone(),M={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:a.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=k;R<L;R++){const N=n[R],W=this.polygonSegments[N.polygonSegmentIdx],Y=this.centroidData[N.centroidIdx].min,ne=this.centroidData[N.centroidIdx].max,re=this.indexArray.uint16;for(let J=W.triangleArrayOffset;J<W.triangleArrayOffset+W.triangleCount;J++)a.emplaceBack(re[3*J],re[3*J+1],re[3*J+2]);M.primitiveLength+=W.triangleCount,A.x=Math.min(A.x,Y.x),A.y=Math.min(A.y,Y.y),O.x=Math.max(O.x,ne.x),O.y=Math.max(O.y,ne.y)}M.primitiveLength>0&&this.triangleSubSegments.push({segment:M,min:A,max:O}),k=L;for(let R=k;R<h&&n[R].subtile===n[k].subtile;R++)L++}m=h;for(let x=m;x<v&&n[x].triangleSegmentIdx===n[m].triangleSegmentIdx;x++)h++}a._trim(),this.indexArray=a}getVisibleSegments(n,a,u){const m=new ki;if(this.wallMode){for(const N of this.triangleSubSegments)m.segments.push(N.segment);return m}let h=0,v=0;const T=1<<n.canonical.z;if(a){const N=a.getMinMaxForTile(n);N&&(h=N.min,v=N.max)}v+=this.maxHeight;const k=n.toUnwrapped();let L;const x=[k.canonical.x/T+k.wrap,k.canonical.y/T],A=[(k.canonical.x+1)/T+k.wrap,(k.canonical.y+1)/T],O=(N,W,Y)=>[N[0]*(1-Y[0])+W[0]*Y[0],N[1]*(1-Y[1])+W[1]*Y[1]],M=[],R=[];for(const N of this.triangleSubSegments){M[0]=N.min.x/Nn,M[1]=N.min.y/Nn,R[0]=N.max.x/Nn,R[1]=N.max.y/Nn;const W=O(x,A,M),Y=O(x,A,R);if(new Fr([W[0],W[1],h],[Y[0],Y[1],v]).intersectsPrecise(u)===0){L&&(m.segments.push(L),L=void 0);continue}const ne=N.segment;L&&L.vertexOffset!==ne.vertexOffset&&(m.segments.push(L),L=void 0),L?(L.vertexLength+=ne.vertexLength,L.primitiveLength+=ne.primitiveLength):L={vertexOffset:ne.vertexOffset,primitiveLength:ne.primitiveLength,vertexLength:ne.vertexLength,primitiveOffset:ne.primitiveOffset,sortKey:void 0,vaos:{}}}return L&&m.segments.push(L),m}encodeCentroid(n,a){const u=n.centroid(),m=a.span(),h=Math.min(7,Math.round(m.x*this.tileToMeter/10)),v=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new Be(yt(u.x,1,Nn-1)<<3|h,yt(u.y,1,Nn-1)<<3|v)}encodeBorderCentroid(n){if(!n.borders)return new Be(0,0);const a=n.borders,u=Number.MAX_VALUE;if(a[0][0]!==u||a[1][0]!==u){const m=a[0][0]!==u?0:1;return new Be(6|(a[0][0]!==u?0:65528),(a[m][0]+a[m][1])/2<<3|6)}{const m=a[2][0]!==u?2:3;return new Be((a[m][0]+a[m][1])/2<<3|6,6|(a[2][0]!==u?0:65528))}}showCentroid(n){const a=this.centroidData[n.centroidDataIndex];a.flags&=jd,a.centroidXY.x=0,a.centroidXY.y=0,this.writeCentroidToBuffer(a)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const a=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,m=n.flags&jd?fE:n.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(a);if(this.centroidVertexArray.geta_centroid_pos1(a)!==m.y||h!==m.x){for(let v=a;v<u;++v)this.centroidVertexArray.emplace(v,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,a,u){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const m=a.getReplacementRegionsForTile(n.toUnwrapped());if(sx(this.activeReplacements,m))return;if(this.activeReplacements=m,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const h=[];for(const v of this.activeReplacements){if(v.order<u)continue;const T=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-n.canonical.z));for(const k of this.centroidData)if(!(k.flags&jd||v.min.x>k.max.x||k.min.x>v.max.x||v.min.y>k.max.y||k.min.y>v.max.y))for(let L=0;L<k.footprintSegLen;L++){const x=this.footprintSegments[k.footprintSegIdx+L];if(h.length=0,EF(this.footprintVertices,x.vertexOffset,x.vertexCount,v.footprintTileId.canonical,n.canonical,h),lE(v.footprint,h,this.footprintIndices.uint16,x.indexOffset,x.indexCount,-x.vertexOffset,-T)){k.flags|=jd;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,a,u){let m=!1;for(let h=0;h<u.footprintSegLen;h++){const v=this.footprintSegments[u.footprintSegIdx+h];let T=0;for(const k of v.ringIndices){for(let L=T,x=k+T-1;L<k+T;x=L++){const A=this.footprintVertices.int16[2*(L+v.vertexOffset)+0],O=this.footprintVertices.int16[2*(L+v.vertexOffset)+1],M=this.footprintVertices.int16[2*(x+v.vertexOffset)+1];O>a!=M>a&&n<(this.footprintVertices.int16[2*(x+v.vertexOffset)+0]-A)*(a-O)/(M-O)+A&&(m=!m)}T=k}}return m}getHeightAtTileCoord(n,a){let u=Number.NEGATIVE_INFINITY,m=!0;const h=4*(n+Nn)*Nn+(a+Nn);if(this.partLookup.hasOwnProperty(h)){const v=this.partLookup[h];return v?{height:v.height,hidden:!!(v.flags&jd)}:void 0}for(const v of this.centroidData)n>v.max.x||v.min.x>n||a>v.max.y||v.min.y>a||this.footprintContainsPoint(n,a,v)&&v&&v.height>u&&(u=v.height,this.partLookup[h]=v,m=!!(v.flags&jd));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:m};this.partLookup[h]=void 0}}function yE(c,n){const a=c.add(n)._unit();return c.x*a.x+c.y*a.y}function CF(c,n,a,u){const m=n.sub(c)._perp()._unit(),h=a.sub(n)._perp()._unit();return bE(c,n,a,yE(m,h),u)}function bE(c,n,a,u,m){const h=Math.sqrt(1-u*u);return Math.min(c.dist(n)/3,n.dist(a)/3,m*h/u)}function ux(c,n,a){return c.x<a[0].x&&n.x<a[0].x||c.x>a[1].x&&n.x>a[1].x||c.y<a[0].y&&n.y<a[0].y||c.y>a[1].y&&n.y>a[1].y}function xE(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function wE(c,n,a){if(c.x<0||c.x>=Nn||n.x<0||n.x>=Nn||a.x<0||a.x>=Nn)return!1;const u=a.sub(n),m=u.perp(),h=c.sub(n);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&m.x*h.x+m.y*h.y<0}function SE(c,n,a){const u=n?2|c:-3&c;return a?1|u:-2&u}function TE(){const c=Math.PI/32,n=Math.tan(c),a=V;return a*Math.sqrt(1+2*n*n)-a}function CE(c,n,a){const u=1<<a.z,m=Le(a.x/u),h=Le((a.x+1)/u),v=Ue(a.y/u),T=Ue((a.y+1)/u);return function(k,L,x,A,O=0,M){const R=[];if(!k.length||!x||!A)return R;const N=(ve,Ie)=>{for(const Ge of ve)R.push({polygon:Ge,bounds:Ie})},W=Math.ceil(Math.log2(x)),Y=Math.ceil(Math.log2(A)),ne=W-Y,re=[];for(let ve=0;ve<Math.abs(ne);ve++)re.push(ne>0?0:1);for(let ve=0;ve<Math.min(W,Y);ve++)re.push(0),re.push(1);let J=k;if(J=By(J,L[0].y-O,L[1].y+O,1),J=By(J,L[0].x-O,L[1].x+O,0),!J.length)return R;const ue=[];for(re.length?ue.push({polygons:J,bounds:L,depth:0}):N(J,L);ue.length;){const ve=ue.pop(),Ie=ve.depth,Ge=re[Ie],ze=ve.bounds[0],$e=ve.bounds[1],st=Ge===0?ze.x:ze.y,Fe=Ge===0?$e.x:$e.y,rt=M?M(Ge,st,Fe):.5*(st+Fe),ht=By(ve.polygons,st-O,rt+O,Ge),pt=By(ve.polygons,rt-O,Fe+O,Ge);if(ht.length){const Tt=[ze,new Be(Ge===0?rt:$e.x,Ge===1?rt:$e.y)];re.length>Ie+1?ue.push({polygons:ht,bounds:Tt,depth:Ie+1}):N(ht,Tt)}if(pt.length){const Tt=[new Be(Ge===0?rt:ze.x,Ge===1?rt:ze.y),$e];re.length>Ie+1?ue.push({polygons:pt,bounds:Tt,depth:Ie+1}):N(pt,Tt)}}return R}(c,n,Math.ceil((h-m)/11.25),Math.ceil((v-T)/11.25),1,(k,L,x)=>{if(k===0)return .5*(L+x);{const A=Ue((a.y+L/Nn)/u);return(Te(.5*(Ue((a.y+x/Nn)/u)+A))*u-a.y)*Nn}})}function EF(c,n,a,u,m,h){const v=Math.pow(2,u.z-m.z);for(let T=0;T<a;T++){let k=c.int16[2*(T+n)+0],L=c.int16[2*(T+n)+1];k=(k+m.x*Nn)*v-u.x*Nn,L=(L+m.y*Nn)*v-u.y*Nn,h.push(new Be(k,L))}}let EE,ME;function ev(c,n){return c.x*n.x+c.y*n.y}function IE(c,n){if(c.length===1){let a=0;const u=n[a++];let m;for(;!m||u.equals(m);)if(m=n[a++],!m)return 1/0;for(;a<n.length;a++){const h=n[a],v=c[0],T=m.sub(u),k=h.sub(u),L=v.sub(u),x=ev(T,T),A=ev(T,k),O=ev(k,k),M=ev(L,T),R=ev(L,k),N=x*O-A*A,W=(O*M-A*R)/N,Y=(x*R-A*M)/N,ne=u.z*(1-W-Y)+m.z*W+h.z*Y;if(isFinite(ne))return ne}return 1/0}{let a=1/0;for(const u of n)a=Math.min(a,u.z);return a}}function AE(c,n,a,u,m,h,v,T){const k=v*m.getElevationAt(c,n,!0,!0),L=h[0]!==0,x=L?h[1]===0?v*(h[0]/7-450):v*function(A,O,M){const R=Math.floor(O[0]/8),N=Math.floor(O[1]/8),W=10*(O[0]-8*R),Y=10*(O[1]-8*N),ne=A.getElevationAt(R,N,!0,!0),re=A.getMeterToDEM(M),J=Math.floor(.5*(W*re-1)),ue=Math.floor(.5*(Y*re-1)),ve=A.tileCoordToPixel(R,N),Ie=2*J+1,Ge=2*ue+1,ze=function(pt,Tt,Ot,Ft,Pt){return[pt.getElevationAtPixel(Tt,Ot,!0),pt.getElevationAtPixel(Tt+Pt,Ot,!0),pt.getElevationAtPixel(Tt,Ot+Pt,!0),pt.getElevationAtPixel(Tt+Ft,Ot+Pt,!0)]}(A,ve.x-J,ve.y-ue,Ie,Ge),$e=Math.abs(ze[0]-ze[1]),st=Math.abs(ze[2]-ze[3]),Fe=Math.abs(ze[0]-ze[2])+Math.abs(ze[1]-ze[3]),rt=Math.min(.25,.5*re*($e+st)/Ie),ht=Math.min(.25,.5*re*Fe/Ge);return ne+Math.max(rt*W,ht*Y)}(m,h,T):k;return{base:k+(a===0?-1:a),top:L?Math.max(x+u,k+a+2):k+u}}no(Uy,"FillExtrusionBucket",{omit:["layers","features"]}),no(mE,"PartData"),no(pE,"FootprintSegment"),no(gE,"BorderCentroidData"),no(_E,"GroundEffect");const MF=Mr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),IF=Mr([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:AF}=MF,kF=Mr([{name:"a_packed",components:4,type:"Float32"}]),{members:PF}=kF,RF=Mr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:OF}=RF;class kE{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.image=new Ud({width:n,height:a}),this.positions={},this.uploaded=!1}getDash(n,a){const u=this.getKey(n,a);return this.positions[u]}trim(){const n=this.width,a=this.height=ur(this.nextRow);this.image.resize({width:n,height:a})}getKey(n,a){return n.join(",")+a}getDashRanges(n,a,u){const m=[];let h=n.length%2==1?-n[n.length-1]*u:0,v=n[0]*u,T=!0;m.push({left:h,right:v,isDash:T,zeroLength:n[0]===0});let k=n[0];for(let L=1;L<n.length;L++){T=!T;const x=n[L];h=k*u,k+=x,v=k*u,m.push({left:h,right:v,isDash:T,zeroLength:x===0})}return m}addRoundDash(n,a,u){const m=a/2;for(let h=-u;h<=u;h++){const v=this.width*(this.nextRow+u+h);let T=0,k=n[T];for(let L=0;L<this.width;L++){L/k.right>1&&(k=n[++T]);const x=Math.abs(L-k.left),A=Math.abs(L-k.right),O=Math.min(x,A);let M;const R=h/u*(m+1);if(k.isDash){const N=m-Math.abs(R);M=Math.sqrt(O*O+N*N)}else M=m-Math.sqrt(O*O+R*R);this.image.data[v+L]=Math.max(0,Math.min(255,M+128))}}}addRegularDash(n,a){for(let k=n.length-1;k>=0;--k){const L=n[k],x=n[k+1];L.zeroLength?n.splice(k,1):x&&x.isDash===L.isDash&&(x.left=L.left,n.splice(k,1))}const u=n[0],m=n[n.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const h=this.width*this.nextRow;let v=0,T=n[v];for(let k=0;k<this.width;k++){k/T.right>1&&(T=n[++v]);const L=Math.abs(k-T.left),x=Math.abs(k-T.right),A=Math.min(L,x);this.image.data[h+k]=Math.max(0,Math.min(255,(T.isDash?A:-A)+a+128))}}addDash(n,a){const u=this.getKey(n,a);if(this.positions[u])return this.positions[u];const m=a==="round",h=m?7:0,v=2*h+1;if(this.nextRow+v>this.height)return Bn("LineAtlas out of space"),null;n.length===0&&n.push(1);let T=0;for(let x=0;x<n.length;x++)n[x]<0&&(Bn("Negative value is found in line dasharray, replacing values with 0"),n[x]=0),T+=n[x];if(T!==0){const x=this.width/T,A=this.getDashRanges(n,this.width,x);m?this.addRoundDash(A,x,h):this.addRegularDash(A,a==="square"?.5*x:0)}const k=this.nextRow+h;this.nextRow+=v;const L={tl:[k,h],br:[T,0]};return this.positions[u]=L,L}}no(kE,"LineAtlas");const LF=Ap.VectorTileFeature.types,DF=Math.cos(Math.PI/180*37.5),zF=Math.cos(Math.PI/180*5);class dx{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Zh,this.layoutVertexArray2=new Tc,this.patternVertexArray=new du,this.indexArray=new bi,this.programConfigurations=new Vl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ki,this.maxLineLength=0,this.zOffsetVertexArray=new zd,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:Nn/64}updateFootprints(n,a){}populate(n,a,u,m){this.hasPattern=Q1("line",this.layers,a);const h=this.layers[0].layout.get("line-sort-key");this.hasZOffset=!this.layers[0].isDraped();const v=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&v==="none"&&Bn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const T=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&T!==void 0;const k=[];for(const{feature:O,id:M,index:R,sourceLayerIndex:N}of n){const W=this.layers[0]._featureFilter.needGeometry,Y=pn(O,W);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),Y,u))continue;const ne=h?h.evaluate(Y,{},u):void 0,re={id:M,properties:O.properties,type:O.type,sourceLayerIndex:N,index:R,geometry:W?Y.geometry:It(O,u,m),patterns:{},sortKey:ne};k.push(re)}h&&k.sort((O,M)=>O.sortKey-M.sortKey);const{lineAtlas:L,featureIndex:x}=a,A=this.addConstantDashes(L);for(const O of k){const{geometry:M,index:R,sourceLayerIndex:N}=O;if(A&&this.addFeatureDashes(O,L),this.hasPattern){const W=ex("line",this.layers,O,this.zoom,a);this.patternFeatures.push(W)}else this.addFeature(O,M,R,u,L.positions,a.availableImages,a.brightness);x.insert(n[R].feature,M,R,N,this.index)}}addConstantDashes(n){let a=!1;for(const u of this.layers){const m=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(m.kind!=="constant"||h.kind!=="constant")a=!0;else{const v=h.value,T=m.value;if(!T)continue;n.addDash(T,v)}}return a}addFeatureDashes(n,a){const u=this.zoom;for(const m of this.layers){const h=m.paint.get("line-dasharray").value,v=m.layout.get("line-cap").value;if(h.kind==="constant"&&v.kind==="constant")continue;let T,k;if(h.kind==="constant"){if(T=h.value,!T)continue}else T=h.evaluate({zoom:u},n);k=v.kind==="constant"?v.value:v.evaluate({zoom:u},n),a.addDash(T,k),n.patterns[m.id]=a.getKey(T,k)}}update(n,a,u,m,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,a,v?this.stateDependentLayers:this.layers,u,m,h)}addFeatures(n,a,u,m,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,a,u,m,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,PF)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,OF)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,IF.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,AF),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,u,m,h,v,T){const k=this.layers[0].layout,L=k.get("line-join").evaluate(n,{}),x=k.get("line-cap").evaluate(n,{}),A=k.get("line-miter-limit"),O=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=k.get("line-z-offset").value;for(const M of a)this.addLine(M,n,m,L,x,A,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,m,T)}addLine(n,a,u,m,h,v,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const k=m==="none";if(this.patternJoinNone=this.hasPattern&&k,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<n.length-1;re++)this.totalDistance+=n[re].dist(n[re+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=LF[a.type]==="Polygon";let x=n.length;for(;x>=2&&n[x-1].equals(n[x-2]);)x--;let A=0;for(;A<x-1&&n[A].equals(n[A+1]);)A++;if(x<(L?3:2))return;m==="bevel"&&(v=1.05);const O=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let M,R,N,W,Y,ne;this.e1=this.e2=-1,L&&(M=n[x-2],Y=n[A].sub(M)._unit()._perp());for(let re=A;re<x;re++){if(N=re===x-1?L?n[A+1]:void 0:n[re+1],N&&n[re].equals(N))continue;Y&&(W=Y),M&&(R=M),M=n[re],ne=this.hasZOffset?this.evaluateElevationValue(R?R.dist(M):0):null,Y=N?N.sub(M)._unit()._perp():W,W=W||Y;const J=R&&N;let ue=J?m:L||k?"butt":h;const ve=W.x*Y.x+W.y*Y.y;if(k){const ht=function(pt){if(pt.patternJoinNone){const Tt=pt.segmentPoints.length/2,Ot=pt.lineSoFar-pt.segmentStart;for(let Ft=0;Ft<Tt;++Ft){const Pt=pt.segmentPoints[2*Ft+1],sn=Math.round(pt.segmentPoints[2*Ft])+.5+.25*Pt;pt.patternVertexArray.emplaceBack(sn,Ot,pt.segmentStart),pt.patternVertexArray.emplaceBack(sn,Ot,pt.segmentStart)}pt.segmentPoints.length=0}pt.e1=pt.e2=-1};if(J&&ve<zF){this.updateDistance(R,M),this.addCurrentVertex(M,W,1,1,O,ne),ht(this),this.addCurrentVertex(M,Y,-1,-1,O,ne);continue}if(R){if(!N){this.updateDistance(R,M),this.addCurrentVertex(M,W,1,1,O,ne),ht(this);continue}ue="miter"}}let Ie=W.add(Y);Ie.x===0&&Ie.y===0||Ie._unit();const Ge=Ie.x*Y.x+Ie.y*Y.y,ze=Ge!==0?1/Ge:1/0,$e=2*Math.sqrt(2-2*Ge),st=Ge<DF&&R&&N,Fe=W.x*Y.y-W.y*Y.x>0,rt=this.overscaling<=16?15*Nn/(512*this.overscaling):0;if(J&&ue==="round"){if(ze<T)ue="miter";else if(ze<=2){const ht=hx(M,-10,Nn+10);ue=this.hasZOffset&&(ht||this.hasCrossSlope)?"miter":"fakeround"}}if(ue==="miter"&&ze>v&&(ue="bevel"),ue==="bevel"&&(ze>2&&(ue="flipbevel"),ze<v&&(ue="miter")),R&&!(ue==="miter"&&st)&&this.updateDistance(R,M),ue==="miter")if(st){const ht=M.dist(R);if(ht>2*rt){const Tt=M.sub(M.sub(R)._mult(rt/ht)._round());this.updateDistance(R,Tt),this.addCurrentVertex(Tt,W,0,0,O,ne),R=Tt}this.updateDistance(R,M),Ie._mult(ze),this.addCurrentVertex(M,Ie,0,0,O,ne);const pt=M.dist(N);if(pt>2*rt){const Tt=M.add(N.sub(M)._mult(rt/pt)._round());this.updateDistance(M,Tt),this.addCurrentVertex(Tt,Y,0,0,O,ne),M=Tt}}else Ie._mult(ze),this.addCurrentVertex(M,Ie,0,0,O,ne);else if(ue==="flipbevel"){if(ze>100)Ie=Y.mult(-1);else{const ht=ze*W.add(Y).mag()/W.sub(Y).mag();Ie._perp()._mult(ht*(Fe?-1:1))}this.addCurrentVertex(M,Ie,0,0,O,ne),this.addCurrentVertex(M,Ie.mult(-1),0,0,O,ne)}else if(ue==="bevel"||ue==="fakeround"){ne!=null&&R&&this.addCurrentVertex(M,W,-1,-1,O,ne);const ht=M.dist(R)<=2*rt&&ue!=="bevel",pt=Ie.mult(Fe?1:-1);pt._mult(ze);const Tt=Y.mult(Fe?-1:1),Ot=W.mult(Fe?-1:1),Ft=this.evaluateElevationValue(this.distance);if(ne==null&&(this.addHalfVertex(M,pt.x,pt.y,!1,!Fe,0,O,Ft),ht||this.addHalfVertex(M,pt.x+2*Ot.x,pt.y+2*Ot.y,!1,Fe,0,O,Ft)),ue==="fakeround"){const Pt=Math.round(180*$e/Math.PI/20);this.addHalfVertex(M,Ot.x,Ot.y,!1,Fe,0,O,Ft);for(let sn=0;sn<Pt;sn++){let Cn=sn/Pt;if(Cn!==.5){const Jn=Cn-.5;Cn+=Cn*Jn*(Cn-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*Jn*Jn+(.848013+ve*(.215638*ve-1.06021)))}const Jt=Tt.sub(Ot)._mult(Cn)._add(Ot)._unit();this.addHalfVertex(M,Jt.x,Jt.y,!1,Fe,0,O,Ft)}this.addHalfVertex(M,Tt.x,Tt.y,!1,Fe,0,O,Ft)}ht||ne!=null||this.addHalfVertex(M,pt.x+2*Tt.x,pt.y+2*Tt.y,!1,Fe,0,O,Ft),ne!=null&&N&&this.addCurrentVertex(M,Y,1,1,O,ne)}else ue==="butt"?this.addCurrentVertex(M,Ie,0,0,O,ne):ue==="square"?(R||this.addCurrentVertex(M,Ie,-1,-1,O,ne),this.addCurrentVertex(M,Ie,0,0,O,ne),R&&this.addCurrentVertex(M,Ie,1,1,O,ne)):ue==="round"&&(R&&(this.addCurrentVertex(M,W,0,0,O,ne),this.addCurrentVertex(M,W,1,1,O,ne,!0)),N&&(this.addCurrentVertex(M,Y,-1,-1,O,ne,!0),this.addCurrentVertex(M,Y,0,0,O,ne)))}}addVerticesTo(n,a,u,m,h,v,T,k,L,x){const A=(a.w-n.w)/this.tessellationStep|0;let O=0;const M=this.scaledDistance;if(A>1){this.lineSoFar=n.w;const N=(a.x-n.x)/A,W=(a.y-n.y)/A,Y=(a.z-n.z)/A,ne=(a.w-n.w)/A;for(let re=1;re<A;++re){n.x+=N,n.y+=W,n.z+=Y,this.lineSoFar+=ne,O+=ne;const J=this.evaluateElevationValue(this.prevDistance+O);this.scaledDistance=(this.prevDistance+O)/this.totalDistance,this.addHalfVertex(n,u,m,x,!1,T,L,J),this.addHalfVertex(n,h,v,x,!0,-k,L,J)}}this.lineSoFar=a.w,this.scaledDistance=M;const R=this.evaluateElevationValue(this.distance);this.addHalfVertex(a,u,m,x,!1,T,L,R),this.addHalfVertex(a,h,v,x,!0,-k,L,R)}evaluateElevationValue(n){return this.hasZOffset?this.zOffsetValue.kind==="constant"?this.zOffsetValue.value:(this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):Bn(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0):void 0}addCurrentVertex(n,a,u,m,h,v,T=!1){const k=a.x+a.y*u,L=a.y-a.x*u,x=a.y*m-a.x,A=-a.y-a.x*m;if(v!=null){const M=Nn+10,R=v,N=new nE(n.x,n.y,R,this.lineSoFar),W=hx(n,-10,M),Y=this.lineSoFar,ne=this.distance;if(this.currentVertex)if(W){const re=this.currentVertexIsOutside,J=this.currentVertex,ue=new nE(n.x,n.y,R,this.lineSoFar);if(rE(J,ue,-10,M),!hx(ue,-10,M)){if(re){this.e1=this.e2=-1,this.distance-=J.dist(N),this.lineSoFar=J.w;const ve=this.evaluateElevationValue(J.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(J,k,L,T,!1,u,h,ve),this.addHalfVertex(J,x,A,T,!0,-m,h,ve),this.prevDistance=this.distance}this.distance=this.prevDistance+J.dist(ue),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(J,ue,k,L,x,A,u,m,h,T),this.distance=ne,this.scaledDistance=this.distance/this.totalDistance}}else{const re=this.currentVertex;if(this.currentVertexIsOutside){rE(re,N,-10,M),this.e1=this.e2=-1,this.distance-=re.dist(N),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=re.w;const J=this.evaluateElevationValue(re.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(re,k,L,T,!1,u,h,J),this.addHalfVertex(re,x,A,T,!0,-m,h,J),this.prevDistance=this.distance,this.distance=ne,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(re,N,k,L,x,A,u,m,h,T)}else W||(this.addHalfVertex(n,k,L,T,!1,u,h,v),this.addHalfVertex(n,x,A,T,!0,-m,h,v));this.currentVertex=N,this.currentVertexIsOutside=W,this.lineSoFar=Y}else this.addHalfVertex(n,k,L,T,!1,u,h,v),this.addHalfVertex(n,x,A,T,!0,-m,h,v)}addHalfVertex({x:n,y:a},u,m,h,v,T,k,L){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((n<<1)+(h?1:0),(a<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const x=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),k.primitiveLength++),v?this.e2=x:this.e1=x,L!=null&&this.zOffsetVertexArray.emplaceBack(L)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,a){this.prevDistance=this.distance,this.distance+=n.dist(a),this.updateScaledDistance()}}function hx(c,n,a){return c.x<n||c.x>a||c.y<n||c.y>a}let PE,RE;function OE(c,n,a){return n*(Nn/(c.tileSize*Math.pow(2,a-c.tileID.overscaledZ)))}no(dx,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const LE=(c,n,a)=>(1-a)*c+a*n;function DE(c,n){return 1/OE(c,1,n.tileZoom)}function zE(c,n,a,u){return c.translatePosMatrix(u||n.tileID.projMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const FE=c=>{const n=[];BE(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const a=c.paint.get("line-trim-offset");a[0]===0&&a[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",m=!!c.paint.get("line-pattern").constantOr(1);return u&&m&&n.push("LINE_JOIN_NONE"),n};function BE(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let fx;const NE=()=>fx||(fx={layout:PE||(PE=new ci({"line-cap":new _o(Lt.layout_line["line-cap"]),"line-join":new _o(Lt.layout_line["line-join"]),"line-miter-limit":new Rn(Lt.layout_line["line-miter-limit"]),"line-round-limit":new Rn(Lt.layout_line["line-round-limit"]),"line-sort-key":new _o(Lt.layout_line["line-sort-key"]),"line-z-offset":new _o(Lt.layout_line["line-z-offset"]),"line-elevation-reference":new Rn(Lt.layout_line["line-elevation-reference"]),"line-cross-slope":new Rn(Lt.layout_line["line-cross-slope"]),visibility:new Rn(Lt.layout_line.visibility)})),paint:RE||(RE=new ci({"line-opacity":new _o(Lt.paint_line["line-opacity"]),"line-color":new _o(Lt.paint_line["line-color"]),"line-translate":new Rn(Lt.paint_line["line-translate"]),"line-translate-anchor":new Rn(Lt.paint_line["line-translate-anchor"]),"line-width":new _o(Lt.paint_line["line-width"]),"line-gap-width":new _o(Lt.paint_line["line-gap-width"]),"line-offset":new _o(Lt.paint_line["line-offset"]),"line-blur":new _o(Lt.paint_line["line-blur"]),"line-dasharray":new _o(Lt.paint_line["line-dasharray"]),"line-pattern":new _o(Lt.paint_line["line-pattern"]),"line-gradient":new kd(Lt.paint_line["line-gradient"]),"line-trim-offset":new Rn(Lt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Rn(Lt.paint_line["line-trim-fade-range"]),"line-trim-color":new Rn(Lt.paint_line["line-trim-color"]),"line-emissive-strength":new Rn(Lt.paint_line["line-emissive-strength"]),"line-border-width":new _o(Lt.paint_line["line-border-width"]),"line-border-color":new _o(Lt.paint_line["line-border-color"]),"line-occlusion-opacity":new Rn(Lt.paint_line["line-occlusion-opacity"])}))},fx);class FF extends _o{possiblyEvaluate(n,a){return a=new Ei(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(n,a)}evaluate(n,a,u,m){return a=mo({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,u,m)}}let tv;function $E(c,n){return n>0?n+2*c:c}const BF=Mr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),NF=Mr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),$F=Mr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Mr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const VF=Mr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),UF=Mr([{name:"a_texb",components:2,type:"Uint16"}]),jF=Mr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),HF=Mr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Mr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const VE=Mr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),GF=Mr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Mr([{name:"triangle",components:3,type:"Uint16"}]),Mr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Mr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Mr([{type:"Float32",name:"offsetX"}]),Mr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ba=24;const Pc=128;function px(c,n){const{expression:a}=n;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Ei(c+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:m}=a;let h=0;for(;h<u.length&&u[h]<=c;)h++;h=Math.max(0,h-1);let v=h;for(;v<u.length&&u[v]<c+1;)v++;v=Math.min(u.length-1,v);const T=u[h],k=u[v];return a.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:k,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:k,minSize:a.evaluate(new Ei(T)),maxSize:a.evaluate(new Ei(k)),interpolationType:m}}}function jy(c,{uSize:n,uSizeT:a},{lowerSize:u,upperSize:m}){return c.kind==="source"?u/Pc:c.kind==="composite"?uo(u/Pc,m/Pc,a):n}function kp(c,n,a=1){let u=0,m=0;if(c.kind==="constant")m=c.layoutSize*a;else if(c.kind!=="source"){const{interpolationType:h,minZoom:v,maxZoom:T}=c,k=h?yt(xs.interpolationFactor(h,n,v,T),0,1):0;c.kind==="camera"?m=uo(c.minSize,c.maxSize,k)*a:u=k*a}return{uSizeT:u,uSize:m}}var WF=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Pc,evaluateSizeForFeature:jy,evaluateSizeForZoom:kp,getSizeData:px});function qF(c,n,a){return c.sections.forEach(u=>{u.text=function(m,h,v){const T=h.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),Ss.applyArabicShaping&&(m=Ss.applyArabicShaping(m)),m}(u.text,n,a)}),c}const nv={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function KF(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function ZF(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}var UE,mx,jE,gx={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function YF(){return UE||(UE=1,gx.read=function(c,n,a,u,m){var h,v,T=8*m-u-1,k=(1<<T)-1,L=k>>1,x=-7,A=a?m-1:0,O=a?-1:1,M=c[n+A];for(A+=O,h=M&(1<<-x)-1,M>>=-x,x+=T;x>0;h=256*h+c[n+A],A+=O,x-=8);for(v=h&(1<<-x)-1,h>>=-x,x+=u;x>0;v=256*v+c[n+A],A+=O,x-=8);if(h===0)h=1-L;else{if(h===k)return v?NaN:1/0*(M?-1:1);v+=Math.pow(2,u),h-=L}return(M?-1:1)*v*Math.pow(2,h-u)},gx.write=function(c,n,a,u,m,h){var v,T,k,L=8*h-m-1,x=(1<<L)-1,A=x>>1,O=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=u?0:h-1,R=u?1:-1,N=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(T=isNaN(n)?1:0,v=x):(v=Math.floor(Math.log(n)/Math.LN2),n*(k=Math.pow(2,-v))<1&&(v--,k*=2),(n+=v+A>=1?O/k:O*Math.pow(2,1-A))*k>=2&&(v++,k/=2),v+A>=x?(T=0,v=x):v+A>=1?(T=(n*k-1)*Math.pow(2,m),v+=A):(T=n*Math.pow(2,A-1)*Math.pow(2,m),v=0));m>=8;c[a+M]=255&T,M+=R,T/=256,m-=8);for(v=v<<m|T,L+=m;L>0;c[a+M]=255&v,M+=R,v/=256,L-=8);c[a+M-R]|=128*N}),gx}function HE(){if(jE)return mx;jE=1,mx=n;var c=YF();function n(J){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(J)?J:new Uint8Array(J||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var a=4294967296,u=1/a,m=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(J){return J.type===n.Bytes?J.readVarint()+J.pos:J.pos+1}function v(J,ue,ve){return ve?4294967296*ue+(J>>>0):4294967296*(ue>>>0)+(J>>>0)}function T(J,ue,ve){var Ie=ue<=16383?1:ue<=2097151?2:ue<=268435455?3:Math.floor(Math.log(ue)/(7*Math.LN2));ve.realloc(Ie);for(var Ge=ve.pos-1;Ge>=J;Ge--)ve.buf[Ge+Ie]=ve.buf[Ge]}function k(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeVarint(J[ve])}function L(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeSVarint(J[ve])}function x(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeFloat(J[ve])}function A(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeDouble(J[ve])}function O(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeBoolean(J[ve])}function M(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeFixed32(J[ve])}function R(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeSFixed32(J[ve])}function N(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeFixed64(J[ve])}function W(J,ue){for(var ve=0;ve<J.length;ve++)ue.writeSFixed64(J[ve])}function Y(J,ue){return(J[ue]|J[ue+1]<<8|J[ue+2]<<16)+16777216*J[ue+3]}function ne(J,ue,ve){J[ve]=ue,J[ve+1]=ue>>>8,J[ve+2]=ue>>>16,J[ve+3]=ue>>>24}function re(J,ue){return(J[ue]|J[ue+1]<<8|J[ue+2]<<16)+(J[ue+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(J,ue,ve){for(ve=ve||this.length;this.pos<ve;){var Ie=this.readVarint(),Ge=Ie>>3,ze=this.pos;this.type=7&Ie,J(Ge,ue,this),this.pos===ze&&this.skip(Ie)}return ue},readMessage:function(J,ue){return this.readFields(J,ue,this.readVarint()+this.pos)},readFixed32:function(){var J=Y(this.buf,this.pos);return this.pos+=4,J},readSFixed32:function(){var J=re(this.buf,this.pos);return this.pos+=4,J},readFixed64:function(){var J=Y(this.buf,this.pos)+Y(this.buf,this.pos+4)*a;return this.pos+=8,J},readSFixed64:function(){var J=Y(this.buf,this.pos)+re(this.buf,this.pos+4)*a;return this.pos+=8,J},readFloat:function(){var J=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,J},readDouble:function(){var J=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,J},readVarint:function(J){var ue,ve,Ie=this.buf;return ue=127&(ve=Ie[this.pos++]),ve<128?ue:(ue|=(127&(ve=Ie[this.pos++]))<<7,ve<128?ue:(ue|=(127&(ve=Ie[this.pos++]))<<14,ve<128?ue:(ue|=(127&(ve=Ie[this.pos++]))<<21,ve<128?ue:function(Ge,ze,$e){var st,Fe,rt=$e.buf;if(st=(112&(Fe=rt[$e.pos++]))>>4,Fe<128||(st|=(127&(Fe=rt[$e.pos++]))<<3,Fe<128)||(st|=(127&(Fe=rt[$e.pos++]))<<10,Fe<128)||(st|=(127&(Fe=rt[$e.pos++]))<<17,Fe<128)||(st|=(127&(Fe=rt[$e.pos++]))<<24,Fe<128)||(st|=(1&(Fe=rt[$e.pos++]))<<31,Fe<128))return v(Ge,st,ze);throw new Error("Expected varint not more than 10 bytes")}(ue|=(15&(ve=Ie[this.pos]))<<28,J,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var J=this.readVarint();return J%2==1?(J+1)/-2:J/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var J=this.readVarint()+this.pos,ue=this.pos;return this.pos=J,J-ue>=12&&m?function(ve,Ie,Ge){return m.decode(ve.subarray(Ie,Ge))}(this.buf,ue,J):function(ve,Ie,Ge){for(var ze="",$e=Ie;$e<Ge;){var st,Fe,rt,ht=ve[$e],pt=null,Tt=ht>239?4:ht>223?3:ht>191?2:1;if($e+Tt>Ge)break;Tt===1?ht<128&&(pt=ht):Tt===2?(192&(st=ve[$e+1]))==128&&(pt=(31&ht)<<6|63&st)<=127&&(pt=null):Tt===3?(Fe=ve[$e+2],(192&(st=ve[$e+1]))==128&&(192&Fe)==128&&((pt=(15&ht)<<12|(63&st)<<6|63&Fe)<=2047||pt>=55296&&pt<=57343)&&(pt=null)):Tt===4&&(Fe=ve[$e+2],rt=ve[$e+3],(192&(st=ve[$e+1]))==128&&(192&Fe)==128&&(192&rt)==128&&((pt=(15&ht)<<18|(63&st)<<12|(63&Fe)<<6|63&rt)<=65535||pt>=1114112)&&(pt=null)),pt===null?(pt=65533,Tt=1):pt>65535&&(pt-=65536,ze+=String.fromCharCode(pt>>>10&1023|55296),pt=56320|1023&pt),ze+=String.fromCharCode(pt),$e+=Tt}return ze}(this.buf,ue,J)},readBytes:function(){var J=this.readVarint()+this.pos,ue=this.buf.subarray(this.pos,J);return this.pos=J,ue},readPackedVarint:function(J,ue){if(this.type!==n.Bytes)return J.push(this.readVarint(ue));var ve=h(this);for(J=J||[];this.pos<ve;)J.push(this.readVarint(ue));return J},readPackedSVarint:function(J){if(this.type!==n.Bytes)return J.push(this.readSVarint());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readSVarint());return J},readPackedBoolean:function(J){if(this.type!==n.Bytes)return J.push(this.readBoolean());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readBoolean());return J},readPackedFloat:function(J){if(this.type!==n.Bytes)return J.push(this.readFloat());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readFloat());return J},readPackedDouble:function(J){if(this.type!==n.Bytes)return J.push(this.readDouble());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readDouble());return J},readPackedFixed32:function(J){if(this.type!==n.Bytes)return J.push(this.readFixed32());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readFixed32());return J},readPackedSFixed32:function(J){if(this.type!==n.Bytes)return J.push(this.readSFixed32());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readSFixed32());return J},readPackedFixed64:function(J){if(this.type!==n.Bytes)return J.push(this.readFixed64());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readFixed64());return J},readPackedSFixed64:function(J){if(this.type!==n.Bytes)return J.push(this.readSFixed64());var ue=h(this);for(J=J||[];this.pos<ue;)J.push(this.readSFixed64());return J},skip:function(J){var ue=7&J;if(ue===n.Varint)for(;this.buf[this.pos++]>127;);else if(ue===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ue===n.Fixed32)this.pos+=4;else{if(ue!==n.Fixed64)throw new Error("Unimplemented type: "+ue);this.pos+=8}},writeTag:function(J,ue){this.writeVarint(J<<3|ue)},realloc:function(J){for(var ue=this.length||16;ue<this.pos+J;)ue*=2;if(ue!==this.length){var ve=new Uint8Array(ue);ve.set(this.buf),this.buf=ve,this.length=ue}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(J){this.realloc(4),ne(this.buf,J,this.pos),this.pos+=4},writeSFixed32:function(J){this.realloc(4),ne(this.buf,J,this.pos),this.pos+=4},writeFixed64:function(J){this.realloc(8),ne(this.buf,-1&J,this.pos),ne(this.buf,Math.floor(J*u),this.pos+4),this.pos+=8},writeSFixed64:function(J){this.realloc(8),ne(this.buf,-1&J,this.pos),ne(this.buf,Math.floor(J*u),this.pos+4),this.pos+=8},writeVarint:function(J){(J=+J||0)>268435455||J<0?function(ue,ve){var Ie,Ge;if(ue>=0?(Ie=ue%4294967296|0,Ge=ue/4294967296|0):(Ge=~(-ue/4294967296),4294967295^(Ie=~(-ue%4294967296))?Ie=Ie+1|0:(Ie=0,Ge=Ge+1|0)),ue>=18446744073709552e3||ue<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(ze,$e,st){st.buf[st.pos++]=127&ze|128,ze>>>=7,st.buf[st.pos++]=127&ze|128,ze>>>=7,st.buf[st.pos++]=127&ze|128,ze>>>=7,st.buf[st.pos++]=127&ze|128,st.buf[st.pos]=127&(ze>>>=7)}(Ie,0,ve),function(ze,$e){var st=(7&ze)<<4;$e.buf[$e.pos++]|=st|((ze>>>=3)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze)))))}(Ge,ve)}(J,this):(this.realloc(4),this.buf[this.pos++]=127&J|(J>127?128:0),J<=127||(this.buf[this.pos++]=127&(J>>>=7)|(J>127?128:0),J<=127||(this.buf[this.pos++]=127&(J>>>=7)|(J>127?128:0),J<=127||(this.buf[this.pos++]=J>>>7&127))))},writeSVarint:function(J){this.writeVarint(J<0?2*-J-1:2*J)},writeBoolean:function(J){this.writeVarint(!!J)},writeString:function(J){J=String(J),this.realloc(4*J.length),this.pos++;var ue=this.pos;this.pos=function(Ie,Ge,ze){for(var $e,st,Fe=0;Fe<Ge.length;Fe++){if(($e=Ge.charCodeAt(Fe))>55295&&$e<57344){if(!st){$e>56319||Fe+1===Ge.length?(Ie[ze++]=239,Ie[ze++]=191,Ie[ze++]=189):st=$e;continue}if($e<56320){Ie[ze++]=239,Ie[ze++]=191,Ie[ze++]=189,st=$e;continue}$e=st-55296<<10|$e-56320|65536,st=null}else st&&(Ie[ze++]=239,Ie[ze++]=191,Ie[ze++]=189,st=null);$e<128?Ie[ze++]=$e:($e<2048?Ie[ze++]=$e>>6|192:($e<65536?Ie[ze++]=$e>>12|224:(Ie[ze++]=$e>>18|240,Ie[ze++]=$e>>12&63|128),Ie[ze++]=$e>>6&63|128),Ie[ze++]=63&$e|128)}return ze}(this.buf,J,this.pos);var ve=this.pos-ue;ve>=128&&T(ue,ve,this),this.pos=ue-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(J){this.realloc(4),c.write(this.buf,J,this.pos,!0,23,4),this.pos+=4},writeDouble:function(J){this.realloc(8),c.write(this.buf,J,this.pos,!0,52,8),this.pos+=8},writeBytes:function(J){var ue=J.length;this.writeVarint(ue),this.realloc(ue);for(var ve=0;ve<ue;ve++)this.buf[this.pos++]=J[ve]},writeRawMessage:function(J,ue){this.pos++;var ve=this.pos;J(ue,this);var Ie=this.pos-ve;Ie>=128&&T(ve,Ie,this),this.pos=ve-1,this.writeVarint(Ie),this.pos+=Ie},writeMessage:function(J,ue,ve){this.writeTag(J,n.Bytes),this.writeRawMessage(ue,ve)},writePackedVarint:function(J,ue){ue.length&&this.writeMessage(J,k,ue)},writePackedSVarint:function(J,ue){ue.length&&this.writeMessage(J,L,ue)},writePackedBoolean:function(J,ue){ue.length&&this.writeMessage(J,O,ue)},writePackedFloat:function(J,ue){ue.length&&this.writeMessage(J,x,ue)},writePackedDouble:function(J,ue){ue.length&&this.writeMessage(J,A,ue)},writePackedFixed32:function(J,ue){ue.length&&this.writeMessage(J,M,ue)},writePackedSFixed32:function(J,ue){ue.length&&this.writeMessage(J,R,ue)},writePackedFixed64:function(J,ue){ue.length&&this.writeMessage(J,N,ue)},writePackedSFixed64:function(J,ue){ue.length&&this.writeMessage(J,W,ue)},writeBytesField:function(J,ue){this.writeTag(J,n.Bytes),this.writeBytes(ue)},writeFixed32Field:function(J,ue){this.writeTag(J,n.Fixed32),this.writeFixed32(ue)},writeSFixed32Field:function(J,ue){this.writeTag(J,n.Fixed32),this.writeSFixed32(ue)},writeFixed64Field:function(J,ue){this.writeTag(J,n.Fixed64),this.writeFixed64(ue)},writeSFixed64Field:function(J,ue){this.writeTag(J,n.Fixed64),this.writeSFixed64(ue)},writeVarintField:function(J,ue){this.writeTag(J,n.Varint),this.writeVarint(ue)},writeSVarintField:function(J,ue){this.writeTag(J,n.Varint),this.writeSVarint(ue)},writeStringField:function(J,ue){this.writeTag(J,n.Bytes),this.writeString(ue)},writeFloatField:function(J,ue){this.writeTag(J,n.Fixed32),this.writeFloat(ue)},writeDoubleField:function(J,ue){this.writeTag(J,n.Fixed64),this.writeDouble(ue)},writeBooleanField:function(J,ue){this.writeVarintField(J,!!ue)}},mx}var Hy=S(HE());const vx=3;function XF(c,n,a){n.glyphs=[],c===1&&a.readMessage(JF,n)}function JF(c,n,a){if(c===3){const{id:u,bitmap:m,width:h,height:v,left:T,top:k,advance:L}=a.readMessage(QF,{});n.glyphs.push({id:u,bitmap:new Ud({width:h+2*vx,height:v+2*vx},m),metrics:{width:h,height:v,left:T,top:k,advance:L}})}else c===4?n.ascender=a.readSVarint():c===5&&(n.descender=a.readSVarint())}function QF(c,n,a){c===1?n.id=a.readVarint():c===2?n.bitmap=a.readBytes():c===3?n.width=a.readVarint():c===4?n.height=a.readVarint():c===5?n.left=a.readSVarint():c===6?n.top=a.readSVarint():c===7&&(n.advance=a.readVarint())}const GE=vx,gl={horizontal:1,vertical:2,horizontalOnly:3};class ov{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,a){const u=new ov;return u.scale=n||1,u.fontStack=a,u}static forImage(n){const a=new ov;return a.imageName=n,a}}class Pp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a){const u=new Pp;for(let m=0;m<n.sections.length;m++){const h=n.sections[m];h.image?u.addImageSection(h):u.addTextSection(h,a)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(a,u){let m="";for(let h=0;h<a.length;h++){const v=a.charCodeAt(h+1)||null,T=a.charCodeAt(h-1)||null;m+=!u&&(v&&yg(v)&&!nv[a[h+1]]||T&&yg(T)&&!nv[a[h-1]])||!nv[a[h]]?a[h]:nv[a[h]]}return m}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&Gy[this.text.charCodeAt(u)];u++)n++;let a=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&Gy[this.text.charCodeAt(u)];u--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const u=new Pp;return u.text=this.text.substring(n,a),u.sectionIndex=this.sectionIndex.slice(n,a),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}addTextSection(n,a){this.text+=n.text,this.sections.push(ov.forText(n.scale,n.fontStack||a));const u=this.sections.length-1;for(let m=0;m<n.text.length;++m)this.sectionIndex.push(u)}addImageSection(n){const a=n.image?n.image.namePrimary:"";if(a.length===0)return void Bn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(ov.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Bn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _x(c,n,a,u,m,h,v,T,k,L,x,A,O,M,R){const N=Pp.fromFeature(c,m);A===gl.vertical&&N.verticalizePunctuation(O);let W=[];const Y=function(ve,Ie,Ge,ze,$e,st){if(!ve)return[];const Fe=[],rt=function(Ot,Ft,Pt,sn,Cn,Jt){let Jn=0;for(let Fn=0;Fn<Ot.length();Fn++){const Pn=Ot.getSection(Fn);Jn+=WE(Ot.getCodePoint(Fn),Pn,sn,Cn,Ft,Jt)}return Jn/Math.max(1,Math.ceil(Jn/Pt))}(ve,Ie,Ge,ze,$e,st),ht=ve.text.indexOf("")>=0;let pt=0;for(let Ot=0;Ot<ve.length();Ot++){const Ft=ve.getSection(Ot),Pt=ve.getCodePoint(Ot);if(Gy[Pt]||(pt+=WE(Pt,Ft,ze,$e,Ie,st)),Ot<ve.length()-1){const sn=!((Tt=Pt)<11904||!(go["Bopomofo Extended"](Tt)||go.Bopomofo(Tt)||go["CJK Compatibility Forms"](Tt)||go["CJK Compatibility Ideographs"](Tt)||go["CJK Compatibility"](Tt)||go["CJK Radicals Supplement"](Tt)||go["CJK Strokes"](Tt)||go["CJK Symbols and Punctuation"](Tt)||go["CJK Unified Ideographs Extension A"](Tt)||go["CJK Unified Ideographs"](Tt)||go["Enclosed CJK Letters and Months"](Tt)||go["Halfwidth and Fullwidth Forms"](Tt)||go.Hiragana(Tt)||go["Ideographic Description Characters"](Tt)||go["Kangxi Radicals"](Tt)||go["Katakana Phonetic Extensions"](Tt)||go.Katakana(Tt)||go["Vertical Forms"](Tt)||go["Yi Radicals"](Tt)||go["Yi Syllables"](Tt)));(eB[Pt]||sn||Ft.imageName)&&Fe.push(KE(Ot+1,pt,rt,Fe,tB(Pt,ve.getCodePoint(Ot+1),sn&&ht),!1))}}var Tt;return ZE(KE(ve.length(),pt,rt,Fe,0,!0))}(N,L,h,n,u,M),{processBidirectionalText:ne,processStyledBidirectionalText:re}=Ss;if(ne&&N.sections.length===1){const ve=ne(N.toString(),Y);for(const Ie of ve){const Ge=new Pp;Ge.text=Ie,Ge.sections=N.sections;for(let ze=0;ze<Ie.length;ze++)Ge.sectionIndex.push(0);W.push(Ge)}}else if(re){const ve=re(N.text,N.sectionIndex,Y);for(const Ie of ve){const Ge=new Pp;Ge.text=Ie[0],Ge.sectionIndex=Ie[1],Ge.sections=N.sections,W.push(Ge)}}else W=function(ve,Ie){const Ge=[],ze=ve.text;let $e=0;for(const st of Ie)Ge.push(ve.substring($e,st)),$e=st;return $e<ze.length&&Ge.push(ve.substring($e,ze.length)),Ge}(N,Y);const J=[],ue={positionedLines:J,text:N.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:A,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ve,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt,Ot){let Ft=0,Pt=0,sn=0;const Cn=rt==="right"?1:rt==="left"?0:.5;let Jt=!1;for(const Xn of $e){const io=Xn.getSections();for(const Uo of io){if(Uo.imageName)continue;const Qo=Ie[Uo.fontStack];if(Qo&&(Jt=Qo.ascender!==void 0&&Qo.descender!==void 0,!Jt))break}if(!Jt)break}let Jn=0;for(const Xn of $e){Xn.trim();const io=Xn.getMaxScale(),Uo=(io-1)*ba,Qo={positionedGlyphs:[],lineOffset:0};ve.positionedLines[Jn]=Qo;const er=Qo.positionedGlyphs;let Zo=0;if(!Xn.length()){Pt+=st,++Jn;continue}let lr=0,ar=0;for(let Wr=0;Wr<Xn.length();Wr++){const Bo=Xn.getSection(Wr),Dr=Xn.getSectionIndex(Wr),Br=Xn.getCodePoint(Wr);let mi=Bo.scale,Di=null,qi=null,zi=null,Ii=ba,Ni=0;const Xi=!(ht===gl.horizontal||!Tt&&!Md(Br)||Tt&&(Gy[Br]||(Fn=Br,go.Arabic(Fn)||go["Arabic Supplement"](Fn)||go["Arabic Extended-A"](Fn)||go["Arabic Presentation Forms-A"](Fn)||go["Arabic Presentation Forms-B"](Fn))));if(Bo.imageName){const xa=ze[Bo.imageName];if(!xa)continue;zi=Bo.imageName,ve.iconsInText=ve.iconsInText||!0,qi=xa.paddedRect;const di=xa.displaySize;mi=mi*ba/Ot,Di={width:di[0],height:di[1],left:0,top:-GE,advance:Xi?di[1]:di[0],localGlyph:!1},Ni=Jt?-Di.height*mi:io*ba-17-di[1]*mi,Ii=Di.advance;const Cs=(Xi?di[0]:di[1])*mi-ba*io;Cs>0&&Cs>Zo&&(Zo=Cs)}else{const xa=Ge[Bo.fontStack];if(!xa)continue;xa[Br]&&(qi=xa[Br]);const di=Ie[Bo.fontStack];if(!di)continue;const Cs=di.glyphs[Br];if(!Cs)continue;if(Di=Cs.metrics,Ii=Br!==8203?ba:0,Jt){const zc=di.ascender!==void 0?Math.abs(di.ascender):0,Hl=di.descender!==void 0?Math.abs(di.descender):0,Gl=(zc+Hl)*mi;lr<Gl&&(lr=Gl,ar=(zc-Hl)/2*mi),Ni=-zc*mi}else Ni=(io-mi)*ba-17}Xi?(ve.verticalizable=!0,er.push({glyph:Br,imageName:zi,x:Ft,y:Pt+Ni,vertical:Xi,scale:mi,localGlyph:Di.localGlyph,fontStack:Bo.fontStack,sectionIndex:Dr,metrics:Di,rect:qi}),Ft+=Ii*mi+pt):(er.push({glyph:Br,imageName:zi,x:Ft,y:Pt+Ni,vertical:Xi,scale:mi,localGlyph:Di.localGlyph,fontStack:Bo.fontStack,sectionIndex:Dr,metrics:Di,rect:qi}),Ft+=Di.advance*mi+pt)}er.length!==0&&(sn=Math.max(Ft-pt,sn),Jt?YE(er,Cn,Zo,ar,st*io/2):YE(er,Cn,Zo,0,st/2)),Ft=0;const Qr=st*io+Zo;Qo.lineOffset=Math.max(Zo,Uo),Pt+=Qr,++Jn}var Fn;const Pn=Pt,{horizontalAlign:Sn,verticalAlign:wo}=yx(Fe);(function(Xn,io,Uo,Qo,er,Zo){const lr=(io-Uo)*er,ar=-Zo*Qo;for(const Qr of Xn)for(const Wr of Qr.positionedGlyphs)Wr.x+=lr,Wr.y+=ar})(ve.positionedLines,Cn,Sn,wo,sn,Pn),ve.top+=-wo*Pn,ve.bottom=ve.top+Pn,ve.left+=-Sn*sn,ve.right=ve.left+sn,ve.hasBaseline=Jt}(ue,n,a,u,W,v,T,k,A,L,O,R),!function(ve){for(const Ie of ve)if(Ie.positionedGlyphs.length!==0)return!1;return!0}(J)&&ue}const Gy={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},eB={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function WE(c,n,a,u,m,h){if(n.imageName){const v=u[n.imageName];return v?v.displaySize[0]*n.scale*ba/h+m:0}{const v=a[n.fontStack],T=v&&v.glyphs[c];return T?T.metrics.advance*n.scale+m:0}}function qE(c,n,a,u){const m=Math.pow(c-n,2);return u?c<n?m/2:2*m:m+Math.abs(a)*a}function tB(c,n,a){let u=0;return c===10&&(u-=1e4),a&&(u+=150),c!==40&&c!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function KE(c,n,a,u,m,h){let v=null,T=qE(n,a,m,h);for(const k of u){const L=qE(n-k.x,a,m,h)+k.badness;L<=T&&(v=k,T=L)}return{index:c,x:n,priorBreak:v,badness:T}}function ZE(c){return c?ZE(c.priorBreak).concat(c.index):[]}function yx(c){let n=.5,a=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function YE(c,n,a,u,m){if(!(n||a||u||m))return;const h=c.length-1,v=c[h],T=(v.x+v.metrics.advance*v.scale)*n;for(let k=0;k<=h;k++)c[k].x-=T,c[k].y+=a+u+m}function nB(c,n,a,u){const{horizontalAlign:m,verticalAlign:h}=yx(u),v=a[0]-c.displaySize[0]*m,T=a[1]-c.displaySize[1]*h;return{imagePrimary:c,imageSecondary:n,top:T,bottom:T+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function XE(c,n,a,u,m,h){const v=c.imagePrimary;let T;if(v.content){const W=v.content,Y=v.pixelRatio||1;T=[W[0]/Y,W[1]/Y,v.displaySize[0]-W[2]/Y,v.displaySize[1]-W[3]/Y]}const k=n.left*h,L=n.right*h;let x,A,O,M;a==="width"||a==="both"?(M=m[0]+k-u[3],A=m[0]+L+u[1]):(M=m[0]+(k+L-v.displaySize[0])/2,A=M+v.displaySize[0]);const R=n.top*h,N=n.bottom*h;return a==="height"||a==="both"?(x=m[1]+R-u[0],O=m[1]+N+u[2]):(x=m[1]+(R+N-v.displaySize[1])/2,O=x+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:x,right:A,bottom:O,left:M,collisionPadding:T}}class Gu extends Be{constructor(n,a,u,m,h){super(n,a),this.angle=m,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new Gu(this.x,this.y,this.z,this.angle,this.segment)}}function JE(c,n,a,u,m){if(n.segment===void 0)return!0;let h=n,v=n.segment+1,T=0;for(;T>-a/2;){if(v--,v<0)return!1;T-=c[v].dist(h),h=c[v]}T+=c[v].dist(c[v+1]),v++;const k=[];let L=0;for(;T<a/2;){const x=c[v],A=c[v+1];if(!A)return!1;let O=c[v-1].angleTo(x)-x.angleTo(A);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:T,angleDelta:O}),L+=O;T-k[0].distance>u;)L-=k.shift().angleDelta;if(L>m)return!1;v++,T+=x.dist(A)}return!0}function QE(c){let n=0;for(let a=0;a<c.length-1;a++)n+=c[a].dist(c[a+1]);return n}function eM(c,n,a){return c?.6*n*a:0}function tM(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function oB(c,n,a,u,m,h){const v=eM(a,m,h),T=tM(a,u)*h;let k=0;const L=QE(c)/2;for(let x=0;x<c.length-1;x++){const A=c[x],O=c[x+1],M=A.dist(O);if(k+M>L){const R=(L-k)/M,N=uo(A.x,O.x,R),W=uo(A.y,O.y,R),Y=new Gu(N,W,0,O.angleTo(A),x);return!v||JE(c,Y,T,v,n)?Y:void 0}k+=M}}function rB(c,n,a,u,m,h,v,T,k){const L=eM(u,h,v),x=tM(u,m),A=x*v,O=c[0].x===0||c[0].x===k||c[0].y===0||c[0].y===k;return n-A<n/4&&(n=A+n/4),nM(c,O?n/2*T%n:(x/2+2*h)*v*T%n,n,L,a,A,O,!1,k)}function nM(c,n,a,u,m,h,v,T,k){const L=h/2,x=QE(c);let A=0,O=n-a,M=[];for(let R=0;R<c.length-1;R++){const N=c[R],W=c[R+1],Y=N.dist(W),ne=W.angleTo(N);for(;O+a<A+Y;){O+=a;const re=(O-A)/Y,J=uo(N.x,W.x,re),ue=uo(N.y,W.y,re);if(J>=0&&J<k&&ue>=0&&ue<k&&O-L>=0&&O+L<=x){const ve=new Gu(J,ue,0,ne,R);u&&!JE(c,ve,h,u,m)||M.push(ve)}}A+=Y}return T||M.length||v||(M=nM(c,A/2,a,u,m,h,v,!0,k)),M}function oM(c,n,a,u,m){const h=[];for(let v=0;v<c.length;v++){const T=c[v];let k;for(let L=0;L<T.length-1;L++){let x=T[L],A=T[L+1];x.x<n&&A.x<n||(x.x<n?x=new Be(n,x.y+(n-x.x)/(A.x-x.x)*(A.y-x.y))._round():A.x<n&&(A=new Be(n,x.y+(n-x.x)/(A.x-x.x)*(A.y-x.y))._round()),x.y<a&&A.y<a||(x.y<a?x=new Be(x.x+(a-x.y)/(A.y-x.y)*(A.x-x.x),a)._round():A.y<a&&(A=new Be(x.x+(a-x.y)/(A.y-x.y)*(A.x-x.x),a)._round()),x.x>=u&&A.x>=u||(x.x>=u?x=new Be(u,x.y+(u-x.x)/(A.x-x.x)*(A.y-x.y))._round():A.x>=u&&(A=new Be(u,x.y+(u-x.x)/(A.x-x.x)*(A.y-x.y))._round()),x.y>=m&&A.y>=m||(x.y>=m?x=new Be(x.x+(m-x.y)/(A.y-x.y)*(A.x-x.x),m)._round():A.y>=m&&(A=new Be(x.x+(m-x.y)/(A.y-x.y)*(A.x-x.x),m)._round()),k&&x.equals(k[k.length-1])||(k=[x],h.push(k)),k.push(A)))))}}return h}function rM(c){let n=0,a=0;for(const v of c)n+=v.w*v.h,a=Math.max(a,v.w);c.sort((v,T)=>T.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let m=0,h=0;for(const v of c)for(let T=u.length-1;T>=0;T--){const k=u[T];if(!(v.w>k.w||v.h>k.h)){if(v.x=k.x,v.y=k.y,h=Math.max(h,v.y+v.h),m=Math.max(m,v.x+v.w),v.w===k.w&&v.h===k.h){const L=u.pop();T<u.length&&(u[T]=L)}else v.h===k.h?(k.x+=v.w,k.w-=v.w):v.w===k.w?(k.y+=v.h,k.h-=v.h):(u.push({x:k.x+v.w,y:k.y,w:k.w-v.w,h:v.h}),k.y+=v.h,k.h-=v.h);break}}return{w:m,h,fill:n/(m*h)||0}}no(Gu,"Anchor");const rv=1;class bx{constructor(n,{pixelRatio:a,version:u,stretchX:m,stretchY:h,content:v},T){this.paddedRect=n,this.pixelRatio=a,this.stretchX=m,this.stretchY=h,this.content=v,this.version=u,this.padding=T}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class iM{constructor(n,a,u){const m={},h={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,m,rv,v),this.addImages(a,h,2,v);const{w:T,h:k}=rM(v),L=new Ua({width:T||1,height:k||1});for(const x in n){const A=n[x],O=m[x].paddedRect;Ua.copy(A.data,L,{x:0,y:0},{x:O.x+rv,y:O.y+rv},A.data,u,A.sdf)}for(const x in a){const A=a[x],O=h[x].paddedRect;let M=h[x].padding;const R=O.x+M,N=O.y+M,W=A.data.width,Y=A.data.height;M=M>1?M-1:M,Ua.copy(A.data,L,{x:0,y:0},{x:R,y:N},A.data,u),Ua.copy(A.data,L,{x:0,y:Y-M},{x:R,y:N-M},{width:W,height:M},u),Ua.copy(A.data,L,{x:0,y:0},{x:R,y:N+Y},{width:W,height:M},u),Ua.copy(A.data,L,{x:W-M,y:0},{x:R-M,y:N},{width:M,height:Y},u),Ua.copy(A.data,L,{x:0,y:0},{x:R+W,y:N},{width:M,height:Y},u),Ua.copy(A.data,L,{x:W-M,y:Y-M},{x:R-M,y:N-M},{width:M,height:M},u),Ua.copy(A.data,L,{x:0,y:Y-M},{x:R+W,y:N-M},{width:M,height:M},u),Ua.copy(A.data,L,{x:0,y:0},{x:R+W,y:N+Y},{width:M,height:M},u),Ua.copy(A.data,L,{x:W-M,y:0},{x:R-M,y:N+Y},{width:M,height:M},u)}this.image=L,this.iconPositions=m,this.patternPositions=h}addImages(n,a,u,m){for(const h in n){const v=n[h],T={x:0,y:0,w:v.data.width+2*u,h:v.data.height+2*u};m.push(T),a[h]=new bx(T,v,u),v.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(n,a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>n.hasImage(m,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const m in n.getUpdatedImages(u))this.patchUpdatedImage(this.iconPositions[m],n.getImage(m,u),a),this.patchUpdatedImage(this.patternPositions[m],n.getImage(m,u),a)}patchUpdatedImage(n,a,u){if(!n||!a||n.version===a.version)return;n.version=a.version;const[m,h]=n.tl;u.update(a.data,{position:{x:m,y:h}})}}no(bx,"ImagePosition"),no(iM,"ImageAtlas");const iv=1e20;function aM(c,n,a,u,m,h,v,T,k){for(let L=n;L<n+u;L++)sM(c,a*h+L,h,m,v,T,k);for(let L=a;L<a+m;L++)sM(c,L*h+n,1,u,v,T,k)}function sM(c,n,a,u,m,h,v){h[0]=0,v[0]=-iv,v[1]=iv,m[0]=c[n];for(let T=1,k=0,L=0;T<u;T++){m[T]=c[n+T*a];const x=T*T;do{const A=h[k];L=(m[T]-m[A]+x-A*A)/(T-A)/2}while(L<=v[k]&&--k>-1);k++,h[k]=T,v[k]=L,v[k+1]=iv}for(let T=0,k=0;T<u;T++){for(;v[k+1]<T;)k++;const L=h[k],x=T-L;c[n+T*a]=m[L]+x*x}}const Rc=2,xx={none:0,ideographs:1,all:2};class Rp{constructor(n,a,u){this.requestManager=n,this.localGlyphMode=a,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,a){this.urls[a]=n}getGlyphs(n,a,u){const m=[],h=this.urls[a]||qe.GLYPHS_URL;for(const v in n)for(const T of n[v])m.push({stack:v,id:T});Co(m,({stack:v,id:T},k)=>{let L=this.entries[v];L||(L=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=L.glyphs[T];if(x!==void 0)return void k(null,{stack:v,id:T,glyph:x});if(x=this._tinySDF(L,v,T),x)return L.glyphs[T]=x,void k(null,{stack:v,id:T,glyph:x});const A=Math.floor(T/256);if(256*A>65535)return Bn("glyphs > 65535 not supported"),void k(null,{stack:v,id:T,glyph:x});if(L.ranges[A])return void k(null,{stack:v,id:T,glyph:x});let O=L.requests[A];O||(O=L.requests[A]=[],Rp.loadGlyphRange(v,A,h,this.requestManager,(M,R)=>{if(R){L.ascender=R.ascender,L.descender=R.descender;for(const N in R.glyphs)this._doesCharSupportLocalGlyph(+N)||(L.glyphs[+N]=R.glyphs[+N]);L.ranges[A]=!0}for(const N of O)N(M,R);delete L.requests[A]})),O.push((M,R)=>{M?k(M):R&&k(null,{stack:v,id:T,glyph:R.glyphs[T]||null})})},(v,T)=>{if(v)u(v);else if(T){const k={};for(const{stack:L,id:x,glyph:A}of T)k[L]===void 0&&(k[L]={}),k[L].glyphs===void 0&&(k[L].glyphs={}),k[L].glyphs[x]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},k[L].ascender=this.entries[L].ascender,k[L].descender=this.entries[L].descender;u(null,k)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==xx.none&&(this.localGlyphMode===xx.all?!!this.localFontFamily:!!this.localFontFamily&&(go["CJK Unified Ideographs"](n)||go["Hangul Syllables"](n)||go.Hiragana(n)||go.Katakana(n)||go["CJK Symbols and Punctuation"](n)||go["CJK Unified Ideographs Extension A"](n)||go["CJK Unified Ideographs Extension B"](n)||go.Osage(n)))}_tinySDF(n,a,u){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(u))return;let h=n.tinySDF;if(!h){let N="400";/bold/i.test(a)?N="900":/medium/i.test(a)?N="500":/light/i.test(a)&&(N="200"),h=n.tinySDF=new Rp.TinySDF({fontFamily:m,fontWeight:N,fontSize:24*Rc,buffer:3*Rc,radius:8*Rc}),h.fontWeight=N}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const v=String.fromCodePoint(u),{data:T,width:k,height:L,glyphWidth:x,glyphHeight:A,glyphLeft:O,glyphTop:M,glyphAdvance:R}=h.draw(v);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new Ud({width:k,height:L},T),metrics:{width:x/Rc,height:A/Rc,left:O/Rc,top:M/Rc-27,advance:R/Rc,localGlyph:!0}}}}Rp.loadGlyphRange=function(c,n,a,u,m){const h=256*n,v=h+255,T=u.transformRequest(u.normalizeGlyphsURL(a).replace("{fontstack}",c).replace("{range}",`${h}-${v}`),ac.Glyphs);tu(T,(k,L)=>{if(k)m(k);else if(L){const x={},A=function(O){return new Hy(O).readFields(XF,{})}(L);for(const O of A.glyphs)x[O.id]=O;m(null,{glyphs:x,ascender:A.ascender,descender:A.descender})}})},Rp.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:a=8,cutoff:u=.25,fontFamily:m="sans-serif",fontWeight:h="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=a;const T=this.size=c+4*n,k=this._createCanvas(T),L=this.ctx=k.getContext("2d",{willReadFrequently:!0});L.font=`${v} ${h} ${c}px ${m}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:m,actualBoundingBoxRight:h}=this.ctx.measureText(c),v=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-m))),k=Math.min(this.size-this.buffer,v+Math.ceil(u)),L=T+2*this.buffer,x=k+2*this.buffer,A=Math.max(L*x,0),O=new Uint8ClampedArray(A),M={data:O,width:L,height:x,glyphWidth:T,glyphHeight:k,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(T===0||k===0)return M;const{ctx:R,buffer:N,gridInner:W,gridOuter:Y}=this;R.clearRect(N,N,T,k),R.fillText(c,N,N+v);const ne=R.getImageData(N,N,T,k);Y.fill(iv,0,A),W.fill(0,0,A);for(let re=0;re<k;re++)for(let J=0;J<T;J++){const ue=ne.data[4*(re*T+J)+3]/255;if(ue===0)continue;const ve=(re+N)*L+J+N;if(ue===1)Y[ve]=0,W[ve]=iv;else{const Ie=.5-ue;Y[ve]=Ie>0?Ie*Ie:0,W[ve]=Ie<0?Ie*Ie:0}}aM(Y,0,0,L,x,L,this.f,this.v,this.z),aM(W,N,N,T,k,L,this.f,this.v,this.z);for(let re=0;re<A;re++){const J=Math.sqrt(Y[re])-Math.sqrt(W[re]);O[re]=Math.round(255-255*(J/this.radius+this.cutoff))}return M}};const Hd=rv;function lM(c,n,a,u,m=1){const h=[],v=c.imagePrimary,T=v.pixelRatio,k=v.paddedRect.w-2*Hd,L=v.paddedRect.h-2*Hd,x=(c.right-c.left)*m,A=(c.bottom-c.top)*m,O=v.stretchX||[[0,k]],M=v.stretchY||[[0,L]],R=(Fe,rt)=>Fe+rt[1]-rt[0],N=O.reduce(R,0),W=M.reduce(R,0),Y=k-N,ne=L-W;let re=0,J=N,ue=0,ve=W,Ie=0,Ge=Y,ze=0,$e=ne;if(v.content&&u){const Fe=v.content;re=Wy(O,0,Fe[0]),ue=Wy(M,0,Fe[1]),J=Wy(O,Fe[0],Fe[2]),ve=Wy(M,Fe[1],Fe[3]),Ie=Fe[0]-re,ze=Fe[1]-ue,Ge=Fe[2]-Fe[0]-J,$e=Fe[3]-Fe[1]-ve}const st=(Fe,rt,ht,pt)=>{const Tt=qy(Fe.stretch-re,J,x,c.left*m),Ot=Ky(Fe.fixed-Ie,Ge,Fe.stretch,N),Ft=qy(rt.stretch-ue,ve,A,c.top*m),Pt=Ky(rt.fixed-ze,$e,rt.stretch,W),sn=qy(ht.stretch-re,J,x,c.left*m),Cn=Ky(ht.fixed-Ie,Ge,ht.stretch,N),Jt=qy(pt.stretch-ue,ve,A,c.top*m),Jn=Ky(pt.fixed-ze,$e,pt.stretch,W),Fn=new Be(Tt,Ft),Pn=new Be(sn,Ft),Sn=new Be(sn,Jt),wo=new Be(Tt,Jt),Xn=new Be(Ot/T,Pt/T),io=new Be(Cn/T,Jn/T),Uo=n*Math.PI/180;if(Uo){const Qr=Math.sin(Uo),Wr=Math.cos(Uo),Bo=[Wr,-Qr,Qr,Wr];Fn._matMult(Bo),Pn._matMult(Bo),wo._matMult(Bo),Sn._matMult(Bo)}const Qo=Fe.stretch+Fe.fixed,er=ht.stretch+ht.fixed,Zo=rt.stretch+rt.fixed,lr=pt.stretch+pt.fixed,ar=c.imageSecondary;return{tl:Fn,tr:Pn,bl:wo,br:Sn,texPrimary:{x:v.paddedRect.x+Hd+Qo,y:v.paddedRect.y+Hd+Zo,w:er-Qo,h:lr-Zo},texSecondary:ar?{x:ar.paddedRect.x+Hd+Qo,y:ar.paddedRect.y+Hd+Zo,w:er-Qo,h:lr-Zo}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Xn,pixelOffsetBR:io,minFontScaleX:Ge/T/x,minFontScaleY:$e/T/A,isSDF:a}};if(u&&(v.stretchX||v.stretchY)){const Fe=cM(O,Y,N),rt=cM(M,ne,W);for(let ht=0;ht<Fe.length-1;ht++){const pt=Fe[ht],Tt=Fe[ht+1];for(let Ot=0;Ot<rt.length-1;Ot++)h.push(st(pt,rt[Ot],Tt,rt[Ot+1]))}}else h.push(st({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:L+1}));return h}function Wy(c,n,a){let u=0;for(const m of c)u+=Math.max(n,Math.min(a,m[1]))-Math.max(n,Math.min(a,m[0]));return u}function cM(c,n,a){const u=[{fixed:-Hd,stretch:0}];for(const[m,h]of c){const v=u[u.length-1];u.push({fixed:m-v.stretch,stretch:v.stretch}),u.push({fixed:m-v.stretch,stretch:v.stretch+(h-m)})}return u.push({fixed:n+Hd,stretch:a}),u}function qy(c,n,a,u){return c/n*a+u}function Ky(c,n,a,u){return c-n*a/u}function iB(c,n,a,u){const m=n+c.positionedLines[u].lineOffset;return u===0?a+m/2:a+(m+(n+c.positionedLines[u-1].lineOffset))/2}function aB(c,n=1,a=!1){let u=1/0,m=1/0,h=-1/0,v=-1/0;const T=c[0];for(let M=0;M<T.length;M++){const R=T[M];(!M||R.x<u)&&(u=R.x),(!M||R.y<m)&&(m=R.y),(!M||R.x>h)&&(h=R.x),(!M||R.y>v)&&(v=R.y)}const k=Math.min(h-u,v-m);let L=k/2;const x=new Hs([],sB);if(k===0)return new Be(u,m);for(let M=u;M<h;M+=k)for(let R=m;R<v;R+=k)x.push(new Op(M+L,R+L,L,c));let A=function(M){let R=0,N=0,W=0;const Y=M[0];for(let ne=0,re=Y.length,J=re-1;ne<re;J=ne++){const ue=Y[ne],ve=Y[J],Ie=ue.x*ve.y-ve.x*ue.y;N+=(ue.x+ve.x)*Ie,W+=(ue.y+ve.y)*Ie,R+=3*Ie}return new Op(N/R,W/R,0,M)}(c),O=x.length;for(;x.length;){const M=x.pop();(M.d>A.d||!A.d)&&(A=M,a&&console.log("found best %d after %d probes",Math.round(1e4*M.d)/1e4,O)),M.max-A.d<=n||(L=M.h/2,x.push(new Op(M.p.x-L,M.p.y-L,L,c)),x.push(new Op(M.p.x+L,M.p.y-L,L,c)),x.push(new Op(M.p.x-L,M.p.y+L,L,c)),x.push(new Op(M.p.x+L,M.p.y+L,L,c)),O+=4)}return a&&(console.log(`num probes: ${O}`),console.log(`best distance: ${A.d}`)),A.p}function sB(c,n){return n.max-c.max}class Op{constructor(n,a,u,m){this.p=new Be(n,a),this.h=u,this.d=function(h,v){let T=!1,k=1/0;for(let L=0;L<v.length;L++){const x=v[L];for(let A=0,O=x.length,M=O-1;A<O;M=A++){const R=x[A],N=x[M];R.y>h.y!=N.y>h.y&&h.x<(N.x-R.x)*(h.y-R.y)/(N.y-R.y)+R.x&&(T=!T),k=Math.min(k,Ro(h,R,N))}}return(T?1:-1)*Math.sqrt(k)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const wx=Number.POSITIVE_INFINITY,lB=Math.sqrt(2);function uM(c,[n,a]){let u=0,m=0;if(a===wx){n<0&&(n=0);const h=n/lB;switch(c){case"top-right":case"top-left":m=h-7;break;case"bottom-right":case"bottom-left":m=7-h;break;case"bottom":m=7-n;break;case"top":m=n-7}switch(c){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),a=Math.abs(a),c){case"top-right":case"top-left":case"top":m=a-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-a}switch(c){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,m]}function Sx(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cB(c,n,a,u,m,h,v,T,k,L,x,A,O,M,R){let N=h.textMaxSize.evaluate(n,{},A);N===void 0?N=v*h.textScaleFactor:N*=h.textScaleFactor;const W=c.layers[0].layout,Y=W.get("icon-offset").evaluate(n,{},A),ne=hM(a.horizontal)||a.vertical,re=O.name==="globe",J=ba,ue=v*h.textScaleFactor/J,ve=c.tilePixelRatio*N/J,Ie=(pt=c.overscaling,c.zoom>18&&pt>2&&(pt>>=1),Math.max(Nn/(512*pt),1)*W.get("symbol-spacing")),Ge=W.get("text-padding")*c.tilePixelRatio,ze=W.get("icon-padding")*c.tilePixelRatio,$e=Et(W.get("text-max-angle")),st=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Fe=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",rt=W.get("symbol-placement"),ht=Ie/2;var pt;const Tt=W.get("icon-text-fit").evaluate(n,{},A),Ot=W.get("icon-text-fit-padding").evaluate(n,{},A),Ft=Tt!=="none";let Pt;c.hasAnyIconTextFit===!1&&Ft&&(c.hasAnyIconTextFit=!0),u&&Ft&&(c.allowVerticalPlacement&&a.vertical&&(Pt=XE(u,a.vertical,Tt,Ot,Y,ue)),ne&&(u=XE(u,ne,Tt,Ot,Y,ue)));const sn=(Cn,Jt,Jn)=>{if(Jt.x<0||Jt.x>=Nn||Jt.y<0||Jt.y>=Nn)return;let Fn=null;if(re){const{x:Pn,y:Sn,z:wo}=O.projectTilePoint(Jt.x,Jt.y,Jn);Fn={anchor:new Gu(Pn,Sn,wo,0,void 0),up:O.upVector(Jn,Jt.x,Jt.y)}}(function(Pn,Sn,wo,Xn,io,Uo,Qo,er,Zo,lr,ar,Qr,Wr,Bo,Dr,Br,mi,Di,qi,zi,Ii,Ni,Xi,xa,di,Cs,zc){const Hl=Pn.addToLineVertexArray(Sn,Xn);let Gl,df,Zd,hf,Tv,RI,OI,LI=0,DI=0,zI=0,FI=0,Jx=-1,Qx=-1;const mu={};let BI=Ve("");const ff=wo?wo.anchor:Sn,ew=Zo.layout.get("icon-text-fit").evaluate(Ii,{},di)!=="none";let tw=0,nw=0;if(Zo._unevaluatedLayout.getValue("text-radial-offset")===void 0?[tw,nw]=Zo.layout.get("text-offset").evaluate(Ii,{},di).map(Xs=>Xs*ba):(tw=Zo.layout.get("text-radial-offset").evaluate(Ii,{},di)*ba,nw=wx),Pn.allowVerticalPlacement&&io.vertical){const Xs=io.vertical;if(Dr)RI=Tx(Xs),er&&(OI=Tx(er));else{const Js=Zo.layout.get("text-rotate").evaluate(Ii,{},di)+90;Zd=Zy(lr,ff,Sn,ar,Qr,Wr,Xs,Bo,Js,Br),er&&(hf=Zy(lr,ff,Sn,ar,Qr,Wr,er,Di,Js))}}if(Uo){const Xs=Zo.layout.get("icon-rotate").evaluate(Ii,{},di),Js=lM(Uo,Xs,Xi,ew,Ni.iconScaleFactor),Vp=er?lM(er,Xs,Xi,ew,Ni.iconScaleFactor):void 0;df=Zy(lr,ff,Sn,ar,Qr,Wr,Uo,Di,Xs),LI=4*Js.length;const NI=Pn.iconSizeData;let pf=null;NI.kind==="source"?(pf=[Pc*Zo.layout.get("icon-size").evaluate(Ii,{},di)*Ni.iconScaleFactor],pf[0]>Gd&&Bn(`${Pn.layerIds[0]}: Value for "icon-size" is >= ${av}. Reduce your "icon-size".`)):NI.kind==="composite"&&(pf=[Pc*Ni.compositeIconSizes[0].evaluate(Ii,{},di)*Ni.iconScaleFactor,Pc*Ni.compositeIconSizes[1].evaluate(Ii,{},di)*Ni.iconScaleFactor],(pf[0]>Gd||pf[1]>Gd)&&Bn(`${Pn.layerIds[0]}: Value for "icon-size" is >= ${av}. Reduce your "icon-size".`)),Pn.addSymbols(Pn.icon,Js,pf,zi,qi,Ii,!1,wo,Sn,Hl.lineStartIndex,Hl.lineLength,-1,xa,di,Cs,zc),Jx=Pn.icon.placedSymbolArray.length-1,Vp&&(DI=4*Vp.length,Pn.addSymbols(Pn.icon,Vp,pf,zi,qi,Ii,gl.vertical,wo,Sn,Hl.lineStartIndex,Hl.lineLength,-1,xa,di,Cs,zc),Qx=Pn.icon.placedSymbolArray.length-1)}for(const Xs in io.horizontal){const Js=io.horizontal[Xs];Gl||(BI=Ve(Js.text),Dr?Tv=Tx(Js):Gl=Zy(lr,ff,Sn,ar,Qr,Wr,Js,Bo,Zo.layout.get("text-rotate").evaluate(Ii,{},di),Br));const Vp=Js.positionedLines.length===1;if(zI+=dM(Pn,wo,Sn,Js,Qo,Zo,Dr,Ii,Br,Hl,io.vertical?gl.horizontal:gl.horizontalOnly,Vp?Object.keys(io.horizontal):[Xs],mu,Jx,Ni,xa,di,Cs),Vp)break}io.vertical&&(FI+=dM(Pn,wo,Sn,io.vertical,Qo,Zo,Dr,Ii,Br,Hl,gl.vertical,["vertical"],mu,Qx,Ni,xa,di,Cs));let Yd=-1;const ow=(Xs,Js)=>Xs?Math.max(Xs,Js):Js;Yd=ow(Tv,Yd),Yd=ow(RI,Yd),Yd=ow(OI,Yd);const TN=Yd>-1?1:0;Pn.glyphOffsetArray.length>=65535&&Bn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ii.sortKey!==void 0&&Pn.addToSortKeyRanges(Pn.symbolInstances.length,Ii.sortKey),Pn.symbolInstances.emplaceBack(Sn.x,Sn.y,ff.x,ff.y,ff.z,mu.right>=0?mu.right:-1,mu.center>=0?mu.center:-1,mu.left>=0?mu.left:-1,mu.vertical>=0?mu.vertical:-1,Jx,Qx,BI,Gl!==void 0?Gl:Pn.collisionBoxArray.length,Gl!==void 0?Gl+1:Pn.collisionBoxArray.length,Zd!==void 0?Zd:Pn.collisionBoxArray.length,Zd!==void 0?Zd+1:Pn.collisionBoxArray.length,df!==void 0?df:Pn.collisionBoxArray.length,df!==void 0?df+1:Pn.collisionBoxArray.length,hf||Pn.collisionBoxArray.length,hf?hf+1:Pn.collisionBoxArray.length,ar,zI,FI,LI,DI,TN,0,tw,nw,Yd,0,ew?1:0)})(c,Jt,Fn,Cn,a,u,m,Pt,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,Ge,st,k,0,ze,Fe,Y,n,h,L,x,A,M,R)};if(rt==="line")for(const Cn of oM(n.geometry,0,0,Nn,Nn)){const Jt=rB(Cn,Ie,$e,a.vertical||ne,u,J,ve,c.overscaling,Nn);for(const Jn of Jt)ne&&uB(c,ne.text,ht,Jn)||sn(Cn,Jn,A)}else if(rt==="line-center"){for(const Cn of n.geometry)if(Cn.length>1){const Jt=oB(Cn,$e,a.vertical||ne,u,J,ve);Jt&&sn(Cn,Jt,A)}}else if(n.type==="Polygon")for(const Cn of zy(n.geometry,0)){const Jt=aB(Cn,16);sn(Cn[0],new Gu(Jt.x,Jt.y,0,0,void 0),A)}else if(n.type==="LineString")for(const Cn of n.geometry)sn(Cn,new Gu(Cn[0].x,Cn[0].y,0,0,void 0),A);else if(n.type==="Point")for(const Cn of n.geometry)for(const Jt of Cn)sn([Jt],new Gu(Jt.x,Jt.y,0,0,void 0),A)}const av=255,Gd=av*Pc;function dM(c,n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W,Y){const ne=function(ue,ve,Ie,Ge,ze,$e,st,Fe){const rt=[];if(ve.positionedLines.length===0)return rt;const ht=Ge.layout.get("text-rotate").evaluate($e,{})*Math.PI/180,pt=function(sn){const Cn=sn[0],Jt=sn[1],Jn=Cn*Jt;return Jn>0?[Cn,-Jt]:Jn<0?[-Cn,Jt]:Cn===0?[Jt,Cn]:[Jt,-Cn]}(Ie);let Tt=Math.abs(ve.top-ve.bottom);for(const sn of ve.positionedLines)Tt-=sn.lineOffset;const Ot=ve.positionedLines.length,Ft=Tt/Ot;let Pt=ve.top-Ie[1];for(let sn=0;sn<Ot;++sn){const Cn=ve.positionedLines[sn];Pt=iB(ve,Ft,Pt,sn);for(const Jt of Cn.positionedGlyphs){if(!Jt.rect)continue;const Jn=Jt.rect||{};let Fn=GE+1,Pn=!0,Sn=1,wo=0;if(Jt.imageName){const zi=st[Jt.imageName];if(!zi)continue;if(zi.sdf){Bn("SDF images are not supported in formatted text and will be ignored.");continue}Pn=!1,Sn=zi.pixelRatio,Fn=rv/Sn}const Xn=(ze||Fe)&&Jt.vertical,io=Jt.metrics.advance*Jt.scale/2,Uo=Jt.metrics,Qo=Jt.rect;if(Qo===null)continue;Fe&&ve.verticalizable&&(wo=Jt.imageName?io-Jt.metrics.width*Jt.scale/2:0);const er=ze?[Jt.x+io,Jt.y]:[0,0];let Zo=[0,0],lr=[0,0],ar=!1;ze||(Xn?(lr=[Jt.x+io+pt[0],Jt.y+pt[1]-wo],ar=!0):Zo=[Jt.x+io+Ie[0],Jt.y+Ie[1]-wo]);const Qr=Qo.w*Jt.scale/(Sn*(Jt.localGlyph?Rc:1)),Wr=Qo.h*Jt.scale/(Sn*(Jt.localGlyph?Rc:1));let Bo,Dr,Br,mi;if(Xn){const zi=Jt.y-Pt,Ii=new Be(-io,io-zi),Ni=-Math.PI/2,Xi=new Be(...lr);Bo=new Be(-io+Zo[0],Zo[1]),Bo._rotateAround(Ni,Ii)._add(Xi),Bo.x+=-zi+io,Bo.y-=(Uo.left-Fn)*Jt.scale;const xa=Jt.imageName?Uo.advance*Jt.scale:ba*Jt.scale,di=String.fromCodePoint(Jt.glyph);KF(di)?Bo.x+=(1-Fn)*Jt.scale:ZF(di)?Bo.x+=xa-Uo.height*Jt.scale+(-Fn-1)*Jt.scale:Bo.x+=Jt.imageName||Uo.width+2*Fn===Qo.w&&Uo.height+2*Fn===Qo.h?(xa-Wr)/2:(xa-(Uo.height+2*Fn)*Jt.scale)/2,Dr=new Be(Bo.x,Bo.y-Qr),Br=new Be(Bo.x+Wr,Bo.y),mi=new Be(Bo.x+Wr,Bo.y-Qr)}else{const zi=(Uo.left-Fn)*Jt.scale-io+Zo[0],Ii=(-Uo.top-Fn)*Jt.scale+Zo[1],Ni=zi+Qr,Xi=Ii+Wr;Bo=new Be(zi,Ii),Dr=new Be(Ni,Ii),Br=new Be(zi,Xi),mi=new Be(Ni,Xi)}if(ht){let zi;zi=ze?new Be(0,0):ar?new Be(pt[0],pt[1]):new Be(Ie[0],Ie[1]),Bo._rotateAround(ht,zi),Dr._rotateAround(ht,zi),Br._rotateAround(ht,zi),mi._rotateAround(ht,zi)}const Di=new Be(0,0),qi=new Be(0,0);rt.push({tl:Bo,tr:Dr,bl:Br,br:mi,texPrimary:Jn,texSecondary:void 0,writingMode:ve.writingMode,glyphOffset:er,sectionIndex:Jt.sectionIndex,isSDF:Pn,pixelOffsetTL:Di,pixelOffsetBR:qi,minFontScaleX:0,minFontScaleY:0})}}return rt}(0,u,k,h,v,T,m,c.allowVerticalPlacement),re=c.textSizeData;let J=null;re.kind==="source"?(J=[Pc*h.layout.get("text-size").evaluate(T,{},W)*R.textScaleFactor],J[0]>Gd&&Bn(`${c.layerIds[0]}: Value for "text-size" is >= ${av}. Reduce your "text-size".`)):re.kind==="composite"&&(J=[Pc*R.compositeTextSizes[0].evaluate(T,{},W)*R.textScaleFactor,Pc*R.compositeTextSizes[1].evaluate(T,{},W)*R.textScaleFactor],(J[0]>Gd||J[1]>Gd)&&Bn(`${c.layerIds[0]}: Value for "text-size" is >= ${av}. Reduce your "text-size".`)),c.addSymbols(c.text,ne,J,k,v,T,x,n,a,L.lineStartIndex,L.lineLength,M,N,W,Y,!1);for(const ue of A)O[ue]=c.text.placedSymbolArray.length-1;return 4*ne.length}function hM(c){for(const n in c)return c[n];return null}function Zy(c,n,a,u,m,h,v,T,k,L){let x=v.top,A=v.bottom,O=v.left,M=v.right;const R=v.collisionPadding;if(R&&(O-=R[0],x-=R[1],M+=R[2],A+=R[3]),k){const N=new Be(O,x),W=new Be(M,x),Y=new Be(O,A),ne=new Be(M,A),re=Et(k);let J=new Be(0,0);L&&(J=new Be(L[0],L[1])),N._rotateAround(re,J),W._rotateAround(re,J),Y._rotateAround(re,J),ne._rotateAround(re,J),O=Math.min(N.x,W.x,Y.x,ne.x),M=Math.max(N.x,W.x,Y.x,ne.x),x=Math.min(N.y,W.y,Y.y,ne.y),A=Math.max(N.y,W.y,Y.y,ne.y)}return c.emplaceBack(n.x,n.y,n.z,a.x,a.y,O,x,M,A,T,u,m,h),c.length-1}function Tx(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function uB(c,n,a,u){const m=c.compareText;if(n in m){const h=m[n];for(let v=h.length-1;v>=0;v--)if(u.dist(h[v])<a)return!0}else m[n]=[];return m[n].push(u),!1}function fM(c,n){const a=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,m=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),h=Math.sin(a)*m/Math.sin(Math.max(Math.PI/2-c._pitch-a,.01));let v=Math.sin(c._pitch)*h+m;const T=m*(1/c._horizonShift);return c.elevation&&c.elevation.exaggeration()!==0||(v*=1+Math.max(c.zoom-17,0)),Math.min(1.01*v,T)}function sv(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const a=Math.pow(2,-c.z),u=c.x*a,m=(c.x+1)*a,h=c.y*a,v=(c.y+1)*a,T=Le(u),k=Le(m),L=Ue(h),x=Ue(v),A=n.project(T,L),O=n.project(k,L),M=n.project(k,x),R=n.project(T,x);let N=Math.min(A.x,O.x,M.x,R.x),W=Math.min(A.y,O.y,M.y,R.y),Y=Math.max(A.x,O.x,M.x,R.x),ne=Math.max(A.y,O.y,M.y,R.y);const re=a/16;function J(ve,Ie,Ge,ze,$e,st){const Fe=(Ge+$e)/2,rt=(ze+st)/2,ht=n.project(Le(Fe),Ue(rt)),pt=Math.max(0,N-ht.x,W-ht.y,ht.x-Y,ht.y-ne);N=Math.min(N,ht.x),Y=Math.max(Y,ht.x),W=Math.min(W,ht.y),ne=Math.max(ne,ht.y),pt>re&&(J(ve,ht,Ge,ze,Fe,rt),J(ht,Ie,Fe,rt,$e,st))}J(A,O,u,h,m,h),J(O,M,m,h,m,v),J(M,R,m,v,u,v),J(R,A,u,v,u,h),N-=re,W-=re,Y+=re,ne+=re;const ue=1/Math.max(Y-N,ne-W);return{scale:ue,x:N*ue,y:W*ue,x2:Y*ue,y2:ne*ue,projection:n}}function pM(c,{x:n,y:a},u=0){return new Be(((n-u)*c.scale-c.x)*Nn,(a*c.scale-c.y)*Nn)}const dB=Re.mat4.identity(new Float32Array(16));class Wd{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,a){return{x:0,y:0,z:0}}unproject(n,a){return new j(0,0)}projectTilePoint(n,a,u){return{x:n,y:a,z:0}}locationPoint(n,a,u=!0){return n._coordinatePoint(n.locationCoordinate(a),u)}pixelsPerMeter(n,a){return we(1,n)*a}pixelSpaceConversion(n,a,u){return 1}farthestPixelDistance(n){return fM(n,n.pixelsPerMeter)}pointCoordinate(n,a,u,m){const h=n.horizonLineFromTop(!1),v=new Be(a,Math.max(h,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,m))}pointCoordinate3D(n,a,u){const m=new Be(a,u);if(n.elevation)return n.elevation.pointCoordinate(m);{const h=this.pointCoordinate(n,m.x,m.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(n,a){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,a.x,a.y);const u=n.horizonLineFromTop();return a.y<u}createInversionMatrix(n,a){return dB}createTileMatrix(n,a,u){let m,h,v;const T=u.canonical,k=Re.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const L=sv(T,this);m=1,h=L.x+u.wrap*L.scale,v=L.y,Re.mat4.scale(k,k,[m/L.scale,m/L.scale,n.pixelsPerMeter/a])}else m=a/n.zoomScale(T.z),h=(T.x+Math.pow(2,T.z)*u.wrap)*m,v=T.y*m;return Re.mat4.translate(k,k,[h,v,0]),Re.mat4.scale(k,k,[m/Nn,m/Nn,1]),k}upVector(n,a,u){return[0,0,1]}upVectorScale(n,a,u){return{metersToTile:1}}}class hB extends Wd{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[a,u]=this.parallels=n.parallels||[29.5,45.5],m=Math.sin(Et(a));this.n=(m+Math.sin(Et(u)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(n,a){const{n:u,c:m,r0:h}=this,v=Et(n-this.center[0]),T=Et(a),k=Math.sqrt(m-2*u*Math.sin(T))/u;return{x:k*Math.sin(v*u),y:k*Math.cos(v*u)-h,z:0}}unproject(n,a){const{n:u,c:m,r0:h}=this,v=h+a;let T=Math.atan2(n,Math.abs(v))*Math.sign(v);v*u<0&&(T-=Math.PI*Math.sign(n)*Math.sign(v));const k=Et(this.center[0])*u;T=qn(T,-Math.PI-k,Math.PI-k);const L=yt(Gt(T/u)+this.center[0],-180,180),x=Math.asin(yt((m-(n*n+v*v)*u*u)/(2*u),-1,1)),A=yt(Gt(x),-Ye,Ye);return new j(L,A)}}const lv=1.340264,cv=-.081106,uv=893e-6,dv=.003796,Yy=Math.sqrt(3)/2;class fB extends Wd{project(n,a){a=a/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(Yy*Math.sin(a)),m=u*u,h=m*m*m;return{x:.5*(n*Math.cos(u)/(Yy*(lv+3*cv*m+h*(7*uv+9*dv*m)))/Math.PI+.5),y:1-.5*(u*(lv+cv*m+h*(uv+dv*m))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,m=u*u,h=m*m*m;for(let x,A,O,M=0;M<12&&(A=u*(lv+cv*m+h*(uv+dv*m))-a,O=lv+3*cv*m+h*(7*uv+9*dv*m),x=A/O,u=yt(u-x,-Math.PI/3,Math.PI/3),m=u*u,h=m*m*m,!(Math.abs(x)<1e-12));++M);const v=Yy*n*(lv+3*cv*m+h*(7*uv+9*dv*m))/Math.cos(u),T=Math.asin(Math.sin(u)/Yy),k=yt(180*v/Math.PI,-180,180),L=yt(180*T/Math.PI,-Ye,Ye);return new j(k,L)}}class pB extends Wd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){return{x:.5+n/360,y:.5-a/360,z:0}}unproject(n,a){const u=360*(n-.5),m=yt(360*(.5-a),-Ye,Ye);return new j(u,m)}}const Lp=Math.PI/2;function Xy(c){return Math.tan((Lp+c)/2)}class mB extends Wd{constructor(n){super(n),this.center=n.center||[0,30];const[a,u]=this.parallels=n.parallels||[30,30];let m=Et(a),h=Et(u);this.southernCenter=m+h<0,this.southernCenter&&(m=-m,h=-h);const v=Math.cos(m),T=Xy(m);this.n=m===h?Math.sin(m):Math.log(v/Math.cos(h))/Math.log(Xy(h)/T),this.f=v*Math.pow(Xy(m),this.n)/this.n}project(n,a){a=Et(a),this.southernCenter&&(a=-a),n=Et(n-this.center[0]);const u=1e-6,{n:m,f:h}=this;h>0?a<-Lp+u&&(a=-Lp+u):a>Lp-u&&(a=Lp-u);const v=h/Math.pow(Xy(a),m);let T=v*Math.sin(m*n),k=h-v*Math.cos(m*n);return T=.5*(T/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:T,y:this.southernCenter?k:1-k,z:0}}unproject(n,a){n=(2*n-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:u,f:m}=this,h=m-a,v=Math.sign(h),T=Math.sign(u)*Math.sqrt(n*n+h*h);let k=Math.atan2(n,Math.abs(h))*v;h*u<0&&(k-=Math.PI*Math.sign(n)*v);const L=yt(Gt(k/u)+this.center[0],-180,180),x=yt(Gt(2*Math.atan(Math.pow(m/T,1/u))-Lp),-Ye,Ye);return new j(L,this.southernCenter?-x:x)}}class mM extends Wd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,a){return{x:_e(n),y:Te(a),z:0}}unproject(n,a){const u=Le(n),m=Ue(a);return new j(u,m)}}const gM=Et(Ye);class gB extends Wd{project(n,a){const u=(a=Et(a))*a,m=u*u;return{x:.5*((n=Et(n))*(.8707-.131979*u+m*(m*(.003971*u-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+u*(.015085+m*(.028874*u-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,m=25,h=0,v=u*u;do{v=u*u;const L=v*v;h=(u*(1.007226+v*(.015085+L*(.028874*v-.044475-.005916*L)))-a)/(1.007226+v*(.045255+L*(.259866*v-.311325-.005916*11*L))),u=yt(u-h,-gM,gM)}while(Math.abs(h)>1e-6&&--m>0);v=u*u;const T=yt(Gt(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),k=Gt(u);return new j(T,k)}}const vM=Et(Ye);class vB extends Wd{project(n,a){a=Et(a),n=Et(n);const u=Math.cos(a),m=2/Math.PI,h=Math.acos(u*Math.cos(n/2)),v=Math.sin(h)/h,T=.5*(n*m+2*u*Math.sin(n/2)/v)||0,k=.5*(a+Math.sin(a)/v)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(n,a){let u=n=(2*n-.5)*Math.PI,m=a=(2*(1-a)-1)*Math.PI,h=25;const v=1e-6;let T=0,k=0;do{const L=Math.cos(m),x=Math.sin(m),A=2*x*L,O=x*x,M=L*L,R=Math.cos(u/2),N=Math.sin(u/2),W=2*R*N,Y=N*N,ne=1-M*R*R,re=ne?1/ne:0,J=ne?Math.acos(L*R)*Math.sqrt(1/ne):0,ue=.5*(2*J*L*N+2*u/Math.PI)-n,ve=.5*(J*x+m)-a,Ie=.5*re*(M*Y+J*L*R*O)+1/Math.PI,Ge=re*(W*A/4-J*x*N),ze=.125*re*(A*N-J*x*M*W),$e=.5*re*(O*R+J*Y*L)+.5,st=Ge*ze-$e*Ie;T=(ve*Ge-ue*$e)/st,k=(ue*ze-ve*Ie)/st,u=yt(u-T,-Math.PI,Math.PI),m=yt(m-k,-vM,vM)}while((Math.abs(T)>v||Math.abs(k)>v)&&--h>0);return new j(Gt(u),Gt(m))}}class _M extends Wd{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Et(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){const{scale:u,cosPhi:m}=this;return{x:Et(n)*m*u+.5,y:-Math.sin(Et(a))/m*u+.5,z:0}}unproject(n,a){const{scale:u,cosPhi:m}=this,h=-(a-.5)/u,v=yt(Gt((n-.5)/u)/m,-180,180),T=Math.asin(yt(h*m,-1,1)),k=yt(Gt(T),-Ye,Ye);return new j(v,k)}}class _B extends mM{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,a,u){const m=Gg(n,a,u),h=Ry(fu(u));return Re.vec3.transformMat4(m,m,h),{x:m[0],y:m[1],z:m[2]}}locationPoint(n,a){const u=D(a.lat,a.lng),m=Re.vec3.normalize([],u),h=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(a),n._centerAltitude):n._centerAltitude,v=we(1,0)*Nn*h;Re.vec3.scaleAndAdd(u,u,m,v);const T=Re.mat4.identity(new Float64Array(16));return Re.mat4.multiply(T,n.pixelMatrix,n.globeMatrix),Re.vec3.transformMat4(u,u,T),new Be(u[0],u[1])}pixelsPerMeter(n,a){return we(1,0)*a}pixelSpaceConversion(n,a,u){const m=we(1,n)*a,h=uo(we(1,45)*a,m,u);return this.pixelsPerMeter(n,a)/h}createTileMatrix(n,a,u){const m=q1(fu(u.canonical));return Re.mat4.multiply(new Float64Array(16),n.globeMatrix,m)}createInversionMatrix(n,a){const{center:u}=n,m=Ry(fu(a));return Re.mat4.rotateY(m,m,Et(u.lng)),Re.mat4.rotateX(m,m,Et(u.lat)),Re.mat4.scale(m,m,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(n,a,u,m){return $d(n,a,u,!0)||new vt(0,0)}pointCoordinate3D(n,a,u){const m=this.pointCoordinate(n,a,u,0);return[m.x,m.y,m.z]}isPointAboveHorizon(n,a){return!$d(n,a.x,a.y,!1)}farthestPixelDistance(n){const a=function(m,h){const v=m.cameraToCenterDistance,T=m._centerAltitude*h,k=m._camera,L=m._camera.forward(),x=Re.vec3.add([],Re.vec3.scale([],L,-v),[0,0,T]),A=m.worldSize/(2*Math.PI),O=[0,0,-A],M=m.width/m.height,R=Math.tan(m.fovAboveCenter),N=Re.vec3.scale([],k.up(),R),W=Re.vec3.scale([],k.right(),R*M),Y=Re.vec3.normalize([],Re.vec3.add([],Re.vec3.add([],L,N),W)),ne=[];let re;if(new rs(x,Y).closestPointOnSphere(O,A,ne)){const J=Re.vec3.add([],ne,O),ue=Re.vec3.sub([],J,x);re=Math.cos(m.fovAboveCenter)*Re.vec3.length(ue)}else{const J=Re.vec3.sub([],x,O),ue=Re.vec3.sub([],O,x);Re.vec3.normalize(ue,ue);const ve=Re.vec3.length(J)-A;re=Math.sqrt(ve*(ve+2*A));const Ie=Math.acos(re/(A+ve))-Math.acos(Re.vec3.dot(L,ue));re*=Math.cos(Ie)}return 1.01*re}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=Vd(n.zoom);if(u>0){const m=fM(n,we(1,n.center.lat)*n.worldSize),h=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return uo(a,m+h*(1-Math.cos(v)),Math.pow(u,10))}return a}upVector(n,a,u){return Gg(a,u,n,1)}upVectorScale(n){return{metersToTile:Nd(Py(fu(n)))}}}function yM(c){const n=c.parallels,a=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new mM(c);case"equirectangular":return new pB(c);case"naturalEarth":return new gB(c);case"equalEarth":return new fB(c);case"winkelTripel":return new vB(c);case"albers":return a?new _M(c):new hB(c);case"lambertConformalConic":return a?new _M(c):new mB(c);case"globe":return new _B(c)}throw new Error(`Invalid projection name: ${c.name}`)}const yB=Ap.VectorTileFeature.types,bB=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Jy(c,n,a,u,m,h,v,T,k,L,x,A,O){const M=T?Math.min(Gd,Math.round(T[0])):0,R=T?Math.min(Gd,Math.round(T[1])):0;c.emplaceBack(n,a,Math.round(32*u),Math.round(32*m),h,v,(M<<1)+(k?1:0),R,16*L,16*x,256*A,256*O)}function Qy(c,n,a){c.emplaceBack(n,a)}function e0(c,n,a,u,m,h,v){c.emplaceBack(n,a,u,m,h,v)}function t0(c,n,a,u,m){c.emplaceBack(n,a,u,m),c.emplaceBack(n,a,u,m),c.emplaceBack(n,a,u,m),c.emplaceBack(n,a,u,m)}function xB(c){for(const n of c.sections)if(O1(n.text))return!0;return!1}class Cx{constructor(n){this.layoutVertexArray=new Rd,this.indexArray=new bi,this.programConfigurations=n,this.segments=new ki,this.dynamicLayoutVertexArray=new Tc,this.opacityVertexArray=new Rg,this.placedSymbolArray=new Fg,this.iconTransitioningVertexArray=new hu,this.globeExtVertexArray=new Pg,this.zOffsetVertexArray=new zd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,a,u,m,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,BF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,$F.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,bB,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,UF.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,NF.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,VF.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}no(Cx,"SymbolBuffers");class Ex{constructor(n,a,u){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new u,this.segments=new ki,this.collisionVertexArray=new Ld,this.collisionVertexArrayExt=new Tc}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,jF.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,HF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}no(Ex,"CollisionBuffers");class n0{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Re.mat4.identity([]),this.placementViewportMatrix=Re.mat4.identity([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=px(this.zoom,a["text-size"]),this.iconSizeData=px(this.zoom,a["icon-size"]);const u=this.layers[0].layout,m=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(v=>gl[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Cx(new Vl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new Cx(new Vl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new yy,this.lineVertexArray=new Tp,this.symbolInstances=new Bg}calculateGlyphDependencies(n,a,u,m,h){for(const v of n){const T=v.codePointAt(0);if(T===void 0)break;if(a[T]=!0,m&&h&&T<=65535){const k=nv[v];k&&(a[k.charCodeAt(0)]=!0)}}}updateFootprints(n,a){}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!sx(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,a,u,m){const h=this.layers[0],v=h.layout,T=this.projection.name==="globe",k=v.get("text-font"),L=v.get("text-field"),x=v.get("icon-image"),A=(L.value.kind!=="constant"||L.value.value instanceof la&&!L.value.value.isEmpty()||L.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),O=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,M=v.get("symbol-sort-key");if(this.features=[],!A&&!O)return;const R=a.iconDependencies,N=a.glyphDependencies,W=a.availableImages,Y=new Ei(this.zoom);for(const{feature:ne,id:re,index:J,sourceLayerIndex:ue}of n){const ve=h._featureFilter.needGeometry,Ie=pn(ne,ve);if(!h._featureFilter.filter(Y,Ie,u))continue;if(ve||(Ie.geometry=It(ne,u,m)),T&&ne.type!==1&&u.z<=5){const st=Ie.geometry,Fe=.98078528056,rt=(ht,pt)=>{const Tt=Gg(ht.x,ht.y,u,1),Ot=Gg(pt.x,pt.y,u,1);return Re.vec3.dot(Tt,Ot)<Fe};for(let ht=0;ht<st.length;ht++)st[ht]=en(st[ht],rt)}let Ge,ze;if(A){const st=h.getValueAndResolveTokens("text-field",Ie,u,W),Fe=la.factory(st);xB(Fe)&&(this.hasRTLText=!0),(!this.hasRTLText||Sg()==="unavailable"||this.hasRTLText&&Ss.isParsed())&&(Ge=qF(Fe,h,Ie))}if(O){const st=h.getValueAndResolveTokens("icon-image",Ie,u,W);ze=st instanceof ma?st:ma.fromString(st)}if(!Ge&&!ze)continue;const $e=this.sortFeaturesByKey?M.evaluate(Ie,{},u):void 0;if(this.features.push({id:re,text:Ge,icon:ze,index:J,sourceLayerIndex:ue,geometry:Ie.geometry,properties:ne.properties,type:yB[ne.type],sortKey:$e}),ze&&(R[ze.namePrimary]=!0,ze.nameSecondary&&(R[ze.nameSecondary]=!0)),Ge){const st=k.evaluate(Ie,{},u).join(","),Fe=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(gl.vertical)>=0;for(const rt of Ge.sections)if(rt.image)R[rt.image.namePrimary]=!0;else{const ht=_g(Ge.toString()),pt=rt.fontStack||st,Tt=N[pt]=N[pt]||{};this.calculateGlyphDependencies(rt.text,Tt,Fe,this.allowVerticalPlacement,ht)}}}v.get("symbol-placement")==="line"&&(this.features=function(ne){const re={},J={},ue=[];let ve=0;function Ie(st){ue.push(ne[st]),ve++}function Ge(st,Fe,rt){const ht=J[st];return delete J[st],J[Fe]=ht,ue[ht].geometry[0].pop(),ue[ht].geometry[0]=ue[ht].geometry[0].concat(rt[0]),ht}function ze(st,Fe,rt){const ht=re[Fe];return delete re[Fe],re[st]=ht,ue[ht].geometry[0].shift(),ue[ht].geometry[0]=rt[0].concat(ue[ht].geometry[0]),ht}function $e(st,Fe,rt){const ht=rt?Fe[0][Fe[0].length-1]:Fe[0][0];return`${st}:${ht.x}:${ht.y}`}for(let st=0;st<ne.length;st++){const Fe=ne[st],rt=Fe.geometry,ht=Fe.text?Fe.text.toString():null;if(!ht){Ie(st);continue}const pt=$e(ht,rt),Tt=$e(ht,rt,!0);if(pt in J&&Tt in re&&J[pt]!==re[Tt]){const Ot=ze(pt,Tt,rt),Ft=Ge(pt,Tt,ue[Ot].geometry);delete re[pt],delete J[Tt],J[$e(ht,ue[Ft].geometry,!0)]=Ft,ue[Ot].geometry=null}else pt in J?Ge(pt,Tt,rt):Tt in re?ze(pt,Tt,rt):(Ie(st),re[pt]=ve-1,J[Tt]=ve-1)}return ue.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,re)=>ne.sortKey-re.sortKey)}update(n,a,u,m,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(n,a,T,u,m,h),this.icon.programConfigurations.updatePaintArrays(n,a,T,u,m,h)}updateZOffset(){const n=(h,v,T)=>{u+=v,u>h.length&&h.resize(u);for(let k=-v;k<0;k++)h.emplace(k+u,T)},a=(h,v,T)=>{m+=v,m>h.length&&h.resize(m);for(let k=-v;k<0;k++)h.emplace(k+m,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,m=0;for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:k,numIconVertices:L}=v,x=v.zOffset,A=L>0;if((T>0||k>0)&&(n(this.text.zOffsetVertexArray,T,x),n(this.text.zOffsetVertexArray,k,x)),A){const{placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:M}=v;O>=0&&a(this.icon.zOffsetVertexArray,L,x),M>=0&&a(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,x)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=yM(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:m,y:h}of a)this.lineVertexArray.emplaceBack(m,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,a,u,m,h,v,T,k,L,x,A,O,M,R,N,W){const Y=n.indexArray,ne=n.layoutVertexArray,re=n.globeExtVertexArray,J=n.segments.prepareSegment(4*a.length,ne,Y,this.canOverlap?v.sortKey:void 0),ue=this.glyphOffsetArray.length,ve=J.vertexLength,Ie=this.allowVerticalPlacement&&T===gl.vertical?Math.PI/2:0,Ge=v.text&&v.text.sections;for(let $e=0;$e<a.length;$e++){const{tl:st,tr:Fe,bl:rt,br:ht,texPrimary:pt,texSecondary:Tt,pixelOffsetTL:Ot,pixelOffsetBR:Ft,minFontScaleX:Pt,minFontScaleY:sn,glyphOffset:Cn,isSDF:Jt,sectionIndex:Jn}=a[$e],Fn=J.vertexLength,Pn=Cn[1];if(Jy(ne,L.x,L.y,st.x,Pn+st.y,pt.x,pt.y,u,Jt,Ot.x,Ot.y,Pt,sn),Jy(ne,L.x,L.y,Fe.x,Pn+Fe.y,pt.x+pt.w,pt.y,u,Jt,Ft.x,Ot.y,Pt,sn),Jy(ne,L.x,L.y,rt.x,Pn+rt.y,pt.x,pt.y+pt.h,u,Jt,Ot.x,Ft.y,Pt,sn),Jy(ne,L.x,L.y,ht.x,Pn+ht.y,pt.x+pt.w,pt.y+pt.h,u,Jt,Ft.x,Ft.y,Pt,sn),k){const{x:Sn,y:wo,z:Xn}=k.anchor,[io,Uo,Qo]=k.up;e0(re,Sn,wo,Xn,io,Uo,Qo),e0(re,Sn,wo,Xn,io,Uo,Qo),e0(re,Sn,wo,Xn,io,Uo,Qo),e0(re,Sn,wo,Xn,io,Uo,Qo),t0(n.dynamicLayoutVertexArray,Sn,wo,Xn,Ie)}else t0(n.dynamicLayoutVertexArray,L.x,L.y,L.z,Ie);if(W){const Sn=Tt||pt;Qy(n.iconTransitioningVertexArray,Sn.x,Sn.y),Qy(n.iconTransitioningVertexArray,Sn.x+Sn.w,Sn.y),Qy(n.iconTransitioningVertexArray,Sn.x,Sn.y+Sn.h),Qy(n.iconTransitioningVertexArray,Sn.x+Sn.w,Sn.y+Sn.h)}Y.emplaceBack(Fn,Fn+1,Fn+2),Y.emplaceBack(Fn+1,Fn+2,Fn+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Cn[0]),$e!==a.length-1&&Jn===a[$e+1].sectionIndex||n.programConfigurations.populatePaintArrays(ne.length,v,v.index,{},M,R,N,Ge&&Ge[Jn])}const ze=k?k.anchor:L;n.placedSymbolArray.emplaceBack(ze.x,ze.y,ze.z,L.x,L.y,ue,this.glyphOffsetArray.length-ue,ve,x,A,L.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],T,0,!1,0,O,0)}_commitLayoutVertex(n,a,u,m,h,v,T){n.emplaceBack(a,u,m,h,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(n,a,u,m,h,v,T){const k=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),L=k.vertexLength,x=T.tileAnchorX,A=T.tileAnchorY;for(let M=0;M<4;M++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,a,n.padding,T.zOffset),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Be(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Be(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Be(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Be(n.x1,n.y2)),k.vertexLength+=4;const O=u.indexArray;O.emplaceBack(L,L+1),O.emplaceBack(L+1,L+2),O.emplaceBack(L+2,L+3),O.emplaceBack(L+3,L),k.primitiveLength+=4}_addTextDebugCollisionBoxes(n,a,u,m,h,v){for(let T=m;T<h;T++){const k=u.get(T),L=this.getSymbolInstanceTextSize(n,v,a,T);this._addCollisionDebugVertices(k,L,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,a,u,m,h,v){for(let T=m;T<h;T++){const k=u.get(T),L=this.getSymbolInstanceIconSize(n,a,v.placedIconSymbolIndex);this._addCollisionDebugVertices(k,L,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ex(_p,VE.members,hu),this.iconCollisionBox=new Ex(_p,VE.members,hu);const m=kp(this.iconSizeData,n),h=kp(this.textSizeData,n,u);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(h,n,a,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(h,n,a,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,n,a,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,n,a,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(n,a,u,m){const h=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:m),v=jy(this.textSizeData,n,h)/ba;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,a,u){const m=this.icon.placedSymbolArray.get(u),h=jy(this.iconSizeData,n,m);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(n,a,u,m){n.emplaceBack(a,-u,-u,m),n.emplaceBack(a,u,-u,m),n.emplaceBack(a,u,u,m),n.emplaceBack(a,-u,u,m)}_updateTextDebugCollisionBoxes(n,a,u,m,h,v,T){for(let k=m;k<h;k++){const L=u.get(k),x=this.getSymbolInstanceTextSize(n,v,a,k);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,x,L.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(n,a,u,m,h,v,T){for(let k=m;k<h;k++){const L=u.get(k),x=this.getSymbolInstanceIconSize(n,a,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,x,L.padding,v.zOffset)}}updateCollisionDebugBuffers(n,a,u,m){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=kp(this.iconSizeData,n,m),v=kp(this.textSizeData,n,u);for(let T=0;T<this.symbolInstances.length;T++){const k=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(v,n,a,k.textBoxStartIndex,k.textBoxEndIndex,k,u),this._updateTextDebugCollisionBoxes(v,n,a,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k,u),this._updateIconDebugCollisionBoxes(h,n,a,k.iconBoxStartIndex,k.iconBoxEndIndex,k,m),this._updateIconDebugCollisionBoxes(h,n,a,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,a,u,m,h,v,T,k,L){const x={};if(a<u){const{x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J,featureIndex:ue}=n.get(a);x.textBox={x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J},x.textFeatureIndex=ue}if(m<h){const{x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J,featureIndex:ue}=n.get(m);x.verticalTextBox={x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J},x.verticalTextFeatureIndex=ue}if(v<T){const{x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J,featureIndex:ue}=n.get(v);x.iconBox={x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J},x.iconFeatureIndex=ue}if(k<L){const{x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J,featureIndex:ue}=n.get(k);x.verticalIconBox={x1:A,y1:O,x2:M,y2:R,padding:N,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:J},x.verticalIconFeatureIndex=ue}return x}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,a){const u=n.placedSymbolArray.get(a),m=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<m;h+=4)n.indexArray.emplaceBack(h,h+1,h+2),n.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),u=Math.cos(n),m=[],h=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const k=this.symbolInstances.get(T);m.push(0|Math.round(a*k.tileAnchorX+u*k.tileAnchorY)),h.push(k.featureIndex)}return v.sort((T,k)=>m[T]-m[k]||h[k]-h[T]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,a)=>this.symbolInstances.get(a).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,a){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const u=this.symbolInstances.get(a);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:L}=u;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),h>=0&&h!==m&&this.addIndicesForPlacedSymbol(this.text,h),v>=0&&v!==h&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),L>=0&&this.addIndicesForPlacedSymbol(this.icon,L)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let bM,xM,Mx;no(n0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),n0.addDynamicAttributes=t0;class wM{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:yi,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}no(wM,"FormatSectionOverride",{omit:["defaultValue"]});const Ix=()=>Mx||(Mx={layout:bM||(bM=new ci({"symbol-placement":new Rn(Lt.layout_symbol["symbol-placement"]),"symbol-spacing":new Rn(Lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Rn(Lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _o(Lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Rn(Lt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Rn(Lt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Rn(Lt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Rn(Lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Rn(Lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Rn(Lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Rn(Lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new _o(Lt.layout_symbol["icon-size"]),"icon-size-scale-range":new Rn(Lt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new _o(Lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _o(Lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new _o(Lt.layout_symbol["icon-image"]),"icon-rotate":new _o(Lt.layout_symbol["icon-rotate"]),"icon-padding":new Rn(Lt.layout_symbol["icon-padding"]),"icon-keep-upright":new Rn(Lt.layout_symbol["icon-keep-upright"]),"icon-offset":new _o(Lt.layout_symbol["icon-offset"]),"icon-anchor":new _o(Lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Rn(Lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Rn(Lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Rn(Lt.layout_symbol["text-rotation-alignment"]),"text-field":new _o(Lt.layout_symbol["text-field"]),"text-font":new _o(Lt.layout_symbol["text-font"]),"text-size":new _o(Lt.layout_symbol["text-size"]),"text-size-scale-range":new Rn(Lt.layout_symbol["text-size-scale-range"]),"text-max-width":new _o(Lt.layout_symbol["text-max-width"]),"text-line-height":new _o(Lt.layout_symbol["text-line-height"]),"text-letter-spacing":new _o(Lt.layout_symbol["text-letter-spacing"]),"text-justify":new _o(Lt.layout_symbol["text-justify"]),"text-radial-offset":new _o(Lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Rn(Lt.layout_symbol["text-variable-anchor"]),"text-anchor":new _o(Lt.layout_symbol["text-anchor"]),"text-max-angle":new Rn(Lt.layout_symbol["text-max-angle"]),"text-writing-mode":new Rn(Lt.layout_symbol["text-writing-mode"]),"text-rotate":new _o(Lt.layout_symbol["text-rotate"]),"text-padding":new Rn(Lt.layout_symbol["text-padding"]),"text-keep-upright":new Rn(Lt.layout_symbol["text-keep-upright"]),"text-transform":new _o(Lt.layout_symbol["text-transform"]),"text-offset":new _o(Lt.layout_symbol["text-offset"]),"text-allow-overlap":new Rn(Lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Rn(Lt.layout_symbol["text-ignore-placement"]),"text-optional":new Rn(Lt.layout_symbol["text-optional"]),visibility:new Rn(Lt.layout_symbol.visibility)})),paint:xM||(xM=new ci({"icon-opacity":new _o(Lt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new _o(Lt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new _o(Lt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new _o(Lt.paint_symbol["text-emissive-strength"]),"icon-color":new _o(Lt.paint_symbol["icon-color"]),"icon-halo-color":new _o(Lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new _o(Lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _o(Lt.paint_symbol["icon-halo-blur"]),"icon-translate":new Rn(Lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Rn(Lt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new _o(Lt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new _o(Lt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new _o(Lt.paint_symbol["text-occlusion-opacity"]),"text-color":new _o(Lt.paint_symbol["text-color"],{runtimeType:zr,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new _o(Lt.paint_symbol["text-halo-color"]),"text-halo-width":new _o(Lt.paint_symbol["text-halo-width"]),"text-halo-blur":new _o(Lt.paint_symbol["text-halo-blur"]),"text-translate":new Rn(Lt.paint_symbol["text-translate"]),"text-translate-anchor":new Rn(Lt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Rn(Lt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Rn(Lt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Rn(Lt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Rn(Lt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new _o(Lt.paint_symbol["symbol-z-offset"])}))},Mx);class o0 extends Va{constructor(n,a,u,m){super(n,Ix(),a,u,m),this._colorAdjustmentMatrix=Re.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,a){super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const m=[];for(const h of u)m.indexOf(h)<0&&m.push(h);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,a,u,m){return this._saturation===n&&this._contrast===a&&this._brightnessMin===u&&this._brightnessMax===m||(this._colorAdjustmentMatrix=function(h,v,T,k){h=ke(h),v=Ee(v);const L=Re.mat4.create(),x=h/3,A=1-2*x,O=[A,x,x,0,x,A,x,0,x,x,A,0,0,0,0,1],M=.5-.5*v,R=k-T;return Re.mat4.multiply(L,[R,0,0,0,0,R,0,0,0,0,R,0,T,T,T,1],[v,0,0,0,0,v,0,0,0,0,v,0,M,M,M,1]),Re.mat4.multiply(L,L,O),L}(n,a,u,m),this._saturation=n,this._contrast=a,this._brightnessMin=u,this._brightnessMax=m),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,a,u,m){const h=this.layout.get(n).evaluate(a,{},u,m),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||ip(v.value)||!h?h:function(T,k){return k.replace(/{([^{}]+)}/g,(L,x)=>x in T?String(T[x]):"")}(a.properties,h)}createBucket(n){return new n0(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of Ix().paint.overridableProperties){if(!o0.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),u=new wM(a),m=new pg(u,a.property.specification,this.scope,this.options);let h=null;h=a.value.kind==="constant"||a.value.kind==="source"?new ap("source",m):new Uh("composite",m,a.value.zoomStops,a.value._interpolationType),this.paint._values[n]=new Id(a.property,h,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&o0.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const u=n.get("text-field"),m=Ix().paint.properties[a];let h=!1;const v=T=>{for(const k of T)if(m.overrides&&m.overrides.hasOverride(k))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof la)v(u.value.value.sections);else if(u.value.kind==="source"){const T=L=>{h||(L instanceof Qa&&Ci(L.value)===cc?v(L.value.sections):L instanceof ru?v(L.sections):L.eachChild(T))},k=u.value;k._styleExpression&&T(k._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,a,u){return{config:new Ac(this,{zoom:a,lut:u}),overrideFog:!1}}}let SM,TM,CM,EM;var Ax=Mr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function kx(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Px(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Rx{constructor(n,a,u,m){this.context=n,this.format=u,this.useMipmap=m&&m.useMipmap,this.texture=n.gl.createTexture(),this.update(a,{premultiply:m&&m.premultiply})}update(n,a){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,m=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:h}=this,{gl:v}=h,{x:T,y:k}=a&&a.position?a.position:{x:0,y:0},L=Math.max(T+u,this.size?this.size[0]:0),x=Math.max(k+m,this.size?this.size[1]:0);!this.size||this.size[0]===L&&this.size[1]===x||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!a||a.premultiply!==!1));const A=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&L>0&&x>0){const O=this.useMipmap?Math.floor(Math.log2(Math.max(L,x)))+1:1;v.texStorage2D(v.TEXTURE_2D,O,this.format,L,x),this.size=[L,x]}if(this.size)if(A)v.texSubImage2D(v.TEXTURE_2D,0,T,k,kx(this.format),Px(this.format),n);else{const O=n.data;O&&v.texSubImage2D(v.TEXTURE_2D,0,T,k,u,m,kx(this.format),Px(this.format),O)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,a,u=!1){const{context:m}=this,{gl:h}=m;h.bindTexture(h.TEXTURE_2D,this.texture),n!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),a!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,a),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,a),this.wrapS=a)}bindExtraParam(n,a,u,m){const{context:h}=this,{gl:v}=h;v.bindTexture(v.TEXTURE_2D,this.texture),a!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,a),this.magFilter=a),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),this.wrapS=u),m!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class r0{constructor(n,a){this.context=n,this.texture=a}bind(n,a){const{context:u}=this,{gl:m}=u;m.bindTexture(m.TEXTURE_2D,this.texture),n!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,n),this.minFilter=n),a!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,a),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,a),this.wrapS=a)}}function i0(c,n,a,u,m,h,v,T){const k=[c,n,1,a,u,1,m,h,1],L=[v,T,1],x=Re.mat3.adjoint([],k),[A,O,M]=Re.vec3.transformMat3(L,L,x);return Re.mat3.multiply(k,k,[A,0,0,0,O,0,0,0,M])}function MM(c,n,a,u,m,h,v,T){const k=function(L,x,A,O,M,R,N,W){const Y=i0(0,0,1,0,1,1,0,1),ne=i0(L,x,A,O,M,R,N,W),re=Re.mat3.adjoint([],Y);return Re.mat3.multiply(ne,ne,re)}(c,n,a,u,m,h,v,T);return[k[2]/k[8]/Nn,k[5]/k[8]/Nn]}function a0(c){return[c[0],Math.min(Math.max(c[1],-Ye),Ye)]}class IM extends Kn{constructor(n,a,u,m){super(),this.id=n,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=a,this._dirty=!1}load(n,a){if(this._loaded=a||!1,this.fire(new wt("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=vs(this.map._requestManager.transformRequest(this.url,ac.Image),(u,m)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Bt(u)):m&&(this.image=m instanceof HTMLImageElement?Yt.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new r0(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new wt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof r0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let a=n[0][1],u=n[0][1];for(const h of n)h[1]>u&&(u=h[1]),h[1]<a&&(a=h[1]);const m=(u+a)/2;if(m>Ye?this.onNorthPole=!0:m<-Ye&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=n.map(vt.fromLngLat);this.tileID=function(v){let T=1/0,k=1/0,L=-1/0,x=-1/0;for(const N of v)T=Math.min(T,N.x),k=Math.min(k,N.y),L=Math.max(L,N.x),x=Math.max(x,N.y);const A=Math.max(L-T,x-k),O=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),M=Math.pow(2,O);let R=Math.floor((T+L)/2*M);return R>1&&(R-=1),new ea(O,R,Math.floor((k+x)/2*M))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new wt("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const Y in this.tiles){const ne=this.tiles[Y];ne.state!=="loaded"&&(ne.state="loaded",ne.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const a=sv(new ea(0,0,0),this.map.transform.projection),u=[a.projection.project(this.coordinates[0][0],this.coordinates[0][1]),a.projection.project(this.coordinates[1][0],this.coordinates[1][1]),a.projection.project(this.coordinates[2][0],this.coordinates[2][1]),a.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Y){const ne=Y[1].x-Y[0].x,re=Y[1].y-Y[0].y,J=Y[2].x-Y[1].x,ue=Y[2].y-Y[1].y,ve=Y[3].x-Y[2].x,Ie=Y[3].y-Y[2].y,Ge=Y[0].x-Y[3].x,ze=Y[0].y-Y[3].y,$e=ne*ue-J*re,st=J*Ie-ve*ue,Fe=ve*ze-Ge*Ie,rt=Ge*re-ne*ze;return $e>0&&st>0&&Fe>0&&rt>0||$e<0&&st<0&&Fe<0&&rt<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=sv(this.tileID,this.map.transform.projection),[h,v,T,k]=this.coordinates.map(Y=>{const ne=m.projection.project(Y[0],Y[1]);return pM(m,ne)._round()});this.perspectiveTransform=MM(h.x,h.y,v.x,v.y,T.x,T.y,k.x,k.y);const L=this._boundsArray=new Pd;L.emplaceBack(h.x,h.y,0,0),L.emplaceBack(v.x,v.y,Nn,0),L.emplaceBack(k.x,k.y,0,Nn),L.emplaceBack(T.x,T.y,Nn,Nn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(L,Ax.members),this.boundsSegments=ki.simpleSegment(0,0,4,2);const x=[],A=[a0((O=this.coordinates)[0]),a0(O[1]),a0(O[2]),a0(O[3])];var O;const[M,R,N,W]=function(Y){let ne=Y[0][0],re=ne,J=Y[0][1],ue=J;for(let ve=1;ve<Y.length;ve++)Y[ve][0]<ne?ne=Y[ve][0]:Y[ve][0]>re&&(re=Y[ve][0]),Y[ve][1]<J?J=Y[ve][1]:Y[ve][1]>ue&&(ue=Y[ve][1]);return[ne,J,re-ne,ue-J]}(A);{const Y=new Pd,[ne,re,J,ue]=function(Ot){let Ft=Ot[0].x,Pt=Ft,sn=Ot[0].y,Cn=sn;for(let Jt=1;Jt<Ot.length;Jt++)Ot[Jt].x<Ft?Ft=Ot[Jt].x:Ot[Jt].x>Pt&&(Pt=Ot[Jt].x),Ot[Jt].y<sn?sn=Ot[Jt].y:Ot[Jt].y>Cn&&(Cn=Ot[Jt].y);return[Ft,sn,Pt-Ft,Cn-sn]}(u),ve=Ot=>[(Ot.x-ne)/J,(Ot.y-re)/ue],[Ie,Ge,ze,$e]=u.map(ve),st=function(Ot,Ft,Pt,sn,Cn,Jt,Jn,Fn){const Pn=i0(0,0,1,0,1,1,0,1),Sn=i0(Ot,Ft,Pt,sn,Cn,Jt,Jn,Fn),wo=Re.mat3.adjoint([],Sn);return Re.mat3.multiply(Pn,Pn,wo)}(Ie[0],Ie[1],Ge[0],Ge[1],ze[0],ze[1],$e[0],$e[1]);this.elevatedGlobePerspectiveTransform=MM(Ie[0],Ie[1],Ge[0],Ge[1],ze[0],ze[1],$e[0],$e[1]);const Fe=(Ot,Ft)=>{x.push(Ot.lng);const Pt=Math.round((Ot.lng-M)/N*Nn),sn=Math.round((Ot.lat-R)/W*Nn),Cn=ve(Ft),Jt=Re.vec3.transformMat3([],[Cn[0],Cn[1],1],st),Jn=Math.round(Jt[0]/Jt[2]*Nn),Fn=Math.round(Jt[1]/Jt[2]*Nn);Y.emplaceBack(Pt,sn,Jn,Fn)},rt=u[3].x-u[0].x,ht=u[3].y-u[0].y,pt=u[2].x-u[1].x,Tt=u[2].y-u[1].y;for(let Ot=0;Ot<65;Ot++){const Ft=Ot/64,Pt=[u[0].x+Ft*rt,u[0].y+Ft*ht],sn=[u[1].x+Ft*pt,u[1].y+Ft*Tt],Cn=sn[0]-Pt[0],Jt=sn[1]-Pt[1];for(let Jn=0;Jn<65;Jn++){const Fn=Jn/64,Pn={x:Pt[0]+Cn*Fn,y:Pt[1]+Jt*Fn};Fe(a.projection.unproject(Pn.x,Pn.y),Pn)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(Y,Ax.members)}{this.maxLongitudeTriangleSize=0;let Y=[],ne=new bi;const re=(J,ue,ve)=>{ne.emplaceBack(J,ue,ve);const Ie=x[J],Ge=x[ue],ze=x[ve],$e=Math.min(Math.min(Ie,Ge),ze),st=Math.max(Math.max(Ie,Ge),ze)-$e;st>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=st),Y.push($e+st/2)};for(let J=0;J<64;J++)for(let ue=0;ue<64;ue++){const ve=65*J+ue,Ie=ve+1,Ge=ve+65,ze=Ge+1;re(ve,Ge,Ie),re(Ie,Ge,ze)}[Y,ne]=function(J,ue){const ve=Array.from({length:J.length},(ze,$e)=>$e);ve.sort((ze,$e)=>J[ze]-J[$e]);const Ie=[],Ge=new bi;for(let ze=0;ze<ve.length;ze++){const $e=ve[ze];Ie.push(J[$e]);const st=3*$e,Fe=st+1;Ge.emplaceBack(ue.uint16[st],ue.uint16[Fe],ue.uint16[Fe+1])}return[Ie,Ge]}(Y,ne),this.elevatedGlobeTrianglesCenterLongitudes=Y,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(ne)}this.elevatedGlobeSegments=ki.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,N/Nn,0,W/Nn,0,0,R,M,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const a=this.map.painter.context,u=a.gl;!this._dirty||this.texture instanceof r0||(this.texture?this.texture.update(this.image):(this.texture=new Rx(a,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(a)}loadTile(n,a){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},a(null)):(n.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const a=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!a)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let m=(h=n+180)+360*Math.round((u[0]-h)/360);var h;const v=new ki,T=(A,O)=>{v.segments.push({vertexOffset:0,primitiveOffset:A,vertexLength:a.segments[0].vertexLength,primitiveLength:O,sortKey:void 0,vaos:{}})},k=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-m)<=k){const A=Zt(u,0,u.length,m+k);return A===u.length||T(A,Bs(u,A+1,u.length,m+360-k)-A),v}m<u[0]&&(m+=360);const L=Bs(u,0,u.length,m-k);if(L===u.length)return T(0,u.length),v;T(0,L-0);const x=Zt(u,L+1,u.length,m+k);return x!==u.length&&T(x,u.length-x),v}}const wB=(Math.pow(256,2)-1)/16907520;class AM extends Va{constructor(n,a,u,m){super(n,{layout:CM||(CM=new ci({visibility:new Rn(Lt.layout_raster.visibility)})),paint:EM||(EM=new ci({"raster-opacity":new Rn(Lt.paint_raster["raster-opacity"]),"raster-color":new kd(Lt.paint_raster["raster-color"]),"raster-color-mix":new Rn(Lt.paint_raster["raster-color-mix"]),"raster-color-range":new Rn(Lt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Rn(Lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Rn(Lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Rn(Lt.paint_raster["raster-brightness-max"]),"raster-saturation":new Rn(Lt.paint_raster["raster-saturation"]),"raster-contrast":new Rn(Lt.paint_raster["raster-contrast"]),"raster-resampling":new Rn(Lt.paint_raster["raster-resampling"]),"raster-fade-duration":new Rn(Lt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Rn(Lt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Rn(Lt.paint_raster["raster-array-band"]),"raster-elevation":new Rn(Lt.paint_raster["raster-elevation"])}))},a,u,m),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof IM&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const a=this._transitionablePaint._values["raster-color"].value.expression,[u,m]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(m)||u===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=Wg({expression:a,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,m])}}let kM,PM,RM,OM,LM;class DM extends Va{constructor(n,a,u,m){super(n,{layout:kM||(kM=new ci({visibility:new Rn(Lt["layout_raster-particle"].visibility)})),paint:PM||(PM=new ci({"raster-particle-array-band":new Rn(Lt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Rn(Lt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new kd(Lt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Rn(Lt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Rn(Lt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Rn(Lt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Rn(Lt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Rn(Lt["paint_raster-particle"]["raster-particle-elevation"])}))},a,u,m),this._updateColorRamp(),this.lastInvalidatedAt=Yt.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,a=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Wg({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:a}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Yt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class SB extends Va{constructor(n,a){super(n,{},a,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function Ox(c,n,a){const u=[0,0,1],m=Re.quat.identity([]);return Re.quat.rotateY(m,m,a?-Et(c)+Math.PI:Et(c)),Re.quat.rotateX(m,m,-Et(n)),Re.vec3.transformQuat(u,u,m),Re.vec3.normalize(u,u)}function zM(c,n){const a=s0(c.projection,c.zoom,c.width,c.height),u=function(h,v,T,k,L){const x=new j(T.lng-180*qd,T.lat),A=new j(T.lng+180*qd,T.lat),O=h.project(x.lng,x.lat),M=h.project(A.lng,A.lat),R=-Math.atan2(M.y-O.y,M.x-O.x),N=vt.fromLngLat(T);N.y=yt(N.y,-1+qd,1-qd);const W=N.toLngLat(),Y=h.project(W.lng,W.lat),ne=vt.fromLngLat(W);ne.x+=qd;const re=ne.toLngLat(),J=h.project(re.lng,re.lat),ue=BM(J.x-Y.x,J.y-Y.y,R),ve=vt.fromLngLat(W);ve.y+=qd;const Ie=ve.toLngLat(),Ge=h.project(Ie.lng,Ie.lat),ze=BM(Ge.x-Y.x,Ge.y-Y.y,R),$e=Math.abs(ue.x)/Math.abs(ze.y),st=Re.mat4.identity([]);Re.mat4.rotateZ(st,st,-R*(1-(L?0:k)));const Fe=Re.mat4.identity([]);return Re.mat4.scale(Fe,Fe,[1,1-(1-$e)*k,1]),Fe[4]=-ze.x/ze.y*k,Re.mat4.rotateZ(Fe,Fe,R),Re.mat4.multiply(Fe,st,Fe),Fe}(c.projection,0,c.center,a,n),m=FM(c);return Re.mat4.scale(u,u,[m,m,1]),u}function FM(c){const n=c.projection,a=s0(c.projection,c.zoom,c.width,c.height),u=Lx(n,c.center),m=Lx(n,j.convert(n.center));return Math.pow(2,u*a+(1-a)*m)}function s0(c,n,a,u,m=1/0){const h=c.range;if(!h)return 0;const v=Math.min(m,Math.max(a,u)),T=Math.log(v/1024)/Math.LN2;return kn(h[0]+T,h[1]+T,n)}const qd=1/4e4;function Lx(c,n){const a=yt(n.lat,-Ye,Ye),u=new j(n.lng-180*qd,a),m=new j(n.lng+180*qd,a),h=c.project(u.lng,a),v=c.project(m.lng,a),T=vt.fromLngLat(u),k=vt.fromLngLat(m),L=v.x-h.x,x=v.y-h.y,A=k.x-T.x,O=k.y-T.y,M=Math.sqrt((A*A+O*O)/(L*L+x*x));return Math.log(M)/Math.LN2}function BM(c,n,a){const u=Math.cos(a),m=Math.sin(a);return{x:c*u-n*m,y:c*m+n*u}}function NM(c,n,a){Re.mat4.identity(c),Re.mat4.rotateZ(c,c,Et(n[2])),Re.mat4.rotateX(c,c,Et(n[0])),Re.mat4.rotateY(c,c,Et(n[1])),Re.mat4.scale(c,c,a),Re.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function l0(c,n,a,u,m,h,v,T){const k=[a[0]-n[0],a[1]-n[1],0],L=[u[0]-n[0],u[1]-n[1],0];if(Re.vec3.length(k)<1e-12||Re.vec3.length(L)<1e-12)return Re.quat.identity(c);const x=Re.vec3.cross([],k,L);Re.vec3.normalize(x,x),Re.vec3.subtract(L,u,n),k[2]=(h-m)*T,L[2]=(v-m)*T;const A=k;return Re.vec3.cross(A,k,L),Re.vec3.normalize(A,A),Re.quat.rotationTo(c,x,A)}function Dx(c,n,a=!1){const u=Vd(n.zoom),m=function(h,v,T){const k=v.worldSize,L=[h[12],h[13],h[14]],x=Ue(L[1]/k),A=Le(L[0]/k),O=Re.mat4.identity([]),M=we(1,x)*k,R=we(1,0)*k*Xe(x,v.zoom),N=1/K1(k);let W=R*N;if(T){const J=s0(v.projection,v.zoom,v.width,v.height,1024);W=N*v.projection.pixelSpaceConversion(v.center.lat,k,J)}const Y=D(x,A);Re.vec3.add(Y,Y,Re.vec3.scale([],Re.vec3.normalize([],Y),M*W*L[2]));const ne=function(J){const ue=[J[0],J[1],J[2]];let ve=[0,1,0];const Ie=Re.vec3.cross([],ve,ue);return Re.vec3.cross(ve,ue,Ie),Re.vec3.squaredLength(ve)===0&&(ve=[0,1,0],Re.vec3.cross(Ie,ue,ve)),Re.vec3.normalize(Ie,Ie),Re.vec3.normalize(ve,ve),Re.vec3.normalize(ue,ue),[Ie[0],Ie[1],Ie[2],0,ve[0],ve[1],ve[2],0,ue[0],ue[1],ue[2],0,J[0],J[1],J[2],1]}(Y);Re.mat4.scale(O,O,[W,W,W*M]),Re.mat4.translate(O,O,[-L[0],-L[1],-L[2]]);const re=Re.mat4.multiply([],v.globeMatrix,ne);return Re.mat4.multiply(re,re,O),Re.mat4.multiply(re,re,h),re}(c,n,a);if(u>0){const h=function(v,T){const k=T.worldSize,L=we(1,0)*k*Xe(T.center.lat,T.zoom)/K1(k),x=we(1,T.center.lat)*k,A=Re.mat4.identity([]);return Re.mat4.rotateY(A,A,Et(T.center.lng)),Re.mat4.rotateX(A,A,Et(T.center.lat)),Re.mat4.translate(A,A,[0,0,ya]),Re.mat4.scale(A,A,[L,L,L*x]),Re.mat4.translate(A,A,[T.point.x-.5*k,T.point.y-.5*k,0]),Re.mat4.multiply(A,A,v),Re.mat4.multiply(A,T.globeMatrix,A)}(c,n);return function(v,T,k){const L=(R,N,W)=>{const Y=Re.vec3.length(R),ne=Re.vec3.length(N),re=Hu(R,N,W);return Re.vec3.scale(re,re,1/Re.vec3.length(re)*uo(Y,ne,W))},x=L([v[0],v[1],v[2]],[T[0],T[1],T[2]],k),A=L([v[4],v[5],v[6]],[T[4],T[5],T[6]],k),O=L([v[8],v[9],v[10]],[T[8],T[9],T[10]],k),M=Hu([v[12],v[13],v[14]],[T[12],T[13],T[14]],k);return[x[0],x[1],x[2],0,A[0],A[1],A[2],0,O[0],O[1],O[2],0,M[0],M[1],M[2],1]}(m,h,u)}return m}function $M(c,n,a,u){const m=Fr.projectAabbCorners(u,a);let h=Number.MAX_VALUE,v=-1;for(let L=0;L<m.length;++L){const x=m[L];x[0]=(.5*x[0]+.5)*n.width,x[1]=(.5-.5*x[1])*n.height,x[2]<h&&(v=L,h=x[2])}const T=L=>new Be(m[L][0],m[L][1]);let k;switch(v){case 0:case 6:k=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:k=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:k=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:k=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(hn(c,k))return h}const TB=Mr([{name:"a_pos_3f",components:3,type:"Float32"}]),CB=Mr([{name:"a_color_3f",components:3,type:"Float32"}]),EB=Mr([{name:"a_color_4f",components:4,type:"Float32"}]),MB=Mr([{name:"a_uv_2f",components:2,type:"Float32"}]),IB=Mr([{name:"a_normal_3f",components:3,type:"Float32"}]),AB=Mr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),kB=Mr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),VM={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class c0{constructor(n,a,u,m){this.message=(n?`${n}: `:"")+u,m&&(this.identifier=m),a!=null&&a.__line__&&(this.line=a.__line__)}}function UM(c,n){const a=c.indexOf("://")===-1;try{return new URL(c,a&&n?"http://example.com":void 0),!0}catch{return!1}}class jM{constructor(n,a){this.feature=n,this.instancedDataOffset=a,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class HM{constructor(){this.instancedDataArray=new Qh,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class zx{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,a){}populate(n,a,u,m){this.tileToMeter=lt(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:T,index:k,sourceLayerIndex:L}of n){const x=T??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),A=pn(v,h);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),A,u))continue;const O={id:x,sourceLayerIndex:L,index:k,geometry:h?A.geometry:It(v,u,m),properties:v.properties,type:v.type,patterns:{}},M=this.addFeature(O,O.geometry,A);M&&a.featureIndex.insert(v,O.geometry,k,L,this.index,this.instancesPerModel[M].instancedDataArray.length,Nn/32)}this.lookup=null}update(n,a,u,m){for(const h in this.instancesPerModel){const v=this.instancesPerModel[h];for(const T in n)v.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(v.features[v.idToFeaturesIndex[T]],n[T],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];for(const m of u.features){const h=this.layers[0],v=m.feature,T=this.canonical,k=h.paint.get("model-rotation").evaluate(v,{},T),L=h.paint.get("model-scale").evaluate(v,{},T),x=h.paint.get("model-translation").evaluate(v,{},T);Re.vec3.exactEquals(m.rotation,k)&&Re.vec3.exactEquals(m.scale,L)&&Re.vec3.exactEquals(m.translation,x)||(this.evaluate(m,m.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,a,u,m){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const h=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(sx(this.activeReplacements,h))return!1;this.activeReplacements=h;let v=!1;for(const T in this.instancesPerModel){const k=this.instancesPerModel[T],L=k.instancedDataArray;for(const x of k.features){const A=x.instancedDataOffset,O=x.instancedDataCount;for(let M=0;M<O;M++){const R=16*(M+A);let N=L.float32[R+0];const W=N>Nn;N=W?N-Nn:N;const Y=Math.floor(N),ne=L.float32[R+1];let re=!1;for(const J of this.activeReplacements)if(!iE(J,u,VM.Model,m)&&!(J.min.x>Y||Y>J.max.x||J.min.y>ne||ne>J.max.y)&&(re=dE(uE(Y,ne,n.canonical,J.footprintTileId.canonical),J.footprint),re))break;L.float32[R]=re?N+Nn:N,v=v||re!==W}}}return v}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,AB.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const a of this.modelUris)n.removeModel(a,"")}addFeature(n,a,u){const m=this.layers[0],h=m.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return Bn(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),h;UM(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new HM);const v=this.instancesPerModel[h],T=v.instancedDataArray,k=new jM(u,T.length);for(const L of a)for(const x of L){if(x.x<0||x.x>=Nn||x.y<0||x.y>=Nn)continue;const A=(this.lookupDim-1)/Nn,O=this.lookupDim*(x.y*A|0)+x.x*A|0;if(this.lookup){if(this.lookup[O]!==0)continue;this.lookup[O]=1}this.instanceCount++;const M=T.length;T.resize(M+1),v.instancesEvaluatedElevation.push(0),T.float32[16*M]=x.x,T.float32[16*M+1]=x.y}return k.instancedDataCount=v.instancedDataArray.length-k.instancedDataOffset,k.instancedDataCount>0&&(n.id&&(v.idToFeaturesIndex[n.id]=v.features.length),v.features.push(k),this.evaluate(k,{},v,!1)),h}getModelUris(){return this.modelUris}evaluate(n,a,u,m){const h=this.layers[0],v=n.feature,T=this.canonical,k=n.rotation=h.paint.get("model-rotation").evaluate(v,a,T),L=n.scale=h.paint.get("model-scale").evaluate(v,a,T),x=n.translation=h.paint.get("model-translation").evaluate(v,a,T),A=h.paint.get("model-color").evaluate(v,a,T);A.a=h.paint.get("model-color-mix-intensity").evaluate(v,a,T);const O=[];this.maxVerticalOffset<x[2]&&(this.maxVerticalOffset=x[2]),this.maxScale=Math.max(Math.max(this.maxScale,L[0]),Math.max(L[1],L[2])),NM(O,k,L);const M=Math.round(100*A.a)+A.b/1.05;for(let R=0;R<n.instancedDataCount;++R){const N=n.instancedDataOffset+R,W=16*N,Y=u.instancedDataArray.float32;let ne=0;m&&(ne=Y[W+6]-u.instancesEvaluatedElevation[N]);const re=0|Y[W+1];Y[W]=(0|Y[W])+A.r/1.05,Y[W+1]=re+A.g/1.05,Y[W+2]=M,Y[W+3]=1/(T.z>10?this.tileToMeter:lt(T,re)),Y[W+4]=x[0],Y[W+5]=x[1],Y[W+6]=x[2]+ne,Y[W+7]=O[0],Y[W+8]=O[1],Y[W+9]=O[2],Y[W+10]=O[4],Y[W+11]=O[5],Y[W+12]=O[6],Y[W+13]=O[8],Y[W+14]=O[9],Y[W+15]=O[10],u.instancesEvaluatedElevation[N]=x[2]}}}let GM,WM;no(zx,"ModelBucket",{omit:["layers"]}),no(HM,"PerModelAttributes"),no(jM,"ModelFeature");const lf=64,Dp={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function qM(c,n,a,u,m,h,v,T,k,L=!1){const x=a.zoom,A=a.project(u),O=Xe(u.lat,x),M=1/O;Re.mat4.identity(c),Re.mat4.translate(c,c,[A.x+v[0]*M,A.y+v[1]*M,v[2]]);let R=1,N=1;const W=a.worldSize;if(L){if(a.projection.name==="mercator"){let J=0;a.elevation&&(J=a.elevation.getAtPointOrZero(new vt(A.x/W,A.y/W),0));const ue=Re.vec4.transformMat4([],[A.x,A.y,J,1],a.projMatrix)[3]/a.cameraToCenterDistance;R=ue,N=ue*Xe(a.center.lat,x)}else if(a.projection.name==="globe"){const J=Dx(c,a),ue=Re.mat4.multiply([],a.projMatrix,J),ve=[0,0,0,1];Re.vec4.transformMat4(ve,ve,ue);const Ie=ve[3]/a.cameraToCenterDistance,Ge=Vd(x),ze=a.projection.pixelsPerMeter(u.lat,W)*Xe(u.lat,x),$e=a.projection.pixelsPerMeter(a.center.lat,W)*Xe(a.center.lat,x);R=Ie/uo(ze,et(a.center.lat),Ge),N=Ie*O/ze,R*=$e,N*=$e}}else R=M;Re.mat4.scale(c,c,[R,R,N]);const Y=[...c],ne=n.orientation,re=[];if(NM(re,[ne[0]+m[0],ne[1]+m[1],ne[2]+m[2]],h),Re.mat4.multiply(c,Y,re),T&&a.elevation){let J=0;const ue=[];if(k&&a.elevation){J=function(Ge,ze,$e,st,Fe){const rt=ze.elevation;if(!rt)return 0;const ht=Fr.projectAabbCorners($e,st),pt=we(1,Fe.lat)*ze.worldSize,Tt=function(wo,Xn){const io=[0,0,1],Uo=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Qo of Uo){const er=wo[Qo.corners[0]],Zo=wo[Qo.corners[1]],lr=wo[Qo.corners[2]],ar=[Zo[0]-er[0],Zo[1]-er[1],Xn*(Zo[2]-er[2])],Qr=Re.vec3.cross(ar,ar,[lr[0]-er[0],lr[1]-er[1],Xn*(lr[2]-er[2])]);Re.vec3.normalize(Qr,Qr),Qo.dotProductWithUp=Re.vec3.dot(Qr,io)}return Uo.sort((Qo,er)=>Qo.dotProductWithUp-er.dotProductWithUp),Uo[0].corners}(ht,pt),Ot=ht[Tt[0]],Ft=ht[Tt[1]],Pt=ht[Tt[2]],sn=ht[Tt[3]],Cn=rt.getAtPointOrZero(new vt(Ot[0]/ze.worldSize,Ot[1]/ze.worldSize),0),Jt=rt.getAtPointOrZero(new vt(Ft[0]/ze.worldSize,Ft[1]/ze.worldSize),0),Jn=rt.getAtPointOrZero(new vt(Pt[0]/ze.worldSize,Pt[1]/ze.worldSize),0),Fn=rt.getAtPointOrZero(new vt(sn[0]/ze.worldSize,sn[1]/ze.worldSize),0),Pn=(Cn+Fn)/2,Sn=(Jt+Jn)/2;return Pn>Sn?Jt<Jn?l0(Ge,Ft,sn,Ot,Jt,Fn,Cn,pt):l0(Ge,Pt,Ot,sn,Jn,Cn,Fn,pt):Cn<Fn?l0(Ge,Ot,Ft,Pt,Cn,Jt,Jn,pt):l0(Ge,sn,Pt,Ft,Fn,Jn,Jt,pt),Math.max(Pn,Sn)}(ue,a,n.aabb,c,u);const ve=Re.mat4.fromQuat([],ue),Ie=Re.mat4.multiply([],ve,re);Re.mat4.multiply(c,Y,Ie)}else J=a.elevation.getAtPointOrZero(new vt(A.x/W,A.y/W),0);J!==0&&(c[14]+=J)}}function hv(c,n,a=!1){c.uploaded||(c.gfxTexture=new Rx(n,c.image,a?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function PB(c,n,a){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,TB.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,IB.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,MB.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?CB:EB).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,kB.members,!0)),c.segments=ki.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&hv(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&hv(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&hv(u.normalTexture,n),u.occlusionTexture&&hv(u.occlusionTexture,n,a),u.emissionTexture&&hv(u.emissionTexture,n)}function Fx(c,n,a){if(c.meshes)for(const u of c.meshes)PB(u,n,a);if(c.children)for(const u of c.children)Fx(u,n,a)}function u0(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)u0(n)}function Bx(c){if(c.meshes)for(const a of c.meshes)a.vertexBuffer&&(a.vertexBuffer.destroy(),a.indexBuffer.destroy(),a.normalBuffer&&a.normalBuffer.destroy(),a.texcoordBuffer&&a.texcoordBuffer.destroy(),a.colorBuffer&&a.colorBuffer.destroy(),a.pbrBuffer&&a.pbrBuffer.destroy(),a.segments.destroy(),a.material&&((n=a.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const a of c.children)Bx(a)}class zp{constructor(n,a,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=a,this._offset=u}static create(n,a,u){const m=u||n.findDEMTileFor(a);if(!m||!m.dem)return;const h=m.dem,v=m.tileID,T=1<<a.canonical.z-v.canonical.z;return new zp(m,h.dim/Nn/T,[(a.canonical.x/T-v.canonical.x)*h.dim,(a.canonical.y/T-v.canonical.y)*h.dim])}tileCoordToPixel(n,a){const u=a*this._scale+this._offset[1],m=Math.floor(n*this._scale+this._offset[0]),h=Math.floor(u);return new Be(m,h)}getElevationAt(n,a,u,m){const h=n*this._scale+this._offset[0],v=a*this._scale+this._offset[1],T=Math.floor(h),k=Math.floor(v),L=this._dem;return m=!!m,u?uo(uo(L.get(T,k,m),L.get(T,k+1,m),v-k),uo(L.get(T+1,k,m),L.get(T+1,k+1,m),v-k),h-T):L.get(T,k,m)}getElevationAtPixel(n,a,u){return this._dem.get(n,a,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*we(1,n)*this._dem.stride}}const Nx=new Float32Array(262144),cf=new Uint8Array(262144);function KM(c){let n=0;if(c.meshes)for(const a of c.meshes)n=Math.max(n,a.aabb.max[2]);if(c.children)for(const a of c.children)n=Math.max(n,KM(a));return n}function ZM(c,n,a){if(c.meshes)for(const u of c.meshes){if(u.aabb.min[0]===1/0)continue;const m=Fr.applyTransform(u.aabb,c.matrix);a.insert(n,m.min[0],m.min[1],m.max[0],m.max[1])}if(c.children)for(const u of c.children)ZM(u,n,a)}const YM=["","wall","door","roof","window","lamp","logo"];class XM{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:KM(n)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const a=new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=Fr.applyTransformFast(u.aabb,this.node.matrix),a.encapsulate(u.transformedAabb)),n++;this.aabb=a}return this.aabb}}class d0{constructor(n,a,u,m,h,v,T){this.id=u,this.layers=n,this.layerIds=this.layers.map(k=>k.fqid),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.modelTraits|=Dp.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,m&&(this.modelTraits|=Dp.HasMapboxMeshFeatures),h&&(this.modelTraits|=Dp.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const k of a)this.nodesInfo.push(new XM(k)),ZM(k,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0)}updateFootprints(n,a){for(const u of this.getNodesInfo()){const m=u.node;m.footprint&&a.push({footprint:m.footprint,id:n})}}update(n){const a=Object.keys(n).length!==0;if(a&&!this.stateDependentLayers.length)return;const u=a?this.stateDependentLayers:this.layers;for(const m of u)this.evaluate(m,n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const a=this.getNodesInfo();for(const u of a){const m=u.node;this.uploaded?this.updatePbrBuffer(m):Fx(m,n,!0)}for(const u of a)u0(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let a=!1;if(!n.meshes)return a;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),a=!0);return a}needsReEvaluation(n,a,u){const m=n.transform.projectionOptions,h=n.style.getBrightness(),v=this.brightness!==h;return!!(!this.uploaded||this.dirty||m.name!==this.projection.name||fv(u.paint.get("model-color").value,v)||fv(u.paint.get("model-color-mix-intensity").value,v)||fv(u.paint.get("model-roughness").value,v)||fv(u.paint.get("model-emissive-strength").value,v)||fv(u.paint.get("model-height-based-emissive-strength-multiplier").value,v))&&(this.projection=m,this.brightness=h,!0)}evaluateScale(n,a){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),m=this.id.canonical;for(const h of u){const v=h.feature;h.evaluatedScale=a.paint.get("model-scale").evaluate(v,{},m)}}evaluate(n,a){const u=this.getNodesInfo();for(const m of u){if(!m.node.meshes)continue;const h=m.feature,v=a&&a[h.id],T=m.node.meshes&&m.node.meshes[0].featureData,k=m.evaluatedColor[2],L=m.evaluatedRMEA[2],x=this.id.canonical;if(m.hasTranslucentParts=!1,T){for(let A=0;A<YM.length;A++){const O=YM[A];O.length&&(h.properties.part=O);const M=n.paint.get("model-color").evaluate(h,v,x).toRenderColor(null),R=n.paint.get("model-color-mix-intensity").evaluate(h,v,x);m.evaluatedColor[A]=[M.r,M.g,M.b,R],m.evaluatedRMEA[A][0]=n.paint.get("model-roughness").evaluate(h,v,x),m.evaluatedRMEA[A][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x),m.evaluatedRMEA[A][3]=M.a,m.emissionHeightBasedParams[A]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,v,x),!m.hasTranslucentParts&&M.a<1&&(m.hasTranslucentParts=!0)}delete h.properties.part,OB(m,k!==m.evaluatedColor[2]||L!==m.evaluatedRMEA[2],this.modelTraits)}else m.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x);m.evaluatedScale=n.paint.get("model-scale").evaluate(h,v,x),this.updatePbrBuffer(m.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,a,u,m){const h=n.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||a!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const v=zp.create(n,u,h);if(!v)return;this.modelTraits&Dp.HasMapboxMeshFeatures&&this.updateDEM(n,v,u,m);for(const T of this.getNodesInfo()){const k=T.node;if(!k.footprint||!k.footprint.vertices||!k.footprint.vertices.length)continue;const L=k.footprint.vertices;let x=v.getElevationAt(L[0].x,L[0].y,!0,!0);for(let A=1;A<L.length;A++)x=Math.min(x,v.getElevationAt(L[A].x,L[A].y,!0,!0));k.elevation=x}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=a}}updateDEM(n,a,u,m){let h=a._dem._modifiedForSources[m];if(h===void 0&&(a._dem._modifiedForSources[m]=[],h=a._dem._modifiedForSources[m]),h.includes(u.canonical))return;const v=a._dem.dim;h.push(u.canonical);let T=!1;for(const k of this.getNodesInfo()){const L=k.node;if(!L.footprint||!L.footprint.grid)continue;const x=L.footprint.grid,A=a.tileCoordToPixel(x.min.x,x.min.y),O=a.tileCoordToPixel(x.max.x,x.max.y),M=Math.min(Math.min(v-O.y,A.x),Math.min(A.y,v-O.x));if(M<0)continue;const R=yt(M,2,5);let N=Math.max(0,A.x-R),W=Math.max(0,A.y-R),Y=Math.min(O.x+R,v-1),ne=Math.min(O.y+R,v-1);for(let ve=W;ve<=ne;++ve)for(let Ie=N;Ie<=Y;++Ie)cf[ve*v+Ie]=255;let re=0,J=0;for(let ve=0;ve<x.cellsY;++ve)for(let Ie=0;Ie<x.cellsX;++Ie){if(!x.cells[ve*x.cellsX+Ie])continue;const Ge=a.tileCoordToPixel(x.min.x+Ie/x.xScale,x.min.y+ve/x.yScale),ze=a.tileCoordToPixel(x.min.x+(Ie+1)/x.xScale,x.min.y+(ve+1)/x.yScale);for(let $e=Ge.y;$e<=Math.min(ze.y+1,v-1);++$e)for(let st=Ge.x;st<=Math.min(ze.x+1,v-1);++st)cf[$e*v+st]===255&&(cf[$e*v+st]=0,re+=a.getElevationAtPixel(st,$e),J++)}const ue=re/J;N=Math.max(1,A.x-R),W=Math.max(1,A.y-R),Y=Math.min(O.x+R,v-2),ne=Math.min(O.y+R,v-2),T=!0;for(let ve=W;ve<=ne;++ve)for(let Ie=N;Ie<=Y;++Ie)cf[ve*v+Ie]===0&&(Nx[ve*v+Ie]=a._dem.set(Ie,ve,ue));for(let ve=1;ve<R;++ve){N=Math.max(1,A.x-ve),W=Math.max(1,A.y-ve),Y=Math.min(O.x+ve,v-2),ne=Math.min(O.y+ve,v-2);for(let Ie=W;Ie<=ne;++Ie)for(let Ge=N;Ge<=Y;++Ge){const ze=Ie*v+Ge;if(cf[ze]===255){let $e=0,st=0,Fe=-1,rt=-1;for(let ht=-1;ht<=1;++ht)for(let pt=-1;pt<=1;++pt){const Tt=(Ie+ht)*v+Ge+pt;if(cf[Tt]>=ve)continue;const Ot=Nx[Tt],Ft=Math.abs(Ot);Ft>st&&($e=Ot,st=Ft,Fe=pt,rt=ht)}if(st>.1){const ht=1-(ve+.5*Math.abs(Fe*rt))/R;let pt=a._dem.get(Ge,Ie)+$e*ht;const Tt=a._dem.get(Ge+Fe,Ie+rt),Ot=a._dem.get(Ge-Fe,Ie-rt,!0);(pt-Tt)*(pt-Ot)>0&&(pt=(Tt+Ot)/2),Nx[ze]=a._dem.set(Ge,Ie,pt),cf[ze]=ve}}}}}T&&(a._demTile.needsDEMTextureUpload=!0,a._dem._timestamp=Yt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const a of n)u0(a.node),Bx(a.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(n.toUnwrapped()),m=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const v=m[h].node;m[h].hiddenByReplacement=!!v.footprint&&!u.find(T=>T.footprint===v.footprint)}}getHeightAtTileCoord(n,a){const u=this.getNodesInfo(),m=[],h=[0,0,0],v=Re.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const k=u[T],L=k.node.meshes[0],x=L.transformedAabb;if(n<x.min[0]||a<x.min[1]||n>x.max[0]||a>x.max[1])continue;if(k.node.hidden===!0)return{height:1/0,maxHeight:k.feature.properties.height,hidden:!1,verticalScale:k.evaluatedScale[2]};Re.mat4.invert(v,k.node.matrix),h[0]=n,h[1]=a,Re.vec3.transformMat4(h,h,v);const A=(h[0]-L.aabb.min[0])/(L.aabb.max[0]-L.aabb.min[0])*lf|0,O=Math.min(63,(h[1]-L.aabb.min[1])/(L.aabb.max[1]-L.aabb.min[1])*lf|0)*lf+Math.min(63,A),M=L.heightmap[O];if(!(M<0&&k.node.footprint))return k.hiddenByReplacement?void 0:{height:M,maxHeight:k.feature.properties.height,hidden:!1,verticalScale:k.evaluatedScale[2]};if(k.node.footprint.grid.query(new Be(n,a),new Be(n,a),m),m.length>0)return{height:void 0,maxHeight:k.feature.properties.height,hidden:k.hiddenByReplacement,verticalScale:k.evaluatedScale[2]}}}}function fv(c,n){return!c.isLightConstant&&n}function RB(c,n,a,u,m,h,v,T){let k=(61440&n|(61440&n)>>4)>>8,L=(3840&n|(3840&n)>>4)>>4,x=240&n|(240&n)>>4;a[3]>0&&(k=uo(k,255*a[0],a[3]),L=uo(L,255*a[1],a[3]),x=uo(x,255*a[2],a[3]));const A=k<<8|L,O=x<<8|Math.floor(255*u[3]),M=function(ve){const Ie=yt(ve,0,2);return Math.min(Math.round(.5*Ie*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],R=yt(m[0],0,1),N=yt(m[1],0,1),W=yt(m[2],0,1),Y=yt(m[3],0,1);let ne,re,J,ue;if(R!==N&&v!==h&&N!==R){const ve=v-h;re=1/(ve*(N-R)),J=-(h+ve*R)/(ve*(N-R));const Ie=yt(m[4],-1,1);ue=Math.pow(10,Ie),ne=255*W<<8|255*Y}else ne=65535,re=0,J=1,ue=1;if(c.emplaceBack(A,O,M,ne,re,J,ue),T){const ve=T.length;T.clear();for(let Ie=0;Ie<ve;Ie++)T.emplaceBack(A,O,M,ne,re,J,ue)}}function OB(c,n,a){const u=c.node;let m=0;const h=a&Dp.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===m||!v.featureData)continue;v.featureArray=new bp,v.featureArray.reserve(v.featureData.length);let T=n;for(const k of v.featureData){const L=h?65535&k:k>>16&65535,x=h?k>>16&65535:65535&k,A=(15&x)<8?15&x:0,O=c.evaluatedRMEA[A],M=c.evaluatedColor[A],R=c.emissionHeightBasedParams[A];let N;if(T&&A===2&&u.lights&&(N=new bp,N.resize(10*u.lights.length)),RB(v.featureArray,L,M,O,R,v.aabb.min[2],v.aabb.max[2],N),N&&T){T=!1;const W=u.meshes[u.lightMeshIndex];W.featureArray=N,W.featureArray._trim()}}v.featureArray._trim(),m++}}no(d0,"Tiled3dModelBucket",{omit:["layers"]}),no(XM,"Tiled3dModelFeature");const LB=["id","tile","layer","source","sourceLayer","state"];class pv{constructor(n,a,u,m,h){this.type="Feature",this._vectorTileFeature=n,this._z=a,this._x=u,this._y=m,this.properties=n.properties,this.id=h}clone(){const n=new pv(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state={...this.state}),this.layer&&(n.layer={...this.layer}),this.namespace&&(n.namespace=this.namespace),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const a of LB)this[a]!==void 0&&(n[a]=this[a]);return n}}function JM(c,n,a,u){const m=1<<c.z;n.lat=Ue((u/Nn+c.y)/m),n.lng=Le((a/Nn+c.x)/m)}const DB={circle:class extends Va{constructor(c,n,a,u){super(c,{layout:Lr||(Lr=new ci({"circle-sort-key":new _o(Lt.layout_circle["circle-sort-key"]),visibility:new Rn(Lt.layout_circle.visibility)})),paint:fi||(fi=new ci({"circle-radius":new _o(Lt.paint_circle["circle-radius"]),"circle-color":new _o(Lt.paint_circle["circle-color"]),"circle-blur":new _o(Lt.paint_circle["circle-blur"]),"circle-opacity":new _o(Lt.paint_circle["circle-opacity"]),"circle-translate":new Rn(Lt.paint_circle["circle-translate"]),"circle-translate-anchor":new Rn(Lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Rn(Lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Rn(Lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _o(Lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _o(Lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _o(Lt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Rn(Lt.paint_circle["circle-emissive-strength"])}))},n,a,u)}createBucket(c){return new xn(c)}queryRadius(c){const n=c;return Zr("circle-radius",this,n)+Zr("circle-stroke-width",this,n)+sr(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,a,u,m,h,v,T){const k=Ur(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),L=this.paint.get("circle-radius").evaluate(n,a)+this.paint.get("circle-stroke-width").evaluate(n,a);return kC(c,u,h,v,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",k,L)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,a){const u=AC(this);return{config:new Ac(this,{zoom:n,lut:a}),defines:u,overrideFog:!1}}},heatmap:class extends Va{createBucket(c){return new RC(c)}constructor(c,n,a,u){super(c,{layout:OC||(OC=new ci({visibility:new Rn(Lt.layout_heatmap.visibility)})),paint:LC||(LC=new ci({"heatmap-radius":new _o(Lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _o(Lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Rn(Lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new kd(Lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Rn(Lt.paint_heatmap["heatmap-opacity"])}))},n,a,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Wg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Zr("heatmap-radius",this,c)}queryIntersectsFeature(c,n,a,u,m,h,v,T){const k=this.paint.get("heatmap-radius").evaluate(n,a);return kC(c,u,h,v,T,!0,!0,new Be(0,0),k)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,a){return c==="heatmap"?{config:new Ac(this,{zoom:n,lut:a}),overrideFog:!1}:{}}},hillshade:class extends Va{constructor(c,n,a,u){super(c,{layout:DC||(DC=new ci({visibility:new Rn(Lt.layout_hillshade.visibility)})),paint:zC||(zC=new ci({"hillshade-illumination-direction":new Rn(Lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Rn(Lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Rn(Lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Rn(Lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Rn(Lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Rn(Lt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Rn(Lt.paint_hillshade["hillshade-emissive-strength"])}))},n,a,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,a){return{overrideFog:!1}}},fill:class extends Va{constructor(c,n,a,u){super(c,{layout:HC||(HC=new ci({"fill-sort-key":new _o(Lt.layout_fill["fill-sort-key"]),visibility:new Rn(Lt.layout_fill.visibility),"fill-elevation-reference":new Rn(Lt.layout_fill["fill-elevation-reference"])})),paint:GC||(GC=new ci({"fill-antialias":new Rn(Lt.paint_fill["fill-antialias"]),"fill-opacity":new _o(Lt.paint_fill["fill-opacity"]),"fill-color":new _o(Lt.paint_fill["fill-color"]),"fill-outline-color":new _o(Lt.paint_fill["fill-outline-color"]),"fill-translate":new Rn(Lt.paint_fill["fill-translate"]),"fill-translate-anchor":new Rn(Lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new _o(Lt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Rn(Lt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new _o(Lt.paint_fill["fill-z-offset"])}))},n,a,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),a=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getDefaultProgramParams(c,n,a){return{config:new Ac(this,{zoom:n,lut:a}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new tx(c)}queryRadius(){return sr(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,a,u,m,h){return!c.queryGeometry.isAboveHorizon&&fo(Gr(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Va{constructor(c,n,a,u){super(c,{layout:EE||(EE=new ci({visibility:new Rn(Lt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Rn(Lt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:ME||(ME=new ci({"fill-extrusion-opacity":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new _o(Lt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Rn(Lt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},n,a,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Uy(c)}queryRadius(){return sr(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,a,u,m,h,v,T,k){const L=Ur(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),x=this.paint.get("fill-extrusion-height").evaluate(n,a),A=this.paint.get("fill-extrusion-base").evaluate(n,a),O=[0,0],M=T&&h.elevation,R=h.elevation?h.elevation.exaggeration():1,N=c.tile.getBucket(this);if(M&&N instanceof Uy){const J=N.centroidVertexArray,ue=k+1;ue<J.length&&(O[0]=J.geta_centroid_pos0(ue),O[1]=J.geta_centroid_pos1(ue))}if(O[0]===0&&O[1]===1)return!1;h.projection.name==="globe"&&(u=CE([u],[new Be(0,0),new Be(Nn,Nn)],c.tileID.canonical).map(J=>J.polygon).flat());const W=M?T:null,[Y,ne]=function(J,ue,ve,Ie,Ge,ze,$e,st,Fe,rt,ht){return J.projection.name==="globe"?function(pt,Tt,Ot,Ft,Pt,sn,Cn,Jt,Jn,Fn,Pn){const Sn=[],wo=[],Xn=pt.projection.upVectorScale(Pn,pt.center.lat,pt.worldSize).metersToTile,io=[0,0,0,1],Uo=[0,0,0,1],Qo=(Zo,lr,ar,Qr)=>{Zo[0]=lr,Zo[1]=ar,Zo[2]=Qr,Zo[3]=1},er=TE();Ot>0&&(Ot+=er),Ft+=er;for(const Zo of Tt){const lr=[],ar=[];for(const Qr of Zo){const Wr=Qr.x+Pt.x,Bo=Qr.y+Pt.y,Dr=pt.projection.projectTilePoint(Wr,Bo,Pn),Br=pt.projection.upVector(Pn,Qr.x,Qr.y);let mi=Ot,Di=Ft;if(Cn){const qi=AE(Wr,Bo,Ot,Ft,Cn,Jt,Jn,Fn);mi+=qi.base,Di+=qi.top}Ot!==0?Qo(io,Dr.x+Br[0]*Xn*mi,Dr.y+Br[1]*Xn*mi,Dr.z+Br[2]*Xn*mi):Qo(io,Dr.x,Dr.y,Dr.z),Qo(Uo,Dr.x+Br[0]*Xn*Di,Dr.y+Br[1]*Xn*Di,Dr.z+Br[2]*Xn*Di),Re.vec3.transformMat4(io,io,sn),Re.vec3.transformMat4(Uo,Uo,sn),lr.push(new sf(io[0],io[1],io[2])),ar.push(new sf(Uo[0],Uo[1],Uo[2]))}Sn.push(lr),wo.push(ar)}return[Sn,wo]}(J,ue,ve,Ie,Ge,ze,$e,st,Fe,rt,ht):$e?function(pt,Tt,Ot,Ft,Pt,sn,Cn,Jt,Jn){const Fn=[],Pn=[],Sn=[0,0,0,1];for(const wo of pt){const Xn=[],io=[];for(const Uo of wo){const Qo=Uo.x+Ft.x,er=Uo.y+Ft.y,Zo=AE(Qo,er,Tt,Ot,sn,Cn,Jt,Jn);Sn[0]=Qo,Sn[1]=er,Sn[2]=Zo.base,Sn[3]=1,Re.vec4.transformMat4(Sn,Sn,Pt),Sn[3]=Math.max(Sn[3],1e-5);const lr=new sf(Sn[0]/Sn[3],Sn[1]/Sn[3],Sn[2]/Sn[3]);Sn[0]=Qo,Sn[1]=er,Sn[2]=Zo.top,Sn[3]=1,Re.vec4.transformMat4(Sn,Sn,Pt),Sn[3]=Math.max(Sn[3],1e-5);const ar=new sf(Sn[0]/Sn[3],Sn[1]/Sn[3],Sn[2]/Sn[3]);Xn.push(lr),io.push(ar)}Fn.push(Xn),Pn.push(io)}return[Fn,Pn]}(ue,ve,Ie,Ge,ze,$e,st,Fe,rt):function(pt,Tt,Ot,Ft,Pt){const sn=[],Cn=[],Jt=Pt[8]*Tt,Jn=Pt[9]*Tt,Fn=Pt[10]*Tt,Pn=Pt[11]*Tt,Sn=Pt[8]*Ot,wo=Pt[9]*Ot,Xn=Pt[10]*Ot,io=Pt[11]*Ot;for(const Uo of pt){const Qo=[],er=[];for(const Zo of Uo){const lr=Zo.x+Ft.x,ar=Zo.y+Ft.y,Qr=Pt[0]*lr+Pt[4]*ar+Pt[12],Wr=Pt[1]*lr+Pt[5]*ar+Pt[13],Bo=Pt[2]*lr+Pt[6]*ar+Pt[14],Dr=Pt[3]*lr+Pt[7]*ar+Pt[15],Br=Qr+Jt,mi=Wr+Jn,Di=Bo+Fn,qi=Math.max(Dr+Pn,1e-5),zi=Qr+Sn,Ii=Wr+wo,Ni=Bo+Xn,Xi=Math.max(Dr+io,1e-5);Qo.push(new sf(Br/qi,mi/qi,Di/qi)),er.push(new sf(zi/Xi,Ii/Xi,Ni/Xi))}sn.push(Qo),Cn.push(er)}return[sn,Cn]}(ue,ve,Ie,Ge,ze)}(h,u,A,x,L,v,W,O,R,h.center.lat,c.tileID.canonical),re=c.queryGeometry;return function(J,ue,ve){let Ie=1/0;fo(ve,ue)&&(Ie=IE(ve,ue[0]));for(let Ge=0;Ge<ue.length;Ge++){const ze=ue[Ge],$e=J[Ge];for(let st=0;st<ze.length-1;st++){const Fe=ze[st],rt=[Fe,ze[st+1],$e[st+1],$e[st],Fe];hn(ve,rt)&&(Ie=Math.min(Ie,IE(ve,rt)))}}return Ie!==1/0&&Ie}(Y,ne,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},line:class extends Va{constructor(c,n,a,u){const m=NE();super(c,m,n,a,u),m.layout&&(this.layout=new Ad(m.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Fl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(tv)return tv;const a=NE();return tv=new FF(a.paint.properties["line-width"].specification),tv.useIntegerZoom=!0,tv})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new dx(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,a){const u=FE(this);return{config:new Ac(this,{zoom:n,lut:a}),defines:u,overrideFog:!1}}queryRadius(c){const n=c,a=$E(Zr("line-width",this,n),Zr("line-gap-width",this,n)),u=Zr("line-offset",this,n);return a/2+Math.abs(u)+sr(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,a,u,m,h){if(c.queryGeometry.isAboveHorizon)return!1;const v=Gr(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),T=c.pixelToTileUnitsFactor/2*$E(this.paint.get("line-width").evaluate(n,a),this.paint.get("line-gap-width").evaluate(n,a)),k=this.paint.get("line-offset").evaluate(n,a);return k&&(u=function(L,x){const A=[],O=new Be(0,0);for(let M=0;M<L.length;M++){const R=L[M],N=[];for(let W=0;W<R.length;W++){const Y=R[W],ne=R[W+1],re=W===0?O:Y.sub(R[W-1])._unit()._perp(),J=W===R.length-1?O:ne.sub(Y)._unit()._perp(),ue=re._add(J)._unit();ue._mult(1/(ue.x*J.x+ue.y*J.y)),N.push(ue._mult(x)._add(Y))}A.push(N)}return A}(u,k*c.pixelToTileUnitsFactor)),function(L,x,A){for(let O=0;O<x.length;O++){const M=x[O];if(L.length>=3){for(let R=0;R<M.length;R++)if(mr(L,M[R]))return!0}if(xo(L,M,A))return!0}return!1}(v,u,T)}isTileClipped(){return!0}isDraped(c){const n=this.layout.get("line-z-offset"),a=n.isConstant()&&!n.constantOr(0),u=this.layout.get("line-elevation-reference");return!(u==="sea"||u==="ground")&&(a||u!=="none")}},symbol:o0,background:class extends Va{constructor(c,n,a,u){super(c,{layout:SM||(SM=new ci({visibility:new Rn(Lt.layout_background.visibility)})),paint:TM||(TM=new ci({"background-pitch-alignment":new Rn(Lt.paint_background["background-pitch-alignment"]),"background-color":new Rn(Lt.paint_background["background-color"]),"background-pattern":new Rn(Lt.paint_background["background-pattern"]),"background-opacity":new Rn(Lt.paint_background["background-opacity"]),"background-emissive-strength":new Rn(Lt.paint_background["background-emissive-strength"])}))},n,a,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,a){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:AM,"raster-particle":DM,sky:class extends Va{constructor(c,n,a,u){super(c,{layout:RM||(RM=new ci({visibility:new Rn(Lt.layout_sky.visibility)})),paint:OM||(OM=new ci({"sky-type":new Rn(Lt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Rn(Lt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Rn(Lt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Rn(Lt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Rn(Lt.paint_sky["sky-gradient-radius"]),"sky-gradient":new kd(Lt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Rn(Lt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Rn(Lt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Rn(Lt.paint_sky["sky-opacity"])}))},n,a,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Wg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),m=!u,h=c.style.light,v=h.properties.get("position");return m&&h.properties.get("anchor")==="viewport"&&Bn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?Ox(v.azimuthal,90-v.polar,n):Ox(u[0],90-u[1],n)}const a=this.paint.get("sky-gradient-center");return Ox(a[0],90-a[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Va{constructor(c,n,a,u){super(c,{paint:LM||(LM=new ci({}))},n,null)}},model:class extends Va{constructor(c,n,a,u){super(c,{layout:GM||(GM=new ci({visibility:new Rn(Lt.layout_model.visibility),"model-id":new _o(Lt.layout_model["model-id"])})),paint:WM||(WM=new ci({"model-opacity":new Rn(Lt.paint_model["model-opacity"]),"model-rotation":new _o(Lt.paint_model["model-rotation"]),"model-scale":new _o(Lt.paint_model["model-scale"]),"model-translation":new _o(Lt.paint_model["model-translation"]),"model-color":new _o(Lt.paint_model["model-color"]),"model-color-mix-intensity":new _o(Lt.paint_model["model-color-mix-intensity"]),"model-type":new Rn(Lt.paint_model["model-type"]),"model-cast-shadows":new Rn(Lt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Rn(Lt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Rn(Lt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new _o(Lt.paint_model["model-emissive-strength"]),"model-roughness":new _o(Lt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new _o(Lt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Rn(Lt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Rn(Lt.paint_model["model-front-cutoff"])}))},n,a,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new zx(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof d0?Nn-1:0}queryIntersectsFeature(c,n,a,u,m,h){if(!this.modelManager)return!1;const v=this.modelManager,T=c.tile.getBucket(this);if(!(T&&T instanceof zx))return!1;const k=T;for(const L in k.instancesPerModel){const x=k.instancesPerModel[L],A=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(x.idToFeaturesIndex.hasOwnProperty(A)){const O=x.features[x.idToFeaturesIndex[A]],M=v.getModel(L,this.scope);if(!M)return!1;let R=Re.mat4.create();const N=new j(0,0),W=k.canonical;let Y=Number.MAX_VALUE;for(let ne=0;ne<O.instancedDataCount;++ne){const re=16*(O.instancedDataOffset+ne),J=x.instancedDataArray.float32,ue=[J[re+4],J[re+5],J[re+6]];JM(W,N,J[re],0|J[re+1]),qM(R,M,h,N,O.rotation,O.scale,ue,!1,!1,!1),h.projection.name==="globe"&&(R=Dx(R,h));const ve=Re.mat4.multiply([],h.projMatrix,R),Ie=c.queryGeometry,Ge=$M(Ie.isPointQuery()?Ie.screenBounds:Ie.screenGeometry,h,ve,M.aabb);Ge!=null&&(Y=Math.min(Ge,Y))}return Y!==Number.MAX_VALUE&&Y}}return!1}_handleOverridablePaintPropertyUpdate(c,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Uh}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(c,n,a,u){const m=c.tile,h=m.getBucket(this);let v=null,T=Number.MAX_VALUE;if(!(h&&h instanceof d0))return{queryFeature:v,intersectionZ:T};const k=h.getNodesInfo()[n];if(k.hiddenByReplacement||!k.node.meshes||!a.filter(new Ei(m.tileID.overscaledZ),k.feature,m.tileID.canonical))return{queryFeature:v,intersectionZ:T};const L=k.node,x=u.calculatePosMatrix(m.tileID.toUnwrapped(),u.worldSize),A=k.evaluatedScale;let O=0;u.elevation&&L.elevation&&(O=L.elevation*u.elevation.exaggeration()),Re.mat4.translate(x,x,[(L.anchor?L.anchor[0]:0)*(A[0]-1),(L.anchor?L.anchor[1]:0)*(A[1]-1),O]),Re.mat4.scale(x,x,A);const M=c.queryGeometry,R=M.isPointQuery()?M.screenBounds:M.screenGeometry,N=function(J){const ue=Re.mat4.multiply([],x,J.matrix);Re.mat4.multiply(ue,u.expandedFarZProjMatrix,ue);for(let ve=0;ve<J.meshes.length;++ve){const Ie=J.meshes[ve];if(ve===J.lightMeshIndex)continue;const Ge=$M(R,u,ue,Ie.aabb);Ge!=null&&(T=Math.min(Ge,T))}if(J.children)for(const ve of J.children)N(ve)};if(N(L),T===Number.MAX_VALUE)return{queryFeature:v,intersectionZ:T};const W=new j(0,0);JM(m.tileID.canonical,W,k.node.anchor[0],k.node.anchor[1]);const{z:Y,x:ne,y:re}=m.tileID.canonical;return v=new pv({},Y,ne,re,k.feature.id),v.properties=k.feature.properties,v.geometry={type:"Point",coordinates:[W.lng,W.lat]},v.layer={...this.serialize(),id:this.fqid},v.state={},v.tile=m.tileID.canonical,{queryFeature:v,intersectionZ:T}}},clip:class extends Va{constructor(c,n,a,u){super(c,{layout:WC||(WC=new ci({"clip-layer-types":new Rn(Lt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Rn(Lt.layout_clip["clip-layer-scope"])})),paint:qC||(qC=new ci({}))},n,a,u)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new KC(c)}isTileClipped(){return!0}is3D(){return!0}}};class zB{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class FB{constructor(){this.tasks={},this.taskQueue=[],Dt(["process"],this),this.invoker=new zB(this.process),this.nextId=0}add(n,a){const u=this.nextId++,m=function({type:h,isSymbolTile:v,zoom:T}){return T=T||0,h==="message"?0:h!=="maybePrepare"||v?h!=="parseTile"||v?h==="parseTile"&&v?300-T:h==="maybePrepare"&&v?400-T:500:200-T:100-T}(a);if(m===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:a,priority:m,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const a=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let n=null,a=1/0;for(let m=0;m<this.taskQueue.length;m++){const h=this.tasks[this.taskQueue[m]];h.priority<a&&(a=h.priority,n=m)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class QM{constructor(n,a,u){this.target=n,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Dt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new FB}send(n,a,u,m,h=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[T]=u);const k=new Set;return this.target.postMessage({id:T,type:n,hasCallback:!!u,targetMapId:m,mustQueue:h,sourceMapId:this.mapId,data:Nu(a,k)},k),{cancel:()=>{u&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(n){const a=n.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const m=this.cancelCallbacks[u];delete this.cancelCallbacks[u],m&&m.cancel()}else if(a.mustQueue||Er()){const m=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,a),m&&m.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,a)}processTask(n,a){if(delete this.cancelCallbacks[n],a.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(a.error?u(os(a.error)):u(null,os(a.data)))}else{const u=new Set,m=a.hasCallback?(v,T)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:v?Nu(v):null,data:Nu(T,u)},u)}:()=>{},h=os(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,h,m);else if(this.parent.getWorkerSource){const v=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,v[0],h.source,h.scope)[v[1]](h,m)}else m(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Fp{constructor(n,a){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=Ho();const u=this.workerPool.acquire(this.id);for(let m=0;m<u.length;m++){const h=new Fp.Actor(u[m],a,this.id);h.name=`Worker ${m}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,a,u){Co(this.actors,(m,h)=>{m.send(n,a,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}Fp.Actor=QM;class eI{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,a){const u=this.toIdx(n,a);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,a){return this.leaves[this.toIdx(n,a)]}toIdx(n,a){return a*this.size+n}}function tI(c,n,a,u){let m=0,h=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(a[v]<c[v]||a[v]>n[v])return null}else{const T=1/u[v];let k=(c[v]-a[v])*T,L=(n[v]-a[v])*T;if(k>L){const x=k;k=L,L=x}if(k>m&&(m=k),L<h&&(h=L),m>h)return null}return m}function nI(c,n,a,u,m,h,v,T,k,L,x){const A=u-c,O=m-n,M=h-a,R=v-c,N=T-n,W=k-a,Y=x[1]*W-x[2]*N,ne=x[2]*R-x[0]*W,re=x[0]*N-x[1]*R,J=A*Y+O*ne+M*re;if(Math.abs(J)<1e-15)return null;const ue=1/J,ve=L[0]-c,Ie=L[1]-n,Ge=L[2]-a,ze=(ve*Y+Ie*ne+Ge*re)*ue;if(ze<0||ze>1)return null;const $e=Ie*M-Ge*O,st=Ge*A-ve*M,Fe=ve*O-Ie*A,rt=(x[0]*$e+x[1]*st+x[2]*Fe)*ue;return rt<0||ze+rt>1?null:(R*$e+N*st+W*Fe)*ue}function oI(c,n,a){return(c-n)/(a-n)}function rI(c,n,a,u,m,h,v,T,k){const L=1<<a,x=h-u,A=v-m,O=(c+1)/L*x+u,M=(n+0)/L*A+m,R=(n+1)/L*A+m;T[0]=(c+0)/L*x+u,T[1]=M,k[0]=O,k[1]=R}class iI{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(h){const v=Math.ceil(Math.log2(h.dim/8)),T=[];let k=Math.ceil(Math.pow(2,v));const L=1/k,x=(M,R,N,W,Y)=>{const ne=W?1:0,re=(M+1)*N-ne,J=R*N,ue=(R+1)*N-ne;Y[0]=M*N,Y[1]=J,Y[2]=re,Y[3]=ue};let A=new eI(k);const O=[];for(let M=0;M<k*k;M++){x(M%k,Math.floor(M/k),L,!1,O);const R=Kd(O[0],O[1],h),N=Kd(O[2],O[1],h),W=Kd(O[2],O[3],h),Y=Kd(O[0],O[3],h);A.minimums.push(Math.min(R,N,W,Y)),A.maximums.push(Math.max(R,N,W,Y)),A.leaves.push(1)}for(T.push(A),k/=2;k>=1;k/=2){const M=T[T.length-1];A=new eI(k);for(let R=0;R<k*k;R++){x(R%k,Math.floor(R/k),2,!0,O);const N=M.getElevation(O[0],O[1]),W=M.getElevation(O[2],O[1]),Y=M.getElevation(O[2],O[3]),ne=M.getElevation(O[0],O[3]),re=M.isLeaf(O[0],O[1]),J=M.isLeaf(O[2],O[1]),ue=M.isLeaf(O[2],O[3]),ve=M.isLeaf(O[0],O[3]),Ie=Math.min(N.min,W.min,Y.min,ne.min),Ge=Math.max(N.max,W.max,Y.max,ne.max),ze=re&&J&&ue&&ve;A.maximums.push(Ge),A.minimums.push(Ie),A.leaves.push(Ge-Ie<=5&&ze?1:0)}T.push(A)}return T}(this.dem),u=a.length-1,m=a[u];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(a,0,0,u,0)}raycastRoot(n,a,u,m,h,v,T=1){return tI([n,a,-100],[u,m,this.maximums[0]*T],h,v)}raycast(n,a,u,m,h,v,T=1){if(!this.nodeCount)return null;const k=this.raycastRoot(n,a,u,m,h,v,T);if(k==null)return null;const L=[],x=[],A=[],O=[],M=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;M.length>0;){const{idx:R,t:N,nodex:W,nodey:Y,depth:ne}=M.pop();if(this.leaves[R]){rI(W,Y,ne,n,a,u,m,A,O);const J=1<<ne,ue=(W+0)/J,ve=(W+1)/J,Ie=(Y+0)/J,Ge=(Y+1)/J,ze=Kd(ue,Ie,this.dem)*T,$e=Kd(ve,Ie,this.dem)*T,st=Kd(ve,Ge,this.dem)*T,Fe=Kd(ue,Ge,this.dem)*T,rt=nI(A[0],A[1],ze,O[0],A[1],$e,O[0],O[1],st,h,v),ht=nI(O[0],O[1],st,A[0],O[1],Fe,A[0],A[1],ze,h,v),pt=Math.min(rt!==null?rt:Number.MAX_VALUE,ht!==null?ht:Number.MAX_VALUE);if(pt!==Number.MAX_VALUE)return pt;{const Tt=Re.vec3.scaleAndAdd([],h,v,N);if(aI(ze,$e,Fe,st,oI(Tt[0],A[0],O[0]),oI(Tt[1],A[1],O[1]))>=Tt[2])return N}continue}let re=0;for(let J=0;J<this._siblingOffset.length;J++){rI((W<<1)+this._siblingOffset[J][0],(Y<<1)+this._siblingOffset[J][1],ne+1,n,a,u,m,A,O),A[2]=-100,O[2]=this.maximums[this.childOffsets[R]+J]*T;const ue=tI(A,O,h,v);if(ue!=null){const ve=ue;L[J]=ve;let Ie=!1;for(let Ge=0;Ge<re&&!Ie;Ge++)ve>=L[x[Ge]]&&(x.splice(Ge,0,J),Ie=!0);Ie||(x[re]=J),re++}}for(let J=0;J<re;J++){const ue=x[J];M.push({idx:this.childOffsets[R]+ue,t:L[ue],nodex:(W<<1)+this._siblingOffset[ue][0],nodey:(Y<<1)+this._siblingOffset[ue][1],depth:ne+1})}}return null}_addNode(n,a,u){return this.minimums.push(n),this.maximums.push(a),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,a,u,m,h){if(n[m].isLeaf(a,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const v=m-1,T=n[v];let k=0,L=0;for(let x=0;x<this._siblingOffset.length;x++){const A=2*a+this._siblingOffset[x][0],O=2*u+this._siblingOffset[x][1],M=T.getElevation(A,O),R=T.isLeaf(A,O),N=this._addNode(M.min,M.max,R);R&&(k|=1<<x),L||(L=N)}for(let x=0;x<this._siblingOffset.length;x++)k&1<<x||this._construct(n,2*a+this._siblingOffset[x][0],2*u+this._siblingOffset[x][1],v,L+x)}}function aI(c,n,a,u,m,h){return uo(uo(c,a,h),uo(n,u,h),m)}function Kd(c,n,a){const u=a.dim,m=yt(c*u-.5,0,u-1),h=yt(n*u-.5,0,u-1),v=Math.floor(m),T=Math.floor(h),k=Math.min(v+1,u-1),L=Math.min(T+1,u-1);return aI(a.get(v,T),a.get(k,T),a.get(v,L),a.get(k,L),m-v,h-T)}const BB={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function NB(c,n,a){return(256*c*256+256*n+a)/10-1e4}function $B(c,n,a){return 256*c+n+a/256-32768}class h0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,a,u,m=!1){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void Bn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const h=this.dim=a.height-2,v=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.floatView=new Float32Array(a.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let k=0;k<h;k++)v[this._idx(-1,k)]=v[this._idx(0,k)],v[this._idx(h,k)]=v[this._idx(h-1,k)],v[this._idx(k,-1)]=v[this._idx(k,0)],v[this._idx(k,h)]=v[this._idx(k,h-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(h,-1)]=v[this._idx(h-1,0)],v[this._idx(-1,h)]=v[this._idx(0,h-1)],v[this._idx(h,h)]=v[this._idx(h-1,h-1)]}const T=u==="terrarium"?$B:NB;for(let k=0;k<v.length;++k){const L=4*k;this.floatView[k]=T(this.pixels[L],this.pixels[L+1],this.pixels[L+2])}this._timestamp=Yt.now()}_buildQuadTree(){this._tree=new iI(this)}get(n,a,u=!1){u&&(n=yt(n,-1,this.dim),a=yt(a,-1,this.dim));const m=this._idx(n,a);return this.floatView[m]}set(n,a,u){const m=this._idx(n,a),h=this.floatView[m];return this.floatView[m]=u,u-h}static getUnpackVector(n){return BB[n]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}static pack(n,a){const u=[0,0,0,0],m=h0.getUnpackVector(a);let h=Math.floor((n+m[3])/m[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new NC({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,a,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let m=a*this.dim,h=a*this.dim+this.dim,v=u*this.dim,T=u*this.dim+this.dim;switch(a){case-1:m=h-1;break;case 1:h=m+1}switch(u){case-1:v=T-1;break;case 1:T=v+1}const k=-a*this.dim,L=-u*this.dim;for(let x=v;x<T;x++)for(let A=m;A<h;A++){const O=4*this._idx(A,x),M=4*this._idx(A+k,x+L);this.pixels[O+0]=n.pixels[M+0],this.pixels[O+1]=n.pixels[M+1],this.pixels[O+2]=n.pixels[M+2],this.pixels[O+3]=n.pixels[M+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function VB(c,n,a){c===1?n.headerLength=a.readFixed32():c===2?n.x=a.readVarint():c===3?n.y=a.readVarint():c===4?n.z=a.readVarint():c===5&&n.layers.push(function(u,m){return u.readFields(WB,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},m)}(a,a.readVarint()+a.pos))}function UB(c,n,a){c===1?(n.delta_filter=function(u,m){return u.readFields(jB,{blockSize:0},m)}(a,a.readVarint()+a.pos),n.filter="delta_filter"):c===2?(a.readVarint(),n.filter="zigzag_filter"):c===3?(a.readVarint(),n.filter="bitshuffle_filter"):c===4&&(a.readVarint(),n.filter="byteshuffle_filter")}function jB(c,n,a){c===1&&(n.blockSize=a.readVarint())}function HB(c,n,a){c===1?(a.readVarint(),n.codec="gzip_data"):c===2?(a.readVarint(),n.codec="jpeg_image"):c===3?(a.readVarint(),n.codec="webp_image"):c===4&&(a.readVarint(),n.codec="png_image")}function GB(c,n,a){let u=0,m=0;c===1?n.firstByte=a.readFixed64():c===2?n.lastByte=a.readFixed64():c===3?n.filters.push(function(h,v){return h.readFields(UB,{},v)}(a,a.readVarint()+a.pos)):c===4?n.codec=function(h,v){return h.readFields(HB,{},v)}(a,a.readVarint()+a.pos):c===5?m=a.readFloat():c===6?u=a.readFloat():c===7?n.bands.push(a.readString()):c===8?n.offset=a.readDouble():c===9&&(n.scale=a.readDouble()),n.offset===0&&(n.offset=m),n.scale===0&&(n.scale=u)}function WB(c,n,a){c===1?n.version=a.readVarint():c===2?n.name=a.readString():c===3?n.units=a.readString():c===4?n.tileSize=a.readVarint():c===5?n.buffer=a.readVarint():c===6?n.pixelFormat=a.readVarint():c===7&&n.dataIndex.push(function(u,m){return u.readFields(GB,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},m)}(a,a.readVarint()+a.pos))}function qB(c,n,a){if(c===2)(function(u,m,h){u.readFields(KB,h,m)})(a,a.readVarint()+a.pos,n);else if(c===3)throw new Error("Not implemented")}function KB(c,n,a){if(c===1){let u=0;const m=a.readVarint()+a.pos;for(;a.pos<m;)n[u++]=a.readVarint()}}no(h0,"DEMData"),no(iI,"DemMinMaxQuadTree",{omit:["dem"]});class ZB{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const a=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,a),a}put(n,a){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,a)}}function YB(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let a=n[3];for(let u=2;u>=1;u--){const m=u===1?1:0,h=u===2?1:0;for(let v=0;v<n[0];v++){const T=n[1]*v;for(let k=m;k<n[1];k++){const L=n[2]*(k+T);for(let x=h;x<n[2];x++){const A=n[3]*(x+L);for(let O=0;O<n[3];O++){const M=A+O;c[M]+=c[M-a]}}}}a*=n[u]}return c}function XB(c){for(let n=0,a=c.length;n<a;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function JB(c,n){switch(n){case"uint32":return c;case"uint16":for(let a=0;a<c.length;a+=2){const u=c[a],m=c[a+1];c[a]=(240&u)>>4|(61440&u)>>8|(240&m)<<4|61440&m,c[a+1]=15&u|(3840&u)>>4|(15&m)<<8|(3840&m)<<4}return c;case"uint8":for(let a=0;a<c.length;a+=4){const u=c[a],m=c[a+1],h=c[a+2],v=c[a+3];c[a+0]=(192&u)>>6|(192&m)>>4|(192&h)>>2|192&v,c[a+1]=(48&u)>>4|(48&m)>>2|48&h|(48&v)<<2,c[a+2]=(12&u)>>2|12&m|(12&h)<<2|(12&v)<<4,c[a+3]=3&u|(3&m)<<2|(3&h)<<4|(3&v)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}var vl=Uint8Array,mv=Uint16Array,QB=Int32Array,sI=new vl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lI=new vl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),eN=new vl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cI=function(c,n){for(var a=new mv(31),u=0;u<31;++u)a[u]=n+=1<<c[u-1];var m=new QB(a[30]);for(u=1;u<30;++u)for(var h=a[u];h<a[u+1];++h)m[h]=h-a[u]<<5|u;return{b:a,r:m}},uI=cI(sI,2),dI=uI.b,tN=uI.r;dI[28]=258,tN[258]=28;for(var nN=cI(lI,0).b,hI=new mv(32768),Wi=0;Wi<32768;++Wi){var Bp=(43690&Wi)>>1|(21845&Wi)<<1;hI[Wi]=((65280&(Bp=(61680&(Bp=(52428&Bp)>>2|(13107&Bp)<<2))>>4|(3855&Bp)<<4))>>8|(255&Bp)<<8)>>1}var gv=function(c,n,a){for(var u=c.length,m=0,h=new mv(n);m<u;++m)c[m]&&++h[c[m]-1];var v,T=new mv(n);for(m=1;m<n;++m)T[m]=T[m-1]+h[m-1]<<1;v=new mv(1<<n);var k=15-n;for(m=0;m<u;++m)if(c[m])for(var L=m<<4|c[m],x=n-c[m],A=T[c[m]-1]++<<x,O=A|(1<<x)-1;A<=O;++A)v[hI[A]>>k]=L;return v},vv=new vl(288);for(Wi=0;Wi<144;++Wi)vv[Wi]=8;for(Wi=144;Wi<256;++Wi)vv[Wi]=9;for(Wi=256;Wi<280;++Wi)vv[Wi]=7;for(Wi=280;Wi<288;++Wi)vv[Wi]=8;var fI=new vl(32);for(Wi=0;Wi<32;++Wi)fI[Wi]=5;var oN=gv(vv,9),rN=gv(fI,5),$x=function(c){for(var n=c[0],a=1;a<c.length;++a)c[a]>n&&(n=c[a]);return n},Oc=function(c,n,a){var u=n/8|0;return(c[u]|c[u+1]<<8)>>(7&n)&a},Vx=function(c,n){var a=n/8|0;return(c[a]|c[a+1]<<8|c[a+2]<<16)>>(7&n)},iN=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Lc=function(c,n,a){var u=new Error(n||iN[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,Lc),!a)throw u;return u},aN=new vl(0),sN=typeof TextDecoder<"u"&&new TextDecoder;try{sN.decode(aN,{stream:!0})}catch{}const lN={gzip_data:"gzip"};class jl extends Error{constructor(n){super(n),this.name="MRTError"}}const cN={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},pI={uint32:1,uint16:2,uint8:4},uN={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Ux;class jx{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const a=this.layers[n];if(!a)throw new jl(`Layer '${n}' not found`);return a}getHeaderLength(n){const a=new Uint8Array(n),u=new DataView(n);if(a[0]!==13)throw new jl("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const a=new Uint8Array(n),u=this.getHeaderLength(n);if(a.length<u)throw new jl(`Expected header with length >= ${u} but got buffer of length ${a.length}`);const m=function(h,v){return h.readFields(VB,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Ux(a.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new jl(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const h of m.layers)this.layers[h.name]=new dN(h,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const a=[],u=this.getLayer(n.layerName);for(let m of n.blockIndices){const h=u.dataIndex[m],v=h.firstByte-n.firstByte,T=h.lastByte-n.firstByte;if(u._blocksInProgress.has(m))continue;const k={layerName:u.name,firstByte:v,lastByte:T,pixelFormat:u.pixelFormat,blockIndex:m,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(L=>L.filter)};u._blocksInProgress.add(m),a.push(k)}return new mI(a,()=>{a.forEach(m=>u._blocksInProgress.delete(m.blockIndex))},(m,h)=>{if(a.forEach(v=>u._blocksInProgress.delete(v.blockIndex)),m)throw m;h.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class dN{constructor({version:n,name:a,units:u,tileSize:m,pixelFormat:h,buffer:v,dataIndex:T},k){if(this.version=n,this.version!==1)throw new jl(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=a,this.units=u,this.tileSize=m,this.buffer=v,this.pixelFormat=cN[h],this.dataIndex=T,this.bandShape=[m+2*v,m+2*v,pI[this.pixelFormat]],this._decodedBlocks=new ZB(k?k.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return pI[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const a=n.blockIndex.toString();this._decodedBlocks.get(a)||this._decodedBlocks.put(a,n.data)}getBlockForBand(n){let a=0;switch(typeof n){case"string":for(const[u,m]of this.dataIndex.entries()){for(const[h,v]of m.bands.entries())if(v===n)return{bandIndex:a+h,blockIndex:u,blockBandIndex:h};a+=m.bands.length}break;case"number":for(const[u,m]of this.dataIndex.entries()){if(n>=a&&n<a+m.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-a};a+=m.bands.length}break;default:throw new jl(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new jl(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let a=1/0,u=-1/0;const m=[],h=new Set;for(const v of n){const{blockIndex:T}=this.getBlockForBand(v);if(T<0)throw new jl(`Invalid band: ${JSON.stringify(v)}`);const k=this.dataIndex[T];m.includes(T)||m.push(T),h.add(T),a=Math.min(a,k.firstByte),u=Math.max(u,k.lastByte)}if(h.size>this.cacheSize)throw new jl(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:a,lastByte:u,blockIndices:m}}hasBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0}hasDataForBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0&&!!this._decodedBlocks.get(a.toString())}getBandView(n){const{blockIndex:a,blockBandIndex:u}=this.getBlockForBand(n),m=this._decodedBlocks.get(a.toString());if(!m)throw new jl(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[a],v=this.bandShape.reduce((L,x)=>L*x,1),T=u*v,k=m.subarray(T,T+v);return{data:k,bytes:new Uint8Array(k.buffer).subarray(k.byteOffset,k.byteOffset+k.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}jx.setPbf=function(c){Ux=c};class mI{constructor(n,a,u){this.tasks=n,this._onCancel=a,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,a){this._finalized||(this._onComplete(n,a),this._finalized=!0)}}jx.performDecoding=function(c,n){const a=new Uint8Array(c);return Promise.all(n.tasks.map(u=>{const{layerName:m,firstByte:h,lastByte:v,pixelFormat:T,blockShape:k,blockIndex:L,filters:x,codec:A}=u,O=a.subarray(h,v+1),M=new Uint32Array(k[0]*k[1]*k[2]);let R;if(A!=="gzip_data")throw new jl(`Unhandled codec: ${A}`);return R=function(N,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((J=function(Ie){Ie[0]==31&&Ie[1]==139&&Ie[2]==8||Lc(6,"invalid gzip data");var Ge=Ie[3],ze=10;4&Ge&&(ze+=2+(Ie[10]|Ie[11]<<8));for(var $e=(Ge>>3&1)+(Ge>>4&1);$e>0;$e-=!Ie[ze++]);return ze+(2&Ge)}(re=N))+8>re.length&&Lc(6,"invalid gzip data"),function(Ie,Ge,ze,$e){var st=Ie.length;if(!st||Ge.f&&!Ge.l)return ze||new vl(0);var Fe=!ze,rt=Fe||Ge.i!=2,ht=Ge.i;Fe&&(ze=new vl(3*st));var pt,Tt,Ot=function(Zd){var hf=ze.length;if(Zd>hf){var Tv=new vl(Math.max(2*hf,Zd));Tv.set(ze),ze=Tv}},Ft=Ge.f||0,Pt=Ge.p||0,sn=Ge.b||0,Cn=Ge.l,Jt=Ge.d,Jn=Ge.m,Fn=Ge.n,Pn=8*st;do{if(!Cn){Ft=Oc(Ie,Pt,1);var Sn=Oc(Ie,Pt+1,3);if(Pt+=3,!Sn){var wo=Ie[(Bo=4+((Pt+7)/8|0))-4]|Ie[Bo-3]<<8,Xn=Bo+wo;if(Xn>st){ht&&Lc(0);break}rt&&Ot(sn+wo),ze.set(Ie.subarray(Bo,Xn),sn),Ge.b=sn+=wo,Ge.p=Pt=8*Xn,Ge.f=Ft;continue}if(Sn==1)Cn=oN,Jt=rN,Jn=9,Fn=5;else if(Sn==2){var io=Oc(Ie,Pt,31)+257,Uo=Oc(Ie,Pt+10,15)+4,Qo=io+Oc(Ie,Pt+5,31)+1;Pt+=14;for(var er=new vl(Qo),Zo=new vl(19),lr=0;lr<Uo;++lr)Zo[eN[lr]]=Oc(Ie,Pt+3*lr,7);Pt+=3*Uo;var ar=$x(Zo),Qr=(1<<ar)-1,Wr=gv(Zo,ar);for(lr=0;lr<Qo;){var Bo,Dr=Wr[Oc(Ie,Pt,Qr)];if(Pt+=15&Dr,(Bo=Dr>>4)<16)er[lr++]=Bo;else{var Br=0,mi=0;for(Bo==16?(mi=3+Oc(Ie,Pt,3),Pt+=2,Br=er[lr-1]):Bo==17?(mi=3+Oc(Ie,Pt,7),Pt+=3):Bo==18&&(mi=11+Oc(Ie,Pt,127),Pt+=7);mi--;)er[lr++]=Br}}var Di=er.subarray(0,io),qi=er.subarray(io);Jn=$x(Di),Fn=$x(qi),Cn=gv(Di,Jn),Jt=gv(qi,Fn)}else Lc(1);if(Pt>Pn){ht&&Lc(0);break}}rt&&Ot(sn+131072);for(var zi=(1<<Jn)-1,Ii=(1<<Fn)-1,Ni=Pt;;Ni=Pt){var Xi=(Br=Cn[Vx(Ie,Pt)&zi])>>4;if((Pt+=15&Br)>Pn){ht&&Lc(0);break}if(Br||Lc(2),Xi<256)ze[sn++]=Xi;else{if(Xi==256){Ni=Pt,Cn=null;break}var xa=Xi-254;Xi>264&&(xa=Oc(Ie,Pt,(1<<(zc=sI[lr=Xi-257]))-1)+dI[lr],Pt+=zc);var di=Jt[Vx(Ie,Pt)&Ii],Cs=di>>4;if(di||Lc(3),Pt+=15&di,qi=nN[Cs],Cs>3){var zc=lI[Cs];qi+=Vx(Ie,Pt)&(1<<zc)-1,Pt+=zc}if(Pt>Pn){ht&&Lc(0);break}rt&&Ot(sn+131072);var Hl=sn+xa;if(sn<qi){var Gl=0-qi,df=Math.min(qi,Hl);for(Gl+sn<0&&Lc(3);sn<df;++sn)ze[sn]=(void 0)[Gl+sn]}for(;sn<Hl;++sn)ze[sn]=ze[sn-qi]}}Ge.l=Cn,Ge.p=Ni,Ge.b=sn,Ge.f=Ft,Cn&&(Ft=1,Ge.m=Jn,Ge.d=Jt,Ge.n=Fn)}while(!Ft);return sn!=ze.length&&Fe?(pt=ze,((Tt=sn)==null||Tt>pt.length)&&(Tt=pt.length),new vl(pt.subarray(0,Tt))):ze.subarray(0,sn)}(re.subarray(J,-8),{i:2},new vl(((Y=re)[(ne=Y.length)-4]|Y[ne-3]<<8|Y[ne-2]<<16|Y[ne-1]<<24)>>>0))));var Y,ne,re,J;const ue=lN[W];if(!ue)throw new Error(`Unhandled codec: ${W}`);const ve=new globalThis.DecompressionStream(ue);return new Response(new Blob([N]).stream().pipeThrough(ve)).arrayBuffer().then(Ie=>new Uint8Array(Ie))}(O,A).then(N=>(function(W,Y){W.readFields(qB,Y)}(new Ux(N),M),new uN[T](M.buffer))),R.then(N=>{for(let W=x.length-1;W>=0;W--)switch(x[W]){case"delta_filter":YB(N,k);break;case"zigzag_filter":XB(N);break;case"bitshuffle_filter":JB(N,T);break;default:throw new jl(`Unhandled filter "${x[W]}"`)}return{layerName:m,blockIndex:L,data:N}}).catch(N=>{throw N})}))},no(mI,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var _v={workerUrl:"",workerClass:null,workerParams:void 0};const Hx="mapboxgl_preloaded_worker_pool";class yv{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<yv.workerCount;)this.workers.push(_v.workerClass!=null?new _v.workerClass:new self.Worker(_v.workerUrl,_v.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Hx]}numActive(){return Object.keys(this.active).length}}let bv;function f0(){return bv||(bv=new yv),bv}yv.workerCount=2;let xv,Gx,Dc,Np,Wx,$p=null;function gI(){return Er()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Gx||qe.DRACO_URL}function vI(){if(Er()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Np)return Np;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Np=WebAssembly.validate(c)?qe.MESHOPT_SIMD_URL:qe.MESHOPT_URL,Np}const p0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},hN={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},wv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function _I(c,n,a){const u=a.json.bufferViews.length,m=a.buffers.length;n.bufferView=u,a.json.bufferViews[u]={buffer:m,byteLength:c.byteLength},a.buffers[m]=c}const qx="KHR_draco_mesh_compression";function fN(c,n){const a=c.extensions&&c.extensions[qx];if(!a)return;const u=new Dc.Decoder,m=wI(n,a.bufferView),h=new Dc.Mesh;if(!u.DecodeArrayToMesh(m,m.byteLength,h))throw new Error("Failed to decode Draco mesh");const v=n.json.accessors[c.indices],T=p0[v.componentType],k=v.count*T.BYTES_PER_ELEMENT,L=Dc._malloc(k);T===Uint16Array?u.GetTrianglesUInt16Array(h,k,L):u.GetTrianglesUInt32Array(h,k,L),_I(Dc.memory.buffer.slice(L,L+k),v,n),Dc._free(L);for(const x of Object.keys(a.attributes)){const A=u.GetAttributeByUniqueId(h,a.attributes[x]),O=n.json.accessors[c.attributes[x]],M=hN[O.componentType],R=O.count*wv[O.type]*p0[O.componentType].BYTES_PER_ELEMENT,N=Dc._malloc(R);u.GetAttributeDataArrayForAllPoints(h,A,Dc[M],R,N),_I(Dc.memory.buffer.slice(N,N+R),O,n),Dc._free(N)}u.destroy(),h.destroy(),delete c.extensions[qx]}const m0="EXT_meshopt_compression";function pN(c,n){if(!c.extensions||!c.extensions[m0])return;const a=c.extensions[m0],u=new Uint8Array(n.buffers[a.buffer],a.byteOffset||0,a.byteLength||0),m=new Uint8Array(a.count*a.byteStride);Wx.decodeGltfBuffer(m,a.count,a.byteStride,u,a.mode,a.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=m.buffer,delete c.extensions[m0]}const yI=1179937895,bI=new TextDecoder("utf8");function xI(c,n){return new URL(c,n).href}function mN(c,n,a,u){return fetch(xI(c.uri,u)).then(m=>m.arrayBuffer()).then(m=>{n.buffers[a]=m})}function wI(c,n){const a=c.json.bufferViews[n];return new Uint8Array(c.buffers[a.buffer],a.byteOffset||0,a.byteLength)}function gN(c,n,a,u){if(c.uri){const m=xI(c.uri,u);return fetch(m).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{n.images[a]=h})}if(c.bufferView!==void 0){const m=wI(n,c.bufferView),h=new Blob([m],{type:c.mimeType});return createImageBitmap(h).then(v=>{n.images[a]=v})}}function SI(c,n=0,a){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===yI){const x=new Uint32Array(c,n);let A=2;const O=(x[A++]>>2)-3,M=x[A++]>>2;if(A++,u.json=JSON.parse(bI.decode(x.subarray(A,A+M))),A+=M,A<O){const R=x[A++];A++;const N=n+(A<<2);u.buffers[0]=c.slice(N,N+R)}}else u.json=JSON.parse(bI.decode(new Uint8Array(c,n)));const{buffers:m,images:h,meshes:v,extensionsUsed:T,bufferViews:k}=u.json;let L=Promise.resolve();if(m){const x=[];for(let A=0;A<m.length;A++){const O=m[A];O.uri?x.push(mN(O,u,A,a)):u.buffers[A]||(u.buffers[A]=null)}L=Promise.all(x)}return L.then(()=>{const x=[],A=T&&T.includes(qx),O=T&&T.includes(m0);if(A&&x.push(function(){if(!Dc)return xv??(xv=function(M){let R,N=null;function W(){R=new Uint8Array(N.buffer)}function Y(){throw new Error("Unexpected Draco error.")}const ne={a:{a:Y,d:function(re,J,ue){return R.copyWithin(re,J,J+ue)},c:function(re){const J=R.length,ue=Math.max(re>>>0,Math.ceil(1.2*J)),ve=Math.ceil((ue-J)/65536);try{return N.grow(ve),W(),!0}catch{return!1}},b:Y}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(M,ne):M.then(re=>re.arrayBuffer()).then(re=>WebAssembly.instantiate(re,ne))).then(re=>{const{Rb:J,Qb:ue,P:ve,T:Ie,X:Ge,Ja:ze,La:$e,Qa:st,Va:Fe,Wa:rt,eb:ht,jb:pt,f:Tt,e:Ot,yb:Ft,zb:Pt,Ab:sn,Bb:Cn,Db:Jt,Gb:Jn}=re.instance.exports;N=Ot;const Fn=(()=>{let Pn=0,Sn=0,wo=0,Xn=0;return io=>{wo&&(J(Xn),J(Pn),Sn+=wo,wo=Pn=0),Pn||(Sn+=128,Pn=ue(Sn));const Uo=io.length+7&-8;let Qo=Pn;Uo>=Sn&&(wo=Uo,Qo=Xn=ue(Uo));for(let er=0;er<io.length;er++)R[Qo+er]=io[er];return Qo}})();return W(),Tt(),{memory:Ot,_free:J,_malloc:ue,Mesh:class{constructor(){this.ptr=ve()}destroy(){Ie(this.ptr)}},Decoder:class{constructor(){this.ptr=ze()}destroy(){pt(this.ptr)}DecodeArrayToMesh(Pn,Sn,wo){const Xn=Fn(Pn),io=$e(this.ptr,Xn,Sn,wo.ptr);return!!Ge(io)}GetAttributeByUniqueId(Pn,Sn){return{ptr:st(this.ptr,Pn.ptr,Sn)}}GetTrianglesUInt16Array(Pn,Sn,wo){Fe(this.ptr,Pn.ptr,Sn,wo)}GetTrianglesUInt32Array(Pn,Sn,wo){rt(this.ptr,Pn.ptr,Sn,wo)}GetAttributeDataArrayForAllPoints(Pn,Sn,wo,Xn,io){ht(this.ptr,Pn.ptr,Sn.ptr,wo,Xn,io)}},DT_INT8:Ft(),DT_UINT8:Pt(),DT_INT16:sn(),DT_UINT16:Cn(),DT_UINT32:Jt(),DT_FLOAT32:Jn()}})}(fetch(gI())),xv.then(M=>{Dc=M,xv=void 0}))}()),O&&x.push(function(){if(Wx)return;const M=function(R){let N;const W=WebAssembly.instantiateStreaming(R,{}).then(re=>{N=re.instance,N.exports.__wasm_call_ctors()}),Y={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ne={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(re,J,ue,ve,Ie,Ge){(function(ze,$e,st,Fe,rt,ht,pt){const Tt=ze.exports.sbrk,Ot=Fe+3&-4,Ft=Tt(Ot*rt),Pt=Tt(ht.length),sn=new Uint8Array(ze.exports.memory.buffer);sn.set(ht,Pt);const Cn=$e(Ft,Fe,rt,Pt,ht.length);if(Cn===0&&pt&&pt(Ft,Ot,rt),st.set(sn.subarray(Ft,Ft+Fe*rt)),Tt(Ft-Tt(0)),Cn!==0)throw new Error(`Malformed buffer data: ${Cn}`)})(N,N.exports[ne[Ie]],re,J,ue,ve,N.exports[Y[Ge]])}}}(fetch(vI()));return M.ready.then(()=>{Wx=M})}()),h)for(let M=0;M<h.length;M++)x.push(gN(h[M],u,M,a));return(x.length?Promise.all(x):Promise.resolve()).then(()=>{if(A&&v)for(const{primitives:M}of v)for(const R of M)fN(R,u);if(O&&v&&k)for(const M of k)pN(M,u);return u})})}function uf(c,n){const a=c.json.bufferViews[n.bufferView],u=p0[n.componentType];return new u(c.buffers[a.buffer],(n.byteOffset||0)+(a.byteOffset||0),n.count*(a.byteStride&&a.byteStride!==wv[n.type]*u.BYTES_PER_ELEMENT?a.byteStride/u.BYTES_PER_ELEMENT:wv[n.type]))}function Kx(c,n,a,u){const m=p0[n.componentType],h=function(x){switch(x){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),v=c.json.bufferViews[n.bufferView],T=v.byteStride?v.byteStride/m.BYTES_PER_ELEMENT:wv[n.type],k=a.float32,L=k.length/a.capacity;for(let x=0,A=0;x<n.count*T;x+=T,A+=L)for(let O=0;O<L;O++)k[A+O]=u[x+O]*h;a._trim()}function vN(c,n,a){const u=c.indices,m=c.attributes,h={};h.indexArray=new bi;const v=n.json.accessors[u],T=v.count/3;h.indexArray.reserve(T);const k=uf(n,v);for(let O=0;O<T;O++)h.indexArray.emplaceBack(k[3*O],k[3*O+1],k[3*O+2]);h.indexArray._trim(),h.vertexArray=new du;const L=n.json.accessors[m.POSITION];h.vertexArray.reserve(L.count);const x=uf(n,L);for(let O=0;O<L.count;O++)h.vertexArray.emplaceBack(x[3*O],x[3*O+1],x[3*O+2]);if(h.vertexArray._trim(),h.aabb=new Fr(L.min,L.max),h.centroid=function(O,M){const R=[0,0,0],N=O.length;if(N>0){for(let W=0;W<N;W++){const Y=3*O[W];R[0]+=M[Y],R[1]+=M[Y+1],R[2]+=M[Y+2]}R[0]/=N,R[1]/=N,R[2]/=N}return R}(k,x),m.COLOR_0!==void 0){const O=n.json.accessors[m.COLOR_0],M=wv[O.type],R=uf(n,O);h.colorArray=M===3?new du:new Tc,h.colorArray.resize(O.count),Kx(n,O,h.colorArray,R)}if(m.NORMAL!==void 0){h.normalArray=new du;const O=n.json.accessors[m.NORMAL];h.normalArray.resize(O.count);const M=uf(n,O);Kx(n,O,h.normalArray,M)}if(m.TEXCOORD_0!==void 0&&a.length>0){h.texcoordArray=new Jh;const O=n.json.accessors[m.TEXCOORD_0];h.texcoordArray.resize(O.count);const M=uf(n,O);Kx(n,O,h.texcoordArray,M)}if(m._FEATURE_ID_RGBA4444!==void 0){const O=n.json.accessors[m._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=uf(n,O))}m._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(uf(n,n.json.accessors[m._FEATURE_RGBA4444]).buffer));const A=c.material;return h.material=function(O,M){const{emissiveFactor:R=[0,0,0],alphaMode:N="OPAQUE",alphaCutoff:W=.5,normalTexture:Y,occlusionTexture:ne,emissiveTexture:re,doubleSided:J}=O,{baseColorFactor:ue=[1,1,1,1],metallicFactor:ve=1,roughnessFactor:Ie=1,baseColorTexture:Ge,metallicRoughnessTexture:ze}=O.pbrMetallicRoughness||{},$e=ne?M[ne.index]:void 0;if(ne&&ne.extensions&&ne.extensions.KHR_texture_transform&&$e){const st=ne.extensions.KHR_texture_transform;$e.offsetScale=[st.offset[0],st.offset[1],st.scale[0],st.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Ln(...ue),metallicFactor:ve,roughnessFactor:Ie,baseColorTexture:Ge?M[Ge.index]:void 0,metallicRoughnessTexture:ze?M[ze.index]:void 0},doubleSided:J,emissiveFactor:R,alphaMode:N,alphaCutoff:W,normalTexture:Y?M[Y.index]:void 0,occlusionTexture:$e,emissionTexture:re?M[re.index]:void 0,defined:O.defined===void 0}}(A!==void 0?n.json.materials[A]:{defined:!1},a),h}function TI(c,n,a){const{matrix:u,rotation:m,translation:h,scale:v,mesh:T,extras:k,children:L}=c,x={};if(x.matrix=u||Re.mat4.fromRotationTranslationScale([],m||[0,0,0,1],h||[0,0,0],v||[1,1,1]),T!==void 0){x.meshes=a[T];const A=x.anchor=[0,0];for(const O of x.meshes){const{min:M,max:R}=O.aabb;A[0]+=M[0]+R[0],A[1]+=M[1]+R[1]}A[0]=Math.floor(A[0]/x.meshes.length/2),A[1]=Math.floor(A[1]/x.meshes.length/2)}if(k&&(k.id&&(x.id=k.id),k.lights&&(x.lights=function(A){if(!A.length)return[];const O=function(Y){const ne=atob(Y),re=new Uint8Array(ne.length);for(let J=0;J<ne.length;J++)re[J]=ne.codePointAt(J);return re}(A),M=[],R=O.length/24,N=new Uint16Array(O.buffer),W=new Float32Array(O.buffer);for(let Y=0;Y<R;Y++){const ne=N[2*Y*6]/30,re=N[2*Y*6+1]/30,J=N[2*Y*6+10]/100,ue=W[6*Y+1],ve=W[6*Y+2],Ie=W[6*Y+3],Ge=W[6*Y+4],ze=Ie-ue,$e=Ge-ve,st=Math.hypot(ze,$e);M.push({pos:[ue+.5*ze,ve+.5*$e,re],normal:[$e/st,-ze/st,0],width:st,height:ne,depth:J,points:[ue,ve,Ie,Ge]})}return M}(k.lights))),L){const A=[];for(const O of L)A.push(TI(n.json.nodes[O],n,a));x.children=A}return x}function _N(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new nx(c.vertices,c.indices,8,256),[a,u]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:a,max:u}}function yN(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const a=n[0];if(!a||!Array.isArray(a)||a.length===0)return null;const u=[];for(const v of a){if(!Array.isArray(v)||v.length!==2)continue;const T=v[0],k=v[1];typeof T=="number"&&typeof k=="number"&&u.push(new Be(T,k))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let m=0;for(let v=0;v<u.length;v++){const T=u[v],k=u[(v+1)%u.length],L=u[(v+2)%u.length];m+=(T.x-k.x)*(L.y-k.y)-(L.x-k.x)*(T.y-k.y)}m>0&&u.reverse();const h=qg(u.flatMap(v=>[v.x,v.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function bN(c,n){const a=[],u=[];let m=0;const h=[];for(const v of c){m=a.length;const T=v.vertexArray.float32,k=v.indexArray.uint16;for(let L=0;L<v.vertexArray.length;L++)h[0]=T[3*L+0],h[1]=T[3*L+1],h[2]=T[3*L+2],Re.vec3.transformMat4(h,h,n),a.push(new Be(h[0],h[1]));for(let L=0;L<3*v.indexArray.length;L++)u.push(k[L]+m)}if(u.length%3!=0)return null;for(let v=0;v<u.length;v+=3){const T=a[u[v+0]],k=a[u[v+1]],L=a[u[v+2]];(T.x-k.x)*(L.y-k.y)-(L.x-k.x)*(T.y-k.y)>0&&([u[v+1],u[v+2]]=[u[v+2],u[v+1]])}return{vertices:a,indices:u}}function CI(c){const n=function(k,L){const x=[],A=WebGL2RenderingContext;if(k.json.textures)for(const O of k.json.textures){const M={magFilter:A.LINEAR,minFilter:A.NEAREST,wrapS:A.REPEAT,wrapT:A.REPEAT};O.sampler!==void 0&&Object.assign(M,k.json.samplers[O.sampler]),x.push({image:L[O.source],sampler:M,uploaded:!1})}return x}(c,c.images),a=function(k,L){const x=[];for(const A of k.json.meshes){const O=[];for(const M of A.primitives)O.push(vN(M,k,L));x.push(O)}return x}(c,n),{scenes:u,scene:m,nodes:h}=c.json,v=u?u[m||0].nodes:h,T=[];for(const k of v)T.push(TI(h[k],c,a));return function(k,L,x){const A={},O=new Set;for(let M=0;M<k.length;M++){const R=x[L[M]];if(!R.extras)continue;const N=R.extras["mapbox:footprint:version"],W=R.extras["mapbox:footprint:id"];(N||W)&&O.add(M),N==="1.0.0"&&W&&(A[W]=M)}for(let M=0;M<k.length;M++){if(O.has(M))continue;const R=k[M],N=x[L[M]];if(!N.extras)continue;let W=null;R.id in A&&(W=bN(k[A[R.id]].meshes,R.matrix)),W||(W=yN(N)),W&&(R.footprint=_N(W))}if(O.size>0){const M=Array.from(O.values()).sort((R,N)=>R-N);for(let R=M.length-1;R>=0;R--)k.splice(M[R],1)}}(T,v,c.json.nodes),T}function xN(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,a=c.aabb.min[0]-1,u=c.aabb.min[1]-1,m=lf/(c.aabb.max[0]-a+2),h=lf/(c.aabb.max[1]-u+2);for(let v=0;v<n.length;v+=3){const T=n[v+2],k=(n[v+0]-a)*m|0,L=(n[v+1]-u)*h|0;T>c.heightmap[L*lf+k]&&(c.heightmap[L*lf+k]=T)}}function wN(c,n){const a={};a.indexArray=new bi,a.indexArray.reserve(4*c.length),a.vertexArray=new du,a.vertexArray.reserve(10*c.length),a.colorArray=new Tc,a.vertexArray.reserve(10*c.length);let u=0;for(const v of c){const T=Math.min(10,Math.max(4,1.3*v.height))*n,k=[-v.normal[1],v.normal[0],0],L=Math.min(.29,.1*v.width/v.depth),x=v.width-2*v.depth*n*(L+.01),A=Re.vec3.scaleAndAdd([],v.pos,k,x/2),O=Re.vec3.scaleAndAdd([],v.pos,k,-x/2),M=[A[0],A[1],A[2]+v.height],R=[O[0],O[1],O[2]+v.height],N=Re.vec3.scaleAndAdd([],v.normal,k,L);Re.vec3.scale(N,N,T);const W=Re.vec3.scaleAndAdd([],v.normal,k,-L);Re.vec3.scale(W,W,T),Re.vec3.add(N,A,N),Re.vec3.add(W,O,W),A[2]+=.1,O[2]+=.1,a.vertexArray.emplaceBack(N[0],N[1],N[2]),a.vertexArray.emplaceBack(W[0],W[1],W[2]),a.vertexArray.emplaceBack(A[0],A[1],A[2]),a.vertexArray.emplaceBack(O[0],O[1],O[2]),a.vertexArray.emplaceBack(M[0],M[1],M[2]),a.vertexArray.emplaceBack(R[0],R[1],R[2]),a.vertexArray.emplaceBack(A[0],A[1],A[2]),a.vertexArray.emplaceBack(O[0],O[1],O[2]),a.vertexArray.emplaceBack(N[0],N[1],N[2]),a.vertexArray.emplaceBack(W[0],W[1],W[2]);const Y=x/T/2;a.colorArray.emplaceBack(-Y-L,-1,Y,.8),a.colorArray.emplaceBack(Y+L,-1,Y,.8),a.colorArray.emplaceBack(-Y,0,Y,1.3),a.colorArray.emplaceBack(Y,0,Y,1.3),a.colorArray.emplaceBack(Y+L,-.8,Y,.7),a.colorArray.emplaceBack(Y+L,-.8,Y,.7),a.colorArray.emplaceBack(0,0,Y,1.3),a.colorArray.emplaceBack(0,0,Y,1.3),a.colorArray.emplaceBack(Y+L,-1.2,Y,.8),a.colorArray.emplaceBack(Y+L,-1.2,Y,.8),a.indexArray.emplaceBack(6+u,4+u,8+u),a.indexArray.emplaceBack(7+u,9+u,5+u),a.indexArray.emplaceBack(0+u,1+u,2+u),a.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const m={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=Ln.white,m.pbrMetallicRoughness=h,a.material=m,a.aabb=new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),a}class EI{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const u=n[a];this._stringToNumber[u]=a,this._numberToString[a]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}class MI{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Bu(Nn,16,0),this.featureIndexArray=new xy,this.promoteId=a,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,a,u,m,h,v=0,T=0){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,h,v);const L=this.grid;for(let x=0;x<a.length;x++){const A=a[x],O=[1/0,1/0,-1/0,-1/0];for(let M=0;M<A.length;M++){const R=A[M];O[0]=Math.min(O[0],R.x),O[1]=Math.min(O[1],R.y),O[2]=Math.max(O[2],R.x),O[3]=Math.max(O[3],R.y)}T!==0&&(O[0]-=T,O[1]-=T,O[2]+=T,O[3]+=T),O[0]<Nn&&O[1]<Nn&&O[2]>=0&&O[3]>=0&&L.insert(k,O[0],O[1],O[2],O[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ap.VectorTile(new Hy(this.rawTileData)).layers,this.sourceLayerCoder=new EI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,a,u){this.loadVTLayers(),this.serializedLayersCache.clear();const m=hp(n.filter),h=n.tileResult,v=n.transform,T=h.bufferedTilespaceBounds,k=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(O,M,R,N)=>Kr(h.bufferedTilespaceGeometry,O,M,R,N));k.sort(SN);let L=null;v.elevation&&k.length>0&&(L=zp.create(v.elevation,this.tileID));const x={};let A;for(let O=0;O<k.length;O++){const M=k[O];if(M===A)continue;A=M;const R=this.featureIndexArray.get(M);let N=null;if(this.is3DTile){const W=this.bucketLayerIDs[0][0],Y=a[W];if(Y.type!=="model")continue;const{queryFeature:ne,intersectionZ:re}=Y.queryIntersectsMatchingFeature(h,R.featureIndex,m,v);ne&&this.appendToResult(x,W,R.featureIndex,ne,re)}else this.loadMatchingFeature(x,R,m,n.layers,n.availableImages,a,u,(W,Y,ne,re=0)=>(N||(N=It(W,this.tileID.canonical,n.tileTransform)),Y.queryIntersectsFeature(h,W,ne,N,this.z,n.transform,n.pixelPosMatrix,L,re)))}return x}loadMatchingFeature(n,a,u,m,h,v,T,k){const{featureIndex:L,bucketIndex:x,sourceLayerIndex:A,layoutVertexArrayOffset:O}=a,M=this.bucketLayerIDs[x];if(m.length&&!function(Y,ne){for(let re=0;re<Y.length;re++)if(ne.indexOf(Y[re])>=0)return!0;return!1}(m,M))return;const R=this.sourceLayerCoder.decode(A),N=this.vtLayers[R].feature(L);if(u.needGeometry){const Y=pn(N,!0);if(!u.filter(new Ei(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!u.filter(new Ei(this.tileID.overscaledZ),N))return;const W=this.getId(N,R);for(let Y=0;Y<M.length;Y++){const ne=M[Y];if(m.length&&m.indexOf(ne)<0)continue;const re=v[ne];if(!re)continue;let J={};W!==void 0&&T&&(J=T.getState(re.sourceLayer||"_geojsonTileLayer",W));const ue=!k||k(N,re,J,O);if(!ue)continue;const ve=new pv(N,this.z,this.x,this.y,W);let Ie=this.serializedLayersCache.get(ne);Ie||(Ie=re.serialize(),Ie.id=ne,this.serializedLayersCache.set(ne,Ie)),ve.layer=mo({},Ie),ve.tile=this.tileID.canonical,ve.layer.paint=II(Ie.paint,re.paint,N,J,h),ve.layer.layout=II(Ie.layout,re.layout,N,J,h),this.appendToResult(n,ne,L,ve,ue)}}appendToResult(n,a,u,m,h){let v=n[a];v===void 0&&(v=n[a]=[]),v.push({featureIndex:u,feature:m,intersectionZ:h})}lookupSymbolFeatures(n,a,u,m,h,v,T){const k={};this.loadVTLayers();const L=hp(m);for(const x of n)this.loadMatchingFeature(k,{bucketIndex:a,sourceLayerIndex:u,featureIndex:x,layoutVertexArrayOffset:0},L,h,v,T);return k}loadFeature(n){const{featureIndex:a,sourceLayerIndex:u}=n;this.loadVTLayers();const m=this.sourceLayerCoder.decode(u),h=this.vtFeatures[m];if(h[a])return h[a];const v=this.vtLayers[m].feature(a);return h[a]=v,v}hasLayer(n){for(const a of this.bucketLayerIDs)for(const u of a)if(n===u)return!0;return!1}getId(n,a){let u=n.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[a];m!=null&&(u=n.properties[m]),typeof u=="boolean"&&(u=Number(u))}return u}}function II(c,n,a,u,m){return ft(c,(h,v)=>{const T=n instanceof Ad?n.get(v):null;return T&&T.evaluate?T.evaluate(a,u,m):T})}function SN(c,n){return n-c}no(MI,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const AI=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Zx{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,u]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=u>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const h=AI[15&u];if(!h)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[T]=new Uint32Array(n,4,1);return new Zx(T,v,h,n)}constructor(n,a=64,u=Float64Array,m){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const h=AI.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,T=n*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-T%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+k,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+k),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+k,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=a,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Yx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:v,nodeSize:T}=this,k=[0,h.length-1,0],L=[];for(;k.length;){const x=k.pop()||0,A=k.pop()||0,O=k.pop()||0;if(A-O<=T){for(let W=O;W<=A;W++){const Y=v[2*W],ne=v[2*W+1];Y>=n&&Y<=u&&ne>=a&&ne<=m&&L.push(h[W])}continue}const M=O+A>>1,R=v[2*M],N=v[2*M+1];R>=n&&R<=u&&N>=a&&N<=m&&L.push(h[M]),(x===0?n<=R:a<=N)&&(k.push(O),k.push(M-1),k.push(1-x)),(x===0?u>=R:m>=N)&&(k.push(M+1),k.push(A),k.push(1-x))}return L}within(n,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:h,nodeSize:v}=this,T=[0,m.length-1,0],k=[],L=u*u;for(;T.length;){const x=T.pop()||0,A=T.pop()||0,O=T.pop()||0;if(A-O<=v){for(let W=O;W<=A;W++)PI(h[2*W],h[2*W+1],n,a)<=L&&k.push(m[W]);continue}const M=O+A>>1,R=h[2*M],N=h[2*M+1];PI(R,N,n,a)<=L&&k.push(m[M]),(x===0?n-u<=R:a-u<=N)&&(T.push(O),T.push(M-1),T.push(1-x)),(x===0?n+u>=R:a+u>=N)&&(T.push(M+1),T.push(A),T.push(1-x))}return k}}function Yx(c,n,a,u,m,h){if(m-u<=a)return;const v=u+m>>1;kI(c,n,v,u,m,h),Yx(c,n,a,u,v-1,1-h),Yx(c,n,a,v+1,m,1-h)}function kI(c,n,a,u,m,h){for(;m>u;){if(m-u>600){const L=m-u+1,x=a-u+1,A=Math.log(L),O=.5*Math.exp(2*A/3),M=.5*Math.sqrt(A*O*(L-O)/L)*(x-L/2<0?-1:1);kI(c,n,a,Math.max(u,Math.floor(a-x*O/L+M)),Math.min(m,Math.floor(a+(L-x)*O/L+M)),h)}const v=n[2*a+h];let T=u,k=m;for(Sv(c,n,u,a),n[2*m+h]>v&&Sv(c,n,u,m);T<k;){for(Sv(c,n,T,k),T++,k--;n[2*T+h]<v;)T++;for(;n[2*k+h]>v;)k--}n[2*u+h]===v?Sv(c,n,u,k):(k++,Sv(c,n,k,m)),k<=a&&(u=k+1),a<=k&&(m=k-1)}}function Sv(c,n,a,u){Xx(c,a,u),Xx(n,2*a,2*u),Xx(n,2*a+1,2*u+1)}function Xx(c,n,a){const u=c[n];c[n]=c[a],c[a]=u}function PI(c,n,a,u){const m=c-a,h=n-u;return m*m+h*h}o.$=cy,o.A=class extends c0{},o.B=Vs,o.C=$n,o.D=Cg,o.E=Kn,o.F=ug,o.G=zu,o.H=cg,o.I=bx,o.J=ip,o.K=$u,o.L=Fu,o.M=Ed,o.N=ri,o.O=$a,o.P=Be,o.Q=li,o.R=ac,o.S=va,o.T=Rx,o.U=yo,o.V=c0,o.W=Eg,o.X=dg,o.Y=ny,o.Z=function(c){const n=c.value;let a=[];if(!n)return a;const u=Vs(n);return u!=="string"?(a=a.concat([new c0(c.key,n,`string expected, "${u}" found`)]),a):(UM(n,!0)||(a=a.concat([new c0(c.key,n,`invalid url "${n}"`)])),a)},o._=Lt,o.a=function(c){return qe.API_CDN_URL_REGEX.test(c)},o.a$=uu,o.a0=ci,o.a1=Rn,o.a2=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return hi(c.expression.evaluate(n))}interpolate(c,n,a){return{x:uo(c.x,n.x,a),y:uo(c.y,n.y,a),z:uo(c.z,n.z,a),azimuthal:uo(c.azimuthal,n.azimuthal,a),polar:uo(c.polar,n.polar,a)}}},o.a3=Ei,o.a4=Uh,o.a5=vt,o.a6=Re,o.a7=kn,o.a8=Ad,o.a9=Vd,o.aA=_r,o.aB=AM,o.aC=DM,o.aD=IM,o.aE=function(c,n){const a=document.createElement("video");a.muted=!0,a.onloadstart=function(){n(null,a)};for(let u=0;u<c.length;u++){const m=document.createElement("source");Ya(c[u])||(a.crossOrigin="Anonymous"),m.src=c[u],a.appendChild(m)}return{cancel:()=>{}}},o.aF=r0,o.aG=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>SI(n,0,c))},o.aH=CI,o.aI=class{constructor(c,n,a,u){this.id=c,this.position=n!=null?new j(n[0],n[1]):new j(0,0),this.orientation=a??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(Re.mat4.multiply(c.matrix,n,c.matrix),c.meshes)for(const a of c.meshes){const u=Fr.applyTransformFast(a.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const a of c.children)this._applyTransformations(a,c.matrix)}computeBoundsAndApplyParent(){const c=Re.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,a,u,m,h,v=!1){qM(this.matrix,this,c.transform,this.position,n,a,u,m,h,v)}upload(c){if(!this.uploaded){for(const n of this.nodes)Fx(n,c);for(const n of this.nodes)u0(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)Bx(c)}},o.aJ=Dt,o.aK=function(c){return c.indexOf(qh)>=0},o.aL=sv,o.aM=Le,o.aN=Ue,o.aO=Pd,o.aP=bi,o.aQ=Ho,o.aR=Sp,o.aS=n0,o.aT=function(){Ss.isLoading()||Ss.isLoaded()||Sg()!=="deferred"||ly()},o.aU=hp,o.aV=pn,o.aW=pv,o.aX=Nr,o.aY=dx,o.aZ=tx,o.a_=It,o.aa=uo,o.ab=Nn,o.ac=hr,o.ad=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([a,u]){const m=hi([1,a,u]);return{x:m.x,y:m.y,z:m.z}}(c.expression.evaluate(n))}interpolate(c,n,a){return{x:uo(c.x,n.x,a),y:uo(c.y,n.y,a),z:uo(c.z,n.z,a)}}},o.ae=function(c,n,a=0,u=!0){const m=new Be(a,a),h=c.sub(m),v=n.add(m),T=[h,new Be(v.x,h.y),v,new Be(h.x,v.y)];return u&&T.push(h.clone()),T},o.af=function(c,n){const a=[];for(let u=0;u<c.length;u++){const m=qn(u-1,-1,c.length-1),h=qn(u+1,-1,c.length-1),v=c[u],T=c[h],k=c[m].sub(v).unit(),L=T.sub(v).unit(),x=L.angleWithSep(k.x,k.y),A=k.add(L).unit().mult(-1*n/Math.sin(x/2));a.push(v.add(A))}return a},o.ag=pM,o.ah=Kr,o.ai=function(c,n,a=0){return Re.vec3.fromValues(((n.x-a)*c.scale-c.x)*Nn,(n.y*c.scale-c.y)*Nn,je(n.z,n.y))},o.aj=rs,o.ak=OE,o.al=function(c){let n=1/0,a=1/0,u=-1/0,m=-1/0;for(const h of c)n=Math.min(n,h.x),a=Math.min(a,h.y),u=Math.max(u,h.x),m=Math.max(m,h.y);return{min:new Be(n,a),max:new Be(u,m)}},o.am=_e,o.an=mr,o.ao=ct,o.ap=yt,o.aq=ya,o.ar=function(c,n){const a={};for(let u=0;u<n.length;u++){const m=n[u];m in c&&(a[m]=c[m])}return a},o.as=X,o.at=Te,o.au=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,a,u){const m=this.entries[c]=this.entries[c]||{callbacks:[]};if(m.result){const[h,v]=m.result;return this.scheduler?this.scheduler.add(()=>{u(h,v)},n):u(h,v),()=>{}}return m.callbacks.push(u),m.cancel||(m.cancel=a((h,v)=>{m.result=[h,v];for(const T of m.callbacks)this.scheduler?this.scheduler.add(()=>{T(h,v)},n):T(h,v);setTimeout(()=>delete this.entries[c],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(h=>h!==u),m.callbacks.length||(m.cancel(),delete this.entries[c]))}}},o.av=mp,o.aw=function(c,n,a){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},m=>{const h=tu(c.request,(v,T,k,L)=>{v?m(v):T&&m(null,{vectorTile:a?void 0:new Ap.VectorTile(new Hy(T)),rawData:T,cacheControl:k,expires:L})});return()=>{h.cancel(),m()}},n)},o.ax=function(c){To++,To>Eo&&(c.getActor().send("enforceCacheSizeLimit",Lo),To=0)},o.ay=gt,o.az=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},o.b=function(c){return qe.API_FONTS_REGEX.test(c)},o.b$=is,o.b0=zg,o.b1=Ul,o.b2=ki,o.b3=qg,o.b4=Ax,o.b5=function(c,n){const a=Vd(n.zoom);if(a===0)return fu(c);const u=ky(c),m=W1(u),h=_e(u.getWest())*n.worldSize,v=_e(u.getEast())*n.worldSize,T=Te(u.getNorth())*n.worldSize,k=Te(u.getSouth())*n.worldSize,L=[h,T,0],x=[v,T,0],A=[h,k,0],O=[v,k,0],M=Re.mat4.invert([],n.globeMatrix);return Re.vec3.transformMat4(L,L,M),Re.vec3.transformMat4(x,x,M),Re.vec3.transformMat4(A,A,M),Re.vec3.transformMat4(O,O,M),m[0]=Hu(m[0],A,a),m[1]=Hu(m[1],O,a),m[2]=Hu(m[2],x,a),m[3]=Hu(m[3],L,a),Fr.fromPoints(m)},o.b6=Ry,o.b7=Gg,o.b8=Hu,o.b9=gp,o.bA=Ln,o.bB=qn,o.bC=Et,o.bD=Bi,o.bE=we,o.bF=function(c,n,a){c[4*n+0]=a[0],c[4*n+1]=a[1],c[4*n+2]=a[2],c[4*n+3]=a[3]},o.bG=nf,o.bH=$l,o.bI=$g,o.bJ=Qi,o.bK=ju,o.bL=j,o.bM=yM,o.bN=wr,o.bO=Ys,o.bP=FM,o.bQ=ea,o.bR=SC,o.bS=function(c,n,a,u,m,h,v,T,k){if(k.name==="globe")return SC(c,n,new ea(a,u,m),!1);const L=sv({z:a,x:u,y:m},k);return new Fr([(h+L.x/L.scale)*n,n*(L.y/L.scale),v],[(h+L.x2/L.scale)*n,n*(L.y2/L.scale),T])},o.bT=function(c,n,a){let u=0;for(let m=0;m<2;++m)c[m]>0&&(u+=(c[m]-0)*(c[m]-0)),n[m]<0&&(u+=(0-n[m])*(0-n[m]));return u},o.bU=Ye,o.bV=f,o.bW=function(c){const n=Re.mat4.identity(new Float64Array(16));Re.mat4.multiply(n,c.pixelMatrix,c.globeMatrix);const a=[0,b,0],u=[0,w,0];return Re.vec3.transformMat4(a,a,n),Re.vec3.transformMat4(u,u,n),[a[0]>0&&a[0]<=c.width&&a[1]>0&&a[1]<=c.height&&!Z1(c,new j(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!Z1(c,new j(c.center.lat,-90))]},o.bX=function(c,n){const{scale:a}=c.tileTransform,u=a*Nn/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return Re.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},o.bY=s0,o.bZ=zM,o.b_=function(c){const n=zM(c,!0);return Re.mat2.invert([],[n[0],n[1],n[4],n[5]])},o.ba=ra,o.bb=jx,o.bc=Hy,o.bd=tu,o.be=function(c){const n=[];for(const a in c)n.push(c[a]);return n},o.bf=function(c,n){const a=[];for(const u in c)u in n||a.push(u);return a},o.bg=Co,o.bh=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bi=Ht,o.bj=function(c,n){const{x:a,y:u}=c.point,m=EC(a,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Re.mat4.multiply(m,m,q1(fu(n)))},o.bk=kp,o.bl=gl,o.bm=jy,o.bn=function(c,n,a,u,m){const h=5*n+2;c.float32[h+0]=a,c.float32[h+1]=u,c.float32[h+2]=m},o.bo=t0,o.bp=oM,o.bq=hn,o.br=ba,o.bs=iE,o.bt=VM,o.bu=uE,o.bv=dE,o.bw=Sx,o.bx=uM,o.by=yx,o.bz=Zx,o.c=it,o.c$=Jr,o.c0=function(c){const{x:n,y:a}=c.point,{lng:u,lat:m}=c._center;return EC(n,a,c.worldSize,u,m)},o.c1=Gt,o.c2=kr,o.c3=Ay,o.c4=function(c){const n=Math.round((c+45+360)%360/90)%4;return ln[n]},o.c5=45,o.c6=be,o.c7=Ep,o.c8=function(c,n,a){const u=Math.sqrt(c*c+n*n+a*a),m=u>0?Math.acos(a/u)*Nt:0;let h=c!==0||n!==0?Math.atan2(-n,-c)*Nt+90:0;return h<0&&(h+=360),[u,h,m]},o.c9=lt,o.cA=function(c){const n=Ye-5;c=yt(c,-n,n)/n*90;const a=Math.pow(Math.abs(Math.sin(Et(c))),3);return Math.round(a*(p.length-1))},o.cB=function(c,n,a,u){const m=n.getNorth(),h=n.getSouth(),v=n.getWest(),T=n.getEast(),k=1<<c.z,L=T-v,x=m-h,A=L/l,O=-x/p[a],M=[0,A,0,O,0,0,m,v,0];if(c.z>0){const R=180/u;Re.mat3.multiply(M,M,[R/L+1,0,0,0,R/x+1,0,-.5*R/A,.5*R/O,1])}return M[2]=k,M[5]=c.x,M[8]=c.y,M},o.cC=fu,o.cD=function(c,n,a){const u=Re.mat4.identity(new Float64Array(16)),m=(n/(1<<c)-.5)*Math.PI*2;return Re.mat4.rotateY(u,a.globeMatrix,m),Float32Array.from(u)},o.cE=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const a=n.getSource().maxzoom,u=1<<a,m=Math.floor(c.x),h=Math.floor((c.x-m)*u),v=Math.floor(c.y*u),T=this.findDEMTileFor(new _r(a,m,a,h,v));return!(!T||!T.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,a=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||c.y<0||c.y>1)return n;const m=u.getSource().maxzoom,h=1<<m,v=Math.floor(c.x),T=c.x-v,k=new _r(m,v,m,Math.floor(T*h),Math.floor(c.y*h)),L=this.findDEMTileFor(k);if(!L||!L.dem)return n;const x=L.dem,A=1<<L.tileID.canonical.z,O=(T*A-L.tileID.canonical.x)*x.dim,M=(c.y*A-L.tileID.canonical.y)*x.dim,R=Math.floor(O),N=Math.floor(M);return(a?this.exaggeration():1)*uo(uo(x.get(R,N),x.get(R,N+1),M-N),uo(x.get(R+1,N),x.get(R+1,N+1),M-N),O-R)}getAtTileOffset(c,n,a){const u=1<<c.canonical.z;return this.getAtPointOrZero(new vt(c.wrap+(c.canonical.x+n/Nn)/u,(c.canonical.y+a/Nn)/u))}getAtTileOffsetFunc(c,n,a,u){return m=>{const h=this.getAtTileOffset(c,m.x,m.y),v=u.upVector(c.canonical,m.x,m.y),T=u.upVectorScale(c.canonical,n,a).metersToTile;return Re.vec3.scale(v,v,h*T),v}}getForTilePoints(c,n,a,u){if(this.isUsingMockSource())return!1;const m=zp.create(this,c,u);return!!m&&(n.forEach(h=>{h[2]=this.exaggeration()*m.getElevationAt(h[0],h[1],a)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const a=n.dem.tree,u=n.tileID,m=1<<c.canonical.z-u.canonical.z;let h=c.canonical.x/m-u.canonical.x,v=c.canonical.y/m-u.canonical.y,T=0;for(let k=0;k<c.canonical.z-u.canonical.z&&!a.leaves[T];k++){h*=2,v*=2;const L=2*Math.floor(v)+Math.floor(h);T=a.childOffsets[T]+L,h%=1,v%=1}return{min:this.exaggeration()*a.minimums[T],max:this.exaggeration()*a.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,a){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,a=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const m of c){const h=this.getMinMaxForTile(m.tileID);h&&(a=Math.min(a,h.min),u=Math.max(u,h.max),n=!0)}return n?{min:a,max:u}:null}},o.cF=NC,o.cG=Nd,o.cH=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},o.cI=CC,o.cJ=ke,o.cK=Ee,o.cL=256,o.cM=function(c,n){const a=[0,0,0],u=Ry(fu(n.canonical));return Re.vec3.transformMat4(a,a,u),Re.vec3.transformMat4(a,a,c),a},o.cN=c=>({u_camera_to_center_distance:new Qi(c),u_extrude_scale:new Mp(c),u_device_pixel_ratio:new Qi(c),u_matrix:new nf(c),u_inv_rot_matrix:new nf(c),u_merc_center:new $l(c),u_tile_id:new $g(c),u_zoom_transition:new Qi(c),u_up_dir:new $g(c),u_emissive_strength:new Qi(c)}),o.cO=c=>({u_matrix:new nf(c),u_pixels_to_tile_units:new Mp(c),u_device_pixel_ratio:new Qi(c),u_units_to_pixels:new $l(c),u_dash_image:new ju(c),u_gradient_image:new ju(c),u_image_height:new Qi(c),u_texsize:new $l(c),u_tile_units_to_pixels:new Qi(c),u_alpha_discard_threshold:new Qi(c),u_trim_offset:new $l(c),u_trim_fade_range:new $l(c),u_trim_color:new Ep(c),u_emissive_strength:new Qi(c),u_zbias_factor:new Qi(c),u_tile_to_meter:new Qi(c)}),o.cP=c=>({u_matrix:new nf(c),u_texsize:new $l(c),u_pixels_to_tile_units:new Mp(c),u_device_pixel_ratio:new Qi(c),u_image:new ju(c),u_units_to_pixels:new $l(c),u_tile_units_to_pixels:new Qi(c),u_alpha_discard_threshold:new Qi(c),u_trim_offset:new $l(c),u_emissive_strength:new Qi(c),u_zbias_factor:new Qi(c),u_tile_to_meter:new Qi(c)}),o.cQ=Od,o.cR=GF,o.cS=WF,o.cT=AC,o.cU=(c,n,a,u,m,h)=>{const v=c.transform,T=v.projection.name==="globe";let k;if(h.paint.get("circle-pitch-alignment")==="map")if(T){const x=CC(v.zoom,n.canonical)*v._pixelsPerMercatorPixel;k=Float32Array.from([x,0,0,x])}else k=v.calculatePixelsToTileUnitsMatrix(a);else k=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const L={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(v.projection),u_matrix:c.translatePosMatrix(n.projMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Yt.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:Z4,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(T){L.u_inv_rot_matrix=u,L.u_merc_center=m,L.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],L.u_zoom_transition=Vd(v.zoom);const x=m[0]*Nn,A=m[1]*Nn;L.u_up_dir=v.projection.upVector(new ea(0,0,0),x,A)}return L},o.cV=FE,o.cW=(c,n,a,u,m,h)=>{const v=c.transform,T=v.pitch<15?LE(.07,.7,yt((14-v.zoom)/5,0,1)):.07;return{u_matrix:zE(c,n,a,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:v.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:m,u_image:0,u_tile_units_to_pixels:DE(n,v),u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:h,u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:T,u_tile_to_meter:lt(n.tileID.canonical,0)}},o.cX=(c,n,a,u,m,h,v)=>{const T=c.transform,k=T.calculatePixelsToTileUnitsMatrix(n),L=T.pitch<15?LE(.07,.7,yt((14-T.zoom)/5,0,1)):.07;return{u_matrix:zE(c,n,a,u),u_pixels_to_tile_units:k,u_device_pixel_ratio:h,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:BE(a)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:DE(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:v,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toRenderColor(a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:lt(n.tileID.canonical,0)}},o.cY=ur,o.cZ=Wg,o.c_=TE,o.ca=Fr,o.cb=hi,o.cc=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},o.cd=function(c){return c({pluginStatus:_a,pluginURL:ws}),wg.on("pluginStateChange",c),c},o.ce=Fp,o.cf=f0,o.cg=Rp,o.ch=xx,o.ci=al,o.cj=sy,o.ck=ho,o.cl=Ve,o.cm=Je,o.cn=function(c){const n=c.indexOf(qh);return n>=0?c.slice(0,n):c},o.co=function(c){const n=c.indexOf(qh);return n>=0?c.slice(n+1):""},o.cp=function(c){const n=[],a=c.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},o.cq=function(c,n,a,u){return c.type==="custom"?new SB(c,n):new DB[c.type](c,n,a,u)},o.cr=un,o.cs=wg,o.ct=sc,o.cu=Vg,o.cv=class extends Ec{constructor(c){super(c),this.current=V1}set(c,n,a){if(this.fetchUniformLocation(c,n)){for(let u=0;u<9;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},o.cw=yn,o.cx=function(c,n,a){const u=Vd(a.zoom),m=c.style.map._antialias,h=n.options.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return u===0&&!m&&!h},o.cy=function(c){const n=c.pixelsPerMeter,a=n/we(1,c.center.lat),u=Re.mat4.identity(new Float64Array(16));return Re.mat4.translate(u,u,[c.point.x,c.point.y,0]),Re.mat4.scale(u,u,[a,a,n]),Float32Array.from(u)},o.cz=ky,o.d=function(c){return qe.API_TILEJSON_REGEX.test(c)},o.d$=S,o.d0=Uy,o.d1=jd,o.d2=450,o.d3=7,o.d4=wB,o.d5=Mr,o.d6=xp,o.d7=256,o.d8=q1,o.d9=du,o.dA=MC,o.dB=function(c){const n=[0,0,0],a=Re.mat4.identity(new Float64Array(16));return Re.mat4.multiply(a,c.pixelMatrix,c.globeMatrix),Re.vec3.transformMat4(n,n,a),new Be(n[0],n[1])},o.dC=function(c,n,a=!1){if(_a===bg||_a===Gh||_a===Wh)throw new Error("setRTLTextPlugin cannot be called multiple times.");ws=Yt.resolveURL(c),_a=bg,up=n,xg(),a||ly()},o.dD=Sg,o.dE=function(){f0().acquire(Hx)},o.dF=function(){const c=bv;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(Hx),bv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.dG=yv,o.dH=function(c){const n=cn();if(!n)return;const a=n.delete(co);c&&a.catch(c).then(()=>c())},o.dI=_v,o.dJ=gI,o.dK=function(c){Gx=Yt.resolveURL(c),$p||($p=new Fp(f0(),new Kn)),$p.broadcast("setDracoUrl",Gx)},o.dL=vI,o.dM=function(c){Np=Yt.resolveURL(c),$p||($p=new Fp(f0(),new Kn)),$p.broadcast("setMeshoptUrl",Np)},o.dN=no,o.dO=Ud,o.dP=Rc,o.dQ=EI,o.dR=MI,o.dS=kE,o.dT=ft,o.dU=iM,o.dV=function(c,n,a,u,m,h,v,T,k,L,x=1,A){c.createArrays(),c.tilePixelRatio=Nn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const O=c.layers[0].layout,M=c.layers[0]._unevaluatedLayout._values,R={};if(R.scaleFactor=x,R.textSizeScaleRange=O.get("text-size-scale-range"),R.iconSizeScaleRange=O.get("icon-size-scale-range"),R.textScaleFactor=yt(R.scaleFactor,R.textSizeScaleRange[0],R.textSizeScaleRange[1]),R.iconScaleFactor=yt(R.scaleFactor,R.iconSizeScaleRange[0],R.iconSizeScaleRange[1]),c.textSizeData.kind==="composite"){const{minZoom:ne,maxZoom:re}=c.textSizeData;R.compositeTextSizes=[M["text-size"].possiblyEvaluate(new Ei(ne),T),M["text-size"].possiblyEvaluate(new Ei(re),T)]}if(c.iconSizeData.kind==="composite"){const{minZoom:ne,maxZoom:re}=c.iconSizeData;R.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new Ei(ne),T),M["icon-size"].possiblyEvaluate(new Ei(re),T)]}R.layoutTextSize=M["text-size"].possiblyEvaluate(new Ei(k+1),T),R.layoutIconSize=M["icon-size"].possiblyEvaluate(new Ei(k+1),T),R.textMaxSize=M["text-size"].possiblyEvaluate(new Ei(18),T);const N=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",W=O.get("text-size");let Y=!1;for(const ne of c.features)if(ne.icon&&ne.icon.nameSecondary){Y=!0;break}for(const ne of c.features){const re=O.get("text-font").evaluate(ne,{},T).join(","),J=W.evaluate(ne,{},T)*R.textScaleFactor,ue=R.layoutTextSize.evaluate(ne,{},T)*R.textScaleFactor,ve=(R.layoutIconSize.evaluate(ne,{},T),{horizontal:{},vertical:void 0}),Ie=ne.text;let Ge,ze=[0,0];if(Ie){const Fe=Ie.toString(),rt=O.get("text-letter-spacing").evaluate(ne,{},T)*ba,ht=O.get("text-line-height").evaluate(ne,{},T)*ba,pt=iy(Fe)?rt:0,Tt=O.get("text-anchor").evaluate(ne,{},T),Ot=O.get("text-variable-anchor");if(!Ot){const Jt=O.get("text-radial-offset").evaluate(ne,{},T);ze=Jt?uM(Tt,[Jt*ba,wx]):O.get("text-offset").evaluate(ne,{},T).map(Jn=>Jn*ba)}let Ft=N?"center":O.get("text-justify").evaluate(ne,{},T);const Pt=O.get("symbol-placement")==="point",sn=Pt?O.get("text-max-width").evaluate(ne,{},T)*ba:1/0,Cn=Jt=>{c.allowVerticalPlacement&&_g(Fe)&&(ve.vertical=_x(Ie,n,a,m,re,sn,ht,Tt,Jt,pt,ze,gl.vertical,!0,ue,J))};if(!N&&Ot){const Jt=Ft==="auto"?Ot.map(Fn=>Sx(Fn)):[Ft];let Jn=!1;for(let Fn=0;Fn<Jt.length;Fn++){const Pn=Jt[Fn];if(!ve.horizontal[Pn])if(Jn)ve.horizontal[Pn]=ve.horizontal[0];else{const Sn=_x(Ie,n,a,m,re,sn,ht,"center",Pn,pt,ze,gl.horizontal,!1,ue,J);Sn&&(ve.horizontal[Pn]=Sn,Jn=Sn.positionedLines.length===1)}}Cn("left")}else{if(Ft==="auto"&&(Ft=Sx(Tt)),Pt||O.get("text-writing-mode").indexOf("horizontal")>=0||!_g(Fe)){const Jt=_x(Ie,n,a,m,re,sn,ht,Tt,Ft,pt,ze,gl.horizontal,!1,ue,J);Jt&&(ve.horizontal[Ft]=Jt)}Cn(Pt?"left":Ft)}}let $e=!1;if(ne.icon&&ne.icon.namePrimary){const Fe=u[ne.icon.namePrimary];Fe&&(Ge=nB(m[ne.icon.namePrimary],ne.icon.nameSecondary?m[ne.icon.nameSecondary]:void 0,O.get("icon-offset").evaluate(ne,{},T),O.get("icon-anchor").evaluate(ne,{},T)),$e=Fe.sdf,c.sdfIcons===void 0?c.sdfIcons=Fe.sdf:c.sdfIcons!==Fe.sdf&&Bn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fe.pixelRatio!==c.pixelRatio||O.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const st=hM(ve.horizontal)||ve.vertical;c.iconsInText||(c.iconsInText=!!st&&st.iconsInText),(st||Ge)&&cB(c,ne,ve,Ge,u,R,ue,0,ze,$e,v,T,L,A,Y)}h&&c.generateCollisionDebugBuffers(k,c.collisionBoxArray,R.textScaleFactor)},o.dW=Ap,o.dX=h0,o.dY=Ke,o.dZ=tE,o.d_=HE,o.da=Uu,o.db=Dg,o.dc=function(c,n,a,u,m){return yt((c-n)/(a-n)*(m-u)+u,u,m)},o.dd=op,o.de=Xe,o.df=class{constructor(c,n,a,u){this.context=c,this.format=u,this.size=a,this.texture=c.gl.createTexture();const[m,h,v]=this.size,{gl:T}=c;T.bindTexture(T.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,m,h,v,0,kx(this.format),Px(this.format),n.data)}bind(c,n){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},o.dg=Dx,o.dh=[1,1,1],o.di=zp,o.dj=Dp,o.dk=hu,o.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Be(1/0,1/0),max:new Be(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const a=sE(new Be(0,0),new Be(Nn,Nn),c),u=[];if(n&&!ax(a,this._globalClipBounds))return u;for(const m of this._activeRegions){if(m.hiddenByOverlap||!ax(a,m))continue;const h=_F(m.min,m.max,c);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[m.priority],footprint:m.footprint,footprintTileId:m.tileId,order:m.order,clipMask:m.clipMask,clipScope:m.clipScope})}return u}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const a=[];for(const u of n.cache.getVisibleCoordinates()){const m=n.cache.getTile(u).buckets[n.layer];m&&m.updateFootprints(u.toUnwrapped(),a)}return a},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const a=c.getOrder(),u=c.getClipMask(),m=c.getClipScope();for(const h of n){if(!h.footprint)continue;const v=sE(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:a,clipMask:u,clipScope:m})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,a)=>n.priority-a.priority||$y(n.min,a.min)||$y(n.max,a.max)||n.order-a.order||n.clipMask-a.clipMask||function(u,m){const h=(v,T)=>v+T;return u.length-m.length||u.reduce(h,"").localeCompare(m.reduce(h,""))}(n.clipScope,a.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const a=this._activeRegions[n],u=this._prevRegions[n];c=a.priority!==u.priority||!aE(a,u)||a.order!==u.order||a.clipMask!==u.clipMask||!Ht(a.clipScope,u.clipScope),++n}}if(c){++this._updateTime;for(const a of this._activeRegions)a.order!==Ny&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,a.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,a.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,a.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,a.max.y));const n=a=>{const u=this._activeRegions;if(a>=u.length)return a;const m=u[a].priority;for(;a<u.length&&u[a].priority===m;)++a;return a};if(this._sourceIds.length>1){let a=0,u=n(a);for(;a!==u;){let m=a;const h=a;for(;m!==u;){const v=this._activeRegions[m];v.hiddenByOverlap=!1;for(let T=0;T<h;T++){const k=this._activeRegions[T];if(!k.hiddenByOverlap&&v.order===Ny&&ax(v,k)&&(v.hiddenByOverlap=cE(v.footprint,v.tileId,k.footprint,k.tileId),v.hiddenByOverlap))break}++m}a=u,u=n(a)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},o.dm=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const a=new uu,u=new bi,m=[],h=c+1+2,v=n[0]+1,T=n[0]+1+(1+n.length),k=(L,x,A)=>{let O=L===h-1?L-2:L===0?L:L-1;return O+=A?24575:0,[O,x]};for(let L=0;L<h;++L)a.emplaceBack(...k(L,0,!0));for(let L=0;L<v;++L)for(let x=0;x<h;++x)a.emplaceBack(...k(x,L,(x===0||x===h-1)&&!0));for(let L=0;L<n.length;++L){const x=n[L];for(let A=0;A<h;++A)a.emplaceBack(...k(A,x,!0))}for(let L=0;L<n.length;++L){const x=u.length,A=n[L]+1+2,O=new bi;for(let N=0;N<A-1;N++){const W=N===A-2,Y=W?h*(T-n.length+L-N):h;for(let ne=0;ne<h-1;ne++){const re=N*h+ne;N===0||W||ne===0||ne===h-2?(O.emplaceBack(re+1,re,re+Y),O.emplaceBack(re+Y,re+Y+1,re+1)):(u.emplaceBack(re+1,re,re+Y),u.emplaceBack(re+Y,re+Y+1,re+1))}}const M=ki.simpleSegment(0,x,a.length,u.length-x);for(let N=0;N<O.uint16.length;N+=3)u.emplaceBack(O.uint16[N],O.uint16[N+1],O.uint16[N+2]);const R=ki.simpleSegment(0,x,a.length,u.length-x);m.push({withoutSkirts:M,withSkirts:R})}return{vertices:a,indices:u,segments:m}}_createGrid(c){const n=this._fillGridMeshWithLods(l,p);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,Ul.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new bi;for(let v=0;v<=l;v++)n.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const a=new Uu,u=new Uu,m=new Uu,h=new Uu;this._poleSegments=[];for(let v=0,T=0;v<Ay;v++){const k=360/(1<<v);a.emplaceBack(0,-ya,0,.5,0),u.emplaceBack(0,-ya,0,.5,1),m.emplaceBack(0,-ya,0,.5,.5),h.emplaceBack(0,-ya,0,.5,.5);for(let L=0;L<=l;L++){let x=L/l,A=0;const O=uo(0,k,x),[M,R,N]=C(q4,K4,O,ya);a.emplaceBack(M,R,N,x,A),u.emplaceBack(M,R,N,x,1-A);const W=Et(O);x=.5+.5*Math.sin(W),A=.5+.5*Math.cos(W),m.emplaceBack(M,R,N,x,A),h.emplaceBack(M,R,N,x,1-A)}this._poleSegments.push(ki.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(a,pi,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,pi,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(m,pi,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(h,pi,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},o.dn=Ny,o.dp=_n,o.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.dr=jn,o.ds=nt,o.dt=D,o.du=function([c,n,a]){const u=Math.hypot(c,n,a),m=Math.atan2(c,a),h=.5*Math.PI-Math.acos(-n/u);return new j(Gt(m),Gt(h))},o.dv=Lx,o.dw=V,o.dx=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(a){if(Xo==null){const u=a.navigator?a.navigator.userAgent:null;Xo=!!a.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Xo}(c)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.dy=function(c,n){Lo=c,Eo=n},o.dz=Z1,o.e=qe,o.e0=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==yI){const a=new Uint32Array(c,0,7),[,,u,m,h,v]=a;n=a.byteLength+m+h+v+h,(u!==c.byteLength||n>=c.byteLength)&&Bn("Invalid b3dm header information.")}return SI(c,n)},o.e1=function(c,n){const a=CI(c);for(const u of a){for(const m of u.meshes)xN(m);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(wN(u.lights,n)))}return a},o.e2=d0,o.e3=QM,o.e4=Ss,o.e5=function(c){Yn(),rr!=null&&rr.then(n=>{n.keys().then(a=>{for(let u=0;u<a.length-c;u++)n.delete(a[u])})})},o.f=function(c){return c.indexOf("mapbox:")===0},o.g=function(c,n){return sc(mo(c,{method:"GET"}),n)},o.h=mt,o.i=function(c){return qe.API_STYLE_REGEX.test(c)&&!it(c)},o.j=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,a)=>String.fromCharCode(+("0x"+a))))},o.l=mo,o.m=$o,o.n=function(c,n){return sc(mo(c,{type:"json"}),n)},o.o=vs,o.p=function(c,n){return sc(mo(c,{method:"POST"}),n)},o.q=Yt,o.r=Ua,o.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=Bt,o.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},o.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},o.w=Bn,o.x=wt,o.y=2,o.z=rM}),g(["./shared"],function(o){function S(Zt){const Ee=Zt?Zt.url.toString():void 0;return Ee?performance.getEntriesByName(Ee):[]}function E(Zt){if(typeof Zt=="number"||typeof Zt=="boolean"||typeof Zt=="string"||Zt==null)return JSON.stringify(Zt);if(Array.isArray(Zt)){let ke="[";for(const qe of Zt)ke+=`${E(qe)},`;return`${ke}]`}let Ee="{";for(const ke of Object.keys(Zt).sort())Ee+=`${ke}:${E(Zt[ke])},`;return`${Ee}}`}function I(Zt){let Ee="";for(const ke of o.bh)Ee+=`/${E(Zt[ke])}`;return Ee}class P{constructor(Ee){this.keyCache={},this._layers={},this._layerConfigs={},Ee&&this.replace(Ee)}replace(Ee,ke){this._layerConfigs={},this._layers={},this.update(Ee,[],ke)}update(Ee,ke,qe){this._options=qe;for(const it of Ee)this._layerConfigs[it.id]=it,(this._layers[it.id]=o.cq(it,this.scope,null,this._options)).compileFilter(qe),this.keyCache[it.id]&&delete this.keyCache[it.id];for(const it of ke)delete this.keyCache[it],delete this._layerConfigs[it],delete this._layers[it];this.familiesBySource={};const mt=function(it,xt){const qt={};for(let Wt=0;Wt<it.length;Wt++){const Qt=xt&&xt[it[Wt].id]||I(it[Wt]);xt&&(xt[it[Wt].id]=Qt);let nn=qt[Qt];nn||(nn=qt[Qt]=[]),nn.push(it[Wt])}const kt=[];for(const Wt in qt)kt.push(qt[Wt]);return kt}(o.be(this._layerConfigs),this.keyCache);for(const it of mt){const xt=it.map(gt=>this._layers[gt.id]),qt=xt[0];if(qt.visibility==="none")continue;const kt=qt.source||"";let Wt=this.familiesBySource[kt];Wt||(Wt=this.familiesBySource[kt]={});const Qt=qt.sourceLayer||"_geojsonTileLayer";let nn=Wt[Qt];nn||(nn=Wt[Qt]=[]),nn.push(xt)}}}const F=1*o.dP;class B{constructor(Ee){const ke={},qe=[];for(const qt in Ee){const kt=Ee[qt],Wt=ke[qt]={};for(const Qt in kt.glyphs){const nn=kt.glyphs[+Qt];if(!nn||nn.bitmap.width===0||nn.bitmap.height===0)continue;const gt=nn.metrics.localGlyph?F:1,Yt={x:0,y:0,w:nn.bitmap.width+2*gt,h:nn.bitmap.height+2*gt};qe.push(Yt),Wt[Qt]=Yt}}const{w:mt,h:it}=o.z(qe),xt=new o.dO({width:mt||1,height:it||1});for(const qt in Ee){const kt=Ee[qt];for(const Wt in kt.glyphs){const Qt=kt.glyphs[+Wt];if(!Qt||Qt.bitmap.width===0||Qt.bitmap.height===0)continue;const nn=ke[qt][Wt],gt=Qt.metrics.localGlyph?F:1;o.dO.copy(Qt.bitmap,xt,{x:0,y:0},{x:nn.x+gt,y:nn.y+gt},Qt.bitmap)}}this.image=xt,this.positions=ke}}o.dN(B,"GlyphAtlas");class ${constructor(Ee){this.tileID=new o.aA(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),this.tileZoom=Ee.tileZoom,this.uid=Ee.uid,this.zoom=Ee.zoom,this.lut=Ee.lut,this.canonical=Ee.tileID.canonical,this.pixelRatio=Ee.pixelRatio,this.tileSize=Ee.tileSize,this.source=Ee.source,this.scope=Ee.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ee.showCollisionBoxes,this.collectResourceTiming=!!Ee.request&&Ee.request.collectResourceTiming,this.promoteId=Ee.promoteId,this.isSymbolTile=Ee.isSymbolTile,this.tileTransform=o.aL(Ee.tileID.canonical,Ee.projection),this.projection=Ee.projection,this.worldview=Ee.worldview,this.localizableLayerIds=Ee.localizableLayerIds,this.brightness=Ee.brightness,this.extraShadowCaster=!!Ee.extraShadowCaster,this.tessellationStep=Ee.tessellationStep,this.scaleFactor=Ee.scaleFactor}parse(Ee,ke,qe,mt,it){this.status="parsing",this.data=Ee,this.collisionBoxArray=new o.aR;const xt=new o.dQ(Object.keys(Ee.layers).sort()),qt=new o.dR(this.tileID,this.promoteId);qt.bucketLayerIDs=[];const kt={},Wt=new o.dS(256,256),Qt={featureIndex:qt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Wt,availableImages:qe,brightness:this.brightness},nn=ke.familiesBySource[this.source];for(const Eo in nn){const cr=Ee.layers[Eo];if(!cr)continue;let rr=!1,qo=!1,cn=!1;for(const $o of nn[Eo])$o[0].type==="symbol"?rr=!0:qo=!0,$o[0].is3D()&&$o[0].type!=="model"&&(cn=!0);if(this.extraShadowCaster&&!cn||this.isSymbolTile===!0&&!rr||this.isSymbolTile===!1&&!qo)continue;cr.version===1&&o.w(`Vector tile source "${this.source}" layer "${Eo}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Yn=xt.encode(Eo),To=[];for(let $o=0,Ir=0;$o<cr.length;$o++){const yr=cr.feature($o),rl=qt.getId(yr,Eo);if(this.localizableLayerIds&&this.localizableLayerIds.has(Eo)){const ps=yr.properties?yr.properties.worldview:null;if(this.worldview&&typeof ps=="string")if(ps==="all")yr.properties.$localized=!0;else{if(!ps.split(",").includes(this.worldview))continue;yr.properties.$localized=!0,yr.properties.worldview=this.worldview}}To.push({feature:yr,id:rl,index:Ir,sourceLayerIndex:Yn}),Ir++}for(const $o of nn[Eo]){const Ir=$o[0];(!this.extraShadowCaster||Ir.is3D()&&Ir.type!=="model")&&(this.isSymbolTile!==void 0&&Ir.type==="symbol"!==this.isSymbolTile||Ir.minzoom&&this.zoom<Math.floor(Ir.minzoom)||Ir.maxzoom&&this.zoom>=Ir.maxzoom||Ir.visibility!=="none"&&(z($o,this.zoom,Qt.brightness,qe),(kt[Ir.id]=Ir.createBucket({index:qt.bucketLayerIDs.length,layers:$o,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Yn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(To,Qt,this.tileID.canonical,this.tileTransform),qt.bucketLayerIDs.push($o.map(yr=>o.av(yr.id,yr.scope)))))}}let gt,Yt,In,ho;Wt.trim();const co={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Lo=()=>{if(gt)return this.status="done",it(gt);if(this.extraShadowCaster)this.status="done",it(null,{buckets:o.be(kt).filter(Eo=>!Eo.isEmpty()),featureIndex:qt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Qt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Yt&&In&&ho){const Eo=new B(Yt),cr=new o.dU(In,ho,this.lut);for(const rr in kt){const qo=kt[rr];qo instanceof o.aS?(z(qo.layers,this.zoom,Qt.brightness,qe),o.dV(qo,Yt,Eo.positions,In,cr.iconPositions,this.showCollisionBoxes,qe,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.brightness)):qo.hasPattern&&(qo instanceof o.aY||qo instanceof o.aZ||qo instanceof o.d0)&&(z(qo.layers,this.zoom,Qt.brightness,qe),qo.addFeatures(Qt,this.tileID.canonical,cr.patternPositions,qe,this.tileTransform,this.brightness))}this.status="done",it(null,{buckets:o.be(kt).filter(rr=>!rr.isEmpty()),featureIndex:qt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Eo.image,lineAtlas:Wt,imageAtlas:cr,brightness:Qt.brightness})}};if(!this.extraShadowCaster){const Eo=o.dT(Qt.glyphDependencies,qo=>Object.keys(qo).map(Number));Object.keys(Eo).length?mt.send("getGlyphs",{uid:this.uid,stacks:Eo,scope:this.scope},(qo,cn)=>{gt||(gt=qo,Yt=cn,Lo())},void 0,!1,co):Yt={};const cr=Object.keys(Qt.iconDependencies);cr.length?mt.send("getImages",{icons:cr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(qo,cn)=>{gt||(gt=qo,In=cn,Lo())},void 0,!1,co):In={};const rr=Object.keys(Qt.patternDependencies);rr.length?mt.send("getImages",{icons:rr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(qo,cn)=>{gt||(gt=qo,ho=cn,Lo())},void 0,!1,co):ho={}}Lo()}}function z(Zt,Ee,ke,qe){const mt=new o.a3(Ee,{brightness:ke});for(const it of Zt)it.recalculate(mt,qe)}class H extends o.E{constructor(Ee,ke,qe,mt,it,xt){super(),this.actor=Ee,this.layerIndex=ke,this.availableImages=qe,this.loadVectorData=it||o.aw,this.loading={},this.loaded={},this.deduped=new o.au(Ee.scheduler),this.isSpriteLoaded=mt,this.scheduler=Ee.scheduler,this.brightness=xt}loadTile(Ee,ke){const qe=Ee.uid,mt=Ee&&Ee.request,it=mt&&mt.collectResourceTiming,xt=this.loading[qe]=new $(Ee);xt.abort=this.loadVectorData(Ee,(qt,kt)=>{const Wt=!this.loading[qe];if(delete this.loading[qe],Wt||qt||!kt)return xt.status="done",Wt||(this.loaded[qe]=xt),ke(qt);const Qt=kt.rawData,nn={};kt.expires&&(nn.expires=kt.expires),kt.cacheControl&&(nn.cacheControl=kt.cacheControl),xt.vectorTile=kt.vectorTile||new o.dW.VectorTile(new o.bc(Qt));const gt=()=>{xt.parse(xt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Yt,In)=>{if(Yt||!In)return ke(Yt);const ho={};if(it){const co=S(mt);co.length>0&&(ho.resourceTiming=JSON.parse(JSON.stringify(co)))}ke(null,o.l({rawTileData:Qt.slice(0)},In,nn,ho))})};this.isSpriteLoaded?gt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(gt,{type:"parseTile",isSymbolTile:Ee.isSymbolTile,zoom:Ee.tileZoom}):gt()}),this.loaded=this.loaded||{},this.loaded[qe]=xt})}reloadTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;if(qe&&qe[mt]){const it=qe[mt];it.scaleFactor=Ee.scaleFactor,it.showCollisionBoxes=Ee.showCollisionBoxes,it.projection=Ee.projection,it.brightness=Ee.brightness,it.tileTransform=o.aL(Ee.tileID.canonical,Ee.projection),it.extraShadowCaster=Ee.extraShadowCaster,it.lut=Ee.lut;const xt=(qt,kt)=>{const Wt=it.reloadCallback;Wt&&(delete it.reloadCallback,it.parse(it.vectorTile,this.layerIndex,this.availableImages,this.actor,Wt)),ke(qt,kt)};it.status==="parsing"?it.reloadCallback=xt:it.status==="done"&&(it.vectorTile?it.parse(it.vectorTile,this.layerIndex,this.availableImages,this.actor,xt):xt())}else ke(null,void 0)}abortTile(Ee,ke){const qe=Ee.uid,mt=this.loading[qe];mt&&(mt.abort&&mt.abort(),delete this.loading[qe]),ke()}removeTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;qe&&qe[mt]&&delete qe[mt],ke()}}class U{loadTile(Ee,ke){const{uid:qe,encoding:mt,rawImageData:it,padding:xt}=Ee,qt=ImageBitmap&&it instanceof ImageBitmap?this.getImageData(it,xt):it;ke(null,new o.dX(qe,qt,mt,xt<1))}getImageData(Ee,ke){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ee.width,Ee.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Ee.width,this.offscreenCanvas.height=Ee.height,this.offscreenCanvasContext.drawImage(Ee,0,0,Ee.width,Ee.height);const qe=this.offscreenCanvasContext.getImageData(-ke,-ke,Ee.width+2*ke,Ee.height+2*ke);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),qe}}o.bb.setPbf(o.bc);class ie{decodeRasterArray({task:Ee,buffer:ke},qe){o.bb.performDecoding(ke,Ee).then(mt=>{qe(null,mt)},mt=>{qe(mt)})}}const Z=o.dW.VectorTileFeature.prototype.toGeoJSON;class G{constructor(Ee){this._feature=Ee,this.extent=o.ab,this.type=Ee.type,this.properties=Ee.tags,"id"in Ee&&!isNaN(Ee.id)&&(this.id=parseInt(Ee.id,10))}loadGeometry(){if(this._feature.type===1){const Ee=[];for(const ke of this._feature.geometry)Ee.push([new o.P(ke[0],ke[1])]);return Ee}{const Ee=[];for(const ke of this._feature.geometry){const qe=[];for(const mt of ke)qe.push(new o.P(mt[0],mt[1]));Ee.push(qe)}return Ee}}toGeoJSON(Ee,ke,qe){return Z.call(this,Ee,ke,qe)}}class Q{constructor(Ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.ab,this.length=Ee.length,this._features=Ee}feature(Ee){return new G(this._features[Ee])}}const oe=64/4096,le=128;class me{constructor(){this.features=new Map}clear(){this.features.clear()}load(Ee=[],ke){for(const qe of Ee){const mt=qe.id;if(mt==null)continue;let it=this.features.get(mt);it&&this.updateCache(it,ke),qe.geometry?(it=ce(qe),this.updateCache(it,ke),this.features.set(mt,it)):this.features.delete(mt),this.updateCache(it,ke)}}updateCache(Ee,ke){for(const{canonical:qe,uid:mt}of Object.values(ke)){const{z:it,x:xt,y:qt}=qe;fe(Ee,Math.pow(2,it),xt,qt)&&delete ke[mt]}}getTile(Ee,ke,qe){const mt=Math.pow(2,Ee),it=[];for(const xt of this.features.values())fe(xt,mt,ke,qe)&&it.push(tt(xt,mt,ke,qe));return{features:it}}getFeatures(){return[...this.features.values()]}}function fe({minX:Zt,minY:Ee,maxX:ke,maxY:qe},mt,it,xt){return Zt<(it+1+oe)/mt&&Ee<(xt+1+oe)/mt&&ke>(it-oe)/mt&&qe>(xt-oe)/mt}function ce(Zt){const{id:Ee,geometry:ke,properties:qe}=Zt;if(!ke)return;if(ke.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:mt,coordinates:it}=ke,xt={id:Ee,type:1,geometry:[],tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},qt=xt.geometry;if(mt==="Point")pe(it,qt,xt);else if(mt==="MultiPoint")for(const kt of it)pe(kt,qt,xt);else if(mt==="LineString")xt.type=2,ye(it,qt,xt);else if(mt==="MultiLineString")xt.type=2,De(it,qt,xt);else if(mt==="Polygon")xt.type=3,De(it,qt,xt,!0);else{if(mt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");xt.type=3;for(const kt of it)De(kt,qt,xt,!0)}return xt}function pe([Zt,Ee],ke,qe){const mt=o.am(Zt);let it=o.at(Ee);it=it<0?0:it>1?1:it,ke.push(mt,it),qe.minX=Math.min(qe.minX,mt),qe.minY=Math.min(qe.minY,it),qe.maxX=Math.max(qe.maxX,mt),qe.maxY=Math.max(qe.maxY,it)}function ye(Zt,Ee,ke,qe=!1,mt=!1){const it=[];for(const xt of Zt)pe(xt,it,ke);Ee.push(it),qe&&function(xt,qt){let kt=0;for(let Wt=0,Qt=xt.length,nn=Qt-2;Wt<Qt;nn=Wt,Wt+=2)kt+=(xt[Wt]-xt[nn])*(xt[Wt+1]+xt[nn+1]);if(kt>0===qt)for(let Wt=0,Qt=xt.length;Wt<Qt/2;Wt+=2){const nn=xt[Wt],gt=xt[Wt+1];xt[Wt]=xt[Qt-2-Wt],xt[Wt+1]=xt[Qt-1-Wt],xt[Qt-2-Wt]=nn,xt[Qt-1-Wt]=gt}}(it,mt)}function De(Zt,Ee,ke,qe=!1){for(let mt=0;mt<Zt.length;mt++)ye(Zt[mt],Ee,ke,qe,mt===0)}function tt(Zt,Ee,ke,qe){const{id:mt,type:it,geometry:xt,tags:qt}=Zt,kt=[];if(it===1)(function(Wt,Qt,nn,gt,Yt){for(let In=0;In<Wt.length;In+=2){const ho=Math.round(o.ab*(Wt[In+0]*Qt-nn)),co=Math.round(o.ab*(Wt[In+1]*Qt-gt));Yt.push([ho,co])}})(xt,Ee,ke,qe,kt);else for(const Wt of xt)Me(Wt,Ee,ke,qe,kt);return{id:mt,type:it,geometry:kt,tags:qt}}function Me(Zt,Ee,ke,qe,mt){const it=-le,xt=o.ab+le;let qt;for(let kt=0;kt<Zt.length-2;kt+=2){let Wt=Math.round(o.ab*(Zt[kt+0]*Ee-ke)),Qt=Math.round(o.ab*(Zt[kt+1]*Ee-qe)),nn=Math.round(o.ab*(Zt[kt+2]*Ee-ke)),gt=Math.round(o.ab*(Zt[kt+3]*Ee-qe));const Yt=nn-Wt,In=gt-Qt;Wt<it&&nn<it||(Wt<it?(Qt+=Math.round(In*((it-Wt)/Yt)),Wt=it):nn<it&&(gt=Qt+Math.round(In*((it-Wt)/Yt)),nn=it),Qt<it&&gt<it||(Qt<it?(Wt+=Math.round(Yt*((it-Qt)/In)),Qt=it):gt<it&&(nn=Wt+Math.round(Yt*((it-Qt)/In)),gt=it),Wt>=xt&&nn>=xt||(Wt>=xt?(Qt+=Math.round(In*((xt-Wt)/Yt)),Wt=xt):nn>=xt&&(gt=Qt+Math.round(In*((xt-Wt)/Yt)),nn=xt),Qt>=xt&&gt>=xt||(Qt>=xt?(Wt+=Math.round(Yt*((xt-Qt)/In)),Qt=xt):gt>=xt&&(nn=Wt+Math.round(Yt*((xt-Qt)/In)),gt=xt),qt&&Wt===qt[qt.length-1][0]&&Qt===qt[qt.length-1][1]||(qt=[[Wt,Qt]],mt.push(qt)),qt.push([nn,gt])))))}}var xe,Ae,Ce,ge={exports:{}},Ne=function(){if(Ce)return ge.exports;Ce=1;var Zt=o.d_(),Ee=function(){if(Ae)return xe;Ae=1;var Qt=o.dY(),nn=o.dZ().VectorTileFeature;function gt(In,ho){this.options=ho||{},this.features=In,this.length=In.length}function Yt(In,ho){this.id=typeof In.id=="number"?In.id:void 0,this.type=In.type,this.rawGeometry=In.type===1?[In.geometry]:In.geometry,this.properties=In.tags,this.extent=ho||4096}return xe=gt,gt.prototype.feature=function(In){return new Yt(this.features[In],this.options.extent)},Yt.prototype.loadGeometry=function(){var In=this.rawGeometry;this.geometry=[];for(var ho=0;ho<In.length;ho++){for(var co=In[ho],Lo=[],Eo=0;Eo<co.length;Eo++)Lo.push(new Qt(co[Eo][0],co[Eo][1]));this.geometry.push(Lo)}return this.geometry},Yt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var In=this.geometry,ho=1/0,co=-1/0,Lo=1/0,Eo=-1/0,cr=0;cr<In.length;cr++)for(var rr=In[cr],qo=0;qo<rr.length;qo++){var cn=rr[qo];ho=Math.min(ho,cn.x),co=Math.max(co,cn.x),Lo=Math.min(Lo,cn.y),Eo=Math.max(Eo,cn.y)}return[ho,Lo,co,Eo]},Yt.prototype.toGeoJSON=nn.prototype.toGeoJSON,xe}();function ke(Qt){var nn=new Zt;return function(gt,Yt){for(var In in gt.layers)Yt.writeMessage(3,qe,gt.layers[In])}(Qt,nn),nn.finish()}function qe(Qt,nn){var gt;nn.writeVarintField(15,Qt.version||1),nn.writeStringField(1,Qt.name||""),nn.writeVarintField(5,Qt.extent||4096);var Yt={keys:[],values:[],keycache:{},valuecache:{}};for(gt=0;gt<Qt.length;gt++)Yt.feature=Qt.feature(gt),nn.writeMessage(2,mt,Yt);var In=Yt.keys;for(gt=0;gt<In.length;gt++)nn.writeStringField(3,In[gt]);var ho=Yt.values;for(gt=0;gt<ho.length;gt++)nn.writeMessage(4,Wt,ho[gt])}function mt(Qt,nn){var gt=Qt.feature;gt.id!==void 0&&nn.writeVarintField(1,gt.id),nn.writeMessage(2,it,Qt),nn.writeVarintField(3,gt.type),nn.writeMessage(4,kt,gt)}function it(Qt,nn){var gt=Qt.feature,Yt=Qt.keys,In=Qt.values,ho=Qt.keycache,co=Qt.valuecache;for(var Lo in gt.properties){var Eo=gt.properties[Lo],cr=ho[Lo];if(Eo!==null){cr===void 0&&(Yt.push(Lo),ho[Lo]=cr=Yt.length-1),nn.writeVarint(cr);var rr=typeof Eo;rr!=="string"&&rr!=="boolean"&&rr!=="number"&&(Eo=JSON.stringify(Eo));var qo=rr+":"+Eo,cn=co[qo];cn===void 0&&(In.push(Eo),co[qo]=cn=In.length-1),nn.writeVarint(cn)}}}function xt(Qt,nn){return(nn<<3)+(7&Qt)}function qt(Qt){return Qt<<1^Qt>>31}function kt(Qt,nn){for(var gt=Qt.loadGeometry(),Yt=Qt.type,In=0,ho=0,co=gt.length,Lo=0;Lo<co;Lo++){var Eo=gt[Lo],cr=1;Yt===1&&(cr=Eo.length),nn.writeVarint(xt(1,cr));for(var rr=Yt===3?Eo.length-1:Eo.length,qo=0;qo<rr;qo++){qo===1&&Yt!==1&&nn.writeVarint(xt(2,rr-1));var cn=Eo[qo].x-In,Yn=Eo[qo].y-ho;nn.writeVarint(qt(cn)),nn.writeVarint(qt(Yn)),In+=cn,ho+=Yn}Yt===3&&nn.writeVarint(xt(7,1))}}function Wt(Qt,nn){var gt=typeof Qt;gt==="string"?nn.writeStringField(1,Qt):gt==="boolean"?nn.writeBooleanField(7,Qt):gt==="number"&&(Qt%1!=0?nn.writeDoubleField(3,Qt):Qt<0?nn.writeSVarintField(6,Qt):nn.writeVarintField(5,Qt))}return ge.exports=ke,ge.exports.fromVectorTileJs=ke,ge.exports.fromGeojsonVt=function(Qt,nn){nn=nn||{};var gt={};for(var Yt in Qt)gt[Yt]=new Ee(Qt[Yt].features,nn),gt[Yt].name=Yt,gt[Yt].version=nn.version,gt[Yt].extent=nn.extent;return ke({layers:gt})},ge.exports.GeoJSONWrapper=Ee,ge.exports}(),We=o.d$(Ne);const ot={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Zt=>Zt},Oe=Math.fround||(Ct=new Float32Array(1),Zt=>(Ct[0]=+Zt,Ct[0]));var Ct;const Mt=3,zt=5,bt=6;class Kt{constructor(Ee){this.options=Object.assign(Object.create(ot),Ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Ee){const{log:ke,minZoom:qe,maxZoom:mt}=this.options;ke&&console.time("total time");const it=`prepare ${Ee.length} points`;ke&&console.time(it),this.points=Ee;const xt=[];for(let kt=0;kt<Ee.length;kt++){const Wt=Ee[kt];if(!Wt.geometry)continue;const[Qt,nn]=Wt.geometry.coordinates,gt=Oe(dn(Qt)),Yt=Oe(At(nn));xt.push(gt,Yt,1/0,kt,-1,1),this.options.reduce&&xt.push(0)}let qt=this.trees[mt+1]=this._createTree(xt);ke&&console.timeEnd(it);for(let kt=mt;kt>=qe;kt--){const Wt=+Date.now();qt=this.trees[kt]=this._createTree(this._cluster(qt,kt)),ke&&console.log("z%d: %d clusters in %dms",kt,qt.numItems,+Date.now()-Wt)}return ke&&console.timeEnd("total time"),this}getClusters(Ee,ke){let qe=((Ee[0]+180)%360+360)%360-180;const mt=Math.max(-90,Math.min(90,Ee[1]));let it=Ee[2]===180?180:((Ee[2]+180)%360+360)%360-180;const xt=Math.max(-90,Math.min(90,Ee[3]));if(Ee[2]-Ee[0]>=360)qe=-180,it=180;else if(qe>it){const nn=this.getClusters([qe,mt,180,xt],ke),gt=this.getClusters([-180,mt,it,xt],ke);return nn.concat(gt)}const qt=this.trees[this._limitZoom(ke)],kt=qt.range(dn(qe),At(xt),dn(it),At(mt)),Wt=qt.data,Qt=[];for(const nn of kt){const gt=this.stride*nn;Qt.push(Wt[gt+zt]>1?$t(Wt,gt,this.clusterProps):this.points[Wt[gt+Mt]])}return Qt}getChildren(Ee){const ke=this._getOriginId(Ee),qe=this._getOriginZoom(Ee),mt="No cluster with the specified id.",it=this.trees[qe];if(!it)throw new Error(mt);const xt=it.data;if(ke*this.stride>=xt.length)throw new Error(mt);const qt=this.options.radius/(this.options.extent*Math.pow(2,qe-1)),kt=it.within(xt[ke*this.stride],xt[ke*this.stride+1],qt),Wt=[];for(const Qt of kt){const nn=Qt*this.stride;xt[nn+4]===Ee&&Wt.push(xt[nn+zt]>1?$t(xt,nn,this.clusterProps):this.points[xt[nn+Mt]])}if(Wt.length===0)throw new Error(mt);return Wt}getLeaves(Ee,ke,qe){const mt=[];return this._appendLeaves(mt,Ee,ke=ke||10,qe=qe||0,0),mt}getTile(Ee,ke,qe){const mt=this.trees[this._limitZoom(Ee)],it=Math.pow(2,Ee),{extent:xt,radius:qt}=this.options,kt=qt/xt,Wt=(qe-kt)/it,Qt=(qe+1+kt)/it,nn={features:[]};return this._addTileFeatures(mt.range((ke-kt)/it,Wt,(ke+1+kt)/it,Qt),mt.data,ke,qe,it,nn),ke===0&&this._addTileFeatures(mt.range(1-kt/it,Wt,1,Qt),mt.data,it,qe,it,nn),ke===it-1&&this._addTileFeatures(mt.range(0,Wt,kt/it,Qt),mt.data,-1,qe,it,nn),nn.features.length?nn:null}getClusterExpansionZoom(Ee){let ke=this._getOriginZoom(Ee)-1;for(;ke<=this.options.maxZoom;){const qe=this.getChildren(Ee);if(ke++,qe.length!==1)break;Ee=qe[0].properties.cluster_id}return ke}_appendLeaves(Ee,ke,qe,mt,it){const xt=this.getChildren(ke);for(const qt of xt){const kt=qt.properties;if(kt&&kt.cluster?it+kt.point_count<=mt?it+=kt.point_count:it=this._appendLeaves(Ee,kt.cluster_id,qe,mt,it):it<mt?it++:Ee.push(qt),Ee.length===qe)break}return it}_createTree(Ee){const ke=new o.bz(Ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let qe=0;qe<Ee.length;qe+=this.stride)ke.add(Ee[qe],Ee[qe+1]);return ke.finish(),ke.data=Ee,ke}_addTileFeatures(Ee,ke,qe,mt,it,xt){for(const qt of Ee){const kt=qt*this.stride,Wt=ke[kt+zt]>1;let Qt,nn,gt;if(Wt)Qt=Re(ke,kt,this.clusterProps),nn=ke[kt],gt=ke[kt+1];else{const ho=this.points[ke[kt+Mt]];Qt=ho.properties;const[co,Lo]=ho.geometry.coordinates;nn=dn(co),gt=At(Lo)}const Yt={type:1,geometry:[[Math.round(this.options.extent*(nn*it-qe)),Math.round(this.options.extent*(gt*it-mt))]],tags:Qt};let In;In=Wt||this.options.generateId?ke[kt+Mt]:this.points[ke[kt+Mt]].id,In!==void 0&&(Yt.id=In),xt.features.push(Yt)}}_limitZoom(Ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+Ee),this.options.maxZoom+1))}_cluster(Ee,ke){const{radius:qe,extent:mt,reduce:it,minPoints:xt}=this.options,qt=qe/(mt*Math.pow(2,ke)),kt=Ee.data,Wt=[],Qt=this.stride;for(let nn=0;nn<kt.length;nn+=Qt){if(kt[nn+2]<=ke)continue;kt[nn+2]=ke;const gt=kt[nn],Yt=kt[nn+1],In=Ee.within(kt[nn],kt[nn+1],qt),ho=kt[nn+zt];let co=ho;for(const Lo of In){const Eo=Lo*Qt;kt[Eo+2]>ke&&(co+=kt[Eo+zt])}if(co>ho&&co>=xt){let Lo,Eo=gt*ho,cr=Yt*ho,rr=-1;const qo=(nn/Qt<<5)+(ke+1)+this.points.length;for(const cn of In){const Yn=cn*Qt;if(kt[Yn+2]<=ke)continue;kt[Yn+2]=ke;const To=kt[Yn+zt];Eo+=kt[Yn]*To,cr+=kt[Yn+1]*To,kt[Yn+4]=qo,it&&(Lo||(Lo=this._map(kt,nn,!0),rr=this.clusterProps.length,this.clusterProps.push(Lo)),it(Lo,this._map(kt,Yn)))}kt[nn+4]=qo,Wt.push(Eo/co,cr/co,1/0,qo,-1,co),it&&Wt.push(rr)}else{for(let Lo=0;Lo<Qt;Lo++)Wt.push(kt[nn+Lo]);if(co>1)for(const Lo of In){const Eo=Lo*Qt;if(!(kt[Eo+2]<=ke)){kt[Eo+2]=ke;for(let cr=0;cr<Qt;cr++)Wt.push(kt[Eo+cr])}}}}return Wt}_getOriginId(Ee){return Ee-this.points.length>>5}_getOriginZoom(Ee){return(Ee-this.points.length)%32}_map(Ee,ke,qe){if(Ee[ke+zt]>1){const xt=this.clusterProps[Ee[ke+bt]];return qe?Object.assign({},xt):xt}const mt=this.points[Ee[ke+Mt]].properties,it=this.options.map(mt);return qe&&it===mt?Object.assign({},it):it}}function $t(Zt,Ee,ke){return{type:"Feature",id:Zt[Ee+Mt],properties:Re(Zt,Ee,ke),geometry:{type:"Point",coordinates:[(qe=Zt[Ee],360*(qe-.5)),Ke(Zt[Ee+1])]}};var qe}function Re(Zt,Ee,ke){const qe=Zt[Ee+zt],mt=qe>=1e4?`${Math.round(qe/1e3)}k`:qe>=1e3?Math.round(qe/100)/10+"k":qe,it=Zt[Ee+bt],xt=it===-1?{}:Object.assign({},ke[it]);return Object.assign(xt,{cluster:!0,cluster_id:Zt[Ee+Mt],point_count:qe,point_count_abbreviated:mt})}function dn(Zt){return Zt/360+.5}function At(Zt){const Ee=Math.sin(Zt*Math.PI/180),ke=.5-.25*Math.log((1+Ee)/(1-Ee))/Math.PI;return ke<0?0:ke>1?1:ke}function Ke(Zt){const Ee=(180-360*Zt)*Math.PI/180;return 360*Math.atan(Math.exp(Ee))/Math.PI-90}function Be(Zt,Ee,ke,qe){let mt=qe;const it=Ee+(ke-Ee>>1);let xt,qt=ke-Ee;const kt=Zt[Ee],Wt=Zt[Ee+1],Qt=Zt[ke],nn=Zt[ke+1];for(let gt=Ee+3;gt<ke;gt+=3){const Yt=Ht(Zt[gt],Zt[gt+1],kt,Wt,Qt,nn);if(Yt>mt)xt=gt,mt=Yt;else if(Yt===mt){const In=Math.abs(gt-it);In<qt&&(xt=gt,qt=In)}}mt>qe&&(xt-Ee>3&&Be(Zt,Ee,xt,qe),Zt[xt+2]=mt,ke-xt>3&&Be(Zt,xt,ke,qe))}function Ht(Zt,Ee,ke,qe,mt,it){let xt=mt-ke,qt=it-qe;if(xt!==0||qt!==0){const kt=((Zt-ke)*xt+(Ee-qe)*qt)/(xt*xt+qt*qt);kt>1?(ke=mt,qe=it):kt>0&&(ke+=xt*kt,qe+=qt*kt)}return xt=Zt-ke,qt=Ee-qe,xt*xt+qt*qt}function Ut(Zt,Ee,ke,qe){const mt={id:Zt??null,type:Ee,geometry:ke,tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")Nt(mt,ke);else if(Ee==="Polygon")Nt(mt,ke[0]);else if(Ee==="MultiLineString")for(const it of ke)Nt(mt,it);else if(Ee==="MultiPolygon")for(const it of ke)Nt(mt,it[0]);return mt}function Nt(Zt,Ee){for(let ke=0;ke<Ee.length;ke+=3)Zt.minX=Math.min(Zt.minX,Ee[ke]),Zt.minY=Math.min(Zt.minY,Ee[ke+1]),Zt.maxX=Math.max(Zt.maxX,Ee[ke]),Zt.maxY=Math.max(Zt.maxY,Ee[ke+1])}function Et(Zt,Ee,ke,qe){if(!Ee.geometry)return;const mt=Ee.geometry.coordinates;if(mt&&mt.length===0)return;const it=Ee.geometry.type,xt=Math.pow(ke.tolerance/((1<<ke.maxZoom)*ke.extent),2);let qt=[],kt=Ee.id;if(ke.promoteId?kt=Ee.properties[ke.promoteId]:ke.generateId&&(kt=qe||0),it==="Point")Gt(mt,qt);else if(it==="MultiPoint")for(const Wt of mt)Gt(Wt,qt);else if(it==="LineString")ln(mt,qt,xt,!1);else if(it==="MultiLineString"){if(ke.lineMetrics){for(const Wt of mt)qt=[],ln(Wt,qt,xt,!1),Zt.push(Ut(kt,"LineString",qt,Ee.properties));return}yn(mt,qt,xt,!1)}else if(it==="Polygon")yn(mt,qt,xt,!0);else{if(it!=="MultiPolygon"){if(it==="GeometryCollection"){for(const Wt of Ee.geometry.geometries)Et(Zt,{id:kt,geometry:Wt,properties:Ee.properties},ke,qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Wt of mt){const Qt=[];yn(Wt,Qt,xt,!0),qt.push(Qt)}}Zt.push(Ut(kt,it,qt,Ee.properties))}function Gt(Zt,Ee){Ee.push(_n(Zt[0]),jn(Zt[1]),0)}function ln(Zt,Ee,ke,qe){let mt,it,xt=0;for(let kt=0;kt<Zt.length;kt++){const Wt=_n(Zt[kt][0]),Qt=jn(Zt[kt][1]);Ee.push(Wt,Qt,0),kt>0&&(xt+=qe?(mt*Qt-Wt*it)/2:Math.sqrt(Math.pow(Wt-mt,2)+Math.pow(Qt-it,2))),mt=Wt,it=Qt}const qt=Ee.length-3;Ee[2]=1,Be(Ee,0,qt,ke),Ee[qt+2]=1,Ee.size=Math.abs(xt),Ee.start=0,Ee.end=Ee.size}function yn(Zt,Ee,ke,qe){for(let mt=0;mt<Zt.length;mt++){const it=[];ln(Zt[mt],it,ke,qe),Ee.push(it)}}function _n(Zt){return Zt/360+.5}function jn(Zt){const Ee=Math.sin(Zt*Math.PI/180),ke=.5-.25*Math.log((1+Ee)/(1-Ee))/Math.PI;return ke<0?0:ke>1?1:ke}function yt(Zt,Ee,ke,qe,mt,it,xt,qt){if(qe/=Ee,it>=(ke/=Ee)&&xt<qe)return Zt;if(xt<ke||it>=qe)return null;const kt=[];for(const Wt of Zt){const Qt=Wt.geometry;let nn=Wt.type;const gt=mt===0?Wt.minX:Wt.minY,Yt=mt===0?Wt.maxX:Wt.maxY;if(gt>=ke&&Yt<qe){kt.push(Wt);continue}if(Yt<ke||gt>=qe)continue;let In=[];if(nn==="Point"||nn==="MultiPoint")kn(Qt,In,ke,qe,mt);else if(nn==="LineString")qn(Qt,In,ke,qe,mt,!1,qt.lineMetrics);else if(nn==="MultiLineString")mo(Qt,In,ke,qe,mt,!1);else if(nn==="Polygon")mo(Qt,In,ke,qe,mt,!0);else if(nn==="MultiPolygon")for(const ho of Qt){const co=[];mo(ho,co,ke,qe,mt,!0),co.length&&In.push(co)}if(In.length){if(qt.lineMetrics&&nn==="LineString"){for(const ho of In)kt.push(Ut(Wt.id,nn,ho,Wt.tags));continue}nn!=="LineString"&&nn!=="MultiLineString"||(In.length===1?(nn="LineString",In=In[0]):nn="MultiLineString"),nn!=="Point"&&nn!=="MultiPoint"||(nn=In.length===3?"Point":"MultiPoint"),kt.push(Ut(Wt.id,nn,In,Wt.tags))}}return kt.length?kt:null}function kn(Zt,Ee,ke,qe,mt){for(let it=0;it<Zt.length;it+=3){const xt=Zt[it+mt];xt>=ke&&xt<=qe&&Io(Ee,Zt[it],Zt[it+1],Zt[it+2])}}function qn(Zt,Ee,ke,qe,mt,it,xt){let qt=Co(Zt);const kt=mt===0?Ho:ur;let Wt,Qt,nn=Zt.start;for(let co=0;co<Zt.length-3;co+=3){const Lo=Zt[co],Eo=Zt[co+1],cr=Zt[co+2],rr=Zt[co+3],qo=Zt[co+4],cn=mt===0?Lo:Eo,Yn=mt===0?rr:qo;let To=!1;xt&&(Wt=Math.sqrt(Math.pow(Lo-rr,2)+Math.pow(Eo-qo,2))),cn<ke?Yn>ke&&(Qt=kt(qt,Lo,Eo,rr,qo,ke),xt&&(qt.start=nn+Wt*Qt)):cn>qe?Yn<qe&&(Qt=kt(qt,Lo,Eo,rr,qo,qe),xt&&(qt.start=nn+Wt*Qt)):Io(qt,Lo,Eo,cr),Yn<ke&&cn>=ke&&(Qt=kt(qt,Lo,Eo,rr,qo,ke),To=!0),Yn>qe&&cn<=qe&&(Qt=kt(qt,Lo,Eo,rr,qo,qe),To=!0),!it&&To&&(xt&&(qt.end=nn+Wt*Qt),Ee.push(qt),qt=Co(Zt)),xt&&(nn+=Wt)}let gt=Zt.length-3;const Yt=Zt[gt],In=Zt[gt+1],ho=mt===0?Yt:In;ho>=ke&&ho<=qe&&Io(qt,Yt,In,Zt[gt+2]),gt=qt.length-3,it&&gt>=3&&(qt[gt]!==qt[0]||qt[gt+1]!==qt[1])&&Io(qt,qt[0],qt[1],qt[2]),qt.length&&Ee.push(qt)}function Co(Zt){const Ee=[];return Ee.size=Zt.size,Ee.start=Zt.start,Ee.end=Zt.end,Ee}function mo(Zt,Ee,ke,qe,mt,it){for(const xt of Zt)qn(xt,Ee,ke,qe,mt,it,!1)}function Io(Zt,Ee,ke,qe){Zt.push(Ee,ke,qe)}function Ho(Zt,Ee,ke,qe,mt,it){const xt=(it-Ee)/(qe-Ee);return Io(Zt,it,ke+(mt-ke)*xt,1),xt}function ur(Zt,Ee,ke,qe,mt,it){const xt=(it-ke)/(mt-ke);return Io(Zt,Ee+(qe-Ee)*xt,it,1),xt}function Dt(Zt,Ee){const ke=[];for(let qe=0;qe<Zt.length;qe++){const mt=Zt[qe],it=mt.type;let xt;if(it==="Point"||it==="MultiPoint"||it==="LineString")xt=En(mt.geometry,Ee);else if(it==="MultiLineString"||it==="Polygon"){xt=[];for(const qt of mt.geometry)xt.push(En(qt,Ee))}else if(it==="MultiPolygon"){xt=[];for(const qt of mt.geometry){const kt=[];for(const Wt of qt)kt.push(En(Wt,Ee));xt.push(kt)}}ke.push(Ut(mt.id,it,xt,mt.tags))}return ke}function En(Zt,Ee){const ke=[];ke.size=Zt.size,Zt.start!==void 0&&(ke.start=Zt.start,ke.end=Zt.end);for(let qe=0;qe<Zt.length;qe+=3)ke.push(Zt[qe]+Ee,Zt[qe+1],Zt[qe+2]);return ke}function ft(Zt,Ee){if(Zt.transformed)return Zt;const ke=1<<Zt.z,qe=Zt.x,mt=Zt.y;for(const it of Zt.features){const xt=it.geometry,qt=it.type;if(it.geometry=[],qt===1)for(let kt=0;kt<xt.length;kt+=2)it.geometry.push(un(xt[kt],xt[kt+1],Ee,ke,qe,mt));else for(let kt=0;kt<xt.length;kt++){const Wt=[];for(let Qt=0;Qt<xt[kt].length;Qt+=2)Wt.push(un(xt[kt][Qt],xt[kt][Qt+1],Ee,ke,qe,mt));it.geometry.push(Wt)}}return Zt.transformed=!0,Zt}function un(Zt,Ee,ke,qe,mt,it){return[Math.round(ke*(Zt*qe-mt)),Math.round(ke*(Ee*qe-it))]}function Je(Zt,Ee,ke,qe,mt){const it=Ee===mt.maxZoom?0:mt.tolerance/((1<<Ee)*mt.extent),xt={features:[],numPoints:0,numSimplified:0,numFeatures:Zt.length,source:null,x:ke,y:qe,z:Ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const qt of Zt)Mn(xt,qt,it,mt);return xt}function Mn(Zt,Ee,ke,qe){const mt=Ee.geometry,it=Ee.type,xt=[];if(Zt.minX=Math.min(Zt.minX,Ee.minX),Zt.minY=Math.min(Zt.minY,Ee.minY),Zt.maxX=Math.max(Zt.maxX,Ee.maxX),Zt.maxY=Math.max(Zt.maxY,Ee.maxY),it==="Point"||it==="MultiPoint")for(let qt=0;qt<mt.length;qt+=3)xt.push(mt[qt],mt[qt+1]),Zt.numPoints++,Zt.numSimplified++;else if(it==="LineString")Bn(xt,mt,Zt,ke,!1,!1);else if(it==="MultiLineString"||it==="Polygon")for(let qt=0;qt<mt.length;qt++)Bn(xt,mt[qt],Zt,ke,it==="Polygon",qt===0);else if(it==="MultiPolygon")for(let qt=0;qt<mt.length;qt++){const kt=mt[qt];for(let Wt=0;Wt<kt.length;Wt++)Bn(xt,kt[Wt],Zt,ke,!0,Wt===0)}if(xt.length){let qt=Ee.tags||null;if(it==="LineString"&&qe.lineMetrics){qt={};for(const Wt in Ee.tags)qt[Wt]=Ee.tags[Wt];qt.mapbox_clip_start=mt.start/mt.size,qt.mapbox_clip_end=mt.end/mt.size}const kt={geometry:xt,type:it==="Polygon"||it==="MultiPolygon"?3:it==="LineString"||it==="MultiLineString"?2:1,tags:qt};Ee.id!==null&&(kt.id=Ee.id),Zt.features.push(kt)}}function Bn(Zt,Ee,ke,qe,mt,it){const xt=qe*qe;if(qe>0&&Ee.size<(mt?xt:qe))return void(ke.numPoints+=Ee.length/3);const qt=[];for(let kt=0;kt<Ee.length;kt+=3)(qe===0||Ee[kt+2]>xt)&&(ke.numSimplified++,qt.push(Ee[kt],Ee[kt+1])),ke.numPoints++;mt&&function(kt,Wt){let Qt=0;for(let nn=0,gt=kt.length,Yt=gt-2;nn<gt;Yt=nn,nn+=2)Qt+=(kt[nn]-kt[Yt])*(kt[nn+1]+kt[Yt+1]);if(Qt>0===Wt)for(let nn=0,gt=kt.length;nn<gt/2;nn+=2){const Yt=kt[nn],In=kt[nn+1];kt[nn]=kt[gt-2-nn],kt[nn+1]=kt[gt-1-nn],kt[gt-2-nn]=Yt,kt[gt-1-nn]=In}}(qt,it),Zt.push(qt)}const Oo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Rr{constructor(Ee,ke){const qe=(ke=this.options=function(it,xt){for(const qt in xt)it[qt]=xt[qt];return it}(Object.create(Oo),ke)).debug;if(qe&&console.time("preprocess data"),ke.maxZoom<0||ke.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ke.promoteId&&ke.generateId)throw new Error("promoteId and generateId cannot be used together.");let mt=function(it,xt){const qt=[];if(it.type==="FeatureCollection")for(let kt=0;kt<it.features.length;kt++)Et(qt,it.features[kt],xt,kt);else Et(qt,it.type==="Feature"?it:{geometry:it},xt);return qt}(Ee,ke);this.tiles={},this.tileCoords=[],qe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ke.indexMaxZoom,ke.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),mt=function(it,xt){const qt=xt.buffer/xt.extent;let kt=it;const Wt=yt(it,1,-1-qt,qt,0,-1,2,xt),Qt=yt(it,1,1-qt,2+qt,0,-1,2,xt);return(Wt||Qt)&&(kt=yt(it,1,-qt,1+qt,0,-1,2,xt)||[],Wt&&(kt=Dt(Wt,1).concat(kt)),Qt&&(kt=kt.concat(Dt(Qt,-1)))),kt}(mt,ke),mt.length&&this.splitTile(mt,0,0,0),qe&&(mt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Ee,ke,qe,mt,it,xt,qt){const kt=[Ee,ke,qe,mt],Wt=this.options,Qt=Wt.debug;for(;kt.length;){mt=kt.pop(),qe=kt.pop(),ke=kt.pop(),Ee=kt.pop();const nn=1<<ke,gt=hi(ke,qe,mt);let Yt=this.tiles[gt];if(!Yt&&(Qt>1&&console.time("creation"),Yt=this.tiles[gt]=Je(Ee,ke,qe,mt,Wt),this.tileCoords.push({z:ke,x:qe,y:mt}),Qt)){Qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ke,qe,mt,Yt.numFeatures,Yt.numPoints,Yt.numSimplified),console.timeEnd("creation"));const To=`z${ke}`;this.stats[To]=(this.stats[To]||0)+1,this.total++}if(Yt.source=Ee,it==null){if(ke===Wt.indexMaxZoom||Yt.numPoints<=Wt.indexMaxPoints)continue}else{if(ke===Wt.maxZoom||ke===it)continue;if(it!=null){const To=it-ke;if(qe!==xt>>To||mt!==qt>>To)continue}}if(Yt.source=null,Ee.length===0)continue;Qt>1&&console.time("clipping");const In=.5*Wt.buffer/Wt.extent,ho=.5-In,co=.5+In,Lo=1+In;let Eo=null,cr=null,rr=null,qo=null,cn=yt(Ee,nn,qe-In,qe+co,0,Yt.minX,Yt.maxX,Wt),Yn=yt(Ee,nn,qe+ho,qe+Lo,0,Yt.minX,Yt.maxX,Wt);Ee=null,cn&&(Eo=yt(cn,nn,mt-In,mt+co,1,Yt.minY,Yt.maxY,Wt),cr=yt(cn,nn,mt+ho,mt+Lo,1,Yt.minY,Yt.maxY,Wt),cn=null),Yn&&(rr=yt(Yn,nn,mt-In,mt+co,1,Yt.minY,Yt.maxY,Wt),qo=yt(Yn,nn,mt+ho,mt+Lo,1,Yt.minY,Yt.maxY,Wt),Yn=null),Qt>1&&console.timeEnd("clipping"),kt.push(Eo||[],ke+1,2*qe,2*mt),kt.push(cr||[],ke+1,2*qe,2*mt+1),kt.push(rr||[],ke+1,2*qe+1,2*mt),kt.push(qo||[],ke+1,2*qe+1,2*mt+1)}}getTile(Ee,ke,qe){Ee=+Ee,ke=+ke,qe=+qe;const mt=this.options,{extent:it,debug:xt}=mt;if(Ee<0||Ee>24)return null;const qt=1<<Ee,kt=hi(Ee,ke=ke+qt&qt-1,qe);if(this.tiles[kt])return ft(this.tiles[kt],it);xt>1&&console.log("drilling down to z%d-%d-%d",Ee,ke,qe);let Wt,Qt=Ee,nn=ke,gt=qe;for(;!Wt&&Qt>0;)Qt--,nn>>=1,gt>>=1,Wt=this.tiles[hi(Qt,nn,gt)];return Wt&&Wt.source?(xt>1&&(console.log("found parent tile z%d-%d-%d",Qt,nn,gt),console.time("drilling down")),this.splitTile(Wt.source,Qt,nn,gt,Ee,ke,qe),xt>1&&console.timeEnd("drilling down"),this.tiles[kt]?ft(this.tiles[kt],it):null):null}}function hi(Zt,Ee,ke){return 32*((1<<Zt)*ke+Ee)+Zt}function Er(Zt,Ee){const ke=Zt.tileID.canonical;if(!this._geoJSONIndex)return void Ee(null,null);const qe=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!qe)return void Ee(null,null);const mt=new Q(qe.features);let it=We(mt);it.byteOffset===0&&it.byteLength===it.buffer.byteLength||(it=new Uint8Array(it)),Ee(null,{vectorTile:mt,rawData:it.buffer})}class Nr extends H{constructor(Ee,ke,qe,mt,it,xt){super(Ee,ke,qe,mt,Er,xt),it&&(this.loadGeoJSON=it),this._dynamicIndex=new me}loadData(Ee,ke){const qe=Ee&&Ee.request,mt=qe&&qe.collectResourceTiming;this.loadGeoJSON(Ee,(it,xt)=>{if(it||!xt)return ke(it);if(typeof xt!="object")return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`));{try{if(Ee.filter){const kt=o.M(Ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(kt.result==="error")throw new Error(kt.value.map(Wt=>`${Wt.key}: ${Wt.message}`).join(", "));xt.features=xt.features.filter(Wt=>kt.value.evaluate({zoom:0},Wt))}Ee.dynamic?(xt.type==="Feature"&&(xt={type:"FeatureCollection",features:[xt]}),Ee.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(xt.features,this.loaded),Ee.cluster&&(xt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Ee.cluster?new Kt(function({superclusterOptions:kt,clusterProperties:Wt}){if(!Wt||!kt)return kt;const Qt={},nn={},gt={accumulated:null,zoom:0},Yt={properties:null},In=Object.keys(Wt);for(const ho of In){const[co,Lo]=Wt[ho],Eo=o.M(Lo),cr=o.M(typeof co=="string"?[co,["accumulated"],["get",ho]]:co);Qt[ho]=Eo.value,nn[ho]=cr.value}return kt.map=ho=>{Yt.properties=ho;const co={};for(const Lo of In)co[Lo]=Qt[Lo].evaluate(gt,Yt);return co},kt.reduce=(ho,co)=>{Yt.properties=co;for(const Lo of In)gt.accumulated=ho[Lo],ho[Lo]=nn[Lo].evaluate(gt,Yt)},kt}(Ee)).load(xt.features):Ee.dynamic?this._dynamicIndex:function(kt,Wt){return new Rr(kt,Wt)}(xt,Ee.geojsonVtOptions)}catch(kt){return ke(kt)}const qt={};if(mt){const kt=S(qe);kt&&(qt.resourceTiming={},qt.resourceTiming[Ee.source]=JSON.parse(JSON.stringify(kt)))}ke(null,qt)}})}reloadTile(Ee,ke){const qe=this.loaded;return qe&&qe[Ee.uid]?Ee.partial?ke(null,void 0):super.reloadTile(Ee,ke):this.loadTile(Ee,ke)}loadGeoJSON(Ee,ke){if(Ee.request)o.n(Ee.request,ke);else{if(typeof Ee.data!="string")return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`));try{return ke(null,JSON.parse(Ee.data))}catch{return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Ee,ke){try{ke(null,this._geoJSONIndex.getClusterExpansionZoom(Ee.clusterId))}catch(qe){ke(qe)}}getClusterChildren(Ee,ke){try{ke(null,this._geoJSONIndex.getChildren(Ee.clusterId))}catch(qe){ke(qe)}}getClusterLeaves(Ee,ke){try{ke(null,this._geoJSONIndex.getLeaves(Ee.clusterId,Ee.limit,Ee.offset))}catch(qe){ke(qe)}}}class Xo{constructor(Ee,ke){this.tileID=new o.aA(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),this.tileZoom=Ee.tileZoom,this.uid=Ee.uid,this.zoom=Ee.zoom,this.canonical=Ee.tileID.canonical,this.pixelRatio=Ee.pixelRatio,this.tileSize=Ee.tileSize,this.source=Ee.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Ee.projection,this.brightness=ke}parse(Ee,ke,qe,mt){this.status="parsing";const it=new o.aA(qe.tileID.overscaledZ,qe.tileID.wrap,qe.tileID.canonical.z,qe.tileID.canonical.x,qe.tileID.canonical.y),xt=[],qt=ke.familiesBySource[qe.source],kt=new o.dR(it,qe.promoteId);return kt.bucketLayerIDs=[],kt.is3DTile=!0,o.e0(Ee).then(Wt=>{if(!Wt)return mt(new Error("Could not parse tile"));const Qt=o.e1(Wt,1/o.c9(qe.tileID.canonical)),nn=Wt.json.extensionsUsed&&Wt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Wt.json.asset.extras&&Wt.json.asset.extras.MAPBOX_mesh_features,gt=Wt.json.extensionsUsed&&Wt.json.extensionsUsed.includes("EXT_meshopt_compression"),Yt=new o.a3(this.zoom,{brightness:this.brightness});for(const In in qt)for(const ho of qt[In]){const co=ho[0];kt.bucketLayerIDs.push(ho.map(Eo=>o.av(Eo.id,Eo.scope))),co.recalculate(Yt,[]);const Lo=new o.e2(ho,Qt,it,nn,gt,this.brightness,kt);nn||(Lo.needsUpload=!0),xt.push(Lo),Lo.evaluate(co)}this.status="done",mt(null,{buckets:xt,featureIndex:kt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Wt=>mt(new Error(Wt.message)))}}class Bi{constructor(Ee,ke,qe,mt,it,xt){this.actor=Ee,this.layerIndex=ke,this.availableImages=qe,this.brightness=xt,this.loading={},this.loaded={}}loadTile(Ee,ke){const qe=Ee.uid,mt=this.loading[qe]=new Xo(Ee,this.brightness);o.bd(Ee.request,(it,xt)=>{const qt=!this.loading[qe];return delete this.loading[qe],qt||it?(mt.status="done",qt||(this.loaded[qe]=mt),ke(it)):xt&&xt.byteLength!==0?void mt.parse(xt,this.layerIndex,Ee,(kt,Wt)=>{mt.status="done",this.loaded=this.loaded||{},this.loaded[qe]=mt,kt||!Wt?ke(kt):ke(null,Wt)}):(mt.status="done",this.loaded[qe]=mt,ke())})}reloadTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;if(qe&&qe[mt]){const it=qe[mt];it.projection=Ee.projection,it.brightness=Ee.brightness;const xt=(qt,kt)=>{it.reloadCallback&&(delete it.reloadCallback,this.loadTile(Ee,ke)),ke(qt,kt)};it.status==="parsing"?it.reloadCallback=xt:it.status==="done"&&this.loadTile(Ee,ke)}}abortTile(Ee,ke){const qe=Ee.uid;this.loading[qe]&&delete this.loading[qe],ke()}removeTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;qe&&qe[mt]&&delete qe[mt],ke()}}class Bs{constructor(Ee){this.self=Ee,this.actor=new o.e3(Ee,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.bM({name:"mercator"}),this.workerSourceTypes={vector:H,geojson:Nr,"batched-model":Bi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ke,qe)=>{if(this.workerSourceTypes[ke])throw new Error(`Worker source with name "${ke}" already registered.`);this.workerSourceTypes[ke]=qe},this.self.registerRTLTextPlugin=ke=>{if(o.e4.isParsed())throw new Error("RTL text plugin already registered.");o.e4.applyArabicShaping=ke.applyArabicShaping,o.e4.processBidirectionalText=ke.processBidirectionalText,o.e4.processStyledBidirectionalText=ke.processStyledBidirectionalText}}clearCaches(Ee,ke,qe){delete this.layerIndexes[Ee],delete this.availableImages[Ee],delete this.workerSources[Ee],delete this.demWorkerSources[Ee],delete this.rasterArrayWorkerSource,qe()}checkIfReady(Ee,ke,qe){qe()}setReferrer(Ee,ke){this.referrer=ke}spriteLoaded(Ee,{scope:ke,isLoaded:qe}){if(this.isSpriteLoaded[Ee]||(this.isSpriteLoaded[Ee]={}),this.isSpriteLoaded[Ee][ke]=qe,this.workerSources[Ee]&&this.workerSources[Ee][ke])for(const mt in this.workerSources[Ee][ke]){const it=this.workerSources[Ee][ke][mt];for(const xt in it){const qt=it[xt];qt instanceof H&&(qt.isSpriteLoaded=qe,qt.fire(new o.x("isSpriteLoaded")))}}}setImages(Ee,{scope:ke,images:qe},mt){if(this.availableImages[Ee]||(this.availableImages[Ee]={}),this.availableImages[Ee][ke]=qe,this.workerSources[Ee]&&this.workerSources[Ee][ke]){for(const it in this.workerSources[Ee][ke]){const xt=this.workerSources[Ee][ke][it];for(const qt in xt)xt[qt].availableImages=qe}mt()}else mt()}setProjection(Ee,ke){this.projections[Ee]=o.bM(ke)}setBrightness(Ee,ke,qe){this.brightness=ke,qe()}setLayers(Ee,ke,qe){this.getLayerIndex(Ee,ke.scope).replace(ke.layers,ke.options),qe()}updateLayers(Ee,ke,qe){this.getLayerIndex(Ee,ke.scope).update(ke.layers,ke.removedIds,ke.options),qe()}loadTile(Ee,ke,qe){ke.projection=this.projections[Ee]||this.defaultProjection,this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).loadTile(ke,qe)}loadDEMTile(Ee,ke,qe){this.getDEMWorkerSource(Ee,ke.source,ke.scope).loadTile(ke,qe)}decodeRasterArray(Ee,ke,qe){this.getRasterArrayWorkerSource().decodeRasterArray(ke,qe)}reloadTile(Ee,ke,qe){ke.projection=this.projections[Ee]||this.defaultProjection,this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).reloadTile(ke,qe)}abortTile(Ee,ke,qe){this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).abortTile(ke,qe)}removeTile(Ee,ke,qe){this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).removeTile(ke,qe)}removeSource(Ee,ke,qe){if(!(this.workerSources[Ee]&&this.workerSources[Ee][ke.scope]&&this.workerSources[Ee][ke.scope][ke.type]&&this.workerSources[Ee][ke.scope][ke.type][ke.source]))return;const mt=this.workerSources[Ee][ke.scope][ke.type][ke.source];delete this.workerSources[Ee][ke.scope][ke.type][ke.source],mt.removeSource!==void 0?mt.removeSource(ke,qe):qe()}loadWorkerSource(Ee,ke,qe){try{this.self.importScripts(ke.url),qe()}catch(mt){qe(mt.toString())}}syncRTLPluginState(Ee,ke,qe){try{o.e4.setState(ke);const mt=o.e4.getPluginURL();if(o.e4.isLoaded()&&!o.e4.isParsed()&&mt!=null){this.self.importScripts(mt);const it=o.e4.isParsed();qe(it?void 0:new Error(`RTL Text Plugin failed to import scripts from ${mt}`),it)}}catch(mt){qe(mt.toString())}}setDracoUrl(Ee,ke){this.dracoUrl=ke}getAvailableImages(Ee,ke){this.availableImages[Ee]||(this.availableImages[Ee]={});let qe=this.availableImages[Ee][ke];return qe||(qe=[]),qe}getLayerIndex(Ee,ke){this.layerIndexes[Ee]||(this.layerIndexes[Ee]={});let qe=this.layerIndexes[Ee][ke];return qe||(qe=this.layerIndexes[Ee][ke]=new P,qe.scope=ke),qe}getWorkerSource(Ee,ke,qe,mt){return this.workerSources[Ee]||(this.workerSources[Ee]={}),this.workerSources[Ee][mt]||(this.workerSources[Ee][mt]={}),this.workerSources[Ee][mt][ke]||(this.workerSources[Ee][mt][ke]={}),this.isSpriteLoaded[Ee]||(this.isSpriteLoaded[Ee]={}),this.workerSources[Ee][mt][ke][qe]||(this.workerSources[Ee][mt][ke][qe]=new this.workerSourceTypes[ke]({send:(it,xt,qt,kt,Wt,Qt)=>{this.actor.send(it,xt,qt,Ee,Wt,Qt)},scheduler:this.actor.scheduler},this.getLayerIndex(Ee,mt),this.getAvailableImages(Ee,mt),this.isSpriteLoaded[Ee][mt],void 0,this.brightness)),this.workerSources[Ee][mt][ke][qe]}getDEMWorkerSource(Ee,ke,qe){return this.demWorkerSources[Ee]||(this.demWorkerSources[Ee]={}),this.demWorkerSources[Ee][qe]||(this.demWorkerSources[Ee][qe]={}),this.demWorkerSources[Ee][qe][ke]||(this.demWorkerSources[Ee][qe][ke]=new U),this.demWorkerSources[Ee][qe][ke]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new ie),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Ee,ke){o.e5(ke)}getWorkerPerformanceMetrics(Ee,ke,qe){qe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Bs(self)),Bs}),g(["./shared"],function(o){var S="3.8.0";const E={create:"create",load:"load",fullLoad:"fullLoad"},I={mark(f){performance.mark(f)},measure(f,r,l){performance.measure(f,r,l)}};function P(f){const r=f.name.split("?")[0];return o.a(r)&&r.includes("mapbox-gl.js")?"javascript":o.a(r)&&r.includes("mapbox-gl.css")?"css":o.b(r)?"fontRange":o.c(r)?"sprite":o.i(r)?"style":o.d(r)?"tilejson":"other"}var F,B={},$=function(){if(F)return B;function f(p){return!r(p)}function r(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,C,D=new Blob([""],{type:"text/javascript"}),V=URL.createObjectURL(D);try{C=new Worker(V),w=!0}catch{w=!1}return C&&C.terminate(),URL.revokeObjectURL(V),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var C=w.getContext("2d");if(!C)return!1;var D=C.getImageData(0,0,1,1);return D&&D.width===w.width}()?(l[b=p&&p.failIfMajorPerformanceCaveat]===void 0&&(l[b]=function(w){var C,D=function(V){var q=document.createElement("canvas"),j=Object.create(f.webGLContextAttributes);return j.failIfMajorPerformanceCaveat=V,q.getContext("webgl2",j)}(w);if(!D)return!1;try{C=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!C||D.isContextLost())&&(D.shaderSource(C,"void main() {}"),D.compileShader(C),D.getShaderParameter(C,D.COMPILE_STATUS)===!0)}(b)),l[b]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var b}F=1,B.supported=f,B.notSupportedReason=r;var l={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},B}();function z(f,r,l){const p=document.createElement(f);return r!=null&&(p.className=r),l&&l.appendChild(p),p}function H(f,r,l){const p=document.createElementNS("http://www.w3.org/2000/svg",f);for(const b of Object.keys(r))p.setAttributeNS(null,b,String(r[b]));return l&&l.appendChild(p),p}const U=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ie=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Z;function G(){U&&ie&&(Z=U[ie],U[ie]="none")}function Q(){U&&ie&&(U[ie]=Z)}function oe(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",oe,!0)}function le(){window.addEventListener("click",oe,!0),window.setTimeout(()=>{window.removeEventListener("click",oe,!0)},0)}function me(f,r){const l=f.getBoundingClientRect();return pe(f,l,r)}function fe(f,r){const l=f.getBoundingClientRect(),p=[];for(let b=0;b<r.length;b++)p.push(pe(f,l,r[b]));return p}function ce(f){return window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function pe(f,r,l){const p=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new o.P((l.clientX-r.left)*p,(l.clientY-r.top)*p)}const ye="01",De="NO_ACCESS_TOKEN";class tt{constructor(r,l,p){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let p=0;p<10;p++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ye,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!o.f(r))return r;const p=xe(r);return p.params.push(`sdk=js-${S}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!o.f(r))return r;const p=xe(r);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeModelURL(r,l){if(!o.f(r))return r;const p=xe(r);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeSourceURL(r,l,p,b){if(!o.f(r))return r;const w=xe(r);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),p&&w.params.push(`language=${p}`),b&&w.params.push(`worldview=${b}`),this._makeAPIURL(w,this._customAccessToken||l)}normalizeSpriteURL(r,l,p,b){const w=xe(r);return o.f(r)?(w.path=`/styles/v1${w.path}/sprite${l}${p}`,this._makeAPIURL(w,this._customAccessToken||b)):(w.path+=`${l}${p}`,Ae(w))}normalizeTileURL(r,l,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!o.f(r))return r;const b=xe(r);b.path=b.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||p&&b.authority!=="raster"&&p===512?"@2x":""}${o.m.supported?".webp":"$1"}`),b.authority==="raster"?b.path=`/${o.e.RASTER_URL_PREFIX}${b.path}`:b.authority==="rasterarrays"?b.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${b.path}`:b.authority==="3dtiles"?b.path=`/${o.e.TILES3D_URL_PREFIX}${b.path}`:(b.path=b.path.replace(/^.+\/v4\//,"/"),b.path=`/${o.e.TILE_URL_VERSION}${b.path}`);const w=this._customAccessToken||function(C){for(const D of C){const V=D.match(/^access_token=(.*)$/);if(V)return V[1]}return null}(b.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&b.params.push(`sku=${this._skuToken}`),this._makeAPIURL(b,w)}canonicalizeTileURL(r,l){const p=xe(r);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return r;let b="mapbox://";p.path.match(/^\/raster\/v1\//)?b+=`raster/${p.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?b+=`rasterarrays/${p.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:b+=`tiles/${p.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let w=p.params;return l&&(w=w.filter(C=>!C.match(/^access_token=/))),w.length&&(b+=`?${w.join("&")}`),b}canonicalizeTileset(r,l){const p=!!l&&o.f(l),b=[];for(const w of r.tiles||[])o.h(w)?b.push(this.canonicalizeTileURL(w,p)):b.push(w);return b}_makeAPIURL(r,l){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",b=xe(o.e.API_URL);if(r.protocol=b.protocol,r.authority=b.authority,r.protocol==="http"){const w=r.params.indexOf("secure");w>=0&&r.params.splice(w,1)}if(b.path!=="/"&&(r.path=`${b.path}${r.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return Ae(r);if(l=l||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return r.params=r.params.filter(w=>w.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Ae(r)}}const Me=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xe(f){const r=f.match(Me);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Ae(f){const r=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${r}`}const Ce="mapbox.eventData";function ge(f){if(!f)return null;const r=f.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(o.j(r[1]))}catch{return null}}class Ne{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=ge(o.e.ACCESS_TOKEN);let p="";return p=l&&l.u?o.k(l.u):o.e.ACCESS_TOKEN||"",r?`${Ce}.${r}:${p}`:`${Ce}:${p}`}fetchEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{const b=localStorage.getItem(l);b&&(this.eventData=JSON.parse(b));const w=localStorage.getItem(p);w&&(this.anonId=w)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid"),b=this.anonId;if(r&&b)try{localStorage.setItem(p,b),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,p,b){if(!o.e.EVENTS_URL)return;const w=xe(o.e.EVENTS_URL);w.params.push(`access_token=${b||o.e.ACCESS_TOKEN||""}`);const C={event:this.type,created:new Date(r).toISOString()},D=l?o.l(C,l):C,V={url:Ae(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=o.p(V,q=>{this.pendingRequest=null,p(q),this.saveEventData(),this.processRequests(b)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const We=new class extends Ne{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,r){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(l=>o.f(l)||o.h(l))&&this.queueRequest(Date.now(),r)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=ge(o.e.ACCESS_TOKEN),l=r?r.u:o.e.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),p=!0);const b=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),C=new Date(b),D=(b-this.eventData.lastSuccess)/864e5;p=p||D>=1||D<-1||w.getDate()!==C.getDate()}else p=!0;p?this.postEvent(b,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:ye,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=b,this.eventData.tokenU=l)},f):this.processRequests()}},ot=We.postTurnstileEvent.bind(We),Oe=new class extends Ne{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,r,l,p){this.skuToken=r,this.errorCb=p,o.e.EVENTS_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(De)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:ye,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f))}remove(){this.errorCb=null}},Ct=Oe.postMapLoadEvent.bind(Oe),Mt=new class extends Ne{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let r=this.mapInstanceIdMap.get(f);return r||(r=o.u(),this.mapInstanceIdMap.set(f,r)),r}getEventId(f){const r=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,r+1),r}postStyleLoadEvent(f,r){const{map:l,style:p,importedStyles:b}=r;if(!o.e.EVENTS_URL||!f&&!o.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(l),C={mapInstanceId:w,eventId:this.getEventId(w),style:p};b.length&&(C.importedStyles=b),this.queueRequest({timestamp:Date.now(),payload:C},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},f)}},zt=Mt.postStyleLoadEvent.bind(Mt),bt=new class extends Ne{constructor(){super("gljs.performance")}postPerformanceEvent(f,r){o.e.EVENTS_URL&&(f||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),p=function(b){const w=performance.getEntriesByType("resource"),C=performance.getEntriesByType("mark"),D=function(ae){const be={};if(ae){for(const _e in ae)if(_e!=="other")for(const Te of ae[_e]){const we=`${_e}ResolveRangeMin`,Le=`${_e}ResolveRangeMax`,Ue=`${_e}RequestCount`,je=`${_e}RequestCachedCount`;be[we]=Math.min(be[we]||1/0,Te.startTime),be[Le]=Math.max(be[Le]||-1/0,Te.responseEnd);const Ye=et=>{be[et]===void 0&&(be[et]=0),++be[et]};Te.transferSize!==void 0&&Te.transferSize===0&&Ye(je),Ye(Ue)}}return be}(function(ae,be){const _e={};if(ae)for(const Te of ae){const we=be(Te);_e[we]===void 0&&(_e[we]=[]),_e[we].push(Te)}return _e}(w,P)),V=window.devicePixelRatio,q=navigator.connection||navigator.mozConnection||navigator.webkitConnection,j=q?q.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},ee=(ae,be,_e)=>{_e!=null&&ae.push({name:be,value:_e.toString()})};for(const ae in D)ee(X.counters,ae,D[ae]);if(b.interactionRange[0]!==1/0&&b.interactionRange[1]!==-1/0&&(ee(X.counters,"interactionRangeMin",b.interactionRange[0]),ee(X.counters,"interactionRangeMax",b.interactionRange[1])),C)for(const ae of Object.keys(E)){const be=E[ae],_e=C.find(Te=>Te.name===be);_e&&ee(X.counters,be,_e.startTime)}return ee(X.counters,"visibilityHidden",b.visibilityHidden),ee(X.attributes,"style",function(ae){if(ae)for(const be of ae){const _e=be.name.split("?")[0];if(o.i(_e)){const Te=_e.split("/").slice(-2);if(Te.length===2)return`mapbox://styles/${Te[0]}/${Te[1]}`}}}(w)),ee(X.attributes,"terrainEnabled",b.terrainEnabled?"true":"false"),ee(X.attributes,"fogEnabled",b.fogEnabled?"true":"false"),ee(X.attributes,"projection",b.projection),ee(X.attributes,"zoom",b.zoom),ee(X.metadata,"devicePixelRatio",V),ee(X.metadata,"connectionEffectiveType",j),ee(X.metadata,"navigatorUserAgent",navigator.userAgent),ee(X.metadata,"screenWidth",window.screen.width),ee(X.metadata,"screenHeight",window.screen.height),ee(X.metadata,"windowWidth",window.innerWidth),ee(X.metadata,"windowHeight",window.innerHeight),ee(X.metadata,"mapWidth",b.width/V),ee(X.metadata,"mapHeight",b.height/V),ee(X.metadata,"webglRenderer",b.renderer),ee(X.metadata,"webglVendor",b.vendor),ee(X.metadata,"sdkVersion",S),ee(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(l);for(const b of p.metadata);for(const b of p.counters);for(const b of p.attributes);this.postEvent(r,p,()=>{},f)}},Kt=bt.postPerformanceEvent.bind(bt),$t=new class extends Ne{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,r,l,p){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const b=xe(o.e.API_URL+o.e.SESSION_PATH);b.params.push(`sku=${r||""}`),b.params.push(`access_token=${p||o.e.ACCESS_TOKEN||""}`);const w={url:Ae(b),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(w,C=>{this.pendingRequest=null,l(C),this.saveEventData(),this.processRequests(p)})}getSessionAPI(f,r,l,p){this.skuToken=r,this.errorCb=p,o.e.SESSION_PATH&&o.e.API_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(De)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f)}remove(){this.errorCb=null}},Re=$t.getSessionAPI.bind($t),dn=new Set;function At(f,r){r?dn.add(f):dn.delete(f)}class Ke{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Be(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ht extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new o.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:p,callback:b}of this.requestors)this._notify(p,l,b);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,p){this._validate(r,p)&&(this.images[l][r]=p)}_validate(r,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,l){if(!r)return!0;let p=0;for(const b of r){if(b[0]<p||b[1]<b[0]||l<b[1])return!1;p=b[1]}return!0}_validateContent(r,l){return!(r&&(r.length!==4||r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,l,p){p.version=this.images[l][r].version+1,this.images[l][r]=p,this.updatedImages[l][r]=!0}removeImage(r,l){const p=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,p){let b=!0;const w=!!this.loaded[l];if(!w)for(const C of r)this.images[l][C]||(b=!1);w||b?this._notify(r,l,p):this.requestors.push({ids:r,scope:l,callback:p})}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,p){const b={};for(const w of r){this.images[l][w]||this.fire(new o.x("styleimagemissing",{id:w}));const C=this.images[l][w];C?b[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:o.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,b)}getPixelSize(r){const{width:l,height:p}=this.atlasImage[r];return{width:l,height:p}}getPattern(r,l,p){const b=this.patterns[l][r],w=this.getImage(r,l);if(!w)return null;if(b&&b.position.version===w.version)return b.position;if(b)b.position.version=w.version;else{const C={w:w.data.width+2*o.y,h:w.data.height+2*o.y,x:0,y:0},D=new o.I(C,w,o.y);this.patterns[l][r]={bin:C,position:D}}return this._updatePatternAtlas(l,p),this.patterns[l][r].position}bind(r,l){const p=r.gl;let b=this.atlasTexture[l];b?this.dirty&&(b.update(this.atlasImage[l]),this.dirty=!1):(b=new o.T(r,this.atlasImage[l],p.RGBA8),this.atlasTexture[l]=b),b.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const p=[];for(const D in this.patterns[r])p.push(this.patterns[r][D].bin);const{w:b,h:w}=o.z(p),C=this.atlasImage[r];C.resize({width:b||1,height:w||1});for(const D in this.patterns[r]){const{bin:V,position:q}=this.patterns[r][D];let j=q.padding;const X=V.x+j,ee=V.y+j,ae=this.images[r][D].data,be=ae.width,_e=ae.height;j=j>1?j-1:j,o.r.copy(ae,C,{x:0,y:0},{x:X,y:ee},{width:be,height:_e},l),o.r.copy(ae,C,{x:0,y:_e-j},{x:X,y:ee-j},{width:be,height:j},l),o.r.copy(ae,C,{x:0,y:0},{x:X,y:ee+_e},{width:be,height:j},l),o.r.copy(ae,C,{x:be-j,y:0},{x:X-j,y:ee},{width:j,height:_e},l),o.r.copy(ae,C,{x:0,y:0},{x:X+be,y:ee},{width:j,height:_e},l),o.r.copy(ae,C,{x:be-j,y:_e-j},{x:X-j,y:ee-j},{width:j,height:j},l),o.r.copy(ae,C,{x:0,y:_e-j},{x:X+be,y:ee-j},{width:j,height:j},l),o.r.copy(ae,C,{x:0,y:0},{x:X+be,y:ee+_e},{width:j,height:j},l),o.r.copy(ae,C,{x:be-j,y:0},{x:X-j,y:ee+_e},{width:j,height:j},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const p of r){if(this.callbackDispatchedThisFrame[l][p])continue;this.callbackDispatchedThisFrame[l][p]=!0;const b=this.images[l][p];Be(b)&&this.updateImage(p,l,b)}}}function Ut(f){const r=f.key,l=f.value,p=f.valueSpec||{},b=f.objectElementValidators||{},w=f.style,C=f.styleSpec;let D=[];const V=o.B(l);if(V!=="object")return[new o.V(r,l,`object expected, ${V} found`)];for(const q in l){const j=q.split(".")[0];let X;b[j]?X=b[j]:p[j]?X=Bn:b["*"]?X=b["*"]:p["*"]&&(X=Bn),X?D=D.concat(X({key:(r&&`${r}.`)+q,value:l[q],valueSpec:p[j]||p["*"],style:w,styleSpec:C,object:l,objectKey:q},l)):D.push(new o.A(r,l[q],`unknown property "${q}"`))}for(const q in p)b[q]||p[q].required&&p[q].default===void 0&&l[q]===void 0&&D.push(new o.V(r,l,`missing required property "${q}"`));return D}function Nt(f){const r=f.value,l=f.valueSpec,p=f.style,b=f.styleSpec,w=f.key,C=f.arrayElementValidator||Bn;if(o.B(r)!=="array")return[new o.V(w,r,`array expected, ${o.B(r)} found`)];if(l.length&&r.length!==l.length)return[new o.V(w,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new o.V(w,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let D={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};b.$version<7&&(D.function=l.function),o.B(l.value)==="object"&&(D=l.value);let V=[];for(let q=0;q<r.length;q++)V=V.concat(C({array:r,arrayIndex:q,value:r[q],valueSpec:D,style:p,styleSpec:b,key:`${w}[${q}]`},!0));return V}function Et(f){const r=f.key,l=f.value,p=f.valueSpec;let b=o.B(l);if(b==="number"&&l!=l&&(b="NaN"),b!=="number")return[new o.V(r,l,`number expected, ${b} found`)];if("minimum"in p){let w=p.minimum;if(o.B(p.minimum)==="array"&&(w=p.minimum[f.arrayIndex]),l<w)return[new o.V(r,l,`${l} is less than the minimum value ${w}`)]}if("maximum"in p){let w=p.maximum;if(o.B(p.maximum)==="array"&&(w=p.maximum[f.arrayIndex]),l>w)return[new o.V(r,l,`${l} is greater than the maximum value ${w}`)]}return[]}function Gt(f){const r=f.valueSpec,l=o.D(f.value.type);let p,b,w,C={};const D=l!=="categorical"&&f.value.property===void 0,V=!D,q=o.B(f.value.stops)==="array"&&o.B(f.value.stops[0])==="array"&&o.B(f.value.stops[0][0])==="object",j=Ut({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ae){if(l==="identity")return[new o.V(ae.key,ae.value,'identity function may not have a "stops" property')];let be=[];const _e=ae.value;return be=be.concat(Nt({key:ae.key,value:_e,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),o.B(_e)==="array"&&_e.length===0&&be.push(new o.V(ae.key,_e,"array must have at least one stop")),be},default:function(ae){return Bn({key:ae.key,value:ae.value,valueSpec:r,style:ae.style,styleSpec:ae.styleSpec})}}});return l==="identity"&&D&&j.push(new o.V(f.key,f.value,'missing required property "property"')),l==="identity"||f.value.stops||j.push(new o.V(f.key,f.value,'missing required property "stops"')),l==="exponential"&&f.valueSpec.expression&&!o.F(f.valueSpec)&&j.push(new o.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(V&&!o.G(f.valueSpec)?j.push(new o.V(f.key,f.value,"property functions not supported")):D&&!o.H(f.valueSpec)&&j.push(new o.V(f.key,f.value,"zoom functions not supported"))),l!=="categorical"&&!q||f.value.property!==void 0||j.push(new o.V(f.key,f.value,'"property" property is required')),j;function X(ae){let be=[];const _e=ae.value,Te=ae.key;if(o.B(_e)!=="array")return[new o.V(Te,_e,`array expected, ${o.B(_e)} found`)];if(_e.length!==2)return[new o.V(Te,_e,`array length 2 expected, length ${_e.length} found`)];if(q){if(o.B(_e[0])!=="object")return[new o.V(Te,_e,`object expected, ${o.B(_e[0])} found`)];if(_e[0].zoom===void 0)return[new o.V(Te,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new o.V(Te,_e,"object stop key must have value")];const we=o.D(_e[0].zoom);if(typeof we!="number")return[new o.V(Te,_e[0].zoom,"stop zoom values must be numbers")];if(w&&w>we)return[new o.V(Te,_e[0].zoom,"stop zoom values must appear in ascending order")];we!==w&&(w=we,b=void 0,C={}),be=be.concat(Ut({key:`${Te}[0]`,value:_e[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:Et,value:ee}}))}else be=be.concat(ee({key:`${Te}[0]`,value:_e[0]},_e));return o.J(o.K(_e[1]))?be.concat([new o.V(`${Te}[1]`,_e[1],"expressions are not allowed in function stops.")]):be.concat(Bn({key:`${Te}[1]`,value:_e[1],valueSpec:r,style:ae.style,styleSpec:ae.styleSpec}))}function ee(ae,be){const _e=o.B(ae.value),Te=o.D(ae.value),we=ae.value!==null?ae.value:be;if(p){if(_e!==p)return[new o.V(ae.key,we,`${_e} stop domain type must match previous stop domain type ${p}`)]}else p=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean"&&typeof Te!="number"&&typeof Te!="string"&&typeof Te!="boolean")return[new o.V(ae.key,we,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&l!=="categorical"){let Le=`number expected, ${_e} found`;return o.G(r)&&l===void 0&&(Le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(ae.key,we,Le)]}return l!=="categorical"||_e!=="number"||typeof Te=="number"&&isFinite(Te)&&Math.floor(Te)===Te?l!=="categorical"&&_e==="number"&&typeof Te=="number"&&typeof b=="number"&&b!==void 0&&Te<b?[new o.V(ae.key,we,"stop domain values must appear in ascending order")]:(b=Te,l==="categorical"&&Te in C?[new o.V(ae.key,we,"stop domain values must be unique")]:(C[Te]=!0,[])):[new o.V(ae.key,we,`integer expected, found ${String(Te)}`)]}}function ln(f){const r=(f.expressionContext==="property"?o.L:o.M)(o.K(f.value),f.valueSpec);if(r.result==="error")return r.value.map(p=>new o.V(`${f.key}${p.key}`,f.value,p.message));const l=r.value.expression||r.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!l.outputDefined())return[new o.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!o.N(l))return[new o.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return yn(l,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!o.O(l,["zoom","feature-state"]))return[new o.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!o.Q(l))return[new o.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function yn(f,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const b of r.valueSpec.expression.parameters)l.delete(b);if(l.size===0)return[];const p=[];return f instanceof o.S&&l.has(f.name)?[new o.V(r.key,r.value,`["${f.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(f.eachChild(b=>{p.push(...yn(b,r))}),p)}function _n(f){const r=f.key,l=f.value,p=f.valueSpec,b=[];return Array.isArray(p.values)?p.values.indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),b}function jn(f){return o.W(o.K(f.value))?ln(o.C({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):yt(f)}function yt(f){const r=f.value,l=f.key;if(o.B(r)!=="array")return[new o.V(l,r,`array expected, ${o.B(r)} found`)];const p=f.styleSpec;let b,w=[];if(r.length<1)return[new o.V(l,r,"filter array must have at least 1 element")];switch(w=w.concat(_n({key:`${l}[0]`,value:r[0],valueSpec:p.filter_operator})),o.D(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&o.D(r[1])==="$type"&&w.push(new o.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&w.push(new o.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(b=o.B(r[1]),b!=="string"&&w.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`)));for(let C=2;C<r.length;C++)b=o.B(r[C]),o.D(r[1])==="$type"?w=w.concat(_n({key:`${l}[${C}]`,value:r[C],valueSpec:p.geometry_type})):b!=="string"&&b!=="number"&&b!=="boolean"&&w.push(new o.V(`${l}[${C}]`,r[C],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let C=1;C<r.length;C++)w=w.concat(yt({key:`${l}[${C}]`,value:r[C],styleSpec:f.styleSpec}));break;case"has":case"!has":b=o.B(r[1]),r.length!==2?w.push(new o.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):b!=="string"&&w.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`))}return w}function kn(f,r){const l=f.key,p=f.style,b=f.layer,w=f.styleSpec,C=f.value,D=f.objectKey,V=w[`${r}_${f.layerType}`];if(!V)return[];const q=D.match(/^(.*)-transition$/);if(r==="paint"&&q&&V[q[1]]&&V[q[1]].transition)return Bn({key:l,value:C,valueSpec:w.transition,style:p,styleSpec:w});const j=f.valueSpec||V[D];if(!j)return[new o.A(l,C,`unknown property "${D}"`)];let X;if(o.B(C)==="string"&&o.G(j)&&!j.tokens&&(X=/^{([^}]+)}$/.exec(C))){const ae=`\`{ "type": "identity", "property": ${X?JSON.stringify(X[1]):'"_"'} }\``;return[new o.V(l,C,`"${D}" does not support interpolation syntax
Use an identity property function instead: ${ae}.`)]}const ee=[];if(f.layerType==="symbol")D!=="text-field"||!p||p.glyphs||p.imports||ee.push(new o.V(l,C,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&o.X(o.K(C))&&o.D(C.type)==="identity"&&ee.push(new o.V(l,C,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&r==="paint"&&b&&b.layout&&b.layout.hasOwnProperty("model-id")&&o.G(j)&&(o.Y(j)||o.H(j))){const ae=o.L(o.K(C),j),be=ae.value.expression||ae.value._styleExpression.expression;be&&!o.O(be,["measure-light"])&&(D==="model-emissive-strength"&&o.Q(be)&&o.N(be)||ee.push(new o.V(l,C,`${D} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ee.concat(Bn({key:f.key,value:C,valueSpec:j,style:p,styleSpec:w,expressionContext:"property",propertyType:r,propertyKey:D}))}function qn(f){return kn(f,"paint")}function Co(f){return kn(f,"layout")}function mo(f){let r=[];const l=f.value,p=f.key,b=f.style,w=f.styleSpec;l.type||l.ref||r.push(new o.V(p,l,'either "type" or "ref" is required'));let C=o.D(l.type);const D=o.D(l.ref);if(l.id){const V=o.D(l.id);for(let q=0;q<f.arrayIndex;q++){const j=b.layers[q];o.D(j.id)===V&&r.push(new o.V(p,l.id,`duplicate layer id "${l.id}", previously used at line ${j.id.__line__}`))}}if("ref"in l){let V;["type","source","source-layer","filter","layout"].forEach(q=>{q in l&&r.push(new o.V(p,l[q],`"${q}" is prohibited for ref layers`))}),b.layers.forEach(q=>{o.D(q.id)===D&&(V=q)}),V?V.ref?r.push(new o.V(p,l.ref,"ref cannot reference another ref layer")):C=o.D(V.type):typeof D=="string"&&r.push(new o.V(p,l.ref,`ref layer "${D}" not found`))}else if(C!=="background"&&C!=="sky"&&C!=="slot")if(l.source){const V=b.sources&&b.sources[l.source],q=V&&o.D(V.type);V?q==="vector"&&C==="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a raster source`)):q==="raster"&&C!=="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a vector source`)):q!=="vector"||l["source-layer"]?q==="raster-dem"&&C!=="hillshade"?r.push(new o.V(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):q!=="raster-array"||["raster","raster-particle"].includes(C)?C!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||q==="geojson"&&V.lineMetrics?C==="raster-particle"&&q!=="raster-array"&&r.push(new o.V(p,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new o.V(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new o.V(p,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new o.V(p,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new o.V(p,l.source,`source "${l.source}" not found`))}else r.push(new o.V(p,l,'missing required property "source"'));return r=r.concat(Ut({key:p,value:l,valueSpec:w.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Bn({key:`${p}.type`,value:l.type,valueSpec:w.layer.type,style:f.style,styleSpec:f.styleSpec,object:l,objectKey:"type"}),filter:V=>jn(o.C({layerType:C},V)),layout:V=>Ut({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":q=>Co(o.C({layerType:C},q))}}),paint:V=>Ut({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":q=>qn(o.C({layerType:C,layer:l},q))}})}})),r}function Io(f){const r=f.value,l=f.key,p=o.B(r);return p!=="string"?[new o.V(l,r,`string expected, ${p} found`)]:[]}const Ho={promoteId:function({key:f,value:r}){if(o.B(r)==="string")return Io({key:f,value:r});{const l=[];for(const p in r)l.push(...Io({key:`${f}.${p}`,value:r[p]}));return l}}};function ur(f){const r=f.value,l=f.key,p=f.styleSpec,b=f.style;if(!r.type)return[new o.V(l,r,'"type" is required')];const w=o.D(r.type);let C=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(r.url||r.tiles||C.push(new o.A(l,r,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return C=C.concat(Ut({key:l,value:r,valueSpec:p[`source_${w.replace("-","_")}`],style:f.style,styleSpec:p,objectElementValidators:Ho})),C;case"geojson":if(C=Ut({key:l,value:r,valueSpec:p.source_geojson,style:b,styleSpec:p,objectElementValidators:Ho}),r.cluster)for(const D in r.clusterProperties){const[V,q]=r.clusterProperties[D],j=typeof V=="string"?[V,["accumulated"],["get",D]]:V;C.push(...ln({key:`${l}.${D}.map`,value:q,expressionContext:"cluster-map"})),C.push(...ln({key:`${l}.${D}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return C;case"video":return Ut({key:l,value:r,valueSpec:p.source_video,style:b,styleSpec:p});case"image":return Ut({key:l,value:r,valueSpec:p.source_image,style:b,styleSpec:p});case"canvas":return[new o.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _n({key:`${l}.type`,value:r.type,valueSpec:{values:Dt(p)}})}}function Dt(f){return f.source.reduce((r,l)=>{const p=f[l];return p.type.type==="enum"&&(r=r.concat(Object.keys(p.type.values))),r},[])}function En(f){const r=f.value,l=f.styleSpec,p=l.light,b=f.style;let w=[];const C=o.B(r);if(r===void 0)return w;if(C!=="object")return w=w.concat([new o.V("light",r,`object expected, ${C} found`)]),w;for(const D in r){const V=D.match(/^(.*)-transition$/);w=w.concat(V&&p[V[1]]&&p[V[1]].transition?Bn({key:D,value:r[D],valueSpec:l.transition,style:b,styleSpec:l}):p[D]?Bn({key:D,value:r[D],valueSpec:p[D],style:b,styleSpec:l}):[new o.V(D,r[D],`unknown property "${D}"`)])}return w}function ft(f){const r=f.value;let l=[];if(!r)return l;const p=o.B(r);if(p!=="object")return l=l.concat([new o.V("light-3d",r,`object expected, ${p} found`)]),l;const b=f.styleSpec,w=b["light-3d"],C=f.key,D=f.style,V=f.style.lights;for(const X of["type","id"])if(!(X in r))return l=l.concat([new o.V("light-3d",r,`missing property ${X} on light`)]),l;if(r.type&&V)for(let X=0;X<f.arrayIndex;X++){const ee=o.D(r.type),ae=V[X];o.D(ae.type)===ee&&l.push(new o.V(C,r.id,`duplicate light type "${r.type}", previously defined at line ${ae.id.__line__}`))}const q=`properties_light_${r.type}`;if(!(q in b))return l=l.concat([new o.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const j=b[q];for(const X in r)if(X==="properties"){const ee=r[X],ae=o.B(ee);if(ae!=="object")return l=l.concat([new o.V("properties",ee,`object expected, ${ae} found`)]),l;for(const be in ee)l=l.concat(j[be]?Bn({key:be,value:ee[be],valueSpec:j[be],style:D,styleSpec:b}):[new o.A(f.key,ee[be],`unknown property "${be}"`)])}else{const ee=X.match(/^(.*)-transition$/);l=l.concat(ee&&w[ee[1]]&&w[ee[1]].transition?Bn({key:X,value:r[X],valueSpec:b.transition,style:D,styleSpec:b}):w[X]?Bn({key:X,value:r[X],valueSpec:w[X],style:D,styleSpec:b}):[new o.A(X,r[X],`unknown property "${X}"`)])}return l}function un(f){const r=f.value,l=f.key,p=f.style,b=f.styleSpec,w=b.terrain;let C=[];const D=o.B(r);if(r===void 0||D==="null")return C;if(D!=="object")return C=C.concat([new o.V("terrain",r,`object expected, ${D} found`)]),C;for(const V in r){const q=V.match(/^(.*)-transition$/);C=C.concat(q&&w[q[1]]&&w[q[1]].transition?Bn({key:V,value:r[V],valueSpec:b.transition,style:p,styleSpec:b}):w[V]?Bn({key:V,value:r[V],valueSpec:w[V],style:p,styleSpec:b}):[new o.A(V,r[V],`unknown property "${V}"`)])}if(r.source){const V=p.sources&&p.sources[r.source],q=V&&o.D(V.type);V?q!=="raster-dem"&&C.push(new o.V(l,r.source,`terrain cannot be used with a source of type ${String(q)}, it only be used with a "raster-dem" source type`)):C.push(new o.V(l,r.source,`source "${r.source}" not found`))}else C.push(new o.V(l,r,'terrain is missing required property "source"'));return C}function Je(f){const r=f.value,l=f.style,p=f.styleSpec,b=p.fog;let w=[];const C=o.B(r);if(r===void 0)return w;if(C!=="object")return w=w.concat([new o.V("fog",r,`object expected, ${C} found`)]),w;for(const D in r){const V=D.match(/^(.*)-transition$/);w=w.concat(V&&b[V[1]]&&b[V[1]].transition?Bn({key:D,value:r[D],valueSpec:p.transition,style:l,styleSpec:p}):b[D]?Bn({key:D,value:r[D],valueSpec:b[D],style:l,styleSpec:p}):[new o.A(D,r[D],`unknown property "${D}"`)])}return w}const Mn={"*":()=>[],array:Nt,boolean:function(f){const r=f.value,l=f.key,p=o.B(r);return p!=="boolean"?[new o.V(l,r,`boolean expected, ${p} found`)]:[]},number:Et,color:function(f){const r=f.key,l=f.value,p=o.B(l);return p!=="string"?[new o.V(r,l,`color expected, ${p} found`)]:o.U.parseCSSColor(l)===null?[new o.V(r,l,`color expected, "${l}" found`)]:[]},enum:_n,filter:jn,function:Gt,layer:mo,object:Ut,source:ur,model:o.Z,light:En,"light-3d":ft,terrain:un,fog:Je,string:Io,formatted:function(f){return Io(f).length===0?[]:ln(f)},resolvedImage:function(f){return Io(f).length===0?[]:ln(f)},projection:function(f){const r=f.value,l=f.styleSpec,p=l.projection,b=f.style;let w=[];const C=o.B(r);if(C==="object")for(const D in r)w=w.concat(Bn({key:D,value:r[D],valueSpec:p[D],style:b,styleSpec:l}));else C!=="string"&&(w=w.concat([new o.V("projection",r,`object or string expected, ${C} found`)]));return w},import:function(f){const{value:r,styleSpec:l}=f,{data:p,...b}=r;Object.defineProperty(b,"__line__",{value:r.__line__,enumerable:!1});let w=Ut(o.C({},f,{value:b,valueSpec:l.import}));return o.D(b.id)===""&&w.push(new o.V(`${f.key}.id`,b,"import id can't be an empty string")),p&&(w=w.concat(Rr(p,l,{key:`${f.key}.data`}))),w}};function Bn(f,r=!1){const l=f.value,p=f.valueSpec,b=f.styleSpec;if(p.expression&&o.X(o.D(l)))return Gt(f);if(p.expression&&o.J(o.K(l)))return ln(f);if(p.type&&Mn[p.type]){const w=Mn[p.type](f);return r===!0&&w.length>0&&o.B(f.value)==="array"?ln(f):w}return Ut(o.C({},f,{valueSpec:p.type?b[p.type]:p}))}function Oo(f){const r=f.value,l=f.key,p=Io(f);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{range}" token'))),p}function Rr(f,r=o._,l={}){return Bn({key:l.key||"",value:f,valueSpec:r.$root,styleSpec:r,style:f,objectElementValidators:{glyphs:Oo,"*":()=>[]}})}function hi(f,r=o._){return it(Rr(f,r))}const Er=f=>it(ur(f)),Nr=f=>it(En(f)),Xo=f=>it(ft(f)),Bi=f=>it(un(f)),Bs=f=>it(Je(f)),Zt=f=>it(mo(f)),Ee=f=>it(jn(f)),ke=f=>it(qn(f)),qe=f=>it(Co(f)),mt=f=>it(o.Z(f));function it(f){return f.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function xt(f,r){let l=!1;if(r&&r.length)for(const p of r)p instanceof o.A?o.w(p.message):(f.fire(new o.t(new Error(p.message))),l=!0);return l}let qt;class kt extends o.E{constructor(r,l="flat"){super(),this._transitionable=new o.$(qt||(qt=new o.a0({anchor:new o.a1(o._.light.anchor),position:new o.a2(o._.light.position),color:new o.a1(o._.light.color),intensity:new o.a1(o._.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,p={}){this._validate(Nr,r,p)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&xt(this,r.call(hi,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}let Wt=class extends o.E{constructor(f,r,l,p){super(),this.scope=l,this._transitionable=new o.$(new o.a0({source:new o.a1(o._.terrain.source),exaggeration:new o.a1(o._.terrain.exaggeration)}),l,p),this._transitionable.setTransitionOrValue(f,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(f,r){this._transitionable.setTransitionOrValue(f,r)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new o.a3(f)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const f=this._transitionable._values.exaggeration;if(!f)return null;const r=f.value.expression;if(!r)return null;let l=-1,p=-1,b=1;for(const w of r.zoomStops)b=r.evaluate(new o.a3(w)),b>.01?(l=w,p=-1):p=w;return b<.01&&l>0&&p>l?[l,p]:null}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof o.a4}};const Qt=45,nn=65,gt=.05;function Yt(f,r,l,p){const b=o.a7(Qt,nn,l),[w,C]=In(f,p);let D=1-Math.min(1,Math.exp((r-w)/(C-w)*-6));return D*=D*D,D=Math.min(1,1.00747*D),D*b*f.alpha}function In(f,r){const l=.5/Math.tan(.5*r);return[f.range[0]+l,f.range[1]+l]}function ho(f,r,l,p,b){const w=o.a6.vec3.transformMat4([],[r,l,p],b.mercatorFogMatrix);return Yt(f,o.a6.vec3.length(w),b.pitch,b._fov)}function co(f,r,l,p,b,w,C){const D=[[l,p,0],[b,p,0],[b,w,0],[l,w,0]];let V=Number.MAX_VALUE,q=-Number.MAX_VALUE;for(const j of D){const X=o.a6.vec3.transformMat4([],j,r),ee=o.a6.vec3.length(X);V=Math.min(V,ee),q=Math.max(q,ee)}return[Yt(f,V,C.pitch,C._fov),Yt(f,q,C.pitch,C._fov)]}class Lo extends o.E{constructor(r,l,p,b){super();const w=new o.a0({range:new o.a1(o._.fog.range),color:new o.a1(o._.fog.color),"high-color":new o.a1(o._.fog["high-color"]),"space-color":new o.a1(o._.fog["space-color"]),"horizon-blend":new o.a1(o._.fog["horizon-blend"]),"star-intensity":new o.a1(o._.fog["star-intensity"]),"vertical-range":new o.a1(o._.fog["vertical-range"])});this._transitionable=new o.$(w,p,new Map(b)),this.set(r,b),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new o.a8(w),this.scope=p}get state(){const r=this._transform,l=r.projection.name==="globe",p=o.a9(r.zoom),b=this.properties.get("range"),w=[.5,3];return{range:l?[o.aa(w[0],b[0],p),o.aa(w[1],b[1],p)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,p={}){if(this._validate(Bs,r,p))return;const b=o.l({},r);for(const w of Object.keys(o._.fog))b[w]===void 0&&(b[w]=o._.fog[w].default);this._options=b,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.a7(Qt,nn,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(p,b,w){const C=o.a5.fromLngLat(b),D=w.elevation?w.elevation.getAtPointOrZero(C):0;return ho(p,C.x,C.y,D,w)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return co(this.state,l,0,0,o.ab,o.ab,this._transform)}getOpacityForBounds(r,l,p,b,w){return this._transform.projection.supportsFog?co(this.state,r,l,p,b,w,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?In(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const p of l){const b=r.points[p];let w;if(b[2]>=0)w=b;else{const C=r.points[p-4];w=o.ac(C,b,C[2]/(C[2]-b[2]))}if(ho(this.state,w[0],w[1],0,this._transform)>=gt)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&xt(this,r.call(hi,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}class Eo extends o.E{constructor(r,l,p,b){super(),this.scope=p,this._options=r,this.properties=new o.a8(l),this._transitionable=new o.$(l,p,new Map(b)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let cr,rr;class qo{constructor(r,l,p,b){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(r,l){let p,b;if(r instanceof o.P||typeof r[0]=="number"){const w=o.P.convert(r);p=[w],b=l.isPointAboveHorizon(w)}else{const w=o.P.convert(r[0]),C=o.P.convert(r[1]);p=[w,C],b=o.ae(w,C).every(D=>l.isPointAboveHorizon(D))}return new qo(p,l.getCameraPoint(),b,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?b[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(b[3]=this.cameraPoint)),o.af(b,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,p,r),w=this.cameraPoint.clone();switch(3*((w.y>l.y)+(w.y>p.y))+((w.x>l.x)+(w.x>p.x))){case 0:b[0]=w,b[4]=w.clone();break;case 1:b.splice(1,0,w);break;case 2:b[1]=w;break;case 3:b.splice(4,0,w);break;case 5:b.splice(2,0,w);break;case 6:b[3]=w;break;case 7:b.splice(3,0,w);break;case 8:b[2]=w}return b}containsTile(r,l,p,b=0){const w=r.queryPadding/l._pixelsPerMercatorPixel+1,C=p?this._bufferedCameraMercator(w,l):this._bufferedScreenMercator(w,l);let D=r.tileID.wrap+(C.unwrapped?b:0);const V=C.polygon.map(Te=>o.ag(r.tileTransform,Te,D));if(!o.ah(V,0,0,o.ab,o.ab))return;D=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const q=this.screenGeometryMercator.polygon.map(Te=>o.ai(r.tileTransform,Te,D)),j=q.map(Te=>new o.P(Te[0],Te[1])),X=l.getFreeCameraOptions().position||new o.a5(0,0,0),ee=o.ai(r.tileTransform,X,D),ae=q.map(Te=>{const we=o.a6.vec3.sub(Te,Te,ee);return o.a6.vec3.normalize(we,we),new o.aj(ee,we)}),be=o.ak(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:ae,bufferedTilespaceGeometry:V,bufferedTilespaceBounds:(_e=o.al(V),_e.min.x=o.ap(_e.min.x,0,o.ab),_e.min.y=o.ap(_e.min.y,0,o.ab),_e.max.x=o.ap(_e.max.x,0,o.ab),_e.max.y=o.ap(_e.max.y,0,o.ab),_e),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:be};var _e}_bufferedScreenMercator(r,l){const p=To(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[p]=b,b}}_bufferedCameraMercator(r,l){const p=To(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[p]=b,b}}_projectAndResample(r,l){const p=function(w,C){const D=o.a6.mat4.multiply([],C.pixelMatrix,C.globeMatrix),V=[0,-o.aq,0,1],q=[0,o.aq,0,1],j=[0,0,0,1];o.a6.vec4.transformMat4(V,V,D),o.a6.vec4.transformMat4(q,q,D),o.a6.vec4.transformMat4(j,j,D);const X=new o.P(V[0]/V[3],V[1]/V[3]),ee=new o.P(q[0]/q[3],q[1]/q[3]),ae=o.an(w,X)&&V[3]<j[3],be=o.an(w,ee)&&q[3]<j[3];if(!ae&&!be)return null;const _e=function(Xe,nt,lt){for(let vt=1;vt<Xe.length;vt++){const dt=Yn(nt.pointCoordinate3D(Xe[vt-1]).x),ct=Yn(nt.pointCoordinate3D(Xe[vt]).x);if(lt<0){if(dt<ct)return{idx:vt,t:-dt/(ct-1-dt)}}else if(ct<dt)return{idx:vt,t:(1-dt)/(ct+1-dt)}}return null}(w,C,ae?-1:1);if(!_e)return null;const{idx:Te,t:we}=_e;let Le=Te>1?cn(w.slice(0,Te),C):[],Ue=Te<w.length?cn(w.slice(Te),C):[];Le=Le.map(Xe=>new o.P(Yn(Xe.x),Xe.y)),Ue=Ue.map(Xe=>new o.P(Yn(Xe.x),Xe.y));const je=[...Le];je.length===0&&je.push(Ue[Ue.length-1]);const Ye=o.aa(je[je.length-1].y,(Ue.length===0?Le[0]:Ue[0]).y,we);let et;return et=ae?[new o.P(0,Ye),new o.P(0,0),new o.P(1,0),new o.P(1,Ye)]:[new o.P(1,Ye),new o.P(1,1),new o.P(0,1),new o.P(0,Ye)],je.push(...et),Ue.length===0?je.push(Le[0]):je.push(...Ue),{polygon:je.map(Xe=>new o.a5(Xe.x,Xe.y)),unwrapped:!1}}(r,l);if(p)return p;const b=function(w,C){let D=!1,V=-1/0,q=0;for(let X=0;X<w.length-1;X++)w[X].x>V&&(V=w[X].x,q=X);for(let X=0;X<w.length-1;X++){const ee=(q+X)%(w.length-1),ae=w[ee],be=w[ee+1];Math.abs(ae.x-be.x)>.5&&(ae.x<be.x?(ae.x+=1,ee===0&&(w[w.length-1].x+=1)):(be.x+=1,ee+1===w.length-1&&(w[0].x+=1)),D=!0)}const j=o.am(C.center.lng);return D&&j<Math.abs(j-1)&&w.forEach(X=>{X.x-=1}),{polygon:w,unwrapped:D}}(cn(r,l).map(w=>new o.P(Yn(w.x),w.y)),l);return{polygon:b.polygon.map(w=>new o.a5(w.x,w.y)),unwrapped:b.unwrapped}}}function cn(f,r){return o.ao(f,l=>{const p=r.pointCoordinate3D(l);l.x=p.x,l.y=p.y},1/256)}function Yn(f){return f<0?1+f%1:f%1}function To(f){return 100*f|0}function $o(f,r,l,p,b){const w=function(D,V){if(D)return b(D);if(V){if(f.url&&V.tiles&&f.tiles&&delete f.tiles,V.variants){if(!Array.isArray(V.variants))return b(new Error("variants must be an array"));for(const j of V.variants){if(j==null||typeof j!="object"||j.constructor!==Object)return b(new Error("variant must be an object"));if(!Array.isArray(j.capabilities))return b(new Error("capabilities must be an array"));if(j.capabilities.length===1&&j.capabilities[0]==="meshopt"){V=o.l(V,j);break}}}const q=o.ar(o.l({},V,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);q.tiles=r.canonicalizeTileset(q,f.url),b(null,q)}},C=function(D,V,q){if(!D)return null;if(!V&&!q)return D;q=q||D.worldview_default;const j=Object.values(D.language||{});if(j.length===0)return null;const X=Object.values(D.worldview||{});if(X.length===0)return null;const ee=j.every(be=>be===V),ae=X.every(be=>be===q);return ee&&ae?D:V in(D.language_options||{})||q in(D.worldview_options||{})?null:D.language_options&&D.worldview_options?D:null}(f.data,l,p);return C?o.q.frame(()=>w(null,C)):f.url?o.n(r.transformRequest(r.normalizeSourceURL(f.url,null,l,p),o.R.Source),w):o.q.frame(()=>{const{data:D,...V}=f;w(null,V)})}class Ir{constructor(r,l,p){this.bounds=o.as.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),p=Math.floor(o.am(this.bounds.getWest())*l),b=Math.floor(o.at(this.bounds.getNorth())*l),w=Math.ceil(o.am(this.bounds.getEast())*l),C=Math.ceil(o.at(this.bounds.getSouth())*l);return r.x>=p&&r.x<w&&r.y>=b&&r.y<C}}class yr extends o.E{constructor(r,l,p,b){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.l(this,o.ar(l,["url","scheme","tileSize","promoteId"])),this._options=o.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new o.au}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=$o(this._options,this.map._requestManager,l,p,(b,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,b)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new o.t(b));else if(w){if(o.l(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const C of w.vector_layers)this.vectorLayerIds.push(C.id),w.worldview&&w.worldview[C.source]&&this.localizableLayerIds.add(C.id)}w.bounds&&(this.tileBounds=new Ir(w.bounds,this.minzoom,this.maxzoom)),ot(w.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}r&&r(b)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}loadTile(r,l){const p=r.tileID.canonical.url(this.tiles,this.scheme),b=this.map._requestManager.normalizeTileURL(p),w=this.map._requestManager.transformRequest(b,o.R.Tile),C=this.map.style?this.map.style.getLut(this.scope):null,D=C?{image:C.image.clone()}:null,V={request:w,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:D,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&o.f(p)&&(V.worldview=this.map.getWorldview()||this.worldviewDefault,V.localizableLayerIds=this.localizableLayerIds),V.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",V,q.bind(this));else if(r.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",V,q.bind(this),void 0,!0);else{const j=o.aw.call({deduped:this._deduped},V,(X,ee)=>{X||!ee?q.call(this,X):(V.data={cacheControl:ee.cacheControl,expires:ee.expires,rawData:ee.rawData.slice(0)},r.actor&&r.actor.send("loadTile",V,q.bind(this),void 0,!0))},!0);r.request={cancel:j}}function q(j,X){return delete r.request,r.aborted?l(null):j&&j.status!==404?l(j):(X&&X.resourceTiming&&(r.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&r.setExpiryData(X),r.loadVectorData(X,this.map.painter),o.ax(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class rl extends o.E{constructor(r,l,p,b){super(),this.id=r,this.dispatcher=p,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.l({type:"raster"},l),o.l(this,o.ar(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._tileJSONRequest=$o(this._options,this.map._requestManager,null,null,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new o.t(l)):p&&(o.l(this,p),p.raster_layers&&(this.rasterLayers=p.raster_layers,this.rasterLayerIds=this.rasterLayers.map(b=>b.id)),p.bounds&&(this.tileBounds=new Ir(p.bounds,this.minzoom,this.maxzoom)),ot(p.tiles),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const p=o.q.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=o.o(this.map._requestManager.transformRequest(b,o.R.Tile),(w,C,D,V)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):w?(r.state="errored",l(w)):C?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:D,expires:V}),r.setTexture(C,this.map.painter),r.state="loaded",o.ax(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof o.T?(r.destroy(!0),r.texture&&r.texture instanceof o.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ps extends rl{constructor(r,l,p,b){super(r,l,p,b),this.type="raster-array",this.maxzoom=22,this._options=o.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);l&&l.enabled&&p&&l._clearRenderCacheForTile(p.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),b=this.map._requestManager.transformRequest(p,o.R.Tile);r.requestParams=b,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(w,C,D,V)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(w)return w.code===20?void 0:(r.state="errored",l(w));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:D,expires:V}),r.state="empty",l(null)})}unloadTile(r,l){const p=r.texture;p&&p instanceof o.T?(r.destroy(!0),this.map.painter.saveTileTexture(p)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,p){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,p,(b,w)=>{if(b)return r.state="errored",this.fire(new o.t(b)),void this.triggerRepaint(r);w&&(r.setTexture(w,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:w})=>w===r),p=l&&l.fields,b=p&&p.bands&&p.bands;return b?b[0]:0}getTextureDescriptor(r,l,p){if(!r)return;const b=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!b)return;let w=null;l instanceof o.aB?w=l.paint.get("raster-array-band"):l instanceof o.aC&&(w=l.paint.get("raster-particle-array-band"));const C=w||this.getInitialBand(b);if(C!=null)if(r.textureDescriptor){if(!r.updateNeeded(b,C)||p)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,b,C)}}const ms={vector:yr,raster:rl,"raster-dem":class extends rl{constructor(f,r,l,p){super(f,r,l,p),this.type="raster-dem",this.maxzoom=22,this._options=o.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(b,w){b&&(f.state="errored",r(b)),w&&(f.dem=w,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=o.o(this.map._requestManager.transformRequest(l,o.R.Tile),(function(b,w,C,D){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(b)f.state="errored",r(b);else if(w){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:C,expires:D});const V=ImageBitmap&&w instanceof ImageBitmap&&o.ay(),q=1-(w.width-o.az(w.width))/2;q<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const j=V?w:o.q.getImageData(w,q),X={uid:f.uid,coord:f.tileID,source:this.id,scope:this.scope,rawImageData:j,encoding:this.encoding,padding:q};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",X,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const r=f.canonical,l=Math.pow(2,r.z),p=(r.x-1+l)%l,b=r.x===0?f.wrap-1:f.wrap,w=(r.x+1+l)%l,C=r.x+1===l?f.wrap+1:f.wrap,D={};return D[new o.aA(f.overscaledZ,b,r.z,p,r.y).key]={backfilled:!1},D[new o.aA(f.overscaledZ,C,r.z,w,r.y).key]={backfilled:!1},r.y>0&&(D[new o.aA(f.overscaledZ,b,r.z,p,r.y-1).key]={backfilled:!1},D[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},D[new o.aA(f.overscaledZ,C,r.z,w,r.y-1).key]={backfilled:!1}),r.y+1<l&&(D[new o.aA(f.overscaledZ,b,r.z,p,r.y+1).key]={backfilled:!1},D[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},D[new o.aA(f.overscaledZ,C,r.z,w,r.y+1).key]={backfilled:!1}),D}},"raster-array":ps,geojson:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=r.data,this._options=o.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const b=o.ab/this.tileSize;this.workerOptions=o.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*b,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*b,extent:o.ab,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.ab,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*b,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new o.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new o.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of f.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterLeaves(f,r,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:r,offset:l},p),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.x("dataloading",{dataType:"source"})),this._loaded=!1;const r=o.l({append:f},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(o.q.resolveURL(l),o.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(p,b)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new o.t(p));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(w.resourceTiming=b.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new o.x("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const l=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,b=p?{image:p.image.clone()}:null,w=this._partialReload,C={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:b,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:w};f.request=this.actor.send(l,C,(D,V)=>w&&!V?(f.state="loaded",r(null)):(delete f.request,f.destroy(),f.aborted?r(null):D?r(D):(f.loadVectorData(V,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,r){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aD{constructor(f,r,l,p){super(f,r,l,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.R.Source).url);o.aE(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new o.t(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new o.t(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(f,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aD,model:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const f=[];for(const r in this._options.models){const l=this._options.models[r],p=o.aG(this.map._requestManager.transformRequest(l.uri,o.R.Model).url).then(b=>{if(!b)return;const w=o.aH(b),C=new o.aI(r,l.position,l.orientation,w);C.computeBoundsAndApplyParent(),this.models.push(C)}).catch(b=>{this.fire(new o.t(new Error(`Could not load model ${r} from ${l.uri}: ${b.message}`)))});f.push(p)}return Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new o.t(new Error(`Could not load models: ${r.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,r){}serialize(){return{type:"model"}}},"batched-model":class extends o.E{constructor(f,r,l,p){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(f){this.map=f,this.load()}load(f){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=$o(this._options,this.map._requestManager,r,l,(p,b)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new o.t(p))):b&&(o.l(this,b),b.bounds&&(this.tileBounds=new Ir(b.bounds,this.minzoom,this.maxzoom)),ot(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),f&&f(p)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,o.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=r;else{if(f.buckets){const w=Object.values(f.buckets);for(const C of w)C.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",p,b.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",p,b.bind(this),void 0,!0);function b(w,C){return f.aborted?r(null):w&&w.status!==404?r(w):(this.map._refreshExpiredTiles&&C&&f.setExpiryData(C),f.loadModelData(C,this.map.painter),f.state="loaded",void r(null))}}serialize(){return o.l({},this._options)}},canvas:class extends o.aD{constructor(f,r,l,p){super(f,r,l,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(w=>typeof w!="number"))||this.fire(new o.t(new o.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.t(new o.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.t(new o.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof o.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ir(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.l(this,o.ar(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:l,z:p}=f.canonical;return this._implementation.hasTile({x:r,y:l,z:p})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:l,y:p,z:b}=f.tileID.canonical,w=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:l,y:p,z:b},{signal:w.signal})).then((function(C){return delete f.request,f.aborted?(f.state="unloaded",r(null)):C===void 0?(f.state="errored",r(null)):C===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(D){return D instanceof ImageData||D instanceof HTMLCanvasElement||D instanceof ImageBitmap||D instanceof HTMLImageElement}(C)?(this.loadTileData(f,C),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(C=>{C.code!==20&&(f.state="errored",r(C))}),f.request.cancel=()=>w.abort()}loadTileData(f,r){f.setTexture(r,this.map.painter)}unloadTile(f,r){if(f.texture&&f.texture instanceof o.T?(f.destroy(!0),f.texture&&f.texture instanceof o.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:l,y:p,z:b}=f.tileID.canonical;this._implementation.unloadTile({x:l,y:p,z:b})}r&&r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=o.av(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}}},za=function(f,r,l,p){const b=new ms[r.type](f,r,l,p);if(b.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${b.id}`);return o.aJ(["load","abort","unload","serialize","prepare"],b),b};function ac(f,r){const l=o.a6.mat4.identity([]);return o.a6.mat4.scale(l,l,[.5*f.width,.5*-f.height,1]),o.a6.mat4.translate(l,l,[1,-1,0]),o.a6.mat4.multiply(l,l,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(l)}function il(f,r,l,p,b,w,C,D,V=!1){const q=f.tilesIn(l,D,V);q.sort(sc);const j=[];for(const ee of q)j.push({wrappedTileID:ee.tile.tileID.wrapped().key,queryResults:ee.tile.queryRenderedFeatures(r,f._state,ee,p,b,w,C,ac(f.transform,ee.tile.tileID),V)});const X=function(ee){const ae={},be={};for(const _e of ee){const Te=_e.queryResults,we=_e.wrappedTileID,Le=be[we]=be[we]||{};for(const Ue in Te){const je=Te[Ue],Ye=Le[Ue]=Le[Ue]||{},et=ae[Ue]=ae[Ue]||[];for(const Xe of je)Ye[Xe.featureIndex]||(Ye[Xe.featureIndex]=!0,et.push(Xe))}}return ae}(j);for(const ee in X)X[ee].forEach(ae=>{const be=ae.feature,_e=be.layer;_e&&_e.type!=="background"&&_e.type!=="sky"&&_e.type!=="slot"&&(o.aK(ee)||(be.source=_e.source,_e["source-layer"]&&(be.sourceLayer=_e["source-layer"])),be.state=be.id!==void 0?f.getFeatureState(_e["source-layer"],be.id):{})});return X}function al(f,r){const l=f.getRenderableIds().map(w=>f.getTileByID(w)),p=[],b={};for(let w=0;w<l.length;w++){const C=l[w],D=C.tileID.canonical.key;b[D]||(b[D]=!0,C.querySourceFeatures(p,r))}return p}function sc(f,r){const l=f.tileID,p=r.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function tu(f,r){const l={};if(!r)return l;for(const p of f){const b=p.layerIds.map(w=>r.getLayer(w)).filter(Boolean);if(b.length!==0){p.layers=b,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(w=>b.filter(C=>C.id===w)[0]));for(const w of b)l[w.fqid]=p}}return l}const Ya=32,gs=33,Xa=new Uint16Array(8184);for(let f=0;f<2046;f++){let r=f+2,l=0,p=0,b=0,w=0,C=0,D=0;for(1&r?b=w=C=Ya:l=p=D=Ya;(r>>=1)>1;){const q=l+b>>1,j=p+w>>1;1&r?(b=l,w=p,l=C,p=D):(l=b,p=w,b=C,w=D),C=q,D=j}const V=4*f;Xa[V+0]=l,Xa[V+1]=p,Xa[V+2]=b,Xa[V+3]=w}const fa=new Uint16Array(2178),vs=new Uint8Array(1089),nu=new Uint16Array(1089);function Ph(f){return f===0?-.03125:f===32?.03125:0}const Rh={type:2,extent:o.ab,loadGeometry:()=>[[new o.P(0,0),new o.P(o.ab+1,0),new o.P(o.ab+1,o.ab+1),new o.P(0,o.ab+1),new o.P(0,0)]]};class Ns{constructor(r,l,p,b,w){this.tileID=r,this.uid=o.aQ(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,b&&b.style&&(this._lastUpdatedBrightness=b.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",b&&b.transform&&(this.projection=b.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<o.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aL(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,p){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=tu(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const w=this.buckets[b];if(w instanceof o.aS){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const w=this.buckets[b];if(w instanceof o.aS&&w.hasRTLText){this.hasRTLText=!0,o.aT();break}}this.queryPadding=0;for(const b in this.buckets){const w=this.buckets[b],C=l.style.getOwnLayer(b);if(!C)continue;const D=C.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,D)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new o.aR}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,p){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets={...this.buckets,...tu(r.buckets,l.style)},r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const b in this.buckets){const w=this.buckets[b];w.uploadPending()&&w.upload(r)}const l=r.gl,p=this.imageAtlas;if(p&&!p.uploaded){const b=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new o.T(r,p.image,l.RGBA8,{useMipmap:b}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,p),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const b=l.style.getBrightness();(this._lastUpdatedBrightness||b)&&(this._lastUpdatedBrightness&&b&&Math.abs(this._lastUpdatedBrightness-b)<.001||(this._lastUpdatedBrightness=b,this.updateBuckets(l)))}queryRenderedFeatures(r,l,p,b,w,C,D,V,q){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:V,transform:D,filter:b,layers:w,availableImages:C,tileTransform:this.tileTransform},r,l):{}}querySourceFeatures(r,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const b=p.loadVTLayers(),w=l?l.sourceLayer:"",C=b._geojsonTileLayer||b[w];if(!C)return;const D=o.aU(l&&l.filter),{z:V,x:q,y:j}=this.tileID.canonical,X={z:V,x:q,y:j};for(let ee=0;ee<C.length;ee++){const ae=C.feature(ee);if(D.needGeometry){const Te=o.aV(ae,!0);if(!D.filter(new o.a3(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!D.filter(new o.a3(this.tileID.overscaledZ),ae))continue;const be=p.getId(ae,w),_e=new o.aW(ae,V,q,j,be);_e.tile=X,r.push(_e)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const p=o.aX(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let b=!1;if(this.expirationTime>p)b=!1;else if(l)if(this.expirationTime<l)b=!0;else{const w=this.expirationTime-l;w?this.expirationTime=p+Math.max(w,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),p=r.style.listImages(),b=r.style.getBrightness();for(const w in this.buckets){if(!r.style.hasLayer(w))continue;const C=this.buckets[w],D=C.layers[0],V=D.sourceLayer||"_geojsonTileLayer",q=l[V],j=r.style.getSourceCache(D.source,D.scope);let X={};j&&(X=j._state.getState(V,void 0)),C.update(X,q,p,this.imageAtlas&&this.imageAtlas.patternPositions||{},b),(C instanceof o.aY||C instanceof o.aZ)&&r._terrain&&r._terrain.enabled&&j&&C.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(j.id,this.tileID);const ee=r&&r.style&&r.style.getOwnLayer(w);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(C)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=o.q.now()+r}setTexture(r,l){const p=l.context,b=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r):(this.texture=new o.T(p,r,b.RGBA8,{useMipmap:!0}),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE))}setDependencies(r,l){const p={};for(const b of l)p[b]=!0;this.dependencies[r]=p}hasDependency(r,l){for(const p of r){const b=this.dependencies[p];if(b){for(const w of l)if(b[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const p=o.a_(Rh,this.tileID.canonical,this.tileTransform)[0],b=new o.a$,w=new o.b0;for(let C=0;C<p.length;C++){const{x:D,y:V}=p[C];b.emplaceBack(D,V),w.emplaceBack(C)}w.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(w),this._tileDebugBuffer=r.createVertexBuffer(b,o.b1.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,b.length,w.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const p=o.a_(Rh,this.tileID.canonical,this.tileTransform)[0];let b,w;if(this.isRaster){const C=function(D,V){const q=o.aL(D,V),j=Math.pow(2,D.z);for(let Te=0;Te<gs;Te++)for(let we=0;we<gs;we++){const Le=o.aM((D.x+(we+Ph(we))/Ya)/j),Ue=o.aN((D.y+(Te+Ph(Te))/Ya)/j),je=V.project(Le,Ue),Ye=Te*gs+we;fa[2*Ye+0]=Math.round((je.x*q.scale-q.x)*o.ab),fa[2*Ye+1]=Math.round((je.y*q.scale-q.y)*o.ab)}vs.fill(0),nu.fill(0);for(let Te=2045;Te>=0;Te--){const we=4*Te,Le=Xa[we+0],Ue=Xa[we+1],je=Xa[we+2],Ye=Xa[we+3],et=Le+je>>1,Xe=Ue+Ye>>1,nt=et+Xe-Ue,lt=Xe+Le-et,vt=Ue*gs+Le,dt=Ye*gs+je,ct=Xe*gs+et,jt=Math.hypot((fa[2*vt+0]+fa[2*dt+0])/2-fa[2*ct+0],(fa[2*vt+1]+fa[2*dt+1])/2-fa[2*ct+1])>=16;vs[ct]=vs[ct]||(jt?1:0),Te<1022&&(vs[ct]=vs[ct]||vs[(Ue+lt>>1)*gs+(Le+nt>>1)]||vs[(Ye+lt>>1)*gs+(je+nt>>1)])}const X=new o.aO,ee=new o.aP;let ae=0;function be(Te,we){const Le=we*gs+Te;return nu[Le]===0&&(X.emplaceBack(fa[2*Le+0],fa[2*Le+1],Te*o.ab/Ya,we*o.ab/Ya),nu[Le]=++ae),nu[Le]-1}function _e(Te,we,Le,Ue,je,Ye){const et=Te+Le>>1,Xe=we+Ue>>1;if(Math.abs(Te-je)+Math.abs(we-Ye)>1&&vs[Xe*gs+et])_e(je,Ye,Te,we,et,Xe),_e(Le,Ue,je,Ye,et,Xe);else{const nt=be(Te,we),lt=be(Le,Ue),vt=be(je,Ye);ee.emplaceBack(nt,lt,vt)}}return _e(0,0,Ya,Ya,Ya,0),_e(Ya,Ya,0,0,0,Ya),{vertices:X,indices:ee}}(this.tileID.canonical,l);b=C.vertices,w=C.indices}else{b=new o.aO,w=new o.aP;for(const{x:D,y:V}of p)b.emplaceBack(D,V,0,0);const C=o.b3(b.int16,void 0,4);for(let D=0;D<C.length;D+=3)w.emplaceBack(C[D],C[D+1],C[D+2])}this._tileBoundsBuffer=r.createVertexBuffer(b,o.b4.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(w),this._tileBoundsSegments=o.b2.simpleSegment(0,0,b.length,w.length)}_makeGlobeTileDebugBuffers(r,l){const p=l.projection;if(!p||p.name!=="globe"||l.freezeTileCoverage)return;const b=this.tileID.canonical,w=o.b5(b,l),C=o.b6(w),D=o.a9(l.zoom);let V;D>0&&(V=o.a6.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,b,l,C,V,D),this._makeGlobeTileDebugTextBuffer(r,b,l,C,V,D)}_globePoint(r,l,p,b,w,C,D){let V=o.b7(r,l,p);if(C){const q=1<<p.z,j=o.am(b.center.lng),X=o.at(b.center.lat),ee=(p.x+.5)/q-j;let ae=0;ee>.5?ae=-1:ee<-.5&&(ae=1);let be=(r/o.ab+p.x)/q+ae,_e=(l/o.ab+p.y)/q;be=(be-j)*b._pixelsPerMercatorPixel+j,_e=(_e-X)*b._pixelsPerMercatorPixel+X;const Te=[be*b.worldSize,_e*b.worldSize,0];o.a6.vec3.transformMat4(Te,Te,C),V=o.b8(V,Te,D)}return o.a6.vec3.transformMat4(V,V,w)}_makeGlobeTileDebugBorderBuffer(r,l,p,b,w,C){const D=new o.a$,V=new o.b0,q=new o.b9,j=(ee,ae,be,_e,Te)=>{const we=(be-ee)/(Te-1),Le=(_e-ae)/(Te-1),Ue=D.length;for(let je=0;je<Te;je++){const Ye=ee+je*we,et=ae+je*Le;D.emplaceBack(Ye,et);const Xe=this._globePoint(Ye,et,l,p,b,w,C);q.emplaceBack(Xe[0],Xe[1],Xe[2]),V.emplaceBack(Ue+je)}},X=o.ab;j(0,0,X,0,16),j(X,0,X,X,16),j(X,X,0,X,16),j(0,X,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(V),this._tileDebugBuffer=r.createVertexBuffer(D,o.b1.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(q,o.ba.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,D.length,V.length)}_makeGlobeTileDebugTextBuffer(r,l,p,b,w,C){const D=o.ab/4,V=new o.a$,q=new o.aP,j=new o.b9,X=25;q.reserve(32),V.reserve(X),j.reserve(X);const ee=(ae,be)=>X*ae+be;for(let ae=0;ae<X;ae++){const be=ae*D;for(let _e=0;_e<X;_e++){const Te=_e*D;V.emplaceBack(Te,be);const we=this._globePoint(Te,be,l,p,b,w,C);j.emplaceBack(we[0],we[1],we[2])}}for(let ae=0;ae<4;ae++)for(let be=0;be<4;be++){const _e=ee(ae,be),Te=ee(ae,be+1),we=ee(ae+1,be),Le=ee(ae+1,be+1);q.emplaceBack(_e,Te,we),q.emplaceBack(we,Te,Le)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(q),this._tileDebugTextBuffer=r.createVertexBuffer(V,o.b1.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(j,o.ba.members),this._tileDebugTextSegments=o.b2.simpleSegment(0,0,X,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.bb.setPbf(o.bc);class lc extends Ns{constructor(r,l,p,b,w){super(r,l,p,b,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const p=l.context,b=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r,{premultiply:!1}):this.texture=new o.T(p,r,b.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const p=this._mrt=new o.bb(30),b=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=o.bd(b,(w,C,D,V)=>{if(w)l(w);else try{const q=p.getHeaderLength(C);if(q>r)return void(this.request=this.fetchHeader(q,l));p.parseHeader(C),this._isHeaderLoaded=!0;let j=0;for(const X of Object.values(p.layers))j=Math.max(j,X.dataIndex[X.dataIndex.length-1].last_byte);C.byteLength>=j&&(this.entireBuffer=C),l(null,this.entireBuffer||C,D,V)}catch(q){l(q)}}),this.request}fetchBand(r,l,p){const b=this._mrt;if(!this._isHeaderLoaded||!b)return void p(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void p(new Error("Can't fetch tile band without an actor"));let C;const D=(X,ee)=>{C.complete(X,ee),X?p(X):(this.updateTextureDescriptor(r,l),p(null,this.textureDescriptor&&this.textureDescriptor.img))},V=(X,ee)=>{if(X)return p(X);const ae=w.send("decodeRasterArray",{buffer:ee,task:C},D,void 0,!0);this._workQueue.push(()=>{ae&&ae.cancel(),C.cancel()})},q=b.getLayer(r);if(!q)return void p(new Error(`Unknown sourceLayer "${r}"`));if(q.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const j=q.getDataRange([l]);if(C=b.createDecodingTask(j),!C||C.tasks.length)if(this.flushQueues(),this.entireBuffer)V(null,this.entireBuffer.slice(j.firstByte,j.lastByte+1));else{const X=Object.assign({},this.requestParams,{headers:{Range:`bytes=${j.firstByte}-${j.lastByte}`}}),ee=o.bd(X,V);this._fetchQueue.push(()=>{ee.cancel(),C.cancel()})}else p(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const p=this._mrt.getLayer(r);if(!p||!p.hasBand(l)||!p.hasDataForBand(l))return;const{bytes:b,tileSize:w,buffer:C,offset:D,scale:V}=p.getBandView(l),q=w+2*C,j={data:b,width:q,height:q},X=this.texture;X&&X instanceof o.T&&X.update(j,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:j,buffer:C,offset:D,tileSize:w,format:p.pixelFormat,mix:[V,256*V,65536*V,16777216*V]}}}class K{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,p){const b=r.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const w={value:l,timeout:void 0};if(p!==void 0&&(w.timeout=setTimeout(()=>{this.remove(r,w)},p)),this.data[b].push(w),this.order.push(b),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const p=r.wrapped().key,b=l===void 0?0:this.data[p].indexOf(l),w=this.data[p][b];return this.data[p].splice(b,1),w.timeout&&clearTimeout(w.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const p in this.data)for(const b of this.data[p])r(b.value)||l.push(b);for(const p of l)this.remove(p.value.tileID,p)}}class he{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,p){const b=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][b]=this.stateChanges[r][b]||{},o.l(this.stateChanges[r][b],p),this.deletedStates[r]===null){this.deletedStates[r]={};for(const w in this.state[r])w!==b&&(this.deletedStates[r][w]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][b]===null){this.deletedStates[r][b]={};for(const w in this.state[r][b])p[w]||(this.deletedStates[r][b][w]=null)}else for(const w in p)this.deletedStates[r]&&this.deletedStates[r][b]&&this.deletedStates[r][b][w]===null&&delete this.deletedStates[r][b][w]}removeFeatureState(r,l,p){if(this.deletedStates[r]===null)return;const b=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&l!==void 0)this.deletedStates[r][b]!==null&&(this.deletedStates[r][b]=this.deletedStates[r][b]||{},this.deletedStates[r][b][p]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][b])for(p in this.deletedStates[r][b]={},this.stateChanges[r][b])this.deletedStates[r][b][p]=null;else this.deletedStates[r][b]=null;else this.deletedStates[r]=null}getState(r,l){const p=this.state[r]||{},b=this.stateChanges[r]||{},w=this.deletedStates[r];if(w===null)return{};if(l!==void 0){const D=String(l),V=o.l({},p[D],b[D]);if(w){const q=w[l];if(q===null)return{};for(const j in q)delete V[j]}return V}const C=o.l({},p,b);if(w)for(const D in w)delete C[D];return C}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const p={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const w={};for(const C in this.stateChanges[b])this.state[b][C]||(this.state[b][C]={}),o.l(this.state[b][C],this.stateChanges[b][C]),w[C]=this.state[b][C];p[b]=w}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const w={};if(this.deletedStates[b]===null)for(const C in this.state[b])w[C]={},this.state[b][C]={};else for(const C in this.deletedStates[b]){if(this.deletedStates[b][C]===null)this.state[b][C]={};else if(this.state[b][C])for(const D of Object.keys(this.deletedStates[b][C]))delete this.state[b][C][D];w[C]=this.state[b][C]}p[b]=p[b]||{},o.l(p[b],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const b in r)r[b].refreshFeatureState(l)}}class Ve extends o.E{constructor(r,l,p){super(),this.id=r,this._onlySymbols=p,l.on("data",b=>{b.dataType==="source"&&b.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&b.dataType==="source"&&b.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new K(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new he,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(r),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return o.be(this._tiles).map(r=>r.tileID).sort(wt).map(r=>r.key)}getRenderableIds(r,l){const p=[];for(const b in this._tiles)this._isIdRenderable(+b,r,l)&&p.push(this._tiles[b]);return r?p.sort((b,w)=>{const C=b.tileID,D=w.tileID,V=new o.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),q=new o.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-D.overscaledZ||q.y-V.y||q.x-V.x}).map(b=>b.tileID.key):p.map(b=>b.tileID).sort(wt).map(b=>b.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,p){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(p||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const p=this._tiles[r];p&&(p.state!=="loading"&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,r,l)))}_tileLoaded(r,l,p,b){if(b)if(r.state="errored",b.status!==404)this._source.fire(new o.t(b,{tile:r}));else{if(this._source.fire(new o.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=o.q.now(),p==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new o.x("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let b=0;b<l.length;b++){const w=l[b];if(r.neighboringTiles&&r.neighboringTiles[w]){const C=this.getTileByID(w);p(r,C),p(C,r)}}function p(b,w){if(!b.dem||b.dem.borderReady)return;b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0;let C=w.tileID.canonical.x-b.tileID.canonical.x;const D=w.tileID.canonical.y-b.tileID.canonical.y,V=Math.pow(2,b.tileID.canonical.z),q=w.tileID.key;C===0&&D===0||Math.abs(D)>1||(Math.abs(C)>1&&(Math.abs(C+V)===1?C+=V:Math.abs(C-V)===1&&(C-=V)),w.dem&&b.dem&&(b.dem.backfillBorder(w.dem,C,D),b.neighboringTiles&&b.neighboringTiles[q]&&(b.neighboringTiles[q].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,p,b){for(const w in this._tiles){let C=this._tiles[w];if(b[w]||!C.hasData()||C.tileID.overscaledZ<=l||C.tileID.overscaledZ>p)continue;let D=C.tileID;for(;C&&C.tileID.overscaledZ>l+1;){const q=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[q.key],C&&C.hasData()&&(D=q)}let V=D;for(;V.overscaledZ>l;)if(V=V.scaledTo(V.overscaledZ-1),r[V.key]){b[D.key]=D;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=r.overscaledZ-1;p>=l;p--){const b=r.scaledTo(p),w=this._getLoadedTile(b);if(w)return w}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const p=Math.ceil(r.width/l)+1,b=Math.ceil(r.height/l)+1,w=Math.floor(p*b*5),C=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(D)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const p={};for(const b in this._tiles){const w=this._tiles[b];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),p[w.tileID.key]=w}this._tiles=p;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(+b,this._tiles[b])}}update(r,l,p,b){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const w=this._source.type==="batched-model";let C,D=this._source.maxzoom;const V=this.map&&this.map.painter?this.map.painter._terrain:null;if(V&&V.sourceCache===this&&V.attenuationRange()){const X=V.attenuationRange()[0],ee=Math.floor(X)-Math.log2(V.getDemUpscale());D>ee&&(D=ee)}if(this.used||this.usedForTerrain){if(this._source.tileID)C=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(X=>new o.aA(X.canonical.z,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y));else if(this.tileCoverLift!==0){const X=r.clone();X.tileCoverLift=this.tileCoverLift,C=X.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.minzoom<=1&&r.projection.name==="globe"&&(C.push(new o.aA(1,0,1,0,0)),C.push(new o.aA(1,0,1,1,0)),C.push(new o.aA(1,0,1,0,1)),C.push(new o.aA(1,0,1,1,1)))}else if(C=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.hasTile){const X=this._source.hasTile.bind(this._source);C=C.filter(ee=>X(ee))}}else C=[];if(C.length>0&&this.castsShadows&&b&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Bt(this._source.type)){const X=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),ee=Math.min(X,this._source.maxzoom);if(w){const ae=r.extendTileCover(C,ee);for(const be of ae)C.push(be)}else{const ae=r.extendTileCover(C,ee,b);for(const be of ae)this._shadowCasterTiles[be.key]=!0,C.push(be)}}const q=this._updateRetainedTiles(C);if(Bt(this._source.type)&&C.length!==0){const X={},ee={},ae=Object.keys(q);for(const _e of ae){const Te=q[_e],we=this._tiles[_e];if(!we||we.fadeEndTime&&we.fadeEndTime<=o.q.now())continue;const Le=this.findLoadedParent(Te,Math.max(Te.overscaledZ-Ve.maxOverzooming,this._source.minzoom));Le&&(this._addTile(Le.tileID),X[Le.tileID.key]=Le.tileID),ee[_e]=Te}const be=C[C.length-1].overscaledZ;for(const _e in this._tiles){const Te=this._tiles[_e];if(q[_e]||!Te.hasData())continue;let we=Te.tileID;for(;we.overscaledZ>be;){we=we.scaledTo(we.overscaledZ-1);const Le=this._tiles[we.key];if(Le&&Le.hasData()&&ee[we.key]){q[_e]=Te.tileID;break}}}for(const _e in X)q[_e]||(this._coveredTiles[_e]=!0,q[_e]=X[_e])}for(const X in q)this._tiles[X].clearFadeHold();const j=o.bf(this._tiles,q);for(const X of j){const ee=this._tiles[X];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(+X)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const p={},b=r.reduce((q,j)=>Math.min(q,j.overscaledZ),1/0),w=r[0].overscaledZ,C=Math.max(w-Ve.maxOverzooming,this._source.minzoom),D=Math.max(w+Ve.maxUnderzooming,this._source.minzoom),V={};for(const q of r){const j=this._addTile(q);l[q.key]=q,j.hasData()||b<this._source.maxzoom&&(V[q.key]=q)}this._retainLoadedChildren(V,b,D,l);for(const q of r){let j=this._tiles[q.key];if(j.hasData())continue;if(q.canonical.z>=this._source.maxzoom){const ee=q.children(this._source.maxzoom)[0],ae=this.getTile(ee);if(ae&&ae.hasData()){l[ee.key]=ee;continue}}else{const ee=q.children(this._source.maxzoom);if(l[ee[0].key]&&l[ee[1].key]&&l[ee[2].key]&&l[ee[3].key])continue}let X=j.wasRequested();for(let ee=q.overscaledZ-1;ee>=C;--ee){const ae=q.scaledTo(ee);if(p[ae.key]||(p[ae.key]=!0,j=this.getTile(ae),!j&&X&&(j=this._addTile(ae)),j&&(l[ae.key]=ae,X=j.wasRequested(),j.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let p,b=this._tiles[r].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){p=this._loadedParentTiles[b.key];break}l.push(b.key);const w=b.scaledTo(b.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;b=w}for(const w of l)this._loadedParentTiles[w]=p}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const p=!!l;if(!p){const b=this.map?this.map.painter:null,w=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new lc(r,w,this.transform.tileZoom,b,this._isRaster):new Ns(r,w,this.transform.tileZoom,b,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,p||this._source.fire(new o.x("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=l.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,p){const b=[],w=this.transform;if(!w)return b;const C=w.projection.name==="globe",D=o.am(w.center.lng);for(const V in this._tiles){const q=this._tiles[V];if(p&&q.clearQueryDebugViz(),q.holdingForFade())continue;let j;if(C){const X=q.tileID.canonical;if(X.z===0){const ee=[Math.abs(o.ap(D,...Vt(X,-1))-D),Math.abs(o.ap(D,...Vt(X,1))-D)];j=[0,2*ee.indexOf(Math.min(...ee))-1]}else{const ee=[Math.abs(o.ap(D,...Vt(X,-1))-D),Math.abs(o.ap(D,...Vt(X,0))-D),Math.abs(o.ap(D,...Vt(X,1))-D)];j=[ee.indexOf(Math.min(...ee))-1]}}else j=[0];for(const X of j){const ee=r.containsTile(q,w,l,X);ee&&b.push(ee)}}return b}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const p=this.getRenderableIds(r,l).map(w=>this._tiles[w].tileID),b=this.transform.projection.name==="globe";for(const w of p)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=b?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return p}sortCoordinatesByDistance(r){const l=r.slice(),p=this.transform._camera.position,b=this.transform._camera.forward(),w={};for(const C of l){const D=1/(1<<C.canonical.z);w[C.key]=((C.canonical.x+.5)*D+C.wrap-p[0])*b[0]+((C.canonical.y+.5)*D-p[1])*b[1]-p[2]*b[2]}return l.sort((C,D)=>w[C.key]-w[D.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(Bt(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.q.now())return!0}return!1}setFeatureState(r,l,p){this._state.updateState(r=r||"_geojsonTileLayer",l,p)}removeFeatureState(r,l,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,p)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,p){const b=this._tiles[r];b&&b.setDependencies(l,p)}reloadTilesForDependencies(r,l){for(const p in this._tiles)this._tiles[p].hasDependency(r,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const V=()=>{this._sourceLoaded&&(this._source.off("data",V),this._preloadTiles(r,l))};return void this._source.on("data",V)}const p=new Map,b=Array.isArray(r)?r:[r],w=this.map.painter.terrain,C=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const V of b){const q=V.coveringTiles({tileSize:C,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const j of q)p.set(j.key,j);this.usedForTerrain&&V.updateElevation(!1)}const D=Array.from(p.values());o.bg(D,(V,q)=>{const j=new Ns(V,this._source.tileSize*V.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(j,X=>{this._source.type==="raster-dem"&&j.dem&&this._backfillDEM(j),q(X,j)})},l)}}function wt(f,r){const l=Math.abs(2*f.wrap)-+(f.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return f.overscaledZ-r.overscaledZ||p-l||r.canonical.y-f.canonical.y||r.canonical.x-f.canonical.x}function Bt(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function Vt(f,r){const l=1<<f.z;return[f.x/l+r,(f.x+1)/l+r]}Ve.maxOverzooming=10,Ve.maxUnderzooming=3;class on{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const p in this.style._mergedLayers){const b=this.style._mergedLayers[p];if(b.type==="fill-extrusion")this.layers.push({layer:b,visible:r,visibilityChanged:l});else if(b.type==="model"){const w=this.style.getLayerSource(b);w&&w.type==="batched-model"&&this.layers.push({layer:b,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const p=l.layer;let b=!1;p.type==="fill-extrusion"?b=!p.isHidden(r)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(b=!p.isHidden(r)&&p.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!b&&l.visible,l.visible=b}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const b of this.layers){const w=b.layer,C=this.style.getLayerSourceCache(w);let D=1;w.type==="fill-extrusion"&&(D=b.visible?w.paint.get("fill-extrusion-vertical-scale"):0);let V=C?C.getTile(l):null;if(!V&&C&&l.canonical.z>C.getSource().minzoom){let q=l.scaledTo(Math.min(C.getSource().maxzoom,l.overscaledZ-1));for(;q.overscaledZ>=C.getSource().minzoom&&(V=C.getTile(q),!V&&q.overscaledZ!==0);)q=q.scaledTo(q.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:V?V.getBucket(w):null,tileID:V?V.tileID:l,verticalScale:D})}r.hasAnyZOffset=!1;let p=!1;for(let b=0;b<r.symbolInstances.length;b++){const w=r.symbolInstances.get(b),C=w.zOffset,D=this._getHeightAtTileOffset(l,w.tileAnchorX,w.tileAnchorY);w.zOffset=D!==Number.NEGATIVE_INFINITY?D:C,p||C===w.zOffset||(p=!0),r.hasAnyZOffset||w.zOffset===0||(r.hasAnyZOffset=!0)}p&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,p,b){let w=l,C=p;if(r.canonical.z!==b.canonical.z){const D=b.canonical,V=1/(1<<r.canonical.z-D.z);w=(l+r.canonical.x*o.ab)*V-D.x*o.ab|0,C=(p+r.canonical.y*o.ab)*V-D.y*o.ab|0}return{tileX:w,tileY:C}}_getHeightAtTileOffset(r,l,p){let b,w;for(let C=0;C<this.layers.length;++C){if(this.layers[C].layer.type!=="fill-extrusion")continue;const{bucket:D,tileID:V,verticalScale:q}=this.currentBuildingBuckets[C];if(!D)continue;const{tileX:j,tileY:X}=this._mapCoordToOverlappingTile(r,l,p,V),ee=D.getHeightAtTileCoord(j,X);ee&&ee.height!==void 0&&(ee.hidden?b=ee.height:w=Math.max(ee.height*q,w||0))}if(w!==void 0)return w;for(let C=0;C<this.layers.length;++C){const D=this.layers[C];if(D.layer.type!=="model"||!D.visible)continue;const{bucket:V,tileID:q}=this.currentBuildingBuckets[C];if(!V)continue;const{tileX:j,tileY:X}=this._mapCoordToOverlappingTile(r,l,p,q),ee=V.getHeightAtTileCoord(j,X);if(ee&&!ee.hidden)return ee.height===void 0&&b!==void 0?Math.min(ee.maxHeight,b)*ee.verticalScale:ee.height?ee.height*ee.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Kn(f,r){const l={};for(const p in f)p!=="ref"&&(l[p]=f[p]);return o.bh.forEach(p=>{p in r&&(l[p]=r[p])}),l}function so(f){f=f.slice();const r=Object.create(null);for(let l=0;l<f.length;l++)r[f[l].id]=f[l];for(let l=0;l<f.length;l++)"ref"in f[l]&&(f[l]=Kn(f[l],r[f[l].ref]));return f}const zn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function yo(f,r,l){l.push({command:zn.addSource,args:[f,r[f]]})}function Ln(f,r,l){r.push({command:zn.removeSource,args:[f]}),l[f]=!0}function dr(f,r,l,p){Ln(f,l,p),yo(f,r,l)}function uo(f,r,l){let p;for(p in f[l])if(f[l].hasOwnProperty(p)&&p!=="data"&&!o.bi(f[l][p],r[l][p]))return!1;for(p in r[l])if(r[l].hasOwnProperty(p)&&p!=="data"&&!o.bi(f[l][p],r[l][p]))return!1;return!0}function hr(f,r,l,p,b,w){let C;for(C in r=r||{},f=f||{})f.hasOwnProperty(C)&&(o.bi(f[C],r[C])||l.push({command:w,args:[p,C,r[C],b]}));for(C in r)r.hasOwnProperty(C)&&!f.hasOwnProperty(C)&&(o.bi(f[C],r[C])||l.push({command:w,args:[p,C,r[C],b]}))}function Ti(f){return f.id}function $n(f,r){return f[r.id]=r,f}class ko{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ap(r,0,1);let l=1,p=this._distances[l];const b=r*this.paddedLength+this.padding;for(;p<b&&l<this._distances.length;)p=this._distances[++l];const w=l-1,C=this._distances[w],D=p-C,V=D>0?(b-C)/D:0;return this.points[w].mult(1-V).add(this.points[l].mult(V))}}class oi{constructor(r,l,p){const b=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(l/p);for(let C=0;C<this.xCellCount*this.yCellCount;C++)b.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,p,b,w){this._forEachCell(l,p,b,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(w)}insertCircle(r,l,p,b){this._forEachCell(l-b,p-b,l+b,p+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(p),this.circles.push(b)}_insertBoxCell(r,l,p,b,w,C){this.boxCells[w].push(C)}_insertCircleCell(r,l,p,b,w,C){this.circleCells[w].push(C)}_query(r,l,p,b,w,C){if(p<0||r>this.width||b<0||l>this.height)return!w&&[];const D=[];if(r<=0&&l<=0&&this.width<=p&&this.height<=b){if(w)return!0;for(let V=0;V<this.boxKeys.length;V++)D.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const q=this.circles[3*V],j=this.circles[3*V+1],X=this.circles[3*V+2];D.push({key:this.circleKeys[V],x1:q-X,y1:j-X,x2:q+X,y2:j+X})}return C?D.filter(C):D}return this._forEachCell(r,l,p,b,this._queryCell,D,{hitTest:w,seenUids:{box:{},circle:{}}},C),w?D.length>0:D}_queryCircle(r,l,p,b,w){const C=r-p,D=r+p,V=l-p,q=l+p;if(D<0||C>this.width||q<0||V>this.height)return!b&&[];const j=[];return this._forEachCell(C,V,D,q,this._queryCellCircle,j,{hitTest:b,circle:{x:r,y:l,radius:p},seenUids:{box:{},circle:{}}},w),b?j.length>0:j}query(r,l,p,b,w){return this._query(r,l,p,b,!1,w)}hitTest(r,l,p,b,w){return this._query(r,l,p,b,!0,w)}hitTestCircle(r,l,p,b){return this._queryCircle(r,l,p,!0,b)}_queryCell(r,l,p,b,w,C,D,V){const q=D.seenUids,j=this.boxCells[w];if(j!==null){const ee=this.bboxes;for(const ae of j)if(!q.box[ae]){q.box[ae]=!0;const be=4*ae;if(r<=ee[be+2]&&l<=ee[be+3]&&p>=ee[be+0]&&b>=ee[be+1]&&(!V||V(this.boxKeys[ae]))){if(D.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[ae],x1:ee[be],y1:ee[be+1],x2:ee[be+2],y2:ee[be+3]})}}}const X=this.circleCells[w];if(X!==null){const ee=this.circles;for(const ae of X)if(!q.circle[ae]){q.circle[ae]=!0;const be=3*ae;if(this._circleAndRectCollide(ee[be],ee[be+1],ee[be+2],r,l,p,b)&&(!V||V(this.circleKeys[ae]))){if(D.hitTest)return C.push(!0),!0;{const _e=ee[be],Te=ee[be+1],we=ee[be+2];C.push({key:this.circleKeys[ae],x1:_e-we,y1:Te-we,x2:_e+we,y2:Te+we})}}}}}_queryCellCircle(r,l,p,b,w,C,D,V){const q=D.circle,j=D.seenUids,X=this.boxCells[w];if(X!==null){const ae=this.bboxes;for(const be of X)if(!j.box[be]){j.box[be]=!0;const _e=4*be;if(this._circleAndRectCollide(q.x,q.y,q.radius,ae[_e+0],ae[_e+1],ae[_e+2],ae[_e+3])&&(!V||V(this.boxKeys[be])))return C.push(!0),!0}}const ee=this.circleCells[w];if(ee!==null){const ae=this.circles;for(const be of ee)if(!j.circle[be]){j.circle[be]=!0;const _e=3*be;if(this._circlesCollide(ae[_e],ae[_e+1],ae[_e+2],q.x,q.y,q.radius)&&(!V||V(this.circleKeys[be])))return C.push(!0),!0}}}_forEachCell(r,l,p,b,w,C,D,V){const q=this._convertToXCellCoord(r),j=this._convertToYCellCoord(l),X=this._convertToXCellCoord(p),ee=this._convertToYCellCoord(b);for(let ae=q;ae<=X;ae++)for(let be=j;be<=ee;be++)if(w.call(this,r,l,p,b,this.xCellCount*be+ae,C,D,V))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,p,b,w,C){const D=b-r,V=w-l,q=p+C;return q*q>D*D+V*V}_circleAndRectCollide(r,l,p,b,w,C,D){const V=(C-b)/2,q=Math.abs(r-(b+V));if(q>V+p)return!1;const j=(D-w)/2,X=Math.abs(l-(w+j));if(X>j+p)return!1;if(q<=V||X<=j)return!0;const ee=q-V,ae=X-j;return ee*ee+ae*ae<=p*p}}const yi={unknown:0,flipRequired:1,flipNotRequired:2},Hn=Math.tan(85*Math.PI/180);function fr(f,r,l,p,b,w,C){const D=o.a6.mat4.create();if(l)if(w.name==="globe"){const V=o.bj(b,r);o.a6.mat4.multiply(D,D,V)}else{const V=o.a6.mat2.invert([],C);D[0]=V[0],D[1]=V[1],D[4]=V[2],D[5]=V[3],p||o.a6.mat4.rotateZ(D,D,b.angle)}else o.a6.mat4.multiply(D,b.labelPlaneMatrix,f);return D}function br(f,r,l,p,b,w,C){const D=fr(f,r,l,p,b,w,C);return w.name==="globe"&&l||(D[2]=D[6]=D[10]=D[14]=0),D}function zr(f,r,l,p,b,w,C){if(l){if(w.name==="globe"){const D=fr(f,r,l,p,b,w,C);return o.a6.mat4.invert(D,D),o.a6.mat4.multiply(D,f,D),D}{const D=o.a6.mat4.clone(f),V=o.a6.mat4.identity([]);return V[0]=C[0],V[1]=C[1],V[4]=C[2],V[5]=C[3],o.a6.mat4.multiply(D,D,V),p||o.a6.mat4.rotateZ(D,D,-b.angle),D}}return b.glCoordMatrix}function sa(f,r,l,p){const b=[f,r,l,1];l?o.a6.vec4.transformMat4(b,b,p):hd(b,b,p);const w=b[3];return b[0]/=w,b[1]/=w,b[2]/=w,b}function xr(f,r){return Math.min(.5+f/r*.5,1.5)}function Ja(f,r){const l=f[0]/f[3],p=f[1]/f[3];return l>=-r[0]&&l<=r[0]&&p>=-r[1]&&p<=r[1]}function cc(f,r,l,p,b,w,C,D,V,q){const j=l.transform,X=p?f.textSizeData:f.iconSizeData,ee=o.bk(X,l.transform.zoom),ae=j.projection.name==="globe",be=[256/l.width*2+1,256/l.height*2+1],_e=p?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;_e.clear();let Te=null;ae&&(Te=p?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const we=f.lineVertexArray,Le=p?f.text.placedSymbolArray:f.icon.placedSymbolArray,Ue=l.transform.width/l.transform.height;let je,Ye=!1;for(let et=0;et<Le.length;et++){const Xe=Le.get(et),{numGlyphs:nt,writingMode:lt}=Xe;if(lt!==o.bl.vertical||Ye||je===o.bl.horizontal||(Ye=!0),je=lt,(Xe.hidden||lt===o.bl.vertical)&&!Ye){$s(nt,_e);continue}Ye=!1;const vt=new o.P(Xe.tileAnchorX,Xe.tileAnchorY);let{x:dt,y:ct,z:jt}=j.projection.projectTilePoint(vt.x,vt.y,q.canonical);if(V){const[hn,Vn,fo]=V(vt);dt+=hn,ct+=Vn,jt+=fo}const en=[dt,ct,jt,1];if(o.a6.vec4.transformMat4(en,en,r),!Ja(en,be)){$s(nt,_e);continue}const gn=en[3],An=xr(l.transform.getCameraToCenterDistance(j.projection),gn),Dn=o.bm(X,ee,Xe),It=C?Dn/An:Dn*An,pn=sa(dt,ct,jt,b);if(pn[3]<=0){$s(nt,_e);continue}let Xt={};const mn=C?null:V,xn=xi(Xe,It,!1,D,r,b,w,f.glyphOffsetArray,we,_e,Te,pn,vt,Xt,Ue,mn,j.projection,q,C);Ye=xn.useVertical,mn&&xn.needsFlipping&&(Xt={}),(xn.notEnoughRoom||Ye||xn.needsFlipping&&xi(Xe,It,!0,D,r,b,w,f.glyphOffsetArray,we,_e,Te,pn,vt,Xt,Ue,mn,j.projection,q,C).notEnoughRoom)&&$s(nt,_e)}p?(f.text.dynamicLayoutVertexBuffer.updateData(_e),Te&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(Te)):(f.icon.dynamicLayoutVertexBuffer.updateData(_e),Te&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(Te))}function uc(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e){const{lineStartIndex:Te,glyphStartIndex:we,segment:Le}=D,Ue=we+D.numGlyphs,je=Te+D.lineLength,Ye=r.getoffsetX(we),et=r.getoffsetX(Ue-1),Xe=ou(f*Ye,l,p,b,w,C,Le,Te,je,V,q,j,X,ee,!0,ae,be,_e);if(!Xe)return null;const nt=ou(f*et,l,p,b,w,C,Le,Te,je,V,q,j,X,ee,!0,ae,be,_e);return nt?{first:Xe,last:nt}:null}function pa(f,r,l,p){return f===o.bl.horizontal&&Math.abs(p)>Math.abs(l)?{useVertical:!0}:f===o.bl.vertical?p>0?{needsFlipping:!0}:null:r!==yi.unknown&&function(b,w){return b===0||Math.abs(w/b)>Hn}(l,p)?r===yi.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function xi(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te,we,Le){const Ue=r/24,je=f.lineOffsetX*Ue,Ye=f.lineOffsetY*Ue,{lineStartIndex:et,glyphStartIndex:Xe,numGlyphs:nt,segment:lt,writingMode:vt,flipState:dt}=f,ct=et+f.lineLength,jt=en=>{if(j){const[It,pn,Xt]=en.up,mn=q.length;o.bn(j,mn+0,It,pn,Xt),o.bn(j,mn+1,It,pn,Xt),o.bn(j,mn+2,It,pn,Xt),o.bn(j,mn+3,It,pn,Xt)}const[gn,An,Dn]=en.point;o.bo(q,gn,An,Dn,en.angle)};if(nt>1){const en=uc(Ue,D,je,Ye,l,X,ee,f,V,w,ae,_e,!1,Te,we,Le);if(!en)return{notEnoughRoom:!0};if(p&&!l){let[gn,An,Dn]=en.first.point,[It,pn,Xt]=en.last.point;[gn,An]=sa(gn,An,Dn,C),[It,pn]=sa(It,pn,Xt,C);const mn=pa(vt,dt,(It-gn)*be,pn-An);if(f.flipState=mn&&mn.needsFlipping?yi.flipRequired:yi.flipNotRequired,mn)return mn}jt(en.first);for(let gn=Xe+1;gn<Xe+nt-1;gn++){const An=ou(Ue*D.getoffsetX(gn),je,Ye,l,X,ee,lt,et,ct,V,w,ae,_e,!1,!1,Te,we,Le);if(!An)return q.length-=4*(gn-Xe),{notEnoughRoom:!0};jt(An)}jt(en.last)}else{if(p&&!l){const gn=sa(ee.x,ee.y,0,b),An=et+lt+1,Dn=new o.P(V.getx(An),V.gety(An)),It=sa(Dn.x,Dn.y,0,b),pn=It[3]>0?It:dc(ee,Dn,gn,1,b,void 0,Te,we.canonical),Xt=pa(vt,dt,(pn[0]-gn[0])*be,pn[1]-gn[1]);if(f.flipState=Xt&&Xt.needsFlipping?yi.flipRequired:yi.flipNotRequired,Xt)return Xt}const en=ou(Ue*D.getoffsetX(Xe),je,Ye,l,X,ee,lt,et,ct,V,w,ae,_e,!1,!1,Te,we,Le);if(!en)return{notEnoughRoom:!0};jt(en)}return{}}function Oh(f,r,l,p,b){const{x:w,y:C,z:D}=p.projectTilePoint(f.x,f.y,r);if(!b)return sa(w,C,D,l);const[V,q,j]=b(f);return sa(w+V,C+q,D+j,l)}function dc(f,r,l,p,b,w,C,D){const V=Oh(f.sub(r)._unit()._add(f),D,b,C,w);return o.a6.vec3.sub(V,l,V),o.a6.vec3.normalize(V,V),o.a6.vec3.scaleAndAdd(V,l,V,p)}function ou(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te,we){const Le=p?f-r:f+r;let Ue=Le>0?1:-1,je=0;p&&(Ue*=-1,je=Math.PI),Ue<0&&(je+=Math.PI);let Ye=D+C+(Ue>0?0:1)|0,et=b,Xe=b,nt=0,lt=0;const vt=Math.abs(Le),dt=[],ct=[];let jt=w,en=jt;const gn=()=>dc(en,jt,Xe,vt-nt+1,j,ee,_e,Te.canonical);for(;nt+lt<=vt;){if(Ye+=Ue,Ye<D||Ye>=V)return null;if(Xe=et,en=jt,dt.push(Xe),ae&&ct.push(en),jt=new o.P(q.getx(Ye),q.gety(Ye)),et=X[Ye],!et){const Vn=Oh(jt,Te.canonical,j,_e,ee);et=Vn[3]>0?X[Ye]=Vn:gn()}nt+=lt,lt=o.a6.vec3.distance(Xe,et)}be&&ee&&(X[Ye]&&(et=gn(),lt=o.a6.vec3.distance(Xe,et)),X[Ye]=et);const An=(vt-nt)/lt,Dn=jt.sub(en)._mult(An)._add(en),It=o.a6.vec3.sub([],et,Xe),pn=o.a6.vec3.scaleAndAdd([],Xe,It,An);let Xt=[0,0,1],mn=It[0],xn=It[1];if(we&&(Xt=_e.upVector(Te.canonical,Dn.x,Dn.y),Xt[0]!==0||Xt[1]!==0||Xt[2]!==1)){const Vn=[Xt[2],0,-Xt[0]],fo=o.a6.vec3.cross([],Xt,Vn);o.a6.vec3.normalize(Vn,Vn),o.a6.vec3.normalize(fo,fo),mn=o.a6.vec3.dot(It,Vn),xn=o.a6.vec3.dot(It,fo)}if(l){const Vn=o.a6.vec3.cross([],Xt,It);o.a6.vec3.normalize(Vn,Vn),o.a6.vec3.scaleAndAdd(pn,pn,Vn,l*Ue)}const hn=je+Math.atan2(xn,mn);return dt.push(pn),ae&&ct.push(Dn),{point:pn,angle:hn,path:dt,tilePath:ct,up:Xt}}function $s(f,r){const l=r.length,p=l+4*f;r.resize(p),r.float32.fill(-1/0,4*l,4*p)}function hd(f,r,l){const p=r[0],b=r[1];return f[0]=l[0]*p+l[4]*b+l[12],f[1]=l[1]*p+l[5]*b+l[13],f[3]=l[3]*p+l[7]*b+l[15],f}const Ia=100;class la{constructor(r,l,p=new oi(r.width+200,r.height+200,25),b=new oi(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=b,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Ia,this.screenBottomBoundary=r.height+Ia,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,p,b,w,C,D,V){let q=p.projectedAnchorX,j=p.projectedAnchorY,X=p.projectedAnchorZ;const ee=p.elevation,ae=p.tileID,be=r.getProjection();if(ee&&ae){const[et,Xe,nt]=be.upVector(ae.canonical,p.tileAnchorX,p.tileAnchorY),lt=be.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;q+=et*ee*lt,j+=Xe*ee*lt,X+=nt*ee*lt}const _e=this.projectAndGetPerspectiveRatio(D,q,j,X,p.tileID,be.name==="globe"||!!ee||this.transform.pitch>0,be),Te=C*_e.perspectiveRatio,we=(p.x1*l+b.x-p.padding)*Te+_e.point.x,Le=(p.y1*l+b.y-p.padding)*Te+_e.point.y,Ue=(p.x2*l+b.x+p.padding)*Te+_e.point.x,je=(p.y2*l+b.y+p.padding)*Te+_e.point.y,Ye=_e.perspectiveRatio<=.55||_e.occluded;return!this.isInsideGrid(we,Le,Ue,je)||!w&&this.grid.hitTest(we,Le,Ue,je,V)||Ye?{box:[],offscreen:!1,occluded:_e.occluded}:{box:[we,Le,Ue,je],offscreen:this.isOffscreen(we,Le,Ue,je),occluded:!1}}placeCollisionCircles(r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e){const Te=[],we=this.transform.elevation,Le=r.getProjection(),Ue=we?we.getAtTileOffsetFunc(_e,this.transform.center.lat,this.transform.worldSize,Le):null,je=new o.P(p.tileAnchorX,p.tileAnchorY);let{x:Ye,y:et,z:Xe}=Le.projectTilePoint(je.x,je.y,_e.canonical);if(Ue){const[Dn,It,pn]=Ue(je);Ye+=Dn,et+=It,Xe+=pn}const nt=Le.name==="globe",lt=this.projectAndGetPerspectiveRatio(D,Ye,et,Xe,_e,nt||!!we||this.transform.pitch>0,Le),{perspectiveRatio:vt}=lt,dt=(X?C/vt:C*vt)/o.br,ct=sa(Ye,et,Xe,V),jt=lt.signedDistanceFromCamera>0?uc(dt,w,p.lineOffsetX*dt,p.lineOffsetY*dt,!1,ct,je,p,b,V,{},we&&!X?Ue:null,X&&!!we,Le,_e,X):null;let en=!1,gn=!1,An=!0;if(jt&&!lt.occluded){const Dn=.5*ae*vt+be,It=new o.P(-100,-100),pn=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Xt=new ko,{first:mn,last:xn}=jt,hn=mn.path.length;let Vn=[];for(let ro=hn-1;ro>=1;ro--)Vn.push(mn.path[ro]);for(let ro=1;ro<xn.path.length;ro++)Vn.push(xn.path[ro]);const fo=2.5*Dn;q&&(Vn=Vn.map(([ro,So,Wn],Ro)=>(Ue&&!nt&&(Wn=Ue(Ro<hn-1?mn.tilePath[hn-1-Ro]:xn.tilePath[Ro-hn+2])[2]),sa(ro,So,Wn,q))),Vn.some(ro=>ro[3]<=0)&&(Vn=[]));let xo=[];if(Vn.length>0){let ro=1/0,So=-1/0,Wn=1/0,Ro=-1/0;for(const Ko of Vn)ro=Math.min(ro,Ko[0]),Wn=Math.min(Wn,Ko[1]),So=Math.max(So,Ko[0]),Ro=Math.max(Ro,Ko[1]);So>=It.x&&ro<=pn.x&&Ro>=It.y&&Wn<=pn.y&&(xo=[Vn.map(Ko=>new o.P(Ko[0],Ko[1]))],(ro<It.x||So>pn.x||Wn<It.y||Ro>pn.y)&&(xo=o.bp(xo,It.x,It.y,pn.x,pn.y)))}for(const ro of xo){Xt.reset(ro,.25*Dn);let So=0;So=Xt.length<=.5*Dn?1:Math.ceil(Xt.paddedLength/fo)+1;for(let Wn=0;Wn<So;Wn++){const Ro=Wn/Math.max(So-1,1),Ko=Xt.lerp(Ro),mr=Ko.x+Ia,Kr=Ko.y+Ia;Te.push(mr,Kr,Dn,0);const Sr=mr-Dn,ii=Kr-Dn,Ar=mr+Dn,Zr=Kr+Dn;if(An=An&&this.isOffscreen(Sr,ii,Ar,Zr),gn=gn||this.isInsideGrid(Sr,ii,Ar,Zr),!l&&this.grid.hitTestCircle(mr,Kr,Dn,ee)&&(en=!0,!j))return{circles:[],offscreen:!1,collisionDetected:en,occluded:!1}}}}return{circles:!j&&en||!gn?[]:Te,offscreen:An,collisionDetected:en,occluded:lt.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let p=1/0,b=1/0,w=-1/0,C=-1/0;for(const j of r){const X=new o.P(j.x+Ia,j.y+Ia);p=Math.min(p,X.x),b=Math.min(b,X.y),w=Math.max(w,X.x),C=Math.max(C,X.y),l.push(X)}const D=this.grid.query(p,b,w,C).concat(this.ignoredGrid.query(p,b,w,C)),V={},q={};for(const j of D){const X=j.key;if(V[X.bucketInstanceId]===void 0&&(V[X.bucketInstanceId]={}),V[X.bucketInstanceId][X.featureIndex])continue;const ee=[new o.P(j.x1,j.y1),new o.P(j.x2,j.y1),new o.P(j.x2,j.y2),new o.P(j.x1,j.y2)];o.bq(l,ee)&&(V[X.bucketInstanceId][X.featureIndex]=!0,q[X.bucketInstanceId]===void 0&&(q[X.bucketInstanceId]=[]),q[X.bucketInstanceId].push(X.featureIndex))}return q}insertCollisionBox(r,l,p,b,w){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:b,collisionGroupID:w},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,p,b,w){const C=l?this.ignoredGrid:this.grid,D={bucketInstanceId:p,featureIndex:b,collisionGroupID:w};for(let V=0;V<r.length;V+=4)C.insertCircle(D,r[V],r[V+1],r[V+2])}projectAndGetPerspectiveRatio(r,l,p,b,w,C,D){const V=[l,p,b,1];let q=!1;b||this.transform.pitch>0?(o.a6.vec4.transformMat4(V,V,r),this.fogState&&w&&D.name!=="globe"&&(q=function(ee,ae,be,_e,Te,we){const Le=we.calculateFogTileMatrix(Te),Ue=[ae,be,_e];return o.a6.vec3.transformMat4(Ue,Ue,Le),Yt(ee,o.a6.vec3.length(Ue),we.pitch,we._fov)}(this.fogState,l,p,b,w.toUnwrapped(),this.transform)>.9)):hd(V,V,r);const j=V[3];return{point:new o.P((V[0]/j+1)/2*this.transform.width+Ia,(-V[1]/j+1)/2*this.transform.height+Ia),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/j*.5,1.5),signedDistanceFromCamera:j,occluded:C&&V[2]>j||q}}isOffscreen(r,l,p,b){return p<Ia||r>=this.screenRightBoundary||b<Ia||l>this.screenBottomBoundary}isInsideGrid(r,l,p,b){return p>=0&&r<this.gridRightBoundary&&b>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=o.a6.mat4.identity([]);return o.a6.mat4.translate(r,r,[-100,-100,0]),r}}function ma(f,r,l){const p=r.createTileMatrix(f,f.worldSize,l.toUnwrapped());return o.a6.mat4.multiply(new Float32Array(16),f.projMatrix,p)}function Zf(f,r,l){if(r.projection.name===l.projection.name)return f.projMatrix;const p=l.clone();return p.setProjection(r.projection),ma(p,r.getProjection(),f)}function El(f,r,l){return r.name===l.projection.name?f.projMatrix:ma(l,r,f)}class Ci{constructor(r,l,p,b){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):b&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ca{constructor(r,l,p,b,w,C=!1){this.text=new Ci(r?r.text:null,l,p,w),this.icon=new Ci(r?r.icon:null,l,b,w),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qa{constructor(r,l,p,b=!1){this.text=r,this.icon=l,this.skipFade=p,this.clipped=b}}class _i{constructor(){this.invProjMatrix=o.a6.mat4.create(),this.viewportMatrix=o.a6.mat4.create(),this.circles=[]}}class fd{constructor(r,l,p,b,w){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=b,this.tileID=w}}class es{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[r]}}function ru(f,r,l,p,b){const{horizontalAlign:w,verticalAlign:C}=o.by(f),D=-(w-.5)*r,V=-(C-.5)*l,q=o.bx(f,p);return new o.P(D+q[0]*b,V+q[1]*b)}function Ml(f,r,l,p,b){const w=new o.P(f,r);return l&&w._rotate(p?b:-b),w}class Vs{constructor(r,l,p,b,w,C){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new la(this.transform,w),this.buildingIndex=C,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new es(p),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,p,b,w=1){const C=p.getBucket(l),D=p.latestFeatureIndex;if(!C||!D||l.fqid!==C.layerIds[0])return;const V=C.layers[0].layout,q=C.layers[0].paint,j=p.collisionBoxArray,X=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),ee=p.tileSize/o.ab,ae=p.tileID.toUnwrapped();this.transform.setProjection(C.projection);const be=(_e=p.tileID,Te=C.getProjection(),we=this.transform,Te.name===this.projection?we.calculateProjMatrix(_e.toUnwrapped()):ma(we,Te,_e));var _e,Te,we;const Le=V.get("text-pitch-alignment")==="map",Ue=V.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const je=l.dynamicFilter(),Ye=l.dynamicFilterNeedsFeature(),et=this.transform.calculatePixelsToTileUnitsMatrix(p),Xe=br(be,p.tileID.canonical,Le,Ue,this.transform,C.getProjection(),et);let nt=null;if(Le){const gn=zr(be,p.tileID.canonical,Le,Ue,this.transform,C.getProjection(),et);nt=o.a6.mat4.multiply([],this.transform.labelPlaneMatrix,gn)}let lt=null;je&&p.latestFeatureIndex&&(lt={unwrappedTileID:ae,dynamicFilter:je,dynamicFilterNeedsFeature:Ye}),this.retainedQueryData[C.bucketInstanceId]=new fd(C.bucketInstanceId,D,C.sourceLayerIndex,C.index,p.tileID);const vt=C.layers[0].layout.get("text-size-scale-range"),dt=o.ap(w,vt[0],vt[1]),ct=C.layers[0].layout.get("icon-size-scale-range"),jt=o.ap(w,ct[0],ct[1]),en={bucket:C,layout:V,paint:q,posMatrix:be,textLabelPlaneMatrix:Xe,labelToScreenMatrix:nt,clippingData:lt,scale:X,textPixelRatio:ee,holdingForFade:p.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:o.bk(C.textSizeData,this.transform.zoom,dt),partiallyEvaluatedIconSize:o.bk(C.iconSizeData,this.transform.zoom,jt),collisionGroup:this.collisionGroups.get(C.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(b)for(const gn of C.sortKeyRanges){const{sortKey:An,symbolInstanceStart:Dn,symbolInstanceEnd:It}=gn;r.push({sortKey:An,symbolInstanceStart:Dn,symbolInstanceEnd:It,parameters:en})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:en})}attemptAnchorPlacement(r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te,we,Le){const{textOffset0:Ue,textOffset1:je,crossTileID:Ye}=ee,et=[Ue,je],Xe=ru(r,p,b,et,w),nt=this.collisionIndex.placeCollisionBox(be,w,l,Ml(Xe.x,Xe.y,C,D,this.transform.angle),X,V,q,j.predicate);if(Te){const lt=be.getSymbolInstanceIconSize(Le,this.transform.zoom,ee.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(be,lt,Te,Ml(Xe.x,Xe.y,C,D,this.transform.angle),X,V,q,j.predicate).box.length===0)return}if(nt.box.length>0){let lt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ye]&&this.prevPlacement.placements[Ye]&&this.prevPlacement.placements[Ye].text&&(lt=this.prevPlacement.variableOffsets[Ye].anchor),this.variableOffsets[Ye]={textOffset:et,width:p,height:b,anchor:r,textScale:w,prevAnchor:lt},this.markUsedJustification(be,r,ee,_e),be.allowVerticalPlacement&&(this.markUsedOrientation(be,_e,ee),this.placedOrientations[Ye]=_e),{shift:Xe,placedGlyphBoxes:nt}}}placeLayerBucketPart(r,l,p,b,w=1){const{bucket:C,layout:D,paint:V,posMatrix:q,textLabelPlaneMatrix:j,labelToScreenMatrix:X,clippingData:ee,textPixelRatio:ae,holdingForFade:be,collisionBoxArray:_e,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:we,collisionGroup:Le,latestFeatureIndex:Ue}=r.parameters,je=D.get("text-optional"),Ye=D.get("icon-optional"),et=D.get("text-allow-overlap"),Xe=D.get("icon-allow-overlap"),nt=D.get("text-rotation-alignment")==="map",lt=D.get("text-pitch-alignment")==="map",vt=D.get("symbol-z-elevate"),dt=V.get("symbol-z-offset"),ct=D.get("symbol-elevation-reference")==="sea",jt=D.get("text-size-scale-range"),en=D.get("icon-size-scale-range"),gn=o.ap(w,jt[0],jt[1]),An=o.ap(w,en[0],en[1]);this.transform.setProjection(C.projection);let Dn=et&&(Xe||!C.hasIconData()||Ye),It=Xe&&(et||!C.hasTextData()||je);const pn=!dt.isConstant();!C.collisionArrays&&_e&&C.deserializeCollisionBoxes(_e),p&&b&&C.updateCollisionDebugBuffers(this.transform.zoom,_e,gn,An);const Xt=(mn,xn,hn)=>{const{crossTileID:Vn,numVerticalGlyphVertices:fo}=mn;let xo=null;if(ee&&ee.dynamicFilterNeedsFeature||pn){const wr=this.retainedQueryData[C.bucketInstanceId];xo=Ue.loadFeature({featureIndex:mn.featureIndex,bucketIndex:wr.bucketIndex,sourceLayerIndex:wr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(ee&&!(0,ee.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},xo,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new o.P(mn.tileAnchorX,mn.tileAnchorY),this.transform.calculateDistanceTileData(ee.unwrappedTileID)))return this.placements[Vn]=new Qa(!1,!1,!1,!0),void l.add(Vn);const ro=dt.evaluate(xo,{});if(l.has(Vn))return;if(be)return void(this.placements[Vn]=new Qa(!1,!1,!1));let So=!1,Wn=!1,Ro=!0,Ko=!1,mr=!1,Kr=null,Sr={box:null,offscreen:null,occluded:null},ii={box:null,offscreen:null,occluded:null},Ar=null,Zr=null,sr=null,Gr=0,Ur=0,Lr=0;hn.textFeatureIndex?Gr=hn.textFeatureIndex:mn.useRuntimeCollisionCircles&&(Gr=mn.featureIndex),hn.verticalTextFeatureIndex&&(Ur=hn.verticalTextFeatureIndex);const fi=wr=>{wr.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const _r=this.transform.elevation;wr.elevation=ct?ro:ro+(_r?_r.getAtTileOffset(wr.tileID,wr.tileAnchorX,wr.tileAnchorY):0),wr.elevation+=mn.zOffset},Yi=hn.textBox;if(Yi){fi(Yi);const wr=kr=>{let Jr=o.bl.horizontal;if(C.allowVerticalPlacement&&!kr&&this.prevPlacement){const Pi=this.prevPlacement.placedOrientations[Vn];Pi&&(this.placedOrientations[Vn]=Pi,Jr=Pi,this.markUsedOrientation(C,Jr,mn))}return Jr},_r=(kr,Jr)=>{if(C.allowVerticalPlacement&&fo>0&&hn.verticalTextBox){for(const Pi of C.writingModes)if(Pi===o.bl.vertical?(Sr=Jr(),ii=Sr):Sr=kr(),Sr&&Sr.box&&Sr.box.length)break}else Sr=kr()};if(D.get("text-variable-anchor")){let kr=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Vn]){const pi=this.prevPlacement.variableOffsets[Vn];kr.indexOf(pi.anchor)>0&&(kr=kr.filter(ra=>ra!==pi.anchor),kr.unshift(pi.anchor))}const Jr=(pi,ra,Ul)=>{const rs=C.getSymbolInstanceTextSize(Te,mn,this.transform.zoom,xn),is=(pi.x2-pi.x1)*rs+2*pi.padding,Zs=(pi.y2-pi.y1)*rs+2*pi.padding,ml=mn.hasIconTextFit&&!Xe?ra:null;ml&&fi(ml);let as={box:[],offscreen:!1,occluded:!1};const kc=et?2*kr.length:kr.length;for(let Ys=0;Ys<kc;++Ys){const Fr=this.attemptAnchorPlacement(kr[Ys%kr.length],pi,is,Zs,rs,nt,lt,ae,q,Le,Ys>=kr.length,mn,xn,C,Ul,ml,Te,we);if(Fr&&(as=Fr.placedGlyphBoxes,as&&as.box&&as.box.length)){So=!0,Kr=Fr.shift;break}}return as};_r(()=>Jr(Yi,hn.iconBox,o.bl.horizontal),()=>{const pi=hn.verticalTextBox;return pi&&fi(pi),C.allowVerticalPlacement&&!(Sr&&Sr.box&&Sr.box.length)&&fo>0&&pi?Jr(pi,hn.verticalIconBox,o.bl.vertical):{box:null,offscreen:null,occluded:null}}),Sr&&(So=Sr.box,Ro=Sr.offscreen,Ko=Sr.occluded);const Pi=wr(!(!Sr||!Sr.box));if(!So&&this.prevPlacement){const pi=this.prevPlacement.variableOffsets[Vn];pi&&(this.variableOffsets[Vn]=pi,this.markUsedJustification(C,pi.anchor,mn,Pi))}}else{const kr=(Jr,Pi)=>{const pi=C.getSymbolInstanceTextSize(Te,mn,this.transform.zoom,xn,w),ra=this.collisionIndex.placeCollisionBox(C,pi,Jr,new o.P(0,0),et,ae,q,Le.predicate);return ra&&ra.box&&ra.box.length&&(this.markUsedOrientation(C,Pi,mn),this.placedOrientations[Vn]=Pi),ra};_r(()=>kr(Yi,o.bl.horizontal),()=>{const Jr=hn.verticalTextBox;return C.allowVerticalPlacement&&fo>0&&Jr?(fi(Jr),kr(Jr,o.bl.vertical)):{box:null,offscreen:null,occluded:null}}),wr(!!(Sr&&Sr.box&&Sr.box.length))}}if(Ar=Sr,So=Ar&&Ar.box&&Ar.box.length>0,Ro=Ar&&Ar.offscreen,Ko=Ar&&Ar.occluded,mn.useRuntimeCollisionCircles){const wr=C.text.placedSymbolArray.get(mn.centerJustifiedTextSymbolIndex>=0?mn.centerJustifiedTextSymbolIndex:mn.verticalPlacedTextSymbolIndex),_r=o.bm(C.textSizeData,Te,wr),kr=D.get("text-padding");Zr=this.collisionIndex.placeCollisionCircles(C,et,wr,C.lineVertexArray,C.glyphOffsetArray,_r,q,j,X,p,lt,Le.predicate,mn.collisionCircleDiameter*_r/o.br,kr,this.retainedQueryData[C.bucketInstanceId].tileID),So=et||Zr.circles.length>0&&!Zr.collisionDetected,Ro=Ro&&Zr.offscreen,Ko=Zr.occluded}if(hn.iconFeatureIndex&&(Lr=hn.iconFeatureIndex),hn.iconBox){const wr=_r=>{fi(_r);const kr=mn.hasIconTextFit&&Kr?Ml(Kr.x,Kr.y,nt,lt,this.transform.angle):new o.P(0,0),Jr=C.getSymbolInstanceIconSize(we,this.transform.zoom,mn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Jr,_r,kr,Xe,ae,q,Le.predicate)};ii&&ii.box&&ii.box.length&&hn.verticalIconBox?(sr=wr(hn.verticalIconBox),Wn=sr.box.length>0):(sr=wr(hn.iconBox),Wn=sr.box.length>0),Ro=Ro&&sr.offscreen,mr=sr.occluded}const Ts=je||mn.numHorizontalGlyphVertices===0&&fo===0,Ks=Ye||mn.numIconVertices===0;if(Ts||Ks?Ks?Ts||(Wn=Wn&&So):So=Wn&&So:Wn=So=Wn&&So,So&&Ar&&Ar.box&&this.collisionIndex.insertCollisionBox(Ar.box,D.get("text-ignore-placement"),C.bucketInstanceId,ii&&ii.box&&Ur?Ur:Gr,Le.ID),Wn&&sr&&this.collisionIndex.insertCollisionBox(sr.box,D.get("icon-ignore-placement"),C.bucketInstanceId,Lr,Le.ID),Zr&&(So&&this.collisionIndex.insertCollisionCircles(Zr.circles,D.get("text-ignore-placement"),C.bucketInstanceId,Gr,Le.ID),p)){const wr=C.bucketInstanceId;let _r=this.collisionCircleArrays[wr];_r===void 0&&(_r=this.collisionCircleArrays[wr]=new _i);for(let kr=0;kr<Zr.circles.length;kr+=4)_r.circles.push(Zr.circles[kr+0]),_r.circles.push(Zr.circles[kr+1]),_r.circles.push(Zr.circles[kr+2]),_r.circles.push(Zr.collisionDetected?1:0)}const ea=C.projection.name!=="globe";Dn=Dn&&(ea||!Ko),It=It&&(ea||!mr),this.placements[Vn]=new Qa(So||Dn,Wn||It,Ro||C.justReloaded),l.add(Vn)};if(vt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,this.retainedQueryData[C.bucketInstanceId].tileID),C.updateZOffset()),C.sortFeaturesByY){const mn=C.getSortedSymbolIndexes(this.transform.angle);for(let xn=mn.length-1;xn>=0;--xn){const hn=mn[xn];Xt(C.symbolInstances.get(hn),hn,C.collisionArrays[hn])}C.hasAnyZOffset&&o.w(`${C.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(C.hasAnyZOffset){const mn=C.getSortedIndexesByZOffset();for(let xn=0;xn<mn.length;++xn){const hn=mn[xn];Xt(C.symbolInstances.get(hn),hn,C.collisionArrays[hn])}}else for(let mn=r.symbolInstanceStart;mn<r.symbolInstanceEnd;mn++)Xt(C.symbolInstances.get(mn),mn,C.collisionArrays[mn]);if(p&&C.bucketInstanceId in this.collisionCircleArrays){const mn=this.collisionCircleArrays[C.bucketInstanceId];o.a6.mat4.invert(mn.invProjMatrix,q),mn.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(r,l,p,b){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:V,crossTileID:q}=p,j=o.bw(l),X=b===o.bl.vertical?V:j==="left"?w:j==="center"?C:j==="right"?D:-1;w>=0&&(r.text.placedSymbolArray.get(w).crossTileID=X>=0&&w!==X?0:q),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=X>=0&&C!==X?0:q),D>=0&&(r.text.placedSymbolArray.get(D).crossTileID=X>=0&&D!==X?0:q),V>=0&&(r.text.placedSymbolArray.get(V).crossTileID=X>=0&&V!==X?0:q)}markUsedOrientation(r,l,p){const b=l===o.bl.horizontal||l===o.bl.horizontalOnly?l:0,w=l===o.bl.vertical?l:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:V,verticalPlacedTextSymbolIndex:q}=p,j=r.text.placedSymbolArray;C>=0&&(j.get(C).placedOrientation=b),D>=0&&(j.get(D).placedOrientation=b),V>=0&&(j.get(V).placedOrientation=b),q>=0&&(j.get(q).placedOrientation=w)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const b=l?l.symbolFadeChange(r):1,w=l?l.opacities:{},C=l?l.variableOffsets:{},D=l?l.placedOrientations:{};for(const V in this.placements){const q=this.placements[V],j=w[V];j?(this.opacities[V]=new ca(j,b,q.text,q.icon,null,q.clipped),p=p||q.text!==j.text.placed||q.icon!==j.icon.placed):(this.opacities[V]=new ca(null,b,q.text,q.icon,q.skipFade,q.clipped),p=p||q.text||q.icon)}for(const V in w){const q=w[V];if(!this.opacities[V]){const j=new ca(q,b,!1,!1);j.isHidden()||(this.opacities[V]=j,p=p||q.text.placed||q.icon.placed)}}for(const V in C)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=C[V]);for(const V in D)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=D[V]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,p,b){const w=new Set;for(const C of l){const D=C.getBucket(r);D&&C.latestFeatureIndex&&r.fqid===D.layerIds[0]&&(this.updateBucketOpacities(D,w,C,C.collisionBoxArray,p,b,C.tileID,r.scope),D.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(D,C.tileID),D.updateZOffset()))}}updateBucketOpacities(r,l,p,b,w,C,D,V){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const q=r.layers[0].layout,j=r.layers[0].paint,X=!!r.layers[0].dynamicFilter(),ee=new ca(null,0,!1,!1,!0),ae=q.get("text-allow-overlap"),be=q.get("icon-allow-overlap"),_e=q.get("text-variable-anchor"),Te=q.get("text-rotation-alignment")==="map",we=q.get("text-pitch-alignment")==="map",Le=j.get("symbol-z-offset"),Ue=q.get("symbol-elevation-reference")==="sea",je=!Le.isConstant(),Ye=new ca(null,0,ae&&(be||!r.hasIconData()||q.get("icon-optional")),be&&(ae||!r.hasTextData()||q.get("text-optional")),!0);!r.collisionArrays&&b&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(b);const et=(nt,lt,vt)=>{for(let dt=0;dt<lt/4;dt++)nt.opacityVertexArray.emplaceBack(vt)};let Xe=0;C&&r.updateReplacement(D,C);for(let nt=0;nt<r.symbolInstances.length;nt++){const lt=r.symbolInstances.get(nt),{numHorizontalGlyphVertices:vt,numVerticalGlyphVertices:dt,crossTileID:ct,numIconVertices:jt,tileAnchorX:en,tileAnchorY:gn}=lt;let An=null;const Dn=this.retainedQueryData[r.bucketInstanceId];je&&lt&&Dn&&(An=p.latestFeatureIndex.loadFeature({featureIndex:lt.featureIndex,bucketIndex:Dn.bucketIndex,sourceLayerIndex:Dn.sourceLayerIndex,layoutVertexArrayOffset:0}));const It=Le.evaluate(An,{}),pn=l.has(ct);let Xt=this.opacities[ct];pn?Xt=ee:Xt||(Xt=Ye,this.opacities[ct]=Xt),l.add(ct);const mn=vt>0||dt>0,xn=jt>0,hn=this.placedOrientations[ct],Vn=hn===o.bl.vertical,fo=hn===o.bl.horizontal||hn===o.bl.horizontalOnly;!mn&&!xn||Xt.isHidden()||Xe++;let xo=!1;if((mn||xn)&&C)for(const ro of r.activeReplacements){if(o.bs(ro,w,o.bt.Symbol,V)||ro.min.x>en||en>ro.max.x||ro.min.y>gn||gn>ro.max.y)continue;const So=o.bu(en,gn,D.canonical,ro.footprintTileId.canonical);if(xo=o.bv(So,ro.footprint),xo)break}if(mn){const ro=xo?Al:js(Xt.text);et(r.text,vt,Vn?Al:ro),et(r.text,dt,fo?Al:ro);const So=Xt.text.isHidden(),{leftJustifiedTextSymbolIndex:Wn,centerJustifiedTextSymbolIndex:Ro,rightJustifiedTextSymbolIndex:Ko,verticalPlacedTextSymbolIndex:mr}=lt,Kr=r.text.placedSymbolArray,Sr=So||Vn?1:0;Wn>=0&&(Kr.get(Wn).hidden=Sr),Ro>=0&&(Kr.get(Ro).hidden=Sr),Ko>=0&&(Kr.get(Ko).hidden=Sr),mr>=0&&(Kr.get(mr).hidden=So||fo?1:0);const ii=this.variableOffsets[ct];ii&&this.markUsedJustification(r,ii.anchor,lt,hn);const Ar=this.placedOrientations[ct];Ar&&(this.markUsedJustification(r,"left",lt,Ar),this.markUsedOrientation(r,Ar,lt))}if(xn){const ro=xo?Al:js(Xt.icon),{placedIconSymbolIndex:So,verticalPlacedIconSymbolIndex:Wn}=lt,Ro=r.icon.placedSymbolArray,Ko=Xt.icon.isHidden()?1:0;So>=0&&(et(r.icon,jt,Vn?Al:ro),Ro.get(So).hidden=Ko),Wn>=0&&(et(r.icon,lt.numVerticalIconVertices,fo?Al:ro),Ro.get(Wn).hidden=Ko)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const ro=r.collisionArrays[nt];if(ro){let So=new o.P(0,0),Wn=!0;if(ro.textBox||ro.verticalTextBox){if(_e){const Ko=this.variableOffsets[ct];Ko?(So=ru(Ko.anchor,Ko.width,Ko.height,Ko.textOffset,Ko.textScale),Te&&So._rotate(we?this.transform.angle:-this.transform.angle)):Wn=!1}X&&(Wn=!Xt.clipped),ro.textBox&&Lu(r.textCollisionBox.collisionVertexArray,Xt.text.placed,!Wn||Vn,It,Ue,So.x,So.y),ro.verticalTextBox&&Lu(r.textCollisionBox.collisionVertexArray,Xt.text.placed,!Wn||fo,It,Ue,So.x,So.y)}const Ro=Wn&&!!(!fo&&ro.verticalIconBox);ro.iconBox&&Lu(r.iconCollisionBox.collisionVertexArray,Xt.icon.placed,Ro,It,Ue,lt.hasIconTextFit?So.x:0,lt.hasIconTextFit?So.y:0),ro.verticalIconBox&&Lu(r.iconCollisionBox.collisionVertexArray,Xt.icon.placed,!Ro,It,Ue,lt.hasIconTextFit?So.x:0,lt.hasIconTextFit?So.y:0)}}}if(r.fullyClipped=Xe===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const nt=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=nt.invProjMatrix,r.placementViewportMatrix=nt.viewportMatrix,r.collisionCircleArray=nt.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function Lu(f,r,l,p,b,w,C){f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0)}const Us=Math.pow(2,25),Zm=Math.pow(2,24),Il=Math.pow(2,17),va=Math.pow(2,16),Ym=Math.pow(2,9),pd=Math.pow(2,8),md=Math.pow(2,1);function js(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,l=Math.floor(127*f.opacity);return l*Us+r*Zm+l*Il+r*va+l*Ym+r*pd+l*md+r}const Al=0;class Lh{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,p,b,w,C){const D=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(D,b,r[this._currentTileIndex],this._sortAcrossTiles,C),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((V,q)=>V.sortKey-q.sortKey));this._currentPartIndex<D.length;){const V=D[this._currentPartIndex];if(l.placeLayerBucketPart(V,this._seenCrossTileIDs,p,V.symbolInstanceStart===0,C),this._currentPartIndex++,w())return!0}return!1}}class hc{constructor(r,l,p,b,w,C,D,V,q){this.placement=new Vs(r,w,C,D,V,q),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(r,l,p,b,w){const C=o.q.now(),D=()=>{const V=o.q.now()-C;return!this._forceFullPlacement&&V>2};for(;this._currentPlacementIndex>=0;){const V=l[r[this._currentPlacementIndex]],q=this.placement.collisionIndex.transform.zoom;if(V.type==="symbol"&&(!V.minzoom||V.minzoom<=q)&&(!V.maxzoom||V.maxzoom>q)){const j=V,X=j.layout.get("symbol-z-elevate"),ee=j.layout.get("symbol-sort-key").constantOr(1)!==void 0,ae=j.layout.get("symbol-z-order"),be=ae==="viewport-y"||ae==="auto"&&!(ae!=="viewport-y"&&ee),_e=j.layout.get("text-allow-overlap")||j.layout.get("icon-allow-overlap")||j.layout.get("text-ignore-placement")||j.layout.get("icon-ignore-placement"),Te=be&&_e,we=this._inProgressLayer=this._inProgressLayer||new Lh(j),Le=o.av(V.source,V.scope);if(we.continuePlacement(X||Te?b[Le]:p[Le],this.placement,this._showCollisionBoxes,V,D,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const _s=512/o.ab/2;class Xm{constructor(r,l,p){this.tileID=r,this.bucketInstanceId=p,this.index=new o.bz(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=r.canonical.x*o.ab,w=r.canonical.y*o.ab;for(let C=0;C<l.length;C++){const{key:D,crossTileID:V,tileAnchorX:q,tileAnchorY:j}=l.get(C),X=Math.floor((b+q)*_s),ee=Math.floor((w+j)*_s);this.index.add(X,ee),this.keys.push(D),this.crossTileIDs.push(V)}this.index.finish()}findMatches(r,l,p){const b=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),w=_s/Math.pow(2,l.canonical.z-this.tileID.canonical.z),C=l.canonical.x*o.ab,D=l.canonical.y*o.ab;for(let V=0;V<r.length;V++){const q=r.get(V);if(q.crossTileID)continue;const{key:j,tileAnchorX:X,tileAnchorY:ee}=q,ae=Math.floor((C+X)*w),be=Math.floor((D+ee)*w),_e=this.index.range(ae-b,be-b,ae+b,be+b);for(const Te of _e){const we=this.crossTileIDs[Te];if(this.keys[Te]===j&&!p.has(we)){p.add(we),q.crossTileID=we;break}}}}}class iu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Yf{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const p in this.indexes){const b=this.indexes[p],w={};for(const C in b){const D=b[C];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+l),w[D.tileID.key]=D}this.indexes[p]=w}this.lng=r}addBucket(r,l,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const b=this.usedCrossTileIDs[r.overscaledZ];for(const w in this.indexes){const C=this.indexes[w];if(Number(w)>r.overscaledZ)for(const D in C){const V=C[D];V.tileID.isChildOf(r)&&V.findMatches(l.symbolInstances,r,b)}else{const D=C[r.scaledTo(Number(w)).key];D&&D.findMatches(l.symbolInstances,r,b)}}for(let w=0;w<l.symbolInstances.length;w++){const C=l.symbolInstances.get(w);C.crossTileID||(C.crossTileID=p.generate(),b.add(C.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Xm(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const p of l.crossTileIDs)this.usedCrossTileIDs[r].delete(p)}removeStaleBuckets(r){let l=!1;for(const p in this.indexes){const b=this.indexes[p];for(const w in b)r[b[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,b[w]),delete b[w],l=!0)}return l}}class gd{constructor(){this.layerIndexes={},this.crossTileIDs=new iu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,p,b){let w=this.layerIndexes[r.fqid];w===void 0&&(w=this.layerIndexes[r.fqid]=new Yf);let C=!1;const D={};b.name!=="globe"&&w.handleWrapJump(p);for(const V of l){const q=V.getBucket(r);q&&r.fqid===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(V.tileID,q,this.crossTileIDs)&&(C=!0),D[q.bucketInstanceId]=!0)}return w.removeStaleBuckets(D)&&(C=!0),C}pruneUnusedLayers(r){const l={};r.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const Fa=771;class ir{constructor(r,l,p,b){this.blendFunction=r,this.blendColor=l,this.mask=p,this.blendEquation=b}}ir.Replace=[1,0,1,0],ir.disabled=new ir(ir.Replace,o.bA.transparent,[!1,!1,!1,!1]),ir.unblended=new ir(ir.Replace,o.bA.transparent,[!0,!0,!0,!0]),ir.alphaBlended=new ir([1,Fa,1,Fa],o.bA.transparent,[!0,!0,!0,!0]),ir.alphaBlendedNonPremultiplied=new ir([770,Fa,770,Fa],o.bA.transparent,[!0,!0,!0,!0]),ir.multiply=new ir([774,0,774,0],o.bA.transparent,[!0,!0,!0,!0]);class bo{constructor(r,l,p){this.func=r,this.mask=l,this.range=p}}bo.ReadOnly=!1,bo.ReadWrite=!0,bo.disabled=new bo(519,bo.ReadOnly,[0,1]);const sl=7680;class Do{constructor(r,l,p,b,w,C){this.test=r,this.ref=l,this.mask=p,this.fail=b,this.depthFail=w,this.pass=C}}Do.disabled=new Do({func:519,mask:0},0,0,sl,sl,sl);const ll=1029,kl=2305;class Po{constructor(r,l,p){this.enable=r,this.mode=l,this.frontFace=p}}function Dh(f,r){const l=o.bD(f,3);o.a6.mat4.fromQuat(f,r),o.bF(f,3,l)}function fc(f,r){const l=o.a6.quat.identity([]);return o.a6.quat.rotateZ(l,l,-r),o.a6.quat.rotateX(l,l,-f),l}function pc(f,r){const l=[f[0],f[1],0],p=[r[0],r[1],0];if(o.a6.vec3.length(l)>=1e-15){const C=o.a6.vec3.normalize([],l);o.a6.vec3.scale(p,C,o.a6.vec3.dot(p,C)),r[0]=p[0],r[1]=p[1]}const b=o.a6.vec3.cross([],r,f);if(o.a6.vec3.len(b)<1e-15)return null;const w=Math.atan2(-b[1],b[0]);return fc(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),w)}Po.disabled=new Po(!1,ll,kl),Po.backCCW=new Po(!0,ll,kl),Po.backCW=new Po(!0,ll,2304),Po.frontCW=new Po(!0,1028,2304),Po.frontCCW=new Po(!0,1028,kl);class cl{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof o.a5?r:new o.a5(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=o.bB(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const p=this.position,b=this._elevation?this._elevation.getAtPointOrZero(o.a5.fromLngLat(r)):0,w=o.a5.fromLngLat(r,b),C=[w.x-p.x,w.y-p.y,w.z-p.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=pc(C,l)}setPitchBearing(r,l){this.orientation=fc(o.bC(r),o.bC(-l))}}class Pl{constructor(r,l){this._transform=o.a6.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new o.a5(r[0],r[1],r[2])}get position(){const r=o.bD(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&o.bF(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.a6.quat.identity([]),r&&Dh(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=fc(r,l),Dh(this._transform,this._orientation)}forward(){const r=o.bD(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.bD(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.bD(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const p=new Float64Array(16);return o.a6.mat4.invert(p,this.getWorldToCamera(r,l)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,p){const b=this.position;o.a6.vec3.scale(b,b,-r);const w=new Float64Array(16);return o.a6.mat4.fromScaling(w,[p,p,p]),o.a6.mat4.translate(w,w,b),w[10]*=l,w}getWorldToCamera(r,l){const p=new Float64Array(16),b=new Float64Array(4),w=this.position;return o.a6.quat.conjugate(b,this._orientation),o.a6.vec3.scale(w,w,-r),o.a6.mat4.fromQuat(p,b),o.a6.mat4.translate(p,p,w),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(r,l,p,b){const w=new Float64Array(16);return o.a6.mat4.perspective(w,r,l,p,b),w}getCameraToClipOrthographic(r,l,p,b,w,C){const D=new Float64Array(16);return o.a6.mat4.ortho(D,r,l,p,b,w,C),D}getDistanceToElevation(r,l=!1){const p=r===0?0:o.bE(r,l?o.aN(this.position[1]):this.position[1]),b=this.forward();return(p-this.position[2])/b[2]}clone(){return new Pl([...this.position],[...this.orientation])}}const ua={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class vd{constructor(r=0,l=0,p=0,b=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=p,this.right=b}interpolate(r,l,p){return l.top!=null&&r.top!=null&&(this.top=o.aa(r.top,l.top,p)),l.bottom!=null&&r.bottom!=null&&(this.bottom=o.aa(r.bottom,l.bottom,p)),l.left!=null&&r.left!=null&&(this.left=o.aa(r.left,l.left,p)),l.right!=null&&r.right!=null&&(this.right=o.aa(r.right,l.right,p)),this}getCenter(r,l){const p=o.ap((this.left+r-this.right)/2,0,r),b=o.ap((this.top+l-this.bottom)/2,0,l);return new o.P(p,b)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new vd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const mc=(f,r,l)=>(1-l)*f+l*r,gc=f=>f*f*f*f*f;class vc{constructor(r,l,p,b,w,C,D){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=p??0,this._maxPitch=b??60,this.setProjection(C),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new o.bL(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new vd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Pl,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new vc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(r||p)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return o.ar(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=o.bM(this.projectionOptions);const p=this.getProjection(),b=!o.bi(l,p);return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.bM({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.bE(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bB(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=o.a6.mat2.create(),o.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=o.ap(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.bC(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let b=0,w=0;for(let C=0;C<l.length;C++){const D=new o.P(l[C][0]*this.width,p+l[C][1]*(this.height-p)),V=r.pointCoordinate(D);if(!V)continue;const q=1/Math.hypot(V[0]-this._camera.position[0],V[1]-this._camera.position[1]);b+=V[3]*q,w+=q}return w===0?NaN:b/w}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,b=this._mercatorZfromZoom(r),w=this._mercatorZfromZoom(this._maxZoom),C=Math.max(b-p,w);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const b=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,p));return o.ap(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!o.a6.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];o.a6.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new cl;return l.position=new o.a5(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!o.a6.quat.length(r))return!1;o.a6.quat.normalize(r,r);const l=o.a6.vec3.transformQuat([],[0,0,-1],r),p=o.a6.vec3.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const b=pc(l,p);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;r[2]=o.ap(r[2],b/p,b/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,p){this._unmodified=!1,this._edgeInsets.interpolate(r,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new o.bN(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new o.P(0,0)),b=this.pointCoordinate(new o.P(this.width,0)),w=this.pointCoordinate(new o.P(this.width,this.height)),C=this.pointCoordinate(new o.P(0,this.height)),D=Math.floor(Math.min(p.x,b.x,w.x,C.x)),V=Math.floor(Math.max(p.x,b.x,w.x,C.x)),q=1;for(let j=D-q;j<=V+q;j++)j!==0&&l.push(new o.bN(j,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,p){let b=[];const w=p!==void 0,C=!w;if(C&&this.zoom<l||w&&p[0]===0&&p[1]===0)return b;const D=new Set,V=(j,X,ee,ae,be)=>{const _e=o.c2(X,j,ee,ae,be);D.has(_e)||(b.push(new o.aA(j,X,ee,ae,be)),D.add(_e))};for(let j=0;j<r.length;j++){const X=r[j];if(C&&X.canonical.z!==l)continue;const ee=X.canonical,ae=X.overscaledZ,be=X.wrap,_e=1<<ee.z,Te=ee.x+1<_e,we=ee.x>0,Le=ee.y+1<_e,Ue=ee.y>0,je=X.wrap-(we?0:1),Ye=X.wrap+(Te?0:1),et=we?ee.x-1:_e-1,Xe=Te?ee.x+1:0;if(w)p[0]<0?(V(ae,Ye,ee.z,Xe,ee.y),p[1]<0&&Le&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,Ye,ee.z,Xe,ee.y+1)),p[1]>0&&Ue&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,Ye,ee.z,Xe,ee.y-1))):p[0]>0?(V(ae,je,ee.z,et,ee.y),p[1]<0&&Le&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,je,ee.z,et,ee.y+1)),p[1]>0&&Ue&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,je,ee.z,et,ee.y-1))):p[1]<0&&Le?V(ae,be,ee.z,ee.x,ee.y+1):Ue&&V(ae,be,ee.z,ee.x,ee.y-1);else{const nt=X.visibleQuadrants;1&nt&&(V(ae,je,ee.z,et,ee.y),Ue&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,je,ee.z,et,ee.y-1))),2&nt&&(V(ae,Ye,ee.z,Xe,ee.y),Ue&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,Ye,ee.z,Xe,ee.y-1))),4&nt&&(V(ae,je,ee.z,et,ee.y),Le&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,je,ee.z,et,ee.y+1))),8&nt&&(V(ae,Ye,ee.z,Xe,ee.y),Le&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,Ye,ee.z,Xe,ee.y+1)))}}const q=[];for(const j of b)b.some(X=>j.isChildOf(X))||q.push(j);if(b=q.filter(j=>!r.some(X=>!!(j.overscaledZ<l&&X.isChildOf(j))||j.equals(X)||j.isChildOf(X))),C){const j=1<<l,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ee=[j*X.x,j*X.y],ae=4,be=ae*ae;b=b.filter(_e=>{const Te=_e.canonical.x+.5-ee[0],we=_e.canonical.y+.5-ee[1];return Te*Te+we*we<be})}return b}coveringTiles(r){let l=this.coveringZoomLevel(r);const p=l,b=this.elevation&&this.elevation.exaggeration(),w=b&&!r.isTerrainDEM,C=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const D=this.locationCoordinate(this.center),V=this.center.lat,q=1<<l,j=[q*D.x,q*D.y,0],X=this.projection.name==="globe",ee=!X,ae=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,ee),be=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),_e=q*o.bE(1,this.center.lat),Te=this._camera.position[2]/o.bE(1,this.center.lat),we=[q*be.x,q*be.y,Te*(ee?1:_e)],Le=X||b,Ue=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),je=this.isLODDisabled(!0)?l:0;let Ye;if(this._elevation&&r.isTerrainDEM)Ye=1e4*this._elevation.exaggeration();else if(this._elevation){const It=this._elevation.getMinMaxForVisibleTiles();Ye=It?It.max:this._centerAltitude}else Ye=this._centerAltitude;const et=r.isTerrainDEM?-Ye:this._elevation?this._elevation.getMinElevationBelowMSL():0,Xe=this.projection.isReprojectedInTileSpace?o.bP(this):1,nt=It=>{const Xt=new o.a5(It.x+25e-6,It.y,It.z),mn=new o.a5(It.x,It.y+25e-6,It.z),xn=It.toLngLat(),hn=Xt.toLngLat(),Vn=mn.toLngLat(),fo=this.locationCoordinate(xn),xo=this.locationCoordinate(hn),ro=this.locationCoordinate(Vn),So=Math.hypot(xo.x-fo.x,xo.y-fo.y),Wn=Math.hypot(ro.x-fo.x,ro.y-fo.y);return Math.sqrt(So*Wn)*Xe/25e-6},lt=It=>{const pn=Ye,Xt=et;return{aabb:o.bS(this,q,0,0,0,It,Xt,pn,this.projection),zoom:0,x:0,y:0,minZ:Xt,maxZ:pn,wrap:It,fullyVisible:!1}},vt=[];let dt=[];const ct=l,jt=r.reparseOverscaled?p:l,en=(Te-this._centerAltitude)*_e,gn=It=>{if(!this._elevation||!It.tileID||!C)return;const pn=this._elevation.getMinMaxForTile(It.tileID),Xt=It.aabb;pn?(Xt.min[2]=pn.min,Xt.max[2]=pn.max,Xt.center[2]=(Xt.min[2]+Xt.max[2])/2):(It.shouldSplit=Dn(It),It.shouldSplit||(Xt.min[2]=Xt.max[2]=Xt.center[2]=this._centerAltitude))},An=(It,pn)=>{if(.707*pn<It)return 1;const Xt=pn/It;return Xt/(1.4144271570014144+(Math.pow(1.1,Xt-1.4144271570014144+1)-1)/(1.1-1)-1)},Dn=It=>{if(It.zoom<je)return!0;if(It.zoom===ct)return!1;if(It.shouldSplit!=null)return It.shouldSplit;const pn=It.aabb.distanceX(we),Xt=It.aabb.distanceY(we);let mn=en,xn=1;if(X){mn=It.aabb.distanceZ(we);const Wn=Math.pow(2,It.zoom),Ro=o.aN((It.y+1)/Wn),Ko=o.aN(It.y/Wn),mr=Math.min(Math.max(V,Ro),Ko),Kr=o.c6(mr)/o.c6(V);if(xn=mr===V?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Kr/this._mercatorScaleRatio),this.zoom<=o.c3&&It.zoom===ct-1&&Kr>=.9)return!0}else if(w&&(mn=It.aabb.distanceZ(we)*_e),this.projection.isReprojectedInTileSpace&&p<=5){const Wn=Math.pow(2,It.zoom),Ro=nt(new o.a5((It.x+.5)/Wn,(It.y+.5)/Wn));xn=Ro>.85?1:Ro}if(!C){const Wn=Math.sqrt(pn*pn+Xt*Xt+mn*mn);let Ro=(1<<ct-It.zoom)*Ue*xn;return Ro*=An(Math.max(mn,en),Wn),Wn<Ro}let hn=Number.MAX_VALUE,Vn=0;const fo=It.aabb.getCorners(),xo=[];for(const Wn of fo){o.a6.vec3.sub(xo,Wn,we),X||(w?xo[2]*=_e:xo[2]=en);const Ro=o.a6.vec3.dot(xo,this._camera.forward());Ro<hn&&(hn=Ro,Vn=Math.abs(xo[2]))}let ro=(1<<ct-It.zoom)*Ue*xn;if(ro*=An(Math.max(Vn,en),hn),hn<ro)return!0;const So=It.aabb.closestPoint(j);return So[0]===j[0]&&So[1]===j[1]};if(this.renderWorldCopies)for(let It=1;It<=3;It++)vt.push(lt(-It)),vt.push(lt(It));for(vt.push(lt(0));vt.length>0;){const It=vt.pop(),pn=It.x,Xt=It.y;let mn=It.fullyVisible;const xn=()=>this.projection.name==="globe"&&(It.y===0||It.y===(1<<It.zoom)-1);if(!mn){let hn=Le?It.aabb.intersects(ae):It.aabb.intersectsFlat(ae);if(hn===0&&xn()){const Vn=new o.bQ(It.zoom,pn,Xt);hn=o.bR(this,q,Vn,!0).intersects(ae)}if(hn===0)continue;mn=hn===2}if(It.zoom!==ct&&Dn(It))for(let hn=0;hn<4;hn++){const Vn=(pn<<1)+hn%2,fo=(Xt<<1)+(hn>>1),xo={aabb:C?It.aabb.quadrant(hn):o.bS(this,q,It.zoom+1,Vn,fo,It.wrap,It.minZ,It.maxZ,this.projection),zoom:It.zoom+1,x:Vn,y:fo,wrap:It.wrap,fullyVisible:mn,tileID:void 0,shouldSplit:void 0,minZ:It.minZ,maxZ:It.maxZ};w&&!X&&(xo.tileID=new o.aA(It.zoom+1===ct?jt:It.zoom+1,It.wrap,It.zoom+1,Vn,fo),gn(xo)),vt.push(xo)}else{const hn=It.zoom===ct?jt:It.zoom;if(r.minzoom&&r.minzoom>hn)continue;let Vn=0;if(!mn){let So=Le?It.aabb.intersectsPrecise(ae):It.aabb.intersectsPreciseFlat(ae);if(So===0&&xn()){const Wn=new o.bQ(It.zoom,pn,Xt);So=o.bR(this,q,Wn,!0).intersectsPrecise(ae)}if(So===0)continue;if(r.calculateQuadrantVisibility)if(ae.containsPoint(It.aabb.center))Vn=15;else for(let Wn=0;Wn<4;Wn++)It.aabb.quadrant(Wn).intersects(ae)!==0&&(Vn|=1<<Wn)}const fo=j[0]-(.5+pn+(It.wrap<<It.zoom))*(1<<l-It.zoom),xo=j[1]-.5-Xt,ro=It.tileID?It.tileID:new o.aA(hn,It.wrap,It.zoom,pn,Xt);r.calculateQuadrantVisibility&&(ro.visibleQuadrants=Vn),dt.push({tileID:ro,distanceSq:fo*fo+xo*xo})}}if(this.fogCullDistSq){const It=this.fogCullDistSq,pn=this.horizonLineFromTop();dt=dt.filter(Xt=>{const mn=[0,0,0,1],xn=[o.ab,o.ab,0,1],hn=this.calculateFogTileMatrix(Xt.tileID.toUnwrapped());o.a6.vec4.transformMat4(mn,mn,hn),o.a6.vec4.transformMat4(xn,xn,hn);const Vn=o.a6.vec4.min([],mn,xn),fo=o.a6.vec4.max([],mn,xn),xo=o.bT(Vn,fo);if(xo===0)return!0;let ro=!1;const So=this._elevation;if(So&&xo>It&&pn!==0){const Wn=this.calculateProjMatrix(Xt.tileID.toUnwrapped());let Ro;r.isTerrainDEM||(Ro=So.getMinMaxForTile(Xt.tileID)),Ro||(Ro={min:et,max:Ye});const Ko=o.c4(this.rotation),mr=[Ko[0]*o.ab,Ko[1]*o.ab,Ro.max];o.a6.vec3.transformMat4(mr,mr,Wn),ro=(1-mr[1])*this.height*.5<pn}return xo<It||ro})}return dt.sort((It,pn)=>It.distanceSq-pn.distanceSq).map(It=>It.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=o.ap(r.lat,-o.bU,o.bU),p=this.projection.project(r.lng,l);return new o.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.bE(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let p,b;const w=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;p=(l.x-w.x)/D,b=(l.y-w.y)/D}else{const D=this.pointCoordinate(l),V=this.pointCoordinate(w);p=D.x-V.x,b=D.y-V.y}const C=this.locationCoordinate(r);this.setLocation(new o.a5(C.x-p,C.y-b))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const p=l?o.bE(l,r.lat):void 0,b=this.projection.project(r.lng,r.lat);return new o.a5(b.x,b.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const p=l??this._centerAltitude,b=[r.x,r.y,0,1],w=[r.x,r.y,1,1];o.a6.vec4.transformMat4(b,b,this.pixelMatrixInverse),o.a6.vec4.transformMat4(w,w,this.pixelMatrixInverse);const C=w[3];o.a6.vec4.scale(b,b,1/b[3]),o.a6.vec4.scale(w,w,1/C);const D=b[2],V=w[2];return{p0:b,p1:w,t:D===V?0:(p-D)/(V-D)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return o.a6.vec4.transformMat4(l,l,this.pixelMatrixInverse),o.a6.vec4.transformMat4(p,p,this.pixelMatrixInverse),o.a6.vec4.scale(l,l,1/l[3]),o.a6.vec4.scale(p,p,1/p[3]),l[2]=o.bE(l[2],this._center.lat)*this.worldSize,p[2]=o.bE(p[2],this._center.lat)*this.worldSize,o.a6.vec4.scale(l,l,1/this.worldSize),o.a6.vec4.scale(p,p,1/this.worldSize),new o.aj([l[0],l[1],l[2]],o.a6.vec3.normalize([],o.a6.vec3.sub([],p,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:p,t:b}=r,w=o.bE(l[2],this._center.lat),C=o.bE(p[2],this._center.lat);return new o.a5(o.aa(l[0],p[0],b)/this.worldSize,o.aa(l[1],p[1],b)/this.worldSize,o.aa(w,C,b))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new o.a5(l[0],l[1],l[2]);let p=0,b=this.horizonLineFromTop();if(r.y>b)return this.pointCoordinate(r);const w=.02*b,C=r.clone();for(let D=0;D<10&&b-p>w;D++){C.y=o.aa(p,b,.66);const V=this.projection.pointCoordinate3D(this,C.x,C.y);V?(b=C.y,l=V):p=C.y}return l?new o.a5(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=o.bV)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,b=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return o.a6.vec4.transformMat4(b,b,this.pixelMatrix),b[3]>0?new o.P(b[0]/b[3],b[1]/b[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,w=this.pointLocation3D(new o.P(l,r)),C=this.pointLocation3D(new o.P(b,r)),D=this.pointLocation3D(new o.P(b,p)),V=this.pointLocation3D(new o.P(l,p));let q=Math.min(w.lng,C.lng,D.lng,V.lng),j=Math.max(w.lng,C.lng,D.lng,V.lng),X=Math.min(w.lat,C.lat,D.lat,V.lat),ee=Math.max(w.lat,C.lat,D.lat,V.lat);const ae=Math.pow(2,-this.zoom)/16*270,be=this.projection.name==="globe"?1:4,_e=(Te,we,Le,Ue,je)=>{const Ye=(Te+Le)/2,et=(we+Ue)/2,Xe=new o.P(Ye,et),{lng:nt,lat:lt}=this.pointLocation3D(Xe),vt=Math.max(0,q-nt,X-lt,nt-j,lt-ee);q=Math.min(q,nt),j=Math.max(j,nt),X=Math.min(X,lt),ee=Math.max(ee,lt),(je<be||vt>ae)&&(_e(Te,we,Ye,et,je+1),_e(Ye,et,Le,Ue,je+1))};if(_e(l,r,b,r,1),_e(b,r,b,p,1),_e(b,p,l,p,1),_e(l,p,l,r,1),this.projection.name==="globe"){const[Te,we]=o.bW(this);Te?(ee=90,j=180,q=-180):we&&(X=-90,j=180,q=-180)}return new o.as(new o.bL(q,X),new o.bL(j,ee))}_getBoundsRectangular(r,l){const{top:p,left:b}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,D=new o.P(b,p),V=new o.P(C,p),q=new o.P(C,w),j=new o.P(b,w);let X=this.pointCoordinate(D,r),ee=this.pointCoordinate(V,r);const ae=this.pointCoordinate(q,l),be=this.pointCoordinate(j,l),_e=(Te,we)=>(we.y-Te.y)/(we.x-Te.x);return X.y>1&&ee.y>=0?X=new o.a5((1-be.y)/_e(be,X)+be.x,1):X.y<0&&ee.y<=1&&(X=new o.a5(-be.y/_e(be,X)+be.x,0)),ee.y>1&&X.y>=0?ee=new o.a5((1-ae.y)/_e(ae,ee)+ae.x,1):ee.y<0&&X.y<=1&&(ee=new o.a5(-ae.y/_e(ae,ee)+ae.x,0)),new o.as().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(be)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((p,b)=>{if(b.dem){const w=b.dem.tree;p.min=Math.min(p.min,w.minimums[0]),p.max=Math.max(p.max,w.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.bU,this.maxLat=o.bU,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.am(this.minLng)*this.tileSize,this.worldMaxX=o.am(this.maxLng)*this.tileSize,this.worldMinY=o.at(this.maxLat)*this.tileSize,this.worldMaxY=o.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,p=this._distanceTileDataCache;if(p[l])return p[l];const b=r.canonical,w=1/this.height,C=this.cameraWorldSize,D=C/this.zoomScale(b.z),V=(b.x+Math.pow(2,b.z)*r.wrap)*D,q=b.y*D,j=this.point;j.x*=C/this.worldSize,j.y*=C/this.worldSize;const X=this.angle,ee=Math.sin(-X),ae=-Math.cos(-X);return p[l]={bearing:[ee,ae],center:[(j.x-V)*w,(j.y-q)*w],scale:D/o.ab*w},p[l]}calculateFogTileMatrix(r){const l=r.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.a6.mat4.multiply(b,this.worldToFogMatrix,b),p[l]=new Float32Array(b),p[l]}calculateProjMatrix(r,l=!1,p=!1){const b=r.key;let w;if(w=p?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,w[b])return w[b];const C=this.calculatePosMatrix(r,this.worldSize);let D;return D=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,o.a6.mat4.multiply(C,D,C),w[b]=new Float32Array(C),w[b]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const b=o.bX(r,this);return p[l]=b,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=o.a6.mat4.fromScaling([],[r,r,r]);return o.a6.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=o.bE(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),b=this._camera.forward(),w=o.bE(1,this._center.lat);p[2]/=w,b[2]/=w,o.a6.vec3.normalize(b,b);const C=r.raycast(p,b,r.exaggeration());if(C){const D=o.a6.vec3.scaleAndAdd([],p,b,C),V=new o.a5(D[0],D[1],o.bE(D[2],o.aN(D[1]))),q=(V.z+o.a6.vec3.length([V.x-p[0],V.y-p[1],V.z-p[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(q),this._centerAltitude=V.toAltitude(),this._center=this.coordinateLocation(V),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,p=o.bE(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(p),w=l.getAtPointOrZero(new o.a5(...b)),C=this.pixelsPerMeter/this.worldSize*w,D=this._minimumHeightOverTerrain(),V=b[2]-C;if(V<=D)if(V<0||r){const q=this.locationCoordinate(this._center,this._centerAltitude),j=[b[0],b[1],q.z-b[2]],X=o.a6.vec3.length(j);j[2]-=(D-V)/this._pixelsPerMercatorPixel;const ee=o.a6.vec3.length(j);if(ee===0)return;o.a6.vec3.scale(j,j,X/ee*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],q.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const ee=this.center;return ee.lat=o.ap(ee.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(ee.lng=o.ap(ee.lng,this.minLng,this.maxLng)),this.center=ee,void(this._constraining=!1)}const l=this._unmodified,{x:p,y:b}=this.point;let w=0,C=p,D=b;const V=this.width/2,q=this.height/2,j=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(b-q<j&&(D=j+q),b+q>X&&(D=X-q),X-j<this.height&&(w=Math.max(w,this.height/(X-j)),D=(X+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ee=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,be=this.worldSize/2-(ee+ae)/2;C=(p+be+this.worldSize)%this.worldSize-be,C-V<ee&&(C=ee+V),C+V>ae&&(C=ae-V),ae-ee<this.width&&(w=Math.max(w,this.width/(ae-ee)),C=(ae+ee)/2)}C===p&&D===b||(this.center=this.unproject(new o.P(C,D))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.bE(1,this.center.lat)/o.bE(1,o.c5));const b=o.bY(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?p:1,C=this._camera.getWorldToCamera(this.worldSize,w);let D;const V=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(V[8]=2*-r.x/this.width,V[9]=2*r.y/this.height,this.isOrthographic){let lt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),vt=lt*this.aspect,dt=-vt,ct=-lt;vt-=r.x,dt-=r.x,lt+=r.y,ct+=r.y,D=this._camera.getCameraToClipOrthographic(dt,vt,ct,lt,this._nearZ,this._farZ),((jt,en,gn,An)=>{for(let Dn=0;Dn<16;Dn++)jt[Dn]=mc(en[Dn],gn[Dn],An)})(D,D,V,gc(this.pitch>=15?1:this.pitch/15))}else D=V;const q=o.a6.mat4.mul([],V,C);let j=o.a6.mat4.mul([],D,C);if(this.projection.isReprojectedInTileSpace){const lt=this.locationCoordinate(this.center),vt=o.a6.mat4.identity([]);o.a6.mat4.translate(vt,vt,[lt.x*this.worldSize,lt.y*this.worldSize,0]),o.a6.mat4.multiply(vt,vt,o.bZ(this)),o.a6.mat4.translate(vt,vt,[-lt.x*this.worldSize,-lt.y*this.worldSize,0]),o.a6.mat4.multiply(j,j,vt),o.a6.mat4.multiply(q,q,vt),this.inverseAdjustmentMatrix=o.b_(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.a6.mat4.scale([],j,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=j,this.invProjMatrix=o.a6.mat4.invert(new Float64Array(16),this.projMatrix),l){const lt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);lt[8]=2*-r.x/this.width,lt[9]=2*r.y/this.height,this.expandedFarZProjMatrix=o.a6.mat4.mul([],lt,C)}else this.expandedFarZProjMatrix=this.projMatrix;const X=o.a6.mat4.invert([],D);this.frustumCorners=o.b$.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const ee=new Float32Array(16);o.a6.mat4.identity(ee),o.a6.mat4.scale(ee,ee,[1,-1,1]),o.a6.mat4.rotateX(ee,ee,this._pitch),o.a6.mat4.rotateZ(ee,ee,this.angle);const ae=o.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.a6.mat4.clone(ae);const be=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-r.x/this.width,ae[9]=2*(r.y+be)/this.height,this.skyboxMatrix=o.a6.mat4.multiply(ee,ae,ee);const _e=this.point,Te=_e.x,we=_e.y,Le=this.width%2/2,Ue=this.height%2/2,je=Math.cos(this.angle),Ye=Math.sin(this.angle),et=Te-Math.round(Te)+je*Le+Ye*Ue,Xe=we-Math.round(we)+je*Ue+Ye*Le,nt=new Float64Array(j);if(o.a6.mat4.translate(nt,nt,[et>.5?et-1:et,Xe>.5?Xe-1:Xe,0]),this.alignedProjMatrix=nt,j=o.a6.mat4.create(),o.a6.mat4.scale(j,j,[this.width/2,-this.height/2,1]),o.a6.mat4.translate(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=o.a6.mat4.create(),o.a6.mat4.scale(j,j,[1,-1,1]),o.a6.mat4.translate(j,j,[-1,-1,0]),o.a6.mat4.scale(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=o.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,q),this._calcFogMatrices(),this._distanceTileDataCache={},j=o.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!j)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=j,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.c0(this);const lt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.a6.vec3.transformMat4(lt,lt,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=j;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,p=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,w=[r,r,l];o.a6.vec3.scale(w,w,b),o.a6.vec3.scale(p,p,-1),o.a6.vec3.multiply(p,p,w);const C=o.a6.mat4.create();o.a6.mat4.translate(C,C,p),o.a6.mat4.scale(C,C,w),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,b)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),b=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-p[0]*w,b.y/this.worldSize-p[1]*w,r/this.worldSize*this._centerAltitude-p[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],b=r[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(w=Math.min((l-p)/b,1)),this._camera.position=o.a6.vec3.scaleAndAdd([],this._camera.position,r,w),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:b}=this._camera.getPitchBearing(),w=o.bE(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.bC(this._maxPitch)),D=Math.max((r[2]-w)/Math.cos(p),C),V=this._zoomFromMercatorZ(D);o.a6.vec3.scaleAndAdd(r,r,l,D),this._pitch=o.ap(p,o.bC(this.minPitch),o.bC(this.maxPitch)),this.angle=o.bB(b,-Math.PI,Math.PI),this._setZoom(o.ap(V,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.a5(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,p=o.bV,b=0,w=1/0;for(;p-l>1e-6&&p>l;){const C=l+.5*(p-l),D=this.tileSize*Math.pow(2,C),V=this.getCameraToCenterDistance(this.projection,C,D),q=this.scaleZoom(V/(r*this.tileSize)),j=Math.abs(C-q);j<w&&(w=j,b=C),C<q?l=C:p=C}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const p=Math.min(r.x,l.x),b=Math.max(r.x,l.x),w=Math.min(r.y,l.y),C=Math.max(r.y,l.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new o.P(p,w),new o.P(b,C),new o.P(p,C),new o.P(b,w)],V=this.renderWorldCopies?-3:0,q=this.renderWorldCopies?4:1;for(const j of D){const X=this.pointRayIntersection(j);if(X.t<0)return!0;const ee=this.rayIntersectionCoordinate(X);if(ee.x<V||ee.y<0||ee.x>q||ee.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.c1(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(r,l){const p=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,r)),b=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,p,b],w){const C=[l,p,b,1];o.a6.vec4.transformMat4(C,C,w);const D=C[3]=Math.max(C[3],1e-6);return C[0]/=D,C[1]/=D,C[2]/=D,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,p=this.worldSize){const b=o.bY(r,l,this.width,this.height,1024),w=r.pixelSpaceConversion(this.center.lat,p,b);let C=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(C=mc(1,C,gc(this.pitch>=15?1:this.pitch/15))),C}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.a6.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const Aa=(f,r)=>{if(r>0&&f.terrain&&o.w("Cutoff is currently disabled on terrain"),r<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=f.transform,p=Math.max(Math.abs(l._zoom-(f.minCutoffZoom-1)),1),b=l.isLODDisabled(!1)?o.a7(60,45,l.pitch):o.a7(30,15,l.pitch),w=l._farZ-l._nearZ,C=r*l.height,D=((1-(V=b))*l.cameraToCenterDistance+V*(l._farZ+C))*p;var V;return{shouldRenderCutoff:b<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(D-l._nearZ)/w,(D-C-l._nearZ)/w]}}},wi={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Hs{constructor(r,l){this.aabb=r,this.lastCascade=l}}class Nn{add(r,l){const p=this.receivers[r.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],l.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],l.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],l.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],l.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],l.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],l.max[2])):this.receivers[r.key]=new Hs(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,p){const b=o.ca.fromPoints(r.points);let w=0;for(const C in this.receivers){const D=this.receivers[C];if(!D||!b.intersectsAabb(D.aabb))continue;D.aabb.min=b.closestPoint(D.aabb.min),D.aabb.max=b.closestPoint(D.aabb.max);const V=D.aabb.getCorners();for(let q=0;q<p.length;q++){let j=!0;for(const X of V){const ee=[X[0]*l,X[1]*l,X[2]];if(o.a6.vec3.transformMat4(ee,ee,p[q].matrix),ee[0]<-1||ee[0]>1||ee[1]<-1||ee[1]>1){j=!1;break}}if(D.lastCascade=q,w=Math.max(w,q),j)break}}return w+1}}class Rl{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Nn,this._depthMode=new bo(r.context.gl.LEQUAL,bo.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(wi,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(wi,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(wi,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const b=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||b<=0||(this._shadowLayerCount=p.style.order.reduce((be,_e)=>{const Te=p.style._mergedLayers[_e];return be+(Te.hasShadowPass()&&!Te.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=p.context,C=wi.shadowMapResolution,D=wi.shadowMapResolution;if(this._cascades.length===0||wi.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let be=0;be<wi.cascadeCount;++be){const _e=p._shadowMapDebug,Te=w.gl,we=w.createFramebuffer(C,D,_e,"texture"),Le=new o.T(w,{width:C,height:D,data:null},Te.DEPTH_COMPONENT16);if(we.depthAttachment.set(Le.texture),_e){const Ue=new o.T(w,{width:C,height:D,data:null},Te.RGBA8);we.colorAttachment.set(Ue.texture)}this._cascades.push({framebuffer:we,texture:Le,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.bO,scale:0})}}this.shadowDirection=_d(l);let V=0;if(r.elevation){const be=r.elevation,_e=[1e4,-1e4];be.visibleDemTiles.filter(Te=>Te.dem).forEach(Te=>{const we=Te.dem.tree;_e[0]=Math.min(_e[0],we.minimums[0]),_e[1]=Math.max(_e[1],we.maximums[0])}),_e[0]!==1e4&&(V=(_e[1]-_e[0])*be.exaggeration())}const q=1.5*r.cameraToCenterDistance,j=3*q,X=new Float64Array(16);for(let be=0;be<this._cascades.length;++be){const _e=this._cascades[be];let Te=r.height/50,we=1;wi.cascadeCount===1?we=j:be===0?we=q:(Te=q,we=j);const[Le,Ue]=au(r,this.shadowDirection,Te,we,wi.shadowMapResolution,V);_e.scale=r.scale,_e.matrix=Le,_e.boundingSphereRadius=Ue,o.a6.mat4.invert(X,_e.matrix),_e.frustum=o.bO.fromInvProjectionMatrix(X,1,0,!0),_e.far=we}const ee=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ee].far,this._cascades[ee].far],this._uniformValues.u_shadow_intensity=b,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/wi.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=wi.shadowMapResolution,this._uniformValues.u_shadowmap_0=ua.ShadowMap0,this._uniformValues.u_shadowmap_1=ua.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ae=p.transform.elevation;for(const be of this._groundShadowTiles){let _e={min:0,max:0};if(ae){const Te=ae.getMinMaxForTile(be);Te&&(_e=Te)}this.addShadowReceiver(be.toUnwrapped(),_e.min,_e.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const p=this.painter,b=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),b.viewport.set([0,0,wi.shadowMapResolution,wi.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){p.currentShadowCascade=w,b.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),b.clear({color:o.bA.white,depth:1});for(const C of r.order){const D=r._mergedLayers[C];if(!D.hasShadowPass()||D.isHidden(p.transform.zoom))continue;const V=r.getLayerSourceCache(D),q=V?l[V.id]:void 0;(D.type==="model"||q&&q.length)&&p.renderLayer(p,V,D,q)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,p=r.context,b=l.directionalLight,w=l.ambientLight;if(!b||!w)return;const C=[],D=Aa(r,r.longestCutoffRange);D.shouldRenderCutoff&&C.push("RENDER_CUTOFF"),C.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&C.push("NORMAL_OFFSET");const V=yc(l,b,w),q=new bo(p.gl.LEQUAL,bo.ReadOnly,r.depthRangeFor3D);for(const j of this._groundShadowTiles){const X=j.toUnwrapped(),ee=r.isTileAffectedByFog(j),ae=r.getOrCreateProgram("groundShadow",{defines:C,overrideFog:ee});this.setupShadows(X,ae),r.uploadCommonUniforms(p,ae,X,null,D);const be={u_matrix:r.transform.calculateProjMatrix(X),u_ground_shadow_factor:V};ae.draw(r,p.gl.TRIANGLES,q,Do.disabled,ir.multiply,Po.disabled,be,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ir.unblended:ir.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,p=l.calculatePosMatrix(r,l.worldSize);return o.a6.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(r){return o.a6.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,p,b=0){if(!this.enabled)return;const w=this.painter.transform,C=this.painter.context,D=C.gl,V=this._uniformValues,q=new Float64Array(16),j=w.calculatePosMatrix(r,w.worldSize);for(let X=0;X<this._cascades.length;X++)o.a6.mat4.multiply(q,this._cascades[X].matrix,j),V[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(q),C.activeTexture.set(D.TEXTURE0+ua.ShadowMap0+X),this._cascades[X].texture.bind(D.NEAREST,D.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const X=o.c9(r.canonical),ee=2/w.tileSize*o.ab/wi.shadowMapResolution,ae=ee*this._cascades[0].boundingSphereRadius,be=ee*this._cascades[this._cascades.length-1].boundingSphereRadius,_e=(p==="vector-tile"?1:3)/Math.pow(2,b-r.canonical.z-(1-w.zoom+Math.floor(w.zoom)));V.u_shadow_normal_offset=[X,ae*_e,be*_e],V.u_shadow_bias=[6e-5,.0012,.012]}else V.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(C,V)}setupShadowsFromMatrix(r,l,p=!1){if(!this.enabled)return;const b=this.painter.context,w=b.gl,C=this._uniformValues,D=new Float64Array(16);for(let V=0;V<wi.cascadeCount;V++)o.a6.mat4.multiply(D,this._cascades[V].matrix,r),C[V===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),b.activeTexture.set(w.TEXTURE0+ua.ShadowMap0+V),this._cascades[V].texture.bind(w.NEAREST,w.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const V=wi.normalOffset;C.u_shadow_normal_offset=[1,V,V],C.u_shadow_bias=[6e-5,.0012,.012]}else C.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(b,C)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,p,b){if(b[2]>=0)return{};const w=function(V,q,j){const X=j/(1<<V.canonical.z);return new o.ca([V.canonical.x*X+V.wrap*j,V.canonical.y*X+V.wrap*j,0],[(V.canonical.x+1)*X+V.wrap*j,(V.canonical.y+1)*X+V.wrap*j,q])}(r,l,p).getCorners(),C=l/-b[2];b[0]<0?(o.a6.vec3.add(w[0],w[0],[b[0]*C,0,0]),o.a6.vec3.add(w[3],w[3],[b[0]*C,0,0])):b[0]>0&&(o.a6.vec3.add(w[1],w[1],[b[0]*C,0,0]),o.a6.vec3.add(w[2],w[2],[b[0]*C,0,0])),b[1]<0?(o.a6.vec3.add(w[0],w[0],[0,b[1]*C,0]),o.a6.vec3.add(w[1],w[1],[0,b[1]*C,0])):b[1]>0&&(o.a6.vec3.add(w[2],w[2],[0,b[1]*C,0]),o.a6.vec3.add(w[3],w[3],[0,b[1]*C,0]));const D={};return D.vertices=w,D.planes=[_c(w[1],w[0],w[4]),_c(w[2],w[1],w[5]),_c(w[3],w[2],w[6]),_c(w[0],w[3],w[7])],D}addShadowReceiver(r,l,p){this._receivers.add(r,o.ca.fromTileIdAndHeight(r,l,p))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function _c(f,r,l){const p=o.a6.vec3.sub([],l,r),b=o.a6.vec3.sub([],f,r),w=o.a6.vec3.cross([],p,b),C=o.a6.vec3.length(w);return C===0?[0,0,1,0]:(o.a6.vec3.scale(w,w,1/C),[w[0],w[1],w[2],-o.a6.vec3.dot(w,r)])}function _d(f){const r=f.properties.get("direction"),l=o.c8(r.x,r.y,r.z);l[2]=o.ap(l[2],0,75);const p=o.cb([l[0],l[1],l[2]]);return o.a6.vec3.fromValues(p.x,p.y,p.z)}function yc(f,r,l){const p=r.properties.get("color"),b=r.properties.get("intensity"),w=r.properties.get("direction"),C=[w.x,w.y,w.z],D=l.properties.get("color"),V=l.properties.get("intensity"),q=Math.max(o.a6.vec3.dot([0,0,1],C),0),j=[0,0,0];o.a6.vec3.scale(j,D.toRenderColor(f.getLut(r.scope)).toArray01Linear().slice(0,3),V);const X=[0,0,0];return o.a6.vec3.scale(X,p.toRenderColor(f.getLut(l.scope)).toArray01Linear().slice(0,3),q*b),o.cc([j[0]>0?j[0]/(j[0]+X[0]):0,j[1]>0?j[1]/(j[1]+X[1]):0,j[2]>0?j[2]/(j[2]+X[2]):0])}function au(f,r,l,p,b,w){const C=f.zoom,D=f.scale,V=f.worldSize,q=1/V,j=f.aspect,X=Math.sqrt(1+j*j)*Math.tan(.5*f.fovX),ee=X*X,ae=p-l,be=p+l;let _e,Te;ee>ae/be?(_e=p,Te=p*X):(_e=.5*be*(1+ee),Te=.5*Math.sqrt(ae*ae+2*(p*p+l*l)*ee+be*be*ee*ee));const we=f.projection.pixelsPerMeter(f.center.lat,V),Le=f._camera.getCameraToWorldMercator(),Ue=[0,0,-_e*q];o.a6.vec3.transformMat4(Ue,Ue,Le);let je=Te*q;const Ye=f._edgeInsets;if(!(Ye.left===0&&Ye.top===0&&Ye.right===0&&Ye.bottom===0||Ye.left===Ye.right&&Ye.top===Ye.bottom)){const mn=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?we:1),xn=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,l,p);xn[8]=2*-f.centerOffset.x/f.width,xn[9]=2*f.centerOffset.y/f.height;const hn=new Float64Array(16);o.a6.mat4.mul(hn,xn,mn);const Vn=new Float64Array(16);o.a6.mat4.invert(Vn,hn);const fo=o.bO.fromInvProjectionMatrix(Vn,V,C,!0);for(const xo of fo.points){const ro=((et=xo)[0]/=D,et[1]/=D,et[2]=o.bE(et[2],f._center.lat),et);je=Math.max(je,o.a6.vec3.len(o.a6.vec3.subtract([],Ue,ro)))}}var et;je*=b/(b-1);const Xe=Math.acos(r[2]),nt=Math.atan2(-r[0],-r[1]),lt=new Pl;lt.position=Ue,lt.setPitchBearing(Xe,nt);const vt=lt.getWorldToCamera(V,we),dt=je*V,ct=Math.min(f._mercatorZfromZoom(17)*V*-2,-2*dt),jt=lt.getCameraToClipOrthographic(-dt,dt,-dt,dt,ct,(dt+w*we)/r[2]),en=new Float64Array(16);o.a6.mat4.multiply(en,jt,vt);const gn=o.a6.vec3.fromValues(Math.floor(1e6*Ue[0])/1e6*V,Math.floor(1e6*Ue[1])/1e6*V,0),An=.5*b,Dn=[0,0,0];o.a6.vec3.transformMat4(Dn,gn,en),o.a6.vec3.scale(Dn,Dn,An);const It=[Math.floor(Dn[0]),Math.floor(Dn[1]),Math.floor(Dn[2])],pn=[0,0,0];o.a6.vec3.sub(pn,Dn,It),o.a6.vec3.scale(pn,pn,-1/An);const Xt=new Float64Array(16);return o.a6.mat4.identity(Xt),o.a6.mat4.translate(Xt,Xt,pn),o.a6.mat4.multiply(en,Xt,en),[en,dt]}class Gs extends o.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.numModelsLoading={}}loadModel(r,l){return o.aG(this.requestManager.transformRequest(l,o.R.Model).url).then(p=>{if(!p)return;const b=o.aH(p),w=new o.aI(r,void 0,void 0,b);return w.computeBoundsAndApplyParent(),w}).catch(p=>{if(p&&p.status===404)return null;this.fire(new o.t(new Error(`Could not load model ${r} from ${l}: ${p.message}`)))})}load(r,l){this.models[l]||(this.models[l]={});const p=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+p.length;const b=[];for(const w of p)b.push(this.loadModel(w,r[w]));Promise.allSettled(b).then(w=>{for(let C=0;C<w.length;C++){const{status:D,value:V}=w[C];D==="fulfilled"&&V&&(this.models[l][p[C]]={model:V,numReferences:1})}this.numModelsLoading[l]-=p.length,this.fire(new o.x("data",{dataType:"style"}))}).catch(w=>{this.fire(new o.t(new Error(`Could not load models: ${w.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,p){this.models[p]||(this.models[p]={}),this.hasModel(r,p)&&this.models[p][r].numReferences++,this.load({[r]:this.requestManager.normalizeModelURL(l)},p)}addModels(r,l){this.models[l]||(this.models[l]={});const p={};for(const b in r)this.models[l][b]={},p[b]=this.requestManager.normalizeModelURL(r[b]);this.load(p,l)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={});const p={};for(const b of r)this.hasModel(b,l)?this.models[l][b].numReferences++:p[b]=this.requestManager.normalizeModelURL(b);this.load(p,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const p=this.models[l][r].model;delete this.models[l][r],p.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const p in this.models[l])this.models[l][p].model&&this.models[l][p].model.upload(r.context)}}const yd=new o.a0({data:new o.a1(o._.colorTheme.data)}),ka=(f,r)=>xt(f,r&&r.filter(l=>l.identifier!=="source.canvas")),Ol=o.ar(zn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),bc=o.ar(zn,["setCenter","setZoom","setBearing","setPitch"]),Xf={version:8,layers:[],sources:{}},an={duration:300,delay:0};class Tn extends o.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=o.l({},an),this._buildingIndex=new on(this),this.crossTileSymbolIndex=new gd,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._mergedLayerSelectors=new Map,this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new Ke,this.dispatcher=l.dispatcher?l.dispatcher:new o.ce(o.cf(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Ht,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new o.cg(r._requestManager,l.localFontFamily?o.ch.all:l.localIdeographFontFamily?o.ch.ideographs:o.ch.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new Gs(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",o.ci());const p=this;this._rtlTextPluginCallback=Tn.registerForPluginStateChange(b=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(w,C)=>{if(o.cj(w),C&&C.every(D=>D))for(const D in p._sourceCaches){const V=p._sourceCaches[D],q=V.getSource().type;q!=="vector"&&q!=="geojson"||V.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const w=this.getOwnSource(b.sourceId);if(w&&w.vectorLayerIds)for(const C in this._layers){const D=this._layers[C];D.source===w.id&&this._validateLayer(D)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(o.f(r))return r;const l=o.ck(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${o.cl(JSON.stringify(r))}`}_diffStyle(r,l,p){this.globalId=this._getGlobalId(r);const b=(w,C)=>{try{C(null,this.setState(w,p))}catch(D){C(D,!1)}};if(typeof r=="string"){const w=this.map._requestManager.normalizeStyleURL(r),C=this.map._requestManager.transformRequest(w,o.R.Style);o.n(C,(D,V)=>{D?this.fire(new o.t(D)):V&&b(V,l)})}else typeof r=="object"&&b(r,l)}loadURL(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"}));const p=typeof l.validate=="boolean"?l.validate:!o.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const b=this.importsCache.get(r);if(b)return this._load(b,p);const w=this.map._requestManager.transformRequest(r,o.R.Style);this._request=o.n(w,(C,D)=>{if(this._request=null,C)this.fire(new o.t(C));else if(D)return this.importsCache.set(r,D),this._load(D,p)})}loadJSON(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=o.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new o.x("dataloading",{dataType:"style"})),this._load(Xf,!1)}_loadImports(r,l,p){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const b=[];for(const w of r){const C=this._createFragmentStyle(w),D=new Promise(j=>{C.once("style.import.load",j),C.once("error",j)}).then(()=>this.mergeAll());if(b.push(D),this.resolvedImports.has(w.url)){C.loadEmpty();continue}const V=w.data||this.importsCache.get(w.url);V?(C.loadJSON(V,{validate:l}),this._isInternalStyle(V)&&(C.globalId=null)):w.url?C.loadURL(w.url,{validate:l}):C.loadEmpty();const q={style:C,id:w.id,config:w.config};if(p){const j=this.fragments.findIndex(({id:X})=>X===p);this.fragments=this.fragments.slice(0,j).concat(q).concat(this.fragments.slice(j))}else this.fragments.push(q)}return Promise.allSettled(b)}getImportGlobalIds(r=this,l=new Set){for(const p of r.fragments)p.style.globalId&&l.add(p.style.globalId),this.getImportGlobalIds(p.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?o.av(r.id,this.scope):r.id;let p;const b=this._initialConfig&&this._initialConfig[l];(r.config||b)&&(p=o.l({},r.config,b));const w=new Tn(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const p=r.schema;if(this._isInternalStyle(r)){const C=o.l({},Xf,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(C,l)}if(this.updateConfig(this._config,p),l&&ka(this,hi(r)))return;this._loaded=!0,this.stylesheet=o.cm(r);const b=()=>{for(const q in r.sources)this.addSource(q,r.sources[q],{validate:!1,isInitialLoad:!0});r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const C=so(this.stylesheet.layers);if(this._order=C.map(q=>q.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const q=this.stylesheet.lights[0];this.light=new kt(q.properties,q.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new kt(this.stylesheet.light)),this._layers={};for(const q of C){const j=o.cq(q,this.scope,this._styleColorTheme.lut,this.options);j.configDependencies.size!==0&&this._configDependentLayers.add(j.fqid),j.setEventedParent(this,{layer:{id:j.id}}),this._layers[j.id]=j;const X=this.getOwnLayerSourceCache(j),ee=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&j.canCastShadows()&&ee&&(X.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const D=this.stylesheet.terrain;D&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(D,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.x("data",{dataType:"style"}));const V=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load")))},w=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=w,w){const C=this._evaluateColorThemeData(w);this._loadColorTheme(C).then(()=>{b()}).catch(D=>{o.w(`Couldn't load color theme from the stylesheet: ${D}`),b()})}else this._styleColorTheme.lut=null,b()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,p,b,w,C,D,V;const q={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(j=>{if(j.stylesheet){if(j.light!=null&&(r=j.light),j.stylesheet.lights)for(const X of j.stylesheet.lights)X.type==="ambient"&&j.ambientLight!=null&&(l=j.ambientLight),X.type==="directional"&&j.directionalLight!=null&&(p=j.directionalLight);b=this._prioritizeTerrain(b,j.terrain,j.stylesheet.terrain),j.stylesheet.fog&&j.fog!=null&&(w=j.fog),j.stylesheet.camera!=null&&(V=j.stylesheet.camera),j.stylesheet.projection!=null&&(C=j.stylesheet.projection),j.stylesheet.transition!=null&&(D=j.stylesheet.transition),q[j.scope]=j._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=p,this.fog=w,this._styleColorThemeForScope=q,b===null?delete this.terrain:this.terrain=b,this.camera=V||{"camera-projection":"perspective"},this.projection=C||{name:"mercator"},this.transition=o.l({},an,D),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=p=>{for(const b of p.fragments)l(b.style);r(p)};l(this)}_prioritizeTerrain(r,l,p){const b=r&&r.drapeRenderMode===0;return p===null?l&&l.drapeRenderMode===0?l:b?r:null:l!=null&&(!r||b||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},p={};this.forEachFragmentStyle(b=>{for(const w in b._sourceCaches){const C=o.av(w,b.scope);r[C]=b._sourceCaches[w]}for(const w in b._otherSourceCaches){const C=o.av(w,b.scope);l[C]=b._otherSourceCaches[w]}for(const w in b._symbolSourceCaches){const C=o.av(w,b.scope);p[C]=b._symbolSourceCaches[w]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=p}mergeLayers(){const r={},l=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._mergedLayerSelectors.clear(),this.forEachFragmentStyle(w=>{for(const D of w._order){const V=w._layers[D];if(V.type==="slot"){const q=o.cn(D);if(r[q])continue;r[q]=[]}V.slot&&r[V.slot]?r[V.slot].push(V):l.push(V)}const{featuresets:C}=w.stylesheet||{};if(C)for(const D in C){const{selectors:V}=C[D];for(const q of V){const j=w._layers[q.layer],X=this._mergedLayerSelectors.get(j.fqid)||[];let ee;if(q.properties)for(const ae in q.properties){const be=o.M(q.properties[ae]);be.result==="success"&&(ee=ee||{},ee[ae]=be.value)}X.push({featuresetId:D,featureNamespace:q.featureNamespace,properties:ee}),this._mergedLayerSelectors.set(j.fqid,X)}}}),this._mergedOrder=[];const b=(w=[])=>{for(const C of w)if(C.type==="slot"){const D=o.cn(C.id);r[D]&&b(r[D]),this._mergedSlots.push(D)}else{const D=o.av(C.id,C.scope);this._mergedOrder.push(D),p[D]=C,C.is3D()&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&(this._clipLayerPresent=!0)}};b(l),this._mergedOrder.sort((w,C)=>{const D=p[w],V=p[C];return D.hasInitialOcclusionOpacityProperties?V.is3D()?1:0:D.is3D()&&V.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=o.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,p,b){const w=o.l({},p);for(const D of Object.keys(o._.colorTheme))w[D]===void 0&&(w[D]=o._.colorTheme[D].default);const C=new o.$(yd,l,new Map(b));return C.setTransitionOrValue(w,b),C.untransitioned().possiblyEvaluate(new o.a3(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,b)=>{const w="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let C=r;C.startsWith(w)||(C=w+C);const D="mapbox-reserved-lut",V=new Image;V.src=C,V.onerror=()=>{this._styleColorTheme.lutLoading=!1,b(new Error("Failed to load image data"))},V.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void p();this._styleColorTheme.lutLoading=!1;const{width:q,height:j,data:X}=o.q.getImageData(V);if(j>32)return void b(new Error("The height of the image must be less than or equal to 32 pixels."));if(q!==j*j)return void b(new Error("The width of the image must be equal to the height squared."));this.getImage(D)&&this.removeImage(D),this.addImage(D,{data:new o.r({width:q,height:j},X),pixelRatio:1,sdf:!1,version:0});const ee=this.imageManager.getImage(D,this.scope);ee?(this._styleColorTheme.lut={image:ee.data,data:r},p()):b(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,p,b){let w,C,D;const V=o.q.devicePixelRatio>1?"@2x":"";let q=o.n(p.transformRequest(p.normalizeSpriteURL(l,V,".json"),o.R.SpriteJSON),(ee,ae)=>{q=null,D||(D=ee,w=ae,X())}),j=o.o(p.transformRequest(p.normalizeSpriteURL(l,V,".png"),o.R.SpriteImage),(ee,ae)=>{j=null,D||(D=ee,C=ae,X())});function X(){if(D)b(D);else if(w&&C){const ee=o.q.getImageData(C),ae={};for(const be in w){const{width:_e,height:Te,x:we,y:Le,sdf:Ue,pixelRatio:je,stretchX:Ye,stretchY:et,content:Xe}=w[be],nt=new o.r({width:_e,height:Te});o.r.copy(ee,nt,{x:we,y:Le},{x:0,y:0},{width:_e,height:Te},null),ae[be]={data:nt,pixelRatio:je,sdf:Ue,stretchX:Ye,stretchY:et,content:Xe}}b(null,ae)}}return{cancel(){q&&(q.cancel(),q=null),j&&(j.cancel(),j=null)}}}(r,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new o.t(l));else if(p)for(const b in p)this.imageManager.addImage(b,this.scope,p[b]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.x("data",{dataType:"style"}))})}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const p=r.sourceLayer;p&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(p)===-1)&&this.fire(new o.t(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const p=this.fragments[l];return p&&p.style&&(r.data=p.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();r[p.id]||(r[p.id]=p.serialize())}return r}_serializeLayers(r){const l=[];for(const p of r){const b=this._layers[p];b&&b.type!=="custom"&&l.push(b.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new o.t(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new o.t(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const p=this.map.painter;if(p)for(let b=r.minzoom||0;b<(r.maxzoom||25.5);b++){const w=r.getProgramIds();if(w)for(const C of w){const D=r.getDefaultProgramParams(C,l.zoom,this._styleColorTheme.lut);D&&(p.style=this,this.fog&&(p._fogVisible=!0,D.overrideFog=!0,p.getOrCreateProgram(C,D)),p._fogVisible=!1,D.overrideFog=!1,p.getOrCreateProgram(C,D),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(D.overrideRtt=!0,p.getOrCreateProgram(C,D)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const p=this._changes.isDirty();let b=!1;if(this._changes.isDirty()){const C=this._changes.getLayerUpdatesByScope();for(const D in C){const{updatedIds:V,removedIds:q}=C[D];(V||q)&&(this._updateWorkerLayers(D,V,q),b=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._changes.reset()}const w={};for(const C in this._mergedSourceCaches){const D=this._mergedSourceCaches[C];w[C]=D.used,D.used=!1,D.tileCoverLift=0}for(const C of this._mergedOrder){const D=this._mergedLayers[C];if(D.recalculate(r,this._availableImages),!D.isHidden(r.zoom)){const V=this.getLayerSourceCache(D);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(D,r)}):this.precompilePrograms(D,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&b&&this.mergeLayers();for(const C in w){const D=this._mergedSourceCaches[C];w[C]!==D.used&&D.getSource().fire(new o.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new o.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,p){const b=this.getFragmentStyle(r);b&&this.dispatcher.broadcast("updateLayers",{layers:l?b._serializeLayers(l):[],scope:r,removedIds:p||[],options:b.options})}setState(r,l){if(this._checkLoaded(),ka(this,hi(r)))return!1;(r=o.cm(r)).layers=so(r.layers);const p=function(C,D){if(!C)return[{command:zn.setStyle,args:[D]}];let V=[];try{if(!o.bi(C.version,D.version))return[{command:zn.setStyle,args:[D]}];if(o.bi(C.center,D.center)||V.push({command:zn.setCenter,args:[D.center]}),o.bi(C.zoom,D.zoom)||V.push({command:zn.setZoom,args:[D.zoom]}),o.bi(C.bearing,D.bearing)||V.push({command:zn.setBearing,args:[D.bearing]}),o.bi(C.pitch,D.pitch)||V.push({command:zn.setPitch,args:[D.pitch]}),o.bi(C.sprite,D.sprite)||V.push({command:zn.setSprite,args:[D.sprite]}),o.bi(C.glyphs,D.glyphs)||V.push({command:zn.setGlyphs,args:[D.glyphs]}),o.bi(C.imports,D.imports)||function(ae=[],be=[],_e){be=be||[];const Te=(ae=ae||[]).map(Ti),we=be.map(Ti),Le=ae.reduce($n,{}),Ue=be.reduce($n,{}),je=Te.slice();let Ye,et,Xe,nt;for(Ye=0,et=0;Ye<Te.length;Ye++)Xe=Te[Ye],Ue.hasOwnProperty(Xe)?et++:(_e.push({command:zn.removeImport,args:[Xe]}),je.splice(je.indexOf(Xe,et),1));for(Ye=0,et=0;Ye<we.length;Ye++)Xe=we[we.length-1-Ye],je[je.length-1-Ye]!==Xe&&(Le.hasOwnProperty(Xe)?(_e.push({command:zn.removeImport,args:[Xe]}),je.splice(je.lastIndexOf(Xe,je.length-et),1)):et++,nt=je[je.length-Ye],_e.push({command:zn.addImport,args:[Ue[Xe],nt]}),je.splice(je.length-Ye,0,Xe));for(const lt of be){const vt=Le[lt.id];vt&&!o.bi(vt,lt)&&_e.push({command:zn.updateImport,args:[lt.id,lt]})}}(C.imports,D.imports,V),o.bi(C.transition,D.transition)||V.push({command:zn.setTransition,args:[D.transition]}),o.bi(C.light,D.light)||V.push({command:zn.setLight,args:[D.light]}),o.bi(C.fog,D.fog)||V.push({command:zn.setFog,args:[D.fog]}),o.bi(C.projection,D.projection)||V.push({command:zn.setProjection,args:[D.projection]}),o.bi(C.lights,D.lights)||V.push({command:zn.setLights,args:[D.lights]}),o.bi(C.camera,D.camera)||V.push({command:zn.setCamera,args:[D.camera]}),!o.bi(C["color-theme"],D["color-theme"]))return[{command:zn.setStyle,args:[D]}];const q={},j=[];(function(ae,be,_e,Te){let we;for(we in be=be||{},ae=ae||{})ae.hasOwnProperty(we)&&(be.hasOwnProperty(we)||Ln(we,_e,Te));for(we in be){if(!be.hasOwnProperty(we))continue;const Le=be[we];ae.hasOwnProperty(we)?o.bi(ae[we],Le)||(ae[we].type==="geojson"&&Le.type==="geojson"&&uo(ae,be,we)?_e.push({command:zn.setGeoJSONSourceData,args:[we,Le.data]}):dr(we,be,_e,Te)):yo(we,be,_e)}})(C.sources,D.sources,j,q);const X=[];C.layers&&C.layers.forEach(ae=>{ae.source&&q[ae.source]?V.push({command:zn.removeLayer,args:[ae.id]}):X.push(ae)});let ee=C.terrain;ee&&q[ee.source]&&(V.push({command:zn.setTerrain,args:[void 0]}),ee=void 0),V=V.concat(j),o.bi(ee,D.terrain)||V.push({command:zn.setTerrain,args:[D.terrain]}),function(ae,be,_e){be=be||[];const Te=(ae=ae||[]).map(Ti),we=be.map(Ti),Le=ae.reduce($n,{}),Ue=be.reduce($n,{}),je=Te.slice(),Ye=Object.create(null);let et,Xe,nt,lt,vt,dt,ct;for(et=0,Xe=0;et<Te.length;et++)nt=Te[et],Ue.hasOwnProperty(nt)?Xe++:(_e.push({command:zn.removeLayer,args:[nt]}),je.splice(je.indexOf(nt,Xe),1));for(et=0,Xe=0;et<we.length;et++)nt=we[we.length-1-et],je[je.length-1-et]!==nt&&(Le.hasOwnProperty(nt)?(_e.push({command:zn.removeLayer,args:[nt]}),je.splice(je.lastIndexOf(nt,je.length-Xe),1)):Xe++,dt=je[je.length-et],_e.push({command:zn.addLayer,args:[Ue[nt],dt]}),je.splice(je.length-et,0,nt),Ye[nt]=!0);for(et=0;et<we.length;et++)if(nt=we[et],lt=Le[nt],vt=Ue[nt],!Ye[nt]&&!o.bi(lt,vt))if(o.bi(lt.source,vt.source)&&o.bi(lt["source-layer"],vt["source-layer"])&&o.bi(lt.type,vt.type)){for(ct in hr(lt.layout,vt.layout,_e,nt,null,zn.setLayoutProperty),hr(lt.paint,vt.paint,_e,nt,null,zn.setPaintProperty),o.bi(lt.slot,vt.slot)||_e.push({command:zn.setSlot,args:[nt,vt.slot]}),o.bi(lt.filter,vt.filter)||_e.push({command:zn.setFilter,args:[nt,vt.filter]}),o.bi(lt.minzoom,vt.minzoom)&&o.bi(lt.maxzoom,vt.maxzoom)||_e.push({command:zn.setLayerZoomRange,args:[nt,vt.minzoom,vt.maxzoom]}),lt)lt.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?hr(lt[ct],vt[ct],_e,nt,ct.slice(6),zn.setPaintProperty):o.bi(lt[ct],vt[ct])||_e.push({command:zn.setLayerProperty,args:[nt,ct,vt[ct]]}));for(ct in vt)vt.hasOwnProperty(ct)&&!lt.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?hr(lt[ct],vt[ct],_e,nt,ct.slice(6),zn.setPaintProperty):o.bi(lt[ct],vt[ct])||_e.push({command:zn.setLayerProperty,args:[nt,ct,vt[ct]]}))}else _e.push({command:zn.removeLayer,args:[nt]}),dt=je[je.lastIndexOf(nt)+1],_e.push({command:zn.addLayer,args:[vt,dt]})}(X,D.layers,V)}catch(q){console.warn("Unable to compute style diff:",q),V=[{command:zn.setStyle,args:[D]}]}return V}(this.serialize(),r).filter(C=>!(C.command in bc));if(p.length===0)return!1;const b=p.filter(C=>!(C.command in Ol));if(b.length>0)throw new Error(`Unimplemented: ${b.map(C=>C.command).join(", ")}.`);const w=[];return p.forEach(C=>{w.push(this[C.command].apply(this,C.args))}),l&&Promise.all(w).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new o.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l){this.imageManager.updateImage(r,this.scope,l)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new o.t(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new o.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,p={}){return this._checkLoaded(),this._validate(mt,`models.${r}`,l,null,p)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new o.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,p={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Er,`sources.${r}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const b=za(r,l,this.dispatcher,this);b.scope=this.scope,b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(b.id),source:b.serialize(),sourceId:b.id}));const w=C=>{const D=(C?"symbol:":"other:")+b.id,V=o.av(D,this.scope),q=this._sourceCaches[D]=new Ve(V,b,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[b.id]=q,q.onAdd(this.map)};w(!1),l.type!=="vector"&&l.type!=="geojson"||w(!0),b.onAdd&&b.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(r);for(const b of p){const w=o.cn(b.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(b.id),b.fire(new o.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const p=this.getOwnSourceCache(l);p&&r.push(p.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const p=r[l]._tiles;for(const b in p){const w=p[b];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const b of r){if(this._validate(Xo,"lights",b))return;switch(b.type){case"ambient":if(this.ambientLight){const w=this.ambientLight;w.set(b),w.updateTransitions(l)}else this.ambientLight=new Eo(b,cr||(cr=new o.a0({color:new o.a1(o._.properties_light_ambient.color),intensity:new o.a1(o._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const w=this.directionalLight;w.set(b),w.updateTransitions(l)}else this.directionalLight=new Eo(b,rr||(rr=new o.a0({direction:new o.ad(o._.properties_light_directional.direction),color:new o.a1(o._.properties_light_directional.color),intensity:new o.a1(o._.properties_light_directional.intensity),"cast-shadows":new o.a1(o._.properties_light_directional["cast-shadows"]),"shadow-intensity":new o.a1(o._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new o.a3(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const p=ee=>.2126*(ee[0]<=.03928?ee[0]/12.92:Math.pow((ee[0]+.055)/1.055,2.4))+.7152*(ee[1]<=.03928?ee[1]/12.92:Math.pow((ee[1]+.055)/1.055,2.4))+.0722*(ee[2]<=.03928?ee[2]/12.92:Math.pow((ee[2]+.055)/1.055,2.4)),b=r.properties.get("color").toRenderColor(null).toArray01(),w=r.properties.get("intensity"),C=r.properties.get("direction"),D=1-o.c8(C.x,C.y,C.z)[2]/90,V=p(b)*w*D,q=l.properties.get("color").toRenderColor(null).toArray01(),j=l.properties.get("intensity"),X=p(q)*j;return Number(((V+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(o.aK(r)){const l=o.co(r),p=this.fragments.find(({id:w})=>w===l);if(!p)throw new Error(`Style import '${r}' not found`);const b=o.cn(r);return p.style.getFragmentStyle(b)}{const l=this.fragments.find(({id:p})=>p===r);if(!l)throw new Error(`Style import '${r}' not found`);return l.style}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const p=[];for(const b in l.stylesheet.featuresets)p.push({featuresetId:b,importId:l.scope?l.scope:void 0});return p}getFeaturesetLayers(r,l){const p=this.getFragmentStyle(l),b=p.stylesheet.featuresets;if(!b||!b[r])return this.fire(new o.t(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const C of b[r].selectors){const D=p.getOwnLayer(C.layer);D&&w.push(D)}return w}getConfigProperty(r,l){const p=this.getFragmentStyle(r);if(!p)return null;const b=o.av(l,p.scope),w=p.options.get(b),C=w?w.value||w.default:null;return C?C.serialize():null}setConfigProperty(r,l,p){const b=this.getFragmentStyle(r);if(!b)return;const w=b.stylesheet.schema;if(!w||!w[l])return;const C=o.M(p);if(C.result!=="success")return void ka(this,C.value);const D=C.value.expression,V=o.av(l,b.scope),q=b.options.get(V);if(!q)return;let j;const{minValue:X,maxValue:ee,stepValue:ae,type:be,values:_e}=w[l],Te=o.M(w[l].default);Te.result==="success"&&(j=Te.value.expression),j?(this.options.set(V,{...q,value:D,default:j,minValue:X,maxValue:ee,stepValue:ae,type:be,values:_e}),this.updateConfigDependencies(l)):this.fire(new o.t(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const p=l.stylesheet.schema;if(!p)return null;const b={};for(const w in p){const C=o.av(w,l.scope),D=l.options.get(C),V=D?D.value||D.default:null;b[w]=V?V.serialize():null}return b}setConfig(r,l){const p=this.getFragmentStyle(r);p&&(p.updateConfig(l,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const p=this.getFragmentStyle(r);p&&(p.stylesheet.schema=l,p.updateConfig(p._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const p in l){let b,w;const C=o.M(l[p].default);if(C.result==="success"&&(b=C.value.expression),r&&r[p]!==void 0){const ee=o.M(r[p]);ee.result==="success"&&(w=ee.value.expression)}const{minValue:D,maxValue:V,stepValue:q,type:j,values:X}=l[p];if(b){const ee=o.av(p,this.scope);this.options.set(ee,{default:b,value:w,minValue:D,maxValue:V,stepValue:q,type:j,values:X})}else this.fire(new o.t(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new o.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const p=this.getLayer(l);if(p){if(r&&!p.configDependencies.has(r))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const p=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut&&p!==""||l._styleColorTheme.lut&&p!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(r,l,p={}){this._checkLoaded();const b=r.id;if(this._layers[b])return void this.fire(new o.t(new Error(`Layer with id "${b}" already exists on this map`)));let w;if(r.type==="custom"){if(ka(this,o.cp(r)))return;w=o.cq(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(b,r.source),r=o.cm(r),r=o.l(r,{source:b})),this._validate(Zt,`layers.${b}`,r,{arrayIndex:-1},p))return;w=o.cq(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:b}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let C=this._order.length;if(l){const j=this._order.indexOf(l);if(j===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));w.slot===this._layers[l].slot?C=j:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,b),this._layerOrderChanged=!0,this._layers[b]=w;const D=this.getOwnLayerSourceCache(w),V=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&w.canCastShadows()&&V&&(D.castsShadows=!0);const q=this._changes.getRemovedLayer(w);if(q&&w.source&&D&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const j=o.av(w.source,w.scope);q.type!==w.type?this._changes.updateSourceCache(j,"clear"):(this._changes.updateSourceCache(j,"reload"),D.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const p=this._checkLayer(r);if(!p||r===l)return;const b=this._order.indexOf(r);this._order.splice(b,1);let w=this._order.length;if(l){const C=this._order.indexOf(l);if(C===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));p.slot===this._layers[l].slot?w=C:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const p=this._order.indexOf(r);this._order.splice(p,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const b=this.getOwnLayerSourceCache(l);if(b&&b.castsShadows){let w=!1;for(const C in this._layers)if(this._layers[C].source===l.source&&this._layers[C].canCastShadows()){w=!0;break}b.castsShadows=w}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,p){this._checkLoaded();const b=this._checkLayer(r);b&&(b.minzoom===l&&b.maxzoom===p||(l!=null&&(b.minzoom=l),p!=null&&(b.maxzoom=p),this._updateLayer(b)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const p=this._checkLayer(r);p&&p.slot!==l&&(p.slot=l,this._updateLayer(p))}setFilter(r,l,p={}){this._checkLoaded();const b=this._checkLayer(r);if(b&&!o.bi(b.filter,l))return l==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(Ee,`layers.${b.id}.filter`,l,{layerType:b.type},p)||(b.filter=o.cm(l),this._updateLayer(b)))}getFilter(r){const l=this._checkLayer(r);if(l)return o.cm(l.filter)}setLayoutProperty(r,l,p,b={}){this._checkLoaded();const w=this._checkLayer(r);if(w&&!o.bi(w.getLayoutProperty(l),p)){if(p!=null&&(!b||b.validate!==!1)&&ka(w,qe.call(hi,{key:`layers.${r}.layout.${l}`,layerType:w.type,objectKey:l,value:p,styleSpec:o._,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(l,p),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(r,l){const p=this._checkLayer(r);if(p)return p.getLayoutProperty(l)}setPaintProperty(r,l,p,b={}){this._checkLoaded();const w=this._checkLayer(r);if(!w||o.bi(w.getPaintProperty(l),p)||p!=null&&(!b||b.validate!==!1)&&ka(w,ke.call(hi,{key:`layers.${r}.paint.${l}`,layerType:w.type,objectKey:l,value:p,styleSpec:o._})))return;const C=w.setPaintProperty(l,p);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),C&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(r,l){const p=this._checkLayer(r);if(p)return p.getPaintProperty(l)}setFeatureState(r,l){this._checkLoaded();const p=r.featureset;if(p){if("featuresetId"in p){const q=this.getFragmentStyle(p.importId),j=q.getFeaturesetLayers(p.featuresetId);for(const{source:X,sourceLayer:ee}of j)q.setFeatureState({id:r.id,source:X,sourceLayer:ee},l)}else if("layerId"in p){const q=this.getLayer(p.layerId);this.setFeatureState({id:r.id,source:q.source,sourceLayer:q.sourceLayer},l)}return}const b=r.source,w=r.sourceLayer,C=this._checkSource(b);if(!C)return;const D=C.type;if(D==="geojson"&&w)return void this.fire(new o.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(D==="vector"&&!w)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided.")));const V=this.getOwnSourceCaches(b);for(const q of V)q.setFeatureState(w,r.id,l)}removeFeatureState(r,l){this._checkLoaded();const p=r.featureset;if(p){if("featuresetId"in p){const q=this.getFragmentStyle(p.importId),j=q.getFeaturesetLayers(p.featuresetId);for(const{source:X,sourceLayer:ee}of j)q.removeFeatureState({id:r.id,source:X,sourceLayer:ee},l)}else if("layerId"in p){const q=this.getLayer(p.layerId);this.removeFeatureState({id:r.id,source:q.source,sourceLayer:q.sourceLayer},l)}return}const b=r.source,w=this._checkSource(b);if(!w)return;const C=w.type,D=C==="vector"?r.sourceLayer:void 0;if(C==="vector"&&!D)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.t(new Error("A feature id is required to remove its specific state property.")));const V=this.getOwnSourceCaches(b);for(const q of V)q.removeFeatureState(D,r.id,l)}getFeatureState(r){this._checkLoaded();const l=r.featureset;if(l){let C;if("featuresetId"in l){const D=this.getFragmentStyle(l.importId),V=D.getFeaturesetLayers(l.featuresetId);for(const{source:q,sourceLayer:j}of V){const X=D.getFeatureState({id:r.id,source:q,sourceLayer:j});if(X&&!C)C=X;else if(!o.bi(C,X))return void this.fire(new o.t(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r){const D=this.getLayer(l.layerId);C=this.getFeatureState({id:r.id,source:D.source,sourceLayer:D.sourceLayer})}return C}const p=r.source,b=r.sourceLayer,w=this._checkSource(p);if(w){if(w.type!=="vector"||b)return r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(p)[0].getFeatureState(b,r.id);this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=o.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return o.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return o.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),p=o.av(r.source,r.scope),b=this._changes.getUpdatedSourceCaches();r.source&&!b[p]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=D=>this._mergedLayers[D].is3D(),p=this.order,b={},w=[];for(let D=p.length-1;D>=0;D--){const V=p[D];if(l(V)){b[V]=D;for(const q of r){const j=q[V];if(j)for(const X of j)w.push(X)}}}w.sort((D,V)=>V.intersectionZ-D.intersectionZ);const C=[];for(let D=p.length-1;D>=0;D--){const V=p[D];if(l(V))for(let q=w.length-1;q>=0;q--){const j=w[q].feature;if(j.layer&&b[j.layer.id]<D)break;C.push(j),w.pop()}else for(const q of r){const j=q[V];if(j)for(const X of j)C.push(X.feature)}}return C}queryRenderedFeatures(r,l,p){l&&!Array.isArray(l)&&l.filter&&this._validate(Ee,"queryRenderedFeatures.filter",l.filter,null,l);let b,w=!1;const C=new Set;if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.t(new Error("parameters.layers must be an Array."))),[];b=[];for(const j of l.layers){const X=this._mergedLayers[j];if(!X)return this.fire(new o.t(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];X.is3D()&&(w=!0),C.add(X.source),b.push(j)}}else w=this.has3DLayers();const D=this._queryRenderedFeatures(r,p,{layerIds:b,filter:l.filter,has3DLayers:w,includedSources:C}),V=this._flattenAndSortRenderedFeatures(D),q=[];for(const j of V)o.co(j.layer.id)===this.scope&&q.push(j);return q}queryRenderedFeaturesForInteractions(r,l,p){let b=[];for(const{featureset:V,filter:q,radius:j}of l){let X=!1;const ee=[],ae=new Set;if("featuresetId"in V){const _e=this.getFeaturesetLayers(V.featuresetId,V.importId);if(_e.length===0)continue;for(const Te of _e)Te.is3D()&&(X=!0),ae.add(Te.source),ee.push(Te.fqid)}else if("layerId"in V){const _e=this._mergedLayers[V.layerId];if(!_e)return this.fire(new o.t(new Error(`The layer '${V.layerId}' does not exist in the map's style and cannot be queried for features.`))),[];_e.is3D()&&(X=!0),ae.add(_e.source),ee.push(V.layerId)}let be=r;if(j)if(r instanceof o.P||typeof r[0]=="number"){const _e=o.P.convert(r);be=[[_e.x-j,_e.y-j],[_e.x+j,_e.y+j]]}else{const _e=o.P.convert(r[0]),Te=o.P.convert(r[1]);be=[[_e.x-j,_e.y-j],[Te.x+j,Te.y+j]]}b=b.concat(this._queryRenderedFeatures(be,p,{layerIds:ee,filter:q,has3DLayers:X,includedSources:ae}))}const w=this._flattenAndSortRenderedFeatures(b),C=(V,q,j)=>{const X=V.clone();if(delete X.layer,X.featureset=q,j&&j.featureNamespace&&(X.namespace=j.featureNamespace),j&&j.properties){const ee={},ae=this.map.transform.zoom;for(const be of Object.keys(j.properties)){const _e=j.properties[be].evaluate({zoom:ae},V._vectorTileFeature,V.state,V.tile,this._availableImages);_e!=null&&(ee[be]=_e)}X.properties=ee}return X},D=[];for(const V of w){const q=V.layer.id,j=o.cn(q),X=o.co(q);for(const{featureset:ee}of l){if("layerId"in ee&&ee.layerId!==q)continue;if("layerId"in ee&&ee.layerId===q){const be=C(V,ee);D.push(be);continue}if("featuresetId"in ee&&(ee.importId!==X||!this.getFeaturesetLayers(ee.featuresetId,ee.importId).map(be=>be.id).includes(j)))continue;const ae=this._mergedLayerSelectors.get(q)||[];for(const be of ae){const _e=C(V,ee,be);D.push(_e)}}}return D}_queryRenderedFeatures(r,l,p){const{layerIds:b,filter:w,has3DLayers:C,includedSources:D}=p,V=[],q=qo.createFromScreenPoints(r,l);for(const j in this._mergedSourceCaches){if(!this._mergedSourceCaches[j].getSource())continue;const X=this._mergedSourceCaches[j].getSource().id;b&&!D.has(X)||V.push(il(this._mergedSourceCaches[j],this._mergedLayers,q,w,b||[],this._availableImages,l,C,!!this.map._showQueryGeometry))}return this.placement&&V.push(function(j,X,ee,ae,be,_e,Te,we){const Le={},Ue=Te.queryRenderedSymbols(ee),je=[];for(const Ye of Object.keys(Ue).map(Number))je.push(we[Ye]);je.sort(sc);for(const Ye of je){const et=Ye.featureIndex.lookupSymbolFeatures(Ue[Ye.bucketInstanceId],Ye.bucketIndex,Ye.sourceLayerIndex,ae,be,_e,j);for(const Xe in et){const nt=Le[Xe]=Le[Xe]||[],lt=et[Xe];lt.sort((vt,dt)=>{const ct=Ye.featureSortOrder;if(ct){const jt=ct.indexOf(vt.featureIndex);return ct.indexOf(dt.featureIndex)-jt}return dt.featureIndex-vt.featureIndex});for(const vt of lt)nt.push(vt)}}for(const Ye in Le)Le[Ye].forEach(et=>{const Xe=et.feature,nt=j[Ye],lt=X(nt);if(!lt)return;const vt=lt.getFeatureState(Xe.layer["source-layer"],Xe.id);Xe.state=vt,o.aK(nt.id)||(Xe.source=Xe.layer.source,Xe.layer["source-layer"]&&(Xe.sourceLayer=Xe.layer["source-layer"]))});return Le}(this._mergedLayers,this.getLayerSourceCache.bind(this),q.screenGeometry,w,b||[],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData)),V}querySourceFeatures(r,l){const p=l&&l.filter;p&&this._validate(Ee,"querySourceFeatures.filter",p,null,l);let b=[];const w=this.getOwnSourceCaches(r);for(const C of w)b=b.concat(al(C,l));return b}addSourceType(r,l,p){return Tn.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(Tn.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,p={}){this._checkLoaded();const b=this.light.getLight();let w=!1;for(const D in r)if(!o.bi(r[D],b[D])){w=!0;break}if(!w)return;const C=this._getTransitionParameters();this.light.setLight(r,l,p),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=r;const b=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const D="terrain-dem-src";this.addSource(D,p.source),p=o.cm(p),p=o.l(p,{source:D})}const w=o.l({},p),C={};if(this.terrain&&b){w.source=this.terrain.get().source;const D=this.terrain?this.getFragmentStyle(this.terrain.scope):null;D&&(C.style=D.serialize())}if(this._validate(Bi,"terrain",w,C))return}if(!this.terrain||this.terrain.scope!==this.scope&&!b||this.terrain&&l!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,l),this.fire(new o.x("data",{dataType:"style"}))}else{const w=this.terrain,C=w.get();for(const D of Object.keys(o._.terrain))!p.hasOwnProperty(D)&&o._.terrain[D].default&&(p[D]=o._.terrain[D].default);for(const D in r)if(!o.bi(r[D],C[D])){w.set(r,this.options),this.stylesheet.terrain=r;const V=this._getTransitionParameters({duration:0});w.updateTransitions(V),this.fire(new o.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new Lo(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!o.bi(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}}else this._createFog(r);this._markersNeedUpdate=!0}setColorTheme(r){this._checkLoaded();const l=()=>{for(const b in this._layers)this._layers[b].lut=this._styleColorTheme.lut;for(const b in this._sourceCaches)this._sourceCaches[b].clearTiles()};if(this._styleColorTheme.colorTheme=r,!r)return this._styleColorTheme.lut=null,void l();const p=this._evaluateColorThemeData(r);this._loadColorTheme(p).then(()=>{this.fire(new o.x("colorthemeset")),l()}).catch(b=>{o.w(`Couldn't set color theme: ${b}`)})}_getTransitionParameters(r){return{now:o.q.now(),transition:o.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?r.push(p):l.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const p=this.terrain=new Wt(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const b=this._getTransitionParameters({duration:0});p.updateTransitions(b)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,p,b,w={}){if(w&&w.validate===!1)return!1;const C=o.l({},this.serialize());return ka(this,r.call(hi,o.l({key:l,style:C,value:p,styleSpec:o._},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const p of l)p.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const p of l)p.resume(),p.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}updateSources(r){let l;this.directionalLight&&(l=_d(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,p,b,w,C,D=!1){let V=!1,q=!1;const j={},X={};for(const ee of this._mergedOrder){const ae=this._mergedLayers[ee];if(ae.type!=="symbol")continue;const be=o.av(ae.source,ae.scope);let _e=j[be];if(!_e){const we=this.getLayerSourceCache(ae);if(!we)continue;const Le=we.getRenderableIds(!0).map(Ue=>we.getTileByID(Ue));X[be]=Le.slice(),_e=j[be]=Le.sort((Ue,je)=>je.tileID.overscaledZ-Ue.tileID.overscaledZ||(Ue.tileID.isLessThan(je.tileID)?-1:1))}const Te=this.crossTileSymbolIndex.addLayer(ae,_e,l.center.lng,l.projection);V=V||Te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),D=D||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new o.x("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.q.now(),l.zoom))&&(this.pauseablePlacement=new hc(l,this._mergedOrder,D,p,b,w,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,j,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.q.now()),q=!0),V&&this.pauseablePlacement.placement.setStale()),q||V){this._buildingIndex.onNewFrame(l.zoom);for(let ee=0;ee<this._mergedOrder.length;ee++){const ae=this._mergedLayers[this._mergedOrder[ee]];if(ae.type!=="symbol")continue;const be=this.isLayerClipped(ae);this.placement.updateLayerOpacities(ae,j[o.av(ae.source,ae.scope)],ee,be?C:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:w})=>w===r.id)!==-1)return void this.fire(new o.t(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return p.push(r),this._loadImports([r],!0);const b=p.findIndex(({id:w})=>w===l);return b===-1&&this.fire(new o.t(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,b).concat(r).concat(p.slice(b)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],b=this.getImportIndex(r);return b===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==p[b].url&&this.setImportUrl(r,l.url),o.bi(l.config,p[b].config)||this.setImportConfig(r,l.config),o.bi(l.data,p[b].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let p=this.stylesheet.imports||[];const b=this.getImportIndex(r);if(b===-1)return this;const w=this.getImportIndex(l);if(w===-1)return this;const C=p[b],D=this.fragments[b];return p=p.filter(({id:V})=>V!==r),this.fragments=this.fragments.filter(({id:V})=>V!==r),this.stylesheet.imports=p.slice(0,w).concat(C).concat(p.slice(w)),this.fragments=this.fragments.slice(0,w).concat(D).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],b=this.getImportIndex(r);if(b===-1)return this;p[b].url=l;const w=this.fragments[b];return w.style=this._createFragmentStyle(p[b]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const p=this.getImportIndex(r),b=this.stylesheet.imports||[];return p===-1?this:l?(this.fragments[p].style.setState(l),this._reloadImports(),this):(delete b[p].data,this.setImportUrl(r,b[p].url))}setImportConfig(r,l){this._checkLoaded();const p=this.getImportIndex(r),b=this.stylesheet.imports||[];if(p===-1)return this;l?b[p].config=l:delete b[p].config;const w=this.fragments[p],C=w.style.stylesheet&&w.style.stylesheet.schema;return w.config=l,w.style.updateConfig(l,C),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],p=this.getImportIndex(r);p!==-1&&(l.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(p=>p.id===r);return l===-1&&this.fire(new o.t(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[l];p&&r.push(p.getSource())}return r}getSource(r,l){const p=this.getSourceCache(r,l);return p&&p.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const p=o.av(r,l);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(r){const l=o.av(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const p=r[l];p==="reload"?this.reloadSource(l):p==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const p of l){const b=this.getLayer(p);b&&b.updateTransitions(r)}}getImages(r,l,p){this.imageManager.getImages(l.icons,l.scope,p),this._updateTilesForChangedImages();const b=w=>{w&&w.setDependencies(l.tileID.key,l.type,l.icons)};b(this._otherSourceCaches[l.source]),b(this._symbolSourceCaches[l.source])}getGlyphs(r,l,p){this.glyphManager.getGlyphs(l.stacks,l.scope,p)}getResource(r,l,p){return o.ct(l,p)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new o.t(new Error(`There is no source with ID '${r}'`))),!1):l.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const p=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(p||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Tn.getSourceType=function(f){return ms[f]},Tn.setSourceType=function(f,r){ms[f]=r},Tn.registerForPluginStateChange=o.cd;var vo=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Jo=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Si=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Or="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Li=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Hi=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ts=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Zi=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Gi=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,ys=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Ba=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const oa=[];dl(vo,oa),dl(Si,oa),dl(Jo,oa);const Na={"_prelude_fog.vertex.glsl":Hi,"_prelude_terrain.vertex.glsl":Li,"_prelude_shadow.vertex.glsl":ys,"_prelude_fog.fragment.glsl":ts,"_prelude_shadow.fragment.glsl":Ba,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Zi,"_prelude_raster_particle.glsl":Gi},bs={};pr("",Li),pr(ts,Hi),pr(Ba,ys),pr(Zi,""),pr(Gi,"");const Ll=pr(Jo,Si),ul=vo;var ns={background:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:pr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:pr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:pr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:pr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:pr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:pr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:pr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:pr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:pr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:pr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:pr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:pr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:pr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:pr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:pr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:pr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Or),skyboxGradient:pr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Or),skyboxCapture:pr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:pr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:pr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:pr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:pr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:pr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),occlusion:pr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function dl(f,r){const l=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of l)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=p.split(" ");for(const w of b)r.includes(w)||r.push(w)}}function pr(f,r){const l=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let b=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);b&&(b=b.map(q=>{const j=q.split(" ");return j[j.length-1]}),b=[...new Set(b)]);const w={},C=[],D=[];if(f=f.replace(l,(q,j)=>(D.push(j),"")),(r=r.replace(l,(q,j)=>(C.push(j),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let V=[...oa];dl(f,V),dl(r,V);for(const q of[...C,...D])Na[q]||console.error(`Undefined include: ${q}`),bs[q]||(bs[q]=[],dl(Na[q],bs[q])),V=[...V,...bs[q]];return{fragmentSource:f=f.replace(p,(q,j,X,ee,ae)=>(w[ae]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
in ${X} ${ee} ${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:j==="initialize"?`
#ifdef HAS_UNIFORM_u_${ae}
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${ee} ${ae};
#endif
`:j==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(p,(q,j,X,ee,ae)=>{const be=ee==="float"?"vec2":ee,_e=ae.match(/color/)?"color":be;return j==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
in ${X} ${ee} a_${ae};
#endif
`:w[ae]?j==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${be} a_${ae};
out ${X} ${ee} ${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:j==="initialize"?_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${_e}(a_${ae}, u_${ae}_t);
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${ee} a_${ae};
    out ${X} ${ee} ${ae};
#endif
`:j==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${ae} = a_${ae};
#endif
`:void 0:j==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${be} a_${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:j==="define-instanced"?_e==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ae}0;
in vec4 a_${ae}1;
in vec4 a_${ae}2;
in vec4 a_${ae}3;
#else
uniform ${X} ${ee} u_${ae};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${be} a_${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:j==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${X} ${ee} ${ae} = a_${ae};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${ee} ${ae} = a_${ae};
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${ee} ${ae} = unpack_mix_${_e}(a_${ae}, u_${ae}_t);
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`}),staticAttributes:b,usedDefines:V,vertexIncludes:C,fragmentIncludes:D}}class su{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,p,b,w,C,D,V){this.context=r;let q=this.boundPaintVertexBuffers.length!==b.length;for(let X=0;!q&&X<b.length;X++)this.boundPaintVertexBuffers[X]!==b[X]&&(q=!0);let j=this.boundDynamicVertexBuffers.length!==D.length;for(let X=0;!j&&X<D.length;X++)this.boundDynamicVertexBuffers[X]!==D[X]&&(j=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||q||j||this.boundIndexBuffer!==w||this.boundVertexOffset!==C)this.freshBind(l,p,b,w,C,D,V);else{r.bindVertexArrayOES.set(this.vao);for(const X of D)X&&(X.bind(),V&&X.instanceCount&&X.setVertexAttribDivisor(r.gl,l,V));w&&w.dynamicDraw&&w.bind()}}freshBind(r,l,p,b,w,C,D){const V=r.numAttributes,q=this.context,j=q.gl;this.vao&&this.destroy(),this.vao=q.gl.createVertexArray(),q.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=b,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=C,l.enableAttributes(j,r),l.bind(),l.setVertexAttribPointers(j,r,w);for(const X of p)X.enableAttributes(j,r),X.bind(),X.setVertexAttribPointers(j,r,w);for(const X of C)X&&(X.enableAttributes(j,r),X.bind(),X.setVertexAttribPointers(j,r,w),D&&X.instanceCount&&X.setVertexAttribDivisor(j,r,D));b&&b.bind(),q.currentNumAttributes=V}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function li(f,r){const l=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new o.a5(0,p/l).toLngLat().lat,new o.a5(0,(p+1)/l).toLngLat().lat]}function ri(f,r,l,p,b,w,C){const D=f.context,V=D.gl,q=l.hillshadeFBO;if(!q)return;f.prepareDrawTile();const j=f.isTileAffectedByFog(r),X=f.getOrCreateProgram("hillshade",{overrideFog:j});D.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,q.colorAttachment.get());const ee=((Te,we,Le,Ue)=>{const je=Le.paint.get("hillshade-shadow-color"),Ye=Le.paint.get("hillshade-highlight-color"),et=Le.paint.get("hillshade-accent-color"),Xe=Le.paint.get("hillshade-emissive-strength");let nt=o.bC(Le.paint.get("hillshade-illumination-direction"));if(Le.paint.get("hillshade-illumination-anchor")==="viewport")nt-=Te.transform.angle;else if(Te.style&&Te.style.enable3dLights()&&Te.style.directionalLight){const vt=Te.style.directionalLight.properties.get("direction"),dt=o.c8(vt.x,vt.y,vt.z);nt=o.bC(dt[1])}const lt=!Te.options.moving;return{u_matrix:Ue||Te.transform.calculateProjMatrix(we.tileID.toUnwrapped(),lt),u_image:0,u_latrange:li(0,we.tileID),u_light:[Le.paint.get("hillshade-exaggeration"),nt],u_shadow:je.toRenderColor(Le.lut),u_highlight:Ye.toRenderColor(Le.lut),u_emissive_strength:Xe,u_accent:et.toRenderColor(Le.lut)}})(f,l,p,f.terrain?r.projMatrix:null);f.uploadCommonUniforms(D,X,r.toUnwrapped());const{tileBoundsBuffer:ae,tileBoundsIndexBuffer:be,tileBoundsSegments:_e}=f.getTileBoundsBuffers(l);X.draw(f,V.TRIANGLES,b,w,C,Po.disabled,ee,p.id,ae,be,_e)}function Dl(f,r,l){if(!r.needsDEMTextureUpload)return;const p=f.context,b=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(l.stride);const w=l.getPixels();r.demTexture?r.demTexture.update(w,{premultiply:!1}):r.demTexture=new o.T(p,w,b.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function $a(f,r,l){const p=f.context,b=p.gl;if(!r.dem)return;const w=r.dem;if(p.activeTexture.set(b.TEXTURE1),Dl(f,r,w),!r.demTexture)return;r.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);const C=w.dim;p.activeTexture.set(b.TEXTURE0);let D=r.hillshadeFBO;if(!D){const ee=new o.T(p,{width:C,height:C,data:null},b.RGBA8);ee.bind(b.LINEAR,b.CLAMP_TO_EDGE),D=r.hillshadeFBO=p.createFramebuffer(C,C,!0,"renderbuffer"),D.colorAttachment.set(ee.texture)}p.bindFramebuffer.set(D.framebuffer),p.viewport.set([0,0,C,C]);const{tileBoundsBuffer:V,tileBoundsIndexBuffer:q,tileBoundsSegments:j}=f.getMercatorTileBoundsBuffers(),X=[];f.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(f,b.TRIANGLES,bo.disabled,Do.disabled,ir.unblended,Po.disabled,((ee,ae)=>{const be=ae.stride,_e=o.a6.mat4.create();return o.a6.mat4.ortho(_e,0,o.ab,-o.ab,0,0,1),o.a6.mat4.translate(_e,_e,[0,-o.ab,0]),{u_matrix:_e,u_image:1,u_dimension:[be,be],u_zoom:ee.overscaledZ}})(r.tileID,w),l.id,V,q,j),r.needsHillshadePrepare=!1}class $r{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Pa extends $r{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Ws extends $r{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class qs extends $r{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class zl extends $r{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Fl extends $r{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class xc extends $r{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Bl extends $r{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class zh extends $r{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class hl extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class bd extends $r{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class xd extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class wd extends $r{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Jf extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class lu extends $r{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class cu extends $r{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Jm extends $r{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class Qm extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class W_ extends $r{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class q_ extends $r{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let M1=class extends $r{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class Fh extends $r{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Bh extends $r{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class K_ extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class xs extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class eg extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Qf extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class ep extends $r{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class tg extends $r{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class ng extends $r{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class tp extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class og extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Nh extends $r{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class np extends Nh{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class rg extends Nh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Z_ extends Nh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Sd extends rg{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const I1=(f,r,l)=>({u_matrix:f,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),Y_=(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:l,u_zoom_transition:b,u_merc_center:w,u_image0:0,u_frustum_tl:C,u_frustum_tr:D,u_frustum_br:V,u_frustum_bl:q,u_globe_pos:j,u_globe_radius:X,u_viewport:ee,u_grid_matrix:_e?Float32Array.from(_e):new Float32Array(9),u_skirt_height:ae,u_far_z_cutoff:be});function X_(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const Td=new class{constructor(){this.operations={}}newMorphing(f,r,l,p,b){if(f in this.operations){const w=this.operations[f];w.to.tileID.key!==l.tileID.key&&(w.queued=l)}else this.operations[f]={startTime:p,phase:0,duration:b,from:r,to:l,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const l=this.operations[r];for(l.phase=(f-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},J_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Q_(f,r,l){if(r===0)return 0;const p=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-f)*Math.max(r,1)*p}function ig(f,r){const l=1<<f.z;return!r&&(f.x===0||f.x===l-1)||f.y===0||f.y===l-1}const $h=f=>({u_matrix:f});function op(f,r,l,p,b){if(b>0){const w=o.q.now(),C=(w-f.timeAdded)/b,D=r?(w-r.timeAdded)/b:-1,V=l.getSource(),q=p.coveringZoomLevel({tileSize:V.tileSize,roundZoom:V.roundZoom}),j=!r||Math.abs(r.tileID.overscaledZ-q)>Math.abs(f.tileID.overscaledZ-q),X=j&&f.refreshedUponExpiration?1:o.ap(j?C:1-D,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class Cd extends Ve{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new o.ce(o.cf(),null),b=za("mock-dem",l,p,r.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class ey extends Ve{constructor(r){const l=za("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new o.ce(o.cf(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,p){if(r.freezeTileCoverage)return;this.transform=r;const b=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,C)=>{if(w[C.key]="",!this._tiles[C.key]){const D=new Ns(C,this._source.tileSize*C.overscaleFactor(),r.tileZoom);D.state="loaded",this._tiles[C.key]=D}return w},{});for(const w in this._tiles)w in b||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ag extends o.aA{constructor(r,l,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class sg extends o.cE{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,b,w]=function(V){const q=new o.a$,j=new o.aP,X=131;q.reserve(17161),j.reserve(33800);const ee=o.ab/128,ae=o.ab+ee/2,be=ae+ee;for(let Te=-ee;Te<be;Te+=ee)for(let we=-ee;we<be;we+=ee){const Le=we<0||we>ae||Te<0||Te>ae?24575:0,Ue=o.ap(Math.round(we),0,o.ab),je=o.ap(Math.round(Te),0,o.ab);q.emplaceBack(Ue+Le,je)}const _e=(Te,we)=>{const Le=we*X+Te;j.emplaceBack(Le+1,Le,Le+X),j.emplaceBack(Le+X,Le+X+1,Le+1)};for(let Te=1;Te<129;Te++)for(let we=1;we<129;we++)_e(we,Te);return[0,129].forEach(Te=>{for(let we=0;we<130;we++)_e(we,Te),_e(Te,we)}),[q,j,32768]}(),C=r.context;this.gridBuffer=C.createVertexBuffer(p,o.b1.members),this.gridIndexBuffer=C.createIndexBuffer(b),this.gridSegments=o.b2.simpleSegment(0,0,p.length,b.length),this.gridNoSkirtSegments=o.b2.simpleSegment(0,0,p.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ey(l.map),this.orthoMatrix=o.a6.mat4.create(),o.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.ab,0,o.ab,0,1);const D=C.gl;this._overlapStencilMode=new Do({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Cd(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,p){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const b=r.terrain.properties,w=r.terrain.drapeRenderMode===0,C=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.q.now();const D=r.terrain&&r.terrain.scope,V=b.get("source"),q=w?this._mockSourceCache:r.getSourceCache(V,D);if(!q)return void o.w(`Couldn't find terrain source "${V}".`);if(this.sourceCache=q,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=C?this.calculateExaggeration(l):b.get("exaggeration"),!l.projection.requiresDraping&&C&&this._exaggeration===0)return void this._disable();this.enabled=!0;const j=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(l,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),l.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,p=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=p;const b=l!=null?p-l:Number.MAX_VALUE;if(Math.abs(b)<2)return this._exaggeration;const w=r.zoom,C=this._style.terrain;if(!this._previousUpdateTimestamp)return C.getExaggeration(w);let D=w-this._previousZoom;const V=this._previousUpdateTimestamp;let q=w;this._evaluationZoom!=null&&(q=this._evaluationZoom,Math.abs(w-q)>.5&&(D=.5*(w-q+D)),D*b<0&&(q+=D)),this._evaluationZoom=q;const j=C.getExaggeration(q),X=j===C.getExaggeration(Math.max(0,q-.1));if(X&&Math.abs(j-this._exaggeration)<.01)return j;let ee=Math.min(.1,.00375*(this._updateTimestamp-V));return(X||j<.1||Math.abs(D)<1e-4)&&(ee=Math.min(.2,4*ee)),o.aa(this._exaggeration,j,ee)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(o.a5.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=l.getIds().map(V=>{const q=l.getTileByID(V).tileID;return q.projMatrix=p.calculateProjMatrix(q.toUnwrapped()),q});(function(V,q){const j=q.transform.pointCoordinate(q.transform.getCameraPoint()),X=new o.P(j.x,j.y);V.sort((ee,ae)=>{if(ae.overscaledZ-ee.overscaledZ)return ae.overscaledZ-ee.overscaledZ;const be=new o.P(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),_e=new o.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),Te=X.mult(1<<ee.canonical.z);return Te.x-=.5,Te.y-=.5,Te.distSqr(be)-Te.distSqr(_e)})})(b,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},b.forEach(V=>{this.proxyToSource[V.key]={}}),this.terrainTileForTile={};const C=this._style._mergedSourceCaches;for(const V in C){const q=C[V];if(!q.used||(q!==this.sourceCache&&this.resetTileLookupCache(q.id),this._setupProxiedCoordsForOrtho(q,r[V],w),q.usedForTerrain))continue;const j=r[V];q.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[l.id]=b.map(V=>new ag(V,V.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const D={};this._visibleDemTiles=[];for(const V of this.proxyCoords){const q=this.terrainTileForTile[V.key];if(!q)continue;const j=q.tileID.key;j in D||(this._visibleDemTiles.push(q),D[j]=j)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const p in this.terrainTileForTile){const b=this.terrainTileForTile[p],w=b.dem;!w||b.demTexture&&!b.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),Dl(this.painter,b,w))}}_prepareDemTileUniforms(r,l,p,b){if(!l||l.demTexture==null)return!1;const w=r.tileID.canonical,C=Math.pow(2,l.tileID.canonical.z-w.z),D=b||"";return p[`u_dem_tl${D}`]=[w.x*C%1,w.y*C%1],p[`u_dem_scale${D}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((p,b)=>{if(!b.dem)return p;const w=b.dem.tree.minimums[0];return w>0&&r++,p+w},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),b=new o.cF({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(b,{premultiply:!1}):w=this._emptyDEMTexture=new o.T(r,b,l.R32F,{premultiply:!1}),w}setupElevationDraw(r,l,p){const b=this.painter.context,w=b.gl,C={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};C.u_exaggeration=this.exaggeration();let D=null,V=null,q=1;if(p&&p.morphing&&this._useVertexMorphing){const ae=p.morphing.srcDemTile,be=p.morphing.dstDemTile;q=p.morphing.phase,ae&&be&&(this._prepareDemTileUniforms(r,ae,C,"_prev")&&(V=ae),this._prepareDemTileUniforms(r,be,C)&&(D=be))}const j=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let X=null;var ee;if(this.enabled?V&&D?(X=D.demTexture,b.activeTexture.set(w.TEXTURE4),V.demTexture.bind(j(V),w.CLAMP_TO_EDGE),C.u_dem_lerp=q):(D=this.terrainTileForTile[r.tileID.key],X=this._prepareDemTileUniforms(r,D,C)?D.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,b.activeTexture.set(w.TEXTURE2),X&&(C.u_dem_size=(ee=X).size[0]===1?1:ee.size[0]-2,X.bind(j(D),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,l,C),p&&p.useMeterToDem&&D){const ae=(1<<D.tileID.canonical.z)*o.bE(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=ae}if(p&&p.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(b,C),this.painter.transform.projection.name==="globe"){const ae=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);l.setGlobeUniformValues(b,ae)}}globeUniformValues(r,l,p){const b=r.projection;return{u_tile_tl_up:b.upVector(l,0,0),u_tile_tr_up:b.upVector(l,o.ab,0),u_tile_br_up:b.upVector(l,o.ab,o.ab),u_tile_bl_up:b.upVector(l,0,o.ab),u_tile_up_scale:p?o.cG(1):b.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,w,C,D,V){if(b.transform.projection.name==="globe")(function(q,j,X,ee,ae){const be=q.context,_e=be.gl;let Te,we;const Le=q.transform,Ue=o.cx(q,be,Le),je=(jt,en)=>{if(we===en)return;const gn=[J_[en],"PROJECTION_GLOBE_VIEW"];Ue&&gn.push("CUSTOM_ANTIALIASING");const An=q.isTileAffectedByFog(jt);Te=q.getOrCreateProgram("globeRaster",{defines:gn,overrideFog:An}),we=en},Ye=q.colorModeForRenderPass(),et=new bo(_e.LEQUAL,bo.ReadWrite,q.depthRangeFor3D);Td.update(ae);const Xe=o.cy(Le),nt=[o.am(Le.center.lng),o.at(Le.center.lat)],lt=q.globeSharedBuffers,vt=[Le.width*o.q.devicePixelRatio,Le.height*o.q.devicePixelRatio],dt=Float32Array.from(Le.globeMatrix),ct={useDenormalizedUpVectorScale:!0};{const jt=q.transform,en=Q_(jt.zoom,j.exaggeration(),j.sourceCache._source.tileSize);we=-1;const gn=_e.TRIANGLES;for(const An of ee){const Dn=X.getTile(An),It=Do.disabled,pn=j.prevTerrainTileForTile[An.key],Xt=j.terrainTileForTile[An.key];X_(pn,Xt)&&Td.newMorphing(An.key,pn,Xt,ae,250),be.activeTexture.set(_e.TEXTURE0),Dn.texture&&Dn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const mn=Td.getMorphValuesForProxy(An.key),xn=mn?1:0;mn&&o.C(ct,{morphing:{srcDemTile:mn.from,dstDemTile:mn.to,phase:o.cw(mn.phase)}});const hn=o.cz(An.canonical),Vn=o.cA(hn.getCenter().lat),fo=o.cB(An.canonical,hn,Vn,jt.worldSize/jt._pixelsPerMercatorPixel),xo=o.b6(o.cC(An.canonical)),ro=Y_(jt.expandedFarZProjMatrix,dt,Xe,xo,o.a9(jt.zoom),nt,jt.frustumCorners.TL,jt.frustumCorners.TR,jt.frustumCorners.BR,jt.frustumCorners.BL,jt.globeCenterInViewSpace,jt.globeRadius,vt,en,jt._farZ,fo);if(je(An,xn),Te&&(j.setupElevationDraw(Dn,Te,ct),q.uploadCommonUniforms(be,Te,An.toUnwrapped()),lt)){const[So,Wn,Ro]=lt.getGridBuffers(Vn,en!==0);Te.draw(q,gn,et,It,Ye,Po.backCCW,ro,"globe_raster",So,Wn,Ro)}}}if(lt&&(q.renderDefaultNorthPole||q.renderDefaultSouthPole)){const jt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ue&&jt.push("CUSTOM_ANTIALIASING"),Te=q.getOrCreateProgram("globeRaster",{defines:jt});for(const en of ee){const{x:gn,y:An,z:Dn}=en.canonical,It=An===0,pn=An===(1<<Dn)-1,[Xt,mn,xn,hn]=lt.getPoleBuffers(Dn,!1);if(hn&&(It||pn)){const Vn=X.getTile(en);be.activeTexture.set(_e.TEXTURE0),Vn.texture&&Vn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);let fo=o.cD(Dn,gn,Le);const xo=o.b6(o.cC(en.canonical)),ro=(So,Wn)=>So.draw(q,_e.TRIANGLES,et,Do.disabled,Ye,Po.disabled,Y_(Le.expandedFarZProjMatrix,fo,fo,xo,0,nt,Le.frustumCorners.TL,Le.frustumCorners.TR,Le.frustumCorners.BR,Le.frustumCorners.BL,Le.globeCenterInViewSpace,Le.globeRadius,vt,0,Le._farZ),"globe_pole_raster",Wn,xn,hn);j.setupElevationDraw(Vn,Te,ct),q.uploadCommonUniforms(be,Te,en.toUnwrapped()),It&&q.renderDefaultNorthPole&&ro(Te,Xt),pn&&q.renderDefaultSouthPole&&(fo=o.a6.mat4.scale(o.a6.mat4.create(),fo,[1,-1,1]),ro(Te,mn))}}}})(b,w,C,D,V);else{const q=b.context,j=q.gl;let X,ee;const ae=b.shadowRenderer,be=Aa(b,b.longestCutoffRange),_e=Ye=>{if(ee===Ye)return;const et=[];et.push(J_[Ye]),be.shouldRenderCutoff&&et.push("RENDER_CUTOFF"),ae&&(et.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&et.push("NORMAL_OFFSET")),X=b.getOrCreateProgram("terrainRaster",{defines:et}),ee=Ye},Te=b.colorModeForRenderPass(),we=new bo(j.LEQUAL,bo.ReadWrite,b.depthRangeFor3D);Td.update(V);const Le=b.transform,Ue=Q_(Le.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let je=[0,0,0];if(ae){const Ye=b.style.directionalLight,et=b.style.ambientLight;Ye&&et&&(je=yc(b.style,Ye,et))}{ee=-1;const Ye=j.TRIANGLES,[et,Xe]=[w.gridIndexBuffer,w.gridSegments];for(const nt of D){const lt=C.getTile(nt),vt=Do.disabled,dt=w.prevTerrainTileForTile[nt.key],ct=w.terrainTileForTile[nt.key];X_(dt,ct)&&Td.newMorphing(nt.key,dt,ct,V,250),q.activeTexture.set(j.TEXTURE0),lt.texture&&lt.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const jt=Td.getMorphValuesForProxy(nt.key),en=jt?1:0;let gn;jt&&(gn={morphing:{srcDemTile:jt.from,dstDemTile:jt.to,phase:o.cw(jt.phase)}});const An=I1(nt.projMatrix,ig(nt.canonical,Le.renderWorldCopies)?Ue/10:Ue,je);if(_e(en),!X)continue;w.setupElevationDraw(lt,X,gn);const Dn=nt.toUnwrapped();ae&&ae.setupShadows(Dn,X),b.uploadCommonUniforms(q,X,Dn,null,be),X.draw(b,Ye,we,vt,Te,Po.backCCW,An,"terrain_raster",w.gridBuffer,et,Xe)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,b=this.proxySourceCache,w=this.proxiedCoords[b.id],C=this._drapedRenderBatches.shift(),D=l.style.order,V=[];let q=0;for(const j of w){const X=b.getTileByID(j.proxyTileKey),ee=b.proxyCachedFBO[j.key]?b.proxyCachedFBO[j.key][r]:void 0,ae=ee!==void 0?b.renderCache[ee]:this.pool[q++],be=ee!==void 0;if(X.texture=ae.tex,be&&!ae.dirty){V.push(X.tileID);continue}let _e;p.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(p.clear({color:o.bA.transparent,stencil:0}),ae.dirty=!1);for(let Te=C.start;Te<=C.end;++Te){const we=l.style._mergedLayers[D[Te]];if(we.isHidden(l.transform.zoom))continue;const Le=l.style.getLayerSourceCache(we),Ue=Le?this.proxyToSource[j.key][Le.id]:[j];if(!Ue)continue;const je=Ue;p.viewport.set([0,0,ae.fb.width,ae.fb.height]),_e!==(Le?Le.id:null)&&(this._setupStencil(ae,Ue,we,Le),_e=Le?Le.id:null),l.renderLayer(l,Le,we,je)}if(this._drapedRenderBatches.length===0)for(const Te of this._pendingGroundEffectLayers){const we=l.style._mergedLayers[D[Te]];if(we.isHidden(l.transform.zoom))continue;const Le=l.style.getLayerSourceCache(we),Ue=Le?this.proxyToSource[j.key][Le.id]:[j];if(!Ue)continue;const je=Ue;p.viewport.set([0,0,ae.fb.width,ae.fb.height]),_e!==(Le?Le.id:null)&&(this._setupStencil(ae,Ue,we,Le),_e=Le?Le.id:null),l.renderLayer(l,Le,we,je)}this.renderedToTile?(ae.dirty=!0,V.push(X.tileID)):be||--q,q===5&&(q=0,this.renderToBackBuffer(V))}return this.renderToBackBuffer(V),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),C.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let p=-1,b=l;for(let w=0;w<l;++w)this._style.isLayerDraped(r._mergedLayers[r.order[w]])?p=Math.max(p,w):b=Math.min(b,w);return b>p}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,p){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const C=w.tileID,D=1<<C.overscaledZ,{x:V,y:q}=C.canonical,j=V/D,X=(V+1)/D,ee=q/D,ae=(q+1)/D;return{minx:j,miny:ee,maxx:X,maxy:ae,t:w.dem.tree.raycastRoot(j,ee,X,ae,r,l,p),tile:w}});b.sort((w,C)=>(w.t!==null?w.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const w of b){if(w.t==null)return null;const C=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,r,l,p);if(C!=null)return C}return null}_createFBO(){const r=this.painter.context,l=r.gl,p=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const b=new o.T(r,{width:p[0],height:p[1],data:null},l.RGBA8);b.bind(l.LINEAR,l.CLAMP_TO_EDGE);const w=r.createFramebuffer(p[0],p[1],!0,null);return w.colorAttachment.set(b.texture),w.depthAttachment=new Sd(r,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:w,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],p=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!p&&l.shouldRedrape():!p&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const p of this._style.getSources())if(p instanceof yr){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const b=this._style._mergedLayers[this._style.order[p]],w=this._style.getLayerSourceCache(b);if(w&&!l[w.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof o.a4){l[w.id]=!0;for(const C of this.proxyCoords){const D=this.proxyToSource[C.key][w.id];if(D)for(const V of D)this._clearRenderCacheForTile(w.id,V)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof rl){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const b=this._style._mergedLayers[this._style.order[p]],w=this._style.getLayerSourceCache(b);if(!w||l[w.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const C=b.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const V=this.proxyToSource[D.key][w.id];if(V)for(const q of V){const j=op(w.getTile(q),w.findLoadedParent(q,0),w,this.painter.transform,C);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(w.id,q)}}}}_setupDrapedRenderBatches(){const r=this._style.order,l=r.length;if(l===0)return;const p=[];this._pendingGroundEffectLayers=[];let b,w=0,C=this._style._mergedLayers[r[w]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++w<l;)C=this._style._mergedLayers[r[w]];for(;w<l;++w){const D=this._style._mergedLayers[r[w]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?b===void 0&&(b=w):(D.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),b!==void 0&&(p.push({start:b,end:w-1}),b=void 0)))}if(b!==void 0&&p.push({start:b,end:w-1}),p.length!==0){const D=p[p.length-1];this._pendingGroundEffectLayers.every(V=>V>D.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const C=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let D=0;D<C.length;++D){const V=Object.values(C[D]);l.renderCachePool.push(...V)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,b=this._tilesDirty;for(let C=p.length-1;C>=0;C--){const D=p[C];if(l.getTileByID(D.key),l.proxyCachedFBO[D.key]!==void 0){const V=r[D.key],q=this.proxyToSource[D.key];let j=0;for(const X in q){const ee=q[X],ae=V[X];if(!ae||ae.length!==ee.length||ee.some((be,_e)=>be!==ae[_e]||b[X]&&b[X].hasOwnProperty(be.key))){j=-1;break}++j}for(const X in l.proxyCachedFBO[D.key])l.renderCache[l.proxyCachedFBO[D.key][X]].dirty=j<0||j!==Object.values(V).length}}const w=[...this._drapedRenderBatches];w.sort((C,D)=>D.end-D.start-(C.end-C.start));for(const C of w)for(const D of p){if(l.proxyCachedFBO[D.key])continue;let V=l.renderCachePool.pop();V===void 0&&l.renderCache.length<50&&(V=l.renderCache.length,l.renderCache.push(this._createFBO())),V!==void 0&&(l.proxyCachedFBO[D.key]={},l.proxyCachedFBO[D.key][C.start]=V,l.renderCache[V].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,p,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,C=w.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let D;if(p.isTileClipped())D=l.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Do.disabled}_renderTileClippingMasks(r,l){const p=this.painter,b=this.painter.context,w=b.gl;p._tileClippingMaskIDs={},b.setColorMode(ir.disabled),b.setDepthMode(bo.disabled);const C=p.getOrCreateProgram("clippingMask");for(const D of r){const V=p._tileClippingMaskIDs[D.key]=--l;C.draw(p,w.TRIANGLES,bo.disabled,new Do({func:w.ALWAYS,mask:0},V,255,w.KEEP,w.KEEP,w.REPLACE),ir.disabled,Po.disabled,$h(D.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const p=[r.x,r.y,1,1];o.a6.vec4.transformMat4(p,p,l.pixelMatrixInverse),o.a6.vec4.scale(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const b=l._camera.position,w=o.bE(1,l.center.lat),C=[b[0],b[1],b[2]/w,0],D=o.a6.vec3.subtract([],p.slice(0,3),C);o.a6.vec3.normalize(D,D);const V=this.raycast(C,D,this._exaggeration);return V!==null&&V?(o.a6.vec3.scaleAndAdd(C,C,D,V),C[3]=C[2],C[2]*=w,C):null}_setupProxiedCoordsForOrtho(r,l,p){if(r.getSource()instanceof o.aD)return this._setupProxiedCoordsForImageSource(r,l,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const b=this.proxiedCoords[r.id]=[],w=this.proxyCoords;for(let V=0;V<w.length;V++){const q=w[V],j=this._findTileCoveringTileID(q,r);if(j){const X=this._createProxiedId(q,j,p[q.key]&&p[q.key][r.id]);b.push(X),this.proxyToSource[q.key][r.id]=[X]}}let C=!1;const D=new Set;for(let V=0;V<l.length;V++){const q=r.getTile(l[V]);if(!q||!q.hasData())continue;const j=this._findTileCoveringTileID(q.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==q.tileID.canonical.z){const X=this.proxyToSource[j.tileID.key][r.id],ee=this._createProxiedId(j.tileID,q,p[j.tileID.key]&&p[j.tileID.key][r.id]);X?X.splice(X.length-1,0,ee):this.proxyToSource[j.tileID.key][r.id]=[ee];const ae=this.proxyToSource[j.tileID.key][r.id];D.has(ae)||D.add(ae),b.push(ee),C=!0}}if(this._sourceTilesOverlap[r.id]=C,C&&this._debugParams.sortTilesHiZFirst)for(const V of D)V.sort((q,j)=>j.overscaledZ-q.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,p){if(!r.getSource().loaded())return;const b=this.proxiedCoords[r.id]=[],w=this.proxyCoords,C=r.getSource(),D=C.tileID;if(!D)return;const V=new o.P(D.x,D.y)._div(1<<D.z),q=C.coordinates.map(o.a5.fromLngLat).reduce((X,ee)=>(X.min.x=Math.min(X.min.x,ee.x-V.x),X.min.y=Math.min(X.min.y,ee.y-V.y),X.max.x=Math.max(X.max.x,ee.x-V.x),X.max.y=Math.max(X.max.y,ee.y-V.y),X),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(X,ee)=>{const ae=X.wrap+X.canonical.x/(1<<X.canonical.z),be=X.canonical.y/(1<<X.canonical.z),_e=o.ab/(1<<X.canonical.z),Te=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),we=ee.canonical.y/(1<<ee.canonical.z);return ae+_e<Te+q.min.x||ae>Te+q.max.x||be+_e<we+q.min.y||be>we+q.max.y};for(let X=0;X<w.length;X++){const ee=w[X];for(let ae=0;ae<l.length;ae++){const be=r.getTile(l[ae]);if(!be||!be.hasData()||j(ee,be.tileID))continue;const _e=this._createProxiedId(ee,be,p[ee.key]&&p[ee.key][r.id]),Te=this.proxyToSource[ee.key][r.id];Te?Te.push(_e):this.proxyToSource[ee.key][r.id]=[_e],b.push(_e)}}}_createProxiedId(r,l,p){let b=this.orthoMatrix;if(p){const w=p.find(C=>C.key===l.tileID.key);if(w)return w}if(l.tileID.key!==r.key){const w=r.canonical.z-l.tileID.canonical.z;let C,D,V;b=o.a6.mat4.create();const q=l.tileID.wrap-r.wrap<<r.overscaledZ;w>0?(C=o.ab>>w,D=C*((l.tileID.canonical.x<<w)-r.canonical.x+q),V=C*((l.tileID.canonical.y<<w)-r.canonical.y)):(C=o.ab<<-w,D=o.ab*(l.tileID.canonical.x-(r.canonical.x+q<<-w)),V=o.ab*(l.tileID.canonical.y-(r.canonical.y<<-w))),o.a6.mat4.ortho(b,0,C,0,C,0,1),o.a6.mat4.translate(b,b,[D,V,0])}return new ag(l.tileID,r.key,b)}_findTileCoveringTileID(r,l){let p=l.getTile(r);if(p&&p.hasData())return p;const b=this._findCoveringTileCache[l.id],w=b[r.key];if(p=w?l.getTileByID(w):null,p&&p.hasData()||w===null)return p;let C=p?p.tileID:r,D=C.overscaledZ;const V=l.getSource().minzoom,q=[];if(!w){const X=l.getSource().maxzoom;if(r.canonical.z>=X){const ee=r.canonical.z-X;l.getSource().reparseOverscaled?(D=Math.max(r.canonical.z+2,l.transform.tileZoom),C=new o.aA(D,r.wrap,X,r.canonical.x>>ee,r.canonical.y>>ee)):ee!==0&&(D=X,C=new o.aA(D,r.wrap,X,r.canonical.x>>ee,r.canonical.y>>ee))}C.key!==r.key&&(q.push(C.key),p=l.getTile(C))}const j=X=>{q.forEach(ee=>{b[ee]=X}),q.length=0};for(D-=1;D>=V&&(!p||!p.hasData());D--){p&&j(p.tileID.key);const X=C.calculateScaledKey(D);if(p=l.getTileByID(X),p&&p.hasData())break;const ee=b[X];if(ee===null)break;ee===void 0?q.push(X):p=l.getTileByID(ee)}return j(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[l.key]=!0}}function lg(f,r,l){const p=function(D,V,q){const j=o.a6.vec3.dot(V,D),X=o.a6.vec3.dot(q,[.2126,.7152,.0722]),ee=(be,_e,Te)=>(1-Te)*be+Te*_e,ae=ee(1-.3*Math.min(X,1),1,Math.min(j+1,1));return ee(.92,1,Math.asin(o.ap(V[2],-1,1))/Math.PI+.5)*ae}(f,[0,0,1],r),b=[0,0,0];o.a6.vec3.scale(b,l.slice(0,3),p);const w=[0,0,0];o.a6.vec3.scale(w,r.slice(0,3),f[2]);const C=[0,0,0];return o.a6.vec3.add(C,b,w),o.cc(C)}const Du=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],ty=["stars","rain_particle","snow_particle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class wc{static cacheKey(r,l,p,b){let w=`${l}${b?b.cacheKey:""}`;for(const C of p)r.usedDefines.includes(C)&&(w+=`/${C}`);return w}constructor(r,l,p,b,w,C){const D=r.gl;this.program=D.createProgram(),this.configuration=b,this.name=l,this.fixedDefines=[...C];const V=b?b.getBinderAttributes():[],q=(p.staticAttributes||[]).concat(V);let j=b?b.defines():[];j=j.concat(C.map(Te=>`#define ${Te}`));const X=`#version 300 es
`;let ee=X+j.concat("precision mediump float;",ul,Ll.fragmentSource).join(`
`);for(const Te of p.fragmentIncludes)ee+=`
${Na[Te]}`;ee+=`
${p.fragmentSource}`;let ae=X+j.concat("precision highp float;",ul,Ll.vertexSource).join(`
`);for(const Te of p.vertexIncludes)ae+=`
${Na[Te]}`;ae+=`
${p.vertexSource}`;const be=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(be,ee),D.compileShader(be),D.attachShader(this.program,be);const _e=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(_e,ae),D.compileShader(_e),D.attachShader(this.program,_e),this.attributes={},this.numAttributes=q.length;for(let Te=0;Te<this.numAttributes;Te++)if(q[Te]){const we=q[Te].startsWith("a_")?q[Te]:`a_${q[Te]}`;D.bindAttribLocation(this.program,Te,we),this.attributes[we]=Te}D.linkProgram(this.program),D.deleteShader(_e),D.deleteShader(be),this.fixedUniforms=w(r),this.binderUniforms=b?b.getUniforms(r):[],(C.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(Te=>({u_dem:new o.bK(Te),u_dem_prev:new o.bK(Te),u_dem_tl:new o.bH(Te),u_dem_scale:new o.bJ(Te),u_dem_tl_prev:new o.bH(Te),u_dem_scale_prev:new o.bJ(Te),u_dem_size:new o.bJ(Te),u_dem_lerp:new o.bJ(Te),u_exaggeration:new o.bJ(Te),u_depth:new o.bK(Te),u_depth_size_inv:new o.bH(Te),u_depth_range_unpack:new o.bH(Te),u_occluder_half_size:new o.bJ(Te),u_occlusion_depth_offset:new o.bJ(Te),u_meter_to_dem:new o.bJ(Te),u_label_plane_matrix_inv:new o.bG(Te)}))(r)),C.includes("GLOBE")&&(this.globeUniforms=(Te=>({u_tile_tl_up:new o.bI(Te),u_tile_tr_up:new o.bI(Te),u_tile_br_up:new o.bI(Te),u_tile_bl_up:new o.bI(Te),u_tile_up_scale:new o.bJ(Te)}))(r)),C.includes("FOG")&&(this.fogUniforms=(Te=>({u_fog_matrix:new o.bG(Te),u_fog_range:new o.bH(Te),u_fog_color:new o.c7(Te),u_fog_horizon_blend:new o.bJ(Te),u_fog_vertical_limit:new o.bH(Te),u_fog_temporal_offset:new o.bJ(Te),u_frustum_tl:new o.bI(Te),u_frustum_tr:new o.bI(Te),u_frustum_br:new o.bI(Te),u_frustum_bl:new o.bI(Te),u_globe_pos:new o.bI(Te),u_globe_radius:new o.bJ(Te),u_globe_transition:new o.bJ(Te),u_is_globe:new o.bK(Te),u_viewport:new o.bH(Te)}))(r)),C.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Te=>({u_cutoff_params:new o.c7(Te)}))(r)),C.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Te=>({u_lighting_ambient_color:new o.bI(Te),u_lighting_directional_dir:new o.bI(Te),u_lighting_directional_color:new o.bI(Te),u_ground_radiance:new o.bI(Te)}))(r)),C.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Te=>({u_light_matrix_0:new o.bG(Te),u_light_matrix_1:new o.bG(Te),u_fade_range:new o.bH(Te),u_shadow_normal_offset:new o.bI(Te),u_shadow_intensity:new o.bJ(Te),u_shadow_texel_size:new o.bJ(Te),u_shadow_map_resolution:new o.bJ(Te),u_shadow_direction:new o.bI(Te),u_shadow_bias:new o.bI(Te),u_shadowmap_0:new o.bK(Te),u_shadowmap_1:new o.bK(Te)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b]&&p[b].set(this.program,b,l[b])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b]&&p[b].set(this.program,b,l[b])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}_drawDebugWireframe(r,l,p,b,w,C,D,V,q,j){const X=r.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const ee=r.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||r._terrain&&r._terrain.renderingToTexture||!Du.includes(this.name))||!(!X.layers3D||!ty.includes(this.name))))return;const ae=ee.gl,be=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,w,ee);if(!be)return;const _e=[...this.fixedDefines];_e.push("DEBUG_WIREFRAME");const Te=r.getOrCreateProgram(this.name,{config:this.configuration,defines:_e});ee.program.set(Te.program);const we=(je,Ye,et)=>{if(Ye[je]&&et[je])for(const Xe in Ye[je])et[je][Xe]&&et[je][Xe].set(et.program,Xe,Ye[je][Xe].current)};q&&q.setUniforms(Te.program,ee,Te.binderUniforms,D,{zoom:V}),we("fixedUniforms",this,Te),we("terrainUniforms",this,Te),we("globeUniforms",this,Te),we("fogUniforms",this,Te),we("lightsUniforms",this,Te),we("shadowUniforms",this,Te),be.bind(),ee.setColorMode(new ir([ae.ONE,ae.ONE_MINUS_SRC_ALPHA,ae.ZERO,ae.ONE],o.bA.transparent,[!0,!0,!0,!1])),ee.setDepthMode(new bo(l.func===ae.LESS?ae.LEQUAL:l.func,bo.ReadOnly,l.range)),ee.setStencilMode(Do.disabled);const Le=3*C.primitiveLength*2,Ue=3*C.primitiveOffset*2*2;j&&j>1?ae.drawElementsInstanced(ae.LINES,Le,ae.UNSIGNED_SHORT,Ue,j):ae.drawElements(ae.LINES,Le,ae.UNSIGNED_SHORT,Ue),w.bind(),ee.program.set(this.program),ee.setDepthMode(l),ee.setStencilMode(p),ee.setColorMode(b)}checkUniforms(r,l,p){if(this.fixedDefines.includes(l)){for(const b of Object.keys(p))if(!p[b].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${b} not set but required by ${l} being defined`)}}draw(r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te){const we=r.context,Le=we.gl;if(this.failedToCreate)return;we.program.set(this.program),we.setDepthMode(p),we.setStencilMode(b),we.setColorMode(w),we.setCullFace(C);for(const Ye of Object.keys(this.fixedUniforms))this.fixedUniforms[Ye].set(this.program,Ye,D[Ye]);be&&be.setUniforms(this.program,we,this.binderUniforms,ee,{zoom:ae});const Ue={[Le.POINTS]:1,[Le.LINES]:2,[Le.TRIANGLES]:3,[Le.LINE_STRIP]:1}[l];this.checkUniforms(V,"RENDER_SHADOWS",this.shadowUniforms);const je=Te&&Te>0?1:void 0;for(const Ye of X.get()){const et=Ye.vaos||(Ye.vaos={});(et[V]||(et[V]=new su)).bind(we,this,q,be?be.getPaintVertexBuffers():[],j,Ye.vertexOffset,_e||[],je),Te&&Te>1?Le.drawElementsInstanced(l,Ye.primitiveLength*Ue,Le.UNSIGNED_SHORT,Ye.primitiveOffset*Ue*2,Te):j?Le.drawElements(l,Ye.primitiveLength*Ue,Le.UNSIGNED_SHORT,Ye.primitiveOffset*Ue*2):Le.drawArrays(l,Ye.vertexOffset,Ye.vertexLength),l===Le.TRIANGLES&&j&&this._drawDebugWireframe(r,p,b,w,j,Ye,ee,ae,be,Te)}}}function rp(f,r){const l=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,f.transform.tileZoom)/l,b=p*(r.tileID.canonical.x+r.tileID.wrap*l),w=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ak(r,1,f.transform.tileZoom),u_pixel_coord_upper:[b>>16,w>>16],u_pixel_coord_lower:[65535&b,65535&w]}}const zu={terrain:0,flat:1},ny=o.a6.mat4.create(),cg=(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te,we)=>{const Le=r.style.light,Ue=Le.properties.get("position"),je=[Ue.x,Ue.y,Ue.z],Ye=o.a6.mat3.create();Le.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(Ye,-r.transform.angle),o.a6.vec3.transformMat3(je,je,Ye));const et=Le.properties.get("color"),Xe=r.transform,nt={u_matrix:f,u_lightpos:je,u_lightintensity:Le.properties.get("intensity"),u_lightcolor:[et.r,et.g,et.b],u_vertical_gradient:+l,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ny,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:zu[q],u_base_type:zu[j],u_ao:b,u_edge_radius:w,u_width_scale:C,u_flood_light_color:be,u_vertical_scale:_e,u_flood_light_intensity:Te,u_ground_shadow_factor:we};return Xe.projection.name==="globe"&&(nt.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],nt.u_zoom_transition=X,nt.u_inv_rot_matrix=ae,nt.u_merc_center=ee,nt.u_up_dir=Xe.projection.upVector(new o.bQ(0,0,0),ee[0]*o.ab,ee[1]*o.ab),nt.u_height_lift=V),nt},ug=(f,r,l,p,b,w)=>({u_matrix:f,u_edge_radius:r,u_width_scale:l,u_vertical_scale:p,u_height_type:zu[b],u_base_type:zu[w]}),dg=(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te)=>{const we=cg(f,r,l,p,b,w,C,D,q,j,X,ee,ae,be,_e,Te,1,[0,0,0]),Le={u_height_factor:-Math.pow(2,D.overscaledZ)/V.tileSize/8};return o.l(we,rp(r,V),Le)},oy=(f,r)=>({u_matrix:f,u_emissive_strength:r}),hg=(f,r,l,p)=>o.l(oy(f,r),rp(l,p)),Vh=(f,r,l)=>({u_matrix:f,u_world:l,u_emissive_strength:r}),A1=(f,r,l,p,b)=>o.l(hg(f,r,l,p),{u_world:b}),k1=(f,r,l,p)=>{const b=o.ab/l.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/b,r.pixelsToGLUnits[1]/b]}},fg=(f,r,l=1)=>({u_matrix:f,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),P1=o.a6.mat4.create(),pg=(f,r,l,p,b,w,C)=>{const D=f.transform,V=D.projection.name==="globe",q=V?o.cI(D.zoom,r.canonical)*D._pixelsPerMercatorPixel:o.ak(l,1,w),j={u_matrix:r.projMatrix,u_extrude_scale:q,u_intensity:C,u_inv_rot_matrix:P1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(V){j.u_inv_rot_matrix=p,j.u_merc_center=b,j.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],j.u_zoom_transition=o.a9(D.zoom);const X=b[0]*o.ab,ee=b[1]*o.ab;j.u_up_dir=D.projection.upVector(new o.bQ(0,0,0),X,ee)}return j};function ip(f,[r,l,p,b],[w,C]){if(w===C)return[0,0,0,0];const D=255*(f-1)/(f*(C-w));return[r*D,l*D,p*D,b*D]}function Ed(f,r,[l,p]){return l===p?0:.5/f+(r-l)*(f-1)/(f*(p-l))}const ap=(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te,we,Le,Ue,je)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:b,u_tl_parent:w,u_scale_parent:q,u_fade_t:j.mix,u_opacity:j.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:o.cJ(X.paint.get("raster-saturation")),u_contrast_factor:o.cK(X.paint.get("raster-contrast")),u_spin_weights:Uh(X.paint.get("raster-hue-rotate")),u_perspective_transform:ee,u_raster_elevation:ae,u_zoom_transition:C,u_merc_center:D,u_cutoff_params:V,u_colorization_mix:ip(o.cL,_e,we),u_colorization_offset:Ed(o.cL,Te,we),u_color_ramp:be,u_texture_offset:[Ue/(Le+2*Ue),Le/(Le+2*Ue)],u_texture_res:[Le+2*Ue,Le+2*Ue],u_emissive_strength:je});function Uh(f){f*=Math.PI/180;const r=Math.sin(f),l=Math.cos(f);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const Fu=.05,sp=(f,r,l,p,b,w,C,D,V,q,j,X)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:b,u_tl_parent:w,u_scale_parent:q,u_fade_t:j.mix,u_opacity:j.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:C,u_merc_center:D,u_cutoff_params:V}),lp=(f,r,l,p,b,w,C,D,V,q)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:p,u_color_ramp:w,u_velocity_res:b,u_max_speed:C,u_uv_offset:D,u_data_scale:[255*V[0],255*V[1]],u_data_offset:q,u_particle_pos_scale:1.1,u_particle_pos_offset:[Fu,Fu]}),mg=(f,r,l,p,b,w,C,D,V,q)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:p,u_max_speed:b,u_speed_factor:w,u_reset_rate:C,u_rand_seed:Math.random(),u_uv_offset:D,u_data_scale:[255*V[0],255*V[1]],u_data_offset:q,u_particle_pos_scale:1.1,u_particle_pos_offset:[Fu,Fu]}),gg=o.a6.mat4.create(),ry=(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te,we,Le,Ue,je,Ye)=>{const et=b.transform,Xe={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:et.getCameraToCenterDistance(Le),u_rotate_symbol:+l,u_aspect_ratio:et.width/et.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:C,u_coord_matrix:D,u_is_text:+q,u_elevation_from_sea:V?1:0,u_pitch_with_map:+p,u_texsize:j,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gg,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:gg,u_up_vector:[0,-1,0],u_color_adj_mat:Ue,u_icon_transition:je||0,u_gamma_scale:p?b.transform.getCameraToCenterDistance(Le)*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:o.q.devicePixelRatio,u_is_halo:+ee,u_scale_factor:Ye||1};return Le.name==="globe"&&(Xe.u_tile_id=[ae.canonical.x,ae.canonical.y,1<<ae.canonical.z],Xe.u_zoom_transition=be,Xe.u_inv_rot_matrix=Te,Xe.u_merc_center=_e,Xe.u_camera_forward=et._camera.forward(),Xe.u_ecef_origin=o.cM(et.globeMatrix,ae.toUnwrapped()),Xe.u_tile_matrix=Float32Array.from(et.globeMatrix),Xe.u_up_vector=we),Xe},Bu=(f,r,l,p)=>({u_matrix:f,u_emissive_strength:r,u_opacity:l,u_color:p}),jh=(f,r,l,p,b,w,C,D,V)=>o.l(function(q,j,X,ee,ae,be){const{width:_e,height:Te}=ee.imageManager.getPixelSize(j),we=Math.pow(2,be.tileID.overscaledZ),Le=be.tileSize*Math.pow(2,ee.transform.tileZoom)/we,Ue=Le*(be.tileID.canonical.x+be.tileID.wrap*we),je=Le*be.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[_e,Te],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:ae?[ee.transform.width,-1*ee.transform.height]:[1/o.ak(be,1,ee.transform.tileZoom),1/o.ak(be,1,ee.transform.tileZoom)],u_pixel_coord_upper:[Ue>>16,je>>16],u_pixel_coord_lower:[65535&Ue,65535&je]}}(0,w,C,p,D,V),{u_matrix:f,u_emissive_strength:r,u_opacity:l}),no=new Float32Array(o.a6.mat4.identity([])),cp=(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae=[0,0,0],be)=>{const _e=b.style.light,Te=_e.properties.get("position"),we=[-Te.x,-Te.y,Te.z],Le=o.a6.mat3.create();_e.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(Le,-b.transform.angle),o.a6.vec3.transformMat3(we,we,Le));const Ue=j.alphaMode==="MASK",je=_e.properties.get("color").toRenderColor(null),Ye=ee.paint.get("model-ambient-occlusion-intensity"),et=ee.paint.get("model-color").constantOr(o.bA.white).toRenderColor(null),Xe=ee.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:p||no,u_lightpos:we,u_lightintensity:_e.properties.get("intensity"),u_lightcolor:[je.r,je.g,je.b],u_camera_pos:ae,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+Ue,u_alphaCutoff:j.alphaCutoff,u_baseColorFactor:[C.r,C.g,C.b,C.a],u_emissiveFactor:[D[0],D[1],D[2],1],u_metallicFactor:V,u_roughnessFactor:q,u_baseColorTexture:ua.BaseColor,u_metallicRoughnessTexture:ua.MetallicRoughness,u_normalTexture:ua.Normal,u_occlusionTexture:ua.Occlusion,u_emissionTexture:ua.Emission,u_lutTexture:ua.LUT,u_color_mix:[et.r,et.g,et.b,Xe],u_aoIntensity:Ye,u_emissive_strength:X,u_occlusionTextureTransform:be||[0,0,0,0]}},vg=(f,r=no,l=no)=>({u_matrix:f,u_instance:r,u_node_matrix:l}),Nu={fillExtrusion:f=>({u_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_vertical_gradient:new o.bJ(f),u_opacity:new o.bJ(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_ao:new o.bH(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_up_dir:new o.bI(f),u_height_lift:new o.bJ(f),u_flood_light_color:new o.bI(f),u_vertical_scale:new o.bJ(f),u_flood_light_intensity:new o.bJ(f),u_ground_shadow_factor:new o.bI(f)}),fillExtrusionDepth:f=>({u_matrix:new o.bG(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_vertical_scale:new o.bJ(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f)}),fillExtrusionPattern:f=>({u_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_vertical_gradient:new o.bJ(f),u_height_factor:new o.bJ(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_ao:new o.bH(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_up_dir:new o.bI(f),u_height_lift:new o.bJ(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f),u_opacity:new o.bJ(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new o.bG(f),u_opacity:new o.bJ(f),u_ao_pass:new o.bJ(f),u_meter_to_tile:new o.bJ(f),u_ao:new o.bH(f),u_flood_light_intensity:new o.bJ(f),u_flood_light_color:new o.bI(f),u_attenuation:new o.bJ(f),u_edge_radius:new o.bJ(f),u_fb:new o.bK(f),u_fb_size:new o.bJ(f),u_dynamic_offset:new o.bJ(f)}),fill:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f)}),fillPattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f)}),fillOutline:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_world:new o.bH(f)}),fillOutlinePattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_world:new o.bH(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f)}),circle:o.cN,collisionBox:f=>({u_matrix:new o.bG(f),u_camera_to_center_distance:new o.bJ(f),u_extrude_scale:new o.bH(f)}),collisionCircle:f=>({u_matrix:new o.bG(f),u_inv_matrix:new o.bG(f),u_camera_to_center_distance:new o.bJ(f),u_viewport_size:new o.bH(f)}),debug:f=>({u_color:new o.cu(f),u_matrix:new o.bG(f),u_overlay:new o.bK(f),u_overlay_scale:new o.bJ(f)}),clippingMask:f=>({u_matrix:new o.bG(f)}),heatmap:f=>({u_extrude_scale:new o.bJ(f),u_intensity:new o.bJ(f),u_matrix:new o.bG(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_up_dir:new o.bI(f)}),heatmapTexture:f=>({u_image:new o.bK(f),u_color_ramp:new o.bK(f),u_opacity:new o.bJ(f)}),hillshade:f=>({u_matrix:new o.bG(f),u_image:new o.bK(f),u_latrange:new o.bH(f),u_light:new o.bH(f),u_shadow:new o.cu(f),u_highlight:new o.cu(f),u_emissive_strength:new o.bJ(f),u_accent:new o.cu(f)}),hillshadePrepare:f=>({u_matrix:new o.bG(f),u_image:new o.bK(f),u_dimension:new o.bH(f),u_zoom:new o.bJ(f)}),line:o.cO,linePattern:o.cP,raster:f=>({u_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bH(f),u_scale_parent:new o.bJ(f),u_fade_t:new o.bJ(f),u_opacity:new o.bJ(f),u_image0:new o.bK(f),u_image1:new o.bK(f),u_brightness_low:new o.bJ(f),u_brightness_high:new o.bJ(f),u_saturation_factor:new o.bJ(f),u_contrast_factor:new o.bJ(f),u_spin_weights:new o.bI(f),u_perspective_transform:new o.bH(f),u_raster_elevation:new o.bJ(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_cutoff_params:new o.c7(f),u_colorization_mix:new o.c7(f),u_colorization_offset:new o.bJ(f),u_color_ramp:new o.bK(f),u_texture_offset:new o.bH(f),u_texture_res:new o.bH(f),u_emissive_strength:new o.bJ(f)}),rasterParticle:f=>({u_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bH(f),u_scale_parent:new o.bJ(f),u_fade_t:new o.bJ(f),u_opacity:new o.bJ(f),u_image0:new o.bK(f),u_image1:new o.bK(f),u_raster_elevation:new o.bJ(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_cutoff_params:new o.c7(f)}),rasterParticleTexture:f=>({u_texture:new o.bK(f),u_opacity:new o.bJ(f)}),rasterParticleDraw:f=>({u_particle_texture:new o.bK(f),u_particle_texture_side_len:new o.bJ(f),u_tile_offset:new o.bH(f),u_velocity:new o.bK(f),u_color_ramp:new o.bK(f),u_velocity_res:new o.bH(f),u_max_speed:new o.bJ(f),u_uv_offset:new o.bH(f),u_data_scale:new o.bH(f),u_data_offset:new o.bJ(f),u_particle_pos_scale:new o.bJ(f),u_particle_pos_offset:new o.bH(f)}),rasterParticleUpdate:f=>({u_particle_texture:new o.bK(f),u_particle_texture_side_len:new o.bJ(f),u_velocity:new o.bK(f),u_velocity_res:new o.bH(f),u_max_speed:new o.bJ(f),u_speed_factor:new o.bJ(f),u_reset_rate:new o.bJ(f),u_rand_seed:new o.bJ(f),u_uv_offset:new o.bH(f),u_data_scale:new o.bH(f),u_data_offset:new o.bJ(f),u_particle_pos_scale:new o.bJ(f),u_particle_pos_offset:new o.bH(f)}),symbol:f=>({u_is_size_zoom_constant:new o.bK(f),u_is_size_feature_constant:new o.bK(f),u_size_t:new o.bJ(f),u_size:new o.bJ(f),u_camera_to_center_distance:new o.bJ(f),u_rotate_symbol:new o.bK(f),u_aspect_ratio:new o.bJ(f),u_fade_change:new o.bJ(f),u_matrix:new o.bG(f),u_label_plane_matrix:new o.bG(f),u_coord_matrix:new o.bG(f),u_is_text:new o.bK(f),u_elevation_from_sea:new o.bK(f),u_pitch_with_map:new o.bK(f),u_texsize:new o.bH(f),u_texsize_icon:new o.bH(f),u_texture:new o.bK(f),u_texture_icon:new o.bK(f),u_gamma_scale:new o.bJ(f),u_device_pixel_ratio:new o.bJ(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_camera_forward:new o.bI(f),u_tile_matrix:new o.bG(f),u_up_vector:new o.bI(f),u_ecef_origin:new o.bI(f),u_is_halo:new o.bK(f),u_icon_transition:new o.bJ(f),u_color_adj_mat:new o.bG(f),u_scale_factor:new o.bJ(f)}),background:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_opacity:new o.bJ(f),u_color:new o.cu(f)}),backgroundPattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_opacity:new o.bJ(f),u_image:new o.bK(f),u_pattern_tl:new o.bH(f),u_pattern_br:new o.bH(f),u_texsize:new o.bH(f),u_pattern_size:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_pattern_units_to_pixels:new o.bH(f)}),terrainRaster:f=>({u_matrix:new o.bG(f),u_image0:new o.bK(f),u_skirt_height:new o.bJ(f),u_ground_shadow_factor:new o.bI(f)}),skybox:f=>({u_matrix:new o.bG(f),u_sun_direction:new o.bI(f),u_cubemap:new o.bK(f),u_opacity:new o.bJ(f),u_temporal_offset:new o.bJ(f)}),skyboxGradient:f=>({u_matrix:new o.bG(f),u_color_ramp:new o.bK(f),u_center_direction:new o.bI(f),u_radius:new o.bJ(f),u_opacity:new o.bJ(f),u_temporal_offset:new o.bJ(f)}),skyboxCapture:f=>({u_matrix_3f:new o.cv(f),u_sun_direction:new o.bI(f),u_sun_intensity:new o.bJ(f),u_color_tint_r:new o.c7(f),u_color_tint_m:new o.c7(f),u_luminance:new o.bJ(f)}),globeRaster:f=>({u_proj_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_image0:new o.bK(f),u_grid_matrix:new o.cv(f),u_skirt_height:new o.bJ(f),u_far_z_cutoff:new o.bJ(f),u_frustum_tl:new o.bI(f),u_frustum_tr:new o.bI(f),u_frustum_br:new o.bI(f),u_frustum_bl:new o.bI(f),u_globe_pos:new o.bI(f),u_globe_radius:new o.bJ(f),u_viewport:new o.bH(f)}),globeAtmosphere:f=>({u_frustum_tl:new o.bI(f),u_frustum_tr:new o.bI(f),u_frustum_br:new o.bI(f),u_frustum_bl:new o.bI(f),u_horizon:new o.bJ(f),u_transition:new o.bJ(f),u_fadeout_range:new o.bJ(f),u_color:new o.c7(f),u_high_color:new o.c7(f),u_space_color:new o.c7(f),u_temporal_offset:new o.bJ(f),u_horizon_angle:new o.bJ(f)}),model:f=>({u_matrix:new o.bG(f),u_lighting_matrix:new o.bG(f),u_normal_matrix:new o.bG(f),u_node_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_camera_pos:new o.bI(f),u_opacity:new o.bJ(f),u_baseColorFactor:new o.c7(f),u_emissiveFactor:new o.c7(f),u_metallicFactor:new o.bJ(f),u_roughnessFactor:new o.bJ(f),u_baseTextureIsAlpha:new o.bK(f),u_alphaMask:new o.bK(f),u_alphaCutoff:new o.bJ(f),u_baseColorTexture:new o.bK(f),u_metallicRoughnessTexture:new o.bK(f),u_normalTexture:new o.bK(f),u_occlusionTexture:new o.bK(f),u_emissionTexture:new o.bK(f),u_lutTexture:new o.bK(f),u_color_mix:new o.c7(f),u_aoIntensity:new o.bJ(f),u_emissive_strength:new o.bJ(f),u_occlusionTextureTransform:new o.c7(f)}),modelDepth:f=>({u_matrix:new o.bG(f),u_instance:new o.bG(f),u_node_matrix:new o.bG(f)}),groundShadow:f=>({u_matrix:new o.bG(f),u_ground_shadow_factor:new o.bI(f)}),stars:f=>({u_matrix:new o.bG(f),u_up:new o.bI(f),u_right:new o.bI(f),u_intensity_multiplier:new o.bJ(f)}),snowParticle:f=>({u_modelview:new o.bG(f),u_projection:new o.bG(f),u_time:new o.bJ(f),u_cam_pos:new o.bI(f),u_velocityConeAperture:new o.bJ(f),u_velocity:new o.bJ(f),u_horizontalOscillationRadius:new o.bJ(f),u_horizontalOscillationRate:new o.bJ(f),u_boxSize:new o.bJ(f),u_billboardSize:new o.bJ(f),u_simpleShapeParameters:new o.bH(f),u_screenSize:new o.bH(f),u_thinningCenterPos:new o.bH(f),u_thinningShape:new o.bI(f),u_thinningAffectedRatio:new o.bJ(f),u_thinningParticleOffset:new o.bJ(f),u_particleColor:new o.c7(f),u_direction:new o.bI(f)}),rainParticle:f=>({u_modelview:new o.bG(f),u_projection:new o.bG(f),u_time:new o.bJ(f),u_cam_pos:new o.bI(f),u_texScreen:new o.bK(f),u_velocityConeAperture:new o.bJ(f),u_velocity:new o.bJ(f),u_boxSize:new o.bJ(f),u_rainDropletSize:new o.bH(f),u_distortionStrength:new o.bJ(f),u_rainDirection:new o.bI(f),u_color:new o.c7(f),u_screenSize:new o.bH(f),u_thinningCenterPos:new o.bH(f),u_thinningShape:new o.bI(f),u_thinningAffectedRatio:new o.bJ(f),u_thinningParticleOffset:new o.bJ(f),u_shapeDirectionalPower:new o.bJ(f),u_mode:new o.bJ(f)}),occlusion:f=>({u_matrix:new o.bG(f),u_anchorPos:new o.bI(f),u_screenSizePx:new o.bH(f),u_occluderSizePx:new o.bH(f),u_color:new o.c7(f)})};class os{constructor(r,l,p,b){this.id=os.uniqueIdxCounter,os.uniqueIdxCounter++,this.context=r;const w=r.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||b||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=os.uniqueIdxCounter,os.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}os.uniqueIdxCounter=0;const go={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _g{constructor(r,l,p,b,w,C){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=b,this.instanceCount=C,this.context=r;const D=r.gl;this.buffer=D.createBuffer(),r.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||w||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let p=0;p<this.attributes.length;p++){const b=l.attributes[this.attributes[p].name];b!==void 0&&r.enableVertexAttribArray(b)}}setVertexAttribPointers(r,l,p){for(let b=0;b<this.attributes.length;b++){const w=this.attributes[b],C=l.attributes[w.name];C!==void 0&&r.vertexAttribPointer(C,w.components,r[go[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(r,l,p){for(let b=0;b<this.attributes.length;b++){const w=l.attributes[this.attributes[b].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(w,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class iy{constructor(r,l,p,b,w){this.context=r,this.width=l,this.height=p;const C=this.framebuffer=r.gl.createFramebuffer();b&&(this.colorAttachment=new np(r,C)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new rg(r,C):new Z_(r,C))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class R1{constructor(r,l){this.gl=r,this.clearColor=new Pa(this),this.clearDepth=new Ws(this),this.clearStencil=new qs(this),this.colorMask=new zl(this),this.depthMask=new Fl(this),this.stencilMask=new xc(this),this.stencilFunc=new Bl(this),this.stencilOp=new zh(this),this.stencilTest=new hl(this),this.depthRange=new bd(this),this.depthTest=new xd(this),this.depthFunc=new wd(this),this.blend=new Jf(this),this.blendFunc=new lu(this),this.blendColor=new cu(this),this.blendEquation=new Jm(this),this.cullFace=new Qm(this),this.cullFaceSide=new W_(this),this.frontFace=new q_(this),this.program=new M1(this),this.activeTexture=new Fh(this),this.viewport=new Bh(this),this.bindFramebuffer=new K_(this),this.bindRenderbuffer=new xs(this),this.bindTexture=new eg(this),this.bindVertexBuffer=new Qf(this),this.bindElementBuffer=new ep(this),this.bindVertexArrayOES=new tg(this),this.pixelStoreUnpack=new ng(this),this.pixelStoreUnpackPremultiplyAlpha=new tp(this),this.pixelStoreUnpackFlipY=new og(this),this.options=l?{...l}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,p){return new os(this,r,l,p)}createVertexBuffer(r,l,p,b,w){return new _g(this,r,l,p,b,w)}createRenderbuffer(r,l,p){const b=this.gl,w=b.createRenderbuffer();return this.bindRenderbuffer.set(w),b.renderbufferStorage(b.RENDERBUFFER,r,l,p),this.bindRenderbuffer.set(null),w}createFramebuffer(r,l,p,b){return new iy(this,r,l,p,b)}clear({color:r,depth:l,stencil:p,colorMask:b}){const w=this.gl;let C=0;r&&(C|=w.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(b||[!0,!0,!0,!0])),l!==void 0&&(C|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(C|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),w.clear(C)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.bi(r.blendFunction,ir.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Md;function yg(f,r,l,p,b,w,C){const D=f.context,V=D.gl,q=f.transform,j=f.getOrCreateProgram("collisionBox"),X=[];let ee=0,ae=0;for(let je=0;je<p.length;je++){const Ye=p[je],et=r.getTile(Ye),Xe=et.getBucket(l);if(!Xe)continue;const nt=Zf(Ye,Xe,q);let lt=nt;b[0]===0&&b[1]===0||(lt=f.translatePosMatrix(nt,et,b,w));const vt=C?Xe.textCollisionBox:Xe.iconCollisionBox,dt=Xe.collisionCircleArray;if(dt.length>0){const ct=o.a6.mat4.create(),jt=lt;o.a6.mat4.mul(ct,Xe.placementInvProjMatrix,q.glCoordMatrix),o.a6.mat4.mul(ct,ct,Xe.placementViewportMatrix),X.push({circleArray:dt,circleOffset:ae,transform:jt,invTransform:ct,projection:Xe.getProjection()}),ee+=dt.length/4,ae=ee}vt&&(f.terrain&&f.terrain.setupElevationDraw(et,j),j.draw(f,V.LINES,bo.disabled,Do.disabled,f.colorModeForRenderPass(),Po.disabled,k1(lt,q,et,Xe.getProjection()),l.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,null,q.zoom,null,[vt.collisionVertexBuffer,vt.collisionVertexBufferExt]))}if(!C||!X.length)return;const be=f.getOrCreateProgram("collisionCircle"),_e=new o.cQ;_e.resize(4*ee),_e._trim();let Te=0;for(const je of X)for(let Ye=0;Ye<je.circleArray.length/4;Ye++){const et=4*Ye,Xe=je.circleArray[et+0],nt=je.circleArray[et+1],lt=je.circleArray[et+2],vt=je.circleArray[et+3];_e.emplace(Te++,Xe,nt,lt,vt,0),_e.emplace(Te++,Xe,nt,lt,vt,1),_e.emplace(Te++,Xe,nt,lt,vt,2),_e.emplace(Te++,Xe,nt,lt,vt,3)}(!Md||Md.length<2*ee)&&(Md=function(je){const Ye=2*je,et=new o.aP;et.resize(Ye),et._trim();for(let Xe=0;Xe<Ye;Xe++){const nt=6*Xe;et.uint16[nt+0]=4*Xe+0,et.uint16[nt+1]=4*Xe+1,et.uint16[nt+2]=4*Xe+2,et.uint16[nt+3]=4*Xe+2,et.uint16[nt+4]=4*Xe+3,et.uint16[nt+5]=4*Xe+0}return et}(ee));const we=D.createIndexBuffer(Md,!0),Le=D.createVertexBuffer(_e,o.cR.members,!0);for(const je of X){const Ye={u_matrix:je.transform,u_inv_matrix:je.invTransform,u_camera_to_center_distance:(Ue=q).getCameraToCenterDistance(je.projection),u_viewport_size:[Ue.width,Ue.height]};be.draw(f,V.TRIANGLES,bo.disabled,Do.disabled,f.colorModeForRenderPass(),Po.disabled,Ye,l.id,Le,we,o.b2.simpleSegment(0,2*je.circleOffset,je.circleArray.length,je.circleArray.length/2),null,q.zoom)}var Ue;Le.destroy(),we.destroy()}const Hh=o.a6.mat4.create();function ay(f){const r=f._camera.getWorldToCamera(f.worldSize,1),l=o.a6.mat4.multiply([],r,f.globeMatrix);o.a6.mat4.invert(l,l);const p=[0,0,0],b=[0,1,0,0];return o.a6.vec4.transformMat4(b,b,l),p[0]=b[0],p[1]=b[1],p[2]=b[2],o.a6.vec3.normalize(p,p),p}function O1({width:f,height:r,anchor:l,textOffset:p,textScale:b},w){const{horizontalAlign:C,verticalAlign:D}=o.by(l),V=-(C-.5)*f,q=-(D-.5)*r,j=o.bx(l,p);return new o.P((V/b+j[0])*w,(q/b+j[1])*w)}function bg(f,r,l,p,b,w,C,D,V,q,j){const X=f.text.placedSymbolArray,ee=f.text.dynamicLayoutVertexArray,ae=f.icon.dynamicLayoutVertexArray,be={},_e=f.getProjection(),Te=El(D,_e,w),we=w.elevation,Le=_e.upVectorScale(D.canonical,w.center.lat,w.worldSize).metersToTile;ee.clear();for(let Ue=0;Ue<X.length;Ue++){const je=X.get(Ue),{tileAnchorX:Ye,tileAnchorY:et,numGlyphs:Xe}=je,nt=je.hidden||!je.crossTileID||f.allowVerticalPlacement&&!je.placedOrientation?null:p[je.crossTileID];if(nt){let lt=0,vt=0,dt=0;if(we){const Xt=we?we.getAtTileOffset(D,Ye,et):0,[mn,xn,hn]=_e.upVector(D.canonical,Ye,et);lt=Xt*mn*Le,vt=Xt*xn*Le,dt=Xt*hn*Le}let[ct,jt,en,gn]=sa(je.projectedAnchorX+lt,je.projectedAnchorY+vt,je.projectedAnchorZ+dt,l?Te:C);const An=xr(w.getCameraToCenterDistance(_e),gn);let Dn=b.evaluateSizeForFeature(f.textSizeData,q,je)*An/o.br;l&&(Dn*=f.tilePixelRatio/V);const It=O1(nt,Dn);l?({x:ct,y:jt,z:en}=_e.projectTilePoint(Ye+It.x,et+It.y,D.canonical),[ct,jt,en]=sa(ct+lt,jt+vt,en+dt,C)):(r&&It._rotate(-w.angle),ct+=It.x,jt+=It.y,en=0);const pn=f.allowVerticalPlacement&&je.placedOrientation===o.bl.vertical?Math.PI/2:0;for(let Xt=0;Xt<Xe;Xt++)o.bo(ee,ct,jt,en,pn);j&&je.associatedIconIndex>=0&&(be[je.associatedIconIndex]={x:ct,y:jt,z:en,angle:pn})}else $s(Xe,ee)}if(j){ae.clear();const Ue=f.icon.placedSymbolArray;for(let je=0;je<Ue.length;je++){const Ye=Ue.get(je),{numGlyphs:et}=Ye,Xe=be[je];if(Ye.hidden||!Xe)$s(et,ae);else{const{x:nt,y:lt,z:vt,angle:dt}=Xe;for(let ct=0;ct<et;ct++)o.bo(ae,nt,lt,vt,dt)}}f.icon.dynamicLayoutVertexBuffer.updateData(ae)}f.text.dynamicLayoutVertexBuffer.updateData(ee)}function Gh(f,r,l,p,b,w,C={}){const D=l.paint.get("icon-translate"),V=l.paint.get("text-translate"),q=l.paint.get("icon-translate-anchor"),j=l.paint.get("text-translate-anchor"),X=l.layout.get("icon-rotation-alignment"),ee=l.layout.get("text-rotation-alignment"),ae=l.layout.get("icon-pitch-alignment"),be=l.layout.get("text-pitch-alignment"),_e=l.layout.get("icon-keep-upright"),Te=l.layout.get("text-keep-upright"),we=l.paint.get("icon-color-saturation"),Le=l.paint.get("icon-color-contrast"),Ue=l.paint.get("icon-color-brightness-min"),je=l.paint.get("icon-color-brightness-max"),Ye=l.layout.get("symbol-elevation-reference")==="sea",et=f.context,Xe=et.gl,nt=f.transform,lt=X==="map",vt=ee==="map",dt=ae==="map",ct=be==="map",jt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let en=!1;const gn=f.depthModeForSublayer(0,bo.ReadOnly),An=[o.am(nt.center.lng),o.at(nt.center.lat)],Dn=l.layout.get("text-variable-anchor"),It=nt.projection.name==="globe",pn=[],Xt=[0,-1,0];for(const mn of p){const xn=r.getTile(mn),hn=xn.getBucket(l);if(!hn||hn.projection.name==="mercator"&&It||hn.fullyClipped)continue;const Vn=hn.projection.name==="globe",fo=Vn?o.a9(nt.zoom):0,xo=El(mn,hn.getProjection(),nt),ro=nt.calculatePixelsToTileUnitsMatrix(xn),So=Dn&&hn.hasTextData(),Wn=hn.hasIconTextFit()&&So&&hn.hasIconData(),Ro=hn.getProjection().createInversionMatrix(nt,mn.canonical),Ko=Ur=>{nt.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||f.terrain)&&(Ur.push("DEPTH_D24"),Ur.push("DEPTH_OCCLUSION"))},mr=()=>{const Ur=lt&&l.layout.get("symbol-placement")!=="point",Lr=[];Ko(Lr);const fi=Ur||Wn,Yi=l.paint.get("icon-image-cross-fade").constantOr(0);f.terrainRenderModeElevated()&&dt&&Lr.push("PITCH_WITH_MAP_TERRAIN"),Vn&&(Lr.push("PROJECTION_GLOBE_VIEW"),fi&&Lr.push("PROJECTED_POS_ON_VIEWPORT")),Yi>0&&Lr.push("ICON_TRANSITION"),hn.icon.zOffsetVertexBuffer&&Lr.push("Z_OFFSET"),we===0&&Le===0&&Ue===0&&je===1||Lr.push("COLOR_ADJUSTMENT"),hn.sdfIcons&&Lr.push("RENDER_SDF");const Ts=hn.icon.programConfigurations.get(l.id),Ks=f.getOrCreateProgram("symbol",{config:Ts,defines:Lr}),ea=xn.imageAtlasTexture?xn.imageAtlasTexture.size:[0,0],wr=hn.iconSizeData,_r=o.bk(wr,nt.zoom),kr=dt||nt.pitch!==0,Jr=fr(xo,xn.tileID.canonical,dt,lt,nt,hn.getProjection(),ro),Pi=zr(xo,xn.tileID.canonical,dt,lt,nt,hn.getProjection(),ro),pi=f.translatePosMatrix(Pi,xn,D,q,!0),ra=f.translatePosMatrix(xo,xn,D,q),Ul=fi?Hh:Jr,rs=lt&&!dt&&!Ur;let is=Xt;!It&&!nt.mercatorFromTransition||lt||(is=ay(nt));const Zs=Vn?is:Xt,ml=l.getColorAdjustmentMatrix(we,Le,Ue,je),as=ry(wr.kind,_r,rs,dt,f,ra,Ul,pi,Ye,!1,ea,[0,0],!0,mn,fo,An,Ro,Zs,hn.getProjection(),ml,Yi),kc=xn.imageAtlasTexture?xn.imageAtlasTexture:null,Ys=l.layout.get("icon-size").constantOr(0)!==1||hn.iconsNeedLinear,Fr=hn.sdfIcons||f.options.rotating||f.options.zooming||Ys||kr?Xe.LINEAR:Xe.NEAREST,Nd=hn.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,jg=f.terrain&&dt&&Ur?o.a6.mat4.invert(o.a6.mat4.create(),Jr):Hh;if(Ur&&hn.icon){const $d=nt.elevation,Hg=$d?$d.getAtTileOffsetFunc(mn,nt.center.lat,nt.worldSize,hn.getProjection()):null,rf=br(xo,xn.tileID.canonical,dt,lt,nt,hn.getProjection(),ro);cc(hn,xo,f,!1,rf,Pi,dt,_e,Hg,mn)}return{program:Ks,buffers:hn.icon,uniformValues:as,atlasTexture:kc,atlasTextureIcon:null,atlasInterpolation:Fr,atlasInterpolationIcon:null,isSDF:hn.sdfIcons,hasHalo:Nd,tile:xn,labelPlaneMatrixInv:jg}},Kr=()=>{const Ur=vt&&l.layout.get("symbol-placement")!=="point",Lr=[],fi=Ur||Dn||Wn;f.terrainRenderModeElevated()&&ct&&Lr.push("PITCH_WITH_MAP_TERRAIN"),Vn&&(Lr.push("PROJECTION_GLOBE_VIEW"),fi&&Lr.push("PROJECTED_POS_ON_VIEWPORT")),hn.text.zOffsetVertexBuffer&&Lr.push("Z_OFFSET"),hn.iconsInText&&Lr.push("RENDER_TEXT_AND_SYMBOL"),Lr.push("RENDER_SDF"),Ko(Lr);const Yi=hn.text.programConfigurations.get(l.id),Ts=f.getOrCreateProgram("symbol",{config:Yi,defines:Lr});let Ks,ea=[0,0],wr=null;const _r=hn.textSizeData;hn.iconsInText&&(ea=xn.imageAtlasTexture?xn.imageAtlasTexture.size:[0,0],wr=xn.imageAtlasTexture?xn.imageAtlasTexture:null,Ks=ct||nt.pitch!==0||f.options.rotating||f.options.zooming||_r.kind==="composite"||_r.kind==="camera"?Xe.LINEAR:Xe.NEAREST);const kr=xn.glyphAtlasTexture?xn.glyphAtlasTexture.size:[0,0],Jr=l.layout.get("text-size-scale-range"),Pi=o.ap(f.scaleFactor,Jr[0],Jr[1]),pi=o.bk(_r,nt.zoom,Pi),ra=fr(xo,xn.tileID.canonical,ct,vt,nt,hn.getProjection(),ro),Ul=zr(xo,xn.tileID.canonical,ct,vt,nt,hn.getProjection(),ro),rs=f.translatePosMatrix(Ul,xn,V,j,!0),is=f.translatePosMatrix(xo,xn,V,j),Zs=fi?Hh:ra,ml=vt&&!ct&&!Ur;let as=Xt;!It&&!nt.mercatorFromTransition||vt||(as=ay(nt));const kc=ry(_r.kind,pi,ml,ct,f,is,Zs,rs,Ye,!0,kr,ea,!0,mn,fo,An,Ro,Vn?as:Xt,hn.getProjection(),null,null,Pi),Ys=xn.glyphAtlasTexture?xn.glyphAtlasTexture:null,Fr=Xe.LINEAR,Nd=l.paint.get("text-halo-width").constantOr(1)!==0,jg=f.terrain&&ct&&Ur?o.a6.mat4.invert(o.a6.mat4.create(),ra):Hh;if(Ur&&hn.text){const $d=nt.elevation,Hg=$d?$d.getAtTileOffsetFunc(mn,nt.center.lat,nt.worldSize,hn.getProjection()):null,rf=br(xo,xn.tileID.canonical,ct,vt,nt,hn.getProjection(),ro);cc(hn,xo,f,!0,rf,Ul,ct,Te,Hg,mn)}return{program:Ts,buffers:hn.text,uniformValues:kc,atlasTexture:Ys,atlasTextureIcon:wr,atlasInterpolation:Fr,atlasInterpolationIcon:Ks,isSDF:!0,hasHalo:Nd,tile:xn,labelPlaneMatrixInv:jg}},Sr=hn.icon.segments.get().length,ii=hn.text.segments.get().length,Ar=Sr&&!C.onlyText?mr():null,Zr=ii&&!C.onlyIcons?Kr():null,sr=l.paint.get("icon-opacity").constantOr(1),Gr=l.paint.get("text-opacity").constantOr(1);if(jt&&hn.canOverlap){en=!0;const Ur=sr&&!C.onlyText?hn.icon.segments.get():[],Lr=Gr&&!C.onlyIcons?hn.text.segments.get():[];for(const fi of Ur)pn.push({segments:new o.b2([fi]),sortKey:fi.sortKey,state:Ar});for(const fi of Lr)pn.push({segments:new o.b2([fi]),sortKey:fi.sortKey,state:Zr})}else C.onlyText||pn.push({segments:sr?hn.icon.segments:new o.b2([]),sortKey:0,state:Ar}),C.onlyIcons||pn.push({segments:Gr?hn.text.segments:new o.b2([]),sortKey:0,state:Zr})}en&&pn.sort((mn,xn)=>mn.sortKey-xn.sortKey);for(const mn of pn){const xn=mn.state;if(xn)if(f.terrain?f.terrain.setupElevationDraw(xn.tile,xn.program,{useDepthForOcclusion:nt.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:xn.labelPlaneMatrixInv}):f.setupDepthForOcclusion(nt.depthOcclusionForSymbolsAndCircles,xn.program),et.activeTexture.set(Xe.TEXTURE0),xn.atlasTexture&&xn.atlasTexture.bind(xn.atlasInterpolation,Xe.CLAMP_TO_EDGE,!0),xn.atlasTextureIcon&&(et.activeTexture.set(Xe.TEXTURE1),xn.atlasTextureIcon&&xn.atlasTextureIcon.bind(xn.atlasInterpolationIcon,Xe.CLAMP_TO_EDGE,!0)),f.uploadCommonLightUniforms(f.context,xn.program),xn.hasHalo){const hn=xn.uniformValues;hn.u_is_halo=1,Wh(xn.buffers,mn.segments,l,f,xn.program,gn,b,w,hn,2),hn.u_is_halo=0}else{if(xn.isSDF){const hn=xn.uniformValues;xn.hasHalo&&(hn.u_is_halo=1,Wh(xn.buffers,mn.segments,l,f,xn.program,gn,b,w,hn,1)),hn.u_is_halo=0}Wh(xn.buffers,mn.segments,l,f,xn.program,gn,b,w,xn.uniformValues,1)}}}function Wh(f,r,l,p,b,w,C,D,V,q){const j=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];b.draw(p,p.context.gl.TRIANGLES,w,C,D,Po.disabled,V,l.id,f.layoutVertexBuffer,f.indexBuffer,r,l.paint,p.transform.zoom,f.programConfigurations.get(l.id),j,q)}function up(f,r,l,p,b,w,C){const D=f.context.gl,V=l.paint.get("fill-pattern"),q=l.is3D(),j=q?f.stencilModeFor3D():Do.disabled,X=V&&V.constantOr(1);let ee,ae,be,_e,Te;C?(ae=X&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=D.LINES):(ae=X?"fillPattern":"fill",ee=D.TRIANGLES);for(const we of p){const Le=r.getTile(we);if(X&&!Le.patternsLoaded())continue;const Ue=Le.getBucket(l);if(!Ue)continue;f.prepareDrawTile();const je=Ue.programConfigurations.get(l.id),Ye=f.isTileAffectedByFog(we),et=f.getOrCreateProgram(ae,{config:je,overrideFog:Ye});X&&(f.context.activeTexture.set(D.TEXTURE0),Le.imageAtlasTexture&&Le.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),je.updatePaintBuffers());const Xe=V.constantOr(null);if(Xe&&Le.imageAtlas){const vt=Le.imageAtlas.patternPositions[Xe.toString()];vt&&je.setConstantPatternPositions(vt)}const nt=f.translatePosMatrix(we.projMatrix,Le,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),lt=l.paint.get("fill-emissive-strength");if(C){_e=Ue.indexBuffer2,Te=Ue.segments2;const vt=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];be=ae==="fillOutlinePattern"&&X?A1(nt,lt,f,Le,vt):Vh(nt,lt,vt)}else _e=Ue.indexBuffer,Te=Ue.segments,be=X?hg(nt,lt,f,Le):oy(nt,lt);f.uploadCommonUniforms(f.context,et,we.toUnwrapped()),et.draw(f,ee,b,q?j:f.stencilModeForClipping(we),w,Po.disabled,be,l.id,Ue.layoutVertexBuffer,_e,Te,l.paint,f.transform.zoom,je,void 0)}}function _a(f,r,l,p,b,w,C,D){l.resetLayerRenderingStats(f);const V=f.context,q=V.gl,j=f.transform,X=l.paint.get("fill-extrusion-pattern"),ee=X.constantOr(1),ae=l.paint.get("fill-extrusion-opacity"),be=f.style.enable3dLights(),_e=l.paint.get(be&&!ee?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e],we=l.layout.get("fill-extrusion-edge-radius"),Le=we>0&&!l.paint.get("fill-extrusion-rounded-roof"),Ue=Le?0:we,je=j.projection.name==="globe"?o.c_():0,Ye=j.projection.name==="globe",et=Ye?o.a9(j.zoom):0,Xe=[o.am(j.center.lng),o.at(j.center.lat)],nt=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),lt=l.paint.get("fill-extrusion-flood-light-intensity"),vt=l.paint.get("fill-extrusion-vertical-scale"),dt=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,ct=l.paint.get("fill-extrusion-height-alignment"),jt=l.paint.get("fill-extrusion-base-alignment"),en=Aa(f,l.paint.get("fill-extrusion-cutoff-fade-range")),gn=[];let An;Ye&&gn.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&gn.push("FAUX_AO"),Le&&gn.push("ZERO_ROOF_RADIUS"),D&&gn.push("HAS_CENTROID"),lt>0&&gn.push("FLOOD_LIGHT"),en.shouldRenderCutoff&&gn.push("RENDER_CUTOFF"),dt&&gn.push("RENDER_WALL_MODE");const Dn=f.renderPass==="shadow",It=f.shadowRenderer,pn=Dn&&!!It;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Xt=[0,0,0];if(It){const hn=f.style.directionalLight,Vn=f.style.ambientLight;hn&&Vn&&(Xt=yc(f.style,hn,Vn)),Dn||(gn.push("RENDER_SHADOWS","DEPTH_TEXTURE"),It.useNormalOffset&&gn.push("NORMAL_OFFSET")),An=gn.concat(["SHADOWS_SINGLE_CASCADE"])}const mn=pn?"fillExtrusionDepth":ee?"fillExtrusionPattern":"fillExtrusion",xn=l.getLayerRenderingStats();for(const hn of p){const Vn=r.getTile(hn),fo=Vn.getBucket(l);if(!fo||fo.projection.name!==j.projection.name)continue;let xo=!1;It&&(xo=It.getMaxCascadeForTile(hn.toUnwrapped())===0);const ro=f.isTileAffectedByFog(hn),So=fo.programConfigurations.get(l.id),Wn=f.getOrCreateProgram(mn,{config:So,defines:xo?An:gn,overrideFog:ro});if(f.terrain&&f.terrain.setupElevationDraw(Vn,Wn,{useMeterToDem:!0}),!fo.centroidVertexBuffer){const Ar=Wn.attributes.a_centroid_pos;Ar!==void 0&&q.vertexAttrib2f(Ar,0,0)}!Dn&&It&&It.setupShadows(Vn.tileID.toUnwrapped(),Wn,"vector-tile",Vn.tileID.overscaledZ),ee&&(f.context.activeTexture.set(q.TEXTURE0),Vn.imageAtlasTexture&&Vn.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),So.updatePaintBuffers());const Ro=X.constantOr(null);if(Ro&&Vn.imageAtlas){const Ar=Vn.imageAtlas.patternPositions[Ro.toString()];Ar&&So.setConstantPatternPositions(Ar)}const Ko=l.paint.get("fill-extrusion-vertical-gradient"),mr=1/fo.tileToMeter;let Kr;if(Dn&&It){if(ly(Vn.tileID,fo,f))continue;const Ar=It.calculateShadowPassMatrixFromTile(Vn.tileID.toUnwrapped());Kr=ug(Ar,Ue,mr,vt,ct,jt)}else{const Ar=f.translatePosMatrix(hn.expandedProjMatrix,Vn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Zr=j.projection.createInversionMatrix(j,hn.canonical);Kr=ee?dg(Ar,f,Ko,ae,Te,Ue,mr,hn,Vn,je,ct,jt,et,Xe,Zr,nt,vt):cg(Ar,f,Ko,ae,Te,Ue,mr,hn,je,ct,jt,et,Xe,Zr,nt,vt,lt,Xt)}f.uploadCommonUniforms(V,Wn,hn.toUnwrapped(),null,en);let Sr=fo.segments;if(j.projection.name==="mercator"&&!Dn&&(Sr=fo.getVisibleSegments(Vn.tileID,f.terrain,f.transform.getFrustum(0)),!Sr.get().length))continue;if(xn)if(Dn)for(const Ar of Sr.get())xn.numRenderedVerticesInShadowPass+=Ar.primitiveLength;else for(const Ar of Sr.get())xn.numRenderedVerticesInTransparentPass+=Ar.primitiveLength;const ii=[];(f.terrain||D)&&ii.push(fo.centroidVertexBuffer),Ye&&ii.push(fo.layoutVertexExtBuffer),dt&&ii.push(fo.wallVertexBuffer),Wn.draw(f,V.gl.TRIANGLES,b,w,C,Po.backCCW,Kr,l.id,fo.layoutVertexBuffer,fo.indexBuffer,Sr,l.paint,f.transform.zoom,So,ii)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function ws(f,r,l,p,b,w,C,D,V,q,j,X,ee,ae,be,_e,Te,we,Le){const Ue=f.context,je=Ue.gl,Ye=f.transform,et=f.transform.zoom,Xe=[],nt=Aa(f,l.paint.get("fill-extrusion-cutoff-fade-range"));q==="clear"?(Xe.push("CLEAR_SUBPASS"),Le&&(Xe.push("CLEAR_FROM_TEXTURE"),Ue.activeTexture.set(je.TEXTURE0),Le.bind(je.LINEAR,je.CLAMP_TO_EDGE))):q==="sdf"&&Xe.push("SDF_SUBPASS"),Te&&Xe.push("HAS_CENTROID"),nt.shouldRenderCutoff&&Xe.push("RENDER_CUTOFF");const lt=l.layout.get("fill-extrusion-edge-radius"),vt=(dt,ct,jt,en,gn)=>{const An=ct.programConfigurations.get(l.id),Dn=f.isTileAffectedByFog(dt),It=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:An,defines:Xe,overrideFog:Dn}),pn=((mn,xn,hn,Vn,fo,xo,ro,So,Wn,Ro,Ko)=>({u_matrix:xn,u_opacity:hn,u_ao_pass:Vn?1:0,u_meter_to_tile:fo,u_ao:xo,u_flood_light_intensity:ro,u_flood_light_color:So,u_attenuation:Wn,u_edge_radius:Ro,u_fb:0,u_fb_size:Ko,u_dynamic_offset:1}))(0,en,j,V,gn,[X,ee*gn],ae,be,_e,et>=17?0:lt*gn,Le?Le.size[0]:0),Xt=[];Te&&Xt.push(ct.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms(Ue,It,dt.toUnwrapped(),null,nt),It.draw(f,Ue.gl.TRIANGLES,b,w,C,D,pn,l.id,ct.vertexBuffer,ct.indexBuffer,jt,l.paint,et,An,Xt)};for(const dt of p){const ct=r.getTile(dt),jt=ct.getBucket(l);if(!jt||jt.projection.name!==Ye.projection.name||!jt.groundEffect||jt.groundEffect&&!jt.groundEffect.hasData())continue;const en=jt.groundEffect,gn=1/jt.tileToMeter;{const An=f.translatePosMatrix(dt.projMatrix,ct,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Dn=en.getDefaultSegment();vt(dt,en,Dn,An,gn)}if(we)for(let An=0;An<4;An++){const Dn=o.c$[An](dt),It=r.getTile(Dn);if(!It)continue;const pn=It.getBucket(l);if(!pn||pn.projection.name!==Ye.projection.name||!pn.groundEffect||pn.groundEffect&&!pn.groundEffect.hasData())continue;const Xt=pn.groundEffect;let mn,xn;An===0?(mn=[-o.ab,0,0],xn=1):An===1?(mn=[o.ab,0,0],xn=0):An===2?(mn=[0,-o.ab,0],xn=3):(mn=[0,o.ab,0],xn=2);const hn=Xt.regionSegments[xn];if(!hn)continue;const Vn=new Float32Array(16);o.a6.mat4.translate(Vn,dt.projMatrix,mn),vt(dt,Xt,hn,f.translatePosMatrix(Vn,ct,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),gn)}}}function sy(f,r,l,p,b,w,C){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const D=w?w.findDEMTileFor(l):null;if(!(D&&D.dem||C))return;const V=we=>new o.P(Math.ceil((we+o.d2)*o.d3),0),q=we=>{const Le=r.getSource().minzoom,Ue=Ye=>{const et=r.getTileByID(Ye);if(et&&et.hasData())return et.getBucket(b)},je=[0,-1,1];for(const Ye of je){if(we.overscaledZ+Ye<Le)continue;const et=Ue(we.calculateScaledKey(we.overscaledZ+Ye));if(et)return et}},j=[0,0,0],X=(we,Le)=>(j[0]=Math.min(we.min.y,Le.min.y),j[1]=Math.max(we.max.y,Le.max.y),j[2]=o.ab-Le.min.x>we.max.x?Le.min.x-o.ab:we.max.x,j),ee=(we,Le)=>(j[0]=Math.min(we.min.x,Le.min.x),j[1]=Math.max(we.max.x,Le.max.x),j[2]=o.ab-Le.min.y>we.max.y?Le.min.y-o.ab:we.max.y,j),ae=[(we,Le)=>X(we,Le),(we,Le)=>X(Le,we),(we,Le)=>ee(we,Le),(we,Le)=>ee(Le,we)],be=(we,Le,Ue,je,Ye,et,Xe)=>{if(!w)return 0;const nt=[[et?Ue:we,et?we:Ue,0],[et?Ue:Le,et?Le:Ue,0]],lt=Xe<0?o.ab+Xe:Xe,vt=[et?lt:(we+Le)/2,et?(we+Le)/2:lt,0];return Ue===0&&Xe<0||Ue!==0&&Xe>0?w.getForTilePoints(Ye,[vt],!0,je):nt.push(vt),w.getForTilePoints(l,nt,!0,D),Math.max(nt[0][2],nt[1][2],vt[2])/w.exaggeration()};for(let we=0;we<4;we++){const Le=p.borderFeatureIndices[we];if(Le.length===0)continue;const Ue=o.c$[we](l),je=q(Ue);if(!(je&&je instanceof o.d0)||p.borderDoneWithNeighborZ[we]===je.canonical.z)continue;je.centroidVertexArray.length===0&&je.createCentroidsBuffer();const Ye=w?w.findDEMTileFor(Ue):null;if(!(Ye&&Ye.dem||C))continue;const et=(we<2?1:5)-we,Xe=je.borderDoneWithNeighborZ[et]!==p.canonical.z,nt=je.borderFeatureIndices[et];let lt=0;if(p.canonical.z!==je.canonical.z){for(const vt of Le)p.showCentroid(p.featuresOnBorder[vt]);if(Xe)for(const vt of nt)je.showCentroid(je.featuresOnBorder[vt]);p.borderDoneWithNeighborZ[we]=je.canonical.z,je.borderDoneWithNeighborZ[et]=p.canonical.z}for(const vt of Le){const dt=p.featuresOnBorder[vt],ct=p.centroidData[dt.centroidDataIndex],jt=dt.borders[we];let en;for(;lt<nt.length;){en=je.featuresOnBorder[nt[lt]];const gn=en.borders[et];if(gn[1]>jt[0]+3||gn[0]>jt[0]-3)break;je.showCentroid(en),lt++}if(en&&lt<nt.length){const gn=lt;let An=0;for(;!(en.borders[et][0]>jt[1]-3)&&(An++,++lt!==nt.length);)en=je.featuresOnBorder[nt[lt]];en=je.featuresOnBorder[nt[gn]];let Dn=!1;if(An>=1){const Xt=en.borders[et];Math.abs(jt[0]-Xt[0])<3&&Math.abs(jt[1]-Xt[1])<3&&(An=1,Dn=!0,lt=gn+1)}else if(An===0){p.showCentroid(dt);continue}const It=je.centroidData[en.centroidDataIndex];C&&Dn&&(((_e=ct).flags|(Te=It).flags)&o.d1?(_e.flags|=o.d1,Te.flags|=o.d1):(_e.flags&=~o.d1,Te.flags&=~o.d1));const pn=dt.intersectsCount()>1||en.intersectsCount()>1;if(An>1)lt=gn,ct.centroidXY=It.centroidXY=new o.P(0,0);else if(Ye&&Ye.dem&&!pn){const Xt=ae[we](ct,It),mn=we%2?o.ab-1:0,xn=be(Xt[0],Math.min(o.ab-1,Xt[1]),mn,Ye,Ue,we<2,Xt[2]);ct.centroidXY=It.centroidXY=V(xn)}else pn?ct.centroidXY=It.centroidXY=new o.P(0,0):(ct.centroidXY=p.encodeBorderCentroid(dt),It.centroidXY=je.encodeBorderCentroid(en));p.writeCentroidToBuffer(ct),je.writeCentroidToBuffer(It)}else p.showCentroid(dt)}p.borderDoneWithNeighborZ[we]=je.canonical.z,je.borderDoneWithNeighborZ[et]=p.canonical.z}var _e,Te;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(f)}const xg=[1,0,0],wg=[0,1,0],Sg=[0,0,1];function ly(f,r,l){const p=l.transform,b=l.shadowRenderer;if(!b)return!0;const w=f.toUnwrapped(),C=p.tileSize*b._cascades[l.currentShadowCascade].scale;let D=r.maxHeight;if(p.elevation){const _e=p.elevation.getMinMaxForTile(f);_e&&(D+=_e.max)}const V=[...b.shadowDirection];V[2]=-V[2];const q=b.computeSimplifiedTileShadowVolume(w,D,C,V);if(!q)return!1;const j=[xg,wg,Sg,V,[V[0],0,V[2]],[0,V[1],V[2]]],X=p.projection.name==="globe",ee=p.scaleZoom(C),ae=o.bO.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,ee,!X),be=b.getCurrentCascadeFrustum();return ae.intersectsPrecise(q.vertices,q.planes,j)===0||be.intersectsPrecise(q.vertices,q.planes,j)===0}function Ss(f){return[f[0]*o.d4,f[1]*o.d4,f[2]*o.d4,0]}function Ei(f,r,l,p,b,w,C,D,V){const q=p.getSource(),j=l.globeSharedBuffers;if(!j)return;let X,ee,ae;if(r&&(X=p.getTile(r)),q instanceof o.aD?(ee=q.texture,ae=o.cD(0,0,l.transform)):X&&r&&(ee=X.texture,ae=o.cD(r.canonical.z,r.canonical.x,l.transform)),!ee||!ae)return;f||(ae=o.a6.mat4.scale(o.a6.mat4.create(),ae,[1,-1,1]));const be=l.context,_e=be.gl,Te=b.paint.get("raster-resampling")==="nearest"?_e.NEAREST:_e.LINEAR,we=l.colorModeForDrapableLayerRenderPass(w),Le=C.defines;Le.push("GLOBE_POLES");const Ue=new bo(_e.LEQUAL,bo.ReadWrite,l.depthRangeFor3D),je=Float32Array.from(l.transform.expandedFarZProjMatrix),Ye=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),be.activeTexture.set(_e.TEXTURE0),ee.bind(Te,_e.CLAMP_TO_EDGE),be.activeTexture.set(_e.TEXTURE1),ee.bind(Te,_e.CLAMP_TO_EDGE),ee.useMipmap&&be.extTextureFilterAnisotropic&&l.transform.pitch>20&&_e.texParameterf(_e.TEXTURE_2D,be.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,be.extTextureFilterAnisotropicMax);const[et,Xe,nt,lt]=r?j.getPoleBuffers(r.canonical.z,!1):j.getPoleBuffers(0,!0),vt=b.paint.get("raster-elevation");let dt;f?(dt=et,l.renderDefaultNorthPole=vt!==0):(dt=Xe,l.renderDefaultSouthPole=vt!==0);const ct=Ss(C.mix),jt=((gn,An,Dn,It,pn,Xt,mn,xn,hn,Vn,fo,xo,ro)=>ap(gn,An,Dn,new Float32Array(16),new Float32Array(9),[0,0],It,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Xt,[0,0],xn,2,Vn,fo,xo,1,0,ro))(je,Ye,ae,o.a9(l.transform.zoom),0,b,0,vt,0,ct,C.offset,C.range,w),en=l.getOrCreateProgram("raster",{defines:Le});l.uploadCommonUniforms(be,en,null),en.draw(l,_e.TRIANGLES,Ue,V,we,D,jt,b.id,dt,nt,lt)}function dp(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,b=.2*f.height,w=r+b;return[r,l,(w-b-r)/p,(w-r)/p]}function Tg(f,r,l,p){if(f)return r instanceof ps&&f instanceof lc?r.getTextureDescriptor(f,l,!0):{texture:f.texture,mix:Ss(p.mix),offset:p.offset,buffer:0,tileSize:1}}var cy=o.d5([{name:"a_index",type:"Int16",components:1}]);class uy{constructor(r,l,p,b){const w={width:p[0],height:p[1],data:null},C=r.gl;this.targetColorTexture=new o.T(r,w,C.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(r,w,C.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,b),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,b=l.width*l.height;this.particleTexture0=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1});const w=new o.d6;w.reserve(b);for(let C=0;C<b;C++)w.emplaceBack(C);this.particleIndexBuffer=this.context.createVertexBuffer(w,cy.members,!0),this.particleSegment=o.b2.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=o.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function dy(f,r,l){if(!f)return null;const p=r.getTextureDescriptor(f,l,!0);if(!p)return null;let{texture:b,mix:w,offset:C,tileSize:D,buffer:V,format:q}=p;if(!b||!q)return null;let j=!1;return q==="uint32"&&(j=!0,w[3]=0,w=ip(o.d7,w,[0,l.paint.get("raster-particle-max-speed")]),C=Ed(o.d7,C,[0,l.paint.get("raster-particle-max-speed")])),{texture:b,textureOffset:[V/(D+2*V),D/(D+2*V)],tileSize:D,scalarData:j,scale:w,offset:C,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[q]]}}function L1(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,b=.2*f.height,w=r+b;return[r,l,(w-b-r)/p,(w-r)/p]}const Id=new o.bA(1,0,0,1),Ad=new o.bA(0,1,0,1),Rn=new o.bA(0,0,1,1),_o=new o.bA(1,0,1,1),kd=new o.bA(0,1,1,1);function ci(f,r,l,p,b,w,C){const D=f.context,V=f.transform,q=D.gl,j=V.projection.name==="globe",X=j?["PROJECTION_GLOBE_VIEW"]:[];let ee=o.a6.mat4.clone(l.projMatrix);if(j&&o.a9(V.zoom)>0){const ct=o.b5(l.canonical,V),jt=o.d8(ct);ee=o.a6.mat4.multiply(new Float32Array(16),V.globeMatrix,jt),o.a6.mat4.multiply(ee,V.projMatrix,ee)}const ae=o.a6.mat4.create();ae[12]+=2*b/(o.q.devicePixelRatio*V.width),ae[13]+=2*w/(o.q.devicePixelRatio*V.height),o.a6.mat4.multiply(ee,ae,ee);const be=f.getOrCreateProgram("debug",{defines:X}),_e=r.getTileByID(l.key);f.terrain&&f.terrain.setupElevationDraw(_e,be);const Te=bo.disabled,we=Do.disabled,Le=f.colorModeForRenderPass(),Ue="$debug";D.activeTexture.set(q.TEXTURE0),f.emptyTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),j?_e._makeGlobeTileDebugBuffers(f.context,V):_e._makeDebugTileBoundsBuffers(f.context,V.projection);const je=_e._tileDebugBuffer||f.debugBuffer,Ye=_e._tileDebugIndexBuffer||f.debugIndexBuffer,et=_e._tileDebugSegments||f.debugSegments;if(be.draw(f,q.LINE_STRIP,Te,we,Le,Po.disabled,fg(ee,p),Ue,je,Ye,et,null,null,null,[_e._globeTileDebugBorderBuffer]),C){const ct=_e.latestRawTileData,jt=Math.floor((ct&&ct.byteLength||0)/1024);let en=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(en+=` => ${l.overscaledZ}`),en+=` ${_e.state}`,en+=` ${jt}kb`,function(gn,An){gn.initDebugOverlayCanvas();const Dn=gn.debugOverlayCanvas,It=gn.context.gl,pn=gn.debugOverlayCanvas.getContext("2d");pn.clearRect(0,0,Dn.width,Dn.height),pn.shadowColor="white",pn.shadowBlur=2,pn.lineWidth=1.5,pn.strokeStyle="white",pn.textBaseline="top",pn.font="bold 36px Open Sans, sans-serif",pn.fillText(An,5,5),pn.strokeText(An,5,5),gn.debugOverlayTexture.update(Dn),gn.debugOverlayTexture.bind(It.LINEAR,It.CLAMP_TO_EDGE)}(f,en)}const Xe=r.getTile(l).tileSize,nt=512/Math.min(Xe,512)*(l.overscaledZ/V.zoom)*.5,lt=_e._tileDebugTextBuffer||f.debugBuffer,vt=_e._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,dt=_e._tileDebugTextSegments||f.debugSegments;be.draw(f,q.TRIANGLES,Te,we,ir.alphaBlended,Po.disabled,fg(ee,o.bA.transparent,nt),Ue,lt,vt,dt,null,null,null,[_e._globeTileDebugTextBuffer])}function Lt(f,r,l,p){$u(f,0,r+l/2,f.transform.width,l,p)}function Cg(f,r,l,p){$u(f,r-l/2,0,l,f.transform.height,p)}function $u(f,r,l,p,b,w){const C=f.context,D=C.gl;D.enable(D.SCISSOR_TEST),D.scissor(r*o.q.devicePixelRatio,l*o.q.devicePixelRatio,p*o.q.devicePixelRatio,b*o.q.devicePixelRatio),C.clear({color:w}),D.disable(D.SCISSOR_TEST)}const Eg=o.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:hp}=Eg;function Sc(f,r,l,p){f.emplaceBack(r,l,p)}class Mg{constructor(r){this.vertexArray=new o.d9,this.indices=new o.aP,Sc(this.vertexArray,-1,-1,1),Sc(this.vertexArray,1,-1,1),Sc(this.vertexArray,-1,1,1),Sc(this.vertexArray,1,1,1),Sc(this.vertexArray,-1,-1,-1),Sc(this.vertexArray,1,-1,-1),Sc(this.vertexArray,-1,1,-1),Sc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,hp),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.b2.simpleSegment(0,0,36,12)}}function fl(f,r,l,p,b,w){const C=f.context.gl,D=r.paint.get("sky-atmosphere-color"),V=r.paint.get("sky-atmosphere-halo-color"),q=r.paint.get("sky-atmosphere-sun-intensity"),j=((X,ee,ae,be,_e)=>({u_matrix_3f:X,u_sun_direction:ee,u_sun_intensity:ae,u_color_tint_r:[be.r,be.g,be.b,be.a],u_color_tint_m:[_e.r,_e.g,_e.b,_e.a],u_luminance:5e-5}))(o.a6.mat3.fromMat4(o.a6.mat3.create(),p),b,q,D,V);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+w,r.skyboxTexture,0),l.draw(f,C.TRIANGLES,bo.disabled,Do.disabled,ir.unblended,Po.frontCW,j,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const D1=o.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class z1{constructor(r){const l=new o.da;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const p=new o.aP;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,D1.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=o.b2.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const hy=o.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class fp{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Ig{constructor(r){this.colorModeAlphaBlendedWriteRGB=new ir([1,Fa,1,Fa],o.bA.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ir([1,0,1,0],o.bA.transparent,[!1,!1,!1,!0]),this.params=new fp,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new z1(l);const p=this.params.sizeRange,b=this.params.intensityRange,w=function(j){const X=o.dd(30),ee=[];for(let ae=0;ae<j;++ae){const be=2*Math.PI*X(),_e=Math.acos(1-2*X())-.5*Math.PI;ee.push(o.a6.vec3.fromValues(Math.cos(_e)*Math.cos(be),Math.cos(_e)*Math.sin(be),Math.sin(_e)))}return ee}(this.params.starsCount),C=o.dd(300),D=new o.db,V=new o.aP;let q=0;for(let j=0;j<w.length;++j){const X=o.a6.vec3.scale([],w[j],200),ee=Math.max(0,1+.01*p*(1*C()-.5)),ae=Math.max(0,1+.01*b*(1*C()-.5));D.emplaceBack(X[0],X[1],X[2],-1,-1,ee,ae),D.emplaceBack(X[0],X[1],X[2],1,-1,ee,ae),D.emplaceBack(X[0],X[1],X[2],1,1,ee,ae),D.emplaceBack(X[0],X[1],X[2],-1,1,ee,ae),V.emplaceBack(q+0,q+1,q+2),V.emplaceBack(q+0,q+2,q+3),q+=4}this.starsVx=l.createVertexBuffer(D,hy.members),this.starsIdx=l.createIndexBuffer(V),this.starsSegments=o.b2.simpleSegment(0,0,D.length,V.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const p=r.context,b=p.gl,w=r.transform,C=new bo(b.LEQUAL,bo.ReadOnly,[0,1]),D=o.a9(w.zoom),V=r.style.getLut(l.scope),q=l.properties.get("color").toRenderColor(V).toArray01(),j=l.properties.get("high-color").toRenderColor(V).toArray01(),X=l.properties.get("space-color").toRenderColor(V).toArray01PremultipliedAlpha(),ee=5e-4,ae=o.dc(l.properties.get("horizon-blend"),0,1,ee,.25),be=o.cx(r,p,w)&&ae===ee?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,_e=r.frameCounter/1e3%1,Te=o.a6.vec3.length(w.globeCenterInViewSpace),we=Math.sqrt(Math.pow(Te,2)-Math.pow(be,2)),Le=Math.acos(we/Te),Ue=je=>{const Ye=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];je&&Ye.push("ALPHA_PASS");const et=r.getOrCreateProgram("globeAtmosphere",{defines:Ye}),Xe=((lt,vt,dt,ct,jt,en,gn,An,Dn,It,pn,Xt)=>({u_frustum_tl:lt,u_frustum_tr:vt,u_frustum_br:dt,u_frustum_bl:ct,u_horizon:jt,u_transition:en,u_fadeout_range:gn,u_color:An,u_high_color:Dn,u_space_color:It,u_temporal_offset:pn,u_horizon_angle:Xt}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,D,ae,q,j,X,_e,Le);r.uploadCommonUniforms(p,et);const nt=this.atmosphereBuffer;nt&&et.draw(r,b.TRIANGLES,C,Do.disabled,je?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Po.backCW,Xe,je?"atmosphere_glow_alpha":"atmosphere_glow",nt.vertexBuffer,nt.indexBuffer,nt.segments)};Ue(!1),Ue(!0)}drawStars(r,l){const p=o.ap(l.properties.get("star-intensity"),0,1);if(p===0)return;const b=r.context,w=b.gl,C=r.transform,D=r.getOrCreateProgram("stars"),V=o.a6.quat.identity([]);o.a6.quat.rotateX(V,V,-C._pitch),o.a6.quat.rotateZ(V,V,-C.angle),o.a6.quat.rotateX(V,V,o.bC(C._center.lat)),o.a6.quat.rotateY(V,V,-o.bC(C._center.lng));const q=o.a6.mat4.fromQuat(new Float32Array(16),V),j=o.a6.mat4.multiply([],C.starsProjMatrix,q),X=o.a6.mat3.fromMat4([],q),ee=o.a6.mat3.invert([],X),ae=[0,1,0];o.a6.vec3.transformMat3(ae,ae,ee),o.a6.vec3.scale(ae,ae,this.params.sizeMultiplier);const be=[1,0,0];o.a6.vec3.transformMat3(be,be,ee),o.a6.vec3.scale(be,be,this.params.sizeMultiplier);const _e=(Te=ae,we=be,Le=p,{u_matrix:Float32Array.from(j),u_up:Te,u_right:we,u_intensity_multiplier:Le});var Te,we,Le;r.uploadCommonUniforms(b,D),this.starsVx&&this.starsIdx&&D.draw(r,w.TRIANGLES,bo.disabled,Do.disabled,this.colorModeAlphaBlendedWriteRGB,Po.disabled,_e,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Ag(f,r){const l=[...f],p=r.cameraWorldSizeForFog/r.worldSize,b=o.a6.mat4.identity([]);return o.a6.mat4.scale(b,b,[p,p,1]),o.a6.mat4.multiply(l,b,l),o.a6.mat4.multiply(l,r.worldToFogMatrix,l),l}function pp(f,r,l,p,b){const w=l.material,C=p.context,{baseColorTexture:D,metallicRoughnessTexture:V}=w.pbrMetallicRoughness,{normalTexture:q,occlusionTexture:j,emissionTexture:X}=w;function ee(be,_e,Te){if(be&&(f.push(_e),C.activeTexture.set(C.gl.TEXTURE0+Te),be.gfxTexture)){const{minFilter:we,magFilter:Le,wrapS:Ue,wrapT:je}=be.sampler;be.gfxTexture.bindExtraParam(we,Le,Ue,je)}}ee(D,"HAS_TEXTURE_u_baseColorTexture",ua.BaseColor),ee(V,"HAS_TEXTURE_u_metallicRoughnessTexture",ua.MetallicRoughness),ee(q,"HAS_TEXTURE_u_normalTexture",ua.Normal),ee(j,"HAS_TEXTURE_u_occlusionTexture",ua.Occlusion),ee(X,"HAS_TEXTURE_u_emissionTexture",ua.Emission),b&&(b.texture||(b.texture=new o.df(p.context,b.image,[b.image.height,b.image.height,b.image.height],C.gl.RGBA8)),C.activeTexture.set(C.gl.TEXTURE0+ua.LUT),b.texture&&b.texture.bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(f.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||f.push("DIFFUSE_SHADED"),f.push("USE_STANDARD_DERIVATIVES");const ae=p.shadowRenderer;ae&&(f.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&f.push("NORMAL_OFFSET"))}function Vu(f,r,l,p,b,w){const C=l.paint.get("model-opacity"),D=r.context,V=new bo(r.context.gl.LEQUAL,bo.ReadWrite,r.depthRangeFor3D),q=r.transform,j=f.mesh,X=j.material,ee=X.pbrMetallicRoughness,ae=r.style.fog;let be;be=r.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:o.a6.mat4.multiply([],p.zScaleMatrix,f.nodeModelMatrix),o.a6.mat4.multiply(be,p.negCameraPosMatrix,be);const _e=o.a6.mat4.invert([],be);o.a6.mat4.transpose(_e,_e);const Te=l.paint.get("model-emissive-strength").constantOr(0),we=cp(new Float32Array(f.worldViewProjection),new Float32Array(be),new Float32Array(_e),null,r,C,ee.baseColorFactor.toRenderColor(null),X.emissiveFactor,ee.metallicFactor,ee.roughnessFactor,X,Te,l),Le={defines:[]},Ue=[],je=r.shadowRenderer;je&&(je.useNormalOffset=!1),pp(Le.defines,Ue,j,r,l.lut);let Ye=null;if(ae){const nt=Ag(f.nodeModelMatrix,r.transform);if(Ye=new Float32Array(nt),q.projection.name!=="globe"){const lt=j.aabb.min,vt=j.aabb.max,[dt,ct]=ae.getOpacityForBounds(nt,lt[0],lt[1],vt[0],vt[1]);Le.overrideFog=dt>=gt||ct>=gt}}const et=Aa(r,l.paint.get("model-cutoff-fade-range"));et.shouldRenderCutoff&&Le.defines.push("RENDER_CUTOFF");const Xe=r.getOrCreateProgram("model",Le);r.uploadCommonUniforms(D,Xe,null,Ye,et),r.renderPass!=="shadow"&&je&&je.setupShadowsFromMatrix(f.nodeModelMatrix,Xe),Xe.draw(r,D.gl.TRIANGLES,V,b,w,j.material.doubleSided?Po.disabled:Po.backCCW,we,l.id,j.vertexBuffer,j.indexBuffer,j.segments,l.paint,r.transform.zoom,void 0,Ue)}function qh(f,r,l,p,b,w,C){let D;D=f.projection.name==="globe"?o.dg(l,f):[...l],o.a6.mat4.multiply(D,D,r.matrix);const V=o.a6.mat4.multiply([],p,D);if(r.meshes)for(const q of r.meshes){if(q.material.alphaMode!=="BLEND"){C.push({mesh:q,depth:0,modelIndex:b,worldViewProjection:V,nodeModelMatrix:D});continue}const j=o.a6.vec3.transformMat4([],q.centroid,V);j[2]>0&&w.push({mesh:q,depth:j[2],modelIndex:b,worldViewProjection:V,nodeModelMatrix:D})}if(r.children)for(const q of r.children)qh(f,q,l,p,b,w,C)}function mp(f,r,l,p){const b=l.shadowRenderer;if(!b)return;const w=b.getShadowPassDepthMode(),C=b.getShadowPassColorMode(),D=b.calculateShadowPassMatrixFromMatrix(r),V=vg(D);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,w,Do.disabled,C,Po.backCCW,V,p.id,f.vertexBuffer,f.indexBuffer,f.segments,p.paint,l.transform.zoom,void 0,void 0)}function fy(f,r,l){const p=r.updateZoomBasedPaintProperties(),b=function(w,C,D){let V,q,j,X=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&X>0){const ee=w.terrain,ae=ee.findDEMTileFor(D);ae&&ae.dem?V=o.di.create(ee,D,ae):X=0}if(X===0&&(C.terrainElevationMin=0,C.terrainElevationMax=0),X===C.validForExaggeration&&(X===0||V&&V._demTile&&V._demTile.tileID===C.validForDEMTile.id&&V._dem._timestamp===C.validForDEMTile.timestamp))return!1;for(const ee in C.instancesPerModel){const ae=C.instancesPerModel[ee];for(let be=0;be<ae.instancedDataArray.length;++be){const _e=(V?X*V.getElevationAt(0|ae.instancedDataArray.float32[16*be],0|ae.instancedDataArray.float32[16*be+1],!0,!0):0)+ae.instancesEvaluatedElevation[be];ae.instancedDataArray.float32[16*be+6]=_e,q=q?Math.min(C.terrainElevationMin,_e):_e,j=j?Math.max(C.terrainElevationMax,_e):_e}}return C.terrainElevationMin=q||0,C.terrainElevationMax=j||0,C.validForExaggeration=X,C.validForDEMTile=V&&V._demTile?{id:V._demTile.tileID,timestamp:V._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,r,l);(p||b)&&(r.uploaded=!1,r.upload(f.context))}const Nl={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.ca([0,0,0],[o.ab,o.ab,0])};function Va(f,r){const l=1<<f.canonical.z,p=r.getFreeCameraOptions().position,b=r.elevation,w=f.canonical.x/l,C=(f.canonical.x+1)/l,D=f.canonical.y/l,V=(f.canonical.y+1)/l;let q=r._centerAltitude;if(b){const ae=b.getMinMaxForTile(f);ae&&ae.max>q&&(q=ae.max)}const j=o.ap(p.x,w,C)-p.x,X=o.ap(p.y,D,V)-p.y,ee=o.bE(q,r.center.lat)-p.z;return r._zoomFromMercatorZ(Math.sqrt(j*j+X*X+ee*ee))}function py(f,r,l,p,b,w,C){const D=f.context,V=f.renderPass==="shadow",q=f.shadowRenderer,j=V&&q?q.getShadowPassDepthMode():new bo(D.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D),X=f.isTileAffectedByFog(w);if(l.meshes)for(const ee of l.meshes){const ae=["MODEL_POSITION_ON_GPU"],be=[];let _e,Te,we;p.instancedDataArray.length>20&&ae.push("INSTANCED_ARRAYS");const Le=Aa(f,r.paint.get("model-cutoff-fade-range"));if(Le.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),V&&q)_e=f.getOrCreateProgram("modelDepth",{defines:ae}),Te=vg(C.shadowTileMatrix,C.shadowTileMatrix,Float32Array.from(l.matrix)),we=q.getShadowPassColorMode();else{pp(ae,be,ee,f,r.lut),_e=f.getOrCreateProgram("model",{defines:ae,overrideFog:X});const je=ee.material,Ye=je.pbrMetallicRoughness,et=r.paint.get("model-opacity"),Xe=r.paint.get("model-emissive-strength").constantOr(0);Te=cp(w.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,f,et,Ye.baseColorFactor.toRenderColor(null),je.emissiveFactor,Ye.metallicFactor,Ye.roughnessFactor,je,Xe,r,b),q&&(C.shadowUniformsInitialized?_e.setShadowUniformValues(D,q.getShadowUniformValues()):(q.setupShadows(w.toUnwrapped(),_e,"model-tile",w.overscaledZ),C.shadowUniformsInitialized=!0)),we=Le.shouldRenderCutoff||et<1||je.alphaMode!=="OPAQUE"?ir.alphaBlended:ir.unblended}f.uploadCommonUniforms(D,_e,w.toUnwrapped(),null,Le);const Ue=ee.material.doubleSided?Po.disabled:Po.backCCW;if(p.instancedDataArray.length>20)be.push(p.instancedDataBuffer),_e.draw(f,D.gl.TRIANGLES,j,Do.disabled,we,Ue,Te,r.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,r.paint,f.transform.zoom,void 0,be,p.instancedDataArray.length);else{const je=V?"u_instance":"u_normal_matrix";for(let Ye=0;Ye<p.instancedDataArray.length;++Ye)Te[je]=new Float32Array(p.instancedDataArray.arrayBuffer,64*Ye,16),_e.draw(f,D.gl.TRIANGLES,j,Do.disabled,we,Ue,Te,r.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,r.paint,f.transform.zoom,void 0,be)}}if(l.children)for(const ee of l.children)py(f,r,ee,p,b,w,C)}const Kh=[1,-1,1];function ui(f,r,l,p){if(!l.modelManager)return!0;const b=l.modelManager;if(!l.shadowRenderer)return!0;const w=l.shadowRenderer,C=r.aabb;let D=!0,V=f.maxHeight;if(V===0){let j=0;for(const X in f.instancesPerModel){const ee=b.getModel(X,p);ee?j=Math.max(j,Math.max(Math.max(ee.aabb.max[0],ee.aabb.max[1]),ee.aabb.max[2])):D=!1}V=f.maxScale*j*1.41+f.maxVerticalOffset,D&&(f.maxHeight=V)}C.max[2]=V,C.min[2]+=f.terrainElevationMin,C.max[2]+=f.terrainElevationMax,o.a6.vec3.transformMat4(C.min,C.min,r.tileMatrix),o.a6.vec3.transformMat4(C.max,C.max,r.tileMatrix);const q=C.intersects(w.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=q===2),q===0}function Mr(f,r){const l=f.uniformValues.u_cutoff_params[0],p=f.uniformValues.u_cutoff_params[1],b=f.uniformValues.u_cutoff_params[2],w=f.uniformValues.u_cutoff_params[3];return p===l||w===b?1:o.ap(((r-l)/(p-l)-b)/(w-b),0,1)}function my(f,r,l,p){if(r.pitch<20)return 1;const b=r.getWorldToCameraMatrix();o.a6.mat4.multiply(b,b,f);const w=o.a6.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),D=C,V=C;w[1]=l.max[1],C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),D=C[1]<D[1]?C:D,V=C[1]>V[1]?C:V,w[0]=l.max[0],C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),D=C[1]<D[1]?C:D,V=C[1]>V[1]?C:V,w[1]=l.min[1],C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),D=C[1]<D[1]?C:D,V=C[1]>V[1]?C:V;const q=o.ap(p[0],0,1),j=100*r.pixelsPerMeter*o.ap(p[1],0,1),X=o.ap(p[2],0,1),ee=o.a6.vec4.lerp(o.a6.vec4.create(),D,V,q),ae=Math.tan(.5*r.fovX),be=-ee[2]*ae;if(j===0)return ee[1]<-Math.abs(be)?X:1;const _e=(-Math.abs(be)-ee[1])/j,Te=(Le,Ue,je)=>(1-je)*Le+je*Ue,we=o.ap(Te(1,X,_e),X,1);return Te(1,we,o.ap((r.pitch-20)/20,0,1))}class uu{}class gp{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,p){{const X=this._storage.get(l.id);if(X)return X.lastUsedFrameIdx=r,X.buf}const b=p.gl,w=b.getBufferParameter(b.ELEMENT_ARRAY_BUFFER,b.BUFFER_SIZE),C=new ArrayBuffer(w),D=new Int16Array(C);b.getBufferSubData(b.ELEMENT_ARRAY_BUFFER,0,new Int16Array(C));const V=new o.dk;for(let X=0;X<w/2;X+=3){const ee=D[X],ae=D[X+1],be=D[X+2];V.emplaceBack(ee,ae),V.emplaceBack(ae,be),V.emplaceBack(be,ee)}const q=p.bindVertexArrayOES.current,j=new uu;return j.buf=new os(p,V),j.lastUsedFrameIdx=r,this._storage.set(l.id,j),p.bindVertexArrayOES.set(q),j.buf}update(r){for(const[l,p]of this._storage)r-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class Pd{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}class kg{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Zh={symbol:function(f,r,l,p,b){if(f.renderPass!=="translucent")return;const w=Do.disabled,C=f.colorModeForRenderPass(),D=l.layout.get("text-variable-anchor"),V=l.layout.get("text-size-scale-range"),q=o.ap(f.scaleFactor,V[0],V[1]);D&&function(ee,ae,be,_e,Te,we,Le,Ue){const je=ae.transform,Ye=Te==="map",et=we==="map";for(const Xe of ee){const nt=_e.getTile(Xe),lt=nt.getBucket(be);if(!lt||!lt.text||!lt.text.segments.get().length)continue;const vt=o.bk(lt.textSizeData,je.zoom,Ue),dt=El(Xe,lt.getProjection(),je),ct=je.calculatePixelsToTileUnitsMatrix(nt),jt=fr(dt,nt.tileID.canonical,et,Ye,je,lt.getProjection(),ct),en=lt.hasIconTextFit()&&lt.hasIconData();if(vt){const gn=Math.pow(2,je.zoom-nt.tileID.overscaledZ);bg(lt,Ye,et,Le,o.cS,je,jt,Xe,gn,vt,en)}}}(p,f,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),b,q);const j=l.paint.get("icon-opacity").constantOr(1)!==0,X=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(j||X)?Gh(f,r,l,p,w,C):(j&&Gh(f,r,l,p,w,C,{onlyIcons:!0}),X&&Gh(f,r,l,p,w,C,{onlyText:!0})),r.map.showCollisionBoxes&&(yg(f,r,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),yg(f,r,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,l,p){if(f.renderPass!=="translucent")return;const b=l.paint.get("circle-opacity"),w=l.paint.get("circle-stroke-width"),C=l.paint.get("circle-stroke-opacity"),D=l.layout.get("circle-sort-key").constantOr(1)!==void 0,V=l.paint.get("circle-emissive-strength");if(b.constantOr(1)===0&&(w.constantOr(1)===0||C.constantOr(1)===0))return;const q=f.context,j=q.gl,X=f.transform,ee=f.depthModeForSublayer(0,bo.ReadOnly),ae=Do.disabled,be=f.colorModeForDrapableLayerRenderPass(V),_e=X.projection.name==="globe",Te=[o.am(X.center.lng),o.at(X.center.lat)],we=[];for(let Ue=0;Ue<p.length;Ue++){const je=p[Ue],Ye=r.getTile(je),et=Ye.getBucket(l);if(!et||et.projection.name!==X.projection.name)continue;const Xe=et.programConfigurations.get(l.id),nt=o.cT(l),lt=f.isTileAffectedByFog(je);_e&&nt.push("PROJECTION_GLOBE_VIEW"),nt.push("DEPTH_D24"),f.terrain&&X.depthOcclusionForSymbolsAndCircles&&nt.push("DEPTH_OCCLUSION");const vt=f.getOrCreateProgram("circle",{config:Xe,defines:nt,overrideFog:lt}),dt=et.layoutVertexBuffer,ct=et.globeExtVertexBuffer,jt=et.indexBuffer,en=X.projection.createInversionMatrix(X,je.canonical),gn={programConfiguration:Xe,program:vt,layoutVertexBuffer:dt,globeExtVertexBuffer:ct,indexBuffer:jt,uniformValues:o.cU(f,je,Ye,en,Te,l),tile:Ye};if(D){const An=et.segments.get();for(const Dn of An)we.push({segments:new o.b2([Dn]),sortKey:Dn.sortKey,state:gn})}else we.push({segments:et.segments,sortKey:0,state:gn})}D&&we.sort((Ue,je)=>Ue.sortKey-je.sortKey);const Le={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const Ue of we){const{programConfiguration:je,program:Ye,layoutVertexBuffer:et,globeExtVertexBuffer:Xe,indexBuffer:nt,uniformValues:lt,tile:vt}=Ue.state,dt=Ue.segments;f.terrain&&f.terrain.setupElevationDraw(vt,Ye,Le),f.uploadCommonUniforms(q,Ye,vt.tileID.toUnwrapped()),Ye.draw(f,j.TRIANGLES,ee,ae,be,Po.disabled,lt,l.id,et,nt,dt,l.paint,X.zoom,je,[Xe])}},heatmap:function(f,r,l,p){if(l.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const b=f.context,w=b.gl,C=Do.disabled,D=new ir([w.ONE,w.ONE,w.ONE,w.ONE],o.bA.transparent,[!0,!0,!0,!0]);(function(ae,be,_e,Te){const we=ae.gl,Le=be.width*Te,Ue=be.height*Te;ae.activeTexture.set(we.TEXTURE1),ae.viewport.set([0,0,Le,Ue]);let je=_e.heatmapFbo;if(!je||je&&(je.width!==Le||je.height!==Ue)){je&&je.destroy();const Ye=we.createTexture();we.bindTexture(we.TEXTURE_2D,Ye),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MAG_FILTER,we.LINEAR),je=_e.heatmapFbo=ae.createFramebuffer(Le,Ue,!0,null),function(et,Xe,nt,lt,vt,dt){const ct=et.gl;ct.texImage2D(ct.TEXTURE_2D,0,et.extRenderToTextureHalfFloat?ct.RGBA16F:ct.RGBA,vt,dt,0,ct.RGBA,et.extRenderToTextureHalfFloat?ct.HALF_FLOAT:ct.UNSIGNED_BYTE,null),lt.colorAttachment.set(nt)}(ae,0,Ye,je,Le,Ue)}else we.bindTexture(we.TEXTURE_2D,je.colorAttachment.get()),ae.bindFramebuffer.set(je.framebuffer)})(b,f,l,f.transform.projection.name==="globe"?.5:.25),b.clear({color:o.bA.transparent});const V=f.transform,q=V.projection.name==="globe",j=q?["PROJECTION_GLOBE_VIEW"]:[],X=q?Po.frontCCW:Po.disabled,ee=[o.am(V.center.lng),o.at(V.center.lat)];for(let ae=0;ae<p.length;ae++){const be=p[ae];if(r.hasRenderableParent(be))continue;const _e=r.getTile(be),Te=_e.getBucket(l);if(!Te||Te.projection.name!==V.projection.name)continue;const we=f.isTileAffectedByFog(be),Le=Te.programConfigurations.get(l.id),Ue=f.getOrCreateProgram("heatmap",{config:Le,defines:j,overrideFog:we}),{zoom:je}=f.transform;f.terrain&&f.terrain.setupElevationDraw(_e,Ue),f.uploadCommonUniforms(b,Ue,be.toUnwrapped());const Ye=V.projection.createInversionMatrix(V,be.canonical);Ue.draw(f,w.TRIANGLES,bo.disabled,C,D,X,pg(f,be,_e,Ye,ee,je,l.paint.get("heatmap-intensity")),l.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,l.paint,f.transform.zoom,Le,q?[Te.globeExtVertexBuffer]:null)}b.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(b,w){const C=b.context,D=C.gl,V=w.heatmapFbo;if(!V)return;C.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,V.colorAttachment.get()),C.activeTexture.set(D.TEXTURE1);let q=w.colorRampTexture;q||(q=w.colorRampTexture=new o.T(C,w.colorRamp,D.RGBA8)),q.bind(D.LINEAR,D.CLAMP_TO_EDGE),b.getOrCreateProgram("heatmapTexture").draw(b,D.TRIANGLES,bo.disabled,Do.disabled,b.colorModeForRenderPass(),Po.disabled,((j,X,ee,ae)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,w),w.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,w.paint,b.transform.zoom)}(f,l))},line:function(f,r,l,p){if(f.renderPass!=="translucent")return;const b=l.paint.get("line-opacity"),w=l.paint.get("line-width");if(b.constantOr(1)===0||w.constantOr(1)===0)return;const C=l.paint.get("line-emissive-strength"),D=l.paint.get("line-occlusion-opacity"),V=l.layout.get("line-elevation-reference")==="sea",q=f.context,j=q.gl,X=!l.isDraped();if(X&&f.transform.projection.name==="globe")return;const ee=l.layout.get("line-cross-slope"),ae=ee!==void 0,be=ee<1,_e=X?new bo(f.depthOcclusion?j.GREATER:j.LEQUAL,bo.ReadOnly,f.depthRangeFor3D):f.depthModeForSublayer(0,bo.ReadOnly),Te=f.colorModeForDrapableLayerRenderPass(C),we=f.terrain&&f.terrain.renderingToTexture,Le=we?1:o.q.devicePixelRatio,Ue=l.paint.get("line-dasharray"),je=Ue.constantOr(1),Ye=l.layout.get("line-cap"),et=Ue.constantOr(null),Xe=Ye.constantOr(null),nt=l.paint.get("line-pattern"),lt=nt.constantOr(1),vt=nt.constantOr(null),dt=l.paint.get("line-opacity").constantOr(1);let ct=!lt&&dt!==1||f.depthOcclusion&&D>0&&D<1;const jt=l.paint.get("line-gradient"),en=lt?"linePattern":"line",gn=o.cV(l);let An;if(we&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ct=!1),D!==0&&f.depthOcclusion){const It=l.paint._values["line-opacity"];It&&It.value&&It.value.kind==="constant"?An=It.value:o.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}if(X&&(f.forceTerrainMode=!0),!X&&D!==0&&f.terrain&&!we)return void o.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`);const Dn=ct&&X?f.stencilModeFor3D():Do.disabled;X&&(gn.push("ELEVATED"),ae&&gn.push(be?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),V&&gn.push("ELEVATION_REFERENCE_SEA"));for(const It of p){const pn=r.getTile(It);if(lt&&!pn.patternsLoaded())continue;const Xt=pn.getBucket(l);if(!Xt)continue;f.prepareDrawTile();const mn=Xt.programConfigurations.get(l.id),xn=f.isTileAffectedByFog(It),hn=f.getOrCreateProgram(en,{config:mn,defines:gn,overrideFog:xn,overrideRtt:!X&&void 0});if(vt&&pn.imageAtlas){const Wn=pn.imageAtlas.patternPositions[vt.toString()];Wn&&mn.setConstantPatternPositions(Wn)}if(!lt&&et&&Xe&&pn.lineAtlas){const Wn=pn.lineAtlas.getDash(et,Xe);Wn&&mn.setConstantPatternPositions(Wn)}let[Vn,fo]=l.paint.get("line-trim-offset");(Xe==="round"||Xe==="square")&&Vn!==fo&&(Vn===0&&(Vn-=1),fo===1&&(fo+=1));const xo=we?It.projMatrix:null,ro=lt?o.cW(f,pn,l,xo,Le,[Vn,fo]):o.cX(f,pn,l,xo,Xt.lineClipsArray.length,Le,[Vn,fo]);if(jt){const Wn=Xt.gradients[l.id];let Ro=Wn.texture;if(l.gradientVersion!==Wn.version){let Ko=256;if(l.stepInterpolant){const mr=r.getSource().maxzoom,Kr=It.canonical.z===mr?Math.ceil(1<<f.transform.maxZoom-It.canonical.z):1;Ko=o.ap(o.cY(Xt.maxLineLength/o.ab*1024*Kr),256,q.maxTextureSize)}Wn.gradient=o.cZ({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Ko,image:Wn.gradient||void 0,clips:Xt.lineClipsArray}),Wn.texture?Wn.texture.update(Wn.gradient):Wn.texture=new o.T(q,Wn.gradient,j.RGBA8),Wn.version=l.gradientVersion,Ro=Wn.texture}q.activeTexture.set(j.TEXTURE1),Ro.bind(l.stepInterpolant?j.NEAREST:j.LINEAR,j.CLAMP_TO_EDGE)}je&&(q.activeTexture.set(j.TEXTURE0),pn.lineAtlasTexture&&pn.lineAtlasTexture.bind(j.LINEAR,j.REPEAT),mn.updatePaintBuffers()),lt&&(q.activeTexture.set(j.TEXTURE0),pn.imageAtlasTexture&&pn.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),mn.updatePaintBuffers()),X&&!V&&f.terrain.setupElevationDraw(pn,hn),f.uploadCommonUniforms(q,hn,It.toUnwrapped());const So=Wn=>{An!=null&&(An.value=dt*D),hn.draw(f,j.TRIANGLES,_e,Wn,Te,Po.disabled,ro,l.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,l.paint,f.transform.zoom,mn,[Xt.layoutVertexBuffer2,Xt.patternVertexBuffer,Xt.zOffsetVertexBuffer]),An!=null&&(An.value=dt)};if(ct&&!X){const Wn=f.stencilModeForClipping(It).ref;Wn===0&&we&&q.clear({stencil:0});const Ro={func:j.EQUAL,mask:255};ro.u_alpha_discard_threshold=.8,So(new Do(Ro,Wn,255,j.KEEP,j.KEEP,j.INVERT)),ro.u_alpha_discard_threshold=0,So(new Do(Ro,Wn,255,j.KEEP,j.KEEP,j.KEEP))}else ct&&X&&(ro.u_alpha_discard_threshold=.001),So(X?Dn:f.stencilModeForClipping(It))}X&&(f.forceTerrainMode=!1),ct&&(f.resetStencilClippingMasks(),we&&q.clear({stencil:0})),D===0||f.depthOcclusion||we||f.layersWithOcclusionOpacity.push(f.currentLayer)},fill:function(f,r,l,p){const b=l.paint.get("fill-color"),w=l.paint.get("fill-opacity"),C=l.is3D(),D=new bo(f.context.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D);if(w.constantOr(1)===0)return;const V=l.paint.get("fill-emissive-strength"),q=f.colorModeForDrapableLayerRenderPass(V),j=l.paint.get("fill-pattern"),X=f.opaquePassEnabledForLayer()&&!j.constantOr(1)&&b.constantOr(o.bA.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===X){const ee=C?D:f.depthModeForSublayer(1,f.renderPass==="opaque"?bo.ReadWrite:bo.ReadOnly);up(f,r,l,p,ee,q,!1)}if(!C&&f.renderPass==="translucent"&&l.paint.get("fill-antialias")){const ee=C?D:f.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,bo.ReadOnly);up(f,r,l,p,ee,q,!0)}},"fill-extrusion":function(f,r,l,p){const b=l.paint.get("fill-extrusion-opacity"),w=f.context,C=w.gl,D=f.terrain,V=D&&D.renderingToTexture;if(b===0)return;const q=f.conflationActive&&f.style.isLayerClipped(l,r.getSource()),j=f.style.order.indexOf(l.fqid);if(q&&function(X,ee,ae,be,_e){for(const Te of be){const we=ee.getTile(Te).getBucket(ae);we&&(we.updateReplacement(Te,X.replacementSource,_e),we.uploadCentroid(X.context))}}(f,r,l,p,j),D||q)for(const X of p){const ee=r.getTile(X).getBucket(l);ee&&sy(f.context,r,X,ee,l,D,q)}if(f.renderPass==="shadow"&&f.shadowRenderer){const X=f.shadowRenderer;if(D&&b<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.a4)return;const ee=X.getShadowPassDepthMode(),ae=X.getShadowPassColorMode();_a(f,r,l,p,ee,Do.disabled,ae,q)}else if(f.renderPass==="translucent"){const X=!l.paint.get("fill-extrusion-pattern").constantOr(1),ee=l.paint.get("fill-extrusion-color").constantOr(o.bA.white);if(!V&&ee.a!==0){const ae=new bo(f.context.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D);b===1&&X?_a(f,r,l,p,ae,Do.disabled,ir.unblended,q):(_a(f,r,l,p,ae,Do.disabled,ir.disabled,q),_a(f,r,l,p,ae,f.stencilModeFor3D(),f.colorModeForRenderPass(),q),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&X&&(!D&&f.transform.projection.name!=="globe"||V)){const ae=l.paint.get("fill-extrusion-opacity"),be=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Te=l.paint.get("fill-extrusion-flood-light-intensity"),we=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),Le=be>0&&_e>0,Ue=Te>0,je=(et,Xe,nt)=>(1-nt)*et+nt*Xe,Ye=et=>{const Xe=f.depthModeForSublayer(1,bo.ReadOnly,C.LEQUAL,!0),nt=l.paint.get(et?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),lt=je(.1,3,nt),vt=f._showOverdrawInspector;if(!vt){const dt=new Do({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),ct=new ir([C.ONE,C.ONE,C.ONE,C.ONE],o.bA.transparent,[!1,!1,!1,!0],C.MIN);ws(f,r,l,p,Xe,dt,ct,Po.disabled,et,"sdf",ae,be,_e,Te,we,lt,q,!1)}{const dt=vt?Do.disabled:new Do({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),ct=vt?f.colorModeForRenderPass():new ir([C.ONE_MINUS_DST_ALPHA,C.DST_ALPHA,C.ONE,C.ONE],o.bA.transparent,[!0,!0,!0,!0]);ws(f,r,l,p,Xe,dt,ct,Po.disabled,et,"color",ae,be,_e,Te,we,lt,q,!1)}};if(V){const et=(Xe,nt,lt)=>{const vt=f.depthModeForSublayer(1,bo.ReadOnly,C.LEQUAL,!1),dt=l.paint.get(Xe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ct=je(.1,3,dt);{const jt=new ir([C.ONE,C.ONE,C.ONE,C.ONE],o.bA.transparent,[!1,!1,!1,!0]);ws(f,r,l,p,vt,Do.disabled,jt,Po.disabled,Xe,"clear",ae,be,_e,Te,we,ct,q,nt)}{const jt=new Do({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),en=new ir([C.ONE,C.ONE,C.ONE,C.ONE],o.bA.transparent,[!1,!1,!1,!0],C.MIN);ws(f,r,l,p,vt,jt,en,Po.disabled,Xe,"sdf",ae,be,_e,Te,we,ct,q,nt)}{const jt=Xe?C.ZERO:C.ONE_MINUS_DST_ALPHA,en=new Do({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),gn=new ir([jt,C.DST_ALPHA,C.ONE_MINUS_DST_ALPHA,C.ZERO],o.bA.transparent,[!0,!0,!0,!0]);ws(f,r,l,p,vt,en,gn,Po.disabled,Xe,"color",ae,be,_e,Te,we,ct,q,nt)}{const jt=new ir([C.ONE,C.ONE,C.ONE,Xe?C.ZERO:C.ONE],o.bA.transparent,[!1,!1,!1,!0],Xe?C.FUNC_ADD:C.MAX);ws(f,r,l,p,vt,Do.disabled,jt,Po.disabled,Xe,"clear",ae,be,_e,Te,we,ct,q,nt,lt)}};if(Le||Ue){let Xe;if(f.prepareDrawTile(),D){const nt=D.drapeBufferSize[0],lt=D.drapeBufferSize[1];Xe=D.framebufferCopyTexture,Xe&&(!Xe||Xe.size[0]===nt&&Xe.size[1]===lt)||(Xe&&Xe.destroy(),Xe=D.framebufferCopyTexture=new o.T(w,new o.r({width:nt,height:lt}),C.RGBA8)),Xe.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.copyTexSubImage2D(C.TEXTURE_2D,0,0,0,0,0,nt,lt)}Le&&et(!0,!1,Xe),Ue&&et(!1,!0,Xe)}}else Le&&Ye(!0),Ue&&Ye(!1),(Le||Ue)&&f.resetStencilClippingMasks()}}},hillshade:function(f,r,l,p){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const b=f.context,w=f.terrain&&f.terrain.renderingToTexture,[C,D]=f.renderPass!=="translucent"||w?[{},p]:f.stencilConfigForOverlap(p);for(const V of D){const q=r.getTile(V);if(q.needsHillshadePrepare&&f.renderPass==="offscreen")$a(f,q,l);else if(f.renderPass==="translucent"){const j=f.depthModeForSublayer(0,bo.ReadOnly),X=l.paint.get("hillshade-emissive-strength"),ee=f.colorModeForDrapableLayerRenderPass(X),ae=w&&f.terrain?f.terrain.stencilModeForRTTOverlap(V):C[V.overscaledZ];ri(f,V,q,l,j,ae,ee)}}b.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,l,p,b,w){if(f.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const C=f.transform.projection.name==="globe",D=l.paint.get("raster-elevation")!==0,V=D&&C;if(f.renderElevatedRasterBackface&&!V)return;const q=f.context,j=q.gl,X=r.getSource(),ee=function(et,Xe,nt,lt){const vt=Xe.paint.get("raster-color"),dt=et.type==="raster-array",ct=[],jt=Xe.paint.get("raster-resampling"),en=Xe.paint.get("raster-color-mix");let gn=Xe.paint.get("raster-color-range");const An=[en[0],en[1],en[2],0],Dn=en[3];let It=jt==="nearest"?lt.NEAREST:lt.LINEAR;if(dt&&(ct.push("RASTER_ARRAY"),vt||ct.push("RASTER_COLOR"),jt==="linear"&&ct.push("RASTER_ARRAY_LINEAR"),It=lt.NEAREST,!gn&&et.rasterLayers)){const pn=et.rasterLayers.find(({id:Xt})=>Xt===Xe.sourceLayer);pn&&pn.fields&&pn.fields.range&&(gn=pn.fields.range)}if(gn=gn||[0,1],vt){ct.push("RASTER_COLOR"),nt.activeTexture.set(lt.TEXTURE2),Xe.updateColorRamp(gn);let pn=Xe.colorRampTexture;pn||(pn=Xe.colorRampTexture=new o.T(nt,Xe.colorRamp,lt.RGBA8)),pn.bind(lt.LINEAR,lt.CLAMP_TO_EDGE)}return{mix:An,range:gn,offset:Dn,defines:ct,resampling:It}}(X,l,q,j);if(X instanceof o.aD&&!p.length&&!C)return;const ae=l.paint.get("raster-emissive-strength"),be=f.colorModeForDrapableLayerRenderPass(ae),_e=f.terrain&&f.terrain.renderingToTexture,Te=!f.options.moving,we=l.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;if(X instanceof o.aD&&!p.length&&(X.onNorthPole||X.onSouthPole)){const et=D?f.stencilModeFor3D():Do.disabled;return void Ei(!!X.onNorthPole,null,f,r,l,ae,ee,Po.disabled,et)}if(!p.length)return;const[Le,Ue]=X instanceof o.aD||_e?[{},p]:f.stencilConfigForOverlap(p),je=Ue[Ue.length-1].overscaledZ;V&&ee.defines.push("PROJECTION_GLOBE_VIEW"),D&&ee.defines.push("RENDER_CUTOFF");const Ye=(et,Xe,nt)=>{for(const lt of et){const vt=lt.toUnwrapped(),dt=r.getTile(lt);if(_e&&(!dt||!dt.hasData()))continue;q.activeTexture.set(j.TEXTURE0);const ct=Tg(dt,X,l,ee);if(!ct||!ct.texture)continue;const{texture:jt,mix:en,offset:gn,tileSize:An,buffer:Dn}=ct;let It,pn;_e?(It=bo.disabled,pn=lt.projMatrix):D?(It=new bo(j.LEQUAL,bo.ReadWrite,f.depthRangeFor3D),pn=C?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix(vt,Te)):(It=f.depthModeForSublayer(lt.overscaledZ-je,l.paint.get("raster-opacity")===1?bo.ReadWrite:bo.ReadOnly,j.LESS),pn=f.transform.calculateProjMatrix(vt,Te));const Xt=f.terrain&&_e?f.terrain.stencilModeForRTTOverlap(lt):Le[lt.overscaledZ],mn=w?0:l.paint.get("raster-fade-duration");dt.registerFadeDuration(mn);const xn=r.findLoadedParent(lt,0),hn=op(dt,xn,r,f.transform,mn);let Vn,fo;f.terrain&&f.terrain.prepareDrawTile(),q.activeTexture.set(j.TEXTURE0),jt.bind(we,j.CLAMP_TO_EDGE),q.activeTexture.set(j.TEXTURE1),xn?(xn.texture&&xn.texture.bind(we,j.CLAMP_TO_EDGE),Vn=Math.pow(2,xn.tileID.overscaledZ-dt.tileID.overscaledZ),fo=[dt.tileID.canonical.x*Vn%1,dt.tileID.canonical.y*Vn%1]):jt.bind(we,j.CLAMP_TO_EDGE),jt.useMipmap&&q.extTextureFilterAnisotropic&&f.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,q.extTextureFilterAnisotropicMax);const xo=f.transform;let ro;const So=D?dp(xo):[0,0,0,0];let Wn,Ro,Ko,mr,Kr,Sr=0;if(V&&X instanceof o.aD&&X.coordinates.length>3)Wn=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0)))),Ro=Float32Array.from(xo.globeMatrix),Ko=Float32Array.from(o.cy(xo)),mr=[o.am(xo.center.lng),o.at(xo.center.lat)],ro=X.elevatedGlobePerspectiveTransform,Kr=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(V){const sr=o.cz(lt.canonical);Sr=o.cA(sr.getCenter().lat),Wn=Float32Array.from(o.b6(o.cC(lt.canonical))),Ro=Float32Array.from(xo.globeMatrix),Ko=Float32Array.from(o.cy(xo)),mr=[o.am(xo.center.lng),o.at(xo.center.lat)],ro=[0,0],Kr=Float32Array.from(o.cB(lt.canonical,sr,Sr,xo.worldSize/xo._pixelsPerMercatorPixel))}else ro=X instanceof o.aD?X.perspectiveTransform:[0,0],Wn=new Float32Array(16),Ro=new Float32Array(9),Ko=new Float32Array(16),mr=[0,0],Kr=new Float32Array(9);const ii=ap(pn,Wn,Ro,Ko,Kr,fo||[0,0],o.a9(f.transform.zoom),mr,So,Vn||1,hn,l,ro,D?l.paint.get("raster-elevation"):0,2,en,gn,ee.range,An,Dn,ae),Ar=f.isTileAffectedByFog(lt),Zr=f.getOrCreateProgram("raster",{defines:ee.defines,overrideFog:Ar});if(f.uploadCommonUniforms(q,Zr,vt),X instanceof o.aD){const sr=X.elevatedGlobeVertexBuffer,Gr=X.elevatedGlobeIndexBuffer;if(_e||!C)X.boundsBuffer&&X.boundsSegments&&Zr.draw(f,j.TRIANGLES,It,Do.disabled,be,Po.disabled,ii,l.id,X.boundsBuffer,f.quadTriangleIndexBuffer,X.boundsSegments);else if(sr&&Gr){const Ur=xo.zoom<=o.c3?X.elevatedGlobeSegments:X.getSegmentsForLongitude(xo.center.lng);Ur&&Zr.draw(f,j.TRIANGLES,It,Do.disabled,be,Xe,ii,l.id,sr,Gr,Ur)}}else if(V){It=new bo(j.LEQUAL,bo.ReadOnly,f.depthRangeFor3D);const sr=f.globeSharedBuffers;if(sr){const[Gr,Ur,Lr]=sr.getGridBuffers(Sr,!1);Zr.draw(f,j.TRIANGLES,It,nt||Xt,f.colorModeForRenderPass(),Xe,ii,l.id,Gr,Ur,Lr)}}else{const{tileBoundsBuffer:sr,tileBoundsIndexBuffer:Gr,tileBoundsSegments:Ur}=f.getTileBoundsBuffers(dt);Zr.draw(f,j.TRIANGLES,It,Xt,be,Po.disabled,ii,l.id,sr,Gr,Ur)}}if(!(X instanceof o.aD)&&V)for(const lt of et){const vt=lt.canonical.y===(1<<lt.canonical.z)-1;lt.canonical.y===0&&Ei(!0,lt,f,r,l,ae,ee,Xe,nt||Do.disabled),vt&&Ei(!1,lt,f,r,l,ae,ee,Xe===Po.frontCW?Po.backCW:Po.frontCW,nt||Do.disabled)}};V?Ye(Ue,f.renderElevatedRasterBackface?Po.backCW:Po.frontCW,f.stencilModeFor3D()):Ye(Ue,Po.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,r,l,p,b,w){f.renderPass==="offscreen"&&function(C,D,V,q){if(!q.length)return;const j=C.context,X=j.gl,ee=D.getSource();if(!(ee instanceof ps))return;const ae=Math.ceil(Math.sqrt(V.paint.get("raster-particle-count")));let be=V.particlePositionRGBAImage;if(!be||be.width!==ae){const Ue=function(je){const Ye=je*je,et=new Uint8Array(4*Ye),Xe=function(lt){return lt|=0,lt=Math.imul(2747636419^lt,2654435769),lt=Math.imul(lt^lt>>>16,2654435769),((lt=Math.imul(lt^lt>>>16,2654435769))>>>0)/4294967296},nt=1/1.1;for(let lt=0;lt<Ye;lt++){const vt=nt*(Xe(2*lt+0)+Fu),dt=nt*(Xe(2*lt+1)+Fu),ct=255*vt%1,jt=255*dt%1,en=ct,gn=dt-jt/255,An=jt;et[4*lt+0]=255*(vt-ct/255),et[4*lt+1]=255*en,et[4*lt+2]=255*gn,et[4*lt+3]=255*An}return et}(ae);be=V.particlePositionRGBAImage=new o.r({width:ae,height:ae},Ue)}let _e=V.particleFramebuffer;_e?_e.width!==ae&&(_e.destroy(),_e=V.particleFramebuffer=j.createFramebuffer(ae,ae,!0,null)):_e=V.particleFramebuffer=j.createFramebuffer(ae,ae,!0,null);const Te=[];for(const Ue of q){const je=D.getTile(Ue);if(!(je instanceof lc))continue;const Ye=dy(je,ee,V);if(!Ye)continue;const et=[je.tileSize,je.tileSize];let Xe=V.tileFramebuffer;Xe||(Xe=V.tileFramebuffer=j.createFramebuffer(et[0],et[1],!0,null));let nt=je.rasterParticleState;nt||(nt=je.rasterParticleState=new uy(j,Ue,et,be));const lt=nt.update(V.lastInvalidatedAt);nt.particleTextureDimension!==ae&&nt.updateParticleTexture(Ue,be);const vt=nt.targetColorTexture;nt.targetColorTexture=nt.backgroundColorTexture,nt.backgroundColorTexture=vt;const dt=nt.particleTexture0;nt.particleTexture0=nt.particleTexture1,nt.particleTexture1=dt,Te.push([Ue,Ye,nt,lt])}if(Te.length===0)return;const we=o.q.now(),Le=V.previousDrawTimestamp?.001*(we-V.previousDrawTimestamp):.0167;if(V.previousDrawTimestamp=we,V.hasColorMap()){j.activeTexture.set(X.TEXTURE0+2);let Ue=V.colorRampTexture;Ue||(Ue=V.colorRampTexture=new o.T(j,V.colorRamp,X.RGBA8)),Ue.bind(X.LINEAR,X.CLAMP_TO_EDGE)}j.bindFramebuffer.set(V.tileFramebuffer.framebuffer),function(Ue,je,Ye){const et=Ue.context,Xe=et.gl,nt=je.tileFramebuffer;et.activeTexture.set(Xe.TEXTURE0);const lt={u_texture:0,u_opacity:1.05*(dt=je.paint.get("raster-particle-fade-opacity-factor"))/(dt+.05)},vt=Ue.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var dt;for(const ct of Ye){const[,,jt,en]=ct;nt.colorAttachment.set(jt.targetColorTexture.texture),et.viewport.set([0,0,nt.width,nt.height]),et.clear({color:o.bA.transparent}),en&&(jt.backgroundColorTexture.bind(Xe.NEAREST,Xe.CLAMP_TO_EDGE),vt.draw(Ue,Xe.TRIANGLES,bo.disabled,Do.disabled,ir.alphaBlended,Po.disabled,lt,je.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments))}}(C,V,Te),function(Ue,je,Ye,et){const Xe=Ue.context,nt=Xe.gl,lt=Ye.tileFramebuffer,vt=Ue.transform.projection.name==="globe",dt=Ye.paint.get("raster-particle-max-speed");for(const ct of et){const[jt,en,gn]=ct;Xe.activeTexture.set(nt.TEXTURE0+0),en.texture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE),lt.colorAttachment.set(gn.targetColorTexture.texture);const An=Ue.getOrCreateProgram("rasterParticleDraw",{defines:en.defines,overrideFog:!1});Xe.activeTexture.set(nt.TEXTURE0+1);const Dn=en.scalarData?[]:[0,1,2,3].map(Xt=>o.c$[Xt](jt));Dn.push(jt);const It=jt.canonical.x,pn=jt.canonical.y;for(const Xt of Dn){const mn=je.getTile(vt?Xt.wrapped():Xt);if(!mn)continue;const xn=mn.rasterParticleState;if(!xn)continue;const hn=Xt.canonical.x+(1<<Xt.canonical.z)*(Xt.wrap-jt.wrap),Vn=Xt.canonical.y;xn.particleTexture0.bind(nt.NEAREST,nt.CLAMP_TO_EDGE);const fo=lp(1,xn.particleTexture0.size[0],[hn-It,Vn-pn],0,en.texture.size,2,dt,en.textureOffset,en.scale,en.offset);An.draw(Ue,nt.POINTS,bo.disabled,Do.disabled,ir.alphaBlended,Po.disabled,fo,Ye.id,xn.particleIndexBuffer,void 0,xn.particleSegment)}}}(C,D,V,Te),j.bindFramebuffer.set(V.particleFramebuffer.framebuffer),function(Ue,je,Ye,et){const Xe=Ue.context,nt=Xe.gl,lt=je.paint.get("raster-particle-max-speed"),vt=et*je.paint.get("raster-particle-speed-factor")*.15,dt=function(jt){return Math.pow(jt,6)}(.01+1*je.paint.get("raster-particle-reset-rate-factor")),ct=je.particleFramebuffer;Xe.viewport.set([0,0,ct.width,ct.height]);for(const jt of Ye){const[,en,gn]=jt;Xe.activeTexture.set(nt.TEXTURE0+0),en.texture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE),Xe.activeTexture.set(nt.TEXTURE0+1);const An=gn.particleTexture0;An.bind(nt.NEAREST,nt.CLAMP_TO_EDGE);const Dn=mg(1,An.size[0],0,en.texture.size,lt,vt,dt,en.textureOffset,en.scale,en.offset);ct.colorAttachment.set(gn.particleTexture1.texture),Xe.clear({color:o.bA.transparent}),Ue.getOrCreateProgram("rasterParticleUpdate",{defines:en.defines}).draw(Ue,nt.TRIANGLES,bo.disabled,Do.disabled,ir.unblended,Po.disabled,Dn,je.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments)}}(C,V,Te,Le)}(f,r,l,p),f.renderPass==="translucent"&&(function(C,D,V,q,j){const X=C.context,ee=X.gl,ae=D.getSource().tileSize,be=5*(1-o.a7(o.bV,o.bV+1,C.transform.zoom))*ae+V.paint.get("raster-particle-elevation"),_e=!C.options.moving,Te=C.transform.projection.name==="globe";if(!q.length)return;const[we,Le]=C.stencilConfigForOverlap(q),Ue=[];Te&&Ue.push("PROJECTION_GLOBE_VIEW");const je=C.stencilModeFor3D();for(const Ye of Le){const et=Ye.toUnwrapped(),Xe=D.getTile(Ye);if(!Xe.rasterParticleState)continue;const nt=Xe.rasterParticleState,lt=100;Xe.registerFadeDuration(lt);const vt=D.findLoadedParent(Ye,0),dt=op(Xe,vt,D,C.transform,lt);let ct,jt;C.terrain&&C.terrain.prepareDrawTile(),X.activeTexture.set(ee.TEXTURE0),nt.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),X.activeTexture.set(ee.TEXTURE1),vt&&vt.rasterParticleState?(vt.rasterParticleState.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),ct=Math.pow(2,vt.tileID.overscaledZ-Xe.tileID.overscaledZ),jt=[Xe.tileID.canonical.x*ct%1,Xe.tileID.canonical.y*ct%1]):nt.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const en=Te?Float32Array.from(C.transform.expandedFarZProjMatrix):C.transform.calculateProjMatrix(et,_e),gn=C.transform,An=L1(gn),Dn=o.cz(Ye.canonical),It=o.cA(Dn.getCenter().lat);let pn,Xt,mn,xn,hn;Te?(pn=Float32Array.from(o.b6(o.cC(Ye.canonical))),Xt=Float32Array.from(gn.globeMatrix),mn=Float32Array.from(o.cy(gn)),xn=[o.am(gn.center.lng),o.at(gn.center.lat)],hn=Float32Array.from(o.cB(Ye.canonical,Dn,It,gn.worldSize/gn._pixelsPerMercatorPixel))):(pn=new Float32Array(16),Xt=new Float32Array(9),mn=new Float32Array(16),xn=[0,0],hn=new Float32Array(9));const Vn=sp(en,pn,Xt,mn,hn,jt||[0,0],o.a9(C.transform.zoom),xn,An,ct||1,dt,be),fo=C.isTileAffectedByFog(Ye),xo=C.getOrCreateProgram("rasterParticle",{defines:Ue,overrideFog:fo});if(C.uploadCommonUniforms(X,xo,et),Te){const ro=new bo(ee.LEQUAL,bo.ReadOnly,C.depthRangeFor3D),So=0,Wn=C.globeSharedBuffers;if(Wn){const[Ro,Ko,mr]=Wn.getGridBuffers(It,So!==0);xo.draw(C,ee.TRIANGLES,ro,je,ir.alphaBlended,C.renderElevatedRasterBackface?Po.frontCCW:Po.backCCW,Vn,V.id,Ro,Ko,mr)}}else{const ro=C.depthModeForSublayer(0,bo.ReadOnly),So=we[Ye.overscaledZ],{tileBoundsBuffer:Wn,tileBoundsIndexBuffer:Ro,tileBoundsSegments:Ko}=C.getTileBoundsBuffers(Xe);xo.draw(C,ee.TRIANGLES,ro,So,ir.alphaBlended,Po.disabled,Vn,V.id,Wn,Ro,Ko)}}C.resetStencilClippingMasks()}(f,r,l,p),f.style.map.triggerRepaint())},background:function(f,r,l,p){const b=l.paint.get("background-color"),w=l.paint.get("background-opacity"),C=l.paint.get("background-emissive-strength"),D=l.paint.get("background-pitch-alignment")==="viewport";if(w===0)return;const V=f.context,q=V.gl,j=f.transform,X=j.tileSize,ee=l.paint.get("background-pattern");let ae;if(ee!==void 0&&(ee===null||(ae=f.imageManager.getPattern(ee.toString(),l.scope,f.style.getLut(l.scope)),!ae)))return;const be=!ee&&b.a===1&&w===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==be)return;const _e=Do.disabled,Te=f.depthModeForSublayer(0,be==="opaque"?bo.ReadWrite:bo.ReadOnly),we=f.colorModeForDrapableLayerRenderPass(C),Le=ee?"backgroundPattern":"background";let Ue,je=p;if(je||(Ue=f.getBackgroundTiles(),je=Object.values(Ue).map(Ye=>Ye.tileID)),ee&&(V.activeTexture.set(q.TEXTURE0),f.imageManager.bind(f.context,l.scope)),D){const Ye=f.getOrCreateProgram(Le,{overrideFog:!1,overrideRtt:!0}),et=new Float32Array(o.a6.mat4.identity([])),Xe=new o.aA(0,0,0,0,0),nt=ee?jh(et,C,w,f,0,l.scope,ae,D,{tileID:Xe,tileSize:X}):Bu(et,C,w,b.toRenderColor(l.lut));Ye.draw(f,q.TRIANGLES,Te,_e,we,Po.disabled,nt,l.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const Ye of je){const et=f.isTileAffectedByFog(Ye),Xe=f.getOrCreateProgram(Le,{overrideFog:et}),nt=Ye.toUnwrapped(),lt=p?Ye.projMatrix:f.transform.calculateProjMatrix(nt);f.prepareDrawTile();const vt=r?r.getTile(Ye):Ue?Ue[Ye.key]:new Ns(Ye,X,j.zoom,f),dt=ee?jh(lt,C,w,f,0,l.scope,ae,D,{tileID:Ye,tileSize:X}):Bu(lt,C,w,b.toRenderColor(l.lut));f.uploadCommonUniforms(V,Xe,nt);const{tileBoundsBuffer:ct,tileBoundsIndexBuffer:jt,tileBoundsSegments:en}=f.getTileBoundsBuffers(vt);Xe.draw(f,q.TRIANGLES,Te,_e,we,Po.disabled,dt,l.id,ct,jt,en)}},sky:function(f,r,l){const p=f._atmosphere?o.a9(f.transform.zoom):1,b=l.paint.get("sky-opacity")*p;if(b===0)return;const w=f.context,C=l.paint.get("sky-type"),D=new bo(w.gl.LEQUAL,bo.ReadOnly,[0,1]),V=f.frameCounter/1e3%1;C==="atmosphere"?f.renderPass==="offscreen"?l.needsSkyboxCapture(f)&&(function(q,j,X,ee){const ae=q.context,be=ae.gl;let _e=j.skyboxFbo;if(!_e){_e=j.skyboxFbo=ae.createFramebuffer(32,32,!0,null),j.skyboxGeometry=new Mg(ae),j.skyboxTexture=ae.gl.createTexture(),be.bindTexture(be.TEXTURE_CUBE_MAP,j.skyboxTexture),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_MIN_FILTER,be.LINEAR),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_MAG_FILTER,be.LINEAR);for(let Ue=0;Ue<6;++Ue)be.texImage2D(be.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,be.RGBA,32,32,0,be.RGBA,be.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(_e.framebuffer),ae.viewport.set([0,0,32,32]);const Te=j.getCenter(q,!0),we=q.getOrCreateProgram("skyboxCapture"),Le=new Float64Array(16);o.a6.mat4.identity(Le),o.a6.mat4.rotateY(Le,Le,.5*-Math.PI),fl(q,j,we,Le,Te,0),o.a6.mat4.identity(Le),o.a6.mat4.rotateY(Le,Le,.5*Math.PI),fl(q,j,we,Le,Te,1),o.a6.mat4.identity(Le),o.a6.mat4.rotateX(Le,Le,.5*-Math.PI),fl(q,j,we,Le,Te,2),o.a6.mat4.identity(Le),o.a6.mat4.rotateX(Le,Le,.5*Math.PI),fl(q,j,we,Le,Te,3),o.a6.mat4.identity(Le),fl(q,j,we,Le,Te,4),o.a6.mat4.identity(Le),o.a6.mat4.rotateY(Le,Le,Math.PI),fl(q,j,we,Le,Te,5),ae.viewport.set([0,0,q.width,q.height])}(f,l),l.markSkyboxValid(f)):f.renderPass==="sky"&&function(q,j,X,ee,ae){const be=q.context,_e=be.gl,Te=q.transform,we=q.getOrCreateProgram("skybox");be.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,j.skyboxTexture);const Le=((Ue,je,Ye,et,Xe)=>({u_matrix:Ue,u_sun_direction:je,u_cubemap:0,u_opacity:et,u_temporal_offset:Xe}))(Te.skyboxMatrix,j.getCenter(q,!1),0,ee,ae);q.uploadCommonUniforms(be,we),we.draw(q,_e.TRIANGLES,X,Do.disabled,q.colorModeForRenderPass(),Po.backCW,Le,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,l,D,b,V):C==="gradient"&&f.renderPass==="sky"&&function(q,j,X,ee,ae){const be=q.context,_e=be.gl,Te=q.transform,we=q.getOrCreateProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new Mg(be)),be.activeTexture.set(_e.TEXTURE0);let Le=j.colorRampTexture;Le||(Le=j.colorRampTexture=new o.T(be,j.colorRamp,_e.RGBA8)),Le.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Ue=((je,Ye,et,Xe,nt)=>({u_matrix:je,u_color_ramp:0,u_center_direction:Ye,u_radius:o.bC(et),u_opacity:Xe,u_temporal_offset:nt}))(Te.skyboxMatrix,j.getCenter(q,!1),j.paint.get("sky-gradient-radius"),ee,ae);q.uploadCommonUniforms(be,we),we.draw(q,_e.TRIANGLES,X,Do.disabled,q.colorModeForRenderPass(),Po.backCW,Ue,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,l,D,b,V)},debug:function(f,r,l,p,b,w){for(let C=0;C<l.length;C++)if(b){const q=new o.bA(p.r*.8,p.g*.8,p.b*.8,1);ci(f,r,l[C],p,-1,-1,w),ci(f,r,l[C],p,-1,1,w),ci(f,r,l[C],p,1,1,w),ci(f,r,l[C],p,1,-1,w),ci(f,r,l[C],q,0,0,w)}else ci(f,r,l[C],p,0,0,w)},custom:function(f,r,l,p){const b=f.context,w=l.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&l.isDraped(r)){if(f.renderPass==="offscreen"){const C=w.prerender;if(C){if(f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const D=f.transform.pointMerc;C.call(w,b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[D.x,D.y],f.transform.pixelsPerMeterRatio)}else C.call(w,b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const D=w.renderToTile;if(D){const V=p[0].canonical,q=new o.a5(V.x+p[0].wrap*(1<<V.z),V.y,V.z);b.setDepthMode(bo.disabled),b.setStencilMode(Do.disabled),b.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),D.call(w,b.gl,q),b.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),b.setStencilMode(Do.disabled);const C=w.renderingMode==="3d"?new bo(f.context.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,bo.ReadOnly);if(b.setDepthMode(C),f.transform.projection.name==="globe"){const D=f.transform.pointMerc;w.render(b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[D.x,D.y],f.transform.pixelsPerMeterRatio)}else w.render(b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState(),b.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,r,l,p){if(f.renderPass==="opaque")return;const b=l.paint.get("model-opacity");if(b===0)return;const w=l.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!w||f.terrain&&b<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof o.a4))return;const C=f.shadowRenderer,D=l.paint.get("model-receive-shadows");C&&(C.useNormalOffset=!0,D||(C.enabled=!1));const V=()=>{C&&(C.useNormalOffset=!0,D||(C.enabled=!0))},q=r.getSource();if(f.renderPass==="light-beam"&&q.type!=="batched-model")return;if(q.type==="vector"||q.type==="geojson")return function(we,Le,Ue,je,Ye){const et=we.transform;if(et.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${et.projection.name} projection is not yet implemented`);const Xe=et.getFreeCameraOptions().position;if(!we.modelManager)return;const nt=we.modelManager;Ue.modelManager=nt;const lt=we.shadowRenderer;if(!Ue._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const vt=Ue._unevaluatedLayout._values["model-id"],dt={...Ue.layout.get("model-id").parameters},ct=we.style.order.indexOf(Ue.fqid);for(const jt of je){const en=Le.getTile(jt).getBucket(Ue);if(!en||en.projection.name!==et.projection.name)continue;const gn=en.getModelUris();gn&&!en.modelsRequested&&(nt.addModelsFromBucket(gn,Ye),en.modelsRequested=!0);const An=Va(jt,et);dt.zoom=An;const Dn=vt.possiblyEvaluate(dt);if(fy(we,en,jt),Nl.shadowUniformsInitialized=!1,Nl.useSingleShadowCascade=!!lt&&lt.getMaxCascadeForTile(jt.toUnwrapped())===0,we.renderPass==="shadow"&&lt){if(we.currentShadowCascade===1&&en.isInsideFirstShadowMapFrustum)continue;const Xt=et.calculatePosMatrix(jt.toUnwrapped(),et.worldSize);if(Nl.tileMatrix.set(Xt),Nl.shadowTileMatrix=Float32Array.from(lt.calculateShadowPassMatrixFromMatrix(Xt)),Nl.aabb.min.fill(0),Nl.aabb.max[0]=Nl.aabb.max[1]=o.ab,Nl.aabb.max[2]=0,ui(en,Nl,we,Ue.scope))continue}const It=1<<jt.canonical.z,pn=[((Xe.x-jt.wrap)*It-jt.canonical.x)*o.ab,(Xe.y*It-jt.canonical.y)*o.ab,Xe.z*It*o.ab];we.conflationActive&&Object.keys(en.instancesPerModel).length>0&&we.style.isLayerClipped(Ue,Le.getSource())&&en.updateReplacement(jt,we.replacementSource,ct,Ye)&&(en.uploaded=!1,en.upload(we.context));for(let Xt in en.instancesPerModel){const mn=en.instancesPerModel[Xt];mn.features.length>0&&(Xt=Dn.evaluate(mn.features[0].feature,{}));const xn=nt.getModel(Xt,Ye);if(xn&&xn.uploaded)for(const hn of xn.nodes)py(we,Ue,hn,mn,pn,jt,Nl)}}}(f,r,l,p,q.type==="vector"?l.scope:""),void V();if(!q.loaded())return;if(q.type==="batched-model")return function(we,Le,Ue,je){Ue.resetLayerRenderingStats(we);const Ye=we.context,et=we.transform,Xe=we.style.fog,nt=we.shadowRenderer;if(et.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${et.projection.name} projection is not yet implemented`);const lt=we.transform.getFreeCameraOptions().position,vt=o.a6.vec3.scale([],[lt.x,lt.y,lt.z],we.transform.worldSize),dt=o.a6.vec3.negate([],vt),ct=o.a6.mat4.identity([]),jt=o.de(et.center.lat,et.zoom),en=o.a6.mat4.fromScaling([],[1,1,1/jt]);o.a6.mat4.translate(ct,ct,dt);const gn=Ue.paint.get("model-opacity"),An=new bo(Ye.gl.LEQUAL,bo.ReadWrite,we.depthRangeFor3D),Dn=new bo(Ye.gl.LEQUAL,bo.ReadOnly,we.depthRangeFor3D),It=new o.ca([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),pn=we.renderPass==="shadow",Xt=pn&&nt?nt.getCurrentCascadeFrustum():et.getFrustum(et.scaleZoom(et.worldSize)),mn=Ue.paint.get("model-front-cutoff"),xn=mn[2]<1,hn=Aa(we,Ue.paint.get("model-cutoff-fade-range")),Vn=Ue.getLayerRenderingStats();(function(fo,xo,ro,So){const Wn=fo.terrain?fo.terrain.exaggeration():0,Ro=fo.transform.zoom;for(const Ko of So){const mr=xo.getTile(Ko).getBucket(ro);mr&&(fo.conflationActive&&mr.updateReplacement(Ko,fo.replacementSource),mr.evaluateScale(fo,ro),fo.terrain&&Wn>0&&mr.elevationUpdate(fo.terrain,Wn,Ko,ro.source),mr.needsReEvaluation(fo,Ro,ro)&&mr.evaluate(ro))}})(we,Le,Ue,je),function(){let fo,xo,ro;xn?(fo=je.length-1,xo=-1,ro=-1):(fo=0,xo=je.length,ro=1);const So=new Float64Array(16),Wn=o.a6.vec3.create(),Ro=new o.P(0,0);for(let Ko=fo;Ko!==xo;Ko+=ro){const mr=je[Ko],Kr=Le.getTile(mr).getBucket(Ue);if(!Kr||!Kr.uploaded)continue;let Sr=!1;nt&&(Sr=nt.getMaxCascadeForTile(mr.toUnwrapped())===0);const ii=et.calculatePosMatrix(mr.toUnwrapped(),et.worldSize),Ar=Kr.modelTraits;!pn&&xn&&(o.a6.mat4.invert(So,ii),o.a6.vec3.transformMat4(Wn,vt,So),Ro.x=Wn[0],Ro.y=Wn[1]);const Zr=[];for(const sr of Kr.getNodesInfo()){if(sr.hiddenByReplacement||!sr.node.meshes)continue;const Gr=sr.node;let Ur=0;we.terrain&&Gr.elevation&&(Ur=Gr.elevation*we.terrain.exaggeration());const Lr=(()=>{const Pi=sr.aabb;return It.min=[...Pi.min],It.max=[...Pi.max],It.min[2]+=Ur,It.max[2]+=Ur,o.a6.vec3.transformMat4(It.min,It.min,ii),o.a6.vec3.transformMat4(It.max,It.max,ii),It})(),fi=sr.evaluatedScale;if(fi[0]<=1&&fi[1]<=1&&fi[2]<=1&&Lr.intersects(Xt)===0)continue;if(!pn&&xn){const Pi=.16666666666666666;sr.cameraCollisionOpacity=vt[0]>Lr.min[0]&&vt[0]<Lr.max[0]&&vt[1]>Lr.min[1]&&vt[1]<Lr.max[1]&&vt[2]*jt<Lr.max[2]&&Gr.footprint&&o.bv(Ro,Gr.footprint)?Math.max(sr.cameraCollisionOpacity-Pi,0):Math.min(1,sr.cameraCollisionOpacity+Pi)}const Yi=[...ii],Ts=Gr.anchor?Gr.anchor[0]:0,Ks=Gr.anchor?Gr.anchor[1]:0;o.a6.mat4.translate(Yi,Yi,[Ts*(fi[0]-1),Ks*(fi[1]-1),Ur]),o.a6.vec3.exactEquals(fi,o.dh)||o.a6.mat4.scale(Yi,Yi,fi);const ea=o.a6.mat4.multiply([],Yi,Gr.matrix),wr=o.a6.mat4.multiply([],et.expandedFarZProjMatrix,ea),_r=o.a6.mat4.multiply([],et.expandedFarZProjMatrix,Yi),kr=o.a6.vec4.transformMat4([],[Ts,Ks,Ur,1],wr)[2];Gr.hidden=!1;let Jr=gn;pn||(xn&&(Jr*=sr.cameraCollisionOpacity,Jr*=my(Yi,et,sr.aabb,mn)),Jr*=Mr(hn,kr)),Jr!==0?Zr.push({nodeInfo:sr,depth:kr,opacity:Jr,wvpForNode:wr,wvpForTile:_r,nodeModelMatrix:ea,tileModelMatrix:Yi}):Gr.hidden=!0}pn||Zr.sort((sr,Gr)=>!xn||sr.opacity===1&&Gr.opacity===1?sr.depth<Gr.depth?-1:1:sr.opacity===1?-1:Gr.opacity===1?1:sr.depth>Gr.depth?-1:1);for(const sr of Zr){const Gr=sr.nodeInfo,Ur=Gr.node;let Lr=o.a6.mat4.multiply([],en,sr.tileModelMatrix);o.a6.mat4.multiply(Lr,ct,Lr);const fi=o.a6.mat4.invert([],Lr);o.a6.mat4.transpose(fi,fi),o.a6.mat4.scale(fi,fi,Kh),Lr=o.a6.mat4.multiply(Lr,Lr,Ur.matrix);const Yi=we.renderPass==="light-beam",Ts=Ar&o.dj.HasMapboxMeshFeatures,Ks=Ts?0:Gr.evaluatedRMEA[0][2];for(let ea=0;ea<Ur.meshes.length;++ea){const wr=Ur.meshes[ea],_r=ea===Ur.lightMeshIndex;let kr=sr.wvpForNode;if(_r){if(!Yi&&!we.terrain&&we.shadowRenderer){we.currentLayer<we.firstLightBeamLayer&&(we.firstLightBeamLayer=we.currentLayer);continue}kr=sr.wvpForTile}else if(Yi)continue;const Jr={defines:[]},Pi=[];if(!pn&&nt&&(nt.useNormalOffset=!!wr.normalBuffer),pp(Jr.defines,Pi,wr,we,Ue.lut),Ts||Jr.defines.push("DIFFUSE_SHADED"),Sr&&Jr.defines.push("SHADOWS_SINGLE_CASCADE"),Vn&&(pn?Vn.numRenderedVerticesInShadowPass+=wr.vertexArray.length:Vn.numRenderedVerticesInTransparentPass+=wr.vertexArray.length),pn){mp(wr,sr.nodeModelMatrix,we,Ue);continue}let pi=null;if(Xe){const ml=Ag(sr.nodeModelMatrix,we.transform);if(pi=new Float32Array(ml),et.projection.name!=="globe"){const as=wr.aabb.min,kc=wr.aabb.max,[Ys,Fr]=Xe.getOpacityForBounds(ml,as[0],as[1],kc[0],kc[1]);Jr.overrideFog=Ys>=gt||Fr>=gt}}const ra=wr.material;let Ul;ra.occlusionTexture&&ra.occlusionTexture.offsetScale&&(Ul=ra.occlusionTexture.offsetScale,Jr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const rs=we.getOrCreateProgram("model",Jr);!pn&&nt&&nt.setupShadowsFromMatrix(sr.tileModelMatrix,rs,nt.useNormalOffset),we.uploadCommonUniforms(Ye,rs,null,pi);const is=ra.pbrMetallicRoughness;is.metallicFactor=.9,is.roughnessFactor=.5;const Zs=cp(new Float32Array(kr),new Float32Array(Lr),new Float32Array(fi),new Float32Array(Ur.matrix),we,sr.opacity,is.baseColorFactor.toRenderColor(null),ra.emissiveFactor,is.metallicFactor,is.roughnessFactor,ra,Ks,Ue,[0,0,0],Ul);!_r&&(Gr.hasTranslucentParts||sr.opacity<1)&&rs.draw(we,Ye.gl.TRIANGLES,An,Do.disabled,ir.disabled,Po.backCCW,Zs,Ue.id,wr.vertexBuffer,wr.indexBuffer,wr.segments,Ue.paint,we.transform.zoom,void 0,Pi),rs.draw(we,Ye.gl.TRIANGLES,_r?Dn:An,Do.disabled,_r||sr.opacity<1||Gr.hasTranslucentParts?ir.alphaBlended:ir.unblended,Po.backCCW,Zs,Ue.id,wr.vertexBuffer,wr.indexBuffer,wr.segments,Ue.paint,we.transform.zoom,void 0,Pi)}}}}()}(f,r,l,p),void V();if(q.type!=="model")return;const j=q.getModels(),X=[],ee=f.transform.getFreeCameraOptions().position,ae=o.a6.vec3.scale([],[ee.x,ee.y,ee.z],f.transform.worldSize);o.a6.vec3.negate(ae,ae);const be=[],_e=[];let Te=0;for(const we of j){const Le=l.paint.get("model-rotation").constantOr(null),Ue=l.paint.get("model-scale").constantOr(null),je=l.paint.get("model-translation").constantOr(null);we.computeModelMatrix(f,Le,Ue,je,!0,!0,!1);const Ye=o.a6.mat4.identity([]),et=o.de(we.position.lat,f.transform.zoom),Xe=o.a6.mat4.fromScaling([],[1,1,1/et]);o.a6.mat4.translate(Ye,Ye,ae),X.push({zScaleMatrix:Xe,negCameraPosMatrix:Ye});for(const nt of we.nodes)qh(f.transform,nt,we.matrix,f.transform.expandedFarZProjMatrix,Te,be,_e);Te++}if(be.sort((we,Le)=>Le.depth-we.depth),f.renderPass!=="shadow"){if(b===1)for(const we of _e)Vu(we,f,l,X[we.modelIndex],Do.disabled,f.colorModeForRenderPass());else{for(const we of _e)Vu(we,f,l,X[we.modelIndex],Do.disabled,ir.disabled);for(const we of _e)Vu(we,f,l,X[we.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const we of be)Vu(we,f,l,X[we.modelIndex],Do.disabled,f.colorModeForRenderPass());V()}else{for(const we of _e)mp(we.mesh,we.nodeModelMatrix,f,l);for(const we of be)mp(we.mesh,we.nodeModelMatrix,f,l);V()}}},Tc={model:function(f,r,l){const p=r.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,p.type==="vector"?f.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const b=p.getModels();for(const w of b)w.upload(l.context)},raster:function(f,r,l){const p=r.getSource();if(!(p instanceof ps&&p.loaded()))return;const b=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!b)return;const w=f.paint.get("raster-array-band")||p.getInitialBand(b);if(w==null)return;const C=r.getIds().map(D=>r.getTileByID(D));for(const D of C)D.updateNeeded(b,w)&&p.prepareTile(D,b,w)},"raster-particle":function(f,r,l){const p=r.getSource();if(!(p instanceof ps&&p.loaded()))return;const b=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!b)return;const w=f.paint.get("raster-particle-array-band")||p.getInitialBand(b);if(w==null)return;const C=r.getIds().map(D=>r.getTileByID(D));for(const D of C)D.updateNeeded(b,w)&&p.prepareTile(D,b,w)}};class du{constructor(r,l,p,b,w){this.context=new R1(r,l),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=o.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const C=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const V of C)this._debugParams.enabledLayers[V]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const V of C)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],V);this.occlusionParams=new Pd(w),this.setup(),this.numSublayers=Ve.maxUnderzooming+Ve.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Rl(this),this._wireframeDebugCache=new gp,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const D=new o.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,D,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=b}updateTerrain(r,l){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new sg(this,r));const b=this._terrain;this.transform.elevation=p?b:null,b.update(r,this.transform,l),this.transform.elevation&&!b.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,b]=l.getFovAdjustedRange(this.transform._fov);if(p>b)return void(this.transform.fogCullDistSq=null);const w=p+.78*(b-p);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new sg(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*o.q.devicePixelRatio,this.height=l*o.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const r=this.context,l=new o.a$;l.emplaceBack(0,0),l.emplaceBack(o.ab,0),l.emplaceBack(0,o.ab),l.emplaceBack(o.ab,o.ab),this.tileExtentBuffer=r.createVertexBuffer(l,o.b1.members),this.tileExtentSegments=o.b2.simpleSegment(0,0,4,2);const p=new o.a$;p.emplaceBack(0,0),p.emplaceBack(o.ab,0),p.emplaceBack(0,o.ab),p.emplaceBack(o.ab,o.ab),this.debugBuffer=r.createVertexBuffer(p,o.b1.members),this.debugSegments=o.b2.simpleSegment(0,0,4,5);const b=new o.a$;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(b,o.b1.members),this.viewportSegments=o.b2.simpleSegment(0,0,4,2);const w=new o.aO;w.emplaceBack(0,0,0,0),w.emplaceBack(o.ab,0,o.ab,0),w.emplaceBack(0,o.ab,0,o.ab),w.emplaceBack(o.ab,o.ab,o.ab,o.ab),this.mercatorBoundsBuffer=r.createVertexBuffer(w,o.b4.members),this.mercatorBoundsSegments=o.b2.simpleSegment(0,0,4,2);const C=new o.aP;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(C);const D=new o.b0;for(const q of[0,1,3,2,0])D.emplaceBack(q);this.debugIndexBuffer=r.createIndexBuffer(D),this.emptyTexture=new o.T(r,new o.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=o.a6.mat4.create();const V=this.context.gl;this.stencilClearMode=new Do({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,bo.disabled,this.stencilClearMode,ir.disabled,Po.disabled,$h(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,p){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const V of p)if(this._tileClippingMaskIDs[V.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=l.id;const b=this.context,w=b.gl;this.nextStencilID+p.length>256&&this.clearStencil(),b.setColorMode(ir.disabled),b.setDepthMode(bo.disabled);const C=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of p){const V=l.getTile(D),q=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:X,tileBoundsSegments:ee}=this.getTileBoundsBuffers(V);C.draw(this,w.TRIANGLES,bo.disabled,new Do({func:w.ALWAYS,mask:0},q,255,w.KEEP,w.KEEP,w.REPLACE),ir.disabled,Po.disabled,$h(D.projMatrix),"$clipping",j,X,ee)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Do({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Do({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,p=r.sort((C,D)=>D.overscaledZ-C.overscaledZ),b=p[p.length-1].overscaledZ,w=p[0].overscaledZ-b+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const C={};for(let D=0;D<w;D++)C[D+b]=new Do({func:l.GEQUAL,mask:255},D+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[C,p]}return[{[b]:Do.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new ir([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new o.bA(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ir.unblended:ir.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new ir([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new o.bA(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,p,b=!1){if(this.depthOcclusion)return new bo(this.context.gl.GREATER,bo.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!b)return bo.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new bo(p||this.context.gl.LEQUAL,l,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),p=Math.ceil(this.height),b=this.context.bindFramebuffer.get(),w=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&p!==0&&(this.depthFBO=new iy(this.context,l,p,!1,"texture"),this.depthTexture=new o.T(this.context,{width:l,height:p,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(b),r.bindTexture(r.TEXTURE_2D,w),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,p,0,0,l,p,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const p=o.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const b=this.style._mergedLayers,w=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(dt=>{const ct=b[dt];return!(ct.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[ct.type]});let C=!1,D=!1;for(const dt of w){const ct=b[dt];ct.type==="circle"&&(C=!0),ct.type==="symbol"&&(ct.hasInitialOcclusionOpacityProperties?D=!0:C=!0)}const V=w.map(dt=>b[dt]),q=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.q.now()),this.imageManager.beginFrame();let j=0,X=!1;for(const dt in q){const ct=q[dt];ct.used&&(ct.prepare(this.context),ct.getSource().usedInConflation&&++j)}let ee=!1;for(const dt of V)dt.isHidden(this.transform.zoom)||(dt.type==="clip"&&(ee=!0),this.prepareLayer(dt));const ae={},be={},_e={},Te={},we={};for(const dt in q){const ct=q[dt];ae[dt]=ct.getVisibleCoordinates(),be[dt]=ae[dt].slice().reverse(),_e[dt]=ct.getVisibleCoordinates(!0).reverse(),Te[dt]=ct.getShadowCasterCoordinates(),we[dt]=ct.sortCoordinatesByDistance(ae[dt])}const Le=dt=>{const ct=this.style.getLayerSourceCache(dt);return ct&&ct.used?ct.getSource():null};if(j||ee||this._clippingActiveLastFrame){const dt=[],ct=[];let jt=0;for(const en of V)this.isSourceForClippingOrConflation(en,Le(en))&&(dt.push(en),ct.push(jt)),jt++;if(dt&&(ee||dt.length>1)||this._clippingActiveLastFrame){ee=!1;const en=[];for(let gn=0;gn<dt.length;gn++){const An=dt[gn],Dn=ct[gn],It=this.style.getLayerSourceCache(An);if(!It||!It.used||!It.getSource().usedInConflation&&An.type!=="clip")continue;let pn=o.dn,Xt=o.bt.None;const mn=[];let xn=!0;if(An.type==="clip"){pn=Dn;for(const hn of An.layout.get("clip-layer-types"))Xt|=hn==="model"?o.bt.Model:hn==="symbol"?o.bt.Symbol:o.bt.FillExtrusion;for(const hn of An.layout.get("clip-layer-scope"))mn.push(hn);An.isHidden(this.transform.zoom)?xn=!1:ee=!0}xn&&en.push({layer:An.fqid,cache:It,order:pn,clipMask:Xt,clipScope:mn})}this.replacementSource.setSources(en),X=!0}}this._clippingActiveLastFrame=ee,X||this.replacementSource.clear(),this.conflationActive=X,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let dt=0;dt<V.length;dt++){const ct=V[dt],jt=ct.cutoffRange();if(this.longestCutoffRange=Math.max(jt,this.longestCutoffRange),jt>0){const en=Le(ct);en&&(this.minCutoffZoom=Math.max(en.minzoom,this.minCutoffZoom)),ct.minzoom&&(this.minCutoffZoom=Math.max(ct.minzoom,this.minCutoffZoom))}ct.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=dt),this._lastOcclusionLayer=dt)}const Ue=this.style&&this.style.fog;Ue?(this._fogVisible=Ue.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ue.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0);const je=this._shadowRenderer;if(je){je.updateShadowParameters(this.transform,this.style.directionalLight);for(const dt in q)for(const ct of ae[dt]){let jt={min:0,max:0};this.terrain&&(jt=this.terrain.getMinMaxForTile(ct)||jt),je.addShadowReceiver(ct.toUnwrapped(),jt.min,jt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Ig(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!dn.has(this.context.gl))return;this.renderPass="offscreen";for(const dt of V){const ct=r.getLayerSourceCache(dt);if(!dt.hasOffscreenPass()||dt.isHidden(this.transform.zoom))continue;const jt=ct?be[ct.id]:void 0;(dt.type==="custom"||dt.type==="raster"||dt.type==="raster-particle"||dt.isSky()||jt&&jt.length)&&this.renderLayer(this,ct,dt,jt)}this.depthRangeFor3D=[0,1-(V.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ye=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),et=(()=>{if(l.showOverdrawInspector)return o.bA.black;const dt=this.style.fog;if(dt&&this.transform.projection.supportsFog){const ct=this.style.getLut(dt.scope);if(!Ye){const jt=dt.properties.get("color").toRenderColor(ct).toArray01();return new o.bA(...jt)}if(Ye){const jt=dt.properties.get("space-color").toRenderColor(ct).toArray01();return new o.bA(...jt)}}return o.bA.transparent})();if(this.context.clear({color:et,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ye&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const dt=V[this.currentLayer],ct=r.getLayerSourceCache(dt);if(dt.isSky())continue;const jt=ct?(dt.is3D()?we:be)[ct.id]:void 0;this._renderTileClippingMasks(dt,ct,jt),this.renderLayer(this,ct,dt,jt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ye&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const dt=V[this.currentLayer],ct=r.getLayerSourceCache(dt);dt.isSky()&&this.renderLayer(this,ct,dt,ct?be[ct.id]:void 0)}function Xe(dt,ct){let jt;return ct&&(jt=(dt.type==="symbol"?_e:dt.is3D()?we:be)[ct.id]),jt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<w.length;){const dt=V[this.currentLayer];if(dt.type==="raster"||dt.type==="raster-particle"){const ct=r.getLayerSourceCache(dt);this.renderLayer(this,ct,dt,Xe(dt,ct))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let nt=0;je&&(nt=je.getShadowCastingLayerCount());let lt=!1,vt=-1;for(let dt=0;dt<w.length;++dt){const ct=V[dt];ct.isHidden(this.transform.zoom)||ct.is3D()&&(vt=dt)}for(D&&vt===-1&&(C=!0);this.currentLayer<w.length;){const dt=V[this.currentLayer],ct=r.getLayerSourceCache(dt);if(dt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(dt)){if(dt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(C&&!lt&&this.terrain&&!this.transform.isOrthographic&&(lt=!0,this.blitDepth()),D&&vt!==-1&&this.currentLayer===vt+1&&!this.transform.isOrthographic&&this.blitDepth(),dt.is3D()||this.terrain||this._renderTileClippingMasks(dt,ct,ct?ae[ct.id]:void 0),this.renderLayer(this,ct,dt,Xe(dt,ct)),!this.terrain&&je&&nt>0&&dt.hasShadowPass()&&--nt==0&&(je.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const jt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=jt;this.currentLayer++){const en=V[this.currentLayer];if(!en.hasLightBeamPass())continue;const gn=r.getLayerSourceCache(en);this.renderLayer(this,gn,en,gn?be[gn.id]:void 0)}this.currentLayer=jt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const jt=this.currentLayer;this.depthOcclusion=!0;for(const en of this.layersWithOcclusionOpacity){this.currentLayer=en;const gn=V[this.currentLayer],An=r.getLayerSourceCache(gn),Dn=An?be[An.id]:void 0;gn.is3D()||this.terrain||this._renderTileClippingMasks(gn,An,An?ae[An.id]:void 0),this.renderLayer(this,An,gn,Dn)}this.depthOcclusion=!1,this.currentLayer=jt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let dt=null;V.forEach(ct=>{const jt=r.getLayerSourceCache(ct);jt&&!ct.isHidden(this.transform.zoom)&&jt.getVisibleCoordinates().length&&(!dt||dt.getSource().maxzoom<jt.getSource().maxzoom)&&(dt=jt)}),dt&&this.options.showTileBoundaries&&Zh.debug(this,dt,dt.getVisibleCoordinates(),o.bA.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Zh.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.bA(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(dt){const ct=dt.transform.padding;Lt(dt,dt.transform.height-(ct.top||0),3,Id),Lt(dt,ct.bottom||0,3,Ad),Cg(dt,ct.left||0,3,Rn),Cg(dt,dt.transform.width-(ct.right||0),3,_o);const jt=dt.transform.centerPoint;(function(en,gn,An,Dn){$u(en,gn-1,An-10,2,20,Dn),$u(en,gn-10,An-1,20,2,Dn)})(dt,jt.x,dt.transform.height-jt.y,kd)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),X||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,p=!l||!l.includes(r.type);if(Tc[r.type]&&(p||this.terrain&&r.type==="custom")){const b=this.style.getLayerSourceCache(r);Tc[r.type](r,b,this)}this.gpuTimingEnd()}renderLayer(r,l,p,b){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||b&&b.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)&&(!r.terrain||p.type!=="custom")||p.type==="clip"||Zh[p.type](r,l,p,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,p=this.context.gl;let b=this.gpuTimers[r.id];b||(b=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:p.createQuery()}),b.calls++,p.beginQuery(l.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,p=l.createQuery();this.deferredRenderGpuTimeQueries.push(p),l.beginQuery(r.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const p in r){const b=r[p],w=this.context.extTimerQuery,C=w.getQueryParameter(b.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(b.query),l[p]=C}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let p=0;for(const b of r)p+=l.getQueryParameter(b,l.QUERY_RESULT)/1e6,l.deleteQuery(b);return p}translatePosMatrix(r,l,p,b,w){if(!p[0]&&!p[1])return r;const C=w?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(C){const q=Math.sin(C),j=Math.cos(C);p=[p[0]*j-p[1]*q,p[0]*q+p[1]*j]}const D=[w?p[0]:o.ak(l,p[0],this.transform.zoom),w?p[1]:o.ak(l,p[1],this.transform.zoom),0],V=new Float32Array(16);return o.a6.mat4.translate(V,r,D),V}saveTileTexture(r){const l=r.size[0],p=this._tileTextures[l];p?p.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,p){const b=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,w=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):b||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||b||l!==void 0&&!l||w.push("FOG","FOG_DITHERING"),b&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(r,l){this.cache=this.cache||{};const p=l&&l.defines||[],b=l&&l.config,w=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(p),C=wc.cacheKey(ns[r],r,w,b);return this.cache[C]||(this.cache[C]=new wc(this.context,r,ns[r],b,Nu[r],w)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const p=this.style.directionalLight,b=this.style.ambientLight;if(p&&b){const w=((C,D,V)=>{const q=C.properties.get("direction"),j=C.properties.get("color").toRenderColor(V.getLut(C.scope)).toArray01(),X=C.properties.get("intensity"),ee=D.properties.get("color").toRenderColor(V.getLut(D.scope)).toArray01(),ae=D.properties.get("intensity"),be=[q.x,q.y,q.z],_e=o.cH(ee,ae),Te=o.cH(j,X);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:be,u_lighting_directional_color:Te,u_ground_radiance:lg(be,Te,_e)}})(p,b,this.style);l.setLightsUniformValues(r,w)}}}uploadCommonUniforms(r,l,p,b,w){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const D=C.getOpacity(this.transform.pitch),V=((q,j,X,ee,ae,be,_e,Te,we,Le,Ue,je)=>{const Ye=q.transform,et=j.properties.get("color").toRenderColor(q.style.getLut(j.scope)).toArray01();et[3]=ee;const Xe=q.frameCounter/1e3%1,[nt,lt]=j.properties.get("vertical-range");return{u_fog_matrix:X?Ye.calculateFogTileMatrix(X):je||q.identityMat,u_fog_range:j.getFovAdjustedRange(Ye._fov),u_fog_color:et,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(nt,lt),lt],u_fog_temporal_offset:Xe,u_frustum_tl:ae,u_frustum_tr:be,u_frustum_br:_e,u_frustum_bl:Te,u_globe_pos:we,u_globe_radius:Le,u_viewport:Ue,u_globe_transition:o.a9(Ye.zoom),u_is_globe:+(Ye.projection.name==="globe")}})(this,C,p,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.q.devicePixelRatio,this.transform.height*o.q.devicePixelRatio],b);l.setFogUniformValues(r,V)}w&&l.setCutoffUniformValues(r,w.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const b of p)l[b.key]=r[b.key]||new Ns(b,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=gt||l[1]>=gt}setupDepthForOcclusion(r,l,p){const b=this.context,w=b.gl,C=!!p;var D;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),b.activeTexture.set(w.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((D=this.depthRangeFor3D)[1]-D[0]),-1-2*D[0]/(D[1]-D[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),b.activeTexture.set(w.TEXTURE0),C||l.setTerrainUniformValues(b,p)}}function Cc(f,r){let l=!1,p=null;const b=()=>{p=null,l&&(f(),p=setTimeout(b,r),l=!1)};return()=>(l=!0,p||b(),p)}class vp{constructor(r){this._hashName=r&&encodeURIComponent(r),o.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Cc(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=Yh(r);if(this._hashName){const p=this._hashName;let b=!1;const w=location.hash.slice(1).split("&").map(C=>{const D=C.split("=")[0];return D===p?(b=!0,`${D}=${l}`):C}).filter(C=>C);return b||w.push(`${p}=${l}`),`#${w.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Yh(f,r){const l=f.getCenter(),p=Math.round(100*f.getZoom())/100,b=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,b),C=Math.round(l.lng*w)/w,D=Math.round(l.lat*w)/w,V=f.getBearing(),q=f.getPitch();let j=r?`/${C}/${D}/${p}`:`${p}/${D}/${C}`;return(V||q)&&(j+="/"+Math.round(10*V)/10),q&&(j+=`/${Math.round(q)}`),j}const Rd={linearity:.3,easing:o.dp(0,0,.3,1)},Pg=o.l({deceleration:2500,maxSpeed:1400},Rd),Rg=o.l({deceleration:20,maxSpeed:1400},Rd),hu=o.l({deceleration:1e3,maxSpeed:360},Rd),Og=o.l({deceleration:1e3,maxSpeed:90},Rd);class _p{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=o.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(l.pan.mag()){const w=Ld(l.pan.mag(),p,o.l({},Pg,r||{}));b.offset=l.pan.mult(w.amount/l.pan.mag()),b.center=this._map.transform.center,Od(b,w)}if(l.zoom){const w=Ld(l.zoom,p,Rg);b.zoom=this._map.transform.zoom+w.amount,Od(b,w)}if(l.bearing){const w=Ld(l.bearing,p,hu);b.bearing=this._map.transform.bearing+o.ap(w.amount,-179,179),Od(b,w)}if(l.pitch){const w=Ld(l.pitch,p,Og);b.pitch=this._map.transform.pitch+w.amount,Od(b,w)}if(b.zoom||b.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;b.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function Od(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function Ld(f,r,l){const{maxSpeed:p,linearity:b,deceleration:w}=l,C=o.ap(f*b/(r/1e3),-p,p),D=Math.abs(C)/(w*b);return{easing:l.easing,duration:1e3*D,amount:C*(D/2)}}class bi extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p,b={}){const w=me(l.getCanvasContainer(),p),C=l.unproject(w);super(r,o.l({point:w,lngLat:C,originalEvent:p},b)),this._defaultPrevented=!1,this.target=l}}class Dd extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){const b=r==="touchend"?p.changedTouches:p.touches,w=fe(l.getCanvasContainer(),b),C=w.map(V=>l.unproject(V)),D=w.reduce((V,q,j,X)=>V.add(q.div(X.length)),new o.P(0,0));super(r,{points:w,point:D,lngLats:C,lngLat:l.unproject(D),originalEvent:p}),this._defaultPrevented=!1}}class Lg extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class zd{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new Lg(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new bi(r.type,this._map,r))}mouseup(r){this._map.fire(new bi(r.type,this._map,r))}preclick(r){const l=o.l({},r);l.type="preclick",this._map.fire(new bi(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new bi(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new bi(r.type,this._map,r))}mouseover(r){this._map.fire(new bi(r.type,this._map,r))}mouseout(r){this._map.fire(new bi(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Dd(r.type,this._map,r))}touchmove(r){this._map.fire(new Dd(r.type,this._map,r))}touchend(r){this._map.fire(new Dd(r.type,this._map,r))}touchcancel(r){this._map.fire(new Dd(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Uu{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new bi(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new bi(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Dg{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(G(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const p=l,b=this._startPos,w=this._lastPos;if(!b||!w||w.equals(p)||!this._box&&p.dist(b)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=z("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const C=Math.min(b.x,p.x),D=Math.max(b.x,p.x),V=Math.min(b.y,p.y),q=Math.max(b.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${V}px)`,this._box.style.width=D-C+"px",this._box.style.height=q-V+"px")})}mouseupWindow(r,l){if(!this._active)return;const p=this._startPos,b=l;if(p&&r.button===0){if(this.reset(),le(),p.x!==b.x||p.y!==b.y)return this._map.fire(new o.x("boxzoomend",{originalEvent:r})),{cameraAnimation:w=>w.fitScreenCoordinates(p,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Q(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new o.x(r,{originalEvent:l}))}}function yp(f,r){const l={};for(let p=0;p<f.length;p++)l[f[p].identifier]=r[p];return l}class gy{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(b){const w=new o.P(0,0);for(const C of b)w._add(C);return w.div(b.length)}(l),this.touches=yp(p,l)))}touchmove(r,l,p){if(this.aborted||!this.centroid)return;const b=yp(p,l);for(const w in this.touches){const C=b[w];(!C||C.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(r,l,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Xh{constructor(r){this.singleTap=new gy(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,p){this.singleTap.touchstart(r,l,p)}touchmove(r,l,p){this.singleTap.touchmove(r,l,p)}touchend(r,l,p){const b=this.singleTap.touchend(r,l,p);if(b){const w=r.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(b)<30;if(w&&C||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class zg{constructor(){this._zoomIn=new Xh({numTouches:1,numTaps:2}),this._zoomOut=new Xh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,p){this._zoomIn.touchstart(r,l,p),this._zoomOut.touchstart(r,l,p)}touchmove(r,l,p){this._zoomIn.touchmove(r,l,p),this._zoomOut.touchmove(r,l,p)}touchend(r,l,p){const b=this._zoomIn.touchend(r,l,p),w=this._zoomOut.touchend(r,l,p);return b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(b)},{originalEvent:r})}):w?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(w)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Jh={0:1,2:2};class Qh{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const p=ce(r);this._correctButton(r,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(r,l){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(b,w){const C=Jh[w];return b.buttons===void 0||(b.buttons&C)!==C}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}}mouseupWindow(r){this._lastPoint&&ce(r)===this._eventButton&&(this._moved&&le(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bp extends Qh{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class xp extends Qh{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=.8*(l.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class wp extends Qh{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=-.5*(l.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class vy{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),o.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(r,l,p){return this._calculateTransform(r,l,p)}touchmove(r,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!o.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,p)}}touchend(r,l,p){this._calculateTransform(r,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,p){p.length>0&&(this._active=!0);const b=yp(p,l),w=new o.P(0,0),C=new o.P(0,0);let D=0;for(const q in b){const j=b[q],X=this._touches[q];X&&(w._add(j),C._add(j.sub(X)),D++,b[q]=j)}if(this._touches=b,D<this._minTouches||!C.mag())return;const V=C.div(D);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(D),panDelta:V}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=z("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Sp{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,p){return{}}touchstart(r,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,p){const b=this._firstTwoTouches;if(!b)return;r.preventDefault();const[w,C]=b,D=ef(p,l,w),V=ef(p,l,C);if(!D||!V)return;const q=this._aroundCenter?null:D.add(V).div(2);return this._move([D,V],q,r)}touchend(r,l,p){if(!this._firstTwoTouches)return;const[b,w]=this._firstTwoTouches,C=ef(p,l,b),D=ef(p,l,w);C&&D||(this._active&&le(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ef(f,r,l){for(let p=0;p<f.length;p++)if(f[p].identifier===l)return r[p]}function Fg(f,r){return Math.log(f/r)/Math.LN2}class _y extends Sp{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Fg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fg(this._distance,p),pinchAround:l}}}function Bg(f,r){return 180*f.angleWith(r)/Math.PI}class yy extends Sp{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Bg(this._vector,p),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const b=Bg(r,p);return Math.abs(b)<l}}function Tp(f){return Math.abs(f.y)>Math.abs(f.x)}class by extends Sp{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Tp(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,p){const b=this._lastPoints;if(!b)return;const w=r[0].sub(b[0]),C=r[1].sub(b[1]);return this._map._cooperativeGestures&&!o.dq()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(w,C,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(w.y+C.y)/2*-.5})}gestureBeginsVertically(r,l,p){if(this._valid!==void 0)return this._valid;const b=r.mag()>=2,w=l.mag()>=2;if(!b&&!w)return;if(!b||!w)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const C=r.y>0==l.y>0;return Tp(r)&&Tp(l)&&C}}const xy={panStep:100,bearingStep:15,pitchStep:10};class wy{constructor(){const r=xy;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,p=0,b=0,w=0,C=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),w=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),w=1);break;case 38:r.shiftKey?b=1:(r.preventDefault(),C=-1);break;case 40:r.shiftKey?b=-1:(r.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(p=0,b=0),{cameraAnimation:D=>{const V=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:Sy,zoom:l?Math.round(V)+l*(r.shiftKey?2:1):V,bearing:D.getBearing()+p*this._bearingStep,pitch:D.getPitch()+b*this._pitchStep,offset:[-w*this._panStep,-C*this._panStep],center:D.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Sy(f){return f*(2-f)}const Ng=4.000244140625,F1=1/450;class B1{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=F1,o.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=o.q.now(),b=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%Ng==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(b*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=me(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const q=this._type==="wheel"&&Math.abs(this._delta)>Ng?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*q)));this._delta<0&&j!==0&&(j=1/j);const X=l(),ee=Math.pow(2,X),ae=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):ee;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(ae*j))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l(),b=this._startZoom,w=this._easing;let C,D=!1;if(this._type==="wheel"&&b&&w){const q=Math.min((o.q.now()-this._lastWheelEventTime)/200,1),j=w(q);C=o.aa(b,p,j),q<1?this._frameId||(this._frameId=!0):D=!0}else C=p,D=!0;this._active=!0,D&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let V=C-l();return V*this._lastDelta<0&&(V=0),{noInertia:!0,needsRenderFrame:!D,zoomDelta:V,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=o.dr;if(this._prevEase){const p=this._prevEase,b=(o.q.now()-p.start)/p.duration,w=p.easing(b+.01)-p.easing(b),C=.27/Math.sqrt(w*w+1e-4)*.01,D=Math.sqrt(.0729-C*C);l=o.dp(C,D,.25,1)}return this._prevEase={start:o.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=z("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ki{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ty{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class N1{constructor(){this._tap=new Xh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,l,p))}touchmove(r,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const b=l[0],w=b.y-this._swipePoint.y;return this._swipePoint=b,r.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(r,l,p)}touchend(r,l,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,l,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $1{constructor(r,l,p){this._el=r,this._mousePan=l,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class tf{constructor(r,l,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Cy{constructor(r,l,p,b){this._el=r,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Fd=f=>f.zoom||f.drag||f.pitch||f.rotate;class Cp extends o.x{}class Ec{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const p=o.a6.vec3.sub([],l,r);this.radius=o.a6.vec3.length(p[2]<0?o.a6.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){o.a6.vec3.div(r,r,this.constants),o.a6.vec3.normalize(r,r),o.a6.vec3.mul(r,r,this.constants);const l=o.a6.vec3.scale([],r,this.radius);if(l[2]>0){const p=o.a6.vec3.scale([],[0,0,1],o.a6.vec3.dot(l,[0,0,1])),b=o.a6.vec3.scale([],o.a6.vec3.normalize([],[l[0],l[1],0]),this.radius),w=o.a6.vec3.add([],l,o.a6.vec3.scale([],o.a6.vec3.sub([],o.a6.vec3.add([],b,p),l),2));l[0]=w[0],l[1]=w[1]}return l}}function ju(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Qi{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _p(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ec,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),o.aJ(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,w,C]of this._listeners){const D=b===document?this.handleWindowEvent:this.handleEvent;b.addEventListener(w,D,C)}}destroy(){for(const[r,l,p]of this._listeners){const b=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,b,p)}}_addDefaultHandlers(r){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new zd(l,r));const b=l.boxZoom=new Dg(l,r);this._add("boxZoom",b);const w=new zg,C=new Ty;l.doubleClickZoom=new ki(C,w),this._add("tapZoom",w),this._add("clickZoom",C);const D=new N1;this._add("tapDragZoom",D);const V=l.touchPitch=new by(l);this._add("touchPitch",V);const q=new xp(r),j=new wp(r);l.dragRotate=new tf(r,q,j),this._add("mouseRotate",q,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const X=new bp(r),ee=new vy(l,r);l.dragPan=new $1(p,X,ee),this._add("mousePan",X),this._add("touchPan",ee,["touchZoom","touchRotate"]);const ae=new yy,be=new _y;l.touchZoomRotate=new Cy(p,be,ae,D),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Uu(l));const _e=l.scrollZoom=new B1(l,this);this._add("scrollZoom",_e,["mousePan"]);const Te=l.keyboard=new wy;this._add("keyboard",Te);for(const we of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[we]&&l[we].enable(r[we])}_add(r,l,p){this._handlers.push({handlerName:r,handler:l,allowed:p}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,p){for(const b in r)if(b!==p&&(!l||l.indexOf(b)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const p of r)this._el.contains(p.target)&&l.push(p);return l}handleEvent(r,l){this._updatingCamera=!0;const p=r.type==="renderFrame",b=p?void 0:r,w={needsRenderFrame:!1},C={},D={},V=r.touches?this._getMapTouches(r.touches):void 0,q=V?fe(this._el,V):p?void 0:me(this._el,r);for(const{handlerName:ee,handler:ae,allowed:be}of this._handlers){if(!ae.isEnabled())continue;let _e;this._blockedByActive(D,be,ee)?ae.reset():ae[l||r.type]&&(_e=ae[l||r.type](r,q,V),this.mergeHandlerResult(w,C,_e,ee,b),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||ae.isActive())&&(D[ee]=ae)}const j={};for(const ee in this._previousActiveHandlers)D[ee]||(j[ee]=b);this._previousActiveHandlers=D,(Object.keys(j).length||ju(w))&&(this._changes.push([w,C,j]),this._triggerRenderFrame()),(Object.keys(D).length||ju(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=w;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(r,l,p,b,w){if(!p)return;o.l(r,p);const C={handlerName:b,originalEvent:p.originalEvent||w};p.zoomDelta!==void 0&&(l.zoom=C),p.panDelta!==void 0&&(l.drag=C),p.pitchDelta!==void 0&&(l.pitch=C),p.bearingDelta!==void 0&&(l.rotate=C)}_applyChanges(){const r={},l={},p={};for(const[b,w,C]of this._changes)b.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(b.panDelta)),b.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(r.around=b.around),b.aroundCoord!==void 0&&(r.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(r.pinchAround=b.pinchAround),b.noInertia&&(r.noInertia=b.noInertia),o.l(l,w),o.l(p,C);this._updateMapTransform(r,l,p),this._changes=[]}_updateMapTransform(r,l,p){const b=this._map,w=b.transform,C=Le=>[Le.x,Le.y,Le.z];if((Le=>{const Ue=this._eventsInProgress.drag;return Ue&&!this._handlersById[Ue.handlerName].isActive()})()&&!ju(r)){const Le=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),Le!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&b._stop(!0),!ju(r))return void this._fireEvents(l,p,!0);let{panDelta:D,zoomDelta:V,bearingDelta:q,pitchDelta:j,around:X,aroundCoord:ee,pinchAround:ae}=r;w._isCameraConstrained&&(V>0&&(V=0),w._isCameraConstrained=!1),ae!==void 0&&(X=ae),(V||(Le=>l[Le]&&!this._eventsInProgress[Le])("drag"))&&X&&(this._dragOrigin=C(w.pointCoordinate3D(X)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",b._stop(!0),X=X||b.transform.centerPoint,q&&(w.bearing+=q),j&&(w.pitch+=j),w._updateCameraState();const be=[0,0,0];if(D)if(w.projection.name==="mercator"){const Le=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(X).dir),Ue=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(X.sub(D)).dir);be[0]=Ue[0]-Le[0],be[1]=Ue[1]-Le[1]}else{const Le=w.pointCoordinate(X);if(w.projection.name==="globe"){D=D.rotate(-w.angle);const Ue=w._pixelsPerMercatorPixel/w.worldSize;be[0]=-D.x*o.ds(o.aN(Le.y))*Ue,be[1]=-D.y*o.ds(w.center.lat)*Ue}else{const Ue=w.pointCoordinate(X.sub(D));Le&&Ue&&(be[0]=Ue.x-Le.x,be[1]=Ue.y-Le.y)}}const _e=w.zoom,Te=[0,0,0];if(V){const Le=C(ee||w.pointCoordinate3D(X)),Ue={dir:o.a6.vec3.normalize([],o.a6.vec3.sub([],Le,w._camera.position))};if(Ue.dir[2]<0){const je=w.zoomDeltaToMovement(Le,V);o.a6.vec3.scale(Te,Ue.dir,je)}}const we=o.a6.vec3.add(be,be,Te);w._translateCameraConstrained(we),V&&Math.abs(w.zoom-_e)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,p,!0)}_fireEvents(r,l,p){const b=Fd(this._eventsInProgress),w=Fd(r),C={};for(const j in r){const{originalEvent:X}=r[j];this._eventsInProgress[j]||(C[`${j}start`]=X),this._eventsInProgress[j]=r[j]}!b&&w&&this._fireEvent("movestart",w.originalEvent);for(const j in C)this._fireEvent(j,C[j]);w&&this._fireEvent("move",w.originalEvent);for(const j in r){const{originalEvent:X}=r[j];this._fireEvent(j,X)}const D={};let V;for(const j in this._eventsInProgress){const{handlerName:X,originalEvent:ee}=this._eventsInProgress[j];this._handlersById[X].isActive()||(delete this._eventsInProgress[j],V=l[X]||ee,D[`${j}end`]=V)}for(const j in D)this._fireEvent(j,D[j]);const q=Fd(this._eventsInProgress);if(p&&(b||w)&&!q){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;j?(X(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:V})):(this._map.fire(new o.x("moveend",{originalEvent:V})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new o.x(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Cp("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const $l="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class $g extends o.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,o.aJ(["_renderFrameCallback"],this)}getCenter(){return new o.bL(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,p){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.l({offset:r},l),p)}panTo(r,l,p){return this.easeTo(o.l({center:r},l),p)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,p){return this.easeTo(o.l({zoom:r},l),p)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,p){return this.easeTo(o.l({bearing:r},l),p)}resetNorth(r,l){return this.rotateTo(0,o.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(o.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=o.as.convert(r);const p=l&&l.bearing||0,b=l&&l.pitch||0,w=r.getNorthWest(),C=r.getSouthEast();return this._cameraForBounds(this.transform,w,C,p,b,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?o.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:o.l({},l,r)}_extendCameraOptions(r){return(r=o.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const p=l.max[0]-l.min[0],b=l.max[1]-l.min[1];return p/b>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):b/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,p,b,w,C){const D=r.clone(),V=this._extendCameraOptions(C);D.bearing=b,D.pitch=w;const q=o.bL.convert(l),j=o.bL.convert(p),X=.5*(q.lat+j.lat),ee=.5*(q.lng+j.lng),ae=o.dt(X,ee),be=o.a6.vec3.normalize([],ae),_e=o.a6.vec3.normalize([],o.a6.vec3.cross([],be,[0,1,0])),Te=o.a6.vec3.cross([],_e,be),we=[_e[0],_e[1],_e[2],0,Te[0],Te[1],Te[2],0,be[0],be[1],be[2],0,0,0,0,1],Le=[ae,o.dt(q.lat,q.lng),o.dt(j.lat,q.lng),o.dt(j.lat,j.lng),o.dt(q.lat,j.lng),o.dt(X,q.lng),o.dt(X,j.lng),o.dt(q.lat,ee),o.dt(j.lat,ee)];let Ue=o.ca.fromPoints(Le.map(Xt=>[o.a6.vec3.dot(_e,Xt),o.a6.vec3.dot(Te,Xt),o.a6.vec3.dot(be,Xt)]));const je=o.a6.vec3.transformMat4([],Ue.center,we);o.a6.vec3.squaredLength(je)===0&&o.a6.vec3.set(je,0,0,1),o.a6.vec3.normalize(je,je),o.a6.vec3.scale(je,je,o.aq),D.center=o.du(je);const Ye=D.getWorldToCameraMatrix(),et=o.a6.mat4.invert(new Float64Array(16),Ye);Ue=o.ca.applyTransform(Ue,o.a6.mat4.multiply([],Ye,we));const Xe=this._extendAABB(Ue,D,V,b);if(!Xe)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ue=Xe,o.a6.vec3.transformMat4(je,je,Ye);const nt=.5*(Ue.max[2]-Ue.min[2]),lt=this._minimumAABBFrustumDistance(D,Ue),vt=o.a6.vec3.scale([],[0,0,1],nt),dt=o.a6.vec3.add(vt,je,vt),ct=lt+(D.pitch===0?0:o.a6.vec3.distance(je,dt)),jt=D.globeCenterInViewSpace,en=o.a6.vec3.sub([],je,[jt[0],jt[1],jt[2]]);o.a6.vec3.normalize(en,en),o.a6.vec3.scale(en,en,ct);const gn=o.a6.vec3.add([],je,en);o.a6.vec3.transformMat4(gn,gn,et);const An=o.dw/o.aq,Dn=o.a6.vec3.length(gn),It=o.bE(Math.max(Dn*An-o.dw,Number.EPSILON),0),pn=Math.min(D.zoomFromMercatorZAdjusted(It),V.maxZoom);return pn>.5*(o.c3+o.bV)?(D.setProjection({name:"mercator"}),D.zoom=pn,this._cameraForBounds(D,l,p,b,w,C)):{center:D.center,zoom:pn,bearing:b,pitch:w}}_extendAABB(r,l,p,b){const w=.5*((p.padding.left||0)+(p.padding.right||0)),C=.5*((p.padding.top||0)+(p.padding.bottom||0)),D=C,V=w,q=w,j=C,X=l.width-(V+q),ee=l.height-(D+j),ae=o.a6.vec3.sub([],r.max,r.min),be=Math.min(X/ae[0],ee/ae[1]),_e=Math.min(l.scaleZoom(l.scale*be),p.maxZoom);if(isNaN(_e))return null;const Te=l.scale/l.zoomScale(_e),we=new o.ca([r.min[0]-V*Te,r.min[1]-j*Te,r.min[2]],[r.max[0]+q*Te,r.max[1]+D*Te,r.max[2]]),Le=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new o.P(p.offset.x,p.offset.y):o.P.convert(p.offset)).rotate(-o.bC(b));return we.center[0]-=Le.x*Te,we.center[1]+=Le.y*Te,we}queryTerrainElevation(r,l){const p=this.transform.elevation;return p?(l=o.l({},{exaggerated:!0},l),p.getAtPoint(o.a5.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,p,b,w,C){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,p,b,w,C);const D=r.clone(),V=this._extendCameraOptions(C);D.bearing=b,D.pitch=w;const q=o.bL.convert(l),j=o.bL.convert(p),X=new o.bL(q.lng,j.lat),ee=new o.bL(j.lng,q.lat),ae=D.project(q),be=D.project(j),_e=this.queryTerrainElevation(q),Te=this.queryTerrainElevation(j),we=this.queryTerrainElevation(X),Le=this.queryTerrainElevation(ee),Ue=[[ae.x,ae.y,Math.min(_e||0,Te||0,we||0,Le||0)],[be.x,be.y,Math.max(_e||0,Te||0,we||0,Le||0)]];let je=o.ca.fromPoints(Ue);const Ye=D.getWorldToCameraMatrix(),et=o.a6.mat4.invert(new Float64Array(16),Ye);je=o.ca.applyTransform(je,Ye);const Xe=this._extendAABB(je,D,V,b);if(!Xe)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");je=Xe;const nt=.5*o.a6.vec3.sub([],je.max,je.min)[2],lt=this._minimumAABBFrustumDistance(D,je),vt=[0,0,1,0];o.a6.vec4.transformMat4(vt,vt,Ye),o.a6.vec4.normalize(vt,vt);const dt=o.a6.vec3.scale([],vt,lt+nt),ct=o.a6.vec3.add([],je.center,dt);o.a6.vec3.transformMat4(je.center,je.center,et),o.a6.vec3.transformMat4(ct,ct,et);const jt=D.unproject(new o.P(je.center[0],je.center[1])),en=o.dv(D.projection,jt),gn=Math.pow(2,en),An=Math.min(D._zoomFromMercatorZ(ct[2]*D.pixelsPerMeter*gn/D.worldSize),V.maxZoom);return D.mercatorFromTransition&&An<.5*(o.c3+o.bV)?(D.setProjection({name:"globe"}),D.zoom=An,this._cameraForBounds(D,l,p,b,w,C)):{center:jt,zoom:An,bearing:b,pitch:w}}fitBounds(r,l,p){const b=this.cameraForBounds(r,l);return this._fitInternal(b,l,p)}fitScreenCoordinates(r,l,p,b,w){const C=o.P.convert(r),D=o.P.convert(l),V=new o.P(Math.min(C.x,D.x),Math.min(C.y,D.y)),q=new o.P(Math.max(C.x,D.x),Math.max(C.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,D))return this;const j=this.transform.pointLocation3D(V),X=this.transform.pointLocation3D(q),ee=this.transform.pointLocation3D(new o.P(V.x,q.y)),ae=this.transform.pointLocation3D(new o.P(q.x,V.y)),be=[Math.min(j.lng,X.lng,ee.lng,ae.lng),Math.min(j.lat,X.lat,ee.lat,ae.lat)],_e=[Math.max(j.lng,X.lng,ee.lng,ae.lng),Math.max(j.lat,X.lat,ee.lat,ae.lat)],Te=b&&b.pitch?b.pitch:this.getPitch(),we=this._cameraForBounds(this.transform,be,_e,p,Te,b);return this._fitInternal(we,b,w)}_fitInternal(r,l,p){return r?(l=o.l(r,l)).linear?this.easeTo(l,p):this.flyTo(l,p):this}jumpTo(r,l){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let b=!1,w=!1,C=!1;"zoom"in r&&p.zoom!==+r.zoom&&(b=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=o.bL.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(w=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(C=!0,p.pitch=+r.pitch);const D=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!p.isPaddingEqual(D))if(r.retainPadding===!1){const V=p.clone();V.padding=D,p.setLocationAtPoint(p.center,V.centerPoint)}else p.padding=D;return r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),b&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),w&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),C&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w($l),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return o.w($l),this;this.stop();const b=p.zoom,w=p.pitch,C=p.bearing;p.setFreeCameraOptions(r);const D=b!==p.zoom,V=w!==p.pitch,q=C!==p.bearing;return this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),D&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),q&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),V&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=o.l({offset:[0,0],duration:500,easing:o.dr},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const p=this.transform,b=this.getZoom(),w=this.getBearing(),C=this.getPitch(),D=this.getPadding(),V="zoom"in r?+r.zoom:b,q="bearing"in r?this._normalizeBearing(r.bearing,w):w,j="pitch"in r?+r.pitch:C,X=this._extendPadding(r.padding),ee=o.P.convert(r.offset);let ae,be,_e;if(p.projection.name==="globe"){const vt=o.a5.fromLngLat(p.center),dt=ee.rotate(-p.angle);vt.x+=dt.x/p.worldSize,vt.y+=dt.y/p.worldSize;const ct=vt.toLngLat(),jt=o.bL.convert(r.center||ct);this._normalizeCenter(jt),ae=p.centerPoint.add(dt),be=new o.P(vt.x,vt.y).mult(p.worldSize),_e=new o.P(o.am(jt.lng),o.at(jt.lat)).mult(p.worldSize).sub(be)}else{ae=p.centerPoint.add(ee);const vt=p.pointLocation(ae),dt=o.bL.convert(r.center||vt);this._normalizeCenter(dt),be=p.project(vt),_e=p.project(dt).sub(be)}const Te=p.zoomScale(V-b);let we,Le;r.around&&(we=o.bL.convert(r.around),Le=p.locationPoint(we));const Ue=this._zooming||V!==b,je=this._rotating||w!==q,Ye=this._pitching||j!==C,et=!p.isPaddingEqual(X),Xe=r.retainPadding===!1?p.clone():p,nt=vt=>dt=>{if(Ue&&(vt.zoom=o.aa(b,V,dt)),je&&(vt.bearing=o.aa(w,q,dt)),Ye&&(vt.pitch=o.aa(C,j,dt)),et&&(Xe.interpolatePadding(D,X,dt),ae=Xe.centerPoint.add(ee)),we)vt.setLocationAtPoint(we,Le);else{const ct=vt.zoomScale(vt.zoom-b),jt=V>b?Math.min(2,Te):Math.max(.5,Te),en=Math.pow(jt,1-dt),gn=vt.unproject(be.add(_e.mult(dt*en)).mult(ct));vt.setLocationAtPoint(vt.renderWorldCopies?gn.wrap():gn,ae)}return r.preloadOnly||this._fireMoveEvents(l),vt};if(r.preloadOnly){const vt=this._emulate(nt,r.duration,p);return this._preloadTiles(vt),this}const lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ue,this._rotating=je,this._pitching=Ye,this._padding=et,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,lt),this._ease(nt(p),vt=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(l,vt)},r),this}_prepareEase(r,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||p.moving||this.fire(new o.x("movestart",r)),this._zooming&&!p.zooming&&this.fire(new o.x("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new o.x("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new o.x("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.x("move",r)),this._zooming&&this.fire(new o.x("zoom",r)),this._rotating&&this.fire(new o.x("rotate",r)),this._pitching&&this.fire(new o.x("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,b=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new o.x("zoomend",r)),b&&this.fire(new o.x("rotateend",r)),w&&this.fire(new o.x("pitchend",r)),this.fire(new o.x("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const Xt=o.ar(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Xt,l)}this.stop(),r=o.l({offset:[0,0],speed:1.2,curve:1.42,easing:o.dr},r);const p=this.transform,b=this.getZoom(),w=this.getBearing(),C=this.getPitch(),D=this.getPadding(),V="zoom"in r?o.ap(+r.zoom,p.minZoom,p.maxZoom):b,q="bearing"in r?this._normalizeBearing(r.bearing,w):w,j="pitch"in r?+r.pitch:C,X=this._extendPadding(r.padding),ee=p.zoomScale(V-b),ae=o.P.convert(r.offset);let be=p.centerPoint.add(ae);const _e=p.pointLocation(be),Te=o.bL.convert(r.center||_e);this._normalizeCenter(Te);const we=p.project(_e),Le=p.project(Te).sub(we);let Ue=r.curve;const je=Math.max(p.width,p.height),Ye=je/ee,et=Le.mag();if("minZoom"in r){const Xt=o.ap(Math.min(r.minZoom,b,V),p.minZoom,p.maxZoom),mn=je/p.zoomScale(Xt-b);Ue=Math.sqrt(mn/et*2)}const Xe=Ue*Ue;function nt(Xt){const mn=(Ye*Ye-je*je+(Xt?-1:1)*Xe*Xe*et*et)/(2*(Xt?Ye:je)*Xe*et);return Math.log(Math.sqrt(mn*mn+1)-mn)}function lt(Xt){return(Math.exp(Xt)-Math.exp(-Xt))/2}function vt(Xt){return(Math.exp(Xt)+Math.exp(-Xt))/2}const dt=nt(0);let ct=function(Xt){return vt(dt)/vt(dt+Ue*Xt)},jt=function(Xt){return je*((vt(dt)*(lt(mn=dt+Ue*Xt)/vt(mn))-lt(dt))/Xe)/et;var mn},en=(nt(1)-dt)/Ue;if(Math.abs(et)<1e-6||!isFinite(en)){if(Math.abs(je-Ye)<1e-6)return this.easeTo(r,l);const Xt=Ye<je?-1:1;en=Math.abs(Math.log(Ye/je))/Ue,jt=function(){return 0},ct=function(mn){return Math.exp(Xt*Ue*mn)}}r.duration="duration"in r?+r.duration:1e3*en/("screenSpeed"in r?+r.screenSpeed/Ue:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const gn=w!==q,An=j!==C,Dn=!p.isPaddingEqual(X),It=r.retainPadding===!1?p.clone():p,pn=Xt=>mn=>{const xn=mn*en,hn=1/ct(xn);Xt.zoom=mn===1?V:b+Xt.scaleZoom(hn),gn&&(Xt.bearing=o.aa(w,q,mn)),An&&(Xt.pitch=o.aa(C,j,mn)),Dn&&(It.interpolatePadding(D,X,mn),be=It.centerPoint.add(ae));const Vn=mn===1?Te:Xt.unproject(we.add(Le.mult(jt(xn))).mult(hn));return Xt.setLocationAtPoint(Xt.renderWorldCopies?Vn.wrap():Vn,be),Xt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),Xt};if(r.preloadOnly){const Xt=this._emulate(pn,r.duration,p);return this._preloadTiles(Xt),this}return this._zooming=!0,this._rotating=gn,this._pitching=An,this._padding=Dn,this._prepareEase(l,!1),this._ease(pn(p),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,l)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,l,p){p.animate===!1||p.duration===0?(r(1),l()):(this._easeStart=o.q.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=o.bB(r,-180,180);const p=Math.abs(r-l);return Math.abs(r-360-l)<p&&(r-=360),Math.abs(r+360-l)<p&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const p=r.lng-l.center.lng;r.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&o.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,p){const b=Math.ceil(15*l/1e3),w=[],C=r(p.clone());for(let D=0;D<=b;D++){const V=C(D/b);w.push(V.clone())}return w}_preloadTiles(r,l){}}class Ep{constructor(r={}){this.options=r,o.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,p=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=z("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const b=z("span","mapboxgl-ctrl-icon",this._compactButton);return b.setAttribute("aria-hidden","true"),b.setAttribute("title",p),this._innerContainer=z("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(r){const p=l.reduce((b,w,C)=>(w.value&&(b+=`${w.key}=${w.value}${C<l.length-1?"&":""}`),b),"?");r.href=`${o.e.FEEDBACK_URL}/${p}#${Yh(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const l=this._map.style._mergedSourceCaches;for(const b in l){const w=l[b];if(w.used){const C=w.getSource();C.attribution&&r.indexOf(C.attribution)<0&&r.push(C.attribution)}}r.sort((b,w)=>b.length-w.length),r=r.filter((b,w)=>{for(let C=w+1;C<r.length;C++)if(r[C].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Vg{constructor(){o.aJ(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=z("div","mapboxgl-ctrl");const l=z("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const p=r[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Ey{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const b of p)if(b.id===r)return void(b.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class nf{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=o.cw((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,p){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+p}}const V1={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},My=["mouseenter","mouseover","mouseleave","mouseout"];class Mp extends o.x{constructor(r,l,p,b){const{point:w,lngLat:C,originalEvent:D,target:V}=r;super(r.type,{point:w,lngLat:C,originalEvent:D,target:V}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=p,this.feature=b}}class Ug{constructor(r){this.map=r,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const{type:p,filter:b}=l;if(b){const C=o.M(b,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(C.result==="error")throw new Error(C.value.map(D=>`${D.key}: ${D.message}`).join(", "));this.filters.set(r,C.value)}const w=this.interactionsByType.get(p)||new Map;w.size===0&&(My.includes(p)?this.map.on(p,l.featureset,this.handleType):this.map.on(p,this.handleType),this.interactionsByType.set(p,w)),w.set(r,l),this.typeById.set(r,p)}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const p=this.interactionsByType.get(l);p&&(p.delete(r),p.size===0&&this.map.off(l,this.handleType))}handleType(r){const l=this.interactionsByType.get(r.type),p=Array.from(l).reverse(),b=[];for(const[,D]of p)D.featureset&&b.push({featureset:D.featureset,filter:D.filter,radius:D.radius});let w=this.map.style.queryRenderedFeaturesForInteractions(r.point,b,this.map.transform);!w.length&&My.includes(r.type)&&(w=[null]);let C=!1;for(const D of w){for(const[V,q]of p){const{handler:j,featureset:X}=q;if(X&&(D==null||o.bi(D.featureset,X))&&j(new Mp(r,V,q,D))!==!1){C=!0;break}}if(C)break}if(!C)for(const[D,V]of p){const{handler:q,featureset:j}=V;if(!j&&q(new Mp(r,D,V,null))!==!1)break}}}function of(f,r){if(Array.isArray(f)&&Array.isArray(r)){const l=new Set(f),p=new Set(r);return l.size===p.size&&f.every(b=>p.has(b))}return o.bi(f,r)}const Bd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1},Mc={showCompass:!0,showZoom:!0,visualizePitch:!1};class pl{constructor(r,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new xp({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new wp({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),G()}move(r,l){const p=this.map,b=this.mouseRotate.mousemoveWindow(r,l),w=b&&b.bearingDelta;if(w&&p.setBearing(p.getBearing()+w),this.mousePitch){const C=this.mousePitch.mousemoveWindow(r,l),D=C&&C.pitchDelta;D&&p.setPitch(p.getPitch()+D)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Q(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),me(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,me(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=fe(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=fe(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ic(f,r,l){if(f=new o.bL(f.lng,f.lat),r){const p=new o.bL(f.lng-360,f.lat),b=new o.bL(f.lng+360,f.lat),w=360*Math.ceil(Math.abs(f.lng-l.center.lng)/360),C=l.locationPoint(f).distSqr(r),D=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(p).distSqr(r)<C&&(D||Math.abs(p.lng-l.center.lng)<w)?f=p:l.locationPoint(b).distSqr(r)<C&&(D||Math.abs(b.lng-l.center.lng)<w)&&(f=b)}for(;Math.abs(f.lng-l.center.lng)>180;){const p=l.locationPoint(f);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;f.lng>l.center.lng?f.lng-=360:f.lng+=360}return f}const Ac={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Vl extends o.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=o.l({element:r},l)),o.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=z("div");const w=41,C=27,D=H("svg",{display:"block",height:w*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${w}`},this._element),V=H("radialGradient",{id:"shadowGradient"},H("defs",{},D));H("stop",{offset:"10%","stop-opacity":.4},V),H("stop",{offset:"100%","stop-opacity":.05},V),H("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),H("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),H("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),H("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=o.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const p=this._element.classList;for(const w in Ac)p.remove(`mapboxgl-marker-anchor-${w}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const b=r&&r.className?r.className.trim().split(/\s+/):[];p.add(...b),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.bL.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,p=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const p=r.unproject(l),b=r.getFreeCameraOptions();if(!b.position)return!1;const w=b.position.toLngLat();return w.distanceTo(p)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(l);let b;r._showingGlobe()&&o.dz(r.transform,this._lngLat)?b=0:(b=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Ac[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,p=this.getPitchAlignment();if(!l||!r||p!=="map")return"";if(!l._showingGlobe()){const V=l.getPitch();return V?`rotateX(${V}deg)`:""}const b=o.c1(o.dA(l.transform,this._lngLat)),w=r.sub(o.dB(l.transform)),C=Math.abs(w.x)+Math.abs(w.y);if(C===0)return"";const D=b/C;return`rotateX(${-w.y*D}deg) rotateY(${w.x*D}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let p=0;const b=this.getRotationAlignment();if(b==="map")if(l._showingGlobe()){const w=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat+.001)),C=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);p=o.c1(Math.atan2(C.y,C.x))-90}else p=-l.getBearing();else if(b==="horizon"){const w=o.a7(4,6,l.getZoom()),C=o.dB(l.transform);C.y+=w*l.transform.height;const D=r.sub(C),V=o.c1(Math.atan2(D.y,D.x));p=(V>90?V-270:V+90)*(1-w)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=Ic(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const p=this._pointerdownPos,b=this._positionDelta;if(p&&b){if(!this._isDragging){const w=this._clickTolerance||l._clickTolerance;if(r.point.dist(p)<w)return;this._isDragging=!0}this._pos=r.point.sub(b),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.x("dragstart"))),this.fire(new o.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.x("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,p=this._pos;l&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const U1={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},j1={maxWidth:100,unit:"metric"},H1={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},G1={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Iy=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ya(f=new o.P(0,0),r="bottom"){if(typeof f=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new o.P(0,f);case"top-left":return new o.P(l,l);case"top-right":return new o.P(-l,l);case"bottom":return new o.P(0,-f);case"bottom-left":return new o.P(l,-l);case"bottom-right":return new o.P(-l,-l);case"left":return new o.P(f,0);case"right":return new o.P(-f,0)}return new o.P(0,0)}return f instanceof o.P||Array.isArray(f)?o.P.convert(f):o.P.convert(f[r]||[0,0])}return{version:S,supported:$.supported,setRTLTextPlugin:o.dC,getRTLTextPluginStatus:o.dD,Map:class extends $g{constructor(f){I.mark(E.create);const r=f;if((f=o.l({},Bd,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&o.dx(window)&&(f.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new vc(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Ey,this._domRenderTaskQueue=new Ey,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.aQ(),this._locale=o.l({},V1,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new nf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=f.scaleFactor,this._requestManager=new tt(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?{...f.contextCreateOptions}:{},typeof f.container=="string"){const l=document.getElementById(f.container);if(!l)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=l}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),o.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new kg),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Qi(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||o.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),f.hash&&(this._hash=new vp(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const l=f.bounds;l&&(this.resize(),this.fitBounds(l,o.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new Ep({customAttribution:f.customAttribution})),this._logoControl=new Vg,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.x(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.x(`${l.dataType}dataloading`,l))}),this._interactions=new Ug(this)}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new o.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=f.onAdd(this);this._controls.push(f);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new o.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.x("movestart",f)).fire(new o.x("move",f)),this.fire(new o.x("resize",f)),r&&this.fire(new o.x("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(o.as.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(f){return this._scaleFactor=f,this.painter.scaleFactor=f,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let l;r==="globe"&&f.zoom>=o.bV?(f.setMercatorFromTransition(),l=!0):r==="mercator"&&f.zoom<o.bV&&(f.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;return r=f.name==="globe"&&this.transform.zoom>=o.bV?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f){return this.transform.locationPoint3D(o.bL.convert(f))}unproject(f){return this.transform.pointLocation3D(o.P.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,l){const p=b=>{let w=[];if(Array.isArray(r)){const C=r.filter(D=>this.getLayer(D));w=C.length?this.queryRenderedFeatures(b,{layers:C}):[]}else w=this.queryRenderedFeatures(b,{featureset:r});return w};if(f==="mouseenter"||f==="mouseover"){let b=!1;return{listener:l,targets:r,delegates:{mousemove:C=>{const D=p(C.point);D.length?b||(b=!0,l.call(this,new bi(f,this,C.originalEvent,{features:D}))):b=!1},mouseout:()=>{b=!1}}}}if(f==="mouseleave"||f==="mouseout"){let b=!1;return{listener:l,targets:r,delegates:{mousemove:D=>{p(D.point).length?b=!0:b&&(b=!1,l.call(this,new bi(f,this,D.originalEvent)))},mouseout:D=>{b&&(b=!1,l.call(this,new bi(f,this,D.originalEvent)))}}}}{const b=w=>{const C=p(w.point);C.length&&(w.features=C,l.call(this,w),delete w.features)};return{listener:l,targets:r,delegates:{[f]:b}}}}on(f,r,l){if(typeof r=="function"||l===void 0)return super.on(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(p);for(const b in p.delegates)this.on(b,p.delegates[b]);return this}once(f,r,l){if(typeof r=="function"||l===void 0)return super.once(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,l);for(const b in p.delegates)this.once(b,p.delegates[b]);return this}off(f,r,l){if(typeof r=="function"||l===void 0)return super.off(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._delegatedListeners?this._delegatedListeners[f]:void 0;return p&&(b=>{for(let w=0;w<b.length;w++){const C=b[w];if(C.listener===l&&of(C.targets,r)){for(const D in C.delegates)this.off(D,C.delegates[D]);return b.splice(w,1),this}}})(p),this}queryRenderedFeatures(f,r){if(!this.style)return[];if(r!==void 0||f===void 0||f instanceof o.P||Array.isArray(f)||(r=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],"featureset"in(r=r||{}))return this._isFeaturesetDescriptorValid(r.featureset)?this.style.queryRenderedFeaturesForInteractions(f,[r],this.transform):[];if(r.layers&&Array.isArray(r.layers)){for(const l of r.layers)if(!this._isValidId(l))return[]}return this.style.queryRenderedFeatures(f,r,this.transform)}querySourceFeatures(f,r){return!f||typeof f=="string"&&!this._isValidId(f)?[]:this.style.querySourceFeatures(f,r)}isPointOnSurface(f){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&o.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(f))}addInteraction(f,r){return this._interactions.add(f,r),this}removeInteraction(f){return this._interactions.remove(f),this}setStyle(f,r){return r=o.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&f&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(f,(l,p)=>{l?(o.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(f,r)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const l=o.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new Tn(this,l).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Tn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new o.t(new Error("IDs can't be empty."))),!1):!o.aK(f)||(this.fire(new o.t(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}_isFeaturesetDescriptorValid(f){return"featuresetId"in f?this._isValidId(f.featuresetId):"layerId"in f&&this._isValidId(f.layerId)}_areTargetsValid(f){if(Array.isArray(f)){for(const r of f)if(!this._isValidId(r))return!1;return!0}return this._isFeaturesetDescriptorValid(f)}addSource(f,r){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,l)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,r,{pixelRatio:l=1,sdf:p=!1,stretchX:b,stretchY:w,content:C}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:D,height:V,data:q}=o.q.getImageData(r);this.style.addImage(f,{data:new o.r({width:D,height:V},q),pixelRatio:l,stretchX:b,stretchY:w,content:C,sdf:p,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:V}=r,q=r;this.style.addImage(f,{data:new o.r({width:D,height:V},new Uint8Array(q.data)),pixelRatio:l,stretchX:b,stretchY:w,content:C,sdf:p,version:0,userImage:q}),q.onAdd&&q.onAdd(this,f)}}updateImage(f,r){this._lazyInitEmptyStyle();const l=this.style.getImage(f);if(!l)return void this.fire(new o.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?o.q.getImageData(r):r,{width:b,height:w,data:C}=p;if(b===void 0||w===void 0)return void this.fire(new o.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==l.data.width||w!==l.data.height)return void this.fire(new o.t(new Error(`The width and height of the updated image (${b}, ${w})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const D=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);l.data.replace(C,D),this.style.updateImage(f,l)}hasImage(f){return f?!!this.style&&!!this.style.getImage(f):(this.fire(new o.t(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){o.o(this._requestManager.transformRequest(f,o.R.Image),(l,p)=>{r(l,p instanceof HTMLImageElement?o.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(f,r){this._lazyInitEmptyStyle(),this.style.addModel(f,r)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new o.t(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,r){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)):this}getSlot(f){const r=this.getLayer(f);return r&&r.slot||null}setSlot(f,r){return this.style.setSlot(f,r),this.style.mergeLayers(),this._update(!0)}addImport(f,r){return this.style.addImport(f,r),this}updateImport(f,r){return typeof r!="string"&&r.id!==f?(this.removeImport(f),this.addImport(r)):(this.style.updateImport(f,r),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,r){return this.style.moveImport(f,r),this._update(!0)}moveLayer(f,r){return this._isValidId(f)?(this.style.moveLayer(f,r),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const r=this.style.getOwnLayer(f);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,r,l){return this._isValidId(f)?(this.style.setLayerZoomRange(f,r,l),this._update(!0)):this}setFilter(f,r,l={}){return this._isValidId(f)?(this.style.setFilter(f,r,l),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setPaintProperty(f,r,l,p),this._update(!0)):this}getPaintProperty(f,r){return this._isValidId(f)?this.style.getPaintProperty(f,r):null}setLayoutProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,r,l,p),this._update(!0)):this}getLayoutProperty(f,r){return this._isValidId(f)?this.style.getLayoutProperty(f,r):null}getSchema(f){return this.style.getSchema(f)}setSchema(f,r){return this.style.setSchema(f,r),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,r){return this.style.setConfig(f,r),this._update(!0)}getConfigProperty(f,r){return this.style.getConfigProperty(f,r)}setConfigProperty(f,r,l){return this.style.setConfigProperty(f,r,l),this._update(!0)}getFeaturesetDescriptors(f){return this.style.getFeaturesetDescriptors(f)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const r=f[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.bL.convert(f),this.transform):0}setFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.setFeatureState(f,r),this._update())}removeFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.removeFeatureState(f,r),this._update())}getFeatureState(f){return f.source&&!this._isValidId(f.source)?null:this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,p,b,w=this._container;for(;w&&(!p||!b);){const C=window.getComputedStyle(w).transform;C&&C!=="none"&&(l=C.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(p=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(b=l[3])),w=w.parentElement}this._containerWidth=p?Math.abs(f/p):f,this._containerHeight=b?Math.abs(r/b):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=z("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=z("div","mapboxgl-canvas-container",f);this._canvas=z("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=z("div","mapboxgl-control-container",f),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(b=>{p[b]=z("div",`mapboxgl-ctrl-${b}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const l=o.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(f),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=o.l({},$.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",f);r?(At(r,!0),this.painter=new du(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.m.testSupport(r)):this.fire(new o.t(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.x("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new o.x("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;this.fire(new o.x("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,p=o.q.now(),b=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=b.createQuery(),b.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const q=this.transform.zoom,j=this.transform.pitch,X=o.q.now(),ee=new o.a3(q,{now:X,fadeDuration:w,pitch:j,transition:this.style.transition});this.style.update(ee)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(p);const D=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),D&&(this._placementDirty=D.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,I.mark(E.load),this.fire(new o.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const q=o.q.now()-p;b.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const j=b.getQueryParameter(r,b.QUERY_RESULT)/1e6;b.deleteQuery(r),this.fire(new o.x("gpu-timing-frame",{cpuTime:q,gpuTime:j}))},50)}if(this.listens("gpu-timing-layer")){const q=this.painter.collectGpuTimers();setTimeout(()=>{const j=this.painter.queryGpuTimers(q);this.fire(new o.x("gpu-timing-layer",{layerTimes:j}))},50)}if(this.listens("gpu-timing-deferred-render")){const q=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const j=this.painter.queryGpuTimeDeferredRender(q);this.fire(new o.x("gpu-timing-deferred-render",{gpuTime:j}))},50)}const V=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(V||this._repaint)this.triggerRepaint();else{const q=this.idle();if(q&&(C=this._updateAverageElevation(p,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),q&&(this.fire(new o.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const j=this._calculateSpeedIndex();this.fire(new o.x("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||V||(this._fullyLoaded=!0,I.mark(E.fullLoad),this._performanceMetricsCollection&&Kt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const l=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const b=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=f;const C=Math.abs(b-w);if(C>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(w),l(w);this._averageElevation.easeTo(w,f,300)}else if(C>1e-4)return this._averageElevation.jumpTo(w),l(w)}return!!this._averageElevation.isEasing(f)&&l(this._averageElevation.getValue(f))}_authenticate(){Re(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===De||f.status===401)){const r=this.painter.context.gl;At(r,!1),this._logoControl instanceof Vg&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ct(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&zt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function b(w){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,w,0);const C=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,C),C}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(b(f),r.canvasCopies.map(b),r.timeStamps)}_canvasPixelComparison(f,r,l){let p=l[1]-l[0];const b=f.length/4;for(let w=0;w<r.length;w++){const C=r[w];let D=0;for(let V=0;V<C.length;V+=4)C[V]===f[V]&&C[V+1]===f[V+1]&&C[V+2]===f[V+2]&&C[V+3]===f[V+3]&&(D+=1);p+=(l[w+2]-l[w+1])*(1-D/b)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),dn.delete(this.painter.context.gl),$t.remove(),Oe.remove(),this._removed=!0,this.fire(new o.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=o.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(f){const r=this.style?this.style.getSourceCaches():[];return o.bg(r,(l,p)=>l._preloadTiles(f,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,r){o.dy(f,r)}get version(){return S}},NavigationControl:class{constructor(f={}){this.options=o.l({},Mc,f),this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),z("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),z("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=z("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),l=r===f.getMaxZoom(),p=r===f.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pl(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const l=z("button",f,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(f,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",l),f.firstElementChild&&f.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends o.E{constructor(f={}){super();const r=navigator.geolocation;this.options=o.l({geolocation:r},U1,f),o.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Cc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,f(l)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),l=f.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new o.x("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("geolocate",f)),this._finish()}}_updateCamera(f){const r=new o.bL(f.coords.longitude,f.coords.latitude),l=f.coords.accuracy,p=this._map.getBearing(),b=o.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),b,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new o.bL(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=o.bE(1,f._center.lat)*f.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=z("button","mapboxgl-ctrl-geolocate",this._container),z("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=z("div","mapboxgl-user-location"),this._dotElement.appendChild(z("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(z("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Vl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=z("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.x("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ep,ScaleControl:class{constructor(f={}){this.options=o.l({},j1,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,p=r._containerWidth/2-f/2,b=r.unproject([p,l]),w=r.unproject([p+f,l]),C=b.distanceTo(w);if(this.options.unit==="imperial"){const D=3.2808*C;D>5280?this._setScale(f,D/5280,"mile"):this._setScale(f,D,"foot")}else this.options.unit==="nautical"?this._setScale(f,C/1852,"nautical-mile"):C>=1e3?this._setScale(f,C/1e3,"kilometer"):this._setScale(f,C,"meter")}_setScale(f,r,l){this._map._requestDomTask(()=>{const p=function(w){const C=Math.pow(10,`${Math.floor(w)}`.length-1);let D=w/C;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(V){const q=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*q)/q}(D),C*D}(r),b=p/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(p):`${p}&nbsp;${H1[l]}`,this._container.style.width=f*b+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=z("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:o.w("Full screen control 'container' must be a DOM element.")),o.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=z("button","mapboxgl-ctrl-fullscreen",this._controlContainer);z("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(f){super(),this.options=o.l(Object.create(G1),f),o.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new o.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new o.x("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=o.bL.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const r=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=f;p=l.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=z("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const l=this._closeButton=z("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,p=this._pos;if(!r||!l||!p)return"bottom";const b=l.offsetWidth,w=l.offsetHeight,C=p.x<b/2,D=p.x>r.transform.width-b/2;if(p.y+f<w)return C?"top-left":D?"top-right":"top";if(p.y>r.transform.height-w){if(C)return"bottom-left";if(D)return"bottom-right"}return C?"left":D?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let p=this._container;if(p||(p=this._container=z("div","mapboxgl-popup",r.getContainer()),this._tip=z("div","mapboxgl-popup-tip",p),p.appendChild(l)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ic(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const b=this._pos=this._trackPointer&&f instanceof o.P?f:r.project(this._lngLat),w=ya(this.options.offset),C=this._anchor=this._getAnchor(w.y),D=ya(this.options.offset,C),V=b.add(D).round();r._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${Ac[C]} translate(${V.x}px,${V.y}px)`)})}if(!this._marker&&r._showingGlobe()){const b=o.dz(r.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Iy);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Vl,Style:Tn,LngLat:o.bL,LngLatBounds:o.as,Point:o.P,MercatorCoordinate:o.a5,FreeCameraOptions:cl,Evented:o.E,config:o.e,prewarm:o.dE,clearPrewarmedResources:o.dF,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(f){o.e.ACCESS_TOKEN=f},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(f){o.e.API_URL=f},get workerCount(){return o.dG.workerCount},set workerCount(f){o.dG.workerCount=f},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){o.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){o.dH(f)},get workerUrl(){return o.dI.workerUrl},set workerUrl(f){o.dI.workerUrl=f},get workerClass(){return o.dI.workerClass},set workerClass(f){o.dI.workerClass=f},get workerParams(){return o.dI.workerParams},set workerParams(f){o.dI.workerParams=f},get dracoUrl(){return o.dJ()},set dracoUrl(f){o.dK(f)},get meshoptUrl(){return o.dL()},set meshoptUrl(f){o.dM(f)},setNow:o.q.setNow,restoreNow:o.q.restoreNow}});var _=d;return _})})(VR);var K6=VR.exports;const gw=Xc(K6);var jR={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){var i=function(K,he){var Ve={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},wt={on:function(Vt,on,Kn){if(Ve[Vt]===void 0)throw new Error("Invalid event type: "+Vt);Ve[Vt].push({selector:on,fn:Kn})},render:function(Vt){he.store.featureChanged(Vt)}},Bt=function(Vt,on){for(var Kn=Ve[Vt],so=Kn.length;so--;){var zn=Kn[so];if(zn.selector(on)){zn.fn.call(wt,on)||he.store.render(),he.ui.updateMapClasses();break}}};return K.start.call(wt),{render:K.render,stop:function(){K.stop&&K.stop()},trash:function(){K.trash&&(K.trash(),he.store.render())},combineFeatures:function(){K.combineFeatures&&K.combineFeatures()},uncombineFeatures:function(){K.uncombineFeatures&&K.uncombineFeatures()},drag:function(Vt){Bt("drag",Vt)},click:function(Vt){Bt("click",Vt)},mousemove:function(Vt){Bt("mousemove",Vt)},mousedown:function(Vt){Bt("mousedown",Vt)},mouseup:function(Vt){Bt("mouseup",Vt)},mouseout:function(Vt){Bt("mouseout",Vt)},keydown:function(Vt){Bt("keydown",Vt)},keyup:function(Vt){Bt("keyup",Vt)},touchstart:function(Vt){Bt("touchstart",Vt)},touchmove:function(Vt){Bt("touchmove",Vt)},touchend:function(Vt){Bt("touchend",Vt)},tap:function(Vt){Bt("tap",Vt)}}};function s(K){return K&&K.__esModule&&Object.prototype.hasOwnProperty.call(K,"default")?K.default:K}function d(K){if(K.__esModule)return K;var he=K.default;if(typeof he=="function"){var Ve=function wt(){if(this instanceof wt){var Bt=[null];Bt.push.apply(Bt,arguments);var Vt=Function.bind.apply(he,Bt);return new Vt}return he.apply(this,arguments)};Ve.prototype=he.prototype}else Ve={};return Object.defineProperty(Ve,"__esModule",{value:!0}),Object.keys(K).forEach(function(wt){var Bt=Object.getOwnPropertyDescriptor(K,wt);Object.defineProperty(Ve,wt,Bt.get?Bt:{enumerable:!0,get:function(){return K[wt]}})}),Ve}var g={},_={RADIUS:6378137},o=_;function S(K){var he=0;if(K&&K.length>0){he+=Math.abs(E(K[0]));for(var Ve=1;Ve<K.length;Ve++)he-=Math.abs(E(K[Ve]))}return he}function E(K){var he,Ve,wt,Bt,Vt,on,Kn=0,so=K.length;if(so>2){for(on=0;on<so;on++)on===so-2?(wt=so-2,Bt=so-1,Vt=0):on===so-1?(wt=so-1,Bt=0,Vt=1):(wt=on,Bt=on+1,Vt=on+2),he=K[wt],Ve=K[Bt],Kn+=(I(K[Vt][0])-I(he[0]))*Math.sin(I(Ve[1]));Kn=Kn*o.RADIUS*o.RADIUS/2}return Kn}function I(K){return K*Math.PI/180}g.geometry=function K(he){var Ve,wt=0;switch(he.type){case"Polygon":return S(he.coordinates);case"MultiPolygon":for(Ve=0;Ve<he.coordinates.length;Ve++)wt+=S(he.coordinates[Ve]);return wt;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Ve=0;Ve<he.geometries.length;Ve++)wt+=K(he.geometries[Ve]);return wt}},g.ring=E;var P={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},F={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},B={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},$={POLYGON:"polygon",LINE:"line_string",POINT:"point"},z={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},H={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},U={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},ie={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},Z={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},G={ACTIVE:"true",INACTIVE:"false"},Q=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],oe=-85,le=Object.freeze({__proto__:null,classes:P,sources:F,cursors:B,types:$,geojsonTypes:z,modes:H,events:U,updateActions:ie,meta:Z,activeStates:G,interactions:Q,LAT_MIN:-90,LAT_RENDERED_MIN:oe,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),me={Point:0,LineString:1,MultiLineString:1,Polygon:2};function fe(K,he){var Ve=me[K.geometry.type]-me[he.geometry.type];return Ve===0&&K.geometry.type===z.POLYGON?K.area-he.area:Ve}function ce(K){return K.map(function(he){return he.geometry.type===z.POLYGON&&(he.area=g.geometry({type:z.FEATURE,property:{},geometry:he.geometry})),he}).sort(fe).map(function(he){return delete he.area,he})}function pe(K,he){return he===void 0&&(he=0),[[K.point.x-he,K.point.y-he],[K.point.x+he,K.point.y+he]]}function ye(K){if(this._items={},this._nums={},this._length=K?K.length:0,K)for(var he=0,Ve=K.length;he<Ve;he++)this.add(K[he]),K[he]!==void 0&&(typeof K[he]=="string"?this._items[K[he]]=he:this._nums[K[he]]=he)}ye.prototype.add=function(K){return this.has(K)||(this._length++,typeof K=="string"?this._items[K]=this._length:this._nums[K]=this._length),this},ye.prototype.delete=function(K){return this.has(K)===!1||(this._length--,delete this._items[K],delete this._nums[K]),this},ye.prototype.has=function(K){return(typeof K=="string"||typeof K=="number")&&(this._items[K]!==void 0||this._nums[K]!==void 0)},ye.prototype.values=function(){var K=this,he=[];return Object.keys(this._items).forEach(function(Ve){he.push({k:Ve,v:K._items[Ve]})}),Object.keys(this._nums).forEach(function(Ve){he.push({k:JSON.parse(Ve),v:K._nums[Ve]})}),he.sort(function(Ve,wt){return Ve.v-wt.v}).map(function(Ve){return Ve.k})},ye.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var De=[Z.FEATURE,Z.MIDPOINT,Z.VERTEX],tt={click:function(K,he,Ve){return Me(K,he,Ve,Ve.options.clickBuffer)},touch:function(K,he,Ve){return Me(K,he,Ve,Ve.options.touchBuffer)}};function Me(K,he,Ve,wt){if(Ve.map===null)return[];var Bt=K?pe(K,wt):he,Vt={};Ve.options.styles&&(Vt.layers=Ve.options.styles.map(function(zn){return zn.id}).filter(function(zn){return Ve.map.getLayer(zn)!=null}));var on=Ve.map.queryRenderedFeatures(Bt,Vt).filter(function(zn){return De.indexOf(zn.properties.meta)!==-1}),Kn=new ye,so=[];return on.forEach(function(zn){var yo=zn.properties.id;Kn.has(yo)||(Kn.add(yo),so.push(zn))}),ce(so)}function xe(K,he){var Ve=tt.click(K,null,he),wt={mouse:B.NONE};return Ve[0]&&(wt.mouse=Ve[0].properties.active===G.ACTIVE?B.MOVE:B.POINTER,wt.feature=Ve[0].properties.meta),he.events.currentModeName().indexOf("draw")!==-1&&(wt.mouse=B.ADD),he.ui.queueMapClasses(wt),he.ui.updateMapClasses(),Ve[0]}function Ae(K,he){var Ve=K.x-he.x,wt=K.y-he.y;return Math.sqrt(Ve*Ve+wt*wt)}function Ce(K,he,Ve){Ve===void 0&&(Ve={});var wt=Ve.fineTolerance!=null?Ve.fineTolerance:4,Bt=Ve.grossTolerance!=null?Ve.grossTolerance:12,Vt=Ve.interval!=null?Ve.interval:500;K.point=K.point||he.point,K.time=K.time||he.time;var on=Ae(K.point,he.point);return on<wt||on<Bt&&he.time-K.time<Vt}function ge(K,he,Ve){Ve===void 0&&(Ve={});var wt=Ve.tolerance!=null?Ve.tolerance:25,Bt=Ve.interval!=null?Ve.interval:250;return K.point=K.point||he.point,K.time=K.time||he.time,Ae(K.point,he.point)<wt&&he.time-K.time<Bt}var Ne={exports:{}},We=Ne.exports=function(K,he){if(he||(he=16),K===void 0&&(K=128),K<=0)return"0";for(var Ve=Math.log(Math.pow(2,K))/Math.log(he),wt=2;Ve===1/0;wt*=2)Ve=Math.log(Math.pow(2,K/wt))/Math.log(he)*wt;var Bt=Ve-Math.floor(Ve),Vt="";for(wt=0;wt<Math.floor(Ve);wt++)Vt=Math.floor(Math.random()*he).toString(he)+Vt;if(Bt){var on=Math.pow(he,Bt);Vt=Math.floor(Math.random()*on).toString(he)+Vt}var Kn=parseInt(Vt,he);return Kn!==1/0&&Kn>=Math.pow(2,K)?We(K,he):Vt};We.rack=function(K,he,Ve){var wt=function(Vt){var on=0;do{if(on++>10){if(!Ve)throw new Error("too many ID collisions, use more bits");K+=Ve}var Kn=We(K,he)}while(Object.hasOwnProperty.call(Bt,Kn));return Bt[Kn]=Vt,Kn},Bt=wt.hats={};return wt.get=function(Vt){return wt.hats[Vt]},wt.set=function(Vt,on){return wt.hats[Vt]=on,wt},wt.bits=K||128,wt.base=he||16,wt};var ot=s(Ne.exports),Oe=function(K,he){this.ctx=K,this.properties=he.properties||{},this.coordinates=he.geometry.coordinates,this.id=he.id||ot(),this.type=he.geometry.type};Oe.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Oe.prototype.incomingCoords=function(K){this.setCoordinates(K)},Oe.prototype.setCoordinates=function(K){this.coordinates=K,this.changed()},Oe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Oe.prototype.setProperty=function(K,he){this.properties[K]=he},Oe.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:z.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Oe.prototype.internal=function(K){var he={id:this.id,meta:Z.FEATURE,"meta:type":this.type,active:G.INACTIVE,mode:K};if(this.ctx.options.userProperties)for(var Ve in this.properties)he["user_"+Ve]=this.properties[Ve];return{type:z.FEATURE,properties:he,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Ct=function(K,he){Oe.call(this,K,he)};(Ct.prototype=Object.create(Oe.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Ct.prototype.updateCoordinate=function(K,he,Ve){this.coordinates=arguments.length===3?[he,Ve]:[K,he],this.changed()},Ct.prototype.getCoordinate=function(){return this.getCoordinates()};var Mt=function(K,he){Oe.call(this,K,he)};(Mt.prototype=Object.create(Oe.prototype)).isValid=function(){return this.coordinates.length>1},Mt.prototype.addCoordinate=function(K,he,Ve){this.changed();var wt=parseInt(K,10);this.coordinates.splice(wt,0,[he,Ve])},Mt.prototype.getCoordinate=function(K){var he=parseInt(K,10);return JSON.parse(JSON.stringify(this.coordinates[he]))},Mt.prototype.removeCoordinate=function(K){this.changed(),this.coordinates.splice(parseInt(K,10),1)},Mt.prototype.updateCoordinate=function(K,he,Ve){var wt=parseInt(K,10);this.coordinates[wt]=[he,Ve],this.changed()};var zt=function(K,he){Oe.call(this,K,he),this.coordinates=this.coordinates.map(function(Ve){return Ve.slice(0,-1)})};(zt.prototype=Object.create(Oe.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(K){return K.length>2})},zt.prototype.incomingCoords=function(K){this.coordinates=K.map(function(he){return he.slice(0,-1)}),this.changed()},zt.prototype.setCoordinates=function(K){this.coordinates=K,this.changed()},zt.prototype.addCoordinate=function(K,he,Ve){this.changed();var wt=K.split(".").map(function(Bt){return parseInt(Bt,10)});this.coordinates[wt[0]].splice(wt[1],0,[he,Ve])},zt.prototype.removeCoordinate=function(K){this.changed();var he=K.split(".").map(function(wt){return parseInt(wt,10)}),Ve=this.coordinates[he[0]];Ve&&(Ve.splice(he[1],1),Ve.length<3&&this.coordinates.splice(he[0],1))},zt.prototype.getCoordinate=function(K){var he=K.split(".").map(function(wt){return parseInt(wt,10)}),Ve=this.coordinates[he[0]];return JSON.parse(JSON.stringify(Ve[he[1]]))},zt.prototype.getCoordinates=function(){return this.coordinates.map(function(K){return K.concat([K[0]])})},zt.prototype.updateCoordinate=function(K,he,Ve){this.changed();var wt=K.split("."),Bt=parseInt(wt[0],10),Vt=parseInt(wt[1],10);this.coordinates[Bt]===void 0&&(this.coordinates[Bt]=[]),this.coordinates[Bt][Vt]=[he,Ve]};var bt={MultiPoint:Ct,MultiLineString:Mt,MultiPolygon:zt},Kt=function(K,he,Ve,wt,Bt){var Vt=Ve.split("."),on=parseInt(Vt[0],10),Kn=Vt[1]?Vt.slice(1).join("."):null;return K[on][he](Kn,wt,Bt)},$t=function(K,he){if(Oe.call(this,K,he),delete this.coordinates,this.model=bt[he.geometry.type],this.model===void 0)throw new TypeError(he.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(he.geometry.coordinates)};function Re(K){this.map=K.map,this.drawConfig=JSON.parse(JSON.stringify(K.options||{})),this._ctx=K}($t.prototype=Object.create(Oe.prototype))._coordinatesToFeatures=function(K){var he=this,Ve=this.model.bind(this);return K.map(function(wt){return new Ve(he.ctx,{id:ot(),type:z.FEATURE,properties:{},geometry:{coordinates:wt,type:he.type.replace("Multi","")}})})},$t.prototype.isValid=function(){return this.features.every(function(K){return K.isValid()})},$t.prototype.setCoordinates=function(K){this.features=this._coordinatesToFeatures(K),this.changed()},$t.prototype.getCoordinate=function(K){return Kt(this.features,"getCoordinate",K)},$t.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(K){return K.type===z.POLYGON?K.getCoordinates():K.coordinates})))},$t.prototype.updateCoordinate=function(K,he,Ve){Kt(this.features,"updateCoordinate",K,he,Ve),this.changed()},$t.prototype.addCoordinate=function(K,he,Ve){Kt(this.features,"addCoordinate",K,he,Ve),this.changed()},$t.prototype.removeCoordinate=function(K){Kt(this.features,"removeCoordinate",K),this.changed()},$t.prototype.getFeatures=function(){return this.features},Re.prototype.setSelected=function(K){return this._ctx.store.setSelected(K)},Re.prototype.setSelectedCoordinates=function(K){var he=this;this._ctx.store.setSelectedCoordinates(K),K.reduce(function(Ve,wt){return Ve[wt.feature_id]===void 0&&(Ve[wt.feature_id]=!0,he._ctx.store.get(wt.feature_id).changed()),Ve},{})},Re.prototype.getSelected=function(){return this._ctx.store.getSelected()},Re.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Re.prototype.isSelected=function(K){return this._ctx.store.isSelected(K)},Re.prototype.getFeature=function(K){return this._ctx.store.get(K)},Re.prototype.select=function(K){return this._ctx.store.select(K)},Re.prototype.deselect=function(K){return this._ctx.store.deselect(K)},Re.prototype.deleteFeature=function(K,he){return he===void 0&&(he={}),this._ctx.store.delete(K,he)},Re.prototype.addFeature=function(K){return this._ctx.store.add(K)},Re.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Re.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Re.prototype.setActionableState=function(K){K===void 0&&(K={});var he={trash:K.trash||!1,combineFeatures:K.combineFeatures||!1,uncombineFeatures:K.uncombineFeatures||!1};return this._ctx.events.actionable(he)},Re.prototype.changeMode=function(K,he,Ve){return he===void 0&&(he={}),Ve===void 0&&(Ve={}),this._ctx.events.changeMode(K,he,Ve)},Re.prototype.updateUIClasses=function(K){return this._ctx.ui.queueMapClasses(K)},Re.prototype.activateUIButton=function(K){return this._ctx.ui.setActiveButton(K)},Re.prototype.featuresAt=function(K,he,Ve){if(Ve===void 0&&(Ve="click"),Ve!=="click"&&Ve!=="touch")throw new Error("invalid buffer type");return tt[Ve](K,he,this._ctx)},Re.prototype.newFeature=function(K){var he=K.geometry.type;return he===z.POINT?new Ct(this._ctx,K):he===z.LINE_STRING?new Mt(this._ctx,K):he===z.POLYGON?new zt(this._ctx,K):new $t(this._ctx,K)},Re.prototype.isInstanceOf=function(K,he){if(K===z.POINT)return he instanceof Ct;if(K===z.LINE_STRING)return he instanceof Mt;if(K===z.POLYGON)return he instanceof zt;if(K==="MultiFeature")return he instanceof $t;throw new Error("Unknown feature class: "+K)},Re.prototype.doRender=function(K){return this._ctx.store.featureChanged(K)},Re.prototype.onSetup=function(){},Re.prototype.onDrag=function(){},Re.prototype.onClick=function(){},Re.prototype.onMouseMove=function(){},Re.prototype.onMouseDown=function(){},Re.prototype.onMouseUp=function(){},Re.prototype.onMouseOut=function(){},Re.prototype.onKeyUp=function(){},Re.prototype.onKeyDown=function(){},Re.prototype.onTouchStart=function(){},Re.prototype.onTouchMove=function(){},Re.prototype.onTouchEnd=function(){},Re.prototype.onTap=function(){},Re.prototype.onStop=function(){},Re.prototype.onTrash=function(){},Re.prototype.onCombineFeature=function(){},Re.prototype.onUncombineFeature=function(){},Re.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var dn={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},At=Object.keys(dn);function Ke(K){var he=Object.keys(K);return function(Ve,wt){wt===void 0&&(wt={});var Bt={},Vt=he.reduce(function(on,Kn){return on[Kn]=K[Kn],on},new Re(Ve));return{start:function(){var on=this;Bt=Vt.onSetup(wt),At.forEach(function(Kn){var so,zn=dn[Kn],yo=function(){return!1};K[zn]&&(yo=function(){return!0}),on.on(Kn,yo,(so=zn,function(Ln){return Vt[so](Bt,Ln)}))})},stop:function(){Vt.onStop(Bt)},trash:function(){Vt.onTrash(Bt)},combineFeatures:function(){Vt.onCombineFeatures(Bt)},uncombineFeatures:function(){Vt.onUncombineFeatures(Bt)},render:function(on,Kn){Vt.toDisplayFeatures(Bt,on,Kn)}}}}function Be(K){return[].concat(K).filter(function(he){return he!==void 0})}function Ht(){var K=this;if(!(K.ctx.map&&K.ctx.map.getSource(F.HOT)!==void 0))return so();var he=K.ctx.events.currentModeName();K.ctx.ui.queueMapClasses({mode:he});var Ve=[],wt=[];K.isDirty?wt=K.getAllIds():(Ve=K.getChangedIds().filter(function(zn){return K.get(zn)!==void 0}),wt=K.sources.hot.filter(function(zn){return zn.properties.id&&Ve.indexOf(zn.properties.id)===-1&&K.get(zn.properties.id)!==void 0}).map(function(zn){return zn.properties.id})),K.sources.hot=[];var Bt=K.sources.cold.length;K.sources.cold=K.isDirty?[]:K.sources.cold.filter(function(zn){var yo=zn.properties.id||zn.properties.parent;return Ve.indexOf(yo)===-1});var Vt=Bt!==K.sources.cold.length||wt.length>0;function on(zn,yo){var Ln=K.get(zn).internal(he);K.ctx.events.currentModeRender(Ln,function(dr){K.sources[yo].push(dr)})}if(Ve.forEach(function(zn){return on(zn,"hot")}),wt.forEach(function(zn){return on(zn,"cold")}),Vt&&K.ctx.map.getSource(F.COLD).setData({type:z.FEATURE_COLLECTION,features:K.sources.cold}),K.ctx.map.getSource(F.HOT).setData({type:z.FEATURE_COLLECTION,features:K.sources.hot}),K._emitSelectionChange&&(K.ctx.map.fire(U.SELECTION_CHANGE,{features:K.getSelected().map(function(zn){return zn.toGeoJSON()}),points:K.getSelectedCoordinates().map(function(zn){return{type:z.FEATURE,properties:{},geometry:{type:z.POINT,coordinates:zn.coordinates}}})}),K._emitSelectionChange=!1),K._deletedFeaturesToEmit.length){var Kn=K._deletedFeaturesToEmit.map(function(zn){return zn.toGeoJSON()});K._deletedFeaturesToEmit=[],K.ctx.map.fire(U.DELETE,{features:Kn})}function so(){K.isDirty=!1,K.clearChangedIds()}so(),K.ctx.map.fire(U.RENDER,{})}function Ut(K){var he,Ve=this;this._features={},this._featureIds=new ye,this._selectedFeatureIds=new ye,this._selectedCoordinates=[],this._changedFeatureIds=new ye,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=K,this.sources={hot:[],cold:[]},this.render=function(){he||(he=requestAnimationFrame(function(){he=null,Ht.call(Ve)}))},this.isDirty=!1}function Nt(K,he){var Ve=K._selectedCoordinates.filter(function(wt){return K._selectedFeatureIds.has(wt.feature_id)});K._selectedCoordinates.length===Ve.length||he.silent||(K._emitSelectionChange=!0),K._selectedCoordinates=Ve}Ut.prototype.createRenderBatch=function(){var K=this,he=this.render,Ve=0;return this.render=function(){Ve++},function(){K.render=he,Ve>0&&K.render()}},Ut.prototype.setDirty=function(){return this.isDirty=!0,this},Ut.prototype.featureChanged=function(K){return this._changedFeatureIds.add(K),this},Ut.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Ut.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Ut.prototype.getAllIds=function(){return this._featureIds.values()},Ut.prototype.add=function(K){return this.featureChanged(K.id),this._features[K.id]=K,this._featureIds.add(K.id),this},Ut.prototype.delete=function(K,he){var Ve=this;return he===void 0&&(he={}),Be(K).forEach(function(wt){Ve._featureIds.has(wt)&&(Ve._featureIds.delete(wt),Ve._selectedFeatureIds.delete(wt),he.silent||Ve._deletedFeaturesToEmit.indexOf(Ve._features[wt])===-1&&Ve._deletedFeaturesToEmit.push(Ve._features[wt]),delete Ve._features[wt],Ve.isDirty=!0)}),Nt(this,he),this},Ut.prototype.get=function(K){return this._features[K]},Ut.prototype.getAll=function(){var K=this;return Object.keys(this._features).map(function(he){return K._features[he]})},Ut.prototype.select=function(K,he){var Ve=this;return he===void 0&&(he={}),Be(K).forEach(function(wt){Ve._selectedFeatureIds.has(wt)||(Ve._selectedFeatureIds.add(wt),Ve._changedFeatureIds.add(wt),he.silent||(Ve._emitSelectionChange=!0))}),this},Ut.prototype.deselect=function(K,he){var Ve=this;return he===void 0&&(he={}),Be(K).forEach(function(wt){Ve._selectedFeatureIds.has(wt)&&(Ve._selectedFeatureIds.delete(wt),Ve._changedFeatureIds.add(wt),he.silent||(Ve._emitSelectionChange=!0))}),Nt(this,he),this},Ut.prototype.clearSelected=function(K){return K===void 0&&(K={}),this.deselect(this._selectedFeatureIds.values(),{silent:K.silent}),this},Ut.prototype.setSelected=function(K,he){var Ve=this;return he===void 0&&(he={}),K=Be(K),this.deselect(this._selectedFeatureIds.values().filter(function(wt){return K.indexOf(wt)===-1}),{silent:he.silent}),this.select(K.filter(function(wt){return!Ve._selectedFeatureIds.has(wt)}),{silent:he.silent}),this},Ut.prototype.setSelectedCoordinates=function(K){return this._selectedCoordinates=K,this._emitSelectionChange=!0,this},Ut.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Ut.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Ut.prototype.getSelected=function(){var K=this;return this._selectedFeatureIds.values().map(function(he){return K.get(he)})},Ut.prototype.getSelectedCoordinates=function(){var K=this;return this._selectedCoordinates.map(function(he){return{coordinates:K.get(he.feature_id).getCoordinate(he.coord_path)}})},Ut.prototype.isSelected=function(K){return this._selectedFeatureIds.has(K)},Ut.prototype.setFeatureProperty=function(K,he,Ve){this.get(K).setProperty(he,Ve),this.featureChanged(K)},Ut.prototype.storeMapConfig=function(){var K=this;Q.forEach(function(he){K.ctx.map[he]&&(K._mapInitialConfig[he]=K.ctx.map[he].isEnabled())})},Ut.prototype.restoreMapConfig=function(){var K=this;Object.keys(this._mapInitialConfig).forEach(function(he){K._mapInitialConfig[he]?K.ctx.map[he].enable():K.ctx.map[he].disable()})},Ut.prototype.getInitialConfigValue=function(K){return this._mapInitialConfig[K]===void 0||this._mapInitialConfig[K]};var Et=function(){for(var K=arguments,he={},Ve=0;Ve<arguments.length;Ve++){var wt=K[Ve];for(var Bt in wt)Gt.call(wt,Bt)&&(he[Bt]=wt[Bt])}return he},Gt=Object.prototype.hasOwnProperty,ln=s(Et),yn=["mode","feature","mouse"];function _n(K){var he=null,Ve=null,wt={onRemove:function(){return K.map.off("load",wt.connect),clearInterval(Ve),wt.removeLayers(),K.store.restoreMapConfig(),K.ui.removeButtons(),K.events.removeEventListeners(),K.ui.clearMapClasses(),K.boxZoomInitial&&K.map.boxZoom.enable(),K.map=null,K.container=null,K.store=null,he&&he.parentNode&&he.parentNode.removeChild(he),he=null,this},connect:function(){K.map.off("load",wt.connect),clearInterval(Ve),wt.addLayers(),K.store.storeMapConfig(),K.events.addEventListeners()},onAdd:function(Bt){var Vt=Bt.fire;return Bt.fire=function(on,Kn){var so=arguments;return Vt.length===1&&arguments.length!==1&&(so=[ln({},{type:on},Kn)]),Vt.apply(Bt,so)},K.map=Bt,K.events=function(on){var Kn=Object.keys(on.options.modes).reduce(function($n,ko){return $n[ko]=Ke(on.options.modes[ko]),$n},{}),so={},zn={},yo={},Ln=null,dr=null;yo.drag=function($n,ko){ko({point:$n.point,time:new Date().getTime()})?(on.ui.queueMapClasses({mouse:B.DRAG}),dr.drag($n)):$n.originalEvent.stopPropagation()},yo.mousedrag=function($n){yo.drag($n,function(ko){return!Ce(so,ko)})},yo.touchdrag=function($n){yo.drag($n,function(ko){return!ge(zn,ko)})},yo.mousemove=function($n){if(($n.originalEvent.buttons!==void 0?$n.originalEvent.buttons:$n.originalEvent.which)===1)return yo.mousedrag($n);var ko=xe($n,on);$n.featureTarget=ko,dr.mousemove($n)},yo.mousedown=function($n){so={time:new Date().getTime(),point:$n.point};var ko=xe($n,on);$n.featureTarget=ko,dr.mousedown($n)},yo.mouseup=function($n){var ko=xe($n,on);$n.featureTarget=ko,Ce(so,{point:$n.point,time:new Date().getTime()})?dr.click($n):dr.mouseup($n)},yo.mouseout=function($n){dr.mouseout($n)},yo.touchstart=function($n){if(on.options.touchEnabled){zn={time:new Date().getTime(),point:$n.point};var ko=tt.touch($n,null,on)[0];$n.featureTarget=ko,dr.touchstart($n)}},yo.touchmove=function($n){if(on.options.touchEnabled)return dr.touchmove($n),yo.touchdrag($n)},yo.touchend=function($n){if($n.originalEvent.preventDefault(),on.options.touchEnabled){var ko=tt.touch($n,null,on)[0];$n.featureTarget=ko,ge(zn,{time:new Date().getTime(),point:$n.point})?dr.tap($n):dr.touchend($n)}};var uo=function($n){return!($n===8||$n===46||$n>=48&&$n<=57)};function hr($n,ko,oi){oi===void 0&&(oi={}),dr.stop();var yi=Kn[$n];if(yi===void 0)throw new Error($n+" is not valid");Ln=$n;var Hn=yi(on,ko);dr=i(Hn,on),oi.silent||on.map.fire(U.MODE_CHANGE,{mode:$n}),on.store.setDirty(),on.store.render()}yo.keydown=function($n){($n.srcElement||$n.target).classList.contains("mapboxgl-canvas")&&($n.keyCode!==8&&$n.keyCode!==46||!on.options.controls.trash?uo($n.keyCode)?dr.keydown($n):$n.keyCode===49&&on.options.controls.point?hr(H.DRAW_POINT):$n.keyCode===50&&on.options.controls.line_string?hr(H.DRAW_LINE_STRING):$n.keyCode===51&&on.options.controls.polygon&&hr(H.DRAW_POLYGON):($n.preventDefault(),dr.trash()))},yo.keyup=function($n){uo($n.keyCode)&&dr.keyup($n)},yo.zoomend=function(){on.store.changeZoom()},yo.data=function($n){if($n.dataType==="style"){var ko=on.setup,oi=on.map,yi=on.options,Hn=on.store;yi.styles.some(function(fr){return oi.getLayer(fr.id)})||(ko.addLayers(),Hn.setDirty(),Hn.render())}};var Ti={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Ln=on.options.defaultMode,dr=i(Kn[Ln](on),on)},changeMode:hr,actionable:function($n){var ko=!1;Object.keys($n).forEach(function(oi){if(Ti[oi]===void 0)throw new Error("Invalid action type");Ti[oi]!==$n[oi]&&(ko=!0),Ti[oi]=$n[oi]}),ko&&on.map.fire(U.ACTIONABLE,{actions:Ti})},currentModeName:function(){return Ln},currentModeRender:function($n,ko){return dr.render($n,ko)},fire:function($n,ko){yo[$n]&&yo[$n](ko)},addEventListeners:function(){on.map.on("mousemove",yo.mousemove),on.map.on("mousedown",yo.mousedown),on.map.on("mouseup",yo.mouseup),on.map.on("data",yo.data),on.map.on("touchmove",yo.touchmove),on.map.on("touchstart",yo.touchstart),on.map.on("touchend",yo.touchend),on.container.addEventListener("mouseout",yo.mouseout),on.options.keybindings&&(on.container.addEventListener("keydown",yo.keydown),on.container.addEventListener("keyup",yo.keyup))},removeEventListeners:function(){on.map.off("mousemove",yo.mousemove),on.map.off("mousedown",yo.mousedown),on.map.off("mouseup",yo.mouseup),on.map.off("data",yo.data),on.map.off("touchmove",yo.touchmove),on.map.off("touchstart",yo.touchstart),on.map.off("touchend",yo.touchend),on.container.removeEventListener("mouseout",yo.mouseout),on.options.keybindings&&(on.container.removeEventListener("keydown",yo.keydown),on.container.removeEventListener("keyup",yo.keyup))},trash:function($n){dr.trash($n)},combineFeatures:function(){dr.combineFeatures()},uncombineFeatures:function(){dr.uncombineFeatures()},getMode:function(){return Ln}}}(K),K.ui=function(on){var Kn={},so=null,zn={mode:null,feature:null,mouse:null},yo={mode:null,feature:null,mouse:null};function Ln($n){yo=ln(yo,$n)}function dr(){var $n,ko;if(on.container){var oi=[],yi=[];yn.forEach(function(Hn){yo[Hn]!==zn[Hn]&&(oi.push(Hn+"-"+zn[Hn]),yo[Hn]!==null&&yi.push(Hn+"-"+yo[Hn]))}),oi.length>0&&($n=on.container.classList).remove.apply($n,oi),yi.length>0&&(ko=on.container.classList).add.apply(ko,yi),zn=ln(zn,yo)}}function uo($n,ko){ko===void 0&&(ko={});var oi=document.createElement("button");return oi.className=P.CONTROL_BUTTON+" "+ko.className,oi.setAttribute("title",ko.title),ko.container.appendChild(oi),oi.addEventListener("click",function(yi){if(yi.preventDefault(),yi.stopPropagation(),yi.target===so)return hr(),void ko.onDeactivate();Ti($n),ko.onActivate()},!0),oi}function hr(){so&&(so.classList.remove(P.ACTIVE_BUTTON),so=null)}function Ti($n){hr();var ko=Kn[$n];ko&&ko&&$n!=="trash"&&(ko.classList.add(P.ACTIVE_BUTTON),so=ko)}return{setActiveButton:Ti,queueMapClasses:Ln,updateMapClasses:dr,clearMapClasses:function(){Ln({mode:null,feature:null,mouse:null}),dr()},addButtons:function(){var $n=on.options.controls,ko=document.createElement("div");return ko.className=P.CONTROL_GROUP+" "+P.CONTROL_BASE,$n&&($n[$.LINE]&&(Kn[$.LINE]=uo($.LINE,{container:ko,className:P.CONTROL_BUTTON_LINE,title:"LineString tool "+(on.options.keybindings?"(l)":""),onActivate:function(){return on.events.changeMode(H.DRAW_LINE_STRING)},onDeactivate:function(){return on.events.trash()}})),$n[$.POLYGON]&&(Kn[$.POLYGON]=uo($.POLYGON,{container:ko,className:P.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(on.options.keybindings?"(p)":""),onActivate:function(){return on.events.changeMode(H.DRAW_POLYGON)},onDeactivate:function(){return on.events.trash()}})),$n[$.POINT]&&(Kn[$.POINT]=uo($.POINT,{container:ko,className:P.CONTROL_BUTTON_POINT,title:"Marker tool "+(on.options.keybindings?"(m)":""),onActivate:function(){return on.events.changeMode(H.DRAW_POINT)},onDeactivate:function(){return on.events.trash()}})),$n.trash&&(Kn.trash=uo("trash",{container:ko,className:P.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){on.events.trash()}})),$n.combine_features&&(Kn.combine_features=uo("combineFeatures",{container:ko,className:P.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){on.events.combineFeatures()}})),$n.uncombine_features&&(Kn.uncombine_features=uo("uncombineFeatures",{container:ko,className:P.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){on.events.uncombineFeatures()}}))),ko},removeButtons:function(){Object.keys(Kn).forEach(function($n){var ko=Kn[$n];ko.parentNode&&ko.parentNode.removeChild(ko),delete Kn[$n]})}}}(K),K.container=Bt.getContainer(),K.store=new Ut(K),he=K.ui.addButtons(),K.options.boxSelect&&(K.boxZoomInitial=Bt.boxZoom.isEnabled(),Bt.boxZoom.disable(),Bt.dragPan.disable(),Bt.dragPan.enable()),Bt.loaded()?wt.connect():(Bt.on("load",wt.connect),Ve=setInterval(function(){Bt.loaded()&&wt.connect()},16)),K.events.start(),he},addLayers:function(){K.map.addSource(F.COLD,{data:{type:z.FEATURE_COLLECTION,features:[]},type:"geojson"}),K.map.addSource(F.HOT,{data:{type:z.FEATURE_COLLECTION,features:[]},type:"geojson"}),K.options.styles.forEach(function(Bt){K.map.addLayer(Bt)}),K.store.setDirty(!0),K.store.render()},removeLayers:function(){K.options.styles.forEach(function(Bt){K.map.getLayer(Bt.id)&&K.map.removeLayer(Bt.id)}),K.map.getSource(F.COLD)&&K.map.removeSource(F.COLD),K.map.getSource(F.HOT)&&K.map.removeSource(F.HOT)}};return K.setup=wt,wt}var jn=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function yt(K){return function(he){var Ve=he.featureTarget;return!!Ve&&!!Ve.properties&&Ve.properties.meta===K}}function kn(K){return!!K.originalEvent&&!!K.originalEvent.shiftKey&&K.originalEvent.button===0}function qn(K){return!!K.featureTarget&&!!K.featureTarget.properties&&K.featureTarget.properties.active===G.ACTIVE&&K.featureTarget.properties.meta===Z.FEATURE}function Co(K){return!!K.featureTarget&&!!K.featureTarget.properties&&K.featureTarget.properties.active===G.INACTIVE&&K.featureTarget.properties.meta===Z.FEATURE}function mo(K){return K.featureTarget===void 0}function Io(K){return!!K.featureTarget&&!!K.featureTarget.properties&&K.featureTarget.properties.meta===Z.FEATURE}function Ho(K){var he=K.featureTarget;return!!he&&!!he.properties&&he.properties.meta===Z.VERTEX}function ur(K){return!!K.originalEvent&&K.originalEvent.shiftKey===!0}function Dt(K){return K.keyCode===27}function En(K){return K.keyCode===13}var ft=Object.freeze({__proto__:null,isOfMetaType:yt,isShiftMousedown:kn,isActiveFeature:qn,isInactiveFeature:Co,noTarget:mo,isFeature:Io,isVertex:Ho,isShiftDown:ur,isEscapeKey:Dt,isEnterKey:En,isTrue:function(){return!0}}),un=Je;function Je(K,he){this.x=K,this.y=he}Je.prototype={clone:function(){return new Je(this.x,this.y)},add:function(K){return this.clone()._add(K)},sub:function(K){return this.clone()._sub(K)},multByPoint:function(K){return this.clone()._multByPoint(K)},divByPoint:function(K){return this.clone()._divByPoint(K)},mult:function(K){return this.clone()._mult(K)},div:function(K){return this.clone()._div(K)},rotate:function(K){return this.clone()._rotate(K)},rotateAround:function(K,he){return this.clone()._rotateAround(K,he)},matMult:function(K){return this.clone()._matMult(K)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(K){return this.x===K.x&&this.y===K.y},dist:function(K){return Math.sqrt(this.distSqr(K))},distSqr:function(K){var he=K.x-this.x,Ve=K.y-this.y;return he*he+Ve*Ve},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(K){return Math.atan2(this.y-K.y,this.x-K.x)},angleWith:function(K){return this.angleWithSep(K.x,K.y)},angleWithSep:function(K,he){return Math.atan2(this.x*he-this.y*K,this.x*K+this.y*he)},_matMult:function(K){var he=K[0]*this.x+K[1]*this.y,Ve=K[2]*this.x+K[3]*this.y;return this.x=he,this.y=Ve,this},_add:function(K){return this.x+=K.x,this.y+=K.y,this},_sub:function(K){return this.x-=K.x,this.y-=K.y,this},_mult:function(K){return this.x*=K,this.y*=K,this},_div:function(K){return this.x/=K,this.y/=K,this},_multByPoint:function(K){return this.x*=K.x,this.y*=K.y,this},_divByPoint:function(K){return this.x/=K.x,this.y/=K.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var K=this.y;return this.y=this.x,this.x=-K,this},_rotate:function(K){var he=Math.cos(K),Ve=Math.sin(K),wt=he*this.x-Ve*this.y,Bt=Ve*this.x+he*this.y;return this.x=wt,this.y=Bt,this},_rotateAround:function(K,he){var Ve=Math.cos(K),wt=Math.sin(K),Bt=he.x+Ve*(this.x-he.x)-wt*(this.y-he.y),Vt=he.y+wt*(this.x-he.x)+Ve*(this.y-he.y);return this.x=Bt,this.y=Vt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Je.convert=function(K){return K instanceof Je?K:Array.isArray(K)?new Je(K[0],K[1]):K};var Mn=s(un);function Bn(K,he){var Ve=he.getBoundingClientRect();return new Mn(K.clientX-Ve.left-(he.clientLeft||0),K.clientY-Ve.top-(he.clientTop||0))}function Oo(K,he,Ve,wt){return{type:z.FEATURE,properties:{meta:Z.VERTEX,parent:K,coord_path:Ve,active:wt?G.ACTIVE:G.INACTIVE},geometry:{type:z.POINT,coordinates:he}}}function Rr(K,he,Ve){var wt=he.geometry.coordinates,Bt=Ve.geometry.coordinates;if(wt[1]>85||wt[1]<oe||Bt[1]>85||Bt[1]<oe)return null;var Vt={lng:(wt[0]+Bt[0])/2,lat:(wt[1]+Bt[1])/2};return{type:z.FEATURE,properties:{meta:Z.MIDPOINT,parent:K,lng:Vt.lng,lat:Vt.lat,coord_path:Ve.properties.coord_path},geometry:{type:z.POINT,coordinates:[Vt.lng,Vt.lat]}}}function hi(K,he,Ve){he===void 0&&(he={}),Ve===void 0&&(Ve=null);var wt,Bt=K.geometry,Vt=Bt.type,on=Bt.coordinates,Kn=K.properties&&K.properties.id,so=[];function zn(Ln,dr){var uo="",hr=null;Ln.forEach(function(Ti,$n){var ko=dr!=null?dr+"."+$n:String($n),oi=Oo(Kn,Ti,ko,yo(ko));if(he.midpoints&&hr){var yi=Rr(Kn,hr,oi);yi&&so.push(yi)}hr=oi;var Hn=JSON.stringify(Ti);uo!==Hn&&so.push(oi),$n===0&&(uo=Hn)})}function yo(Ln){return!!he.selectedPaths&&he.selectedPaths.indexOf(Ln)!==-1}return Vt===z.POINT?so.push(Oo(Kn,on,Ve,yo(Ve))):Vt===z.POLYGON?on.forEach(function(Ln,dr){zn(Ln,Ve!==null?Ve+"."+dr:String(dr))}):Vt===z.LINE_STRING?zn(on,Ve):Vt.indexOf(z.MULTI_PREFIX)===0&&(wt=Vt.replace(z.MULTI_PREFIX,""),on.forEach(function(Ln,dr){var uo={type:z.FEATURE,properties:K.properties,geometry:{type:wt,coordinates:Ln}};so=so.concat(hi(uo,he,dr))})),so}var Er={enable:function(K){setTimeout(function(){K.map&&K.map.doubleClickZoom&&K._ctx&&K._ctx.store&&K._ctx.store.getInitialConfigValue&&K._ctx.store.getInitialConfigValue("doubleClickZoom")&&K.map.doubleClickZoom.enable()},0)},disable:function(K){setTimeout(function(){K.map&&K.map.doubleClickZoom&&K.map.doubleClickZoom.disable()},0)}},Nr={exports:{}},Xo=function(K){if(!K||!K.type)return null;var he=Bi[K.type];if(!he)return null;if(he==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:K}]};if(he==="feature")return{type:"FeatureCollection",features:[K]};if(he==="featurecollection")return K},Bi={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Bs=s(Xo),Zt=Object.freeze({__proto__:null,default:function K(he){switch(he&&he.type||null){case"FeatureCollection":return he.features=he.features.reduce(function(Ve,wt){return Ve.concat(K(wt))},[]),he;case"Feature":return he.geometry?K(he.geometry).map(function(Ve){var wt={type:"Feature",properties:JSON.parse(JSON.stringify(he.properties)),geometry:Ve};return he.id!==void 0&&(wt.id=he.id),wt}):[he];case"MultiPoint":return he.coordinates.map(function(Ve){return{type:"Point",coordinates:Ve}});case"MultiPolygon":return he.coordinates.map(function(Ve){return{type:"Polygon",coordinates:Ve}});case"MultiLineString":return he.coordinates.map(function(Ve){return{type:"LineString",coordinates:Ve}});case"GeometryCollection":return he.geometries.map(K).reduce(function(Ve,wt){return Ve.concat(wt)},[]);case"Point":case"Polygon":case"LineString":return[he]}}}),Ee=Xo,ke=d(Zt),qe=function(K){return function he(Ve){return Array.isArray(Ve)&&Ve.length&&typeof Ve[0]=="number"?[Ve]:Ve.reduce(function(wt,Bt){return Array.isArray(Bt)&&Array.isArray(Bt[0])?wt.concat(he(Bt)):(wt.push(Bt),wt)},[])}(K)};ke instanceof Function||(ke=ke.default);var mt={exports:{}},it=mt.exports=function(K){return new xt(K)};function xt(K){this.value=K}function qt(K,he,Ve){var wt=[],Bt=[],Vt=!0;return function on(Kn){var so=Ve?kt(Kn):Kn,zn={},yo=!0,Ln={node:so,node_:Kn,path:[].concat(wt),parent:Bt[Bt.length-1],parents:Bt,key:wt.slice(-1)[0],isRoot:wt.length===0,level:wt.length,circular:null,update:function(hr,Ti){Ln.isRoot||(Ln.parent.node[Ln.key]=hr),Ln.node=hr,Ti&&(yo=!1)},delete:function(hr){delete Ln.parent.node[Ln.key],hr&&(yo=!1)},remove:function(hr){nn(Ln.parent.node)?Ln.parent.node.splice(Ln.key,1):delete Ln.parent.node[Ln.key],hr&&(yo=!1)},keys:null,before:function(hr){zn.before=hr},after:function(hr){zn.after=hr},pre:function(hr){zn.pre=hr},post:function(hr){zn.post=hr},stop:function(){Vt=!1},block:function(){yo=!1}};if(!Vt)return Ln;function dr(){if(typeof Ln.node=="object"&&Ln.node!==null){Ln.keys&&Ln.node_===Ln.node||(Ln.keys=Wt(Ln.node)),Ln.isLeaf=Ln.keys.length==0;for(var hr=0;hr<Bt.length;hr++)if(Bt[hr].node_===Kn){Ln.circular=Bt[hr];break}}else Ln.isLeaf=!0,Ln.keys=null;Ln.notLeaf=!Ln.isLeaf,Ln.notRoot=!Ln.isRoot}dr();var uo=he.call(Ln,Ln.node);return uo!==void 0&&Ln.update&&Ln.update(uo),zn.before&&zn.before.call(Ln,Ln.node),yo&&(typeof Ln.node!="object"||Ln.node===null||Ln.circular||(Bt.push(Ln),dr(),gt(Ln.keys,function(hr,Ti){wt.push(hr),zn.pre&&zn.pre.call(Ln,Ln.node[hr],hr);var $n=on(Ln.node[hr]);Ve&&Yt.call(Ln.node,hr)&&(Ln.node[hr]=$n.node),$n.isLast=Ti==Ln.keys.length-1,$n.isFirst=Ti==0,zn.post&&zn.post.call(Ln,$n),wt.pop()}),Bt.pop()),zn.after&&zn.after.call(Ln,Ln.node)),Ln}(K).node}function kt(K){if(typeof K=="object"&&K!==null){var he;if(nn(K))he=[];else if(Qt(K)==="[object Date]")he=new Date(K.getTime?K.getTime():K);else if(function(Bt){return Qt(Bt)==="[object RegExp]"}(K))he=new RegExp(K);else if(function(Bt){return Qt(Bt)==="[object Error]"}(K))he={message:K.message};else if(function(Bt){return Qt(Bt)==="[object Boolean]"}(K))he=new Boolean(K);else if(function(Bt){return Qt(Bt)==="[object Number]"}(K))he=new Number(K);else if(function(Bt){return Qt(Bt)==="[object String]"}(K))he=new String(K);else if(Object.create&&Object.getPrototypeOf)he=Object.create(Object.getPrototypeOf(K));else if(K.constructor===Object)he={};else{var Ve=K.constructor&&K.constructor.prototype||K.__proto__||{},wt=function(){};wt.prototype=Ve,he=new wt}return gt(Wt(K),function(Bt){he[Bt]=K[Bt]}),he}return K}xt.prototype.get=function(K){for(var he=this.value,Ve=0;Ve<K.length;Ve++){var wt=K[Ve];if(!he||!Yt.call(he,wt)){he=void 0;break}he=he[wt]}return he},xt.prototype.has=function(K){for(var he=this.value,Ve=0;Ve<K.length;Ve++){var wt=K[Ve];if(!he||!Yt.call(he,wt))return!1;he=he[wt]}return!0},xt.prototype.set=function(K,he){for(var Ve=this.value,wt=0;wt<K.length-1;wt++){var Bt=K[wt];Yt.call(Ve,Bt)||(Ve[Bt]={}),Ve=Ve[Bt]}return Ve[K[wt]]=he,he},xt.prototype.map=function(K){return qt(this.value,K,!0)},xt.prototype.forEach=function(K){return this.value=qt(this.value,K,!1),this.value},xt.prototype.reduce=function(K,he){var Ve=arguments.length===1,wt=Ve?this.value:he;return this.forEach(function(Bt){this.isRoot&&Ve||(wt=K.call(this,wt,Bt))}),wt},xt.prototype.paths=function(){var K=[];return this.forEach(function(he){K.push(this.path)}),K},xt.prototype.nodes=function(){var K=[];return this.forEach(function(he){K.push(this.node)}),K},xt.prototype.clone=function(){var K=[],he=[];return function Ve(wt){for(var Bt=0;Bt<K.length;Bt++)if(K[Bt]===wt)return he[Bt];if(typeof wt=="object"&&wt!==null){var Vt=kt(wt);return K.push(wt),he.push(Vt),gt(Wt(wt),function(on){Vt[on]=Ve(wt[on])}),K.pop(),he.pop(),Vt}return wt}(this.value)};var Wt=Object.keys||function(K){var he=[];for(var Ve in K)he.push(Ve);return he};function Qt(K){return Object.prototype.toString.call(K)}var nn=Array.isArray||function(K){return Object.prototype.toString.call(K)==="[object Array]"},gt=function(K,he){if(K.forEach)return K.forEach(he);for(var Ve=0;Ve<K.length;Ve++)he(K[Ve],Ve,K)};gt(Wt(xt.prototype),function(K){it[K]=function(he){var Ve=[].slice.call(arguments,1),wt=new xt(he);return wt[K].apply(wt,Ve)}});var Yt=Object.hasOwnProperty||function(K,he){return he in K},In=mt.exports,ho=co;function co(K){if(!(this instanceof co))return new co(K);this._bbox=K||[1/0,1/0,-1/0,-1/0],this._valid=!!K}co.prototype.include=function(K){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],K[0]),this._bbox[1]=Math.min(this._bbox[1],K[1]),this._bbox[2]=Math.max(this._bbox[2],K[0]),this._bbox[3]=Math.max(this._bbox[3],K[1]),this},co.prototype.equals=function(K){var he;return he=K instanceof co?K.bbox():K,this._bbox[0]==he[0]&&this._bbox[1]==he[1]&&this._bbox[2]==he[2]&&this._bbox[3]==he[3]},co.prototype.center=function(K){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},co.prototype.union=function(K){var he;return this._valid=!0,he=K instanceof co?K.bbox():K,this._bbox[0]=Math.min(this._bbox[0],he[0]),this._bbox[1]=Math.min(this._bbox[1],he[1]),this._bbox[2]=Math.max(this._bbox[2],he[2]),this._bbox[3]=Math.max(this._bbox[3],he[3]),this},co.prototype.bbox=function(){return this._valid?this._bbox:null},co.prototype.contains=function(K){if(!K)return this._fastContains();if(!this._valid)return null;var he=K[0],Ve=K[1];return this._bbox[0]<=he&&this._bbox[1]<=Ve&&this._bbox[2]>=he&&this._bbox[3]>=Ve},co.prototype.intersect=function(K){return this._valid?(he=K instanceof co?K.bbox():K,!(this._bbox[0]>he[2]||this._bbox[2]<he[0]||this._bbox[3]<he[1]||this._bbox[1]>he[3])):null;var he},co.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var K="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",K)},co.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Lo=function(K){if(!K)return[];var he=ke(Ee(K)),Ve=[];return he.features.forEach(function(wt){wt.geometry&&(Ve=Ve.concat(qe(wt.geometry.coordinates)))}),Ve},Eo=In,cr=ho,rr={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},qo=Object.keys(rr);function cn(K){for(var he=cr(),Ve=Lo(K),wt=0;wt<Ve.length;wt++)he.include(Ve[wt]);return he}Nr.exports=function(K){return cn(K).bbox()},Nr.exports.polygon=function(K){return cn(K).polygon()},Nr.exports.bboxify=function(K){return Eo(K).map(function(he){he&&qo.some(function(Ve){return!!he[Ve]&&rr[Ve].indexOf(he.type)!==-1})&&(he.bbox=cn(he).bbox(),this.update(he))})};var Yn=s(Nr.exports),To=-90;function $o(K,he){var Ve=To,wt=90,Bt=To,Vt=90,on=270,Kn=-270;K.forEach(function(zn){var yo=Yn(zn),Ln=yo[1],dr=yo[3],uo=yo[0],hr=yo[2];Ln>Ve&&(Ve=Ln),dr<wt&&(wt=dr),dr>Bt&&(Bt=dr),Ln<Vt&&(Vt=Ln),uo<on&&(on=uo),hr>Kn&&(Kn=hr)});var so=he;return Ve+so.lat>85&&(so.lat=85-Ve),Bt+so.lat>90&&(so.lat=90-Bt),wt+so.lat<-85&&(so.lat=-85-wt),Vt+so.lat<To&&(so.lat=To-Vt),on+so.lng<=-270&&(so.lng+=360*Math.ceil(Math.abs(so.lng)/360)),Kn+so.lng>=270&&(so.lng-=360*Math.ceil(Math.abs(so.lng)/360)),so}function Ir(K,he){var Ve=$o(K.map(function(wt){return wt.toGeoJSON()}),he);K.forEach(function(wt){var Bt,Vt=wt.getCoordinates(),on=function(so){var zn={lng:so[0]+Ve.lng,lat:so[1]+Ve.lat};return[zn.lng,zn.lat]},Kn=function(so){return so.map(function(zn){return on(zn)})};wt.type===z.POINT?Bt=on(Vt):wt.type===z.LINE_STRING||wt.type===z.MULTI_POINT?Bt=Vt.map(on):wt.type===z.POLYGON||wt.type===z.MULTI_LINE_STRING?Bt=Vt.map(Kn):wt.type===z.MULTI_POLYGON&&(Bt=Vt.map(function(so){return so.map(function(zn){return Kn(zn)})})),wt.incomingCoords(Bt)})}var yr={onSetup:function(K){var he=this,Ve={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:K.featureIds||[]};return this.setSelected(Ve.initiallySelectedFeatureIds.filter(function(wt){return he.getFeature(wt)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Ve},fireUpdate:function(){this.map.fire(U.UPDATE,{action:ie.MOVE,features:this.getSelected().map(function(K){return K.toGeoJSON()})})},fireActionable:function(){var K=this,he=this.getSelected(),Ve=he.filter(function(Kn){return K.isInstanceOf("MultiFeature",Kn)}),wt=!1;if(he.length>1){wt=!0;var Bt=he[0].type.replace("Multi","");he.forEach(function(Kn){Kn.type.replace("Multi","")!==Bt&&(wt=!1)})}var Vt=Ve.length>0,on=he.length>0;this.setActionableState({combineFeatures:wt,uncombineFeatures:Vt,trash:on})},getUniqueIds:function(K){return K.length?K.map(function(he){return he.properties.id}).filter(function(he){return he!==void 0}).reduce(function(he,Ve){return he.add(Ve),he},new ye).values():[]},stopExtendedInteractions:function(K){K.boxSelectElement&&(K.boxSelectElement.parentNode&&K.boxSelectElement.parentNode.removeChild(K.boxSelectElement),K.boxSelectElement=null),this.map.dragPan.enable(),K.boxSelecting=!1,K.canBoxSelect=!1,K.dragMoving=!1,K.canDragMove=!1},onStop:function(){Er.enable(this)},onMouseMove:function(K,he){return Io(he)&&K.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(K),!0},onMouseOut:function(K){return!K.dragMoving||this.fireUpdate()}};yr.onTap=yr.onClick=function(K,he){return mo(he)?this.clickAnywhere(K,he):yt(Z.VERTEX)(he)?this.clickOnVertex(K,he):Io(he)?this.clickOnFeature(K,he):void 0},yr.clickAnywhere=function(K){var he=this,Ve=this.getSelectedIds();Ve.length&&(this.clearSelectedFeatures(),Ve.forEach(function(wt){return he.doRender(wt)})),Er.enable(this),this.stopExtendedInteractions(K)},yr.clickOnVertex=function(K,he){this.changeMode(H.DIRECT_SELECT,{featureId:he.featureTarget.properties.parent,coordPath:he.featureTarget.properties.coord_path,startPos:he.lngLat}),this.updateUIClasses({mouse:B.MOVE})},yr.startOnActiveFeature=function(K,he){this.stopExtendedInteractions(K),this.map.dragPan.disable(),this.doRender(he.featureTarget.properties.id),K.canDragMove=!0,K.dragMoveLocation=he.lngLat},yr.clickOnFeature=function(K,he){var Ve=this;Er.disable(this),this.stopExtendedInteractions(K);var wt=ur(he),Bt=this.getSelectedIds(),Vt=he.featureTarget.properties.id,on=this.isSelected(Vt);if(!wt&&on&&this.getFeature(Vt).type!==z.POINT)return this.changeMode(H.DIRECT_SELECT,{featureId:Vt});on&&wt?(this.deselect(Vt),this.updateUIClasses({mouse:B.POINTER}),Bt.length===1&&Er.enable(this)):!on&&wt?(this.select(Vt),this.updateUIClasses({mouse:B.MOVE})):on||wt||(Bt.forEach(function(Kn){return Ve.doRender(Kn)}),this.setSelected(Vt),this.updateUIClasses({mouse:B.MOVE})),this.doRender(Vt)},yr.onMouseDown=function(K,he){return qn(he)?this.startOnActiveFeature(K,he):this.drawConfig.boxSelect&&kn(he)?this.startBoxSelect(K,he):void 0},yr.startBoxSelect=function(K,he){this.stopExtendedInteractions(K),this.map.dragPan.disable(),K.boxSelectStartLocation=Bn(he.originalEvent,this.map.getContainer()),K.canBoxSelect=!0},yr.onTouchStart=function(K,he){if(qn(he))return this.startOnActiveFeature(K,he)},yr.onDrag=function(K,he){return K.canDragMove?this.dragMove(K,he):this.drawConfig.boxSelect&&K.canBoxSelect?this.whileBoxSelect(K,he):void 0},yr.whileBoxSelect=function(K,he){K.boxSelecting=!0,this.updateUIClasses({mouse:B.ADD}),K.boxSelectElement||(K.boxSelectElement=document.createElement("div"),K.boxSelectElement.classList.add(P.BOX_SELECT),this.map.getContainer().appendChild(K.boxSelectElement));var Ve=Bn(he.originalEvent,this.map.getContainer()),wt=Math.min(K.boxSelectStartLocation.x,Ve.x),Bt=Math.max(K.boxSelectStartLocation.x,Ve.x),Vt=Math.min(K.boxSelectStartLocation.y,Ve.y),on=Math.max(K.boxSelectStartLocation.y,Ve.y),Kn="translate("+wt+"px, "+Vt+"px)";K.boxSelectElement.style.transform=Kn,K.boxSelectElement.style.WebkitTransform=Kn,K.boxSelectElement.style.width=Bt-wt+"px",K.boxSelectElement.style.height=on-Vt+"px"},yr.dragMove=function(K,he){K.dragMoving=!0,he.originalEvent.stopPropagation();var Ve={lng:he.lngLat.lng-K.dragMoveLocation.lng,lat:he.lngLat.lat-K.dragMoveLocation.lat};Ir(this.getSelected(),Ve),K.dragMoveLocation=he.lngLat},yr.onTouchEnd=yr.onMouseUp=function(K,he){var Ve=this;if(K.dragMoving)this.fireUpdate();else if(K.boxSelecting){var wt=[K.boxSelectStartLocation,Bn(he.originalEvent,this.map.getContainer())],Bt=this.featuresAt(null,wt,"click"),Vt=this.getUniqueIds(Bt).filter(function(on){return!Ve.isSelected(on)});Vt.length&&(this.select(Vt),Vt.forEach(function(on){return Ve.doRender(on)}),this.updateUIClasses({mouse:B.MOVE}))}this.stopExtendedInteractions(K)},yr.toDisplayFeatures=function(K,he,Ve){he.properties.active=this.isSelected(he.properties.id)?G.ACTIVE:G.INACTIVE,Ve(he),this.fireActionable(),he.properties.active===G.ACTIVE&&he.geometry.type!==z.POINT&&hi(he).forEach(Ve)},yr.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},yr.onCombineFeatures=function(){var K=this.getSelected();if(!(K.length===0||K.length<2)){for(var he=[],Ve=[],wt=K[0].type.replace("Multi",""),Bt=0;Bt<K.length;Bt++){var Vt=K[Bt];if(Vt.type.replace("Multi","")!==wt)return;Vt.type.includes("Multi")?Vt.getCoordinates().forEach(function(Kn){he.push(Kn)}):he.push(Vt.getCoordinates()),Ve.push(Vt.toGeoJSON())}if(Ve.length>1){var on=this.newFeature({type:z.FEATURE,properties:Ve[0].properties,geometry:{type:"Multi"+wt,coordinates:he}});this.addFeature(on),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([on.id]),this.map.fire(U.COMBINE_FEATURES,{createdFeatures:[on.toGeoJSON()],deletedFeatures:Ve})}this.fireActionable()}},yr.onUncombineFeatures=function(){var K=this,he=this.getSelected();if(he.length!==0){for(var Ve=[],wt=[],Bt=function(on){var Kn=he[on];K.isInstanceOf("MultiFeature",Kn)&&(Kn.getFeatures().forEach(function(so){K.addFeature(so),so.properties=Kn.properties,Ve.push(so.toGeoJSON()),K.select([so.id])}),K.deleteFeature(Kn.id,{silent:!0}),wt.push(Kn.toGeoJSON()))},Vt=0;Vt<he.length;Vt++)Bt(Vt);Ve.length>1&&this.map.fire(U.UNCOMBINE_FEATURES,{createdFeatures:Ve,deletedFeatures:wt}),this.fireActionable()}};var rl=yt(Z.VERTEX),ps=yt(Z.MIDPOINT),ms={fireUpdate:function(){this.map.fire(U.UPDATE,{action:ie.CHANGE_COORDINATES,features:this.getSelected().map(function(K){return K.toGeoJSON()})})},fireActionable:function(K){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:K.selectedCoordPaths.length>0})},startDragging:function(K,he){this.map.dragPan.disable(),K.canDragMove=!0,K.dragMoveLocation=he.lngLat},stopDragging:function(K){this.map.dragPan.enable(),K.dragMoving=!1,K.canDragMove=!1,K.dragMoveLocation=null},onVertex:function(K,he){this.startDragging(K,he);var Ve=he.featureTarget.properties,wt=K.selectedCoordPaths.indexOf(Ve.coord_path);ur(he)||wt!==-1?ur(he)&&wt===-1&&K.selectedCoordPaths.push(Ve.coord_path):K.selectedCoordPaths=[Ve.coord_path];var Bt=this.pathsToCoordinates(K.featureId,K.selectedCoordPaths);this.setSelectedCoordinates(Bt)},onMidpoint:function(K,he){this.startDragging(K,he);var Ve=he.featureTarget.properties;K.feature.addCoordinate(Ve.coord_path,Ve.lng,Ve.lat),this.fireUpdate(),K.selectedCoordPaths=[Ve.coord_path]},pathsToCoordinates:function(K,he){return he.map(function(Ve){return{feature_id:K,coord_path:Ve}})},onFeature:function(K,he){K.selectedCoordPaths.length===0?this.startDragging(K,he):this.stopDragging(K)},dragFeature:function(K,he,Ve){Ir(this.getSelected(),Ve),K.dragMoveLocation=he.lngLat},dragVertex:function(K,he,Ve){for(var wt=K.selectedCoordPaths.map(function(Kn){return K.feature.getCoordinate(Kn)}),Bt=$o(wt.map(function(Kn){return{type:z.FEATURE,properties:{},geometry:{type:z.POINT,coordinates:Kn}}}),Ve),Vt=0;Vt<wt.length;Vt++){var on=wt[Vt];K.feature.updateCoordinate(K.selectedCoordPaths[Vt],on[0]+Bt.lng,on[1]+Bt.lat)}},clickNoTarget:function(){this.changeMode(H.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(H.SIMPLE_SELECT)},clickActiveFeature:function(K){K.selectedCoordPaths=[],this.clearSelectedCoordinates(),K.feature.changed()},onSetup:function(K){var he=K.featureId,Ve=this.getFeature(he);if(!Ve)throw new Error("You must provide a featureId to enter direct_select mode");if(Ve.type===z.POINT)throw new TypeError("direct_select mode doesn't handle point features");var wt={featureId:he,feature:Ve,dragMoveLocation:K.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:K.coordPath?[K.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(he,wt.selectedCoordPaths)),this.setSelected(he),Er.disable(this),this.setActionableState({trash:!0}),wt},onStop:function(){Er.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(K,he,Ve){K.featureId===he.properties.id?(he.properties.active=G.ACTIVE,Ve(he),hi(he,{map:this.map,midpoints:!0,selectedPaths:K.selectedCoordPaths}).forEach(Ve)):(he.properties.active=G.INACTIVE,Ve(he)),this.fireActionable(K)},onTrash:function(K){K.selectedCoordPaths.sort(function(he,Ve){return Ve.localeCompare(he,"en",{numeric:!0})}).forEach(function(he){return K.feature.removeCoordinate(he)}),this.fireUpdate(),K.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(K),K.feature.isValid()===!1&&(this.deleteFeature([K.featureId]),this.changeMode(H.SIMPLE_SELECT,{}))},onMouseMove:function(K,he){var Ve=qn(he),wt=rl(he),Bt=ps(he),Vt=K.selectedCoordPaths.length===0;return Ve&&Vt||wt&&!Vt?this.updateUIClasses({mouse:B.MOVE}):this.updateUIClasses({mouse:B.NONE}),(wt||Ve||Bt)&&K.dragMoving&&this.fireUpdate(),this.stopDragging(K),!0},onMouseOut:function(K){return K.dragMoving&&this.fireUpdate(),!0}};ms.onTouchStart=ms.onMouseDown=function(K,he){return rl(he)?this.onVertex(K,he):qn(he)?this.onFeature(K,he):ps(he)?this.onMidpoint(K,he):void 0},ms.onDrag=function(K,he){if(K.canDragMove===!0){K.dragMoving=!0,he.originalEvent.stopPropagation();var Ve={lng:he.lngLat.lng-K.dragMoveLocation.lng,lat:he.lngLat.lat-K.dragMoveLocation.lat};K.selectedCoordPaths.length>0?this.dragVertex(K,he,Ve):this.dragFeature(K,he,Ve),K.dragMoveLocation=he.lngLat}},ms.onClick=function(K,he){return mo(he)?this.clickNoTarget(K,he):qn(he)?this.clickActiveFeature(K,he):Co(he)?this.clickInactive(K,he):void this.stopDragging(K)},ms.onTap=function(K,he){return mo(he)?this.clickNoTarget(K,he):qn(he)?this.clickActiveFeature(K,he):Co(he)?this.clickInactive(K,he):void 0},ms.onTouchEnd=ms.onMouseUp=function(K){K.dragMoving&&this.fireUpdate(),this.stopDragging(K)};var za={};function ac(K,he){return!!K.lngLat&&K.lngLat.lng===he[0]&&K.lngLat.lat===he[1]}za.onSetup=function(){var K=this.newFeature({type:z.FEATURE,properties:{},geometry:{type:z.POINT,coordinates:[]}});return this.addFeature(K),this.clearSelectedFeatures(),this.updateUIClasses({mouse:B.ADD}),this.activateUIButton($.POINT),this.setActionableState({trash:!0}),{point:K}},za.stopDrawingAndRemove=function(K){this.deleteFeature([K.point.id],{silent:!0}),this.changeMode(H.SIMPLE_SELECT)},za.onTap=za.onClick=function(K,he){this.updateUIClasses({mouse:B.MOVE}),K.point.updateCoordinate("",he.lngLat.lng,he.lngLat.lat),this.map.fire(U.CREATE,{features:[K.point.toGeoJSON()]}),this.changeMode(H.SIMPLE_SELECT,{featureIds:[K.point.id]})},za.onStop=function(K){this.activateUIButton(),K.point.getCoordinate().length||this.deleteFeature([K.point.id],{silent:!0})},za.toDisplayFeatures=function(K,he,Ve){var wt=he.properties.id===K.point.id;if(he.properties.active=wt?G.ACTIVE:G.INACTIVE,!wt)return Ve(he)},za.onTrash=za.stopDrawingAndRemove,za.onKeyUp=function(K,he){if(Dt(he)||En(he))return this.stopDrawingAndRemove(K,he)};var il={onSetup:function(){var K=this.newFeature({type:z.FEATURE,properties:{},geometry:{type:z.POLYGON,coordinates:[[]]}});return this.addFeature(K),this.clearSelectedFeatures(),Er.disable(this),this.updateUIClasses({mouse:B.ADD}),this.activateUIButton($.POLYGON),this.setActionableState({trash:!0}),{polygon:K,currentVertexPosition:0}},clickAnywhere:function(K,he){if(K.currentVertexPosition>0&&ac(he,K.polygon.coordinates[0][K.currentVertexPosition-1]))return this.changeMode(H.SIMPLE_SELECT,{featureIds:[K.polygon.id]});this.updateUIClasses({mouse:B.ADD}),K.polygon.updateCoordinate("0."+K.currentVertexPosition,he.lngLat.lng,he.lngLat.lat),K.currentVertexPosition++,K.polygon.updateCoordinate("0."+K.currentVertexPosition,he.lngLat.lng,he.lngLat.lat)},clickOnVertex:function(K){return this.changeMode(H.SIMPLE_SELECT,{featureIds:[K.polygon.id]})},onMouseMove:function(K,he){K.polygon.updateCoordinate("0."+K.currentVertexPosition,he.lngLat.lng,he.lngLat.lat),Ho(he)&&this.updateUIClasses({mouse:B.POINTER})}};il.onTap=il.onClick=function(K,he){return Ho(he)?this.clickOnVertex(K,he):this.clickAnywhere(K,he)},il.onKeyUp=function(K,he){Dt(he)?(this.deleteFeature([K.polygon.id],{silent:!0}),this.changeMode(H.SIMPLE_SELECT)):En(he)&&this.changeMode(H.SIMPLE_SELECT,{featureIds:[K.polygon.id]})},il.onStop=function(K){this.updateUIClasses({mouse:B.NONE}),Er.enable(this),this.activateUIButton(),this.getFeature(K.polygon.id)!==void 0&&(K.polygon.removeCoordinate("0."+K.currentVertexPosition),K.polygon.isValid()?this.map.fire(U.CREATE,{features:[K.polygon.toGeoJSON()]}):(this.deleteFeature([K.polygon.id],{silent:!0}),this.changeMode(H.SIMPLE_SELECT,{},{silent:!0})))},il.toDisplayFeatures=function(K,he,Ve){var wt=he.properties.id===K.polygon.id;if(he.properties.active=wt?G.ACTIVE:G.INACTIVE,!wt)return Ve(he);if(he.geometry.coordinates.length!==0){var Bt=he.geometry.coordinates[0].length;if(!(Bt<3)){if(he.properties.meta=Z.FEATURE,Ve(Oo(K.polygon.id,he.geometry.coordinates[0][0],"0.0",!1)),Bt>3){var Vt=he.geometry.coordinates[0].length-3;Ve(Oo(K.polygon.id,he.geometry.coordinates[0][Vt],"0."+Vt,!1))}if(Bt<=4){var on=[[he.geometry.coordinates[0][0][0],he.geometry.coordinates[0][0][1]],[he.geometry.coordinates[0][1][0],he.geometry.coordinates[0][1][1]]];if(Ve({type:z.FEATURE,properties:he.properties,geometry:{coordinates:on,type:z.LINE_STRING}}),Bt===3)return}return Ve(he)}}},il.onTrash=function(K){this.deleteFeature([K.polygon.id],{silent:!0}),this.changeMode(H.SIMPLE_SELECT)};var al={onSetup:function(K){var he,Ve,wt=(K=K||{}).featureId,Bt="forward";if(wt){if(!(he=this.getFeature(wt)))throw new Error("Could not find a feature with the provided featureId");var Vt=K.from;if(Vt&&Vt.type==="Feature"&&Vt.geometry&&Vt.geometry.type==="Point"&&(Vt=Vt.geometry),Vt&&Vt.type==="Point"&&Vt.coordinates&&Vt.coordinates.length===2&&(Vt=Vt.coordinates),!Vt||!Array.isArray(Vt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var on=he.coordinates.length-1;if(he.coordinates[on][0]===Vt[0]&&he.coordinates[on][1]===Vt[1])Ve=on+1,he.addCoordinate.apply(he,[Ve].concat(he.coordinates[on]));else{if(he.coordinates[0][0]!==Vt[0]||he.coordinates[0][1]!==Vt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Bt="backwards",Ve=0,he.addCoordinate.apply(he,[Ve].concat(he.coordinates[0]))}}else he=this.newFeature({type:z.FEATURE,properties:{},geometry:{type:z.LINE_STRING,coordinates:[]}}),Ve=0,this.addFeature(he);return this.clearSelectedFeatures(),Er.disable(this),this.updateUIClasses({mouse:B.ADD}),this.activateUIButton($.LINE),this.setActionableState({trash:!0}),{line:he,currentVertexPosition:Ve,direction:Bt}},clickAnywhere:function(K,he){if(K.currentVertexPosition>0&&ac(he,K.line.coordinates[K.currentVertexPosition-1])||K.direction==="backwards"&&ac(he,K.line.coordinates[K.currentVertexPosition+1]))return this.changeMode(H.SIMPLE_SELECT,{featureIds:[K.line.id]});this.updateUIClasses({mouse:B.ADD}),K.line.updateCoordinate(K.currentVertexPosition,he.lngLat.lng,he.lngLat.lat),K.direction==="forward"?(K.currentVertexPosition++,K.line.updateCoordinate(K.currentVertexPosition,he.lngLat.lng,he.lngLat.lat)):K.line.addCoordinate(0,he.lngLat.lng,he.lngLat.lat)},clickOnVertex:function(K){return this.changeMode(H.SIMPLE_SELECT,{featureIds:[K.line.id]})},onMouseMove:function(K,he){K.line.updateCoordinate(K.currentVertexPosition,he.lngLat.lng,he.lngLat.lat),Ho(he)&&this.updateUIClasses({mouse:B.POINTER})}};al.onTap=al.onClick=function(K,he){if(Ho(he))return this.clickOnVertex(K,he);this.clickAnywhere(K,he)},al.onKeyUp=function(K,he){En(he)?this.changeMode(H.SIMPLE_SELECT,{featureIds:[K.line.id]}):Dt(he)&&(this.deleteFeature([K.line.id],{silent:!0}),this.changeMode(H.SIMPLE_SELECT))},al.onStop=function(K){Er.enable(this),this.activateUIButton(),this.getFeature(K.line.id)!==void 0&&(K.line.removeCoordinate(""+K.currentVertexPosition),K.line.isValid()?this.map.fire(U.CREATE,{features:[K.line.toGeoJSON()]}):(this.deleteFeature([K.line.id],{silent:!0}),this.changeMode(H.SIMPLE_SELECT,{},{silent:!0})))},al.onTrash=function(K){this.deleteFeature([K.line.id],{silent:!0}),this.changeMode(H.SIMPLE_SELECT)},al.toDisplayFeatures=function(K,he,Ve){var wt=he.properties.id===K.line.id;if(he.properties.active=wt?G.ACTIVE:G.INACTIVE,!wt)return Ve(he);he.geometry.coordinates.length<2||(he.properties.meta=Z.FEATURE,Ve(Oo(K.line.id,he.geometry.coordinates[K.direction==="forward"?he.geometry.coordinates.length-2:1],""+(K.direction==="forward"?he.geometry.coordinates.length-2:1),!1)),Ve(he))};var sc={simple_select:yr,direct_select:ms,draw_point:za,draw_polygon:il,draw_line_string:al},tu={defaultMode:H.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:jn,modes:sc,controls:{},userProperties:!1},Ya={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},gs={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Xa(K,he){return K.map(function(Ve){return Ve.source?Ve:ln(Ve,{id:Ve.id+"."+he,source:he==="hot"?F.HOT:F.COLD})})}var fa={exports:{}};(function(K,he){var Ve="__lodash_hash_undefined__",wt=9007199254740991,Bt="[object Arguments]",Vt="[object Array]",on="[object Boolean]",Kn="[object Date]",so="[object Error]",zn="[object Function]",yo="[object Map]",Ln="[object Number]",dr="[object Object]",uo="[object Promise]",hr="[object RegExp]",Ti="[object Set]",$n="[object String]",ko="[object Symbol]",oi="[object WeakMap]",yi="[object ArrayBuffer]",Hn="[object DataView]",fr=/^\[object .+?Constructor\]$/,br=/^(?:0|[1-9]\d*)$/,zr={};zr["[object Float32Array]"]=zr["[object Float64Array]"]=zr["[object Int8Array]"]=zr["[object Int16Array]"]=zr["[object Int32Array]"]=zr["[object Uint8Array]"]=zr["[object Uint8ClampedArray]"]=zr["[object Uint16Array]"]=zr["[object Uint32Array]"]=!0,zr[Bt]=zr[Vt]=zr[yi]=zr[on]=zr[Hn]=zr[Kn]=zr[so]=zr[zn]=zr[yo]=zr[Ln]=zr[dr]=zr[hr]=zr[Ti]=zr[$n]=zr[oi]=!1;var sa=typeof Ps=="object"&&Ps&&Ps.Object===Object&&Ps,xr=typeof self=="object"&&self&&self.Object===Object&&self,Ja=sa||xr||Function("return this")(),cc=he&&!he.nodeType&&he,uc=cc&&K&&!K.nodeType&&K,pa=uc&&uc.exports===cc,xi=pa&&sa.process,Oh=function(){try{return xi&&xi.binding&&xi.binding("util")}catch{}}(),dc=Oh&&Oh.isTypedArray;function ou(an,Tn){for(var vo=-1,Jo=an==null?0:an.length;++vo<Jo;)if(Tn(an[vo],vo,an))return!0;return!1}function $s(an){var Tn=-1,vo=Array(an.size);return an.forEach(function(Jo,Si){vo[++Tn]=[Si,Jo]}),vo}function hd(an){var Tn=-1,vo=Array(an.size);return an.forEach(function(Jo){vo[++Tn]=Jo}),vo}var Ia,la,ma,Zf=Array.prototype,El=Function.prototype,Ci=Object.prototype,ca=Ja["__core-js_shared__"],Qa=El.toString,_i=Ci.hasOwnProperty,fd=(Ia=/[^.]+$/.exec(ca&&ca.keys&&ca.keys.IE_PROTO||""))?"Symbol(src)_1."+Ia:"",es=Ci.toString,ru=RegExp("^"+Qa.call(_i).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ml=pa?Ja.Buffer:void 0,Vs=Ja.Symbol,Lu=Ja.Uint8Array,Us=Ci.propertyIsEnumerable,Zm=Zf.splice,Il=Vs?Vs.toStringTag:void 0,va=Object.getOwnPropertySymbols,Ym=Ml?Ml.isBuffer:void 0,pd=(la=Object.keys,ma=Object,function(an){return la(ma(an))}),md=Aa(Ja,"DataView"),js=Aa(Ja,"Map"),Al=Aa(Ja,"Promise"),Lh=Aa(Ja,"Set"),hc=Aa(Ja,"WeakMap"),_s=Aa(Object,"create"),Xm=Rl(md),iu=Rl(js),Yf=Rl(Al),gd=Rl(Lh),Fa=Rl(hc),ir=Vs?Vs.prototype:void 0,bo=ir?ir.valueOf:void 0;function sl(an){var Tn=-1,vo=an==null?0:an.length;for(this.clear();++Tn<vo;){var Jo=an[Tn];this.set(Jo[0],Jo[1])}}function Do(an){var Tn=-1,vo=an==null?0:an.length;for(this.clear();++Tn<vo;){var Jo=an[Tn];this.set(Jo[0],Jo[1])}}function ll(an){var Tn=-1,vo=an==null?0:an.length;for(this.clear();++Tn<vo;){var Jo=an[Tn];this.set(Jo[0],Jo[1])}}function kl(an){var Tn=-1,vo=an==null?0:an.length;for(this.__data__=new ll;++Tn<vo;)this.add(an[Tn])}function Po(an){var Tn=this.__data__=new Do(an);this.size=Tn.size}function Dh(an,Tn){var vo=yc(an),Jo=!vo&&_d(an),Si=!vo&&!Jo&&au(an),Or=!vo&&!Jo&&!Si&&bc(an),Li=vo||Jo||Si||Or,Hi=Li?function(Gi,ys){for(var Ba=-1,oa=Array(Gi);++Ba<Gi;)oa[Ba]=ys(Ba);return oa}(an.length,String):[],ts=Hi.length;for(var Zi in an)!_i.call(an,Zi)||Li&&(Zi=="length"||Si&&(Zi=="offset"||Zi=="parent")||Or&&(Zi=="buffer"||Zi=="byteLength"||Zi=="byteOffset")||Nn(Zi,ts))||Hi.push(Zi);return Hi}function fc(an,Tn){for(var vo=an.length;vo--;)if(_c(an[vo][0],Tn))return vo;return-1}function pc(an){return an==null?an===void 0?"[object Undefined]":"[object Null]":Il&&Il in Object(an)?function(Tn){var vo=_i.call(Tn,Il),Jo=Tn[Il];try{Tn[Il]=void 0;var Si=!0}catch{}var Or=es.call(Tn);return Si&&(vo?Tn[Il]=Jo:delete Tn[Il]),Or}(an):function(Tn){return es.call(Tn)}(an)}function cl(an){return Ol(an)&&pc(an)==Bt}function Pl(an,Tn,vo,Jo,Si){return an===Tn||(an==null||Tn==null||!Ol(an)&&!Ol(Tn)?an!=an&&Tn!=Tn:function(Or,Li,Hi,ts,Zi,Gi){var ys=yc(Or),Ba=yc(Li),oa=ys?Vt:Hs(Or),Na=Ba?Vt:Hs(Li),bs=(oa=oa==Bt?dr:oa)==dr,Ll=(Na=Na==Bt?dr:Na)==dr,ul=oa==Na;if(ul&&au(Or)){if(!au(Li))return!1;ys=!0,bs=!1}if(ul&&!bs)return Gi||(Gi=new Po),ys||bc(Or)?mc(Or,Li,Hi,ts,Zi,Gi):function(li,ri,Dl,$a,$r,Pa,Ws){switch(Dl){case Hn:if(li.byteLength!=ri.byteLength||li.byteOffset!=ri.byteOffset)return!1;li=li.buffer,ri=ri.buffer;case yi:return!(li.byteLength!=ri.byteLength||!Pa(new Lu(li),new Lu(ri)));case on:case Kn:case Ln:return _c(+li,+ri);case so:return li.name==ri.name&&li.message==ri.message;case hr:case $n:return li==ri+"";case yo:var qs=$s;case Ti:var zl=1&$a;if(qs||(qs=hd),li.size!=ri.size&&!zl)return!1;var Fl=Ws.get(li);if(Fl)return Fl==ri;$a|=2,Ws.set(li,ri);var xc=mc(qs(li),qs(ri),$a,$r,Pa,Ws);return Ws.delete(li),xc;case ko:if(bo)return bo.call(li)==bo.call(ri)}return!1}(Or,Li,oa,Hi,ts,Zi,Gi);if(!(1&Hi)){var ns=bs&&_i.call(Or,"__wrapped__"),dl=Ll&&_i.call(Li,"__wrapped__");if(ns||dl){var pr=ns?Or.value():Or,su=dl?Li.value():Li;return Gi||(Gi=new Po),Zi(pr,su,Hi,ts,Gi)}}return ul?(Gi||(Gi=new Po),function(li,ri,Dl,$a,$r,Pa){var Ws=1&Dl,qs=gc(li),zl=qs.length,Fl=gc(ri).length;if(zl!=Fl&&!Ws)return!1;for(var xc=zl;xc--;){var Bl=qs[xc];if(!(Ws?Bl in ri:_i.call(ri,Bl)))return!1}var zh=Pa.get(li);if(zh&&Pa.get(ri))return zh==ri;var hl=!0;Pa.set(li,ri),Pa.set(ri,li);for(var bd=Ws;++xc<zl;){var xd=li[Bl=qs[xc]],wd=ri[Bl];if($a)var Jf=Ws?$a(wd,xd,Bl,ri,li,Pa):$a(xd,wd,Bl,li,ri,Pa);if(!(Jf===void 0?xd===wd||$r(xd,wd,Dl,$a,Pa):Jf)){hl=!1;break}bd||(bd=Bl=="constructor")}if(hl&&!bd){var lu=li.constructor,cu=ri.constructor;lu==cu||!("constructor"in li)||!("constructor"in ri)||typeof lu=="function"&&lu instanceof lu&&typeof cu=="function"&&cu instanceof cu||(hl=!1)}return Pa.delete(li),Pa.delete(ri),hl}(Or,Li,Hi,ts,Zi,Gi)):!1}(an,Tn,vo,Jo,Pl,Si))}function ua(an){return!(!ka(an)||function(Tn){return!!fd&&fd in Tn}(an))&&(Gs(an)?ru:fr).test(Rl(an))}function vd(an){if(vo=(Tn=an)&&Tn.constructor,Jo=typeof vo=="function"&&vo.prototype||Ci,Tn!==Jo)return pd(an);var Tn,vo,Jo,Si=[];for(var Or in Object(an))_i.call(an,Or)&&Or!="constructor"&&Si.push(Or);return Si}function mc(an,Tn,vo,Jo,Si,Or){var Li=1&vo,Hi=an.length,ts=Tn.length;if(Hi!=ts&&!(Li&&ts>Hi))return!1;var Zi=Or.get(an);if(Zi&&Or.get(Tn))return Zi==Tn;var Gi=-1,ys=!0,Ba=2&vo?new kl:void 0;for(Or.set(an,Tn),Or.set(Tn,an);++Gi<Hi;){var oa=an[Gi],Na=Tn[Gi];if(Jo)var bs=Li?Jo(Na,oa,Gi,Tn,an,Or):Jo(oa,Na,Gi,an,Tn,Or);if(bs!==void 0){if(bs)continue;ys=!1;break}if(Ba){if(!ou(Tn,function(Ll,ul){if(ns=ul,!Ba.has(ns)&&(oa===Ll||Si(oa,Ll,vo,Jo,Or)))return Ba.push(ul);var ns})){ys=!1;break}}else if(oa!==Na&&!Si(oa,Na,vo,Jo,Or)){ys=!1;break}}return Or.delete(an),Or.delete(Tn),ys}function gc(an){return function(Tn,vo,Jo){var Si=vo(Tn);return yc(Tn)?Si:function(Or,Li){for(var Hi=-1,ts=Li.length,Zi=Or.length;++Hi<ts;)Or[Zi+Hi]=Li[Hi];return Or}(Si,Jo(Tn))}(an,Xf,wi)}function vc(an,Tn){var vo,Jo,Si=an.__data__;return((Jo=typeof(vo=Tn))=="string"||Jo=="number"||Jo=="symbol"||Jo=="boolean"?vo!=="__proto__":vo===null)?Si[typeof Tn=="string"?"string":"hash"]:Si.map}function Aa(an,Tn){var vo=function(Jo,Si){return Jo==null?void 0:Jo[Si]}(an,Tn);return ua(vo)?vo:void 0}sl.prototype.clear=function(){this.__data__=_s?_s(null):{},this.size=0},sl.prototype.delete=function(an){var Tn=this.has(an)&&delete this.__data__[an];return this.size-=Tn?1:0,Tn},sl.prototype.get=function(an){var Tn=this.__data__;if(_s){var vo=Tn[an];return vo===Ve?void 0:vo}return _i.call(Tn,an)?Tn[an]:void 0},sl.prototype.has=function(an){var Tn=this.__data__;return _s?Tn[an]!==void 0:_i.call(Tn,an)},sl.prototype.set=function(an,Tn){var vo=this.__data__;return this.size+=this.has(an)?0:1,vo[an]=_s&&Tn===void 0?Ve:Tn,this},Do.prototype.clear=function(){this.__data__=[],this.size=0},Do.prototype.delete=function(an){var Tn=this.__data__,vo=fc(Tn,an);return!(vo<0)&&(vo==Tn.length-1?Tn.pop():Zm.call(Tn,vo,1),--this.size,!0)},Do.prototype.get=function(an){var Tn=this.__data__,vo=fc(Tn,an);return vo<0?void 0:Tn[vo][1]},Do.prototype.has=function(an){return fc(this.__data__,an)>-1},Do.prototype.set=function(an,Tn){var vo=this.__data__,Jo=fc(vo,an);return Jo<0?(++this.size,vo.push([an,Tn])):vo[Jo][1]=Tn,this},ll.prototype.clear=function(){this.size=0,this.__data__={hash:new sl,map:new(js||Do),string:new sl}},ll.prototype.delete=function(an){var Tn=vc(this,an).delete(an);return this.size-=Tn?1:0,Tn},ll.prototype.get=function(an){return vc(this,an).get(an)},ll.prototype.has=function(an){return vc(this,an).has(an)},ll.prototype.set=function(an,Tn){var vo=vc(this,an),Jo=vo.size;return vo.set(an,Tn),this.size+=vo.size==Jo?0:1,this},kl.prototype.add=kl.prototype.push=function(an){return this.__data__.set(an,Ve),this},kl.prototype.has=function(an){return this.__data__.has(an)},Po.prototype.clear=function(){this.__data__=new Do,this.size=0},Po.prototype.delete=function(an){var Tn=this.__data__,vo=Tn.delete(an);return this.size=Tn.size,vo},Po.prototype.get=function(an){return this.__data__.get(an)},Po.prototype.has=function(an){return this.__data__.has(an)},Po.prototype.set=function(an,Tn){var vo=this.__data__;if(vo instanceof Do){var Jo=vo.__data__;if(!js||Jo.length<199)return Jo.push([an,Tn]),this.size=++vo.size,this;vo=this.__data__=new ll(Jo)}return vo.set(an,Tn),this.size=vo.size,this};var wi=va?function(an){return an==null?[]:(an=Object(an),function(Tn,vo){for(var Jo=-1,Si=Tn==null?0:Tn.length,Or=0,Li=[];++Jo<Si;){var Hi=Tn[Jo];vo(Hi,Jo,Tn)&&(Li[Or++]=Hi)}return Li}(va(an),function(Tn){return Us.call(an,Tn)}))}:function(){return[]},Hs=pc;function Nn(an,Tn){return!!(Tn=Tn??wt)&&(typeof an=="number"||br.test(an))&&an>-1&&an%1==0&&an<Tn}function Rl(an){if(an!=null){try{return Qa.call(an)}catch{}try{return an+""}catch{}}return""}function _c(an,Tn){return an===Tn||an!=an&&Tn!=Tn}(md&&Hs(new md(new ArrayBuffer(1)))!=Hn||js&&Hs(new js)!=yo||Al&&Hs(Al.resolve())!=uo||Lh&&Hs(new Lh)!=Ti||hc&&Hs(new hc)!=oi)&&(Hs=function(an){var Tn=pc(an),vo=Tn==dr?an.constructor:void 0,Jo=vo?Rl(vo):"";if(Jo)switch(Jo){case Xm:return Hn;case iu:return yo;case Yf:return uo;case gd:return Ti;case Fa:return oi}return Tn});var _d=cl(function(){return arguments}())?cl:function(an){return Ol(an)&&_i.call(an,"callee")&&!Us.call(an,"callee")},yc=Array.isArray,au=Ym||function(){return!1};function Gs(an){if(!ka(an))return!1;var Tn=pc(an);return Tn==zn||Tn=="[object GeneratorFunction]"||Tn=="[object AsyncFunction]"||Tn=="[object Proxy]"}function yd(an){return typeof an=="number"&&an>-1&&an%1==0&&an<=wt}function ka(an){var Tn=typeof an;return an!=null&&(Tn=="object"||Tn=="function")}function Ol(an){return an!=null&&typeof an=="object"}var bc=dc?function(an){return function(Tn){return an(Tn)}}(dc):function(an){return Ol(an)&&yd(an.length)&&!!zr[pc(an)]};function Xf(an){return(Tn=an)!=null&&yd(Tn.length)&&!Gs(Tn)?Dh(an):vd(an);var Tn}K.exports=function(an,Tn){return Pl(an,Tn)}})(fa,fa.exports);var vs=s(fa.exports);function nu(K,he){return K.length===he.length&&JSON.stringify(K.map(function(Ve){return Ve}).sort())===JSON.stringify(he.map(function(Ve){return Ve}).sort())}var Ph={Polygon:zt,LineString:Mt,Point:Ct,MultiPolygon:$t,MultiLineString:$t,MultiPoint:$t},Rh=Object.freeze({__proto__:null,CommonSelectors:ft,constrainFeatureMovement:$o,createMidPoint:Rr,createSupplementaryPoints:hi,createVertex:Oo,doubleClickZoom:Er,euclideanDistance:Ae,featuresAt:tt,getFeatureAtAndSetCursors:xe,isClick:Ce,isEventAtCoordinates:ac,isTap:ge,mapEventToBoundingBox:pe,ModeHandler:i,moveFeatures:Ir,sortFeatures:ce,stringSetsAreEqual:nu,StringSet:ye,theme:jn,toDenseArray:Be}),Ns=function(K,he){var Ve={options:K=function(Bt){Bt===void 0&&(Bt={});var Vt=ln(Bt);return Bt.controls||(Vt.controls={}),Bt.displayControlsDefault===!1?Vt.controls=ln(gs,Bt.controls):Vt.controls=ln(Ya,Bt.controls),(Vt=ln(tu,Vt)).styles=Xa(Vt.styles,"cold").concat(Xa(Vt.styles,"hot")),Vt}(K)};he=function(Bt,Vt){return Vt.modes=H,Vt.getFeatureIdsAt=function(on){return tt.click({point:on},null,Bt).map(function(Kn){return Kn.properties.id})},Vt.getSelectedIds=function(){return Bt.store.getSelectedIds()},Vt.getSelected=function(){return{type:z.FEATURE_COLLECTION,features:Bt.store.getSelectedIds().map(function(on){return Bt.store.get(on)}).map(function(on){return on.toGeoJSON()})}},Vt.getSelectedPoints=function(){return{type:z.FEATURE_COLLECTION,features:Bt.store.getSelectedCoordinates().map(function(on){return{type:z.FEATURE,properties:{},geometry:{type:z.POINT,coordinates:on.coordinates}}})}},Vt.set=function(on){if(on.type===void 0||on.type!==z.FEATURE_COLLECTION||!Array.isArray(on.features))throw new Error("Invalid FeatureCollection");var Kn=Bt.store.createRenderBatch(),so=Bt.store.getAllIds().slice(),zn=Vt.add(on),yo=new ye(zn);return(so=so.filter(function(Ln){return!yo.has(Ln)})).length&&Vt.delete(so),Kn(),zn},Vt.add=function(on){var Kn=JSON.parse(JSON.stringify(Bs(on))).features.map(function(so){if(so.id=so.id||ot(),so.geometry===null)throw new Error("Invalid geometry: null");if(Bt.store.get(so.id)===void 0||Bt.store.get(so.id).type!==so.geometry.type){var zn=Ph[so.geometry.type];if(zn===void 0)throw new Error("Invalid geometry type: "+so.geometry.type+".");var yo=new zn(Bt,so);Bt.store.add(yo)}else{var Ln=Bt.store.get(so.id);Ln.properties=so.properties,vs(Ln.properties,so.properties)||Bt.store.featureChanged(Ln.id),vs(Ln.getCoordinates(),so.geometry.coordinates)||Ln.incomingCoords(so.geometry.coordinates)}return so.id});return Bt.store.render(),Kn},Vt.get=function(on){var Kn=Bt.store.get(on);if(Kn)return Kn.toGeoJSON()},Vt.getAll=function(){return{type:z.FEATURE_COLLECTION,features:Bt.store.getAll().map(function(on){return on.toGeoJSON()})}},Vt.delete=function(on){return Bt.store.delete(on,{silent:!0}),Vt.getMode()!==H.DIRECT_SELECT||Bt.store.getSelectedIds().length?Bt.store.render():Bt.events.changeMode(H.SIMPLE_SELECT,void 0,{silent:!0}),Vt},Vt.deleteAll=function(){return Bt.store.delete(Bt.store.getAllIds(),{silent:!0}),Vt.getMode()===H.DIRECT_SELECT?Bt.events.changeMode(H.SIMPLE_SELECT,void 0,{silent:!0}):Bt.store.render(),Vt},Vt.changeMode=function(on,Kn){return Kn===void 0&&(Kn={}),on===H.SIMPLE_SELECT&&Vt.getMode()===H.SIMPLE_SELECT?(nu(Kn.featureIds||[],Bt.store.getSelectedIds())||(Bt.store.setSelected(Kn.featureIds,{silent:!0}),Bt.store.render()),Vt):(on===H.DIRECT_SELECT&&Vt.getMode()===H.DIRECT_SELECT&&Kn.featureId===Bt.store.getSelectedIds()[0]||Bt.events.changeMode(on,Kn,{silent:!0}),Vt)},Vt.getMode=function(){return Bt.events.getMode()},Vt.trash=function(){return Bt.events.trash({silent:!0}),Vt},Vt.combineFeatures=function(){return Bt.events.combineFeatures({silent:!0}),Vt},Vt.uncombineFeatures=function(){return Bt.events.uncombineFeatures({silent:!0}),Vt},Vt.setFeatureProperty=function(on,Kn,so){return Bt.store.setFeatureProperty(on,Kn,so),Vt},Vt}(Ve,he),Ve.api=he;var wt=_n(Ve);return he.onAdd=wt.onAdd,he.onRemove=wt.onRemove,he.types=$,he.options=K,he};function lc(K){Ns(K,this)}return lc.modes=sc,lc.constants=le,lc.lib=Rh,lc})})(jR);var Z6=jR.exports;const Y6=Xc(Z6),X6={class:"control-panel"},J6={key:0,class:"file-name"},Q6={__name:"App",setup(e){gw.accessToken="pk.eyJ1IjoibHZ1c2xmY29vIiwiYSI6ImNsbzJ0Zjd2ejBiN3AydmxlN25pa3E5c3cifQ.qNGUVfyvKHJZqfKlaH_5XQ";const t=Se(null),i=Se(!0),s=Se(""),d=Se(null);No(()=>{t.value=new gw.Map({container:"mapContainer",style:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://khms0.google.com/kh/v=988?x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles"}]},center:[121.544,31.221],zoom:14,pitch:60,bearing:130});const S=new Y6({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}});t.value.addControl(S),t.value.on("load",()=>{console.log("Map loaded.")}),d.value=new gw.Popup({closeButton:!0,closeOnClick:!0})});const g=S=>{const E=S.target.files[0];if(E){s.value=E.name;const I=new FileReader;I.onload=P=>{try{const F=JSON.parse(P.target.result);_(F)}catch(F){console.error("JSON",F)}},I.readAsText(E)}},_=S=>{t.value.getLayer("3d-buildings")&&t.value.removeLayer("3d-buildings"),t.value.getSource("geojson-source")&&t.value.removeSource("geojson-source"),t.value.addSource("geojson-source",{type:"geojson",data:S}),t.value.addLayer({id:"3d-buildings",source:"geojson-source",type:"fill-extrusion",paint:{"fill-extrusion-color":["interpolate",["linear"],["*",["get","Height"],5],0,"rgb(255, 235, 238)",30,"rgb(255, 193, 193)",60,"rgb(244, 67, 54)",100,"rgb(183, 28, 28)"],"fill-extrusion-height":["*",1,["get","Height"]],"fill-extrusion-opacity":.9}}),t.value.on("click","3d-buildings",E=>{const I=E.features;if(I.length>0){const P=I[0].properties,F=E.lngLat;P.Height,d.value.setLngLat(F).setHTML(`<div><strong></strong><pre>${JSON.stringify(P,null,2)}</pre></div>`).addTo(t.value)}}),t.value.on("mouseenter","3d-buildings",()=>{t.value.getCanvas().style.cursor="pointer"}),t.value.on("mouseleave","3d-buildings",()=>{t.value.getCanvas().style.cursor=""})},o=()=>{i.value=!i.value;const S=i.value?"visible":"none";t.value.setLayoutProperty("3d-buildings","visibility",S)};return(S,E)=>(se(),Pe("div",null,[E[0]||(E[0]=He("div",{id:"mapContainer",class:"map-container"},null,-1)),He("div",X6,[He("input",{type:"file",accept:".json",onChange:g,class:"file-input"},null,32),s.value?(se(),Pe("span",J6,""+wn(s.value),1)):St("",!0),He("button",{class:"toggle-button",onClick:o},wn(i.value?"":""),1)])]))}},e$="2.9.0",CA=Symbol("INSTALLED_KEY"),HR=Symbol(),Hv="el",t$="is-",_f=(e,t,i,s,d)=>{let g=`${e}-${t}`;return i&&(g+=`-${i}`),s&&(g+=`__${s}`),d&&(g+=`--${d}`),g},GR=Symbol("namespaceContextKey"),BS=e=>{const t=e||(jo()?Un(GR,Se(Hv)):Se(Hv));return te(()=>y(t)||Hv)},rn=(e,t)=>{const i=BS(t);return{namespace:i,b:(z="")=>_f(i.value,e,z,"",""),e:z=>z?_f(i.value,e,"",z,""):"",m:z=>z?_f(i.value,e,"","",z):"",be:(z,H)=>z&&H?_f(i.value,e,z,H,""):"",em:(z,H)=>z&&H?_f(i.value,e,"",z,H):"",bm:(z,H)=>z&&H?_f(i.value,e,z,"",H):"",bem:(z,H,U)=>z&&H&&U?_f(i.value,e,z,H,U):"",is:(z,...H)=>{const U=H.length>=1?H[0]:!0;return z&&U?`${t$}${z}`:""},cssVar:z=>{const H={};for(const U in z)z[U]&&(H[`--${i.value}-${U}`]=z[U]);return H},cssVarName:z=>`--${i.value}-${z}`,cssVarBlock:z=>{const H={};for(const U in z)z[U]&&(H[`--${i.value}-${e}-${U}`]=z[U]);return H},cssVarBlockName:z=>`--${i.value}-${e}-${z}`}};var WR=typeof global=="object"&&global&&global.Object===Object&&global,n$=typeof self=="object"&&self&&self.Object===Object&&self,Jc=WR||n$||Function("return this")(),tc=Jc.Symbol,qR=Object.prototype,o$=qR.hasOwnProperty,r$=qR.toString,Iv=tc?tc.toStringTag:void 0;function i$(e){var t=o$.call(e,Iv),i=e[Iv];try{e[Iv]=void 0;var s=!0}catch{}var d=r$.call(e);return s&&(t?e[Iv]=i:delete e[Iv]),d}var a$=Object.prototype,s$=a$.toString;function l$(e){return s$.call(e)}var c$="[object Null]",u$="[object Undefined]",EA=tc?tc.toStringTag:void 0;function Gf(e){return e==null?e===void 0?u$:c$:EA&&EA in Object(e)?i$(e):l$(e)}function Tu(e){return e!=null&&typeof e=="object"}var d$="[object Symbol]";function Jb(e){return typeof e=="symbol"||Tu(e)&&Gf(e)==d$}function NS(e,t){for(var i=-1,s=e==null?0:e.length,d=Array(s);++i<s;)d[i]=t(e[i],i,e);return d}var zs=Array.isArray,h$=1/0,MA=tc?tc.prototype:void 0,IA=MA?MA.toString:void 0;function KR(e){if(typeof e=="string")return e;if(zs(e))return NS(e,KR)+"";if(Jb(e))return IA?IA.call(e):"";var t=e+"";return t=="0"&&1/e==-h$?"-0":t}var f$=/\s/;function p$(e){for(var t=e.length;t--&&f$.test(e.charAt(t)););return t}var m$=/^\s+/;function g$(e){return e&&e.slice(0,p$(e)+1).replace(m$,"")}function Fs(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var AA=NaN,v$=/^[-+]0x[0-9a-f]+$/i,_$=/^0b[01]+$/i,y$=/^0o[0-7]+$/i,b$=parseInt;function kA(e){if(typeof e=="number")return e;if(Jb(e))return AA;if(Fs(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Fs(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=g$(e);var i=_$.test(e);return i||y$.test(e)?b$(e.slice(2),i?2:8):v$.test(e)?AA:+e}function $S(e){return e}var x$="[object AsyncFunction]",w$="[object Function]",S$="[object GeneratorFunction]",T$="[object Proxy]";function VS(e){if(!Fs(e))return!1;var t=Gf(e);return t==w$||t==S$||t==x$||t==T$}var vw=Jc["__core-js_shared__"],PA=function(){var e=/[^.]+$/.exec(vw&&vw.keys&&vw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function C$(e){return!!PA&&PA in e}var E$=Function.prototype,M$=E$.toString;function Wf(e){if(e!=null){try{return M$.call(e)}catch{}try{return e+""}catch{}}return""}var I$=/[\\^$.*+?()[\]{}|]/g,A$=/^\[object .+?Constructor\]$/,k$=Function.prototype,P$=Object.prototype,R$=k$.toString,O$=P$.hasOwnProperty,L$=RegExp("^"+R$.call(O$).replace(I$,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function D$(e){if(!Fs(e)||C$(e))return!1;var t=VS(e)?L$:A$;return t.test(Wf(e))}function z$(e,t){return e==null?void 0:e[t]}function qf(e,t){var i=z$(e,t);return D$(i)?i:void 0}var a2=qf(Jc,"WeakMap"),RA=Object.create,F$=function(){function e(){}return function(t){if(!Fs(t))return{};if(RA)return RA(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function B$(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function N$(){}function ZR(e,t){var i=-1,s=e.length;for(t||(t=Array(s));++i<s;)t[i]=e[i];return t}var $$=800,V$=16,U$=Date.now;function j$(e){var t=0,i=0;return function(){var s=U$(),d=V$-(s-i);if(i=s,d>0){if(++t>=$$)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function H$(e){return function(){return e}}var gb=function(){try{var e=qf(Object,"defineProperty");return e({},"",{}),e}catch{}}(),G$=gb?function(e,t){return gb(e,"toString",{configurable:!0,enumerable:!1,value:H$(t),writable:!0})}:$S,YR=j$(G$);function W$(e,t){for(var i=-1,s=e==null?0:e.length;++i<s&&t(e[i],i,e)!==!1;);return e}function XR(e,t,i,s){for(var d=e.length,g=i+(s?1:-1);s?g--:++g<d;)if(t(e[g],g,e))return g;return-1}function q$(e){return e!==e}function K$(e,t,i){for(var s=i-1,d=e.length;++s<d;)if(e[s]===t)return s;return-1}function Z$(e,t,i){return t===t?K$(e,t,i):XR(e,q$,i)}function Y$(e,t){var i=e==null?0:e.length;return!!i&&Z$(e,t,0)>-1}var X$=9007199254740991,J$=/^(?:0|[1-9]\d*)$/;function Qb(e,t){var i=typeof e;return t=t??X$,!!t&&(i=="number"||i!="symbol"&&J$.test(e))&&e>-1&&e%1==0&&e<t}function US(e,t,i){t=="__proto__"&&gb?gb(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function k_(e,t){return e===t||e!==e&&t!==t}var Q$=Object.prototype,eV=Q$.hasOwnProperty;function jS(e,t,i){var s=e[t];(!(eV.call(e,t)&&k_(s,i))||i===void 0&&!(t in e))&&US(e,t,i)}function Fm(e,t,i,s){var d=!i;i||(i={});for(var g=-1,_=t.length;++g<_;){var o=t[g],S=void 0;S===void 0&&(S=e[o]),d?US(i,o,S):jS(i,o,S)}return i}var OA=Math.max;function JR(e,t,i){return t=OA(t===void 0?e.length-1:t,0),function(){for(var s=arguments,d=-1,g=OA(s.length-t,0),_=Array(g);++d<g;)_[d]=s[t+d];d=-1;for(var o=Array(t+1);++d<t;)o[d]=s[d];return o[t]=i(_),B$(e,this,o)}}function QR(e,t){return YR(JR(e,t,$S),e+"")}var tV=9007199254740991;function HS(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=tV}function Bm(e){return e!=null&&HS(e.length)&&!VS(e)}function nV(e,t,i){if(!Fs(i))return!1;var s=typeof t;return(s=="number"?Bm(i)&&Qb(t,i.length):s=="string"&&t in i)?k_(i[t],e):!1}function oV(e){return QR(function(t,i){var s=-1,d=i.length,g=d>1?i[d-1]:void 0,_=d>2?i[2]:void 0;for(g=e.length>3&&typeof g=="function"?(d--,g):void 0,_&&nV(i[0],i[1],_)&&(g=d<3?void 0:g,d=1),t=Object(t);++s<d;){var o=i[s];o&&e(t,o,s,g)}return t})}var rV=Object.prototype;function GS(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||rV;return e===i}function iV(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}var aV="[object Arguments]";function LA(e){return Tu(e)&&Gf(e)==aV}var eO=Object.prototype,sV=eO.hasOwnProperty,lV=eO.propertyIsEnumerable,i_=LA(function(){return arguments}())?LA:function(e){return Tu(e)&&sV.call(e,"callee")&&!lV.call(e,"callee")};function cV(){return!1}var tO=typeof wl=="object"&&wl&&!wl.nodeType&&wl,DA=tO&&typeof Sl=="object"&&Sl&&!Sl.nodeType&&Sl,uV=DA&&DA.exports===tO,zA=uV?Jc.Buffer:void 0,dV=zA?zA.isBuffer:void 0,a_=dV||cV,hV="[object Arguments]",fV="[object Array]",pV="[object Boolean]",mV="[object Date]",gV="[object Error]",vV="[object Function]",_V="[object Map]",yV="[object Number]",bV="[object Object]",xV="[object RegExp]",wV="[object Set]",SV="[object String]",TV="[object WeakMap]",CV="[object ArrayBuffer]",EV="[object DataView]",MV="[object Float32Array]",IV="[object Float64Array]",AV="[object Int8Array]",kV="[object Int16Array]",PV="[object Int32Array]",RV="[object Uint8Array]",OV="[object Uint8ClampedArray]",LV="[object Uint16Array]",DV="[object Uint32Array]",Ki={};Ki[MV]=Ki[IV]=Ki[AV]=Ki[kV]=Ki[PV]=Ki[RV]=Ki[OV]=Ki[LV]=Ki[DV]=!0;Ki[hV]=Ki[fV]=Ki[CV]=Ki[pV]=Ki[EV]=Ki[mV]=Ki[gV]=Ki[vV]=Ki[_V]=Ki[yV]=Ki[bV]=Ki[xV]=Ki[wV]=Ki[SV]=Ki[TV]=!1;function zV(e){return Tu(e)&&HS(e.length)&&!!Ki[Gf(e)]}function WS(e){return function(t){return e(t)}}var nO=typeof wl=="object"&&wl&&!wl.nodeType&&wl,Gv=nO&&typeof Sl=="object"&&Sl&&!Sl.nodeType&&Sl,FV=Gv&&Gv.exports===nO,_w=FV&&WR.process,_m=function(){try{var e=Gv&&Gv.require&&Gv.require("util").types;return e||_w&&_w.binding&&_w.binding("util")}catch{}}(),FA=_m&&_m.isTypedArray,qS=FA?WS(FA):zV,BV=Object.prototype,NV=BV.hasOwnProperty;function oO(e,t){var i=zs(e),s=!i&&i_(e),d=!i&&!s&&a_(e),g=!i&&!s&&!d&&qS(e),_=i||s||d||g,o=_?iV(e.length,String):[],S=o.length;for(var E in e)(t||NV.call(e,E))&&!(_&&(E=="length"||d&&(E=="offset"||E=="parent")||g&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||Qb(E,S)))&&o.push(E);return o}function rO(e,t){return function(i){return e(t(i))}}var $V=rO(Object.keys,Object),VV=Object.prototype,UV=VV.hasOwnProperty;function jV(e){if(!GS(e))return $V(e);var t=[];for(var i in Object(e))UV.call(e,i)&&i!="constructor"&&t.push(i);return t}function P_(e){return Bm(e)?oO(e):jV(e)}function HV(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var GV=Object.prototype,WV=GV.hasOwnProperty;function qV(e){if(!Fs(e))return HV(e);var t=GS(e),i=[];for(var s in e)s=="constructor"&&(t||!WV.call(e,s))||i.push(s);return i}function R_(e){return Bm(e)?oO(e,!0):qV(e)}var KV=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ZV=/^\w*$/;function KS(e,t){if(zs(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||Jb(e)?!0:ZV.test(e)||!KV.test(e)||t!=null&&e in Object(t)}var s_=qf(Object,"create");function YV(){this.__data__=s_?s_(null):{},this.size=0}function XV(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var JV="__lodash_hash_undefined__",QV=Object.prototype,e8=QV.hasOwnProperty;function t8(e){var t=this.__data__;if(s_){var i=t[e];return i===JV?void 0:i}return e8.call(t,e)?t[e]:void 0}var n8=Object.prototype,o8=n8.hasOwnProperty;function r8(e){var t=this.__data__;return s_?t[e]!==void 0:o8.call(t,e)}var i8="__lodash_hash_undefined__";function a8(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=s_&&t===void 0?i8:t,this}function Ff(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}Ff.prototype.clear=YV;Ff.prototype.delete=XV;Ff.prototype.get=t8;Ff.prototype.has=r8;Ff.prototype.set=a8;function s8(){this.__data__=[],this.size=0}function e1(e,t){for(var i=e.length;i--;)if(k_(e[i][0],t))return i;return-1}var l8=Array.prototype,c8=l8.splice;function u8(e){var t=this.__data__,i=e1(t,e);if(i<0)return!1;var s=t.length-1;return i==s?t.pop():c8.call(t,i,1),--this.size,!0}function d8(e){var t=this.__data__,i=e1(t,e);return i<0?void 0:t[i][1]}function h8(e){return e1(this.__data__,e)>-1}function f8(e,t){var i=this.__data__,s=e1(i,e);return s<0?(++this.size,i.push([e,t])):i[s][1]=t,this}function sd(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}sd.prototype.clear=s8;sd.prototype.delete=u8;sd.prototype.get=d8;sd.prototype.has=h8;sd.prototype.set=f8;var l_=qf(Jc,"Map");function p8(){this.size=0,this.__data__={hash:new Ff,map:new(l_||sd),string:new Ff}}function m8(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function t1(e,t){var i=e.__data__;return m8(t)?i[typeof t=="string"?"string":"hash"]:i.map}function g8(e){var t=t1(this,e).delete(e);return this.size-=t?1:0,t}function v8(e){return t1(this,e).get(e)}function _8(e){return t1(this,e).has(e)}function y8(e,t){var i=t1(this,e),s=i.size;return i.set(e,t),this.size+=i.size==s?0:1,this}function ld(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}ld.prototype.clear=p8;ld.prototype.delete=g8;ld.prototype.get=v8;ld.prototype.has=_8;ld.prototype.set=y8;var b8="Expected a function";function n1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(b8);var i=function(){var s=arguments,d=t?t.apply(this,s):s[0],g=i.cache;if(g.has(d))return g.get(d);var _=e.apply(this,s);return i.cache=g.set(d,_)||g,_};return i.cache=new(n1.Cache||ld),i}n1.Cache=ld;var x8=500;function w8(e){var t=n1(e,function(s){return i.size===x8&&i.clear(),s}),i=t.cache;return t}var S8=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,T8=/\\(\\)?/g,C8=w8(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(S8,function(i,s,d,g){t.push(d?g.replace(T8,"$1"):s||i)}),t});function E8(e){return e==null?"":KR(e)}function Nm(e,t){return zs(e)?e:KS(e,t)?[e]:C8(E8(e))}var M8=1/0;function $m(e){if(typeof e=="string"||Jb(e))return e;var t=e+"";return t=="0"&&1/e==-M8?"-0":t}function o1(e,t){t=Nm(t,e);for(var i=0,s=t.length;e!=null&&i<s;)e=e[$m(t[i++])];return i&&i==s?e:void 0}function Ji(e,t,i){var s=e==null?void 0:o1(e,t);return s===void 0?i:s}function ZS(e,t){for(var i=-1,s=t.length,d=e.length;++i<s;)e[d+i]=t[i];return e}var BA=tc?tc.isConcatSpreadable:void 0;function I8(e){return zs(e)||i_(e)||!!(BA&&e&&e[BA])}function O_(e,t,i,s,d){var g=-1,_=e.length;for(i||(i=I8),d||(d=[]);++g<_;){var o=e[g];t>0&&i(o)?t>1?O_(o,t-1,i,s,d):ZS(d,o):s||(d[d.length]=o)}return d}function iO(e){var t=e==null?0:e.length;return t?O_(e,1):[]}function aO(e){return YR(JR(e,void 0,iO),e+"")}var YS=rO(Object.getPrototypeOf,Object),A8="[object Object]",k8=Function.prototype,P8=Object.prototype,sO=k8.toString,R8=P8.hasOwnProperty,O8=sO.call(Object);function lO(e){if(!Tu(e)||Gf(e)!=A8)return!1;var t=YS(e);if(t===null)return!0;var i=R8.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&sO.call(i)==O8}function L8(e,t,i){var s=-1,d=e.length;t<0&&(t=-t>d?0:d+t),i=i>d?d:i,i<0&&(i+=d),d=t>i?0:i-t>>>0,t>>>=0;for(var g=Array(d);++s<d;)g[s]=e[s+t];return g}function us(){if(!arguments.length)return[];var e=arguments[0];return zs(e)?e:[e]}function D8(){this.__data__=new sd,this.size=0}function z8(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function F8(e){return this.__data__.get(e)}function B8(e){return this.__data__.has(e)}var N8=200;function $8(e,t){var i=this.__data__;if(i instanceof sd){var s=i.__data__;if(!l_||s.length<N8-1)return s.push([e,t]),this.size=++i.size,this;i=this.__data__=new ld(s)}return i.set(e,t),this.size=i.size,this}function Gc(e){var t=this.__data__=new sd(e);this.size=t.size}Gc.prototype.clear=D8;Gc.prototype.delete=z8;Gc.prototype.get=F8;Gc.prototype.has=B8;Gc.prototype.set=$8;function V8(e,t){return e&&Fm(t,P_(t),e)}function U8(e,t){return e&&Fm(t,R_(t),e)}var cO=typeof wl=="object"&&wl&&!wl.nodeType&&wl,NA=cO&&typeof Sl=="object"&&Sl&&!Sl.nodeType&&Sl,j8=NA&&NA.exports===cO,$A=j8?Jc.Buffer:void 0,VA=$A?$A.allocUnsafe:void 0;function uO(e,t){if(t)return e.slice();var i=e.length,s=VA?VA(i):new e.constructor(i);return e.copy(s),s}function H8(e,t){for(var i=-1,s=e==null?0:e.length,d=0,g=[];++i<s;){var _=e[i];t(_,i,e)&&(g[d++]=_)}return g}function dO(){return[]}var G8=Object.prototype,W8=G8.propertyIsEnumerable,UA=Object.getOwnPropertySymbols,XS=UA?function(e){return e==null?[]:(e=Object(e),H8(UA(e),function(t){return W8.call(e,t)}))}:dO;function q8(e,t){return Fm(e,XS(e),t)}var K8=Object.getOwnPropertySymbols,hO=K8?function(e){for(var t=[];e;)ZS(t,XS(e)),e=YS(e);return t}:dO;function Z8(e,t){return Fm(e,hO(e),t)}function fO(e,t,i){var s=t(e);return zs(e)?s:ZS(s,i(e))}function s2(e){return fO(e,P_,XS)}function pO(e){return fO(e,R_,hO)}var l2=qf(Jc,"DataView"),c2=qf(Jc,"Promise"),cm=qf(Jc,"Set"),jA="[object Map]",Y8="[object Object]",HA="[object Promise]",GA="[object Set]",WA="[object WeakMap]",qA="[object DataView]",X8=Wf(l2),J8=Wf(l_),Q8=Wf(c2),eU=Wf(cm),tU=Wf(a2),$c=Gf;(l2&&$c(new l2(new ArrayBuffer(1)))!=qA||l_&&$c(new l_)!=jA||c2&&$c(c2.resolve())!=HA||cm&&$c(new cm)!=GA||a2&&$c(new a2)!=WA)&&($c=function(e){var t=Gf(e),i=t==Y8?e.constructor:void 0,s=i?Wf(i):"";if(s)switch(s){case X8:return qA;case J8:return jA;case Q8:return HA;case eU:return GA;case tU:return WA}return t});var nU=Object.prototype,oU=nU.hasOwnProperty;function rU(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&oU.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var vb=Jc.Uint8Array;function JS(e){var t=new e.constructor(e.byteLength);return new vb(t).set(new vb(e)),t}function iU(e,t){var i=t?JS(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var aU=/\w*$/;function sU(e){var t=new e.constructor(e.source,aU.exec(e));return t.lastIndex=e.lastIndex,t}var KA=tc?tc.prototype:void 0,ZA=KA?KA.valueOf:void 0;function lU(e){return ZA?Object(ZA.call(e)):{}}function mO(e,t){var i=t?JS(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var cU="[object Boolean]",uU="[object Date]",dU="[object Map]",hU="[object Number]",fU="[object RegExp]",pU="[object Set]",mU="[object String]",gU="[object Symbol]",vU="[object ArrayBuffer]",_U="[object DataView]",yU="[object Float32Array]",bU="[object Float64Array]",xU="[object Int8Array]",wU="[object Int16Array]",SU="[object Int32Array]",TU="[object Uint8Array]",CU="[object Uint8ClampedArray]",EU="[object Uint16Array]",MU="[object Uint32Array]";function IU(e,t,i){var s=e.constructor;switch(t){case vU:return JS(e);case cU:case uU:return new s(+e);case _U:return iU(e,i);case yU:case bU:case xU:case wU:case SU:case TU:case CU:case EU:case MU:return mO(e,i);case dU:return new s;case hU:case mU:return new s(e);case fU:return sU(e);case pU:return new s;case gU:return lU(e)}}function gO(e){return typeof e.constructor=="function"&&!GS(e)?F$(YS(e)):{}}var AU="[object Map]";function kU(e){return Tu(e)&&$c(e)==AU}var YA=_m&&_m.isMap,PU=YA?WS(YA):kU,RU="[object Set]";function OU(e){return Tu(e)&&$c(e)==RU}var XA=_m&&_m.isSet,LU=XA?WS(XA):OU,DU=1,zU=2,FU=4,vO="[object Arguments]",BU="[object Array]",NU="[object Boolean]",$U="[object Date]",VU="[object Error]",_O="[object Function]",UU="[object GeneratorFunction]",jU="[object Map]",HU="[object Number]",yO="[object Object]",GU="[object RegExp]",WU="[object Set]",qU="[object String]",KU="[object Symbol]",ZU="[object WeakMap]",YU="[object ArrayBuffer]",XU="[object DataView]",JU="[object Float32Array]",QU="[object Float64Array]",ej="[object Int8Array]",tj="[object Int16Array]",nj="[object Int32Array]",oj="[object Uint8Array]",rj="[object Uint8ClampedArray]",ij="[object Uint16Array]",aj="[object Uint32Array]",$i={};$i[vO]=$i[BU]=$i[YU]=$i[XU]=$i[NU]=$i[$U]=$i[JU]=$i[QU]=$i[ej]=$i[tj]=$i[nj]=$i[jU]=$i[HU]=$i[yO]=$i[GU]=$i[WU]=$i[qU]=$i[KU]=$i[oj]=$i[rj]=$i[ij]=$i[aj]=!0;$i[VU]=$i[_O]=$i[ZU]=!1;function um(e,t,i,s,d,g){var _,o=t&DU,S=t&zU,E=t&FU;if(i&&(_=d?i(e,s,d,g):i(e)),_!==void 0)return _;if(!Fs(e))return e;var I=zs(e);if(I){if(_=rU(e),!o)return ZR(e,_)}else{var P=$c(e),F=P==_O||P==UU;if(a_(e))return uO(e,o);if(P==yO||P==vO||F&&!d){if(_=S||F?{}:gO(e),!o)return S?Z8(e,U8(_,e)):q8(e,V8(_,e))}else{if(!$i[P])return d?e:{};_=IU(e,P,o)}}g||(g=new Gc);var B=g.get(e);if(B)return B;g.set(e,_),LU(e)?e.forEach(function(H){_.add(um(H,t,i,H,e,g))}):PU(e)&&e.forEach(function(H,U){_.set(U,um(H,t,i,U,e,g))});var $=E?S?pO:s2:S?R_:P_,z=I?void 0:$(e);return W$(z||e,function(H,U){z&&(U=H,H=e[U]),jS(_,U,um(H,t,i,U,e,g))}),_}var sj=4;function JA(e){return um(e,sj)}var lj=1,cj=4;function _b(e){return um(e,lj|cj)}var uj="__lodash_hash_undefined__";function dj(e){return this.__data__.set(e,uj),this}function hj(e){return this.__data__.has(e)}function c_(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new ld;++t<i;)this.add(e[t])}c_.prototype.add=c_.prototype.push=dj;c_.prototype.has=hj;function fj(e,t){for(var i=-1,s=e==null?0:e.length;++i<s;)if(t(e[i],i,e))return!0;return!1}function bO(e,t){return e.has(t)}var pj=1,mj=2;function xO(e,t,i,s,d,g){var _=i&pj,o=e.length,S=t.length;if(o!=S&&!(_&&S>o))return!1;var E=g.get(e),I=g.get(t);if(E&&I)return E==t&&I==e;var P=-1,F=!0,B=i&mj?new c_:void 0;for(g.set(e,t),g.set(t,e);++P<o;){var $=e[P],z=t[P];if(s)var H=_?s(z,$,P,t,e,g):s($,z,P,e,t,g);if(H!==void 0){if(H)continue;F=!1;break}if(B){if(!fj(t,function(U,ie){if(!bO(B,ie)&&($===U||d($,U,i,s,g)))return B.push(ie)})){F=!1;break}}else if(!($===z||d($,z,i,s,g))){F=!1;break}}return g.delete(e),g.delete(t),F}function gj(e){var t=-1,i=Array(e.size);return e.forEach(function(s,d){i[++t]=[d,s]}),i}function QS(e){var t=-1,i=Array(e.size);return e.forEach(function(s){i[++t]=s}),i}var vj=1,_j=2,yj="[object Boolean]",bj="[object Date]",xj="[object Error]",wj="[object Map]",Sj="[object Number]",Tj="[object RegExp]",Cj="[object Set]",Ej="[object String]",Mj="[object Symbol]",Ij="[object ArrayBuffer]",Aj="[object DataView]",QA=tc?tc.prototype:void 0,yw=QA?QA.valueOf:void 0;function kj(e,t,i,s,d,g,_){switch(i){case Aj:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ij:return!(e.byteLength!=t.byteLength||!g(new vb(e),new vb(t)));case yj:case bj:case Sj:return k_(+e,+t);case xj:return e.name==t.name&&e.message==t.message;case Tj:case Ej:return e==t+"";case wj:var o=gj;case Cj:var S=s&vj;if(o||(o=QS),e.size!=t.size&&!S)return!1;var E=_.get(e);if(E)return E==t;s|=_j,_.set(e,t);var I=xO(o(e),o(t),s,d,g,_);return _.delete(e),I;case Mj:if(yw)return yw.call(e)==yw.call(t)}return!1}var Pj=1,Rj=Object.prototype,Oj=Rj.hasOwnProperty;function Lj(e,t,i,s,d,g){var _=i&Pj,o=s2(e),S=o.length,E=s2(t),I=E.length;if(S!=I&&!_)return!1;for(var P=S;P--;){var F=o[P];if(!(_?F in t:Oj.call(t,F)))return!1}var B=g.get(e),$=g.get(t);if(B&&$)return B==t&&$==e;var z=!0;g.set(e,t),g.set(t,e);for(var H=_;++P<S;){F=o[P];var U=e[F],ie=t[F];if(s)var Z=_?s(ie,U,F,t,e,g):s(U,ie,F,e,t,g);if(!(Z===void 0?U===ie||d(U,ie,i,s,g):Z)){z=!1;break}H||(H=F=="constructor")}if(z&&!H){var G=e.constructor,Q=t.constructor;G!=Q&&"constructor"in e&&"constructor"in t&&!(typeof G=="function"&&G instanceof G&&typeof Q=="function"&&Q instanceof Q)&&(z=!1)}return g.delete(e),g.delete(t),z}var Dj=1,ek="[object Arguments]",tk="[object Array]",x0="[object Object]",zj=Object.prototype,nk=zj.hasOwnProperty;function Fj(e,t,i,s,d,g){var _=zs(e),o=zs(t),S=_?tk:$c(e),E=o?tk:$c(t);S=S==ek?x0:S,E=E==ek?x0:E;var I=S==x0,P=E==x0,F=S==E;if(F&&a_(e)){if(!a_(t))return!1;_=!0,I=!1}if(F&&!I)return g||(g=new Gc),_||qS(e)?xO(e,t,i,s,d,g):kj(e,t,S,i,s,d,g);if(!(i&Dj)){var B=I&&nk.call(e,"__wrapped__"),$=P&&nk.call(t,"__wrapped__");if(B||$){var z=B?e.value():e,H=$?t.value():t;return g||(g=new Gc),d(z,H,i,s,g)}}return F?(g||(g=new Gc),Lj(e,t,i,s,d,g)):!1}function r1(e,t,i,s,d){return e===t?!0:e==null||t==null||!Tu(e)&&!Tu(t)?e!==e&&t!==t:Fj(e,t,i,s,r1,d)}var Bj=1,Nj=2;function $j(e,t,i,s){var d=i.length,g=d;if(e==null)return!g;for(e=Object(e);d--;){var _=i[d];if(_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++d<g;){_=i[d];var o=_[0],S=e[o],E=_[1];if(_[2]){if(S===void 0&&!(o in e))return!1}else{var I=new Gc,P;if(!(P===void 0?r1(E,S,Bj|Nj,s,I):P))return!1}}return!0}function wO(e){return e===e&&!Fs(e)}function Vj(e){for(var t=P_(e),i=t.length;i--;){var s=t[i],d=e[s];t[i]=[s,d,wO(d)]}return t}function SO(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==void 0||e in Object(i))}}function Uj(e){var t=Vj(e);return t.length==1&&t[0][2]?SO(t[0][0],t[0][1]):function(i){return i===e||$j(i,e,t)}}function jj(e,t){return e!=null&&t in Object(e)}function Hj(e,t,i){t=Nm(t,e);for(var s=-1,d=t.length,g=!1;++s<d;){var _=$m(t[s]);if(!(g=e!=null&&i(e,_)))break;e=e[_]}return g||++s!=d?g:(d=e==null?0:e.length,!!d&&HS(d)&&Qb(_,d)&&(zs(e)||i_(e)))}function TO(e,t){return e!=null&&Hj(e,t,jj)}var Gj=1,Wj=2;function qj(e,t){return KS(e)&&wO(t)?SO($m(e),t):function(i){var s=Ji(i,e);return s===void 0&&s===t?TO(i,e):r1(t,s,Gj|Wj)}}function Kj(e){return function(t){return t==null?void 0:t[e]}}function Zj(e){return function(t){return o1(t,e)}}function Yj(e){return KS(e)?Kj($m(e)):Zj(e)}function CO(e){return typeof e=="function"?e:e==null?$S:typeof e=="object"?zs(e)?qj(e[0],e[1]):Uj(e):Yj(e)}function Xj(e){return function(t,i,s){for(var d=-1,g=Object(t),_=s(t),o=_.length;o--;){var S=_[++d];if(i(g[S],S,g)===!1)break}return t}}var EO=Xj();function Jj(e,t){return e&&EO(e,t,P_)}function Qj(e,t){return function(i,s){if(i==null)return i;if(!Bm(i))return e(i,s);for(var d=i.length,g=-1,_=Object(i);++g<d&&s(_[g],g,_)!==!1;);return i}}var eH=Qj(Jj),bw=function(){return Jc.Date.now()},tH="Expected a function",nH=Math.max,oH=Math.min;function ol(e,t,i){var s,d,g,_,o,S,E=0,I=!1,P=!1,F=!0;if(typeof e!="function")throw new TypeError(tH);t=kA(t)||0,Fs(i)&&(I=!!i.leading,P="maxWait"in i,g=P?nH(kA(i.maxWait)||0,t):g,F="trailing"in i?!!i.trailing:F);function B(oe){var le=s,me=d;return s=d=void 0,E=oe,_=e.apply(me,le),_}function $(oe){return E=oe,o=setTimeout(U,t),I?B(oe):_}function z(oe){var le=oe-S,me=oe-E,fe=t-le;return P?oH(fe,g-me):fe}function H(oe){var le=oe-S,me=oe-E;return S===void 0||le>=t||le<0||P&&me>=g}function U(){var oe=bw();if(H(oe))return ie(oe);o=setTimeout(U,z(oe))}function ie(oe){return o=void 0,F&&s?B(oe):(s=d=void 0,_)}function Z(){o!==void 0&&clearTimeout(o),E=0,s=S=d=o=void 0}function G(){return o===void 0?_:ie(bw())}function Q(){var oe=bw(),le=H(oe);if(s=arguments,d=this,S=oe,le){if(o===void 0)return $(S);if(P)return clearTimeout(o),o=setTimeout(U,t),B(S)}return o===void 0&&(o=setTimeout(U,t)),_}return Q.cancel=Z,Q.flush=G,Q}function u2(e,t,i){(i!==void 0&&!k_(e[t],i)||i===void 0&&!(t in e))&&US(e,t,i)}function MO(e){return Tu(e)&&Bm(e)}function d2(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function rH(e){return Fm(e,R_(e))}function iH(e,t,i,s,d,g,_){var o=d2(e,i),S=d2(t,i),E=_.get(S);if(E){u2(e,i,E);return}var I=g?g(o,S,i+"",e,t,_):void 0,P=I===void 0;if(P){var F=zs(S),B=!F&&a_(S),$=!F&&!B&&qS(S);I=S,F||B||$?zs(o)?I=o:MO(o)?I=ZR(o):B?(P=!1,I=uO(S,!0)):$?(P=!1,I=mO(S,!0)):I=[]:lO(S)||i_(S)?(I=o,i_(o)?I=rH(o):(!Fs(o)||VS(o))&&(I=gO(S))):P=!1}P&&(_.set(S,I),d(I,S,s,g,_),_.delete(S)),u2(e,i,I)}function IO(e,t,i,s,d){e!==t&&EO(t,function(g,_){if(d||(d=new Gc),Fs(g))iH(e,t,_,i,IO,s,d);else{var o=s?s(d2(e,_),g,_+"",e,t,d):void 0;o===void 0&&(o=g),u2(e,_,o)}},R_)}function aH(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function AO(e,t,i){var s=e==null?0:e.length;if(!s)return-1;var d=s-1;return XR(e,CO(t),d,!0)}function sH(e,t){var i=-1,s=Bm(e)?Array(e.length):[];return eH(e,function(d,g,_){s[++i]=t(d,g,_)}),s}function lH(e,t){var i=zs(e)?NS:sH;return i(e,CO(t))}function cH(e,t){return O_(lH(e,t),1)}var uH=1/0;function dH(e){var t=e==null?0:e.length;return t?O_(e,uH):[]}function u_(e){for(var t=-1,i=e==null?0:e.length,s={};++t<i;){var d=e[t];s[d[0]]=d[1]}return s}function hH(e,t){return t.length<2?e:o1(e,L8(t,0,-1))}function Oa(e,t){return r1(e,t)}function ga(e){return e==null}function kO(e){return e===void 0}var PO=oV(function(e,t,i){IO(e,t,i)});function fH(e,t){return t=Nm(t,e),e=hH(e,t),e==null||delete e[$m(aH(t))]}function pH(e){return lO(e)?void 0:e}var mH=1,gH=2,vH=4,_H=aO(function(e,t){var i={};if(e==null)return i;var s=!1;t=NS(t,function(g){return g=Nm(g,e),s||(s=g.length>1),g}),Fm(e,pO(e),i),s&&(i=um(i,mH|gH|vH,pH));for(var d=t.length;d--;)fH(i,t[d]);return i});function RO(e,t,i,s){if(!Fs(e))return e;t=Nm(t,e);for(var d=-1,g=t.length,_=g-1,o=e;o!=null&&++d<g;){var S=$m(t[d]),E=i;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(d!=_){var I=o[S];E=void 0,E===void 0&&(E=Fs(I)?I:Qb(t[d+1])?[]:{})}jS(o,S,E),o=o[S]}return e}function yH(e,t,i){for(var s=-1,d=t.length,g={};++s<d;){var _=t[s],o=o1(e,_);i(o,_)&&RO(g,Nm(_,e),o)}return g}function bH(e,t){return yH(e,t,function(i,s){return TO(e,s)})}var Uc=aO(function(e,t){return e==null?{}:bH(e,t)});function xH(e,t,i){return e==null?e:RO(e,t,i)}var wH="Expected a function";function Pf(e,t,i){var s=!0,d=!0;if(typeof e!="function")throw new TypeError(wH);return Fs(i)&&(s="leading"in i?!!i.leading:s,d="trailing"in i?!!i.trailing:d),ol(e,t,{leading:s,maxWait:t,trailing:d})}var SH=1/0,TH=cm&&1/QS(new cm([,-0]))[1]==SH?function(e){return new cm(e)}:N$,CH=200;function EH(e,t,i){var s=-1,d=Y$,g=e.length,_=!0,o=[],S=o;if(g>=CH){var E=TH(e);if(E)return QS(E);_=!1,d=bO,S=new c_}else S=o;e:for(;++s<g;){var I=e[s],P=I;if(I=I!==0?I:0,_&&P===P){for(var F=S.length;F--;)if(S[F]===P)continue e;o.push(I)}else d(S,P,i)||(S!==o&&S.push(P),o.push(I))}return o}var xw=QR(function(e){return EH(O_(e,1,MO,!0))});const Hr=e=>e===void 0,ai=e=>typeof e=="boolean",ao=e=>typeof e=="number",yl=e=>!e&&e!==0||fn(e)&&e.length===0||Vo(e)&&!Object.keys(e).length,Tl=e=>typeof Element>"u"?!1:e instanceof Element,Bf=e=>ga(e),MH=e=>Zn(e)?!Number.isNaN(Number(e)):!1,i1=e=>e===window;var IH=Object.defineProperty,AH=Object.defineProperties,kH=Object.getOwnPropertyDescriptors,ok=Object.getOwnPropertySymbols,PH=Object.prototype.hasOwnProperty,RH=Object.prototype.propertyIsEnumerable,rk=(e,t,i)=>t in e?IH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,OH=(e,t)=>{for(var i in t||(t={}))PH.call(t,i)&&rk(e,i,t[i]);if(ok)for(var i of ok(t))RH.call(t,i)&&rk(e,i,t[i]);return e},LH=(e,t)=>AH(e,kH(t));function h2(e,t){var i;const s=gi();return Ha(()=>{s.value=e()},LH(OH({},t),{flush:(i=void 0)!=null?i:"sync"})),Dm(s)}var ik;const gr=typeof window<"u",DH=e=>typeof e<"u",f2=e=>typeof e=="function",zH=e=>typeof e=="string",ym=()=>{},p2=gr&&((ik=window==null?void 0:window.navigator)==null?void 0:ik.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function vh(e){return typeof e=="function"?e():y(e)}function OO(e,t){function i(...s){return new Promise((d,g)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(d).catch(g)})}return i}function FH(e,t={}){let i,s,d=ym;const g=o=>{clearTimeout(o),d(),d=ym};return o=>{const S=vh(e),E=vh(t.maxWait);return i&&g(i),S<=0||E!==void 0&&E<=0?(s&&(g(s),s=null),Promise.resolve(o())):new Promise((I,P)=>{d=t.rejectOnCancel?P:I,E&&!s&&(s=setTimeout(()=>{i&&g(i),s=null,I(o())},E)),i=setTimeout(()=>{s&&g(s),s=null,I(o())},S)})}}function BH(e,t=!0,i=!0,s=!1){let d=0,g,_=!0,o=ym,S;const E=()=>{g&&(clearTimeout(g),g=void 0,o(),o=ym)};return P=>{const F=vh(e),B=Date.now()-d,$=()=>S=P();return E(),F<=0?(d=Date.now(),$()):(B>F&&(i||!_)?(d=Date.now(),$()):t&&(S=new Promise((z,H)=>{o=s?H:z,g=setTimeout(()=>{d=Date.now(),_=!0,z($()),E()},Math.max(0,F-B))})),!i&&!g&&(g=setTimeout(()=>_=!0,F)),_=!1,S)}}function NH(e){return e}function $H(e,t){let i,s,d;const g=Se(!0),_=()=>{g.value=!0,d()};tn(e,_,{flush:"sync"});const o=f2(t)?t:t.get,S=f2(t)?void 0:t.set,E=l5((I,P)=>(s=I,d=P,{get(){return g.value&&(i=o(),g.value=!1),s(),i},set(F){S==null||S(F)}}));return Object.isExtensible(E)&&(E.trigger=_),E}function L_(e){return b3()?(x3(e),!0):!1}function VH(e,t=200,i={}){return OO(FH(t,i),e)}function UH(e,t=200,i={}){const s=Se(e.value),d=VH(()=>{s.value=e.value},t,i);return tn(e,()=>d()),s}function LO(e,t=200,i=!1,s=!0,d=!1){return OO(BH(t,i,s,d),e)}function eT(e,t=!0){jo()?No(e):t?e():oo(e)}function Nf(e,t,i={}){const{immediate:s=!0}=i,d=Se(!1);let g=null;function _(){g&&(clearTimeout(g),g=null)}function o(){d.value=!1,_()}function S(...E){_(),d.value=!0,g=setTimeout(()=>{d.value=!1,g=null,e(...E)},vh(t))}return s&&(d.value=!0,gr&&S()),L_(o),{isPending:Dm(d),start:S,stop:o}}function Os(e){var t;const i=vh(e);return(t=i==null?void 0:i.$el)!=null?t:i}const Ih=gr?window:void 0,jH=gr?window.document:void 0;function qr(...e){let t,i,s,d;if(zH(e[0])||Array.isArray(e[0])?([i,s,d]=e,t=Ih):[t,i,s,d]=e,!t)return ym;Array.isArray(i)||(i=[i]),Array.isArray(s)||(s=[s]);const g=[],_=()=>{g.forEach(I=>I()),g.length=0},o=(I,P,F,B)=>(I.addEventListener(P,F,B),()=>I.removeEventListener(P,F,B)),S=tn(()=>[Os(t),vh(d)],([I,P])=>{_(),I&&g.push(...i.flatMap(F=>s.map(B=>o(I,F,B,P))))},{immediate:!0,flush:"post"}),E=()=>{S(),_()};return L_(E),E}let ak=!1;function tT(e,t,i={}){const{window:s=Ih,ignore:d=[],capture:g=!0,detectIframe:_=!1}=i;if(!s)return;p2&&!ak&&(ak=!0,Array.from(s.document.body.children).forEach(F=>F.addEventListener("click",ym)));let o=!0;const S=F=>d.some(B=>{if(typeof B=="string")return Array.from(s.document.querySelectorAll(B)).some($=>$===F.target||F.composedPath().includes($));{const $=Os(B);return $&&(F.target===$||F.composedPath().includes($))}}),I=[qr(s,"click",F=>{const B=Os(e);if(!(!B||B===F.target||F.composedPath().includes(B))){if(F.detail===0&&(o=!S(F)),!o){o=!0;return}t(F)}},{passive:!0,capture:g}),qr(s,"pointerdown",F=>{const B=Os(e);B&&(o=!F.composedPath().includes(B)&&!S(F))},{passive:!0}),_&&qr(s,"blur",F=>{var B;const $=Os(e);((B=s.document.activeElement)==null?void 0:B.tagName)==="IFRAME"&&!($!=null&&$.contains(s.document.activeElement))&&t(F)})].filter(Boolean);return()=>I.forEach(F=>F())}function HH(e={}){var t;const{window:i=Ih}=e,s=(t=e.document)!=null?t:i==null?void 0:i.document,d=$H(()=>null,()=>s==null?void 0:s.activeElement);return i&&(qr(i,"blur",g=>{g.relatedTarget===null&&d.trigger()},!0),qr(i,"focus",d.trigger,!0)),d}function DO(e,t=!1){const i=Se(),s=()=>i.value=!!e();return s(),eT(s,t),i}function GH(e){return JSON.parse(JSON.stringify(e))}const sk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},lk="__vueuse_ssr_handlers__";sk[lk]=sk[lk]||{};function WH(e,t,{window:i=Ih,initialValue:s=""}={}){const d=Se(s),g=te(()=>{var _;return Os(t)||((_=i==null?void 0:i.document)==null?void 0:_.documentElement)});return tn([g,()=>vh(e)],([_,o])=>{var S;if(_&&i){const E=(S=i.getComputedStyle(_).getPropertyValue(o))==null?void 0:S.trim();d.value=E||s}},{immediate:!0}),tn(d,_=>{var o;(o=g.value)!=null&&o.style&&g.value.style.setProperty(vh(e),_)}),d}function qH({document:e=jH}={}){if(!e)return Se("visible");const t=Se(e.visibilityState);return qr(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var ck=Object.getOwnPropertySymbols,KH=Object.prototype.hasOwnProperty,ZH=Object.prototype.propertyIsEnumerable,YH=(e,t)=>{var i={};for(var s in e)KH.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&ck)for(var s of ck(e))t.indexOf(s)<0&&ZH.call(e,s)&&(i[s]=e[s]);return i};function Mi(e,t,i={}){const s=i,{window:d=Ih}=s,g=YH(s,["window"]);let _;const o=DO(()=>d&&"ResizeObserver"in d),S=()=>{_&&(_.disconnect(),_=void 0)},E=tn(()=>Os(e),P=>{S(),o.value&&d&&P&&(_=new ResizeObserver(t),_.observe(P,g))},{immediate:!0,flush:"post"}),I=()=>{S(),E()};return L_(I),{isSupported:o,stop:I}}function uk(e,t={}){const{reset:i=!0,windowResize:s=!0,windowScroll:d=!0,immediate:g=!0}=t,_=Se(0),o=Se(0),S=Se(0),E=Se(0),I=Se(0),P=Se(0),F=Se(0),B=Se(0);function $(){const z=Os(e);if(!z){i&&(_.value=0,o.value=0,S.value=0,E.value=0,I.value=0,P.value=0,F.value=0,B.value=0);return}const H=z.getBoundingClientRect();_.value=H.height,o.value=H.bottom,S.value=H.left,E.value=H.right,I.value=H.top,P.value=H.width,F.value=H.x,B.value=H.y}return Mi(e,$),tn(()=>Os(e),z=>!z&&$()),d&&qr("scroll",$,{capture:!0,passive:!0}),s&&qr("resize",$,{passive:!0}),eT(()=>{g&&$()}),{height:_,bottom:o,left:S,right:E,top:I,width:P,x:F,y:B,update:$}}var dk=Object.getOwnPropertySymbols,XH=Object.prototype.hasOwnProperty,JH=Object.prototype.propertyIsEnumerable,QH=(e,t)=>{var i={};for(var s in e)XH.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&dk)for(var s of dk(e))t.indexOf(s)<0&&JH.call(e,s)&&(i[s]=e[s]);return i};function zO(e,t,i={}){const s=i,{window:d=Ih}=s,g=QH(s,["window"]);let _;const o=DO(()=>d&&"MutationObserver"in d),S=()=>{_&&(_.disconnect(),_=void 0)},E=tn(()=>Os(e),P=>{S(),o.value&&d&&P&&(_=new MutationObserver(t),_.observe(P,g))},{immediate:!0}),I=()=>{S(),E()};return L_(I),{isSupported:o,stop:I}}var hk;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(hk||(hk={}));var eG=Object.defineProperty,fk=Object.getOwnPropertySymbols,tG=Object.prototype.hasOwnProperty,nG=Object.prototype.propertyIsEnumerable,pk=(e,t,i)=>t in e?eG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oG=(e,t)=>{for(var i in t||(t={}))tG.call(t,i)&&pk(e,i,t[i]);if(fk)for(var i of fk(t))nG.call(t,i)&&pk(e,i,t[i]);return e};const rG={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};oG({linear:NH},rG);function FO(e,t,i,s={}){var d,g,_;const{clone:o=!1,passive:S=!1,eventName:E,deep:I=!1,defaultValue:P}=s,F=jo(),B=i||(F==null?void 0:F.emit)||((d=F==null?void 0:F.$emit)==null?void 0:d.bind(F))||((_=(g=F==null?void 0:F.proxy)==null?void 0:g.$emit)==null?void 0:_.bind(F==null?void 0:F.proxy));let $=E;t||(t="modelValue"),$=E||$||`update:${t.toString()}`;const z=U=>o?f2(o)?o(U):GH(U):U,H=()=>DH(e[t])?z(e[t]):P;if(S){const U=H(),ie=Se(U);return tn(()=>e[t],Z=>ie.value=z(Z)),tn(ie,Z=>{(Z!==e[t]||I)&&B($,Z)},{deep:I}),ie}else return te({get(){return H()},set(U){B($,U)}})}function iG({window:e=Ih}={}){if(!e)return Se(!1);const t=Se(e.document.hasFocus());return qr(e,"blur",()=>{t.value=!1}),qr(e,"focus",()=>{t.value=!0}),t}function aG(e={}){const{window:t=Ih,initialWidth:i=1/0,initialHeight:s=1/0,listenOrientation:d=!0,includeScrollbar:g=!0}=e,_=Se(i),o=Se(s),S=()=>{t&&(g?(_.value=t.innerWidth,o.value=t.innerHeight):(_.value=t.document.documentElement.clientWidth,o.value=t.document.documentElement.clientHeight))};return S(),eT(S),qr("resize",S,{passive:!0}),d&&qr("orientationchange",S,{passive:!0}),{width:_,height:o}}class sG extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function ha(e,t){throw new sG(`[${e}] ${t}`)}const mk={current:0},gk=Se(0),BO=2e3,vk=Symbol("elZIndexContextKey"),NO=Symbol("zIndexContextKey"),Vm=e=>{const t=jo()?Un(vk,mk):mk,i=e||(jo()?Un(NO,void 0):void 0),s=te(()=>{const _=y(i);return ao(_)?_:BO}),d=te(()=>s.value+gk.value),g=()=>(t.current++,gk.value=t.current,d.value);return!gr&&Un(vk),{initialZIndex:s,currentZIndex:d,nextZIndex:g}};var lG={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const cG=e=>(t,i)=>uG(t,i,y(e)),uG=(e,t,i)=>Ji(i,e,e).replace(/\{(\w+)\}/g,(s,d)=>{var g;return`${(g=t==null?void 0:t[d])!=null?g:`{${d}}`}`}),dG=e=>{const t=te(()=>y(e).name),i=vi(e)?e:Se(e);return{lang:t,locale:i,t:cG(e)}},$O=Symbol("localeContextKey"),vr=e=>{const t=e||Un($O,Se());return dG(te(()=>t.value||lG))},VO="__epPropKey",ut=e=>e,hG=e=>Vo(e)&&!!e[VO],Qc=(e,t)=>{if(!Vo(e)||hG(e))return e;const{values:i,required:s,default:d,type:g,validator:_}=e,S={type:g,required:!!s,validator:i||_?E=>{let I=!1,P=[];if(i&&(P=Array.from(i),Tr(e,"default")&&P.push(d),I||(I=P.includes(E))),_&&(I||(I=_(E))),!I&&P.length>0){const F=[...new Set(P)].map(B=>JSON.stringify(B)).join(", ");p6(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${F}], got value ${JSON.stringify(E)}.`)}return I}:void 0,[VO]:!0};return Tr(e,"default")&&(S.default=d),S},vn=e=>u_(Object.entries(e).map(([t,i])=>[t,Qc(i,t)])),ku=["","default","small","large"],ia=Qc({type:String,values:ku,required:!1}),UO=Symbol("size"),jO=()=>{const e=Un(UO,{});return te(()=>y(e.size)||"")},HO=Symbol("emptyValuesContextKey"),fG=["",void 0,null],pG=void 0,Um=vn({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>Qn(e)?!e():!e}}),a1=(e,t)=>{const i=jo()?Un(HO,Se({})):Se({}),s=te(()=>e.emptyValues||i.value.emptyValues||fG),d=te(()=>Qn(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:Qn(i.value.valueOnClear)?i.value.valueOnClear():i.value.valueOnClear!==void 0?i.value.valueOnClear:t!==void 0?t:pG),g=_=>s.value.includes(_);return s.value.includes(d.value),{emptyValues:s,valueOnClear:d,isEmptyValue:g}},bm=e=>Object.keys(e),GO=e=>Object.entries(e),j0=(e,t,i)=>({get value(){return Ji(e,t,i)},set value(s){xH(e,t,s)}}),yb=Se();function s1(e,t=void 0){const i=jo()?Un(HR,yb):yb;return e?te(()=>{var s,d;return(d=(s=i.value)==null?void 0:s[e])!=null?d:t}):i}function l1(e,t){const i=s1(),s=rn(e,te(()=>{var o;return((o=i.value)==null?void 0:o.namespace)||Hv})),d=vr(te(()=>{var o;return(o=i.value)==null?void 0:o.locale})),g=Vm(te(()=>{var o;return((o=i.value)==null?void 0:o.zIndex)||BO})),_=te(()=>{var o;return y(t)||((o=i.value)==null?void 0:o.size)||""});return nT(te(()=>y(i)||{})),{ns:s,locale:d,zIndex:g,size:_}}const nT=(e,t,i=!1)=>{var s;const d=!!jo(),g=d?s1():void 0,_=(s=t==null?void 0:t.provide)!=null?s:d?or:void 0;if(!_)return;const o=te(()=>{const S=y(e);return g!=null&&g.value?mG(g.value,S):S});return _(HR,o),_($O,te(()=>o.value.locale)),_(GR,te(()=>o.value.namespace)),_(NO,te(()=>o.value.zIndex)),_(UO,{size:te(()=>o.value.size||"")}),_(HO,te(()=>({emptyValues:o.value.emptyValues,valueOnClear:o.value.valueOnClear}))),(i||!yb.value)&&(yb.value=o.value),o},mG=(e,t)=>{const i=[...new Set([...bm(e),...bm(t)])],s={};for(const d of i)s[d]=t[d]!==void 0?t[d]:e[d];return s},gG=(e=[])=>({version:e$,install:(i,s)=>{i[CA]||(i[CA]=!0,e.forEach(d=>i.use(d)),s&&nT(s,i,!0))}}),Fo="update:modelValue",Yr="change",Ga="input",vG=vn({zIndex:{type:ut([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),_G={scroll:({scrollTop:e,fixed:t})=>ao(e)&&ai(t),[Yr]:e=>ai(e)};var bn=(e,t)=>{const i=e.__vccOpts||e;for(const[s,d]of t)i[s]=d;return i};function yG(e,t,i,s){const d=i-t;return e/=s/2,e<1?d/2*e*e*e+t:d/2*((e-=2)*e*e+2)+t}const _h=e=>gr?window.requestAnimationFrame(e):setTimeout(e,16),$f=e=>gr?window.cancelAnimationFrame(e):clearTimeout(e),WO=(e="")=>e.split(" ").filter(t=>!!t.trim()),el=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},Yl=(e,t)=>{!e||!t.trim()||e.classList.add(...WO(t))},fs=(e,t)=>{!e||!t.trim()||e.classList.remove(...WO(t))},Ju=(e,t)=>{var i;if(!gr||!e||!t)return"";let s=Ds(t);s==="float"&&(s="cssFloat");try{const d=e.style[s];if(d)return d;const g=(i=document.defaultView)==null?void 0:i.getComputedStyle(e,"");return g?g[s]:""}catch{return e.style[s]}},qO=(e,t,i)=>{if(!(!e||!t))if(Vo(t))GO(t).forEach(([s,d])=>qO(e,s,d));else{const s=Ds(t);e.style[s]=i}};function ji(e,t="px"){if(!e)return"";if(ao(e)||MH(e))return`${e}${t}`;if(Zn(e))return e}const bG=(e,t)=>{if(!gr)return!1;const i={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],s=Ju(e,i);return["scroll","auto","overlay"].some(d=>s.includes(d))},oT=(e,t)=>{if(!gr)return;let i=e;for(;i;){if([window,document,document.documentElement].includes(i))return window;if(bG(i,t))return i;i=i.parentNode}return i};let w0;const KO=e=>{var t;if(!gr)return 0;if(w0!==void 0)return w0;const i=document.createElement("div");i.className=`${e}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const s=i.offsetWidth;i.style.overflow="scroll";const d=document.createElement("div");d.style.width="100%",i.appendChild(d);const g=d.offsetWidth;return(t=i.parentNode)==null||t.removeChild(i),w0=s-g,w0};function rT(e,t){if(!gr)return;if(!t){e.scrollTop=0;return}const i=[];let s=t.offsetParent;for(;s!==null&&e!==s&&e.contains(s);)i.push(s),s=s.offsetParent;const d=t.offsetTop+i.reduce((S,E)=>S+E.offsetTop,0),g=d+t.offsetHeight,_=e.scrollTop,o=_+e.clientHeight;d<_?e.scrollTop=d:g>o&&(e.scrollTop=g-e.clientHeight)}function xG(e,t,i,s,d){const g=Date.now();let _;const o=()=>{const E=Date.now()-g,I=yG(E>s?s:E,t,i,s);i1(e)?e.scrollTo(window.pageXOffset,I):e.scrollTop=I,E<s?_=_h(o):Qn(d)&&d()};return o(),()=>{_&&$f(_)}}const _k=(e,t)=>i1(t)?e.ownerDocument.documentElement:t,yk=e=>i1(e)?window.scrollY:e.scrollTop,ZO="ElAffix",wG=Ze({name:ZO}),SG=Ze({...wG,props:vG,emits:_G,setup(e,{expose:t,emit:i}){const s=e,d=rn("affix"),g=gi(),_=gi(),o=gi(),{height:S}=aG(),{height:E,width:I,top:P,bottom:F,update:B}=uk(_,{windowScroll:!1}),$=uk(g),z=Se(!1),H=Se(0),U=Se(0),ie=te(()=>({height:z.value?`${E.value}px`:"",width:z.value?`${I.value}px`:""})),Z=te(()=>{if(!z.value)return{};const oe=s.offset?ji(s.offset):0;return{height:`${E.value}px`,width:`${I.value}px`,top:s.position==="top"?oe:"",bottom:s.position==="bottom"?oe:"",transform:U.value?`translateY(${U.value}px)`:"",zIndex:s.zIndex}}),G=()=>{if(!o.value)return;H.value=o.value instanceof Window?document.documentElement.scrollTop:o.value.scrollTop||0;const{position:oe,target:le,offset:me}=s,fe=me+E.value;if(oe==="top")if(le){const ce=$.bottom.value-fe;z.value=me>P.value&&$.bottom.value>0,U.value=ce<0?ce:0}else z.value=me>P.value;else if(le){const ce=S.value-$.top.value-fe;z.value=S.value-me<F.value&&S.value>$.top.value,U.value=ce<0?-ce:0}else z.value=S.value-me<F.value},Q=()=>{B(),i("scroll",{scrollTop:H.value,fixed:z.value})};return tn(z,oe=>i("change",oe)),No(()=>{var oe;s.target?(g.value=(oe=document.querySelector(s.target))!=null?oe:void 0,g.value||ha(ZO,`Target does not exist: ${s.target}`)):g.value=document.documentElement,o.value=oT(_.value,!0),B()}),qr(o,"scroll",Q),Ha(G),t({update:G,updateRoot:B}),(oe,le)=>(se(),Pe("div",{ref_key:"root",ref:_,class:de(y(d).b()),style:to(y(ie))},[He("div",{class:de({[y(d).m("fixed")]:z.value}),style:to(y(Z))},[_t(oe.$slots,"default")],6)],6))}});var TG=bn(SG,[["__file","affix.vue"]]);const Ao=(e,t)=>{if(e.install=i=>{for(const s of[e,...Object.values(t??{})])i.component(s.name,s)},t)for(const[i,s]of Object.entries(t))e[i]=s;return e},YO=(e,t)=>(e.install=i=>{e._context=i._context,i.config.globalProperties[t]=e},e),CG=(e,t)=>(e.install=i=>{i.directive(t,e)},e),Oi=e=>(e.install=jr,e),EG=Ao(TG),MG=vn({size:{type:ut([Number,String])},color:{type:String}}),IG=Ze({name:"ElIcon",inheritAttrs:!1}),AG=Ze({...IG,props:MG,setup(e){const t=e,i=rn("icon"),s=te(()=>{const{size:d,color:g}=t;return!d&&!g?{}:{fontSize:Hr(d)?void 0:ji(d),"--color":g}});return(d,g)=>(se(),Pe("i",Yo({class:y(i).b(),style:y(s)},d.$attrs),[_t(d.$slots,"default")],16))}});var kG=bn(AG,[["__file","icon.vue"]]);const Gn=Ao(kG);/*! Element Plus Icons Vue v2.3.1 */var PG=Ze({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),cd=PG,RG=Ze({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),yh=RG,OG=Ze({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),Ls=OG,LG=Ze({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),iT=LG,DG=Ze({name:"Back",__name:"back",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),He("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),zG=DG,FG=Ze({name:"Calendar",__name:"calendar",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),BG=FG,NG=Ze({name:"CaretRight",__name:"caret-right",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),XO=NG,$G=Ze({name:"CaretTop",__name:"caret-top",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),VG=$G,UG=Ze({name:"Check",__name:"check",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),D_=UG,jG=Ze({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),HG=jG,GG=Ze({name:"CircleCheck",__name:"circle-check",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),He("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),aT=GG,WG=Ze({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),sT=WG,qG=Ze({name:"CircleClose",__name:"circle-close",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),He("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),ud=qG,KG=Ze({name:"Clock",__name:"clock",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),He("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),He("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),JO=KG,ZG=Ze({name:"Close",__name:"close",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),Kc=ZG,YG=Ze({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),bh=YG,XG=Ze({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),xh=XG,JG=Ze({name:"Delete",__name:"delete",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),QG=JG,eW=Ze({name:"Document",__name:"document",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),tW=eW,nW=Ze({name:"FullScreen",__name:"full-screen",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),oW=nW,rW=Ze({name:"Hide",__name:"hide",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),He("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),iW=rW,aW=Ze({name:"InfoFilled",__name:"info-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),lT=aW,sW=Ze({name:"Loading",__name:"loading",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Cu=sW,lW=Ze({name:"Minus",__name:"minus",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),cW=lW,uW=Ze({name:"MoreFilled",__name:"more-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),bk=uW,dW=Ze({name:"More",__name:"more",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),hW=dW,fW=Ze({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),pW=fW,mW=Ze({name:"Plus",__name:"plus",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),QO=mW,gW=Ze({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),vW=gW,_W=Ze({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),yW=_W,bW=Ze({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),xW=bW,wW=Ze({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),SW=wW,TW=Ze({name:"Search",__name:"search",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),CW=TW,EW=Ze({name:"SortDown",__name:"sort-down",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),MW=EW,IW=Ze({name:"SortUp",__name:"sort-up",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),AW=IW,kW=Ze({name:"StarFilled",__name:"star-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),S0=kW,PW=Ze({name:"Star",__name:"star",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),RW=PW,OW=Ze({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),eL=OW,LW=Ze({name:"View",__name:"view",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),DW=LW,zW=Ze({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),c1=zW,FW=Ze({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),tL=FW,BW=Ze({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,i)=>(se(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[He("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),NW=BW;const Xr=ut([String,Object,Function]),cT={Close:Kc},uT={Close:Kc,SuccessFilled:eL,InfoFilled:lT,WarningFilled:c1,CircleCloseFilled:sT},wh={success:eL,warning:c1,error:sT,info:lT},u1={validating:Cu,success:aT,error:ud},$W=["light","dark"],VW=vn({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:bm(wh),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:$W,default:"light"}}),UW={close:e=>e instanceof MouseEvent},jW=Ze({name:"ElAlert"}),HW=Ze({...jW,props:VW,emits:UW,setup(e,{emit:t}){const i=e,{Close:s}=uT,d=aa(),g=rn("alert"),_=Se(!0),o=te(()=>wh[i.type]),S=te(()=>[g.e("icon"),{[g.is("big")]:!!i.description||!!d.default}]),E=te(()=>({"with-description":i.description||d.default})),I=P=>{_.value=!1,t("close",P)};return(P,F)=>(se(),Rt(Ea,{name:y(g).b("fade"),persisted:""},{default:at(()=>[zo(He("div",{class:de([y(g).b(),y(g).m(P.type),y(g).is("center",P.center),y(g).is(P.effect)]),role:"alert"},[P.showIcon&&y(o)?(se(),Rt(y(Gn),{key:0,class:de(y(S))},{default:at(()=>[(se(),Rt(Wo(y(o))))]),_:1},8,["class"])):St("v-if",!0),He("div",{class:de(y(g).e("content"))},[P.title||P.$slots.title?(se(),Pe("span",{key:0,class:de([y(g).e("title"),y(E)])},[_t(P.$slots,"title",{},()=>[nr(wn(P.title),1)])],2)):St("v-if",!0),P.$slots.default||P.description?(se(),Pe("p",{key:1,class:de(y(g).e("description"))},[_t(P.$slots,"default",{},()=>[nr(wn(P.description),1)])],2)):St("v-if",!0),P.closable?(se(),Pe(eo,{key:2},[P.closeText?(se(),Pe("div",{key:0,class:de([y(g).e("close-btn"),y(g).is("customed")]),onClick:I},wn(P.closeText),3)):(se(),Rt(y(Gn),{key:1,class:de(y(g).e("close-btn")),onClick:I},{default:at(()=>[Qe(y(s))]),_:1},8,["class"]))],64)):St("v-if",!0)],2)],2),[[Cr,_.value]])]),_:3},8,["name"]))}});var GW=bn(HW,[["__file","alert.vue"]]);const WW=Ao(GW),d1=()=>gr&&/firefox/i.test(window.navigator.userAgent);let Fc;const qW=`
  height:0 !important;
  visibility:hidden !important;
  ${d1()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,KW=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function ZW(e){const t=window.getComputedStyle(e),i=t.getPropertyValue("box-sizing"),s=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),d=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:KW.map(_=>`${_}:${t.getPropertyValue(_)}`).join(";"),paddingSize:s,borderSize:d,boxSizing:i}}function xk(e,t=1,i){var s;Fc||(Fc=document.createElement("textarea"),document.body.appendChild(Fc));const{paddingSize:d,borderSize:g,boxSizing:_,contextStyle:o}=ZW(e);Fc.setAttribute("style",`${o};${qW}`),Fc.value=e.value||e.placeholder||"";let S=Fc.scrollHeight;const E={};_==="border-box"?S=S+g:_==="content-box"&&(S=S-d),Fc.value="";const I=Fc.scrollHeight-d;if(ao(t)){let P=I*t;_==="border-box"&&(P=P+d+g),S=Math.max(P,S),E.minHeight=`${P}px`}if(ao(i)){let P=I*i;_==="border-box"&&(P=P+d+g),S=Math.min(P,S)}return E.height=`${S}px`,(s=Fc.parentNode)==null||s.removeChild(Fc),Fc=void 0,E}const Ri=e=>e,YW=vn({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),Da=e=>Uc(YW,e),dT=vn({id:{type:String,default:void 0},size:ia,disabled:Boolean,modelValue:{type:ut([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:ut([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:Xr},prefixIcon:{type:Xr},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:ut([Object,Array,String]),default:()=>Ri({})},autofocus:Boolean,rows:{type:Number,default:2},...Da(["ariaLabel"])}),XW={[Fo]:e=>Zn(e),input:e=>Zn(e),change:e=>Zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},JW=["class","style"],QW=/^on[A-Z]/,z_=(e={})=>{const{excludeListeners:t=!1,excludeKeys:i}=e,s=te(()=>((i==null?void 0:i.value)||[]).concat(JW)),d=jo();return te(d?()=>{var g;return u_(Object.entries((g=d.proxy)==null?void 0:g.$attrs).filter(([_])=>!s.value.includes(_)&&!(t&&QW.test(_))))}:()=>({}))},Kf=Symbol("formContextKey"),Eu=Symbol("formItemContextKey"),wk={prefix:Math.floor(Math.random()*1e4),current:0},e9=Symbol("elIdInjection"),hT=()=>jo()?Un(e9,wk):wk,La=e=>{const t=hT(),i=BS();return h2(()=>y(e)||`${i.value}-id-${t.prefix}-${t.current++}`)},Ka=()=>{const e=Un(Kf,void 0),t=Un(Eu,void 0);return{form:e,formItem:t}},ic=(e,{formItemContext:t,disableIdGeneration:i,disableIdManagement:s})=>{i||(i=Se(!1)),s||(s=Se(!1));const d=Se();let g;const _=te(()=>{var o;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((o=t.inputIds)==null?void 0:o.length)<=1)});return No(()=>{g=tn([Vr(e,"id"),i],([o,S])=>{const E=o??(S?void 0:La().value);E!==d.value&&(t!=null&&t.removeInputId&&(d.value&&t.removeInputId(d.value),!(s!=null&&s.value)&&!S&&E&&t.addInputId(E)),d.value=E)},{immediate:!0})}),Eh(()=>{g&&g(),t!=null&&t.removeInputId&&d.value&&t.removeInputId(d.value)}),{isLabeledByFormItem:_,inputId:d}},nL=e=>{const t=jo();return te(()=>{var i,s;return(s=(i=t==null?void 0:t.proxy)==null?void 0:i.$props)==null?void 0:s[e]})},na=(e,t={})=>{const i=Se(void 0),s=t.prop?i:nL("size"),d=t.global?i:jO(),g=t.form?{size:void 0}:Un(Kf,void 0),_=t.formItem?{size:void 0}:Un(Eu,void 0);return te(()=>s.value||y(e)||(_==null?void 0:_.size)||(g==null?void 0:g.size)||d.value||"")},Za=e=>{const t=nL("disabled"),i=Un(Kf,void 0);return te(()=>t.value||y(e)||(i==null?void 0:i.disabled)||!1)};function Ah(e,{beforeFocus:t,afterFocus:i,beforeBlur:s,afterBlur:d}={}){const g=jo(),{emit:_}=g,o=gi(),S=Se(!1),E=F=>{Qn(t)&&t(F)||S.value||(S.value=!0,_("focus",F),i==null||i())},I=F=>{var B;Qn(s)&&s(F)||F.relatedTarget&&((B=o.value)!=null&&B.contains(F.relatedTarget))||(S.value=!1,_("blur",F),d==null||d())},P=()=>{var F,B;(F=o.value)!=null&&F.contains(document.activeElement)&&o.value!==document.activeElement||(B=e.value)==null||B.focus()};return tn(o,F=>{F&&F.setAttribute("tabindex","-1")}),qr(o,"focus",E,!0),qr(o,"blur",I,!0),qr(o,"click",P,!0),{isFocused:S,wrapperRef:o,handleFocus:E,handleBlur:I}}const t9=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e);function F_({afterComposition:e,emit:t}){const i=Se(!1),s=o=>{t==null||t("compositionstart",o),i.value=!0},d=o=>{var S;t==null||t("compositionupdate",o);const E=(S=o.target)==null?void 0:S.value,I=E[E.length-1]||"";i.value=!t9(I)},g=o=>{t==null||t("compositionend",o),i.value&&(i.value=!1,oo(()=>e(o)))};return{isComposing:i,handleComposition:o=>{o.type==="compositionend"?g(o):d(o)},handleCompositionStart:s,handleCompositionUpdate:d,handleCompositionEnd:g}}function n9(e){let t;function i(){if(e.value==null)return;const{selectionStart:d,selectionEnd:g,value:_}=e.value;if(d==null||g==null)return;const o=_.slice(0,Math.max(0,d)),S=_.slice(Math.max(0,g));t={selectionStart:d,selectionEnd:g,value:_,beforeTxt:o,afterTxt:S}}function s(){if(e.value==null||t==null)return;const{value:d}=e.value,{beforeTxt:g,afterTxt:_,selectionStart:o}=t;if(g==null||_==null||o==null)return;let S=d.length;if(d.endsWith(_))S=d.length-_.length;else if(d.startsWith(g))S=g.length;else{const E=g[o-1],I=d.indexOf(E,o-1);I!==-1&&(S=I+1)}e.value.setSelectionRange(S,S)}return[i,s]}const o9=Ze({name:"ElInput",inheritAttrs:!1}),r9=Ze({...o9,props:dT,emits:XW,setup(e,{expose:t,emit:i}){const s=e,d=Mh(),g=z_(),_=aa(),o=te(()=>[s.type==="textarea"?z.b():$.b(),$.m(F.value),$.is("disabled",B.value),$.is("exceed",ot.value),{[$.b("group")]:_.prepend||_.append,[$.m("prefix")]:_.prefix||s.prefixIcon,[$.m("suffix")]:_.suffix||s.suffixIcon||s.clearable||s.showPassword,[$.bm("suffix","password-clear")]:Ce.value&&ge.value,[$.b("hidden")]:s.type==="hidden"},d.class]),S=te(()=>[$.e("wrapper"),$.is("focus",me.value)]),{form:E,formItem:I}=Ka(),{inputId:P}=ic(s,{formItemContext:I}),F=na(),B=Za(),$=rn("input"),z=rn("textarea"),H=gi(),U=gi(),ie=Se(!1),Z=Se(!1),G=Se(),Q=gi(s.inputStyle),oe=te(()=>H.value||U.value),{wrapperRef:le,isFocused:me,handleFocus:fe,handleBlur:ce}=Ah(oe,{beforeFocus(){return B.value},afterBlur(){var yt;s.validateEvent&&((yt=I==null?void 0:I.validate)==null||yt.call(I,"blur").catch(kn=>void 0))}}),pe=te(()=>{var yt;return(yt=E==null?void 0:E.statusIcon)!=null?yt:!1}),ye=te(()=>(I==null?void 0:I.validateState)||""),De=te(()=>ye.value&&u1[ye.value]),tt=te(()=>Z.value?DW:iW),Me=te(()=>[d.style]),xe=te(()=>[s.inputStyle,Q.value,{resize:s.resize}]),Ae=te(()=>ga(s.modelValue)?"":String(s.modelValue)),Ce=te(()=>s.clearable&&!B.value&&!s.readonly&&!!Ae.value&&(me.value||ie.value)),ge=te(()=>s.showPassword&&!B.value&&!!Ae.value&&(!!Ae.value||me.value)),Ne=te(()=>s.showWordLimit&&!!s.maxlength&&(s.type==="text"||s.type==="textarea")&&!B.value&&!s.readonly&&!s.showPassword),We=te(()=>Ae.value.length),ot=te(()=>!!Ne.value&&We.value>Number(s.maxlength)),Oe=te(()=>!!_.suffix||!!s.suffixIcon||Ce.value||s.showPassword||Ne.value||!!ye.value&&pe.value),[Ct,Mt]=n9(H);Mi(U,yt=>{if(Kt(),!Ne.value||s.resize!=="both")return;const kn=yt[0],{width:qn}=kn.contentRect;G.value={right:`calc(100% - ${qn+15+6}px)`}});const zt=()=>{const{type:yt,autosize:kn}=s;if(!(!gr||yt!=="textarea"||!U.value))if(kn){const qn=Vo(kn)?kn.minRows:void 0,Co=Vo(kn)?kn.maxRows:void 0,mo=xk(U.value,qn,Co);Q.value={overflowY:"hidden",...mo},oo(()=>{U.value.offsetHeight,Q.value=mo})}else Q.value={minHeight:xk(U.value).minHeight}},Kt=(yt=>{let kn=!1;return()=>{var qn;if(kn||!s.autosize)return;((qn=U.value)==null?void 0:qn.offsetParent)===null||(yt(),kn=!0)}})(zt),$t=()=>{const yt=oe.value,kn=s.formatter?s.formatter(Ae.value):Ae.value;!yt||yt.value===kn||(yt.value=kn)},Re=async yt=>{Ct();let{value:kn}=yt.target;if(s.formatter&&(kn=s.parser?s.parser(kn):kn),!At.value){if(kn===Ae.value){$t();return}i(Fo,kn),i("input",kn),await oo(),$t(),Mt()}},dn=yt=>{i("change",yt.target.value)},{isComposing:At,handleCompositionStart:Ke,handleCompositionUpdate:Be,handleCompositionEnd:Ht}=F_({emit:i,afterComposition:Re}),Ut=()=>{Ct(),Z.value=!Z.value,setTimeout(Mt)},Nt=()=>{var yt;return(yt=oe.value)==null?void 0:yt.focus()},Et=()=>{var yt;return(yt=oe.value)==null?void 0:yt.blur()},Gt=yt=>{ie.value=!1,i("mouseleave",yt)},ln=yt=>{ie.value=!0,i("mouseenter",yt)},yn=yt=>{i("keydown",yt)},_n=()=>{var yt;(yt=oe.value)==null||yt.select()},jn=()=>{i(Fo,""),i("change",""),i("clear"),i("input","")};return tn(()=>s.modelValue,()=>{var yt;oo(()=>zt()),s.validateEvent&&((yt=I==null?void 0:I.validate)==null||yt.call(I,"change").catch(kn=>void 0))}),tn(Ae,()=>$t()),tn(()=>s.type,async()=>{await oo(),$t(),zt()}),No(()=>{!s.formatter&&s.parser,$t(),oo(zt)}),t({input:H,textarea:U,ref:oe,textareaStyle:xe,autosize:Vr(s,"autosize"),isComposing:At,focus:Nt,blur:Et,select:_n,clear:jn,resizeTextarea:zt}),(yt,kn)=>(se(),Pe("div",{class:de([y(o),{[y($).bm("group","append")]:yt.$slots.append,[y($).bm("group","prepend")]:yt.$slots.prepend}]),style:to(y(Me)),onMouseenter:ln,onMouseleave:Gt},[St(" input "),yt.type!=="textarea"?(se(),Pe(eo,{key:0},[St(" prepend slot "),yt.$slots.prepend?(se(),Pe("div",{key:0,class:de(y($).be("group","prepend"))},[_t(yt.$slots,"prepend")],2)):St("v-if",!0),He("div",{ref_key:"wrapperRef",ref:le,class:de(y(S))},[St(" prefix slot "),yt.$slots.prefix||yt.prefixIcon?(se(),Pe("span",{key:0,class:de(y($).e("prefix"))},[He("span",{class:de(y($).e("prefix-inner"))},[_t(yt.$slots,"prefix"),yt.prefixIcon?(se(),Rt(y(Gn),{key:0,class:de(y($).e("icon"))},{default:at(()=>[(se(),Rt(Wo(yt.prefixIcon)))]),_:1},8,["class"])):St("v-if",!0)],2)],2)):St("v-if",!0),He("input",Yo({id:y(P),ref_key:"input",ref:H,class:y($).e("inner")},y(g),{minlength:yt.minlength,maxlength:yt.maxlength,type:yt.showPassword?Z.value?"text":"password":yt.type,disabled:y(B),readonly:yt.readonly,autocomplete:yt.autocomplete,tabindex:yt.tabindex,"aria-label":yt.ariaLabel,placeholder:yt.placeholder,style:yt.inputStyle,form:yt.form,autofocus:yt.autofocus,role:yt.containerRole,onCompositionstart:y(Ke),onCompositionupdate:y(Be),onCompositionend:y(Ht),onInput:Re,onChange:dn,onKeydown:yn}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),St(" suffix slot "),y(Oe)?(se(),Pe("span",{key:1,class:de(y($).e("suffix"))},[He("span",{class:de(y($).e("suffix-inner"))},[!y(Ce)||!y(ge)||!y(Ne)?(se(),Pe(eo,{key:0},[_t(yt.$slots,"suffix"),yt.suffixIcon?(se(),Rt(y(Gn),{key:0,class:de(y($).e("icon"))},{default:at(()=>[(se(),Rt(Wo(yt.suffixIcon)))]),_:1},8,["class"])):St("v-if",!0)],64)):St("v-if",!0),y(Ce)?(se(),Rt(y(Gn),{key:1,class:de([y($).e("icon"),y($).e("clear")]),onMousedown:po(y(jr),["prevent"]),onClick:jn},{default:at(()=>[Qe(y(ud))]),_:1},8,["class","onMousedown"])):St("v-if",!0),y(ge)?(se(),Rt(y(Gn),{key:2,class:de([y($).e("icon"),y($).e("password")]),onClick:Ut},{default:at(()=>[(se(),Rt(Wo(y(tt))))]),_:1},8,["class"])):St("v-if",!0),y(Ne)?(se(),Pe("span",{key:3,class:de(y($).e("count"))},[He("span",{class:de(y($).e("count-inner"))},wn(y(We))+" / "+wn(yt.maxlength),3)],2)):St("v-if",!0),y(ye)&&y(De)&&y(pe)?(se(),Rt(y(Gn),{key:4,class:de([y($).e("icon"),y($).e("validateIcon"),y($).is("loading",y(ye)==="validating")])},{default:at(()=>[(se(),Rt(Wo(y(De))))]),_:1},8,["class"])):St("v-if",!0)],2)],2)):St("v-if",!0)],2),St(" append slot "),yt.$slots.append?(se(),Pe("div",{key:1,class:de(y($).be("group","append"))},[_t(yt.$slots,"append")],2)):St("v-if",!0)],64)):(se(),Pe(eo,{key:1},[St(" textarea "),He("textarea",Yo({id:y(P),ref_key:"textarea",ref:U,class:[y(z).e("inner"),y($).is("focus",y(me))]},y(g),{minlength:yt.minlength,maxlength:yt.maxlength,tabindex:yt.tabindex,disabled:y(B),readonly:yt.readonly,autocomplete:yt.autocomplete,style:y(xe),"aria-label":yt.ariaLabel,placeholder:yt.placeholder,form:yt.form,autofocus:yt.autofocus,rows:yt.rows,role:yt.containerRole,onCompositionstart:y(Ke),onCompositionupdate:y(Be),onCompositionend:y(Ht),onInput:Re,onFocus:y(fe),onBlur:y(ce),onChange:dn,onKeydown:yn}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),y(Ne)?(se(),Pe("span",{key:0,style:to(G.value),class:de(y($).e("count"))},wn(y(We))+" / "+wn(yt.maxlength),7)):St("v-if",!0)],64))],38))}});var i9=bn(r9,[["__file","input.vue"]]);const hs=Ao(i9),jp=4,oL={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},a9=({move:e,size:t,bar:i})=>({[i.size]:t,transform:`translate${i.axis}(${e}%)`}),fT=Symbol("scrollbarContextKey"),s9=vn({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),l9="Thumb",c9=Ze({__name:"thumb",props:s9,setup(e){const t=e,i=Un(fT),s=rn("scrollbar");i||ha(l9,"can not inject scrollbar context");const d=Se(),g=Se(),_=Se({}),o=Se(!1);let S=!1,E=!1,I=gr?document.onselectstart:null;const P=te(()=>oL[t.vertical?"vertical":"horizontal"]),F=te(()=>a9({size:t.size,move:t.move,bar:P.value})),B=te(()=>d.value[P.value.offset]**2/i.wrapElement[P.value.scrollSize]/t.ratio/g.value[P.value.offset]),$=oe=>{var le;if(oe.stopPropagation(),oe.ctrlKey||[1,2].includes(oe.button))return;(le=window.getSelection())==null||le.removeAllRanges(),H(oe);const me=oe.currentTarget;me&&(_.value[P.value.axis]=me[P.value.offset]-(oe[P.value.client]-me.getBoundingClientRect()[P.value.direction]))},z=oe=>{if(!g.value||!d.value||!i.wrapElement)return;const le=Math.abs(oe.target.getBoundingClientRect()[P.value.direction]-oe[P.value.client]),me=g.value[P.value.offset]/2,fe=(le-me)*100*B.value/d.value[P.value.offset];i.wrapElement[P.value.scroll]=fe*i.wrapElement[P.value.scrollSize]/100},H=oe=>{oe.stopImmediatePropagation(),S=!0,document.addEventListener("mousemove",U),document.addEventListener("mouseup",ie),I=document.onselectstart,document.onselectstart=()=>!1},U=oe=>{if(!d.value||!g.value||S===!1)return;const le=_.value[P.value.axis];if(!le)return;const me=(d.value.getBoundingClientRect()[P.value.direction]-oe[P.value.client])*-1,fe=g.value[P.value.offset]-le,ce=(me-fe)*100*B.value/d.value[P.value.offset];i.wrapElement[P.value.scroll]=ce*i.wrapElement[P.value.scrollSize]/100},ie=()=>{S=!1,_.value[P.value.axis]=0,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",ie),Q(),E&&(o.value=!1)},Z=()=>{E=!1,o.value=!!t.size},G=()=>{E=!0,o.value=S};ni(()=>{Q(),document.removeEventListener("mouseup",ie)});const Q=()=>{document.onselectstart!==I&&(document.onselectstart=I)};return qr(Vr(i,"scrollbarElement"),"mousemove",Z),qr(Vr(i,"scrollbarElement"),"mouseleave",G),(oe,le)=>(se(),Rt(Ea,{name:y(s).b("fade"),persisted:""},{default:at(()=>[zo(He("div",{ref_key:"instance",ref:d,class:de([y(s).e("bar"),y(s).is(y(P).key)]),onMousedown:z},[He("div",{ref_key:"thumb",ref:g,class:de(y(s).e("thumb")),style:to(y(F)),onMousedown:$},null,38)],34),[[Cr,oe.always||o.value]])]),_:1},8,["name"]))}});var Sk=bn(c9,[["__file","thumb.vue"]]);const u9=vn({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),d9=Ze({__name:"bar",props:u9,setup(e,{expose:t}){const i=e,s=Un(fT),d=Se(0),g=Se(0),_=Se(""),o=Se(""),S=Se(1),E=Se(1);return t({handleScroll:F=>{if(F){const B=F.offsetHeight-jp,$=F.offsetWidth-jp;g.value=F.scrollTop*100/B*S.value,d.value=F.scrollLeft*100/$*E.value}},update:()=>{const F=s==null?void 0:s.wrapElement;if(!F)return;const B=F.offsetHeight-jp,$=F.offsetWidth-jp,z=B**2/F.scrollHeight,H=$**2/F.scrollWidth,U=Math.max(z,i.minSize),ie=Math.max(H,i.minSize);S.value=z/(B-z)/(U/(B-U)),E.value=H/($-H)/(ie/($-ie)),o.value=U+jp<B?`${U}px`:"",_.value=ie+jp<$?`${ie}px`:""}}),(F,B)=>(se(),Pe(eo,null,[Qe(Sk,{move:d.value,ratio:E.value,size:_.value,always:F.always},null,8,["move","ratio","size","always"]),Qe(Sk,{move:g.value,ratio:S.value,size:o.value,vertical:"",always:F.always},null,8,["move","ratio","size","always"])],64))}});var h9=bn(d9,[["__file","bar.vue"]]);const f9=vn({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:ut([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...Da(["ariaLabel","ariaOrientation"])}),p9={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(ao)},m9="ElScrollbar",g9=Ze({name:m9}),v9=Ze({...g9,props:f9,emits:p9,setup(e,{expose:t,emit:i}){const s=e,d=rn("scrollbar");let g,_,o=0,S=0;const E=Se(),I=Se(),P=Se(),F=Se(),B=te(()=>{const Q={};return s.height&&(Q.height=ji(s.height)),s.maxHeight&&(Q.maxHeight=ji(s.maxHeight)),[s.wrapStyle,Q]}),$=te(()=>[s.wrapClass,d.e("wrap"),{[d.em("wrap","hidden-default")]:!s.native}]),z=te(()=>[d.e("view"),s.viewClass]),H=()=>{var Q;I.value&&((Q=F.value)==null||Q.handleScroll(I.value),o=I.value.scrollTop,S=I.value.scrollLeft,i("scroll",{scrollTop:I.value.scrollTop,scrollLeft:I.value.scrollLeft}))};function U(Q,oe){Vo(Q)?I.value.scrollTo(Q):ao(Q)&&ao(oe)&&I.value.scrollTo(Q,oe)}const ie=Q=>{ao(Q)&&(I.value.scrollTop=Q)},Z=Q=>{ao(Q)&&(I.value.scrollLeft=Q)},G=()=>{var Q;(Q=F.value)==null||Q.update()};return tn(()=>s.noresize,Q=>{Q?(g==null||g(),_==null||_()):({stop:g}=Mi(P,G),_=qr("resize",G))},{immediate:!0}),tn(()=>[s.maxHeight,s.height],()=>{s.native||oo(()=>{var Q;G(),I.value&&((Q=F.value)==null||Q.handleScroll(I.value))})}),or(fT,Pr({scrollbarElement:E,wrapElement:I})),kS(()=>{I.value&&(I.value.scrollTop=o,I.value.scrollLeft=S)}),No(()=>{s.native||oo(()=>{G()})}),Au(()=>G()),t({wrapRef:I,update:G,scrollTo:U,setScrollTop:ie,setScrollLeft:Z,handleScroll:H}),(Q,oe)=>(se(),Pe("div",{ref_key:"scrollbarRef",ref:E,class:de(y(d).b())},[He("div",{ref_key:"wrapRef",ref:I,class:de(y($)),style:to(y(B)),tabindex:Q.tabindex,onScroll:H},[(se(),Rt(Wo(Q.tag),{id:Q.id,ref_key:"resizeRef",ref:P,class:de(y(z)),style:to(Q.viewStyle),role:Q.role,"aria-label":Q.ariaLabel,"aria-orientation":Q.ariaOrientation},{default:at(()=>[_t(Q.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),Q.native?St("v-if",!0):(se(),Rt(h9,{key:0,ref_key:"barRef",ref:F,always:Q.always,"min-size":Q.minSize},null,8,["always","min-size"]))],2))}});var _9=bn(v9,[["__file","scrollbar.vue"]]);const Pu=Ao(_9),pT=Symbol("popper"),rL=Symbol("popperContent"),y9=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],iL=vn({role:{type:String,values:y9,default:"tooltip"}}),b9=Ze({name:"ElPopper",inheritAttrs:!1}),x9=Ze({...b9,props:iL,setup(e,{expose:t}){const i=e,s=Se(),d=Se(),g=Se(),_=Se(),o=te(()=>i.role),S={triggerRef:s,popperInstanceRef:d,contentRef:g,referenceRef:_,role:o};return t(S),or(pT,S),(E,I)=>_t(E.$slots,"default")}});var w9=bn(x9,[["__file","popper.vue"]]);const aL=vn({arrowOffset:{type:Number,default:5}}),S9=Ze({name:"ElPopperArrow",inheritAttrs:!1}),T9=Ze({...S9,props:aL,setup(e,{expose:t}){const i=e,s=rn("popper"),{arrowOffset:d,arrowRef:g,arrowStyle:_}=Un(rL,void 0);return tn(()=>i.arrowOffset,o=>{d.value=o}),ni(()=>{g.value=void 0}),t({arrowRef:g}),(o,S)=>(se(),Pe("span",{ref_key:"arrowRef",ref:g,class:de(y(s).e("arrow")),style:to(y(_)),"data-popper-arrow":""},null,6))}});var C9=bn(T9,[["__file","arrow.vue"]]);const sL=vn({virtualRef:{type:ut(Object)},virtualTriggering:Boolean,onMouseenter:{type:ut(Function)},onMouseleave:{type:ut(Function)},onClick:{type:ut(Function)},onKeydown:{type:ut(Function)},onFocus:{type:ut(Function)},onBlur:{type:ut(Function)},onContextmenu:{type:ut(Function)},id:String,open:Boolean}),lL=Symbol("elForwardRef"),E9=e=>{or(lL,{setForwardRef:i=>{e.value=i}})},M9=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),I9='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',A9=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,Tk=e=>Array.from(e.querySelectorAll(I9)).filter(t=>m2(t)&&A9(t)),m2=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},H0=function(e,t,...i){let s;t.includes("mouse")||t.includes("click")?s="MouseEvents":t.includes("key")?s="KeyboardEvent":s="HTMLEvents";const d=document.createEvent(s);return d.initEvent(t,...i),e.dispatchEvent(d),e},cL=e=>!e.getAttribute("aria-owns"),uL=(e,t,i)=>{const{parentNode:s}=e;if(!s)return null;const d=s.querySelectorAll(i),g=Array.prototype.indexOf.call(d,e);return d[g+t]||null},G0=e=>{e&&(e.focus(),!cL(e)&&e.click())},k9="ElOnlyChild",dL=Ze({name:k9,setup(e,{slots:t,attrs:i}){var s;const d=Un(lL),g=M9((s=d==null?void 0:d.setForwardRef)!=null?s:jr);return()=>{var _;const o=(_=t.default)==null?void 0:_.call(t,i);if(!o||o.length>1)return null;const S=hL(o);return S?zo(td(S,i),[[g]]):null}}});function hL(e){if(!e)return null;const t=e;for(const i of t){if(Vo(i))switch(i.type){case Sa:continue;case zm:case"svg":return Ck(i);case eo:return hL(i.children);default:return i}return Ck(i)}return null}function Ck(e){const t=rn("only-child");return Qe("span",{class:t.e("content")},[e])}const P9=Ze({name:"ElPopperTrigger",inheritAttrs:!1}),R9=Ze({...P9,props:sL,setup(e,{expose:t}){const i=e,{role:s,triggerRef:d}=Un(pT,void 0);E9(d);const g=te(()=>o.value?i.id:void 0),_=te(()=>{if(s&&s.value==="tooltip")return i.open&&i.id?i.id:void 0}),o=te(()=>{if(s&&s.value!=="tooltip")return s.value}),S=te(()=>o.value?`${i.open}`:void 0);let E;const I=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return No(()=>{tn(()=>i.virtualRef,P=>{P&&(d.value=Os(P))},{immediate:!0}),tn(d,(P,F)=>{E==null||E(),E=void 0,Tl(P)&&(I.forEach(B=>{var $;const z=i[B];z&&(P.addEventListener(B.slice(2).toLowerCase(),z),($=F==null?void 0:F.removeEventListener)==null||$.call(F,B.slice(2).toLowerCase(),z))}),m2(P)&&(E=tn([g,_,o,S],B=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(($,z)=>{ga(B[z])?P.removeAttribute($):P.setAttribute($,B[z])})},{immediate:!0}))),Tl(F)&&m2(F)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(B=>F.removeAttribute(B))},{immediate:!0})}),ni(()=>{if(E==null||E(),E=void 0,d.value&&Tl(d.value)){const P=d.value;I.forEach(F=>{const B=i[F];B&&P.removeEventListener(F.slice(2).toLowerCase(),B)}),d.value=void 0}}),t({triggerRef:d}),(P,F)=>P.virtualTriggering?St("v-if",!0):(se(),Rt(y(dL),Yo({key:0},P.$attrs,{"aria-controls":y(g),"aria-describedby":y(_),"aria-expanded":y(S),"aria-haspopup":y(o)}),{default:at(()=>[_t(P.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var O9=bn(R9,[["__file","trigger.vue"]]);const ww="focus-trap.focus-after-trapped",Sw="focus-trap.focus-after-released",L9="focus-trap.focusout-prevented",Ek={cancelable:!0,bubbles:!1},D9={cancelable:!0,bubbles:!1},Mk="focusAfterTrapped",Ik="focusAfterReleased",mT=Symbol("elFocusTrap"),gT=Se(),h1=Se(0),vT=Se(0);let T0=0;const fL=e=>{const t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const d=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||d?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t},Ak=(e,t)=>{for(const i of e)if(!z9(i,t))return i},z9=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},F9=e=>{const t=fL(e),i=Ak(t,e),s=Ak(t.reverse(),e);return[i,s]},B9=e=>e instanceof HTMLInputElement&&"select"in e,eh=(e,t)=>{if(e&&e.focus){const i=document.activeElement;e.focus({preventScroll:!0}),vT.value=window.performance.now(),e!==i&&B9(e)&&t&&e.select()}};function kk(e,t){const i=[...e],s=e.indexOf(t);return s!==-1&&i.splice(s,1),i}const N9=()=>{let e=[];return{push:s=>{const d=e[0];d&&s!==d&&d.pause(),e=kk(e,s),e.unshift(s)},remove:s=>{var d,g;e=kk(e,s),(g=(d=e[0])==null?void 0:d.resume)==null||g.call(d)}}},$9=(e,t=!1)=>{const i=document.activeElement;for(const s of e)if(eh(s,t),document.activeElement!==i)return},Pk=N9(),V9=()=>h1.value>vT.value,C0=()=>{gT.value="pointer",h1.value=window.performance.now()},Rk=()=>{gT.value="keyboard",h1.value=window.performance.now()},U9=()=>(No(()=>{T0===0&&(document.addEventListener("mousedown",C0),document.addEventListener("touchstart",C0),document.addEventListener("keydown",Rk)),T0++}),ni(()=>{T0--,T0<=0&&(document.removeEventListener("mousedown",C0),document.removeEventListener("touchstart",C0),document.removeEventListener("keydown",Rk))}),{focusReason:gT,lastUserFocusTimestamp:h1,lastAutomatedFocusTimestamp:vT}),E0=e=>new CustomEvent(L9,{...D9,detail:e}),On={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};let Yp=[];const Ok=e=>{e.code===On.esc&&Yp.forEach(t=>t(e))},j9=e=>{No(()=>{Yp.length===0&&document.addEventListener("keydown",Ok),gr&&Yp.push(e)}),ni(()=>{Yp=Yp.filter(t=>t!==e),Yp.length===0&&gr&&document.removeEventListener("keydown",Ok)})},H9=Ze({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Mk,Ik,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const i=Se();let s,d;const{focusReason:g}=U9();j9($=>{e.trapped&&!_.paused&&t("release-requested",$)});const _={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},o=$=>{if(!e.loop&&!e.trapped||_.paused)return;const{code:z,altKey:H,ctrlKey:U,metaKey:ie,currentTarget:Z,shiftKey:G}=$,{loop:Q}=e,oe=z===On.tab&&!H&&!U&&!ie,le=document.activeElement;if(oe&&le){const me=Z,[fe,ce]=F9(me);if(fe&&ce){if(!G&&le===ce){const ye=E0({focusReason:g.value});t("focusout-prevented",ye),ye.defaultPrevented||($.preventDefault(),Q&&eh(fe,!0))}else if(G&&[fe,me].includes(le)){const ye=E0({focusReason:g.value});t("focusout-prevented",ye),ye.defaultPrevented||($.preventDefault(),Q&&eh(ce,!0))}}else if(le===me){const ye=E0({focusReason:g.value});t("focusout-prevented",ye),ye.defaultPrevented||$.preventDefault()}}};or(mT,{focusTrapRef:i,onKeydown:o}),tn(()=>e.focusTrapEl,$=>{$&&(i.value=$)},{immediate:!0}),tn([i],([$],[z])=>{$&&($.addEventListener("keydown",o),$.addEventListener("focusin",I),$.addEventListener("focusout",P)),z&&(z.removeEventListener("keydown",o),z.removeEventListener("focusin",I),z.removeEventListener("focusout",P))});const S=$=>{t(Mk,$)},E=$=>t(Ik,$),I=$=>{const z=y(i);if(!z)return;const H=$.target,U=$.relatedTarget,ie=H&&z.contains(H);e.trapped||U&&z.contains(U)||(s=U),ie&&t("focusin",$),!_.paused&&e.trapped&&(ie?d=H:eh(d,!0))},P=$=>{const z=y(i);if(!(_.paused||!z))if(e.trapped){const H=$.relatedTarget;!ga(H)&&!z.contains(H)&&setTimeout(()=>{if(!_.paused&&e.trapped){const U=E0({focusReason:g.value});t("focusout-prevented",U),U.defaultPrevented||eh(d,!0)}},0)}else{const H=$.target;H&&z.contains(H)||t("focusout",$)}};async function F(){await oo();const $=y(i);if($){Pk.push(_);const z=$.contains(document.activeElement)?s:document.activeElement;if(s=z,!$.contains(z)){const U=new Event(ww,Ek);$.addEventListener(ww,S),$.dispatchEvent(U),U.defaultPrevented||oo(()=>{let ie=e.focusStartEl;Zn(ie)||(eh(ie),document.activeElement!==ie&&(ie="first")),ie==="first"&&$9(fL($),!0),(document.activeElement===z||ie==="container")&&eh($)})}}}function B(){const $=y(i);if($){$.removeEventListener(ww,S);const z=new CustomEvent(Sw,{...Ek,detail:{focusReason:g.value}});$.addEventListener(Sw,E),$.dispatchEvent(z),!z.defaultPrevented&&(g.value=="keyboard"||!V9()||$.contains(document.activeElement))&&eh(s??document.body),$.removeEventListener(Sw,E),Pk.remove(_)}}return No(()=>{e.trapped&&F(),tn(()=>e.trapped,$=>{$?F():B()})}),ni(()=>{e.trapped&&B(),i.value&&(i.value.removeEventListener("keydown",o),i.value.removeEventListener("focusin",I),i.value.removeEventListener("focusout",P),i.value=void 0)}),{onKeydown:o}}});function G9(e,t,i,s,d,g){return _t(e.$slots,"default",{handleKeydown:e.onKeydown})}var jm=bn(H9,[["render",G9],["__file","focus-trap.vue"]]),tl="top",nc="bottom",oc="right",nl="left",_T="auto",B_=[tl,nc,oc,nl],xm="start",d_="end",W9="clippingParents",pL="viewport",Av="popper",q9="reference",Lk=B_.reduce(function(e,t){return e.concat([t+"-"+xm,t+"-"+d_])},[]),dd=[].concat(B_,[_T]).reduce(function(e,t){return e.concat([t,t+"-"+xm,t+"-"+d_])},[]),K9="beforeRead",Z9="read",Y9="afterRead",X9="beforeMain",J9="main",Q9="afterMain",eq="beforeWrite",tq="write",nq="afterWrite",oq=[K9,Z9,Y9,X9,J9,Q9,eq,tq,nq];function Mu(e){return e?(e.nodeName||"").toLowerCase():null}function eu(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function wm(e){var t=eu(e).Element;return e instanceof t||e instanceof Element}function Ql(e){var t=eu(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function yT(e){if(typeof ShadowRoot>"u")return!1;var t=eu(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function rq(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var s=t.styles[i]||{},d=t.attributes[i]||{},g=t.elements[i];!Ql(g)||!Mu(g)||(Object.assign(g.style,s),Object.keys(d).forEach(function(_){var o=d[_];o===!1?g.removeAttribute(_):g.setAttribute(_,o===!0?"":o)}))})}function iq(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(s){var d=t.elements[s],g=t.attributes[s]||{},_=Object.keys(t.styles.hasOwnProperty(s)?t.styles[s]:i[s]),o=_.reduce(function(S,E){return S[E]="",S},{});!Ql(d)||!Mu(d)||(Object.assign(d.style,o),Object.keys(g).forEach(function(S){d.removeAttribute(S)}))})}}var mL={name:"applyStyles",enabled:!0,phase:"write",fn:rq,effect:iq,requires:["computeStyles"]};function wu(e){return e.split("-")[0]}var Rf=Math.max,bb=Math.min,Sm=Math.round;function Tm(e,t){t===void 0&&(t=!1);var i=e.getBoundingClientRect(),s=1,d=1;if(Ql(e)&&t){var g=e.offsetHeight,_=e.offsetWidth;_>0&&(s=Sm(i.width)/_||1),g>0&&(d=Sm(i.height)/g||1)}return{width:i.width/s,height:i.height/d,top:i.top/d,right:i.right/s,bottom:i.bottom/d,left:i.left/s,x:i.left/s,y:i.top/d}}function bT(e){var t=Tm(e),i=e.offsetWidth,s=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-s)<=1&&(s=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:s}}function gL(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&yT(i)){var s=t;do{if(s&&e.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function nd(e){return eu(e).getComputedStyle(e)}function aq(e){return["table","td","th"].indexOf(Mu(e))>=0}function kh(e){return((wm(e)?e.ownerDocument:e.document)||window.document).documentElement}function f1(e){return Mu(e)==="html"?e:e.assignedSlot||e.parentNode||(yT(e)?e.host:null)||kh(e)}function Dk(e){return!Ql(e)||nd(e).position==="fixed"?null:e.offsetParent}function sq(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,i=navigator.userAgent.indexOf("Trident")!==-1;if(i&&Ql(e)){var s=nd(e);if(s.position==="fixed")return null}var d=f1(e);for(yT(d)&&(d=d.host);Ql(d)&&["html","body"].indexOf(Mu(d))<0;){var g=nd(d);if(g.transform!=="none"||g.perspective!=="none"||g.contain==="paint"||["transform","perspective"].indexOf(g.willChange)!==-1||t&&g.willChange==="filter"||t&&g.filter&&g.filter!=="none")return d;d=d.parentNode}return null}function N_(e){for(var t=eu(e),i=Dk(e);i&&aq(i)&&nd(i).position==="static";)i=Dk(i);return i&&(Mu(i)==="html"||Mu(i)==="body"&&nd(i).position==="static")?t:i||sq(e)||t}function xT(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Wv(e,t,i){return Rf(e,bb(t,i))}function lq(e,t,i){var s=Wv(e,t,i);return s>i?i:s}function vL(){return{top:0,right:0,bottom:0,left:0}}function _L(e){return Object.assign({},vL(),e)}function yL(e,t){return t.reduce(function(i,s){return i[s]=e,i},{})}var cq=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,_L(typeof e!="number"?e:yL(e,B_))};function uq(e){var t,i=e.state,s=e.name,d=e.options,g=i.elements.arrow,_=i.modifiersData.popperOffsets,o=wu(i.placement),S=xT(o),E=[nl,oc].indexOf(o)>=0,I=E?"height":"width";if(!(!g||!_)){var P=cq(d.padding,i),F=bT(g),B=S==="y"?tl:nl,$=S==="y"?nc:oc,z=i.rects.reference[I]+i.rects.reference[S]-_[S]-i.rects.popper[I],H=_[S]-i.rects.reference[S],U=N_(g),ie=U?S==="y"?U.clientHeight||0:U.clientWidth||0:0,Z=z/2-H/2,G=P[B],Q=ie-F[I]-P[$],oe=ie/2-F[I]/2+Z,le=Wv(G,oe,Q),me=S;i.modifiersData[s]=(t={},t[me]=le,t.centerOffset=le-oe,t)}}function dq(e){var t=e.state,i=e.options,s=i.element,d=s===void 0?"[data-popper-arrow]":s;d!=null&&(typeof d=="string"&&(d=t.elements.popper.querySelector(d),!d)||!gL(t.elements.popper,d)||(t.elements.arrow=d))}var hq={name:"arrow",enabled:!0,phase:"main",fn:uq,effect:dq,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Cm(e){return e.split("-")[1]}var fq={top:"auto",right:"auto",bottom:"auto",left:"auto"};function pq(e){var t=e.x,i=e.y,s=window,d=s.devicePixelRatio||1;return{x:Sm(t*d)/d||0,y:Sm(i*d)/d||0}}function zk(e){var t,i=e.popper,s=e.popperRect,d=e.placement,g=e.variation,_=e.offsets,o=e.position,S=e.gpuAcceleration,E=e.adaptive,I=e.roundOffsets,P=e.isFixed,F=_.x,B=F===void 0?0:F,$=_.y,z=$===void 0?0:$,H=typeof I=="function"?I({x:B,y:z}):{x:B,y:z};B=H.x,z=H.y;var U=_.hasOwnProperty("x"),ie=_.hasOwnProperty("y"),Z=nl,G=tl,Q=window;if(E){var oe=N_(i),le="clientHeight",me="clientWidth";if(oe===eu(i)&&(oe=kh(i),nd(oe).position!=="static"&&o==="absolute"&&(le="scrollHeight",me="scrollWidth")),oe=oe,d===tl||(d===nl||d===oc)&&g===d_){G=nc;var fe=P&&oe===Q&&Q.visualViewport?Q.visualViewport.height:oe[le];z-=fe-s.height,z*=S?1:-1}if(d===nl||(d===tl||d===nc)&&g===d_){Z=oc;var ce=P&&oe===Q&&Q.visualViewport?Q.visualViewport.width:oe[me];B-=ce-s.width,B*=S?1:-1}}var pe=Object.assign({position:o},E&&fq),ye=I===!0?pq({x:B,y:z}):{x:B,y:z};if(B=ye.x,z=ye.y,S){var De;return Object.assign({},pe,(De={},De[G]=ie?"0":"",De[Z]=U?"0":"",De.transform=(Q.devicePixelRatio||1)<=1?"translate("+B+"px, "+z+"px)":"translate3d("+B+"px, "+z+"px, 0)",De))}return Object.assign({},pe,(t={},t[G]=ie?z+"px":"",t[Z]=U?B+"px":"",t.transform="",t))}function mq(e){var t=e.state,i=e.options,s=i.gpuAcceleration,d=s===void 0?!0:s,g=i.adaptive,_=g===void 0?!0:g,o=i.roundOffsets,S=o===void 0?!0:o,E={placement:wu(t.placement),variation:Cm(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:d,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,zk(Object.assign({},E,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:_,roundOffsets:S})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,zk(Object.assign({},E,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:S})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var bL={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:mq,data:{}},M0={passive:!0};function gq(e){var t=e.state,i=e.instance,s=e.options,d=s.scroll,g=d===void 0?!0:d,_=s.resize,o=_===void 0?!0:_,S=eu(t.elements.popper),E=[].concat(t.scrollParents.reference,t.scrollParents.popper);return g&&E.forEach(function(I){I.addEventListener("scroll",i.update,M0)}),o&&S.addEventListener("resize",i.update,M0),function(){g&&E.forEach(function(I){I.removeEventListener("scroll",i.update,M0)}),o&&S.removeEventListener("resize",i.update,M0)}}var xL={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:gq,data:{}},vq={left:"right",right:"left",bottom:"top",top:"bottom"};function W0(e){return e.replace(/left|right|bottom|top/g,function(t){return vq[t]})}var _q={start:"end",end:"start"};function Fk(e){return e.replace(/start|end/g,function(t){return _q[t]})}function wT(e){var t=eu(e),i=t.pageXOffset,s=t.pageYOffset;return{scrollLeft:i,scrollTop:s}}function ST(e){return Tm(kh(e)).left+wT(e).scrollLeft}function yq(e){var t=eu(e),i=kh(e),s=t.visualViewport,d=i.clientWidth,g=i.clientHeight,_=0,o=0;return s&&(d=s.width,g=s.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(_=s.offsetLeft,o=s.offsetTop)),{width:d,height:g,x:_+ST(e),y:o}}function bq(e){var t,i=kh(e),s=wT(e),d=(t=e.ownerDocument)==null?void 0:t.body,g=Rf(i.scrollWidth,i.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),_=Rf(i.scrollHeight,i.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),o=-s.scrollLeft+ST(e),S=-s.scrollTop;return nd(d||i).direction==="rtl"&&(o+=Rf(i.clientWidth,d?d.clientWidth:0)-g),{width:g,height:_,x:o,y:S}}function TT(e){var t=nd(e),i=t.overflow,s=t.overflowX,d=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+d+s)}function wL(e){return["html","body","#document"].indexOf(Mu(e))>=0?e.ownerDocument.body:Ql(e)&&TT(e)?e:wL(f1(e))}function qv(e,t){var i;t===void 0&&(t=[]);var s=wL(e),d=s===((i=e.ownerDocument)==null?void 0:i.body),g=eu(s),_=d?[g].concat(g.visualViewport||[],TT(s)?s:[]):s,o=t.concat(_);return d?o:o.concat(qv(f1(_)))}function g2(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function xq(e){var t=Tm(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function Bk(e,t){return t===pL?g2(yq(e)):wm(t)?xq(t):g2(bq(kh(e)))}function wq(e){var t=qv(f1(e)),i=["absolute","fixed"].indexOf(nd(e).position)>=0,s=i&&Ql(e)?N_(e):e;return wm(s)?t.filter(function(d){return wm(d)&&gL(d,s)&&Mu(d)!=="body"}):[]}function Sq(e,t,i){var s=t==="clippingParents"?wq(e):[].concat(t),d=[].concat(s,[i]),g=d[0],_=d.reduce(function(o,S){var E=Bk(e,S);return o.top=Rf(E.top,o.top),o.right=bb(E.right,o.right),o.bottom=bb(E.bottom,o.bottom),o.left=Rf(E.left,o.left),o},Bk(e,g));return _.width=_.right-_.left,_.height=_.bottom-_.top,_.x=_.left,_.y=_.top,_}function SL(e){var t=e.reference,i=e.element,s=e.placement,d=s?wu(s):null,g=s?Cm(s):null,_=t.x+t.width/2-i.width/2,o=t.y+t.height/2-i.height/2,S;switch(d){case tl:S={x:_,y:t.y-i.height};break;case nc:S={x:_,y:t.y+t.height};break;case oc:S={x:t.x+t.width,y:o};break;case nl:S={x:t.x-i.width,y:o};break;default:S={x:t.x,y:t.y}}var E=d?xT(d):null;if(E!=null){var I=E==="y"?"height":"width";switch(g){case xm:S[E]=S[E]-(t[I]/2-i[I]/2);break;case d_:S[E]=S[E]+(t[I]/2-i[I]/2);break}}return S}function h_(e,t){t===void 0&&(t={});var i=t,s=i.placement,d=s===void 0?e.placement:s,g=i.boundary,_=g===void 0?W9:g,o=i.rootBoundary,S=o===void 0?pL:o,E=i.elementContext,I=E===void 0?Av:E,P=i.altBoundary,F=P===void 0?!1:P,B=i.padding,$=B===void 0?0:B,z=_L(typeof $!="number"?$:yL($,B_)),H=I===Av?q9:Av,U=e.rects.popper,ie=e.elements[F?H:I],Z=Sq(wm(ie)?ie:ie.contextElement||kh(e.elements.popper),_,S),G=Tm(e.elements.reference),Q=SL({reference:G,element:U,placement:d}),oe=g2(Object.assign({},U,Q)),le=I===Av?oe:G,me={top:Z.top-le.top+z.top,bottom:le.bottom-Z.bottom+z.bottom,left:Z.left-le.left+z.left,right:le.right-Z.right+z.right},fe=e.modifiersData.offset;if(I===Av&&fe){var ce=fe[d];Object.keys(me).forEach(function(pe){var ye=[oc,nc].indexOf(pe)>=0?1:-1,De=[tl,nc].indexOf(pe)>=0?"y":"x";me[pe]+=ce[De]*ye})}return me}function Tq(e,t){t===void 0&&(t={});var i=t,s=i.placement,d=i.boundary,g=i.rootBoundary,_=i.padding,o=i.flipVariations,S=i.allowedAutoPlacements,E=S===void 0?dd:S,I=Cm(s),P=I?o?Lk:Lk.filter(function($){return Cm($)===I}):B_,F=P.filter(function($){return E.indexOf($)>=0});F.length===0&&(F=P);var B=F.reduce(function($,z){return $[z]=h_(e,{placement:z,boundary:d,rootBoundary:g,padding:_})[wu(z)],$},{});return Object.keys(B).sort(function($,z){return B[$]-B[z]})}function Cq(e){if(wu(e)===_T)return[];var t=W0(e);return[Fk(e),t,Fk(t)]}function Eq(e){var t=e.state,i=e.options,s=e.name;if(!t.modifiersData[s]._skip){for(var d=i.mainAxis,g=d===void 0?!0:d,_=i.altAxis,o=_===void 0?!0:_,S=i.fallbackPlacements,E=i.padding,I=i.boundary,P=i.rootBoundary,F=i.altBoundary,B=i.flipVariations,$=B===void 0?!0:B,z=i.allowedAutoPlacements,H=t.options.placement,U=wu(H),ie=U===H,Z=S||(ie||!$?[W0(H)]:Cq(H)),G=[H].concat(Z).reduce(function(Ct,Mt){return Ct.concat(wu(Mt)===_T?Tq(t,{placement:Mt,boundary:I,rootBoundary:P,padding:E,flipVariations:$,allowedAutoPlacements:z}):Mt)},[]),Q=t.rects.reference,oe=t.rects.popper,le=new Map,me=!0,fe=G[0],ce=0;ce<G.length;ce++){var pe=G[ce],ye=wu(pe),De=Cm(pe)===xm,tt=[tl,nc].indexOf(ye)>=0,Me=tt?"width":"height",xe=h_(t,{placement:pe,boundary:I,rootBoundary:P,altBoundary:F,padding:E}),Ae=tt?De?oc:nl:De?nc:tl;Q[Me]>oe[Me]&&(Ae=W0(Ae));var Ce=W0(Ae),ge=[];if(g&&ge.push(xe[ye]<=0),o&&ge.push(xe[Ae]<=0,xe[Ce]<=0),ge.every(function(Ct){return Ct})){fe=pe,me=!1;break}le.set(pe,ge)}if(me)for(var Ne=$?3:1,We=function(Ct){var Mt=G.find(function(zt){var bt=le.get(zt);if(bt)return bt.slice(0,Ct).every(function(Kt){return Kt})});if(Mt)return fe=Mt,"break"},ot=Ne;ot>0;ot--){var Oe=We(ot);if(Oe==="break")break}t.placement!==fe&&(t.modifiersData[s]._skip=!0,t.placement=fe,t.reset=!0)}}var Mq={name:"flip",enabled:!0,phase:"main",fn:Eq,requiresIfExists:["offset"],data:{_skip:!1}};function Nk(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function $k(e){return[tl,oc,nc,nl].some(function(t){return e[t]>=0})}function Iq(e){var t=e.state,i=e.name,s=t.rects.reference,d=t.rects.popper,g=t.modifiersData.preventOverflow,_=h_(t,{elementContext:"reference"}),o=h_(t,{altBoundary:!0}),S=Nk(_,s),E=Nk(o,d,g),I=$k(S),P=$k(E);t.modifiersData[i]={referenceClippingOffsets:S,popperEscapeOffsets:E,isReferenceHidden:I,hasPopperEscaped:P},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":I,"data-popper-escaped":P})}var Aq={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Iq};function kq(e,t,i){var s=wu(e),d=[nl,tl].indexOf(s)>=0?-1:1,g=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,_=g[0],o=g[1];return _=_||0,o=(o||0)*d,[nl,oc].indexOf(s)>=0?{x:o,y:_}:{x:_,y:o}}function Pq(e){var t=e.state,i=e.options,s=e.name,d=i.offset,g=d===void 0?[0,0]:d,_=dd.reduce(function(I,P){return I[P]=kq(P,t.rects,g),I},{}),o=_[t.placement],S=o.x,E=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=S,t.modifiersData.popperOffsets.y+=E),t.modifiersData[s]=_}var Rq={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Pq};function Oq(e){var t=e.state,i=e.name;t.modifiersData[i]=SL({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}var TL={name:"popperOffsets",enabled:!0,phase:"read",fn:Oq,data:{}};function Lq(e){return e==="x"?"y":"x"}function Dq(e){var t=e.state,i=e.options,s=e.name,d=i.mainAxis,g=d===void 0?!0:d,_=i.altAxis,o=_===void 0?!1:_,S=i.boundary,E=i.rootBoundary,I=i.altBoundary,P=i.padding,F=i.tether,B=F===void 0?!0:F,$=i.tetherOffset,z=$===void 0?0:$,H=h_(t,{boundary:S,rootBoundary:E,padding:P,altBoundary:I}),U=wu(t.placement),ie=Cm(t.placement),Z=!ie,G=xT(U),Q=Lq(G),oe=t.modifiersData.popperOffsets,le=t.rects.reference,me=t.rects.popper,fe=typeof z=="function"?z(Object.assign({},t.rects,{placement:t.placement})):z,ce=typeof fe=="number"?{mainAxis:fe,altAxis:fe}:Object.assign({mainAxis:0,altAxis:0},fe),pe=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ye={x:0,y:0};if(oe){if(g){var De,tt=G==="y"?tl:nl,Me=G==="y"?nc:oc,xe=G==="y"?"height":"width",Ae=oe[G],Ce=Ae+H[tt],ge=Ae-H[Me],Ne=B?-me[xe]/2:0,We=ie===xm?le[xe]:me[xe],ot=ie===xm?-me[xe]:-le[xe],Oe=t.elements.arrow,Ct=B&&Oe?bT(Oe):{width:0,height:0},Mt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:vL(),zt=Mt[tt],bt=Mt[Me],Kt=Wv(0,le[xe],Ct[xe]),$t=Z?le[xe]/2-Ne-Kt-zt-ce.mainAxis:We-Kt-zt-ce.mainAxis,Re=Z?-le[xe]/2+Ne+Kt+bt+ce.mainAxis:ot+Kt+bt+ce.mainAxis,dn=t.elements.arrow&&N_(t.elements.arrow),At=dn?G==="y"?dn.clientTop||0:dn.clientLeft||0:0,Ke=(De=pe==null?void 0:pe[G])!=null?De:0,Be=Ae+$t-Ke-At,Ht=Ae+Re-Ke,Ut=Wv(B?bb(Ce,Be):Ce,Ae,B?Rf(ge,Ht):ge);oe[G]=Ut,ye[G]=Ut-Ae}if(o){var Nt,Et=G==="x"?tl:nl,Gt=G==="x"?nc:oc,ln=oe[Q],yn=Q==="y"?"height":"width",_n=ln+H[Et],jn=ln-H[Gt],yt=[tl,nl].indexOf(U)!==-1,kn=(Nt=pe==null?void 0:pe[Q])!=null?Nt:0,qn=yt?_n:ln-le[yn]-me[yn]-kn+ce.altAxis,Co=yt?ln+le[yn]+me[yn]-kn-ce.altAxis:jn,mo=B&&yt?lq(qn,ln,Co):Wv(B?qn:_n,ln,B?Co:jn);oe[Q]=mo,ye[Q]=mo-ln}t.modifiersData[s]=ye}}var zq={name:"preventOverflow",enabled:!0,phase:"main",fn:Dq,requiresIfExists:["offset"]};function Fq(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Bq(e){return e===eu(e)||!Ql(e)?wT(e):Fq(e)}function Nq(e){var t=e.getBoundingClientRect(),i=Sm(t.width)/e.offsetWidth||1,s=Sm(t.height)/e.offsetHeight||1;return i!==1||s!==1}function $q(e,t,i){i===void 0&&(i=!1);var s=Ql(t),d=Ql(t)&&Nq(t),g=kh(t),_=Tm(e,d),o={scrollLeft:0,scrollTop:0},S={x:0,y:0};return(s||!s&&!i)&&((Mu(t)!=="body"||TT(g))&&(o=Bq(t)),Ql(t)?(S=Tm(t,!0),S.x+=t.clientLeft,S.y+=t.clientTop):g&&(S.x=ST(g))),{x:_.left+o.scrollLeft-S.x,y:_.top+o.scrollTop-S.y,width:_.width,height:_.height}}function Vq(e){var t=new Map,i=new Set,s=[];e.forEach(function(g){t.set(g.name,g)});function d(g){i.add(g.name);var _=[].concat(g.requires||[],g.requiresIfExists||[]);_.forEach(function(o){if(!i.has(o)){var S=t.get(o);S&&d(S)}}),s.push(g)}return e.forEach(function(g){i.has(g.name)||d(g)}),s}function Uq(e){var t=Vq(e);return oq.reduce(function(i,s){return i.concat(t.filter(function(d){return d.phase===s}))},[])}function jq(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function Hq(e){var t=e.reduce(function(i,s){var d=i[s.name];return i[s.name]=d?Object.assign({},d,s,{options:Object.assign({},d.options,s.options),data:Object.assign({},d.data,s.data)}):s,i},{});return Object.keys(t).map(function(i){return t[i]})}var Vk={placement:"bottom",modifiers:[],strategy:"absolute"};function Uk(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function CT(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,s=i===void 0?[]:i,d=t.defaultOptions,g=d===void 0?Vk:d;return function(_,o,S){S===void 0&&(S=g);var E={placement:"bottom",orderedModifiers:[],options:Object.assign({},Vk,g),modifiersData:{},elements:{reference:_,popper:o},attributes:{},styles:{}},I=[],P=!1,F={state:E,setOptions:function(z){var H=typeof z=="function"?z(E.options):z;$(),E.options=Object.assign({},g,E.options,H),E.scrollParents={reference:wm(_)?qv(_):_.contextElement?qv(_.contextElement):[],popper:qv(o)};var U=Uq(Hq([].concat(s,E.options.modifiers)));return E.orderedModifiers=U.filter(function(ie){return ie.enabled}),B(),F.update()},forceUpdate:function(){if(!P){var z=E.elements,H=z.reference,U=z.popper;if(Uk(H,U)){E.rects={reference:$q(H,N_(U),E.options.strategy==="fixed"),popper:bT(U)},E.reset=!1,E.placement=E.options.placement,E.orderedModifiers.forEach(function(me){return E.modifiersData[me.name]=Object.assign({},me.data)});for(var ie=0;ie<E.orderedModifiers.length;ie++){if(E.reset===!0){E.reset=!1,ie=-1;continue}var Z=E.orderedModifiers[ie],G=Z.fn,Q=Z.options,oe=Q===void 0?{}:Q,le=Z.name;typeof G=="function"&&(E=G({state:E,options:oe,name:le,instance:F})||E)}}}},update:jq(function(){return new Promise(function(z){F.forceUpdate(),z(E)})}),destroy:function(){$(),P=!0}};if(!Uk(_,o))return F;F.setOptions(S).then(function(z){!P&&S.onFirstUpdate&&S.onFirstUpdate(z)});function B(){E.orderedModifiers.forEach(function(z){var H=z.name,U=z.options,ie=U===void 0?{}:U,Z=z.effect;if(typeof Z=="function"){var G=Z({state:E,name:H,instance:F,options:ie}),Q=function(){};I.push(G||Q)}})}function $(){I.forEach(function(z){return z()}),I=[]}return F}}CT();var Gq=[xL,TL,bL,mL];CT({defaultModifiers:Gq});var Wq=[xL,TL,bL,mL,Rq,Mq,zq,hq,Aq],qq=CT({defaultModifiers:Wq});const Kq=["fixed","absolute"],Zq=vn({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:ut(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:dd,default:"bottom"},popperOptions:{type:ut(Object),default:()=>({})},strategy:{type:String,values:Kq,default:"absolute"}}),CL=vn({...Zq,id:String,style:{type:ut([String,Array,Object])},className:{type:ut([String,Array,Object])},effect:{type:ut(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:ut([String,Array,Object])},popperStyle:{type:ut([String,Array,Object])},referenceEl:{type:ut(Object)},triggerTargetEl:{type:ut(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...Da(["ariaLabel"])}),Yq={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},Xq=(e,t)=>{const i=Se(!1),s=Se();return{focusStartRef:s,trapped:i,onFocusAfterReleased:E=>{var I;((I=E.detail)==null?void 0:I.focusReason)!=="pointer"&&(s.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:E=>{e.visible&&!i.value&&(E.target&&(s.value=E.target),i.value=!0)},onFocusoutPrevented:E=>{e.trapping||(E.detail.focusReason==="pointer"&&E.preventDefault(),i.value=!1)},onReleaseRequested:()=>{i.value=!1,t("close")}}},Jq=(e,t=[])=>{const{placement:i,strategy:s,popperOptions:d}=e,g={placement:i,strategy:s,...d,modifiers:[...e7(e),...t]};return t7(g,d==null?void 0:d.modifiers),g},Qq=e=>{if(gr)return Os(e)};function e7(e){const{offset:t,gpuAcceleration:i,fallbackPlacements:s}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:s}},{name:"computeStyles",options:{gpuAcceleration:i}}]}function t7(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const n7=(e,t,i={})=>{const s={name:"updateState",enabled:!0,phase:"write",fn:({state:S})=>{const E=o7(S);Object.assign(_.value,E)},requires:["computeStyles"]},d=te(()=>{const{onFirstUpdate:S,placement:E,strategy:I,modifiers:P}=y(i);return{onFirstUpdate:S,placement:E||"bottom",strategy:I||"absolute",modifiers:[...P||[],s,{name:"applyStyles",enabled:!1}]}}),g=gi(),_=Se({styles:{popper:{position:y(d).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),o=()=>{g.value&&(g.value.destroy(),g.value=void 0)};return tn(d,S=>{const E=y(g);E&&E.setOptions(S)},{deep:!0}),tn([e,t],([S,E])=>{o(),!(!S||!E)&&(g.value=qq(S,E,y(d)))}),ni(()=>{o()}),{state:te(()=>{var S;return{...((S=y(g))==null?void 0:S.state)||{}}}),styles:te(()=>y(_).styles),attributes:te(()=>y(_).attributes),update:()=>{var S;return(S=y(g))==null?void 0:S.update()},forceUpdate:()=>{var S;return(S=y(g))==null?void 0:S.forceUpdate()},instanceRef:te(()=>y(g))}};function o7(e){const t=Object.keys(e.elements),i=u_(t.map(d=>[d,e.styles[d]||{}])),s=u_(t.map(d=>[d,e.attributes[d]]));return{styles:i,attributes:s}}const r7=0,i7=e=>{const{popperInstanceRef:t,contentRef:i,triggerRef:s,role:d}=Un(pT,void 0),g=Se(),_=Se(),o=te(()=>({name:"eventListeners",enabled:!!e.visible})),S=te(()=>{var U;const ie=y(g),Z=(U=y(_))!=null?U:r7;return{name:"arrow",enabled:!kO(ie),options:{element:ie,padding:Z}}}),E=te(()=>({onFirstUpdate:()=>{$()},...Jq(e,[y(S),y(o)])})),I=te(()=>Qq(e.referenceEl)||y(s)),{attributes:P,state:F,styles:B,update:$,forceUpdate:z,instanceRef:H}=n7(I,i,E);return tn(H,U=>t.value=U),No(()=>{tn(()=>{var U;return(U=y(I))==null?void 0:U.getBoundingClientRect()},()=>{$()})}),{attributes:P,arrowRef:g,contentRef:i,instanceRef:H,state:F,styles:B,role:d,forceUpdate:z,update:$}},a7=(e,{attributes:t,styles:i,role:s})=>{const{nextZIndex:d}=Vm(),g=rn("popper"),_=te(()=>y(t).popper),o=Se(ao(e.zIndex)?e.zIndex:d()),S=te(()=>[g.b(),g.is("pure",e.pure),g.is(e.effect),e.popperClass]),E=te(()=>[{zIndex:y(o)},y(i).popper,e.popperStyle||{}]),I=te(()=>s.value==="dialog"?"false":void 0),P=te(()=>y(i).arrow||{});return{ariaModal:I,arrowStyle:P,contentAttrs:_,contentClass:S,contentStyle:E,contentZIndex:o,updateZIndex:()=>{o.value=ao(e.zIndex)?e.zIndex:d()}}},s7=Ze({name:"ElPopperContent"}),l7=Ze({...s7,props:CL,emits:Yq,setup(e,{expose:t,emit:i}){const s=e,{focusStartRef:d,trapped:g,onFocusAfterReleased:_,onFocusAfterTrapped:o,onFocusInTrap:S,onFocusoutPrevented:E,onReleaseRequested:I}=Xq(s,i),{attributes:P,arrowRef:F,contentRef:B,styles:$,instanceRef:z,role:H,update:U}=i7(s),{ariaModal:ie,arrowStyle:Z,contentAttrs:G,contentClass:Q,contentStyle:oe,updateZIndex:le}=a7(s,{styles:$,attributes:P,role:H}),me=Un(Eu,void 0),fe=Se();or(rL,{arrowStyle:Z,arrowRef:F,arrowOffset:fe}),me&&or(Eu,{...me,addInputId:jr,removeInputId:jr});let ce;const pe=(De=!0)=>{U(),De&&le()},ye=()=>{pe(!1),s.visible&&s.focusOnShow?g.value=!0:s.visible===!1&&(g.value=!1)};return No(()=>{tn(()=>s.triggerTargetEl,(De,tt)=>{ce==null||ce(),ce=void 0;const Me=y(De||B.value),xe=y(tt||B.value);Tl(Me)&&(ce=tn([H,()=>s.ariaLabel,ie,()=>s.id],Ae=>{["role","aria-label","aria-modal","id"].forEach((Ce,ge)=>{ga(Ae[ge])?Me.removeAttribute(Ce):Me.setAttribute(Ce,Ae[ge])})},{immediate:!0})),xe!==Me&&Tl(xe)&&["role","aria-label","aria-modal","id"].forEach(Ae=>{xe.removeAttribute(Ae)})},{immediate:!0}),tn(()=>s.visible,ye,{immediate:!0})}),ni(()=>{ce==null||ce(),ce=void 0}),t({popperContentRef:B,popperInstanceRef:z,updatePopper:pe,contentStyle:oe}),(De,tt)=>(se(),Pe("div",Yo({ref_key:"contentRef",ref:B},y(G),{style:y(oe),class:y(Q),tabindex:"-1",onMouseenter:Me=>De.$emit("mouseenter",Me),onMouseleave:Me=>De.$emit("mouseleave",Me)}),[Qe(y(jm),{trapped:y(g),"trap-on-focus-in":!0,"focus-trap-el":y(B),"focus-start-el":y(d),onFocusAfterTrapped:y(o),onFocusAfterReleased:y(_),onFocusin:y(S),onFocusoutPrevented:y(E),onReleaseRequested:y(I)},{default:at(()=>[_t(De.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var c7=bn(l7,[["__file","content.vue"]]);const EL=Ao(w9),p1=Symbol("elTooltip");function jk(){let e;const t=(s,d)=>{i(),e=window.setTimeout(s,d)},i=()=>window.clearTimeout(e);return L_(()=>i()),{registerTimeout:t,cancelTimeout:i}}const u7=vn({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),d7=({showAfter:e,hideAfter:t,autoClose:i,open:s,close:d})=>{const{registerTimeout:g}=jk(),{registerTimeout:_,cancelTimeout:o}=jk();return{onOpen:I=>{g(()=>{s(I);const P=y(i);ao(P)&&P>0&&_(()=>{d(I)},P)},y(e))},onClose:I=>{o(),g(()=>{d(I)},y(t))}}},wa=vn({...u7,...CL,appendTo:{type:ut([String,Object])},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:ut(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...Da(["ariaLabel"])}),f_=vn({...sL,disabled:Boolean,trigger:{type:ut([String,Array]),default:"hover"},triggerKeys:{type:ut(Array),default:()=>[On.enter,On.numpadEnter,On.space]}}),h7=Qc({type:ut(Boolean),default:null}),f7=Qc({type:ut(Function)}),p7=e=>{const t=`update:${e}`,i=`onUpdate:${e}`,s=[t],d={[e]:h7,[i]:f7};return{useModelToggle:({indicator:_,toggleReason:o,shouldHideWhenRouteChanges:S,shouldProceed:E,onShow:I,onHide:P})=>{const F=jo(),{emit:B}=F,$=F.props,z=te(()=>Qn($[i])),H=te(()=>$[e]===null),U=le=>{_.value!==!0&&(_.value=!0,o&&(o.value=le),Qn(I)&&I(le))},ie=le=>{_.value!==!1&&(_.value=!1,o&&(o.value=le),Qn(P)&&P(le))},Z=le=>{if($.disabled===!0||Qn(E)&&!E())return;const me=z.value&&gr;me&&B(t,!0),(H.value||!me)&&U(le)},G=le=>{if($.disabled===!0||!gr)return;const me=z.value&&gr;me&&B(t,!1),(H.value||!me)&&ie(le)},Q=le=>{ai(le)&&($.disabled&&le?z.value&&B(t,!1):_.value!==le&&(le?U():ie()))},oe=()=>{_.value?G():Z()};return tn(()=>$[e],Q),S&&F.appContext.config.globalProperties.$route!==void 0&&tn(()=>({...F.proxy.$route}),()=>{S.value&&_.value&&G()}),No(()=>{Q($[e])}),{hide:G,show:Z,toggle:oe,hasUpdateHandler:z}},useModelToggleProps:d,useModelToggleEmits:s}},{useModelToggleProps:m7,useModelToggleEmits:g7,useModelToggle:v7}=p7("visible"),_7=vn({...iL,...m7,...wa,...f_,...aL,showArrow:{type:Boolean,default:!0}}),y7=[...g7,"before-show","before-hide","show","hide","open","close"],b7=(e,t)=>fn(e)?e.includes(t):e===t,Hp=(e,t,i)=>s=>{b7(y(e),t)&&i(s)},Ui=(e,t,{checkForDefaultPrevented:i=!0}={})=>d=>{const g=e==null?void 0:e(d);if(i===!1||!g)return t==null?void 0:t(d)},Hk=e=>t=>t.pointerType==="mouse"?e(t):void 0,x7=Ze({name:"ElTooltipTrigger"}),w7=Ze({...x7,props:f_,setup(e,{expose:t}){const i=e,s=rn("tooltip"),{controlled:d,id:g,open:_,onOpen:o,onClose:S,onToggle:E}=Un(p1,void 0),I=Se(null),P=()=>{if(y(d)||i.disabled)return!0},F=Vr(i,"trigger"),B=Ui(P,Hp(F,"hover",o)),$=Ui(P,Hp(F,"hover",S)),z=Ui(P,Hp(F,"click",G=>{G.button===0&&E(G)})),H=Ui(P,Hp(F,"focus",o)),U=Ui(P,Hp(F,"focus",S)),ie=Ui(P,Hp(F,"contextmenu",G=>{G.preventDefault(),E(G)})),Z=Ui(P,G=>{const{code:Q}=G;i.triggerKeys.includes(Q)&&(G.preventDefault(),E(G))});return t({triggerRef:I}),(G,Q)=>(se(),Rt(y(O9),{id:y(g),"virtual-ref":G.virtualRef,open:y(_),"virtual-triggering":G.virtualTriggering,class:de(y(s).e("trigger")),onBlur:y(U),onClick:y(z),onContextmenu:y(ie),onFocus:y(H),onMouseenter:y(B),onMouseleave:y($),onKeydown:y(Z)},{default:at(()=>[_t(G.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var S7=bn(w7,[["__file","trigger.vue"]]);const T7=vn({to:{type:ut([String,Object]),required:!0},disabled:Boolean}),C7=Ze({__name:"teleport",props:T7,setup(e){return(t,i)=>t.disabled?_t(t.$slots,"default",{key:0}):(se(),Rt(y5,{key:1,to:t.to},[_t(t.$slots,"default")],8,["to"]))}});var E7=bn(C7,[["__file","teleport.vue"]]);const Hm=Ao(E7),ML=()=>{const e=BS(),t=hT(),i=te(()=>`${e.value}-popper-container-${t.prefix}`),s=te(()=>`#${i.value}`);return{id:i,selector:s}},M7=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},I7=()=>{const{id:e,selector:t}=ML();return qb(()=>{gr&&(document.body.querySelector(t.value)||M7(e.value))}),{id:e,selector:t}},A7=Ze({name:"ElTooltipContent",inheritAttrs:!1}),k7=Ze({...A7,props:wa,setup(e,{expose:t}){const i=e,{selector:s}=ML(),d=rn("tooltip"),g=Se();let _;const{controlled:o,id:S,open:E,trigger:I,onClose:P,onOpen:F,onShow:B,onHide:$,onBeforeShow:z,onBeforeHide:H}=Un(p1,void 0),U=te(()=>i.transition||`${d.namespace.value}-fade-in-linear`),ie=te(()=>i.persistent);ni(()=>{_==null||_()});const Z=te(()=>y(ie)?!0:y(E)),G=te(()=>i.disabled?!1:y(E)),Q=te(()=>i.appendTo||s.value),oe=te(()=>{var xe;return(xe=i.style)!=null?xe:{}}),le=Se(!0),me=()=>{$(),le.value=!0},fe=()=>{if(y(o))return!0},ce=Ui(fe,()=>{i.enterable&&y(I)==="hover"&&F()}),pe=Ui(fe,()=>{y(I)==="hover"&&P()}),ye=()=>{var xe,Ae;(Ae=(xe=g.value)==null?void 0:xe.updatePopper)==null||Ae.call(xe),z==null||z()},De=()=>{H==null||H()},tt=()=>{B(),_=tT(te(()=>{var xe;return(xe=g.value)==null?void 0:xe.popperContentRef}),()=>{if(y(o))return;y(I)!=="hover"&&P()})},Me=()=>{i.virtualTriggering||P()};return tn(()=>y(E),xe=>{xe?le.value=!1:_==null||_()},{flush:"post"}),tn(()=>i.content,()=>{var xe,Ae;(Ae=(xe=g.value)==null?void 0:xe.updatePopper)==null||Ae.call(xe)}),t({contentRef:g}),(xe,Ae)=>(se(),Rt(y(Hm),{disabled:!xe.teleported,to:y(Q)},{default:at(()=>[Qe(Ea,{name:y(U),onAfterLeave:me,onBeforeEnter:ye,onAfterEnter:tt,onBeforeLeave:De},{default:at(()=>[y(Z)?zo((se(),Rt(y(c7),Yo({key:0,id:y(S),ref_key:"contentRef",ref:g},xe.$attrs,{"aria-label":xe.ariaLabel,"aria-hidden":le.value,"boundaries-padding":xe.boundariesPadding,"fallback-placements":xe.fallbackPlacements,"gpu-acceleration":xe.gpuAcceleration,offset:xe.offset,placement:xe.placement,"popper-options":xe.popperOptions,strategy:xe.strategy,effect:xe.effect,enterable:xe.enterable,pure:xe.pure,"popper-class":xe.popperClass,"popper-style":[xe.popperStyle,y(oe)],"reference-el":xe.referenceEl,"trigger-target-el":xe.triggerTargetEl,visible:y(G),"z-index":xe.zIndex,onMouseenter:y(ce),onMouseleave:y(pe),onBlur:Me,onClose:y(P)}),{default:at(()=>[_t(xe.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Cr,y(G)]]):St("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var P7=bn(k7,[["__file","content.vue"]]);const R7=Ze({name:"ElTooltip"}),O7=Ze({...R7,props:_7,emits:y7,setup(e,{expose:t,emit:i}){const s=e;I7();const d=La(),g=Se(),_=Se(),o=()=>{var U;const ie=y(g);ie&&((U=ie.popperInstanceRef)==null||U.update())},S=Se(!1),E=Se(),{show:I,hide:P,hasUpdateHandler:F}=v7({indicator:S,toggleReason:E}),{onOpen:B,onClose:$}=d7({showAfter:Vr(s,"showAfter"),hideAfter:Vr(s,"hideAfter"),autoClose:Vr(s,"autoClose"),open:I,close:P}),z=te(()=>ai(s.visible)&&!F.value);or(p1,{controlled:z,id:d,open:Dm(S),trigger:Vr(s,"trigger"),onOpen:U=>{B(U)},onClose:U=>{$(U)},onToggle:U=>{y(S)?$(U):B(U)},onShow:()=>{i("show",E.value)},onHide:()=>{i("hide",E.value)},onBeforeShow:()=>{i("before-show",E.value)},onBeforeHide:()=>{i("before-hide",E.value)},updatePopper:o}),tn(()=>s.disabled,U=>{U&&S.value&&(S.value=!1)});const H=U=>{var ie,Z;const G=(Z=(ie=_.value)==null?void 0:ie.contentRef)==null?void 0:Z.popperContentRef,Q=(U==null?void 0:U.relatedTarget)||document.activeElement;return G&&G.contains(Q)};return tR(()=>S.value&&P()),t({popperRef:g,contentRef:_,isFocusInsideContent:H,updatePopper:o,onOpen:B,onClose:$,hide:P}),(U,ie)=>(se(),Rt(y(EL),{ref_key:"popperRef",ref:g,role:U.role},{default:at(()=>[Qe(S7,{disabled:U.disabled,trigger:U.trigger,"trigger-keys":U.triggerKeys,"virtual-ref":U.virtualRef,"virtual-triggering":U.virtualTriggering},{default:at(()=>[U.$slots.default?_t(U.$slots,"default",{key:0}):St("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Qe(P7,{ref_key:"contentRef",ref:_,"aria-label":U.ariaLabel,"boundaries-padding":U.boundariesPadding,content:U.content,disabled:U.disabled,effect:U.effect,enterable:U.enterable,"fallback-placements":U.fallbackPlacements,"hide-after":U.hideAfter,"gpu-acceleration":U.gpuAcceleration,offset:U.offset,persistent:U.persistent,"popper-class":U.popperClass,"popper-style":U.popperStyle,placement:U.placement,"popper-options":U.popperOptions,pure:U.pure,"raw-content":U.rawContent,"reference-el":U.referenceEl,"trigger-target-el":U.triggerTargetEl,"show-after":U.showAfter,strategy:U.strategy,teleported:U.teleported,transition:U.transition,"virtual-triggering":U.virtualTriggering,"z-index":U.zIndex,"append-to":U.appendTo},{default:at(()=>[_t(U.$slots,"content",{},()=>[U.rawContent?(se(),Pe("span",{key:0,innerHTML:U.content},null,8,["innerHTML"])):(se(),Pe("span",{key:1},wn(U.content),1))]),U.showArrow?(se(),Rt(y(C9),{key:0,"arrow-offset":U.arrowOffset},null,8,["arrow-offset"])):St("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var L7=bn(O7,[["__file","tooltip.vue"]]);const qa=Ao(L7),D7=vn({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:ut(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:ut([Function,Array]),default:jr},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:wa.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...Da(["ariaLabel"])}),z7={[Fo]:e=>Zn(e),[Ga]:e=>Zn(e),[Yr]:e=>Zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>Vo(e)},IL="ElAutocomplete",F7=Ze({name:IL,inheritAttrs:!1}),B7=Ze({...F7,props:D7,emits:z7,setup(e,{expose:t,emit:i}){const s=e,d=z_(),g=Mh(),_=Za(),o=rn("autocomplete"),S=Se(),E=Se(),I=Se(),P=Se();let F=!1,B=!1;const $=Se([]),z=Se(-1),H=Se(""),U=Se(!1),ie=Se(!1),Z=Se(!1),G=La(),Q=te(()=>g.style),oe=te(()=>($.value.length>0||Z.value)&&U.value),le=te(()=>!s.hideLoading&&Z.value),me=te(()=>S.value?Array.from(S.value.$el.querySelectorAll("input")):[]),fe=()=>{oe.value&&(H.value=`${S.value.$el.offsetWidth}px`)},ce=()=>{z.value=-1},pe=async bt=>{if(ie.value)return;const Kt=$t=>{Z.value=!1,!ie.value&&(fn($t)?($.value=$t,z.value=s.highlightFirstItem?0:-1):ha(IL,"autocomplete suggestions must be an array"))};if(Z.value=!0,fn(s.fetchSuggestions))Kt(s.fetchSuggestions);else{const $t=await s.fetchSuggestions(bt,Kt);fn($t)&&Kt($t)}},ye=ol(pe,s.debounce),De=bt=>{const Kt=!!bt;if(i(Ga,bt),i(Fo,bt),ie.value=!1,U.value||(U.value=Kt),!s.triggerOnFocus&&!bt){ie.value=!0,$.value=[];return}ye(bt)},tt=bt=>{var Kt;_.value||(((Kt=bt.target)==null?void 0:Kt.tagName)!=="INPUT"||me.value.includes(document.activeElement))&&(U.value=!0)},Me=bt=>{i(Yr,bt)},xe=bt=>{B?B=!1:(U.value=!0,i("focus",bt),s.triggerOnFocus&&!F&&ye(String(s.modelValue)))},Ae=bt=>{setTimeout(()=>{var Kt;if((Kt=I.value)!=null&&Kt.isFocusInsideContent()){B=!0;return}U.value&&We(),i("blur",bt)})},Ce=()=>{U.value=!1,i(Fo,""),i("clear")},ge=async()=>{oe.value&&z.value>=0&&z.value<$.value.length?Ct($.value[z.value]):s.selectWhenUnmatched&&(i("select",{value:s.modelValue}),$.value=[],z.value=-1)},Ne=bt=>{oe.value&&(bt.preventDefault(),bt.stopPropagation(),We())},We=()=>{U.value=!1},ot=()=>{var bt;(bt=S.value)==null||bt.focus()},Oe=()=>{var bt;(bt=S.value)==null||bt.blur()},Ct=async bt=>{i(Ga,bt[s.valueKey]),i(Fo,bt[s.valueKey]),i("select",bt),$.value=[],z.value=-1},Mt=bt=>{if(!oe.value||Z.value)return;if(bt<0){z.value=-1;return}bt>=$.value.length&&(bt=$.value.length-1);const Kt=E.value.querySelector(`.${o.be("suggestion","wrap")}`),Re=Kt.querySelectorAll(`.${o.be("suggestion","list")} li`)[bt],dn=Kt.scrollTop,{offsetTop:At,scrollHeight:Ke}=Re;At+Ke>dn+Kt.clientHeight&&(Kt.scrollTop+=Ke),At<dn&&(Kt.scrollTop-=Ke),z.value=bt,S.value.ref.setAttribute("aria-activedescendant",`${G.value}-item-${z.value}`)},zt=tT(P,()=>{oe.value&&We()});return ni(()=>{zt==null||zt()}),No(()=>{S.value.ref.setAttribute("role","textbox"),S.value.ref.setAttribute("aria-autocomplete","list"),S.value.ref.setAttribute("aria-controls","id"),S.value.ref.setAttribute("aria-activedescendant",`${G.value}-item-${z.value}`),F=S.value.ref.hasAttribute("readonly")}),t({highlightedIndex:z,activated:U,loading:Z,inputRef:S,popperRef:I,suggestions:$,handleSelect:Ct,handleKeyEnter:ge,focus:ot,blur:Oe,close:We,highlight:Mt,getData:pe}),(bt,Kt)=>(se(),Rt(y(qa),{ref_key:"popperRef",ref:I,visible:y(oe),placement:bt.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[y(o).e("popper"),bt.popperClass],teleported:bt.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${y(o).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:fe,onHide:ce},{content:at(()=>[He("div",{ref_key:"regionRef",ref:E,class:de([y(o).b("suggestion"),y(o).is("loading",y(le))]),style:to({[bt.fitInputWidth?"width":"minWidth"]:H.value,outline:"none"}),role:"region"},[Qe(y(Pu),{id:y(G),tag:"ul","wrap-class":y(o).be("suggestion","wrap"),"view-class":y(o).be("suggestion","list"),role:"listbox"},{default:at(()=>[y(le)?(se(),Pe("li",{key:0},[_t(bt.$slots,"loading",{},()=>[Qe(y(Gn),{class:de(y(o).is("loading"))},{default:at(()=>[Qe(y(Cu))]),_:1},8,["class"])])])):(se(!0),Pe(eo,{key:1},tr($.value,($t,Re)=>(se(),Pe("li",{id:`${y(G)}-item-${Re}`,key:Re,class:de({highlighted:z.value===Re}),role:"option","aria-selected":z.value===Re,onClick:dn=>Ct($t)},[_t(bt.$slots,"default",{item:$t},()=>[nr(wn($t[bt.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:at(()=>[He("div",{ref_key:"listboxRef",ref:P,class:de([y(o).b(),bt.$attrs.class]),style:to(y(Q)),role:"combobox","aria-haspopup":"listbox","aria-expanded":y(oe),"aria-owns":y(G)},[Qe(y(hs),Yo({ref_key:"inputRef",ref:S},y(d),{clearable:bt.clearable,disabled:y(_),name:bt.name,"model-value":bt.modelValue,"aria-label":bt.ariaLabel,onInput:De,onChange:Me,onFocus:xe,onBlur:Ae,onClear:Ce,onKeydown:[ti(po($t=>Mt(z.value-1),["prevent"]),["up"]),ti(po($t=>Mt(z.value+1),["prevent"]),["down"]),ti(ge,["enter"]),ti(We,["tab"]),ti(Ne,["esc"])],onMousedown:tt}),ec({_:2},[bt.$slots.prepend?{name:"prepend",fn:at(()=>[_t(bt.$slots,"prepend")])}:void 0,bt.$slots.append?{name:"append",fn:at(()=>[_t(bt.$slots,"append")])}:void 0,bt.$slots.prefix?{name:"prefix",fn:at(()=>[_t(bt.$slots,"prefix")])}:void 0,bt.$slots.suffix?{name:"suffix",fn:at(()=>[_t(bt.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var N7=bn(B7,[["__file","autocomplete.vue"]]);const $7=Ao(N7),V7=vn({size:{type:[Number,String],values:ku,default:"",validator:e=>ao(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:Xr},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:ut(String),default:"cover"}}),U7={error:e=>e instanceof Event},j7=Ze({name:"ElAvatar"}),H7=Ze({...j7,props:V7,emits:U7,setup(e,{emit:t}){const i=e,s=rn("avatar"),d=Se(!1),g=te(()=>{const{size:E,icon:I,shape:P}=i,F=[s.b()];return Zn(E)&&F.push(s.m(E)),I&&F.push(s.m("icon")),P&&F.push(s.m(P)),F}),_=te(()=>{const{size:E}=i;return ao(E)?s.cssVarBlock({size:ji(E)||""}):void 0}),o=te(()=>({objectFit:i.fit}));tn(()=>i.src,()=>d.value=!1);function S(E){d.value=!0,t("error",E)}return(E,I)=>(se(),Pe("span",{class:de(y(g)),style:to(y(_))},[(E.src||E.srcSet)&&!d.value?(se(),Pe("img",{key:0,src:E.src,alt:E.alt,srcset:E.srcSet,style:to(y(o)),onError:S},null,44,["src","alt","srcset"])):E.icon?(se(),Rt(y(Gn),{key:1},{default:at(()=>[(se(),Rt(Wo(E.icon)))]),_:1})):_t(E.$slots,"default",{key:2})],6))}});var G7=bn(H7,[["__file","avatar.vue"]]);const W7=Ao(G7),q7={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},K7={click:e=>e instanceof MouseEvent},Z7=(e,t,i)=>{const s=gi(),d=gi(),g=Se(!1),_=()=>{s.value&&(g.value=s.value.scrollTop>=e.visibilityHeight)},o=E=>{var I;(I=s.value)==null||I.scrollTo({top:0,behavior:"smooth"}),t("click",E)},S=LO(_,300,!0);return qr(d,"scroll",S),No(()=>{var E;d.value=document,s.value=document.documentElement,e.target&&(s.value=(E=document.querySelector(e.target))!=null?E:void 0,s.value||ha(i,`target does not exist: ${e.target}`),d.value=s.value),_()}),{visible:g,handleClick:o}},AL="ElBacktop",Y7=Ze({name:AL}),X7=Ze({...Y7,props:q7,emits:K7,setup(e,{emit:t}){const i=e,s=rn("backtop"),{handleClick:d,visible:g}=Z7(i,t,AL),_=te(()=>({right:`${i.right}px`,bottom:`${i.bottom}px`}));return(o,S)=>(se(),Rt(Ea,{name:`${y(s).namespace.value}-fade-in`},{default:at(()=>[y(g)?(se(),Pe("div",{key:0,style:to(y(_)),class:de(y(s).b()),onClick:po(y(d),["stop"])},[_t(o.$slots,"default",{},()=>[Qe(y(Gn),{class:de(y(s).e("icon"))},{default:at(()=>[Qe(y(VG))]),_:1},8,["class"])])],14,["onClick"])):St("v-if",!0)]),_:3},8,["name"]))}});var J7=bn(X7,[["__file","backtop.vue"]]);const Q7=Ao(J7),eK=vn({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:ut([String,Object,Array])},offset:{type:ut(Array),default:[0,0]},badgeClass:{type:String}}),tK=Ze({name:"ElBadge"}),nK=Ze({...tK,props:eK,setup(e,{expose:t}){const i=e,s=rn("badge"),d=te(()=>i.isDot?"":ao(i.value)&&ao(i.max)?i.max<i.value?`${i.max}+`:`${i.value}`:`${i.value}`),g=te(()=>{var _,o,S,E,I;return[{backgroundColor:i.color,marginRight:ji(-((o=(_=i.offset)==null?void 0:_[0])!=null?o:0)),marginTop:ji((E=(S=i.offset)==null?void 0:S[1])!=null?E:0)},(I=i.badgeStyle)!=null?I:{}]});return t({content:d}),(_,o)=>(se(),Pe("div",{class:de(y(s).b())},[_t(_.$slots,"default"),Qe(Ea,{name:`${y(s).namespace.value}-zoom-in-center`,persisted:""},{default:at(()=>[zo(He("sup",{class:de([y(s).e("content"),y(s).em("content",_.type),y(s).is("fixed",!!_.$slots.default),y(s).is("dot",_.isDot),y(s).is("hide-zero",!_.showZero&&i.value===0),_.badgeClass]),style:to(y(g)),textContent:wn(y(d))},null,14,["textContent"]),[[Cr,!_.hidden&&(y(d)||_.isDot)]])]),_:1},8,["name"])],2))}});var oK=bn(nK,[["__file","badge.vue"]]);const kL=Ao(oK),PL=Symbol("breadcrumbKey"),rK=vn({separator:{type:String,default:"/"},separatorIcon:{type:Xr}}),iK=Ze({name:"ElBreadcrumb"}),aK=Ze({...iK,props:rK,setup(e){const t=e,{t:i}=vr(),s=rn("breadcrumb"),d=Se();return or(PL,t),No(()=>{const g=d.value.querySelectorAll(`.${s.e("item")}`);g.length&&g[g.length-1].setAttribute("aria-current","page")}),(g,_)=>(se(),Pe("div",{ref_key:"breadcrumb",ref:d,class:de(y(s).b()),"aria-label":y(i)("el.breadcrumb.label"),role:"navigation"},[_t(g.$slots,"default")],10,["aria-label"]))}});var sK=bn(aK,[["__file","breadcrumb.vue"]]);const lK=vn({to:{type:ut([String,Object]),default:""},replace:Boolean}),cK=Ze({name:"ElBreadcrumbItem"}),uK=Ze({...cK,props:lK,setup(e){const t=e,i=jo(),s=Un(PL,void 0),d=rn("breadcrumb"),g=i.appContext.config.globalProperties.$router,_=Se(),o=()=>{!t.to||!g||(t.replace?g.replace(t.to):g.push(t.to))};return(S,E)=>{var I,P;return se(),Pe("span",{class:de(y(d).e("item"))},[He("span",{ref_key:"link",ref:_,class:de([y(d).e("inner"),y(d).is("link",!!S.to)]),role:"link",onClick:o},[_t(S.$slots,"default")],2),(I=y(s))!=null&&I.separatorIcon?(se(),Rt(y(Gn),{key:0,class:de(y(d).e("separator"))},{default:at(()=>[(se(),Rt(Wo(y(s).separatorIcon)))]),_:1},8,["class"])):(se(),Pe("span",{key:1,class:de(y(d).e("separator")),role:"presentation"},wn((P=y(s))==null?void 0:P.separator),3))],2)}}});var RL=bn(uK,[["__file","breadcrumb-item.vue"]]);const dK=Ao(sK,{BreadcrumbItem:RL}),hK=Oi(RL),OL=Symbol("buttonGroupContextKey"),dh=({from:e,replacement:t,scope:i,version:s,ref:d,type:g="API"},_)=>{tn(()=>y(_),o=>{},{immediate:!0})},fK=(e,t)=>{dh({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},te(()=>e.type==="text"));const i=Un(OL,void 0),s=s1("button"),{form:d}=Ka(),g=na(te(()=>i==null?void 0:i.size)),_=Za(),o=Se(),S=aa(),E=te(()=>e.type||(i==null?void 0:i.type)||""),I=te(()=>{var $,z,H;return(H=(z=e.autoInsertSpace)!=null?z:($=s.value)==null?void 0:$.autoInsertSpace)!=null?H:!1}),P=te(()=>e.tag==="button"?{ariaDisabled:_.value||e.loading,disabled:_.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),F=te(()=>{var $;const z=($=S.default)==null?void 0:$.call(S);if(I.value&&(z==null?void 0:z.length)===1){const H=z[0];if((H==null?void 0:H.type)===zm){const U=H.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(U.trim())}}return!1});return{_disabled:_,_size:g,_type:E,_ref:o,_props:P,shouldAddSpace:F,handleClick:$=>{if(_.value||e.loading){$.stopPropagation();return}e.nativeType==="reset"&&(d==null||d.resetFields()),t("click",$)}}},v2=["default","primary","success","warning","info","danger","text",""],pK=["button","submit","reset"],_2=vn({size:ia,disabled:Boolean,type:{type:String,values:v2,default:""},icon:{type:Xr},nativeType:{type:String,values:pK,default:"button"},loading:Boolean,loadingIcon:{type:Xr,default:()=>Cu},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:ut([String,Object]),default:"button"}}),mK={click:e=>e instanceof MouseEvent};function Wa(e,t){gK(e)&&(e="100%");var i=vK(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function I0(e){return Math.min(1,Math.max(0,e))}function gK(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function vK(e){return typeof e=="string"&&e.indexOf("%")!==-1}function LL(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function A0(e){return e<=1?"".concat(Number(e)*100,"%"):e}function Tf(e){return e.length===1?"0"+e:String(e)}function _K(e,t,i){return{r:Wa(e,255)*255,g:Wa(t,255)*255,b:Wa(i,255)*255}}function Gk(e,t,i){e=Wa(e,255),t=Wa(t,255),i=Wa(i,255);var s=Math.max(e,t,i),d=Math.min(e,t,i),g=0,_=0,o=(s+d)/2;if(s===d)_=0,g=0;else{var S=s-d;switch(_=o>.5?S/(2-s-d):S/(s+d),s){case e:g=(t-i)/S+(t<i?6:0);break;case t:g=(i-e)/S+2;break;case i:g=(e-t)/S+4;break}g/=6}return{h:g,s:_,l:o}}function Tw(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*(6*i):i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function yK(e,t,i){var s,d,g;if(e=Wa(e,360),t=Wa(t,100),i=Wa(i,100),t===0)d=i,g=i,s=i;else{var _=i<.5?i*(1+t):i+t-i*t,o=2*i-_;s=Tw(o,_,e+1/3),d=Tw(o,_,e),g=Tw(o,_,e-1/3)}return{r:s*255,g:d*255,b:g*255}}function Wk(e,t,i){e=Wa(e,255),t=Wa(t,255),i=Wa(i,255);var s=Math.max(e,t,i),d=Math.min(e,t,i),g=0,_=s,o=s-d,S=s===0?0:o/s;if(s===d)g=0;else{switch(s){case e:g=(t-i)/o+(t<i?6:0);break;case t:g=(i-e)/o+2;break;case i:g=(e-t)/o+4;break}g/=6}return{h:g,s:S,v:_}}function bK(e,t,i){e=Wa(e,360)*6,t=Wa(t,100),i=Wa(i,100);var s=Math.floor(e),d=e-s,g=i*(1-t),_=i*(1-d*t),o=i*(1-(1-d)*t),S=s%6,E=[i,_,g,g,o,i][S],I=[o,i,i,_,g,g][S],P=[g,g,o,i,i,_][S];return{r:E*255,g:I*255,b:P*255}}function qk(e,t,i,s){var d=[Tf(Math.round(e).toString(16)),Tf(Math.round(t).toString(16)),Tf(Math.round(i).toString(16))];return s&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function xK(e,t,i,s,d){var g=[Tf(Math.round(e).toString(16)),Tf(Math.round(t).toString(16)),Tf(Math.round(i).toString(16)),Tf(wK(s))];return d&&g[0].startsWith(g[0].charAt(1))&&g[1].startsWith(g[1].charAt(1))&&g[2].startsWith(g[2].charAt(1))&&g[3].startsWith(g[3].charAt(1))?g[0].charAt(0)+g[1].charAt(0)+g[2].charAt(0)+g[3].charAt(0):g.join("")}function wK(e){return Math.round(parseFloat(e)*255).toString(16)}function Kk(e){return _l(e)/255}function _l(e){return parseInt(e,16)}function SK(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var y2={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function TK(e){var t={r:0,g:0,b:0},i=1,s=null,d=null,g=null,_=!1,o=!1;return typeof e=="string"&&(e=MK(e)),typeof e=="object"&&(qu(e.r)&&qu(e.g)&&qu(e.b)?(t=_K(e.r,e.g,e.b),_=!0,o=String(e.r).substr(-1)==="%"?"prgb":"rgb"):qu(e.h)&&qu(e.s)&&qu(e.v)?(s=A0(e.s),d=A0(e.v),t=bK(e.h,s,d),_=!0,o="hsv"):qu(e.h)&&qu(e.s)&&qu(e.l)&&(s=A0(e.s),g=A0(e.l),t=yK(e.h,s,g),_=!0,o="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(i=e.a)),i=LL(i),{ok:_,format:e.format||o,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:i}}var CK="[-\\+]?\\d+%?",EK="[-\\+]?\\d*\\.\\d+%?",sh="(?:".concat(EK,")|(?:").concat(CK,")"),Cw="[\\s|\\(]+(".concat(sh,")[,|\\s]+(").concat(sh,")[,|\\s]+(").concat(sh,")\\s*\\)?"),Ew="[\\s|\\(]+(".concat(sh,")[,|\\s]+(").concat(sh,")[,|\\s]+(").concat(sh,")[,|\\s]+(").concat(sh,")\\s*\\)?"),Bc={CSS_UNIT:new RegExp(sh),rgb:new RegExp("rgb"+Cw),rgba:new RegExp("rgba"+Ew),hsl:new RegExp("hsl"+Cw),hsla:new RegExp("hsla"+Ew),hsv:new RegExp("hsv"+Cw),hsva:new RegExp("hsva"+Ew),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function MK(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(y2[e])e=y2[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=Bc.rgb.exec(e);return i?{r:i[1],g:i[2],b:i[3]}:(i=Bc.rgba.exec(e),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=Bc.hsl.exec(e),i?{h:i[1],s:i[2],l:i[3]}:(i=Bc.hsla.exec(e),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=Bc.hsv.exec(e),i?{h:i[1],s:i[2],v:i[3]}:(i=Bc.hsva.exec(e),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=Bc.hex8.exec(e),i?{r:_l(i[1]),g:_l(i[2]),b:_l(i[3]),a:Kk(i[4]),format:t?"name":"hex8"}:(i=Bc.hex6.exec(e),i?{r:_l(i[1]),g:_l(i[2]),b:_l(i[3]),format:t?"name":"hex"}:(i=Bc.hex4.exec(e),i?{r:_l(i[1]+i[1]),g:_l(i[2]+i[2]),b:_l(i[3]+i[3]),a:Kk(i[4]+i[4]),format:t?"name":"hex8"}:(i=Bc.hex3.exec(e),i?{r:_l(i[1]+i[1]),g:_l(i[2]+i[2]),b:_l(i[3]+i[3]),format:t?"name":"hex"}:!1)))))))))}function qu(e){return!!Bc.CSS_UNIT.exec(String(e))}var DL=function(){function e(t,i){t===void 0&&(t=""),i===void 0&&(i={});var s;if(t instanceof e)return t;typeof t=="number"&&(t=SK(t)),this.originalInput=t;var d=TK(t);this.originalInput=t,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(s=i.format)!==null&&s!==void 0?s:d.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),i,s,d,g=t.r/255,_=t.g/255,o=t.b/255;return g<=.03928?i=g/12.92:i=Math.pow((g+.055)/1.055,2.4),_<=.03928?s=_/12.92:s=Math.pow((_+.055)/1.055,2.4),o<=.03928?d=o/12.92:d=Math.pow((o+.055)/1.055,2.4),.2126*i+.7152*s+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=LL(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=Wk(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=Wk(this.r,this.g,this.b),i=Math.round(t.h*360),s=Math.round(t.s*100),d=Math.round(t.v*100);return this.a===1?"hsv(".concat(i,", ").concat(s,"%, ").concat(d,"%)"):"hsva(".concat(i,", ").concat(s,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=Gk(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=Gk(this.r,this.g,this.b),i=Math.round(t.h*360),s=Math.round(t.s*100),d=Math.round(t.l*100);return this.a===1?"hsl(".concat(i,", ").concat(s,"%, ").concat(d,"%)"):"hsla(".concat(i,", ").concat(s,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),qk(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),xK(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),s=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(i,", ").concat(s,")"):"rgba(".concat(t,", ").concat(i,", ").concat(s,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(i){return"".concat(Math.round(Wa(i,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(i){return Math.round(Wa(i,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+qk(this.r,this.g,this.b,!1),i=0,s=Object.entries(y2);i<s.length;i++){var d=s[i],g=d[0],_=d[1];if(t===_)return g}return!1},e.prototype.toString=function(t){var i=!!t;t=t??this.format;var s=!1,d=this.a<1&&this.a>=0,g=!i&&d&&(t.startsWith("hex")||t==="name");return g?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(s=this.toRgbString()),t==="prgb"&&(s=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(s=this.toHexString()),t==="hex3"&&(s=this.toHexString(!0)),t==="hex4"&&(s=this.toHex8String(!0)),t==="hex8"&&(s=this.toHex8String()),t==="name"&&(s=this.toName()),t==="hsl"&&(s=this.toHslString()),t==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l+=t/100,i.l=I0(i.l),new e(i)},e.prototype.brighten=function(t){t===void 0&&(t=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(t/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(t/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(t/100)))),new e(i)},e.prototype.darken=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l-=t/100,i.l=I0(i.l),new e(i)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s-=t/100,i.s=I0(i.s),new e(i)},e.prototype.saturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s+=t/100,i.s=I0(i.s),new e(i)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var i=this.toHsl(),s=(i.h+t)%360;return i.h=s<0?360+s:s,new e(i)},e.prototype.mix=function(t,i){i===void 0&&(i=50);var s=this.toRgb(),d=new e(t).toRgb(),g=i/100,_={r:(d.r-s.r)*g+s.r,g:(d.g-s.g)*g+s.g,b:(d.b-s.b)*g+s.b,a:(d.a-s.a)*g+s.a};return new e(_)},e.prototype.analogous=function(t,i){t===void 0&&(t=6),i===void 0&&(i=30);var s=this.toHsl(),d=360/i,g=[this];for(s.h=(s.h-(d*t>>1)+720)%360;--t;)s.h=(s.h+d)%360,g.push(new e(s));return g},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var i=this.toHsv(),s=i.h,d=i.s,g=i.v,_=[],o=1/t;t--;)_.push(new e({h:s,s:d,v:g})),g=(g+o)%1;return _},e.prototype.splitcomplement=function(){var t=this.toHsl(),i=t.h;return[this,new e({h:(i+72)%360,s:t.s,l:t.l}),new e({h:(i+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var i=this.toRgb(),s=new e(t).toRgb(),d=i.a+s.a*(1-i.a);return new e({r:(i.r*i.a+s.r*s.a*(1-i.a))/d,g:(i.g*i.a+s.g*s.a*(1-i.a))/d,b:(i.b*i.a+s.b*s.a*(1-i.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var i=this.toHsl(),s=i.h,d=[this],g=360/t,_=1;_<t;_++)d.push(new e({h:(s+_*g)%360,s:i.s,l:i.l}));return d},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function Jd(e,t=20){return e.mix("#141414",t).toString()}function IK(e){const t=Za(),i=rn("button");return te(()=>{let s={},d=e.color;if(d){const g=d.match(/var\((.*?)\)/);g&&(d=window.getComputedStyle(window.document.documentElement).getPropertyValue(g[1]));const _=new DL(d),o=e.dark?_.tint(20).toString():Jd(_,20);if(e.plain)s=i.cssVarBlock({"bg-color":e.dark?Jd(_,90):_.tint(90).toString(),"text-color":d,"border-color":e.dark?Jd(_,50):_.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":d,"hover-border-color":d,"active-bg-color":o,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":o}),t.value&&(s[i.cssVarBlockName("disabled-bg-color")]=e.dark?Jd(_,90):_.tint(90).toString(),s[i.cssVarBlockName("disabled-text-color")]=e.dark?Jd(_,50):_.tint(50).toString(),s[i.cssVarBlockName("disabled-border-color")]=e.dark?Jd(_,80):_.tint(80).toString());else{const S=e.dark?Jd(_,30):_.tint(30).toString(),E=_.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(s=i.cssVarBlock({"bg-color":d,"text-color":E,"border-color":d,"hover-bg-color":S,"hover-text-color":E,"hover-border-color":S,"active-bg-color":o,"active-border-color":o}),t.value){const I=e.dark?Jd(_,50):_.tint(50).toString();s[i.cssVarBlockName("disabled-bg-color")]=I,s[i.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,s[i.cssVarBlockName("disabled-border-color")]=I}}}return s})}const AK=Ze({name:"ElButton"}),kK=Ze({...AK,props:_2,emits:mK,setup(e,{expose:t,emit:i}){const s=e,d=IK(s),g=rn("button"),{_ref:_,_size:o,_type:S,_disabled:E,_props:I,shouldAddSpace:P,handleClick:F}=fK(s,i),B=te(()=>[g.b(),g.m(S.value),g.m(o.value),g.is("disabled",E.value),g.is("loading",s.loading),g.is("plain",s.plain),g.is("round",s.round),g.is("circle",s.circle),g.is("text",s.text),g.is("link",s.link),g.is("has-bg",s.bg)]);return t({ref:_,size:o,type:S,disabled:E,shouldAddSpace:P}),($,z)=>(se(),Rt(Wo($.tag),Yo({ref_key:"_ref",ref:_},y(I),{class:y(B),style:y(d),onClick:y(F)}),{default:at(()=>[$.loading?(se(),Pe(eo,{key:0},[$.$slots.loading?_t($.$slots,"loading",{key:0}):(se(),Rt(y(Gn),{key:1,class:de(y(g).is("loading"))},{default:at(()=>[(se(),Rt(Wo($.loadingIcon)))]),_:1},8,["class"]))],64)):$.icon||$.$slots.icon?(se(),Rt(y(Gn),{key:1},{default:at(()=>[$.icon?(se(),Rt(Wo($.icon),{key:0})):_t($.$slots,"icon",{key:1})]),_:3})):St("v-if",!0),$.$slots.default?(se(),Pe("span",{key:2,class:de({[y(g).em("text","expand")]:y(P)})},[_t($.$slots,"default")],2)):St("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var PK=bn(kK,[["__file","button.vue"]]);const RK={size:_2.size,type:_2.type},OK=Ze({name:"ElButtonGroup"}),LK=Ze({...OK,props:RK,setup(e){const t=e;or(OL,Pr({size:Vr(t,"size"),type:Vr(t,"type")}));const i=rn("button");return(s,d)=>(se(),Pe("div",{class:de(y(i).b("group"))},[_t(s.$slots,"default")],2))}});var zL=bn(LK,[["__file","button-group.vue"]]);const Ta=Ao(PK,{ButtonGroup:zL}),FL=Oi(zL);var BL={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){var i=1e3,s=6e4,d=36e5,g="millisecond",_="second",o="minute",S="hour",E="day",I="week",P="month",F="quarter",B="year",$="date",z="Invalid Date",H=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ie={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(tt){var Me=["th","st","nd","rd"],xe=tt%100;return"["+tt+(Me[(xe-20)%10]||Me[xe]||Me[0])+"]"}},Z=function(tt,Me,xe){var Ae=String(tt);return!Ae||Ae.length>=Me?tt:""+Array(Me+1-Ae.length).join(xe)+tt},G={s:Z,z:function(tt){var Me=-tt.utcOffset(),xe=Math.abs(Me),Ae=Math.floor(xe/60),Ce=xe%60;return(Me<=0?"+":"-")+Z(Ae,2,"0")+":"+Z(Ce,2,"0")},m:function tt(Me,xe){if(Me.date()<xe.date())return-tt(xe,Me);var Ae=12*(xe.year()-Me.year())+(xe.month()-Me.month()),Ce=Me.clone().add(Ae,P),ge=xe-Ce<0,Ne=Me.clone().add(Ae+(ge?-1:1),P);return+(-(Ae+(xe-Ce)/(ge?Ce-Ne:Ne-Ce))||0)},a:function(tt){return tt<0?Math.ceil(tt)||0:Math.floor(tt)},p:function(tt){return{M:P,y:B,w:I,d:E,D:$,h:S,m:o,s:_,ms:g,Q:F}[tt]||String(tt||"").toLowerCase().replace(/s$/,"")},u:function(tt){return tt===void 0}},Q="en",oe={};oe[Q]=ie;var le="$isDayjsObject",me=function(tt){return tt instanceof ye||!(!tt||!tt[le])},fe=function tt(Me,xe,Ae){var Ce;if(!Me)return Q;if(typeof Me=="string"){var ge=Me.toLowerCase();oe[ge]&&(Ce=ge),xe&&(oe[ge]=xe,Ce=ge);var Ne=Me.split("-");if(!Ce&&Ne.length>1)return tt(Ne[0])}else{var We=Me.name;oe[We]=Me,Ce=We}return!Ae&&Ce&&(Q=Ce),Ce||!Ae&&Q},ce=function(tt,Me){if(me(tt))return tt.clone();var xe=typeof Me=="object"?Me:{};return xe.date=tt,xe.args=arguments,new ye(xe)},pe=G;pe.l=fe,pe.i=me,pe.w=function(tt,Me){return ce(tt,{locale:Me.$L,utc:Me.$u,x:Me.$x,$offset:Me.$offset})};var ye=function(){function tt(xe){this.$L=fe(xe.locale,null,!0),this.parse(xe),this.$x=this.$x||xe.x||{},this[le]=!0}var Me=tt.prototype;return Me.parse=function(xe){this.$d=function(Ae){var Ce=Ae.date,ge=Ae.utc;if(Ce===null)return new Date(NaN);if(pe.u(Ce))return new Date;if(Ce instanceof Date)return new Date(Ce);if(typeof Ce=="string"&&!/Z$/i.test(Ce)){var Ne=Ce.match(H);if(Ne){var We=Ne[2]-1||0,ot=(Ne[7]||"0").substring(0,3);return ge?new Date(Date.UTC(Ne[1],We,Ne[3]||1,Ne[4]||0,Ne[5]||0,Ne[6]||0,ot)):new Date(Ne[1],We,Ne[3]||1,Ne[4]||0,Ne[5]||0,Ne[6]||0,ot)}}return new Date(Ce)}(xe),this.init()},Me.init=function(){var xe=this.$d;this.$y=xe.getFullYear(),this.$M=xe.getMonth(),this.$D=xe.getDate(),this.$W=xe.getDay(),this.$H=xe.getHours(),this.$m=xe.getMinutes(),this.$s=xe.getSeconds(),this.$ms=xe.getMilliseconds()},Me.$utils=function(){return pe},Me.isValid=function(){return this.$d.toString()!==z},Me.isSame=function(xe,Ae){var Ce=ce(xe);return this.startOf(Ae)<=Ce&&Ce<=this.endOf(Ae)},Me.isAfter=function(xe,Ae){return ce(xe)<this.startOf(Ae)},Me.isBefore=function(xe,Ae){return this.endOf(Ae)<ce(xe)},Me.$g=function(xe,Ae,Ce){return pe.u(xe)?this[Ae]:this.set(Ce,xe)},Me.unix=function(){return Math.floor(this.valueOf()/1e3)},Me.valueOf=function(){return this.$d.getTime()},Me.startOf=function(xe,Ae){var Ce=this,ge=!!pe.u(Ae)||Ae,Ne=pe.p(xe),We=function($t,Re){var dn=pe.w(Ce.$u?Date.UTC(Ce.$y,Re,$t):new Date(Ce.$y,Re,$t),Ce);return ge?dn:dn.endOf(E)},ot=function($t,Re){return pe.w(Ce.toDate()[$t].apply(Ce.toDate("s"),(ge?[0,0,0,0]:[23,59,59,999]).slice(Re)),Ce)},Oe=this.$W,Ct=this.$M,Mt=this.$D,zt="set"+(this.$u?"UTC":"");switch(Ne){case B:return ge?We(1,0):We(31,11);case P:return ge?We(1,Ct):We(0,Ct+1);case I:var bt=this.$locale().weekStart||0,Kt=(Oe<bt?Oe+7:Oe)-bt;return We(ge?Mt-Kt:Mt+(6-Kt),Ct);case E:case $:return ot(zt+"Hours",0);case S:return ot(zt+"Minutes",1);case o:return ot(zt+"Seconds",2);case _:return ot(zt+"Milliseconds",3);default:return this.clone()}},Me.endOf=function(xe){return this.startOf(xe,!1)},Me.$set=function(xe,Ae){var Ce,ge=pe.p(xe),Ne="set"+(this.$u?"UTC":""),We=(Ce={},Ce[E]=Ne+"Date",Ce[$]=Ne+"Date",Ce[P]=Ne+"Month",Ce[B]=Ne+"FullYear",Ce[S]=Ne+"Hours",Ce[o]=Ne+"Minutes",Ce[_]=Ne+"Seconds",Ce[g]=Ne+"Milliseconds",Ce)[ge],ot=ge===E?this.$D+(Ae-this.$W):Ae;if(ge===P||ge===B){var Oe=this.clone().set($,1);Oe.$d[We](ot),Oe.init(),this.$d=Oe.set($,Math.min(this.$D,Oe.daysInMonth())).$d}else We&&this.$d[We](ot);return this.init(),this},Me.set=function(xe,Ae){return this.clone().$set(xe,Ae)},Me.get=function(xe){return this[pe.p(xe)]()},Me.add=function(xe,Ae){var Ce,ge=this;xe=Number(xe);var Ne=pe.p(Ae),We=function(Ct){var Mt=ce(ge);return pe.w(Mt.date(Mt.date()+Math.round(Ct*xe)),ge)};if(Ne===P)return this.set(P,this.$M+xe);if(Ne===B)return this.set(B,this.$y+xe);if(Ne===E)return We(1);if(Ne===I)return We(7);var ot=(Ce={},Ce[o]=s,Ce[S]=d,Ce[_]=i,Ce)[Ne]||1,Oe=this.$d.getTime()+xe*ot;return pe.w(Oe,this)},Me.subtract=function(xe,Ae){return this.add(-1*xe,Ae)},Me.format=function(xe){var Ae=this,Ce=this.$locale();if(!this.isValid())return Ce.invalidDate||z;var ge=xe||"YYYY-MM-DDTHH:mm:ssZ",Ne=pe.z(this),We=this.$H,ot=this.$m,Oe=this.$M,Ct=Ce.weekdays,Mt=Ce.months,zt=Ce.meridiem,bt=function(Re,dn,At,Ke){return Re&&(Re[dn]||Re(Ae,ge))||At[dn].slice(0,Ke)},Kt=function(Re){return pe.s(We%12||12,Re,"0")},$t=zt||function(Re,dn,At){var Ke=Re<12?"AM":"PM";return At?Ke.toLowerCase():Ke};return ge.replace(U,function(Re,dn){return dn||function(At){switch(At){case"YY":return String(Ae.$y).slice(-2);case"YYYY":return pe.s(Ae.$y,4,"0");case"M":return Oe+1;case"MM":return pe.s(Oe+1,2,"0");case"MMM":return bt(Ce.monthsShort,Oe,Mt,3);case"MMMM":return bt(Mt,Oe);case"D":return Ae.$D;case"DD":return pe.s(Ae.$D,2,"0");case"d":return String(Ae.$W);case"dd":return bt(Ce.weekdaysMin,Ae.$W,Ct,2);case"ddd":return bt(Ce.weekdaysShort,Ae.$W,Ct,3);case"dddd":return Ct[Ae.$W];case"H":return String(We);case"HH":return pe.s(We,2,"0");case"h":return Kt(1);case"hh":return Kt(2);case"a":return $t(We,ot,!0);case"A":return $t(We,ot,!1);case"m":return String(ot);case"mm":return pe.s(ot,2,"0");case"s":return String(Ae.$s);case"ss":return pe.s(Ae.$s,2,"0");case"SSS":return pe.s(Ae.$ms,3,"0");case"Z":return Ne}return null}(Re)||Ne.replace(":","")})},Me.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Me.diff=function(xe,Ae,Ce){var ge,Ne=this,We=pe.p(Ae),ot=ce(xe),Oe=(ot.utcOffset()-this.utcOffset())*s,Ct=this-ot,Mt=function(){return pe.m(Ne,ot)};switch(We){case B:ge=Mt()/12;break;case P:ge=Mt();break;case F:ge=Mt()/3;break;case I:ge=(Ct-Oe)/6048e5;break;case E:ge=(Ct-Oe)/864e5;break;case S:ge=Ct/d;break;case o:ge=Ct/s;break;case _:ge=Ct/i;break;default:ge=Ct}return Ce?ge:pe.a(ge)},Me.daysInMonth=function(){return this.endOf(P).$D},Me.$locale=function(){return oe[this.$L]},Me.locale=function(xe,Ae){if(!xe)return this.$L;var Ce=this.clone(),ge=fe(xe,Ae,!0);return ge&&(Ce.$L=ge),Ce},Me.clone=function(){return pe.w(this.$d,this)},Me.toDate=function(){return new Date(this.valueOf())},Me.toJSON=function(){return this.isValid()?this.toISOString():null},Me.toISOString=function(){return this.$d.toISOString()},Me.toString=function(){return this.$d.toUTCString()},tt}(),De=ye.prototype;return ce.prototype=De,[["$ms",g],["$s",_],["$m",o],["$H",S],["$W",E],["$M",P],["$y",B],["$D",$]].forEach(function(tt){De[tt[1]]=function(Me){return this.$g(Me,tt[0],tt[1])}}),ce.extend=function(tt,Me){return tt.$i||(tt(Me,ye,ce),tt.$i=!0),ce},ce.locale=fe,ce.isDayjs=me,ce.unix=function(tt){return ce(1e3*tt)},ce.en=oe[Q],ce.Ls=oe,ce.p={},ce})})(BL);var DK=BL.exports;const Mo=Xc(DK),Mw=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],hh=e=>Array.from(Array.from({length:e}).keys()),NL=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),$L=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),Zk=function(e,t){const i=ph(e),s=ph(t);return i&&s?e.getTime()===t.getTime():!i&&!s?e===t:!1},Yk=function(e,t){const i=fn(e),s=fn(t);return i&&s?e.length!==t.length?!1:e.every((d,g)=>Zk(d,t[g])):!i&&!s?Zk(e,t):!1},Xk=function(e,t,i){const s=yl(t)||t==="x"?Mo(e).locale(i):Mo(e,t).locale(i);return s.isValid()?s:void 0},Jk=function(e,t,i){return yl(t)?e:t==="x"?+e:Mo(e).locale(i).format(t)},Iw=(e,t)=>{var i;const s=[],d=t==null?void 0:t();for(let g=0;g<e;g++)s.push((i=d==null?void 0:d.includes(g))!=null?i:!1);return s},k0=e=>fn(e)?e.map(t=>t.toDate()):e.toDate(),zK=(e,t)=>{const i=e.subtract(1,"month").endOf("month").date();return hh(t).map((s,d)=>i-(t-d-1))},FK=e=>{const t=e.daysInMonth();return hh(t).map((i,s)=>s+1)},BK=e=>hh(e.length/7).map(t=>{const i=t*7;return e.slice(i,i+7)}),NK=vn({selectedDay:{type:ut(Object)},range:{type:ut(Array)},date:{type:ut(Object),required:!0},hideHeader:{type:Boolean}}),$K={pick:e=>Vo(e)};var VL={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){return function(i,s,d){var g=s.prototype,_=function(P){return P&&(P.indexOf?P:P.s)},o=function(P,F,B,$,z){var H=P.name?P:P.$locale(),U=_(H[F]),ie=_(H[B]),Z=U||ie.map(function(Q){return Q.slice(0,$)});if(!z)return Z;var G=H.weekStart;return Z.map(function(Q,oe){return Z[(oe+(G||0))%7]})},S=function(){return d.Ls[d.locale()]},E=function(P,F){return P.formats[F]||function(B){return B.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function($,z,H){return z||H.slice(1)})}(P.formats[F.toUpperCase()])},I=function(){var P=this;return{months:function(F){return F?F.format("MMMM"):o(P,"months")},monthsShort:function(F){return F?F.format("MMM"):o(P,"monthsShort","months",3)},firstDayOfWeek:function(){return P.$locale().weekStart||0},weekdays:function(F){return F?F.format("dddd"):o(P,"weekdays")},weekdaysMin:function(F){return F?F.format("dd"):o(P,"weekdaysMin","weekdays",2)},weekdaysShort:function(F){return F?F.format("ddd"):o(P,"weekdaysShort","weekdays",3)},longDateFormat:function(F){return E(P.$locale(),F)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};g.localeData=function(){return I.bind(this)()},d.localeData=function(){var P=S();return{firstDayOfWeek:function(){return P.weekStart||0},weekdays:function(){return d.weekdays()},weekdaysShort:function(){return d.weekdaysShort()},weekdaysMin:function(){return d.weekdaysMin()},months:function(){return d.months()},monthsShort:function(){return d.monthsShort()},longDateFormat:function(F){return E(P,F)},meridiem:P.meridiem,ordinal:P.ordinal}},d.months=function(){return o(S(),"months")},d.monthsShort=function(){return o(S(),"monthsShort","months",3)},d.weekdays=function(P){return o(S(),"weekdays",null,null,P)},d.weekdaysShort=function(P){return o(S(),"weekdaysShort","weekdays",3,P)},d.weekdaysMin=function(P){return o(S(),"weekdaysMin","weekdays",2,P)}}})})(VL);var VK=VL.exports;const UL=Xc(VK),UK=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],Aw=["sun","mon","tue","wed","thu","fri","sat"],jK=(e,t)=>{Mo.extend(UL);const i=Mo.localeData().firstDayOfWeek(),{t:s,lang:d}=vr(),g=Mo().locale(d.value),_=te(()=>!!e.range&&!!e.range.length),o=te(()=>{let F=[];if(_.value){const[B,$]=e.range,z=hh($.date()-B.date()+1).map(ie=>({text:B.date()+ie,type:"current"}));let H=z.length%7;H=H===0?0:7-H;const U=hh(H).map((ie,Z)=>({text:Z+1,type:"next"}));F=z.concat(U)}else{const B=e.date.startOf("month").day(),$=zK(e.date,(B-i+7)%7).map(ie=>({text:ie,type:"prev"})),z=FK(e.date).map(ie=>({text:ie,type:"current"}));F=[...$,...z];const H=7-(F.length%7||7),U=hh(H).map((ie,Z)=>({text:Z+1,type:"next"}));F=F.concat(U)}return BK(F)}),S=te(()=>{const F=i;return F===0?Aw.map(B=>s(`el.datepicker.weeks.${B}`)):Aw.slice(F).concat(Aw.slice(0,F)).map(B=>s(`el.datepicker.weeks.${B}`))}),E=(F,B)=>{switch(B){case"prev":return e.date.startOf("month").subtract(1,"month").date(F);case"next":return e.date.startOf("month").add(1,"month").date(F);case"current":return e.date.date(F)}};return{now:g,isInRange:_,rows:o,weekDays:S,getFormattedDate:E,handlePickDay:({text:F,type:B})=>{const $=E(F,B);t("pick",$)},getSlotData:({text:F,type:B})=>{const $=E(F,B);return{isSelected:$.isSame(e.selectedDay),type:`${B}-month`,day:$.format("YYYY-MM-DD"),date:$.toDate()}}}},HK=Ze({name:"DateTable"}),GK=Ze({...HK,props:NK,emits:$K,setup(e,{expose:t,emit:i}){const s=e,{isInRange:d,now:g,rows:_,weekDays:o,getFormattedDate:S,handlePickDay:E,getSlotData:I}=jK(s,i),P=rn("calendar-table"),F=rn("calendar-day"),B=({text:$,type:z})=>{const H=[z];if(z==="current"){const U=S($,z);U.isSame(s.selectedDay,"day")&&H.push(F.is("selected")),U.isSame(g,"day")&&H.push(F.is("today"))}return H};return t({getFormattedDate:S}),($,z)=>(se(),Pe("table",{class:de([y(P).b(),y(P).is("range",y(d))]),cellspacing:"0",cellpadding:"0"},[$.hideHeader?St("v-if",!0):(se(),Pe("thead",{key:0},[He("tr",null,[(se(!0),Pe(eo,null,tr(y(o),H=>(se(),Pe("th",{key:H,scope:"col"},wn(H),1))),128))])])),He("tbody",null,[(se(!0),Pe(eo,null,tr(y(_),(H,U)=>(se(),Pe("tr",{key:U,class:de({[y(P).e("row")]:!0,[y(P).em("row","hide-border")]:U===0&&$.hideHeader})},[(se(!0),Pe(eo,null,tr(H,(ie,Z)=>(se(),Pe("td",{key:Z,class:de(B(ie)),onClick:G=>y(E)(ie)},[He("div",{class:de(y(F).b())},[_t($.$slots,"date-cell",{data:y(I)(ie)},()=>[He("span",null,wn(ie.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var Qk=bn(GK,[["__file","date-table.vue"]]);const WK=(e,t)=>{const i=e.endOf("month"),s=t.startOf("month"),g=i.isSame(s,"week")?s.add(1,"week"):s;return[[e,i],[g.startOf("week"),t]]},qK=(e,t)=>{const i=e.endOf("month"),s=e.add(1,"month").startOf("month"),d=i.isSame(s,"week")?s.add(1,"week"):s,g=d.endOf("month"),_=t.startOf("month"),o=g.isSame(_,"week")?_.add(1,"week"):_;return[[e,i],[d.startOf("week"),g],[o.startOf("week"),t]]},KK=(e,t,i)=>{const{lang:s}=vr(),d=Se(),g=Mo().locale(s.value),_=te({get(){return e.modelValue?S.value:d.value},set(H){if(!H)return;d.value=H;const U=H.toDate();t(Ga,U),t(Fo,U)}}),o=te(()=>{if(!e.range||!fn(e.range)||e.range.length!==2||e.range.some(Z=>!ph(Z)))return[];const H=e.range.map(Z=>Mo(Z).locale(s.value)),[U,ie]=H;return U.isAfter(ie)?[]:U.isSame(ie,"month")?B(U,ie):U.add(1,"month").month()!==ie.month()?[]:B(U,ie)}),S=te(()=>e.modelValue?Mo(e.modelValue).locale(s.value):_.value||(o.value.length?o.value[0][0]:g)),E=te(()=>S.value.subtract(1,"month").date(1)),I=te(()=>S.value.add(1,"month").date(1)),P=te(()=>S.value.subtract(1,"year").date(1)),F=te(()=>S.value.add(1,"year").date(1)),B=(H,U)=>{const ie=H.startOf("week"),Z=U.endOf("week"),G=ie.get("month"),Q=Z.get("month");return G===Q?[[ie,Z]]:(G+1)%12===Q?WK(ie,Z):G+2===Q||(G+1)%11===Q?qK(ie,Z):[]},$=H=>{_.value=H};return{calculateValidatedDateRange:B,date:S,realSelectedDay:_,pickDay:$,selectDate:H=>{const ie={"prev-month":E.value,"next-month":I.value,"prev-year":P.value,"next-year":F.value,today:g}[H];ie.isSame(S.value,"day")||$(ie)},validatedRange:o}},ZK=e=>fn(e)&&e.length===2&&e.every(t=>ph(t)),YK=vn({modelValue:{type:Date},range:{type:ut(Array),validator:ZK}}),XK={[Fo]:e=>ph(e),[Ga]:e=>ph(e)},JK="ElCalendar",QK=Ze({name:JK}),eZ=Ze({...QK,props:YK,emits:XK,setup(e,{expose:t,emit:i}){const s=e,d=rn("calendar"),{calculateValidatedDateRange:g,date:_,pickDay:o,realSelectedDay:S,selectDate:E,validatedRange:I}=KK(s,i),{t:P}=vr(),F=te(()=>{const B=`el.datepicker.month${_.value.format("M")}`;return`${_.value.year()} ${P("el.datepicker.year")} ${P(B)}`});return t({selectedDay:S,pickDay:o,selectDate:E,calculateValidatedDateRange:g}),(B,$)=>(se(),Pe("div",{class:de(y(d).b())},[He("div",{class:de(y(d).e("header"))},[_t(B.$slots,"header",{date:y(F)},()=>[He("div",{class:de(y(d).e("title"))},wn(y(F)),3),y(I).length===0?(se(),Pe("div",{key:0,class:de(y(d).e("button-group"))},[Qe(y(FL),null,{default:at(()=>[Qe(y(Ta),{size:"small",onClick:z=>y(E)("prev-month")},{default:at(()=>[nr(wn(y(P)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),Qe(y(Ta),{size:"small",onClick:z=>y(E)("today")},{default:at(()=>[nr(wn(y(P)("el.datepicker.today")),1)]),_:1},8,["onClick"]),Qe(y(Ta),{size:"small",onClick:z=>y(E)("next-month")},{default:at(()=>[nr(wn(y(P)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):St("v-if",!0)])],2),y(I).length===0?(se(),Pe("div",{key:0,class:de(y(d).e("body"))},[Qe(Qk,{date:y(_),"selected-day":y(S),onPick:y(o)},ec({_:2},[B.$slots["date-cell"]?{name:"date-cell",fn:at(z=>[_t(B.$slots,"date-cell",Vc(mh(z)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(se(),Pe("div",{key:1,class:de(y(d).e("body"))},[(se(!0),Pe(eo,null,tr(y(I),(z,H)=>(se(),Rt(Qk,{key:H,date:z[0],"selected-day":y(S),range:z,"hide-header":H!==0,onPick:y(o)},ec({_:2},[B.$slots["date-cell"]?{name:"date-cell",fn:at(U=>[_t(B.$slots,"date-cell",Vc(mh(U)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var tZ=bn(eZ,[["__file","calendar.vue"]]);const nZ=Ao(tZ),oZ=vn({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:ut([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),rZ=Ze({name:"ElCard"}),iZ=Ze({...rZ,props:oZ,setup(e){const t=rn("card");return(i,s)=>(se(),Pe("div",{class:de([y(t).b(),y(t).is(`${i.shadow}-shadow`)])},[i.$slots.header||i.header?(se(),Pe("div",{key:0,class:de(y(t).e("header"))},[_t(i.$slots,"header",{},()=>[nr(wn(i.header),1)])],2)):St("v-if",!0),He("div",{class:de([y(t).e("body"),i.bodyClass]),style:to(i.bodyStyle)},[_t(i.$slots,"default")],6),i.$slots.footer||i.footer?(se(),Pe("div",{key:1,class:de(y(t).e("footer"))},[_t(i.$slots,"footer",{},()=>[nr(wn(i.footer),1)])],2)):St("v-if",!0)],2))}});var aZ=bn(iZ,[["__file","card.vue"]]);const sZ=Ao(aZ),lZ=vn({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),cZ={change:(e,t)=>[e,t].every(ao)},jL=Symbol("carouselContextKey"),b2="ElCarouselItem";var Kl=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Kl||{});function x2(e){return Ai(e)&&e.type===eo}function uZ(e){return Ai(e)&&e.type===Sa}function dZ(e){return Ai(e)&&!x2(e)&&!uZ(e)}const hZ=e=>{if(!Ai(e))return{};const t=e.props||{},i=(Ai(e.type)?e.type.props:void 0)||{},s={};return Object.keys(i).forEach(d=>{Tr(i[d],"default")&&(s[d]=i[d].default)}),Object.keys(t).forEach(d=>{s[Ds(d)]=t[d]}),s},fZ=e=>{if(!fn(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},fh=e=>{const t=fn(e)?e:[e],i=[];return t.forEach(s=>{var d;fn(s)?i.push(...fh(s)):Ai(s)&&((d=s.component)!=null&&d.subTree)?i.push(s,...fh(s.component.subTree)):Ai(s)&&fn(s.children)?i.push(...fh(s.children)):i.push(s)}),i},pZ=(e,t,i)=>fh(e.subTree).filter(g=>{var _;return Ai(g)&&((_=g.type)==null?void 0:_.name)===t&&!!g.component}).map(g=>g.component.uid).map(g=>i[g]).filter(g=>!!g),ET=(e,t)=>{const i={},s=gi([]);return{children:s,addChild:_=>{i[_.uid]=_,s.value=pZ(e,t,i)},removeChild:_=>{delete i[_],s.value=s.value.filter(o=>o.uid!==_)}}},eP=300,mZ=(e,t,i)=>{const{children:s,addChild:d,removeChild:g}=ET(jo(),b2),_=aa(),o=Se(-1),S=Se(null),E=Se(!1),I=Se(),P=Se(0),F=Se(!0),B=Se(!0),$=Se(!1),z=te(()=>e.arrow!=="never"&&!y(ie)),H=te(()=>s.value.some(zt=>zt.props.label.toString().length>0)),U=te(()=>e.type==="card"),ie=te(()=>e.direction==="vertical"),Z=te(()=>e.height!=="auto"?{height:e.height}:{height:`${P.value}px`,overflow:"hidden"}),G=Pf(zt=>{ce(zt)},eP,{trailing:!0}),Q=Pf(zt=>{ge(zt)},eP),oe=zt=>F.value?o.value<=1?zt<=1:zt>1:!0;function le(){S.value&&(clearInterval(S.value),S.value=null)}function me(){e.interval<=0||!e.autoplay||S.value||(S.value=setInterval(()=>fe(),e.interval))}const fe=()=>{B.value||($.value=!0),B.value=!1,o.value<s.value.length-1?o.value=o.value+1:e.loop?o.value=0:$.value=!1};function ce(zt){if(B.value||($.value=!0),B.value=!1,Zn(zt)){const $t=s.value.filter(Re=>Re.props.name===zt);$t.length>0&&(zt=s.value.indexOf($t[0]))}if(zt=Number(zt),Number.isNaN(zt)||zt!==Math.floor(zt))return;const bt=s.value.length,Kt=o.value;zt<0?o.value=e.loop?bt-1:0:zt>=bt?o.value=e.loop?0:bt-1:o.value=zt,Kt===o.value&&pe(Kt),ot()}function pe(zt){s.value.forEach((bt,Kt)=>{bt.translateItem(Kt,o.value,zt)})}function ye(zt,bt){var Kt,$t,Re,dn;const At=y(s),Ke=At.length;if(Ke===0||!zt.states.inStage)return!1;const Be=bt+1,Ht=bt-1,Ut=Ke-1,Nt=At[Ut].states.active,Et=At[0].states.active,Gt=($t=(Kt=At[Be])==null?void 0:Kt.states)==null?void 0:$t.active,ln=(dn=(Re=At[Ht])==null?void 0:Re.states)==null?void 0:dn.active;return bt===Ut&&Et||Gt?"left":bt===0&&Nt||ln?"right":!1}function De(){E.value=!0,e.pauseOnHover&&le()}function tt(){E.value=!1,me()}function Me(){$.value=!1}function xe(zt){y(ie)||s.value.forEach((bt,Kt)=>{zt===ye(bt,Kt)&&(bt.states.hover=!0)})}function Ae(){y(ie)||s.value.forEach(zt=>{zt.states.hover=!1})}function Ce(zt){zt!==o.value&&(B.value||($.value=!0)),o.value=zt}function ge(zt){e.trigger==="hover"&&zt!==o.value&&(o.value=zt,B.value||($.value=!0))}function Ne(){ce(o.value-1)}function We(){ce(o.value+1)}function ot(){le(),e.pauseOnHover||me()}function Oe(zt){e.height==="auto"&&(P.value=zt)}function Ct(){var zt;const bt=(zt=_.default)==null?void 0:zt.call(_);if(!bt)return null;const $t=fh(bt).filter(Re=>Ai(Re)&&Re.type.name===b2);return($t==null?void 0:$t.length)===2&&e.loop&&!U.value?(F.value=!0,$t):(F.value=!1,null)}tn(()=>o.value,(zt,bt)=>{pe(bt),F.value&&(zt=zt%2,bt=bt%2),bt>-1&&t("change",zt,bt)}),tn(()=>e.autoplay,zt=>{zt?me():le()}),tn(()=>e.loop,()=>{ce(o.value)}),tn(()=>e.interval,()=>{ot()});const Mt=gi();return No(()=>{tn(()=>s.value,()=>{s.value.length>0&&ce(e.initialIndex)},{immediate:!0}),Mt.value=Mi(I.value,()=>{pe()}),me()}),ni(()=>{le(),I.value&&Mt.value&&Mt.value.stop()}),or(jL,{root:I,isCardType:U,isVertical:ie,items:s,loop:e.loop,cardScale:e.cardScale,addItem:d,removeItem:g,setActiveItem:ce,setContainerHeight:Oe}),{root:I,activeIndex:o,arrowDisplay:z,hasLabel:H,hover:E,isCardType:U,isTransitioning:$,items:s,isVertical:ie,containerStyle:Z,isItemsTwoLength:F,handleButtonEnter:xe,handleTransitionEnd:Me,handleButtonLeave:Ae,handleIndicatorClick:Ce,handleMouseEnter:De,handleMouseLeave:tt,setActiveItem:ce,prev:Ne,next:We,PlaceholderItem:Ct,isTwoLengthShow:oe,throttledArrowClick:G,throttledIndicatorHover:Q}},gZ="ElCarousel",vZ=Ze({name:gZ}),_Z=Ze({...vZ,props:lZ,emits:cZ,setup(e,{expose:t,emit:i}){const s=e,{root:d,activeIndex:g,arrowDisplay:_,hasLabel:o,hover:S,isCardType:E,items:I,isVertical:P,containerStyle:F,handleButtonEnter:B,handleButtonLeave:$,isTransitioning:z,handleIndicatorClick:H,handleMouseEnter:U,handleMouseLeave:ie,handleTransitionEnd:Z,setActiveItem:G,prev:Q,next:oe,PlaceholderItem:le,isTwoLengthShow:me,throttledArrowClick:fe,throttledIndicatorHover:ce}=mZ(s,i),pe=rn("carousel"),{t:ye}=vr(),De=te(()=>{const xe=[pe.b(),pe.m(s.direction)];return y(E)&&xe.push(pe.m("card")),xe}),tt=te(()=>{const xe=[pe.e("container")];return s.motionBlur&&y(z)&&I.value.length>1&&xe.push(y(P)?`${pe.namespace.value}-transitioning-vertical`:`${pe.namespace.value}-transitioning`),xe}),Me=te(()=>{const xe=[pe.e("indicators"),pe.em("indicators",s.direction)];return y(o)&&xe.push(pe.em("indicators","labels")),s.indicatorPosition==="outside"&&xe.push(pe.em("indicators","outside")),y(P)&&xe.push(pe.em("indicators","right")),xe});return t({activeIndex:g,setActiveItem:G,prev:Q,next:oe}),(xe,Ae)=>(se(),Pe("div",{ref_key:"root",ref:d,class:de(y(De)),onMouseenter:po(y(U),["stop"]),onMouseleave:po(y(ie),["stop"])},[y(_)?(se(),Rt(Ea,{key:0,name:"carousel-arrow-left",persisted:""},{default:at(()=>[zo(He("button",{type:"button",class:de([y(pe).e("arrow"),y(pe).em("arrow","left")]),"aria-label":y(ye)("el.carousel.leftArrow"),onMouseenter:Ce=>y(B)("left"),onMouseleave:y($),onClick:po(Ce=>y(fe)(y(g)-1),["stop"])},[Qe(y(Gn),null,{default:at(()=>[Qe(y(yh))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Cr,(xe.arrow==="always"||y(S))&&(s.loop||y(g)>0)]])]),_:1})):St("v-if",!0),y(_)?(se(),Rt(Ea,{key:1,name:"carousel-arrow-right",persisted:""},{default:at(()=>[zo(He("button",{type:"button",class:de([y(pe).e("arrow"),y(pe).em("arrow","right")]),"aria-label":y(ye)("el.carousel.rightArrow"),onMouseenter:Ce=>y(B)("right"),onMouseleave:y($),onClick:po(Ce=>y(fe)(y(g)+1),["stop"])},[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ls))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Cr,(xe.arrow==="always"||y(S))&&(s.loop||y(g)<y(I).length-1)]])]),_:1})):St("v-if",!0),He("div",{class:de(y(tt)),style:to(y(F)),onTransitionend:y(Z)},[Qe(y(le)),_t(xe.$slots,"default")],46,["onTransitionend"]),xe.indicatorPosition!=="none"?(se(),Pe("ul",{key:2,class:de(y(Me))},[(se(!0),Pe(eo,null,tr(y(I),(Ce,ge)=>zo((se(),Pe("li",{key:ge,class:de([y(pe).e("indicator"),y(pe).em("indicator",xe.direction),y(pe).is("active",ge===y(g))]),onMouseenter:Ne=>y(ce)(ge),onClick:po(Ne=>y(H)(ge),["stop"])},[He("button",{class:de(y(pe).e("button")),"aria-label":y(ye)("el.carousel.indicator",{index:ge+1})},[y(o)?(se(),Pe("span",{key:0},wn(Ce.props.label),1)):St("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[Cr,y(me)(ge)]])),128))],2)):St("v-if",!0),s.motionBlur?(se(),Pe("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[He("defs",null,[He("filter",{id:"elCarouselHorizontal"},[He("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),He("filter",{id:"elCarouselVertical"},[He("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):St("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var yZ=bn(_Z,[["__file","carousel.vue"]]);const bZ=vn({name:{type:String,default:""},label:{type:[String,Number],default:""}}),xZ=e=>{const t=Un(jL),i=jo(),s=Se(),d=Se(!1),g=Se(0),_=Se(1),o=Se(!1),S=Se(!1),E=Se(!1),I=Se(!1),{isCardType:P,isVertical:F,cardScale:B}=t;function $(Z,G,Q){const oe=Q-1,le=G-1,me=G+1,fe=Q/2;return G===0&&Z===oe?-1:G===oe&&Z===0?Q:Z<le&&G-Z>=fe?Q+1:Z>me&&Z-G>=fe?-2:Z}function z(Z,G){var Q,oe;const le=y(F)?((Q=t.root.value)==null?void 0:Q.offsetHeight)||0:((oe=t.root.value)==null?void 0:oe.offsetWidth)||0;return E.value?le*((2-B)*(Z-G)+1)/4:Z<G?-(1+B)*le/4:(3+B)*le/4}function H(Z,G,Q){const oe=t.root.value;return oe?((Q?oe.offsetHeight:oe.offsetWidth)||0)*(Z-G):0}const U=(Z,G,Q)=>{var oe;const le=y(P),me=(oe=t.items.value.length)!=null?oe:Number.NaN,fe=Z===G;!le&&!Hr(Q)&&(I.value=fe||Z===Q),!fe&&me>2&&t.loop&&(Z=$(Z,G,me));const ce=y(F);o.value=fe,le?(E.value=Math.round(Math.abs(Z-G))<=1,g.value=z(Z,G),_.value=y(o)?1:B):g.value=H(Z,G,ce),S.value=!0,fe&&s.value&&t.setContainerHeight(s.value.offsetHeight)};function ie(){if(t&&y(P)){const Z=t.items.value.findIndex(({uid:G})=>G===i.uid);t.setActiveItem(Z)}}return No(()=>{t.addItem({props:e,states:Pr({hover:d,translate:g,scale:_,active:o,ready:S,inStage:E,animating:I}),uid:i.uid,translateItem:U})}),Eh(()=>{t.removeItem(i.uid)}),{carouselItemRef:s,active:o,animating:I,hover:d,inStage:E,isVertical:F,translate:g,isCardType:P,scale:_,ready:S,handleItemClick:ie}},wZ=Ze({name:b2}),SZ=Ze({...wZ,props:bZ,setup(e){const t=e,i=rn("carousel"),{carouselItemRef:s,active:d,animating:g,hover:_,inStage:o,isVertical:S,translate:E,isCardType:I,scale:P,ready:F,handleItemClick:B}=xZ(t),$=te(()=>[i.e("item"),i.is("active",d.value),i.is("in-stage",o.value),i.is("hover",_.value),i.is("animating",g.value),{[i.em("item","card")]:I.value,[i.em("item","card-vertical")]:I.value&&S.value}]),z=te(()=>{const U=`${`translate${y(S)?"Y":"X"}`}(${y(E)}px)`,ie=`scale(${y(P)})`;return{transform:[U,ie].join(" ")}});return(H,U)=>zo((se(),Pe("div",{ref_key:"carouselItemRef",ref:s,class:de(y($)),style:to(y(z)),onClick:y(B)},[y(I)?zo((se(),Pe("div",{key:0,class:de(y(i).e("mask"))},null,2)),[[Cr,!y(d)]]):St("v-if",!0),_t(H.$slots,"default")],14,["onClick"])),[[Cr,y(F)]])}});var HL=bn(SZ,[["__file","carousel-item.vue"]]);const TZ=Ao(yZ,{CarouselItem:HL}),CZ=Oi(HL),GL={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:ia,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...Da(["ariaControls"])},WL={[Fo]:e=>Zn(e)||ao(e)||ai(e),change:e=>Zn(e)||ao(e)||ai(e)},Gm=Symbol("checkboxGroupContextKey"),EZ=({model:e,isChecked:t})=>{const i=Un(Gm,void 0),s=te(()=>{var g,_;const o=(g=i==null?void 0:i.max)==null?void 0:g.value,S=(_=i==null?void 0:i.min)==null?void 0:_.value;return!Hr(o)&&e.value.length>=o&&!t.value||!Hr(S)&&e.value.length<=S&&t.value});return{isDisabled:Za(te(()=>(i==null?void 0:i.disabled.value)||s.value)),isLimitDisabled:s}},MZ=(e,{model:t,isLimitExceeded:i,hasOwnLabel:s,isDisabled:d,isLabeledByFormItem:g})=>{const _=Un(Gm,void 0),{formItem:o}=Ka(),{emit:S}=jo();function E($){var z,H,U,ie;return[!0,e.trueValue,e.trueLabel].includes($)?(H=(z=e.trueValue)!=null?z:e.trueLabel)!=null?H:!0:(ie=(U=e.falseValue)!=null?U:e.falseLabel)!=null?ie:!1}function I($,z){S("change",E($),z)}function P($){if(i.value)return;const z=$.target;S("change",E(z.checked),$)}async function F($){i.value||!s.value&&!d.value&&g.value&&($.composedPath().some(U=>U.tagName==="LABEL")||(t.value=E([!1,e.falseValue,e.falseLabel].includes(t.value)),await oo(),I(t.value,$)))}const B=te(()=>(_==null?void 0:_.validateEvent)||e.validateEvent);return tn(()=>e.modelValue,()=>{B.value&&(o==null||o.validate("change").catch($=>void 0))}),{handleChange:P,onClickRoot:F}},IZ=e=>{const t=Se(!1),{emit:i}=jo(),s=Un(Gm,void 0),d=te(()=>Hr(s)===!1),g=Se(!1),_=te({get(){var o,S;return d.value?(o=s==null?void 0:s.modelValue)==null?void 0:o.value:(S=e.modelValue)!=null?S:t.value},set(o){var S,E;d.value&&fn(o)?(g.value=((S=s==null?void 0:s.max)==null?void 0:S.value)!==void 0&&o.length>(s==null?void 0:s.max.value)&&o.length>_.value.length,g.value===!1&&((E=s==null?void 0:s.changeEvent)==null||E.call(s,o))):(i(Fo,o),t.value=o)}});return{model:_,isGroup:d,isLimitExceeded:g}},AZ=(e,t,{model:i})=>{const s=Un(Gm,void 0),d=Se(!1),g=te(()=>Bf(e.value)?e.label:e.value),_=te(()=>{const I=i.value;return ai(I)?I:fn(I)?Vo(g.value)?I.map(ei).some(P=>Oa(P,g.value)):I.map(ei).includes(g.value):I!=null?I===e.trueValue||I===e.trueLabel:!!I}),o=na(te(()=>{var I;return(I=s==null?void 0:s.size)==null?void 0:I.value}),{prop:!0}),S=na(te(()=>{var I;return(I=s==null?void 0:s.size)==null?void 0:I.value})),E=te(()=>!!t.default||!Bf(g.value));return{checkboxButtonSize:o,isChecked:_,isFocused:d,checkboxSize:S,hasOwnLabel:E,actualValue:g}},qL=(e,t)=>{const{formItem:i}=Ka(),{model:s,isGroup:d,isLimitExceeded:g}=IZ(e),{isFocused:_,isChecked:o,checkboxButtonSize:S,checkboxSize:E,hasOwnLabel:I,actualValue:P}=AZ(e,t,{model:s}),{isDisabled:F}=EZ({model:s,isChecked:o}),{inputId:B,isLabeledByFormItem:$}=ic(e,{formItemContext:i,disableIdGeneration:I,disableIdManagement:d}),{handleChange:z,onClickRoot:H}=MZ(e,{model:s,isLimitExceeded:g,hasOwnLabel:I,isDisabled:F,isLabeledByFormItem:$});return(()=>{function ie(){var Z,G;fn(s.value)&&!s.value.includes(P.value)?s.value.push(P.value):s.value=(G=(Z=e.trueValue)!=null?Z:e.trueLabel)!=null?G:!0}e.checked&&ie()})(),dh({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},te(()=>d.value&&Bf(e.value))),dh({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},te(()=>!!e.trueLabel)),dh({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},te(()=>!!e.falseLabel)),{inputId:B,isLabeledByFormItem:$,isChecked:o,isDisabled:F,isFocused:_,checkboxButtonSize:S,checkboxSize:E,hasOwnLabel:I,model:s,actualValue:P,handleChange:z,onClickRoot:H}},kZ=Ze({name:"ElCheckbox"}),PZ=Ze({...kZ,props:GL,emits:WL,setup(e){const t=e,i=aa(),{inputId:s,isLabeledByFormItem:d,isChecked:g,isDisabled:_,isFocused:o,checkboxSize:S,hasOwnLabel:E,model:I,actualValue:P,handleChange:F,onClickRoot:B}=qL(t,i),$=rn("checkbox"),z=te(()=>[$.b(),$.m(S.value),$.is("disabled",_.value),$.is("bordered",t.border),$.is("checked",g.value)]),H=te(()=>[$.e("input"),$.is("disabled",_.value),$.is("checked",g.value),$.is("indeterminate",t.indeterminate),$.is("focus",o.value)]);return(U,ie)=>(se(),Rt(Wo(!y(E)&&y(d)?"span":"label"),{class:de(y(z)),"aria-controls":U.indeterminate?U.ariaControls:null,onClick:y(B)},{default:at(()=>{var Z,G,Q,oe;return[He("span",{class:de(y(H))},[U.trueValue||U.falseValue||U.trueLabel||U.falseLabel?zo((se(),Pe("input",{key:0,id:y(s),"onUpdate:modelValue":le=>vi(I)?I.value=le:null,class:de(y($).e("original")),type:"checkbox",indeterminate:U.indeterminate,name:U.name,tabindex:U.tabindex,disabled:y(_),"true-value":(G=(Z=U.trueValue)!=null?Z:U.trueLabel)!=null?G:!0,"false-value":(oe=(Q=U.falseValue)!=null?Q:U.falseLabel)!=null?oe:!1,onChange:y(F),onFocus:le=>o.value=!0,onBlur:le=>o.value=!1,onClick:po(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[mb,y(I)]]):zo((se(),Pe("input",{key:1,id:y(s),"onUpdate:modelValue":le=>vi(I)?I.value=le:null,class:de(y($).e("original")),type:"checkbox",indeterminate:U.indeterminate,disabled:y(_),value:y(P),name:U.name,tabindex:U.tabindex,onChange:y(F),onFocus:le=>o.value=!0,onBlur:le=>o.value=!1,onClick:po(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[mb,y(I)]]),He("span",{class:de(y($).e("inner"))},null,2)],2),y(E)?(se(),Pe("span",{key:0,class:de(y($).e("label"))},[_t(U.$slots,"default"),U.$slots.default?St("v-if",!0):(se(),Pe(eo,{key:0},[nr(wn(U.label),1)],64))],2)):St("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var RZ=bn(PZ,[["__file","checkbox.vue"]]);const OZ=Ze({name:"ElCheckboxButton"}),LZ=Ze({...OZ,props:GL,emits:WL,setup(e){const t=e,i=aa(),{isFocused:s,isChecked:d,isDisabled:g,checkboxButtonSize:_,model:o,actualValue:S,handleChange:E}=qL(t,i),I=Un(Gm,void 0),P=rn("checkbox"),F=te(()=>{var $,z,H,U;const ie=(z=($=I==null?void 0:I.fill)==null?void 0:$.value)!=null?z:"";return{backgroundColor:ie,borderColor:ie,color:(U=(H=I==null?void 0:I.textColor)==null?void 0:H.value)!=null?U:"",boxShadow:ie?`-1px 0 0 0 ${ie}`:void 0}}),B=te(()=>[P.b("button"),P.bm("button",_.value),P.is("disabled",g.value),P.is("checked",d.value),P.is("focus",s.value)]);return($,z)=>{var H,U,ie,Z;return se(),Pe("label",{class:de(y(B))},[$.trueValue||$.falseValue||$.trueLabel||$.falseLabel?zo((se(),Pe("input",{key:0,"onUpdate:modelValue":G=>vi(o)?o.value=G:null,class:de(y(P).be("button","original")),type:"checkbox",name:$.name,tabindex:$.tabindex,disabled:y(g),"true-value":(U=(H=$.trueValue)!=null?H:$.trueLabel)!=null?U:!0,"false-value":(Z=(ie=$.falseValue)!=null?ie:$.falseLabel)!=null?Z:!1,onChange:y(E),onFocus:G=>s.value=!0,onBlur:G=>s.value=!1,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[mb,y(o)]]):zo((se(),Pe("input",{key:1,"onUpdate:modelValue":G=>vi(o)?o.value=G:null,class:de(y(P).be("button","original")),type:"checkbox",name:$.name,tabindex:$.tabindex,disabled:y(g),value:y(S),onChange:y(E),onFocus:G=>s.value=!0,onBlur:G=>s.value=!1,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[mb,y(o)]]),$.$slots.default||$.label?(se(),Pe("span",{key:2,class:de(y(P).be("button","inner")),style:to(y(d)?y(F):void 0)},[_t($.$slots,"default",{},()=>[nr(wn($.label),1)])],6)):St("v-if",!0)],2)}}});var KL=bn(LZ,[["__file","checkbox-button.vue"]]);const DZ=vn({modelValue:{type:ut(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:ia,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),zZ={[Fo]:e=>fn(e),change:e=>fn(e)},FZ=Ze({name:"ElCheckboxGroup"}),BZ=Ze({...FZ,props:DZ,emits:zZ,setup(e,{emit:t}){const i=e,s=rn("checkbox"),{formItem:d}=Ka(),{inputId:g,isLabeledByFormItem:_}=ic(i,{formItemContext:d}),o=async E=>{t(Fo,E),await oo(),t("change",E)},S=te({get(){return i.modelValue},set(E){o(E)}});return or(Gm,{...Uc(Ca(i),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:S,changeEvent:o}),tn(()=>i.modelValue,()=>{i.validateEvent&&(d==null||d.validate("change").catch(E=>void 0))}),(E,I)=>{var P;return se(),Rt(Wo(E.tag),{id:y(g),class:de(y(s).b("group")),role:"group","aria-label":y(_)?void 0:E.ariaLabel||"checkbox-group","aria-labelledby":y(_)?(P=y(d))==null?void 0:P.labelId:void 0},{default:at(()=>[_t(E.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var ZL=bn(BZ,[["__file","checkbox-group.vue"]]);const rc=Ao(RZ,{CheckboxButton:KL,CheckboxGroup:ZL}),NZ=Oi(KL),YL=Oi(ZL),XL=vn({modelValue:{type:[String,Number,Boolean],default:void 0},size:ia,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),$Z=vn({...XL,border:Boolean}),JL={[Fo]:e=>Zn(e)||ao(e)||ai(e),[Yr]:e=>Zn(e)||ao(e)||ai(e)},QL=Symbol("radioGroupKey"),eD=(e,t)=>{const i=Se(),s=Un(QL,void 0),d=te(()=>!!s),g=te(()=>Bf(e.value)?e.label:e.value),_=te({get(){return d.value?s.modelValue:e.modelValue},set(P){d.value?s.changeEvent(P):t&&t(Fo,P),i.value.checked=e.modelValue===g.value}}),o=na(te(()=>s==null?void 0:s.size)),S=Za(te(()=>s==null?void 0:s.disabled)),E=Se(!1),I=te(()=>S.value||d.value&&_.value!==g.value?-1:0);return dh({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},te(()=>d.value&&Bf(e.value))),{radioRef:i,isGroup:d,radioGroup:s,focus:E,size:o,disabled:S,tabIndex:I,modelValue:_,actualValue:g}},VZ=Ze({name:"ElRadio"}),UZ=Ze({...VZ,props:$Z,emits:JL,setup(e,{emit:t}){const i=e,s=rn("radio"),{radioRef:d,radioGroup:g,focus:_,size:o,disabled:S,modelValue:E,actualValue:I}=eD(i,t);function P(){oo(()=>t("change",E.value))}return(F,B)=>{var $;return se(),Pe("label",{class:de([y(s).b(),y(s).is("disabled",y(S)),y(s).is("focus",y(_)),y(s).is("bordered",F.border),y(s).is("checked",y(E)===y(I)),y(s).m(y(o))])},[He("span",{class:de([y(s).e("input"),y(s).is("disabled",y(S)),y(s).is("checked",y(E)===y(I))])},[zo(He("input",{ref_key:"radioRef",ref:d,"onUpdate:modelValue":z=>vi(E)?E.value=z:null,class:de(y(s).e("original")),value:y(I),name:F.name||(($=y(g))==null?void 0:$.name),disabled:y(S),checked:y(E)===y(I),type:"radio",onFocus:z=>_.value=!0,onBlur:z=>_.value=!1,onChange:P,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[zR,y(E)]]),He("span",{class:de(y(s).e("inner"))},null,2)],2),He("span",{class:de(y(s).e("label")),onKeydown:po(()=>{},["stop"])},[_t(F.$slots,"default",{},()=>[nr(wn(F.label),1)])],42,["onKeydown"])],2)}}});var jZ=bn(UZ,[["__file","radio.vue"]]);const HZ=vn({...XL}),GZ=Ze({name:"ElRadioButton"}),WZ=Ze({...GZ,props:HZ,setup(e){const t=e,i=rn("radio"),{radioRef:s,focus:d,size:g,disabled:_,modelValue:o,radioGroup:S,actualValue:E}=eD(t),I=te(()=>({backgroundColor:(S==null?void 0:S.fill)||"",borderColor:(S==null?void 0:S.fill)||"",boxShadow:S!=null&&S.fill?`-1px 0 0 0 ${S.fill}`:"",color:(S==null?void 0:S.textColor)||""}));return(P,F)=>{var B;return se(),Pe("label",{class:de([y(i).b("button"),y(i).is("active",y(o)===y(E)),y(i).is("disabled",y(_)),y(i).is("focus",y(d)),y(i).bm("button",y(g))])},[zo(He("input",{ref_key:"radioRef",ref:s,"onUpdate:modelValue":$=>vi(o)?o.value=$:null,class:de(y(i).be("button","original-radio")),value:y(E),type:"radio",name:P.name||((B=y(S))==null?void 0:B.name),disabled:y(_),onFocus:$=>d.value=!0,onBlur:$=>d.value=!1,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[zR,y(o)]]),He("span",{class:de(y(i).be("button","inner")),style:to(y(o)===y(E)?y(I):{}),onKeydown:po(()=>{},["stop"])},[_t(P.$slots,"default",{},()=>[nr(wn(P.label),1)])],46,["onKeydown"])],2)}}});var tD=bn(WZ,[["__file","radio-button.vue"]]);const qZ=vn({id:{type:String,default:void 0},size:ia,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),KZ=JL,ZZ=Ze({name:"ElRadioGroup"}),YZ=Ze({...ZZ,props:qZ,emits:KZ,setup(e,{emit:t}){const i=e,s=rn("radio"),d=La(),g=Se(),{formItem:_}=Ka(),{inputId:o,isLabeledByFormItem:S}=ic(i,{formItemContext:_}),E=P=>{t(Fo,P),oo(()=>t("change",P))};No(()=>{const P=g.value.querySelectorAll("[type=radio]"),F=P[0];!Array.from(P).some(B=>B.checked)&&F&&(F.tabIndex=0)});const I=te(()=>i.name||d.value);return or(QL,Pr({...Ca(i),changeEvent:E,name:I})),tn(()=>i.modelValue,()=>{i.validateEvent&&(_==null||_.validate("change").catch(P=>void 0))}),(P,F)=>(se(),Pe("div",{id:y(o),ref_key:"radioGroupRef",ref:g,class:de(y(s).b("group")),role:"radiogroup","aria-label":y(S)?void 0:P.ariaLabel||"radio-group","aria-labelledby":y(S)?y(_).labelId:void 0},[_t(P.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var nD=bn(YZ,[["__file","radio-group.vue"]]);const oD=Ao(jZ,{RadioButton:tD,RadioGroup:nD}),XZ=Oi(nD),JZ=Oi(tD);var QZ=Ze({name:"NodeContent",setup(){return{ns:rn("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:i}=this.$parent,{data:s,label:d}=t,{renderLabelFn:g}=i;return lo("span",{class:e.e("label")},g?g({node:t,data:s}):d)}});const MT=Symbol(),eY=Ze({name:"ElCascaderNode",components:{ElCheckbox:rc,ElRadio:oD,NodeContent:QZ,ElIcon:Gn,Check:D_,Loading:Cu,ArrowRight:Ls},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const i=Un(MT),s=rn("cascader-node"),d=te(()=>i.isHoverMenu),g=te(()=>i.config.multiple),_=te(()=>i.config.checkStrictly),o=te(()=>{var oe;return(oe=i.checkedNodes[0])==null?void 0:oe.uid}),S=te(()=>e.node.isDisabled),E=te(()=>e.node.isLeaf),I=te(()=>_.value&&!E.value||!S.value),P=te(()=>B(i.expandingNode)),F=te(()=>_.value&&i.checkedNodes.some(B)),B=oe=>{var le;const{level:me,uid:fe}=e.node;return((le=oe==null?void 0:oe.pathNodes[me-1])==null?void 0:le.uid)===fe},$=()=>{P.value||i.expandNode(e.node)},z=oe=>{const{node:le}=e;oe!==le.checked&&i.handleCheckChange(le,oe)},H=()=>{i.lazyLoad(e.node,()=>{E.value||$()})},U=oe=>{d.value&&(ie(),!E.value&&t("expand",oe))},ie=()=>{const{node:oe}=e;!I.value||oe.loading||(oe.loaded?$():H())},Z=()=>{d.value&&!E.value||(E.value&&!S.value&&!_.value&&!g.value?Q(!0):ie())},G=oe=>{_.value?(z(oe),e.node.loaded&&$()):Q(oe)},Q=oe=>{e.node.loaded?(z(oe),!_.value&&$()):H()};return{panel:i,isHoverMenu:d,multiple:g,checkStrictly:_,checkedNodeId:o,isDisabled:S,isLeaf:E,expandable:I,inExpandingPath:P,inCheckedPath:F,ns:s,handleHoverExpand:U,handleExpand:ie,handleClick:Z,handleCheck:Q,handleSelectCheck:G}}});function tY(e,t,i,s,d,g){const _=Go("el-checkbox"),o=Go("el-radio"),S=Go("check"),E=Go("el-icon"),I=Go("node-content"),P=Go("loading"),F=Go("arrow-right");return se(),Pe("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:de([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[St(" prefix "),e.multiple?(se(),Rt(_,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:po(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(se(),Rt(o,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:po(()=>{},["stop"])},{default:at(()=>[St(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),He("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(se(),Rt(E,{key:2,class:de(e.ns.e("prefix"))},{default:at(()=>[Qe(S)]),_:1},8,["class"])):St("v-if",!0),St(" content "),Qe(I),St(" postfix "),e.isLeaf?St("v-if",!0):(se(),Pe(eo,{key:3},[e.node.loading?(se(),Rt(E,{key:0,class:de([e.ns.is("loading"),e.ns.e("postfix")])},{default:at(()=>[Qe(P)]),_:1},8,["class"])):(se(),Rt(E,{key:1,class:de(["arrow-right",e.ns.e("postfix")])},{default:at(()=>[Qe(F)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var nY=bn(eY,[["render",tY],["__file","node.vue"]]);const oY=Ze({name:"ElCascaderMenu",components:{Loading:Cu,ElIcon:Gn,ElScrollbar:Pu,ElCascaderNode:nY},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=jo(),i=rn("cascader-menu"),{t:s}=vr(),d=La();let g=null,_=null;const o=Un(MT),S=Se(null),E=te(()=>!e.nodes.length),I=te(()=>!o.initialLoaded),P=te(()=>`${d.value}-${e.index}`),F=H=>{g=H.target},B=H=>{if(!(!o.isHoverMenu||!g||!S.value))if(g.contains(H.target)){$();const U=t.vnode.el,{left:ie}=U.getBoundingClientRect(),{offsetWidth:Z,offsetHeight:G}=U,Q=H.clientX-ie,oe=g.offsetTop,le=oe+g.offsetHeight;S.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${Q} ${oe} L${Z} 0 V${oe} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${Q} ${le} L${Z} ${G} V${le} Z" />
        `}else _||(_=window.setTimeout(z,o.config.hoverThreshold))},$=()=>{_&&(clearTimeout(_),_=null)},z=()=>{S.value&&(S.value.innerHTML="",$())};return{ns:i,panel:o,hoverZone:S,isEmpty:E,isLoading:I,menuId:P,t:s,handleExpand:F,handleMouseMove:B,clearHoverZone:z}}});function rY(e,t,i,s,d,g){const _=Go("el-cascader-node"),o=Go("loading"),S=Go("el-icon"),E=Go("el-scrollbar");return se(),Rt(E,{key:e.menuId,tag:"ul",role:"menu",class:de(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:at(()=>{var I;return[(se(!0),Pe(eo,null,tr(e.nodes,P=>(se(),Rt(_,{key:P.uid,node:P,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(se(),Pe("div",{key:0,class:de(e.ns.e("empty-text"))},[Qe(S,{size:"14",class:de(e.ns.is("loading"))},{default:at(()=>[Qe(o)]),_:1},8,["class"]),nr(" "+wn(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(se(),Pe("div",{key:1,class:de(e.ns.e("empty-text"))},[_t(e.$slots,"empty",{},()=>[nr(wn(e.t("el.cascader.noData")),1)])],2)):(I=e.panel)!=null&&I.isHoverMenu?(se(),Pe("svg",{key:2,ref:"hoverZone",class:de(e.ns.e("hover-zone"))},null,2)):St("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var iY=bn(oY,[["render",rY],["__file","menu.vue"]]);const IT=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),bu=e=>M_(e);let aY=0;const sY=e=>{const t=[e];let{parent:i}=e;for(;i;)t.unshift(i),i=i.parent;return t};let w2=class S2{constructor(t,i,s,d=!1){this.data=t,this.config=i,this.parent=s,this.root=d,this.uid=aY++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:g,label:_,children:o}=i,S=t[o],E=sY(this);this.level=d?0:s?s.level+1:1,this.value=t[g],this.label=t[_],this.pathNodes=E,this.pathValues=E.map(I=>I.value),this.pathLabels=E.map(I=>I.label),this.childrenData=S,this.children=(S||[]).map(I=>new S2(I,i,this)),this.loaded=!i.lazy||this.isLeaf||!yl(S)}get isDisabled(){const{data:t,parent:i,config:s}=this,{disabled:d,checkStrictly:g}=s;return(Qn(d)?d(t,this):!!t[d])||!g&&(i==null?void 0:i.isDisabled)}get isLeaf(){const{data:t,config:i,childrenData:s,loaded:d}=this,{lazy:g,leaf:_}=i,o=Qn(_)?_(t,this):t[_];return Hr(o)?g&&!d?!1:!(fn(s)&&s.length):!!o}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:i,children:s}=this,d=new S2(t,this.config,this);return fn(i)?i.push(t):this.childrenData=[t],s.push(d),d}calcText(t,i){const s=t?this.pathLabels.join(i):this.label;return this.text=s,s}broadcast(t,...i){const s=`onParent${bu(t)}`;this.children.forEach(d=>{d&&(d.broadcast(t,...i),d[s]&&d[s](...i))})}emit(t,...i){const{parent:s}=this,d=`onChild${bu(t)}`;s&&(s[d]&&s[d](...i),s.emit(t,...i))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,i=t.filter(d=>!d.isDisabled),s=i.length?i.every(d=>d.checked):!1;this.setCheckState(s)}setCheckState(t){const i=this.children.length,s=this.children.reduce((d,g)=>{const _=g.checked?1:g.indeterminate?.5:0;return d+_},0);this.checked=this.loaded&&this.children.filter(d=>!d.isDisabled).every(d=>d.loaded&&d.checked)&&t,this.indeterminate=this.loaded&&s!==i&&s>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:i,multiple:s}=this.config;i||!s?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const T2=(e,t)=>e.reduce((i,s)=>(s.isLeaf?i.push(s):(!t&&i.push(s),i=i.concat(T2(s.children,t))),i),[]);class tP{constructor(t,i){this.config=i;const s=(t||[]).map(d=>new w2(d,this.config));this.nodes=s,this.allNodes=T2(s,!1),this.leafNodes=T2(s,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,i){const s=i?i.appendChild(t):new w2(t,this.config);i||this.nodes.push(s),this.allNodes.push(s),s.isLeaf&&this.leafNodes.push(s)}appendNodes(t,i){t.forEach(s=>this.appendNode(s,i))}getNodeByValue(t,i=!1){return!t&&t!==0?null:this.getFlattedNodes(i).find(d=>Oa(d.value,t)||Oa(d.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:s,level:d})=>Oa(t.value,s)&&t.level===d)||null}}const rD=vn({modelValue:{type:ut([Number,String,Array])},options:{type:ut(Array),default:()=>[]},props:{type:ut(Object),default:()=>({})}}),lY={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:jr,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},cY=e=>te(()=>({...lY,...e.props})),nP=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},uY=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():cL(e)&&e.click()},dY=(e,t)=>{const i=t.slice(0),s=i.map(g=>g.uid),d=e.reduce((g,_)=>{const o=s.indexOf(_.uid);return o>-1&&(g.push(_),i.splice(o,1),s.splice(o,1)),g},[]);return d.push(...i),d},oP=e=>[...new Set(e)],Rs=e=>!e&&e!==0?[]:fn(e)?e:[e],hY=Ze({name:"ElCascaderPanel",components:{ElCascaderMenu:iY},props:{...rD,border:{type:Boolean,default:!0},renderLabel:Function},emits:[Fo,Yr,"close","expand-change"],setup(e,{emit:t,slots:i}){let s=!1;const d=rn("cascader"),g=cY(e);let _=null;const o=Se(!0),S=Se([]),E=Se(null),I=Se([]),P=Se(null),F=Se([]),B=te(()=>g.value.expandTrigger==="hover"),$=te(()=>e.renderLabel||i.default),z=()=>{const{options:ye}=e,De=g.value;s=!1,_=new tP(ye,De),I.value=[_.getNodes()],De.lazy&&yl(e.options)?(o.value=!1,H(void 0,tt=>{tt&&(_=new tP(tt,De),I.value=[_.getNodes()]),o.value=!0,me(!1,!0)})):me(!1,!0)},H=(ye,De)=>{const tt=g.value;ye=ye||new w2({},tt,void 0,!0),ye.loading=!0;const Me=xe=>{const Ae=ye,Ce=Ae.root?null:Ae;xe&&(_==null||_.appendNodes(xe,Ce)),Ae.loading=!1,Ae.loaded=!0,Ae.childrenData=Ae.childrenData||[],De&&De(xe)};tt.lazyLoad(ye,Me)},U=(ye,De)=>{var tt;const{level:Me}=ye,xe=I.value.slice(0,Me);let Ae;ye.isLeaf?Ae=ye.pathNodes[Me-2]:(Ae=ye,xe.push(ye.children)),((tt=P.value)==null?void 0:tt.uid)!==(Ae==null?void 0:Ae.uid)&&(P.value=ye,I.value=xe,!De&&t("expand-change",(ye==null?void 0:ye.pathValues)||[]))},ie=(ye,De,tt=!0)=>{const{checkStrictly:Me,multiple:xe}=g.value,Ae=F.value[0];s=!0,!xe&&(Ae==null||Ae.doCheck(!1)),ye.doCheck(De),le(),tt&&!xe&&!Me&&t("close"),!tt&&!xe&&!Me&&Z(ye)},Z=ye=>{ye&&(ye=ye.parent,Z(ye),ye&&U(ye))},G=ye=>_==null?void 0:_.getFlattedNodes(ye),Q=ye=>{var De;return(De=G(ye))==null?void 0:De.filter(tt=>tt.checked!==!1)},oe=()=>{F.value.forEach(ye=>ye.doCheck(!1)),le(),I.value=I.value.slice(0,1),P.value=null,t("expand-change",[])},le=()=>{var ye;const{checkStrictly:De,multiple:tt}=g.value,Me=F.value,xe=Q(!De),Ae=dY(Me,xe),Ce=Ae.map(ge=>ge.valueByOption);F.value=Ae,E.value=tt?Ce:(ye=Ce[0])!=null?ye:null},me=(ye=!1,De=!1)=>{const{modelValue:tt}=e,{lazy:Me,multiple:xe,checkStrictly:Ae}=g.value,Ce=!Ae;if(!(!o.value||s||!De&&Oa(tt,E.value)))if(Me&&!ye){const Ne=oP(dH(Rs(tt))).map(We=>_==null?void 0:_.getNodeByValue(We)).filter(We=>!!We&&!We.loaded&&!We.loading);Ne.length?Ne.forEach(We=>{H(We,()=>me(!1,De))}):me(!0,De)}else{const ge=xe?Rs(tt):[tt],Ne=oP(ge.map(We=>_==null?void 0:_.getNodeByValue(We,Ce)));fe(Ne,De),E.value=_b(tt)}},fe=(ye,De=!0)=>{const{checkStrictly:tt}=g.value,Me=F.value,xe=ye.filter(ge=>!!ge&&(tt||ge.isLeaf)),Ae=_==null?void 0:_.getSameNode(P.value),Ce=De&&Ae||xe[0];Ce?Ce.pathNodes.forEach(ge=>U(ge,!0)):P.value=null,Me.forEach(ge=>ge.doCheck(!1)),Pr(xe).forEach(ge=>ge.doCheck(!0)),F.value=xe,oo(ce)},ce=()=>{gr&&S.value.forEach(ye=>{const De=ye==null?void 0:ye.$el;if(De){const tt=De.querySelector(`.${d.namespace.value}-scrollbar__wrap`),Me=De.querySelector(`.${d.b("node")}.${d.is("active")}`)||De.querySelector(`.${d.b("node")}.in-active-path`);rT(tt,Me)}})},pe=ye=>{const De=ye.target,{code:tt}=ye;switch(tt){case On.up:case On.down:{ye.preventDefault();const Me=tt===On.up?-1:1;G0(uL(De,Me,`.${d.b("node")}[tabindex="-1"]`));break}case On.left:{ye.preventDefault();const Me=S.value[nP(De)-1],xe=Me==null?void 0:Me.$el.querySelector(`.${d.b("node")}[aria-expanded="true"]`);G0(xe);break}case On.right:{ye.preventDefault();const Me=S.value[nP(De)+1],xe=Me==null?void 0:Me.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`);G0(xe);break}case On.enter:case On.numpadEnter:uY(De);break}};return or(MT,Pr({config:g,expandingNode:P,checkedNodes:F,isHoverMenu:B,initialLoaded:o,renderLabelFn:$,lazyLoad:H,expandNode:U,handleCheckChange:ie})),tn([g,()=>e.options],z,{deep:!0,immediate:!0}),tn(()=>e.modelValue,()=>{s=!1,me()},{deep:!0}),tn(()=>E.value,ye=>{Oa(ye,e.modelValue)||(t(Fo,ye),t(Yr,ye))}),oR(()=>S.value=[]),No(()=>!yl(e.modelValue)&&me()),{ns:d,menuList:S,menus:I,checkedNodes:F,handleKeyDown:pe,handleCheckChange:ie,getFlattedNodes:G,getCheckedNodes:Q,clearCheckedNodes:oe,calculateCheckedValue:le,scrollToExpandingNode:ce}}});function fY(e,t,i,s,d,g){const _=Go("el-cascader-menu");return se(),Pe("div",{class:de([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(se(!0),Pe(eo,null,tr(e.menus,(o,S)=>(se(),Rt(_,{key:S,ref_for:!0,ref:E=>e.menuList[S]=E,index:S,nodes:[...o]},{empty:at(()=>[_t(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var pY=bn(hY,[["render",fY],["__file","index.vue"]]);const iD=Ao(pY),od=vn({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:ku},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),mY={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},gY=Ze({name:"ElTag"}),vY=Ze({...gY,props:od,emits:mY,setup(e,{emit:t}){const i=e,s=na(),d=rn("tag"),g=te(()=>{const{type:E,hit:I,effect:P,closable:F,round:B}=i;return[d.b(),d.is("closable",F),d.m(E||"primary"),d.m(s.value),d.m(P),d.is("hit",I),d.is("round",B)]}),_=E=>{t("close",E)},o=E=>{t("click",E)},S=E=>{var I,P,F;(F=(P=(I=E==null?void 0:E.component)==null?void 0:I.subTree)==null?void 0:P.component)!=null&&F.bum&&(E.component.subTree.component.bum=null)};return(E,I)=>E.disableTransitions?(se(),Pe("span",{key:0,class:de(y(g)),style:to({backgroundColor:E.color}),onClick:o},[He("span",{class:de(y(d).e("content"))},[_t(E.$slots,"default")],2),E.closable?(se(),Rt(y(Gn),{key:0,class:de(y(d).e("close")),onClick:po(_,["stop"])},{default:at(()=>[Qe(y(Kc))]),_:1},8,["class","onClick"])):St("v-if",!0)],6)):(se(),Rt(Ea,{key:1,name:`${y(d).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:S},{default:at(()=>[He("span",{class:de(y(g)),style:to({backgroundColor:E.color}),onClick:o},[He("span",{class:de(y(d).e("content"))},[_t(E.$slots,"default")],2),E.closable?(se(),Rt(y(Gn),{key:0,class:de(y(d).e("close")),onClick:po(_,["stop"])},{default:at(()=>[Qe(y(Kc))]),_:1},8,["class","onClick"])):St("v-if",!0)],6)]),_:3},8,["name"]))}});var _Y=bn(vY,[["__file","tag.vue"]]);const Em=Ao(_Y),yY=vn({...rD,size:ia,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:ut(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:ut(Function),default:()=>!0},placement:{type:ut(String),values:dd,default:"bottom-start"},fallbackPlacements:{type:ut(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:wa.teleported,tagType:{...od.type,default:"info"},tagEffect:{...od.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...Um}),bY={[Fo]:e=>!0,[Yr]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>ai(e),expandChange:e=>!!e,removeTag:e=>!!e},th=new Map;if(gr){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const i of th.values())for(const{documentHandler:s}of i)s(t,e);e=void 0}})}function rP(e,t){let i=[];return fn(t.arg)?i=t.arg:Tl(t.arg)&&i.push(t.arg),function(s,d){const g=t.instance.popperRef,_=s.target,o=d==null?void 0:d.target,S=!t||!t.instance,E=!_||!o,I=e.contains(_)||e.contains(o),P=e===_,F=i.length&&i.some($=>$==null?void 0:$.contains(_))||i.length&&i.includes(o),B=g&&(g.contains(_)||g.contains(o));S||E||I||P||F||B||t.value(s,d)}}const rd={beforeMount(e,t){th.has(e)||th.set(e,[]),th.get(e).push({documentHandler:rP(e,t),bindingFn:t.value})},updated(e,t){th.has(e)||th.set(e,[]);const i=th.get(e),s=i.findIndex(g=>g.bindingFn===t.oldValue),d={documentHandler:rP(e,t),bindingFn:t.value};s>=0?i.splice(s,1,d):i.push(d)},unmounted(e){th.delete(e)}},xY="ElCascader",wY=Ze({name:xY}),SY=Ze({...wY,props:yY,emits:bY,setup(e,{expose:t,emit:i}){const s=e,d={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:ft})=>{const{modifiersData:un,placement:Je}=ft;["right","left","bottom","top"].includes(Je)||(un.arrow.x=35)},requires:["arrow"]}]},g=Mh();let _=0,o=0;const S=rn("cascader"),E=rn("input"),{t:I}=vr(),{form:P,formItem:F}=Ka(),{valueOnClear:B}=a1(s),{isComposing:$,handleComposition:z}=F_({afterComposition(ft){var un;const Je=(un=ft.target)==null?void 0:un.value;Dt(Je)}}),H=Se(null),U=Se(null),ie=Se(null),Z=Se(null),G=Se(null),Q=Se(!1),oe=Se(!1),le=Se(!1),me=Se(!1),fe=Se(""),ce=Se(""),pe=Se([]),ye=Se([]),De=Se([]),tt=te(()=>g.style),Me=te(()=>s.disabled||(P==null?void 0:P.disabled)),xe=te(()=>s.placeholder||I("el.cascader.placeholder")),Ae=te(()=>ce.value||pe.value.length>0||$.value?"":xe.value),Ce=na(),ge=te(()=>Ce.value==="small"?"small":"default"),Ne=te(()=>!!s.props.multiple),We=te(()=>!s.filterable||Ne.value),ot=te(()=>Ne.value?ce.value:fe.value),Oe=te(()=>{var ft;return((ft=Z.value)==null?void 0:ft.checkedNodes)||[]}),Ct=te(()=>!s.clearable||Me.value||le.value||!oe.value?!1:!!Oe.value.length),Mt=te(()=>{const{showAllLevels:ft,separator:un}=s,Je=Oe.value;return Je.length?Ne.value?"":Je[0].calcText(ft,un):""}),zt=te(()=>(F==null?void 0:F.validateState)||""),bt=te({get(){return _b(s.modelValue)},set(ft){const un=ft??B.value;i(Fo,un),i(Yr,un),s.validateEvent&&(F==null||F.validate("change").catch(Je=>void 0))}}),Kt=te(()=>[S.b(),S.m(Ce.value),S.is("disabled",Me.value),g.class]),$t=te(()=>[E.e("icon"),"icon-arrow-down",S.is("reverse",Q.value)]),Re=te(()=>S.is("focus",Q.value||me.value)),dn=te(()=>{var ft,un;return(un=(ft=H.value)==null?void 0:ft.popperRef)==null?void 0:un.contentRef}),At=ft=>{var un,Je,Mn;Me.value||(ft=ft??!Q.value,ft!==Q.value&&(Q.value=ft,(Je=(un=U.value)==null?void 0:un.input)==null||Je.setAttribute("aria-expanded",`${ft}`),ft?(Ke(),oo((Mn=Z.value)==null?void 0:Mn.scrollToExpandingNode)):s.filterable&&kn(),i("visibleChange",ft)))},Ke=()=>{oo(()=>{var ft;(ft=H.value)==null||ft.updatePopper()})},Be=()=>{le.value=!1},Ht=ft=>{const{showAllLevels:un,separator:Je}=s;return{node:ft,key:ft.uid,text:ft.calcText(un,Je),hitState:!1,closable:!Me.value&&!ft.isDisabled,isCollapseTag:!1}},Ut=ft=>{var un;const Je=ft.node;Je.doCheck(!1),(un=Z.value)==null||un.calculateCheckedValue(),i("removeTag",Je.valueByOption)},Nt=()=>{if(!Ne.value)return;const ft=Oe.value,un=[],Je=[];if(ft.forEach(Mn=>Je.push(Ht(Mn))),ye.value=Je,ft.length){ft.slice(0,s.maxCollapseTags).forEach(Oo=>un.push(Ht(Oo)));const Mn=ft.slice(s.maxCollapseTags),Bn=Mn.length;Bn&&(s.collapseTags?un.push({key:-1,text:`+ ${Bn}`,closable:!1,isCollapseTag:!0}):Mn.forEach(Oo=>un.push(Ht(Oo))))}pe.value=un},Et=()=>{var ft,un;const{filterMethod:Je,showAllLevels:Mn,separator:Bn}=s,Oo=(un=(ft=Z.value)==null?void 0:ft.getFlattedNodes(!s.props.checkStrictly))==null?void 0:un.filter(Rr=>Rr.isDisabled?!1:(Rr.calcText(Mn,Bn),Je(Rr,ot.value)));Ne.value&&(pe.value.forEach(Rr=>{Rr.hitState=!1}),ye.value.forEach(Rr=>{Rr.hitState=!1})),le.value=!0,De.value=Oo,Ke()},Gt=()=>{var ft;let un;le.value&&G.value?un=G.value.$el.querySelector(`.${S.e("suggestion-item")}`):un=(ft=Z.value)==null?void 0:ft.$el.querySelector(`.${S.b("node")}[tabindex="-1"]`),un&&(un.focus(),!le.value&&un.click())},ln=()=>{var ft,un;const Je=(ft=U.value)==null?void 0:ft.input,Mn=ie.value,Bn=(un=G.value)==null?void 0:un.$el;if(!(!gr||!Je)){if(Bn){const Oo=Bn.querySelector(`.${S.e("suggestion-list")}`);Oo.style.minWidth=`${Je.offsetWidth}px`}if(Mn){const{offsetHeight:Oo}=Mn,Rr=pe.value.length>0?`${Math.max(Oo,_)-2}px`:`${_}px`;Je.style.height=Rr,Ke()}}},yn=ft=>{var un;return(un=Z.value)==null?void 0:un.getCheckedNodes(ft)},_n=ft=>{Ke(),i("expandChange",ft)},jn=ft=>{if(!$.value)switch(ft.code){case On.enter:case On.numpadEnter:At();break;case On.down:At(!0),oo(Gt),ft.preventDefault();break;case On.esc:Q.value===!0&&(ft.preventDefault(),ft.stopPropagation(),At(!1));break;case On.tab:At(!1);break}},yt=()=>{var ft;(ft=Z.value)==null||ft.clearCheckedNodes(),!Q.value&&s.filterable&&kn(),At(!1),i("clear")},kn=()=>{const{value:ft}=Mt;fe.value=ft,ce.value=ft},qn=ft=>{var un,Je;const{checked:Mn}=ft;Ne.value?(un=Z.value)==null||un.handleCheckChange(ft,!Mn,!1):(!Mn&&((Je=Z.value)==null||Je.handleCheckChange(ft,!0,!1)),At(!1))},Co=ft=>{const un=ft.target,{code:Je}=ft;switch(Je){case On.up:case On.down:{const Mn=Je===On.up?-1:1;G0(uL(un,Mn,`.${S.e("suggestion-item")}[tabindex="-1"]`));break}case On.enter:case On.numpadEnter:un.click();break}},mo=()=>{const ft=pe.value,un=ft[ft.length-1];o=ce.value?0:o+1,!(!un||!o||s.collapseTags&&ft.length>1)&&(un.hitState?Ut(un):un.hitState=!0)},Io=ft=>{const un=ft.target,Je=S.e("search-input");un.className===Je&&(me.value=!0),i("focus",ft)},Ho=ft=>{me.value=!1,i("blur",ft)},ur=ol(()=>{const{value:ft}=ot;if(!ft)return;const un=s.beforeFilter(ft);Xv(un)?un.then(Et).catch(()=>{}):un!==!1?Et():Be()},s.debounce),Dt=(ft,un)=>{!Q.value&&At(!0),!(un!=null&&un.isComposing)&&(ft?ur():Be())},En=ft=>Number.parseFloat(WH(E.cssVarName("input-height"),ft).value)-2;return tn(le,Ke),tn([Oe,Me,()=>s.collapseTags],Nt),tn(pe,()=>{oo(()=>ln())}),tn(Ce,async()=>{await oo();const ft=U.value.input;_=En(ft)||_,ln()}),tn(Mt,kn,{immediate:!0}),No(()=>{const ft=U.value.input,un=En(ft);_=ft.offsetHeight||un,Mi(ft,ln)}),t({getCheckedNodes:yn,cascaderPanelRef:Z,togglePopperVisible:At,contentRef:dn,presentText:Mt}),(ft,un)=>(se(),Rt(y(qa),{ref_key:"tooltipRef",ref:H,visible:Q.value,teleported:ft.teleported,"popper-class":[y(S).e("dropdown"),ft.popperClass],"popper-options":d,"fallback-placements":ft.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:ft.placement,transition:`${y(S).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:ft.persistent,onHide:Be},{default:at(()=>[zo((se(),Pe("div",{class:de(y(Kt)),style:to(y(tt)),onClick:()=>At(y(We)?void 0:!0),onKeydown:jn,onMouseenter:Je=>oe.value=!0,onMouseleave:Je=>oe.value=!1},[Qe(y(hs),{ref_key:"input",ref:U,modelValue:fe.value,"onUpdate:modelValue":Je=>fe.value=Je,placeholder:y(Ae),readonly:y(We),disabled:y(Me),"validate-event":!1,size:y(Ce),class:de(y(Re)),tabindex:y(Ne)&&ft.filterable&&!y(Me)?-1:void 0,onCompositionstart:y(z),onCompositionupdate:y(z),onCompositionend:y(z),onFocus:Io,onBlur:Ho,onInput:Dt},{suffix:at(()=>[y(Ct)?(se(),Rt(y(Gn),{key:"clear",class:de([y(E).e("icon"),"icon-circle-close"]),onClick:po(yt,["stop"])},{default:at(()=>[Qe(y(ud))]),_:1},8,["class","onClick"])):(se(),Rt(y(Gn),{key:"arrow-down",class:de(y($t)),onClick:po(Je=>At(),["stop"])},{default:at(()=>[Qe(y(cd))]),_:1},8,["class","onClick"]))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),y(Ne)?(se(),Pe("div",{key:0,ref_key:"tagWrapper",ref:ie,class:de([y(S).e("tags"),y(S).is("validate",!!y(zt))])},[(se(!0),Pe(eo,null,tr(pe.value,Je=>(se(),Rt(y(Em),{key:Je.key,type:ft.tagType,size:y(ge),effect:ft.tagEffect,hit:Je.hitState,closable:Je.closable,"disable-transitions":"",onClose:Mn=>Ut(Je)},{default:at(()=>[Je.isCollapseTag===!1?(se(),Pe("span",{key:0},wn(Je.text),1)):(se(),Rt(y(qa),{key:1,disabled:Q.value||!ft.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:at(()=>[He("span",null,wn(Je.text),1)]),content:at(()=>[He("div",{class:de(y(S).e("collapse-tags"))},[(se(!0),Pe(eo,null,tr(ye.value.slice(ft.maxCollapseTags),(Mn,Bn)=>(se(),Pe("div",{key:Bn,class:de(y(S).e("collapse-tag"))},[(se(),Rt(y(Em),{key:Mn.key,class:"in-tooltip",type:ft.tagType,size:y(ge),effect:ft.tagEffect,hit:Mn.hitState,closable:Mn.closable,"disable-transitions":"",onClose:Oo=>Ut(Mn)},{default:at(()=>[He("span",null,wn(Mn.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),ft.filterable&&!y(Me)?zo((se(),Pe("input",{key:0,"onUpdate:modelValue":Je=>ce.value=Je,type:"text",class:de(y(S).e("search-input")),placeholder:y(Mt)?"":y(xe),onInput:Je=>Dt(ce.value,Je),onClick:po(Je=>At(!0),["stop"]),onKeydown:ti(mo,["delete"]),onCompositionstart:y(z),onCompositionupdate:y(z),onCompositionend:y(z),onFocus:Io,onBlur:Ho},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[Xb,ce.value]]):St("v-if",!0)],2)):St("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[y(rd),()=>At(!1),y(dn)]])]),content:at(()=>[zo(Qe(y(iD),{ref_key:"cascaderPanelRef",ref:Z,modelValue:y(bt),"onUpdate:modelValue":Je=>vi(bt)?bt.value=Je:null,options:ft.options,props:s.props,border:!1,"render-label":ft.$slots.default,onExpandChange:_n,onClose:Je=>ft.$nextTick(()=>At(!1))},{empty:at(()=>[_t(ft.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[Cr,!le.value]]),ft.filterable?zo((se(),Rt(y(Pu),{key:0,ref_key:"suggestionPanel",ref:G,tag:"ul",class:de(y(S).e("suggestion-panel")),"view-class":y(S).e("suggestion-list"),onKeydown:Co},{default:at(()=>[De.value.length?(se(!0),Pe(eo,{key:0},tr(De.value,Je=>(se(),Pe("li",{key:Je.uid,class:de([y(S).e("suggestion-item"),y(S).is("checked",Je.checked)]),tabindex:-1,onClick:Mn=>qn(Je)},[He("span",null,wn(Je.text),1),Je.checked?(se(),Rt(y(Gn),{key:0},{default:at(()=>[Qe(y(D_))]),_:1})):St("v-if",!0)],10,["onClick"]))),128)):_t(ft.$slots,"empty",{key:1},()=>[He("li",{class:de(y(S).e("empty-text"))},wn(y(I)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[Cr,le.value]]):St("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var TY=bn(SY,[["__file","cascader.vue"]]);const CY=Ao(TY),EY=vn({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),MY={"update:checked":e=>ai(e),[Yr]:e=>ai(e)},IY=Ze({name:"ElCheckTag"}),AY=Ze({...IY,props:EY,emits:MY,setup(e,{emit:t}){const i=e,s=rn("check-tag"),d=te(()=>i.disabled),g=te(()=>[s.b(),s.is("checked",i.checked),s.is("disabled",d.value),s.m(i.type||"primary")]),_=()=>{if(d.value)return;const o=!i.checked;t(Yr,o),t("update:checked",o)};return(o,S)=>(se(),Pe("span",{class:de(y(g)),onClick:_},[_t(o.$slots,"default")],2))}});var kY=bn(AY,[["__file","check-tag.vue"]]);const PY=Ao(kY),RY=vn({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:ut([Number,Object]),default:()=>Ri({})},sm:{type:ut([Number,Object]),default:()=>Ri({})},md:{type:ut([Number,Object]),default:()=>Ri({})},lg:{type:ut([Number,Object]),default:()=>Ri({})},xl:{type:ut([Number,Object]),default:()=>Ri({})}}),aD=Symbol("rowContextKey"),OY=Ze({name:"ElCol"}),LY=Ze({...OY,props:RY,setup(e){const t=e,{gutter:i}=Un(aD,{gutter:te(()=>0)}),s=rn("col"),d=te(()=>{const _={};return i.value&&(_.paddingLeft=_.paddingRight=`${i.value/2}px`),_}),g=te(()=>{const _=[];return["span","offset","pull","push"].forEach(E=>{const I=t[E];ao(I)&&(E==="span"?_.push(s.b(`${t[E]}`)):I>0&&_.push(s.b(`${E}-${t[E]}`)))}),["xs","sm","md","lg","xl"].forEach(E=>{ao(t[E])?_.push(s.b(`${E}-${t[E]}`)):Vo(t[E])&&Object.entries(t[E]).forEach(([I,P])=>{_.push(I!=="span"?s.b(`${E}-${I}-${P}`):s.b(`${E}-${P}`))})}),i.value&&_.push(s.is("guttered")),[s.b(),_]});return(_,o)=>(se(),Rt(Wo(_.tag),{class:de(y(g)),style:to(y(d))},{default:at(()=>[_t(_.$slots,"default")]),_:3},8,["class","style"]))}});var DY=bn(LY,[["__file","col.vue"]]);const zY=Ao(DY),iP=e=>ao(e)||Zn(e)||fn(e),FY=vn({accordion:Boolean,modelValue:{type:ut([Array,String,Number]),default:()=>Ri([])}}),BY={[Fo]:iP,[Yr]:iP},sD=Symbol("collapseContextKey"),NY=(e,t)=>{const i=Se(us(e.modelValue)),s=g=>{i.value=g;const _=e.accordion?i.value[0]:i.value;t(Fo,_),t(Yr,_)},d=g=>{if(e.accordion)s([i.value[0]===g?"":g]);else{const _=[...i.value],o=_.indexOf(g);o>-1?_.splice(o,1):_.push(g),s(_)}};return tn(()=>e.modelValue,()=>i.value=us(e.modelValue),{deep:!0}),or(sD,{activeNames:i,handleItemClick:d}),{activeNames:i,setActiveNames:s}},$Y=()=>{const e=rn("collapse");return{rootKls:te(()=>e.b())}},VY=Ze({name:"ElCollapse"}),UY=Ze({...VY,props:FY,emits:BY,setup(e,{expose:t,emit:i}){const s=e,{activeNames:d,setActiveNames:g}=NY(s,i),{rootKls:_}=$Y();return t({activeNames:d,setActiveNames:g}),(o,S)=>(se(),Pe("div",{class:de(y(_))},[_t(o.$slots,"default")],2))}});var jY=bn(UY,[["__file","collapse.vue"]]);const HY=Ze({name:"ElCollapseTransition"}),GY=Ze({...HY,setup(e){const t=rn("collapse-transition"),i=d=>{d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom},s={beforeEnter(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.style.height&&(d.dataset.elExistsHeight=d.style.height),d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0},enter(d){requestAnimationFrame(()=>{d.dataset.oldOverflow=d.style.overflow,d.dataset.elExistsHeight?d.style.maxHeight=d.dataset.elExistsHeight:d.scrollHeight!==0?d.style.maxHeight=`${d.scrollHeight}px`:d.style.maxHeight=0,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom,d.style.overflow="hidden"})},afterEnter(d){d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow},enterCancelled(d){i(d)},beforeLeave(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.dataset.oldOverflow=d.style.overflow,d.style.maxHeight=`${d.scrollHeight}px`,d.style.overflow="hidden"},leave(d){d.scrollHeight!==0&&(d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0)},afterLeave(d){i(d)},leaveCancelled(d){i(d)}};return(d,g)=>(se(),Rt(Ea,Yo({name:y(t).b()},I5(s)),{default:at(()=>[_t(d.$slots,"default")]),_:3},16,["name"]))}});var WY=bn(GY,[["__file","collapse-transition.vue"]]);const m1=Ao(WY),qY=vn({title:{type:String,default:""},name:{type:ut([String,Number]),default:void 0},icon:{type:Xr,default:Ls},disabled:Boolean}),KY=e=>{const t=Un(sD),{namespace:i}=rn("collapse"),s=Se(!1),d=Se(!1),g=hT(),_=te(()=>g.current++),o=te(()=>{var F;return(F=e.name)!=null?F:`${i.value}-id-${g.prefix}-${y(_)}`}),S=te(()=>t==null?void 0:t.activeNames.value.includes(y(o)));return{focusing:s,id:_,isActive:S,handleFocus:()=>{setTimeout(()=>{d.value?d.value=!1:s.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(y(o)),s.value=!1,d.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(y(o))}}},ZY=(e,{focusing:t,isActive:i,id:s})=>{const d=rn("collapse"),g=te(()=>[d.b("item"),d.is("active",y(i)),d.is("disabled",e.disabled)]),_=te(()=>[d.be("item","header"),d.is("active",y(i)),{focusing:y(t)&&!e.disabled}]),o=te(()=>[d.be("item","arrow"),d.is("active",y(i))]),S=te(()=>d.be("item","wrap")),E=te(()=>d.be("item","content")),I=te(()=>d.b(`content-${y(s)}`)),P=te(()=>d.b(`head-${y(s)}`));return{arrowKls:o,headKls:_,rootKls:g,itemWrapperKls:S,itemContentKls:E,scopedContentId:I,scopedHeadId:P}},YY=Ze({name:"ElCollapseItem"}),XY=Ze({...YY,props:qY,setup(e,{expose:t}){const i=e,{focusing:s,id:d,isActive:g,handleFocus:_,handleHeaderClick:o,handleEnterClick:S}=KY(i),{arrowKls:E,headKls:I,rootKls:P,itemWrapperKls:F,itemContentKls:B,scopedContentId:$,scopedHeadId:z}=ZY(i,{focusing:s,isActive:g,id:d});return t({isActive:g}),(H,U)=>(se(),Pe("div",{class:de(y(P))},[He("button",{id:y(z),class:de(y(I)),"aria-expanded":y(g),"aria-controls":y($),"aria-describedby":y($),tabindex:H.disabled?-1:0,type:"button",onClick:y(o),onKeydown:ti(po(y(S),["stop","prevent"]),["space","enter"]),onFocus:y(_),onBlur:ie=>s.value=!1},[_t(H.$slots,"title",{},()=>[nr(wn(H.title),1)]),_t(H.$slots,"icon",{isActive:y(g)},()=>[Qe(y(Gn),{class:de(y(E))},{default:at(()=>[(se(),Rt(Wo(H.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),Qe(y(m1),null,{default:at(()=>[zo(He("div",{id:y($),role:"region",class:de(y(F)),"aria-hidden":!y(g),"aria-labelledby":y(z)},[He("div",{class:de(y(B))},[_t(H.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[Cr,y(g)]])]),_:3})],2))}});var lD=bn(XY,[["__file","collapse-item.vue"]]);const JY=Ao(jY,{CollapseItem:lD}),QY=Oi(lD),eX=vn({color:{type:ut(Object),required:!0},vertical:{type:Boolean,default:!1}});let kw=!1;function p_(e,t){if(!gr)return;const i=function(g){var _;(_=t.drag)==null||_.call(t,g)},s=function(g){var _;document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",s),document.onselectstart=null,document.ondragstart=null,kw=!1,(_=t.end)==null||_.call(t,g)},d=function(g){var _;kw||(g.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",i),document.addEventListener("mouseup",s),document.addEventListener("touchmove",i),document.addEventListener("touchend",s),kw=!0,(_=t.start)==null||_.call(t,g))};e.addEventListener("mousedown",d),e.addEventListener("touchstart",d,{passive:!1})}const tX=(e,t)=>{if(!gr||!e||!t)return!1;const i=e.getBoundingClientRect();let s;return t instanceof Element?s=t.getBoundingClientRect():s={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},i.top<s.bottom&&i.bottom>s.top&&i.right>s.left&&i.left<s.right},aP=e=>{let t=0,i=e;for(;i;)t+=i.offsetTop,i=i.offsetParent;return t},C2=(e,t)=>Math.abs(aP(e)-aP(t)),AT=e=>{let t,i;return e.type==="touchend"?(i=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(i=e.touches[0].clientY,t=e.touches[0].clientX):(i=e.clientY,t=e.clientX),{clientX:t,clientY:i}},nX=e=>{const t=jo(),{t:i}=vr(),s=gi(),d=gi(),g=te(()=>e.color.get("alpha")),_=te(()=>i("el.colorpicker.alphaLabel"));function o(P){var F;P.target!==s.value&&S(P),(F=s.value)==null||F.focus()}function S(P){if(!d.value||!s.value)return;const B=t.vnode.el.getBoundingClientRect(),{clientX:$,clientY:z}=AT(P);if(e.vertical){let H=z-B.top;H=Math.max(s.value.offsetHeight/2,H),H=Math.min(H,B.height-s.value.offsetHeight/2),e.color.set("alpha",Math.round((H-s.value.offsetHeight/2)/(B.height-s.value.offsetHeight)*100))}else{let H=$-B.left;H=Math.max(s.value.offsetWidth/2,H),H=Math.min(H,B.width-s.value.offsetWidth/2),e.color.set("alpha",Math.round((H-s.value.offsetWidth/2)/(B.width-s.value.offsetWidth)*100))}}function E(P){const{code:F,shiftKey:B}=P,$=B?10:1;switch(F){case On.left:case On.down:P.preventDefault(),P.stopPropagation(),I(-$);break;case On.right:case On.up:P.preventDefault(),P.stopPropagation(),I($);break}}function I(P){let F=g.value+P;F=F<0?0:F>100?100:F,e.color.set("alpha",F)}return{thumb:s,bar:d,alpha:g,alphaLabel:_,handleDrag:S,handleClick:o,handleKeydown:E}},oX=(e,{bar:t,thumb:i,handleDrag:s})=>{const d=jo(),g=rn("color-alpha-slider"),_=Se(0),o=Se(0),S=Se();function E(){if(!i.value||e.vertical)return 0;const ie=d.vnode.el,Z=e.color.get("alpha");return ie?Math.round(Z*(ie.offsetWidth-i.value.offsetWidth/2)/100):0}function I(){if(!i.value)return 0;const ie=d.vnode.el;if(!e.vertical)return 0;const Z=e.color.get("alpha");return ie?Math.round(Z*(ie.offsetHeight-i.value.offsetHeight/2)/100):0}function P(){if(e.color&&e.color.value){const{r:ie,g:Z,b:G}=e.color.toRgb();return`linear-gradient(to right, rgba(${ie}, ${Z}, ${G}, 0) 0%, rgba(${ie}, ${Z}, ${G}, 1) 100%)`}return""}function F(){_.value=E(),o.value=I(),S.value=P()}No(()=>{if(!t.value||!i.value)return;const ie={drag:Z=>{s(Z)},end:Z=>{s(Z)}};p_(t.value,ie),p_(i.value,ie),F()}),tn(()=>e.color.get("alpha"),()=>F()),tn(()=>e.color.value,()=>F());const B=te(()=>[g.b(),g.is("vertical",e.vertical)]),$=te(()=>g.e("bar")),z=te(()=>g.e("thumb")),H=te(()=>({background:S.value})),U=te(()=>({left:ji(_.value),top:ji(o.value)}));return{rootKls:B,barKls:$,barStyle:H,thumbKls:z,thumbStyle:U,update:F}},rX="ElColorAlphaSlider",iX=Ze({name:rX}),aX=Ze({...iX,props:eX,setup(e,{expose:t}){const i=e,{alpha:s,alphaLabel:d,bar:g,thumb:_,handleDrag:o,handleClick:S,handleKeydown:E}=nX(i),{rootKls:I,barKls:P,barStyle:F,thumbKls:B,thumbStyle:$,update:z}=oX(i,{bar:g,thumb:_,handleDrag:o});return t({update:z,bar:g,thumb:_}),(H,U)=>(se(),Pe("div",{class:de(y(I))},[He("div",{ref_key:"bar",ref:g,class:de(y(P)),style:to(y(F)),onClick:y(S)},null,14,["onClick"]),He("div",{ref_key:"thumb",ref:_,class:de(y(B)),style:to(y($)),"aria-label":y(d),"aria-valuenow":y(s),"aria-orientation":H.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:y(E)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var sX=bn(aX,[["__file","alpha-slider.vue"]]);const lX=Ze({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=rn("color-hue-slider"),i=jo(),s=Se(),d=Se(),g=Se(0),_=Se(0),o=te(()=>e.color.get("hue"));tn(()=>o.value,()=>{F()});function S(B){B.target!==s.value&&E(B)}function E(B){if(!d.value||!s.value)return;const z=i.vnode.el.getBoundingClientRect(),{clientX:H,clientY:U}=AT(B);let ie;if(e.vertical){let Z=U-z.top;Z=Math.min(Z,z.height-s.value.offsetHeight/2),Z=Math.max(s.value.offsetHeight/2,Z),ie=Math.round((Z-s.value.offsetHeight/2)/(z.height-s.value.offsetHeight)*360)}else{let Z=H-z.left;Z=Math.min(Z,z.width-s.value.offsetWidth/2),Z=Math.max(s.value.offsetWidth/2,Z),ie=Math.round((Z-s.value.offsetWidth/2)/(z.width-s.value.offsetWidth)*360)}e.color.set("hue",ie)}function I(){if(!s.value)return 0;const B=i.vnode.el;if(e.vertical)return 0;const $=e.color.get("hue");return B?Math.round($*(B.offsetWidth-s.value.offsetWidth/2)/360):0}function P(){if(!s.value)return 0;const B=i.vnode.el;if(!e.vertical)return 0;const $=e.color.get("hue");return B?Math.round($*(B.offsetHeight-s.value.offsetHeight/2)/360):0}function F(){g.value=I(),_.value=P()}return No(()=>{if(!d.value||!s.value)return;const B={drag:$=>{E($)},end:$=>{E($)}};p_(d.value,B),p_(s.value,B),F()}),{bar:d,thumb:s,thumbLeft:g,thumbTop:_,hueValue:o,handleClick:S,update:F,ns:t}}});function cX(e,t,i,s,d,g){return se(),Pe("div",{class:de([e.ns.b(),e.ns.is("vertical",e.vertical)])},[He("div",{ref:"bar",class:de(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),He("div",{ref:"thumb",class:de(e.ns.e("thumb")),style:to({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var uX=bn(lX,[["render",cX],["__file","hue-slider.vue"]]);const dX=vn({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:ia,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:wa.teleported,predefine:{type:ut(Array)},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),hX={[Fo]:e=>Zn(e)||ga(e),[Yr]:e=>Zn(e)||ga(e),activeChange:e=>Zn(e)||ga(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},cD=Symbol("colorPickerContextKey"),sP=function(e,t,i){return[e,t*i/((e=(2-t)*i)<1?e:2-e)||0,e/2]},fX=function(e){return Zn(e)&&e.includes(".")&&Number.parseFloat(e)===1},pX=function(e){return Zn(e)&&e.includes("%")},dm=function(e,t){fX(e)&&(e="100%");const i=pX(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),i&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},lP={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},q0=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),i=e%16;return`${lP[t]||t}${lP[i]||i}`},cP=function({r:e,g:t,b:i}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+i)?"":`#${q0(e)}${q0(t)}${q0(i)}`},Pw={A:10,B:11,C:12,D:13,E:14,F:15},yf=function(e){return e.length===2?(Pw[e[0].toUpperCase()]||+e[0])*16+(Pw[e[1].toUpperCase()]||+e[1]):Pw[e[1].toUpperCase()]||+e[1]},mX=function(e,t,i){t=t/100,i=i/100;let s=t;const d=Math.max(i,.01);i*=2,t*=i<=1?i:2-i,s*=d<=1?d:2-d;const g=(i+t)/2,_=i===0?2*s/(d+s):2*t/(i+t);return{h:e,s:_*100,v:g*100}},uP=(e,t,i)=>{e=dm(e,255),t=dm(t,255),i=dm(i,255);const s=Math.max(e,t,i),d=Math.min(e,t,i);let g;const _=s,o=s-d,S=s===0?0:o/s;if(s===d)g=0;else{switch(s){case e:{g=(t-i)/o+(t<i?6:0);break}case t:{g=(i-e)/o+2;break}case i:{g=(e-t)/o+4;break}}g/=6}return{h:g*360,s:S*100,v:_*100}},kv=function(e,t,i){e=dm(e,360)*6,t=dm(t,100),i=dm(i,100);const s=Math.floor(e),d=e-s,g=i*(1-t),_=i*(1-d*t),o=i*(1-(1-d)*t),S=s%6,E=[i,_,g,g,o,i][S],I=[o,i,i,_,g,g][S],P=[g,g,o,i,i,_][S];return{r:Math.round(E*255),g:Math.round(I*255),b:Math.round(P*255)}};class Kv{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const i in t)Tr(t,i)&&(this[i]=t[i]);t.value?this.fromString(t.value):this.doOnChange()}set(t,i){if(arguments.length===1&&typeof t=="object"){for(const s in t)Tr(t,s)&&this.set(s,t[s]);return}this[`_${t}`]=i,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return kv(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const i=(s,d,g)=>{this._hue=Math.max(0,Math.min(360,s)),this._saturation=Math.max(0,Math.min(100,d)),this._value=Math.max(0,Math.min(100,g)),this.doOnChange()};if(t.includes("hsl")){const s=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,g)=>g>2?Number.parseFloat(d):Number.parseInt(d,10));if(s.length===4?this._alpha=Number.parseFloat(s[3])*100:s.length===3&&(this._alpha=100),s.length>=3){const{h:d,s:g,v:_}=mX(s[0],s[1],s[2]);i(d,g,_)}}else if(t.includes("hsv")){const s=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,g)=>g>2?Number.parseFloat(d):Number.parseInt(d,10));s.length===4?this._alpha=Number.parseFloat(s[3])*100:s.length===3&&(this._alpha=100),s.length>=3&&i(s[0],s[1],s[2])}else if(t.includes("rgb")){const s=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,g)=>g>2?Number.parseFloat(d):Number.parseInt(d,10));if(s.length===4?this._alpha=Number.parseFloat(s[3])*100:s.length===3&&(this._alpha=100),s.length>=3){const{h:d,s:g,v:_}=uP(s[0],s[1],s[2]);i(d,g,_)}}else if(t.includes("#")){const s=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(s))return;let d,g,_;s.length===3?(d=yf(s[0]+s[0]),g=yf(s[1]+s[1]),_=yf(s[2]+s[2])):(s.length===6||s.length===8)&&(d=yf(s.slice(0,2)),g=yf(s.slice(2,4)),_=yf(s.slice(4,6))),s.length===8?this._alpha=yf(s.slice(6))/255*100:(s.length===3||s.length===6)&&(this._alpha=100);const{h:o,s:S,v:E}=uP(d,g,_);i(o,S,E)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:i,_value:s,_alpha:d,format:g}=this;if(this.enableAlpha)switch(g){case"hsl":{const _=sP(t,i/100,s/100);this.value=`hsla(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(i)}%, ${Math.round(s)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${cP(kv(t,i,s))}${q0(d*255/100)}`;break}default:{const{r:_,g:o,b:S}=kv(t,i,s);this.value=`rgba(${_}, ${o}, ${S}, ${this.get("alpha")/100})`}}else switch(g){case"hsl":{const _=sP(t,i/100,s/100);this.value=`hsl(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(i)}%, ${Math.round(s)}%)`;break}case"rgb":{const{r:_,g:o,b:S}=kv(t,i,s);this.value=`rgb(${_}, ${o}, ${S})`;break}default:this.value=cP(kv(t,i,s))}}}const gX=Ze({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=rn("color-predefine"),{currentColor:i}=Un(cD),s=Se(g(e.colors,e.color));tn(()=>i.value,_=>{const o=new Kv;o.fromString(_),s.value.forEach(S=>{S.selected=o.compare(S)})}),Ha(()=>{s.value=g(e.colors,e.color)});function d(_){e.color.fromString(e.colors[_])}function g(_,o){return _.map(S=>{const E=new Kv;return E.enableAlpha=e.enableAlpha,E.format="rgba",E.fromString(S),E.selected=E.value===o.value,E})}return{rgbaColors:s,handleSelect:d,ns:t}}});function vX(e,t,i,s,d,g){return se(),Pe("div",{class:de(e.ns.b())},[He("div",{class:de(e.ns.e("colors"))},[(se(!0),Pe(eo,null,tr(e.rgbaColors,(_,o)=>(se(),Pe("div",{key:e.colors[o],class:de([e.ns.e("color-selector"),e.ns.is("alpha",_._alpha<100),{selected:_.selected}]),onClick:S=>e.handleSelect(o)},[He("div",{style:to({backgroundColor:_.value})},null,4)],10,["onClick"]))),128))],2)],2)}var _X=bn(gX,[["render",vX],["__file","predefine.vue"]]);const yX=Ze({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=rn("color-svpanel"),i=jo(),s=Se(0),d=Se(0),g=Se("hsl(0, 100%, 50%)"),_=te(()=>{const E=e.color.get("hue"),I=e.color.get("value");return{hue:E,value:I}});function o(){const E=e.color.get("saturation"),I=e.color.get("value"),P=i.vnode.el,{clientWidth:F,clientHeight:B}=P;d.value=E*F/100,s.value=(100-I)*B/100,g.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function S(E){const P=i.vnode.el.getBoundingClientRect(),{clientX:F,clientY:B}=AT(E);let $=F-P.left,z=B-P.top;$=Math.max(0,$),$=Math.min($,P.width),z=Math.max(0,z),z=Math.min(z,P.height),d.value=$,s.value=z,e.color.set({saturation:$/P.width*100,value:100-z/P.height*100})}return tn(()=>_.value,()=>{o()}),No(()=>{p_(i.vnode.el,{drag:E=>{S(E)},end:E=>{S(E)}}),o()}),{cursorTop:s,cursorLeft:d,background:g,colorValue:_,handleDrag:S,update:o,ns:t}}});function bX(e,t,i,s,d,g){return se(),Pe("div",{class:de(e.ns.b()),style:to({backgroundColor:e.background})},[He("div",{class:de(e.ns.e("white"))},null,2),He("div",{class:de(e.ns.e("black"))},null,2),He("div",{class:de(e.ns.e("cursor")),style:to({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[He("div")],6)],6)}var xX=bn(yX,[["render",bX],["__file","sv-panel.vue"]]);const wX=Ze({name:"ElColorPicker"}),SX=Ze({...wX,props:dX,emits:hX,setup(e,{expose:t,emit:i}){const s=e,{t:d}=vr(),g=rn("color"),{formItem:_}=Ka(),o=na(),S=Za(),{inputId:E,isLabeledByFormItem:I}=ic(s,{formItemContext:_}),P=Se(),F=Se(),B=Se(),$=Se(),z=Se(),H=Se(),{isFocused:U,handleFocus:ie,handleBlur:Z}=Ah(z,{beforeFocus(){return S.value},beforeBlur($t){var Re;return(Re=$.value)==null?void 0:Re.isFocusInsideContent($t)},afterBlur(){Me(!1),ge()}});let G=!0;const Q=Pr(new Kv({enableAlpha:s.showAlpha,format:s.colorFormat||"",value:s.modelValue})),oe=Se(!1),le=Se(!1),me=Se(""),fe=te(()=>!s.modelValue&&!le.value?"transparent":tt(Q,s.showAlpha)),ce=te(()=>!s.modelValue&&!le.value?"":Q.value),pe=te(()=>I.value?void 0:s.ariaLabel||d("el.colorpicker.defaultLabel")),ye=te(()=>I.value?_==null?void 0:_.labelId:void 0),De=te(()=>[g.b("picker"),g.is("disabled",S.value),g.bm("picker",o.value),g.is("focused",U.value)]);function tt($t,Re){if(!($t instanceof Kv))throw new TypeError("color should be instance of _color Class");const{r:dn,g:At,b:Ke}=$t.toRgb();return Re?`rgba(${dn}, ${At}, ${Ke}, ${$t.get("alpha")/100})`:`rgb(${dn}, ${At}, ${Ke})`}function Me($t){oe.value=$t}const xe=ol(Me,100,{leading:!0});function Ae(){S.value||Me(!0)}function Ce(){xe(!1),ge()}function ge(){oo(()=>{s.modelValue?Q.fromString(s.modelValue):(Q.value="",oo(()=>{le.value=!1}))})}function Ne(){S.value||xe(!oe.value)}function We(){Q.fromString(me.value)}function ot(){const $t=Q.value;i(Fo,$t),i("change",$t),s.validateEvent&&(_==null||_.validate("change").catch(Re=>void 0)),xe(!1),oo(()=>{const Re=new Kv({enableAlpha:s.showAlpha,format:s.colorFormat||"",value:s.modelValue});Q.compare(Re)||ge()})}function Oe(){xe(!1),i(Fo,null),i("change",null),s.modelValue!==null&&s.validateEvent&&(_==null||_.validate("change").catch($t=>void 0)),ge()}function Ct(){oe.value&&(Ce(),U.value&&bt())}function Mt($t){$t.preventDefault(),$t.stopPropagation(),Me(!1),ge()}function zt($t){switch($t.code){case On.enter:case On.numpadEnter:case On.space:$t.preventDefault(),$t.stopPropagation(),Ae(),H.value.focus();break;case On.esc:Mt($t);break}}function bt(){z.value.focus()}function Kt(){z.value.blur()}return No(()=>{s.modelValue&&(me.value=ce.value)}),tn(()=>s.modelValue,$t=>{$t?$t&&$t!==Q.value&&(G=!1,Q.fromString($t)):le.value=!1}),tn(()=>[s.colorFormat,s.showAlpha],()=>{Q.enableAlpha=s.showAlpha,Q.format=s.colorFormat||Q.format,Q.doOnChange(),i(Fo,Q.value)}),tn(()=>ce.value,$t=>{me.value=$t,G&&i("activeChange",$t),G=!0}),tn(()=>Q.value,()=>{!s.modelValue&&!le.value&&(le.value=!0)}),tn(()=>oe.value,()=>{oo(()=>{var $t,Re,dn;($t=P.value)==null||$t.update(),(Re=F.value)==null||Re.update(),(dn=B.value)==null||dn.update()})}),or(cD,{currentColor:ce}),t({color:Q,show:Ae,hide:Ce,focus:bt,blur:Kt}),($t,Re)=>(se(),Rt(y(qa),{ref_key:"popper",ref:$,visible:oe.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[y(g).be("picker","panel"),y(g).b("dropdown"),$t.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:$t.teleported,transition:`${y(g).namespace.value}-zoom-in-top`,persistent:"",onHide:dn=>Me(!1)},{content:at(()=>[zo((se(),Pe("div",{onKeydown:ti(Mt,["esc"])},[He("div",{class:de(y(g).be("dropdown","main-wrapper"))},[Qe(uX,{ref_key:"hue",ref:P,class:"hue-slider",color:y(Q),vertical:""},null,8,["color"]),Qe(xX,{ref_key:"sv",ref:F,color:y(Q)},null,8,["color"])],2),$t.showAlpha?(se(),Rt(sX,{key:0,ref_key:"alpha",ref:B,color:y(Q)},null,8,["color"])):St("v-if",!0),$t.predefine?(se(),Rt(_X,{key:1,ref:"predefine","enable-alpha":$t.showAlpha,color:y(Q),colors:$t.predefine},null,8,["enable-alpha","color","colors"])):St("v-if",!0),He("div",{class:de(y(g).be("dropdown","btns"))},[He("span",{class:de(y(g).be("dropdown","value"))},[Qe(y(hs),{ref_key:"inputRef",ref:H,modelValue:me.value,"onUpdate:modelValue":dn=>me.value=dn,"validate-event":!1,size:"small",onKeyup:ti(We,["enter"]),onBlur:We},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),Qe(y(Ta),{class:de(y(g).be("dropdown","link-btn")),text:"",size:"small",onClick:Oe},{default:at(()=>[nr(wn(y(d)("el.colorpicker.clear")),1)]),_:1},8,["class"]),Qe(y(Ta),{plain:"",size:"small",class:de(y(g).be("dropdown","btn")),onClick:ot},{default:at(()=>[nr(wn(y(d)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[y(rd),Ct]])]),default:at(()=>[He("div",Yo({id:y(E),ref_key:"triggerRef",ref:z},$t.$attrs,{class:y(De),role:"button","aria-label":y(pe),"aria-labelledby":y(ye),"aria-description":y(d)("el.colorpicker.description",{color:$t.modelValue||""}),"aria-disabled":y(S),tabindex:y(S)?-1:$t.tabindex,onKeydown:zt,onFocus:y(ie),onBlur:y(Z)}),[y(S)?(se(),Pe("div",{key:0,class:de(y(g).be("picker","mask"))},null,2)):St("v-if",!0),He("div",{class:de(y(g).be("picker","trigger")),onClick:Ne},[He("span",{class:de([y(g).be("picker","color"),y(g).is("alpha",$t.showAlpha)])},[He("span",{class:de(y(g).be("picker","color-inner")),style:to({backgroundColor:y(fe)})},[zo(Qe(y(Gn),{class:de([y(g).be("picker","icon"),y(g).is("icon-arrow-down")])},{default:at(()=>[Qe(y(cd))]),_:1},8,["class"]),[[Cr,$t.modelValue||le.value]]),zo(Qe(y(Gn),{class:de([y(g).be("picker","empty"),y(g).is("icon-close")])},{default:at(()=>[Qe(y(Kc))]),_:1},8,["class"]),[[Cr,!$t.modelValue&&!le.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var TX=bn(SX,[["__file","color-picker.vue"]]);const CX=Ao(TX),EX=vn({a11y:{type:Boolean,default:!0},locale:{type:ut(Object)},size:ia,button:{type:ut(Object)},experimentalFeatures:{type:ut(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:ut(Object)},zIndex:Number,namespace:{type:String,default:"el"},...Um}),Nc={},MX=Ze({name:"ElConfigProvider",props:EX,setup(e,{slots:t}){tn(()=>e.message,s=>{Object.assign(Nc,s??{})},{immediate:!0,deep:!0});const i=nT(e);return()=>_t(t,"default",{config:i==null?void 0:i.value})}}),IX=Ao(MX),AX=Ze({name:"ElContainer"}),kX=Ze({...AX,props:{direction:{type:String}},setup(e){const t=e,i=aa(),s=rn("container"),d=te(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:i&&i.default?i.default().some(_=>{const o=_.type.name;return o==="ElHeader"||o==="ElFooter"}):!1);return(g,_)=>(se(),Pe("section",{class:de([y(s).b(),y(s).is("vertical",y(d))])},[_t(g.$slots,"default")],2))}});var PX=bn(kX,[["__file","container.vue"]]);const RX=Ze({name:"ElAside"}),OX=Ze({...RX,props:{width:{type:String,default:null}},setup(e){const t=e,i=rn("aside"),s=te(()=>t.width?i.cssVarBlock({width:t.width}):{});return(d,g)=>(se(),Pe("aside",{class:de(y(i).b()),style:to(y(s))},[_t(d.$slots,"default")],6))}});var uD=bn(OX,[["__file","aside.vue"]]);const LX=Ze({name:"ElFooter"}),DX=Ze({...LX,props:{height:{type:String,default:null}},setup(e){const t=e,i=rn("footer"),s=te(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,g)=>(se(),Pe("footer",{class:de(y(i).b()),style:to(y(s))},[_t(d.$slots,"default")],6))}});var dD=bn(DX,[["__file","footer.vue"]]);const zX=Ze({name:"ElHeader"}),FX=Ze({...zX,props:{height:{type:String,default:null}},setup(e){const t=e,i=rn("header"),s=te(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,g)=>(se(),Pe("header",{class:de(y(i).b()),style:to(y(s))},[_t(d.$slots,"default")],6))}});var hD=bn(FX,[["__file","header.vue"]]);const BX=Ze({name:"ElMain"}),NX=Ze({...BX,setup(e){const t=rn("main");return(i,s)=>(se(),Pe("main",{class:de(y(t).b())},[_t(i.$slots,"default")],2))}});var fD=bn(NX,[["__file","main.vue"]]);const $X=Ao(PX,{Aside:uD,Footer:dD,Header:hD,Main:fD}),VX=Oi(uD),UX=Oi(dD),jX=Oi(hD),HX=Oi(fD);var pD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},s=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d/,g=/\d\d/,_=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,S={},E=function(H){return(H=+H)+(H>68?1900:2e3)},I=function(H){return function(U){this[H]=+U}},P=[/[+-]\d\d:?(\d\d)?|Z/,function(H){(this.zone||(this.zone={})).offset=function(U){if(!U||U==="Z")return 0;var ie=U.match(/([+-]|\d\d)/g),Z=60*ie[1]+(+ie[2]||0);return Z===0?0:ie[0]==="+"?-Z:Z}(H)}],F=function(H){var U=S[H];return U&&(U.indexOf?U:U.s.concat(U.f))},B=function(H,U){var ie,Z=S.meridiem;if(Z){for(var G=1;G<=24;G+=1)if(H.indexOf(Z(G,0,U))>-1){ie=G>12;break}}else ie=H===(U?"pm":"PM");return ie},$={A:[o,function(H){this.afternoon=B(H,!1)}],a:[o,function(H){this.afternoon=B(H,!0)}],Q:[d,function(H){this.month=3*(H-1)+1}],S:[d,function(H){this.milliseconds=100*+H}],SS:[g,function(H){this.milliseconds=10*+H}],SSS:[/\d{3}/,function(H){this.milliseconds=+H}],s:[_,I("seconds")],ss:[_,I("seconds")],m:[_,I("minutes")],mm:[_,I("minutes")],H:[_,I("hours")],h:[_,I("hours")],HH:[_,I("hours")],hh:[_,I("hours")],D:[_,I("day")],DD:[g,I("day")],Do:[o,function(H){var U=S.ordinal,ie=H.match(/\d+/);if(this.day=ie[0],U)for(var Z=1;Z<=31;Z+=1)U(Z).replace(/\[|\]/g,"")===H&&(this.day=Z)}],w:[_,I("week")],ww:[g,I("week")],M:[_,I("month")],MM:[g,I("month")],MMM:[o,function(H){var U=F("months"),ie=(F("monthsShort")||U.map(function(Z){return Z.slice(0,3)})).indexOf(H)+1;if(ie<1)throw new Error;this.month=ie%12||ie}],MMMM:[o,function(H){var U=F("months").indexOf(H)+1;if(U<1)throw new Error;this.month=U%12||U}],Y:[/[+-]?\d+/,I("year")],YY:[g,function(H){this.year=E(H)}],YYYY:[/\d{4}/,I("year")],Z:P,ZZ:P};function z(H){var U,ie;U=H,ie=S&&S.formats;for(var Z=(H=U.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(ce,pe,ye){var De=ye&&ye.toUpperCase();return pe||ie[ye]||i[ye]||ie[De].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(tt,Me,xe){return Me||xe.slice(1)})})).match(s),G=Z.length,Q=0;Q<G;Q+=1){var oe=Z[Q],le=$[oe],me=le&&le[0],fe=le&&le[1];Z[Q]=fe?{regex:me,parser:fe}:oe.replace(/^\[|\]$/g,"")}return function(ce){for(var pe={},ye=0,De=0;ye<G;ye+=1){var tt=Z[ye];if(typeof tt=="string")De+=tt.length;else{var Me=tt.regex,xe=tt.parser,Ae=ce.slice(De),Ce=Me.exec(Ae)[0];xe.call(pe,Ce),ce=ce.replace(Ce,"")}}return function(ge){var Ne=ge.afternoon;if(Ne!==void 0){var We=ge.hours;Ne?We<12&&(ge.hours+=12):We===12&&(ge.hours=0),delete ge.afternoon}}(pe),pe}}return function(H,U,ie){ie.p.customParseFormat=!0,H&&H.parseTwoDigitYear&&(E=H.parseTwoDigitYear);var Z=U.prototype,G=Z.parse;Z.parse=function(Q){var oe=Q.date,le=Q.utc,me=Q.args;this.$u=le;var fe=me[1];if(typeof fe=="string"){var ce=me[2]===!0,pe=me[3]===!0,ye=ce||pe,De=me[2];pe&&(De=me[2]),S=this.$locale(),!ce&&De&&(S=ie.Ls[De]),this.$d=function(Ae,Ce,ge,Ne){try{if(["x","X"].indexOf(Ce)>-1)return new Date((Ce==="X"?1e3:1)*Ae);var We=z(Ce)(Ae),ot=We.year,Oe=We.month,Ct=We.day,Mt=We.hours,zt=We.minutes,bt=We.seconds,Kt=We.milliseconds,$t=We.zone,Re=We.week,dn=new Date,At=Ct||(ot||Oe?1:dn.getDate()),Ke=ot||dn.getFullYear(),Be=0;ot&&!Oe||(Be=Oe>0?Oe-1:dn.getMonth());var Ht,Ut=Mt||0,Nt=zt||0,Et=bt||0,Gt=Kt||0;return $t?new Date(Date.UTC(Ke,Be,At,Ut,Nt,Et,Gt+60*$t.offset*1e3)):ge?new Date(Date.UTC(Ke,Be,At,Ut,Nt,Et,Gt)):(Ht=new Date(Ke,Be,At,Ut,Nt,Et,Gt),Re&&(Ht=Ne(Ht).week(Re).toDate()),Ht)}catch{return new Date("")}}(oe,fe,le,ie),this.init(),De&&De!==!0&&(this.$L=this.locale(De).$L),ye&&oe!=this.format(fe)&&(this.$d=new Date("")),S={}}else if(fe instanceof Array)for(var tt=fe.length,Me=1;Me<=tt;Me+=1){me[1]=fe[Me-1];var xe=ie.apply(this,me);if(xe.isValid()){this.$d=xe.$d,this.$L=xe.$L,this.init();break}Me===tt&&(this.$d=new Date(""))}else G.call(this,Q)}}})})(pD);var GX=pD.exports;const kT=Xc(GX);var mD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){return function(i,s){var d=s.prototype,g=d.format;d.format=function(_){var o=this,S=this.$locale();if(!this.isValid())return g.bind(this)(_);var E=this.$utils(),I=(_||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(P){switch(P){case"Q":return Math.ceil((o.$M+1)/3);case"Do":return S.ordinal(o.$D);case"gggg":return o.weekYear();case"GGGG":return o.isoWeekYear();case"wo":return S.ordinal(o.week(),"W");case"w":case"ww":return E.s(o.week(),P==="w"?1:2,"0");case"W":case"WW":return E.s(o.isoWeek(),P==="W"?1:2,"0");case"k":case"kk":return E.s(String(o.$H===0?24:o.$H),P==="k"?1:2,"0");case"X":return Math.floor(o.$d.getTime()/1e3);case"x":return o.$d.getTime();case"z":return"["+o.offsetName()+"]";case"zzz":return"["+o.offsetName("long")+"]";default:return P}});return g.bind(this)(I)}}})})(mD);var WX=mD.exports;const qX=Xc(WX);var gD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){var i="week",s="year";return function(d,g,_){var o=g.prototype;o.week=function(S){if(S===void 0&&(S=null),S!==null)return this.add(7*(S-this.week()),"day");var E=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var I=_(this).startOf(s).add(1,s).date(E),P=_(this).endOf(i);if(I.isBefore(P))return 1}var F=_(this).startOf(s).date(E).startOf(i).subtract(1,"millisecond"),B=this.diff(F,i,!0);return B<0?_(this).startOf("week").week():Math.ceil(B)},o.weeks=function(S){return S===void 0&&(S=null),this.week(S)}}})})(gD);var KX=gD.exports;const ZX=Xc(KX);var vD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){return function(i,s){s.prototype.weekYear=function(){var d=this.month(),g=this.week(),_=this.year();return g===1&&d===11?_+1:d===0&&g>=52?_-1:_}}})})(vD);var YX=vD.exports;const XX=Xc(YX);var _D={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){return function(i,s,d){s.prototype.dayOfYear=function(g){var _=Math.round((d(this).startOf("day")-d(this).startOf("year"))/864e5)+1;return g==null?_:this.add(g-_,"day")}}})})(_D);var JX=_D.exports;const QX=Xc(JX);var yD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){return function(i,s){s.prototype.isSameOrAfter=function(d,g){return this.isSame(d,g)||this.isAfter(d,g)}}})})(yD);var eJ=yD.exports;const tJ=Xc(eJ);var bD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ps,function(){return function(i,s){s.prototype.isSameOrBefore=function(d,g){return this.isSame(d,g)||this.isBefore(d,g)}}})})(bD);var nJ=bD.exports;const oJ=Xc(nJ),dP=["hours","minutes","seconds"],E2="HH:mm:ss",Xp="YYYY-MM-DD",rJ={date:Xp,dates:Xp,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${Xp} ${E2}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:Xp,datetimerange:`${Xp} ${E2}`},xD=vn({disabledHours:{type:ut(Function)},disabledMinutes:{type:ut(Function)},disabledSeconds:{type:ut(Function)}}),wD=vn({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),PT=vn({id:{type:ut([Array,String])},name:{type:ut([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:ut([String,Object]),default:ud},editable:{type:Boolean,default:!0},prefixIcon:{type:ut([String,Object]),default:""},size:ia,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})},modelValue:{type:ut([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:ut([Date,Array])},defaultTime:{type:ut([Date,Array])},isRange:Boolean,...xD,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:ut([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:ut(String),values:dd,default:"bottom"},fallbackPlacements:{type:ut(Array),default:["bottom","top","right","left"]},...Um,...Da(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),iJ=vn({id:{type:ut(Array)},name:{type:ut(Array)},modelValue:{type:ut([Array,String])},startPlaceholder:String,endPlaceholder:String}),aJ=Ze({name:"PickerRangeTrigger",inheritAttrs:!1}),sJ=Ze({...aJ,props:iJ,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(e,{expose:t,emit:i}){const s=z_(),d=rn("date"),g=rn("range"),_=Se(),o=Se(),{wrapperRef:S,isFocused:E}=Ah(_),I=G=>{i("click",G)},P=G=>{i("mouseenter",G)},F=G=>{i("mouseleave",G)},B=G=>{i("mouseenter",G)},$=G=>{i("startInput",G)},z=G=>{i("endInput",G)},H=G=>{i("startChange",G)},U=G=>{i("endChange",G)};return t({focus:()=>{var G;(G=_.value)==null||G.focus()},blur:()=>{var G,Q;(G=_.value)==null||G.blur(),(Q=o.value)==null||Q.blur()}}),(G,Q)=>(se(),Pe("div",{ref_key:"wrapperRef",ref:S,class:de([y(d).is("active",y(E)),G.$attrs.class]),style:to(G.$attrs.style),onClick:I,onMouseenter:P,onMouseleave:F,onTouchstartPassive:B},[_t(G.$slots,"prefix"),He("input",Yo(y(s),{id:G.id&&G.id[0],ref_key:"inputRef",ref:_,name:G.name&&G.name[0],placeholder:G.startPlaceholder,value:G.modelValue&&G.modelValue[0],class:y(g).b("input"),onInput:$,onChange:H}),null,16,["id","name","placeholder","value"]),_t(G.$slots,"range-separator"),He("input",Yo(y(s),{id:G.id&&G.id[1],ref_key:"endInputRef",ref:o,name:G.name&&G.name[1],placeholder:G.endPlaceholder,value:G.modelValue&&G.modelValue[1],class:y(g).b("input"),onInput:z,onChange:U}),null,16,["id","name","placeholder","value"]),_t(G.$slots,"suffix")],38))}});var lJ=bn(sJ,[["__file","picker-range-trigger.vue"]]);const cJ=Ze({name:"Picker"}),uJ=Ze({...cJ,props:PT,emits:["update:modelValue","change","focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:i}){const s=e,d=Mh(),{lang:g}=vr(),_=rn("date"),o=rn("input"),S=rn("range"),{form:E,formItem:I}=Ka(),P=Un("ElPopperOptions",{}),{valueOnClear:F}=a1(s,null),B=Se(),$=Se(),z=Se(!1),H=Se(!1),U=Se(null);let ie=!1;const{isFocused:Z,handleFocus:G,handleBlur:Q}=Ah($,{beforeFocus(){return s.readonly||ge.value},afterFocus(){z.value=!0},beforeBlur(Je){var Mn;return!ie&&((Mn=B.value)==null?void 0:Mn.isFocusInsideContent(Je))},afterBlur(){ln(),z.value=!1,ie=!1,s.validateEvent&&(I==null||I.validate("blur").catch(Je=>void 0))}}),oe=te(()=>[_.b("editor"),_.bm("editor",s.type),o.e("wrapper"),_.is("disabled",ge.value),_.is("active",z.value),S.b("editor"),Ut?S.bm("editor",Ut.value):"",d.class]),le=te(()=>[o.e("icon"),S.e("close-icon"),Kt.value?"":S.e("close-icon--hidden")]);tn(z,Je=>{Je?oo(()=>{Je&&(U.value=s.modelValue)}):(Gt.value=null,oo(()=>{me(s.modelValue)}))});const me=(Je,Mn)=>{(Mn||!Yk(Je,U.value))&&(i("change",Je),s.validateEvent&&(I==null||I.validate("change").catch(Bn=>void 0)))},fe=Je=>{if(!Yk(s.modelValue,Je)){let Mn;fn(Je)?Mn=Je.map(Bn=>Jk(Bn,s.valueFormat,g.value)):Je&&(Mn=Jk(Je,s.valueFormat,g.value)),i("update:modelValue",Je&&Mn,g.value)}},ce=Je=>{i("keydown",Je)},pe=te(()=>$.value?Array.from($.value.$el.querySelectorAll("input")):[]),ye=(Je,Mn,Bn)=>{const Oo=pe.value;Oo.length&&(!Bn||Bn==="min"?(Oo[0].setSelectionRange(Je,Mn),Oo[0].focus()):Bn==="max"&&(Oo[1].setSelectionRange(Je,Mn),Oo[1].focus()))},De=(Je="",Mn=!1)=>{z.value=Mn;let Bn;fn(Je)?Bn=Je.map(Oo=>Oo.toDate()):Bn=Je&&Je.toDate(),Gt.value=null,fe(Bn)},tt=()=>{H.value=!0},Me=()=>{i("visible-change",!0)},xe=()=>{H.value=!1,z.value=!1,i("visible-change",!1)},Ae=()=>{z.value=!0},Ce=()=>{z.value=!1},ge=te(()=>s.disabled||(E==null?void 0:E.disabled)),Ne=te(()=>{let Je;if(Re.value?Ho.value.getDefaultValue&&(Je=Ho.value.getDefaultValue()):fn(s.modelValue)?Je=s.modelValue.map(Mn=>Xk(Mn,s.valueFormat,g.value)):Je=Xk(s.modelValue,s.valueFormat,g.value),Ho.value.getRangeAvailableTime){const Mn=Ho.value.getRangeAvailableTime(Je);Oa(Mn,Je)||(Je=Mn,Re.value||fe(k0(Je)))}return fn(Je)&&Je.some(Mn=>!Mn)&&(Je=[]),Je}),We=te(()=>{if(!Ho.value.panelReady)return"";const Je=_n(Ne.value);return fn(Gt.value)?[Gt.value[0]||Je&&Je[0]||"",Gt.value[1]||Je&&Je[1]||""]:Gt.value!==null?Gt.value:!Oe.value&&Re.value||!z.value&&Re.value?"":Je?Ct.value||Mt.value||zt.value?Je.join(", "):Je:""}),ot=te(()=>s.type.includes("time")),Oe=te(()=>s.type.startsWith("time")),Ct=te(()=>s.type==="dates"),Mt=te(()=>s.type==="months"),zt=te(()=>s.type==="years"),bt=te(()=>s.prefixIcon||(ot.value?JO:BG)),Kt=Se(!1),$t=Je=>{s.readonly||ge.value||(Kt.value&&(Je.stopPropagation(),Ho.value.handleClear?Ho.value.handleClear():fe(F.value),me(F.value,!0),Kt.value=!1,xe()),i("clear"))},Re=te(()=>{const{modelValue:Je}=s;return!Je||fn(Je)&&!Je.filter(Boolean).length}),dn=async Je=>{var Mn;s.readonly||ge.value||(((Mn=Je.target)==null?void 0:Mn.tagName)!=="INPUT"||Z.value)&&(z.value=!0)},At=()=>{s.readonly||ge.value||!Re.value&&s.clearable&&(Kt.value=!0)},Ke=()=>{Kt.value=!1},Be=Je=>{var Mn;s.readonly||ge.value||(((Mn=Je.touches[0].target)==null?void 0:Mn.tagName)!=="INPUT"||Z.value)&&(z.value=!0)},Ht=te(()=>s.type.includes("range")),Ut=na(),Nt=te(()=>{var Je,Mn;return(Mn=(Je=y(B))==null?void 0:Je.popperRef)==null?void 0:Mn.contentRef}),Et=tT($,Je=>{const Mn=y(Nt),Bn=Os($);Mn&&(Je.target===Mn||Je.composedPath().includes(Mn))||Je.target===Bn||Bn&&Je.composedPath().includes(Bn)||(z.value=!1)});ni(()=>{Et==null||Et()});const Gt=Se(null),ln=()=>{if(Gt.value){const Je=yn(We.value);Je&&jn(Je)&&(fe(k0(Je)),Gt.value=null)}Gt.value===""&&(fe(F.value),me(F.value),Gt.value=null)},yn=Je=>Je?Ho.value.parseUserInput(Je):null,_n=Je=>Je?Ho.value.formatToString(Je):null,jn=Je=>Ho.value.isValidValue(Je),yt=async Je=>{if(s.readonly||ge.value)return;const{code:Mn}=Je;if(ce(Je),Mn===On.esc){z.value===!0&&(z.value=!1,Je.preventDefault(),Je.stopPropagation());return}if(Mn===On.down&&(Ho.value.handleFocusPicker&&(Je.preventDefault(),Je.stopPropagation()),z.value===!1&&(z.value=!0,await oo()),Ho.value.handleFocusPicker)){Ho.value.handleFocusPicker();return}if(Mn===On.tab){ie=!0;return}if(Mn===On.enter||Mn===On.numpadEnter){(Gt.value===null||Gt.value===""||jn(yn(We.value)))&&(ln(),z.value=!1),Je.stopPropagation();return}if(Gt.value){Je.stopPropagation();return}Ho.value.handleKeydownInput&&Ho.value.handleKeydownInput(Je)},kn=Je=>{Gt.value=Je,z.value||(z.value=!0)},qn=Je=>{const Mn=Je.target;Gt.value?Gt.value=[Mn.value,Gt.value[1]]:Gt.value=[Mn.value,null]},Co=Je=>{const Mn=Je.target;Gt.value?Gt.value=[Gt.value[0],Mn.value]:Gt.value=[null,Mn.value]},mo=()=>{var Je;const Mn=Gt.value,Bn=yn(Mn&&Mn[0]),Oo=y(Ne);if(Bn&&Bn.isValid()){Gt.value=[_n(Bn),((Je=We.value)==null?void 0:Je[1])||null];const Rr=[Bn,Oo&&(Oo[1]||null)];jn(Rr)&&(fe(k0(Rr)),Gt.value=null)}},Io=()=>{var Je;const Mn=y(Gt),Bn=yn(Mn&&Mn[1]),Oo=y(Ne);if(Bn&&Bn.isValid()){Gt.value=[((Je=y(We))==null?void 0:Je[0])||null,_n(Bn)];const Rr=[Oo&&Oo[0],Bn];jn(Rr)&&(fe(k0(Rr)),Gt.value=null)}},Ho=Se({}),ur=Je=>{Ho.value[Je[0]]=Je[1],Ho.value.panelReady=!0},Dt=Je=>{i("calendar-change",Je)},En=(Je,Mn,Bn)=>{i("panel-change",Je,Mn,Bn)},ft=()=>{var Je;(Je=$.value)==null||Je.focus()},un=()=>{var Je;(Je=$.value)==null||Je.blur()};return or("EP_PICKER_BASE",{props:s}),t({focus:ft,blur:un,handleOpen:Ae,handleClose:Ce,onPick:De}),(Je,Mn)=>(se(),Rt(y(qa),Yo({ref_key:"refPopper",ref:B,visible:z.value,effect:"light",pure:"",trigger:"click"},Je.$attrs,{role:"dialog",teleported:"",transition:`${y(_).namespace.value}-zoom-in-top`,"popper-class":[`${y(_).namespace.value}-picker__popper`,Je.popperClass],"popper-options":y(P),"fallback-placements":Je.fallbackPlacements,"gpu-acceleration":!1,placement:Je.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:tt,onShow:Me,onHide:xe}),{default:at(()=>[y(Ht)?(se(),Rt(lJ,{key:1,id:Je.id,ref_key:"inputRef",ref:$,"model-value":y(We),name:Je.name,disabled:y(ge),readonly:!Je.editable||Je.readonly,"start-placeholder":Je.startPlaceholder,"end-placeholder":Je.endPlaceholder,class:de(y(oe)),style:to(Je.$attrs.style),"aria-label":Je.ariaLabel,tabindex:Je.tabindex,autocomplete:"off",role:"combobox",onClick:dn,onFocus:y(G),onBlur:y(Q),onStartInput:qn,onStartChange:mo,onEndInput:Co,onEndChange:Io,onMousedown:dn,onMouseenter:At,onMouseleave:Ke,onTouchstartPassive:Be,onKeydown:yt},{prefix:at(()=>[y(bt)?(se(),Rt(y(Gn),{key:0,class:de([y(o).e("icon"),y(S).e("icon")])},{default:at(()=>[(se(),Rt(Wo(y(bt))))]),_:1},8,["class"])):St("v-if",!0)]),"range-separator":at(()=>[_t(Je.$slots,"range-separator",{},()=>[He("span",{class:de(y(S).b("separator"))},wn(Je.rangeSeparator),3)])]),suffix:at(()=>[Je.clearIcon?(se(),Rt(y(Gn),{key:0,class:de(y(le)),onMousedown:po(y(jr),["prevent"]),onClick:$t},{default:at(()=>[(se(),Rt(Wo(Je.clearIcon)))]),_:1},8,["class","onMousedown"])):St("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(se(),Rt(y(hs),{key:0,id:Je.id,ref_key:"inputRef",ref:$,"container-role":"combobox","model-value":y(We),name:Je.name,size:y(Ut),disabled:y(ge),placeholder:Je.placeholder,class:de([y(_).b("editor"),y(_).bm("editor",Je.type),Je.$attrs.class]),style:to(Je.$attrs.style),readonly:!Je.editable||Je.readonly||y(Ct)||y(Mt)||y(zt)||Je.type==="week","aria-label":Je.ariaLabel,tabindex:Je.tabindex,"validate-event":!1,onInput:kn,onFocus:y(G),onBlur:y(Q),onKeydown:yt,onChange:ln,onMousedown:dn,onMouseenter:At,onMouseleave:Ke,onTouchstartPassive:Be,onClick:po(()=>{},["stop"])},{prefix:at(()=>[y(bt)?(se(),Rt(y(Gn),{key:0,class:de(y(o).e("icon")),onMousedown:po(dn,["prevent"]),onTouchstartPassive:Be},{default:at(()=>[(se(),Rt(Wo(y(bt))))]),_:1},8,["class","onMousedown"])):St("v-if",!0)]),suffix:at(()=>[Kt.value&&Je.clearIcon?(se(),Rt(y(Gn),{key:0,class:de(`${y(o).e("icon")} clear-icon`),onMousedown:po(y(jr),["prevent"]),onClick:$t},{default:at(()=>[(se(),Rt(Wo(Je.clearIcon)))]),_:1},8,["class","onMousedown"])):St("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:at(()=>[_t(Je.$slots,"default",{visible:z.value,actualVisible:H.value,parsedValue:y(Ne),format:Je.format,dateFormat:Je.dateFormat,timeFormat:Je.timeFormat,unlinkPanels:Je.unlinkPanels,type:Je.type,defaultValue:Je.defaultValue,showNow:Je.showNow,onPick:De,onSelectRange:ye,onSetPickerOption:ur,onCalendarChange:Dt,onPanelChange:En,onMousedown:po(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var SD=bn(uJ,[["__file","picker.vue"]]);const dJ=vn({...wD,datetimeRole:String,parsedValue:{type:ut(Object)}}),TD=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:i})=>{const s=(_,o,S,E)=>{const I={hour:e,minute:t,second:i};let P=_;return["hour","minute","second"].forEach(F=>{if(I[F]){let B;const $=I[F];switch(F){case"minute":{B=$(P.hour(),o,E);break}case"second":{B=$(P.hour(),P.minute(),o,E);break}default:{B=$(o,E);break}}if(B!=null&&B.length&&!B.includes(P[F]())){const z=S?0:B.length-1;P=P[F](B[z])}}}),P},d={};return{timePickerOptions:d,getAvailableTime:s,onSetOption:([_,o])=>{d[_]=o}}},Rw=e=>{const t=(s,d)=>s||d,i=s=>s!==!0;return e.map(t).filter(i)},CD=(e,t,i)=>({getHoursList:(_,o)=>Iw(24,e&&(()=>e==null?void 0:e(_,o))),getMinutesList:(_,o,S)=>Iw(60,t&&(()=>t==null?void 0:t(_,o,S))),getSecondsList:(_,o,S,E)=>Iw(60,i&&(()=>i==null?void 0:i(_,o,S,E)))}),ED=(e,t,i)=>{const{getHoursList:s,getMinutesList:d,getSecondsList:g}=CD(e,t,i);return{getAvailableHours:(E,I)=>Rw(s(E,I)),getAvailableMinutes:(E,I,P)=>Rw(d(E,I,P)),getAvailableSeconds:(E,I,P,F)=>Rw(g(E,I,P,F))}},MD=e=>{const t=Se(e.parsedValue);return tn(()=>e.visible,i=>{i||(t.value=e.parsedValue)}),t},hJ=vn({role:{type:String,required:!0},spinnerDate:{type:ut(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:ut(String),default:""},...xD}),fJ=100,pJ=600,xb={beforeMount(e,t){const i=t.value,{interval:s=fJ,delay:d=pJ}=Qn(i)?{}:i;let g,_;const o=()=>Qn(i)?i():i.handler(),S=()=>{_&&(clearTimeout(_),_=void 0),g&&(clearInterval(g),g=void 0)};e.addEventListener("mousedown",E=>{E.button===0&&(S(),o(),document.addEventListener("mouseup",()=>S(),{once:!0}),_=setTimeout(()=>{g=setInterval(()=>{o()},s)},d))})}},mJ=Ze({__name:"basic-time-spinner",props:hJ,emits:["change","select-range","set-option"],setup(e,{emit:t}){const i=e,s=Un("EP_PICKER_BASE"),{isRange:d}=s.props,g=rn("time"),{getHoursList:_,getMinutesList:o,getSecondsList:S}=CD(i.disabledHours,i.disabledMinutes,i.disabledSeconds);let E=!1;const I=Se(),P=Se(),F=Se(),B=Se(),$={hours:P,minutes:F,seconds:B},z=te(()=>i.showSeconds?dP:dP.slice(0,2)),H=te(()=>{const{spinnerDate:We}=i,ot=We.hour(),Oe=We.minute(),Ct=We.second();return{hours:ot,minutes:Oe,seconds:Ct}}),U=te(()=>{const{hours:We,minutes:ot}=y(H),{role:Oe,spinnerDate:Ct}=i,Mt=d?void 0:Ct;return{hours:_(Oe,Mt),minutes:o(We,Oe,Mt),seconds:S(We,ot,Oe,Mt)}}),ie=te(()=>{const{hours:We,minutes:ot,seconds:Oe}=y(H);return{hours:Mw(We,23),minutes:Mw(ot,59),seconds:Mw(Oe,59)}}),Z=ol(We=>{E=!1,oe(We)},200),G=We=>{if(!!!i.amPmMode)return"";const Oe=i.amPmMode==="A";let Ct=We<12?" am":" pm";return Oe&&(Ct=Ct.toUpperCase()),Ct},Q=We=>{let ot;switch(We){case"hours":ot=[0,2];break;case"minutes":ot=[3,5];break;case"seconds":ot=[6,8];break}const[Oe,Ct]=ot;t("select-range",Oe,Ct),I.value=We},oe=We=>{fe(We,y(H)[We])},le=()=>{oe("hours"),oe("minutes"),oe("seconds")},me=We=>We.querySelector(`.${g.namespace.value}-scrollbar__wrap`),fe=(We,ot)=>{if(i.arrowControl)return;const Oe=y($[We]);Oe&&Oe.$el&&(me(Oe.$el).scrollTop=Math.max(0,ot*ce(We)))},ce=We=>{const ot=y($[We]),Oe=ot==null?void 0:ot.$el.querySelector("li");return Oe&&Number.parseFloat(Ju(Oe,"height"))||0},pe=()=>{De(1)},ye=()=>{De(-1)},De=We=>{I.value||Q("hours");const ot=I.value,Oe=y(H)[ot],Ct=I.value==="hours"?24:60,Mt=tt(ot,Oe,We,Ct);Me(ot,Mt),fe(ot,Mt),oo(()=>Q(ot))},tt=(We,ot,Oe,Ct)=>{let Mt=(ot+Oe+Ct)%Ct;const zt=y(U)[We];for(;zt[Mt]&&Mt!==ot;)Mt=(Mt+Oe+Ct)%Ct;return Mt},Me=(We,ot)=>{if(y(U)[We][ot])return;const{hours:Mt,minutes:zt,seconds:bt}=y(H);let Kt;switch(We){case"hours":Kt=i.spinnerDate.hour(ot).minute(zt).second(bt);break;case"minutes":Kt=i.spinnerDate.hour(Mt).minute(ot).second(bt);break;case"seconds":Kt=i.spinnerDate.hour(Mt).minute(zt).second(ot);break}t("change",Kt)},xe=(We,{value:ot,disabled:Oe})=>{Oe||(Me(We,ot),Q(We),fe(We,ot))},Ae=We=>{const ot=y($[We]);if(!ot)return;E=!0,Z(We);const Oe=Math.min(Math.round((me(ot.$el).scrollTop-(Ce(We)*.5-10)/ce(We)+3)/ce(We)),We==="hours"?23:59);Me(We,Oe)},Ce=We=>y($[We]).$el.offsetHeight,ge=()=>{const We=ot=>{const Oe=y($[ot]);Oe&&Oe.$el&&(me(Oe.$el).onscroll=()=>{Ae(ot)})};We("hours"),We("minutes"),We("seconds")};No(()=>{oo(()=>{!i.arrowControl&&ge(),le(),i.role==="start"&&Q("hours")})});const Ne=(We,ot)=>{$[ot].value=We??void 0};return t("set-option",[`${i.role}_scrollDown`,De]),t("set-option",[`${i.role}_emitSelectRange`,Q]),tn(()=>i.spinnerDate,()=>{E||le()}),(We,ot)=>(se(),Pe("div",{class:de([y(g).b("spinner"),{"has-seconds":We.showSeconds}])},[We.arrowControl?St("v-if",!0):(se(!0),Pe(eo,{key:0},tr(y(z),Oe=>(se(),Rt(y(Pu),{key:Oe,ref_for:!0,ref:Ct=>Ne(Ct,Oe),class:de(y(g).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":y(g).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:Ct=>Q(Oe),onMousemove:Ct=>oe(Oe)},{default:at(()=>[(se(!0),Pe(eo,null,tr(y(U)[Oe],(Ct,Mt)=>(se(),Pe("li",{key:Mt,class:de([y(g).be("spinner","item"),y(g).is("active",Mt===y(H)[Oe]),y(g).is("disabled",Ct)]),onClick:zt=>xe(Oe,{value:Mt,disabled:Ct})},[Oe==="hours"?(se(),Pe(eo,{key:0},[nr(wn(("0"+(We.amPmMode?Mt%12||12:Mt)).slice(-2))+wn(G(Mt)),1)],64)):(se(),Pe(eo,{key:1},[nr(wn(("0"+Mt).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),We.arrowControl?(se(!0),Pe(eo,{key:1},tr(y(z),Oe=>(se(),Pe("div",{key:Oe,class:de([y(g).be("spinner","wrapper"),y(g).is("arrow")]),onMouseenter:Ct=>Q(Oe)},[zo((se(),Rt(y(Gn),{class:de(["arrow-up",y(g).be("spinner","arrow")])},{default:at(()=>[Qe(y(iT))]),_:1},8,["class"])),[[y(xb),ye]]),zo((se(),Rt(y(Gn),{class:de(["arrow-down",y(g).be("spinner","arrow")])},{default:at(()=>[Qe(y(cd))]),_:1},8,["class"])),[[y(xb),pe]]),He("ul",{class:de(y(g).be("spinner","list"))},[(se(!0),Pe(eo,null,tr(y(ie)[Oe],(Ct,Mt)=>(se(),Pe("li",{key:Mt,class:de([y(g).be("spinner","item"),y(g).is("active",Ct===y(H)[Oe]),y(g).is("disabled",y(U)[Oe][Ct])])},[y(ao)(Ct)?(se(),Pe(eo,{key:0},[Oe==="hours"?(se(),Pe(eo,{key:0},[nr(wn(("0"+(We.amPmMode?Ct%12||12:Ct)).slice(-2))+wn(G(Ct)),1)],64)):(se(),Pe(eo,{key:1},[nr(wn(("0"+Ct).slice(-2)),1)],64))],64)):St("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):St("v-if",!0)],2))}});var M2=bn(mJ,[["__file","basic-time-spinner.vue"]]);const gJ=Ze({__name:"panel-time-pick",props:dJ,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,s=Un("EP_PICKER_BASE"),{arrowControl:d,disabledHours:g,disabledMinutes:_,disabledSeconds:o,defaultValue:S}=s.props,{getAvailableHours:E,getAvailableMinutes:I,getAvailableSeconds:P}=ED(g,_,o),F=rn("time"),{t:B,lang:$}=vr(),z=Se([0,2]),H=MD(i),U=te(()=>Hr(i.actualVisible)?`${F.namespace.value}-zoom-in-top`:""),ie=te(()=>i.format.includes("ss")),Z=te(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),G=Ce=>{const ge=Mo(Ce).locale($.value),Ne=tt(ge);return ge.isSame(Ne)},Q=()=>{t("pick",H.value,!1)},oe=(Ce=!1,ge=!1)=>{ge||t("pick",i.parsedValue,Ce)},le=Ce=>{if(!i.visible)return;const ge=tt(Ce).millisecond(0);t("pick",ge,!0)},me=(Ce,ge)=>{t("select-range",Ce,ge),z.value=[Ce,ge]},fe=Ce=>{const ge=[0,3].concat(ie.value?[6]:[]),Ne=["hours","minutes"].concat(ie.value?["seconds"]:[]),ot=(ge.indexOf(z.value[0])+Ce+ge.length)%ge.length;pe.start_emitSelectRange(Ne[ot])},ce=Ce=>{const ge=Ce.code,{left:Ne,right:We,up:ot,down:Oe}=On;if([Ne,We].includes(ge)){fe(ge===Ne?-1:1),Ce.preventDefault();return}if([ot,Oe].includes(ge)){const Ct=ge===ot?-1:1;pe.start_scrollDown(Ct),Ce.preventDefault();return}},{timePickerOptions:pe,onSetOption:ye,getAvailableTime:De}=TD({getAvailableHours:E,getAvailableMinutes:I,getAvailableSeconds:P}),tt=Ce=>De(Ce,i.datetimeRole||"",!0),Me=Ce=>Ce?Mo(Ce,i.format).locale($.value):null,xe=Ce=>Ce?Ce.format(i.format):null,Ae=()=>Mo(S).locale($.value);return t("set-picker-option",["isValidValue",G]),t("set-picker-option",["formatToString",xe]),t("set-picker-option",["parseUserInput",Me]),t("set-picker-option",["handleKeydownInput",ce]),t("set-picker-option",["getRangeAvailableTime",tt]),t("set-picker-option",["getDefaultValue",Ae]),(Ce,ge)=>(se(),Rt(Ea,{name:y(U)},{default:at(()=>[Ce.actualVisible||Ce.visible?(se(),Pe("div",{key:0,class:de(y(F).b("panel"))},[He("div",{class:de([y(F).be("panel","content"),{"has-seconds":y(ie)}])},[Qe(M2,{ref:"spinner",role:Ce.datetimeRole||"start","arrow-control":y(d),"show-seconds":y(ie),"am-pm-mode":y(Z),"spinner-date":Ce.parsedValue,"disabled-hours":y(g),"disabled-minutes":y(_),"disabled-seconds":y(o),onChange:le,onSetOption:y(ye),onSelectRange:me},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),He("div",{class:de(y(F).be("panel","footer"))},[He("button",{type:"button",class:de([y(F).be("panel","btn"),"cancel"]),onClick:Q},wn(y(B)("el.datepicker.cancel")),3),He("button",{type:"button",class:de([y(F).be("panel","btn"),"confirm"]),onClick:Ne=>oe()},wn(y(B)("el.datepicker.confirm")),11,["onClick"])],2)],2)):St("v-if",!0)]),_:1},8,["name"]))}});var wb=bn(gJ,[["__file","panel-time-pick.vue"]]);const vJ=vn({...wD,parsedValue:{type:ut(Array)}}),_J=Ze({__name:"panel-time-range",props:vJ,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,s=(dn,At)=>{const Ke=[];for(let Be=dn;Be<=At;Be++)Ke.push(Be);return Ke},{t:d,lang:g}=vr(),_=rn("time"),o=rn("picker"),S=Un("EP_PICKER_BASE"),{arrowControl:E,disabledHours:I,disabledMinutes:P,disabledSeconds:F,defaultValue:B}=S.props,$=te(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",E),G.value?"has-seconds":""]),z=te(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",E),G.value?"has-seconds":""]),H=te(()=>i.parsedValue[0]),U=te(()=>i.parsedValue[1]),ie=MD(i),Z=()=>{t("pick",ie.value,!1)},G=te(()=>i.format.includes("ss")),Q=te(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),oe=(dn=!1)=>{t("pick",[H.value,U.value],dn)},le=dn=>{ce(dn.millisecond(0),U.value)},me=dn=>{ce(H.value,dn.millisecond(0))},fe=dn=>{const At=dn.map(Be=>Mo(Be).locale(g.value)),Ke=We(At);return At[0].isSame(Ke[0])&&At[1].isSame(Ke[1])},ce=(dn,At)=>{i.visible&&t("pick",[dn,At],!0)},pe=te(()=>H.value>U.value),ye=Se([0,2]),De=(dn,At)=>{t("select-range",dn,At,"min"),ye.value=[dn,At]},tt=te(()=>G.value?11:8),Me=(dn,At)=>{t("select-range",dn,At,"max");const Ke=y(tt);ye.value=[dn+Ke,At+Ke]},xe=dn=>{const At=G.value?[0,3,6,11,14,17]:[0,3,8,11],Ke=["hours","minutes"].concat(G.value?["seconds"]:[]),Ht=(At.indexOf(ye.value[0])+dn+At.length)%At.length,Ut=At.length/2;Ht<Ut?Mt.start_emitSelectRange(Ke[Ht]):Mt.end_emitSelectRange(Ke[Ht-Ut])},Ae=dn=>{const At=dn.code,{left:Ke,right:Be,up:Ht,down:Ut}=On;if([Ke,Be].includes(At)){xe(At===Ke?-1:1),dn.preventDefault();return}if([Ht,Ut].includes(At)){const Nt=At===Ht?-1:1,Et=ye.value[0]<tt.value?"start":"end";Mt[`${Et}_scrollDown`](Nt),dn.preventDefault();return}},Ce=(dn,At)=>{const Ke=I?I(dn):[],Be=dn==="start",Ut=(At||(Be?U.value:H.value)).hour(),Nt=Be?s(Ut+1,23):s(0,Ut-1);return xw(Ke,Nt)},ge=(dn,At,Ke)=>{const Be=P?P(dn,At):[],Ht=At==="start",Ut=Ke||(Ht?U.value:H.value),Nt=Ut.hour();if(dn!==Nt)return Be;const Et=Ut.minute(),Gt=Ht?s(Et+1,59):s(0,Et-1);return xw(Be,Gt)},Ne=(dn,At,Ke,Be)=>{const Ht=F?F(dn,At,Ke):[],Ut=Ke==="start",Nt=Be||(Ut?U.value:H.value),Et=Nt.hour(),Gt=Nt.minute();if(dn!==Et||At!==Gt)return Ht;const ln=Nt.second(),yn=Ut?s(ln+1,59):s(0,ln-1);return xw(Ht,yn)},We=([dn,At])=>[zt(dn,"start",!0,At),zt(At,"end",!1,dn)],{getAvailableHours:ot,getAvailableMinutes:Oe,getAvailableSeconds:Ct}=ED(Ce,ge,Ne),{timePickerOptions:Mt,getAvailableTime:zt,onSetOption:bt}=TD({getAvailableHours:ot,getAvailableMinutes:Oe,getAvailableSeconds:Ct}),Kt=dn=>dn?fn(dn)?dn.map(At=>Mo(At,i.format).locale(g.value)):Mo(dn,i.format).locale(g.value):null,$t=dn=>dn?fn(dn)?dn.map(At=>At.format(i.format)):dn.format(i.format):null,Re=()=>{if(fn(B))return B.map(At=>Mo(At).locale(g.value));const dn=Mo(B).locale(g.value);return[dn,dn.add(60,"m")]};return t("set-picker-option",["formatToString",$t]),t("set-picker-option",["parseUserInput",Kt]),t("set-picker-option",["isValidValue",fe]),t("set-picker-option",["handleKeydownInput",Ae]),t("set-picker-option",["getDefaultValue",Re]),t("set-picker-option",["getRangeAvailableTime",We]),(dn,At)=>dn.actualVisible?(se(),Pe("div",{key:0,class:de([y(_).b("range-picker"),y(o).b("panel")])},[He("div",{class:de(y(_).be("range-picker","content"))},[He("div",{class:de(y(_).be("range-picker","cell"))},[He("div",{class:de(y(_).be("range-picker","header"))},wn(y(d)("el.datepicker.startTime")),3),He("div",{class:de(y($))},[Qe(M2,{ref:"minSpinner",role:"start","show-seconds":y(G),"am-pm-mode":y(Q),"arrow-control":y(E),"spinner-date":y(H),"disabled-hours":Ce,"disabled-minutes":ge,"disabled-seconds":Ne,onChange:le,onSetOption:y(bt),onSelectRange:De},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),He("div",{class:de(y(_).be("range-picker","cell"))},[He("div",{class:de(y(_).be("range-picker","header"))},wn(y(d)("el.datepicker.endTime")),3),He("div",{class:de(y(z))},[Qe(M2,{ref:"maxSpinner",role:"end","show-seconds":y(G),"am-pm-mode":y(Q),"arrow-control":y(E),"spinner-date":y(U),"disabled-hours":Ce,"disabled-minutes":ge,"disabled-seconds":Ne,onChange:me,onSetOption:y(bt),onSelectRange:Me},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),He("div",{class:de(y(_).be("panel","footer"))},[He("button",{type:"button",class:de([y(_).be("panel","btn"),"cancel"]),onClick:Ke=>Z()},wn(y(d)("el.datepicker.cancel")),11,["onClick"]),He("button",{type:"button",class:de([y(_).be("panel","btn"),"confirm"]),disabled:y(pe),onClick:Ke=>oe()},wn(y(d)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):St("v-if",!0)}});var yJ=bn(_J,[["__file","panel-time-range.vue"]]);Mo.extend(kT);var bJ=Ze({name:"ElTimePicker",install:null,props:{...PT,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const i=Se(),[s,d]=e.isRange?["timerange",yJ]:["time",wb],g=_=>t.emit("update:modelValue",_);return or("ElPopperOptions",e.popperOptions),t.expose({focus:()=>{var _;(_=i.value)==null||_.focus()},blur:()=>{var _;(_=i.value)==null||_.blur()},handleOpen:()=>{var _;(_=i.value)==null||_.handleOpen()},handleClose:()=>{var _;(_=i.value)==null||_.handleClose()}}),()=>{var _;const o=(_=e.format)!=null?_:E2;return Qe(SD,Yo(e,{ref:i,type:s,format:o,"onUpdate:modelValue":g}),{default:S=>Qe(d,S,null)})}}});const xJ=Ao(bJ),g1=Symbol(),wJ=vn({...PT,type:{type:ut(String),default:"date"}}),SJ=["date","dates","year","years","month","months","week","range"],RT=vn({disabledDate:{type:ut(Function)},date:{type:ut(Object),required:!0},minDate:{type:ut(Object)},maxDate:{type:ut(Object)},parsedValue:{type:ut([Object,Array])},rangeState:{type:ut(Object),default:()=>({endDate:null,selecting:!1})}}),ID=vn({type:{type:ut(String),required:!0,values:UK},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),OT=vn({unlinkPanels:Boolean,parsedValue:{type:ut(Array)}}),LT=e=>({type:String,values:SJ,default:e}),TJ=vn({...ID,parsedValue:{type:ut([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),Mm=e=>{if(!fn(e))return!1;const[t,i]=e;return Mo.isDayjs(t)&&Mo.isDayjs(i)&&t.isSameOrBefore(i)},DT=(e,{lang:t,unit:i,unlinkPanels:s})=>{let d;if(fn(e)){let[g,_]=e.map(o=>Mo(o).locale(t));return s||(_=g.add(1,i)),[g,_]}else e?d=Mo(e):d=Mo();return d=d.locale(t),[d,d.add(1,i)]},CJ=(e,t,{columnIndexOffset:i,startDate:s,nextEndDate:d,now:g,unit:_,relativeDateGetter:o,setCellMetadata:S,setRowMetadata:E})=>{for(let I=0;I<e.row;I++){const P=t[I];for(let F=0;F<e.column;F++){let B=P[F+i];B||(B={row:I,column:F,type:"normal",inRange:!1,start:!1,end:!1});const $=I*e.column+F,z=o($);B.dayjs=z,B.date=z.toDate(),B.timestamp=z.valueOf(),B.type="normal",B.inRange=!!(s&&z.isSameOrAfter(s,_)&&d&&z.isSameOrBefore(d,_))||!!(s&&z.isSameOrBefore(s,_)&&d&&z.isSameOrAfter(d,_)),s!=null&&s.isSameOrAfter(d)?(B.start=!!d&&z.isSame(d,_),B.end=s&&z.isSame(s,_)):(B.start=!!s&&z.isSame(s,_),B.end=!!d&&z.isSame(d,_)),z.isSame(g,_)&&(B.type="today"),S==null||S(B,{rowIndex:I,columnIndex:F}),P[F+i]=B}E==null||E(P)}},Sb=(e,t,i)=>{const s=Mo().locale(i).startOf("month").month(t).year(e),d=s.daysInMonth();return hh(d).map(g=>s.add(g,"day").toDate())},m_=(e,t,i,s)=>{const d=Mo().year(e).month(t).startOf("month"),g=Sb(e,t,i).find(_=>!(s!=null&&s(_)));return g?Mo(g).locale(i):d.locale(i)},I2=(e,t,i)=>{const s=e.year();if(!(i!=null&&i(e.toDate())))return e.locale(t);const d=e.month();if(!Sb(s,d,t).every(i))return m_(s,d,t,i);for(let g=0;g<12;g++)if(!Sb(s,g,t).every(i))return m_(s,g,t,i);return e},EJ=vn({...RT,cellClassName:{type:ut(Function)},showWeekNumber:Boolean,selectionMode:LT("date")}),MJ=["changerange","pick","select"],A2=(e="")=>["normal","today"].includes(e),IJ=(e,t)=>{const{lang:i}=vr(),s=Se(),d=Se(),g=Se(),_=Se(),o=Se([[],[],[],[],[],[]]);let S=!1;const E=e.date.$locale().weekStart||7,I=e.date.locale("en").localeData().weekdaysShort().map(ge=>ge.toLowerCase()),P=te(()=>E>3?7-E:-E),F=te(()=>{const ge=e.date.startOf("month");return ge.subtract(ge.day()||7,"day")}),B=te(()=>I.concat(I).slice(E,E+7)),$=te(()=>iO(y(G)).some(ge=>ge.isCurrent)),z=te(()=>{const ge=e.date.startOf("month"),Ne=ge.day()||7,We=ge.daysInMonth(),ot=ge.subtract(1,"month").daysInMonth();return{startOfMonthDay:Ne,dateCountOfMonth:We,dateCountOfLastMonth:ot}}),H=te(()=>e.selectionMode==="dates"?Rs(e.parsedValue):[]),U=(ge,{count:Ne,rowIndex:We,columnIndex:ot})=>{const{startOfMonthDay:Oe,dateCountOfMonth:Ct,dateCountOfLastMonth:Mt}=y(z),zt=y(P);if(We>=0&&We<=1){const bt=Oe+zt<0?7+Oe+zt:Oe+zt;if(ot+We*7>=bt)return ge.text=Ne,!0;ge.text=Mt-(bt-ot%7)+1+We*7,ge.type="prev-month"}else return Ne<=Ct?ge.text=Ne:(ge.text=Ne-Ct,ge.type="next-month"),!0;return!1},ie=(ge,{columnIndex:Ne,rowIndex:We},ot)=>{const{disabledDate:Oe,cellClassName:Ct}=e,Mt=y(H),zt=U(ge,{count:ot,rowIndex:We,columnIndex:Ne}),bt=ge.dayjs.toDate();return ge.selected=Mt.find(Kt=>Kt.isSame(ge.dayjs,"day")),ge.isSelected=!!ge.selected,ge.isCurrent=oe(ge),ge.disabled=Oe==null?void 0:Oe(bt),ge.customClass=Ct==null?void 0:Ct(bt),zt},Z=ge=>{if(e.selectionMode==="week"){const[Ne,We]=e.showWeekNumber?[1,7]:[0,6],ot=Ce(ge[Ne+1]);ge[Ne].inRange=ot,ge[Ne].start=ot,ge[We].inRange=ot,ge[We].end=ot}},G=te(()=>{const{minDate:ge,maxDate:Ne,rangeState:We,showWeekNumber:ot}=e,Oe=y(P),Ct=y(o),Mt="day";let zt=1;if(ot)for(let bt=0;bt<6;bt++)Ct[bt][0]||(Ct[bt][0]={type:"week",text:y(F).add(bt*7+1,Mt).week()});return CJ({row:6,column:7},Ct,{startDate:ge,columnIndexOffset:ot?1:0,nextEndDate:We.endDate||Ne||We.selecting&&ge||null,now:Mo().locale(y(i)).startOf(Mt),unit:Mt,relativeDateGetter:bt=>y(F).add(bt-Oe,Mt),setCellMetadata:(...bt)=>{ie(...bt,zt)&&(zt+=1)},setRowMetadata:Z}),Ct});tn(()=>e.date,async()=>{var ge;(ge=y(s))!=null&&ge.contains(document.activeElement)&&(await oo(),await Q())});const Q=async()=>{var ge;return(ge=y(d))==null?void 0:ge.focus()},oe=ge=>e.selectionMode==="date"&&A2(ge.type)&&le(ge,e.parsedValue),le=(ge,Ne)=>Ne?Mo(Ne).locale(y(i)).isSame(e.date.date(Number(ge.text)),"day"):!1,me=(ge,Ne)=>{const We=ge*7+(Ne-(e.showWeekNumber?1:0))-y(P);return y(F).add(We,"day")},fe=ge=>{var Ne;if(!e.rangeState.selecting)return;let We=ge.target;if(We.tagName==="SPAN"&&(We=(Ne=We.parentNode)==null?void 0:Ne.parentNode),We.tagName==="DIV"&&(We=We.parentNode),We.tagName!=="TD")return;const ot=We.parentNode.rowIndex-1,Oe=We.cellIndex;y(G)[ot][Oe].disabled||(ot!==y(g)||Oe!==y(_))&&(g.value=ot,_.value=Oe,t("changerange",{selecting:!0,endDate:me(ot,Oe)}))},ce=ge=>!y($)&&(ge==null?void 0:ge.text)===1&&ge.type==="normal"||ge.isCurrent,pe=ge=>{S||y($)||e.selectionMode!=="date"||Ae(ge,!0)},ye=ge=>{ge.target.closest("td")&&(S=!0)},De=ge=>{ge.target.closest("td")&&(S=!1)},tt=ge=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:ge,maxDate:null}),t("select",!0)):(ge>=e.minDate?t("pick",{minDate:e.minDate,maxDate:ge}):t("pick",{minDate:ge,maxDate:e.minDate}),t("select",!1))},Me=ge=>{const Ne=ge.week(),We=`${ge.year()}w${Ne}`;t("pick",{year:ge.year(),week:Ne,value:We,date:ge.startOf("week")})},xe=(ge,Ne)=>{const We=Ne?Rs(e.parsedValue).filter(ot=>(ot==null?void 0:ot.valueOf())!==ge.valueOf()):Rs(e.parsedValue).concat([ge]);t("pick",We)},Ae=(ge,Ne=!1)=>{const We=ge.target.closest("td");if(!We)return;const ot=We.parentNode.rowIndex-1,Oe=We.cellIndex,Ct=y(G)[ot][Oe];if(Ct.disabled||Ct.type==="week")return;const Mt=me(ot,Oe);switch(e.selectionMode){case"range":{tt(Mt);break}case"date":{t("pick",Mt,Ne);break}case"week":{Me(Mt);break}case"dates":{xe(Mt,!!Ct.selected);break}}},Ce=ge=>{if(e.selectionMode!=="week")return!1;let Ne=e.date.startOf("day");if(ge.type==="prev-month"&&(Ne=Ne.subtract(1,"month")),ge.type==="next-month"&&(Ne=Ne.add(1,"month")),Ne=Ne.date(Number.parseInt(ge.text,10)),e.parsedValue&&!fn(e.parsedValue)){const We=(e.parsedValue.day()-E+7)%7-1;return e.parsedValue.subtract(We,"day").isSame(Ne,"day")}return!1};return{WEEKS:B,rows:G,tbodyRef:s,currentCellRef:d,focus:Q,isCurrent:oe,isWeekActive:Ce,isSelectedCell:ce,handlePickDate:Ae,handleMouseUp:De,handleMouseDown:ye,handleMouseMove:fe,handleFocus:pe}},AJ=(e,{isCurrent:t,isWeekActive:i})=>{const s=rn("date-table"),{t:d}=vr(),g=te(()=>[s.b(),{"is-week-mode":e.selectionMode==="week"}]),_=te(()=>d("el.datepicker.dateTablePrompt")),o=te(()=>d("el.datepicker.week"));return{tableKls:g,tableLabel:_,weekLabel:o,getCellClasses:I=>{const P=[];return A2(I.type)&&!I.disabled?(P.push("available"),I.type==="today"&&P.push("today")):P.push(I.type),t(I)&&P.push("current"),I.inRange&&(A2(I.type)||e.selectionMode==="week")&&(P.push("in-range"),I.start&&P.push("start-date"),I.end&&P.push("end-date")),I.disabled&&P.push("disabled"),I.selected&&P.push("selected"),I.customClass&&P.push(I.customClass),P.join(" ")},getRowKls:I=>[s.e("row"),{current:i(I)}],t:d}},kJ=vn({cell:{type:ut(Object)}});var zT=Ze({name:"ElDatePickerCell",props:kJ,setup(e){const t=rn("date-table-cell"),{slots:i}=Un(g1);return()=>{const{cell:s}=e;return _t(i,"default",{...s},()=>{var d;return[Qe("div",{class:t.b()},[Qe("span",{class:t.e("text")},[(d=s==null?void 0:s.renderText)!=null?d:s==null?void 0:s.text])])]})}}});const PJ=Ze({__name:"basic-date-table",props:EJ,emits:MJ,setup(e,{expose:t,emit:i}){const s=e,{WEEKS:d,rows:g,tbodyRef:_,currentCellRef:o,focus:S,isCurrent:E,isWeekActive:I,isSelectedCell:P,handlePickDate:F,handleMouseUp:B,handleMouseDown:$,handleMouseMove:z,handleFocus:H}=IJ(s,i),{tableLabel:U,tableKls:ie,weekLabel:Z,getCellClasses:G,getRowKls:Q,t:oe}=AJ(s,{isCurrent:E,isWeekActive:I});return t({focus:S}),(le,me)=>(se(),Pe("table",{"aria-label":y(U),class:de(y(ie)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:y(F),onMousemove:y(z),onMousedown:po(y($),["prevent"]),onMouseup:y(B)},[He("tbody",{ref_key:"tbodyRef",ref:_},[He("tr",null,[le.showWeekNumber?(se(),Pe("th",{key:0,scope:"col"},wn(y(Z)),1)):St("v-if",!0),(se(!0),Pe(eo,null,tr(y(d),(fe,ce)=>(se(),Pe("th",{key:ce,"aria-label":y(oe)("el.datepicker.weeksFull."+fe),scope:"col"},wn(y(oe)("el.datepicker.weeks."+fe)),9,["aria-label"]))),128))]),(se(!0),Pe(eo,null,tr(y(g),(fe,ce)=>(se(),Pe("tr",{key:ce,class:de(y(Q)(fe[1]))},[(se(!0),Pe(eo,null,tr(fe,(pe,ye)=>(se(),Pe("td",{key:`${ce}.${ye}`,ref_for:!0,ref:De=>y(P)(pe)&&(o.value=De),class:de(y(G)(pe)),"aria-current":pe.isCurrent?"date":void 0,"aria-selected":pe.isCurrent,tabindex:y(P)(pe)?0:-1,onFocus:y(H)},[Qe(y(zT),{cell:pe},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var k2=bn(PJ,[["__file","basic-date-table.vue"]]);const RJ=vn({...RT,selectionMode:LT("month")}),OJ=Ze({__name:"basic-month-table",props:RJ,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const s=e,d=rn("month-table"),{t:g,lang:_}=vr(),o=Se(),S=Se(),E=Se(s.date.locale("en").localeData().monthsShort().map(Z=>Z.toLowerCase())),I=Se([[],[],[]]),P=Se(),F=Se(),B=te(()=>{var Z,G;const Q=I.value,oe=Mo().locale(_.value).startOf("month");for(let le=0;le<3;le++){const me=Q[le];for(let fe=0;fe<4;fe++){const ce=me[fe]||(me[fe]={row:le,column:fe,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});ce.type="normal";const pe=le*4+fe,ye=s.date.startOf("year").month(pe),De=s.rangeState.endDate||s.maxDate||s.rangeState.selecting&&s.minDate||null;ce.inRange=!!(s.minDate&&ye.isSameOrAfter(s.minDate,"month")&&De&&ye.isSameOrBefore(De,"month"))||!!(s.minDate&&ye.isSameOrBefore(s.minDate,"month")&&De&&ye.isSameOrAfter(De,"month")),(Z=s.minDate)!=null&&Z.isSameOrAfter(De)?(ce.start=!!(De&&ye.isSame(De,"month")),ce.end=s.minDate&&ye.isSame(s.minDate,"month")):(ce.start=!!(s.minDate&&ye.isSame(s.minDate,"month")),ce.end=!!(De&&ye.isSame(De,"month"))),oe.isSame(ye)&&(ce.type="today"),ce.text=pe,ce.disabled=((G=s.disabledDate)==null?void 0:G.call(s,ye.toDate()))||!1}}return Q}),$=()=>{var Z;(Z=S.value)==null||Z.focus()},z=Z=>{const G={},Q=s.date.year(),oe=new Date,le=Z.text;return G.disabled=s.disabledDate?Sb(Q,le,_.value).every(s.disabledDate):!1,G.current=Rs(s.parsedValue).findIndex(me=>Mo.isDayjs(me)&&me.year()===Q&&me.month()===le)>=0,G.today=oe.getFullYear()===Q&&oe.getMonth()===le,Z.inRange&&(G["in-range"]=!0,Z.start&&(G["start-date"]=!0),Z.end&&(G["end-date"]=!0)),G},H=Z=>{const G=s.date.year(),Q=Z.text;return Rs(s.date).findIndex(oe=>oe.year()===G&&oe.month()===Q)>=0},U=Z=>{var G;if(!s.rangeState.selecting)return;let Q=Z.target;if(Q.tagName==="SPAN"&&(Q=(G=Q.parentNode)==null?void 0:G.parentNode),Q.tagName==="DIV"&&(Q=Q.parentNode),Q.tagName!=="TD")return;const oe=Q.parentNode.rowIndex,le=Q.cellIndex;B.value[oe][le].disabled||(oe!==P.value||le!==F.value)&&(P.value=oe,F.value=le,i("changerange",{selecting:!0,endDate:s.date.startOf("year").month(oe*4+le)}))},ie=Z=>{var G;const Q=(G=Z.target)==null?void 0:G.closest("td");if((Q==null?void 0:Q.tagName)!=="TD"||el(Q,"disabled"))return;const oe=Q.cellIndex,me=Q.parentNode.rowIndex*4+oe,fe=s.date.startOf("year").month(me);if(s.selectionMode==="months"){if(Z.type==="keydown"){i("pick",Rs(s.parsedValue),!1);return}const ce=m_(s.date.year(),me,_.value,s.disabledDate),pe=el(Q,"current")?Rs(s.parsedValue).filter(ye=>(ye==null?void 0:ye.month())!==ce.month()):Rs(s.parsedValue).concat([Mo(ce)]);i("pick",pe)}else s.selectionMode==="range"?s.rangeState.selecting?(s.minDate&&fe>=s.minDate?i("pick",{minDate:s.minDate,maxDate:fe}):i("pick",{minDate:fe,maxDate:s.minDate}),i("select",!1)):(i("pick",{minDate:fe,maxDate:null}),i("select",!0)):i("pick",me)};return tn(()=>s.date,async()=>{var Z,G;(Z=o.value)!=null&&Z.contains(document.activeElement)&&(await oo(),(G=S.value)==null||G.focus())}),t({focus:$}),(Z,G)=>(se(),Pe("table",{role:"grid","aria-label":y(g)("el.datepicker.monthTablePrompt"),class:de(y(d).b()),onClick:ie,onMousemove:U},[He("tbody",{ref_key:"tbodyRef",ref:o},[(se(!0),Pe(eo,null,tr(y(B),(Q,oe)=>(se(),Pe("tr",{key:oe},[(se(!0),Pe(eo,null,tr(Q,(le,me)=>(se(),Pe("td",{key:me,ref_for:!0,ref:fe=>H(le)&&(S.value=fe),class:de(z(le)),"aria-selected":`${H(le)}`,"aria-label":y(g)(`el.datepicker.month${+le.text+1}`),tabindex:H(le)?0:-1,onKeydown:[ti(po(ie,["prevent","stop"]),["space"]),ti(po(ie,["prevent","stop"]),["enter"])]},[Qe(y(zT),{cell:{...le,renderText:y(g)("el.datepicker.months."+E.value[le.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var P2=bn(OJ,[["__file","basic-month-table.vue"]]);const LJ=vn({...RT,selectionMode:LT("year")}),DJ=Ze({__name:"basic-year-table",props:LJ,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const s=e,d=(G,Q)=>{const oe=Mo(String(G)).locale(Q).startOf("year"),me=oe.endOf("year").dayOfYear();return hh(me).map(fe=>oe.add(fe,"day").toDate())},g=rn("year-table"),{t:_,lang:o}=vr(),S=Se(),E=Se(),I=te(()=>Math.floor(s.date.year()/10)*10),P=Se([[],[],[]]),F=Se(),B=Se(),$=te(()=>{var G;const Q=P.value,oe=Mo().locale(o.value).startOf("year");for(let le=0;le<3;le++){const me=Q[le];for(let fe=0;fe<4&&!(le*4+fe>=10);fe++){let ce=me[fe];ce||(ce={row:le,column:fe,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),ce.type="normal";const pe=le*4+fe+I.value,ye=Mo().year(pe),De=s.rangeState.endDate||s.maxDate||s.rangeState.selecting&&s.minDate||null;ce.inRange=!!(s.minDate&&ye.isSameOrAfter(s.minDate,"year")&&De&&ye.isSameOrBefore(De,"year"))||!!(s.minDate&&ye.isSameOrBefore(s.minDate,"year")&&De&&ye.isSameOrAfter(De,"year")),(G=s.minDate)!=null&&G.isSameOrAfter(De)?(ce.start=!!(De&&ye.isSame(De,"year")),ce.end=!!(s.minDate&&ye.isSame(s.minDate,"year"))):(ce.start=!!(s.minDate&&ye.isSame(s.minDate,"year")),ce.end=!!(De&&ye.isSame(De,"year"))),oe.isSame(ye)&&(ce.type="today"),ce.text=pe;const Me=ye.toDate();ce.disabled=s.disabledDate&&s.disabledDate(Me)||!1,me[fe]=ce}}return Q}),z=()=>{var G;(G=E.value)==null||G.focus()},H=G=>{const Q={},oe=Mo().locale(o.value),le=G.text;return Q.disabled=s.disabledDate?d(le,o.value).every(s.disabledDate):!1,Q.today=oe.year()===le,Q.current=Rs(s.parsedValue).findIndex(me=>me.year()===le)>=0,G.inRange&&(Q["in-range"]=!0,G.start&&(Q["start-date"]=!0),G.end&&(Q["end-date"]=!0)),Q},U=G=>{const Q=G.text;return Rs(s.date).findIndex(oe=>oe.year()===Q)>=0},ie=G=>{var Q;const oe=(Q=G.target)==null?void 0:Q.closest("td");if(!oe||!oe.textContent||el(oe,"disabled"))return;const le=oe.cellIndex,fe=oe.parentNode.rowIndex*4+le+I.value,ce=Mo().year(fe);if(s.selectionMode==="range")s.rangeState.selecting?(s.minDate&&ce>=s.minDate?i("pick",{minDate:s.minDate,maxDate:ce}):i("pick",{minDate:ce,maxDate:s.minDate}),i("select",!1)):(i("pick",{minDate:ce,maxDate:null}),i("select",!0));else if(s.selectionMode==="years"){if(G.type==="keydown"){i("pick",Rs(s.parsedValue),!1);return}const pe=I2(ce.startOf("year"),o.value,s.disabledDate),ye=el(oe,"current")?Rs(s.parsedValue).filter(De=>(De==null?void 0:De.year())!==fe):Rs(s.parsedValue).concat([pe]);i("pick",ye)}else i("pick",fe)},Z=G=>{var Q;if(!s.rangeState.selecting)return;const oe=(Q=G.target)==null?void 0:Q.closest("td");if(!oe)return;const le=oe.parentNode.rowIndex,me=oe.cellIndex;$.value[le][me].disabled||(le!==F.value||me!==B.value)&&(F.value=le,B.value=me,i("changerange",{selecting:!0,endDate:Mo().year(I.value).add(le*4+me,"year")}))};return tn(()=>s.date,async()=>{var G,Q;(G=S.value)!=null&&G.contains(document.activeElement)&&(await oo(),(Q=E.value)==null||Q.focus())}),t({focus:z}),(G,Q)=>(se(),Pe("table",{role:"grid","aria-label":y(_)("el.datepicker.yearTablePrompt"),class:de(y(g).b()),onClick:ie,onMousemove:Z},[He("tbody",{ref_key:"tbodyRef",ref:S},[(se(!0),Pe(eo,null,tr(y($),(oe,le)=>(se(),Pe("tr",{key:le},[(se(!0),Pe(eo,null,tr(oe,(me,fe)=>(se(),Pe("td",{key:`${le}_${fe}`,ref_for:!0,ref:ce=>U(me)&&(E.value=ce),class:de(["available",H(me)]),"aria-selected":U(me),"aria-label":String(me.text),tabindex:U(me)?0:-1,onKeydown:[ti(po(ie,["prevent","stop"]),["space"]),ti(po(ie,["prevent","stop"]),["enter"])]},[Qe(y(zT),{cell:me},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var R2=bn(DJ,[["__file","basic-year-table.vue"]]);const zJ=Ze({__name:"panel-date-pick",props:TJ,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const i=e,s=(Dt,En,ft)=>!0,d=rn("picker-panel"),g=rn("date-picker"),_=Mh(),o=aa(),{t:S,lang:E}=vr(),I=Un("EP_PICKER_BASE"),P=Un(p1),{shortcuts:F,disabledDate:B,cellClassName:$,defaultTime:z}=I.props,H=Vr(I.props,"defaultValue"),U=Se(),ie=Se(Mo().locale(E.value)),Z=Se(!1);let G=!1;const Q=te(()=>Mo(z).locale(E.value)),oe=te(()=>ie.value.month()),le=te(()=>ie.value.year()),me=Se([]),fe=Se(null),ce=Se(null),pe=Dt=>me.value.length>0?s(Dt,me.value,i.format||"HH:mm:ss"):!0,ye=Dt=>z&&!Ht.value&&!Z.value&&!G?Q.value.year(Dt.year()).month(Dt.month()).date(Dt.date()):bt.value?Dt.millisecond(0):Dt.startOf("day"),De=(Dt,...En)=>{if(!Dt)t("pick",Dt,...En);else if(fn(Dt)){const ft=Dt.map(ye);t("pick",ft,...En)}else t("pick",ye(Dt),...En);fe.value=null,ce.value=null,Z.value=!1,G=!1},tt=async(Dt,En)=>{if(Ne.value==="date"){Dt=Dt;let ft=i.parsedValue?i.parsedValue.year(Dt.year()).month(Dt.month()).date(Dt.date()):Dt;pe(ft)||(ft=me.value[0][0].year(Dt.year()).month(Dt.month()).date(Dt.date())),ie.value=ft,De(ft,bt.value||En),i.type==="datetime"&&(await oo(),mo())}else Ne.value==="week"?De(Dt.date):Ne.value==="dates"&&De(Dt,!0)},Me=Dt=>{const En=Dt?"add":"subtract";ie.value=ie.value[En](1,"month"),ur("month")},xe=Dt=>{const En=ie.value,ft=Dt?"add":"subtract";ie.value=Ae.value==="year"?En[ft](10,"year"):En[ft](1,"year"),ur("year")},Ae=Se("date"),Ce=te(()=>{const Dt=S("el.datepicker.year");if(Ae.value==="year"){const En=Math.floor(le.value/10)*10;return Dt?`${En} ${Dt} - ${En+9} ${Dt}`:`${En} - ${En+9}`}return`${le.value} ${Dt}`}),ge=Dt=>{const En=Qn(Dt.value)?Dt.value():Dt.value;if(En){G=!0,De(Mo(En).locale(E.value));return}Dt.onClick&&Dt.onClick({attrs:_,slots:o,emit:t})},Ne=te(()=>{const{type:Dt}=i;return["week","month","months","year","years","dates"].includes(Dt)?Dt:"date"}),We=te(()=>Ne.value==="dates"||Ne.value==="months"||Ne.value==="years"),ot=te(()=>Ne.value==="date"?Ae.value:Ne.value),Oe=te(()=>!!F.length),Ct=async(Dt,En)=>{Ne.value==="month"?(ie.value=m_(ie.value.year(),Dt,E.value,B),De(ie.value,!1)):Ne.value==="months"?De(Dt,En??!0):(ie.value=m_(ie.value.year(),Dt,E.value,B),Ae.value="date",["month","year","date","week"].includes(Ne.value)&&(De(ie.value,!0),await oo(),mo())),ur("month")},Mt=async(Dt,En)=>{if(Ne.value==="year"){const ft=ie.value.startOf("year").year(Dt);ie.value=I2(ft,E.value,B),De(ie.value,!1)}else if(Ne.value==="years")De(Dt,En??!0);else{const ft=ie.value.year(Dt);ie.value=I2(ft,E.value,B),Ae.value="month",["month","year","date","week"].includes(Ne.value)&&(De(ie.value,!0),await oo(),mo())}ur("year")},zt=async Dt=>{Ae.value=Dt,await oo(),mo()},bt=te(()=>i.type==="datetime"||i.type==="datetimerange"),Kt=te(()=>{const Dt=bt.value||Ne.value==="dates",En=Ne.value==="years",ft=Ne.value==="months",un=Ae.value==="date",Je=Ae.value==="year",Mn=Ae.value==="month";return Dt&&un||En&&Je||ft&&Mn}),$t=te(()=>B?i.parsedValue?fn(i.parsedValue)?B(i.parsedValue[0].toDate()):B(i.parsedValue.toDate()):!0:!1),Re=()=>{if(We.value)De(i.parsedValue);else{let Dt=i.parsedValue;if(!Dt){const En=Mo(z).locale(E.value),ft=Co();Dt=En.year(ft.year()).month(ft.month()).date(ft.date())}ie.value=Dt,De(Dt)}},dn=te(()=>B?B(Mo().locale(E.value).toDate()):!1),At=()=>{const En=Mo().locale(E.value).toDate();Z.value=!0,(!B||!B(En))&&pe(En)&&(ie.value=Mo().locale(E.value),De(ie.value))},Ke=te(()=>i.timeFormat||$L(i.format)),Be=te(()=>i.dateFormat||NL(i.format)),Ht=te(()=>{if(ce.value)return ce.value;if(!(!i.parsedValue&&!H.value))return(i.parsedValue||ie.value).format(Ke.value)}),Ut=te(()=>{if(fe.value)return fe.value;if(!(!i.parsedValue&&!H.value))return(i.parsedValue||ie.value).format(Be.value)}),Nt=Se(!1),Et=()=>{Nt.value=!0},Gt=()=>{Nt.value=!1},ln=Dt=>({hour:Dt.hour(),minute:Dt.minute(),second:Dt.second(),year:Dt.year(),month:Dt.month(),date:Dt.date()}),yn=(Dt,En,ft)=>{const{hour:un,minute:Je,second:Mn}=ln(Dt),Bn=i.parsedValue?i.parsedValue.hour(un).minute(Je).second(Mn):Dt;ie.value=Bn,De(ie.value,!0),ft||(Nt.value=En)},_n=Dt=>{const En=Mo(Dt,Ke.value).locale(E.value);if(En.isValid()&&pe(En)){const{year:ft,month:un,date:Je}=ln(ie.value);ie.value=En.year(ft).month(un).date(Je),ce.value=null,Nt.value=!1,De(ie.value,!0)}},jn=Dt=>{const En=Mo(Dt,Be.value).locale(E.value);if(En.isValid()){if(B&&B(En.toDate()))return;const{hour:ft,minute:un,second:Je}=ln(ie.value);ie.value=En.hour(ft).minute(un).second(Je),fe.value=null,De(ie.value,!0)}},yt=Dt=>Mo.isDayjs(Dt)&&Dt.isValid()&&(B?!B(Dt.toDate()):!0),kn=Dt=>fn(Dt)?Dt.map(En=>En.format(i.format)):Dt.format(i.format),qn=Dt=>Mo(Dt,i.format).locale(E.value),Co=()=>{const Dt=Mo(H.value).locale(E.value);if(!H.value){const En=Q.value;return Mo().hour(En.hour()).minute(En.minute()).second(En.second()).locale(E.value)}return Dt},mo=async()=>{var Dt;["week","month","year","date"].includes(Ne.value)&&((Dt=U.value)==null||Dt.focus(),Ne.value==="week"&&Ho(On.down))},Io=Dt=>{const{code:En}=Dt;[On.up,On.down,On.left,On.right,On.home,On.end,On.pageUp,On.pageDown].includes(En)&&(Ho(En),Dt.stopPropagation(),Dt.preventDefault()),[On.enter,On.space,On.numpadEnter].includes(En)&&fe.value===null&&ce.value===null&&(Dt.preventDefault(),De(ie.value,!1))},Ho=Dt=>{var En;const{up:ft,down:un,left:Je,right:Mn,home:Bn,end:Oo,pageUp:Rr,pageDown:hi}=On,Er={year:{[ft]:-4,[un]:4,[Je]:-1,[Mn]:1,offset:(Xo,Bi)=>Xo.setFullYear(Xo.getFullYear()+Bi)},month:{[ft]:-4,[un]:4,[Je]:-1,[Mn]:1,offset:(Xo,Bi)=>Xo.setMonth(Xo.getMonth()+Bi)},week:{[ft]:-1,[un]:1,[Je]:-1,[Mn]:1,offset:(Xo,Bi)=>Xo.setDate(Xo.getDate()+Bi*7)},date:{[ft]:-7,[un]:7,[Je]:-1,[Mn]:1,[Bn]:Xo=>-Xo.getDay(),[Oo]:Xo=>-Xo.getDay()+6,[Rr]:Xo=>-new Date(Xo.getFullYear(),Xo.getMonth(),0).getDate(),[hi]:Xo=>new Date(Xo.getFullYear(),Xo.getMonth()+1,0).getDate(),offset:(Xo,Bi)=>Xo.setDate(Xo.getDate()+Bi)}},Nr=ie.value.toDate();for(;Math.abs(ie.value.diff(Nr,"year",!0))<1;){const Xo=Er[ot.value];if(!Xo)return;if(Xo.offset(Nr,Qn(Xo[Dt])?Xo[Dt](Nr):(En=Xo[Dt])!=null?En:0),B&&B(Nr))break;const Bi=Mo(Nr).locale(E.value);ie.value=Bi,t("pick",Bi,!0);break}},ur=Dt=>{t("panel-change",ie.value.toDate(),Dt,Ae.value)};return tn(()=>Ne.value,Dt=>{if(["month","year"].includes(Dt)){Ae.value=Dt;return}else if(Dt==="years"){Ae.value="year";return}else if(Dt==="months"){Ae.value="month";return}Ae.value="date"},{immediate:!0}),tn(()=>Ae.value,()=>{P==null||P.updatePopper()}),tn(()=>H.value,Dt=>{Dt&&(ie.value=Co())},{immediate:!0}),tn(()=>i.parsedValue,Dt=>{if(Dt){if(We.value||fn(Dt))return;ie.value=Dt}else ie.value=Co()},{immediate:!0}),t("set-picker-option",["isValidValue",yt]),t("set-picker-option",["formatToString",kn]),t("set-picker-option",["parseUserInput",qn]),t("set-picker-option",["handleFocusPicker",mo]),(Dt,En)=>(se(),Pe("div",{class:de([y(d).b(),y(g).b(),{"has-sidebar":Dt.$slots.sidebar||y(Oe),"has-time":y(bt)}])},[He("div",{class:de(y(d).e("body-wrapper"))},[_t(Dt.$slots,"sidebar",{class:de(y(d).e("sidebar"))}),y(Oe)?(se(),Pe("div",{key:0,class:de(y(d).e("sidebar"))},[(se(!0),Pe(eo,null,tr(y(F),(ft,un)=>(se(),Pe("button",{key:un,type:"button",class:de(y(d).e("shortcut")),onClick:Je=>ge(ft)},wn(ft.text),11,["onClick"]))),128))],2)):St("v-if",!0),He("div",{class:de(y(d).e("body"))},[y(bt)?(se(),Pe("div",{key:0,class:de(y(g).e("time-header"))},[He("span",{class:de(y(g).e("editor-wrap"))},[Qe(y(hs),{placeholder:y(S)("el.datepicker.selectDate"),"model-value":y(Ut),size:"small","validate-event":!1,onInput:ft=>fe.value=ft,onChange:jn},null,8,["placeholder","model-value","onInput"])],2),zo((se(),Pe("span",{class:de(y(g).e("editor-wrap"))},[Qe(y(hs),{placeholder:y(S)("el.datepicker.selectTime"),"model-value":y(Ht),size:"small","validate-event":!1,onFocus:Et,onInput:ft=>ce.value=ft,onChange:_n},null,8,["placeholder","model-value","onInput"]),Qe(y(wb),{visible:Nt.value,format:y(Ke),"parsed-value":ie.value,onPick:yn},null,8,["visible","format","parsed-value"])],2)),[[y(rd),Gt]])],2)):St("v-if",!0),zo(He("div",{class:de([y(g).e("header"),(Ae.value==="year"||Ae.value==="month")&&y(g).e("header--bordered")])},[He("span",{class:de(y(g).e("prev-btn"))},[He("button",{type:"button","aria-label":y(S)("el.datepicker.prevYear"),class:de(["d-arrow-left",y(d).e("icon-btn")]),onClick:ft=>xe(!1)},[_t(Dt.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(bh))]),_:1})])],10,["aria-label","onClick"]),zo(He("button",{type:"button","aria-label":y(S)("el.datepicker.prevMonth"),class:de([y(d).e("icon-btn"),"arrow-left"]),onClick:ft=>Me(!1)},[_t(Dt.$slots,"prev-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(yh))]),_:1})])],10,["aria-label","onClick"]),[[Cr,Ae.value==="date"]])],2),He("span",{role:"button",class:de(y(g).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:ti(ft=>zt("year"),["enter"]),onClick:ft=>zt("year")},wn(y(Ce)),43,["onKeydown","onClick"]),zo(He("span",{role:"button","aria-live":"polite",tabindex:"0",class:de([y(g).e("header-label"),{active:Ae.value==="month"}]),onKeydown:ti(ft=>zt("month"),["enter"]),onClick:ft=>zt("month")},wn(y(S)(`el.datepicker.month${y(oe)+1}`)),43,["onKeydown","onClick"]),[[Cr,Ae.value==="date"]]),He("span",{class:de(y(g).e("next-btn"))},[zo(He("button",{type:"button","aria-label":y(S)("el.datepicker.nextMonth"),class:de([y(d).e("icon-btn"),"arrow-right"]),onClick:ft=>Me(!0)},[_t(Dt.$slots,"next-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ls))]),_:1})])],10,["aria-label","onClick"]),[[Cr,Ae.value==="date"]]),He("button",{type:"button","aria-label":y(S)("el.datepicker.nextYear"),class:de([y(d).e("icon-btn"),"d-arrow-right"]),onClick:ft=>xe(!0)},[_t(Dt.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(xh))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[Cr,Ae.value!=="time"]]),He("div",{class:de(y(d).e("content")),onKeydown:Io},[Ae.value==="date"?(se(),Rt(k2,{key:0,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ne),date:ie.value,"parsed-value":Dt.parsedValue,"disabled-date":y(B),"cell-class-name":y($),onPick:tt},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):St("v-if",!0),Ae.value==="year"?(se(),Rt(R2,{key:1,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ne),date:ie.value,"disabled-date":y(B),"parsed-value":Dt.parsedValue,onPick:Mt},null,8,["selection-mode","date","disabled-date","parsed-value"])):St("v-if",!0),Ae.value==="month"?(se(),Rt(P2,{key:2,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ne),date:ie.value,"parsed-value":Dt.parsedValue,"disabled-date":y(B),onPick:Ct},null,8,["selection-mode","date","parsed-value","disabled-date"])):St("v-if",!0)],34)],2)],2),zo(He("div",{class:de(y(d).e("footer"))},[zo(Qe(y(Ta),{text:"",size:"small",class:de(y(d).e("link-btn")),disabled:y(dn),onClick:At},{default:at(()=>[nr(wn(y(S)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[Cr,!y(We)&&Dt.showNow]]),Qe(y(Ta),{plain:"",size:"small",class:de(y(d).e("link-btn")),disabled:y($t),onClick:Re},{default:at(()=>[nr(wn(y(S)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[Cr,y(Kt)]])],2))}});var FJ=bn(zJ,[["__file","panel-date-pick.vue"]]);const BJ=vn({...ID,...OT,visible:Boolean}),AD=e=>{const{emit:t}=jo(),i=Mh(),s=aa();return g=>{const _=Qn(g.value)?g.value():g.value;if(_){t("pick",[Mo(_[0]).locale(e.value),Mo(_[1]).locale(e.value)]);return}g.onClick&&g.onClick({attrs:i,slots:s,emit:t})}},kD=(e,{defaultValue:t,leftDate:i,rightDate:s,unit:d,onParsedValueChanged:g})=>{const{emit:_}=jo(),{pickerNs:o}=Un(g1),S=rn("date-range-picker"),{t:E,lang:I}=vr(),P=AD(I),F=Se(),B=Se(),$=Se({endDate:null,selecting:!1}),z=G=>{$.value=G},H=(G=!1)=>{const Q=y(F),oe=y(B);Mm([Q,oe])&&_("pick",[Q,oe],G)},U=G=>{$.value.selecting=G,G||($.value.endDate=null)},ie=G=>{if(fn(G)&&G.length===2){const[Q,oe]=G;F.value=Q,i.value=Q,B.value=oe,g(y(F),y(B))}else Z()},Z=()=>{const[G,Q]=DT(y(t),{lang:y(I),unit:d,unlinkPanels:e.unlinkPanels});F.value=void 0,B.value=void 0,i.value=G,s.value=Q};return tn(t,G=>{G&&Z()},{immediate:!0}),tn(()=>e.parsedValue,ie,{immediate:!0}),{minDate:F,maxDate:B,rangeState:$,lang:I,ppNs:o,drpNs:S,handleChangeRange:z,handleRangeConfirm:H,handleShortcutClick:P,onSelect:U,onReset:ie,t:E}},P0="month",NJ=Ze({__name:"panel-date-range",props:BJ,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const i=e,s=Un("EP_PICKER_BASE"),{disabledDate:d,cellClassName:g,defaultTime:_,clearable:o}=s.props,S=Vr(s.props,"format"),E=Vr(s.props,"shortcuts"),I=Vr(s.props,"defaultValue"),{lang:P}=vr(),F=Se(Mo().locale(P.value)),B=Se(Mo().locale(P.value).add(1,P0)),{minDate:$,maxDate:z,rangeState:H,ppNs:U,drpNs:ie,handleChangeRange:Z,handleRangeConfirm:G,handleShortcutClick:Q,onSelect:oe,onReset:le,t:me}=kD(i,{defaultValue:I,leftDate:F,rightDate:B,unit:P0,onParsedValueChanged:En});tn(()=>i.visible,ft=>{!ft&&H.value.selecting&&(le(i.parsedValue),oe(!1))});const fe=Se({min:null,max:null}),ce=Se({min:null,max:null}),pe=te(()=>`${F.value.year()} ${me("el.datepicker.year")} ${me(`el.datepicker.month${F.value.month()+1}`)}`),ye=te(()=>`${B.value.year()} ${me("el.datepicker.year")} ${me(`el.datepicker.month${B.value.month()+1}`)}`),De=te(()=>F.value.year()),tt=te(()=>F.value.month()),Me=te(()=>B.value.year()),xe=te(()=>B.value.month()),Ae=te(()=>!!E.value.length),Ce=te(()=>fe.value.min!==null?fe.value.min:$.value?$.value.format(Oe.value):""),ge=te(()=>fe.value.max!==null?fe.value.max:z.value||$.value?(z.value||$.value).format(Oe.value):""),Ne=te(()=>ce.value.min!==null?ce.value.min:$.value?$.value.format(ot.value):""),We=te(()=>ce.value.max!==null?ce.value.max:z.value||$.value?(z.value||$.value).format(ot.value):""),ot=te(()=>i.timeFormat||$L(S.value)),Oe=te(()=>i.dateFormat||NL(S.value)),Ct=ft=>Mm(ft)&&(d?!d(ft[0].toDate())&&!d(ft[1].toDate()):!0),Mt=()=>{F.value=F.value.subtract(1,"year"),i.unlinkPanels||(B.value=F.value.add(1,"month")),Ke("year")},zt=()=>{F.value=F.value.subtract(1,"month"),i.unlinkPanels||(B.value=F.value.add(1,"month")),Ke("month")},bt=()=>{i.unlinkPanels?B.value=B.value.add(1,"year"):(F.value=F.value.add(1,"year"),B.value=F.value.add(1,"month")),Ke("year")},Kt=()=>{i.unlinkPanels?B.value=B.value.add(1,"month"):(F.value=F.value.add(1,"month"),B.value=F.value.add(1,"month")),Ke("month")},$t=()=>{F.value=F.value.add(1,"year"),Ke("year")},Re=()=>{F.value=F.value.add(1,"month"),Ke("month")},dn=()=>{B.value=B.value.subtract(1,"year"),Ke("year")},At=()=>{B.value=B.value.subtract(1,"month"),Ke("month")},Ke=ft=>{t("panel-change",[F.value.toDate(),B.value.toDate()],ft)},Be=te(()=>{const ft=(tt.value+1)%12,un=tt.value+1>=12?1:0;return i.unlinkPanels&&new Date(De.value+un,ft)<new Date(Me.value,xe.value)}),Ht=te(()=>i.unlinkPanels&&Me.value*12+xe.value-(De.value*12+tt.value+1)>=12),Ut=te(()=>!($.value&&z.value&&!H.value.selecting&&Mm([$.value,z.value]))),Nt=te(()=>i.type==="datetime"||i.type==="datetimerange"),Et=(ft,un)=>{if(ft)return _?Mo(_[un]||_).locale(P.value).year(ft.year()).month(ft.month()).date(ft.date()):ft},Gt=(ft,un=!0)=>{const Je=ft.minDate,Mn=ft.maxDate,Bn=Et(Je,0),Oo=Et(Mn,1);z.value===Oo&&$.value===Bn||(t("calendar-change",[Je.toDate(),Mn&&Mn.toDate()]),z.value=Oo,$.value=Bn,!(!un||Nt.value)&&G())},ln=Se(!1),yn=Se(!1),_n=()=>{ln.value=!1},jn=()=>{yn.value=!1},yt=(ft,un)=>{fe.value[un]=ft;const Je=Mo(ft,Oe.value).locale(P.value);if(Je.isValid()){if(d&&d(Je.toDate()))return;un==="min"?(F.value=Je,$.value=($.value||F.value).year(Je.year()).month(Je.month()).date(Je.date()),!i.unlinkPanels&&(!z.value||z.value.isBefore($.value))&&(B.value=Je.add(1,"month"),z.value=$.value.add(1,"month"))):(B.value=Je,z.value=(z.value||B.value).year(Je.year()).month(Je.month()).date(Je.date()),!i.unlinkPanels&&(!$.value||$.value.isAfter(z.value))&&(F.value=Je.subtract(1,"month"),$.value=z.value.subtract(1,"month")))}},kn=(ft,un)=>{fe.value[un]=null},qn=(ft,un)=>{ce.value[un]=ft;const Je=Mo(ft,ot.value).locale(P.value);Je.isValid()&&(un==="min"?(ln.value=!0,$.value=($.value||F.value).hour(Je.hour()).minute(Je.minute()).second(Je.second())):(yn.value=!0,z.value=(z.value||B.value).hour(Je.hour()).minute(Je.minute()).second(Je.second()),B.value=z.value))},Co=(ft,un)=>{ce.value[un]=null,un==="min"?(F.value=$.value,ln.value=!1,(!z.value||z.value.isBefore($.value))&&(z.value=$.value)):(B.value=z.value,yn.value=!1,z.value&&z.value.isBefore($.value)&&($.value=z.value))},mo=(ft,un,Je)=>{ce.value.min||(ft&&(F.value=ft,$.value=($.value||F.value).hour(ft.hour()).minute(ft.minute()).second(ft.second())),Je||(ln.value=un),(!z.value||z.value.isBefore($.value))&&(z.value=$.value,B.value=ft))},Io=(ft,un,Je)=>{ce.value.max||(ft&&(B.value=ft,z.value=(z.value||B.value).hour(ft.hour()).minute(ft.minute()).second(ft.second())),Je||(yn.value=un),z.value&&z.value.isBefore($.value)&&($.value=z.value))},Ho=()=>{F.value=DT(y(I),{lang:y(P),unit:"month",unlinkPanels:i.unlinkPanels})[0],B.value=F.value.add(1,"month"),z.value=void 0,$.value=void 0,t("pick",null)},ur=ft=>fn(ft)?ft.map(un=>un.format(S.value)):ft.format(S.value),Dt=ft=>fn(ft)?ft.map(un=>Mo(un,S.value).locale(P.value)):Mo(ft,S.value).locale(P.value);function En(ft,un){if(i.unlinkPanels&&un){const Je=(ft==null?void 0:ft.year())||0,Mn=(ft==null?void 0:ft.month())||0,Bn=un.year(),Oo=un.month();B.value=Je===Bn&&Mn===Oo?un.add(1,P0):un}else B.value=F.value.add(1,P0),un&&(B.value=B.value.hour(un.hour()).minute(un.minute()).second(un.second()))}return t("set-picker-option",["isValidValue",Ct]),t("set-picker-option",["parseUserInput",Dt]),t("set-picker-option",["formatToString",ur]),t("set-picker-option",["handleClear",Ho]),(ft,un)=>(se(),Pe("div",{class:de([y(U).b(),y(ie).b(),{"has-sidebar":ft.$slots.sidebar||y(Ae),"has-time":y(Nt)}])},[He("div",{class:de(y(U).e("body-wrapper"))},[_t(ft.$slots,"sidebar",{class:de(y(U).e("sidebar"))}),y(Ae)?(se(),Pe("div",{key:0,class:de(y(U).e("sidebar"))},[(se(!0),Pe(eo,null,tr(y(E),(Je,Mn)=>(se(),Pe("button",{key:Mn,type:"button",class:de(y(U).e("shortcut")),onClick:Bn=>y(Q)(Je)},wn(Je.text),11,["onClick"]))),128))],2)):St("v-if",!0),He("div",{class:de(y(U).e("body"))},[y(Nt)?(se(),Pe("div",{key:0,class:de(y(ie).e("time-header"))},[He("span",{class:de(y(ie).e("editors-wrap"))},[He("span",{class:de(y(ie).e("time-picker-wrap"))},[Qe(y(hs),{size:"small",disabled:y(H).selecting,placeholder:y(me)("el.datepicker.startDate"),class:de(y(ie).e("editor")),"model-value":y(Ce),"validate-event":!1,onInput:Je=>yt(Je,"min"),onChange:Je=>kn(Je,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),zo((se(),Pe("span",{class:de(y(ie).e("time-picker-wrap"))},[Qe(y(hs),{size:"small",class:de(y(ie).e("editor")),disabled:y(H).selecting,placeholder:y(me)("el.datepicker.startTime"),"model-value":y(Ne),"validate-event":!1,onFocus:Je=>ln.value=!0,onInput:Je=>qn(Je,"min"),onChange:Je=>Co(Je,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),Qe(y(wb),{visible:ln.value,format:y(ot),"datetime-role":"start","parsed-value":F.value,onPick:mo},null,8,["visible","format","parsed-value"])],2)),[[y(rd),_n]])],2),He("span",null,[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ls))]),_:1})]),He("span",{class:de([y(ie).e("editors-wrap"),"is-right"])},[He("span",{class:de(y(ie).e("time-picker-wrap"))},[Qe(y(hs),{size:"small",class:de(y(ie).e("editor")),disabled:y(H).selecting,placeholder:y(me)("el.datepicker.endDate"),"model-value":y(ge),readonly:!y($),"validate-event":!1,onInput:Je=>yt(Je,"max"),onChange:Je=>kn(Je,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),zo((se(),Pe("span",{class:de(y(ie).e("time-picker-wrap"))},[Qe(y(hs),{size:"small",class:de(y(ie).e("editor")),disabled:y(H).selecting,placeholder:y(me)("el.datepicker.endTime"),"model-value":y(We),readonly:!y($),"validate-event":!1,onFocus:Je=>y($)&&(yn.value=!0),onInput:Je=>qn(Je,"max"),onChange:Je=>Co(Je,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),Qe(y(wb),{"datetime-role":"end",visible:yn.value,format:y(ot),"parsed-value":B.value,onPick:Io},null,8,["visible","format","parsed-value"])],2)),[[y(rd),jn]])],2)],2)):St("v-if",!0),He("div",{class:de([[y(U).e("content"),y(ie).e("content")],"is-left"])},[He("div",{class:de(y(ie).e("header"))},[He("button",{type:"button",class:de([y(U).e("icon-btn"),"d-arrow-left"]),"aria-label":y(me)("el.datepicker.prevYear"),onClick:Mt},[_t(ft.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(bh))]),_:1})])],10,["aria-label"]),He("button",{type:"button",class:de([y(U).e("icon-btn"),"arrow-left"]),"aria-label":y(me)("el.datepicker.prevMonth"),onClick:zt},[_t(ft.$slots,"prev-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(yh))]),_:1})])],10,["aria-label"]),ft.unlinkPanels?(se(),Pe("button",{key:0,type:"button",disabled:!y(Ht),class:de([[y(U).e("icon-btn"),{"is-disabled":!y(Ht)}],"d-arrow-right"]),"aria-label":y(me)("el.datepicker.nextYear"),onClick:$t},[_t(ft.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(xh))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),ft.unlinkPanels?(se(),Pe("button",{key:1,type:"button",disabled:!y(Be),class:de([[y(U).e("icon-btn"),{"is-disabled":!y(Be)}],"arrow-right"]),"aria-label":y(me)("el.datepicker.nextMonth"),onClick:Re},[_t(ft.$slots,"next-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ls))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),He("div",null,wn(y(pe)),1)],2),Qe(k2,{"selection-mode":"range",date:F.value,"min-date":y($),"max-date":y(z),"range-state":y(H),"disabled-date":y(d),"cell-class-name":y(g),onChangerange:y(Z),onPick:Gt,onSelect:y(oe)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),He("div",{class:de([[y(U).e("content"),y(ie).e("content")],"is-right"])},[He("div",{class:de(y(ie).e("header"))},[ft.unlinkPanels?(se(),Pe("button",{key:0,type:"button",disabled:!y(Ht),class:de([[y(U).e("icon-btn"),{"is-disabled":!y(Ht)}],"d-arrow-left"]),"aria-label":y(me)("el.datepicker.prevYear"),onClick:dn},[_t(ft.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(bh))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),ft.unlinkPanels?(se(),Pe("button",{key:1,type:"button",disabled:!y(Be),class:de([[y(U).e("icon-btn"),{"is-disabled":!y(Be)}],"arrow-left"]),"aria-label":y(me)("el.datepicker.prevMonth"),onClick:At},[_t(ft.$slots,"prev-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(yh))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),He("button",{type:"button","aria-label":y(me)("el.datepicker.nextYear"),class:de([y(U).e("icon-btn"),"d-arrow-right"]),onClick:bt},[_t(ft.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(xh))]),_:1})])],10,["aria-label"]),He("button",{type:"button",class:de([y(U).e("icon-btn"),"arrow-right"]),"aria-label":y(me)("el.datepicker.nextMonth"),onClick:Kt},[_t(ft.$slots,"next-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ls))]),_:1})])],10,["aria-label"]),He("div",null,wn(y(ye)),1)],2),Qe(k2,{"selection-mode":"range",date:B.value,"min-date":y($),"max-date":y(z),"range-state":y(H),"disabled-date":y(d),"cell-class-name":y(g),onChangerange:y(Z),onPick:Gt,onSelect:y(oe)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),y(Nt)?(se(),Pe("div",{key:0,class:de(y(U).e("footer"))},[y(o)?(se(),Rt(y(Ta),{key:0,text:"",size:"small",class:de(y(U).e("link-btn")),onClick:Ho},{default:at(()=>[nr(wn(y(me)("el.datepicker.clear")),1)]),_:1},8,["class"])):St("v-if",!0),Qe(y(Ta),{plain:"",size:"small",class:de(y(U).e("link-btn")),disabled:y(Ut),onClick:Je=>y(G)(!1)},{default:at(()=>[nr(wn(y(me)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):St("v-if",!0)],2))}});var $J=bn(NJ,[["__file","panel-date-range.vue"]]);const VJ=vn({...OT}),UJ=["pick","set-picker-option","calendar-change"],jJ=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const{t:s}=vr(),d=()=>{t.value=t.value.subtract(1,"year"),e.value||(i.value=i.value.subtract(1,"year"))},g=()=>{e.value||(t.value=t.value.add(1,"year")),i.value=i.value.add(1,"year")},_=()=>{t.value=t.value.add(1,"year")},o=()=>{i.value=i.value.subtract(1,"year")},S=te(()=>`${t.value.year()} ${s("el.datepicker.year")}`),E=te(()=>`${i.value.year()} ${s("el.datepicker.year")}`),I=te(()=>t.value.year()),P=te(()=>i.value.year()===t.value.year()?t.value.year()+1:i.value.year());return{leftPrevYear:d,rightNextYear:g,leftNextYear:_,rightPrevYear:o,leftLabel:S,rightLabel:E,leftYear:I,rightYear:P}},R0="year",HJ=Ze({name:"DatePickerMonthRange"}),GJ=Ze({...HJ,props:VJ,emits:UJ,setup(e,{emit:t}){const i=e,{lang:s}=vr(),d=Un("EP_PICKER_BASE"),{shortcuts:g,disabledDate:_}=d.props,o=Vr(d.props,"format"),S=Vr(d.props,"defaultValue"),E=Se(Mo().locale(s.value)),I=Se(Mo().locale(s.value).add(1,R0)),{minDate:P,maxDate:F,rangeState:B,ppNs:$,drpNs:z,handleChangeRange:H,handleRangeConfirm:U,handleShortcutClick:ie,onSelect:Z}=kD(i,{defaultValue:S,leftDate:E,rightDate:I,unit:R0,onParsedValueChanged:Ce}),G=te(()=>!!g.length),{leftPrevYear:Q,rightNextYear:oe,leftNextYear:le,rightPrevYear:me,leftLabel:fe,rightLabel:ce,leftYear:pe,rightYear:ye}=jJ({unlinkPanels:Vr(i,"unlinkPanels"),leftDate:E,rightDate:I}),De=te(()=>i.unlinkPanels&&ye.value>pe.value+1),tt=(ge,Ne=!0)=>{const We=ge.minDate,ot=ge.maxDate;F.value===ot&&P.value===We||(t("calendar-change",[We.toDate(),ot&&ot.toDate()]),F.value=ot,P.value=We,Ne&&U())},Me=()=>{E.value=DT(y(S),{lang:y(s),unit:"year",unlinkPanels:i.unlinkPanels})[0],I.value=E.value.add(1,"year"),t("pick",null)},xe=ge=>fn(ge)?ge.map(Ne=>Ne.format(o.value)):ge.format(o.value),Ae=ge=>fn(ge)?ge.map(Ne=>Mo(Ne,o.value).locale(s.value)):Mo(ge,o.value).locale(s.value);function Ce(ge,Ne){if(i.unlinkPanels&&Ne){const We=(ge==null?void 0:ge.year())||0,ot=Ne.year();I.value=We===ot?Ne.add(1,R0):Ne}else I.value=E.value.add(1,R0)}return t("set-picker-option",["isValidValue",Mm]),t("set-picker-option",["formatToString",xe]),t("set-picker-option",["parseUserInput",Ae]),t("set-picker-option",["handleClear",Me]),(ge,Ne)=>(se(),Pe("div",{class:de([y($).b(),y(z).b(),{"has-sidebar":!!ge.$slots.sidebar||y(G)}])},[He("div",{class:de(y($).e("body-wrapper"))},[_t(ge.$slots,"sidebar",{class:de(y($).e("sidebar"))}),y(G)?(se(),Pe("div",{key:0,class:de(y($).e("sidebar"))},[(se(!0),Pe(eo,null,tr(y(g),(We,ot)=>(se(),Pe("button",{key:ot,type:"button",class:de(y($).e("shortcut")),onClick:Oe=>y(ie)(We)},wn(We.text),11,["onClick"]))),128))],2)):St("v-if",!0),He("div",{class:de(y($).e("body"))},[He("div",{class:de([[y($).e("content"),y(z).e("content")],"is-left"])},[He("div",{class:de(y(z).e("header"))},[He("button",{type:"button",class:de([y($).e("icon-btn"),"d-arrow-left"]),onClick:y(Q)},[_t(ge.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(bh))]),_:1})])],10,["onClick"]),ge.unlinkPanels?(se(),Pe("button",{key:0,type:"button",disabled:!y(De),class:de([[y($).e("icon-btn"),{[y($).is("disabled")]:!y(De)}],"d-arrow-right"]),onClick:y(le)},[_t(ge.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(xh))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),He("div",null,wn(y(fe)),1)],2),Qe(P2,{"selection-mode":"range",date:E.value,"min-date":y(P),"max-date":y(F),"range-state":y(B),"disabled-date":y(_),onChangerange:y(H),onPick:tt,onSelect:y(Z)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),He("div",{class:de([[y($).e("content"),y(z).e("content")],"is-right"])},[He("div",{class:de(y(z).e("header"))},[ge.unlinkPanels?(se(),Pe("button",{key:0,type:"button",disabled:!y(De),class:de([[y($).e("icon-btn"),{"is-disabled":!y(De)}],"d-arrow-left"]),onClick:y(me)},[_t(ge.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(bh))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),He("button",{type:"button",class:de([y($).e("icon-btn"),"d-arrow-right"]),onClick:y(oe)},[_t(ge.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(xh))]),_:1})])],10,["onClick"]),He("div",null,wn(y(ce)),1)],2),Qe(P2,{"selection-mode":"range",date:I.value,"min-date":y(P),"max-date":y(F),"range-state":y(B),"disabled-date":y(_),onChangerange:y(H),onPick:tt,onSelect:y(Z)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var WJ=bn(GJ,[["__file","panel-month-range.vue"]]);const qJ=vn({...OT}),KJ=["pick","set-picker-option","calendar-change"],ZJ=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const s=()=>{t.value=t.value.subtract(10,"year"),e.value||(i.value=i.value.subtract(10,"year"))},d=()=>{e.value||(t.value=t.value.add(10,"year")),i.value=i.value.add(10,"year")},g=()=>{t.value=t.value.add(10,"year")},_=()=>{i.value=i.value.subtract(10,"year")},o=te(()=>{const P=Math.floor(t.value.year()/10)*10;return`${P}-${P+9}`}),S=te(()=>{const P=Math.floor(i.value.year()/10)*10;return`${P}-${P+9}`}),E=te(()=>Math.floor(t.value.year()/10)*10+9),I=te(()=>Math.floor(i.value.year()/10)*10);return{leftPrevYear:s,rightNextYear:d,leftNextYear:g,rightPrevYear:_,leftLabel:o,rightLabel:S,leftYear:E,rightYear:I}},hP="year",YJ=Ze({name:"DatePickerYearRange"}),XJ=Ze({...YJ,props:qJ,emits:KJ,setup(e,{emit:t}){const i=e,{lang:s}=vr(),d=Se(Mo().locale(s.value)),g=Se(d.value.add(10,"year")),{pickerNs:_}=Un(g1),o=rn("date-range-picker"),S=te(()=>!!tt.length),E=te(()=>[_.b(),o.b(),{"has-sidebar":!!aa().sidebar||S.value}]),I=te(()=>({content:[_.e("content"),o.e("content"),"is-left"],arrowLeftBtn:[_.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),{[_.is("disabled")]:!Q.value},"d-arrow-right"]})),P=te(()=>({content:[_.e("content"),o.e("content"),"is-right"],arrowLeftBtn:[_.e("icon-btn"),{"is-disabled":!Q.value},"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),"d-arrow-right"]})),F=AD(s),{leftPrevYear:B,rightNextYear:$,leftNextYear:z,rightPrevYear:H,leftLabel:U,rightLabel:ie,leftYear:Z,rightYear:G}=ZJ({unlinkPanels:Vr(i,"unlinkPanels"),leftDate:d,rightDate:g}),Q=te(()=>i.unlinkPanels&&G.value>Z.value+1),oe=Se(),le=Se(),me=Se({endDate:null,selecting:!1}),fe=Oe=>{me.value=Oe},ce=(Oe,Ct=!0)=>{const Mt=Oe.minDate,zt=Oe.maxDate;le.value===zt&&oe.value===Mt||(t("calendar-change",[Mt.toDate(),zt&&zt.toDate()]),le.value=zt,oe.value=Mt,Ct&&pe())},pe=(Oe=!1)=>{Mm([oe.value,le.value])&&t("pick",[oe.value,le.value],Oe)},ye=Oe=>{me.value.selecting=Oe,Oe||(me.value.endDate=null)},De=Un("EP_PICKER_BASE"),{shortcuts:tt,disabledDate:Me}=De.props,xe=Vr(De.props,"format"),Ae=Vr(De.props,"defaultValue"),Ce=()=>{let Oe;if(fn(Ae.value)){const Ct=Mo(Ae.value[0]);let Mt=Mo(Ae.value[1]);return i.unlinkPanels||(Mt=Ct.add(10,hP)),[Ct,Mt]}else Ae.value?Oe=Mo(Ae.value):Oe=Mo();return Oe=Oe.locale(s.value),[Oe,Oe.add(10,hP)]};tn(()=>Ae.value,Oe=>{if(Oe){const Ct=Ce();d.value=Ct[0],g.value=Ct[1]}},{immediate:!0}),tn(()=>i.parsedValue,Oe=>{if(Oe&&Oe.length===2)if(oe.value=Oe[0],le.value=Oe[1],d.value=oe.value,i.unlinkPanels&&le.value){const Ct=oe.value.year(),Mt=le.value.year();g.value=Ct===Mt?le.value.add(10,"year"):le.value}else g.value=d.value.add(10,"year");else{const Ct=Ce();oe.value=void 0,le.value=void 0,d.value=Ct[0],g.value=Ct[1]}},{immediate:!0});const ge=Oe=>fn(Oe)?Oe.map(Ct=>Mo(Ct,xe.value).locale(s.value)):Mo(Oe,xe.value).locale(s.value),Ne=Oe=>fn(Oe)?Oe.map(Ct=>Ct.format(xe.value)):Oe.format(xe.value),We=Oe=>Mm(Oe)&&(Me?!Me(Oe[0].toDate())&&!Me(Oe[1].toDate()):!0),ot=()=>{const Oe=Ce();d.value=Oe[0],g.value=Oe[1],le.value=void 0,oe.value=void 0,t("pick",null)};return t("set-picker-option",["isValidValue",We]),t("set-picker-option",["parseUserInput",ge]),t("set-picker-option",["formatToString",Ne]),t("set-picker-option",["handleClear",ot]),(Oe,Ct)=>(se(),Pe("div",{class:de(y(E))},[He("div",{class:de(y(_).e("body-wrapper"))},[_t(Oe.$slots,"sidebar",{class:de(y(_).e("sidebar"))}),y(S)?(se(),Pe("div",{key:0,class:de(y(_).e("sidebar"))},[(se(!0),Pe(eo,null,tr(y(tt),(Mt,zt)=>(se(),Pe("button",{key:zt,type:"button",class:de(y(_).e("shortcut")),onClick:bt=>y(F)(Mt)},wn(Mt.text),11,["onClick"]))),128))],2)):St("v-if",!0),He("div",{class:de(y(_).e("body"))},[He("div",{class:de(y(I).content)},[He("div",{class:de(y(o).e("header"))},[He("button",{type:"button",class:de(y(I).arrowLeftBtn),onClick:y(B)},[_t(Oe.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(bh))]),_:1})])],10,["onClick"]),Oe.unlinkPanels?(se(),Pe("button",{key:0,type:"button",disabled:!y(Q),class:de(y(I).arrowRightBtn),onClick:y(z)},[_t(Oe.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(xh))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),He("div",null,wn(y(U)),1)],2),Qe(R2,{"selection-mode":"range",date:d.value,"min-date":oe.value,"max-date":le.value,"range-state":me.value,"disabled-date":y(Me),onChangerange:fe,onPick:ce,onSelect:ye},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),He("div",{class:de(y(P).content)},[He("div",{class:de(y(o).e("header"))},[Oe.unlinkPanels?(se(),Pe("button",{key:0,type:"button",disabled:!y(Q),class:de(y(P).arrowLeftBtn),onClick:y(H)},[_t(Oe.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(bh))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),He("button",{type:"button",class:de(y(P).arrowRightBtn),onClick:y($)},[_t(Oe.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(xh))]),_:1})])],10,["onClick"]),He("div",null,wn(y(ie)),1)],2),Qe(R2,{"selection-mode":"range",date:g.value,"min-date":oe.value,"max-date":le.value,"range-state":me.value,"disabled-date":y(Me),onChangerange:fe,onPick:ce,onSelect:ye},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var JJ=bn(XJ,[["__file","panel-year-range.vue"]]);const QJ=function(e){switch(e){case"daterange":case"datetimerange":return $J;case"monthrange":return WJ;case"yearrange":return JJ;default:return FJ}};Mo.extend(UL);Mo.extend(qX);Mo.extend(kT);Mo.extend(ZX);Mo.extend(XX);Mo.extend(QX);Mo.extend(tJ);Mo.extend(oJ);var eQ=Ze({name:"ElDatePicker",install:null,props:wJ,emits:["update:modelValue"],setup(e,{expose:t,emit:i,slots:s}){const d=rn("picker-panel");or("ElPopperOptions",Pr(Vr(e,"popperOptions"))),or(g1,{slots:s,pickerNs:d});const g=Se();t({focus:()=>{var S;(S=g.value)==null||S.focus()},blur:()=>{var S;(S=g.value)==null||S.blur()},handleOpen:()=>{var S;(S=g.value)==null||S.handleOpen()},handleClose:()=>{var S;(S=g.value)==null||S.handleClose()}});const o=S=>{i("update:modelValue",S)};return()=>{var S;const E=(S=e.format)!=null?S:rJ[e.type]||Xp,I=QJ(e.type);return Qe(SD,Yo(e,{format:E,type:e.type,ref:g,"onUpdate:modelValue":o}),{default:P=>Qe(I,P,{"prev-month":s["prev-month"],"next-month":s["next-month"],"prev-year":s["prev-year"],"next-year":s["next-year"]}),"range-separator":s["range-separator"]})}}});const tQ=Ao(eQ),FT=Symbol("elDescriptions");var Pv=Ze({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:Un(FT,{})}},render(){var e;const t=hZ(this.cell),i=(((e=this.cell)==null?void 0:e.dirs)||[]).map(U=>{const{dir:ie,arg:Z,modifiers:G,value:Q}=U;return[ie,Q,Z,G]}),{border:s,direction:d}=this.descriptions,g=d==="vertical",_=()=>{var U,ie,Z;return((Z=(ie=(U=this.cell)==null?void 0:U.children)==null?void 0:ie.label)==null?void 0:Z.call(ie))||t.label},o=()=>{var U,ie,Z;return(Z=(ie=(U=this.cell)==null?void 0:U.children)==null?void 0:ie.default)==null?void 0:Z.call(ie)},S=t.span,E=t.rowspan,I=t.align?`is-${t.align}`:"",P=t.labelAlign?`is-${t.labelAlign}`:I,F=t.className,B=t.labelClassName,$=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,z={width:ji($),minWidth:ji(t.minWidth)},H=rn("descriptions");switch(this.type){case"label":return zo(lo(this.tag,{style:z,class:[H.e("cell"),H.e("label"),H.is("bordered-label",s),H.is("vertical-label",g),P,B],colSpan:g?S:1,rowspan:g?1:E},_()),i);case"content":return zo(lo(this.tag,{style:z,class:[H.e("cell"),H.e("content"),H.is("bordered-content",s),H.is("vertical-content",g),I,F],colSpan:g?S:S*2-1,rowspan:g?E*2-1:E},o()),i);default:{const U=_();return zo(lo("td",{style:z,class:[H.e("cell"),I],colSpan:S,rowspan:E},[ga(U)?void 0:lo("span",{class:[H.e("label"),B]},U),lo("span",{class:[H.e("content"),F]},o())]),i)}}}});const nQ=vn({row:{type:ut(Array),default:()=>[]}}),oQ=Ze({name:"ElDescriptionsRow"}),rQ=Ze({...oQ,props:nQ,setup(e){const t=Un(FT,{});return(i,s)=>y(t).direction==="vertical"?(se(),Pe(eo,{key:0},[He("tr",null,[(se(!0),Pe(eo,null,tr(i.row,(d,g)=>(se(),Rt(y(Pv),{key:`tr1-${g}`,cell:d,tag:"th",type:"label"},null,8,["cell"]))),128))]),He("tr",null,[(se(!0),Pe(eo,null,tr(i.row,(d,g)=>(se(),Rt(y(Pv),{key:`tr2-${g}`,cell:d,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(se(),Pe("tr",{key:1},[(se(!0),Pe(eo,null,tr(i.row,(d,g)=>(se(),Pe(eo,{key:`tr3-${g}`},[y(t).border?(se(),Pe(eo,{key:0},[Qe(y(Pv),{cell:d,tag:"td",type:"label"},null,8,["cell"]),Qe(y(Pv),{cell:d,tag:"td",type:"content"},null,8,["cell"])],64)):(se(),Rt(y(Pv),{key:1,cell:d,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var iQ=bn(rQ,[["__file","descriptions-row.vue"]]);const aQ=vn({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:ia,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),sQ=Ze({name:"ElDescriptions"}),lQ=Ze({...sQ,props:aQ,setup(e){const t=e,i=rn("descriptions"),s=na(),d=aa();or(FT,t);const g=te(()=>[i.b(),i.m(s.value)]),_=(S,E,I,P=!1)=>(S.props||(S.props={}),E>I&&(S.props.span=I),P&&(S.props.span=E),S),o=()=>{if(!d.default)return[];const S=fh(d.default()).filter($=>{var z;return((z=$==null?void 0:$.type)==null?void 0:z.name)==="ElDescriptionsItem"}),E=[];let I=[],P=t.column,F=0;const B=[];return S.forEach(($,z)=>{var H,U,ie;const Z=((H=$.props)==null?void 0:H.span)||1,G=((U=$.props)==null?void 0:U.rowspan)||1,Q=E.length;if(B[Q]||(B[Q]=0),G>1)for(let oe=1;oe<G;oe++)B[ie=Q+oe]||(B[ie]=0),B[Q+oe]++,F++;if(B[Q]>0&&(P-=B[Q],B[Q]=0),z<S.length-1&&(F+=Z>P?P:Z),z===S.length-1){const oe=t.column-F%t.column;I.push(_($,oe,P,!0)),E.push(I);return}Z<P?(P-=Z,I.push($)):(I.push(_($,Z,P)),E.push(I),P=t.column,I=[])}),E};return(S,E)=>(se(),Pe("div",{class:de(y(g))},[S.title||S.extra||S.$slots.title||S.$slots.extra?(se(),Pe("div",{key:0,class:de(y(i).e("header"))},[He("div",{class:de(y(i).e("title"))},[_t(S.$slots,"title",{},()=>[nr(wn(S.title),1)])],2),He("div",{class:de(y(i).e("extra"))},[_t(S.$slots,"extra",{},()=>[nr(wn(S.extra),1)])],2)],2)):St("v-if",!0),He("div",{class:de(y(i).e("body"))},[He("table",{class:de([y(i).e("table"),y(i).is("bordered",S.border)])},[He("tbody",null,[(se(!0),Pe(eo,null,tr(o(),(I,P)=>(se(),Rt(iQ,{key:P,row:I},null,8,["row"]))),128))])],2)],2)],2))}});var cQ=bn(lQ,[["__file","description.vue"]]);const uQ=vn({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),PD=Ze({name:"ElDescriptionsItem",props:uQ}),dQ=Ao(cQ,{DescriptionsItem:PD}),hQ=Oi(PD),BT=e=>{if(!e)return{onClick:jr,onMousedown:jr,onMouseup:jr};let t=!1,i=!1;return{onClick:_=>{t&&i&&e(_),t=i=!1},onMousedown:_=>{t=_.target===_.currentTarget},onMouseup:_=>{i=_.target===_.currentTarget}}},fQ=vn({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:ut([String,Array,Object])},zIndex:{type:ut([String,Number])}}),pQ={click:e=>e instanceof MouseEvent},mQ="overlay";var gQ=Ze({name:"ElOverlay",props:fQ,emits:pQ,setup(e,{slots:t,emit:i}){const s=rn(mQ),d=S=>{i("click",S)},{onClick:g,onMousedown:_,onMouseup:o}=BT(e.customMaskEvent?void 0:d);return()=>e.mask?Qe("div",{class:[s.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:g,onMousedown:_,onMouseup:o},[_t(t,"default")],Kl.STYLE|Kl.CLASS|Kl.PROPS,["onClick","onMouseup","onMousedown"]):lo("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[_t(t,"default")])}});const NT=gQ,RD=Symbol("dialogInjectionKey"),OD=vn({center:Boolean,alignCenter:Boolean,closeIcon:{type:Xr},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),vQ={close:()=>!0},LD=(e,t,i,s)=>{let d={offsetX:0,offsetY:0};const g=E=>{const I=E.clientX,P=E.clientY,{offsetX:F,offsetY:B}=d,$=e.value.getBoundingClientRect(),z=$.left,H=$.top,U=$.width,ie=$.height,Z=document.documentElement.clientWidth,G=document.documentElement.clientHeight,Q=-z+F,oe=-H+B,le=Z-z-U+F,me=G-H-ie+B,fe=pe=>{let ye=F+pe.clientX-I,De=B+pe.clientY-P;s!=null&&s.value||(ye=Math.min(Math.max(ye,Q),le),De=Math.min(Math.max(De,oe),me)),d={offsetX:ye,offsetY:De},e.value&&(e.value.style.transform=`translate(${ji(ye)}, ${ji(De)})`)},ce=()=>{document.removeEventListener("mousemove",fe),document.removeEventListener("mouseup",ce)};document.addEventListener("mousemove",fe),document.addEventListener("mouseup",ce)},_=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",g)},o=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",g)},S=()=>{d={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")};return No(()=>{Ha(()=>{i.value?_():o()})}),ni(()=>{o()}),{resetPosition:S}},v1=(...e)=>t=>{e.forEach(i=>{Qn(i)?i(t):i.value=t})},_Q=Ze({name:"ElDialogContent"}),yQ=Ze({..._Q,props:OD,emits:vQ,setup(e,{expose:t}){const i=e,{t:s}=vr(),{Close:d}=cT,{dialogRef:g,headerRef:_,bodyId:o,ns:S,style:E}=Un(RD),{focusTrapRef:I}=Un(mT),P=te(()=>[S.b(),S.is("fullscreen",i.fullscreen),S.is("draggable",i.draggable),S.is("align-center",i.alignCenter),{[S.m("center")]:i.center}]),F=v1(I,g),B=te(()=>i.draggable),$=te(()=>i.overflow),{resetPosition:z}=LD(g,_,B,$);return t({resetPosition:z}),(H,U)=>(se(),Pe("div",{ref:y(F),class:de(y(P)),style:to(y(E)),tabindex:"-1"},[He("header",{ref_key:"headerRef",ref:_,class:de([y(S).e("header"),{"show-close":H.showClose}])},[_t(H.$slots,"header",{},()=>[He("span",{role:"heading","aria-level":H.ariaLevel,class:de(y(S).e("title"))},wn(H.title),11,["aria-level"])]),H.showClose?(se(),Pe("button",{key:0,"aria-label":y(s)("el.dialog.close"),class:de(y(S).e("headerbtn")),type:"button",onClick:ie=>H.$emit("close")},[Qe(y(Gn),{class:de(y(S).e("close"))},{default:at(()=>[(se(),Rt(Wo(H.closeIcon||y(d))))]),_:1},8,["class"])],10,["aria-label","onClick"])):St("v-if",!0)],2),He("div",{id:y(o),class:de(y(S).e("body"))},[_t(H.$slots,"default")],10,["id"]),H.$slots.footer?(se(),Pe("footer",{key:0,class:de(y(S).e("footer"))},[_t(H.$slots,"footer")],2)):St("v-if",!0)],6))}});var bQ=bn(yQ,[["__file","dialog-content.vue"]]);const DD=vn({...OD,appendToBody:Boolean,appendTo:{type:ut([String,Object]),default:"body"},beforeClose:{type:ut(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),zD={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[Fo]:e=>ai(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},$T=(e,t={})=>{vi(e)||ha("[useLockscreen]","You need to pass a ref param to this function");const i=t.ns||rn("popup"),s=te(()=>i.bm("parent","hidden"));if(!gr||el(document.body,s.value))return;let d=0,g=!1,_="0";const o=()=>{setTimeout(()=>{typeof document>"u"||(fs(document==null?void 0:document.body,s.value),g&&document&&(document.body.style.width=_))},200)};tn(e,S=>{if(!S){o();return}g=!el(document.body,s.value),g&&(_=document.body.style.width),d=KO(i.namespace.value);const E=document.documentElement.clientHeight<document.body.scrollHeight,I=Ju(document.body,"overflowY");d>0&&(E||I==="scroll")&&g&&(document.body.style.width=`calc(100% - ${d}px)`),Yl(document.body,s.value)}),x3(()=>o())},FD=(e,t)=>{var i;const d=jo().emit,{nextZIndex:g}=Vm();let _="";const o=La(),S=La(),E=Se(!1),I=Se(!1),P=Se(!1),F=Se((i=e.zIndex)!=null?i:g());let B,$;const z=s1("namespace",Hv),H=te(()=>{const Me={},xe=`--${z.value}-dialog`;return e.fullscreen||(e.top&&(Me[`${xe}-margin-top`]=e.top),e.width&&(Me[`${xe}-width`]=ji(e.width))),Me}),U=te(()=>e.alignCenter?{display:"flex"}:{});function ie(){d("opened")}function Z(){d("closed"),d(Fo,!1),e.destroyOnClose&&(P.value=!1)}function G(){d("close")}function Q(){$==null||$(),B==null||B(),e.openDelay&&e.openDelay>0?{stop:B}=Nf(()=>fe(),e.openDelay):fe()}function oe(){B==null||B(),$==null||$(),e.closeDelay&&e.closeDelay>0?{stop:$}=Nf(()=>ce(),e.closeDelay):ce()}function le(){function Me(xe){xe||(I.value=!0,E.value=!1)}e.beforeClose?e.beforeClose(Me):oe()}function me(){e.closeOnClickModal&&le()}function fe(){gr&&(E.value=!0)}function ce(){E.value=!1}function pe(){d("openAutoFocus")}function ye(){d("closeAutoFocus")}function De(Me){var xe;((xe=Me.detail)==null?void 0:xe.focusReason)==="pointer"&&Me.preventDefault()}e.lockScroll&&$T(E);function tt(){e.closeOnPressEscape&&le()}return tn(()=>e.modelValue,Me=>{Me?(I.value=!1,Q(),P.value=!0,F.value=kO(e.zIndex)?g():F.value++,oo(()=>{d("open"),t.value&&(t.value.scrollTop=0)})):E.value&&oe()}),tn(()=>e.fullscreen,Me=>{t.value&&(Me?(_=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=_)}),No(()=>{e.modelValue&&(E.value=!0,P.value=!0,Q())}),{afterEnter:ie,afterLeave:Z,beforeLeave:G,handleClose:le,onModalClick:me,close:oe,doClose:ce,onOpenAutoFocus:pe,onCloseAutoFocus:ye,onCloseRequested:tt,onFocusoutPrevented:De,titleId:o,bodyId:S,closed:I,style:H,overlayDialogStyle:U,rendered:P,visible:E,zIndex:F}},xQ=Ze({name:"ElDialog",inheritAttrs:!1}),wQ=Ze({...xQ,props:DD,emits:zD,setup(e,{expose:t}){const i=e,s=aa();dh({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},te(()=>!!s.title));const d=rn("dialog"),g=Se(),_=Se(),o=Se(),{visible:S,titleId:E,bodyId:I,style:P,overlayDialogStyle:F,rendered:B,zIndex:$,afterEnter:z,afterLeave:H,beforeLeave:U,handleClose:ie,onModalClick:Z,onOpenAutoFocus:G,onCloseAutoFocus:Q,onCloseRequested:oe,onFocusoutPrevented:le}=FD(i,g);or(RD,{dialogRef:g,headerRef:_,bodyId:I,ns:d,rendered:B,style:P});const me=BT(Z),fe=te(()=>i.draggable&&!i.fullscreen);return t({visible:S,dialogContentRef:o,resetPosition:()=>{var pe;(pe=o.value)==null||pe.resetPosition()}}),(pe,ye)=>(se(),Rt(y(Hm),{to:pe.appendTo,disabled:pe.appendTo!=="body"?!1:!pe.appendToBody},{default:at(()=>[Qe(Ea,{name:"dialog-fade",onAfterEnter:y(z),onAfterLeave:y(H),onBeforeLeave:y(U),persisted:""},{default:at(()=>[zo(Qe(y(NT),{"custom-mask-event":"",mask:pe.modal,"overlay-class":pe.modalClass,"z-index":y($)},{default:at(()=>[He("div",{role:"dialog","aria-modal":"true","aria-label":pe.title||void 0,"aria-labelledby":pe.title?void 0:y(E),"aria-describedby":y(I),class:de(`${y(d).namespace.value}-overlay-dialog`),style:to(y(F)),onClick:y(me).onClick,onMousedown:y(me).onMousedown,onMouseup:y(me).onMouseup},[Qe(y(jm),{loop:"",trapped:y(S),"focus-start-el":"container",onFocusAfterTrapped:y(G),onFocusAfterReleased:y(Q),onFocusoutPrevented:y(le),onReleaseRequested:y(oe)},{default:at(()=>[y(B)?(se(),Rt(bQ,Yo({key:0,ref_key:"dialogContentRef",ref:o},pe.$attrs,{center:pe.center,"align-center":pe.alignCenter,"close-icon":pe.closeIcon,draggable:y(fe),overflow:pe.overflow,fullscreen:pe.fullscreen,"show-close":pe.showClose,title:pe.title,"aria-level":pe.headerAriaLevel,onClose:y(ie)}),ec({header:at(()=>[pe.$slots.title?_t(pe.$slots,"title",{key:1}):_t(pe.$slots,"header",{key:0,close:y(ie),titleId:y(E),titleClass:y(d).e("title")})]),default:at(()=>[_t(pe.$slots,"default")]),_:2},[pe.$slots.footer?{name:"footer",fn:at(()=>[_t(pe.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):St("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[Cr,y(S)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var SQ=bn(wQ,[["__file","dialog.vue"]]);const TQ=Ao(SQ),CQ=vn({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:ut(String),default:"solid"}}),EQ=Ze({name:"ElDivider"}),MQ=Ze({...EQ,props:CQ,setup(e){const t=e,i=rn("divider"),s=te(()=>i.cssVar({"border-style":t.borderStyle}));return(d,g)=>(se(),Pe("div",{class:de([y(i).b(),y(i).m(d.direction)]),style:to(y(s)),role:"separator"},[d.$slots.default&&d.direction!=="vertical"?(se(),Pe("div",{key:0,class:de([y(i).e("text"),y(i).is(d.contentPosition)])},[_t(d.$slots,"default")],2)):St("v-if",!0)],6))}});var IQ=bn(MQ,[["__file","divider.vue"]]);const BD=Ao(IQ),AQ=vn({...DD,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),kQ=zD,PQ=Ze({name:"ElDrawer",inheritAttrs:!1}),RQ=Ze({...PQ,props:AQ,emits:kQ,setup(e,{expose:t}){const i=e,s=aa();dh({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},te(()=>!!s.title));const d=Se(),g=Se(),_=rn("drawer"),{t:o}=vr(),{afterEnter:S,afterLeave:E,beforeLeave:I,visible:P,rendered:F,titleId:B,bodyId:$,zIndex:z,onModalClick:H,onOpenAutoFocus:U,onCloseAutoFocus:ie,onFocusoutPrevented:Z,onCloseRequested:G,handleClose:Q}=FD(i,d),oe=te(()=>i.direction==="rtl"||i.direction==="ltr"),le=te(()=>ji(i.size));return t({handleClose:Q,afterEnter:S,afterLeave:E}),(me,fe)=>(se(),Rt(y(Hm),{to:me.appendTo,disabled:me.appendTo!=="body"?!1:!me.appendToBody},{default:at(()=>[Qe(Ea,{name:y(_).b("fade"),onAfterEnter:y(S),onAfterLeave:y(E),onBeforeLeave:y(I),persisted:""},{default:at(()=>[zo(Qe(y(NT),{mask:me.modal,"overlay-class":me.modalClass,"z-index":y(z),onClick:y(H)},{default:at(()=>[Qe(y(jm),{loop:"",trapped:y(P),"focus-trap-el":d.value,"focus-start-el":g.value,onFocusAfterTrapped:y(U),onFocusAfterReleased:y(ie),onFocusoutPrevented:y(Z),onReleaseRequested:y(G)},{default:at(()=>[He("div",Yo({ref_key:"drawerRef",ref:d,"aria-modal":"true","aria-label":me.title||void 0,"aria-labelledby":me.title?void 0:y(B),"aria-describedby":y($)},me.$attrs,{class:[y(_).b(),me.direction,y(P)&&"open"],style:y(oe)?"width: "+y(le):"height: "+y(le),role:"dialog",onClick:po(()=>{},["stop"])}),[He("span",{ref_key:"focusStartRef",ref:g,class:de(y(_).e("sr-focus")),tabindex:"-1"},null,2),me.withHeader?(se(),Pe("header",{key:0,class:de(y(_).e("header"))},[me.$slots.title?_t(me.$slots,"title",{key:1},()=>[St(" DEPRECATED SLOT ")]):_t(me.$slots,"header",{key:0,close:y(Q),titleId:y(B),titleClass:y(_).e("title")},()=>[me.$slots.title?St("v-if",!0):(se(),Pe("span",{key:0,id:y(B),role:"heading","aria-level":me.headerAriaLevel,class:de(y(_).e("title"))},wn(me.title),11,["id","aria-level"]))]),me.showClose?(se(),Pe("button",{key:2,"aria-label":y(o)("el.drawer.close"),class:de(y(_).e("close-btn")),type:"button",onClick:y(Q)},[Qe(y(Gn),{class:de(y(_).e("close"))},{default:at(()=>[Qe(y(Kc))]),_:1},8,["class"])],10,["aria-label","onClick"])):St("v-if",!0)],2)):St("v-if",!0),y(F)?(se(),Pe("div",{key:1,id:y($),class:de(y(_).e("body"))},[_t(me.$slots,"default")],10,["id"])):St("v-if",!0),me.$slots.footer?(se(),Pe("div",{key:2,class:de(y(_).e("footer"))},[_t(me.$slots,"footer")],2)):St("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Cr,y(P)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var OQ=bn(RQ,[["__file","drawer.vue"]]);const LQ=Ao(OQ),DQ=Ze({inheritAttrs:!1});function zQ(e,t,i,s,d,g){return _t(e.$slots,"default")}var FQ=bn(DQ,[["render",zQ],["__file","collection.vue"]]);const BQ=Ze({name:"ElCollectionItem",inheritAttrs:!1});function NQ(e,t,i,s,d,g){return _t(e.$slots,"default")}var $Q=bn(BQ,[["render",NQ],["__file","collection-item.vue"]]);const ND="data-el-collection-item",$D=e=>{const t=`El${e}Collection`,i=`${t}Item`,s=Symbol(t),d=Symbol(i),g={...FQ,name:t,setup(){const o=Se(null),S=new Map;or(s,{itemMap:S,getItems:()=>{const I=y(o);if(!I)return[];const P=Array.from(I.querySelectorAll(`[${ND}]`));return[...S.values()].sort((B,$)=>P.indexOf(B.ref)-P.indexOf($.ref))},collectionRef:o})}},_={...$Q,name:i,setup(o,{attrs:S}){const E=Se(null),I=Un(s,void 0);or(d,{collectionItemRef:E}),No(()=>{const P=y(E);P&&I.itemMap.set(P,{ref:P,...S})}),ni(()=>{const P=y(E);I.itemMap.delete(P)})}};return{COLLECTION_INJECTION_KEY:s,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:g,ElCollectionItem:_}},VQ=vn({style:{type:ut([String,Array,Object])},currentTabId:{type:ut(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:ut(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:UQ,ElCollectionItem:jQ,COLLECTION_INJECTION_KEY:VT,COLLECTION_ITEM_INJECTION_KEY:HQ}=$D("RovingFocusGroup"),UT=Symbol("elRovingFocusGroup"),VD=Symbol("elRovingFocusGroupItem"),GQ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},WQ=(e,t)=>e,qQ=(e,t,i)=>{const s=WQ(e.code);return GQ[s]},KQ=(e,t)=>e.map((i,s)=>e[(s+t)%e.length]),jT=e=>{const{activeElement:t}=document;for(const i of e)if(i===t||(i.focus(),t!==document.activeElement))return},fP="currentTabIdChange",pP="rovingFocusGroup.entryFocus",ZQ={bubbles:!1,cancelable:!0},YQ=Ze({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:VQ,emits:[fP,"entryFocus"],setup(e,{emit:t}){var i;const s=Se((i=e.currentTabId||e.defaultCurrentTabId)!=null?i:null),d=Se(!1),g=Se(!1),_=Se(null),{getItems:o}=Un(VT,void 0),S=te(()=>[{outline:"none"},e.style]),E=z=>{t(fP,z)},I=()=>{d.value=!0},P=Ui(z=>{var H;(H=e.onMousedown)==null||H.call(e,z)},()=>{g.value=!0}),F=Ui(z=>{var H;(H=e.onFocus)==null||H.call(e,z)},z=>{const H=!y(g),{target:U,currentTarget:ie}=z;if(U===ie&&H&&!y(d)){const Z=new Event(pP,ZQ);if(ie==null||ie.dispatchEvent(Z),!Z.defaultPrevented){const G=o().filter(fe=>fe.focusable),Q=G.find(fe=>fe.active),oe=G.find(fe=>fe.id===y(s)),me=[Q,oe,...G].filter(Boolean).map(fe=>fe.ref);jT(me)}}g.value=!1}),B=Ui(z=>{var H;(H=e.onBlur)==null||H.call(e,z)},()=>{d.value=!1}),$=(...z)=>{t("entryFocus",...z)};or(UT,{currentTabbedId:Dm(s),loop:Vr(e,"loop"),tabIndex:te(()=>y(d)?-1:0),rovingFocusGroupRef:_,rovingFocusGroupRootStyle:S,orientation:Vr(e,"orientation"),dir:Vr(e,"dir"),onItemFocus:E,onItemShiftTab:I,onBlur:B,onFocus:F,onMousedown:P}),tn(()=>e.currentTabId,z=>{s.value=z??null}),qr(_,pP,$)}});function XQ(e,t,i,s,d,g){return _t(e.$slots,"default")}var JQ=bn(YQ,[["render",XQ],["__file","roving-focus-group-impl.vue"]]);const QQ=Ze({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:UQ,ElRovingFocusGroupImpl:JQ}});function eee(e,t,i,s,d,g){const _=Go("el-roving-focus-group-impl"),o=Go("el-focus-group-collection");return se(),Rt(o,null,{default:at(()=>[Qe(_,Vc(mh(e.$attrs)),{default:at(()=>[_t(e.$slots,"default")]),_:3},16)]),_:3})}var tee=bn(QQ,[["render",eee],["__file","roving-focus-group.vue"]]);const K0=vn({trigger:f_.trigger,effect:{...wa.effect,default:"light"},type:{type:ut(String)},placement:{type:ut(String),default:"bottom"},popperOptions:{type:ut(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:ut([Number,String]),default:0},maxHeight:{type:ut([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,default:"menu"},buttonProps:{type:ut(Object)},teleported:wa.teleported}),UD=vn({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Xr}}),nee=vn({onKeydown:{type:ut(Function)}}),oee=[On.down,On.pageDown,On.home],jD=[On.up,On.pageUp,On.end],ree=[...oee,...jD],{ElCollection:iee,ElCollectionItem:aee,COLLECTION_INJECTION_KEY:see,COLLECTION_ITEM_INJECTION_KEY:lee}=$D("Dropdown"),_1=Symbol("elDropdown"),{ButtonGroup:cee}=Ta,uee=Ze({name:"ElDropdown",components:{ElButton:Ta,ElButtonGroup:cee,ElScrollbar:Pu,ElDropdownCollection:iee,ElTooltip:qa,ElRovingFocusGroup:tee,ElOnlyChild:dL,ElIcon:Gn,ArrowDown:cd},props:K0,emits:["visible-change","click","command"],setup(e,{emit:t}){const i=jo(),s=rn("dropdown"),{t:d}=vr(),g=Se(),_=Se(),o=Se(null),S=Se(null),E=Se(null),I=Se(null),P=Se(!1),F=[On.enter,On.numpadEnter,On.space,On.down],B=te(()=>({maxHeight:ji(e.maxHeight)})),$=te(()=>[s.m(Q.value)]),z=te(()=>us(e.trigger)),H=La().value,U=te(()=>e.id||H);tn([g,z],([Ae,Ce],[ge])=>{var Ne,We,ot;(Ne=ge==null?void 0:ge.$el)!=null&&Ne.removeEventListener&&ge.$el.removeEventListener("pointerenter",le),(We=Ae==null?void 0:Ae.$el)!=null&&We.removeEventListener&&Ae.$el.removeEventListener("pointerenter",le),(ot=Ae==null?void 0:Ae.$el)!=null&&ot.addEventListener&&Ce.includes("hover")&&Ae.$el.addEventListener("pointerenter",le)},{immediate:!0}),ni(()=>{var Ae,Ce;(Ce=(Ae=g.value)==null?void 0:Ae.$el)!=null&&Ce.removeEventListener&&g.value.$el.removeEventListener("pointerenter",le)});function ie(){Z()}function Z(){var Ae;(Ae=o.value)==null||Ae.onClose()}function G(){var Ae;(Ae=o.value)==null||Ae.onOpen()}const Q=na();function oe(...Ae){t("command",...Ae)}function le(){var Ae,Ce;(Ce=(Ae=g.value)==null?void 0:Ae.$el)==null||Ce.focus()}function me(){}function fe(){const Ae=y(S);z.value.includes("hover")&&(Ae==null||Ae.focus()),I.value=null}function ce(Ae){I.value=Ae}function pe(Ae){P.value||(Ae.preventDefault(),Ae.stopImmediatePropagation())}function ye(){t("visible-change",!0)}function De(Ae){(Ae==null?void 0:Ae.type)==="keydown"&&S.value.focus()}function tt(){t("visible-change",!1)}return or(_1,{contentRef:S,role:te(()=>e.role),triggerId:U,isUsingKeyboard:P,onItemEnter:me,onItemLeave:fe}),or("elDropdown",{instance:i,dropdownSize:Q,handleClick:ie,commandHandler:oe,trigger:Vr(e,"trigger"),hideOnClick:Vr(e,"hideOnClick")}),{t:d,ns:s,scrollbar:E,wrapStyle:B,dropdownTriggerKls:$,dropdownSize:Q,triggerId:U,triggerKeys:F,currentTabId:I,handleCurrentTabIdChange:ce,handlerMainButtonClick:Ae=>{t("click",Ae)},handleEntryFocus:pe,handleClose:Z,handleOpen:G,handleBeforeShowTooltip:ye,handleShowTooltip:De,handleBeforeHideTooltip:tt,onFocusAfterTrapped:Ae=>{var Ce,ge;Ae.preventDefault(),(ge=(Ce=S.value)==null?void 0:Ce.focus)==null||ge.call(Ce,{preventScroll:!0})},popperRef:o,contentRef:S,triggeringElementRef:g,referenceElementRef:_}}});function dee(e,t,i,s,d,g){var _;const o=Go("el-dropdown-collection"),S=Go("el-roving-focus-group"),E=Go("el-scrollbar"),I=Go("el-only-child"),P=Go("el-tooltip"),F=Go("el-button"),B=Go("arrow-down"),$=Go("el-icon"),z=Go("el-button-group");return se(),Pe("div",{class:de([e.ns.b(),e.ns.is("disabled",e.disabled)])},[Qe(P,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(_=e.referenceElementRef)==null?void 0:_.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},ec({content:at(()=>[Qe(E,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:at(()=>[Qe(S,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:at(()=>[Qe(o,null,{default:at(()=>[_t(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:at(()=>[Qe(I,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:at(()=>[_t(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(se(),Rt(z,{key:0},{default:at(()=>[Qe(F,Yo({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:at(()=>[_t(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),Qe(F,Yo({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:at(()=>[Qe($,{class:de(e.ns.e("icon"))},{default:at(()=>[Qe(B)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):St("v-if",!0)],2)}var hee=bn(uee,[["render",dee],["__file","dropdown.vue"]]);const fee=Ze({components:{ElRovingFocusCollectionItem:jQ},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:i,loop:s,onItemFocus:d,onItemShiftTab:g}=Un(UT,void 0),{getItems:_}=Un(VT,void 0),o=La(),S=Se(null),E=Ui(B=>{t("mousedown",B)},B=>{e.focusable?d(y(o)):B.preventDefault()}),I=Ui(B=>{t("focus",B)},()=>{d(y(o))}),P=Ui(B=>{t("keydown",B)},B=>{const{code:$,shiftKey:z,target:H,currentTarget:U}=B;if($===On.tab&&z){g();return}if(H!==U)return;const ie=qQ(B);if(ie){B.preventDefault();let G=_().filter(Q=>Q.focusable).map(Q=>Q.ref);switch(ie){case"last":{G.reverse();break}case"prev":case"next":{ie==="prev"&&G.reverse();const Q=G.indexOf(U);G=s.value?KQ(G,Q+1):G.slice(Q+1);break}}oo(()=>{jT(G)})}}),F=te(()=>i.value===y(o));return or(VD,{rovingFocusGroupItemRef:S,tabIndex:te(()=>y(F)?0:-1),handleMousedown:E,handleFocus:I,handleKeydown:P}),{id:o,handleKeydown:P,handleFocus:I,handleMousedown:E}}});function pee(e,t,i,s,d,g){const _=Go("el-roving-focus-collection-item");return se(),Rt(_,{id:e.id,focusable:e.focusable,active:e.active},{default:at(()=>[_t(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var mee=bn(fee,[["render",pee],["__file","roving-focus-item.vue"]]);const gee=Ze({name:"DropdownItemImpl",components:{ElIcon:Gn},props:UD,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const i=rn("dropdown"),{role:s}=Un(_1,void 0),{collectionItemRef:d}=Un(lee,void 0),{collectionItemRef:g}=Un(HQ,void 0),{rovingFocusGroupItemRef:_,tabIndex:o,handleFocus:S,handleKeydown:E,handleMousedown:I}=Un(VD,void 0),P=v1(d,g,_),F=te(()=>s.value==="menu"?"menuitem":s.value==="navigation"?"link":"button"),B=Ui($=>{if([On.enter,On.numpadEnter,On.space].includes($.code))return $.preventDefault(),$.stopImmediatePropagation(),t("clickimpl",$),!0},E);return{ns:i,itemRef:P,dataset:{[ND]:""},role:F,tabIndex:o,handleFocus:S,handleKeydown:B,handleMousedown:I}}});function vee(e,t,i,s,d,g){const _=Go("el-icon");return se(),Pe(eo,null,[e.divided?(se(),Pe("li",{key:0,role:"separator",class:de(e.ns.bem("menu","item","divided"))},null,2)):St("v-if",!0),He("li",Yo({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:o=>e.$emit("clickimpl",o),onFocus:e.handleFocus,onKeydown:po(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:o=>e.$emit("pointermove",o),onPointerleave:o=>e.$emit("pointerleave",o)}),[e.icon?(se(),Rt(_,{key:0},{default:at(()=>[(se(),Rt(Wo(e.icon)))]),_:1})):St("v-if",!0),_t(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var _ee=bn(gee,[["render",vee],["__file","dropdown-item-impl.vue"]]);const HD=()=>{const e=Un("elDropdown",{}),t=te(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},yee=Ze({name:"ElDropdownItem",components:{ElDropdownCollectionItem:aee,ElRovingFocusItem:mee,ElDropdownItemImpl:_ee},inheritAttrs:!1,props:UD,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:i}){const{elDropdown:s}=HD(),d=jo(),g=Se(null),_=te(()=>{var B,$;return($=(B=y(g))==null?void 0:B.textContent)!=null?$:""}),{onItemEnter:o,onItemLeave:S}=Un(_1,void 0),E=Ui(B=>(t("pointermove",B),B.defaultPrevented),Hk(B=>{if(e.disabled){S(B);return}const $=B.currentTarget;$===document.activeElement||$.contains(document.activeElement)||(o(B),B.defaultPrevented||$==null||$.focus())})),I=Ui(B=>(t("pointerleave",B),B.defaultPrevented),Hk(S)),P=Ui(B=>{if(!e.disabled)return t("click",B),B.type!=="keydown"&&B.defaultPrevented},B=>{var $,z,H;if(e.disabled){B.stopImmediatePropagation();return}($=s==null?void 0:s.hideOnClick)!=null&&$.value&&((z=s.handleClick)==null||z.call(s)),(H=s.commandHandler)==null||H.call(s,e.command,d,B)}),F=te(()=>({...e,...i}));return{handleClick:P,handlePointerMove:E,handlePointerLeave:I,textContent:_,propsAndAttrs:F}}});function bee(e,t,i,s,d,g){var _;const o=Go("el-dropdown-item-impl"),S=Go("el-roving-focus-item"),E=Go("el-dropdown-collection-item");return se(),Rt(E,{disabled:e.disabled,"text-value":(_=e.textValue)!=null?_:e.textContent},{default:at(()=>[Qe(S,{focusable:!e.disabled},{default:at(()=>[Qe(o,Yo(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:at(()=>[_t(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var GD=bn(yee,[["render",bee],["__file","dropdown-item.vue"]]);const xee=Ze({name:"ElDropdownMenu",props:nee,setup(e){const t=rn("dropdown"),{_elDropdownSize:i}=HD(),s=i.value,{focusTrapRef:d,onKeydown:g}=Un(mT,void 0),{contentRef:_,role:o,triggerId:S}=Un(_1,void 0),{collectionRef:E,getItems:I}=Un(see,void 0),{rovingFocusGroupRef:P,rovingFocusGroupRootStyle:F,tabIndex:B,onBlur:$,onFocus:z,onMousedown:H}=Un(UT,void 0),{collectionRef:U}=Un(VT,void 0),ie=te(()=>[t.b("menu"),t.bm("menu",s==null?void 0:s.value)]),Z=v1(_,E,d,P,U),G=Ui(oe=>{var le;(le=e.onKeydown)==null||le.call(e,oe)},oe=>{const{currentTarget:le,code:me,target:fe}=oe;if(le.contains(fe),On.tab===me&&oe.stopImmediatePropagation(),oe.preventDefault(),fe!==y(_)||!ree.includes(me))return;const pe=I().filter(ye=>!ye.disabled).map(ye=>ye.ref);jD.includes(me)&&pe.reverse(),jT(pe)});return{size:s,rovingFocusGroupRootStyle:F,tabIndex:B,dropdownKls:ie,role:o,triggerId:S,dropdownListWrapperRef:Z,handleKeydown:oe=>{G(oe),g(oe)},onBlur:$,onFocus:z,onMousedown:H}}});function wee(e,t,i,s,d,g){return se(),Pe("ul",{ref:e.dropdownListWrapperRef,class:de(e.dropdownKls),style:to(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:po(e.handleKeydown,["self"]),onMousedown:po(e.onMousedown,["self"])},[_t(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var WD=bn(xee,[["render",wee],["__file","dropdown-menu.vue"]]);const See=Ao(hee,{DropdownItem:GD,DropdownMenu:WD}),Tee=Oi(GD),Cee=Oi(WD),Eee=Ze({name:"ImgEmpty"}),Mee=Ze({...Eee,setup(e){const t=rn("empty"),i=La();return(s,d)=>(se(),Pe("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[He("defs",null,[He("linearGradient",{id:`linearGradient-1-${y(i)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[He("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),He("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),He("linearGradient",{id:`linearGradient-2-${y(i)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[He("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),He("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),He("rect",{id:`path-3-${y(i)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),He("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[He("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[He("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[He("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${y(t).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),He("polygon",{id:"Rectangle-Copy-14",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),He("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[He("polygon",{id:"Rectangle-Copy-10",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),He("polygon",{id:"Rectangle-Copy-11",fill:`var(${y(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),He("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${y(i)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),He("polygon",{id:"Rectangle-Copy-13",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),He("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${y(i)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),He("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[He("use",{id:"Mask",fill:`var(${y(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${y(i)}`},null,8,["fill","xlink:href"]),He("polygon",{id:"Rectangle-Copy",fill:`var(${y(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${y(i)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),He("polygon",{id:"Rectangle-Copy-18",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var Iee=bn(Mee,[["__file","img-empty.vue"]]);const Aee=vn({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),kee=Ze({name:"ElEmpty"}),Pee=Ze({...kee,props:Aee,setup(e){const t=e,{t:i}=vr(),s=rn("empty"),d=te(()=>t.description||i("el.table.emptyText")),g=te(()=>({width:ji(t.imageSize)}));return(_,o)=>(se(),Pe("div",{class:de(y(s).b())},[He("div",{class:de(y(s).e("image")),style:to(y(g))},[_.image?(se(),Pe("img",{key:0,src:_.image,ondragstart:"return false"},null,8,["src"])):_t(_.$slots,"image",{key:1},()=>[Qe(Iee)])],6),He("div",{class:de(y(s).e("description"))},[_.$slots.description?_t(_.$slots,"description",{key:0}):(se(),Pe("p",{key:1},wn(y(d)),1))],2),_.$slots.default?(se(),Pe("div",{key:0,class:de(y(s).e("bottom"))},[_t(_.$slots,"default")],2)):St("v-if",!0)],2))}});var Ree=bn(Pee,[["__file","empty.vue"]]);const qD=Ao(Ree),Oee=vn({size:{type:String,values:ku},disabled:Boolean}),Lee=vn({...Oee,model:Object,rules:{type:ut(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),Dee={validate:(e,t,i)=>(fn(e)||Zn(e))&&ai(t)&&Zn(i)};function zee(){const e=Se([]),t=te(()=>{if(!e.value.length)return"0";const g=Math.max(...e.value);return g?`${g}px`:""});function i(g){const _=e.value.indexOf(g);return _===-1&&t.value,_}function s(g,_){if(g&&_){const o=i(_);e.value.splice(o,1,g)}else g&&e.value.push(g)}function d(g){const _=i(g);_>-1&&e.value.splice(_,1)}return{autoLabelWidth:t,registerLabelWidth:s,deregisterLabelWidth:d}}const O0=(e,t)=>{const i=us(t);return i.length>0?e.filter(s=>s.prop&&i.includes(s.prop)):e},Fee="ElForm",Bee=Ze({name:Fee}),Nee=Ze({...Bee,props:Lee,emits:Dee,setup(e,{expose:t,emit:i}){const s=e,d=[],g=na(),_=rn("form"),o=te(()=>{const{labelPosition:Z,inline:G}=s;return[_.b(),_.m(g.value||"default"),{[_.m(`label-${Z}`)]:Z,[_.m("inline")]:G}]}),S=Z=>d.find(G=>G.prop===Z),E=Z=>{d.push(Z)},I=Z=>{Z.prop&&d.splice(d.indexOf(Z),1)},P=(Z=[])=>{s.model&&O0(d,Z).forEach(G=>G.resetField())},F=(Z=[])=>{O0(d,Z).forEach(G=>G.clearValidate())},B=te(()=>!!s.model),$=Z=>{if(d.length===0)return[];const G=O0(d,Z);return G.length?G:[]},z=async Z=>U(void 0,Z),H=async(Z=[])=>{if(!B.value)return!1;const G=$(Z);if(G.length===0)return!0;let Q={};for(const oe of G)try{await oe.validate("")}catch(le){Q={...Q,...le}}return Object.keys(Q).length===0?!0:Promise.reject(Q)},U=async(Z=[],G)=>{const Q=!Qn(G);try{const oe=await H(Z);return oe===!0&&await(G==null?void 0:G(oe)),oe}catch(oe){if(oe instanceof Error)throw oe;const le=oe;return s.scrollToError&&ie(Object.keys(le)[0]),await(G==null?void 0:G(!1,le)),Q&&Promise.reject(le)}},ie=Z=>{var G;const Q=O0(d,Z)[0];Q&&((G=Q.$el)==null||G.scrollIntoView(s.scrollIntoViewOptions))};return tn(()=>s.rules,()=>{s.validateOnRuleChange&&z().catch(Z=>void 0)},{deep:!0}),or(Kf,Pr({...Ca(s),emit:i,resetFields:P,clearValidate:F,validateField:U,getField:S,addField:E,removeField:I,...zee()})),t({validate:z,validateField:U,resetFields:P,clearValidate:F,scrollToField:ie,fields:d}),(Z,G)=>(se(),Pe("form",{class:de(y(o))},[_t(Z.$slots,"default")],2))}});var $ee=bn(Nee,[["__file","form.vue"]]);function Cf(){return Cf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Cf.apply(this,arguments)}function Vee(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,g_(e,t)}function O2(e){return O2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},O2(e)}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,d){return s.__proto__=d,s},g_(e,t)}function Uee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Z0(e,t,i){return Uee()?Z0=Reflect.construct.bind():Z0=function(d,g,_){var o=[null];o.push.apply(o,g);var S=Function.bind.apply(d,o),E=new S;return _&&g_(E,_.prototype),E},Z0.apply(null,arguments)}function jee(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function L2(e){var t=typeof Map=="function"?new Map:void 0;return L2=function(s){if(s===null||!jee(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(s))return t.get(s);t.set(s,d)}function d(){return Z0(s,arguments,O2(this).constructor)}return d.prototype=Object.create(s.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),g_(d,s)},L2(e)}var Hee=/%[sdj%]/g,Gee=function(){};function D2(e){if(!e||!e.length)return null;var t={};return e.forEach(function(i){var s=i.field;t[s]=t[s]||[],t[s].push(i)}),t}function xl(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];var d=0,g=i.length;if(typeof e=="function")return e.apply(null,i);if(typeof e=="string"){var _=e.replace(Hee,function(o){if(o==="%%")return"%";if(d>=g)return o;switch(o){case"%s":return String(i[d++]);case"%d":return Number(i[d++]);case"%j":try{return JSON.stringify(i[d++])}catch{return"[Circular]"}break;default:return o}});return _}return e}function Wee(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function Ma(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||Wee(t)&&typeof e=="string"&&!e)}function qee(e,t,i){var s=[],d=0,g=e.length;function _(o){s.push.apply(s,o||[]),d++,d===g&&i(s)}e.forEach(function(o){t(o,_)})}function mP(e,t,i){var s=0,d=e.length;function g(_){if(_&&_.length){i(_);return}var o=s;s=s+1,o<d?t(e[o],g):i([])}g([])}function Kee(e){var t=[];return Object.keys(e).forEach(function(i){t.push.apply(t,e[i]||[])}),t}var gP=function(e){Vee(t,e);function t(i,s){var d;return d=e.call(this,"Async Validation Error")||this,d.errors=i,d.fields=s,d}return t}(L2(Error));function Zee(e,t,i,s,d){if(t.first){var g=new Promise(function(F,B){var $=function(U){return s(U),U.length?B(new gP(U,D2(U))):F(d)},z=Kee(e);mP(z,i,$)});return g.catch(function(F){return F}),g}var _=t.firstFields===!0?Object.keys(e):t.firstFields||[],o=Object.keys(e),S=o.length,E=0,I=[],P=new Promise(function(F,B){var $=function(H){if(I.push.apply(I,H),E++,E===S)return s(I),I.length?B(new gP(I,D2(I))):F(d)};o.length||(s(I),F(d)),o.forEach(function(z){var H=e[z];_.indexOf(z)!==-1?mP(H,i,$):qee(H,i,$)})});return P.catch(function(F){return F}),P}function Yee(e){return!!(e&&e.message!==void 0)}function Xee(e,t){for(var i=e,s=0;s<t.length;s++){if(i==null)return i;i=i[t[s]]}return i}function vP(e,t){return function(i){var s;return e.fullFields?s=Xee(t,e.fullFields):s=t[i.field||e.fullField],Yee(i)?(i.field=i.field||e.fullField,i.fieldValue=s,i):{message:typeof i=="function"?i():i,fieldValue:s,field:i.field||e.fullField}}}function _P(e,t){if(t){for(var i in t)if(t.hasOwnProperty(i)){var s=t[i];typeof s=="object"&&typeof e[i]=="object"?e[i]=Cf({},e[i],s):e[i]=s}}return e}var KD=function(t,i,s,d,g,_){t.required&&(!s.hasOwnProperty(t.field)||Ma(i,_||t.type))&&d.push(xl(g.messages.required,t.fullField))},Jee=function(t,i,s,d,g){(/^\s+$/.test(i)||i==="")&&d.push(xl(g.messages.whitespace,t.fullField))},L0,Qee=function(){if(L0)return L0;var e="[a-fA-F\\d:]",t=function(G){return G&&G.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+s+":){7}(?:"+s+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+s+":){6}(?:"+i+"|:"+s+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+s+":){5}(?::"+i+"|(?::"+s+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+s+":){4}(?:(?::"+s+"){0,1}:"+i+"|(?::"+s+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+s+":){3}(?:(?::"+s+"){0,2}:"+i+"|(?::"+s+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+s+":){2}(?:(?::"+s+"){0,3}:"+i+"|(?::"+s+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+s+":){1}(?:(?::"+s+"){0,4}:"+i+"|(?::"+s+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+s+"){0,5}:"+i+"|(?::"+s+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),g=new RegExp("(?:^"+i+"$)|(?:^"+d+"$)"),_=new RegExp("^"+i+"$"),o=new RegExp("^"+d+"$"),S=function(G){return G&&G.exact?g:new RegExp("(?:"+t(G)+i+t(G)+")|(?:"+t(G)+d+t(G)+")","g")};S.v4=function(Z){return Z&&Z.exact?_:new RegExp(""+t(Z)+i+t(Z),"g")},S.v6=function(Z){return Z&&Z.exact?o:new RegExp(""+t(Z)+d+t(Z),"g")};var E="(?:(?:[a-z]+:)?//)",I="(?:\\S+(?::\\S*)?@)?",P=S.v4().source,F=S.v6().source,B="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",$="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",z="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",H="(?::\\d{2,5})?",U='(?:[/?#][^\\s"]*)?',ie="(?:"+E+"|www\\.)"+I+"(?:localhost|"+P+"|"+F+"|"+B+$+z+")"+H+U;return L0=new RegExp("(?:^"+ie+"$)","i"),L0},yP={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Lv={integer:function(t){return Lv.number(t)&&parseInt(t,10)===t},float:function(t){return Lv.number(t)&&!Lv.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!Lv.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(yP.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(Qee())},hex:function(t){return typeof t=="string"&&!!t.match(yP.hex)}},ete=function(t,i,s,d,g){if(t.required&&i===void 0){KD(t,i,s,d,g);return}var _=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=t.type;_.indexOf(o)>-1?Lv[o](i)||d.push(xl(g.messages.types[o],t.fullField,t.type)):o&&typeof i!==t.type&&d.push(xl(g.messages.types[o],t.fullField,t.type))},tte=function(t,i,s,d,g){var _=typeof t.len=="number",o=typeof t.min=="number",S=typeof t.max=="number",E=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,I=i,P=null,F=typeof i=="number",B=typeof i=="string",$=Array.isArray(i);if(F?P="number":B?P="string":$&&(P="array"),!P)return!1;$&&(I=i.length),B&&(I=i.replace(E,"_").length),_?I!==t.len&&d.push(xl(g.messages[P].len,t.fullField,t.len)):o&&!S&&I<t.min?d.push(xl(g.messages[P].min,t.fullField,t.min)):S&&!o&&I>t.max?d.push(xl(g.messages[P].max,t.fullField,t.max)):o&&S&&(I<t.min||I>t.max)&&d.push(xl(g.messages[P].range,t.fullField,t.min,t.max))},Gp="enum",nte=function(t,i,s,d,g){t[Gp]=Array.isArray(t[Gp])?t[Gp]:[],t[Gp].indexOf(i)===-1&&d.push(xl(g.messages[Gp],t.fullField,t[Gp].join(", ")))},ote=function(t,i,s,d,g){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(i)||d.push(xl(g.messages.pattern.mismatch,t.fullField,i,t.pattern));else if(typeof t.pattern=="string"){var _=new RegExp(t.pattern);_.test(i)||d.push(xl(g.messages.pattern.mismatch,t.fullField,i,t.pattern))}}},si={required:KD,whitespace:Jee,type:ete,range:tte,enum:nte,pattern:ote},rte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i,"string")&&!t.required)return s();si.required(t,i,d,_,g,"string"),Ma(i,"string")||(si.type(t,i,d,_,g),si.range(t,i,d,_,g),si.pattern(t,i,d,_,g),t.whitespace===!0&&si.whitespace(t,i,d,_,g))}s(_)},ite=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),i!==void 0&&si.type(t,i,d,_,g)}s(_)},ate=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(i===""&&(i=void 0),Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),i!==void 0&&(si.type(t,i,d,_,g),si.range(t,i,d,_,g))}s(_)},ste=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),i!==void 0&&si.type(t,i,d,_,g)}s(_)},lte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),Ma(i)||si.type(t,i,d,_,g)}s(_)},cte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),i!==void 0&&(si.type(t,i,d,_,g),si.range(t,i,d,_,g))}s(_)},ute=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),i!==void 0&&(si.type(t,i,d,_,g),si.range(t,i,d,_,g))}s(_)},dte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(i==null&&!t.required)return s();si.required(t,i,d,_,g,"array"),i!=null&&(si.type(t,i,d,_,g),si.range(t,i,d,_,g))}s(_)},hte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),i!==void 0&&si.type(t,i,d,_,g)}s(_)},fte="enum",pte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g),i!==void 0&&si[fte](t,i,d,_,g)}s(_)},mte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i,"string")&&!t.required)return s();si.required(t,i,d,_,g),Ma(i,"string")||si.pattern(t,i,d,_,g)}s(_)},gte=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i,"date")&&!t.required)return s();if(si.required(t,i,d,_,g),!Ma(i,"date")){var S;i instanceof Date?S=i:S=new Date(i),si.type(t,S,d,_,g),S&&si.range(t,S.getTime(),d,_,g)}}s(_)},vte=function(t,i,s,d,g){var _=[],o=Array.isArray(i)?"array":typeof i;si.required(t,i,d,_,g,o),s(_)},Ow=function(t,i,s,d,g){var _=t.type,o=[],S=t.required||!t.required&&d.hasOwnProperty(t.field);if(S){if(Ma(i,_)&&!t.required)return s();si.required(t,i,d,o,g,_),Ma(i,_)||si.type(t,i,d,o,g)}s(o)},_te=function(t,i,s,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,g)}s(_)},Zv={string:rte,method:ite,number:ate,boolean:ste,regexp:lte,integer:cte,float:ute,array:dte,object:hte,enum:pte,pattern:mte,date:gte,url:Ow,hex:Ow,email:Ow,required:vte,any:_te};function z2(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var F2=z2(),$_=function(){function e(i){this.rules=null,this._messages=F2,this.define(i)}var t=e.prototype;return t.define=function(s){var d=this;if(!s)throw new Error("Cannot configure a schema with no rules");if(typeof s!="object"||Array.isArray(s))throw new Error("Rules must be an object");this.rules={},Object.keys(s).forEach(function(g){var _=s[g];d.rules[g]=Array.isArray(_)?_:[_]})},t.messages=function(s){return s&&(this._messages=_P(z2(),s)),this._messages},t.validate=function(s,d,g){var _=this;d===void 0&&(d={}),g===void 0&&(g=function(){});var o=s,S=d,E=g;if(typeof S=="function"&&(E=S,S={}),!this.rules||Object.keys(this.rules).length===0)return E&&E(null,o),Promise.resolve(o);function I(z){var H=[],U={};function ie(G){if(Array.isArray(G)){var Q;H=(Q=H).concat.apply(Q,G)}else H.push(G)}for(var Z=0;Z<z.length;Z++)ie(z[Z]);H.length?(U=D2(H),E(H,U)):E(null,o)}if(S.messages){var P=this.messages();P===F2&&(P=z2()),_P(P,S.messages),S.messages=P}else S.messages=this.messages();var F={},B=S.keys||Object.keys(this.rules);B.forEach(function(z){var H=_.rules[z],U=o[z];H.forEach(function(ie){var Z=ie;typeof Z.transform=="function"&&(o===s&&(o=Cf({},o)),U=o[z]=Z.transform(U)),typeof Z=="function"?Z={validator:Z}:Z=Cf({},Z),Z.validator=_.getValidationMethod(Z),Z.validator&&(Z.field=z,Z.fullField=Z.fullField||z,Z.type=_.getType(Z),F[z]=F[z]||[],F[z].push({rule:Z,value:U,source:o,field:z}))})});var $={};return Zee(F,S,function(z,H){var U=z.rule,ie=(U.type==="object"||U.type==="array")&&(typeof U.fields=="object"||typeof U.defaultField=="object");ie=ie&&(U.required||!U.required&&z.value),U.field=z.field;function Z(oe,le){return Cf({},le,{fullField:U.fullField+"."+oe,fullFields:U.fullFields?[].concat(U.fullFields,[oe]):[oe]})}function G(oe){oe===void 0&&(oe=[]);var le=Array.isArray(oe)?oe:[oe];!S.suppressWarning&&le.length&&e.warning("async-validator:",le),le.length&&U.message!==void 0&&(le=[].concat(U.message));var me=le.map(vP(U,o));if(S.first&&me.length)return $[U.field]=1,H(me);if(!ie)H(me);else{if(U.required&&!z.value)return U.message!==void 0?me=[].concat(U.message).map(vP(U,o)):S.error&&(me=[S.error(U,xl(S.messages.required,U.field))]),H(me);var fe={};U.defaultField&&Object.keys(z.value).map(function(ye){fe[ye]=U.defaultField}),fe=Cf({},fe,z.rule.fields);var ce={};Object.keys(fe).forEach(function(ye){var De=fe[ye],tt=Array.isArray(De)?De:[De];ce[ye]=tt.map(Z.bind(null,ye))});var pe=new e(ce);pe.messages(S.messages),z.rule.options&&(z.rule.options.messages=S.messages,z.rule.options.error=S.error),pe.validate(z.value,z.rule.options||S,function(ye){var De=[];me&&me.length&&De.push.apply(De,me),ye&&ye.length&&De.push.apply(De,ye),H(De.length?De:null)})}}var Q;if(U.asyncValidator)Q=U.asyncValidator(U,z.value,G,z.source,S);else if(U.validator){try{Q=U.validator(U,z.value,G,z.source,S)}catch(oe){console.error==null||console.error(oe),S.suppressValidatorError||setTimeout(function(){throw oe},0),G(oe.message)}Q===!0?G():Q===!1?G(typeof U.message=="function"?U.message(U.fullField||U.field):U.message||(U.fullField||U.field)+" fails"):Q instanceof Array?G(Q):Q instanceof Error&&G(Q.message)}Q&&Q.then&&Q.then(function(){return G()},function(oe){return G(oe)})},function(z){I(z)},o)},t.getType=function(s){if(s.type===void 0&&s.pattern instanceof RegExp&&(s.type="pattern"),typeof s.validator!="function"&&s.type&&!Zv.hasOwnProperty(s.type))throw new Error(xl("Unknown rule type %s",s.type));return s.type||"string"},t.getValidationMethod=function(s){if(typeof s.validator=="function")return s.validator;var d=Object.keys(s),g=d.indexOf("message");return g!==-1&&d.splice(g,1),d.length===1&&d[0]==="required"?Zv.required:Zv[this.getType(s)]||void 0},e}();$_.register=function(t,i){if(typeof i!="function")throw new Error("Cannot register a validator by type, validator is not a function");Zv[t]=i};$_.warning=Gee;$_.messages=F2;$_.validators=Zv;const yte=["","error","validating","success"],bte=vn({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:ut([String,Array])},required:{type:Boolean,default:void 0},rules:{type:ut([Object,Array])},error:String,validateStatus:{type:String,values:yte},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:ku}}),bP="ElLabelWrap";var xte=Ze({name:bP,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const i=Un(Kf,void 0),s=Un(Eu);s||ha(bP,"usage: <el-form-item><label-wrap /></el-form-item>");const d=rn("form"),g=Se(),_=Se(0),o=()=>{var I;if((I=g.value)!=null&&I.firstElementChild){const P=window.getComputedStyle(g.value.firstElementChild).width;return Math.ceil(Number.parseFloat(P))}else return 0},S=(I="update")=>{oo(()=>{t.default&&e.isAutoWidth&&(I==="update"?_.value=o():I==="remove"&&(i==null||i.deregisterLabelWidth(_.value)))})},E=()=>S("update");return No(()=>{E()}),ni(()=>{S("remove")}),Au(()=>E()),tn(_,(I,P)=>{e.updateAll&&(i==null||i.registerLabelWidth(I,P))}),Mi(te(()=>{var I,P;return(P=(I=g.value)==null?void 0:I.firstElementChild)!=null?P:null}),E),()=>{var I,P;if(!t)return null;const{isAutoWidth:F}=e;if(F){const B=i==null?void 0:i.autoLabelWidth,$=s==null?void 0:s.hasLabel,z={};if($&&B&&B!=="auto"){const H=Math.max(0,Number.parseInt(B,10)-_.value),ie=(s.labelPosition||i.labelPosition)==="left"?"marginRight":"marginLeft";H&&(z[ie]=`${H}px`)}return Qe("div",{ref:g,class:[d.be("item","label-wrap")],style:z},[(I=t.default)==null?void 0:I.call(t)])}else return Qe(eo,{ref:g},[(P=t.default)==null?void 0:P.call(t)])}}});const wte=Ze({name:"ElFormItem"}),Ste=Ze({...wte,props:bte,setup(e,{expose:t}){const i=e,s=aa(),d=Un(Kf,void 0),g=Un(Eu,void 0),_=na(void 0,{formItem:!1}),o=rn("form-item"),S=La().value,E=Se([]),I=Se(""),P=UH(I,100),F=Se(""),B=Se();let $,z=!1;const H=te(()=>i.labelPosition||(d==null?void 0:d.labelPosition)),U=te(()=>{if(H.value==="top")return{};const Kt=ji(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return Kt?{width:Kt}:{}}),ie=te(()=>{if(H.value==="top"||d!=null&&d.inline)return{};if(!i.label&&!i.labelWidth&&ce)return{};const Kt=ji(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return!i.label&&!s.label?{marginLeft:Kt}:{}}),Z=te(()=>[o.b(),o.m(_.value),o.is("error",I.value==="error"),o.is("validating",I.value==="validating"),o.is("success",I.value==="success"),o.is("required",Me.value||i.required),o.is("no-asterisk",d==null?void 0:d.hideRequiredAsterisk),(d==null?void 0:d.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[o.m("feedback")]:d==null?void 0:d.statusIcon,[o.m(`label-${H.value}`)]:H.value}]),G=te(()=>ai(i.inlineMessage)?i.inlineMessage:(d==null?void 0:d.inlineMessage)||!1),Q=te(()=>[o.e("error"),{[o.em("error","inline")]:G.value}]),oe=te(()=>i.prop?Zn(i.prop)?i.prop:i.prop.join("."):""),le=te(()=>!!(i.label||s.label)),me=te(()=>i.for||(E.value.length===1?E.value[0]:void 0)),fe=te(()=>!me.value&&le.value),ce=!!g,pe=te(()=>{const Kt=d==null?void 0:d.model;if(!(!Kt||!i.prop))return j0(Kt,i.prop).value}),ye=te(()=>{const{required:Kt}=i,$t=[];i.rules&&$t.push(...us(i.rules));const Re=d==null?void 0:d.rules;if(Re&&i.prop){const dn=j0(Re,i.prop).value;dn&&$t.push(...us(dn))}if(Kt!==void 0){const dn=$t.map((At,Ke)=>[At,Ke]).filter(([At])=>Object.keys(At).includes("required"));if(dn.length>0)for(const[At,Ke]of dn)At.required!==Kt&&($t[Ke]={...At,required:Kt});else $t.push({required:Kt})}return $t}),De=te(()=>ye.value.length>0),tt=Kt=>ye.value.filter(Re=>!Re.trigger||!Kt?!0:fn(Re.trigger)?Re.trigger.includes(Kt):Re.trigger===Kt).map(({trigger:Re,...dn})=>dn),Me=te(()=>ye.value.some(Kt=>Kt.required)),xe=te(()=>{var Kt;return P.value==="error"&&i.showMessage&&((Kt=d==null?void 0:d.showMessage)!=null?Kt:!0)}),Ae=te(()=>`${i.label||""}${(d==null?void 0:d.labelSuffix)||""}`),Ce=Kt=>{I.value=Kt},ge=Kt=>{var $t,Re;const{errors:dn,fields:At}=Kt;(!dn||!At)&&console.error(Kt),Ce("error"),F.value=dn?(Re=($t=dn==null?void 0:dn[0])==null?void 0:$t.message)!=null?Re:`${i.prop} is required`:"",d==null||d.emit("validate",i.prop,!1,F.value)},Ne=()=>{Ce("success"),d==null||d.emit("validate",i.prop,!0,"")},We=async Kt=>{const $t=oe.value;return new $_({[$t]:Kt}).validate({[$t]:pe.value},{firstFields:!0}).then(()=>(Ne(),!0)).catch(dn=>(ge(dn),Promise.reject(dn)))},ot=async(Kt,$t)=>{if(z||!i.prop)return!1;const Re=Qn($t);if(!De.value)return $t==null||$t(!1),!1;const dn=tt(Kt);return dn.length===0?($t==null||$t(!0),!0):(Ce("validating"),We(dn).then(()=>($t==null||$t(!0),!0)).catch(At=>{const{fields:Ke}=At;return $t==null||$t(!1,Ke),Re?!1:Promise.reject(Ke)}))},Oe=()=>{Ce(""),F.value="",z=!1},Ct=async()=>{const Kt=d==null?void 0:d.model;if(!Kt||!i.prop)return;const $t=j0(Kt,i.prop);z=!0,$t.value=JA($),await oo(),Oe(),z=!1},Mt=Kt=>{E.value.includes(Kt)||E.value.push(Kt)},zt=Kt=>{E.value=E.value.filter($t=>$t!==Kt)};tn(()=>i.error,Kt=>{F.value=Kt||"",Ce(Kt?"error":"")},{immediate:!0}),tn(()=>i.validateStatus,Kt=>Ce(Kt||""));const bt=Pr({...Ca(i),$el:B,size:_,validateState:I,labelId:S,inputIds:E,isGroup:fe,hasLabel:le,fieldValue:pe,addInputId:Mt,removeInputId:zt,resetField:Ct,clearValidate:Oe,validate:ot});return or(Eu,bt),No(()=>{i.prop&&(d==null||d.addField(bt),$=JA(pe.value))}),ni(()=>{d==null||d.removeField(bt)}),t({size:_,validateMessage:F,validateState:I,validate:ot,clearValidate:Oe,resetField:Ct}),(Kt,$t)=>{var Re;return se(),Pe("div",{ref_key:"formItemRef",ref:B,class:de(y(Z)),role:y(fe)?"group":void 0,"aria-labelledby":y(fe)?y(S):void 0},[Qe(y(xte),{"is-auto-width":y(U).width==="auto","update-all":((Re=y(d))==null?void 0:Re.labelWidth)==="auto"},{default:at(()=>[y(le)?(se(),Rt(Wo(y(me)?"label":"div"),{key:0,id:y(S),for:y(me),class:de(y(o).e("label")),style:to(y(U))},{default:at(()=>[_t(Kt.$slots,"label",{label:y(Ae)},()=>[nr(wn(y(Ae)),1)])]),_:3},8,["id","for","class","style"])):St("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),He("div",{class:de(y(o).e("content")),style:to(y(ie))},[_t(Kt.$slots,"default"),Qe(DR,{name:`${y(o).namespace.value}-zoom-in-top`},{default:at(()=>[y(xe)?_t(Kt.$slots,"error",{key:0,error:F.value},()=>[He("div",{class:de(y(Q))},wn(F.value),3)]):St("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var ZD=bn(Ste,[["__file","form-item.vue"]]);const Tte=Ao($ee,{FormItem:ZD}),Cte=Oi(ZD),Ete=vn({urlList:{type:ut(Array),default:()=>Ri([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:ut(String)}}),Mte={close:()=>!0,switch:e=>ao(e),rotate:e=>ao(e)},Ite=Ze({name:"ElImageViewer"}),Ate=Ze({...Ite,props:Ete,emits:Mte,setup(e,{expose:t,emit:i}){var s;const d=e,g={CONTAIN:{name:"contain",icon:uh(oW)},ORIGINAL:{name:"original",icon:uh(SW)}},{t:_}=vr(),o=rn("image-viewer"),{nextZIndex:S}=Vm(),E=Se(),I=Se([]),P=NN(),F=Se(!0),B=Se(d.initialIndex),$=gi(g.CONTAIN),z=Se({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),H=Se((s=d.zIndex)!=null?s:S()),U=te(()=>{const{urlList:ot}=d;return ot.length<=1}),ie=te(()=>B.value===0),Z=te(()=>B.value===d.urlList.length-1),G=te(()=>d.urlList[B.value]),Q=te(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!d.infinite&&ie.value)]),oe=te(()=>[o.e("btn"),o.e("next"),o.is("disabled",!d.infinite&&Z.value)]),le=te(()=>{const{scale:ot,deg:Oe,offsetX:Ct,offsetY:Mt,enableTransition:zt}=z.value;let bt=Ct/ot,Kt=Mt/ot;const $t=Oe*Math.PI/180,Re=Math.cos($t),dn=Math.sin($t);bt=bt*Re+Kt*dn,Kt=Kt*Re-Ct/ot*dn;const At={transform:`scale(${ot}) rotate(${Oe}deg) translate(${bt}px, ${Kt}px)`,transition:zt?"transform .3s":""};return $.value.name===g.CONTAIN.name&&(At.maxWidth=At.maxHeight="100%"),At});function me(){ce(),i("close")}function fe(){const ot=Pf(Ct=>{switch(Ct.code){case On.esc:d.closeOnPressEscape&&me();break;case On.space:Me();break;case On.left:Ae();break;case On.up:ge("zoomIn");break;case On.right:Ce();break;case On.down:ge("zoomOut");break}}),Oe=Pf(Ct=>{const Mt=Ct.deltaY||Ct.deltaX;ge(Mt<0?"zoomIn":"zoomOut",{zoomRate:d.zoomRate,enableTransition:!1})});P.run(()=>{qr(document,"keydown",ot),qr(document,"wheel",Oe)})}function ce(){P.stop()}function pe(){F.value=!1}function ye(ot){F.value=!1,ot.target.alt=_("el.image.error")}function De(ot){if(F.value||ot.button!==0||!E.value)return;z.value.enableTransition=!1;const{offsetX:Oe,offsetY:Ct}=z.value,Mt=ot.pageX,zt=ot.pageY,bt=Pf($t=>{z.value={...z.value,offsetX:Oe+$t.pageX-Mt,offsetY:Ct+$t.pageY-zt}}),Kt=qr(document,"mousemove",bt);qr(document,"mouseup",()=>{Kt()}),ot.preventDefault()}function tt(){z.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Me(){if(F.value)return;const ot=bm(g),Oe=Object.values(g),Ct=$.value.name,zt=(Oe.findIndex(bt=>bt.name===Ct)+1)%ot.length;$.value=g[ot[zt]],tt()}function xe(ot){const Oe=d.urlList.length;B.value=(ot+Oe)%Oe}function Ae(){ie.value&&!d.infinite||xe(B.value-1)}function Ce(){Z.value&&!d.infinite||xe(B.value+1)}function ge(ot,Oe={}){if(F.value)return;const{minScale:Ct,maxScale:Mt}=d,{zoomRate:zt,rotateDeg:bt,enableTransition:Kt}={zoomRate:d.zoomRate,rotateDeg:90,enableTransition:!0,...Oe};switch(ot){case"zoomOut":z.value.scale>Ct&&(z.value.scale=Number.parseFloat((z.value.scale/zt).toFixed(3)));break;case"zoomIn":z.value.scale<Mt&&(z.value.scale=Number.parseFloat((z.value.scale*zt).toFixed(3)));break;case"clockwise":z.value.deg+=bt,i("rotate",z.value.deg);break;case"anticlockwise":z.value.deg-=bt,i("rotate",z.value.deg);break}z.value.enableTransition=Kt}function Ne(ot){var Oe;((Oe=ot.detail)==null?void 0:Oe.focusReason)==="pointer"&&ot.preventDefault()}function We(){d.closeOnPressEscape&&me()}return tn(G,()=>{oo(()=>{const ot=I.value[0];ot!=null&&ot.complete||(F.value=!0)})}),tn(B,ot=>{tt(),i("switch",ot)}),No(()=>{fe()}),t({setActiveItem:xe}),(ot,Oe)=>(se(),Rt(y(Hm),{to:"body",disabled:!ot.teleported},{default:at(()=>[Qe(Ea,{name:"viewer-fade",appear:""},{default:at(()=>[He("div",{ref_key:"wrapper",ref:E,tabindex:-1,class:de(y(o).e("wrapper")),style:to({zIndex:H.value})},[Qe(y(jm),{loop:"",trapped:"","focus-trap-el":E.value,"focus-start-el":"container",onFocusoutPrevented:Ne,onReleaseRequested:We},{default:at(()=>[He("div",{class:de(y(o).e("mask")),onClick:po(Ct=>ot.hideOnClickModal&&me(),["self"])},null,10,["onClick"]),St(" CLOSE "),He("span",{class:de([y(o).e("btn"),y(o).e("close")]),onClick:me},[Qe(y(Gn),null,{default:at(()=>[Qe(y(Kc))]),_:1})],2),St(" ARROW "),y(U)?St("v-if",!0):(se(),Pe(eo,{key:0},[He("span",{class:de(y(Q)),onClick:Ae},[Qe(y(Gn),null,{default:at(()=>[Qe(y(yh))]),_:1})],2),He("span",{class:de(y(oe)),onClick:Ce},[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ls))]),_:1})],2)],64)),St(" ACTIONS "),He("div",{class:de([y(o).e("btn"),y(o).e("actions")])},[He("div",{class:de(y(o).e("actions__inner"))},[Qe(y(Gn),{onClick:Ct=>ge("zoomOut")},{default:at(()=>[Qe(y(NW))]),_:1},8,["onClick"]),Qe(y(Gn),{onClick:Ct=>ge("zoomIn")},{default:at(()=>[Qe(y(tL))]),_:1},8,["onClick"]),He("i",{class:de(y(o).e("actions__divider"))},null,2),Qe(y(Gn),{onClick:Me},{default:at(()=>[(se(),Rt(Wo(y($).icon)))]),_:1}),He("i",{class:de(y(o).e("actions__divider"))},null,2),Qe(y(Gn),{onClick:Ct=>ge("anticlockwise")},{default:at(()=>[Qe(y(yW))]),_:1},8,["onClick"]),Qe(y(Gn),{onClick:Ct=>ge("clockwise")},{default:at(()=>[Qe(y(xW))]),_:1},8,["onClick"])],2)],2),St(" CANVAS "),He("div",{class:de(y(o).e("canvas"))},[(se(!0),Pe(eo,null,tr(ot.urlList,(Ct,Mt)=>zo((se(),Pe("img",{ref_for:!0,ref:zt=>I.value[Mt]=zt,key:Ct,src:Ct,style:to(y(le)),class:de(y(o).e("img")),crossorigin:ot.crossorigin,onLoad:pe,onError:ye,onMousedown:De},null,46,["src","crossorigin"])),[[Cr,Mt===B.value]])),128))],2),_t(ot.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var kte=bn(Ate,[["__file","image-viewer.vue"]]);const YD=Ao(kte),Pte=vn({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ut([String,Object])},previewSrcList:{type:ut(Array),default:()=>Ri([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:ut(String)}}),Rte={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>ao(e),close:()=>!0,show:()=>!0},Ote=Ze({name:"ElImage",inheritAttrs:!1}),Lte=Ze({...Ote,props:Pte,emits:Rte,setup(e,{emit:t}){const i=e;let s="";const{t:d}=vr(),g=rn("image"),_=Mh(),o=te(()=>u_(Object.entries(_).filter(([Ce])=>/^(data-|on[A-Z])/i.test(Ce)||["id","style"].includes(Ce)))),S=z_({excludeListeners:!0,excludeKeys:te(()=>Object.keys(o.value))}),E=Se(),I=Se(!1),P=Se(!0),F=Se(!1),B=Se(),$=Se(),z=gr&&"loading"in HTMLImageElement.prototype;let H,U;const ie=te(()=>[g.e("inner"),G.value&&g.e("preview"),P.value&&g.is("loading")]),Z=te(()=>{const{fit:Ce}=i;return gr&&Ce?{objectFit:Ce}:{}}),G=te(()=>{const{previewSrcList:Ce}=i;return fn(Ce)&&Ce.length>0}),Q=te(()=>{const{previewSrcList:Ce,initialIndex:ge}=i;let Ne=ge;return ge>Ce.length-1&&(Ne=0),Ne}),oe=te(()=>i.loading==="eager"?!1:!z&&i.loading==="lazy"||i.lazy),le=()=>{gr&&(P.value=!0,I.value=!1,E.value=i.src)};function me(Ce){P.value=!1,I.value=!1,t("load",Ce)}function fe(Ce){P.value=!1,I.value=!0,t("error",Ce)}function ce(){tX(B.value,$.value)&&(le(),De())}const pe=LO(ce,200,!0);async function ye(){var Ce;if(!gr)return;await oo();const{scrollContainer:ge}=i;Tl(ge)?$.value=ge:Zn(ge)&&ge!==""?$.value=(Ce=document.querySelector(ge))!=null?Ce:void 0:B.value&&($.value=oT(B.value)),$.value&&(H=qr($,"scroll",pe),setTimeout(()=>ce(),100))}function De(){!gr||!$.value||!pe||(H==null||H(),$.value=void 0)}function tt(Ce){if(Ce.ctrlKey){if(Ce.deltaY<0)return Ce.preventDefault(),!1;if(Ce.deltaY>0)return Ce.preventDefault(),!1}}function Me(){G.value&&(U=qr("wheel",tt,{passive:!1}),s=document.body.style.overflow,document.body.style.overflow="hidden",F.value=!0,t("show"))}function xe(){U==null||U(),document.body.style.overflow=s,F.value=!1,t("close")}function Ae(Ce){t("switch",Ce)}return tn(()=>i.src,()=>{oe.value?(P.value=!0,I.value=!1,De(),ye()):le()}),No(()=>{oe.value?ye():le()}),(Ce,ge)=>(se(),Pe("div",Yo({ref_key:"container",ref:B},y(o),{class:[y(g).b(),Ce.$attrs.class]}),[I.value?_t(Ce.$slots,"error",{key:0},()=>[He("div",{class:de(y(g).e("error"))},wn(y(d)("el.image.error")),3)]):(se(),Pe(eo,{key:1},[E.value!==void 0?(se(),Pe("img",Yo({key:0},y(S),{src:E.value,loading:Ce.loading,style:y(Z),class:y(ie),crossorigin:Ce.crossorigin,onClick:Me,onLoad:me,onError:fe}),null,16,["src","loading","crossorigin"])):St("v-if",!0),P.value?(se(),Pe("div",{key:1,class:de(y(g).e("wrapper"))},[_t(Ce.$slots,"placeholder",{},()=>[He("div",{class:de(y(g).e("placeholder"))},null,2)])],2)):St("v-if",!0)],64)),y(G)?(se(),Pe(eo,{key:2},[F.value?(se(),Rt(y(YD),{key:0,"z-index":Ce.zIndex,"initial-index":y(Q),infinite:Ce.infinite,"zoom-rate":Ce.zoomRate,"min-scale":Ce.minScale,"max-scale":Ce.maxScale,"url-list":Ce.previewSrcList,crossorigin:Ce.crossorigin,"hide-on-click-modal":Ce.hideOnClickModal,teleported:Ce.previewTeleported,"close-on-press-escape":Ce.closeOnPressEscape,onClose:xe,onSwitch:Ae},{default:at(()=>[Ce.$slots.viewer?(se(),Pe("div",{key:0},[_t(Ce.$slots,"viewer")])):St("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):St("v-if",!0)],64)):St("v-if",!0)],16))}});var Dte=bn(Lte,[["__file","image.vue"]]);const zte=Ao(Dte),Fte=vn({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:ia,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||ao(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),Bte={[Yr]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Ga]:e=>ao(e)||ga(e),[Fo]:e=>ao(e)||ga(e)},Nte=Ze({name:"ElInputNumber"}),$te=Ze({...Nte,props:Fte,emits:Bte,setup(e,{expose:t,emit:i}){const s=e,{t:d}=vr(),g=rn("input-number"),_=Se(),o=Pr({currentValue:s.modelValue,userInput:null}),{formItem:S}=Ka(),E=te(()=>ao(s.modelValue)&&s.modelValue<=s.min),I=te(()=>ao(s.modelValue)&&s.modelValue>=s.max),P=te(()=>{const Me=U(s.step);return Hr(s.precision)?Math.max(U(s.modelValue),Me):(Me>s.precision,s.precision)}),F=te(()=>s.controls&&s.controlsPosition==="right"),B=na(),$=Za(),z=te(()=>{if(o.userInput!==null)return o.userInput;let Me=o.currentValue;if(ga(Me))return"";if(ao(Me)){if(Number.isNaN(Me))return"";Hr(s.precision)||(Me=Me.toFixed(s.precision))}return Me}),H=(Me,xe)=>{if(Hr(xe)&&(xe=P.value),xe===0)return Math.round(Me);let Ae=String(Me);const Ce=Ae.indexOf(".");if(Ce===-1||!Ae.replace(".","").split("")[Ce+xe])return Me;const We=Ae.length;return Ae.charAt(We-1)==="5"&&(Ae=`${Ae.slice(0,Math.max(0,We-1))}6`),Number.parseFloat(Number(Ae).toFixed(xe))},U=Me=>{if(ga(Me))return 0;const xe=Me.toString(),Ae=xe.indexOf(".");let Ce=0;return Ae!==-1&&(Ce=xe.length-Ae-1),Ce},ie=(Me,xe=1)=>ao(Me)?H(Me+s.step*xe):o.currentValue,Z=()=>{if(s.readonly||$.value||I.value)return;const Me=Number(z.value)||0,xe=ie(Me);oe(xe),i(Ga,o.currentValue),De()},G=()=>{if(s.readonly||$.value||E.value)return;const Me=Number(z.value)||0,xe=ie(Me,-1);oe(xe),i(Ga,o.currentValue),De()},Q=(Me,xe)=>{const{max:Ae,min:Ce,step:ge,precision:Ne,stepStrictly:We,valueOnClear:ot}=s;Ae<Ce&&ha("InputNumber","min should not be greater than max.");let Oe=Number(Me);if(ga(Me)||Number.isNaN(Oe))return null;if(Me===""){if(ot===null)return null;Oe=Zn(ot)?{min:Ce,max:Ae}[ot]:ot}return We&&(Oe=H(Math.round(Oe/ge)*ge,Ne),Oe!==Me&&xe&&i(Fo,Oe)),Hr(Ne)||(Oe=H(Oe,Ne)),(Oe>Ae||Oe<Ce)&&(Oe=Oe>Ae?Ae:Ce,xe&&i(Fo,Oe)),Oe},oe=(Me,xe=!0)=>{var Ae;const Ce=o.currentValue,ge=Q(Me);if(!xe){i(Fo,ge);return}Ce===ge&&Me||(o.userInput=null,i(Fo,ge),Ce!==ge&&i(Yr,ge,Ce),s.validateEvent&&((Ae=S==null?void 0:S.validate)==null||Ae.call(S,"change").catch(Ne=>void 0)),o.currentValue=ge)},le=Me=>{o.userInput=Me;const xe=Me===""?null:Number(Me);i(Ga,xe),oe(xe,!1)},me=Me=>{const xe=Me!==""?Number(Me):"";(ao(xe)&&!Number.isNaN(xe)||Me==="")&&oe(xe),De(),o.userInput=null},fe=()=>{var Me,xe;(xe=(Me=_.value)==null?void 0:Me.focus)==null||xe.call(Me)},ce=()=>{var Me,xe;(xe=(Me=_.value)==null?void 0:Me.blur)==null||xe.call(Me)},pe=Me=>{i("focus",Me)},ye=Me=>{var xe,Ae;o.userInput=null,d1()&&o.currentValue===null&&((xe=_.value)!=null&&xe.input)&&(_.value.input.value=""),i("blur",Me),s.validateEvent&&((Ae=S==null?void 0:S.validate)==null||Ae.call(S,"blur").catch(Ce=>void 0))},De=()=>{o.currentValue!==s.modelValue&&(o.currentValue=s.modelValue)},tt=Me=>{document.activeElement===Me.target&&Me.preventDefault()};return tn(()=>s.modelValue,(Me,xe)=>{const Ae=Q(Me,!0);o.userInput===null&&Ae!==xe&&(o.currentValue=Ae)},{immediate:!0}),No(()=>{var Me;const{min:xe,max:Ae,modelValue:Ce}=s,ge=(Me=_.value)==null?void 0:Me.input;if(ge.setAttribute("role","spinbutton"),Number.isFinite(Ae)?ge.setAttribute("aria-valuemax",String(Ae)):ge.removeAttribute("aria-valuemax"),Number.isFinite(xe)?ge.setAttribute("aria-valuemin",String(xe)):ge.removeAttribute("aria-valuemin"),ge.setAttribute("aria-valuenow",o.currentValue||o.currentValue===0?String(o.currentValue):""),ge.setAttribute("aria-disabled",String($.value)),!ao(Ce)&&Ce!=null){let Ne=Number(Ce);Number.isNaN(Ne)&&(Ne=null),i(Fo,Ne)}ge.addEventListener("wheel",tt,{passive:!1})}),Au(()=>{var Me,xe;const Ae=(Me=_.value)==null?void 0:Me.input;Ae==null||Ae.setAttribute("aria-valuenow",`${(xe=o.currentValue)!=null?xe:""}`)}),t({focus:fe,blur:ce}),(Me,xe)=>(se(),Pe("div",{class:de([y(g).b(),y(g).m(y(B)),y(g).is("disabled",y($)),y(g).is("without-controls",!Me.controls),y(g).is("controls-right",y(F))]),onDragstart:po(()=>{},["prevent"])},[Me.controls?zo((se(),Pe("span",{key:0,role:"button","aria-label":y(d)("el.inputNumber.decrease"),class:de([y(g).e("decrease"),y(g).is("disabled",y(E))]),onKeydown:ti(G,["enter"])},[_t(Me.$slots,"decrease-icon",{},()=>[Qe(y(Gn),null,{default:at(()=>[y(F)?(se(),Rt(y(cd),{key:0})):(se(),Rt(y(cW),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(xb),G]]):St("v-if",!0),Me.controls?zo((se(),Pe("span",{key:1,role:"button","aria-label":y(d)("el.inputNumber.increase"),class:de([y(g).e("increase"),y(g).is("disabled",y(I))]),onKeydown:ti(Z,["enter"])},[_t(Me.$slots,"increase-icon",{},()=>[Qe(y(Gn),null,{default:at(()=>[y(F)?(se(),Rt(y(iT),{key:0})):(se(),Rt(y(QO),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(xb),Z]]):St("v-if",!0),Qe(y(hs),{id:Me.id,ref_key:"input",ref:_,type:"number",step:Me.step,"model-value":y(z),placeholder:Me.placeholder,readonly:Me.readonly,disabled:y($),size:y(B),max:Me.max,min:Me.min,name:Me.name,"aria-label":Me.ariaLabel,"validate-event":!1,onKeydown:[ti(po(Z,["prevent"]),["up"]),ti(po(G,["prevent"]),["down"])],onBlur:ye,onFocus:pe,onInput:le,onChange:me},ec({_:2},[Me.$slots.prefix?{name:"prefix",fn:at(()=>[_t(Me.$slots,"prefix")])}:void 0,Me.$slots.suffix?{name:"suffix",fn:at(()=>[_t(Me.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var Vte=bn($te,[["__file","input-number.vue"]]);const XD=Ao(Vte),Ute=vn({modelValue:{type:ut(Array)},max:Number,tagType:{...od.type,default:"info"},tagEffect:od.effect,trigger:{type:ut(String),default:On.enter},draggable:{type:Boolean,default:!1},size:ia,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},ariaLabel:String}),jte={[Fo]:e=>fn(e)||Hr(e),[Yr]:e=>fn(e)||Hr(e),[Ga]:e=>Zn(e),"add-tag":e=>Zn(e),"remove-tag":e=>Zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function Hte({props:e,emit:t,formItem:i}){const s=Za(),d=na(),g=gi(),_=Se(),o=te(()=>["small"].includes(d.value)?"small":"default"),S=te(()=>{var fe;return(fe=e.modelValue)!=null&&fe.length?void 0:e.placeholder}),E=te(()=>!(e.readonly||s.value)),I=te(()=>{var fe,ce;return Hr(e.max)?!1:((ce=(fe=e.modelValue)==null?void 0:fe.length)!=null?ce:0)>=e.max}),P=fe=>{if(I.value){_.value=void 0;return}Q.value||t(Ga,fe.target.value)},F=fe=>{var ce;switch(fe.code){case e.trigger:fe.preventDefault(),fe.stopPropagation(),B();break;case On.numpadEnter:e.trigger===On.enter&&(fe.preventDefault(),fe.stopPropagation(),B());break;case On.backspace:!_.value&&((ce=e.modelValue)!=null&&ce.length)&&(fe.preventDefault(),fe.stopPropagation(),$(e.modelValue.length-1));break}},B=()=>{var fe,ce;const pe=(fe=_.value)==null?void 0:fe.trim();if(!pe||I.value)return;const ye=[...(ce=e.modelValue)!=null?ce:[],pe];t(Fo,ye),t(Yr,ye),t("add-tag",pe),_.value=void 0},$=fe=>{var ce;const pe=((ce=e.modelValue)!=null?ce:[]).slice(),[ye]=pe.splice(fe,1);t(Fo,pe),t(Yr,pe),t("remove-tag",ye)},z=()=>{_.value=void 0,t(Fo,void 0),t(Yr,void 0),t("clear")},H=(fe,ce,pe)=>{var ye;const De=((ye=e.modelValue)!=null?ye:[]).slice(),[tt]=De.splice(fe,1),Me=ce>fe&&pe==="before"?-1:ce<fe&&pe==="after"?1:0;De.splice(ce+Me,0,tt),t(Fo,De),t(Yr,De)},U=()=>{var fe;(fe=g.value)==null||fe.focus()},ie=()=>{var fe;(fe=g.value)==null||fe.blur()},{wrapperRef:Z,isFocused:G}=Ah(g,{beforeFocus(){return s.value},afterBlur(){var fe;B(),e.validateEvent&&((fe=i==null?void 0:i.validate)==null||fe.call(i,"blur").catch(ce=>void 0))}}),{isComposing:Q,handleCompositionStart:oe,handleCompositionUpdate:le,handleCompositionEnd:me}=F_({afterComposition:P});return tn(()=>e.modelValue,()=>{var fe;e.validateEvent&&((fe=i==null?void 0:i.validate)==null||fe.call(i,Yr).catch(ce=>void 0))}),{inputRef:g,wrapperRef:Z,isFocused:G,isComposing:Q,inputValue:_,size:d,tagSize:o,placeholder:S,closable:E,disabled:s,inputLimit:I,handleDragged:H,handleInput:P,handleKeydown:F,handleAddTag:B,handleRemoveTag:$,handleClear:z,handleCompositionStart:oe,handleCompositionUpdate:le,handleCompositionEnd:me,focus:U,blur:ie}}function Gte(){const e=Se(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function Wte(){const e=gi(),t=Se(0),i=11,s=te(()=>({minWidth:`${Math.max(t.value,i)}px`}));return Mi(e,()=>{var g,_;t.value=(_=(g=e.value)==null?void 0:g.getBoundingClientRect().width)!=null?_:0}),{calculatorRef:e,calculatorWidth:t,inputStyle:s}}function qte({wrapperRef:e,handleDragged:t,afterDragged:i}){const s=rn("input-tag"),d=gi(),g=Se(!1);let _,o,S,E;function I($){return`.${s.e("inner")} .${s.namespace.value}-tag:nth-child(${$+1})`}function P($,z){_=z,o=e.value.querySelector(I(z)),o&&(o.style.opacity="0.5"),$.dataTransfer.effectAllowed="move"}function F($,z){if(S=z,$.preventDefault(),$.dataTransfer.dropEffect="move",Hr(_)||_===z){g.value=!1;return}const H=e.value.querySelector(I(z)).getBoundingClientRect(),U=_+1!==z,ie=_-1!==z,Z=$.clientX-H.left,G=U?ie?.5:1:-1,Q=ie?U?.5:0:1;Z<=H.width*G?E="before":Z>H.width*Q?E="after":E=void 0;const oe=e.value.querySelector(`.${s.e("inner")}`),le=oe.getBoundingClientRect(),me=Number.parseFloat(Ju(oe,"gap"))/2,fe=H.top-le.top;let ce=-9999;if(E==="before")ce=Math.max(H.left-le.left-me,Math.floor(-me/2));else if(E==="after"){const pe=H.right-le.left;ce=pe+(le.width===pe?Math.floor(me/2):me)}qO(d.value,{top:`${fe}px`,left:`${ce}px`}),g.value=!!E}function B($){$.preventDefault(),o&&(o.style.opacity=""),E&&!Hr(_)&&!Hr(S)&&_!==S&&t(_,S,E),g.value=!1,_=void 0,o=null,S=void 0,E=void 0,i==null||i()}return{dropIndicatorRef:d,showDropIndicator:g,handleDragStart:P,handleDragOver:F,handleDragEnd:B}}function Kte({props:e,isFocused:t,hovering:i,disabled:s,inputValue:d,size:g,validateState:_,validateIcon:o,needStatusIcon:S}){const E=Mh(),I=aa(),P=rn("input-tag"),F=rn("input"),B=te(()=>[P.b(),P.is("focused",t.value),P.is("hovering",i.value),P.is("disabled",s.value),P.m(g.value),P.e("wrapper"),E.class]),$=te(()=>[E.style]),z=te(()=>{var ie,Z;return[P.e("inner"),P.is("draggable",e.draggable),P.is("left-space",!((ie=e.modelValue)!=null&&ie.length)&&!I.prefix),P.is("right-space",!((Z=e.modelValue)!=null&&Z.length)&&!U.value)]}),H=te(()=>{var ie;return e.clearable&&!s.value&&!e.readonly&&(((ie=e.modelValue)==null?void 0:ie.length)||d.value)&&(t.value||i.value)}),U=te(()=>I.suffix||H.value||_.value&&o.value&&S.value);return{ns:P,nsInput:F,containerKls:B,containerStyle:$,innerKls:z,showClear:H,showSuffix:U}}const Zte=Ze({name:"ElInputTag",inheritAttrs:!1}),Yte=Ze({...Zte,props:Ute,emits:jte,setup(e,{expose:t,emit:i}){const s=e,d=z_(),g=aa(),{form:_,formItem:o}=Ka(),{inputId:S}=ic(s,{formItemContext:o}),E=te(()=>{var At;return(At=_==null?void 0:_.statusIcon)!=null?At:!1}),I=te(()=>(o==null?void 0:o.validateState)||""),P=te(()=>I.value&&u1[I.value]),{inputRef:F,wrapperRef:B,isFocused:$,inputValue:z,size:H,tagSize:U,placeholder:ie,closable:Z,disabled:G,handleDragged:Q,handleInput:oe,handleKeydown:le,handleRemoveTag:me,handleClear:fe,handleCompositionStart:ce,handleCompositionUpdate:pe,handleCompositionEnd:ye,focus:De,blur:tt}=Hte({props:s,emit:i,formItem:o}),{hovering:Me,handleMouseEnter:xe,handleMouseLeave:Ae}=Gte(),{calculatorRef:Ce,inputStyle:ge}=Wte(),{dropIndicatorRef:Ne,showDropIndicator:We,handleDragStart:ot,handleDragOver:Oe,handleDragEnd:Ct}=qte({wrapperRef:B,handleDragged:Q,afterDragged:De}),{ns:Mt,nsInput:zt,containerKls:bt,containerStyle:Kt,innerKls:$t,showClear:Re,showSuffix:dn}=Kte({props:s,hovering:Me,isFocused:$,inputValue:z,disabled:G,size:H,validateState:I,validateIcon:P,needStatusIcon:E});return t({focus:De,blur:tt}),(At,Ke)=>(se(),Pe("div",{ref_key:"wrapperRef",ref:B,class:de(y(bt)),style:to(y(Kt)),onMouseenter:y(xe),onMouseleave:y(Ae)},[y(g).prefix?(se(),Pe("div",{key:0,class:de(y(Mt).e("prefix"))},[_t(At.$slots,"prefix")],2)):St("v-if",!0),He("div",{class:de(y($t))},[(se(!0),Pe(eo,null,tr(At.modelValue,(Be,Ht)=>(se(),Rt(y(Em),{key:Ht,size:y(U),closable:y(Z),type:At.tagType,effect:At.tagEffect,draggable:y(Z)&&At.draggable,"disable-transitions":"",onClose:Ut=>y(me)(Ht),onDragstart:Ut=>y(ot)(Ut,Ht),onDragover:Ut=>y(Oe)(Ut,Ht),onDragend:y(Ct),onDrop:po(()=>{},["stop"])},{default:at(()=>[_t(At.$slots,"tag",{value:Be,index:Ht},()=>[nr(wn(Be),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),He("div",{class:de(y(Mt).e("input-wrapper"))},[zo(He("input",Yo({id:y(S),ref_key:"inputRef",ref:F,"onUpdate:modelValue":Be=>vi(z)?z.value=Be:null},y(d),{type:"text",minlength:At.minlength,maxlength:At.maxlength,disabled:y(G),readonly:At.readonly,autocomplete:At.autocomplete,tabindex:At.tabindex,placeholder:y(ie),autofocus:At.autofocus,ariaLabel:At.ariaLabel,class:y(Mt).e("input"),style:y(ge),onCompositionstart:y(ce),onCompositionupdate:y(pe),onCompositionend:y(ye),onInput:y(oe),onKeydown:y(le)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[Xb,y(z)]]),He("span",{ref_key:"calculatorRef",ref:Ce,"aria-hidden":"true",class:de(y(Mt).e("input-calculator")),textContent:wn(y(z))},null,10,["textContent"])],2),zo(He("div",{ref_key:"dropIndicatorRef",ref:Ne,class:de(y(Mt).e("drop-indicator"))},null,2),[[Cr,y(We)]])],2),y(dn)?(se(),Pe("div",{key:1,class:de(y(Mt).e("suffix"))},[_t(At.$slots,"suffix"),y(Re)?(se(),Rt(y(Gn),{key:0,class:de([y(Mt).e("icon"),y(Mt).e("clear")]),onMousedown:po(y(jr),["prevent"]),onClick:y(fe)},{default:at(()=>[Qe(y(ud))]),_:1},8,["class","onMousedown","onClick"])):St("v-if",!0),y(I)&&y(P)&&y(E)?(se(),Rt(y(Gn),{key:1,class:de([y(zt).e("icon"),y(zt).e("validateIcon"),y(zt).is("loading",y(I)==="validating")])},{default:at(()=>[(se(),Rt(Wo(y(P))))]),_:1},8,["class"])):St("v-if",!0)],2)):St("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var Xte=bn(Yte,[["__file","input-tag.vue"]]);const Jte=Ao(Xte),Qte=vn({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:Xr}}),ene={click:e=>e instanceof MouseEvent},tne=Ze({name:"ElLink"}),nne=Ze({...tne,props:Qte,emits:ene,setup(e,{emit:t}){const i=e,s=rn("link"),d=te(()=>[s.b(),s.m(i.type),s.is("disabled",i.disabled),s.is("underline",i.underline&&!i.disabled)]);function g(_){i.disabled||t("click",_)}return(_,o)=>(se(),Pe("a",{class:de(y(d)),href:_.disabled||!_.href?void 0:_.href,target:_.disabled||!_.href?void 0:_.target,onClick:g},[_.icon?(se(),Rt(y(Gn),{key:0},{default:at(()=>[(se(),Rt(Wo(_.icon)))]),_:1})):St("v-if",!0),_.$slots.default?(se(),Pe("span",{key:1,class:de(y(s).e("inner"))},[_t(_.$slots,"default")],2)):St("v-if",!0),_.$slots.icon?_t(_.$slots,"icon",{key:2}):St("v-if",!0)],10,["href","target"]))}});var one=bn(nne,[["__file","link.vue"]]);const rne=Ao(one);let ine=class{constructor(t,i){this.parent=t,this.domNode=i,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,i=>{i.addEventListener("keydown",s=>{let d=!1;switch(s.code){case On.down:{this.gotoSubIndex(this.subIndex+1),d=!0;break}case On.up:{this.gotoSubIndex(this.subIndex-1),d=!0;break}case On.tab:{H0(t,"mouseleave");break}case On.enter:case On.numpadEnter:case On.space:{d=!0,s.currentTarget.click();break}}return d&&(s.preventDefault(),s.stopPropagation()),!1})})}},ane=class{constructor(t,i){this.domNode=t,this.submenu=null,this.submenu=null,this.init(i)}init(t){this.domNode.setAttribute("tabindex","0");const i=this.domNode.querySelector(`.${t}-menu`);i&&(this.submenu=new ine(this,i)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let i=!1;switch(t.code){case On.down:{H0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),i=!0;break}case On.up:{H0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),i=!0;break}case On.tab:{H0(t.currentTarget,"mouseleave");break}case On.enter:case On.numpadEnter:case On.space:{i=!0,t.currentTarget.click();break}}i&&t.preventDefault()})}},sne=class{constructor(t,i){this.domNode=t,this.init(i)}init(t){const i=this.domNode.childNodes;Array.from(i).forEach(s=>{s.nodeType===1&&new ane(s,t)})}};const lne=Ze({name:"ElMenuCollapseTransition",setup(){const e=rn("menu");return{listeners:{onBeforeEnter:i=>i.style.opacity="0.2",onEnter(i,s){Yl(i,`${e.namespace.value}-opacity-transition`),i.style.opacity="1",s()},onAfterEnter(i){fs(i,`${e.namespace.value}-opacity-transition`),i.style.opacity=""},onBeforeLeave(i){i.dataset||(i.dataset={}),el(i,e.m("collapse"))?(fs(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),Yl(i,e.m("collapse"))):(Yl(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),fs(i,e.m("collapse"))),i.style.width=`${i.scrollWidth}px`,i.style.overflow="hidden"},onLeave(i){Yl(i,"horizontal-collapse-transition"),i.style.width=`${i.dataset.scrollWidth}px`}}}}});function cne(e,t,i,s,d,g){return se(),Rt(Ea,Yo({mode:"out-in"},e.listeners),{default:at(()=>[_t(e.$slots,"default")]),_:3},16)}var une=bn(lne,[["render",cne],["__file","menu-collapse-transition.vue"]]);function JD(e,t){const i=te(()=>{let d=e.parent;const g=[t.value];for(;d.type.name!=="ElMenu";)d.props.index&&g.unshift(d.props.index),d=d.parent;return g});return{parentMenu:te(()=>{let d=e.parent;for(;d&&!["ElMenu","ElSubMenu"].includes(d.type.name);)d=d.parent;return d}),indexPath:i}}function dne(e){return te(()=>{const i=e.backgroundColor;return i?new DL(i).shade(20).toString():""})}const QD=(e,t)=>{const i=rn("menu");return te(()=>i.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":dne(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},hne=vn({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:Xr},expandOpenIcon:{type:Xr},collapseCloseIcon:{type:Xr},collapseOpenIcon:{type:Xr}}),Lw="ElSubMenu";var HT=Ze({name:Lw,props:hne,setup(e,{slots:t,expose:i}){const s=jo(),{indexPath:d,parentMenu:g}=JD(s,te(()=>e.index)),_=rn("menu"),o=rn("sub-menu"),S=Un("rootMenu");S||ha(Lw,"can not inject root menu");const E=Un(`subMenu:${g.value.uid}`);E||ha(Lw,"can not inject sub menu");const I=Se({}),P=Se({});let F;const B=Se(!1),$=Se(),z=Se(null),H=te(()=>me.value==="horizontal"&&ie.value?"bottom-start":"right-start"),U=te(()=>me.value==="horizontal"&&ie.value||me.value==="vertical"&&!S.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?oe.value?e.expandOpenIcon:e.expandCloseIcon:cd:e.collapseCloseIcon&&e.collapseOpenIcon?oe.value?e.collapseOpenIcon:e.collapseCloseIcon:Ls),ie=te(()=>E.level===0),Z=te(()=>{const Ne=e.teleported;return Ne===void 0?ie.value:Ne}),G=te(()=>S.props.collapse?`${_.namespace.value}-zoom-in-left`:`${_.namespace.value}-zoom-in-top`),Q=te(()=>me.value==="horizontal"&&ie.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),oe=te(()=>S.openedMenus.includes(e.index)),le=te(()=>{let Ne=!1;return Object.values(I.value).forEach(We=>{We.active&&(Ne=!0)}),Object.values(P.value).forEach(We=>{We.active&&(Ne=!0)}),Ne}),me=te(()=>S.props.mode),fe=Pr({index:e.index,indexPath:d,active:le}),ce=QD(S.props,E.level+1),pe=te(()=>{var Ne;return(Ne=e.popperOffset)!=null?Ne:S.props.popperOffset}),ye=te(()=>{var Ne;return(Ne=e.popperClass)!=null?Ne:S.props.popperClass}),De=te(()=>{var Ne;return(Ne=e.showTimeout)!=null?Ne:S.props.showTimeout}),tt=te(()=>{var Ne;return(Ne=e.hideTimeout)!=null?Ne:S.props.hideTimeout}),Me=()=>{var Ne,We,ot;return(ot=(We=(Ne=z.value)==null?void 0:Ne.popperRef)==null?void 0:We.popperInstanceRef)==null?void 0:ot.destroy()},xe=Ne=>{Ne||Me()},Ae=()=>{S.props.menuTrigger==="hover"&&S.props.mode==="horizontal"||S.props.collapse&&S.props.mode==="vertical"||e.disabled||S.handleSubMenuClick({index:e.index,indexPath:d.value,active:le.value})},Ce=(Ne,We=De.value)=>{var ot;if(Ne.type!=="focus"){if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"||e.disabled){E.mouseInChild.value=!0;return}E.mouseInChild.value=!0,F==null||F(),{stop:F}=Nf(()=>{S.openMenu(e.index,d.value)},We),Z.value&&((ot=g.value.vnode.el)==null||ot.dispatchEvent(new MouseEvent("mouseenter")))}},ge=(Ne=!1)=>{var We;if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"){E.mouseInChild.value=!1;return}F==null||F(),E.mouseInChild.value=!1,{stop:F}=Nf(()=>!B.value&&S.closeMenu(e.index,d.value),tt.value),Z.value&&Ne&&((We=E.handleMouseleave)==null||We.call(E,!0))};tn(()=>S.props.collapse,Ne=>xe(!!Ne));{const Ne=ot=>{P.value[ot.index]=ot},We=ot=>{delete P.value[ot.index]};or(`subMenu:${s.uid}`,{addSubMenu:Ne,removeSubMenu:We,handleMouseleave:ge,mouseInChild:B,level:E.level+1})}return i({opened:oe}),No(()=>{S.addSubMenu(fe),E.addSubMenu(fe)}),ni(()=>{E.removeSubMenu(fe),S.removeSubMenu(fe)}),()=>{var Ne;const We=[(Ne=t.title)==null?void 0:Ne.call(t),lo(Gn,{class:o.e("icon-arrow"),style:{transform:oe.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&S.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Zn(U.value)?lo(s.appContext.components[U.value]):lo(U.value)})],ot=S.isMenuPopup?lo(qa,{ref:z,visible:oe.value,effect:"light",pure:!0,offset:pe.value,showArrow:!1,persistent:!0,popperClass:ye.value,placement:H.value,teleported:Z.value,fallbackPlacements:Q.value,transition:G.value,gpuAcceleration:!1},{content:()=>{var Oe;return lo("div",{class:[_.m(me.value),_.m("popup-container"),ye.value],onMouseenter:Ct=>Ce(Ct,100),onMouseleave:()=>ge(!0),onFocus:Ct=>Ce(Ct,100)},[lo("ul",{class:[_.b(),_.m("popup"),_.m(`popup-${H.value}`)],style:ce.value},[(Oe=t.default)==null?void 0:Oe.call(t)])])},default:()=>lo("div",{class:o.e("title"),onClick:Ae},We)}):lo(eo,{},[lo("div",{class:o.e("title"),ref:$,onClick:Ae},We),lo(m1,{},{default:()=>{var Oe;return zo(lo("ul",{role:"menu",class:[_.b(),_.m("inline")],style:ce.value},[(Oe=t.default)==null?void 0:Oe.call(t)]),[[Cr,oe.value]])}})]);return lo("li",{class:[o.b(),o.is("active",le.value),o.is("opened",oe.value),o.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:oe.value,onMouseenter:Ce,onMouseleave:()=>ge(),onFocus:Ce},[ot])}}});const fne=vn({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:ut(Array),default:()=>Ri([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:Xr,default:()=>hW},popperEffect:{type:ut(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),Dw=e=>fn(e)&&e.every(t=>Zn(t)),pne={close:(e,t)=>Zn(e)&&Dw(t),open:(e,t)=>Zn(e)&&Dw(t),select:(e,t,i,s)=>Zn(e)&&Dw(t)&&Vo(i)&&(s===void 0||s instanceof Promise)};var mne=Ze({name:"ElMenu",props:fne,emits:pne,setup(e,{emit:t,slots:i,expose:s}){const d=jo(),g=d.appContext.config.globalProperties.$router,_=Se(),o=rn("menu"),S=rn("sub-menu"),E=Se(-1),I=Se(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),P=Se(e.defaultActive),F=Se({}),B=Se({}),$=te(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),z=()=>{const Me=P.value&&F.value[P.value];if(!Me||e.mode==="horizontal"||e.collapse)return;Me.indexPath.forEach(Ae=>{const Ce=B.value[Ae];Ce&&H(Ae,Ce.indexPath)})},H=(Me,xe)=>{I.value.includes(Me)||(e.uniqueOpened&&(I.value=I.value.filter(Ae=>xe.includes(Ae))),I.value.push(Me),t("open",Me,xe))},U=Me=>{const xe=I.value.indexOf(Me);xe!==-1&&I.value.splice(xe,1)},ie=(Me,xe)=>{U(Me),t("close",Me,xe)},Z=({index:Me,indexPath:xe})=>{I.value.includes(Me)?ie(Me,xe):H(Me,xe)},G=Me=>{(e.mode==="horizontal"||e.collapse)&&(I.value=[]);const{index:xe,indexPath:Ae}=Me;if(!(ga(xe)||ga(Ae)))if(e.router&&g){const Ce=Me.route||xe,ge=g.push(Ce).then(Ne=>(Ne||(P.value=xe),Ne));t("select",xe,Ae,{index:xe,indexPath:Ae,route:Ce},ge)}else P.value=xe,t("select",xe,Ae,{index:xe,indexPath:Ae})},Q=Me=>{const xe=F.value,Ae=xe[Me]||P.value&&xe[P.value]||xe[e.defaultActive];Ae?P.value=Ae.index:P.value=Me},oe=Me=>{const xe=getComputedStyle(Me),Ae=Number.parseInt(xe.marginLeft,10),Ce=Number.parseInt(xe.marginRight,10);return Me.offsetWidth+Ae+Ce||0},le=()=>{var Me,xe;if(!_.value)return-1;const Ae=Array.from((xe=(Me=_.value)==null?void 0:Me.childNodes)!=null?xe:[]).filter(Mt=>Mt.nodeName!=="#comment"&&(Mt.nodeName!=="#text"||Mt.nodeValue)),Ce=64,ge=getComputedStyle(_.value),Ne=Number.parseInt(ge.paddingLeft,10),We=Number.parseInt(ge.paddingRight,10),ot=_.value.clientWidth-Ne-We;let Oe=0,Ct=0;return Ae.forEach((Mt,zt)=>{Oe+=oe(Mt),Oe<=ot-Ce&&(Ct=zt+1)}),Ct===Ae.length?-1:Ct},me=Me=>B.value[Me].indexPath,fe=(Me,xe=33.34)=>{let Ae;return()=>{Ae&&clearTimeout(Ae),Ae=setTimeout(()=>{Me()},xe)}};let ce=!0;const pe=()=>{if(E.value===le())return;const Me=()=>{E.value=-1,oo(()=>{E.value=le()})};ce?Me():fe(Me)(),ce=!1};tn(()=>e.defaultActive,Me=>{F.value[Me]||(P.value=""),Q(Me)}),tn(()=>e.collapse,Me=>{Me&&(I.value=[])}),tn(F.value,z);let ye;Ha(()=>{e.mode==="horizontal"&&e.ellipsis?ye=Mi(_,pe).stop:ye==null||ye()});const De=Se(!1);{const Me=ge=>{B.value[ge.index]=ge},xe=ge=>{delete B.value[ge.index]};or("rootMenu",Pr({props:e,openedMenus:I,items:F,subMenus:B,activeIndex:P,isMenuPopup:$,addMenuItem:ge=>{F.value[ge.index]=ge},removeMenuItem:ge=>{delete F.value[ge.index]},addSubMenu:Me,removeSubMenu:xe,openMenu:H,closeMenu:ie,handleMenuItemClick:G,handleSubMenuClick:Z})),or(`subMenu:${d.uid}`,{addSubMenu:Me,removeSubMenu:xe,mouseInChild:De,level:0})}No(()=>{e.mode==="horizontal"&&new sne(d.vnode.el,o.namespace.value)}),s({open:xe=>{const{indexPath:Ae}=B.value[xe];Ae.forEach(Ce=>H(Ce,Ae))},close:U,handleResize:pe});const tt=QD(e,0);return()=>{var Me,xe;let Ae=(xe=(Me=i.default)==null?void 0:Me.call(i))!=null?xe:[];const Ce=[];if(e.mode==="horizontal"&&_.value){const We=fh(Ae),ot=E.value===-1?We:We.slice(0,E.value),Oe=E.value===-1?[]:We.slice(E.value);Oe!=null&&Oe.length&&e.ellipsis&&(Ae=ot,Ce.push(lo(HT,{index:"sub-menu-more",class:S.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>lo(Gn,{class:S.e("icon-more")},{default:()=>lo(e.ellipsisIcon)}),default:()=>Oe})))}const ge=e.closeOnClickOutside?[[rd,()=>{I.value.length&&(De.value||(I.value.forEach(We=>t("close",We,me(We))),I.value=[]))}]]:[],Ne=zo(lo("ul",{key:String(e.collapse),role:"menubar",ref:_,style:tt.value,class:{[o.b()]:!0,[o.m(e.mode)]:!0,[o.m("collapse")]:e.collapse}},[...Ae,...Ce]),ge);return e.collapseTransition&&e.mode==="vertical"?lo(une,()=>Ne):Ne}}});const gne=vn({index:{type:ut([String,null]),default:null},route:{type:ut([String,Object])},disabled:Boolean}),vne={click:e=>Zn(e.index)&&fn(e.indexPath)},zw="ElMenuItem",_ne=Ze({name:zw,components:{ElTooltip:qa},props:gne,emits:vne,setup(e,{emit:t}){const i=jo(),s=Un("rootMenu"),d=rn("menu"),g=rn("menu-item");s||ha(zw,"can not inject root menu");const{parentMenu:_,indexPath:o}=JD(i,Vr(e,"index")),S=Un(`subMenu:${_.value.uid}`);S||ha(zw,"can not inject sub menu");const E=te(()=>e.index===s.activeIndex),I=Pr({index:e.index,indexPath:o,active:E}),P=()=>{e.disabled||(s.handleMenuItemClick({index:e.index,indexPath:o.value,route:e.route}),t("click",I))};return No(()=>{S.addSubMenu(I),s.addMenuItem(I)}),ni(()=>{S.removeSubMenu(I),s.removeMenuItem(I)}),{parentMenu:_,rootMenu:s,active:E,nsMenu:d,nsMenuItem:g,handleClick:P}}});function yne(e,t,i,s,d,g){const _=Go("el-tooltip");return se(),Pe("li",{class:de([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",onClick:e.handleClick},[e.parentMenu.type.name==="ElMenu"&&e.rootMenu.props.collapse&&e.$slots.title?(se(),Rt(_,{key:0,effect:e.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:at(()=>[_t(e.$slots,"title")]),default:at(()=>[He("div",{class:de(e.nsMenu.be("tooltip","trigger"))},[_t(e.$slots,"default")],2)]),_:3},8,["effect"])):(se(),Pe(eo,{key:1},[_t(e.$slots,"default"),_t(e.$slots,"title")],64))],10,["onClick"])}var ez=bn(_ne,[["render",yne],["__file","menu-item.vue"]]);const bne={title:String},xne="ElMenuItemGroup",wne=Ze({name:xne,props:bne,setup(){return{ns:rn("menu-item-group")}}});function Sne(e,t,i,s,d,g){return se(),Pe("li",{class:de(e.ns.b())},[He("div",{class:de(e.ns.e("title"))},[e.$slots.title?_t(e.$slots,"title",{key:1}):(se(),Pe(eo,{key:0},[nr(wn(e.title),1)],64))],2),He("ul",null,[_t(e.$slots,"default")])],2)}var tz=bn(wne,[["render",Sne],["__file","menu-item-group.vue"]]);const Tne=Ao(mne,{MenuItem:ez,MenuItemGroup:tz,SubMenu:HT}),Cne=Oi(ez),Ene=Oi(tz),Mne=Oi(HT),Ine=vn({icon:{type:Xr,default:()=>zG},title:String,content:{type:String,default:""}}),Ane={back:()=>!0},kne=Ze({name:"ElPageHeader"}),Pne=Ze({...kne,props:Ine,emits:Ane,setup(e,{emit:t}){const i=aa(),{t:s}=vr(),d=rn("page-header"),g=te(()=>[d.b(),{[d.m("has-breadcrumb")]:!!i.breadcrumb,[d.m("has-extra")]:!!i.extra,[d.is("contentful")]:!!i.default}]);function _(){t("back")}return(o,S)=>(se(),Pe("div",{class:de(y(g))},[o.$slots.breadcrumb?(se(),Pe("div",{key:0,class:de(y(d).e("breadcrumb"))},[_t(o.$slots,"breadcrumb")],2)):St("v-if",!0),He("div",{class:de(y(d).e("header"))},[He("div",{class:de(y(d).e("left"))},[He("div",{class:de(y(d).e("back")),role:"button",tabindex:"0",onClick:_},[o.icon||o.$slots.icon?(se(),Pe("div",{key:0,"aria-label":o.title||y(s)("el.pageHeader.title"),class:de(y(d).e("icon"))},[_t(o.$slots,"icon",{},()=>[o.icon?(se(),Rt(y(Gn),{key:0},{default:at(()=>[(se(),Rt(Wo(o.icon)))]),_:1})):St("v-if",!0)])],10,["aria-label"])):St("v-if",!0),He("div",{class:de(y(d).e("title"))},[_t(o.$slots,"title",{},()=>[nr(wn(o.title||y(s)("el.pageHeader.title")),1)])],2)],2),Qe(y(BD),{direction:"vertical"}),He("div",{class:de(y(d).e("content"))},[_t(o.$slots,"content",{},()=>[nr(wn(o.content),1)])],2)],2),o.$slots.extra?(se(),Pe("div",{key:0,class:de(y(d).e("extra"))},[_t(o.$slots,"extra")],2)):St("v-if",!0)],2),o.$slots.default?(se(),Pe("div",{key:1,class:de(y(d).e("main"))},[_t(o.$slots,"default")],2)):St("v-if",!0)],2))}});var Rne=bn(Pne,[["__file","page-header.vue"]]);const One=Ao(Rne),nz=Symbol("elPaginationKey"),Lne=vn({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:Xr}}),Dne={click:e=>e instanceof MouseEvent},zne=Ze({name:"ElPaginationPrev"}),Fne=Ze({...zne,props:Lne,emits:Dne,setup(e){const t=e,{t:i}=vr(),s=te(()=>t.disabled||t.currentPage<=1);return(d,g)=>(se(),Pe("button",{type:"button",class:"btn-prev",disabled:y(s),"aria-label":d.prevText||y(i)("el.pagination.prev"),"aria-disabled":y(s),onClick:_=>d.$emit("click",_)},[d.prevText?(se(),Pe("span",{key:0},wn(d.prevText),1)):(se(),Rt(y(Gn),{key:1},{default:at(()=>[(se(),Rt(Wo(d.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var Bne=bn(Fne,[["__file","prev.vue"]]);const Nne=vn({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:Xr}}),$ne=Ze({name:"ElPaginationNext"}),Vne=Ze({...$ne,props:Nne,emits:["click"],setup(e){const t=e,{t:i}=vr(),s=te(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(d,g)=>(se(),Pe("button",{type:"button",class:"btn-next",disabled:y(s),"aria-label":d.nextText||y(i)("el.pagination.next"),"aria-disabled":y(s),onClick:_=>d.$emit("click",_)},[d.nextText?(se(),Pe("span",{key:0},wn(d.nextText),1)):(se(),Rt(y(Gn),{key:1},{default:at(()=>[(se(),Rt(Wo(d.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var Une=bn(Vne,[["__file","next.vue"]]);const oz=Symbol("ElSelectGroup"),Wm=Symbol("ElSelect");function jne(e,t){const i=Un(Wm),s=Un(oz,{disabled:!1}),d=te(()=>I(us(i.props.modelValue),e.value)),g=te(()=>{var B;if(i.props.multiple){const $=us((B=i.props.modelValue)!=null?B:[]);return!d.value&&$.length>=i.props.multipleLimit&&i.props.multipleLimit>0}else return!1}),_=te(()=>e.label||(Vo(e.value)?"":e.value)),o=te(()=>e.value||e.label||""),S=te(()=>e.disabled||t.groupDisabled||g.value),E=jo(),I=(B=[],$)=>{if(Vo(e.value)){const z=i.props.valueKey;return B&&B.some(H=>ei(Ji(H,z))===Ji($,z))}else return B&&B.includes($)},P=()=>{!e.disabled&&!s.disabled&&(i.states.hoveringIndex=i.optionsArray.indexOf(E.proxy))},F=B=>{const $=new RegExp(IT(B),"i");t.visible=$.test(_.value)||e.created};return tn(()=>_.value,()=>{!e.created&&!i.props.remote&&i.setSelected()}),tn(()=>e.value,(B,$)=>{const{remote:z,valueKey:H}=i.props;if(B!==$&&(i.onOptionDestroy($,E.proxy),i.onOptionCreate(E.proxy)),!e.created&&!z){if(H&&Vo(B)&&Vo($)&&B[H]===$[H])return;i.setSelected()}}),tn(()=>s.disabled,()=>{t.groupDisabled=s.disabled},{immediate:!0}),{select:i,currentLabel:_,currentValue:o,itemSelected:d,isDisabled:S,hoverItem:P,updateOption:F}}const Hne=Ze({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=rn("select"),i=La(),s=te(()=>[t.be("dropdown","item"),t.is("disabled",y(o)),t.is("selected",y(_)),t.is("hovering",y(F))]),d=Pr({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:g,itemSelected:_,isDisabled:o,select:S,hoverItem:E,updateOption:I}=jne(e,d),{visible:P,hover:F}=Ca(d),B=jo().proxy;S.onOptionCreate(B),ni(()=>{const z=B.value,{selected:H}=S.states,U=H.some(ie=>ie.value===B.value);oo(()=>{S.states.cachedOptions.get(z)===B&&!U&&S.states.cachedOptions.delete(z)}),S.onOptionDestroy(z,B)});function $(){o.value||S.handleOptionSelect(B)}return{ns:t,id:i,containerKls:s,currentLabel:g,itemSelected:_,isDisabled:o,select:S,hoverItem:E,updateOption:I,visible:P,hover:F,selectOptionClick:$,states:d}}});function Gne(e,t,i,s,d,g){return zo((se(),Pe("li",{id:e.id,class:de(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:po(e.selectOptionClick,["stop"])},[_t(e.$slots,"default",{},()=>[He("span",null,wn(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[Cr,e.visible]])}var GT=bn(Hne,[["render",Gne],["__file","option.vue"]]);const Wne=Ze({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=Un(Wm),t=rn("select"),i=te(()=>e.props.popperClass),s=te(()=>e.props.multiple),d=te(()=>e.props.fitInputWidth),g=Se("");function _(){var o;g.value=`${(o=e.selectRef)==null?void 0:o.offsetWidth}px`}return No(()=>{_(),Mi(e.selectRef,_)}),{ns:t,minWidth:g,popperClass:i,isMultiple:s,isFitInputWidth:d}}});function qne(e,t,i,s,d,g){return se(),Pe("div",{class:de([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:to({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(se(),Pe("div",{key:0,class:de(e.ns.be("dropdown","header"))},[_t(e.$slots,"header")],2)):St("v-if",!0),_t(e.$slots,"default"),e.$slots.footer?(se(),Pe("div",{key:1,class:de(e.ns.be("dropdown","footer"))},[_t(e.$slots,"footer")],2)):St("v-if",!0)],6)}var Kne=bn(Wne,[["render",qne],["__file","select-dropdown.vue"]]);const Zne=11,Yne=(e,t)=>{const{t:i}=vr(),s=La(),d=rn("select"),g=rn("input"),_=Pr({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),o=Se(null),S=Se(null),E=Se(null),I=Se(null),P=Se(null),F=Se(null),B=Se(null),$=Se(null),z=Se(null),H=Se(null),U=Se(null),ie=Se(null),{isComposing:Z,handleCompositionStart:G,handleCompositionUpdate:Q,handleCompositionEnd:oe}=F_({afterComposition:gt=>Io(gt)}),{wrapperRef:le,isFocused:me,handleBlur:fe}=Ah(P,{beforeFocus(){return Ae.value},afterFocus(){e.automaticDropdown&&!ce.value&&(ce.value=!0,_.menuVisibleOnFocus=!0)},beforeBlur(gt){var Yt,In;return((Yt=E.value)==null?void 0:Yt.isFocusInsideContent(gt))||((In=I.value)==null?void 0:In.isFocusInsideContent(gt))},afterBlur(){ce.value=!1,_.menuVisibleOnFocus=!1}}),ce=Se(!1),pe=Se(),{form:ye,formItem:De}=Ka(),{inputId:tt}=ic(e,{formItemContext:De}),{valueOnClear:Me,isEmptyValue:xe}=a1(e),Ae=te(()=>e.disabled||(ye==null?void 0:ye.disabled)),Ce=te(()=>fn(e.modelValue)?e.modelValue.length>0:!xe(e.modelValue)),ge=te(()=>{var gt;return(gt=ye==null?void 0:ye.statusIcon)!=null?gt:!1}),Ne=te(()=>e.clearable&&!Ae.value&&_.inputHovering&&Ce.value),We=te(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),ot=te(()=>d.is("reverse",We.value&&ce.value)),Oe=te(()=>(De==null?void 0:De.validateState)||""),Ct=te(()=>u1[Oe.value]),Mt=te(()=>e.remote?300:0),zt=te(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!_.inputValue&&_.options.size===0?!1:e.filterable&&_.inputValue&&_.options.size>0&&bt.value===0?e.noMatchText||i("el.select.noMatch"):_.options.size===0?e.noDataText||i("el.select.noData"):null),bt=te(()=>Kt.value.filter(gt=>gt.visible).length),Kt=te(()=>{const gt=Array.from(_.options.values()),Yt=[];return _.optionValues.forEach(In=>{const ho=gt.findIndex(co=>co.value===In);ho>-1&&Yt.push(gt[ho])}),Yt.length>=gt.length?Yt:gt}),$t=te(()=>Array.from(_.cachedOptions.values())),Re=te(()=>{const gt=Kt.value.filter(Yt=>!Yt.created).some(Yt=>Yt.currentLabel===_.inputValue);return e.filterable&&e.allowCreate&&_.inputValue!==""&&!gt}),dn=()=>{e.filterable&&Qn(e.filterMethod)||e.filterable&&e.remote&&Qn(e.remoteMethod)||Kt.value.forEach(gt=>{var Yt;(Yt=gt.updateOption)==null||Yt.call(gt,_.inputValue)})},At=na(),Ke=te(()=>["small"].includes(At.value)?"small":"default"),Be=te({get(){return ce.value&&zt.value!==!1},set(gt){ce.value=gt}}),Ht=te(()=>{if(e.multiple&&!Hr(e.modelValue))return us(e.modelValue).length===0&&!_.inputValue;const gt=fn(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||Hr(gt)?!_.inputValue:!0}),Ut=te(()=>{var gt;const Yt=(gt=e.placeholder)!=null?gt:i("el.select.placeholder");return e.multiple||!Ce.value?Yt:_.selectedLabel}),Nt=te(()=>p2?null:"mouseenter");tn(()=>e.modelValue,(gt,Yt)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(_.inputValue="",Et("")),ln(),!Oa(gt,Yt)&&e.validateEvent&&(De==null||De.validate("change").catch(In=>void 0))},{flush:"post",deep:!0}),tn(()=>ce.value,gt=>{gt?Et(_.inputValue):(_.inputValue="",_.previousQuery=null,_.isBeforeHide=!0),t("visible-change",gt)}),tn(()=>_.options.entries(),()=>{var gt;if(!gr)return;const Yt=((gt=o.value)==null?void 0:gt.querySelectorAll("input"))||[];(!e.filterable&&!e.defaultFirstOption&&!Hr(e.modelValue)||!Array.from(Yt).includes(document.activeElement))&&ln(),e.defaultFirstOption&&(e.filterable||e.remote)&&bt.value&&Gt()},{flush:"post"}),tn(()=>_.hoveringIndex,gt=>{ao(gt)&&gt>-1?pe.value=Kt.value[gt]||{}:pe.value={},Kt.value.forEach(Yt=>{Yt.hover=pe.value===Yt})}),Ha(()=>{_.isBeforeHide||dn()});const Et=gt=>{_.previousQuery===gt||Z.value||(_.previousQuery=gt,e.filterable&&Qn(e.filterMethod)?e.filterMethod(gt):e.filterable&&e.remote&&Qn(e.remoteMethod)&&e.remoteMethod(gt),e.defaultFirstOption&&(e.filterable||e.remote)&&bt.value?oo(Gt):oo(_n))},Gt=()=>{const gt=Kt.value.filter(co=>co.visible&&!co.disabled&&!co.states.groupDisabled),Yt=gt.find(co=>co.created),In=gt[0],ho=Kt.value.map(co=>co.value);_.hoveringIndex=Mn(ho,Yt||In)},ln=()=>{if(e.multiple)_.selectedLabel="";else{const Yt=fn(e.modelValue)?e.modelValue[0]:e.modelValue,In=yn(Yt);_.selectedLabel=In.currentLabel,_.selected=[In];return}const gt=[];Hr(e.modelValue)||us(e.modelValue).forEach(Yt=>{gt.push(yn(Yt))}),_.selected=gt},yn=gt=>{let Yt;const In=Jv(gt);for(let Lo=_.cachedOptions.size-1;Lo>=0;Lo--){const Eo=$t.value[Lo];if(In?Ji(Eo.value,e.valueKey)===Ji(gt,e.valueKey):Eo.value===gt){Yt={value:gt,currentLabel:Eo.currentLabel,get isDisabled(){return Eo.isDisabled}};break}}if(Yt)return Yt;const ho=In?gt.label:gt??"";return{value:gt,currentLabel:ho}},_n=()=>{_.hoveringIndex=Kt.value.findIndex(gt=>_.selected.some(Yt=>qe(Yt)===qe(gt)))},jn=()=>{_.selectionWidth=S.value.getBoundingClientRect().width},yt=()=>{_.calculatorWidth=F.value.getBoundingClientRect().width},kn=()=>{_.collapseItemWidth=U.value.getBoundingClientRect().width},qn=()=>{var gt,Yt;(Yt=(gt=E.value)==null?void 0:gt.updatePopper)==null||Yt.call(gt)},Co=()=>{var gt,Yt;(Yt=(gt=I.value)==null?void 0:gt.updatePopper)==null||Yt.call(gt)},mo=()=>{_.inputValue.length>0&&!ce.value&&(ce.value=!0),Et(_.inputValue)},Io=gt=>{if(_.inputValue=gt.target.value,e.remote)Ho();else return mo()},Ho=ol(()=>{mo()},Mt.value),ur=gt=>{Oa(e.modelValue,gt)||t(Yr,gt)},Dt=gt=>AO(gt,Yt=>{const In=_.cachedOptions.get(Yt);return In&&!In.disabled&&!In.states.groupDisabled}),En=gt=>{if(e.multiple&&gt.code!==On.delete&&gt.target.value.length<=0){const Yt=us(e.modelValue).slice(),In=Dt(Yt);if(In<0)return;const ho=Yt[In];Yt.splice(In,1),t(Fo,Yt),ur(Yt),t("remove-tag",ho)}},ft=(gt,Yt)=>{const In=_.selected.indexOf(Yt);if(In>-1&&!Ae.value){const ho=us(e.modelValue).slice();ho.splice(In,1),t(Fo,ho),ur(ho),t("remove-tag",Yt.value)}gt.stopPropagation(),Nr()},un=gt=>{gt.stopPropagation();const Yt=e.multiple?[]:Me.value;if(e.multiple)for(const In of _.selected)In.isDisabled&&Yt.push(In.value);t(Fo,Yt),ur(Yt),_.hoveringIndex=-1,ce.value=!1,t("clear"),Nr()},Je=gt=>{var Yt;if(e.multiple){const In=us((Yt=e.modelValue)!=null?Yt:[]).slice(),ho=Mn(In,gt);ho>-1?In.splice(ho,1):(e.multipleLimit<=0||In.length<e.multipleLimit)&&In.push(gt.value),t(Fo,In),ur(In),gt.created&&Et(""),e.filterable&&!e.reserveKeyword&&(_.inputValue="")}else t(Fo,gt.value),ur(gt.value),ce.value=!1;Nr(),!ce.value&&oo(()=>{Bn(gt)})},Mn=(gt=[],Yt)=>Hr(Yt)?-1:Vo(Yt.value)?gt.findIndex(In=>Oa(Ji(In,e.valueKey),qe(Yt))):gt.indexOf(Yt.value),Bn=gt=>{var Yt,In,ho,co,Lo;const Eo=fn(gt)?gt[0]:gt;let cr=null;if(Eo!=null&&Eo.value){const rr=Kt.value.filter(qo=>qo.value===Eo.value);rr.length>0&&(cr=rr[0].$el)}if(E.value&&cr){const rr=(co=(ho=(In=(Yt=E.value)==null?void 0:Yt.popperRef)==null?void 0:In.contentRef)==null?void 0:ho.querySelector)==null?void 0:co.call(ho,`.${d.be("dropdown","wrap")}`);rr&&rT(rr,cr)}(Lo=ie.value)==null||Lo.handleScroll()},Oo=gt=>{_.options.set(gt.value,gt),_.cachedOptions.set(gt.value,gt)},Rr=(gt,Yt)=>{_.options.get(gt)===Yt&&_.options.delete(gt)},hi=te(()=>{var gt,Yt;return(Yt=(gt=E.value)==null?void 0:gt.popperRef)==null?void 0:Yt.contentRef}),Er=()=>{_.isBeforeHide=!1,oo(()=>Bn(_.selected))},Nr=()=>{var gt;(gt=P.value)==null||gt.focus()},Xo=()=>{var gt;if(ce.value){ce.value=!1,oo(()=>{var Yt;return(Yt=P.value)==null?void 0:Yt.blur()});return}(gt=P.value)==null||gt.blur()},Bi=gt=>{un(gt)},Bs=gt=>{if(ce.value=!1,me.value){const Yt=new FocusEvent("focus",gt);oo(()=>fe(Yt))}},Zt=()=>{_.inputValue.length>0?_.inputValue="":ce.value=!1},Ee=()=>{Ae.value||(p2&&(_.inputHovering=!0),_.menuVisibleOnFocus?_.menuVisibleOnFocus=!1:ce.value=!ce.value)},ke=()=>{if(!ce.value)Ee();else{const gt=Kt.value[_.hoveringIndex];gt&&!gt.disabled&&!gt.states.groupDisabled&&Je(gt)}},qe=gt=>Vo(gt.value)?Ji(gt.value,e.valueKey):gt.value,mt=te(()=>Kt.value.filter(gt=>gt.visible).every(gt=>gt.disabled)),it=te(()=>e.multiple?e.collapseTags?_.selected.slice(0,e.maxCollapseTags):_.selected:[]),xt=te(()=>e.multiple?e.collapseTags?_.selected.slice(e.maxCollapseTags):[]:[]),qt=gt=>{if(!ce.value){ce.value=!0;return}if(!(_.options.size===0||bt.value===0||Z.value)&&!mt.value){gt==="next"?(_.hoveringIndex++,_.hoveringIndex===_.options.size&&(_.hoveringIndex=0)):gt==="prev"&&(_.hoveringIndex--,_.hoveringIndex<0&&(_.hoveringIndex=_.options.size-1));const Yt=Kt.value[_.hoveringIndex];(Yt.disabled===!0||Yt.states.groupDisabled===!0||!Yt.visible)&&qt(gt),oo(()=>Bn(pe.value))}},kt=()=>{if(!S.value)return 0;const gt=window.getComputedStyle(S.value);return Number.parseFloat(gt.gap||"6px")},Wt=te(()=>{const gt=kt();return{maxWidth:`${U.value&&e.maxCollapseTags===1?_.selectionWidth-_.collapseItemWidth-gt:_.selectionWidth}px`}}),Qt=te(()=>({maxWidth:`${_.selectionWidth}px`})),nn=te(()=>({width:`${Math.max(_.calculatorWidth,Zne)}px`}));return Mi(S,jn),Mi(F,yt),Mi(z,qn),Mi(le,qn),Mi(H,Co),Mi(U,kn),No(()=>{ln()}),{inputId:tt,contentId:s,nsSelect:d,nsInput:g,states:_,isFocused:me,expanded:ce,optionsArray:Kt,hoverOption:pe,selectSize:At,filteredOptionsCount:bt,resetCalculatorWidth:yt,updateTooltip:qn,updateTagTooltip:Co,debouncedOnInputChange:Ho,onInput:Io,deletePrevTag:En,deleteTag:ft,deleteSelected:un,handleOptionSelect:Je,scrollToOption:Bn,hasModelValue:Ce,shouldShowPlaceholder:Ht,currentPlaceholder:Ut,mouseEnterEventName:Nt,needStatusIcon:ge,showClose:Ne,iconComponent:We,iconReverse:ot,validateState:Oe,validateIcon:Ct,showNewOption:Re,updateOptions:dn,collapseTagSize:Ke,setSelected:ln,selectDisabled:Ae,emptyText:zt,handleCompositionStart:G,handleCompositionUpdate:Q,handleCompositionEnd:oe,onOptionCreate:Oo,onOptionDestroy:Rr,handleMenuEnter:Er,focus:Nr,blur:Xo,handleClearClick:Bi,handleClickOutside:Bs,handleEsc:Zt,toggleMenu:Ee,selectOption:ke,getValueKey:qe,navigateOptions:qt,dropdownMenuVisible:Be,showTagList:it,collapseTagList:xt,tagStyle:Wt,collapseTagStyle:Qt,inputStyle:nn,popperRef:hi,inputRef:P,tooltipRef:E,tagTooltipRef:I,calculatorRef:F,prefixRef:B,suffixRef:$,selectRef:o,wrapperRef:le,selectionRef:S,scrollbarRef:ie,menuRef:z,tagMenuRef:H,collapseItemRef:U}};var Xne=Ze({name:"ElOptions",setup(e,{slots:t}){const i=Un(Wm);let s=[];return()=>{var d,g;const _=(d=t.default)==null?void 0:d.call(t),o=[];function S(E){fn(E)&&E.forEach(I=>{var P,F,B,$;const z=(P=(I==null?void 0:I.type)||{})==null?void 0:P.name;z==="ElOptionGroup"?S(!Zn(I.children)&&!fn(I.children)&&Qn((F=I.children)==null?void 0:F.default)?(B=I.children)==null?void 0:B.default():I.children):z==="ElOption"?o.push(($=I.props)==null?void 0:$.value):fn(I.children)&&S(I.children)})}return _.length&&S((g=_[0])==null?void 0:g.children),Oa(o,s)||(s=o,i&&(i.states.optionValues=o)),_}}});const Jne=vn({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:ia,effect:{type:ut(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:wa.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Xr,default:ud},fitInputWidth:Boolean,suffixIcon:{type:Xr,default:cd},tagType:{...od.type,default:"info"},tagEffect:{...od.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:ut(String),values:dd,default:"bottom-start"},fallbackPlacements:{type:ut(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:String,...Um,...Da(["ariaLabel"])}),xP="ElSelect",Qne=Ze({name:xP,componentName:xP,components:{ElSelectMenu:Kne,ElOption:GT,ElOptions:Xne,ElTag:Em,ElScrollbar:Pu,ElTooltip:qa,ElIcon:Gn},directives:{ClickOutside:rd},props:Jne,emits:[Fo,Yr,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const i=te(()=>{const{modelValue:_,multiple:o}=e,S=o?[]:void 0;return fn(_)?o?_:S:o?S:_}),s=Pr({...Ca(e),modelValue:i}),d=Yne(s,t);or(Wm,Pr({props:s,states:d.states,optionsArray:d.optionsArray,handleOptionSelect:d.handleOptionSelect,onOptionCreate:d.onOptionCreate,onOptionDestroy:d.onOptionDestroy,selectRef:d.selectRef,setSelected:d.setSelected}));const g=te(()=>e.multiple?d.states.selected.map(_=>_.currentLabel):d.states.selectedLabel);return{...d,modelValue:i,selectedLabel:g}}});function eoe(e,t,i,s,d,g){const _=Go("el-tag"),o=Go("el-tooltip"),S=Go("el-icon"),E=Go("el-option"),I=Go("el-options"),P=Go("el-scrollbar"),F=Go("el-select-menu"),B=Kb("click-outside");return zo((se(),Pe("div",{ref:"selectRef",class:de([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[Bv(e.mouseEnterEventName)]:$=>e.states.inputHovering=!0,onMouseleave:$=>e.states.inputHovering=!1},[Qe(o,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:$=>e.states.isBeforeHide=!1},{default:at(()=>{var $;return[He("div",{ref:"wrapperRef",class:de([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:po(e.toggleMenu,["prevent"])},[e.$slots.prefix?(se(),Pe("div",{key:0,ref:"prefixRef",class:de(e.nsSelect.e("prefix"))},[_t(e.$slots,"prefix")],2)):St("v-if",!0),He("div",{ref:"selectionRef",class:de([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?_t(e.$slots,"tag",{key:0},()=>[(se(!0),Pe(eo,null,tr(e.showTagList,z=>(se(),Pe("div",{key:e.getValueKey(z),class:de(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!e.selectDisabled&&!z.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:to(e.tagStyle),onClose:H=>e.deleteTag(H,z)},{default:at(()=>[He("span",{class:de(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:z.currentLabel,value:z.value},()=>[nr(wn(z.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(se(),Rt(o,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:at(()=>[He("div",{ref:"collapseItemRef",class:de(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:to(e.collapseTagStyle)},{default:at(()=>[He("span",{class:de(e.nsSelect.e("tags-text"))}," + "+wn(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:at(()=>[He("div",{ref:"tagMenuRef",class:de(e.nsSelect.e("selection"))},[(se(!0),Pe(eo,null,tr(e.collapseTagList,z=>(se(),Pe("div",{key:e.getValueKey(z),class:de(e.nsSelect.e("selected-item"))},[Qe(_,{class:"in-tooltip",closable:!e.selectDisabled&&!z.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:H=>e.deleteTag(H,z)},{default:at(()=>[He("span",{class:de(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:z.currentLabel,value:z.value},()=>[nr(wn(z.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):St("v-if",!0)]):St("v-if",!0),He("div",{class:de([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[zo(He("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":z=>e.states.inputValue=z,type:"text",name:e.name,class:de([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:to(e.inputStyle),tabindex:e.tabindex,role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":(($=e.hoverOption)==null?void 0:$.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[ti(po(z=>e.navigateOptions("next"),["stop","prevent"]),["down"]),ti(po(z=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),ti(po(e.handleEsc,["stop","prevent"]),["esc"]),ti(po(e.selectOption,["stop","prevent"]),["enter"]),ti(po(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:po(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[Xb,e.states.inputValue]]),e.filterable?(se(),Pe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:de(e.nsSelect.e("input-calculator")),textContent:wn(e.states.inputValue)},null,10,["textContent"])):St("v-if",!0)],2),e.shouldShowPlaceholder?(se(),Pe("div",{key:1,class:de([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?_t(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[He("span",null,wn(e.currentPlaceholder),1)]):(se(),Pe("span",{key:1},wn(e.currentPlaceholder),1))],2)):St("v-if",!0)],2),He("div",{ref:"suffixRef",class:de(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(se(),Rt(S,{key:0,class:de([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:at(()=>[(se(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])):St("v-if",!0),e.showClose&&e.clearIcon?(se(),Rt(S,{key:1,class:de([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:at(()=>[(se(),Rt(Wo(e.clearIcon)))]),_:1},8,["class","onClick"])):St("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(se(),Rt(S,{key:2,class:de([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:at(()=>[(se(),Rt(Wo(e.validateIcon)))]),_:1},8,["class"])):St("v-if",!0)],2)],10,["onClick"])]}),content:at(()=>[Qe(F,{ref:"menuRef"},{default:at(()=>[e.$slots.header?(se(),Pe("div",{key:0,class:de(e.nsSelect.be("dropdown","header")),onClick:po(()=>{},["stop"])},[_t(e.$slots,"header")],10,["onClick"])):St("v-if",!0),zo(Qe(P,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:de([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:at(()=>[e.showNewOption?(se(),Rt(E,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):St("v-if",!0),Qe(I,null,{default:at(()=>[_t(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[Cr,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(se(),Pe("div",{key:1,class:de(e.nsSelect.be("dropdown","loading"))},[_t(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(se(),Pe("div",{key:2,class:de(e.nsSelect.be("dropdown","empty"))},[_t(e.$slots,"empty",{},()=>[He("span",null,wn(e.emptyText),1)])],2)):St("v-if",!0),e.$slots.footer?(se(),Pe("div",{key:3,class:de(e.nsSelect.be("dropdown","footer")),onClick:po(()=>{},["stop"])},[_t(e.$slots,"footer")],10,["onClick"])):St("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[B,e.handleClickOutside,e.popperRef]])}var toe=bn(Qne,[["render",eoe],["__file","select.vue"]]);const noe=Ze({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=rn("select"),i=Se(null),s=jo(),d=Se([]);or(oz,Pr({...Ca(e)}));const g=te(()=>d.value.some(E=>E.visible===!0)),_=E=>{var I,P;return((I=E.type)==null?void 0:I.name)==="ElOption"&&!!((P=E.component)!=null&&P.proxy)},o=E=>{const I=us(E),P=[];return I.forEach(F=>{var B,$;_(F)?P.push(F.component.proxy):(B=F.children)!=null&&B.length?P.push(...o(F.children)):($=F.component)!=null&&$.subTree&&P.push(...o(F.component.subTree))}),P},S=()=>{d.value=o(s.subTree)};return No(()=>{S()}),zO(i,S,{attributes:!0,subtree:!0,childList:!0}),{groupRef:i,visible:g,ns:t}}});function ooe(e,t,i,s,d,g){return zo((se(),Pe("ul",{ref:"groupRef",class:de(e.ns.be("group","wrap"))},[He("li",{class:de(e.ns.be("group","title"))},wn(e.label),3),He("li",null,[He("ul",{class:de(e.ns.b("group"))},[_t(e.$slots,"default")],2)])],2)),[[Cr,e.visible]])}var rz=bn(noe,[["render",ooe],["__file","option-group.vue"]]);const Vf=Ao(toe,{Option:GT,OptionGroup:rz}),Tb=Oi(GT),roe=Oi(rz),WT=()=>Un(nz,{}),ioe=vn({pageSize:{type:Number,required:!0},pageSizes:{type:ut(Array),default:()=>Ri([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:ku},appendSizeTo:String}),aoe=Ze({name:"ElPaginationSizes"}),soe=Ze({...aoe,props:ioe,emits:["page-size-change"],setup(e,{emit:t}){const i=e,{t:s}=vr(),d=rn("pagination"),g=WT(),_=Se(i.pageSize);tn(()=>i.pageSizes,(E,I)=>{if(!Oa(E,I)&&fn(E)){const P=E.includes(i.pageSize)?i.pageSize:i.pageSizes[0];t("page-size-change",P)}}),tn(()=>i.pageSize,E=>{_.value=E});const o=te(()=>i.pageSizes);function S(E){var I;E!==_.value&&(_.value=E,(I=g.handleSizeChange)==null||I.call(g,Number(E)))}return(E,I)=>(se(),Pe("span",{class:de(y(d).e("sizes"))},[Qe(y(Vf),{"model-value":_.value,disabled:E.disabled,"popper-class":E.popperClass,size:E.size,teleported:E.teleported,"validate-event":!1,"append-to":E.appendSizeTo,onChange:S},{default:at(()=>[(se(!0),Pe(eo,null,tr(y(o),P=>(se(),Rt(y(Tb),{key:P,value:P,label:P+y(s)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var loe=bn(soe,[["__file","sizes.vue"]]);const coe=vn({size:{type:String,values:ku}}),uoe=Ze({name:"ElPaginationJumper"}),doe=Ze({...uoe,props:coe,setup(e){const{t}=vr(),i=rn("pagination"),{pageCount:s,disabled:d,currentPage:g,changeEvent:_}=WT(),o=Se(),S=te(()=>{var P;return(P=o.value)!=null?P:g==null?void 0:g.value});function E(P){o.value=P?+P:""}function I(P){P=Math.trunc(+P),_==null||_(P),o.value=void 0}return(P,F)=>(se(),Pe("span",{class:de(y(i).e("jump")),disabled:y(d)},[He("span",{class:de([y(i).e("goto")])},wn(y(t)("el.pagination.goto")),3),Qe(y(hs),{size:P.size,class:de([y(i).e("editor"),y(i).is("in-pagination")]),min:1,max:y(s),disabled:y(d),"model-value":y(S),"validate-event":!1,"aria-label":y(t)("el.pagination.page"),type:"number","onUpdate:modelValue":E,onChange:I},null,8,["size","class","max","disabled","model-value","aria-label"]),He("span",{class:de([y(i).e("classifier")])},wn(y(t)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var hoe=bn(doe,[["__file","jumper.vue"]]);const foe=vn({total:{type:Number,default:1e3}}),poe=Ze({name:"ElPaginationTotal"}),moe=Ze({...poe,props:foe,setup(e){const{t}=vr(),i=rn("pagination"),{disabled:s}=WT();return(d,g)=>(se(),Pe("span",{class:de(y(i).e("total")),disabled:y(s)},wn(y(t)("el.pagination.total",{total:d.total})),11,["disabled"]))}});var goe=bn(moe,[["__file","total.vue"]]);const voe=vn({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),_oe=Ze({name:"ElPaginationPager"}),yoe=Ze({..._oe,props:voe,emits:["change"],setup(e,{emit:t}){const i=e,s=rn("pager"),d=rn("icon"),{t:g}=vr(),_=Se(!1),o=Se(!1),S=Se(!1),E=Se(!1),I=Se(!1),P=Se(!1),F=te(()=>{const G=i.pagerCount,Q=(G-1)/2,oe=Number(i.currentPage),le=Number(i.pageCount);let me=!1,fe=!1;le>G&&(oe>G-Q&&(me=!0),oe<le-Q&&(fe=!0));const ce=[];if(me&&!fe){const pe=le-(G-2);for(let ye=pe;ye<le;ye++)ce.push(ye)}else if(!me&&fe)for(let pe=2;pe<G;pe++)ce.push(pe);else if(me&&fe){const pe=Math.floor(G/2)-1;for(let ye=oe-pe;ye<=oe+pe;ye++)ce.push(ye)}else for(let pe=2;pe<le;pe++)ce.push(pe);return ce}),B=te(()=>["more","btn-quickprev",d.b(),s.is("disabled",i.disabled)]),$=te(()=>["more","btn-quicknext",d.b(),s.is("disabled",i.disabled)]),z=te(()=>i.disabled?-1:0);Ha(()=>{const G=(i.pagerCount-1)/2;_.value=!1,o.value=!1,i.pageCount>i.pagerCount&&(i.currentPage>i.pagerCount-G&&(_.value=!0),i.currentPage<i.pageCount-G&&(o.value=!0))});function H(G=!1){i.disabled||(G?S.value=!0:E.value=!0)}function U(G=!1){G?I.value=!0:P.value=!0}function ie(G){const Q=G.target;if(Q.tagName.toLowerCase()==="li"&&Array.from(Q.classList).includes("number")){const oe=Number(Q.textContent);oe!==i.currentPage&&t("change",oe)}else Q.tagName.toLowerCase()==="li"&&Array.from(Q.classList).includes("more")&&Z(G)}function Z(G){const Q=G.target;if(Q.tagName.toLowerCase()==="ul"||i.disabled)return;let oe=Number(Q.textContent);const le=i.pageCount,me=i.currentPage,fe=i.pagerCount-2;Q.className.includes("more")&&(Q.className.includes("quickprev")?oe=me-fe:Q.className.includes("quicknext")&&(oe=me+fe)),Number.isNaN(+oe)||(oe<1&&(oe=1),oe>le&&(oe=le)),oe!==me&&t("change",oe)}return(G,Q)=>(se(),Pe("ul",{class:de(y(s).b()),onClick:Z,onKeyup:ti(ie,["enter"])},[G.pageCount>0?(se(),Pe("li",{key:0,class:de([[y(s).is("active",G.currentPage===1),y(s).is("disabled",G.disabled)],"number"]),"aria-current":G.currentPage===1,"aria-label":y(g)("el.pagination.currentPage",{pager:1}),tabindex:y(z)}," 1 ",10,["aria-current","aria-label","tabindex"])):St("v-if",!0),_.value?(se(),Pe("li",{key:1,class:de(y(B)),tabindex:y(z),"aria-label":y(g)("el.pagination.prevPages",{pager:G.pagerCount-2}),onMouseenter:oe=>H(!0),onMouseleave:oe=>S.value=!1,onFocus:oe=>U(!0),onBlur:oe=>I.value=!1},[(S.value||I.value)&&!G.disabled?(se(),Rt(y(bh),{key:0})):(se(),Rt(y(bk),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):St("v-if",!0),(se(!0),Pe(eo,null,tr(y(F),oe=>(se(),Pe("li",{key:oe,class:de([[y(s).is("active",G.currentPage===oe),y(s).is("disabled",G.disabled)],"number"]),"aria-current":G.currentPage===oe,"aria-label":y(g)("el.pagination.currentPage",{pager:oe}),tabindex:y(z)},wn(oe),11,["aria-current","aria-label","tabindex"]))),128)),o.value?(se(),Pe("li",{key:2,class:de(y($)),tabindex:y(z),"aria-label":y(g)("el.pagination.nextPages",{pager:G.pagerCount-2}),onMouseenter:oe=>H(),onMouseleave:oe=>E.value=!1,onFocus:oe=>U(),onBlur:oe=>P.value=!1},[(E.value||P.value)&&!G.disabled?(se(),Rt(y(xh),{key:0})):(se(),Rt(y(bk),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):St("v-if",!0),G.pageCount>1?(se(),Pe("li",{key:3,class:de([[y(s).is("active",G.currentPage===G.pageCount),y(s).is("disabled",G.disabled)],"number"]),"aria-current":G.currentPage===G.pageCount,"aria-label":y(g)("el.pagination.currentPage",{pager:G.pageCount}),tabindex:y(z)},wn(G.pageCount),11,["aria-current","aria-label","tabindex"])):St("v-if",!0)],42,["onKeyup"]))}});var boe=bn(yoe,[["__file","pager.vue"]]);const Es=e=>typeof e!="number",xoe=vn({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>ao(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:ut(Array),default:()=>Ri([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:Xr,default:()=>yh},nextText:{type:String,default:""},nextIcon:{type:Xr,default:()=>Ls},teleported:{type:Boolean,default:!0},small:Boolean,size:ia,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),woe={"update:current-page":e=>ao(e),"update:page-size":e=>ao(e),"size-change":e=>ao(e),change:(e,t)=>ao(e)&&ao(t),"current-change":e=>ao(e),"prev-click":e=>ao(e),"next-click":e=>ao(e)},wP="ElPagination";var Soe=Ze({name:wP,props:xoe,emits:woe,setup(e,{emit:t,slots:i}){const{t:s}=vr(),d=rn("pagination"),g=jo().vnode.props||{},_=jO(),o=te(()=>{var Q;return e.small?"small":(Q=e.size)!=null?Q:_.value});dh({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},te(()=>!!e.small));const S="onUpdate:currentPage"in g||"onUpdate:current-page"in g||"onCurrentChange"in g,E="onUpdate:pageSize"in g||"onUpdate:page-size"in g||"onSizeChange"in g,I=te(()=>{if(Es(e.total)&&Es(e.pageCount)||!Es(e.currentPage)&&!S)return!1;if(e.layout.includes("sizes")){if(Es(e.pageCount)){if(!Es(e.total)&&!Es(e.pageSize)&&!E)return!1}else if(!E)return!1}return!0}),P=Se(Es(e.defaultPageSize)?10:e.defaultPageSize),F=Se(Es(e.defaultCurrentPage)?1:e.defaultCurrentPage),B=te({get(){return Es(e.pageSize)?P.value:e.pageSize},set(Q){Es(e.pageSize)&&(P.value=Q),E&&(t("update:page-size",Q),t("size-change",Q))}}),$=te(()=>{let Q=0;return Es(e.pageCount)?Es(e.total)||(Q=Math.max(1,Math.ceil(e.total/B.value))):Q=e.pageCount,Q}),z=te({get(){return Es(e.currentPage)?F.value:e.currentPage},set(Q){let oe=Q;Q<1?oe=1:Q>$.value&&(oe=$.value),Es(e.currentPage)&&(F.value=oe),S&&(t("update:current-page",oe),t("current-change",oe))}});tn($,Q=>{z.value>Q&&(z.value=Q)}),tn([z,B],Q=>{t("change",...Q)},{flush:"post"});function H(Q){z.value=Q}function U(Q){B.value=Q;const oe=$.value;z.value>oe&&(z.value=oe)}function ie(){e.disabled||(z.value-=1,t("prev-click",z.value))}function Z(){e.disabled||(z.value+=1,t("next-click",z.value))}function G(Q,oe){Q&&(Q.props||(Q.props={}),Q.props.class=[Q.props.class,oe].join(" "))}return or(nz,{pageCount:$,disabled:te(()=>e.disabled),currentPage:z,changeEvent:H,handleSizeChange:U}),()=>{var Q,oe;if(!I.value)return s("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&$.value<=1)return null;const le=[],me=[],fe=lo("div",{class:d.e("rightwrapper")},me),ce={prev:lo(Bne,{disabled:e.disabled,currentPage:z.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:ie}),jumper:lo(hoe,{size:o.value}),pager:lo(boe,{currentPage:z.value,pageCount:$.value,pagerCount:e.pagerCount,onChange:H,disabled:e.disabled}),next:lo(Une,{disabled:e.disabled,currentPage:z.value,pageCount:$.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:Z}),sizes:lo(loe,{pageSize:B.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:o.value,appendSizeTo:e.appendSizeTo}),slot:(oe=(Q=i==null?void 0:i.default)==null?void 0:Q.call(i))!=null?oe:null,total:lo(goe,{total:Es(e.total)?0:e.total})},pe=e.layout.split(",").map(De=>De.trim());let ye=!1;return pe.forEach(De=>{if(De==="->"){ye=!0;return}ye?me.push(ce[De]):le.push(ce[De])}),G(le[0],d.is("first")),G(le[le.length-1],d.is("last")),ye&&me.length>0&&(G(me[0],d.is("first")),G(me[me.length-1],d.is("last")),le.push(fe)),lo("div",{class:[d.b(),d.is("background",e.background),d.m(o.value)]},le)}}});const Toe=Ao(Soe),Coe=vn({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:v2,default:"primary"},cancelButtonType:{type:String,values:v2,default:"text"},icon:{type:Xr,default:()=>vW},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:wa.teleported,persistent:wa.persistent,width:{type:[String,Number],default:150}}),Eoe={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},Moe=Ze({name:"ElPopconfirm"}),Ioe=Ze({...Moe,props:Coe,emits:Eoe,setup(e,{emit:t}){const i=e,{t:s}=vr(),d=rn("popconfirm"),g=Se(),_=()=>{var F,B;(B=(F=g.value)==null?void 0:F.onClose)==null||B.call(F)},o=te(()=>({width:ji(i.width)})),S=F=>{t("confirm",F),_()},E=F=>{t("cancel",F),_()},I=te(()=>i.confirmButtonText||s("el.popconfirm.confirmButtonText")),P=te(()=>i.cancelButtonText||s("el.popconfirm.cancelButtonText"));return(F,B)=>(se(),Rt(y(qa),Yo({ref_key:"tooltipRef",ref:g,trigger:"click",effect:"light"},F.$attrs,{"popper-class":`${y(d).namespace.value}-popover`,"popper-style":y(o),teleported:F.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":F.hideAfter,persistent:F.persistent}),{content:at(()=>[He("div",{class:de(y(d).b())},[He("div",{class:de(y(d).e("main"))},[!F.hideIcon&&F.icon?(se(),Rt(y(Gn),{key:0,class:de(y(d).e("icon")),style:to({color:F.iconColor})},{default:at(()=>[(se(),Rt(Wo(F.icon)))]),_:1},8,["class","style"])):St("v-if",!0),nr(" "+wn(F.title),1)],2),He("div",{class:de(y(d).e("action"))},[_t(F.$slots,"actions",{confirm:S,cancel:E},()=>[Qe(y(Ta),{size:"small",type:F.cancelButtonType==="text"?"":F.cancelButtonType,text:F.cancelButtonType==="text",onClick:E},{default:at(()=>[nr(wn(y(P)),1)]),_:1},8,["type","text"]),Qe(y(Ta),{size:"small",type:F.confirmButtonType==="text"?"":F.confirmButtonType,text:F.confirmButtonType==="text",onClick:S},{default:at(()=>[nr(wn(y(I)),1)]),_:1},8,["type","text"])])],2)],2)]),default:at(()=>[F.$slots.reference?_t(F.$slots,"reference",{key:0}):St("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var Aoe=bn(Ioe,[["__file","popconfirm.vue"]]);const koe=Ao(Aoe),Poe=vn({trigger:f_.trigger,placement:K0.placement,disabled:f_.disabled,visible:wa.visible,transition:wa.transition,popperOptions:K0.popperOptions,tabindex:K0.tabindex,content:wa.content,popperStyle:wa.popperStyle,popperClass:wa.popperClass,enterable:{...wa.enterable,default:!0},effect:{...wa.effect,default:"light"},teleported:wa.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),Roe={"update:visible":e=>ai(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},Ooe="onUpdate:visible",Loe=Ze({name:"ElPopover"}),Doe=Ze({...Loe,props:Poe,emits:Roe,setup(e,{expose:t,emit:i}){const s=e,d=te(()=>s[Ooe]),g=rn("popover"),_=Se(),o=te(()=>{var H;return(H=y(_))==null?void 0:H.popperRef}),S=te(()=>[{width:ji(s.width)},s.popperStyle]),E=te(()=>[g.b(),s.popperClass,{[g.m("plain")]:!!s.content}]),I=te(()=>s.transition===`${g.namespace.value}-fade-in-linear`),P=()=>{var H;(H=_.value)==null||H.hide()},F=()=>{i("before-enter")},B=()=>{i("before-leave")},$=()=>{i("after-enter")},z=()=>{i("update:visible",!1),i("after-leave")};return t({popperRef:o,hide:P}),(H,U)=>(se(),Rt(y(qa),Yo({ref_key:"tooltipRef",ref:_},H.$attrs,{trigger:H.trigger,placement:H.placement,disabled:H.disabled,visible:H.visible,transition:H.transition,"popper-options":H.popperOptions,tabindex:H.tabindex,content:H.content,offset:H.offset,"show-after":H.showAfter,"hide-after":H.hideAfter,"auto-close":H.autoClose,"show-arrow":H.showArrow,"aria-label":H.title,effect:H.effect,enterable:H.enterable,"popper-class":y(E),"popper-style":y(S),teleported:H.teleported,persistent:H.persistent,"gpu-acceleration":y(I),"onUpdate:visible":y(d),onBeforeShow:F,onBeforeHide:B,onShow:$,onHide:z}),{content:at(()=>[H.title?(se(),Pe("div",{key:0,class:de(y(g).e("title")),role:"title"},wn(H.title),3)):St("v-if",!0),_t(H.$slots,"default",{},()=>[nr(wn(H.content),1)])]),default:at(()=>[H.$slots.reference?_t(H.$slots,"reference",{key:0}):St("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var zoe=bn(Doe,[["__file","popover.vue"]]);const SP=(e,t)=>{const i=t.arg||t.value,s=i==null?void 0:i.popperRef;s&&(s.triggerRef=e)};var Foe={mounted(e,t){SP(e,t)},updated(e,t){SP(e,t)}};const Boe="popover",iz=CG(Foe,Boe),Noe=Ao(zoe,{directive:iz}),$oe=vn({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:ut(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:ut([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:ut(Function),default:e=>`${e}%`}}),Voe=Ze({name:"ElProgress"}),Uoe=Ze({...Voe,props:$oe,setup(e){const t=e,i={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},s=rn("progress"),d=te(()=>{const Z={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},G=ie(t.percentage);return G.includes("gradient")?Z.background=G:Z.backgroundColor=G,Z}),g=te(()=>(t.strokeWidth/t.width*100).toFixed(1)),_=te(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(g.value)/2}`,10):0),o=te(()=>{const Z=_.value,G=t.type==="dashboard";return`
          M 50 50
          m 0 ${G?"":"-"}${Z}
          a ${Z} ${Z} 0 1 1 0 ${G?"-":""}${Z*2}
          a ${Z} ${Z} 0 1 1 0 ${G?"":"-"}${Z*2}
          `}),S=te(()=>2*Math.PI*_.value),E=te(()=>t.type==="dashboard"?.75:1),I=te(()=>`${-1*S.value*(1-E.value)/2}px`),P=te(()=>({strokeDasharray:`${S.value*E.value}px, ${S.value}px`,strokeDashoffset:I.value})),F=te(()=>({strokeDasharray:`${S.value*E.value*(t.percentage/100)}px, ${S.value}px`,strokeDashoffset:I.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),B=te(()=>{let Z;return t.color?Z=ie(t.percentage):Z=i[t.status]||i.default,Z}),$=te(()=>t.status==="warning"?c1:t.type==="line"?t.status==="success"?aT:ud:t.status==="success"?D_:Kc),z=te(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),H=te(()=>t.format(t.percentage));function U(Z){const G=100/Z.length;return Z.map((oe,le)=>Zn(oe)?{color:oe,percentage:(le+1)*G}:oe).sort((oe,le)=>oe.percentage-le.percentage)}const ie=Z=>{var G;const{color:Q}=t;if(Qn(Q))return Q(Z);if(Zn(Q))return Q;{const oe=U(Q);for(const le of oe)if(le.percentage>Z)return le.color;return(G=oe[oe.length-1])==null?void 0:G.color}};return(Z,G)=>(se(),Pe("div",{class:de([y(s).b(),y(s).m(Z.type),y(s).is(Z.status),{[y(s).m("without-text")]:!Z.showText,[y(s).m("text-inside")]:Z.textInside}]),role:"progressbar","aria-valuenow":Z.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[Z.type==="line"?(se(),Pe("div",{key:0,class:de(y(s).b("bar"))},[He("div",{class:de(y(s).be("bar","outer")),style:to({height:`${Z.strokeWidth}px`})},[He("div",{class:de([y(s).be("bar","inner"),{[y(s).bem("bar","inner","indeterminate")]:Z.indeterminate},{[y(s).bem("bar","inner","striped")]:Z.striped},{[y(s).bem("bar","inner","striped-flow")]:Z.stripedFlow}]),style:to(y(d))},[(Z.showText||Z.$slots.default)&&Z.textInside?(se(),Pe("div",{key:0,class:de(y(s).be("bar","innerText"))},[_t(Z.$slots,"default",{percentage:Z.percentage},()=>[He("span",null,wn(y(H)),1)])],2)):St("v-if",!0)],6)],6)],2)):(se(),Pe("div",{key:1,class:de(y(s).b("circle")),style:to({height:`${Z.width}px`,width:`${Z.width}px`})},[(se(),Pe("svg",{viewBox:"0 0 100 100"},[He("path",{class:de(y(s).be("circle","track")),d:y(o),stroke:`var(${y(s).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":Z.strokeLinecap,"stroke-width":y(g),fill:"none",style:to(y(P))},null,14,["d","stroke","stroke-linecap","stroke-width"]),He("path",{class:de(y(s).be("circle","path")),d:y(o),stroke:y(B),fill:"none",opacity:Z.percentage?1:0,"stroke-linecap":Z.strokeLinecap,"stroke-width":y(g),style:to(y(F))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(Z.showText||Z.$slots.default)&&!Z.textInside?(se(),Pe("div",{key:2,class:de(y(s).e("text")),style:to({fontSize:`${y(z)}px`})},[_t(Z.$slots,"default",{percentage:Z.percentage},()=>[Z.status?(se(),Rt(y(Gn),{key:1},{default:at(()=>[(se(),Rt(Wo(y($))))]),_:1})):(se(),Pe("span",{key:0},wn(y(H)),1))])],6)):St("v-if",!0)],10,["aria-valuenow"]))}});var joe=bn(Uoe,[["__file","progress.vue"]]);const az=Ao(joe),Hoe=vn({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:ut([Array,Object]),default:()=>Ri(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:ut([Array,Object]),default:()=>[S0,S0,S0]},voidIcon:{type:Xr,default:()=>RW},disabledVoidIcon:{type:Xr,default:()=>S0},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:ut(Array),default:()=>Ri(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:ia,clearable:Boolean,...Da(["ariaLabel"])}),Goe={[Yr]:e=>ao(e),[Fo]:e=>ao(e)},Woe=Ze({name:"ElRate"}),qoe=Ze({...Woe,props:Hoe,emits:Goe,setup(e,{expose:t,emit:i}){const s=e;function d(xe,Ae){const Ce=We=>Vo(We),ge=Object.keys(Ae).map(We=>+We).filter(We=>{const ot=Ae[We];return(Ce(ot)?ot.excluded:!1)?xe<We:xe<=We}).sort((We,ot)=>We-ot),Ne=Ae[ge[0]];return Ce(Ne)&&Ne.value||Ne}const g=Un(Kf,void 0),_=Un(Eu,void 0),o=na(),S=rn("rate"),{inputId:E,isLabeledByFormItem:I}=ic(s,{formItemContext:_}),P=Se(s.modelValue),F=Se(-1),B=Se(!0),$=te(()=>[S.b(),S.m(o.value)]),z=te(()=>s.disabled||(g==null?void 0:g.disabled)),H=te(()=>S.cssVarBlock({"void-color":s.voidColor,"disabled-void-color":s.disabledVoidColor,"fill-color":G.value})),U=te(()=>{let xe="";return s.showScore?xe=s.scoreTemplate.replace(/\{\s*value\s*\}/,z.value?`${s.modelValue}`:`${P.value}`):s.showText&&(xe=s.texts[Math.ceil(P.value)-1]),xe}),ie=te(()=>s.modelValue*100-Math.floor(s.modelValue)*100),Z=te(()=>fn(s.colors)?{[s.lowThreshold]:s.colors[0],[s.highThreshold]:{value:s.colors[1],excluded:!0},[s.max]:s.colors[2]}:s.colors),G=te(()=>{const xe=d(P.value,Z.value);return Vo(xe)?"":xe}),Q=te(()=>{let xe="";return z.value?xe=`${ie.value}%`:s.allowHalf&&(xe="50%"),{color:G.value,width:xe}}),oe=te(()=>{let xe=fn(s.icons)?[...s.icons]:{...s.icons};return xe=uh(xe),fn(xe)?{[s.lowThreshold]:xe[0],[s.highThreshold]:{value:xe[1],excluded:!0},[s.max]:xe[2]}:xe}),le=te(()=>d(s.modelValue,oe.value)),me=te(()=>z.value?Zn(s.disabledVoidIcon)?s.disabledVoidIcon:uh(s.disabledVoidIcon):Zn(s.voidIcon)?s.voidIcon:uh(s.voidIcon)),fe=te(()=>d(P.value,oe.value));function ce(xe){const Ae=z.value&&ie.value>0&&xe-1<s.modelValue&&xe>s.modelValue,Ce=s.allowHalf&&B.value&&xe-.5<=P.value&&xe>P.value;return Ae||Ce}function pe(xe){s.clearable&&xe===s.modelValue&&(xe=0),i(Fo,xe),s.modelValue!==xe&&i("change",xe)}function ye(xe){z.value||(s.allowHalf&&B.value?pe(P.value):pe(xe))}function De(xe){if(z.value)return;let Ae=P.value;const Ce=xe.code;return Ce===On.up||Ce===On.right?(s.allowHalf?Ae+=.5:Ae+=1,xe.stopPropagation(),xe.preventDefault()):(Ce===On.left||Ce===On.down)&&(s.allowHalf?Ae-=.5:Ae-=1,xe.stopPropagation(),xe.preventDefault()),Ae=Ae<0?0:Ae,Ae=Ae>s.max?s.max:Ae,i(Fo,Ae),i("change",Ae),Ae}function tt(xe,Ae){if(!z.value){if(s.allowHalf&&Ae){let Ce=Ae.target;el(Ce,S.e("item"))&&(Ce=Ce.querySelector(`.${S.e("icon")}`)),(Ce.clientWidth===0||el(Ce,S.e("decimal")))&&(Ce=Ce.parentNode),B.value=Ae.offsetX*2<=Ce.clientWidth,P.value=B.value?xe-.5:xe}else P.value=xe;F.value=xe}}function Me(){z.value||(s.allowHalf&&(B.value=s.modelValue!==Math.floor(s.modelValue)),P.value=s.modelValue,F.value=-1)}return tn(()=>s.modelValue,xe=>{P.value=xe,B.value=s.modelValue!==Math.floor(s.modelValue)}),s.modelValue||i(Fo,0),t({setCurrentValue:tt,resetCurrentValue:Me}),(xe,Ae)=>{var Ce;return se(),Pe("div",{id:y(E),class:de([y($),y(S).is("disabled",y(z))]),role:"slider","aria-label":y(I)?void 0:xe.ariaLabel||"rating","aria-labelledby":y(I)?(Ce=y(_))==null?void 0:Ce.labelId:void 0,"aria-valuenow":P.value,"aria-valuetext":y(U)||void 0,"aria-valuemin":"0","aria-valuemax":xe.max,tabindex:"0",style:to(y(H)),onKeydown:De},[(se(!0),Pe(eo,null,tr(xe.max,(ge,Ne)=>(se(),Pe("span",{key:Ne,class:de(y(S).e("item")),onMousemove:We=>tt(ge,We),onMouseleave:Me,onClick:We=>ye(ge)},[Qe(y(Gn),{class:de([y(S).e("icon"),{hover:F.value===ge},y(S).is("active",ge<=P.value)])},{default:at(()=>[ce(ge)?St("v-if",!0):(se(),Pe(eo,{key:0},[zo((se(),Rt(Wo(y(fe)),null,null,512)),[[Cr,ge<=P.value]]),zo((se(),Rt(Wo(y(me)),null,null,512)),[[Cr,!(ge<=P.value)]])],64)),ce(ge)?(se(),Pe(eo,{key:1},[(se(),Rt(Wo(y(me)),{class:de([y(S).em("decimal","box")])},null,8,["class"])),Qe(y(Gn),{style:to(y(Q)),class:de([y(S).e("icon"),y(S).e("decimal")])},{default:at(()=>[(se(),Rt(Wo(y(le))))]),_:1},8,["style","class"])],64)):St("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),xe.showText||xe.showScore?(se(),Pe("span",{key:0,class:de(y(S).e("text")),style:to({color:xe.textColor})},wn(y(U)),7)):St("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var Koe=bn(qoe,[["__file","rate.vue"]]);const Zoe=Ao(Koe),em={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},TP={[em.success]:HG,[em.warning]:c1,[em.error]:sT,[em.info]:lT},Yoe=vn({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),Xoe=Ze({name:"ElResult"}),Joe=Ze({...Xoe,props:Yoe,setup(e){const t=e,i=rn("result"),s=te(()=>{const d=t.icon,g=d&&em[d]?em[d]:"icon-info",_=TP[g]||TP["icon-info"];return{class:g,component:_}});return(d,g)=>(se(),Pe("div",{class:de(y(i).b())},[He("div",{class:de(y(i).e("icon"))},[_t(d.$slots,"icon",{},()=>[y(s).component?(se(),Rt(Wo(y(s).component),{key:0,class:de(y(s).class)},null,8,["class"])):St("v-if",!0)])],2),d.title||d.$slots.title?(se(),Pe("div",{key:0,class:de(y(i).e("title"))},[_t(d.$slots,"title",{},()=>[He("p",null,wn(d.title),1)])],2)):St("v-if",!0),d.subTitle||d.$slots["sub-title"]?(se(),Pe("div",{key:1,class:de(y(i).e("subtitle"))},[_t(d.$slots,"sub-title",{},()=>[He("p",null,wn(d.subTitle),1)])],2)):St("v-if",!0),d.$slots.extra?(se(),Pe("div",{key:2,class:de(y(i).e("extra"))},[_t(d.$slots,"extra")],2)):St("v-if",!0)],2))}});var Qoe=bn(Joe,[["__file","result.vue"]]);const ere=Ao(Qoe),tre=["start","center","end","space-around","space-between","space-evenly"],nre=["top","middle","bottom"],ore=vn({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:tre,default:"start"},align:{type:String,values:nre}}),rre=Ze({name:"ElRow"}),ire=Ze({...rre,props:ore,setup(e){const t=e,i=rn("row"),s=te(()=>t.gutter);or(aD,{gutter:s});const d=te(()=>{const _={};return t.gutter&&(_.marginRight=_.marginLeft=`-${t.gutter/2}px`),_}),g=te(()=>[i.b(),i.is(`justify-${t.justify}`,t.justify!=="start"),i.is(`align-${t.align}`,!!t.align)]);return(_,o)=>(se(),Rt(Wo(_.tag),{class:de(y(g)),style:to(y(d))},{default:at(()=>[_t(_.$slots,"default")]),_:3},8,["class","style"]))}});var are=bn(ire,[["__file","row.vue"]]);const sre=Ao(are),lre=Ze({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:rn("select")}}});function cre(e,t,i,s,d,g){return se(),Pe("div",{class:de(e.ns.be("group","title")),style:to({...e.style,lineHeight:`${e.height}px`})},wn(e.item.label),7)}var ure=bn(lre,[["render",cre],["__file","group-item.vue"]]);function dre(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const sz={label:"label",value:"value",disabled:"disabled",options:"options"};function y1(e){const t=te(()=>({...sz,...e.props}));return{aliasProps:t,getLabel:_=>Ji(_,t.value.label),getValue:_=>Ji(_,t.value.value),getDisabled:_=>Ji(_,t.value.disabled),getOptions:_=>Ji(_,t.value.options)}}const hre=vn({allowCreate:Boolean,autocomplete:{type:ut(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:Xr,default:ud},effect:{type:ut(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:ut([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:ut(Array),required:!0},placeholder:{type:String},teleported:wa.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})},remote:Boolean,size:ia,props:{type:ut(Object),default:()=>sz},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:ut(String),values:dd,default:"bottom-start"},fallbackPlacements:{type:ut(Array),default:["bottom-start","top-start","right","left"]},tagType:{...od.type,default:"info"},tagEffect:{...od.effect,default:"light"},tabindex:{type:[String,Number],default:0},appendTo:String,...Um,...Da(["ariaLabel"])}),fre=vn({data:Array,disabled:Boolean,hovering:Boolean,item:{type:ut(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),pre={[Fo]:e=>!0,[Yr]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},mre={hover:e=>ao(e),select:(e,t)=>!0},qT=Symbol("ElSelectV2Injection"),gre=Ze({props:fre,emits:mre,setup(e,{emit:t}){const i=Un(qT),s=rn("select"),{hoverItem:d,selectOptionClick:g}=dre(e,{emit:t}),{getLabel:_}=y1(i.props);return{ns:s,hoverItem:d,selectOptionClick:g,getLabel:_}}});function vre(e,t,i,s,d,g){return se(),Pe("li",{"aria-selected":e.selected,style:to(e.style),class:de([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:po(e.selectOptionClick,["stop"])},[_t(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[He("span",null,wn(e.getLabel(e.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var _re=bn(gre,[["render",vre],["__file","option-item.vue"]]),CP=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function yre(e,t){return!!(e===t||CP(e)&&CP(t))}function bre(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!yre(e[i],t[i]))return!1;return!0}function xre(e,t){t===void 0&&(t=bre);var i=null;function s(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];if(i&&i.lastThis===this&&t(d,i.lastArgs))return i.lastResult;var _=e.apply(this,d);return i={lastResult:_,lastArgs:d,lastThis:this},_}return s.clear=function(){i=null},s}const lz=()=>{const t=jo().proxy.$props;return te(()=>{const i=(s,d,g)=>({});return t.perfMode?n1(i):xre(i)})},B2=50,Cb="itemRendered",Eb="scroll",tm="forward",Mb="backward",Xl="auto",b1="smart",v_="start",xu="center",__="end",Im="horizontal",KT="vertical",wre="ltr",hm="rtl",y_="negative",ZT="positive-ascending",YT="positive-descending",Sre={[Im]:"left",[KT]:"top"},Tre=20,Cre={[Im]:"deltaX",[KT]:"deltaY"},Ere=({atEndEdge:e,atStartEdge:t,layout:i},s)=>{let d,g=0;const _=S=>S<0&&t.value||S>0&&e.value;return{hasReachedEdge:_,onWheel:S=>{$f(d);const E=S[Cre[i.value]];_(g)&&_(g+E)||(g+=E,d1()||S.preventDefault(),d=_h(()=>{s(g),g=0}))}}},N2=Qc({type:ut([Number,Function]),required:!0}),$2=Qc({type:Number}),V2=Qc({type:Number,default:2}),Mre=Qc({type:String,values:["ltr","rtl"],default:"ltr"}),U2=Qc({type:Number,default:0}),Ib=Qc({type:Number,required:!0}),cz=Qc({type:String,values:["horizontal","vertical"],default:KT}),uz=vn({className:{type:String,default:""},containerElement:{type:ut([String,Object]),default:"div"},data:{type:ut(Array),default:()=>Ri([])},direction:Mre,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:ut([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),dz=vn({cache:V2,estimatedItemSize:$2,layout:cz,initScrollOffset:U2,total:Ib,itemSize:N2,...uz}),j2={type:Number,default:6},hz={type:Number,default:0},fz={type:Number,default:2},Of=vn({columnCache:V2,columnWidth:N2,estimatedColumnWidth:$2,estimatedRowHeight:$2,initScrollLeft:U2,initScrollTop:U2,itemKey:{type:ut(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:V2,rowHeight:N2,totalColumn:Ib,totalRow:Ib,hScrollbarSize:j2,vScrollbarSize:j2,scrollbarStartGap:hz,scrollbarEndGap:fz,role:String,...uz}),pz=vn({alwaysOn:Boolean,class:String,layout:cz,total:Ib,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:j2,startGap:hz,endGap:fz,visible:Boolean}),Ef=(e,t)=>e<t?tm:Mb,b_=e=>e===wre||e===hm||e===Im,EP=e=>e===hm;let Wp=null;function Ab(e=!1){if(Wp===null||e){const t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";const s=document.createElement("div"),d=s.style;return d.width="100px",d.height="100px",t.appendChild(s),document.body.appendChild(t),t.scrollLeft>0?Wp=YT:(t.scrollLeft=1,t.scrollLeft===0?Wp=y_:Wp=ZT),document.body.removeChild(t),Wp}return Wp}function Ire({move:e,size:t,bar:i},s){const d={},g=`translate${i.axis}(${e}px)`;return d[i.size]=t,d.transform=g,d.msTransform=g,d.webkitTransform=g,s==="horizontal"?d.height="100%":d.width="100%",d}const H2=Ze({name:"ElVirtualScrollBar",props:pz,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const i=te(()=>e.startGap+e.endGap),s=rn("virtual-scrollbar"),d=rn("scrollbar"),g=Se(),_=Se();let o=null,S=null;const E=Pr({isDragging:!1,traveled:0}),I=te(()=>oL[e.layout]),P=te(()=>e.clientSize-y(i)),F=te(()=>({position:"absolute",width:`${Im===e.layout?P.value:e.scrollbarSize}px`,height:`${Im===e.layout?e.scrollbarSize:P.value}px`,[Sre[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),B=te(()=>{const oe=e.ratio,le=e.clientSize;if(oe>=100)return Number.POSITIVE_INFINITY;if(oe>=50)return oe*le/100;const me=le/3;return Math.floor(Math.min(Math.max(oe*le,Tre),me))}),$=te(()=>{if(!Number.isFinite(B.value))return{display:"none"};const oe=`${B.value}px`;return Ire({bar:I.value,size:oe,move:E.traveled},e.layout)}),z=te(()=>Math.floor(e.clientSize-B.value-y(i))),H=()=>{window.addEventListener("mousemove",G),window.addEventListener("mouseup",Z);const oe=y(_);oe&&(S=document.onselectstart,document.onselectstart=()=>!1,oe.addEventListener("touchmove",G,{passive:!0}),oe.addEventListener("touchend",Z))},U=()=>{window.removeEventListener("mousemove",G),window.removeEventListener("mouseup",Z),document.onselectstart=S,S=null;const oe=y(_);oe&&(oe.removeEventListener("touchmove",G),oe.removeEventListener("touchend",Z))},ie=oe=>{oe.stopImmediatePropagation(),!(oe.ctrlKey||[1,2].includes(oe.button))&&(E.isDragging=!0,E[I.value.axis]=oe.currentTarget[I.value.offset]-(oe[I.value.client]-oe.currentTarget.getBoundingClientRect()[I.value.direction]),t("start-move"),H())},Z=()=>{E.isDragging=!1,E[I.value.axis]=0,t("stop-move"),U()},G=oe=>{const{isDragging:le}=E;if(!le||!_.value||!g.value)return;const me=E[I.value.axis];if(!me)return;$f(o);const fe=(g.value.getBoundingClientRect()[I.value.direction]-oe[I.value.client])*-1,ce=_.value[I.value.offset]-me,pe=fe-ce;o=_h(()=>{E.traveled=Math.max(e.startGap,Math.min(pe,z.value)),t("scroll",pe,z.value)})},Q=oe=>{const le=Math.abs(oe.target.getBoundingClientRect()[I.value.direction]-oe[I.value.client]),me=_.value[I.value.offset]/2,fe=le-me;E.traveled=Math.max(0,Math.min(fe,z.value)),t("scroll",fe,z.value)};return tn(()=>e.scrollFrom,oe=>{E.isDragging||(E.traveled=Math.ceil(oe*z.value))}),ni(()=>{U()}),()=>lo("div",{role:"presentation",ref:g,class:[s.b(),e.class,(e.alwaysOn||E.isDragging)&&"always-on"],style:F.value,onMousedown:po(Q,["stop","prevent"]),onTouchstartPrevent:ie},lo("div",{ref:_,class:d.e("thumb"),style:$.value,onMousedown:ie},[]))}}),mz=({name:e,getOffset:t,getItemSize:i,getItemOffset:s,getEstimatedTotalSize:d,getStartIndexForOffset:g,getStopIndexForStartIndex:_,initCache:o,clearCache:S,validateProps:E})=>Ze({name:e??"ElVirtualList",props:dz,emits:[Cb,Eb],setup(I,{emit:P,expose:F}){E(I);const B=jo(),$=rn("vl"),z=Se(o(I,B)),H=lz(),U=Se(),ie=Se(),Z=Se(),G=Se({isScrolling:!1,scrollDir:"forward",scrollOffset:ao(I.initScrollOffset)?I.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:I.scrollbarAlwaysOn}),Q=te(()=>{const{total:Oe,cache:Ct}=I,{isScrolling:Mt,scrollDir:zt,scrollOffset:bt}=y(G);if(Oe===0)return[0,0,0,0];const Kt=g(I,bt,y(z)),$t=_(I,Kt,bt,y(z)),Re=!Mt||zt===Mb?Math.max(1,Ct):1,dn=!Mt||zt===tm?Math.max(1,Ct):1;return[Math.max(0,Kt-Re),Math.max(0,Math.min(Oe-1,$t+dn)),Kt,$t]}),oe=te(()=>d(I,y(z))),le=te(()=>b_(I.layout)),me=te(()=>[{position:"relative",[`overflow-${le.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:I.direction,height:ao(I.height)?`${I.height}px`:I.height,width:ao(I.width)?`${I.width}px`:I.width},I.style]),fe=te(()=>{const Oe=y(oe),Ct=y(le);return{height:Ct?"100%":`${Oe}px`,pointerEvents:y(G).isScrolling?"none":void 0,width:Ct?`${Oe}px`:"100%"}}),ce=te(()=>le.value?I.width:I.height),{onWheel:pe}=Ere({atStartEdge:te(()=>G.value.scrollOffset<=0),atEndEdge:te(()=>G.value.scrollOffset>=oe.value),layout:te(()=>I.layout)},Oe=>{var Ct,Mt;(Mt=(Ct=Z.value).onMouseUp)==null||Mt.call(Ct),Ae(Math.min(G.value.scrollOffset+Oe,oe.value-ce.value))});qr(U,"wheel",pe,{passive:!1});const ye=()=>{const{total:Oe}=I;if(Oe>0){const[bt,Kt,$t,Re]=y(Q);P(Cb,bt,Kt,$t,Re)}const{scrollDir:Ct,scrollOffset:Mt,updateRequested:zt}=y(G);P(Eb,Ct,Mt,zt)},De=Oe=>{const{clientHeight:Ct,scrollHeight:Mt,scrollTop:zt}=Oe.currentTarget,bt=y(G);if(bt.scrollOffset===zt)return;const Kt=Math.max(0,Math.min(zt,Mt-Ct));G.value={...bt,isScrolling:!0,scrollDir:Ef(bt.scrollOffset,Kt),scrollOffset:Kt,updateRequested:!1},oo(Ne)},tt=Oe=>{const{clientWidth:Ct,scrollLeft:Mt,scrollWidth:zt}=Oe.currentTarget,bt=y(G);if(bt.scrollOffset===Mt)return;const{direction:Kt}=I;let $t=Mt;if(Kt===hm)switch(Ab()){case y_:{$t=-Mt;break}case YT:{$t=zt-Ct-Mt;break}}$t=Math.max(0,Math.min($t,zt-Ct)),G.value={...bt,isScrolling:!0,scrollDir:Ef(bt.scrollOffset,$t),scrollOffset:$t,updateRequested:!1},oo(Ne)},Me=Oe=>{y(le)?tt(Oe):De(Oe),ye()},xe=(Oe,Ct)=>{const Mt=(oe.value-ce.value)/Ct*Oe;Ae(Math.min(oe.value-ce.value,Mt))},Ae=Oe=>{Oe=Math.max(Oe,0),Oe!==y(G).scrollOffset&&(G.value={...y(G),scrollOffset:Oe,scrollDir:Ef(y(G).scrollOffset,Oe),updateRequested:!0},oo(Ne))},Ce=(Oe,Ct=Xl)=>{const{scrollOffset:Mt}=y(G);Oe=Math.max(0,Math.min(Oe,I.total-1)),Ae(t(I,Oe,Ct,Mt,y(z)))},ge=Oe=>{const{direction:Ct,itemSize:Mt,layout:zt}=I,bt=H.value(S&&Mt,S&&zt,S&&Ct);let Kt;if(Tr(bt,String(Oe)))Kt=bt[Oe];else{const $t=s(I,Oe,y(z)),Re=i(I,Oe,y(z)),dn=y(le),At=Ct===hm,Ke=dn?$t:0;bt[Oe]=Kt={position:"absolute",left:At?void 0:`${Ke}px`,right:At?`${Ke}px`:void 0,top:dn?0:`${$t}px`,height:dn?"100%":`${Re}px`,width:dn?`${Re}px`:"100%"}}return Kt},Ne=()=>{G.value.isScrolling=!1,oo(()=>{H.value(-1,null,null)})},We=()=>{const Oe=U.value;Oe&&(Oe.scrollTop=0)};No(()=>{if(!gr)return;const{initScrollOffset:Oe}=I,Ct=y(U);ao(Oe)&&Ct&&(y(le)?Ct.scrollLeft=Oe:Ct.scrollTop=Oe),ye()}),Au(()=>{const{direction:Oe,layout:Ct}=I,{scrollOffset:Mt,updateRequested:zt}=y(G),bt=y(U);if(zt&&bt)if(Ct===Im)if(Oe===hm)switch(Ab()){case y_:{bt.scrollLeft=-Mt;break}case ZT:{bt.scrollLeft=Mt;break}default:{const{clientWidth:Kt,scrollWidth:$t}=bt;bt.scrollLeft=$t-Kt-Mt;break}}else bt.scrollLeft=Mt;else bt.scrollTop=Mt}),kS(()=>{y(U).scrollTop=y(G).scrollOffset});const ot={ns:$,clientSize:ce,estimatedTotalSize:oe,windowStyle:me,windowRef:U,innerRef:ie,innerStyle:fe,itemsToRender:Q,scrollbarRef:Z,states:G,getItemStyle:ge,onScroll:Me,onScrollbarScroll:xe,onWheel:pe,scrollTo:Ae,scrollToItem:Ce,resetScrollTop:We};return F({windowRef:U,innerRef:ie,getItemStyleCache:H,scrollTo:Ae,scrollToItem:Ce,resetScrollTop:We,states:G}),ot},render(I){var P;const{$slots:F,className:B,clientSize:$,containerElement:z,data:H,getItemStyle:U,innerElement:ie,itemsToRender:Z,innerStyle:G,layout:Q,total:oe,onScroll:le,onScrollbarScroll:me,states:fe,useIsScrolling:ce,windowStyle:pe,ns:ye}=I,[De,tt]=Z,Me=Wo(z),xe=Wo(ie),Ae=[];if(oe>0)for(let We=De;We<=tt;We++)Ae.push(lo(eo,{key:We},(P=F.default)==null?void 0:P.call(F,{data:H,index:We,isScrolling:ce?fe.isScrolling:void 0,style:U(We)})));const Ce=[lo(xe,{style:G,ref:"innerRef"},Zn(xe)?Ae:{default:()=>Ae})],ge=lo(H2,{ref:"scrollbarRef",clientSize:$,layout:Q,onScroll:me,ratio:$*100/this.estimatedTotalSize,scrollFrom:fe.scrollOffset/(this.estimatedTotalSize-$),total:oe}),Ne=lo(Me,{class:[ye.e("window"),B],style:pe,onScroll:le,ref:"windowRef",key:0},Zn(Me)?[Ce]:{default:()=>[Ce]});return lo("div",{key:0,class:[ye.e("wrapper"),fe.scrollbarAlwaysOn?"always-on":""]},[Ne,ge])}}),gz=mz({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:i,layout:s,width:d},g,_,o)=>{const S=b_(s)?d:e,E=Math.max(0,t*i-S),I=Math.min(E,g*i),P=Math.max(0,(g+1)*i-S);switch(_===b1&&(o>=P-S&&o<=I+S?_=Xl:_=xu),_){case v_:return I;case __:return P;case xu:{const F=Math.round(P+(I-P)/2);return F<Math.ceil(S/2)?0:F>E+Math.floor(S/2)?E:F}case Xl:default:return o>=P&&o<=I?o:o<P?P:I}},getStartIndexForOffset:({total:e,itemSize:t},i)=>Math.max(0,Math.min(e-1,Math.floor(i/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:i,layout:s,width:d},g,_)=>{const o=g*i,S=b_(s)?d:e,E=Math.ceil((S+_-o)/i);return Math.max(0,Math.min(t-1,g+E-1))},initCache(){},clearCache:!0,validateProps(){}}),nm=(e,t,i)=>{const{itemSize:s}=e,{items:d,lastVisitedIndex:g}=i;if(t>g){let _=0;if(g>=0){const o=d[g];_=o.offset+o.size}for(let o=g+1;o<=t;o++){const S=s(o);d[o]={offset:_,size:S},_+=S}i.lastVisitedIndex=t}return d[t]},Are=(e,t,i)=>{const{items:s,lastVisitedIndex:d}=t;return(d>0?s[d].offset:0)>=i?vz(e,t,0,d,i):kre(e,t,Math.max(0,d),i)},vz=(e,t,i,s,d)=>{for(;i<=s;){const g=i+Math.floor((s-i)/2),_=nm(e,g,t).offset;if(_===d)return g;_<d?i=g+1:_>d&&(s=g-1)}return Math.max(0,i-1)},kre=(e,t,i,s)=>{const{total:d}=e;let g=1;for(;i<d&&nm(e,i,t).offset<s;)i+=g,g*=2;return vz(e,t,Math.floor(i/2),Math.min(i,d-1),s)},MP=({total:e},{items:t,estimatedItemSize:i,lastVisitedIndex:s})=>{let d=0;if(s>=e&&(s=e-1),s>=0){const o=t[s];d=o.offset+o.size}const _=(e-s-1)*i;return d+_},Pre=mz({name:"ElDynamicSizeList",getItemOffset:(e,t,i)=>nm(e,t,i).offset,getItemSize:(e,t,{items:i})=>i[t].size,getEstimatedTotalSize:MP,getOffset:(e,t,i,s,d)=>{const{height:g,layout:_,width:o}=e,S=b_(_)?o:g,E=nm(e,t,d),I=MP(e,d),P=Math.max(0,Math.min(I-S,E.offset)),F=Math.max(0,E.offset-S+E.size);switch(i===b1&&(s>=F-S&&s<=P+S?i=Xl:i=xu),i){case v_:return P;case __:return F;case xu:return Math.round(F+(P-F)/2);case Xl:default:return s>=F&&s<=P?s:s<F?F:P}},getStartIndexForOffset:(e,t,i)=>Are(e,i,t),getStopIndexForStartIndex:(e,t,i,s)=>{const{height:d,total:g,layout:_,width:o}=e,S=b_(_)?o:d,E=nm(e,t,s),I=i+S;let P=E.offset+E.size,F=t;for(;F<g-1&&P<I;)F++,P+=nm(e,F,s).size;return F},initCache({estimatedItemSize:e=B2},t){const i={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return i.clearCacheAfterIndex=(s,d=!0)=>{var g,_;i.lastVisitedIndex=Math.min(i.lastVisitedIndex,s-1),(g=t.exposed)==null||g.getItemStyleCache(-1),d&&((_=t.proxy)==null||_.$forceUpdate())},i},clearCache:!1,validateProps:({itemSize:e})=>{}}),Rre={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var Ore=Ze({name:"ElSelectDropdown",props:Rre,setup(e,{slots:t,expose:i}){const s=Un(qT),d=rn("select"),{getLabel:g,getValue:_,getDisabled:o}=y1(s.props),S=Se([]),E=Se(),I=te(()=>e.data.length);tn(()=>I.value,()=>{var pe,ye;(ye=(pe=s.tooltipRef.value).updatePopper)==null||ye.call(pe)});const P=te(()=>Hr(s.props.estimatedOptionHeight)),F=te(()=>P.value?{itemSize:s.props.itemHeight}:{estimatedSize:s.props.estimatedOptionHeight,itemSize:pe=>S.value[pe]}),B=(pe=[],ye)=>{const{props:{valueKey:De}}=s;return Vo(ye)?pe&&pe.some(tt=>ei(Ji(tt,De))===Ji(ye,De)):pe.includes(ye)},$=(pe,ye)=>{if(Vo(ye)){const{valueKey:De}=s.props;return Ji(pe,De)===Ji(ye,De)}else return pe===ye},z=(pe,ye)=>s.props.multiple?B(pe,_(ye)):$(pe,_(ye)),H=(pe,ye)=>{const{disabled:De,multiple:tt,multipleLimit:Me}=s.props;return De||!ye&&(tt?Me>0&&pe.length>=Me:!1)},U=pe=>e.hoveringIndex===pe;i({listRef:E,isSized:P,isItemDisabled:H,isItemHovering:U,isItemSelected:z,scrollToItem:pe=>{const ye=E.value;ye&&ye.scrollToItem(pe)},resetScrollTop:()=>{const pe=E.value;pe&&pe.resetScrollTop()}});const Q=pe=>{const{index:ye,data:De,style:tt}=pe,Me=y(P),{itemSize:xe,estimatedSize:Ae}=y(F),{modelValue:Ce}=s.props,{onSelect:ge,onHover:Ne}=s,We=De[ye];if(We.type==="Group")return Qe(ure,{item:We,style:tt,height:Me?xe:Ae},null);const ot=z(Ce,We),Oe=H(Ce,ot),Ct=U(ye);return Qe(_re,Yo(pe,{selected:ot,disabled:o(We)||Oe,created:!!We.created,hovering:Ct,item:We,onSelect:ge,onHover:Ne}),{default:Mt=>{var zt;return((zt=t.default)==null?void 0:zt.call(t,Mt))||Qe("span",null,[g(We)])}})},{onKeyboardNavigate:oe,onKeyboardSelect:le}=s,me=()=>{oe("forward")},fe=()=>{oe("backward")},ce=pe=>{const{code:ye}=pe,{tab:De,esc:tt,down:Me,up:xe,enter:Ae,numpadEnter:Ce}=On;switch(ye!==De&&(pe.preventDefault(),pe.stopPropagation()),ye){case De:case tt:break;case Me:me();break;case xe:fe();break;case Ae:case Ce:le();break}};return()=>{var pe,ye,De,tt;const{data:Me,width:xe}=e,{height:Ae,multiple:Ce,scrollbarAlwaysOn:ge}=s.props,Ne=y(P)?gz:Pre;return Qe("div",{class:[d.b("dropdown"),d.is("multiple",Ce)],style:{width:`${xe}px`}},[(pe=t.header)==null?void 0:pe.call(t),((ye=t.loading)==null?void 0:ye.call(t))||((De=t.empty)==null?void 0:De.call(t))||Qe(Ne,Yo({ref:E},y(F),{className:d.be("dropdown","list"),scrollbarAlwaysOn:ge,data:Me,height:Ae,width:xe,total:Me.length,onKeydown:ce}),{default:We=>Qe(Q,We,null)}),(tt=t.footer)==null?void 0:tt.call(t)])}}});function Lre(e,t){const{aliasProps:i,getLabel:s,getValue:d}=y1(e),g=Se(0),_=Se(),o=te(()=>e.allowCreate&&e.filterable);function S(B){const $=z=>s(z)===B;return e.options&&e.options.some($)||t.createdOptions.some($)}function E(B){o.value&&(e.multiple&&B.created?g.value++:_.value=B)}function I(B){if(o.value)if(B&&B.length>0){if(S(B))return;const $={[i.value.value]:B,[i.value.label]:B,created:!0,[i.value.disabled]:!1};t.createdOptions.length>=g.value?t.createdOptions[g.value]=$:t.createdOptions.push($)}else if(e.multiple)t.createdOptions.length=g.value;else{const $=_.value;t.createdOptions.length=0,$&&$.created&&t.createdOptions.push($)}}function P(B){if(!o.value||!B||!B.created||B.created&&e.reserveKeyword&&t.inputValue===s(B))return;const $=t.createdOptions.findIndex(z=>d(z)===d(B));~$&&(t.createdOptions.splice($,1),g.value--)}function F(){o.value&&(t.createdOptions.length=0,g.value=0)}return{createNewOption:I,removeNewOption:P,selectNewOption:E,clearAllNewOption:F}}const Dre=11,zre=(e,t)=>{const{t:i}=vr(),s=rn("select"),d=rn("input"),{form:g,formItem:_}=Ka(),{inputId:o}=ic(e,{formItemContext:_}),{aliasProps:S,getLabel:E,getValue:I,getDisabled:P,getOptions:F}=y1(e),{valueOnClear:B,isEmptyValue:$}=a1(e),z=Pr({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),H=Se(-1),U=Se(),ie=Se(),Z=Se(),G=Se(),Q=Se(),oe=Se(),le=Se(),me=Se(),fe=Se(),ce=Se(),pe=Se(),{isComposing:ye,handleCompositionStart:De,handleCompositionEnd:tt,handleCompositionUpdate:Me}=F_({afterComposition:cn=>co(cn)}),{wrapperRef:xe,isFocused:Ae,handleBlur:Ce}=Ah(Q,{beforeFocus(){return ot.value},afterFocus(){e.automaticDropdown&&!We.value&&(We.value=!0,z.menuVisibleOnFocus=!0)},beforeBlur(cn){var Yn,To;return((Yn=Z.value)==null?void 0:Yn.isFocusInsideContent(cn))||((To=G.value)==null?void 0:To.isFocusInsideContent(cn))},afterBlur(){We.value=!1,z.menuVisibleOnFocus=!1}}),ge=Se([]),Ne=Se([]),We=Se(!1),ot=te(()=>e.disabled||(g==null?void 0:g.disabled)),Oe=te(()=>{var cn;return(cn=g==null?void 0:g.statusIcon)!=null?cn:!1}),Ct=te(()=>{const cn=Ne.value.length*e.itemHeight;return cn>e.height?e.height:cn}),Mt=te(()=>e.multiple?fn(e.modelValue)&&e.modelValue.length>0:!$(e.modelValue)),zt=te(()=>e.clearable&&!ot.value&&z.inputHovering&&Mt.value),bt=te(()=>e.remote&&e.filterable?"":cd),Kt=te(()=>bt.value&&s.is("reverse",We.value)),$t=te(()=>(_==null?void 0:_.validateState)||""),Re=te(()=>{if($t.value)return u1[$t.value]}),dn=te(()=>e.remote?300:0),At=te(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!z.inputValue&&ge.value.length===0?!1:e.filterable&&z.inputValue&&ge.value.length>0&&Ne.value.length===0?e.noMatchText||i("el.select.noMatch"):ge.value.length===0?e.noDataText||i("el.select.noData"):null),Ke=cn=>{const Yn=To=>{if(e.filterable&&Qn(e.filterMethod)||e.filterable&&e.remote&&Qn(e.remoteMethod))return!0;const $o=new RegExp(IT(cn),"i");return cn?$o.test(E(To)||""):!0};return e.loading?[]:[...z.createdOptions,...e.options].reduce((To,$o)=>{const Ir=F($o);if(fn(Ir)){const yr=Ir.filter(Yn);yr.length>0&&To.push({label:E($o),type:"Group"},...yr)}else(e.remote||Yn($o))&&To.push($o);return To},[])},Be=()=>{ge.value=Ke(""),Ne.value=Ke(z.inputValue)},Ht=te(()=>{const cn=new Map;return ge.value.forEach((Yn,To)=>{cn.set(Xo(I(Yn)),{option:Yn,index:To})}),cn}),Ut=te(()=>{const cn=new Map;return Ne.value.forEach((Yn,To)=>{cn.set(Xo(I(Yn)),{option:Yn,index:To})}),cn}),Nt=te(()=>Ne.value.every(cn=>P(cn))),Et=na(),Gt=te(()=>Et.value==="small"?"small":"default"),ln=()=>{var cn;H.value=((cn=U.value)==null?void 0:cn.offsetWidth)||200},yn=()=>{if(!ie.value)return 0;const cn=window.getComputedStyle(ie.value);return Number.parseFloat(cn.gap||"6px")},_n=te(()=>{const cn=yn();return{maxWidth:`${pe.value&&e.maxCollapseTags===1?z.selectionWidth-z.collapseItemWidth-cn:z.selectionWidth}px`}}),jn=te(()=>({maxWidth:`${z.selectionWidth}px`})),yt=te(()=>({width:`${Math.max(z.calculatorWidth,Dre)}px`})),kn=te(()=>fn(e.modelValue)?e.modelValue.length===0&&!z.inputValue:e.filterable?!z.inputValue:!0),qn=te(()=>{var cn;const Yn=(cn=e.placeholder)!=null?cn:i("el.select.placeholder");return e.multiple||!Mt.value?Yn:z.selectedLabel}),Co=te(()=>{var cn,Yn;return(Yn=(cn=Z.value)==null?void 0:cn.popperRef)==null?void 0:Yn.contentRef}),mo=te(()=>{if(e.multiple){const cn=e.modelValue.length;if(e.modelValue.length>0&&Ut.value.has(e.modelValue[cn-1])){const{index:Yn}=Ut.value.get(e.modelValue[cn-1]);return Yn}}else if(e.modelValue&&Ut.value.has(e.modelValue)){const{index:cn}=Ut.value.get(e.modelValue);return cn}return-1}),Io=te({get(){return We.value&&At.value!==!1},set(cn){We.value=cn}}),Ho=te(()=>e.multiple?e.collapseTags?z.cachedOptions.slice(0,e.maxCollapseTags):z.cachedOptions:[]),ur=te(()=>e.multiple?e.collapseTags?z.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:Dt,removeNewOption:En,selectNewOption:ft,clearAllNewOption:un}=Lre(e,z),Je=()=>{ot.value||(z.menuVisibleOnFocus?z.menuVisibleOnFocus=!1:We.value=!We.value)},Mn=()=>{z.inputValue.length>0&&!We.value&&(We.value=!0),Dt(z.inputValue),Oo(z.inputValue)},Bn=ol(Mn,dn.value),Oo=cn=>{z.previousQuery===cn||ye.value||(z.previousQuery=cn,e.filterable&&Qn(e.filterMethod)?e.filterMethod(cn):e.filterable&&e.remote&&Qn(e.remoteMethod)&&e.remoteMethod(cn),e.defaultFirstOption&&(e.filterable||e.remote)&&Ne.value.length?oo(Rr):oo(ho))},Rr=()=>{const cn=Ne.value.filter($o=>!$o.disabled&&$o.type!=="Group"),Yn=cn.find($o=>$o.created),To=cn[0];z.hoveringIndex=Nr(Ne.value,Yn||To)},hi=cn=>{Oa(e.modelValue,cn)||t(Yr,cn)},Er=cn=>{t(Fo,cn),hi(cn),z.previousValue=e.multiple?String(cn):cn},Nr=(cn=[],Yn)=>{if(!Vo(Yn))return cn.indexOf(Yn);const To=e.valueKey;let $o=-1;return cn.some((Ir,yr)=>Ji(Ir,To)===Ji(Yn,To)?($o=yr,!0):!1),$o},Xo=cn=>Vo(cn)?Ji(cn,e.valueKey):cn,Bi=()=>{ln()},Bs=()=>{z.selectionWidth=ie.value.getBoundingClientRect().width},Zt=()=>{z.calculatorWidth=oe.value.getBoundingClientRect().width},Ee=()=>{z.collapseItemWidth=pe.value.getBoundingClientRect().width},ke=()=>{var cn,Yn;(Yn=(cn=Z.value)==null?void 0:cn.updatePopper)==null||Yn.call(cn)},qe=()=>{var cn,Yn;(Yn=(cn=G.value)==null?void 0:cn.updatePopper)==null||Yn.call(cn)},mt=cn=>{if(e.multiple){let Yn=e.modelValue.slice();const To=Nr(Yn,I(cn));To>-1?(Yn=[...Yn.slice(0,To),...Yn.slice(To+1)],z.cachedOptions.splice(To,1),En(cn)):(e.multipleLimit<=0||Yn.length<e.multipleLimit)&&(Yn=[...Yn,I(cn)],z.cachedOptions.push(cn),ft(cn)),Er(Yn),cn.created&&Oo(""),e.filterable&&!e.reserveKeyword&&(z.inputValue="")}else z.selectedLabel=E(cn),Er(I(cn)),We.value=!1,ft(cn),cn.created||un();xt()},it=(cn,Yn)=>{let To=e.modelValue.slice();const $o=Nr(To,I(Yn));$o>-1&&!ot.value&&(To=[...e.modelValue.slice(0,$o),...e.modelValue.slice($o+1)],z.cachedOptions.splice($o,1),Er(To),t("remove-tag",I(Yn)),En(Yn)),cn.stopPropagation(),xt()},xt=()=>{var cn;(cn=Q.value)==null||cn.focus()},qt=()=>{var cn;if(We.value){We.value=!1,oo(()=>{var Yn;return(Yn=Q.value)==null?void 0:Yn.blur()});return}(cn=Q.value)==null||cn.blur()},kt=()=>{z.inputValue.length>0?z.inputValue="":We.value=!1},Wt=cn=>AO(cn,Yn=>!z.cachedOptions.some(To=>I(To)===Yn&&P(To))),Qt=cn=>{if(e.multiple&&cn.code!==On.delete&&z.inputValue.length===0){cn.preventDefault();const Yn=e.modelValue.slice(),To=Wt(Yn);if(To<0)return;const $o=Yn[To];Yn.splice(To,1);const Ir=z.cachedOptions[To];z.cachedOptions.splice(To,1),En(Ir),Er(Yn),t("remove-tag",$o)}},nn=()=>{let cn;fn(e.modelValue)?cn=[]:cn=B.value,e.multiple?z.cachedOptions=[]:z.selectedLabel="",We.value=!1,Er(cn),t("clear"),un(),xt()},gt=(cn,Yn=void 0)=>{const To=Ne.value;if(!["forward","backward"].includes(cn)||ot.value||To.length<=0||Nt.value||ye.value)return;if(!We.value)return Je();Yn===void 0&&(Yn=z.hoveringIndex);let $o=-1;cn==="forward"?($o=Yn+1,$o>=To.length&&($o=0)):cn==="backward"&&($o=Yn-1,($o<0||$o>=To.length)&&($o=To.length-1));const Ir=To[$o];if(P(Ir)||Ir.type==="Group")return gt(cn,$o);z.hoveringIndex=$o,cr($o)},Yt=()=>{if(We.value)~z.hoveringIndex&&Ne.value[z.hoveringIndex]&&mt(Ne.value[z.hoveringIndex]);else return Je()},In=cn=>{z.hoveringIndex=cn??-1},ho=()=>{e.multiple?z.hoveringIndex=Ne.value.findIndex(cn=>e.modelValue.some(Yn=>Xo(Yn)===Xo(cn))):z.hoveringIndex=Ne.value.findIndex(cn=>Xo(cn)===Xo(e.modelValue))},co=cn=>{if(z.inputValue=cn.target.value,e.remote)Bn();else return Mn()},Lo=cn=>{if(We.value=!1,Ae.value){const Yn=new FocusEvent("focus",cn);Ce(Yn)}},Eo=()=>(z.isBeforeHide=!1,oo(()=>{~mo.value&&cr(z.hoveringIndex)})),cr=cn=>{fe.value.scrollToItem(cn)},rr=(cn,Yn)=>{const To=Xo(cn);if(Ht.value.has(To)){const{option:$o}=Ht.value.get(To);return $o}if(Yn&&Yn.length){const $o=Yn.find(Ir=>Xo(I(Ir))===To);if($o)return $o}return{[S.value.value]:cn,[S.value.label]:cn}},qo=(cn=!1)=>{if(e.multiple)if(e.modelValue.length>0){const Yn=z.cachedOptions.slice();z.cachedOptions.length=0,z.previousValue=e.modelValue.toString();for(const To of e.modelValue){const $o=rr(To,Yn);z.cachedOptions.push($o)}}else z.cachedOptions=[],z.previousValue=void 0;else if(Mt.value){z.previousValue=e.modelValue;const Yn=Ne.value,To=Yn.findIndex($o=>Xo(I($o))===Xo(e.modelValue));~To?z.selectedLabel=E(Yn[To]):(!z.selectedLabel||cn)&&(z.selectedLabel=Xo(e.modelValue))}else z.selectedLabel="",z.previousValue=void 0;un(),ln()};return tn(We,cn=>{cn?Oo(""):(z.inputValue="",z.previousQuery=null,z.isBeforeHide=!0,Dt("")),t("visible-change",cn)}),tn(()=>e.modelValue,(cn,Yn)=>{var To;(!cn||fn(cn)&&cn.length===0||e.multiple&&!Oa(cn.toString(),z.previousValue)||!e.multiple&&Xo(cn)!==Xo(z.previousValue))&&qo(!0),!Oa(cn,Yn)&&e.validateEvent&&((To=_==null?void 0:_.validate)==null||To.call(_,"change").catch(Ir=>void 0))},{deep:!0}),tn(()=>e.options,()=>{const cn=Q.value;(!cn||cn&&document.activeElement!==cn)&&qo()},{deep:!0,flush:"post"}),tn(()=>Ne.value,()=>fe.value&&oo(fe.value.resetScrollTop)),Ha(()=>{z.isBeforeHide||Be()}),Ha(()=>{const{valueKey:cn,options:Yn}=e,To=new Map;for(const $o of Yn){const Ir=I($o);let yr=Ir;if(Vo(yr)&&(yr=Ji(Ir,cn)),To.get(yr))break;To.set(yr,!0)}}),No(()=>{qo()}),Mi(U,Bi),Mi(ie,Bs),Mi(oe,Zt),Mi(fe,ke),Mi(xe,ke),Mi(ce,qe),Mi(pe,Ee),{inputId:o,collapseTagSize:Gt,currentPlaceholder:qn,expanded:We,emptyText:At,popupHeight:Ct,debounce:dn,allOptions:ge,filteredOptions:Ne,iconComponent:bt,iconReverse:Kt,tagStyle:_n,collapseTagStyle:jn,inputStyle:yt,popperSize:H,dropdownMenuVisible:Io,hasModelValue:Mt,shouldShowPlaceholder:kn,selectDisabled:ot,selectSize:Et,needStatusIcon:Oe,showClearBtn:zt,states:z,isFocused:Ae,nsSelect:s,nsInput:d,calculatorRef:oe,inputRef:Q,menuRef:fe,tagMenuRef:ce,tooltipRef:Z,tagTooltipRef:G,selectRef:U,wrapperRef:xe,selectionRef:ie,prefixRef:le,suffixRef:me,collapseItemRef:pe,popperRef:Co,validateState:$t,validateIcon:Re,showTagList:Ho,collapseTagList:ur,debouncedOnInputChange:Bn,deleteTag:it,getLabel:E,getValue:I,getDisabled:P,getValueKey:Xo,handleClear:nn,handleClickOutside:Lo,handleDel:Qt,handleEsc:kt,focus:xt,blur:qt,handleMenuEnter:Eo,handleResize:Bi,resetSelectionWidth:Bs,resetCalculatorWidth:Zt,updateTooltip:ke,updateTagTooltip:qe,updateOptions:Be,toggleMenu:Je,scrollTo:cr,onInput:co,onKeyboardNavigate:gt,onKeyboardSelect:Yt,onSelect:mt,onHover:In,handleCompositionStart:De,handleCompositionEnd:tt,handleCompositionUpdate:Me}},Fre=Ze({name:"ElSelectV2",components:{ElSelectMenu:Ore,ElTag:Em,ElTooltip:qa,ElIcon:Gn},directives:{ClickOutside:rd},props:hre,emits:pre,setup(e,{emit:t}){const i=te(()=>{const{modelValue:g,multiple:_}=e,o=_?[]:void 0;return fn(g)?_?g:o:_?o:g}),s=zre(Pr({...Ca(e),modelValue:i}),t);or(qT,{props:Pr({...Ca(e),height:s.popupHeight,modelValue:i}),expanded:s.expanded,tooltipRef:s.tooltipRef,onSelect:s.onSelect,onHover:s.onHover,onKeyboardNavigate:s.onKeyboardNavigate,onKeyboardSelect:s.onKeyboardSelect});const d=te(()=>e.multiple?s.states.cachedOptions.map(g=>g.label):s.states.selectedLabel);return{...s,modelValue:i,selectedLabel:d}}});function Bre(e,t,i,s,d,g){const _=Go("el-tag"),o=Go("el-tooltip"),S=Go("el-icon"),E=Go("el-select-menu"),I=Kb("click-outside");return zo((se(),Pe("div",{ref:"selectRef",class:de([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:P=>e.states.inputHovering=!0,onMouseleave:P=>e.states.inputHovering=!1},[Qe(o,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:P=>e.states.isBeforeHide=!1},{default:at(()=>[He("div",{ref:"wrapperRef",class:de([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:po(e.toggleMenu,["prevent"])},[e.$slots.prefix?(se(),Pe("div",{key:0,ref:"prefixRef",class:de(e.nsSelect.e("prefix"))},[_t(e.$slots,"prefix")],2)):St("v-if",!0),He("div",{ref:"selectionRef",class:de([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?_t(e.$slots,"tag",{key:0},()=>[(se(!0),Pe(eo,null,tr(e.showTagList,P=>(se(),Pe("div",{key:e.getValueKey(e.getValue(P)),class:de(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!e.selectDisabled&&!e.getDisabled(P),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:to(e.tagStyle),onClose:F=>e.deleteTag(F,P)},{default:at(()=>[He("span",{class:de(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:e.getLabel(P),value:e.getValue(P)},()=>[nr(wn(e.getLabel(P)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(se(),Rt(o,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:at(()=>[He("div",{ref:"collapseItemRef",class:de(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:to(e.collapseTagStyle),"disable-transitions":""},{default:at(()=>[He("span",{class:de(e.nsSelect.e("tags-text"))}," + "+wn(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:at(()=>[He("div",{ref:"tagMenuRef",class:de(e.nsSelect.e("selection"))},[(se(!0),Pe(eo,null,tr(e.collapseTagList,P=>(se(),Pe("div",{key:e.getValueKey(e.getValue(P)),class:de(e.nsSelect.e("selected-item"))},[Qe(_,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(P),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:F=>e.deleteTag(F,P)},{default:at(()=>[He("span",{class:de(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:e.getLabel(P),value:e.getValue(P)},()=>[nr(wn(e.getLabel(P)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):St("v-if",!0)]):St("v-if",!0),He("div",{class:de([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[zo(He("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":P=>e.states.inputValue=P,style:to(e.inputStyle),autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:de([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[ti(po(P=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),ti(po(P=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),ti(po(e.onKeyboardSelect,["stop","prevent"]),["enter"]),ti(po(e.handleEsc,["stop","prevent"]),["esc"]),ti(po(e.handleDel,["stop"]),["delete"])],onClick:po(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","tabindex","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[Xb,e.states.inputValue]]),e.filterable?(se(),Pe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:de(e.nsSelect.e("input-calculator")),textContent:wn(e.states.inputValue)},null,10,["textContent"])):St("v-if",!0)],2),e.shouldShowPlaceholder?(se(),Pe("div",{key:1,class:de([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?_t(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[He("span",null,wn(e.currentPlaceholder),1)]):(se(),Pe("span",{key:1},wn(e.currentPlaceholder),1))],2)):St("v-if",!0)],2),He("div",{ref:"suffixRef",class:de(e.nsSelect.e("suffix"))},[e.iconComponent?zo((se(),Rt(S,{key:0,class:de([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:at(()=>[(se(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])),[[Cr,!e.showClearBtn]]):St("v-if",!0),e.showClearBtn&&e.clearIcon?(se(),Rt(S,{key:1,class:de([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:po(e.handleClear,["prevent","stop"])},{default:at(()=>[(se(),Rt(Wo(e.clearIcon)))]),_:1},8,["class","onClick"])):St("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(se(),Rt(S,{key:2,class:de([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:at(()=>[(se(),Rt(Wo(e.validateIcon)))]),_:1},8,["class"])):St("v-if",!0)],2)],10,["onClick"])]),content:at(()=>[Qe(E,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},ec({default:at(P=>[_t(e.$slots,"default",Vc(mh(P)))]),_:2},[e.$slots.header?{name:"header",fn:at(()=>[He("div",{class:de(e.nsSelect.be("dropdown","header"))},[_t(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:at(()=>[He("div",{class:de(e.nsSelect.be("dropdown","loading"))},[_t(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:at(()=>[He("div",{class:de(e.nsSelect.be("dropdown","empty"))},[_t(e.$slots,"empty",{},()=>[He("span",null,wn(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:at(()=>[He("div",{class:de(e.nsSelect.be("dropdown","footer"))},[_t(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[I,e.handleClickOutside,e.popperRef]])}var Nre=bn(Fre,[["render",Bre],["__file","select.vue"]]);const $re=Ao(Nre),Vre=vn({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:ut([Number,Object])}}),Ure=vn({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),jre=Ze({name:"ElSkeletonItem"}),Hre=Ze({...jre,props:Ure,setup(e){const t=rn("skeleton");return(i,s)=>(se(),Pe("div",{class:de([y(t).e("item"),y(t).e(i.variant)])},[i.variant==="image"?(se(),Rt(y(pW),{key:0})):St("v-if",!0)],2))}});var kb=bn(Hre,[["__file","skeleton-item.vue"]]);const Gre=(e,t=0)=>{if(t===0)return e;const i=Vo(t)&&!!t.initVal,s=Se(i);let d=null;const g=o=>{if(Hr(o)){s.value=e.value;return}d&&clearTimeout(d),d=setTimeout(()=>{s.value=e.value},o)},_=o=>{o==="leading"?ao(t)?g(t):g(t.leading):Vo(t)?g(t.trailing):s.value=!1};return No(()=>_("leading")),tn(()=>e.value,o=>{_(o?"leading":"trailing")}),s},Wre=Ze({name:"ElSkeleton"}),qre=Ze({...Wre,props:Vre,setup(e,{expose:t}){const i=e,s=rn("skeleton"),d=Gre(Vr(i,"loading"),i.throttle);return t({uiLoading:d}),(g,_)=>y(d)?(se(),Pe("div",Yo({key:0,class:[y(s).b(),y(s).is("animated",g.animated)]},g.$attrs),[(se(!0),Pe(eo,null,tr(g.count,o=>(se(),Pe(eo,{key:o},[y(d)?_t(g.$slots,"template",{key:o},()=>[Qe(kb,{class:de(y(s).is("first")),variant:"p"},null,8,["class"]),(se(!0),Pe(eo,null,tr(g.rows,S=>(se(),Rt(kb,{key:S,class:de([y(s).e("paragraph"),y(s).is("last",S===g.rows&&g.rows>1)]),variant:"p"},null,8,["class"]))),128))]):St("v-if",!0)],64))),128))],16)):_t(g.$slots,"default",Vc(Yo({key:1},g.$attrs)))}});var Kre=bn(qre,[["__file","skeleton.vue"]]);const Zre=Ao(Kre,{SkeletonItem:kb}),Yre=Oi(kb),_z=Symbol("sliderContextKey"),Xre=vn({modelValue:{type:ut([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:ia,inputSize:ia,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:ut(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:ut(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:dd,default:"top"},marks:{type:ut(Object)},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),Fw=e=>ao(e)||fn(e)&&e.every(ao),Jre={[Fo]:Fw,[Ga]:Fw,[Yr]:Fw},Qre=vn({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:dd,default:"top"}}),eie={[Fo]:e=>ao(e)},tie=(e,t,i)=>{const s=Se(),d=Se(!1),g=te(()=>t.value instanceof Function),_=te(()=>g.value&&t.value(e.modelValue)||e.modelValue),o=ol(()=>{i.value&&(d.value=!0)},50),S=ol(()=>{i.value&&(d.value=!1)},50);return{tooltip:s,tooltipVisible:d,formatValue:_,displayTooltip:o,hideTooltip:S}},nie=(e,t,i)=>{const{disabled:s,min:d,max:g,step:_,showTooltip:o,precision:S,sliderSize:E,formatTooltip:I,emitChange:P,resetSize:F,updateDragging:B}=Un(_z),{tooltip:$,tooltipVisible:z,formatValue:H,displayTooltip:U,hideTooltip:ie}=tie(e,I,o),Z=Se(),G=te(()=>`${(e.modelValue-d.value)/(g.value-d.value)*100}%`),Q=te(()=>e.vertical?{bottom:G.value}:{left:G.value}),oe=()=>{t.hovering=!0,U()},le=()=>{t.hovering=!1,t.dragging||ie()},me=ot=>{s.value||(ot.preventDefault(),Ce(ot),window.addEventListener("mousemove",ge),window.addEventListener("touchmove",ge),window.addEventListener("mouseup",Ne),window.addEventListener("touchend",Ne),window.addEventListener("contextmenu",Ne),Z.value.focus())},fe=ot=>{s.value||(t.newPosition=Number.parseFloat(G.value)+ot/(g.value-d.value)*100,We(t.newPosition),P())},ce=()=>{fe(-_.value)},pe=()=>{fe(_.value)},ye=()=>{fe(-_.value*4)},De=()=>{fe(_.value*4)},tt=()=>{s.value||(We(0),P())},Me=()=>{s.value||(We(100),P())},xe=ot=>{let Oe=!0;switch(ot.code){case On.left:case On.down:ce();break;case On.right:case On.up:pe();break;case On.home:tt();break;case On.end:Me();break;case On.pageDown:ye();break;case On.pageUp:De();break;default:Oe=!1;break}Oe&&ot.preventDefault()},Ae=ot=>{let Oe,Ct;return ot.type.startsWith("touch")?(Ct=ot.touches[0].clientY,Oe=ot.touches[0].clientX):(Ct=ot.clientY,Oe=ot.clientX),{clientX:Oe,clientY:Ct}},Ce=ot=>{t.dragging=!0,t.isClick=!0;const{clientX:Oe,clientY:Ct}=Ae(ot);e.vertical?t.startY=Ct:t.startX=Oe,t.startPosition=Number.parseFloat(G.value),t.newPosition=t.startPosition},ge=ot=>{if(t.dragging){t.isClick=!1,U(),F();let Oe;const{clientX:Ct,clientY:Mt}=Ae(ot);e.vertical?(t.currentY=Mt,Oe=(t.startY-t.currentY)/E.value*100):(t.currentX=Ct,Oe=(t.currentX-t.startX)/E.value*100),t.newPosition=t.startPosition+Oe,We(t.newPosition)}},Ne=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||ie(),t.isClick||We(t.newPosition),P()},0),window.removeEventListener("mousemove",ge),window.removeEventListener("touchmove",ge),window.removeEventListener("mouseup",Ne),window.removeEventListener("touchend",Ne),window.removeEventListener("contextmenu",Ne))},We=async ot=>{if(ot===null||Number.isNaN(+ot))return;ot<0?ot=0:ot>100&&(ot=100);const Oe=100/((g.value-d.value)/_.value);let Mt=Math.round(ot/Oe)*Oe*(g.value-d.value)*.01+d.value;Mt=Number.parseFloat(Mt.toFixed(S.value)),Mt!==e.modelValue&&i(Fo,Mt),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await oo(),t.dragging&&U(),$.value.updatePopper()};return tn(()=>t.dragging,ot=>{B(ot)}),qr(Z,"touchstart",me,{passive:!1}),{disabled:s,button:Z,tooltip:$,tooltipVisible:z,showTooltip:o,wrapperStyle:Q,formatValue:H,handleMouseEnter:oe,handleMouseLeave:le,onButtonDown:me,onKeyDown:xe,setPosition:We}},oie=Ze({name:"ElSliderButton"}),rie=Ze({...oie,props:Qre,emits:eie,setup(e,{expose:t,emit:i}){const s=e,d=rn("slider"),g=Pr({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:s.modelValue}),{disabled:_,button:o,tooltip:S,showTooltip:E,tooltipVisible:I,wrapperStyle:P,formatValue:F,handleMouseEnter:B,handleMouseLeave:$,onButtonDown:z,onKeyDown:H,setPosition:U}=nie(s,g,i),{hovering:ie,dragging:Z}=Ca(g);return t({onButtonDown:z,onKeyDown:H,setPosition:U,hovering:ie,dragging:Z}),(G,Q)=>(se(),Pe("div",{ref_key:"button",ref:o,class:de([y(d).e("button-wrapper"),{hover:y(ie),dragging:y(Z)}]),style:to(y(P)),tabindex:y(_)?-1:0,onMouseenter:y(B),onMouseleave:y($),onMousedown:y(z),onFocus:y(B),onBlur:y($),onKeydown:y(H)},[Qe(y(qa),{ref_key:"tooltip",ref:S,visible:y(I),placement:G.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":G.tooltipClass,disabled:!y(E),persistent:y(E)},{content:at(()=>[He("span",null,wn(y(F)),1)]),default:at(()=>[He("div",{class:de([y(d).e("button"),{hover:y(ie),dragging:y(Z)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var IP=bn(rie,[["__file","button.vue"]]);const iie=vn({mark:{type:ut([String,Object]),default:void 0}});var aie=Ze({name:"ElSliderMarker",props:iie,setup(e){const t=rn("slider"),i=te(()=>Zn(e.mark)?e.mark:e.mark.label),s=te(()=>Zn(e.mark)?void 0:e.mark.style);return()=>lo("div",{class:t.e("marks-text"),style:s.value},i.value)}});const sie=(e,t,i)=>{const{form:s,formItem:d}=Ka(),g=gi(),_=Se(),o=Se(),S={firstButton:_,secondButton:o},E=te(()=>e.disabled||(s==null?void 0:s.disabled)||!1),I=te(()=>Math.min(t.firstValue,t.secondValue)),P=te(()=>Math.max(t.firstValue,t.secondValue)),F=te(()=>e.range?`${100*(P.value-I.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),B=te(()=>e.range?`${100*(I.value-e.min)/(e.max-e.min)}%`:"0%"),$=te(()=>e.vertical?{height:e.height}:{}),z=te(()=>e.vertical?{height:F.value,bottom:B.value}:{width:F.value,left:B.value}),H=()=>{g.value&&(t.sliderSize=g.value[`client${e.vertical?"Height":"Width"}`])},U=ye=>{const De=e.min+ye*(e.max-e.min)/100;if(!e.range)return _;let tt;return Math.abs(I.value-De)<Math.abs(P.value-De)?tt=t.firstValue<t.secondValue?"firstButton":"secondButton":tt=t.firstValue>t.secondValue?"firstButton":"secondButton",S[tt]},ie=ye=>{const De=U(ye);return De.value.setPosition(ye),De},Z=ye=>{t.firstValue=ye??e.min,Q(e.range?[I.value,P.value]:ye??e.min)},G=ye=>{t.secondValue=ye,e.range&&Q([I.value,P.value])},Q=ye=>{i(Fo,ye),i(Ga,ye)},oe=async()=>{await oo(),i(Yr,e.range?[I.value,P.value]:e.modelValue)},le=ye=>{var De,tt,Me,xe,Ae,Ce;if(E.value||t.dragging)return;H();let ge=0;if(e.vertical){const Ne=(Me=(tt=(De=ye.touches)==null?void 0:De.item(0))==null?void 0:tt.clientY)!=null?Me:ye.clientY;ge=(g.value.getBoundingClientRect().bottom-Ne)/t.sliderSize*100}else{const Ne=(Ce=(Ae=(xe=ye.touches)==null?void 0:xe.item(0))==null?void 0:Ae.clientX)!=null?Ce:ye.clientX,We=g.value.getBoundingClientRect().left;ge=(Ne-We)/t.sliderSize*100}if(!(ge<0||ge>100))return ie(ge)};return{elFormItem:d,slider:g,firstButton:_,secondButton:o,sliderDisabled:E,minValue:I,maxValue:P,runwayStyle:$,barStyle:z,resetSize:H,setPosition:ie,emitChange:oe,onSliderWrapperPrevent:ye=>{var De,tt;((De=S.firstButton.value)!=null&&De.dragging||(tt=S.secondButton.value)!=null&&tt.dragging)&&ye.preventDefault()},onSliderClick:ye=>{le(ye)&&oe()},onSliderDown:async ye=>{const De=le(ye);De&&(await oo(),De.value.onButtonDown(ye))},onSliderMarkerDown:ye=>{E.value||t.dragging||ie(ye)},setFirstValue:Z,setSecondValue:G}},lie=(e,t,i,s)=>({stops:te(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const _=(e.max-e.min)/e.step,o=100*e.step/(e.max-e.min),S=Array.from({length:_-1}).map((E,I)=>(I+1)*o);return e.range?S.filter(E=>E<100*(i.value-e.min)/(e.max-e.min)||E>100*(s.value-e.min)/(e.max-e.min)):S.filter(E=>E>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:_=>e.vertical?{bottom:`${_}%`}:{left:`${_}%`}}),cie=e=>te(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((i,s)=>i-s).filter(i=>i<=e.max&&i>=e.min).map(i=>({point:i,position:(i-e.min)*100/(e.max-e.min),mark:e.marks[i]})):[]),uie=(e,t,i,s,d,g)=>{const _=E=>{d(Fo,E),d(Ga,E)},o=()=>e.range?![i.value,s.value].every((E,I)=>E===t.oldValue[I]):e.modelValue!==t.oldValue,S=()=>{var E,I;e.min>e.max&&ha("Slider","min should not be greater than max.");const P=e.modelValue;e.range&&fn(P)?P[1]<e.min?_([e.min,e.min]):P[0]>e.max?_([e.max,e.max]):P[0]<e.min?_([e.min,P[1]]):P[1]>e.max?_([P[0],e.max]):(t.firstValue=P[0],t.secondValue=P[1],o()&&(e.validateEvent&&((E=g==null?void 0:g.validate)==null||E.call(g,"change").catch(F=>void 0)),t.oldValue=P.slice())):!e.range&&ao(P)&&!Number.isNaN(P)&&(P<e.min?_(e.min):P>e.max?_(e.max):(t.firstValue=P,o()&&(e.validateEvent&&((I=g==null?void 0:g.validate)==null||I.call(g,"change").catch(F=>void 0)),t.oldValue=P)))};S(),tn(()=>t.dragging,E=>{E||S()}),tn(()=>e.modelValue,(E,I)=>{t.dragging||fn(E)&&fn(I)&&E.every((P,F)=>P===I[F])&&t.firstValue===E[0]&&t.secondValue===E[1]||S()},{deep:!0}),tn(()=>[e.min,e.max],()=>{S()})},die=(e,t,i)=>{const s=Se();return No(async()=>{e.range?(fn(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(!ao(e.modelValue)||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),qr(window,"resize",i),await oo(),i()}),{sliderWrapper:s}},hie=Ze({name:"ElSlider"}),fie=Ze({...hie,props:Xre,emits:Jre,setup(e,{expose:t,emit:i}){const s=e,d=rn("slider"),{t:g}=vr(),_=Pr({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:o,slider:S,firstButton:E,secondButton:I,sliderDisabled:P,minValue:F,maxValue:B,runwayStyle:$,barStyle:z,resetSize:H,emitChange:U,onSliderWrapperPrevent:ie,onSliderClick:Z,onSliderDown:G,onSliderMarkerDown:Q,setFirstValue:oe,setSecondValue:le}=sie(s,_,i),{stops:me,getStopStyle:fe}=lie(s,_,F,B),{inputId:ce,isLabeledByFormItem:pe}=ic(s,{formItemContext:o}),ye=na(),De=te(()=>s.inputSize||ye.value),tt=te(()=>s.ariaLabel||g("el.slider.defaultLabel",{min:s.min,max:s.max})),Me=te(()=>s.range?s.rangeStartLabel||g("el.slider.defaultRangeStartLabel"):tt.value),xe=te(()=>s.formatValueText?s.formatValueText(Oe.value):`${Oe.value}`),Ae=te(()=>s.rangeEndLabel||g("el.slider.defaultRangeEndLabel")),Ce=te(()=>s.formatValueText?s.formatValueText(Ct.value):`${Ct.value}`),ge=te(()=>[d.b(),d.m(ye.value),d.is("vertical",s.vertical),{[d.m("with-input")]:s.showInput}]),Ne=cie(s);uie(s,_,F,B,i,o);const We=te(()=>{const bt=[s.min,s.max,s.step].map(Kt=>{const $t=`${Kt}`.split(".")[1];return $t?$t.length:0});return Math.max.apply(null,bt)}),{sliderWrapper:ot}=die(s,_,H),{firstValue:Oe,secondValue:Ct,sliderSize:Mt}=Ca(_),zt=bt=>{_.dragging=bt};return qr(ot,"touchstart",ie,{passive:!1}),qr(ot,"touchmove",ie,{passive:!1}),or(_z,{...Ca(s),sliderSize:Mt,disabled:P,precision:We,emitChange:U,resetSize:H,updateDragging:zt}),t({onSliderClick:Z}),(bt,Kt)=>{var $t,Re;return se(),Pe("div",{id:bt.range?y(ce):void 0,ref_key:"sliderWrapper",ref:ot,class:de(y(ge)),role:bt.range?"group":void 0,"aria-label":bt.range&&!y(pe)?y(tt):void 0,"aria-labelledby":bt.range&&y(pe)?($t=y(o))==null?void 0:$t.labelId:void 0},[He("div",{ref_key:"slider",ref:S,class:de([y(d).e("runway"),{"show-input":bt.showInput&&!bt.range},y(d).is("disabled",y(P))]),style:to(y($)),onMousedown:y(G),onTouchstartPassive:y(G)},[He("div",{class:de(y(d).e("bar")),style:to(y(z))},null,6),Qe(IP,{id:bt.range?void 0:y(ce),ref_key:"firstButton",ref:E,"model-value":y(Oe),vertical:bt.vertical,"tooltip-class":bt.tooltipClass,placement:bt.placement,role:"slider","aria-label":bt.range||!y(pe)?y(Me):void 0,"aria-labelledby":!bt.range&&y(pe)?(Re=y(o))==null?void 0:Re.labelId:void 0,"aria-valuemin":bt.min,"aria-valuemax":bt.range?y(Ct):bt.max,"aria-valuenow":y(Oe),"aria-valuetext":y(xe),"aria-orientation":bt.vertical?"vertical":"horizontal","aria-disabled":y(P),"onUpdate:modelValue":y(oe)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),bt.range?(se(),Rt(IP,{key:0,ref_key:"secondButton",ref:I,"model-value":y(Ct),vertical:bt.vertical,"tooltip-class":bt.tooltipClass,placement:bt.placement,role:"slider","aria-label":y(Ae),"aria-valuemin":y(Oe),"aria-valuemax":bt.max,"aria-valuenow":y(Ct),"aria-valuetext":y(Ce),"aria-orientation":bt.vertical?"vertical":"horizontal","aria-disabled":y(P),"onUpdate:modelValue":y(le)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):St("v-if",!0),bt.showStops?(se(),Pe("div",{key:1},[(se(!0),Pe(eo,null,tr(y(me),(dn,At)=>(se(),Pe("div",{key:At,class:de(y(d).e("stop")),style:to(y(fe)(dn))},null,6))),128))])):St("v-if",!0),y(Ne).length>0?(se(),Pe(eo,{key:2},[He("div",null,[(se(!0),Pe(eo,null,tr(y(Ne),(dn,At)=>(se(),Pe("div",{key:At,style:to(y(fe)(dn.position)),class:de([y(d).e("stop"),y(d).e("marks-stop")])},null,6))),128))]),He("div",{class:de(y(d).e("marks"))},[(se(!0),Pe(eo,null,tr(y(Ne),(dn,At)=>(se(),Rt(y(aie),{key:At,mark:dn.mark,style:to(y(fe)(dn.position)),onMousedown:po(Ke=>y(Q)(dn.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):St("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),bt.showInput&&!bt.range?(se(),Rt(y(XD),{key:0,ref:"input","model-value":y(Oe),class:de(y(d).e("input")),step:bt.step,disabled:y(P),controls:bt.showInputControls,min:bt.min,max:bt.max,precision:y(We),debounce:bt.debounce,size:y(De),"onUpdate:modelValue":y(oe),onChange:y(U)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):St("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var pie=bn(fie,[["__file","slider.vue"]]);const mie=Ao(pie),gie=vn({prefixCls:{type:String}}),AP=Ze({name:"ElSpaceItem",props:gie,setup(e,{slots:t}){const i=rn("space"),s=te(()=>`${e.prefixCls||i.b()}__item`);return()=>lo("div",{class:s.value},_t(t,"default"))}}),kP={small:8,default:12,large:16};function vie(e){const t=rn("space"),i=te(()=>[t.b(),t.m(e.direction),e.class]),s=Se(0),d=Se(0),g=te(()=>{const o=e.wrap||e.fill?{flexWrap:"wrap"}:{},S={alignItems:e.alignment},E={rowGap:`${d.value}px`,columnGap:`${s.value}px`};return[o,S,E,e.style]}),_=te(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return Ha(()=>{const{size:o="small",wrap:S,direction:E,fill:I}=e;if(fn(o)){const[P=0,F=0]=o;s.value=P,d.value=F}else{let P;ao(o)?P=o:P=kP[o||"small"]||kP.small,(S||I)&&E==="horizontal"?s.value=d.value=P:E==="horizontal"?(s.value=P,d.value=0):(d.value=P,s.value=0)}}),{classes:i,containerStyle:g,itemStyle:_}}const _ie=vn({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:ut([String,Object,Array]),default:""},style:{type:ut([String,Array,Object]),default:""},alignment:{type:ut(String),default:"center"},prefixCls:{type:String},spacer:{type:ut([Object,String,Number,Array]),default:null,validator:e=>Ai(e)||ao(e)||Zn(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:ku,validator:e=>ao(e)||fn(e)&&e.length===2&&e.every(ao)}}),yie=Ze({name:"ElSpace",props:_ie,setup(e,{slots:t}){const{classes:i,containerStyle:s,itemStyle:d}=vie(e);function g(_,o="",S=[]){const{prefixCls:E}=e;return _.forEach((I,P)=>{x2(I)?fn(I.children)&&I.children.forEach((F,B)=>{x2(F)&&fn(F.children)?g(F.children,`${o+B}-`,S):S.push(Qe(AP,{style:d.value,prefixCls:E,key:`nested-${o+B}`},{default:()=>[F]},Kl.PROPS|Kl.STYLE,["style","prefixCls"]))}):dZ(I)&&S.push(Qe(AP,{style:d.value,prefixCls:E,key:`LoopKey${o+P}`},{default:()=>[I]},Kl.PROPS|Kl.STYLE,["style","prefixCls"]))}),S}return()=>{var _;const{spacer:o,direction:S}=e,E=_t(t,"default",{key:0},()=>[]);if(((_=E.children)!=null?_:[]).length===0)return null;if(fn(E.children)){let I=g(E.children);if(o){const P=I.length-1;I=I.reduce((F,B,$)=>{const z=[...F,B];return $!==P&&z.push(Qe("span",{style:[d.value,S==="vertical"?"width: 100%":null],key:$},[Ai(o)?o:nr(o,Kl.TEXT)],Kl.STYLE)),z},[])}return Qe("div",{class:i.value,style:s.value},I,Kl.STYLE|Kl.CLASS)}return E.children}}}),bie=Ao(yie),xie=vn({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:ut([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:ut([String,Object,Array])}}),wie=Ze({name:"ElStatistic"}),Sie=Ze({...wie,props:xie,setup(e,{expose:t}){const i=e,s=rn("statistic"),d=te(()=>{const{value:g,formatter:_,precision:o,decimalSeparator:S,groupSeparator:E}=i;if(Qn(_))return _(g);if(!ao(g)||Number.isNaN(g))return g;let[I,P=""]=String(g).split(".");return P=P.padEnd(o,"0").slice(0,o>0?o:0),I=I.replace(/\B(?=(\d{3})+(?!\d))/g,E),[I,P].join(P?S:"")});return t({displayValue:d}),(g,_)=>(se(),Pe("div",{class:de(y(s).b())},[g.$slots.title||g.title?(se(),Pe("div",{key:0,class:de(y(s).e("head"))},[_t(g.$slots,"title",{},()=>[nr(wn(g.title),1)])],2)):St("v-if",!0),He("div",{class:de(y(s).e("content"))},[g.$slots.prefix||g.prefix?(se(),Pe("div",{key:0,class:de(y(s).e("prefix"))},[_t(g.$slots,"prefix",{},()=>[He("span",null,wn(g.prefix),1)])],2)):St("v-if",!0),He("span",{class:de(y(s).e("number")),style:to(g.valueStyle)},wn(y(d)),7),g.$slots.suffix||g.suffix?(se(),Pe("div",{key:1,class:de(y(s).e("suffix"))},[_t(g.$slots,"suffix",{},()=>[He("span",null,wn(g.suffix),1)])],2)):St("v-if",!0)],2)],2))}});var Tie=bn(Sie,[["__file","statistic.vue"]]);const yz=Ao(Tie),Cie=vn({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:ut([Number,Object]),default:0},valueStyle:{type:ut([String,Object,Array])}}),Eie={finish:()=>!0,[Yr]:e=>ao(e)},Mie=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],PP=e=>ao(e)?new Date(e).getTime():e.valueOf(),RP=(e,t)=>{let i=e;const s=/\[([^\]]*)]/g;return Mie.reduce((g,[_,o])=>{const S=new RegExp(`${_}+(?![^\\[\\]]*\\])`,"g");if(S.test(g)){const E=Math.floor(i/o);return i-=E*o,g.replace(S,I=>String(E).padStart(I.length,"0"))}return g},t).replace(s,"$1")},Iie=Ze({name:"ElCountdown"}),Aie=Ze({...Iie,props:Cie,emits:Eie,setup(e,{expose:t,emit:i}){const s=e;let d;const g=Se(0),_=te(()=>RP(g.value,s.format)),o=I=>RP(I,s.format),S=()=>{d&&($f(d),d=void 0)},E=()=>{const I=PP(s.value),P=()=>{let F=I-Date.now();i("change",F),F<=0?(F=0,S(),i("finish")):d=_h(P),g.value=F};d=_h(P)};return No(()=>{g.value=PP(s.value)-Date.now(),tn(()=>[s.value,s.format],()=>{S(),E()},{immediate:!0})}),ni(()=>{S()}),t({displayValue:_}),(I,P)=>(se(),Rt(y(yz),{value:g.value,title:I.title,prefix:I.prefix,suffix:I.suffix,"value-style":I.valueStyle,formatter:o},ec({_:2},[tr(I.$slots,(F,B)=>({name:B,fn:at(()=>[_t(I.$slots,B)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var kie=bn(Aie,[["__file","countdown.vue"]]);const Pie=Ao(kie),Rie=vn({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),Oie={[Yr]:(e,t)=>[e,t].every(ao)},Lie=Ze({name:"ElSteps"}),Die=Ze({...Lie,props:Rie,emits:Oie,setup(e,{emit:t}){const i=e,s=rn("steps"),{children:d,addChild:g,removeChild:_}=ET(jo(),"ElStep");return tn(d,()=>{d.value.forEach((o,S)=>{o.setIndex(S)})}),or("ElSteps",{props:i,steps:d,addStep:g,removeStep:_}),tn(()=>i.active,(o,S)=>{t(Yr,o,S)}),(o,S)=>(se(),Pe("div",{class:de([y(s).b(),y(s).m(o.simple?"simple":o.direction)])},[_t(o.$slots,"default")],2))}});var zie=bn(Die,[["__file","steps.vue"]]);const Fie=vn({title:{type:String,default:""},icon:{type:Xr},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Bie=Ze({name:"ElStep"}),Nie=Ze({...Bie,props:Fie,setup(e){const t=e,i=rn("step"),s=Se(-1),d=Se({}),g=Se(""),_=Un("ElSteps"),o=jo();No(()=>{tn([()=>_.props.active,()=>_.props.processStatus,()=>_.props.finishStatus],([oe])=>{G(oe)},{immediate:!0})}),ni(()=>{_.removeStep(Q.uid)});const S=te(()=>t.status||g.value),E=te(()=>{const oe=_.steps.value[s.value-1];return oe?oe.currentStatus:"wait"}),I=te(()=>_.props.alignCenter),P=te(()=>_.props.direction==="vertical"),F=te(()=>_.props.simple),B=te(()=>_.steps.value.length),$=te(()=>{var oe;return((oe=_.steps.value[B.value-1])==null?void 0:oe.uid)===(o==null?void 0:o.uid)}),z=te(()=>F.value?"":_.props.space),H=te(()=>[i.b(),i.is(F.value?"simple":_.props.direction),i.is("flex",$.value&&!z.value&&!I.value),i.is("center",I.value&&!P.value&&!F.value)]),U=te(()=>{const oe={flexBasis:ao(z.value)?`${z.value}px`:z.value?z.value:`${100/(B.value-(I.value?0:1))}%`};return P.value||$.value&&(oe.maxWidth=`${100/B.value}%`),oe}),ie=oe=>{s.value=oe},Z=oe=>{const le=oe==="wait",me={transitionDelay:`${le?"-":""}${150*s.value}ms`},fe=oe===_.props.processStatus||le?0:100;me.borderWidth=fe&&!F.value?"1px":0,me[_.props.direction==="vertical"?"height":"width"]=`${fe}%`,d.value=me},G=oe=>{oe>s.value?g.value=_.props.finishStatus:oe===s.value&&E.value!=="error"?g.value=_.props.processStatus:g.value="wait";const le=_.steps.value[s.value-1];le&&le.calcProgress(g.value)},Q=Pr({uid:o.uid,currentStatus:S,setIndex:ie,calcProgress:Z});return _.addStep(Q),(oe,le)=>(se(),Pe("div",{style:to(y(U)),class:de(y(H))},[St(" icon & line "),He("div",{class:de([y(i).e("head"),y(i).is(y(S))])},[y(F)?St("v-if",!0):(se(),Pe("div",{key:0,class:de(y(i).e("line"))},[He("i",{class:de(y(i).e("line-inner")),style:to(d.value)},null,6)],2)),He("div",{class:de([y(i).e("icon"),y(i).is(oe.icon||oe.$slots.icon?"icon":"text")])},[_t(oe.$slots,"icon",{},()=>[oe.icon?(se(),Rt(y(Gn),{key:0,class:de(y(i).e("icon-inner"))},{default:at(()=>[(se(),Rt(Wo(oe.icon)))]),_:1},8,["class"])):y(S)==="success"?(se(),Rt(y(Gn),{key:1,class:de([y(i).e("icon-inner"),y(i).is("status")])},{default:at(()=>[Qe(y(D_))]),_:1},8,["class"])):y(S)==="error"?(se(),Rt(y(Gn),{key:2,class:de([y(i).e("icon-inner"),y(i).is("status")])},{default:at(()=>[Qe(y(Kc))]),_:1},8,["class"])):y(F)?St("v-if",!0):(se(),Pe("div",{key:3,class:de(y(i).e("icon-inner"))},wn(s.value+1),3))])],2)],2),St(" title & description "),He("div",{class:de(y(i).e("main"))},[He("div",{class:de([y(i).e("title"),y(i).is(y(S))])},[_t(oe.$slots,"title",{},()=>[nr(wn(oe.title),1)])],2),y(F)?(se(),Pe("div",{key:0,class:de(y(i).e("arrow"))},null,2)):(se(),Pe("div",{key:1,class:de([y(i).e("description"),y(i).is(y(S))])},[_t(oe.$slots,"description",{},()=>[nr(wn(oe.description),1)])],2))],2)],6))}});var bz=bn(Nie,[["__file","item.vue"]]);const $ie=Ao(zie,{Step:bz}),Vie=Oi(bz),xz=e=>["",...ku].includes(e),Uie=vn({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:xz},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:Xr},activeActionIcon:{type:Xr},activeIcon:{type:Xr},inactiveIcon:{type:Xr},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:ut(Function)},id:String,tabindex:{type:[String,Number]},...Da(["ariaLabel"])}),jie={[Fo]:e=>ai(e)||Zn(e)||ao(e),[Yr]:e=>ai(e)||Zn(e)||ao(e),[Ga]:e=>ai(e)||Zn(e)||ao(e)},wz="ElSwitch",Hie=Ze({name:wz}),Gie=Ze({...Hie,props:Uie,emits:jie,setup(e,{expose:t,emit:i}){const s=e,{formItem:d}=Ka(),g=na(),_=rn("switch"),{inputId:o}=ic(s,{formItemContext:d}),S=Za(te(()=>s.loading)),E=Se(s.modelValue!==!1),I=Se(),P=Se(),F=te(()=>[_.b(),_.m(g.value),_.is("disabled",S.value),_.is("checked",U.value)]),B=te(()=>[_.e("label"),_.em("label","left"),_.is("active",!U.value)]),$=te(()=>[_.e("label"),_.em("label","right"),_.is("active",U.value)]),z=te(()=>({width:ji(s.width)}));tn(()=>s.modelValue,()=>{E.value=!0});const H=te(()=>E.value?s.modelValue:!1),U=te(()=>H.value===s.activeValue);[s.activeValue,s.inactiveValue].includes(H.value)||(i(Fo,s.inactiveValue),i(Yr,s.inactiveValue),i(Ga,s.inactiveValue)),tn(U,Q=>{var oe;I.value.checked=Q,s.validateEvent&&((oe=d==null?void 0:d.validate)==null||oe.call(d,"change").catch(le=>void 0))});const ie=()=>{const Q=U.value?s.inactiveValue:s.activeValue;i(Fo,Q),i(Yr,Q),i(Ga,Q),oo(()=>{I.value.checked=U.value})},Z=()=>{if(S.value)return;const{beforeChange:Q}=s;if(!Q){ie();return}const oe=Q();[Xv(oe),ai(oe)].includes(!0)||ha(wz,"beforeChange must return type `Promise<boolean>` or `boolean`"),Xv(oe)?oe.then(me=>{me&&ie()}).catch(me=>{}):oe&&ie()},G=()=>{var Q,oe;(oe=(Q=I.value)==null?void 0:Q.focus)==null||oe.call(Q)};return No(()=>{I.value.checked=U.value}),t({focus:G,checked:U}),(Q,oe)=>(se(),Pe("div",{class:de(y(F)),onClick:po(Z,["prevent"])},[He("input",{id:y(o),ref_key:"input",ref:I,class:de(y(_).e("input")),type:"checkbox",role:"switch","aria-checked":y(U),"aria-disabled":y(S),"aria-label":Q.ariaLabel,name:Q.name,"true-value":Q.activeValue,"false-value":Q.inactiveValue,disabled:y(S),tabindex:Q.tabindex,onChange:ie,onKeydown:ti(Z,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!Q.inlinePrompt&&(Q.inactiveIcon||Q.inactiveText)?(se(),Pe("span",{key:0,class:de(y(B))},[Q.inactiveIcon?(se(),Rt(y(Gn),{key:0},{default:at(()=>[(se(),Rt(Wo(Q.inactiveIcon)))]),_:1})):St("v-if",!0),!Q.inactiveIcon&&Q.inactiveText?(se(),Pe("span",{key:1,"aria-hidden":y(U)},wn(Q.inactiveText),9,["aria-hidden"])):St("v-if",!0)],2)):St("v-if",!0),He("span",{ref_key:"core",ref:P,class:de(y(_).e("core")),style:to(y(z))},[Q.inlinePrompt?(se(),Pe("div",{key:0,class:de(y(_).e("inner"))},[Q.activeIcon||Q.inactiveIcon?(se(),Rt(y(Gn),{key:0,class:de(y(_).is("icon"))},{default:at(()=>[(se(),Rt(Wo(y(U)?Q.activeIcon:Q.inactiveIcon)))]),_:1},8,["class"])):Q.activeText||Q.inactiveText?(se(),Pe("span",{key:1,class:de(y(_).is("text")),"aria-hidden":!y(U)},wn(y(U)?Q.activeText:Q.inactiveText),11,["aria-hidden"])):St("v-if",!0)],2)):St("v-if",!0),He("div",{class:de(y(_).e("action"))},[Q.loading?(se(),Rt(y(Gn),{key:0,class:de(y(_).is("loading"))},{default:at(()=>[Qe(y(Cu))]),_:1},8,["class"])):y(U)?_t(Q.$slots,"active-action",{key:1},()=>[Q.activeActionIcon?(se(),Rt(y(Gn),{key:0},{default:at(()=>[(se(),Rt(Wo(Q.activeActionIcon)))]),_:1})):St("v-if",!0)]):y(U)?St("v-if",!0):_t(Q.$slots,"inactive-action",{key:2},()=>[Q.inactiveActionIcon?(se(),Rt(y(Gn),{key:0},{default:at(()=>[(se(),Rt(Wo(Q.inactiveActionIcon)))]),_:1})):St("v-if",!0)])],2)],6),!Q.inlinePrompt&&(Q.activeIcon||Q.activeText)?(se(),Pe("span",{key:1,class:de(y($))},[Q.activeIcon?(se(),Rt(y(Gn),{key:0},{default:at(()=>[(se(),Rt(Wo(Q.activeIcon)))]),_:1})):St("v-if",!0),!Q.activeIcon&&Q.activeText?(se(),Pe("span",{key:1,"aria-hidden":!y(U)},wn(Q.activeText),9,["aria-hidden"])):St("v-if",!0)],2)):St("v-if",!0)],10,["onClick"]))}});var Wie=bn(Gie,[["__file","switch.vue"]]);const qie=Ao(Wie),Bw=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},Kie=function(e,t,i,s,d){if(!t&&!s&&(!d||fn(d)&&!d.length))return e;Zn(i)?i=i==="descending"?-1:1:i=i&&i<0?-1:1;const g=s?null:function(o,S){return d?(fn(d)||(d=[d]),d.map(E=>Zn(E)?Ji(o,E):E(o,S,e))):(t!=="$key"&&Vo(o)&&"$value"in o&&(o=o.$value),[Vo(o)?Ji(o,t):o])},_=function(o,S){if(s)return s(o.value,S.value);for(let E=0,I=o.key.length;E<I;E++){if(o.key[E]<S.key[E])return-1;if(o.key[E]>S.key[E])return 1}return 0};return e.map((o,S)=>({value:o,index:S,key:g?g(o,S):null})).sort((o,S)=>{let E=_(o,S);return E||(E=o.index-S.index),E*+i}).map(o=>o.value)},Sz=function(e,t){let i=null;return e.columns.forEach(s=>{s.id===t&&(i=s)}),i},Zie=function(e,t){let i=null;for(let s=0;s<e.columns.length;s++){const d=e.columns[s];if(d.columnKey===t){i=d;break}}return i||ha("ElTable",`No column matching with column-key: ${t}`),i},OP=function(e,t,i){const s=(t.className||"").match(new RegExp(`${i}-table_[^\\s]+`,"gm"));return s?Sz(e,s[0]):null},ds=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(Zn(t)){if(!t.includes("."))return`${e[t]}`;const i=t.split(".");let s=e;for(const d of i)s=s[d];return`${s}`}else if(Qn(t))return t.call(null,e)},Mf=function(e,t){const i={};return(e||[]).forEach((s,d)=>{i[ds(s,t)]={row:s,index:d}}),i};function Yie(e,t){const i={};let s;for(s in e)i[s]=e[s];for(s in t)if(Tr(t,s)){const d=t[s];typeof d<"u"&&(i[s]=d)}return i}function XT(e){return e===""||e!==void 0&&(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function Tz(e){return e===""||e!==void 0&&(e=XT(e),Number.isNaN(e)&&(e=80)),e}function Xie(e){return ao(e)?e:Zn(e)?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function Jie(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,i)=>(...s)=>t(i(...s)))}function Pb(e,t,i,s,d,g){let _=g??0,o=!1;const S=e.indexOf(t),E=S!==-1,I=d==null?void 0:d.call(null,t,g),P=B=>{B==="add"?e.push(t):e.splice(S,1),o=!0},F=B=>{let $=0;const z=(s==null?void 0:s.children)&&B[s.children];return z&&fn(z)&&($+=z.length,z.forEach(H=>{$+=F(H)})),$};return(!d||I)&&(ai(i)?i&&!E?P("add"):!i&&E&&P("remove"):P(E?"remove":"add")),!(s!=null&&s.checkStrictly)&&(s!=null&&s.children)&&fn(t[s.children])&&t[s.children].forEach(B=>{Pb(e,B,i??!E,s,d,_+1),_+=F(B)+1}),o}function Qie(e,t,i="children",s="hasChildren"){const d=_=>!(fn(_)&&_.length);function g(_,o,S){t(_,o,S),o.forEach(E=>{if(E[s]){t(E,null,S+1);return}const I=E[i];d(I)||g(E,I,S+1)})}e.forEach(_=>{if(_[s]){t(_,null,0);return}const o=_[i];d(o)||g(_,o,0)})}const LP=(e,t)=>({content:t,...e,popperOptions:{strategy:"fixed",...e.popperOptions}});let ql=null;function eae(e,t,i,s){if((ql==null?void 0:ql.trigger)===i){PO(ql.vm.component.props,LP(e,t));return}ql==null||ql();const d=s==null?void 0:s.refs.tableWrapper,g=d==null?void 0:d.dataset.prefix,_=Qe(qa,{virtualTriggering:!0,virtualRef:i,appendTo:d,placement:"top",transition:"none",offset:0,hideAfter:0,...LP(e,t)});_.appContext={...s.appContext,...s};const o=document.createElement("div");gh(_,o),_.component.exposed.onOpen();const S=d==null?void 0:d.querySelector(`.${g}-scrollbar__wrap`);ql=()=>{gh(null,o),S==null||S.removeEventListener("scroll",ql),ql=null},ql.trigger=i,ql.vm=_,S==null||S.addEventListener("scroll",ql)}function Cz(e){return e.children?cH(e.children,Cz):[e]}function DP(e,t){return e+t.colSpan}const Ez=(e,t,i,s)=>{let d=0,g=e;const _=i.states.columns.value;if(s){const S=Cz(s[e]);d=_.slice(0,_.indexOf(S[0])).reduce(DP,0),g=d+S.reduce(DP,0)-1}else d=e;let o;switch(t){case"left":g<i.states.fixedLeafColumnsLength.value&&(o="left");break;case"right":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(o="right");break;default:g<i.states.fixedLeafColumnsLength.value?o="left":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(o="right")}return o?{direction:o,start:d,after:g}:{}},JT=(e,t,i,s,d,g=0)=>{const _=[],{direction:o,start:S,after:E}=Ez(t,i,s,d);if(o){const I=o==="left";_.push(`${e}-fixed-column--${o}`),I&&E+g===s.states.fixedLeafColumnsLength.value-1?_.push("is-last-column"):!I&&S-g===s.states.columns.value.length-s.states.rightFixedLeafColumnsLength.value&&_.push("is-first-column")}return _};function zP(e,t){return e+(t.realWidth===null||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const QT=(e,t,i,s)=>{const{direction:d,start:g=0,after:_=0}=Ez(e,t,i,s);if(!d)return;const o={},S=d==="left",E=i.states.columns.value;return S?o.left=E.slice(0,g).reduce(zP,0):o.right=E.slice(_+1).reverse().reduce(zP,0),o},Am=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function tae(e){const t=jo(),i=Se(!1),s=Se([]);return{updateExpandRows:()=>{const S=e.data.value||[],E=e.rowKey.value;if(i.value)s.value=S.slice();else if(E){const I=Mf(s.value,E);s.value=S.reduce((P,F)=>{const B=ds(F,E);return I[B]&&P.push(F),P},[])}else s.value=[]},toggleRowExpansion:(S,E)=>{Pb(s.value,S,E)&&t.emit("expand-change",S,s.value.slice())},setExpandRowKeys:S=>{t.store.assertRowKey();const E=e.data.value||[],I=e.rowKey.value,P=Mf(E,I);s.value=S.reduce((F,B)=>{const $=P[B];return $&&F.push($.row),F},[])},isRowExpanded:S=>{const E=e.rowKey.value;return E?!!Mf(s.value,E)[ds(S,E)]:s.value.includes(S)},states:{expandRows:s,defaultExpandAll:i}}}function nae(e){const t=jo(),i=Se(null),s=Se(null),d=E=>{t.store.assertRowKey(),i.value=E,_(E)},g=()=>{i.value=null},_=E=>{const{data:I,rowKey:P}=e;let F=null;P.value&&(F=(y(I)||[]).find(B=>ds(B,P.value)===E)),s.value=F,t.emit("current-change",s.value,null)};return{setCurrentRowKey:d,restoreCurrentRowKey:g,setCurrentRowByKey:_,updateCurrentRow:E=>{const I=s.value;if(E&&E!==I){s.value=E,t.emit("current-change",s.value,I);return}!E&&I&&(s.value=null,t.emit("current-change",null,I))},updateCurrentRowData:()=>{const E=e.rowKey.value,I=e.data.value||[],P=s.value;if(!I.includes(P)&&P){if(E){const F=ds(P,E);_(F)}else s.value=null;s.value===null&&t.emit("current-change",null,P)}else i.value&&(_(i.value),g())},states:{_currentRowKey:i,currentRow:s}}}function oae(e){const t=Se([]),i=Se({}),s=Se(16),d=Se(!1),g=Se({}),_=Se("hasChildren"),o=Se("children"),S=Se(!1),E=jo(),I=te(()=>{if(!e.rowKey.value)return{};const Z=e.data.value||[];return F(Z)}),P=te(()=>{const Z=e.rowKey.value,G=Object.keys(g.value),Q={};return G.length&&G.forEach(oe=>{if(g.value[oe].length){const le={children:[]};g.value[oe].forEach(me=>{const fe=ds(me,Z);le.children.push(fe),me[_.value]&&!Q[fe]&&(Q[fe]={children:[]})}),Q[oe]=le}}),Q}),F=Z=>{const G=e.rowKey.value,Q={};return Qie(Z,(oe,le,me)=>{const fe=ds(oe,G);fn(le)?Q[fe]={children:le.map(ce=>ds(ce,G)),level:me}:d.value&&(Q[fe]={children:[],lazy:!0,level:me})},o.value,_.value),Q},B=(Z=!1,G=(Q=>(Q=E.store)==null?void 0:Q.states.defaultExpandAll.value)())=>{var Q;const oe=I.value,le=P.value,me=Object.keys(oe),fe={};if(me.length){const ce=y(i),pe=[],ye=(tt,Me)=>{if(Z)return t.value?G||t.value.includes(Me):!!(G||tt!=null&&tt.expanded);{const xe=G||t.value&&t.value.includes(Me);return!!(tt!=null&&tt.expanded||xe)}};me.forEach(tt=>{const Me=ce[tt],xe={...oe[tt]};if(xe.expanded=ye(Me,tt),xe.lazy){const{loaded:Ae=!1,loading:Ce=!1}=Me||{};xe.loaded=!!Ae,xe.loading=!!Ce,pe.push(tt)}fe[tt]=xe});const De=Object.keys(le);d.value&&De.length&&pe.length&&De.forEach(tt=>{const Me=ce[tt],xe=le[tt].children;if(pe.includes(tt)){if(fe[tt].children.length!==0)throw new Error("[ElTable]children must be an empty array.");fe[tt].children=xe}else{const{loaded:Ae=!1,loading:Ce=!1}=Me||{};fe[tt]={lazy:!0,loaded:!!Ae,loading:!!Ce,expanded:ye(Me,tt),children:xe,level:""}}})}i.value=fe,(Q=E.store)==null||Q.updateTableScrollY()};tn(()=>t.value,()=>{B(!0)}),tn(()=>I.value,()=>{B()}),tn(()=>P.value,()=>{B()});const $=Z=>{t.value=Z,B()},z=(Z,G)=>{E.store.assertRowKey();const Q=e.rowKey.value,oe=ds(Z,Q),le=oe&&i.value[oe];if(oe&&le&&"expanded"in le){const me=le.expanded;G=Hr(G)?!le.expanded:G,i.value[oe].expanded=G,me!==G&&E.emit("expand-change",Z,G),E.store.updateTableScrollY()}},H=Z=>{E.store.assertRowKey();const G=e.rowKey.value,Q=ds(Z,G),oe=i.value[Q];d.value&&oe&&"loaded"in oe&&!oe.loaded?U(Z,Q,oe):z(Z,void 0)},U=(Z,G,Q)=>{const{load:oe}=E.props;oe&&!i.value[G].loaded&&(i.value[G].loading=!0,oe(Z,Q,le=>{if(!fn(le))throw new TypeError("[ElTable] data must be an array");i.value[G].loading=!1,i.value[G].loaded=!0,i.value[G].expanded=!0,le.length&&(g.value[G]=le),E.emit("expand-change",Z,!0)}))};return{loadData:U,loadOrToggle:H,toggleTreeExpansion:z,updateTreeExpandKeys:$,updateTreeData:B,updateKeyChildren:(Z,G)=>{const{lazy:Q,rowKey:oe}=E.props;if(Q){if(!oe)throw new Error("[Table] rowKey is required in updateKeyChild");g.value[Z]&&(g.value[Z]=G)}},normalize:F,states:{expandRowKeys:t,treeData:i,indent:s,lazy:d,lazyTreeNodeMap:g,lazyColumnIdentifier:_,childrenColumnName:o,checkStrictly:S}}}const rae=(e,t)=>{const i=t.sortingColumn;return!i||Zn(i.sortable)?e:Kie(e,t.sortProp,t.sortOrder,i.sortMethod,i.sortBy)},Y0=e=>{const t=[];return e.forEach(i=>{i.children&&i.children.length>0?t.push.apply(t,Y0(i.children)):t.push(i)}),t};function iae(){var e;const t=jo(),{size:i}=Ca((e=t.proxy)==null?void 0:e.$props),s=Se(null),d=Se([]),g=Se([]),_=Se(!1),o=Se([]),S=Se([]),E=Se([]),I=Se([]),P=Se([]),F=Se([]),B=Se([]),$=Se([]),z=[],H=Se(0),U=Se(0),ie=Se(0),Z=Se(!1),G=Se([]),Q=Se(!1),oe=Se(!1),le=Se(null),me=Se({}),fe=Se(null),ce=Se(null),pe=Se(null),ye=Se(null),De=Se(null);tn(d,()=>{var Dt;t.state&&(Ce(!1),t.props.tableLayout==="auto"&&((Dt=t.refs.tableHeaderRef)==null||Dt.updateFixedColumnStyle()))},{deep:!0});const tt=()=>{if(!s.value)throw new Error("[ElTable] prop row-key is required")},Me=Dt=>{var En;(En=Dt.children)==null||En.forEach(ft=>{ft.fixed=Dt.fixed,Me(ft)})};let xe;const Ae=()=>{o.value.forEach(Je=>{Me(Je)}),I.value=o.value.filter(Je=>Je.fixed===!0||Je.fixed==="left"),P.value=o.value.filter(Je=>Je.fixed==="right"),Hr(xe)&&o.value[0]&&o.value[0].type==="selection"&&(xe=!!o.value[0].fixed),I.value.length>0&&o.value[0]&&o.value[0].type==="selection"&&(o.value[0].fixed?I.value.some(Mn=>Mn.type!=="selection")?xe=void 0:(o.value[0].fixed=xe,xe||I.value.shift()):(o.value[0].fixed=!0,I.value.unshift(o.value[0])));const Dt=o.value.filter(Je=>!Je.fixed);S.value=[].concat(I.value).concat(Dt).concat(P.value);const En=Y0(Dt),ft=Y0(I.value),un=Y0(P.value);H.value=En.length,U.value=ft.length,ie.value=un.length,E.value=[].concat(ft).concat(En).concat(un),_.value=I.value.length>0||P.value.length>0},Ce=(Dt,En=!1)=>{Dt&&Ae(),En?t.state.doLayout():t.state.debouncedUpdateLayout()},ge=Dt=>G.value.some(En=>Oa(En,Dt)),Ne=()=>{Z.value=!1;const Dt=G.value;G.value=[],Dt.length&&t.emit("selection-change",[])},We=()=>{let Dt;if(s.value){Dt=[];const En=Mf(G.value,s.value),ft=Mf(d.value,s.value);for(const un in En)Tr(En,un)&&!ft[un]&&Dt.push(En[un].row)}else Dt=G.value.filter(En=>!d.value.includes(En));if(Dt.length){const En=G.value.filter(ft=>!Dt.includes(ft));G.value=En,t.emit("selection-change",En.slice())}},ot=()=>(G.value||[]).slice(),Oe=(Dt,En,ft=!0,un=!1)=>{var Je,Mn,Bn,Oo;const Rr={children:(Mn=(Je=t==null?void 0:t.store)==null?void 0:Je.states)==null?void 0:Mn.childrenColumnName.value,checkStrictly:(Oo=(Bn=t==null?void 0:t.store)==null?void 0:Bn.states)==null?void 0:Oo.checkStrictly.value};if(Pb(G.value,Dt,En,Rr,un?void 0:le.value)){const Er=(G.value||[]).slice();ft&&t.emit("select",Er,Dt),t.emit("selection-change",Er)}},Ct=()=>{var Dt,En;const ft=oe.value?!Z.value:!(Z.value||G.value.length);Z.value=ft;let un=!1,Je=0;const Mn=(En=(Dt=t==null?void 0:t.store)==null?void 0:Dt.states)==null?void 0:En.rowKey.value,{childrenColumnName:Bn}=t.store.states,Oo={children:Bn.value,checkStrictly:!1};d.value.forEach((Rr,hi)=>{const Er=hi+Je;Pb(G.value,Rr,ft,Oo,le.value,Er)&&(un=!0),Je+=bt(ds(Rr,Mn))}),un&&t.emit("selection-change",G.value?G.value.slice():[]),t.emit("select-all",(G.value||[]).slice())},Mt=()=>{const Dt=Mf(G.value,s.value);d.value.forEach(En=>{const ft=ds(En,s.value),un=Dt[ft];un&&(G.value[un.index]=En)})},zt=()=>{var Dt;if(((Dt=d.value)==null?void 0:Dt.length)===0){Z.value=!1;return}const{childrenColumnName:En}=t.store.states,ft=s.value?Mf(G.value,s.value):void 0;let un=0,Je=0;const Mn=Rr=>ft?!!ft[ds(Rr,s.value)]:G.value.includes(Rr),Bn=Rr=>{var hi;for(const Er of Rr){const Nr=le.value&&le.value.call(null,Er,un);if(Mn(Er))Je++;else if(!le.value||Nr)return!1;if(un++,(hi=Er[En.value])!=null&&hi.length&&!Bn(Er[En.value]))return!1}return!0},Oo=Bn(d.value||[]);Z.value=Je===0?!1:Oo},bt=Dt=>{var En;if(!t||!t.store)return 0;const{treeData:ft}=t.store.states;let un=0;const Je=(En=ft.value[Dt])==null?void 0:En.children;return Je&&(un+=Je.length,Je.forEach(Mn=>{un+=bt(Mn)})),un},Kt=(Dt,En)=>{fn(Dt)||(Dt=[Dt]);const ft={};return Dt.forEach(un=>{me.value[un.id]=En,ft[un.columnKey||un.id]=En}),ft},$t=(Dt,En,ft)=>{ce.value&&ce.value!==Dt&&(ce.value.order=null),ce.value=Dt,pe.value=En,ye.value=ft},Re=()=>{let Dt=y(g);Object.keys(me.value).forEach(En=>{const ft=me.value[En];if(!ft||ft.length===0)return;const un=Sz({columns:E.value},En);un&&un.filterMethod&&(Dt=Dt.filter(Je=>ft.some(Mn=>un.filterMethod.call(null,Mn,Je,un))))}),fe.value=Dt},dn=()=>{d.value=rae(fe.value,{sortingColumn:ce.value,sortProp:pe.value,sortOrder:ye.value})},At=(Dt=void 0)=>{Dt&&Dt.filter||Re(),dn()},Ke=Dt=>{const{tableHeaderRef:En}=t.refs;if(!En)return;const ft=Object.assign({},En.filterPanels),un=Object.keys(ft);if(un.length)if(Zn(Dt)&&(Dt=[Dt]),fn(Dt)){const Je=Dt.map(Mn=>Zie({columns:E.value},Mn));un.forEach(Mn=>{const Bn=Je.find(Oo=>Oo.id===Mn);Bn&&(Bn.filteredValue=[])}),t.store.commit("filterChange",{column:Je,values:[],silent:!0,multi:!0})}else un.forEach(Je=>{const Mn=E.value.find(Bn=>Bn.id===Je);Mn&&(Mn.filteredValue=[])}),me.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},Be=()=>{ce.value&&($t(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Ht,toggleRowExpansion:Ut,updateExpandRows:Nt,states:Et,isRowExpanded:Gt}=tae({data:d,rowKey:s}),{updateTreeExpandKeys:ln,toggleTreeExpansion:yn,updateTreeData:_n,updateKeyChildren:jn,loadOrToggle:yt,states:kn}=oae({data:d,rowKey:s}),{updateCurrentRowData:qn,updateCurrentRow:Co,setCurrentRowKey:mo,states:Io}=nae({data:d,rowKey:s});return{assertRowKey:tt,updateColumns:Ae,scheduleLayout:Ce,isSelected:ge,clearSelection:Ne,cleanSelection:We,getSelectionRows:ot,toggleRowSelection:Oe,_toggleAllSelection:Ct,toggleAllSelection:null,updateSelectionByRowKey:Mt,updateAllSelected:zt,updateFilters:Kt,updateCurrentRow:Co,updateSort:$t,execFilter:Re,execSort:dn,execQuery:At,clearFilter:Ke,clearSort:Be,toggleRowExpansion:Ut,setExpandRowKeysAdapter:Dt=>{Ht(Dt),ln(Dt)},setCurrentRowKey:mo,toggleRowExpansionAdapter:(Dt,En)=>{E.value.some(({type:un})=>un==="expand")?Ut(Dt,En):yn(Dt,En)},isRowExpanded:Gt,updateExpandRows:Nt,updateCurrentRowData:qn,loadOrToggle:yt,updateTreeData:_n,updateKeyChildren:jn,states:{tableSize:i,rowKey:s,data:d,_data:g,isComplex:_,_columns:o,originColumns:S,columns:E,fixedColumns:I,rightFixedColumns:P,leafColumns:F,fixedLeafColumns:B,rightFixedLeafColumns:$,updateOrderFns:z,leafColumnsLength:H,fixedLeafColumnsLength:U,rightFixedLeafColumnsLength:ie,isAllSelected:Z,selection:G,reserveSelection:Q,selectOnIndeterminate:oe,selectable:le,filters:me,filteredData:fe,sortingColumn:ce,sortProp:pe,sortOrder:ye,hoverRow:De,...Et,...kn,...Io}}}function G2(e,t){return e.map(i=>{var s;return i.id===t.id?t:((s=i.children)!=null&&s.length&&(i.children=G2(i.children,t)),i)})}function W2(e){e.forEach(t=>{var i,s;t.no=(i=t.getColumnIndex)==null?void 0:i.call(t),(s=t.children)!=null&&s.length&&W2(t.children)}),e.sort((t,i)=>t.no-i.no)}function aae(){const e=jo(),t=iae();return{ns:rn("table"),...t,mutations:{setData(_,o){const S=y(_._data)!==o;_.data.value=o,_._data.value=o,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),y(_.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):S?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(_,o,S,E){const I=y(_._columns);let P=[];S?(S&&!S.children&&(S.children=[]),S.children.push(o),P=G2(I,S)):(I.push(o),P=I),W2(P),_._columns.value=P,_.updateOrderFns.push(E),o.type==="selection"&&(_.selectable.value=o.selectable,_.reserveSelection.value=o.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(_,o){var S;((S=o.getColumnIndex)==null?void 0:S.call(o))!==o.no&&(W2(_._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(_,o,S,E){const I=y(_._columns)||[];if(S)S.children.splice(S.children.findIndex(F=>F.id===o.id),1),oo(()=>{var F;((F=S.children)==null?void 0:F.length)===0&&delete S.children}),_._columns.value=G2(I,S);else{const F=I.indexOf(o);F>-1&&(I.splice(F,1),_._columns.value=I)}const P=_.updateOrderFns.indexOf(E);P>-1&&_.updateOrderFns.splice(P,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(_,o){const{prop:S,order:E,init:I}=o;if(S){const P=y(_.columns).find(F=>F.property===S);P&&(P.order=E,e.store.updateSort(P,S,E),e.store.commit("changeSortCondition",{init:I}))}},changeSortCondition(_,o){const{sortingColumn:S,sortProp:E,sortOrder:I}=_,P=y(S),F=y(E),B=y(I);B===null&&(_.sortingColumn.value=null,_.sortProp.value=null);const $={filter:!0};e.store.execQuery($),(!o||!(o.silent||o.init))&&e.emit("sort-change",{column:P,prop:F,order:B}),e.store.updateTableScrollY()},filterChange(_,o){const{column:S,values:E,silent:I}=o,P=e.store.updateFilters(S,E);e.store.execQuery(),I||e.emit("filter-change",P),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(_,o){e.store.toggleRowSelection(o),e.store.updateAllSelected()},setHoverRow(_,o){_.hoverRow.value=o},setCurrentRow(_,o){e.store.updateCurrentRow(o)}},commit:function(_,...o){const S=e.store.mutations;if(S[_])S[_].apply(e,[e.store.states].concat(o));else throw new Error(`Action not found: ${_}`)},updateTableScrollY:function(){oo(()=>e.layout.updateScrollY.apply(e.layout))}}}const Yv={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function sae(e,t){if(!e)throw new Error("Table is required.");const i=aae();return i.toggleAllSelection=ol(i._toggleAllSelection,10),Object.keys(Yv).forEach(s=>{Mz(Iz(t,s),s,i)}),lae(i,t),i}function lae(e,t){Object.keys(Yv).forEach(i=>{tn(()=>Iz(t,i),s=>{Mz(s,i,e)})})}function Mz(e,t,i){let s=e,d=Yv[t];typeof Yv[t]=="object"&&(d=d.key,s=s||Yv[t].default),i.states[d].value=s}function Iz(e,t){if(t.includes(".")){const i=t.split(".");let s=e;return i.forEach(d=>{s=s[d]}),s}else return e[t]}class cae{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=Se(null),this.scrollX=Se(!1),this.scrollY=Se(!1),this.bodyWidth=Se(null),this.fixedWidth=Se(null),this.rightFixedWidth=Se(null),this.gutterWidth=0;for(const i in t)Tr(t,i)&&(vi(this[i])?this[i].value=t[i]:this[i]=t[i]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const i=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(i!=null&&i.wrapRef)){let s=!0;const d=this.scrollY.value;return s=i.wrapRef.scrollHeight>i.wrapRef.clientHeight,this.scrollY.value=s,d!==s}return!1}setHeight(t,i="height"){if(!gr)return;const s=this.table.vnode.el;if(t=Xie(t),this.height.value=Number(t),!s&&(t||t===0))return oo(()=>this.setHeight(t,i));ao(t)?(s.style[i]=`${t}px`,this.updateElsHeight()):Zn(t)&&(s.style[i]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(s=>{s.isColumnGroup?t.push.apply(t,s.columns):t.push(s)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let i=t;for(;i.tagName!=="DIV";){if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1}updateColumnsWidth(){if(!gr)return;const t=this.fit,i=this.table.vnode.el.clientWidth;let s=0;const d=this.getFlattenColumns(),g=d.filter(S=>!ao(S.width));if(d.forEach(S=>{ao(S.width)&&S.realWidth&&(S.realWidth=null)}),g.length>0&&t){if(d.forEach(S=>{s+=Number(S.width||S.minWidth||80)}),s<=i){this.scrollX.value=!1;const S=i-s;if(g.length===1)g[0].realWidth=Number(g[0].minWidth||80)+S;else{const E=g.reduce((F,B)=>F+Number(B.minWidth||80),0),I=S/E;let P=0;g.forEach((F,B)=>{if(B===0)return;const $=Math.floor(Number(F.minWidth||80)*I);P+=$,F.realWidth=Number(F.minWidth||80)+$}),g[0].realWidth=Number(g[0].minWidth||80)+S-P}}else this.scrollX.value=!0,g.forEach(S=>{S.realWidth=Number(S.minWidth)});this.bodyWidth.value=Math.max(s,i),this.table.state.resizeState.value.width=this.bodyWidth.value}else d.forEach(S=>{!S.width&&!S.minWidth?S.realWidth=80:S.realWidth=Number(S.width||S.minWidth),s+=S.realWidth}),this.scrollX.value=s>i,this.bodyWidth.value=s;const _=this.store.states.fixedColumns.value;if(_.length>0){let S=0;_.forEach(E=>{S+=Number(E.realWidth||E.width)}),this.fixedWidth.value=S}const o=this.store.states.rightFixedColumns.value;if(o.length>0){let S=0;o.forEach(E=>{S+=Number(E.realWidth||E.width)}),this.rightFixedWidth.value=S}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}notifyObservers(t){this.observers.forEach(s=>{var d,g;switch(t){case"columns":(d=s.state)==null||d.onColumnsChange(this);break;case"scrollable":(g=s.state)==null||g.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:uae}=rc,dae=Ze({name:"ElTableFilterPanel",components:{ElCheckbox:rc,ElCheckboxGroup:uae,ElScrollbar:Pu,ElTooltip:qa,ElIcon:Gn,ArrowDown:cd,ArrowUp:iT},directives:{ClickOutside:rd},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:{type:String}},setup(e){const t=jo(),{t:i}=vr(),s=rn("table-filter"),d=t==null?void 0:t.parent;d.filterPanels.value[e.column.id]||(d.filterPanels.value[e.column.id]=t);const g=Se(!1),_=Se(null),o=te(()=>e.column&&e.column.filters),S=te(()=>e.column.filterClassName?`${s.b()} ${e.column.filterClassName}`:s.b()),E=te({get:()=>{var Q;return(((Q=e.column)==null?void 0:Q.filteredValue)||[])[0]},set:Q=>{I.value&&(typeof Q<"u"&&Q!==null?I.value.splice(0,1,Q):I.value.splice(0,1))}}),I=te({get(){return e.column?e.column.filteredValue||[]:[]},set(Q){e.column&&e.upDataColumn("filteredValue",Q)}}),P=te(()=>e.column?e.column.filterMultiple:!0),F=Q=>Q.value===E.value,B=()=>{g.value=!1},$=Q=>{Q.stopPropagation(),g.value=!g.value},z=()=>{g.value=!1},H=()=>{Z(I.value),B()},U=()=>{I.value=[],Z(I.value),B()},ie=Q=>{E.value=Q,Z(typeof Q<"u"&&Q!==null?I.value:[]),B()},Z=Q=>{e.store.commit("filterChange",{column:e.column,values:Q}),e.store.updateAllSelected()};tn(g,Q=>{e.column&&e.upDataColumn("filterOpened",Q)},{immediate:!0});const G=te(()=>{var Q,oe;return(oe=(Q=_.value)==null?void 0:Q.popperRef)==null?void 0:oe.contentRef});return{tooltipVisible:g,multiple:P,filterClassName:S,filteredValue:I,filterValue:E,filters:o,handleConfirm:H,handleReset:U,handleSelect:ie,isActive:F,t:i,ns:s,showFilterPanel:$,hideFilterPanel:z,popperPaneRef:G,tooltip:_}}});function hae(e,t,i,s,d,g){const _=Go("el-checkbox"),o=Go("el-checkbox-group"),S=Go("el-scrollbar"),E=Go("arrow-up"),I=Go("arrow-down"),P=Go("el-icon"),F=Go("el-tooltip"),B=Kb("click-outside");return se(),Rt(F,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:"","append-to":e.appendTo},{content:at(()=>[e.multiple?(se(),Pe("div",{key:0},[He("div",{class:de(e.ns.e("content"))},[Qe(S,{"wrap-class":e.ns.e("wrap")},{default:at(()=>[Qe(o,{modelValue:e.filteredValue,"onUpdate:modelValue":$=>e.filteredValue=$,class:de(e.ns.e("checkbox-group"))},{default:at(()=>[(se(!0),Pe(eo,null,tr(e.filters,$=>(se(),Rt(_,{key:$.value,value:$.value},{default:at(()=>[nr(wn($.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),He("div",{class:de(e.ns.e("bottom"))},[He("button",{class:de({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:e.handleConfirm},wn(e.t("el.table.confirmFilter")),11,["disabled","onClick"]),He("button",{type:"button",onClick:e.handleReset},wn(e.t("el.table.resetFilter")),9,["onClick"])],2)])):(se(),Pe("ul",{key:1,class:de(e.ns.e("list"))},[He("li",{class:de([e.ns.e("list-item"),{[e.ns.is("active")]:e.filterValue===void 0||e.filterValue===null}]),onClick:$=>e.handleSelect(null)},wn(e.t("el.table.clearFilter")),11,["onClick"]),(se(!0),Pe(eo,null,tr(e.filters,$=>(se(),Pe("li",{key:$.value,class:de([e.ns.e("list-item"),e.ns.is("active",e.isActive($))]),label:$.value,onClick:z=>e.handleSelect($.value)},wn($.text),11,["label","onClick"]))),128))],2))]),default:at(()=>[zo((se(),Pe("span",{class:de([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:e.showFilterPanel},[Qe(P,null,{default:at(()=>[_t(e.$slots,"filter-icon",{},()=>[e.column.filterOpened?(se(),Rt(E,{key:0})):(se(),Rt(I,{key:1}))])]),_:3})],10,["onClick"])),[[B,e.hideFilterPanel,e.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var fae=bn(dae,[["render",hae],["__file","filter-panel.vue"]]);function Az(e){const t=jo();qb(()=>{i.value.addObserver(t)}),No(()=>{s(i.value),d(i.value)}),Au(()=>{s(i.value),d(i.value)}),Eh(()=>{i.value.removeObserver(t)});const i=te(()=>{const g=e.layout;if(!g)throw new Error("Can not find table layout.");return g}),s=g=>{var _;const o=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col"))||[];if(!o.length)return;const S=g.getFlattenColumns(),E={};S.forEach(I=>{E[I.id]=I});for(let I=0,P=o.length;I<P;I++){const F=o[I],B=F.getAttribute("name"),$=E[B];$&&F.setAttribute("width",$.realWidth||$.width)}},d=g=>{var _,o;const S=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let I=0,P=S.length;I<P;I++)S[I].setAttribute("width",g.scrollY.value?g.gutterWidth:"0");const E=((o=e.vnode.el)==null?void 0:o.querySelectorAll("th.gutter"))||[];for(let I=0,P=E.length;I<P;I++){const F=E[I];F.style.width=g.scrollY.value?`${g.gutterWidth}px`:"0",F.style.display=g.scrollY.value?"":"none"}};return{tableLayout:i.value,onColumnsChange:s,onScrollableChange:d}}const Ru=Symbol("ElTable");function pae(e,t){const i=jo(),s=Un(Ru),d=z=>{z.stopPropagation()},g=(z,H)=>{!H.filters&&H.sortable?$(z,H,!1):H.filterable&&!H.sortable&&d(z),s==null||s.emit("header-click",H,z)},_=(z,H)=>{s==null||s.emit("header-contextmenu",H,z)},o=Se(null),S=Se(!1),E=Se({}),I=(z,H)=>{if(gr&&!(H.children&&H.children.length>0)&&o.value&&e.border){S.value=!0;const U=s;t("set-drag-visible",!0);const Z=(U==null?void 0:U.vnode.el).getBoundingClientRect().left,G=i.vnode.el.querySelector(`th.${H.id}`),Q=G.getBoundingClientRect(),oe=Q.left-Z+30;Yl(G,"noclick"),E.value={startMouseLeft:z.clientX,startLeft:Q.right-Z,startColumnLeft:Q.left-Z,tableLeft:Z};const le=U==null?void 0:U.refs.resizeProxy;le.style.left=`${E.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const me=ce=>{const pe=ce.clientX-E.value.startMouseLeft,ye=E.value.startLeft+pe;le.style.left=`${Math.max(oe,ye)}px`},fe=()=>{if(S.value){const{startColumnLeft:ce,startLeft:pe}=E.value,De=Number.parseInt(le.style.left,10)-ce;H.width=H.realWidth=De,U==null||U.emit("header-dragend",H.width,pe-ce,H,z),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",S.value=!1,o.value=null,E.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",me),document.removeEventListener("mouseup",fe),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{fs(G,"noclick")},0)};document.addEventListener("mousemove",me),document.addEventListener("mouseup",fe)}},P=(z,H)=>{var U;if(H.children&&H.children.length>0)return;const ie=z.target;if(!Tl(ie))return;const Z=ie==null?void 0:ie.closest("th");if(!(!H||!H.resizable||!Z)&&!S.value&&e.border){const G=Z.getBoundingClientRect(),Q=document.body.style,oe=((U=Z.parentNode)==null?void 0:U.lastElementChild)===Z;G.width>12&&G.right-z.pageX<8&&!oe?(Q.cursor="col-resize",el(Z,"is-sortable")&&(Z.style.cursor="col-resize"),o.value=H):S.value||(Q.cursor="",el(Z,"is-sortable")&&(Z.style.cursor="pointer"),o.value=null)}},F=()=>{gr&&(document.body.style.cursor="")},B=({order:z,sortOrders:H})=>{if(z==="")return H[0];const U=H.indexOf(z||null);return H[U>H.length-2?0:U+1]},$=(z,H,U)=>{var ie;z.stopPropagation();const Z=H.order===U?null:U||B(H),G=(ie=z.target)==null?void 0:ie.closest("th");if(G&&el(G,"noclick")){fs(G,"noclick");return}if(!H.sortable)return;const Q=z.currentTarget;if(["ascending","descending"].some(ce=>el(Q,ce)&&!H.sortOrders.includes(ce)))return;const oe=e.store.states;let le=oe.sortProp.value,me;const fe=oe.sortingColumn.value;(fe!==H||fe===H&&fe.order===null)&&(fe&&(fe.order=null),oe.sortingColumn.value=H,le=H.property),Z?me=H.order=Z:me=H.order=null,oe.sortProp.value=le,oe.sortOrder.value=me,s==null||s.store.commit("changeSortCondition")};return{handleHeaderClick:g,handleHeaderContextMenu:_,handleMouseDown:I,handleMouseMove:P,handleMouseOut:F,handleSortClick:$,handleFilterClick:d}}function mae(e){const t=Un(Ru),i=rn("table");return{getHeaderRowStyle:o=>{const S=t==null?void 0:t.props.headerRowStyle;return Qn(S)?S.call(null,{rowIndex:o}):S},getHeaderRowClass:o=>{const S=[],E=t==null?void 0:t.props.headerRowClassName;return Zn(E)?S.push(E):Qn(E)&&S.push(E.call(null,{rowIndex:o})),S.join(" ")},getHeaderCellStyle:(o,S,E,I)=>{var P;let F=(P=t==null?void 0:t.props.headerCellStyle)!=null?P:{};Qn(F)&&(F=F.call(null,{rowIndex:o,columnIndex:S,row:E,column:I}));const B=QT(S,I.fixed,e.store,E);return Am(B,"left"),Am(B,"right"),Object.assign({},F,B)},getHeaderCellClass:(o,S,E,I)=>{const P=JT(i.b(),S,I.fixed,e.store,E),F=[I.id,I.order,I.headerAlign,I.className,I.labelClassName,...P];I.children||F.push("is-leaf"),I.sortable&&F.push("is-sortable");const B=t==null?void 0:t.props.headerCellClassName;return Zn(B)?F.push(B):Qn(B)&&F.push(B.call(null,{rowIndex:o,columnIndex:S,row:E,column:I})),F.push(i.e("cell")),F.filter($=>!!$).join(" ")}}}const kz=e=>{const t=[];return e.forEach(i=>{i.children?(t.push(i),t.push.apply(t,kz(i.children))):t.push(i)}),t},Pz=e=>{let t=1;const i=(g,_)=>{if(_&&(g.level=_.level+1,t<g.level&&(t=g.level)),g.children){let o=0;g.children.forEach(S=>{i(S,g),o+=S.colSpan}),g.colSpan=o}else g.colSpan=1};e.forEach(g=>{g.level=1,i(g,void 0)});const s=[];for(let g=0;g<t;g++)s.push([]);return kz(e).forEach(g=>{g.children?(g.rowSpan=1,g.children.forEach(_=>_.isSubColumn=!0)):g.rowSpan=t-g.level+1,s[g.level-1].push(g)}),s};function gae(e){const t=Un(Ru),i=te(()=>Pz(e.store.states.originColumns.value));return{isGroup:te(()=>{const g=i.value.length>1;return g&&t&&(t.state.isGroup.value=!0),g}),toggleAllSelection:g=>{g.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:i}}var vae=Ze({name:"ElTableHeader",components:{ElCheckbox:rc},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String}},setup(e,{emit:t}){const i=jo(),s=Un(Ru),d=rn("table"),g=Se({}),{onColumnsChange:_,onScrollableChange:o}=Az(s),S=(s==null?void 0:s.props.tableLayout)==="auto",E=Pr(new Map),I=Se(),P=()=>{setTimeout(()=>{E.size>0&&(E.forEach((ce,pe)=>{const ye=I.value.querySelector(`.${pe.replace(/\s/g,".")}`);if(ye){const De=ye.getBoundingClientRect().width;ce.width=De}}),E.clear())})};tn(E,P),No(async()=>{await oo(),await oo();const{prop:ce,order:pe}=e.defaultSort;s==null||s.store.commit("sort",{prop:ce,order:pe,init:!0}),P()});const{handleHeaderClick:F,handleHeaderContextMenu:B,handleMouseDown:$,handleMouseMove:z,handleMouseOut:H,handleSortClick:U,handleFilterClick:ie}=pae(e,t),{getHeaderRowStyle:Z,getHeaderRowClass:G,getHeaderCellStyle:Q,getHeaderCellClass:oe}=mae(e),{isGroup:le,toggleAllSelection:me,columnRows:fe}=gae(e);return i.state={onColumnsChange:_,onScrollableChange:o},i.filterPanels=g,{ns:d,filterPanels:g,onColumnsChange:_,onScrollableChange:o,columnRows:fe,getHeaderRowClass:G,getHeaderRowStyle:Z,getHeaderCellClass:oe,getHeaderCellStyle:Q,handleHeaderClick:F,handleHeaderContextMenu:B,handleMouseDown:$,handleMouseMove:z,handleMouseOut:H,handleSortClick:U,handleFilterClick:ie,isGroup:le,toggleAllSelection:me,saveIndexSelection:E,isTableLayoutAuto:S,theadRef:I,updateFixedColumnStyle:P}},render(){const{ns:e,isGroup:t,columnRows:i,getHeaderCellStyle:s,getHeaderCellClass:d,getHeaderRowClass:g,getHeaderRowStyle:_,handleHeaderClick:o,handleHeaderContextMenu:S,handleMouseDown:E,handleMouseMove:I,handleSortClick:P,handleMouseOut:F,store:B,$parent:$,saveIndexSelection:z,isTableLayoutAuto:H}=this;let U=1;return lo("thead",{ref:"theadRef",class:{[e.is("group")]:t}},i.map((ie,Z)=>lo("tr",{class:g(Z),key:Z,style:_(Z)},ie.map((G,Q)=>{G.rowSpan>U&&(U=G.rowSpan);const oe=d(Z,Q,ie,G);return H&&G.fixed&&z.set(oe,G),lo("th",{class:oe,colspan:G.colSpan,key:`${G.id}-thead`,rowspan:G.rowSpan,style:s(Z,Q,ie,G),onClick:le=>{le.currentTarget.classList.contains("noclick")||o(le,G)},onContextmenu:le=>S(le,G),onMousedown:le=>E(le,G),onMousemove:le=>I(le,G),onMouseout:F},[lo("div",{class:["cell",G.filteredValue&&G.filteredValue.length>0?"highlight":""]},[G.renderHeader?G.renderHeader({column:G,$index:Q,store:B,_self:$}):G.label,G.sortable&&lo("span",{onClick:le=>P(le,G),class:"caret-wrapper"},[lo("i",{onClick:le=>P(le,G,"ascending"),class:"sort-caret ascending"}),lo("i",{onClick:le=>P(le,G,"descending"),class:"sort-caret descending"})]),G.filterable&&lo(fae,{store:B,placement:G.filterPlacement||"bottom-start",appendTo:$.appendFilterPanelTo,column:G,upDataColumn:(le,me)=>{G[le]=me}},{"filter-icon":()=>G.renderFilterIcon?G.renderFilterIcon({filterOpened:G.filterOpened}):null})])])}))))}});function Nw(e,t,i=.03){return e-t>i}function _ae(e){const t=Un(Ru),i=Se(""),s=Se(lo("div")),d=($,z,H)=>{var U;const ie=t,Z=Bw($);let G;const Q=(U=ie==null?void 0:ie.vnode.el)==null?void 0:U.dataset.prefix;Z&&(G=OP({columns:e.store.states.columns.value},Z,Q),G&&(ie==null||ie.emit(`cell-${H}`,z,G,Z,$))),ie==null||ie.emit(`row-${H}`,z,G,$)},g=($,z)=>{d($,z,"dblclick")},_=($,z)=>{e.store.commit("setCurrentRow",z),d($,z,"click")},o=($,z)=>{d($,z,"contextmenu")},S=ol($=>{e.store.commit("setHoverRow",$)},30),E=ol(()=>{e.store.commit("setHoverRow",null)},30),I=$=>{const z=window.getComputedStyle($,null),H=Number.parseInt(z.paddingLeft,10)||0,U=Number.parseInt(z.paddingRight,10)||0,ie=Number.parseInt(z.paddingTop,10)||0,Z=Number.parseInt(z.paddingBottom,10)||0;return{left:H,right:U,top:ie,bottom:Z}},P=($,z,H)=>{let U=z.target.parentNode;for(;$>1&&(U=U==null?void 0:U.nextSibling,!(!U||U.nodeName!=="TR"));)H(U,"hover-row hover-fixed-row"),$--};return{handleDoubleClick:g,handleClick:_,handleContextMenu:o,handleMouseEnter:S,handleMouseLeave:E,handleCellMouseEnter:($,z,H)=>{var U;const ie=t,Z=Bw($),G=(U=ie==null?void 0:ie.vnode.el)==null?void 0:U.dataset.prefix;if(Z){const Ae=OP({columns:e.store.states.columns.value},Z,G);Z.rowSpan>1&&P(Z.rowSpan,$,Yl);const Ce=ie.hoverState={cell:Z,column:Ae,row:z};ie==null||ie.emit("cell-mouse-enter",Ce.row,Ce.column,Ce.cell,$)}if(!H)return;const Q=$.target.querySelector(".cell");if(!(el(Q,`${G}-tooltip`)&&Q.childNodes.length))return;const oe=document.createRange();oe.setStart(Q,0),oe.setEnd(Q,Q.childNodes.length);const{width:le,height:me}=oe.getBoundingClientRect(),{width:fe,height:ce}=Q.getBoundingClientRect(),{top:pe,left:ye,right:De,bottom:tt}=I(Q),Me=ye+De,xe=pe+tt;(Nw(le+Me,fe)||Nw(me+xe,ce)||Nw(Q.scrollWidth,fe))&&eae(H,Z.innerText||Z.textContent,Z,ie)},handleCellMouseLeave:$=>{const z=Bw($);if(!z)return;z.rowSpan>1&&P(z.rowSpan,$,fs);const H=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",H==null?void 0:H.row,H==null?void 0:H.column,H==null?void 0:H.cell,$)},tooltipContent:i,tooltipTrigger:s}}function yae(e){const t=Un(Ru),i=rn("table");return{getRowStyle:(E,I)=>{const P=t==null?void 0:t.props.rowStyle;return Qn(P)?P.call(null,{row:E,rowIndex:I}):P||null},getRowClass:(E,I)=>{const P=[i.e("row")];t!=null&&t.props.highlightCurrentRow&&E===e.store.states.currentRow.value&&P.push("current-row"),e.stripe&&I%2===1&&P.push(i.em("row","striped"));const F=t==null?void 0:t.props.rowClassName;return Zn(F)?P.push(F):Qn(F)&&P.push(F.call(null,{row:E,rowIndex:I})),P},getCellStyle:(E,I,P,F)=>{const B=t==null?void 0:t.props.cellStyle;let $=B??{};Qn(B)&&($=B.call(null,{rowIndex:E,columnIndex:I,row:P,column:F}));const z=QT(I,e==null?void 0:e.fixed,e.store);return Am(z,"left"),Am(z,"right"),Object.assign({},$,z)},getCellClass:(E,I,P,F,B)=>{const $=JT(i.b(),I,e==null?void 0:e.fixed,e.store,void 0,B),z=[F.id,F.align,F.className,...$],H=t==null?void 0:t.props.cellClassName;return Zn(H)?z.push(H):Qn(H)&&z.push(H.call(null,{rowIndex:E,columnIndex:I,row:P,column:F})),z.push(i.e("cell")),z.filter(U=>!!U).join(" ")},getSpan:(E,I,P,F)=>{let B=1,$=1;const z=t==null?void 0:t.props.spanMethod;if(Qn(z)){const H=z({row:E,column:I,rowIndex:P,columnIndex:F});fn(H)?(B=H[0],$=H[1]):typeof H=="object"&&(B=H.rowspan,$=H.colspan)}return{rowspan:B,colspan:$}},getColspanRealWidth:(E,I,P)=>{if(I<1)return E[P].realWidth;const F=E.map(({realWidth:B,width:$})=>B||$).slice(P,P+I);return Number(F.reduce((B,$)=>Number(B)+Number($),-1))}}}const bae=Ze({name:"TableTdWrapper"}),xae=Ze({...bae,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(e){return(t,i)=>(se(),Pe("td",{colspan:e.colspan,rowspan:e.rowspan},[_t(t.$slots,"default")],8,["colspan","rowspan"]))}});var wae=bn(xae,[["__file","td-wrapper.vue"]]);function Sae(e){const t=Un(Ru),i=rn("table"),{handleDoubleClick:s,handleClick:d,handleContextMenu:g,handleMouseEnter:_,handleMouseLeave:o,handleCellMouseEnter:S,handleCellMouseLeave:E,tooltipContent:I,tooltipTrigger:P}=_ae(e),{getRowStyle:F,getRowClass:B,getCellStyle:$,getCellClass:z,getSpan:H,getColspanRealWidth:U}=yae(e),ie=te(()=>e.store.states.columns.value.findIndex(({type:le})=>le==="default")),Z=(le,me)=>{const fe=t.props.rowKey;return fe?ds(le,fe):me},G=(le,me,fe,ce=!1)=>{const{tooltipEffect:pe,tooltipOptions:ye,store:De}=e,{indent:tt,columns:Me}=De.states,xe=B(le,me);let Ae=!0;return fe&&(xe.push(i.em("row",`level-${fe.level}`)),Ae=fe.display),lo("tr",{style:[Ae?null:{},F(le,me)],class:xe,key:Z(le,me),onDblclick:ge=>s(ge,le),onClick:ge=>d(ge,le),onContextmenu:ge=>g(ge,le),onMouseenter:()=>_(me),onMouseleave:o},Me.value.map((ge,Ne)=>{const{rowspan:We,colspan:ot}=H(le,ge,me,Ne);if(!We||!ot)return null;const Oe=Object.assign({},ge);Oe.realWidth=U(Me.value,ot,Ne);const Ct={store:e.store,_self:e.context||t,column:Oe,row:le,$index:me,cellIndex:Ne,expanded:ce};Ne===ie.value&&fe&&(Ct.treeNode={indent:fe.level*tt.value,level:fe.level},ai(fe.expanded)&&(Ct.treeNode.expanded=fe.expanded,"loading"in fe&&(Ct.treeNode.loading=fe.loading),"noLazyChildren"in fe&&(Ct.treeNode.noLazyChildren=fe.noLazyChildren)));const Mt=`${Z(le,me)},${Ne}`,zt=Oe.columnKey||Oe.rawColumnKey||"",bt=ge.showOverflowTooltip&&PO({effect:pe},ye,ge.showOverflowTooltip);return lo(wae,{style:$(me,Ne,le,ge),class:z(me,Ne,le,ge,ot-1),key:`${zt}${Mt}`,rowspan:We,colspan:ot,onMouseenter:Kt=>S(Kt,le,bt),onMouseleave:E},{default:()=>Q(Ne,ge,Ct)})}))},Q=(le,me,fe)=>me.renderCell(fe);return{wrappedRowRender:(le,me)=>{const fe=e.store,{isRowExpanded:ce,assertRowKey:pe}=fe,{treeData:ye,lazyTreeNodeMap:De,childrenColumnName:tt,rowKey:Me}=fe.states,xe=fe.states.columns.value;if(xe.some(({type:Ce})=>Ce==="expand")){const Ce=ce(le),ge=G(le,me,void 0,Ce),Ne=t.renderExpanded;return Ce?Ne?[[ge,lo("tr",{key:`expanded-row__${ge.key}`},[lo("td",{colspan:xe.length,class:`${i.e("cell")} ${i.e("expanded-cell")}`},[Ne({row:le,$index:me,store:fe,expanded:Ce})])])]]:(console.error("[Element Error]renderExpanded is required."),ge):[[ge]]}else if(Object.keys(ye.value).length){pe();const Ce=ds(le,Me.value);let ge=ye.value[Ce],Ne=null;ge&&(Ne={expanded:ge.expanded,level:ge.level,display:!0},ai(ge.lazy)&&(ai(ge.loaded)&&ge.loaded&&(Ne.noLazyChildren=!(ge.children&&ge.children.length)),Ne.loading=ge.loading));const We=[G(le,me,Ne)];if(ge){let ot=0;const Oe=(Mt,zt)=>{Mt&&Mt.length&&zt&&Mt.forEach(bt=>{const Kt={display:zt.display&&zt.expanded,level:zt.level+1,expanded:!1,noLazyChildren:!1,loading:!1},$t=ds(bt,Me.value);if($t==null)throw new Error("For nested data item, row-key is required.");if(ge={...ye.value[$t]},ge&&(Kt.expanded=ge.expanded,ge.level=ge.level||Kt.level,ge.display=!!(ge.expanded&&Kt.display),ai(ge.lazy)&&(ai(ge.loaded)&&ge.loaded&&(Kt.noLazyChildren=!(ge.children&&ge.children.length)),Kt.loading=ge.loading)),ot++,We.push(G(bt,me+ot,Kt)),ge){const Re=De.value[$t]||bt[tt.value];Oe(Re,ge)}})};ge.display=!0;const Ct=De.value[Ce]||le[tt.value];Oe(Ct,ge)}return We}else return G(le,me,void 0)},tooltipContent:I,tooltipTrigger:P}}const Tae={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var Cae=Ze({name:"ElTableBody",props:Tae,setup(e){const t=jo(),i=Un(Ru),s=rn("table"),{wrappedRowRender:d,tooltipContent:g,tooltipTrigger:_}=Sae(e),{onColumnsChange:o,onScrollableChange:S}=Az(i),E=[];return tn(e.store.states.hoverRow,(I,P)=>{var F;const B=t==null?void 0:t.vnode.el,$=Array.from((B==null?void 0:B.children)||[]).filter(U=>U==null?void 0:U.classList.contains(`${s.e("row")}`));let z=I;const H=(F=$[z])==null?void 0:F.childNodes;if(H!=null&&H.length){let U=0;Array.from(H).reduce((Z,G,Q)=>{var oe,le;return((oe=H[Q])==null?void 0:oe.colSpan)>1&&(U=(le=H[Q])==null?void 0:le.colSpan),G.nodeName!=="TD"&&U===0&&Z.push(Q),U>0&&U--,Z},[]).forEach(Z=>{var G;for(z=I;z>0;){const Q=(G=$[z-1])==null?void 0:G.childNodes;if(Q[Z]&&Q[Z].nodeName==="TD"&&Q[Z].rowSpan>1){Yl(Q[Z],"hover-cell"),E.push(Q[Z]);break}z--}})}else E.forEach(U=>fs(U,"hover-cell")),E.length=0;!e.store.states.isComplex.value||!gr||_h(()=>{const U=$[P],ie=$[I];U&&!U.classList.contains("hover-fixed-row")&&fs(U,"hover-row"),ie&&Yl(ie,"hover-row")})}),Eh(()=>{var I;(I=ql)==null||I()}),{ns:s,onColumnsChange:o,onScrollableChange:S,wrappedRowRender:d,tooltipContent:g,tooltipTrigger:_}},render(){const{wrappedRowRender:e,store:t}=this,i=t.states.data.value||[];return lo("tbody",{tabIndex:-1},[i.reduce((s,d)=>s.concat(e(d,s.length)),[])])}});function Eae(){const e=Un(Ru),t=e==null?void 0:e.store,i=te(()=>t.states.fixedLeafColumnsLength.value),s=te(()=>t.states.rightFixedColumns.value.length),d=te(()=>t.states.columns.value.length),g=te(()=>t.states.fixedColumns.value.length),_=te(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:i,rightFixedLeafCount:s,columnsCount:d,leftFixedCount:g,rightFixedCount:_,columns:t.states.columns}}function Mae(e){const{columns:t}=Eae(),i=rn("table");return{getCellClasses:(g,_)=>{const o=g[_],S=[i.e("cell"),o.id,o.align,o.labelClassName,...JT(i.b(),_,o.fixed,e.store)];return o.className&&S.push(o.className),o.children||S.push(i.is("leaf")),S},getCellStyles:(g,_)=>{const o=QT(_,g.fixed,e.store);return Am(o,"left"),Am(o,"right"),o},columns:t}}var Iae=Ze({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const{getCellClasses:t,getCellStyles:i,columns:s}=Mae(e);return{ns:rn("table"),getCellClasses:t,getCellStyles:i,columns:s}},render(){const{columns:e,getCellStyles:t,getCellClasses:i,summaryMethod:s,sumText:d}=this,g=this.store.states.data.value;let _=[];return s?_=s({columns:e,data:g}):e.forEach((o,S)=>{if(S===0){_[S]=d;return}const E=g.map(B=>Number(B[o.property])),I=[];let P=!0;E.forEach(B=>{if(!Number.isNaN(+B)){P=!1;const $=`${B}`.split(".")[1];I.push($?$.length:0)}});const F=Math.max.apply(null,I);P?_[S]="":_[S]=E.reduce((B,$)=>{const z=Number($);return Number.isNaN(+z)?B:Number.parseFloat((B+$).toFixed(Math.min(F,20)))},0)}),lo(lo("tfoot",[lo("tr",{},[...e.map((o,S)=>lo("td",{key:S,colspan:o.colSpan,rowspan:o.rowSpan,class:i(e,S),style:t(o,S)},[lo("div",{class:["cell",o.labelClassName]},[_[S]])]))])]))}});function Aae(e){return{setCurrentRow:P=>{e.commit("setCurrentRow",P)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(P,F,B=!0)=>{e.toggleRowSelection(P,F,!1,B),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:P=>{e.clearFilter(P)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(P,F)=>{e.toggleRowExpansionAdapter(P,F)},clearSort:()=>{e.clearSort()},sort:(P,F)=>{e.commit("sort",{prop:P,order:F})},updateKeyChildren:(P,F)=>{e.updateKeyChildren(P,F)}}}function kae(e,t,i,s){const d=Se(!1),g=Se(null),_=Se(!1),o=Ce=>{_.value=Ce},S=Se({width:null,height:null,headerHeight:null}),E=Se(!1),I={display:"inline-block",verticalAlign:"middle"},P=Se(),F=Se(0),B=Se(0),$=Se(0),z=Se(0),H=Se(0);Ha(()=>{t.setHeight(e.height)}),Ha(()=>{t.setMaxHeight(e.maxHeight)}),tn(()=>[e.currentRowKey,i.states.rowKey],([Ce,ge])=>{!y(ge)||!y(Ce)||i.setCurrentRowKey(`${Ce}`)},{immediate:!0}),tn(()=>e.data,Ce=>{s.store.commit("setData",Ce)},{immediate:!0,deep:!0}),Ha(()=>{e.expandRowKeys&&i.setExpandRowKeysAdapter(e.expandRowKeys)});const U=()=>{s.store.commit("setHoverRow",null),s.hoverState&&(s.hoverState=null)},ie=(Ce,ge)=>{const{pixelX:Ne,pixelY:We}=ge;Math.abs(Ne)>=Math.abs(We)&&(s.refs.bodyWrapper.scrollLeft+=ge.pixelX/5)},Z=te(()=>e.height||e.maxHeight||i.states.fixedColumns.value.length>0||i.states.rightFixedColumns.value.length>0),G=te(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),Q=()=>{Z.value&&t.updateElsHeight(),t.updateColumnsWidth(),requestAnimationFrame(fe)};No(async()=>{await oo(),i.updateColumns(),ce(),requestAnimationFrame(Q);const Ce=s.vnode.el,ge=s.refs.headerWrapper;e.flexible&&Ce&&Ce.parentElement&&(Ce.parentElement.style.minWidth="0"),S.value={width:P.value=Ce.offsetWidth,height:Ce.offsetHeight,headerHeight:e.showHeader&&ge?ge.offsetHeight:null},i.states.columns.value.forEach(Ne=>{Ne.filteredValue&&Ne.filteredValue.length&&s.store.commit("filterChange",{column:Ne,values:Ne.filteredValue,silent:!0})}),s.$ready=!0});const oe=(Ce,ge)=>{if(!Ce)return;const Ne=Array.from(Ce.classList).filter(We=>!We.startsWith("is-scrolling-"));Ne.push(t.scrollX.value?ge:"is-scrolling-none"),Ce.className=Ne.join(" ")},le=Ce=>{const{tableWrapper:ge}=s.refs;oe(ge,Ce)},me=Ce=>{const{tableWrapper:ge}=s.refs;return!!(ge&&ge.classList.contains(Ce))},fe=function(){if(!s.refs.scrollBarRef)return;if(!t.scrollX.value){const Mt="is-scrolling-none";me(Mt)||le(Mt);return}const Ce=s.refs.scrollBarRef.wrapRef;if(!Ce)return;const{scrollLeft:ge,offsetWidth:Ne,scrollWidth:We}=Ce,{headerWrapper:ot,footerWrapper:Oe}=s.refs;ot&&(ot.scrollLeft=ge),Oe&&(Oe.scrollLeft=ge);const Ct=We-Ne-1;ge>=Ct?le("is-scrolling-right"):le(ge===0?"is-scrolling-left":"is-scrolling-middle")},ce=()=>{s.refs.scrollBarRef&&(s.refs.scrollBarRef.wrapRef&&qr(s.refs.scrollBarRef.wrapRef,"scroll",fe,{passive:!0}),e.fit?Mi(s.vnode.el,pe):qr(window,"resize",pe),Mi(s.refs.bodyWrapper,()=>{var Ce,ge;pe(),(ge=(Ce=s.refs)==null?void 0:Ce.scrollBarRef)==null||ge.update()}))},pe=()=>{var Ce,ge,Ne,We;const ot=s.vnode.el;if(!s.$ready||!ot)return;let Oe=!1;const{width:Ct,height:Mt,headerHeight:zt}=S.value,bt=P.value=ot.offsetWidth;Ct!==bt&&(Oe=!0);const Kt=ot.offsetHeight;(e.height||Z.value)&&Mt!==Kt&&(Oe=!0);const $t=e.tableLayout==="fixed"?s.refs.headerWrapper:(Ce=s.refs.tableHeaderRef)==null?void 0:Ce.$el;e.showHeader&&($t==null?void 0:$t.offsetHeight)!==zt&&(Oe=!0),F.value=((ge=s.refs.tableWrapper)==null?void 0:ge.scrollHeight)||0,$.value=($t==null?void 0:$t.scrollHeight)||0,z.value=((Ne=s.refs.footerWrapper)==null?void 0:Ne.offsetHeight)||0,H.value=((We=s.refs.appendWrapper)==null?void 0:We.offsetHeight)||0,B.value=F.value-$.value-z.value-H.value,Oe&&(S.value={width:bt,height:Kt,headerHeight:e.showHeader&&($t==null?void 0:$t.offsetHeight)||0},Q())},ye=na(),De=te(()=>{const{bodyWidth:Ce,scrollY:ge,gutterWidth:Ne}=t;return Ce.value?`${Ce.value-(ge.value?Ne:0)}px`:""}),tt=te(()=>e.maxHeight?"fixed":e.tableLayout),Me=te(()=>{if(e.data&&e.data.length)return null;let Ce="100%";e.height&&B.value&&(Ce=`${B.value}px`);const ge=P.value;return{width:ge?`${ge}px`:"",height:Ce}}),xe=te(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${$.value+z.value}px)`}:{maxHeight:`${e.maxHeight-$.value-z.value}px`}:{});return{isHidden:d,renderExpanded:g,setDragVisible:o,isGroup:E,handleMouseLeave:U,handleHeaderFooterMousewheel:ie,tableSize:ye,emptyBlockStyle:Me,handleFixedMousewheel:(Ce,ge)=>{const Ne=s.refs.bodyWrapper;if(Math.abs(ge.spinY)>0){const We=Ne.scrollTop;ge.pixelY<0&&We!==0&&Ce.preventDefault(),ge.pixelY>0&&Ne.scrollHeight-Ne.clientHeight>We&&Ce.preventDefault(),Ne.scrollTop+=Math.ceil(ge.pixelY/5)}else Ne.scrollLeft+=Math.ceil(ge.pixelX/5)},resizeProxyVisible:_,bodyWidth:De,resizeState:S,doLayout:Q,tableBodyStyles:G,tableLayout:tt,scrollbarViewStyle:I,scrollbarStyle:xe}}function Pae(e){const t=Se(),i=()=>{const d=e.vnode.el.querySelector(".hidden-columns"),g={childList:!0,subtree:!0},_=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{_.forEach(o=>o())}),t.value.observe(d,g)};No(()=>{i()}),Eh(()=>{var s;(s=t.value)==null||s.disconnect()})}var Rae={data:{type:Array,default:()=>[]},size:ia,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0}};function Rz(e){const t=e.tableLayout==="auto";let i=e.columns||[];t&&i.every(d=>d.width===void 0)&&(i=[]);const s=d=>{const g={key:`${e.tableLayout}_${d.id}`,style:{},name:void 0};return t?g.style={width:`${d.width}px`}:g.name=d.id,g};return lo("colgroup",{},i.map(d=>lo("col",s(d))))}Rz.props=["columns","tableLayout"];const Oae=()=>{const e=Se(),t=(g,_)=>{const o=e.value;o&&o.scrollTo(g,_)},i=(g,_)=>{const o=e.value;o&&ao(_)&&["Top","Left"].includes(g)&&o[`setScroll${g}`](_)};return{scrollBarRef:e,scrollTo:t,setScrollTop:g=>i("Top",g),setScrollLeft:g=>i("Left",g)}};var FP=!1,wf,q2,K2,X0,J0,Oz,Q0,Z2,Y2,X2,Lz,J2,Q2,Dz,zz;function Qs(){if(!FP){FP=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),i=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(J2=/\b(iPhone|iP[ao]d)/.exec(e),Q2=/\b(iP[ao]d)/.exec(e),X2=/Android/i.exec(e),Dz=/FBAN\/\w+;/i.exec(e),zz=/Mobile/i.exec(e),Lz=!!/Win64/.exec(e),t){wf=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,wf&&document&&document.documentMode&&(wf=document.documentMode);var s=/(?:Trident\/(\d+.\d+))/.exec(e);Oz=s?parseFloat(s[1])+4:wf,q2=t[2]?parseFloat(t[2]):NaN,K2=t[3]?parseFloat(t[3]):NaN,X0=t[4]?parseFloat(t[4]):NaN,X0?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),J0=t&&t[1]?parseFloat(t[1]):NaN):J0=NaN}else wf=q2=K2=J0=X0=NaN;if(i){if(i[1]){var d=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);Q0=d?parseFloat(d[1].replace("_",".")):!0}else Q0=!1;Z2=!!i[2],Y2=!!i[3]}else Q0=Z2=Y2=!1}}var eS={ie:function(){return Qs()||wf},ieCompatibilityMode:function(){return Qs()||Oz>wf},ie64:function(){return eS.ie()&&Lz},firefox:function(){return Qs()||q2},opera:function(){return Qs()||K2},webkit:function(){return Qs()||X0},safari:function(){return eS.webkit()},chrome:function(){return Qs()||J0},windows:function(){return Qs()||Z2},osx:function(){return Qs()||Q0},linux:function(){return Qs()||Y2},iphone:function(){return Qs()||J2},mobile:function(){return Qs()||J2||Q2||X2||zz},nativeApp:function(){return Qs()||Dz},android:function(){return Qs()||X2},ipad:function(){return Qs()||Q2}},Lae=eS,Dae=!!(typeof window<"u"&&window.document&&window.document.createElement),zae={canUseDOM:Dae},Fz=zae,Bz;Fz.canUseDOM&&(Bz=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function Fae(e,t){if(!Fz.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,s=i in document;if(!s){var d=document.createElement("div");d.setAttribute(i,"return;"),s=typeof d[i]=="function"}return!s&&Bz&&e==="wheel"&&(s=document.implementation.hasFeature("Events.wheel","3.0")),s}var Bae=Fae,BP=10,NP=40,$P=800;function Nz(e){var t=0,i=0,s=0,d=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),s=t*BP,d=i*BP,"deltaY"in e&&(d=e.deltaY),"deltaX"in e&&(s=e.deltaX),(s||d)&&e.deltaMode&&(e.deltaMode==1?(s*=NP,d*=NP):(s*=$P,d*=$P)),s&&!t&&(t=s<1?-1:1),d&&!i&&(i=d<1?-1:1),{spinX:t,spinY:i,pixelX:s,pixelY:d}}Nz.getEventType=function(){return Lae.firefox()?"DOMMouseScroll":Bae("wheel")?"wheel":"mousewheel"};var Nae=Nz;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const $ae=function(e,t){if(e&&e.addEventListener){const i=function(s){const d=Nae(s);t&&Reflect.apply(t,this,[s,d])};e.addEventListener("wheel",i,{passive:!0})}},Vae={beforeMount(e,t){$ae(e,t.value)}};let Uae=1;const jae=Ze({name:"ElTable",directives:{Mousewheel:Vae},components:{TableHeader:vae,TableBody:Cae,TableFooter:Iae,ElScrollbar:Pu,hColgroup:Rz},props:Rae,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change","scroll"],setup(e){const{t}=vr(),i=rn("table"),s=jo();or(Ru,s);const d=sae(s,e);s.store=d;const g=new cae({store:s.store,table:s,fit:e.fit,showHeader:e.showHeader});s.layout=g;const _=te(()=>(d.states.data.value||[]).length===0),{setCurrentRow:o,getSelectionRows:S,toggleRowSelection:E,clearSelection:I,clearFilter:P,toggleAllSelection:F,toggleRowExpansion:B,clearSort:$,sort:z,updateKeyChildren:H}=Aae(d),{isHidden:U,renderExpanded:ie,setDragVisible:Z,isGroup:G,handleMouseLeave:Q,handleHeaderFooterMousewheel:oe,tableSize:le,emptyBlockStyle:me,handleFixedMousewheel:fe,resizeProxyVisible:ce,bodyWidth:pe,resizeState:ye,doLayout:De,tableBodyStyles:tt,tableLayout:Me,scrollbarViewStyle:xe,scrollbarStyle:Ae}=kae(e,g,d,s),{scrollBarRef:Ce,scrollTo:ge,setScrollLeft:Ne,setScrollTop:We}=Oae(),ot=ol(De,50),Oe=`${i.namespace.value}-table_${Uae++}`;s.tableId=Oe,s.state={isGroup:G,resizeState:ye,doLayout:De,debouncedUpdateLayout:ot};const Ct=te(()=>{var bt;return(bt=e.sumText)!=null?bt:t("el.table.sumText")}),Mt=te(()=>{var bt;return(bt=e.emptyText)!=null?bt:t("el.table.emptyText")}),zt=te(()=>Pz(d.states.originColumns.value)[0]);return Pae(s),ni(()=>{ot.cancel()}),{ns:i,layout:g,store:d,columns:zt,handleHeaderFooterMousewheel:oe,handleMouseLeave:Q,tableId:Oe,tableSize:le,isHidden:U,isEmpty:_,renderExpanded:ie,resizeProxyVisible:ce,resizeState:ye,isGroup:G,bodyWidth:pe,tableBodyStyles:tt,emptyBlockStyle:me,debouncedUpdateLayout:ot,handleFixedMousewheel:fe,setCurrentRow:o,getSelectionRows:S,toggleRowSelection:E,clearSelection:I,clearFilter:P,toggleAllSelection:F,toggleRowExpansion:B,clearSort:$,doLayout:De,sort:z,updateKeyChildren:H,t,setDragVisible:Z,context:s,computedSumText:Ct,computedEmptyText:Mt,tableLayout:Me,scrollbarViewStyle:xe,scrollbarStyle:Ae,scrollBarRef:Ce,scrollTo:ge,setScrollLeft:Ne,setScrollTop:We}}});function Hae(e,t,i,s,d,g){const _=Go("hColgroup"),o=Go("table-header"),S=Go("table-body"),E=Go("table-footer"),I=Go("el-scrollbar"),P=Kb("mousewheel");return se(),Pe("div",{ref:"tableWrapper",class:de([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:to(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:e.handleMouseLeave},[He("div",{class:de(e.ns.e("inner-wrapper"))},[He("div",{ref:"hiddenColumns",class:"hidden-columns"},[_t(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?zo((se(),Pe("div",{key:0,ref:"headerWrapper",class:de(e.ns.e("header-wrapper"))},[He("table",{ref:"tableHeader",class:de(e.ns.e("header")),style:to(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[Qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Qe(o,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","onSetDragVisible"])],6)],2)),[[P,e.handleHeaderFooterMousewheel]]):St("v-if",!0),He("div",{ref:"bodyWrapper",class:de(e.ns.e("body-wrapper"))},[Qe(I,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn,tabindex:e.scrollbarTabindex,onScroll:F=>e.$emit("scroll",F)},{default:at(()=>[He("table",{ref:"tableBody",class:de(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:to({width:e.bodyWidth,tableLayout:e.tableLayout})},[Qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(se(),Rt(o,{key:0,ref:"tableHeaderRef",class:de(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):St("v-if",!0),Qe(S,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(se(),Rt(E,{key:1,class:de(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):St("v-if",!0)],6),e.isEmpty?(se(),Pe("div",{key:0,ref:"emptyBlock",style:to(e.emptyBlockStyle),class:de(e.ns.e("empty-block"))},[He("span",{class:de(e.ns.e("empty-text"))},[_t(e.$slots,"empty",{},()=>[nr(wn(e.computedEmptyText),1)])],2)],6)):St("v-if",!0),e.$slots.append?(se(),Pe("div",{key:1,ref:"appendWrapper",class:de(e.ns.e("append-wrapper"))},[_t(e.$slots,"append")],2)):St("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex","onScroll"])],2),e.showSummary&&e.tableLayout==="fixed"?zo((se(),Pe("div",{key:1,ref:"footerWrapper",class:de(e.ns.e("footer-wrapper"))},[He("table",{class:de(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:to(e.tableBodyStyles)},[Qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Qe(E,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[Cr,!e.isEmpty],[P,e.handleHeaderFooterMousewheel]]):St("v-if",!0),e.border||e.isGroup?(se(),Pe("div",{key:2,class:de(e.ns.e("border-left-patch"))},null,2)):St("v-if",!0)],2),zo(He("div",{ref:"resizeProxy",class:de(e.ns.e("column-resize-proxy"))},null,2),[[Cr,e.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var Gae=bn(jae,[["render",Hae],["__file","table.vue"]]);const Wae={selection:"table-column--selection",expand:"table__expand-column"},qae={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},Kae=e=>Wae[e]||"",Zae={selection:{renderHeader({store:e,column:t}){function i(){return e.states.data.value&&e.states.data.value.length===0}return lo(rc,{disabled:i(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:i,$index:s}){return lo(rc,{disabled:t.selectable?!t.selectable.call(null,e,s):!1,size:i.states.tableSize.value,onChange:()=>{i.commit("rowSelectedChanged",e)},onClick:d=>d.stopPropagation(),modelValue:i.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let i=t+1;const s=e.index;return ao(s)?i=t+s:Qn(s)&&(i=s(t)),lo("div",{},[i])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:i}){const{ns:s}=t,d=[s.e("expand-icon")];return i&&d.push(s.em("expand-icon","expanded")),lo("div",{class:d,onClick:function(_){_.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[lo(Gn,null,{default:()=>[lo(Ls)]})]})},sortable:!1,resizable:!1}};function Yae({row:e,column:t,$index:i}){var s;const d=t.property,g=d&&j0(e,d).value;return t&&t.formatter?t.formatter(e,t,g,i):((s=g==null?void 0:g.toString)==null?void 0:s.call(g))||""}function Xae({row:e,treeNode:t,store:i},s=!1){const{ns:d}=i;if(!t)return s?[lo("span",{class:d.e("placeholder")})]:null;const g=[],_=function(o){o.stopPropagation(),!t.loading&&i.loadOrToggle(e)};if(t.indent&&g.push(lo("span",{class:d.e("indent"),style:{"padding-left":`${t.indent}px`}})),ai(t.expanded)&&!t.noLazyChildren){const o=[d.e("expand-icon"),t.expanded?d.em("expand-icon","expanded"):""];let S=Ls;t.loading&&(S=Cu),g.push(lo("div",{class:o,onClick:_},{default:()=>[lo(Gn,{class:{[d.is("loading")]:t.loading}},{default:()=>[lo(S)]})]}))}else g.push(lo("span",{class:d.e("placeholder")}));return g}function VP(e,t){return e.reduce((i,s)=>(i[s]=s,i),t)}function Jae(e,t){const i=jo();return{registerComplexWatchers:()=>{const g=["fixed"],_={realWidth:"width",realMinWidth:"minWidth"},o=VP(g,_);Object.keys(o).forEach(S=>{const E=_[S];Tr(t,E)&&tn(()=>t[E],I=>{let P=I;E==="width"&&S==="realWidth"&&(P=XT(I)),E==="minWidth"&&S==="realMinWidth"&&(P=Tz(I)),i.columnConfig.value[E]=P,i.columnConfig.value[S]=P;const F=E==="fixed";e.value.store.scheduleLayout(F)})})},registerNormalWatchers:()=>{const g=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],_={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},o=VP(g,_);Object.keys(o).forEach(S=>{const E=_[S];Tr(t,E)&&tn(()=>t[E],I=>{i.columnConfig.value[S]=I})})}}}function Qae(e,t,i){const s=jo(),d=Se(""),g=Se(!1),_=Se(),o=Se(),S=rn("table");Ha(()=>{_.value=e.align?`is-${e.align}`:null,_.value}),Ha(()=>{o.value=e.headerAlign?`is-${e.headerAlign}`:_.value,o.value});const E=te(()=>{let G=s.vnode.vParent||s.parent;for(;G&&!G.tableId&&!G.columnId;)G=G.vnode.vParent||G.parent;return G}),I=te(()=>{const{store:G}=s.parent;if(!G)return!1;const{treeData:Q}=G.states,oe=Q.value;return oe&&Object.keys(oe).length>0}),P=Se(XT(e.width)),F=Se(Tz(e.minWidth)),B=G=>(P.value&&(G.width=P.value),F.value&&(G.minWidth=F.value),!P.value&&F.value&&(G.width=void 0),G.minWidth||(G.minWidth=80),G.realWidth=Number(G.width===void 0?G.minWidth:G.width),G),$=G=>{const Q=G.type,oe=Zae[Q]||{};Object.keys(oe).forEach(me=>{const fe=oe[me];me!=="className"&&fe!==void 0&&(G[me]=fe)});const le=Kae(Q);if(le){const me=`${y(S.namespace)}-${le}`;G.className=G.className?`${G.className} ${me}`:me}return G},z=G=>{fn(G)?G.forEach(oe=>Q(oe)):Q(G);function Q(oe){var le;((le=oe==null?void 0:oe.type)==null?void 0:le.name)==="ElTableColumn"&&(oe.vParent=s)}};return{columnId:d,realAlign:_,isSubColumn:g,realHeaderAlign:o,columnOrTableParent:E,setColumnWidth:B,setColumnForcedProps:$,setColumnRenders:G=>{e.renderHeader||G.type!=="selection"&&(G.renderHeader=oe=>(s.columnConfig.value.label,_t(t,"header",oe,()=>[G.label]))),t["filter-icon"]&&(G.renderFilterIcon=oe=>_t(t,"filter-icon",oe));let Q=G.renderCell;return G.type==="expand"?(G.renderCell=oe=>lo("div",{class:"cell"},[Q(oe)]),i.value.renderExpanded=oe=>t.default?t.default(oe):t.default):(Q=Q||Yae,G.renderCell=oe=>{let le=null;if(t.default){const De=t.default(oe);le=De.some(tt=>tt.type!==Sa)?De:Q(oe)}else le=Q(oe);const{columns:me}=i.value.store.states,fe=me.value.findIndex(De=>De.type==="default"),ce=I.value&&oe.cellIndex===fe,pe=Xae(oe,ce),ye={class:"cell",style:{}};return G.showOverflowTooltip&&(ye.class=`${ye.class} ${y(S.namespace)}-tooltip`,ye.style={width:`${(oe.column.realWidth||Number(oe.column.width))-1}px`}),z(le),lo("div",ye,[pe,le])}),G},getPropsData:(...G)=>G.reduce((Q,oe)=>(fn(oe)&&oe.forEach(le=>{Q[le]=e[le]}),Q),{}),getColumnElIndex:(G,Q)=>Array.prototype.indexOf.call(G,Q),updateColumnOrder:()=>{i.value.store.commit("updateColumnOrder",s.columnConfig.value)}}}var ese={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let tse=1;var $z=Ze({name:"ElTableColumn",components:{ElCheckbox:rc},props:ese,setup(e,{slots:t}){const i=jo(),s=Se({}),d=te(()=>{let Z=i.parent;for(;Z&&!Z.tableId;)Z=Z.parent;return Z}),{registerNormalWatchers:g,registerComplexWatchers:_}=Jae(d,e),{columnId:o,isSubColumn:S,realHeaderAlign:E,columnOrTableParent:I,setColumnWidth:P,setColumnForcedProps:F,setColumnRenders:B,getPropsData:$,getColumnElIndex:z,realAlign:H,updateColumnOrder:U}=Qae(e,t,d),ie=I.value;o.value=`${ie.tableId||ie.columnId}_column_${tse++}`,qb(()=>{S.value=d.value!==ie;const Z=e.type||"default",G=e.sortable===""?!0:e.sortable,Q=Hr(e.showOverflowTooltip)?ie.props.showOverflowTooltip:e.showOverflowTooltip,oe={...qae[Z],id:o.value,type:Z,property:e.prop||e.property,align:H,headerAlign:E,showOverflowTooltip:Q,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:G,index:e.index,rawColumnKey:i.vnode.key};let pe=$(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);pe=Yie(oe,pe),pe=Jie(B,P,F)(pe),s.value=pe,g(),_()}),No(()=>{var Z;const G=I.value,Q=S.value?G.vnode.el.children:(Z=G.refs.hiddenColumns)==null?void 0:Z.children,oe=()=>z(Q||[],i.vnode.el);s.value.getColumnIndex=oe,oe()>-1&&d.value.store.commit("insertColumn",s.value,S.value?G.columnConfig.value:null,U)}),ni(()=>{const Z=s.value.getColumnIndex;(Z?Z():-1)>-1&&d.value.store.commit("removeColumn",s.value,S.value?ie.columnConfig.value:null,U)}),i.columnId=o.value,i.columnConfig=s},render(){var e,t,i;try{const s=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),d=[];if(fn(s))for(const _ of s)((i=_.type)==null?void 0:i.name)==="ElTableColumn"||_.shapeFlag&2?d.push(_):_.type===eo&&fn(_.children)&&_.children.forEach(o=>{(o==null?void 0:o.patchFlag)!==1024&&!Zn(o==null?void 0:o.children)&&d.push(o)});return lo("div",d)}catch{return lo("div",[])}}});const nse=Ao(Gae,{TableColumn:$z}),ose=Oi($z);var x_=(e=>(e.ASC="asc",e.DESC="desc",e))(x_||{}),w_=(e=>(e.CENTER="center",e.RIGHT="right",e))(w_||{}),Vz=(e=>(e.LEFT="left",e.RIGHT="right",e))(Vz||{});const tS={asc:"desc",desc:"asc"},S_=Symbol("placeholder"),rse=(e,t,i)=>{var s;const d={flexGrow:0,flexShrink:0,...i?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};i||(d.flexShrink=1);const g={...(s=e.style)!=null?s:{},...d,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(g.maxWidth=e.maxWidth),e.minWidth&&(g.minWidth=e.minWidth)),g};function ise(e,t,i){const s=te(()=>y(t).map((H,U)=>{var ie,Z;return{...H,key:(Z=(ie=H.key)!=null?ie:H.dataKey)!=null?Z:U}})),d=te(()=>y(s).filter(H=>!H.hidden)),g=te(()=>y(d).filter(H=>H.fixed==="left"||H.fixed===!0)),_=te(()=>y(d).filter(H=>H.fixed==="right")),o=te(()=>y(d).filter(H=>!H.fixed)),S=te(()=>{const H=[];return y(g).forEach(U=>{H.push({...U,placeholderSign:S_})}),y(o).forEach(U=>{H.push(U)}),y(_).forEach(U=>{H.push({...U,placeholderSign:S_})}),H}),E=te(()=>y(g).length||y(_).length),I=te(()=>y(s).reduce((H,U)=>(H[U.key]=rse(U,y(i),e.fixed),H),{})),P=te(()=>y(d).reduce((H,U)=>H+U.width,0)),F=H=>y(s).find(U=>U.key===H),B=H=>y(I)[H],$=(H,U)=>{H.width=U};function z(H){var U;const{key:ie}=H.currentTarget.dataset;if(!ie)return;const{sortState:Z,sortBy:G}=e;let Q=x_.ASC;Vo(Z)?Q=tS[Z[ie]]:Q=tS[G.order],(U=e.onColumnSort)==null||U.call(e,{column:F(ie),key:ie,order:Q})}return{columns:s,columnsStyles:I,columnsTotalWidth:P,fixedColumnsOnLeft:g,fixedColumnsOnRight:_,hasFixedColumns:E,mainColumns:S,normalColumns:o,visibleColumns:d,getColumn:F,getColumnStyle:B,updateColumnWidth:$,onColumnSorted:z}}const ase=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,onMaybeEndReached:d})=>{const g=Se({scrollLeft:0,scrollTop:0});function _(B){var $,z,H;const{scrollTop:U}=B;($=t.value)==null||$.scrollTo(B),(z=i.value)==null||z.scrollToTop(U),(H=s.value)==null||H.scrollToTop(U)}function o(B){g.value=B,_(B)}function S(B){g.value.scrollTop=B,_(y(g))}function E(B){var $,z;g.value.scrollLeft=B,(z=($=t.value)==null?void 0:$.scrollTo)==null||z.call($,y(g))}function I(B){var $;o(B),($=e.onScroll)==null||$.call(e,B)}function P({scrollTop:B}){const{scrollTop:$}=y(g);B!==$&&S(B)}function F(B,$="auto"){var z;(z=t.value)==null||z.scrollToRow(B,$)}return tn(()=>y(g).scrollTop,(B,$)=>{B>$&&d()}),{scrollPos:g,scrollTo:o,scrollToLeft:E,scrollToTop:S,scrollToRow:F,onScroll:I,onVerticalScroll:P}},sse=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,tableInstance:d,ns:g,isScrolling:_})=>{const o=jo(),{emit:S}=o,E=gi(!1),I=Se(e.defaultExpandedRowKeys||[]),P=Se(-1),F=gi(null),B=Se({}),$=Se({}),z=gi({}),H=gi({}),U=gi({}),ie=te(()=>ao(e.estimatedRowHeight));function Z(ce){var pe;(pe=e.onRowsRendered)==null||pe.call(e,ce),ce.rowCacheEnd>y(P)&&(P.value=ce.rowCacheEnd)}function G({hovered:ce,rowKey:pe}){if(_.value)return;d.vnode.el.querySelectorAll(`[rowkey="${String(pe)}"]`).forEach(tt=>{ce?tt.classList.add(g.is("hovered")):tt.classList.remove(g.is("hovered"))})}function Q({expanded:ce,rowData:pe,rowIndex:ye,rowKey:De}){var tt,Me;const xe=[...y(I)],Ae=xe.indexOf(De);ce?Ae===-1&&xe.push(De):Ae>-1&&xe.splice(Ae,1),I.value=xe,S("update:expandedRowKeys",xe),(tt=e.onRowExpand)==null||tt.call(e,{expanded:ce,rowData:pe,rowIndex:ye,rowKey:De}),(Me=e.onExpandedRowsChange)==null||Me.call(e,xe)}const oe=ol(()=>{var ce,pe,ye,De;E.value=!0,B.value={...y(B),...y($)},le(y(F),!1),$.value={},F.value=null,(ce=t.value)==null||ce.forceUpdate(),(pe=i.value)==null||pe.forceUpdate(),(ye=s.value)==null||ye.forceUpdate(),(De=o.proxy)==null||De.$forceUpdate(),E.value=!1},0);function le(ce,pe=!1){y(ie)&&[t,i,s].forEach(ye=>{const De=y(ye);De&&De.resetAfterRowIndex(ce,pe)})}function me(ce,pe,ye){const De=y(F);(De===null||De>ye)&&(F.value=ye),$.value[ce]=pe}function fe({rowKey:ce,height:pe,rowIndex:ye},De){De?De===Vz.RIGHT?U.value[ce]=pe:z.value[ce]=pe:H.value[ce]=pe;const tt=Math.max(...[z,U,H].map(Me=>Me.value[ce]||0));y(B)[ce]!==tt&&(me(ce,tt,ye),oe())}return{expandedRowKeys:I,lastRenderedRowIndex:P,isDynamic:ie,isResetting:E,rowHeights:B,resetAfterIndex:le,onRowExpanded:Q,onRowHovered:G,onRowsRendered:Z,onRowHeightChange:fe}},lse=(e,{expandedRowKeys:t,lastRenderedRowIndex:i,resetAfterIndex:s})=>{const d=Se({}),g=te(()=>{const o={},{data:S,rowKey:E}=e,I=y(t);if(!I||!I.length)return S;const P=[],F=new Set;I.forEach($=>F.add($));let B=S.slice();for(B.forEach($=>o[$[E]]=0);B.length>0;){const $=B.shift();P.push($),F.has($[E])&&fn($.children)&&$.children.length>0&&(B=[...$.children,...B],$.children.forEach(z=>o[z[E]]=o[$[E]]+1))}return d.value=o,P}),_=te(()=>{const{data:o,expandColumnKey:S}=e;return S?y(g):o});return tn(_,(o,S)=>{o!==S&&(i.value=-1,s(0,!0))}),{data:_,depthMap:d}},cse=(e,t)=>e+t,eb=e=>fn(e)?e.reduce(cse,0):e,Uf=(e,t,i={})=>Qn(e)?e(t):e??i,lh=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=ji(e[t])}),e),Uz=e=>Ai(e)?t=>lo(e,t):e,use=(e,{columnsTotalWidth:t,data:i,fixedColumnsOnLeft:s,fixedColumnsOnRight:d})=>{const g=te(()=>{const{fixed:Z,width:G,vScrollbarSize:Q}=e,oe=G-Q;return Z?Math.max(Math.round(y(t)),oe):oe}),_=te(()=>y(g)+e.vScrollbarSize),o=te(()=>{const{height:Z=0,maxHeight:G=0,footerHeight:Q,hScrollbarSize:oe}=e;if(G>0){const le=y($),me=y(S),ce=y(B)+le+me+oe;return Math.min(ce,G-Q)}return Z-Q}),S=te(()=>{const{rowHeight:Z,estimatedRowHeight:G}=e,Q=y(i);return ao(G)?Q.length*G:Q.length*Z}),E=te(()=>{const{maxHeight:Z}=e,G=y(o);if(ao(Z)&&Z>0)return G;const Q=y(S)+y(B)+y($);return Math.min(G,Q)}),I=Z=>Z.width,P=te(()=>eb(y(s).map(I))),F=te(()=>eb(y(d).map(I))),B=te(()=>eb(e.headerHeight)),$=te(()=>{var Z;return(((Z=e.fixedData)==null?void 0:Z.length)||0)*e.rowHeight}),z=te(()=>y(o)-y(B)-y($)),H=te(()=>{const{style:Z={},height:G,width:Q}=e;return lh({...Z,height:G,width:Q})}),U=te(()=>lh({height:e.footerHeight})),ie=te(()=>({top:ji(y(B)),bottom:ji(e.footerHeight),width:ji(e.width)}));return{bodyWidth:g,fixedTableHeight:E,mainTableHeight:o,leftTableWidth:P,rightTableWidth:F,headerWidth:_,rowsHeight:S,windowHeight:z,footerHeight:U,emptyStyle:ie,rootStyle:H,headerHeight:B}};function dse(e){const t=Se(),i=Se(),s=Se(),{columns:d,columnsStyles:g,columnsTotalWidth:_,fixedColumnsOnLeft:o,fixedColumnsOnRight:S,hasFixedColumns:E,mainColumns:I,onColumnSorted:P}=ise(e,Vr(e,"columns"),Vr(e,"fixed")),{scrollTo:F,scrollToLeft:B,scrollToTop:$,scrollToRow:z,onScroll:H,onVerticalScroll:U,scrollPos:ie}=ase(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,onMaybeEndReached:Ke}),Z=rn("table-v2"),G=jo(),Q=gi(!1),{expandedRowKeys:oe,lastRenderedRowIndex:le,isDynamic:me,isResetting:fe,rowHeights:ce,resetAfterIndex:pe,onRowExpanded:ye,onRowHeightChange:De,onRowHovered:tt,onRowsRendered:Me}=sse(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,tableInstance:G,ns:Z,isScrolling:Q}),{data:xe,depthMap:Ae}=lse(e,{expandedRowKeys:oe,lastRenderedRowIndex:le,resetAfterIndex:pe}),{bodyWidth:Ce,fixedTableHeight:ge,mainTableHeight:Ne,leftTableWidth:We,rightTableWidth:ot,headerWidth:Oe,rowsHeight:Ct,windowHeight:Mt,footerHeight:zt,emptyStyle:bt,rootStyle:Kt,headerHeight:$t}=use(e,{columnsTotalWidth:_,data:xe,fixedColumnsOnLeft:o,fixedColumnsOnRight:S}),Re=Se(),dn=te(()=>{const Be=y(xe).length===0;return fn(e.fixedData)?e.fixedData.length===0&&Be:Be});function At(Be){const{estimatedRowHeight:Ht,rowHeight:Ut,rowKey:Nt}=e;return Ht?y(ce)[y(xe)[Be][Nt]]||Ht:Ut}function Ke(){const{onEndReached:Be}=e;if(!Be)return;const{scrollTop:Ht}=y(ie),Ut=y(Ct),Nt=y(Mt),Et=Ut-(Ht+Nt)+e.hScrollbarSize;y(le)>=0&&Ut===Ht+y(Ne)-y($t)&&Be(Et)}return tn(()=>e.expandedRowKeys,Be=>oe.value=Be,{deep:!0}),{columns:d,containerRef:Re,mainTableRef:t,leftTableRef:i,rightTableRef:s,isDynamic:me,isResetting:fe,isScrolling:Q,hasFixedColumns:E,columnsStyles:g,columnsTotalWidth:_,data:xe,expandedRowKeys:oe,depthMap:Ae,fixedColumnsOnLeft:o,fixedColumnsOnRight:S,mainColumns:I,bodyWidth:Ce,emptyStyle:bt,rootStyle:Kt,headerWidth:Oe,footerHeight:zt,mainTableHeight:Ne,fixedTableHeight:ge,leftTableWidth:We,rightTableWidth:ot,showEmpty:dn,getRowHeight:At,onColumnSorted:P,onRowHovered:tt,onRowExpanded:ye,onRowsRendered:Me,onRowHeightChange:De,scrollTo:F,scrollToLeft:B,scrollToTop:$,scrollToRow:z,onScroll:H,onVerticalScroll:U}}const eC=Symbol("tableV2"),jz=String,V_={type:ut(Array),required:!0},tC={type:ut(Array)},Hz={...tC,required:!0},hse=String,UP={type:ut(Array),default:()=>Ri([])},Sf={type:Number,required:!0},Gz={type:ut([String,Number,Symbol]),default:"id"},jP={type:ut(Object)},If=vn({class:String,columns:V_,columnsStyles:{type:ut(Object),required:!0},depth:Number,expandColumnKey:hse,estimatedRowHeight:{...Of.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:ut(Function)},onRowHover:{type:ut(Function)},onRowHeightChange:{type:ut(Function)},rowData:{type:ut(Object),required:!0},rowEventHandlers:{type:ut(Object)},rowIndex:{type:Number,required:!0},rowKey:Gz,style:{type:ut(Object)}}),$w={type:Number,required:!0},nC=vn({class:String,columns:V_,fixedHeaderData:{type:ut(Array)},headerData:{type:ut(Array),required:!0},headerHeight:{type:ut([Number,Array]),default:50},rowWidth:$w,rowHeight:{type:Number,default:50},height:$w,width:$w}),tb=vn({columns:V_,data:Hz,fixedData:tC,estimatedRowHeight:If.estimatedRowHeight,width:Sf,height:Sf,headerWidth:Sf,headerHeight:nC.headerHeight,bodyWidth:Sf,rowHeight:Sf,cache:dz.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Of.scrollbarAlwaysOn,scrollbarStartGap:Of.scrollbarStartGap,scrollbarEndGap:Of.scrollbarEndGap,class:jz,style:jP,containerStyle:jP,getRowHeight:{type:ut(Function),required:!0},rowKey:If.rowKey,onRowsRendered:{type:ut(Function)},onScroll:{type:ut(Function)}}),fse=vn({cache:tb.cache,estimatedRowHeight:If.estimatedRowHeight,rowKey:Gz,headerClass:{type:ut([String,Function])},headerProps:{type:ut([Object,Function])},headerCellProps:{type:ut([Object,Function])},headerHeight:nC.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:ut([String,Function])},rowProps:{type:ut([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:ut([Object,Function])},columns:V_,data:Hz,dataGetter:{type:ut(Function)},fixedData:tC,expandColumnKey:If.expandColumnKey,expandedRowKeys:UP,defaultExpandedRowKeys:UP,class:jz,fixed:Boolean,style:{type:ut(Object)},width:Sf,height:Sf,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Of.hScrollbarSize,vScrollbarSize:Of.vScrollbarSize,scrollbarAlwaysOn:pz.alwaysOn,sortBy:{type:ut(Object),default:()=>({})},sortState:{type:ut(Object),default:void 0},onColumnSort:{type:ut(Function)},onExpandedRowsChange:{type:ut(Function)},onEndReached:{type:ut(Function)},onRowExpand:If.onRowExpand,onScroll:tb.onScroll,onRowsRendered:tb.onRowsRendered,rowEventHandlers:If.rowEventHandlers}),pse="ElTableV2Header",mse=Ze({name:pse,props:nC,setup(e,{slots:t,expose:i}){const s=rn("table-v2"),d=Un("tableV2GridScrollLeft"),g=Se(),_=te(()=>lh({width:e.width,height:e.height})),o=te(()=>lh({width:e.rowWidth,height:e.height})),S=te(()=>us(y(e.headerHeight))),E=F=>{const B=y(g);oo(()=>{B!=null&&B.scroll&&B.scroll({left:F})})},I=()=>{const F=s.e("fixed-header-row"),{columns:B,fixedHeaderData:$,rowHeight:z}=e;return $==null?void 0:$.map((H,U)=>{var ie;const Z=lh({height:z,width:"100%"});return(ie=t.fixed)==null?void 0:ie.call(t,{class:F,columns:B,rowData:H,rowIndex:-(U+1),style:Z})})},P=()=>{const F=s.e("dynamic-header-row"),{columns:B}=e;return y(S).map(($,z)=>{var H;const U=lh({width:"100%",height:$});return(H=t.dynamic)==null?void 0:H.call(t,{class:F,columns:B,headerIndex:z,style:U})})};return Au(()=>{d!=null&&d.value&&E(d.value)}),i({scrollToLeft:E}),()=>{if(!(e.height<=0))return Qe("div",{ref:g,class:e.class,style:y(_),role:"rowgroup"},[Qe("div",{style:y(o),class:s.e("header")},[P(),I()])])}}});var gse=mse;const vse=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:i,atYStartEdge:s},d)=>{let g=null,_=0,o=0;const S=(I,P)=>{const F=I<=0&&t.value||I>=0&&e.value,B=P<=0&&s.value||P>=0&&i.value;return F&&B};return{hasReachedEdge:S,onWheel:I=>{$f(g);let P=I.deltaX,F=I.deltaY;Math.abs(P)>Math.abs(F)?F=0:P=0,I.shiftKey&&F!==0&&(P=F,F=0),!(S(_,o)&&S(_+P,o+F))&&(_+=P,o+=F,I.preventDefault(),g=_h(()=>{d(_,o),_=0,o=0}))}}},Wz=({name:e,clearCache:t,getColumnPosition:i,getColumnStartIndexForOffset:s,getColumnStopIndexForStartIndex:d,getEstimatedTotalHeight:g,getEstimatedTotalWidth:_,getColumnOffset:o,getRowOffset:S,getRowPosition:E,getRowStartIndexForOffset:I,getRowStopIndexForStartIndex:P,initCache:F,injectToInstance:B,validateProps:$})=>Ze({name:e??"ElVirtualList",props:Of,emits:[Cb,Eb],setup(z,{emit:H,expose:U,slots:ie}){const Z=rn("vl");$(z);const G=jo(),Q=Se(F(z,G));B==null||B(G,Q);const oe=Se(),le=Se(),me=Se(),fe=Se(null),ce=Se({isScrolling:!1,scrollLeft:ao(z.initScrollLeft)?z.initScrollLeft:0,scrollTop:ao(z.initScrollTop)?z.initScrollTop:0,updateRequested:!1,xAxisScrollDir:tm,yAxisScrollDir:tm}),pe=lz(),ye=te(()=>Number.parseInt(`${z.height}`,10)),De=te(()=>Number.parseInt(`${z.width}`,10)),tt=te(()=>{const{totalColumn:Nt,totalRow:Et,columnCache:Gt}=z,{isScrolling:ln,xAxisScrollDir:yn,scrollLeft:_n}=y(ce);if(Nt===0||Et===0)return[0,0,0,0];const jn=s(z,_n,y(Q)),yt=d(z,jn,_n,y(Q)),kn=!ln||yn===Mb?Math.max(1,Gt):1,qn=!ln||yn===tm?Math.max(1,Gt):1;return[Math.max(0,jn-kn),Math.max(0,Math.min(Nt-1,yt+qn)),jn,yt]}),Me=te(()=>{const{totalColumn:Nt,totalRow:Et,rowCache:Gt}=z,{isScrolling:ln,yAxisScrollDir:yn,scrollTop:_n}=y(ce);if(Nt===0||Et===0)return[0,0,0,0];const jn=I(z,_n,y(Q)),yt=P(z,jn,_n,y(Q)),kn=!ln||yn===Mb?Math.max(1,Gt):1,qn=!ln||yn===tm?Math.max(1,Gt):1;return[Math.max(0,jn-kn),Math.max(0,Math.min(Et-1,yt+qn)),jn,yt]}),xe=te(()=>g(z,y(Q))),Ae=te(()=>_(z,y(Q))),Ce=te(()=>{var Nt;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:z.direction,height:ao(z.height)?`${z.height}px`:z.height,width:ao(z.width)?`${z.width}px`:z.width},(Nt=z.style)!=null?Nt:{}]}),ge=te(()=>{const Nt=`${y(Ae)}px`;return{height:`${y(xe)}px`,pointerEvents:y(ce).isScrolling?"none":void 0,width:Nt}}),Ne=()=>{const{totalColumn:Nt,totalRow:Et}=z;if(Nt>0&&Et>0){const[yt,kn,qn,Co]=y(tt),[mo,Io,Ho,ur]=y(Me);H(Cb,{columnCacheStart:yt,columnCacheEnd:kn,rowCacheStart:mo,rowCacheEnd:Io,columnVisibleStart:qn,columnVisibleEnd:Co,rowVisibleStart:Ho,rowVisibleEnd:ur})}const{scrollLeft:Gt,scrollTop:ln,updateRequested:yn,xAxisScrollDir:_n,yAxisScrollDir:jn}=y(ce);H(Eb,{xAxisScrollDir:_n,scrollLeft:Gt,yAxisScrollDir:jn,scrollTop:ln,updateRequested:yn})},We=Nt=>{const{clientHeight:Et,clientWidth:Gt,scrollHeight:ln,scrollLeft:yn,scrollTop:_n,scrollWidth:jn}=Nt.currentTarget,yt=y(ce);if(yt.scrollTop===_n&&yt.scrollLeft===yn)return;let kn=yn;if(EP(z.direction))switch(Ab()){case y_:kn=-yn;break;case YT:kn=jn-Gt-yn;break}ce.value={...yt,isScrolling:!0,scrollLeft:kn,scrollTop:Math.max(0,Math.min(_n,ln-Et)),updateRequested:!0,xAxisScrollDir:Ef(yt.scrollLeft,kn),yAxisScrollDir:Ef(yt.scrollTop,_n)},oo(()=>Kt()),$t(),Ne()},ot=(Nt,Et)=>{const Gt=y(ye),ln=(xe.value-Gt)/Et*Nt;Mt({scrollTop:Math.min(xe.value-Gt,ln)})},Oe=(Nt,Et)=>{const Gt=y(De),ln=(Ae.value-Gt)/Et*Nt;Mt({scrollLeft:Math.min(Ae.value-Gt,ln)})},{onWheel:Ct}=vse({atXStartEdge:te(()=>ce.value.scrollLeft<=0),atXEndEdge:te(()=>ce.value.scrollLeft>=Ae.value-y(De)),atYStartEdge:te(()=>ce.value.scrollTop<=0),atYEndEdge:te(()=>ce.value.scrollTop>=xe.value-y(ye))},(Nt,Et)=>{var Gt,ln,yn,_n;(ln=(Gt=le.value)==null?void 0:Gt.onMouseUp)==null||ln.call(Gt),(_n=(yn=me.value)==null?void 0:yn.onMouseUp)==null||_n.call(yn);const jn=y(De),yt=y(ye);Mt({scrollLeft:Math.min(ce.value.scrollLeft+Nt,Ae.value-jn),scrollTop:Math.min(ce.value.scrollTop+Et,xe.value-yt)})});qr(oe,"wheel",Ct,{passive:!1});const Mt=({scrollLeft:Nt=ce.value.scrollLeft,scrollTop:Et=ce.value.scrollTop})=>{Nt=Math.max(Nt,0),Et=Math.max(Et,0);const Gt=y(ce);Et===Gt.scrollTop&&Nt===Gt.scrollLeft||(ce.value={...Gt,xAxisScrollDir:Ef(Gt.scrollLeft,Nt),yAxisScrollDir:Ef(Gt.scrollTop,Et),scrollLeft:Nt,scrollTop:Et,updateRequested:!0},oo(()=>Kt()),$t(),Ne())},zt=(Nt=0,Et=0,Gt=Xl)=>{const ln=y(ce);Et=Math.max(0,Math.min(Et,z.totalColumn-1)),Nt=Math.max(0,Math.min(Nt,z.totalRow-1));const yn=KO(Z.namespace.value),_n=y(Q),jn=g(z,_n),yt=_(z,_n);Mt({scrollLeft:o(z,Et,Gt,ln.scrollLeft,_n,yt>z.width?yn:0),scrollTop:S(z,Nt,Gt,ln.scrollTop,_n,jn>z.height?yn:0)})},bt=(Nt,Et)=>{const{columnWidth:Gt,direction:ln,rowHeight:yn}=z,_n=pe.value(t&&Gt,t&&yn,t&&ln),jn=`${Nt},${Et}`;if(Tr(_n,jn))return _n[jn];{const[,yt]=i(z,Et,y(Q)),kn=y(Q),qn=EP(ln),[Co,mo]=E(z,Nt,kn),[Io]=i(z,Et,kn);return _n[jn]={position:"absolute",left:qn?void 0:`${yt}px`,right:qn?`${yt}px`:void 0,top:`${mo}px`,height:`${Co}px`,width:`${Io}px`},_n[jn]}},Kt=()=>{ce.value.isScrolling=!1,oo(()=>{pe.value(-1,null,null)})};No(()=>{if(!gr)return;const{initScrollLeft:Nt,initScrollTop:Et}=z,Gt=y(oe);Gt&&(ao(Nt)&&(Gt.scrollLeft=Nt),ao(Et)&&(Gt.scrollTop=Et)),Ne()});const $t=()=>{const{direction:Nt}=z,{scrollLeft:Et,scrollTop:Gt,updateRequested:ln}=y(ce),yn=y(oe);if(ln&&yn){if(Nt===hm)switch(Ab()){case y_:{yn.scrollLeft=-Et;break}case ZT:{yn.scrollLeft=Et;break}default:{const{clientWidth:_n,scrollWidth:jn}=yn;yn.scrollLeft=jn-_n-Et;break}}else yn.scrollLeft=Math.max(0,Et);yn.scrollTop=Math.max(0,Gt)}},{resetAfterColumnIndex:Re,resetAfterRowIndex:dn,resetAfter:At}=G.proxy;U({windowRef:oe,innerRef:fe,getItemStyleCache:pe,scrollTo:Mt,scrollToItem:zt,states:ce,resetAfterColumnIndex:Re,resetAfterRowIndex:dn,resetAfter:At});const Ke=()=>{const{scrollbarAlwaysOn:Nt,scrollbarStartGap:Et,scrollbarEndGap:Gt,totalColumn:ln,totalRow:yn}=z,_n=y(De),jn=y(ye),yt=y(Ae),kn=y(xe),{scrollLeft:qn,scrollTop:Co}=y(ce),mo=lo(H2,{ref:le,alwaysOn:Nt,startGap:Et,endGap:Gt,class:Z.e("horizontal"),clientSize:_n,layout:"horizontal",onScroll:Oe,ratio:_n*100/yt,scrollFrom:qn/(yt-_n),total:yn,visible:!0}),Io=lo(H2,{ref:me,alwaysOn:Nt,startGap:Et,endGap:Gt,class:Z.e("vertical"),clientSize:jn,layout:"vertical",onScroll:ot,ratio:jn*100/kn,scrollFrom:Co/(kn-jn),total:ln,visible:!0});return{horizontalScrollbar:mo,verticalScrollbar:Io}},Be=()=>{var Nt;const[Et,Gt]=y(tt),[ln,yn]=y(Me),{data:_n,totalColumn:jn,totalRow:yt,useIsScrolling:kn,itemKey:qn}=z,Co=[];if(yt>0&&jn>0)for(let mo=ln;mo<=yn;mo++)for(let Io=Et;Io<=Gt;Io++){const Ho=qn({columnIndex:Io,data:_n,rowIndex:mo});Co.push(lo(eo,{key:Ho},(Nt=ie.default)==null?void 0:Nt.call(ie,{columnIndex:Io,data:_n,isScrolling:kn?y(ce).isScrolling:void 0,style:bt(mo,Io),rowIndex:mo})))}return Co},Ht=()=>{const Nt=Wo(z.innerElement),Et=Be();return[lo(Nt,{style:y(ge),ref:fe},Zn(Nt)?Et:{default:()=>Et})]};return()=>{const Nt=Wo(z.containerElement),{horizontalScrollbar:Et,verticalScrollbar:Gt}=Ke(),ln=Ht();return lo("div",{key:0,class:Z.e("wrapper"),role:z.role},[lo(Nt,{class:z.className,style:y(Ce),onScroll:We,ref:oe},Zn(Nt)?ln:{default:()=>ln}),Et,Gt])}}}),{max:Rb,min:qz,floor:Kz}=Math,_se={column:"columnWidth",row:"rowHeight"},nS={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Zu=(e,t,i,s)=>{const[d,g,_]=[i[s],e[_se[s]],i[nS[s]]];if(t>_){let o=0;if(_>=0){const S=d[_];o=S.offset+S.size}for(let S=_+1;S<=t;S++){const E=g(S);d[S]={offset:o,size:E},o+=E}i[nS[s]]=t}return d[t]},Zz=(e,t,i,s,d,g)=>{for(;i<=s;){const _=i+Kz((s-i)/2),o=Zu(e,_,t,g).offset;if(o===d)return _;o<d?i=_+1:s=_-1}return Rb(0,i-1)},yse=(e,t,i,s,d)=>{const g=d==="column"?e.totalColumn:e.totalRow;let _=1;for(;i<g&&Zu(e,i,t,d).offset<s;)i+=_,_*=2;return Zz(e,t,Kz(i/2),qz(i,g-1),s,d)},HP=(e,t,i,s)=>{const[d,g]=[t[s],t[nS[s]]];return(g>0?d[g].offset:0)>=i?Zz(e,t,0,g,i,s):yse(e,t,Rb(0,g),i,s)},Yz=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:i,row:s})=>{let d=0;if(i>=e&&(i=e-1),i>=0){const o=s[i];d=o.offset+o.size}const _=(e-i-1)*t;return d+_},Xz=({totalColumn:e},{column:t,estimatedColumnWidth:i,lastVisitedColumnIndex:s})=>{let d=0;if(s>e&&(s=e-1),s>=0){const o=t[s];d=o.offset+o.size}const _=(e-s-1)*i;return d+_},bse={column:Xz,row:Yz},GP=(e,t,i,s,d,g,_)=>{const[o,S]=[g==="row"?e.height:e.width,bse[g]],E=Zu(e,t,d,g),I=S(e,d),P=Rb(0,qz(I-o,E.offset)),F=Rb(0,E.offset-o+_+E.size);switch(i===b1&&(s>=F-o&&s<=P+o?i=Xl:i=xu),i){case v_:return P;case __:return F;case xu:return Math.round(F+(P-F)/2);case Xl:default:return s>=F&&s<=P?s:F>P||s<F?F:P}},xse=Wz({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,i)=>{const s=Zu(e,t,i,"column");return[s.size,s.offset]},getRowPosition:(e,t,i)=>{const s=Zu(e,t,i,"row");return[s.size,s.offset]},getColumnOffset:(e,t,i,s,d,g)=>GP(e,t,i,s,d,"column",g),getRowOffset:(e,t,i,s,d,g)=>GP(e,t,i,s,d,"row",g),getColumnStartIndexForOffset:(e,t,i)=>HP(e,i,t,"column"),getColumnStopIndexForStartIndex:(e,t,i,s)=>{const d=Zu(e,t,s,"column"),g=i+e.width;let _=d.offset+d.size,o=t;for(;o<e.totalColumn-1&&_<g;)o++,_+=Zu(e,t,s,"column").size;return o},getEstimatedTotalHeight:Yz,getEstimatedTotalWidth:Xz,getRowStartIndexForOffset:(e,t,i)=>HP(e,i,t,"row"),getRowStopIndexForStartIndex:(e,t,i,s)=>{const{totalRow:d,height:g}=e,_=Zu(e,t,s,"row"),o=i+g;let S=_.size+_.offset,E=t;for(;E<d-1&&S<o;)E++,S+=Zu(e,E,s,"row").size;return E},injectToInstance:(e,t)=>{const i=({columnIndex:g,rowIndex:_},o)=>{var S,E;o=Hr(o)?!0:o,ao(g)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,g-1)),ao(_)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,_-1)),(S=e.exposed)==null||S.getItemStyleCache.value(-1,null,null),o&&((E=e.proxy)==null||E.$forceUpdate())},s=(g,_)=>{i({columnIndex:g},_)},d=(g,_)=>{i({rowIndex:g},_)};Object.assign(e.proxy,{resetAfterColumnIndex:s,resetAfterRowIndex:d,resetAfter:i})},initCache:({estimatedColumnWidth:e=B2,estimatedRowHeight:t=B2})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),wse=Wz({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:i},s,d,g,_,o)=>{i=Number(i);const S=Math.max(0,e*t-i),E=Math.min(S,s*t),I=Math.max(0,s*t-i+o+t);switch(d==="smart"&&(g>=I-i&&g<=E+i?d=Xl:d=xu),d){case v_:return E;case __:return I;case xu:{const P=Math.round(I+(E-I)/2);return P<Math.ceil(i/2)?0:P>S+Math.floor(i/2)?S:P}case Xl:default:return g>=I&&g<=E?g:I>E||g<I?I:E}},getRowOffset:({rowHeight:e,height:t,totalRow:i},s,d,g,_,o)=>{t=Number(t);const S=Math.max(0,i*e-t),E=Math.min(S,s*e),I=Math.max(0,s*e-t+o+e);switch(d===b1&&(g>=I-t&&g<=E+t?d=Xl:d=xu),d){case v_:return E;case __:return I;case xu:{const P=Math.round(I+(E-I)/2);return P<Math.ceil(t/2)?0:P>S+Math.floor(t/2)?S:P}case Xl:default:return g>=I&&g<=E?g:I>E||g<I?I:E}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:i},s,d)=>{const g=s*e,_=Math.ceil((i+d-g)/e);return Math.max(0,Math.min(t-1,s+_-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:i},s,d)=>{const g=s*e,_=Math.ceil((i+d-g)/e);return Math.max(0,Math.min(t-1,s+_-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),Sse="ElTableV2Grid",Tse=e=>{const t=Se(),i=Se(),s=Se(0),d=te(()=>{const{data:H,rowHeight:U,estimatedRowHeight:ie}=e;if(!ie)return H.length*U}),g=te(()=>{const{fixedData:H,rowHeight:U}=e;return((H==null?void 0:H.length)||0)*U}),_=te(()=>eb(e.headerHeight)),o=te(()=>{const{height:H}=e;return Math.max(0,H-y(_)-y(g))}),S=te(()=>y(_)+y(g)>0),E=({data:H,rowIndex:U})=>H[U][e.rowKey];function I({rowCacheStart:H,rowCacheEnd:U,rowVisibleStart:ie,rowVisibleEnd:Z}){var G;(G=e.onRowsRendered)==null||G.call(e,{rowCacheStart:H,rowCacheEnd:U,rowVisibleStart:ie,rowVisibleEnd:Z})}function P(H,U){var ie;(ie=i.value)==null||ie.resetAfterRowIndex(H,U)}function F(H,U){const ie=y(t),Z=y(i);Vo(H)?(ie==null||ie.scrollToLeft(H.scrollLeft),s.value=H.scrollLeft,Z==null||Z.scrollTo(H)):(ie==null||ie.scrollToLeft(H),s.value=H,Z==null||Z.scrollTo({scrollLeft:H,scrollTop:U}))}function B(H){var U;(U=y(i))==null||U.scrollTo({scrollTop:H})}function $(H,U){var ie;(ie=y(i))==null||ie.scrollToItem(H,1,U)}function z(){var H,U;(H=y(i))==null||H.$forceUpdate(),(U=y(t))==null||U.$forceUpdate()}return{bodyRef:i,forceUpdate:z,fixedRowHeight:g,gridHeight:o,hasHeader:S,headerHeight:_,headerRef:t,totalHeight:d,itemKey:E,onItemRendered:I,resetAfterRowIndex:P,scrollTo:F,scrollToTop:B,scrollToRow:$,scrollLeft:s}},Cse=Ze({name:Sse,props:tb,setup(e,{slots:t,expose:i}){const{ns:s}=Un(eC),{bodyRef:d,fixedRowHeight:g,gridHeight:_,hasHeader:o,headerRef:S,headerHeight:E,totalHeight:I,forceUpdate:P,itemKey:F,onItemRendered:B,resetAfterRowIndex:$,scrollTo:z,scrollToTop:H,scrollToRow:U,scrollLeft:ie}=Tse(e);or("tableV2GridScrollLeft",ie),i({forceUpdate:P,totalHeight:I,scrollTo:z,scrollToTop:H,scrollToRow:U,resetAfterRowIndex:$});const Z=()=>e.bodyWidth;return()=>{const{cache:G,columns:Q,data:oe,fixedData:le,useIsScrolling:me,scrollbarAlwaysOn:fe,scrollbarEndGap:ce,scrollbarStartGap:pe,style:ye,rowHeight:De,bodyWidth:tt,estimatedRowHeight:Me,headerWidth:xe,height:Ae,width:Ce,getRowHeight:ge,onScroll:Ne}=e,We=ao(Me),ot=We?xse:wse,Oe=y(E);return Qe("div",{role:"table",class:[s.e("table"),e.class],style:ye},[Qe(ot,{ref:d,data:oe,useIsScrolling:me,itemKey:F,columnCache:0,columnWidth:We?Z:tt,totalColumn:1,totalRow:oe.length,rowCache:G,rowHeight:We?ge:De,width:Ce,height:y(_),class:s.e("body"),role:"rowgroup",scrollbarStartGap:pe,scrollbarEndGap:ce,scrollbarAlwaysOn:fe,onScroll:Ne,onItemRendered:B,perfMode:!1},{default:Ct=>{var Mt;const zt=oe[Ct.rowIndex];return(Mt=t.row)==null?void 0:Mt.call(t,{...Ct,columns:Q,rowData:zt})}}),y(o)&&Qe(gse,{ref:S,class:s.e("header-wrapper"),columns:Q,headerData:oe,headerHeight:e.headerHeight,fixedHeaderData:le,rowWidth:xe,rowHeight:De,width:Ce,height:Math.min(Oe+y(g),Ae)},{dynamic:t.header,fixed:t.row})])}}});var oC=Cse;function Ese(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Mse=(e,{slots:t})=>{const{mainTableRef:i,...s}=e;return Qe(oC,Yo({ref:i},s),Ese(t)?t:{default:()=>[t]})};var Ise=Mse;function Ase(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const kse=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:i,...s}=e;return Qe(oC,Yo({ref:i},s),Ase(t)?t:{default:()=>[t]})};var Pse=kse;function Rse(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Ose=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:i,...s}=e;return Qe(oC,Yo({ref:i},s),Rse(t)?t:{default:()=>[t]})};var Lse=Ose;const Dse=e=>{const{isScrolling:t}=Un(eC),i=Se(!1),s=Se(),d=te(()=>ao(e.estimatedRowHeight)&&e.rowIndex>=0),g=(S=!1)=>{const E=y(s);if(!E)return;const{columns:I,onRowHeightChange:P,rowKey:F,rowIndex:B,style:$}=e,{height:z}=E.getBoundingClientRect();i.value=!0,oo(()=>{if(S||z!==Number.parseInt($.height)){const H=I[0],U=(H==null?void 0:H.placeholderSign)===S_;P==null||P({rowKey:F,height:z,rowIndex:B},H&&!U&&H.fixed)}})},_=te(()=>{const{rowData:S,rowIndex:E,rowKey:I,onRowHover:P}=e,F=e.rowEventHandlers||{},B={};return Object.entries(F).forEach(([$,z])=>{Qn(z)&&(B[$]=H=>{z({event:H,rowData:S,rowIndex:E,rowKey:I})})}),P&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:$,hovered:z})=>{const H=B[$];B[$]=U=>{P({event:U,hovered:z,rowData:S,rowIndex:E,rowKey:I}),H==null||H(U)}}),B}),o=S=>{const{onRowExpand:E,rowData:I,rowIndex:P,rowKey:F}=e;E==null||E({expanded:S,rowData:I,rowIndex:P,rowKey:F})};return No(()=>{y(d)&&g(!0)}),{isScrolling:t,measurable:d,measured:i,rowRef:s,eventHandlers:_,onExpand:o}},zse="ElTableV2TableRow",Fse=Ze({name:zse,props:If,setup(e,{expose:t,slots:i,attrs:s}){const{eventHandlers:d,isScrolling:g,measurable:_,measured:o,rowRef:S,onExpand:E}=Dse(e);return t({onExpand:E}),()=>{const{columns:I,columnsStyles:P,expandColumnKey:F,depth:B,rowData:$,rowIndex:z,style:H}=e;let U=I.map((ie,Z)=>{const G=fn($.children)&&$.children.length>0&&ie.key===F;return i.cell({column:ie,columns:I,columnIndex:Z,depth:B,style:P[ie.key],rowData:$,rowIndex:z,isScrolling:y(g),expandIconProps:G?{rowData:$,rowIndex:z,onExpand:E}:void 0})});if(i.row&&(U=i.row({cells:U.map(ie=>fn(ie)&&ie.length===1?ie[0]:ie),style:H,columns:I,depth:B,rowData:$,rowIndex:z,isScrolling:y(g)})),y(_)){const{height:ie,...Z}=H||{},G=y(o);return Qe("div",Yo({ref:S,class:e.class,style:G?H:Z,role:"row"},s,y(d)),[U])}return Qe("div",Yo(s,{ref:S,class:e.class,style:H,role:"row"},y(d)),[U])}}});var Bse=Fse;function Nse(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const $se=(e,{slots:t})=>{const{columns:i,columnsStyles:s,depthMap:d,expandColumnKey:g,expandedRowKeys:_,estimatedRowHeight:o,hasFixedColumns:S,rowData:E,rowIndex:I,style:P,isScrolling:F,rowProps:B,rowClass:$,rowKey:z,rowEventHandlers:H,ns:U,onRowHovered:ie,onRowExpanded:Z}=e,G=Uf($,{columns:i,rowData:E,rowIndex:I},""),Q=Uf(B,{columns:i,rowData:E,rowIndex:I}),oe=E[z],le=d[oe]||0,me=!!g,fe=I<0,ce=[U.e("row"),G,{[U.e(`row-depth-${le}`)]:me&&I>=0,[U.is("expanded")]:me&&_.includes(oe),[U.is("fixed")]:!le&&fe,[U.is("customized")]:!!t.row}],pe=S?ie:void 0,ye={...Q,columns:i,columnsStyles:s,class:ce,depth:le,expandColumnKey:g,estimatedRowHeight:fe?void 0:o,isScrolling:F,rowIndex:I,rowData:E,rowKey:oe,rowEventHandlers:H,style:P};return Qe(Bse,Yo(ye,{onRowExpand:Z,onMouseenter:Me=>{pe==null||pe({hovered:!0,rowKey:oe,event:Me,rowData:E,rowIndex:I})},onMouseleave:Me=>{pe==null||pe({hovered:!1,rowKey:oe,event:Me,rowData:E,rowIndex:I})},rowkey:oe}),Nse(t)?t:{default:()=>[t]})};var Vse=$se;const rC=(e,{slots:t})=>{var i;const{cellData:s,style:d}=e,g=((i=s==null?void 0:s.toString)==null?void 0:i.call(s))||"",_=_t(t,"default",e,()=>[g]);return Qe("div",{class:e.class,title:g,style:d},[_])};rC.displayName="ElTableV2Cell";rC.inheritAttrs=!1;var Use=rC;const jse=e=>{const{expanded:t,expandable:i,onExpand:s,style:d,size:g}=e,_={onClick:i?()=>s(!t):void 0,class:e.class};return Qe(Gn,Yo(_,{size:g,style:d}),{default:()=>[Qe(Ls,null,null)]})};var Hse=jse;const Jz=({columns:e,column:t,columnIndex:i,depth:s,expandIconProps:d,isScrolling:g,rowData:_,rowIndex:o,style:S,expandedRowKeys:E,ns:I,cellProps:P,expandColumnKey:F,indentSize:B,iconSize:$,rowKey:z},{slots:H})=>{const U=lh(S);if(t.placeholderSign===S_)return Qe("div",{class:I.em("row-cell","placeholder"),style:U},null);const{cellRenderer:ie,dataKey:Z,dataGetter:G}=t,Q=Qn(G)?G({columns:e,column:t,columnIndex:i,rowData:_,rowIndex:o}):Ji(_,Z??""),oe=Uf(P,{cellData:Q,columns:e,column:t,columnIndex:i,rowIndex:o,rowData:_}),le={class:I.e("cell-text"),columns:e,column:t,columnIndex:i,cellData:Q,isScrolling:g,rowData:_,rowIndex:o},me=Uz(ie),fe=me?me(le):_t(H,"default",le,()=>[Qe(Use,le,null)]),ce=[I.e("row-cell"),t.class,t.align===w_.CENTER&&I.is("align-center"),t.align===w_.RIGHT&&I.is("align-right")],pe=o>=0&&F&&t.key===F,ye=o>=0&&E.includes(_[z]);let De;const tt=`margin-inline-start: ${s*B}px;`;return pe&&(Vo(d)?De=Qe(Hse,Yo(d,{class:[I.e("expand-icon"),I.is("expanded",ye)],size:$,expanded:ye,style:tt,expandable:!0}),null):De=Qe("div",{style:[tt,`width: ${$}px; height: ${$}px;`].join(" ")},null)),Qe("div",Yo({class:ce,style:U},oe,{role:"cell"}),[De,fe])};Jz.inheritAttrs=!1;var WP=Jz;const Gse=vn({class:String,columns:V_,columnsStyles:{type:ut(Object),required:!0},headerIndex:Number,style:{type:ut(Object)}}),Wse=Ze({name:"ElTableV2HeaderRow",props:Gse,setup(e,{slots:t}){return()=>{const{columns:i,columnsStyles:s,headerIndex:d,style:g}=e;let _=i.map((o,S)=>t.cell({columns:i,column:o,columnIndex:S,headerIndex:d,style:s[o.key]}));return t.header&&(_=t.header({cells:_.map(o=>fn(o)&&o.length===1?o[0]:o),columns:i,headerIndex:d})),Qe("div",{class:e.class,style:g,role:"row"},[_])}}});var qse=Wse;function Kse(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Zse=({columns:e,columnsStyles:t,headerIndex:i,style:s,headerClass:d,headerProps:g,ns:_},{slots:o})=>{const S={columns:e,headerIndex:i},E=[_.e("header-row"),Uf(d,S,""),{[_.is("customized")]:!!o.header}],I={...Uf(g,S),columnsStyles:t,class:E,columns:e,headerIndex:i,style:s};return Qe(qse,I,Kse(o)?o:{default:()=>[o]})};var Yse=Zse;const iC=(e,{slots:t})=>_t(t,"default",e,()=>{var i,s;return[Qe("div",{class:e.class,title:(i=e.column)==null?void 0:i.title},[(s=e.column)==null?void 0:s.title])]});iC.displayName="ElTableV2HeaderCell";iC.inheritAttrs=!1;var Xse=iC;const Jse=e=>{const{sortOrder:t}=e;return Qe(Gn,{size:14,class:e.class},{default:()=>[t===x_.ASC?Qe(AW,null,null):Qe(MW,null,null)]})};var Qse=Jse;const ele=(e,{slots:t})=>{const{column:i,ns:s,style:d,onColumnSorted:g}=e,_=lh(d);if(i.placeholderSign===S_)return Qe("div",{class:s.em("header-row-cell","placeholder"),style:_},null);const{headerCellRenderer:o,headerClass:S,sortable:E}=i,I={...e,class:s.e("header-cell-text")},P=Uz(o),F=P?P(I):_t(t,"default",I,()=>[Qe(Xse,I,null)]),{sortBy:B,sortState:$,headerCellProps:z}=e;let H,U;if($){const G=$[i.key];H=!!tS[G],U=H?G:x_.ASC}else H=i.key===B.key,U=H?B.order:x_.ASC;const ie=[s.e("header-cell"),Uf(S,e,""),i.align===w_.CENTER&&s.is("align-center"),i.align===w_.RIGHT&&s.is("align-right"),E&&s.is("sortable")],Z={...Uf(z,e),onClick:i.sortable?g:void 0,class:ie,style:_,"data-key":i.key};return Qe("div",Yo(Z,{role:"columnheader"}),[F,E&&Qe(Qse,{class:[s.e("sort-icon"),H&&s.is("sorting")],sortOrder:U},null)])};var qP=ele;const Qz=(e,{slots:t})=>{var i;return Qe("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};Qz.displayName="ElTableV2Footer";var tle=Qz;const e4=(e,{slots:t})=>{const i=_t(t,"default",{},()=>[Qe(qD,null,null)]);return Qe("div",{class:e.class,style:e.style},[i])};e4.displayName="ElTableV2Empty";var nle=e4;const t4=(e,{slots:t})=>{var i;return Qe("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};t4.displayName="ElTableV2Overlay";var ole=t4;function Rv(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const rle="ElTableV2",ile=Ze({name:rle,props:fse,setup(e,{slots:t,expose:i}){const s=rn("table-v2"),{columnsStyles:d,fixedColumnsOnLeft:g,fixedColumnsOnRight:_,mainColumns:o,mainTableHeight:S,fixedTableHeight:E,leftTableWidth:I,rightTableWidth:P,data:F,depthMap:B,expandedRowKeys:$,hasFixedColumns:z,mainTableRef:H,leftTableRef:U,rightTableRef:ie,isDynamic:Z,isResetting:G,isScrolling:Q,bodyWidth:oe,emptyStyle:le,rootStyle:me,headerWidth:fe,footerHeight:ce,showEmpty:pe,scrollTo:ye,scrollToLeft:De,scrollToTop:tt,scrollToRow:Me,getRowHeight:xe,onColumnSorted:Ae,onRowHeightChange:Ce,onRowHovered:ge,onRowExpanded:Ne,onRowsRendered:We,onScroll:ot,onVerticalScroll:Oe}=dse(e);return i({scrollTo:ye,scrollToLeft:De,scrollToTop:tt,scrollToRow:Me}),or(eC,{ns:s,isResetting:G,isScrolling:Q}),()=>{const{cache:Ct,cellProps:Mt,estimatedRowHeight:zt,expandColumnKey:bt,fixedData:Kt,headerHeight:$t,headerClass:Re,headerProps:dn,headerCellProps:At,sortBy:Ke,sortState:Be,rowHeight:Ht,rowClass:Ut,rowEventHandlers:Nt,rowKey:Et,rowProps:Gt,scrollbarAlwaysOn:ln,indentSize:yn,iconSize:_n,useIsScrolling:jn,vScrollbarSize:yt,width:kn}=e,qn=y(F),Co={cache:Ct,class:s.e("main"),columns:y(o),data:qn,fixedData:Kt,estimatedRowHeight:zt,bodyWidth:y(oe)+yt,headerHeight:$t,headerWidth:y(fe),height:y(S),mainTableRef:H,rowKey:Et,rowHeight:Ht,scrollbarAlwaysOn:ln,scrollbarStartGap:2,scrollbarEndGap:yt,useIsScrolling:jn,width:kn,getRowHeight:xe,onRowsRendered:We,onScroll:ot},mo=y(I),Io=y(E),Ho={cache:Ct,class:s.e("left"),columns:y(g),data:qn,estimatedRowHeight:zt,leftTableRef:U,rowHeight:Ht,bodyWidth:mo,headerWidth:mo,headerHeight:$t,height:Io,rowKey:Et,scrollbarAlwaysOn:ln,scrollbarStartGap:2,scrollbarEndGap:yt,useIsScrolling:jn,width:mo,getRowHeight:xe,onScroll:Oe},Dt=y(P)+yt,En={cache:Ct,class:s.e("right"),columns:y(_),data:qn,estimatedRowHeight:zt,rightTableRef:ie,rowHeight:Ht,bodyWidth:Dt,headerWidth:Dt,headerHeight:$t,height:Io,rowKey:Et,scrollbarAlwaysOn:ln,scrollbarStartGap:2,scrollbarEndGap:yt,width:Dt,style:`--${y(s.namespace)}-table-scrollbar-size: ${yt}px`,useIsScrolling:jn,getRowHeight:xe,onScroll:Oe},ft=y(d),un={ns:s,depthMap:y(B),columnsStyles:ft,expandColumnKey:bt,expandedRowKeys:y($),estimatedRowHeight:zt,hasFixedColumns:y(z),rowProps:Gt,rowClass:Ut,rowKey:Et,rowEventHandlers:Nt,onRowHovered:ge,onRowExpanded:Ne,onRowHeightChange:Ce},Je={cellProps:Mt,expandColumnKey:bt,indentSize:yn,iconSize:_n,rowKey:Et,expandedRowKeys:y($),ns:s},Mn={ns:s,headerClass:Re,headerProps:dn,columnsStyles:ft},Bn={ns:s,sortBy:Ke,sortState:Be,headerCellProps:At,onColumnSorted:Ae},Oo={row:Er=>Qe(Vse,Yo(Er,un),{row:t.row,cell:Nr=>{let Xo;return t.cell?Qe(WP,Yo(Nr,Je,{style:ft[Nr.column.key]}),Rv(Xo=t.cell(Nr))?Xo:{default:()=>[Xo]}):Qe(WP,Yo(Nr,Je,{style:ft[Nr.column.key]}),null)}}),header:Er=>Qe(Yse,Yo(Er,Mn),{header:t.header,cell:Nr=>{let Xo;return t["header-cell"]?Qe(qP,Yo(Nr,Bn,{style:ft[Nr.column.key]}),Rv(Xo=t["header-cell"](Nr))?Xo:{default:()=>[Xo]}):Qe(qP,Yo(Nr,Bn,{style:ft[Nr.column.key]}),null)}})},Rr=[e.class,s.b(),s.e("root"),{[s.is("dynamic")]:y(Z)}],hi={class:s.e("footer"),style:y(ce)};return Qe("div",{class:Rr,style:y(me)},[Qe(Ise,Co,Rv(Oo)?Oo:{default:()=>[Oo]}),Qe(Pse,Ho,Rv(Oo)?Oo:{default:()=>[Oo]}),Qe(Lse,En,Rv(Oo)?Oo:{default:()=>[Oo]}),t.footer&&Qe(tle,hi,{default:t.footer}),y(pe)&&Qe(nle,{class:s.e("empty"),style:y(le)},{default:t.empty}),t.overlay&&Qe(ole,{class:s.e("overlay")},{default:t.overlay})])}}});var ale=ile;const sle=vn({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:ut(Function)}}),lle=e=>{const t=Se(),i=Se(0),s=Se(0);let d;return No(()=>{d=Mi(t,([g])=>{const{width:_,height:o}=g.contentRect,{paddingLeft:S,paddingRight:E,paddingTop:I,paddingBottom:P}=getComputedStyle(g.target),F=Number.parseInt(S)||0,B=Number.parseInt(E)||0,$=Number.parseInt(I)||0,z=Number.parseInt(P)||0;i.value=_-F-B,s.value=o-$-z}).stop}),ni(()=>{d==null||d()}),tn([i,s],([g,_])=>{var o;(o=e.onResize)==null||o.call(e,{width:g,height:_})}),{sizer:t,width:i,height:s}},cle=Ze({name:"ElAutoResizer",props:sle,setup(e,{slots:t}){const i=rn("auto-resizer"),{height:s,width:d,sizer:g}=lle(e),_={width:"100%",height:"100%"};return()=>{var o;return Qe("div",{ref:g,class:i.b(),style:_},[(o=t.default)==null?void 0:o.call(t,{height:s.value,width:d.value})])}}});var ule=cle;const dle=Ao(ale),hle=Ao(ule),x1=Symbol("tabsRootContextKey"),fle=vn({tabs:{type:ut(Array),default:()=>Ri([])}}),n4="ElTabBar",ple=Ze({name:n4}),mle=Ze({...ple,props:fle,setup(e,{expose:t}){const i=e,s=jo(),d=Un(x1);d||ha(n4,"<el-tabs><el-tab-bar /></el-tabs>");const g=rn("tabs"),_=Se(),o=Se(),S=()=>{let B=0,$=0;const z=["top","bottom"].includes(d.props.tabPosition)?"width":"height",H=z==="width"?"x":"y",U=H==="x"?"left":"top";return i.tabs.every(ie=>{var Z,G;const Q=(G=(Z=s.parent)==null?void 0:Z.refs)==null?void 0:G[`tab-${ie.uid}`];if(!Q)return!1;if(!ie.active)return!0;B=Q[`offset${bu(U)}`],$=Q[`client${bu(z)}`];const oe=window.getComputedStyle(Q);return z==="width"&&($-=Number.parseFloat(oe.paddingLeft)+Number.parseFloat(oe.paddingRight),B+=Number.parseFloat(oe.paddingLeft)),!1}),{[z]:`${$}px`,transform:`translate${bu(H)}(${B}px)`}},E=()=>o.value=S(),I=[],P=()=>{var B;I.forEach(z=>z.stop()),I.length=0;const $=(B=s.parent)==null?void 0:B.refs;if($){for(const z in $)if(z.startsWith("tab-")){const H=$[z];H&&I.push(Mi(H,E))}}};tn(()=>i.tabs,async()=>{await oo(),E(),P()},{immediate:!0});const F=Mi(_,()=>E());return ni(()=>{I.forEach(B=>B.stop()),I.length=0,F.stop()}),t({ref:_,update:E}),(B,$)=>(se(),Pe("div",{ref_key:"barRef",ref:_,class:de([y(g).e("active-bar"),y(g).is(y(d).props.tabPosition)]),style:to(o.value)},null,6))}});var gle=bn(mle,[["__file","tab-bar.vue"]]);const vle=vn({panes:{type:ut(Array),default:()=>Ri([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),_le={tabClick:(e,t,i)=>i instanceof Event,tabRemove:(e,t)=>t instanceof Event},KP="ElTabNav",yle=Ze({name:KP,props:vle,emits:_le,setup(e,{expose:t,emit:i}){const s=Un(x1);s||ha(KP,"<el-tabs><tab-nav /></el-tabs>");const d=rn("tabs"),g=qH(),_=iG(),o=Se(),S=Se(),E=Se(),I=Se(),P=Se(!1),F=Se(0),B=Se(!1),$=Se(!0),z=te(()=>["top","bottom"].includes(s.props.tabPosition)?"width":"height"),H=te(()=>({transform:`translate${z.value==="width"?"X":"Y"}(-${F.value}px)`})),U=()=>{if(!o.value)return;const me=o.value[`offset${bu(z.value)}`],fe=F.value;if(!fe)return;const ce=fe>me?fe-me:0;F.value=ce},ie=()=>{if(!o.value||!S.value)return;const me=S.value[`offset${bu(z.value)}`],fe=o.value[`offset${bu(z.value)}`],ce=F.value;if(me-ce<=fe)return;const pe=me-ce>fe*2?ce+fe:me-fe;F.value=pe},Z=async()=>{const me=S.value;if(!P.value||!E.value||!o.value||!me)return;await oo();const fe=E.value.querySelector(".is-active");if(!fe)return;const ce=o.value,pe=["top","bottom"].includes(s.props.tabPosition),ye=fe.getBoundingClientRect(),De=ce.getBoundingClientRect(),tt=pe?me.offsetWidth-De.width:me.offsetHeight-De.height,Me=F.value;let xe=Me;pe?(ye.left<De.left&&(xe=Me-(De.left-ye.left)),ye.right>De.right&&(xe=Me+ye.right-De.right)):(ye.top<De.top&&(xe=Me-(De.top-ye.top)),ye.bottom>De.bottom&&(xe=Me+(ye.bottom-De.bottom))),xe=Math.max(xe,0),F.value=Math.min(xe,tt)},G=()=>{var me;if(!S.value||!o.value)return;e.stretch&&((me=I.value)==null||me.update());const fe=S.value[`offset${bu(z.value)}`],ce=o.value[`offset${bu(z.value)}`],pe=F.value;ce<fe?(P.value=P.value||{},P.value.prev=pe,P.value.next=pe+ce<fe,fe-pe<ce&&(F.value=fe-ce)):(P.value=!1,pe>0&&(F.value=0))},Q=me=>{let fe=0;switch(me.code){case On.left:case On.up:fe=-1;break;case On.right:case On.down:fe=1;break;default:return}const ce=Array.from(me.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let ye=ce.indexOf(me.target)+fe;ye<0?ye=ce.length-1:ye>=ce.length&&(ye=0),ce[ye].focus({preventScroll:!0}),ce[ye].click(),oe()},oe=()=>{$.value&&(B.value=!0)},le=()=>B.value=!1;return tn(g,me=>{me==="hidden"?$.value=!1:me==="visible"&&setTimeout(()=>$.value=!0,50)}),tn(_,me=>{me?setTimeout(()=>$.value=!0,50):$.value=!1}),Mi(E,G),No(()=>setTimeout(()=>Z(),0)),Au(()=>G()),t({scrollToActiveTab:Z,removeFocus:le}),()=>{const me=P.value?[Qe("span",{class:[d.e("nav-prev"),d.is("disabled",!P.value.prev)],onClick:U},[Qe(Gn,null,{default:()=>[Qe(yh,null,null)]})]),Qe("span",{class:[d.e("nav-next"),d.is("disabled",!P.value.next)],onClick:ie},[Qe(Gn,null,{default:()=>[Qe(Ls,null,null)]})])]:null,fe=e.panes.map((ce,pe)=>{var ye,De,tt,Me;const xe=ce.uid,Ae=ce.props.disabled,Ce=(De=(ye=ce.props.name)!=null?ye:ce.index)!=null?De:`${pe}`,ge=!Ae&&(ce.isClosable||e.editable);ce.index=`${pe}`;const Ne=ge?Qe(Gn,{class:"is-icon-close",onClick:Oe=>i("tabRemove",ce,Oe)},{default:()=>[Qe(Kc,null,null)]}):null,We=((Me=(tt=ce.slots).label)==null?void 0:Me.call(tt))||ce.props.label,ot=!Ae&&ce.active?0:-1;return Qe("div",{ref:`tab-${xe}`,class:[d.e("item"),d.is(s.props.tabPosition),d.is("active",ce.active),d.is("disabled",Ae),d.is("closable",ge),d.is("focus",B.value)],id:`tab-${Ce}`,key:`tab-${xe}`,"aria-controls":`pane-${Ce}`,role:"tab","aria-selected":ce.active,tabindex:ot,onFocus:()=>oe(),onBlur:()=>le(),onClick:Oe=>{le(),i("tabClick",ce,Ce,Oe)},onKeydown:Oe=>{ge&&(Oe.code===On.delete||Oe.code===On.backspace)&&i("tabRemove",ce,Oe)}},[We,Ne])});return Qe("div",{ref:E,class:[d.e("nav-wrap"),d.is("scrollable",!!P.value),d.is(s.props.tabPosition)]},[me,Qe("div",{class:d.e("nav-scroll"),ref:o},[Qe("div",{class:[d.e("nav"),d.is(s.props.tabPosition),d.is("stretch",e.stretch&&["top","bottom"].includes(s.props.tabPosition))],ref:S,style:H.value,role:"tablist",onKeydown:Q},[e.type?null:Qe(gle,{ref:I,tabs:[...e.panes]},null),fe])])])}}}),ble=vn({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:ut(Function),default:()=>!0},stretch:Boolean}),Vw=e=>Zn(e)||ao(e),xle={[Fo]:e=>Vw(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>Vw(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>Vw(e),tabAdd:()=>!0},wle=Ze({name:"ElTabs",props:ble,emits:xle,setup(e,{emit:t,slots:i,expose:s}){var d;const g=rn("tabs"),_=te(()=>["left","right"].includes(e.tabPosition)),{children:o,addChild:S,removeChild:E}=ET(jo(),"ElTabPane"),I=Se(),P=Se((d=e.modelValue)!=null?d:"0"),F=async(U,ie=!1)=>{var Z,G,Q;if(!(P.value===U||Hr(U)))try{await((Z=e.beforeLeave)==null?void 0:Z.call(e,U,P.value))!==!1&&(P.value=U,ie&&(t(Fo,U),t("tabChange",U)),(Q=(G=I.value)==null?void 0:G.removeFocus)==null||Q.call(G))}catch{}},B=(U,ie,Z)=>{U.props.disabled||(F(ie,!0),t("tabClick",U,Z))},$=(U,ie)=>{U.props.disabled||Hr(U.props.name)||(ie.stopPropagation(),t("edit",U.props.name,"remove"),t("tabRemove",U.props.name))},z=()=>{t("edit",void 0,"add"),t("tabAdd")};tn(()=>e.modelValue,U=>F(U)),tn(P,async()=>{var U;await oo(),(U=I.value)==null||U.scrollToActiveTab()}),or(x1,{props:e,currentName:P,registerPane:U=>{o.value.push(U)},sortPane:S,unregisterPane:E}),s({currentName:P});const H=({render:U})=>U();return()=>{const U=i["add-icon"],ie=e.editable||e.addable?Qe("div",{class:[g.e("new-tab"),_.value&&g.e("new-tab-vertical")],tabindex:"0",onClick:z,onKeydown:Q=>{[On.enter,On.numpadEnter].includes(Q.code)&&z()}},[U?_t(i,"add-icon"):Qe(Gn,{class:g.is("icon-plus")},{default:()=>[Qe(QO,null,null)]})]):null,Z=Qe("div",{class:[g.e("header"),_.value&&g.e("header-vertical"),g.is(e.tabPosition)]},[Qe(H,{render:()=>{const Q=o.value.some(oe=>oe.slots.label);return Qe(yle,{ref:I,currentName:P.value,editable:e.editable,type:e.type,panes:o.value,stretch:e.stretch,onTabClick:B,onTabRemove:$},{$stable:!Q})}},null),ie]),G=Qe("div",{class:g.e("content")},[_t(i,"default")]);return Qe("div",{class:[g.b(),g.m(e.tabPosition),{[g.m("card")]:e.type==="card",[g.m("border-card")]:e.type==="border-card"}]},[G,Z])}}});var Sle=wle;const Tle=vn({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),o4="ElTabPane",Cle=Ze({name:o4}),Ele=Ze({...Cle,props:Tle,setup(e){const t=e,i=jo(),s=aa(),d=Un(x1);d||ha(o4,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const g=rn("tab-pane"),_=Se(),o=te(()=>t.closable||d.props.closable),S=h2(()=>{var B;return d.currentName.value===((B=t.name)!=null?B:_.value)}),E=Se(S.value),I=te(()=>{var B;return(B=t.name)!=null?B:_.value}),P=h2(()=>!t.lazy||E.value||S.value);tn(S,B=>{B&&(E.value=!0)});const F=Pr({uid:i.uid,slots:s,props:t,paneName:I,active:S,index:_,isClosable:o});return d.registerPane(F),No(()=>{d.sortPane(F)}),Eh(()=>{d.unregisterPane(F.uid)}),(B,$)=>y(P)?zo((se(),Pe("div",{key:0,id:`pane-${y(I)}`,class:de(y(g).b()),role:"tabpanel","aria-hidden":!y(S),"aria-labelledby":`tab-${y(I)}`},[_t(B.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[Cr,y(S)]]):St("v-if",!0)}});var r4=bn(Ele,[["__file","tab-pane.vue"]]);const Mle=Ao(Sle,{TabPane:r4}),Ile=Oi(r4),Ale=vn({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:ku,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),kle=Ze({name:"ElText"}),Ple=Ze({...kle,props:Ale,setup(e){const t=e,i=na(),s=rn("text"),d=te(()=>[s.b(),s.m(t.type),s.m(i.value),s.is("truncated",t.truncated),s.is("line-clamp",!Hr(t.lineClamp))]);return(g,_)=>(se(),Rt(Wo(g.tag),{class:de(y(d)),style:to({"-webkit-line-clamp":g.lineClamp})},{default:at(()=>[_t(g.$slots,"default")]),_:3},8,["class","style"]))}});var Rle=bn(Ple,[["__file","text.vue"]]);const Ole=Ao(Rle),Lle=vn({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:ut(String),default:"light"},clearable:{type:Boolean,default:!0},size:ia,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:ut([String,Object]),default:()=>JO},clearIcon:{type:ut([String,Object]),default:()=>ud},...Um}),Qu=e=>{const t=(e||"").split(":");if(t.length>=2){let i=Number.parseInt(t[0],10);const s=Number.parseInt(t[1],10),d=e.toUpperCase();return d.includes("AM")&&i===12?i=0:d.includes("PM")&&i!==12&&(i+=12),{hours:i,minutes:s}}return null},Uw=(e,t)=>{const i=Qu(e);if(!i)return-1;const s=Qu(t);if(!s)return-1;const d=i.minutes+i.hours*60,g=s.minutes+s.hours*60;return d===g?0:d>g?1:-1},ZP=e=>`${e}`.padStart(2,"0"),Jp=e=>`${ZP(e.hours)}:${ZP(e.minutes)}`,Dle=(e,t)=>{const i=Qu(e);if(!i)return"";const s=Qu(t);if(!s)return"";const d={hours:i.hours,minutes:i.minutes};return d.minutes+=s.minutes,d.hours+=s.hours,d.hours+=Math.floor(d.minutes/60),d.minutes=d.minutes%60,Jp(d)},zle=Ze({name:"ElTimeSelect"}),Fle=Ze({...zle,props:Lle,emits:["change","blur","focus","clear","update:modelValue"],setup(e,{expose:t}){const i=e;Mo.extend(kT);const{Option:s}=Vf,d=rn("input"),g=Se(),_=Za(),{lang:o}=vr(),S=te(()=>i.modelValue),E=te(()=>{const U=Qu(i.start);return U?Jp(U):null}),I=te(()=>{const U=Qu(i.end);return U?Jp(U):null}),P=te(()=>{const U=Qu(i.step);return U?Jp(U):null}),F=te(()=>{const U=Qu(i.minTime||"");return U?Jp(U):null}),B=te(()=>{const U=Qu(i.maxTime||"");return U?Jp(U):null}),$=te(()=>{const U=[];if(i.start&&i.end&&i.step){let ie=E.value,Z;for(;ie&&I.value&&Uw(ie,I.value)<=0;)Z=Mo(ie,"HH:mm").locale(o.value).format(i.format),U.push({value:Z,disabled:Uw(ie,F.value||"-1:-1")<=0||Uw(ie,B.value||"100:100")>=0}),ie=Dle(ie,P.value)}return U});return t({blur:()=>{var U,ie;(ie=(U=g.value)==null?void 0:U.blur)==null||ie.call(U)},focus:()=>{var U,ie;(ie=(U=g.value)==null?void 0:U.focus)==null||ie.call(U)}}),(U,ie)=>(se(),Rt(y(Vf),{ref_key:"select",ref:g,"model-value":y(S),disabled:y(_),clearable:U.clearable,"clear-icon":U.clearIcon,size:U.size,effect:U.effect,placeholder:U.placeholder,"default-first-option":"",filterable:U.editable,"empty-values":U.emptyValues,"value-on-clear":U.valueOnClear,"onUpdate:modelValue":Z=>U.$emit("update:modelValue",Z),onChange:Z=>U.$emit("change",Z),onBlur:Z=>U.$emit("blur",Z),onFocus:Z=>U.$emit("focus",Z),onClear:()=>U.$emit("clear")},{prefix:at(()=>[U.prefixIcon?(se(),Rt(y(Gn),{key:0,class:de(y(d).e("prefix-icon"))},{default:at(()=>[(se(),Rt(Wo(U.prefixIcon)))]),_:1},8,["class"])):St("v-if",!0)]),default:at(()=>[(se(!0),Pe(eo,null,tr(y($),Z=>(se(),Rt(y(s),{key:Z.value,label:Z.value,value:Z.value,disabled:Z.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var Ble=bn(Fle,[["__file","time-select.vue"]]);const Nle=Ao(Ble),$le=Ze({name:"ElTimeline",setup(e,{slots:t}){const i=rn("timeline");return or("timeline",t),()=>lo("ul",{class:[i.b()]},[_t(t,"default")])}}),Vle=vn({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:Xr},hollow:Boolean}),Ule=Ze({name:"ElTimelineItem"}),jle=Ze({...Ule,props:Vle,setup(e){const t=e,i=rn("timeline-item"),s=te(()=>[i.e("node"),i.em("node",t.size||""),i.em("node",t.type||""),i.is("hollow",t.hollow)]);return(d,g)=>(se(),Pe("li",{class:de([y(i).b(),{[y(i).e("center")]:d.center}])},[He("div",{class:de(y(i).e("tail"))},null,2),d.$slots.dot?St("v-if",!0):(se(),Pe("div",{key:0,class:de(y(s)),style:to({backgroundColor:d.color})},[d.icon?(se(),Rt(y(Gn),{key:0,class:de(y(i).e("icon"))},{default:at(()=>[(se(),Rt(Wo(d.icon)))]),_:1},8,["class"])):St("v-if",!0)],6)),d.$slots.dot?(se(),Pe("div",{key:1,class:de(y(i).e("dot"))},[_t(d.$slots,"dot")],2)):St("v-if",!0),He("div",{class:de(y(i).e("wrapper"))},[!d.hideTimestamp&&d.placement==="top"?(se(),Pe("div",{key:0,class:de([y(i).e("timestamp"),y(i).is("top")])},wn(d.timestamp),3)):St("v-if",!0),He("div",{class:de(y(i).e("content"))},[_t(d.$slots,"default")],2),!d.hideTimestamp&&d.placement==="bottom"?(se(),Pe("div",{key:1,class:de([y(i).e("timestamp"),y(i).is("bottom")])},wn(d.timestamp),3)):St("v-if",!0)],2)],2))}});var i4=bn(jle,[["__file","timeline-item.vue"]]);const Hle=Ao($le,{TimelineItem:i4}),Gle=Oi(i4),a4=vn({nowrap:Boolean});var s4=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(s4||{});const Wle=Object.values(s4),aC=vn({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:ut(Object),default:null}}),qle=vn({side:{type:ut(String),values:Wle,required:!0}}),Kle=["absolute","fixed"],Zle=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],sC=vn({arrowPadding:{type:ut(Number),default:5},effect:{type:ut(String),default:"light"},contentClass:String,placement:{type:ut(String),values:Zle,default:"bottom"},reference:{type:ut(Object),default:null},offset:{type:Number,default:8},strategy:{type:ut(String),values:Kle,default:"absolute"},showArrow:Boolean,...Da(["ariaLabel"])}),lC=vn({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:ut(Function)},"onUpdate:open":{type:ut(Function)}}),qp={type:ut(Function)},cC=vn({onBlur:qp,onClick:qp,onFocus:qp,onMouseDown:qp,onMouseEnter:qp,onMouseLeave:qp}),Yle=vn({...lC,...aC,...cC,...sC,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:ut(Object),default:null},teleported:Boolean,to:{type:ut(String),default:"body"}}),w1=Symbol("tooltipV2"),l4=Symbol("tooltipV2Content"),jw="tooltip_v2.open",Xle=Ze({name:"ElTooltipV2Root"}),Jle=Ze({...Xle,props:lC,setup(e,{expose:t}){const i=e,s=Se(i.defaultOpen),d=Se(null),g=te({get:()=>Bf(i.open)?s.value:i.open,set:H=>{var U;s.value=H,(U=i["onUpdate:open"])==null||U.call(i,H)}}),_=te(()=>ao(i.delayDuration)&&i.delayDuration>0),{start:o,stop:S}=Nf(()=>{g.value=!0},te(()=>i.delayDuration),{immediate:!1}),E=rn("tooltip-v2"),I=La(),P=()=>{S(),g.value=!0},F=()=>{y(_)?o():P()},B=P,$=()=>{S(),g.value=!1};return tn(g,H=>{var U;H&&(document.dispatchEvent(new CustomEvent(jw)),B()),(U=i.onOpenChange)==null||U.call(i,H)}),No(()=>{document.addEventListener(jw,$)}),ni(()=>{S(),document.removeEventListener(jw,$)}),or(w1,{contentId:I,triggerRef:d,ns:E,onClose:$,onDelayOpen:F,onOpen:B}),t({onOpen:B,onClose:$}),(H,U)=>_t(H.$slots,"default",{open:y(g)})}});var Qle=bn(Jle,[["__file","root.vue"]]);const ece=Ze({name:"ElTooltipV2Arrow"}),tce=Ze({...ece,props:{...aC,...qle},setup(e){const t=e,{ns:i}=Un(w1),{arrowRef:s}=Un(l4),d=te(()=>{const{style:g,width:_,height:o}=t,S=i.namespace.value;return{[`--${S}-tooltip-v2-arrow-width`]:`${_}px`,[`--${S}-tooltip-v2-arrow-height`]:`${o}px`,[`--${S}-tooltip-v2-arrow-border-width`]:`${_/2}px`,[`--${S}-tooltip-v2-arrow-cover-width`]:_/2-1,...g||{}}});return(g,_)=>(se(),Pe("span",{ref_key:"arrowRef",ref:s,style:to(y(d)),class:de(y(i).e("arrow"))},null,6))}});var YP=bn(tce,[["__file","arrow.vue"]]);const km=Math.min,Lf=Math.max,Ob=Math.round,D0=Math.floor,Su=e=>({x:e,y:e}),nce={left:"right",right:"left",bottom:"top",top:"bottom"},oce={start:"end",end:"start"};function oS(e,t,i){return Lf(e,km(t,i))}function U_(e,t){return typeof e=="function"?e(t):e}function jf(e){return e.split("-")[0]}function j_(e){return e.split("-")[1]}function c4(e){return e==="x"?"y":"x"}function uC(e){return e==="y"?"height":"width"}function Pm(e){return["top","bottom"].includes(jf(e))?"y":"x"}function dC(e){return c4(Pm(e))}function rce(e,t,i){i===void 0&&(i=!1);const s=j_(e),d=dC(e),g=uC(d);let _=d==="x"?s===(i?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[g]>t.floating[g]&&(_=Lb(_)),[_,Lb(_)]}function ice(e){const t=Lb(e);return[rS(e),t,rS(t)]}function rS(e){return e.replace(/start|end/g,t=>oce[t])}function ace(e,t,i){const s=["left","right"],d=["right","left"],g=["top","bottom"],_=["bottom","top"];switch(e){case"top":case"bottom":return i?t?d:s:t?s:d;case"left":case"right":return t?g:_;default:return[]}}function sce(e,t,i,s){const d=j_(e);let g=ace(jf(e),i==="start",s);return d&&(g=g.map(_=>_+"-"+d),t&&(g=g.concat(g.map(rS)))),g}function Lb(e){return e.replace(/left|right|bottom|top/g,t=>nce[t])}function lce(e){return{top:0,right:0,bottom:0,left:0,...e}}function u4(e){return typeof e!="number"?lce(e):{top:e,right:e,bottom:e,left:e}}function Db(e){const{x:t,y:i,width:s,height:d}=e;return{width:s,height:d,top:i,left:t,right:t+s,bottom:i+d,x:t,y:i}}function XP(e,t,i){let{reference:s,floating:d}=e;const g=Pm(t),_=dC(t),o=uC(_),S=jf(t),E=g==="y",I=s.x+s.width/2-d.width/2,P=s.y+s.height/2-d.height/2,F=s[o]/2-d[o]/2;let B;switch(S){case"top":B={x:I,y:s.y-d.height};break;case"bottom":B={x:I,y:s.y+s.height};break;case"right":B={x:s.x+s.width,y:P};break;case"left":B={x:s.x-d.width,y:P};break;default:B={x:s.x,y:s.y}}switch(j_(t)){case"start":B[_]-=F*(i&&E?-1:1);break;case"end":B[_]+=F*(i&&E?-1:1);break}return B}const cce=async(e,t,i)=>{const{placement:s="bottom",strategy:d="absolute",middleware:g=[],platform:_}=i,o=g.filter(Boolean),S=await(_.isRTL==null?void 0:_.isRTL(t));let E=await _.getElementRects({reference:e,floating:t,strategy:d}),{x:I,y:P}=XP(E,s,S),F=s,B={},$=0;for(let z=0;z<o.length;z++){const{name:H,fn:U}=o[z],{x:ie,y:Z,data:G,reset:Q}=await U({x:I,y:P,initialPlacement:s,placement:F,strategy:d,middlewareData:B,rects:E,platform:_,elements:{reference:e,floating:t}});I=ie??I,P=Z??P,B={...B,[H]:{...B[H],...G}},Q&&$<=50&&($++,typeof Q=="object"&&(Q.placement&&(F=Q.placement),Q.rects&&(E=Q.rects===!0?await _.getElementRects({reference:e,floating:t,strategy:d}):Q.rects),{x:I,y:P}=XP(E,F,S)),z=-1)}return{x:I,y:P,placement:F,strategy:d,middlewareData:B}};async function hC(e,t){var i;t===void 0&&(t={});const{x:s,y:d,platform:g,rects:_,elements:o,strategy:S}=e,{boundary:E="clippingAncestors",rootBoundary:I="viewport",elementContext:P="floating",altBoundary:F=!1,padding:B=0}=U_(t,e),$=u4(B),H=o[F?P==="floating"?"reference":"floating":P],U=Db(await g.getClippingRect({element:(i=await(g.isElement==null?void 0:g.isElement(H)))==null||i?H:H.contextElement||await(g.getDocumentElement==null?void 0:g.getDocumentElement(o.floating)),boundary:E,rootBoundary:I,strategy:S})),ie=P==="floating"?{x:s,y:d,width:_.floating.width,height:_.floating.height}:_.reference,Z=await(g.getOffsetParent==null?void 0:g.getOffsetParent(o.floating)),G=await(g.isElement==null?void 0:g.isElement(Z))?await(g.getScale==null?void 0:g.getScale(Z))||{x:1,y:1}:{x:1,y:1},Q=Db(g.convertOffsetParentRelativeRectToViewportRelativeRect?await g.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:ie,offsetParent:Z,strategy:S}):ie);return{top:(U.top-Q.top+$.top)/G.y,bottom:(Q.bottom-U.bottom+$.bottom)/G.y,left:(U.left-Q.left+$.left)/G.x,right:(Q.right-U.right+$.right)/G.x}}const uce=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:s,placement:d,rects:g,platform:_,elements:o,middlewareData:S}=t,{element:E,padding:I=0}=U_(e,t)||{};if(E==null)return{};const P=u4(I),F={x:i,y:s},B=dC(d),$=uC(B),z=await _.getDimensions(E),H=B==="y",U=H?"top":"left",ie=H?"bottom":"right",Z=H?"clientHeight":"clientWidth",G=g.reference[$]+g.reference[B]-F[B]-g.floating[$],Q=F[B]-g.reference[B],oe=await(_.getOffsetParent==null?void 0:_.getOffsetParent(E));let le=oe?oe[Z]:0;(!le||!await(_.isElement==null?void 0:_.isElement(oe)))&&(le=o.floating[Z]||g.floating[$]);const me=G/2-Q/2,fe=le/2-z[$]/2-1,ce=km(P[U],fe),pe=km(P[ie],fe),ye=ce,De=le-z[$]-pe,tt=le/2-z[$]/2+me,Me=oS(ye,tt,De),xe=!S.arrow&&j_(d)!=null&&tt!==Me&&g.reference[$]/2-(tt<ye?ce:pe)-z[$]/2<0,Ae=xe?tt<ye?tt-ye:tt-De:0;return{[B]:F[B]+Ae,data:{[B]:Me,centerOffset:tt-Me-Ae,...xe&&{alignmentOffset:Ae}},reset:xe}}}),dce=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var i,s;const{placement:d,middlewareData:g,rects:_,initialPlacement:o,platform:S,elements:E}=t,{mainAxis:I=!0,crossAxis:P=!0,fallbackPlacements:F,fallbackStrategy:B="bestFit",fallbackAxisSideDirection:$="none",flipAlignment:z=!0,...H}=U_(e,t);if((i=g.arrow)!=null&&i.alignmentOffset)return{};const U=jf(d),ie=Pm(o),Z=jf(o)===o,G=await(S.isRTL==null?void 0:S.isRTL(E.floating)),Q=F||(Z||!z?[Lb(o)]:ice(o)),oe=$!=="none";!F&&oe&&Q.push(...sce(o,z,$,G));const le=[o,...Q],me=await hC(t,H),fe=[];let ce=((s=g.flip)==null?void 0:s.overflows)||[];if(I&&fe.push(me[U]),P){const tt=rce(d,_,G);fe.push(me[tt[0]],me[tt[1]])}if(ce=[...ce,{placement:d,overflows:fe}],!fe.every(tt=>tt<=0)){var pe,ye;const tt=(((pe=g.flip)==null?void 0:pe.index)||0)+1,Me=le[tt];if(Me)return{data:{index:tt,overflows:ce},reset:{placement:Me}};let xe=(ye=ce.filter(Ae=>Ae.overflows[0]<=0).sort((Ae,Ce)=>Ae.overflows[1]-Ce.overflows[1])[0])==null?void 0:ye.placement;if(!xe)switch(B){case"bestFit":{var De;const Ae=(De=ce.filter(Ce=>{if(oe){const ge=Pm(Ce.placement);return ge===ie||ge==="y"}return!0}).map(Ce=>[Ce.placement,Ce.overflows.filter(ge=>ge>0).reduce((ge,Ne)=>ge+Ne,0)]).sort((Ce,ge)=>Ce[1]-ge[1])[0])==null?void 0:De[0];Ae&&(xe=Ae);break}case"initialPlacement":xe=o;break}if(d!==xe)return{reset:{placement:xe}}}return{}}}};async function hce(e,t){const{placement:i,platform:s,elements:d}=e,g=await(s.isRTL==null?void 0:s.isRTL(d.floating)),_=jf(i),o=j_(i),S=Pm(i)==="y",E=["left","top"].includes(_)?-1:1,I=g&&S?-1:1,P=U_(t,e);let{mainAxis:F,crossAxis:B,alignmentAxis:$}=typeof P=="number"?{mainAxis:P,crossAxis:0,alignmentAxis:null}:{mainAxis:P.mainAxis||0,crossAxis:P.crossAxis||0,alignmentAxis:P.alignmentAxis};return o&&typeof $=="number"&&(B=o==="end"?$*-1:$),S?{x:B*I,y:F*E}:{x:F*E,y:B*I}}const fce=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var i,s;const{x:d,y:g,placement:_,middlewareData:o}=t,S=await hce(t,e);return _===((i=o.offset)==null?void 0:i.placement)&&(s=o.arrow)!=null&&s.alignmentOffset?{}:{x:d+S.x,y:g+S.y,data:{...S,placement:_}}}}},pce=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:s,placement:d}=t,{mainAxis:g=!0,crossAxis:_=!1,limiter:o={fn:H=>{let{x:U,y:ie}=H;return{x:U,y:ie}}},...S}=U_(e,t),E={x:i,y:s},I=await hC(t,S),P=Pm(jf(d)),F=c4(P);let B=E[F],$=E[P];if(g){const H=F==="y"?"top":"left",U=F==="y"?"bottom":"right",ie=B+I[H],Z=B-I[U];B=oS(ie,B,Z)}if(_){const H=P==="y"?"top":"left",U=P==="y"?"bottom":"right",ie=$+I[H],Z=$-I[U];$=oS(ie,$,Z)}const z=o.fn({...t,[F]:B,[P]:$});return{...z,data:{x:z.x-i,y:z.y-s,enabled:{[F]:g,[P]:_}}}}}};function S1(){return typeof window<"u"}function qm(e){return d4(e)?(e.nodeName||"").toLowerCase():"#document"}function Cl(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ou(e){var t;return(t=(d4(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function d4(e){return S1()?e instanceof Node||e instanceof Cl(e).Node:!1}function Zc(e){return S1()?e instanceof Element||e instanceof Cl(e).Element:!1}function Iu(e){return S1()?e instanceof HTMLElement||e instanceof Cl(e).HTMLElement:!1}function JP(e){return!S1()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Cl(e).ShadowRoot}function H_(e){const{overflow:t,overflowX:i,overflowY:s,display:d}=Yc(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+i)&&!["inline","contents"].includes(d)}function mce(e){return["table","td","th"].includes(qm(e))}function T1(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function fC(e){const t=pC(),i=Zc(e)?Yc(e):e;return i.transform!=="none"||i.perspective!=="none"||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","perspective","filter"].some(s=>(i.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(i.contain||"").includes(s))}function gce(e){let t=Sh(e);for(;Iu(t)&&!Rm(t);){if(fC(t))return t;if(T1(t))return null;t=Sh(t)}return null}function pC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Rm(e){return["html","body","#document"].includes(qm(e))}function Yc(e){return Cl(e).getComputedStyle(e)}function C1(e){return Zc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Sh(e){if(qm(e)==="html")return e;const t=e.assignedSlot||e.parentNode||JP(e)&&e.host||Ou(e);return JP(t)?t.host:t}function h4(e){const t=Sh(e);return Rm(t)?e.ownerDocument?e.ownerDocument.body:e.body:Iu(t)&&H_(t)?t:h4(t)}function T_(e,t,i){var s;t===void 0&&(t=[]),i===void 0&&(i=!0);const d=h4(e),g=d===((s=e.ownerDocument)==null?void 0:s.body),_=Cl(d);if(g){const o=iS(_);return t.concat(_,_.visualViewport||[],H_(d)?d:[],o&&i?T_(o):[])}return t.concat(d,T_(d,[],i))}function iS(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function f4(e){const t=Yc(e);let i=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const d=Iu(e),g=d?e.offsetWidth:i,_=d?e.offsetHeight:s,o=Ob(i)!==g||Ob(s)!==_;return o&&(i=g,s=_),{width:i,height:s,$:o}}function mC(e){return Zc(e)?e:e.contextElement}function fm(e){const t=mC(e);if(!Iu(t))return Su(1);const i=t.getBoundingClientRect(),{width:s,height:d,$:g}=f4(t);let _=(g?Ob(i.width):i.width)/s,o=(g?Ob(i.height):i.height)/d;return(!_||!Number.isFinite(_))&&(_=1),(!o||!Number.isFinite(o))&&(o=1),{x:_,y:o}}const vce=Su(0);function p4(e){const t=Cl(e);return!pC()||!t.visualViewport?vce:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function _ce(e,t,i){return t===void 0&&(t=!1),!i||t&&i!==Cl(e)?!1:t}function Hf(e,t,i,s){t===void 0&&(t=!1),i===void 0&&(i=!1);const d=e.getBoundingClientRect(),g=mC(e);let _=Su(1);t&&(s?Zc(s)&&(_=fm(s)):_=fm(e));const o=_ce(g,i,s)?p4(g):Su(0);let S=(d.left+o.x)/_.x,E=(d.top+o.y)/_.y,I=d.width/_.x,P=d.height/_.y;if(g){const F=Cl(g),B=s&&Zc(s)?Cl(s):s;let $=F,z=iS($);for(;z&&s&&B!==$;){const H=fm(z),U=z.getBoundingClientRect(),ie=Yc(z),Z=U.left+(z.clientLeft+parseFloat(ie.paddingLeft))*H.x,G=U.top+(z.clientTop+parseFloat(ie.paddingTop))*H.y;S*=H.x,E*=H.y,I*=H.x,P*=H.y,S+=Z,E+=G,$=Cl(z),z=iS($)}}return Db({width:I,height:P,x:S,y:E})}function gC(e,t){const i=C1(e).scrollLeft;return t?t.left+i:Hf(Ou(e)).left+i}function m4(e,t,i){i===void 0&&(i=!1);const s=e.getBoundingClientRect(),d=s.left+t.scrollLeft-(i?0:gC(e,s)),g=s.top+t.scrollTop;return{x:d,y:g}}function yce(e){let{elements:t,rect:i,offsetParent:s,strategy:d}=e;const g=d==="fixed",_=Ou(s),o=t?T1(t.floating):!1;if(s===_||o&&g)return i;let S={scrollLeft:0,scrollTop:0},E=Su(1);const I=Su(0),P=Iu(s);if((P||!P&&!g)&&((qm(s)!=="body"||H_(_))&&(S=C1(s)),Iu(s))){const B=Hf(s);E=fm(s),I.x=B.x+s.clientLeft,I.y=B.y+s.clientTop}const F=_&&!P&&!g?m4(_,S,!0):Su(0);return{width:i.width*E.x,height:i.height*E.y,x:i.x*E.x-S.scrollLeft*E.x+I.x+F.x,y:i.y*E.y-S.scrollTop*E.y+I.y+F.y}}function bce(e){return Array.from(e.getClientRects())}function xce(e){const t=Ou(e),i=C1(e),s=e.ownerDocument.body,d=Lf(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),g=Lf(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let _=-i.scrollLeft+gC(e);const o=-i.scrollTop;return Yc(s).direction==="rtl"&&(_+=Lf(t.clientWidth,s.clientWidth)-d),{width:d,height:g,x:_,y:o}}function wce(e,t){const i=Cl(e),s=Ou(e),d=i.visualViewport;let g=s.clientWidth,_=s.clientHeight,o=0,S=0;if(d){g=d.width,_=d.height;const E=pC();(!E||E&&t==="fixed")&&(o=d.offsetLeft,S=d.offsetTop)}return{width:g,height:_,x:o,y:S}}function Sce(e,t){const i=Hf(e,!0,t==="fixed"),s=i.top+e.clientTop,d=i.left+e.clientLeft,g=Iu(e)?fm(e):Su(1),_=e.clientWidth*g.x,o=e.clientHeight*g.y,S=d*g.x,E=s*g.y;return{width:_,height:o,x:S,y:E}}function QP(e,t,i){let s;if(t==="viewport")s=wce(e,i);else if(t==="document")s=xce(Ou(e));else if(Zc(t))s=Sce(t,i);else{const d=p4(e);s={x:t.x-d.x,y:t.y-d.y,width:t.width,height:t.height}}return Db(s)}function g4(e,t){const i=Sh(e);return i===t||!Zc(i)||Rm(i)?!1:Yc(i).position==="fixed"||g4(i,t)}function Tce(e,t){const i=t.get(e);if(i)return i;let s=T_(e,[],!1).filter(o=>Zc(o)&&qm(o)!=="body"),d=null;const g=Yc(e).position==="fixed";let _=g?Sh(e):e;for(;Zc(_)&&!Rm(_);){const o=Yc(_),S=fC(_);!S&&o.position==="fixed"&&(d=null),(g?!S&&!d:!S&&o.position==="static"&&!!d&&["absolute","fixed"].includes(d.position)||H_(_)&&!S&&g4(e,_))?s=s.filter(I=>I!==_):d=o,_=Sh(_)}return t.set(e,s),s}function Cce(e){let{element:t,boundary:i,rootBoundary:s,strategy:d}=e;const _=[...i==="clippingAncestors"?T1(t)?[]:Tce(t,this._c):[].concat(i),s],o=_[0],S=_.reduce((E,I)=>{const P=QP(t,I,d);return E.top=Lf(P.top,E.top),E.right=km(P.right,E.right),E.bottom=km(P.bottom,E.bottom),E.left=Lf(P.left,E.left),E},QP(t,o,d));return{width:S.right-S.left,height:S.bottom-S.top,x:S.left,y:S.top}}function Ece(e){const{width:t,height:i}=f4(e);return{width:t,height:i}}function Mce(e,t,i){const s=Iu(t),d=Ou(t),g=i==="fixed",_=Hf(e,!0,g,t);let o={scrollLeft:0,scrollTop:0};const S=Su(0);if(s||!s&&!g)if((qm(t)!=="body"||H_(d))&&(o=C1(t)),s){const F=Hf(t,!0,g,t);S.x=F.x+t.clientLeft,S.y=F.y+t.clientTop}else d&&(S.x=gC(d));const E=d&&!s&&!g?m4(d,o):Su(0),I=_.left+o.scrollLeft-S.x-E.x,P=_.top+o.scrollTop-S.y-E.y;return{x:I,y:P,width:_.width,height:_.height}}function Hw(e){return Yc(e).position==="static"}function e3(e,t){if(!Iu(e)||Yc(e).position==="fixed")return null;if(t)return t(e);let i=e.offsetParent;return Ou(e)===i&&(i=i.ownerDocument.body),i}function v4(e,t){const i=Cl(e);if(T1(e))return i;if(!Iu(e)){let d=Sh(e);for(;d&&!Rm(d);){if(Zc(d)&&!Hw(d))return d;d=Sh(d)}return i}let s=e3(e,t);for(;s&&mce(s)&&Hw(s);)s=e3(s,t);return s&&Rm(s)&&Hw(s)&&!fC(s)?i:s||gce(e)||i}const Ice=async function(e){const t=this.getOffsetParent||v4,i=this.getDimensions,s=await i(e.floating);return{reference:Mce(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Ace(e){return Yc(e).direction==="rtl"}const kce={convertOffsetParentRelativeRectToViewportRelativeRect:yce,getDocumentElement:Ou,getClippingRect:Cce,getOffsetParent:v4,getElementRects:Ice,getClientRects:bce,getDimensions:Ece,getScale:fm,isElement:Zc,isRTL:Ace};function Pce(e,t){let i=null,s;const d=Ou(e);function g(){var o;clearTimeout(s),(o=i)==null||o.disconnect(),i=null}function _(o,S){o===void 0&&(o=!1),S===void 0&&(S=1),g();const{left:E,top:I,width:P,height:F}=e.getBoundingClientRect();if(o||t(),!P||!F)return;const B=D0(I),$=D0(d.clientWidth-(E+P)),z=D0(d.clientHeight-(I+F)),H=D0(E),ie={rootMargin:-B+"px "+-$+"px "+-z+"px "+-H+"px",threshold:Lf(0,km(1,S))||1};let Z=!0;function G(Q){const oe=Q[0].intersectionRatio;if(oe!==S){if(!Z)return _();oe?_(!1,oe):s=setTimeout(()=>{_(!1,1e-7)},1e3)}Z=!1}try{i=new IntersectionObserver(G,{...ie,root:d.ownerDocument})}catch{i=new IntersectionObserver(G,ie)}i.observe(e)}return _(!0),g}function Rce(e,t,i,s){s===void 0&&(s={});const{ancestorScroll:d=!0,ancestorResize:g=!0,elementResize:_=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:S=!1}=s,E=mC(e),I=d||g?[...E?T_(E):[],...T_(t)]:[];I.forEach(U=>{d&&U.addEventListener("scroll",i,{passive:!0}),g&&U.addEventListener("resize",i)});const P=E&&o?Pce(E,i):null;let F=-1,B=null;_&&(B=new ResizeObserver(U=>{let[ie]=U;ie&&ie.target===E&&B&&(B.unobserve(t),cancelAnimationFrame(F),F=requestAnimationFrame(()=>{var Z;(Z=B)==null||Z.observe(t)})),i()}),E&&!S&&B.observe(E),B.observe(t));let $,z=S?Hf(e):null;S&&H();function H(){const U=Hf(e);z&&(U.x!==z.x||U.y!==z.y||U.width!==z.width||U.height!==z.height)&&i(),z=U,$=requestAnimationFrame(H)}return i(),()=>{var U;I.forEach(ie=>{d&&ie.removeEventListener("scroll",i),g&&ie.removeEventListener("resize",i)}),P==null||P(),(U=B)==null||U.disconnect(),B=null,S&&cancelAnimationFrame($)}}const Oce=hC,_4=fce,Lce=pce,Dce=dce,y4=uce,b4=(e,t,i)=>{const s=new Map,d={platform:kce,...i},g={...d.platform,_c:s};return cce(e,t,{...d,platform:g})},zce=vn({style:{type:ut([String,Object,Array]),default:()=>({})}}),Fce=Ze({name:"ElVisuallyHidden"}),Bce=Ze({...Fce,props:zce,setup(e){const t=e,i=te(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(s,d)=>(se(),Pe("span",Yo(s.$attrs,{style:y(i)}),[_t(s.$slots,"default")],16))}});var Nce=bn(Bce,[["__file","visual-hidden.vue"]]);vn({});const $ce=e=>{if(!gr)return;if(!e)return e;const t=Os(e);return t||(vi(e)?t:e)},Vce=({middleware:e,placement:t,strategy:i})=>{const s=Se(),d=Se(),g=Se(),_=Se(),o=Se({}),S={x:g,y:_,placement:t,strategy:i,middlewareData:o},E=async()=>{if(!gr)return;const I=$ce(s),P=Os(d);if(!I||!P)return;const F=await b4(I,P,{placement:y(t),strategy:y(i),middleware:y(e)});bm(S).forEach(B=>{S[B].value=F[B]})};return No(()=>{Ha(()=>{E()})}),{...S,update:E,referenceRef:s,contentRef:d}},Uce=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(i){const s=y(e);return s?y4({element:s,padding:t}).fn(i):{}}}),jce=Ze({name:"ElTooltipV2Content"}),Hce=Ze({...jce,props:{...sC,...a4},setup(e){const t=e,{triggerRef:i,contentId:s}=Un(w1),d=Se(t.placement),g=Se(t.strategy),_=Se(null),{referenceRef:o,contentRef:S,middlewareData:E,x:I,y:P,update:F}=Vce({placement:d,strategy:g,middleware:te(()=>{const Z=[_4(t.offset)];return t.showArrow&&Z.push(Uce({arrowRef:_})),Z})}),B=Vm().nextZIndex(),$=rn("tooltip-v2"),z=te(()=>d.value.split("-")[0]),H=te(()=>({position:y(g),top:`${y(P)||0}px`,left:`${y(I)||0}px`,zIndex:B})),U=te(()=>{if(!t.showArrow)return{};const{arrow:Z}=y(E);return{[`--${$.namespace.value}-tooltip-v2-arrow-x`]:`${Z==null?void 0:Z.x}px`||"",[`--${$.namespace.value}-tooltip-v2-arrow-y`]:`${Z==null?void 0:Z.y}px`||""}}),ie=te(()=>[$.e("content"),$.is("dark",t.effect==="dark"),$.is(y(g)),t.contentClass]);return tn(_,()=>F()),tn(()=>t.placement,Z=>d.value=Z),No(()=>{tn(()=>t.reference||i.value,Z=>{o.value=Z||void 0},{immediate:!0})}),or(l4,{arrowRef:_}),(Z,G)=>(se(),Pe("div",{ref_key:"contentRef",ref:S,style:to(y(H)),"data-tooltip-v2-root":""},[Z.nowrap?St("v-if",!0):(se(),Pe("div",{key:0,"data-side":y(z),class:de(y(ie))},[_t(Z.$slots,"default",{contentStyle:y(H),contentClass:y(ie)}),Qe(y(Nce),{id:y(s),role:"tooltip"},{default:at(()=>[Z.ariaLabel?(se(),Pe(eo,{key:0},[nr(wn(Z.ariaLabel),1)],64)):_t(Z.$slots,"default",{key:1})]),_:3},8,["id"]),_t(Z.$slots,"arrow",{style:to(y(U)),side:y(z)})],10,["data-side"]))],4))}});var t3=bn(Hce,[["__file","content.vue"]]);const Gce=vn({setRef:{type:ut(Function),required:!0},onlyChild:Boolean});var Wce=Ze({props:Gce,setup(e,{slots:t}){const i=Se(),s=v1(i,d=>{d?e.setRef(d.nextElementSibling):e.setRef(null)});return()=>{var d;const[g]=((d=t.default)==null?void 0:d.call(t))||[],_=e.onlyChild?fZ(g.children):g.children;return Qe(eo,{ref:s},[_])}}});const qce=Ze({name:"ElTooltipV2Trigger"}),Kce=Ze({...qce,props:{...a4,...cC},setup(e){const t=e,{onClose:i,onOpen:s,onDelayOpen:d,triggerRef:g,contentId:_}=Un(w1);let o=!1;const S=ie=>{g.value=ie},E=()=>{o=!1},I=Ui(t.onMouseEnter,d),P=Ui(t.onMouseLeave,i),F=Ui(t.onMouseDown,()=>{i(),o=!0,document.addEventListener("mouseup",E,{once:!0})}),B=Ui(t.onFocus,()=>{o||s()}),$=Ui(t.onBlur,i),z=Ui(t.onClick,ie=>{ie.detail===0&&i()}),H={blur:$,click:z,focus:B,mousedown:F,mouseenter:I,mouseleave:P},U=(ie,Z,G)=>{ie&&Object.entries(Z).forEach(([Q,oe])=>{ie[G](Q,oe)})};return tn(g,(ie,Z)=>{U(ie,H,"addEventListener"),U(Z,H,"removeEventListener"),ie&&ie.setAttribute("aria-describedby",_.value)}),ni(()=>{U(g.value,H,"removeEventListener"),document.removeEventListener("mouseup",E)}),(ie,Z)=>ie.nowrap?(se(),Rt(y(Wce),{key:0,"set-ref":S,"only-child":""},{default:at(()=>[_t(ie.$slots,"default")]),_:3})):(se(),Pe("button",Yo({key:1,ref_key:"triggerRef",ref:g},ie.$attrs),[_t(ie.$slots,"default")],16))}});var Zce=bn(Kce,[["__file","trigger.vue"]]);const Yce=Ze({name:"ElTooltipV2"}),Xce=Ze({...Yce,props:Yle,setup(e){const i=Ca(e),s=Pr(Uc(i,Object.keys(aC))),d=Pr(Uc(i,Object.keys(sC))),g=Pr(Uc(i,Object.keys(lC))),_=Pr(Uc(i,Object.keys(cC)));return(o,S)=>(se(),Rt(Qle,Vc(mh(g)),{default:at(({open:E})=>[Qe(Zce,Yo(_,{nowrap:""}),{default:at(()=>[_t(o.$slots,"trigger")]),_:3},16),Qe(y(Hm),{to:o.to,disabled:!o.teleported},{default:at(()=>[o.fullTransition?(se(),Rt(Ea,Vc(Yo({key:0},o.transitionProps)),{default:at(()=>[o.alwaysOn||E?(se(),Rt(t3,Vc(Yo({key:0},d)),{arrow:at(({style:I,side:P})=>[o.showArrow?(se(),Rt(YP,Yo({key:0},s,{style:I,side:P}),null,16,["style","side"])):St("v-if",!0)]),default:at(()=>[_t(o.$slots,"default")]),_:3},16)):St("v-if",!0)]),_:2},1040)):(se(),Pe(eo,{key:1},[o.alwaysOn||E?(se(),Rt(t3,Vc(Yo({key:0},d)),{arrow:at(({style:I,side:P})=>[o.showArrow?(se(),Rt(YP,Yo({key:0},s,{style:I,side:P}),null,16,["style","side"])):St("v-if",!0)]),default:at(()=>[_t(o.$slots,"default")]),_:3},16)):St("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var Jce=bn(Xce,[["__file","tooltip.vue"]]);const Qce=Ao(Jce),x4="left-check-change",w4="right-check-change",Qp=vn({data:{type:ut(Array),default:()=>[]},titles:{type:ut(Array),default:()=>[]},buttonTexts:{type:ut(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:ut(Function)},leftDefaultChecked:{type:ut(Array),default:()=>[]},rightDefaultChecked:{type:ut(Array),default:()=>[]},renderContent:{type:ut(Function)},modelValue:{type:ut(Array),default:()=>[]},format:{type:ut(Object),default:()=>({})},filterable:Boolean,props:{type:ut(Object),default:()=>Ri({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),aS=(e,t)=>[e,t].every(fn)||fn(e)&&ga(t),eue={[Yr]:(e,t,i)=>[e,i].every(fn)&&["left","right"].includes(t),[Fo]:e=>fn(e),[x4]:aS,[w4]:aS},sS="checked-change",tue=vn({data:Qp.data,optionRender:{type:ut(Function)},placeholder:String,title:String,filterable:Boolean,format:Qp.format,filterMethod:Qp.filterMethod,defaultChecked:Qp.leftDefaultChecked,props:Qp.props}),nue={[sS]:aS},G_=e=>{const t={label:"label",key:"key",disabled:"disabled"};return te(()=>({...t,...e.props}))},oue=(e,t,i)=>{const s=G_(e),d=te(()=>e.data.filter(I=>Qn(e.filterMethod)?e.filterMethod(t.query,I):String(I[s.value.label]||I[s.value.key]).toLowerCase().includes(t.query.toLowerCase()))),g=te(()=>d.value.filter(I=>!I[s.value.disabled])),_=te(()=>{const I=t.checked.length,P=e.data.length,{noChecked:F,hasChecked:B}=e.format;return F&&B?I>0?B.replace(/\${checked}/g,I.toString()).replace(/\${total}/g,P.toString()):F.replace(/\${total}/g,P.toString()):`${I}/${P}`}),o=te(()=>{const I=t.checked.length;return I>0&&I<g.value.length}),S=()=>{const I=g.value.map(P=>P[s.value.key]);t.allChecked=I.length>0&&I.every(P=>t.checked.includes(P))},E=I=>{t.checked=I?g.value.map(P=>P[s.value.key]):[]};return tn(()=>t.checked,(I,P)=>{if(S(),t.checkChangeByUser){const F=I.concat(P).filter(B=>!I.includes(B)||!P.includes(B));i(sS,I,F)}else i(sS,I),t.checkChangeByUser=!0}),tn(g,()=>{S()}),tn(()=>e.data,()=>{const I=[],P=d.value.map(F=>F[s.value.key]);t.checked.forEach(F=>{P.includes(F)&&I.push(F)}),t.checkChangeByUser=!1,t.checked=I}),tn(()=>e.defaultChecked,(I,P)=>{if(P&&I.length===P.length&&I.every($=>P.includes($)))return;const F=[],B=g.value.map($=>$[s.value.key]);I.forEach($=>{B.includes($)&&F.push($)}),t.checkChangeByUser=!1,t.checked=F},{immediate:!0}),{filteredData:d,checkableData:g,checkedSummary:_,isIndeterminate:o,updateAllChecked:S,handleAllCheckedChange:E}},rue=Ze({name:"ElTransferPanel"}),iue=Ze({...rue,props:tue,emits:nue,setup(e,{expose:t,emit:i}){const s=e,d=aa(),g=({option:Z})=>Z,{t:_}=vr(),o=rn("transfer"),S=Pr({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),E=G_(s),{filteredData:I,checkedSummary:P,isIndeterminate:F,handleAllCheckedChange:B}=oue(s,S,i),$=te(()=>!yl(S.query)&&yl(I.value)),z=te(()=>!yl(d.default()[0].children)),{checked:H,allChecked:U,query:ie}=Ca(S);return t({query:ie}),(Z,G)=>(se(),Pe("div",{class:de(y(o).b("panel"))},[He("p",{class:de(y(o).be("panel","header"))},[Qe(y(rc),{modelValue:y(U),"onUpdate:modelValue":Q=>vi(U)?U.value=Q:null,indeterminate:y(F),"validate-event":!1,onChange:y(B)},{default:at(()=>[nr(wn(Z.title)+" ",1),He("span",null,wn(y(P)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),He("div",{class:de([y(o).be("panel","body"),y(o).is("with-footer",y(z))])},[Z.filterable?(se(),Rt(y(hs),{key:0,modelValue:y(ie),"onUpdate:modelValue":Q=>vi(ie)?ie.value=Q:null,class:de(y(o).be("panel","filter")),size:"default",placeholder:Z.placeholder,"prefix-icon":y(CW),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):St("v-if",!0),zo(Qe(y(YL),{modelValue:y(H),"onUpdate:modelValue":Q=>vi(H)?H.value=Q:null,"validate-event":!1,class:de([y(o).is("filterable",Z.filterable),y(o).be("panel","list")])},{default:at(()=>[(se(!0),Pe(eo,null,tr(y(I),Q=>(se(),Rt(y(rc),{key:Q[y(E).key],class:de(y(o).be("panel","item")),value:Q[y(E).key],disabled:Q[y(E).disabled],"validate-event":!1},{default:at(()=>{var oe;return[Qe(g,{option:(oe=Z.optionRender)==null?void 0:oe.call(Z,Q)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[Cr,!y($)&&!y(yl)(Z.data)]]),zo(He("div",{class:de(y(o).be("panel","empty"))},[_t(Z.$slots,"empty",{},()=>[nr(wn(y($)?y(_)("el.transfer.noMatch"):y(_)("el.transfer.noData")),1)])],2),[[Cr,y($)||y(yl)(Z.data)]])],2),y(z)?(se(),Pe("p",{key:0,class:de(y(o).be("panel","footer"))},[_t(Z.$slots,"default")],2)):St("v-if",!0)],2))}});var n3=bn(iue,[["__file","transfer-panel.vue"]]);const aue=e=>{const t=G_(e),i=te(()=>e.data.reduce((g,_)=>(g[_[t.value.key]]=_)&&g,{})),s=te(()=>e.data.filter(g=>!e.modelValue.includes(g[t.value.key]))),d=te(()=>e.targetOrder==="original"?e.data.filter(g=>e.modelValue.includes(g[t.value.key])):e.modelValue.reduce((g,_)=>{const o=i.value[_];return o&&g.push(o),g},[]));return{sourceData:s,targetData:d}},sue=(e,t,i)=>{const s=G_(e),d=(o,S,E)=>{i(Fo,o),i(Yr,o,S,E)};return{addToLeft:()=>{const o=e.modelValue.slice();t.rightChecked.forEach(S=>{const E=o.indexOf(S);E>-1&&o.splice(E,1)}),d(o,"left",t.rightChecked)},addToRight:()=>{let o=e.modelValue.slice();const S=e.data.filter(E=>{const I=E[s.value.key];return t.leftChecked.includes(I)&&!e.modelValue.includes(I)}).map(E=>E[s.value.key]);o=e.targetOrder==="unshift"?S.concat(o):o.concat(S),e.targetOrder==="original"&&(o=e.data.filter(E=>o.includes(E[s.value.key])).map(E=>E[s.value.key])),d(o,"right",t.leftChecked)}}},lue=(e,t)=>({onSourceCheckedChange:(d,g)=>{e.leftChecked=d,g&&t(x4,d,g)},onTargetCheckedChange:(d,g)=>{e.rightChecked=d,g&&t(w4,d,g)}}),cue=Ze({name:"ElTransfer"}),uue=Ze({...cue,props:Qp,emits:eue,setup(e,{expose:t,emit:i}){const s=e,d=aa(),{t:g}=vr(),_=rn("transfer"),{formItem:o}=Ka(),S=Pr({leftChecked:[],rightChecked:[]}),E=G_(s),{sourceData:I,targetData:P}=aue(s),{onSourceCheckedChange:F,onTargetCheckedChange:B}=lue(S,i),{addToLeft:$,addToRight:z}=sue(s,S,i),H=Se(),U=Se(),ie=me=>{switch(me){case"left":H.value.query="";break;case"right":U.value.query="";break}},Z=te(()=>s.buttonTexts.length===2),G=te(()=>s.titles[0]||g("el.transfer.titles.0")),Q=te(()=>s.titles[1]||g("el.transfer.titles.1")),oe=te(()=>s.filterPlaceholder||g("el.transfer.filterPlaceholder"));tn(()=>s.modelValue,()=>{var me;s.validateEvent&&((me=o==null?void 0:o.validate)==null||me.call(o,"change").catch(fe=>void 0))});const le=te(()=>me=>{var fe;if(s.renderContent)return s.renderContent(lo,me);const ce=(((fe=d.default)==null?void 0:fe.call(d,{option:me}))||[]).filter(pe=>pe.type!==Sa);return ce.length?ce:lo("span",me[E.value.label]||me[E.value.key])});return t({clearQuery:ie,leftPanel:H,rightPanel:U}),(me,fe)=>(se(),Pe("div",{class:de(y(_).b())},[Qe(n3,{ref_key:"leftPanel",ref:H,data:y(I),"option-render":y(le),placeholder:y(oe),title:y(G),filterable:me.filterable,format:me.format,"filter-method":me.filterMethod,"default-checked":me.leftDefaultChecked,props:s.props,onCheckedChange:y(F)},{empty:at(()=>[_t(me.$slots,"left-empty")]),default:at(()=>[_t(me.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),He("div",{class:de(y(_).e("buttons"))},[Qe(y(Ta),{type:"primary",class:de([y(_).e("button"),y(_).is("with-texts",y(Z))]),disabled:y(yl)(S.rightChecked),onClick:y($)},{default:at(()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(yh))]),_:1}),y(Hr)(me.buttonTexts[0])?St("v-if",!0):(se(),Pe("span",{key:0},wn(me.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),Qe(y(Ta),{type:"primary",class:de([y(_).e("button"),y(_).is("with-texts",y(Z))]),disabled:y(yl)(S.leftChecked),onClick:y(z)},{default:at(()=>[y(Hr)(me.buttonTexts[1])?St("v-if",!0):(se(),Pe("span",{key:0},wn(me.buttonTexts[1]),1)),Qe(y(Gn),null,{default:at(()=>[Qe(y(Ls))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),Qe(n3,{ref_key:"rightPanel",ref:U,data:y(P),"option-render":y(le),placeholder:y(oe),filterable:me.filterable,format:me.format,"filter-method":me.filterMethod,title:y(Q),"default-checked":me.rightDefaultChecked,props:s.props,onCheckedChange:y(B)},{empty:at(()=>[_t(me.$slots,"right-empty")]),default:at(()=>[_t(me.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var due=bn(uue,[["__file","transfer.vue"]]);const hue=Ao(due),pm="$treeNodeId",o3=function(e,t){!t||t[pm]||Object.defineProperty(t,pm,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},vC=function(e,t){return e?t[e]:t[pm]},lS=(e,t,i)=>{const s=e.value.currentNode;i();const d=e.value.currentNode;s!==d&&t("current-change",d?d.data:null,d)},cS=e=>{let t=!0,i=!0,s=!0;for(let d=0,g=e.length;d<g;d++){const _=e[d];(_.checked!==!0||_.indeterminate)&&(t=!1,_.disabled||(s=!1)),(_.checked!==!1||_.indeterminate)&&(i=!1)}return{all:t,none:i,allWithoutDisable:s,half:!t&&!i}},Dv=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:i,half:s}=cS(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):s?(e.checked=!1,e.indeterminate=!0):i&&(e.checked=!1,e.indeterminate=!1);const d=e.parent;!d||d.level===0||e.store.checkStrictly||Dv(d)},z0=function(e,t){const i=e.store.props,s=e.data||{},d=i[t];if(Qn(d))return d(s,e);if(Zn(d))return s[d];if(Hr(d)){const g=s[t];return g===void 0?"":g}};let fue=0,uS=class nb{constructor(t){this.id=fue++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const i in t)Tr(t,i)&&(this[i]=t[i]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const i=t.props;if(i&&typeof i.isLeaf<"u"){const g=z0(this,"isLeaf");ai(g)&&(this.isLeafByUser=g)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),fn(this.data)||o3(this,this.data),!this.data)return;const s=t.defaultExpandedKeys,d=t.key;d&&s&&s.includes(this.key)&&this.expand(null,t.autoExpandParent),d&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){fn(t)||o3(this,t),this.data=t,this.childNodes=[];let i;this.level===0&&fn(this.data)?i=this.data:i=z0(this,"children")||[];for(let s=0,d=i.length;s<d;s++)this.insertChild({data:i[s]})}get label(){return z0(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return z0(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return t.childNodes[i+1]}return null}get previousSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return i>0?t.childNodes[i-1]:null}return null}contains(t,i=!0){return(this.childNodes||[]).some(s=>s===t||i&&s.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,i,s){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof nb)){if(!s){const d=this.getChildren(!0);d.includes(t.data)||(Hr(i)||i<0?d.push(t.data):d.splice(i,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=Pr(new nb(t)),t instanceof nb&&t.initialize()}t.level=this.level+1,Hr(i)||i<0?this.childNodes.push(t):this.childNodes.splice(i,0,t),this.updateLeafState()}insertBefore(t,i){let s;i&&(s=this.childNodes.indexOf(i)),this.insertChild(t,s)}insertAfter(t,i){let s;i&&(s=this.childNodes.indexOf(i),s!==-1&&(s+=1)),this.insertChild(t,s)}removeChild(t){const i=this.getChildren()||[],s=i.indexOf(t.data);s>-1&&i.splice(s,1);const d=this.childNodes.indexOf(t);d>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(d,1)),this.updateLeafState()}removeChildByData(t){let i=null;for(let s=0;s<this.childNodes.length;s++)if(this.childNodes[s].data===t){i=this.childNodes[s];break}i&&this.removeChild(i)}expand(t,i){const s=()=>{if(i){let d=this.parent;for(;d.level>0;)d.expanded=!0,d=d.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(d=>{d.canFocus=!0})};this.shouldLoadData()?this.loadData(d=>{fn(d)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Dv(this),s())}):s()}doCreateChildren(t,i={}){t.forEach(s=>{this.insertChild(Object.assign({data:s},i),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,i,s,d){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:_,allWithoutDisable:o}=cS(this.childNodes);!this.isLeaf&&!_&&o&&(this.checked=!1,t=!1);const S=()=>{if(i){const E=this.childNodes;for(let F=0,B=E.length;F<B;F++){const $=E[F];d=d||t!==!1;const z=$.disabled?$.checked:d;$.setChecked(z,i,!0,d)}const{half:I,all:P}=cS(E);P||(this.checked=P,this.indeterminate=I)}};if(this.shouldLoadData()){this.loadData(()=>{S(),Dv(this)},{checked:t!==!1});return}else S()}const g=this.parent;!g||g.level===0||s||Dv(g)}getChildren(t=!1){if(this.level===0)return this.data;const i=this.data;if(!i)return null;const s=this.store.props;let d="children";return s&&(d=s.children||"children"),i[d]===void 0&&(i[d]=null),t&&!i[d]&&(i[d]=[]),i[d]}updateChildren(){const t=this.getChildren()||[],i=this.childNodes.map(g=>g.data),s={},d=[];t.forEach((g,_)=>{const o=g[pm];!!o&&i.findIndex(E=>E[pm]===o)>=0?s[o]={index:_,data:g}:d.push({index:_,data:g})}),this.store.lazy||i.forEach(g=>{s[g[pm]]||this.removeChildByData(g)}),d.forEach(({index:g,data:_})=>{this.insertChild({data:_},g)}),this.updateLeafState()}loadData(t,i={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(i).length)){this.loading=!0;const s=g=>{this.childNodes=[],this.doCreateChildren(g,i),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,g)},d=()=>{this.loading=!1};this.store.load(this,s,d)}else t&&t.call(this)}eachNode(t){const i=[this];for(;i.length;){const s=i.shift();i.unshift(...s.childNodes),t(s)}}reInitChecked(){this.store.checkStrictly||Dv(this)}};class pue{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const i in t)Tr(t,i)&&(this[i]=t[i]);this.nodesMap={}}initialize(){if(this.root=new uS({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,i=>{this.root.doCreateChildren(i),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const i=this.filterNodeMethod,s=this.lazy,d=function(g){const _=g.root?g.root.childNodes:g.childNodes;if(_.forEach(o=>{o.visible=i.call(o,t,o.data,o),d(o)}),!g.visible&&_.length){let o=!0;o=!_.some(S=>S.visible),g.root?g.root.visible=o===!1:g.visible=o===!1}t&&g.visible&&!g.isLeaf&&(!s||g.loaded)&&g.expand()};d(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof uS)return t;const i=Vo(t)?vC(this.key,t):t;return this.nodesMap[i]||null}insertBefore(t,i){const s=this.getNode(i);s.parent.insertBefore({data:t},s)}insertAfter(t,i){const s=this.getNode(i);s.parent.insertAfter({data:t},s)}remove(t){const i=this.getNode(t);i&&i.parent&&(i===this.currentNode&&(this.currentNode=null),i.parent.removeChild(i))}append(t,i){const s=Bf(i)?this.root:this.getNode(i);s&&s.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],i=this.nodesMap;t.forEach(s=>{const d=i[s];d&&d.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const i=this.key;!t||!t.data||(i?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(s=>{this.deregisterNode(s)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,i=!1){const s=[],d=function(g){(g.root?g.root.childNodes:g.childNodes).forEach(o=>{(o.checked||i&&o.indeterminate)&&(!t||t&&o.isLeaf)&&s.push(o.data),d(o)})};return d(this),s}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(i=>(i||{})[this.key])}getHalfCheckedNodes(){const t=[],i=function(s){(s.root?s.root.childNodes:s.childNodes).forEach(g=>{g.indeterminate&&t.push(g.data),i(g)})};return i(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],i=this.nodesMap;for(const s in i)Tr(i,s)&&t.push(i[s]);return t}updateChildren(t,i){const s=this.nodesMap[t];if(!s)return;const d=s.childNodes;for(let g=d.length-1;g>=0;g--){const _=d[g];this.remove(_.data)}for(let g=0,_=i.length;g<_;g++){const o=i[g];this.append(o,s.data)}}_setCheckedKeys(t,i=!1,s){const d=this._getAllNodes().sort((S,E)=>S.level-E.level),g=Object.create(null),_=Object.keys(s);d.forEach(S=>S.setChecked(!1,!1));const o=S=>{S.childNodes.forEach(E=>{var I;g[E.data[t]]=!0,(I=E.childNodes)!=null&&I.length&&o(E)})};for(let S=0,E=d.length;S<E;S++){const I=d[S],P=I.data[t].toString();if(!_.includes(P)){I.checked&&!g[P]&&I.setChecked(!1,!1);continue}if(I.childNodes.length&&o(I),I.isLeaf||this.checkStrictly){I.setChecked(!0,!1);continue}if(I.setChecked(!0,!0),i){I.setChecked(!1,!1);const B=function($){$.childNodes.forEach(H=>{H.isLeaf||H.setChecked(!1,!1),B(H)})};B(I)}}}setCheckedNodes(t,i=!1){const s=this.key,d={};t.forEach(g=>{d[(g||{})[s]]=!0}),this._setCheckedKeys(s,i,d)}setCheckedKeys(t,i=!1){this.defaultCheckedKeys=t;const s=this.key,d={};t.forEach(g=>{d[g]=!0}),this._setCheckedKeys(s,i,d)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(i=>{const s=this.getNode(i);s&&s.expand(null,this.autoExpandParent)})}setChecked(t,i,s){const d=this.getNode(t);d&&d.setChecked(!!i,s)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const i=this.currentNode;i&&(i.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,i=!0){const s=t[this.key],d=this.nodesMap[s];this.setCurrentNode(d),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,i=!0){if(this.currentNodeKey=t,t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const s=this.getNode(t);s&&(this.setCurrentNode(s),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const mue=Ze({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=rn("tree"),i=Un("NodeInstance"),s=Un("RootTree");return()=>{const d=e.node,{data:g,store:_}=d;return e.renderContent?e.renderContent(lo,{_self:i,node:d,data:g,store:_}):_t(s.ctx.slots,"default",{node:d,data:g},()=>[lo("span",{class:t.be("node","label")},[d.label])])}}});var gue=bn(mue,[["__file","tree-node-content.vue"]]);function S4(e){const t=Un("TreeNodeMap",null),i={treeNodeExpand:s=>{e.node!==s&&e.node.collapse()},children:[]};return t&&t.children.push(i),or("TreeNodeMap",i),{broadcastExpanded:s=>{if(e.accordion)for(const d of i.children)d.treeNodeExpand(s)}}}const T4=Symbol("dragEvents");function vue({props:e,ctx:t,el$:i,dropIndicator$:s,store:d}){const g=rn("tree"),_=Se({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return or(T4,{treeNodeDragStart:({event:I,treeNode:P})=>{if(Qn(e.allowDrag)&&!e.allowDrag(P.node))return I.preventDefault(),!1;I.dataTransfer.effectAllowed="move";try{I.dataTransfer.setData("text/plain","")}catch{}_.value.draggingNode=P,t.emit("node-drag-start",P.node,I)},treeNodeDragOver:({event:I,treeNode:P})=>{const F=P,B=_.value.dropNode;B&&B.node.id!==F.node.id&&fs(B.$el,g.is("drop-inner"));const $=_.value.draggingNode;if(!$||!F)return;let z=!0,H=!0,U=!0,ie=!0;Qn(e.allowDrop)&&(z=e.allowDrop($.node,F.node,"prev"),ie=H=e.allowDrop($.node,F.node,"inner"),U=e.allowDrop($.node,F.node,"next")),I.dataTransfer.dropEffect=H||z||U?"move":"none",(z||H||U)&&(B==null?void 0:B.node.id)!==F.node.id&&(B&&t.emit("node-drag-leave",$.node,B.node,I),t.emit("node-drag-enter",$.node,F.node,I)),z||H||U?_.value.dropNode=F:_.value.dropNode=null,F.node.nextSibling===$.node&&(U=!1),F.node.previousSibling===$.node&&(z=!1),F.node.contains($.node,!1)&&(H=!1),($.node===F.node||$.node.contains(F.node))&&(z=!1,H=!1,U=!1);const Z=F.$el.querySelector(`.${g.be("node","content")}`).getBoundingClientRect(),G=i.value.getBoundingClientRect();let Q;const oe=z?H?.25:U?.45:1:-1,le=U?H?.75:z?.55:0:1;let me=-9999;const fe=I.clientY-Z.top;fe<Z.height*oe?Q="before":fe>Z.height*le?Q="after":H?Q="inner":Q="none";const ce=F.$el.querySelector(`.${g.be("node","expand-icon")}`).getBoundingClientRect(),pe=s.value;Q==="before"?me=ce.top-G.top:Q==="after"&&(me=ce.bottom-G.top),pe.style.top=`${me}px`,pe.style.left=`${ce.right-G.left}px`,Q==="inner"?Yl(F.$el,g.is("drop-inner")):fs(F.$el,g.is("drop-inner")),_.value.showDropIndicator=Q==="before"||Q==="after",_.value.allowDrop=_.value.showDropIndicator||ie,_.value.dropType=Q,t.emit("node-drag-over",$.node,F.node,I)},treeNodeDragEnd:I=>{const{draggingNode:P,dropType:F,dropNode:B}=_.value;if(I.preventDefault(),I.dataTransfer&&(I.dataTransfer.dropEffect="move"),P&&B){const $={data:P.node.data};F!=="none"&&P.node.remove(),F==="before"?B.node.parent.insertBefore($,B.node):F==="after"?B.node.parent.insertAfter($,B.node):F==="inner"&&B.node.insertChild($),F!=="none"&&(d.value.registerNode($),d.value.key&&P.node.eachNode(z=>{var H;(H=d.value.nodesMap[z.data[d.value.key]])==null||H.setChecked(z.checked,!d.value.checkStrictly)})),fs(B.$el,g.is("drop-inner")),t.emit("node-drag-end",P.node,B.node,F,I),F!=="none"&&t.emit("node-drop",P.node,B.node,F,I)}P&&!B&&t.emit("node-drag-end",P.node,null,F,I),_.value.showDropIndicator=!1,_.value.draggingNode=null,_.value.dropNode=null,_.value.allowDrop=!0}}),{dragState:_}}const _ue=Ze({name:"ElTreeNode",components:{ElCollapseTransition:m1,ElCheckbox:rc,NodeContent:gue,ElIcon:Gn,Loading:Cu},props:{node:{type:uS,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const i=rn("tree"),{broadcastExpanded:s}=S4(e),d=Un("RootTree"),g=Se(!1),_=Se(!1),o=Se(null),S=Se(null),E=Se(null),I=Un(T4),P=jo();or("NodeInstance",P),e.node.expanded&&(g.value=!0,_.value=!0);const F=d.props.props.children||"children";tn(()=>{const fe=e.node.data[F];return fe&&[...fe]},()=>{e.node.updateChildren()}),tn(()=>e.node.indeterminate,fe=>{z(e.node.checked,fe)}),tn(()=>e.node.checked,fe=>{z(fe,e.node.indeterminate)}),tn(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),tn(()=>e.node.expanded,fe=>{oo(()=>g.value=fe),fe&&(_.value=!0)});const B=fe=>vC(d.props.nodeKey,fe.data),$=fe=>{const ce=e.props.class;if(!ce)return{};let pe;if(Qn(ce)){const{data:ye}=fe;pe=ce(ye,fe)}else pe=ce;return Zn(pe)?{[pe]:!0}:pe},z=(fe,ce)=>{(o.value!==fe||S.value!==ce)&&d.ctx.emit("check-change",e.node.data,fe,ce),o.value=fe,S.value=ce},H=fe=>{lS(d.store,d.ctx.emit,()=>{var ce;if((ce=d==null?void 0:d.props)==null?void 0:ce.nodeKey){const ye=B(e.node);d.store.value.setCurrentNodeKey(ye)}else d.store.value.setCurrentNode(e.node)}),d.currentNode.value=e.node,d.props.expandOnClickNode&&ie(),d.props.checkOnClickNode&&!e.node.disabled&&Z(null,{target:{checked:!e.node.checked}}),d.ctx.emit("node-click",e.node.data,e.node,P,fe)},U=fe=>{d.instance.vnode.props.onNodeContextmenu&&(fe.stopPropagation(),fe.preventDefault()),d.ctx.emit("node-contextmenu",fe,e.node.data,e.node,P)},ie=()=>{e.node.isLeaf||(g.value?(d.ctx.emit("node-collapse",e.node.data,e.node,P),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,P)}))},Z=(fe,ce)=>{e.node.setChecked(ce.target.checked,!d.props.checkStrictly),oo(()=>{const pe=d.store.value;d.ctx.emit("check",e.node.data,{checkedNodes:pe.getCheckedNodes(),checkedKeys:pe.getCheckedKeys(),halfCheckedNodes:pe.getHalfCheckedNodes(),halfCheckedKeys:pe.getHalfCheckedKeys()})})};return{ns:i,node$:E,tree:d,expanded:g,childNodeRendered:_,oldChecked:o,oldIndeterminate:S,getNodeKey:B,getNodeClass:$,handleSelectChange:z,handleClick:H,handleContextMenu:U,handleExpandIconClick:ie,handleCheckChange:Z,handleChildNodeExpand:(fe,ce,pe)=>{s(ce),d.ctx.emit("node-expand",fe,ce,pe)},handleDragStart:fe=>{d.props.draggable&&I.treeNodeDragStart({event:fe,treeNode:e})},handleDragOver:fe=>{fe.preventDefault(),d.props.draggable&&I.treeNodeDragOver({event:fe,treeNode:{$el:E.value,node:e.node}})},handleDrop:fe=>{fe.preventDefault()},handleDragEnd:fe=>{d.props.draggable&&I.treeNodeDragEnd(fe)},CaretRight:XO}}});function yue(e,t,i,s,d,g){const _=Go("el-icon"),o=Go("el-checkbox"),S=Go("loading"),E=Go("node-content"),I=Go("el-tree-node"),P=Go("el-collapse-transition");return zo((se(),Pe("div",{ref:"node$",class:de([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:po(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:po(e.handleDragStart,["stop"]),onDragover:po(e.handleDragOver,["stop"]),onDragend:po(e.handleDragEnd,["stop"]),onDrop:po(e.handleDrop,["stop"])},[He("div",{class:de(e.ns.be("node","content")),style:to({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(se(),Rt(_,{key:0,class:de([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:po(e.handleExpandIconClick,["stop"])},{default:at(()=>[(se(),Rt(Wo(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):St("v-if",!0),e.showCheckbox?(se(),Rt(o,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:po(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):St("v-if",!0),e.node.loading?(se(),Rt(_,{key:2,class:de([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:at(()=>[Qe(S)]),_:1},8,["class"])):St("v-if",!0),Qe(E,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Qe(P,null,{default:at(()=>[!e.renderAfterExpand||e.childNodeRendered?zo((se(),Pe("div",{key:0,class:de(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(se(!0),Pe(eo,null,tr(e.node.childNodes,F=>(se(),Rt(I,{key:e.getNodeKey(F),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:F,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[Cr,e.expanded]]):St("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[Cr,e.node.visible]])}var bue=bn(_ue,[["render",yue],["__file","tree-node.vue"]]);function xue({el$:e},t){const i=rn("tree"),s=gi([]),d=gi([]);No(()=>{_()}),Au(()=>{s.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),tn(d,o=>{o.forEach(S=>{S.setAttribute("tabindex","-1")})}),qr(e,"keydown",o=>{const S=o.target;if(!S.className.includes(i.b("node")))return;const E=o.code;s.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`));const I=s.value.indexOf(S);let P;if([On.up,On.down].includes(E)){if(o.preventDefault(),E===On.up){P=I===-1?0:I!==0?I-1:s.value.length-1;const B=P;for(;!t.value.getNode(s.value[P].dataset.key).canFocus;){if(P--,P===B){P=-1;break}P<0&&(P=s.value.length-1)}}else{P=I===-1?0:I<s.value.length-1?I+1:0;const B=P;for(;!t.value.getNode(s.value[P].dataset.key).canFocus;){if(P++,P===B){P=-1;break}P>=s.value.length&&(P=0)}}P!==-1&&s.value[P].focus()}[On.left,On.right].includes(E)&&(o.preventDefault(),S.click());const F=S.querySelector('[type="checkbox"]');[On.enter,On.numpadEnter,On.space].includes(E)&&F&&(o.preventDefault(),F.click())});const _=()=>{var o;s.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`)),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const S=e.value.querySelectorAll(`.${i.is("checked")}[role=treeitem]`);if(S.length){S[0].setAttribute("tabindex","0");return}(o=s.value[0])==null||o.setAttribute("tabindex","0")}}const wue=Ze({name:"ElTree",components:{ElTreeNode:bue},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Xr}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:i}=vr(),s=rn("tree"),d=Un(Wm,null),g=Se(new pue({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));g.value.initialize();const _=Se(g.value.root),o=Se(null),S=Se(null),E=Se(null),{broadcastExpanded:I}=S4(e),{dragState:P}=vue({props:e,ctx:t,el$:S,dropIndicator$:E,store:g});xue({el$:S},g);const F=te(()=>{const{childNodes:Ce}=_.value,ge=d?d.hasFilteredOptions!==0:!1;return(!Ce||Ce.length===0||Ce.every(({visible:Ne})=>!Ne))&&!ge});tn(()=>e.currentNodeKey,Ce=>{g.value.setCurrentNodeKey(Ce)}),tn(()=>e.defaultCheckedKeys,Ce=>{g.value.setDefaultCheckedKey(Ce)}),tn(()=>e.defaultExpandedKeys,Ce=>{g.value.setDefaultExpandedKeys(Ce)}),tn(()=>e.data,Ce=>{g.value.setData(Ce)},{deep:!0}),tn(()=>e.checkStrictly,Ce=>{g.value.checkStrictly=Ce});const B=Ce=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");g.value.filter(Ce)},$=Ce=>vC(e.nodeKey,Ce.data),z=Ce=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const ge=g.value.getNode(Ce);if(!ge)return[];const Ne=[ge.data];let We=ge.parent;for(;We&&We!==_.value;)Ne.push(We.data),We=We.parent;return Ne.reverse()},H=(Ce,ge)=>g.value.getCheckedNodes(Ce,ge),U=Ce=>g.value.getCheckedKeys(Ce),ie=()=>{const Ce=g.value.getCurrentNode();return Ce?Ce.data:null},Z=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const Ce=ie();return Ce?Ce[e.nodeKey]:null},G=(Ce,ge)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");g.value.setCheckedNodes(Ce,ge)},Q=(Ce,ge)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");g.value.setCheckedKeys(Ce,ge)},oe=(Ce,ge,Ne)=>{g.value.setChecked(Ce,ge,Ne)},le=()=>g.value.getHalfCheckedNodes(),me=()=>g.value.getHalfCheckedKeys(),fe=(Ce,ge=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");lS(g,t.emit,()=>{I(Ce),g.value.setUserCurrentNode(Ce,ge)})},ce=(Ce,ge=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");lS(g,t.emit,()=>{I(),g.value.setCurrentNodeKey(Ce,ge)})},pe=Ce=>g.value.getNode(Ce),ye=Ce=>{g.value.remove(Ce)},De=(Ce,ge)=>{g.value.append(Ce,ge)},tt=(Ce,ge)=>{g.value.insertBefore(Ce,ge)},Me=(Ce,ge)=>{g.value.insertAfter(Ce,ge)},xe=(Ce,ge,Ne)=>{I(ge),t.emit("node-expand",Ce,ge,Ne)},Ae=(Ce,ge)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");g.value.updateChildren(Ce,ge)};return or("RootTree",{ctx:t,props:e,store:g,root:_,currentNode:o,instance:jo()}),or(Eu,void 0),{ns:s,store:g,root:_,currentNode:o,dragState:P,el$:S,dropIndicator$:E,isEmpty:F,filter:B,getNodeKey:$,getNodePath:z,getCheckedNodes:H,getCheckedKeys:U,getCurrentNode:ie,getCurrentKey:Z,setCheckedNodes:G,setCheckedKeys:Q,setChecked:oe,getHalfCheckedNodes:le,getHalfCheckedKeys:me,setCurrentNode:fe,setCurrentKey:ce,t:i,getNode:pe,remove:ye,append:De,insertBefore:tt,insertAfter:Me,handleNodeExpand:xe,updateKeyChildren:Ae}}});function Sue(e,t,i,s,d,g){const _=Go("el-tree-node");return se(),Pe("div",{ref:"el$",class:de([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(se(!0),Pe(eo,null,tr(e.root.childNodes,o=>(se(),Rt(_,{key:e.getNodeKey(o),node:o,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(se(),Pe("div",{key:0,class:de(e.ns.e("empty-block"))},[_t(e.$slots,"empty",{},()=>{var o;return[He("span",{class:de(e.ns.e("empty-text"))},wn((o=e.emptyText)!=null?o:e.t("el.tree.emptyText")),3)]})],2)):St("v-if",!0),zo(He("div",{ref:"dropIndicator$",class:de(e.ns.e("drop-indicator"))},null,2),[[Cr,e.dragState.showDropIndicator]])],2)}var Tue=bn(wue,[["render",Sue],["__file","tree.vue"]]);const zb=Ao(Tue),Cue=(e,{attrs:t,emit:i},{select:s,tree:d,key:g})=>{const _=rn("tree-select");return tn(()=>e.data,()=>{e.filterable&&oo(()=>{var S,E;(E=d.value)==null||E.filter((S=s.value)==null?void 0:S.states.inputValue)})},{flush:"post"}),{...Uc(Ca(e),Object.keys(Vf.props)),...t,"onUpdate:modelValue":S=>i(Fo,S),valueKey:g,popperClass:te(()=>{const S=[_.e("popper")];return e.popperClass&&S.push(e.popperClass),S.join(" ")}),filterMethod:(S="")=>{var E;e.filterMethod?e.filterMethod(S):e.remoteMethod?e.remoteMethod(S):(E=d.value)==null||E.filter(S)}}},Eue=Ze({extends:Tb,setup(e,t){const i=Tb.setup(e,t);delete i.selectOptionClick;const s=jo().proxy;return oo(()=>{i.select.states.cachedOptions.get(s.value)||i.select.onOptionCreate(s)}),tn(()=>t.attrs.visible,d=>{i.states.visible=d},{immediate:!0}),i},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function dS(e){return e||e===0}function _C(e){return fn(e)&&e.length}function Kp(e){return fn(e)?e:dS(e)?[e]:[]}function ob(e,t,i,s,d){for(let g=0;g<e.length;g++){const _=e[g];if(t(_,g,e,d))return s?s(_,g,e,d):_;{const o=i(_);if(_C(o)){const S=ob(o,t,i,s,_);if(S)return S}}}}function rb(e,t,i,s){for(let d=0;d<e.length;d++){const g=e[d];t(g,d,e,s);const _=i(g);_C(_)&&rb(_,t,i,g)}}const Mue=(e,{attrs:t,slots:i,emit:s},{select:d,tree:g,key:_})=>{tn(()=>e.modelValue,()=>{e.showCheckbox&&oo(()=>{const F=g.value;F&&!Oa(F.getCheckedKeys(),Kp(e.modelValue))&&F.setCheckedKeys(Kp(e.modelValue))})},{immediate:!0,deep:!0});const o=te(()=>({value:_.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),S=(F,B)=>{var $;const z=o.value[F];return Qn(z)?z(B,($=g.value)==null?void 0:$.getNode(S("value",B))):B[z]},E=Kp(e.modelValue).map(F=>ob(e.data||[],B=>S("value",B)===F,B=>S("children",B),(B,$,z,H)=>H&&S("value",H))).filter(F=>dS(F)),I=te(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const F=[];return rb(e.data.concat(e.cacheData),B=>{const $=S("value",B);F.push({value:$,currentLabel:S("label",B),isDisabled:S("disabled",B)})},B=>S("children",B)),F}),P=()=>{var F;return(F=g.value)==null?void 0:F.getCheckedKeys().filter(B=>{var $;const z=($=g.value)==null?void 0:$.getNode(B);return!ga(z)&&yl(z.childNodes)})};return{...Uc(Ca(e),Object.keys(zb.props)),...t,nodeKey:_,expandOnClickNode:te(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:te(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(E):E),renderContent:(F,{node:B,data:$,store:z})=>F(Eue,{value:S("value",$),label:S("label",$),disabled:S("disabled",$),visible:B.visible},e.renderContent?()=>e.renderContent(F,{node:B,data:$,store:z}):i.default?()=>i.default({node:B,data:$,store:z}):void 0),filterNodeMethod:(F,B,$)=>e.filterNodeMethod?e.filterNodeMethod(F,B,$):F?new RegExp(IT(F),"i").test(S("label",B)||""):!0,onNodeClick:(F,B,$)=>{var z,H,U,ie;if((z=t.onNodeClick)==null||z.call(t,F,B,$),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||B.isLeaf)){if(!S("disabled",F)){const Z=(H=d.value)==null?void 0:H.states.options.get(S("value",F));(U=d.value)==null||U.handleOptionSelect(Z)}}else e.expandOnClickNode&&$.proxy.handleExpandIconClick();(ie=d.value)==null||ie.focus()}},onCheck:(F,B)=>{var $;if(!e.showCheckbox)return;const z=S("value",F),H={};rb([g.value.store.root],G=>H[G.key]=G,G=>G.childNodes);const U=B.checkedKeys,ie=e.multiple?Kp(e.modelValue).filter(G=>!(G in H)&&!U.includes(G)):[],Z=ie.concat(U);if(e.checkStrictly)s(Fo,e.multiple?Z:Z.includes(z)?z:void 0);else if(e.multiple){const G=P();s(Fo,ie.concat(G))}else{const G=ob([F],le=>!_C(S("children",le))&&!S("disabled",le),le=>S("children",le)),Q=G?S("value",G):void 0,oe=dS(e.modelValue)&&!!ob([F],le=>S("value",le)===e.modelValue,le=>S("children",le));s(Fo,Q===e.modelValue||oe?void 0:Q)}oo(()=>{var G;const Q=Kp(e.modelValue);g.value.setCheckedKeys(Q),(G=t.onCheck)==null||G.call(t,F,{checkedKeys:g.value.getCheckedKeys(),checkedNodes:g.value.getCheckedNodes(),halfCheckedKeys:g.value.getHalfCheckedKeys(),halfCheckedNodes:g.value.getHalfCheckedNodes()})}),($=d.value)==null||$.focus()},onNodeExpand:(F,B,$)=>{var z;(z=t.onNodeExpand)==null||z.call(t,F,B,$),oo(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&B.checked){const H={},U=g.value.getCheckedKeys();rb([g.value.store.root],G=>H[G.key]=G,G=>G.childNodes);const ie=Kp(e.modelValue).filter(G=>!(G in H)&&!U.includes(G)),Z=P();s(Fo,ie.concat(Z))}})},cacheOptions:I}};var Iue=Ze({props:{data:{type:Array,default:()=>[]}},setup(e){const t=Un(Wm);return tn(()=>e.data,()=>{var i;e.data.forEach(d=>{t.states.cachedOptions.has(d.value)||t.states.cachedOptions.set(d.value,d)});const s=((i=t.selectRef)==null?void 0:i.querySelectorAll("input"))||[];gr&&!Array.from(s).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Aue=Ze({name:"ElTreeSelect",inheritAttrs:!1,props:{...Vf.props,...zb.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:i,expose:s}=t,d=Se(),g=Se(),_=te(()=>e.nodeKey||e.valueKey||"value"),o=Cue(e,t,{select:d,tree:g,key:_}),{cacheOptions:S,...E}=Mue(e,t,{select:d,tree:g,key:_}),I=Pr({});return s(I),No(()=>{Object.assign(I,{...Uc(g.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...Uc(d.value,["focus","blur","selectedLabel"])})}),()=>lo(Vf,Pr({...o,ref:P=>d.value=P}),{...i,default:()=>[lo(Iue,{data:S.value}),lo(zb,Pr({...E,ref:P=>g.value=P}))]})}});var kue=bn(Aue,[["__file","tree-select.vue"]]);const Pue=Ao(kue),yC=Symbol(),Rue={key:-1,level:-1,data:{}};var zv=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e.CLASS="",e))(zv||{}),hS=(e=>(e.ADD="add",e.DELETE="delete",e))(hS||{});const C4={type:Number,default:26},Oue=vn({data:{type:ut(Array),default:()=>Ri([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:ut(Object),default:()=>Ri({children:"children",label:"label",disabled:"disabled",value:"id",class:""})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:ut(Array),default:()=>Ri([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:ut(Array),default:()=>Ri([])},indent:{type:Number,default:16},itemSize:C4,icon:{type:Xr},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:ut([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:ut(Function)},perfMode:{type:Boolean,default:!0}}),Lue=vn({node:{type:ut(Object),default:()=>Ri(Rue)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:C4}),Due=vn({node:{type:ut(Object),required:!0}}),E4="node-click",M4="node-drop",I4="node-expand",A4="node-collapse",k4="current-change",P4="check",R4="check-change",O4="node-contextmenu",zue={[E4]:(e,t,i)=>e&&t&&i,[M4]:(e,t,i)=>e&&t&&i,[I4]:(e,t)=>e&&t,[A4]:(e,t)=>e&&t,[k4]:(e,t)=>e&&t,[P4]:(e,t)=>e&&t,[R4]:(e,t)=>e&&ai(t),[O4]:(e,t,i)=>e&&t&&i},Fue={click:(e,t)=>!!(e&&t),drop:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&ai(t)};function Bue(e,t){const i=Se(new Set),s=Se(new Set),{emit:d}=jo();tn([()=>t.value,()=>e.defaultCheckedKeys],()=>oo(()=>{ie(e.defaultCheckedKeys)}),{immediate:!0});const g=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:Z,maxLevel:G}=t.value,Q=i.value,oe=new Set;for(let le=G-1;le>=1;--le){const me=Z.get(le);me&&me.forEach(fe=>{const ce=fe.children;if(ce){let pe=!0,ye=!1;for(const De of ce){const tt=De.key;if(Q.has(tt))ye=!0;else if(oe.has(tt)){pe=!1,ye=!0;break}else pe=!1}pe?Q.add(fe.key):ye?(oe.add(fe.key),Q.delete(fe.key)):(Q.delete(fe.key),oe.delete(fe.key))}})}s.value=oe},_=Z=>i.value.has(Z.key),o=Z=>s.value.has(Z.key),S=(Z,G,Q=!0)=>{const oe=i.value,le=(me,fe)=>{oe[fe?hS.ADD:hS.DELETE](me.key);const ce=me.children;!e.checkStrictly&&ce&&ce.forEach(pe=>{pe.disabled||le(pe,fe)})};le(Z,G),g(),Q&&E(Z,G)},E=(Z,G)=>{const{checkedNodes:Q,checkedKeys:oe}=$(),{halfCheckedNodes:le,halfCheckedKeys:me}=z();d(P4,Z.data,{checkedKeys:oe,checkedNodes:Q,halfCheckedKeys:me,halfCheckedNodes:le}),d(R4,Z.data,G)};function I(Z=!1){return $(Z).checkedKeys}function P(Z=!1){return $(Z).checkedNodes}function F(){return z().halfCheckedKeys}function B(){return z().halfCheckedNodes}function $(Z=!1){const G=[],Q=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:oe}=t.value;i.value.forEach(le=>{const me=oe.get(le);me&&(!Z||Z&&me.isLeaf)&&(Q.push(le),G.push(me.data))})}return{checkedKeys:Q,checkedNodes:G}}function z(){const Z=[],G=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:Q}=t.value;s.value.forEach(oe=>{const le=Q.get(oe);le&&(G.push(oe),Z.push(le.data))})}return{halfCheckedNodes:Z,halfCheckedKeys:G}}function H(Z){i.value.clear(),s.value.clear(),oo(()=>{ie(Z)})}function U(Z,G){if(t!=null&&t.value&&e.showCheckbox){const Q=t.value.treeNodeMap.get(Z);Q&&S(Q,G,!1)}}function ie(Z){if(t!=null&&t.value){const{treeNodeMap:G}=t.value;if(e.showCheckbox&&G&&Z)for(const Q of Z){const oe=G.get(Q);oe&&!_(oe)&&S(oe,!0,!1)}}}return{updateCheckedKeys:g,toggleCheckbox:S,isChecked:_,isIndeterminate:o,getCheckedKeys:I,getCheckedNodes:P,getHalfCheckedKeys:F,getHalfCheckedNodes:B,setChecked:U,setCheckedKeys:H}}function Nue(e,t){const i=Se(new Set([])),s=Se(new Set([])),d=te(()=>Qn(e.filterMethod));function g(o){var S;if(!d.value)return;const E=new Set,I=s.value,P=i.value,F=[],B=((S=t.value)==null?void 0:S.treeNodes)||[],$=e.filterMethod;P.clear();function z(H){H.forEach(U=>{F.push(U),$!=null&&$(o,U.data)?F.forEach(Z=>{E.add(Z.key)}):U.isLeaf&&P.add(U.key);const ie=U.children;if(ie&&z(ie),!U.isLeaf){if(!E.has(U.key))P.add(U.key);else if(ie){let Z=!0;for(const G of ie)if(!P.has(G.key)){Z=!1;break}Z?I.add(U.key):I.delete(U.key)}}F.pop()})}return z(B),E}function _(o){return s.value.has(o.key)}return{hiddenExpandIconKeySet:s,hiddenNodeKeySet:i,doFilter:g,isForceHiddenExpandIcon:_}}function $ue(e,t){const i=Se(new Set(e.defaultExpandedKeys)),s=Se(),d=gi(),g=Se();tn(()=>e.currentNodeKey,At=>{s.value=At},{immediate:!0}),tn(()=>e.data,At=>{Kt(At)},{immediate:!0});const{isIndeterminate:_,isChecked:o,toggleCheckbox:S,getCheckedKeys:E,getCheckedNodes:I,getHalfCheckedKeys:P,getHalfCheckedNodes:F,setChecked:B,setCheckedKeys:$}=Bue(e,d),{doFilter:z,hiddenNodeKeySet:H,isForceHiddenExpandIcon:U}=Nue(e,d),ie=te(()=>{var At;return((At=e.props)==null?void 0:At.value)||zv.KEY}),Z=te(()=>{var At;return((At=e.props)==null?void 0:At.children)||zv.CHILDREN}),G=te(()=>{var At;return((At=e.props)==null?void 0:At.disabled)||zv.DISABLED}),Q=te(()=>{var At;return((At=e.props)==null?void 0:At.label)||zv.LABEL}),oe=te(()=>{var At;const Ke=i.value,Be=H.value,Ht=[],Ut=((At=d.value)==null?void 0:At.treeNodes)||[],Nt=[];for(let Et=Ut.length-1;Et>=0;--Et)Nt.push(Ut[Et]);for(;Nt.length;){const Et=Nt.pop();if(!Be.has(Et.key)&&(Ht.push(Et),Et.children&&Ke.has(Et.key)))for(let Gt=Et.children.length-1;Gt>=0;--Gt)Nt.push(Et.children[Gt])}return Ht}),le=te(()=>oe.value.length>0);function me(At){const Ke=new Map,Be=new Map;let Ht=1;function Ut(Et,Gt=1,ln=void 0){var yn;const _n=[];for(const jn of Et){const yt=pe(jn),kn={level:Gt,key:yt,data:jn};kn.label=De(jn),kn.parent=ln;const qn=ce(jn);kn.disabled=ye(jn),kn.isLeaf=!qn||qn.length===0,qn&&qn.length&&(kn.children=Ut(qn,Gt+1,kn)),_n.push(kn),Ke.set(yt,kn),Be.has(Gt)||Be.set(Gt,[]),(yn=Be.get(Gt))==null||yn.push(kn)}return Gt>Ht&&(Ht=Gt),_n}const Nt=Ut(At);return{treeNodeMap:Ke,levelTreeNodeMap:Be,maxLevel:Ht,treeNodes:Nt}}function fe(At){const Ke=z(At);Ke&&(i.value=Ke)}function ce(At){return At[Z.value]}function pe(At){return At?At[ie.value]:""}function ye(At){return At[G.value]}function De(At){return At[Q.value]}function tt(At){i.value.has(At.key)?We(At):Ne(At)}function Me(At){const Ke=new Set,Be=d.value.treeNodeMap;At.forEach(Ht=>{let Ut=Be.get(Ht);for(;Ut&&!Ke.has(Ut.key);)Ke.add(Ut.key),Ut=Ut.parent}),i.value=Ke}function xe(At,Ke){t(E4,At.data,At,Ke),Ce(At),e.expandOnClickNode&&tt(At),e.showCheckbox&&e.checkOnClickNode&&!At.disabled&&S(At,!o(At),!0)}function Ae(At,Ke){t(M4,At.data,At,Ke)}function Ce(At){Ct(At)||(s.value=At.key,t(k4,At.data,At))}function ge(At,Ke){S(At,Ke)}function Ne(At){const Ke=i.value;if(d.value&&e.accordion){const{treeNodeMap:Be}=d.value;Ke.forEach(Ht=>{const Ut=Be.get(Ht);At&&At.level===(Ut==null?void 0:Ut.level)&&Ke.delete(Ht)})}Ke.add(At.key),t(I4,At.data,At)}function We(At){i.value.delete(At.key),t(A4,At.data,At)}function ot(At){return i.value.has(At.key)}function Oe(At){return!!At.disabled}function Ct(At){const Ke=s.value;return Ke!==void 0&&Ke===At.key}function Mt(){var At,Ke;if(s.value)return(Ke=(At=d.value)==null?void 0:At.treeNodeMap.get(s.value))==null?void 0:Ke.data}function zt(){return s.value}function bt(At){s.value=At}function Kt(At){oo(()=>d.value=me(At))}function $t(At){var Ke;const Be=Vo(At)?pe(At):At;return(Ke=d.value)==null?void 0:Ke.treeNodeMap.get(Be)}function Re(At,Ke="auto"){const Be=$t(At);Be&&g.value&&g.value.scrollToItem(oe.value.indexOf(Be),Ke)}function dn(At){var Ke;(Ke=g.value)==null||Ke.scrollTo(At)}return{tree:d,flattenTree:oe,isNotEmpty:le,listRef:g,getKey:pe,getChildren:ce,toggleExpand:tt,toggleCheckbox:S,isExpanded:ot,isChecked:o,isIndeterminate:_,isDisabled:Oe,isCurrent:Ct,isForceHiddenExpandIcon:U,handleNodeClick:xe,handleNodeDrop:Ae,handleNodeCheck:ge,getCurrentNode:Mt,getCurrentKey:zt,setCurrentKey:bt,getCheckedKeys:E,getCheckedNodes:I,getHalfCheckedKeys:P,getHalfCheckedNodes:F,setChecked:B,setCheckedKeys:$,filter:fe,setData:Kt,getNode:$t,expandNode:Ne,collapseNode:We,setExpandedKeys:Me,scrollToNode:Re,scrollTo:dn}}var Vue=Ze({name:"ElTreeNodeContent",props:Due,setup(e){const t=Un(yC),i=rn("tree");return()=>{const s=e.node,{data:d}=s;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:s,data:d}):lo("span",{class:i.be("node","label")},[s==null?void 0:s.label])}}});const Uue=Ze({name:"ElTreeNode"}),jue=Ze({...Uue,props:Lue,emits:Fue,setup(e,{emit:t}){const i=e,s=Un(yC),d=rn("tree"),g=te(()=>{var B;return(B=s==null?void 0:s.props.indent)!=null?B:16}),_=te(()=>{var B;return(B=s==null?void 0:s.props.icon)!=null?B:XO}),o=B=>{const $=s==null?void 0:s.props.props.class;if(!$)return{};let z;if(Qn($)){const{data:H}=B;z=$(H,B)}else z=$;return Zn(z)?{[z]:!0}:z},S=B=>{t("click",i.node,B)},E=B=>{t("drop",i.node,B)},I=()=>{t("toggle",i.node)},P=B=>{t("check",i.node,B)},F=B=>{var $,z,H,U;(H=(z=($=s==null?void 0:s.instance)==null?void 0:$.vnode)==null?void 0:z.props)!=null&&H.onNodeContextmenu&&(B.stopPropagation(),B.preventDefault()),s==null||s.ctx.emit(O4,B,(U=i.node)==null?void 0:U.data,i.node)};return(B,$)=>{var z,H,U;return se(),Pe("div",{ref:"node$",class:de([y(d).b("node"),y(d).is("expanded",B.expanded),y(d).is("current",B.current),y(d).is("focusable",!B.disabled),y(d).is("checked",!B.disabled&&B.checked),o(B.node)]),role:"treeitem",tabindex:"-1","aria-expanded":B.expanded,"aria-disabled":B.disabled,"aria-checked":B.checked,"data-key":(z=B.node)==null?void 0:z.key,onClick:po(S,["stop"]),onContextmenu:F,onDragover:po(()=>{},["prevent"]),onDragenter:po(()=>{},["prevent"]),onDrop:po(E,["stop"])},[He("div",{class:de(y(d).be("node","content")),style:to({paddingLeft:`${(B.node.level-1)*y(g)}px`,height:B.itemSize+"px"})},[y(_)?(se(),Rt(y(Gn),{key:0,class:de([y(d).is("leaf",!!((H=B.node)!=null&&H.isLeaf)),y(d).is("hidden",B.hiddenExpandIcon),{expanded:!((U=B.node)!=null&&U.isLeaf)&&B.expanded},y(d).be("node","expand-icon")]),onClick:po(I,["stop"])},{default:at(()=>[(se(),Rt(Wo(y(_))))]),_:1},8,["class","onClick"])):St("v-if",!0),B.showCheckbox?(se(),Rt(y(rc),{key:1,"model-value":B.checked,indeterminate:B.indeterminate,disabled:B.disabled,onChange:P,onClick:po(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):St("v-if",!0),Qe(y(Vue),{node:B.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var Hue=bn(jue,[["__file","tree-node.vue"]]);const Gue=Ze({name:"ElTreeV2"}),Wue=Ze({...Gue,props:Oue,emits:zue,setup(e,{expose:t,emit:i}){const s=e,d=aa(),g=te(()=>s.itemSize);or(yC,{ctx:{emit:i,slots:d},props:s,instance:jo()}),or(Eu,void 0);const{t:_}=vr(),o=rn("tree"),{flattenTree:S,isNotEmpty:E,listRef:I,toggleExpand:P,isExpanded:F,isIndeterminate:B,isChecked:$,isDisabled:z,isCurrent:H,isForceHiddenExpandIcon:U,handleNodeClick:ie,handleNodeDrop:Z,handleNodeCheck:G,toggleCheckbox:Q,getCurrentNode:oe,getCurrentKey:le,setCurrentKey:me,getCheckedKeys:fe,getCheckedNodes:ce,getHalfCheckedKeys:pe,getHalfCheckedNodes:ye,setChecked:De,setCheckedKeys:tt,filter:Me,setData:xe,getNode:Ae,expandNode:Ce,collapseNode:ge,setExpandedKeys:Ne,scrollToNode:We,scrollTo:ot}=$ue(s,i);return t({toggleCheckbox:Q,getCurrentNode:oe,getCurrentKey:le,setCurrentKey:me,getCheckedKeys:fe,getCheckedNodes:ce,getHalfCheckedKeys:pe,getHalfCheckedNodes:ye,setChecked:De,setCheckedKeys:tt,filter:Me,setData:xe,getNode:Ae,expandNode:Ce,collapseNode:ge,setExpandedKeys:Ne,scrollToNode:We,scrollTo:ot}),(Oe,Ct)=>(se(),Pe("div",{class:de([y(o).b(),{[y(o).m("highlight-current")]:Oe.highlightCurrent}]),role:"tree"},[y(E)?(se(),Rt(y(gz),{key:0,ref_key:"listRef",ref:I,"class-name":y(o).b("virtual-list"),data:y(S),total:y(S).length,height:Oe.height,"item-size":y(g),"perf-mode":Oe.perfMode},{default:at(({data:Mt,index:zt,style:bt})=>[(se(),Rt(Hue,{key:Mt[zt].key,style:to(bt),node:Mt[zt],expanded:y(F)(Mt[zt]),"show-checkbox":Oe.showCheckbox,checked:y($)(Mt[zt]),indeterminate:y(B)(Mt[zt]),"item-size":y(g),disabled:y(z)(Mt[zt]),current:y(H)(Mt[zt]),"hidden-expand-icon":y(U)(Mt[zt]),onClick:y(ie),onToggle:y(P),onCheck:y(G),onDrop:y(Z)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(se(),Pe("div",{key:1,class:de(y(o).e("empty-block"))},[_t(Oe.$slots,"empty",{},()=>{var Mt;return[He("span",{class:de(y(o).e("empty-text"))},wn((Mt=Oe.emptyText)!=null?Mt:y(_)("el.tree.emptyText")),3)]})],2))],2))}});var que=bn(Wue,[["__file","tree.vue"]]);const Kue=Ao(que),L4=Symbol("uploadContextKey"),Zue="ElUpload";class Yue extends Error{constructor(t,i,s,d){super(t),this.name="UploadAjaxError",this.status=i,this.method=s,this.url=d}}function r3(e,t,i){let s;return i.response?s=`${i.response.error||i.response}`:i.responseText?s=`${i.responseText}`:s=`fail to ${t.method} ${e} ${i.status}`,new Yue(s,i.status,t.method,e)}function Xue(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const Jue=e=>{typeof XMLHttpRequest>"u"&&ha(Zue,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,i=e.action;t.upload&&t.upload.addEventListener("progress",g=>{const _=g;_.percent=g.total>0?g.loaded/g.total*100:0,e.onProgress(_)});const s=new FormData;if(e.data)for(const[g,_]of Object.entries(e.data))fn(_)&&_.length?s.append(g,..._):s.append(g,_);s.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(r3(i,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(r3(i,e,t));e.onSuccess(Xue(t))}),t.open(e.method,i,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const d=e.headers||{};if(d instanceof Headers)d.forEach((g,_)=>t.setRequestHeader(_,g));else for(const[g,_]of Object.entries(d))ga(_)||t.setRequestHeader(g,String(_));return t.send(s),t},D4=["text","picture","picture-card"];let Que=1;const fS=()=>Date.now()+Que++,z4=vn({action:{type:String,default:"#"},headers:{type:ut(Object)},method:{type:String,default:"post"},data:{type:ut([Object,Function,Promise]),default:()=>Ri({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:ut(Array),default:()=>Ri([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:D4,default:"text"},httpRequest:{type:ut(Function),default:Jue},disabled:Boolean,limit:Number}),ede=vn({...z4,beforeUpload:{type:ut(Function),default:jr},beforeRemove:{type:ut(Function)},onRemove:{type:ut(Function),default:jr},onChange:{type:ut(Function),default:jr},onPreview:{type:ut(Function),default:jr},onSuccess:{type:ut(Function),default:jr},onProgress:{type:ut(Function),default:jr},onError:{type:ut(Function),default:jr},onExceed:{type:ut(Function),default:jr},crossorigin:{type:ut(String)}}),tde=vn({files:{type:ut(Array),default:()=>Ri([])},disabled:{type:Boolean,default:!1},handlePreview:{type:ut(Function),default:jr},listType:{type:String,values:D4,default:"text"},crossorigin:{type:ut(String)}}),nde={remove:e=>!!e},ode=Ze({name:"ElUploadList"}),rde=Ze({...ode,props:tde,emits:nde,setup(e,{emit:t}){const i=e,{t:s}=vr(),d=rn("upload"),g=rn("icon"),_=rn("list"),o=Za(),S=Se(!1),E=te(()=>[d.b("list"),d.bm("list",i.listType),d.is("disabled",i.disabled)]),I=P=>{t("remove",P)};return(P,F)=>(se(),Rt(DR,{tag:"ul",class:de(y(E)),name:y(_).b()},{default:at(()=>[(se(!0),Pe(eo,null,tr(P.files,(B,$)=>(se(),Pe("li",{key:B.uid||B.name,class:de([y(d).be("list","item"),y(d).is(B.status),{focusing:S.value}]),tabindex:"0",onKeydown:ti(z=>!y(o)&&I(B),["delete"]),onFocus:z=>S.value=!0,onBlur:z=>S.value=!1,onClick:z=>S.value=!1},[_t(P.$slots,"default",{file:B,index:$},()=>[P.listType==="picture"||B.status!=="uploading"&&P.listType==="picture-card"?(se(),Pe("img",{key:0,class:de(y(d).be("list","item-thumbnail")),src:B.url,crossorigin:P.crossorigin,alt:""},null,10,["src","crossorigin"])):St("v-if",!0),B.status==="uploading"||P.listType!=="picture-card"?(se(),Pe("div",{key:1,class:de(y(d).be("list","item-info"))},[He("a",{class:de(y(d).be("list","item-name")),onClick:po(z=>P.handlePreview(B),["prevent"])},[Qe(y(Gn),{class:de(y(g).m("document"))},{default:at(()=>[Qe(y(tW))]),_:1},8,["class"]),He("span",{class:de(y(d).be("list","item-file-name")),title:B.name},wn(B.name),11,["title"])],10,["onClick"]),B.status==="uploading"?(se(),Rt(y(az),{key:0,type:P.listType==="picture-card"?"circle":"line","stroke-width":P.listType==="picture-card"?6:2,percentage:Number(B.percentage),style:to(P.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):St("v-if",!0)],2)):St("v-if",!0),He("label",{class:de(y(d).be("list","item-status-label"))},[P.listType==="text"?(se(),Rt(y(Gn),{key:0,class:de([y(g).m("upload-success"),y(g).m("circle-check")])},{default:at(()=>[Qe(y(aT))]),_:1},8,["class"])):["picture-card","picture"].includes(P.listType)?(se(),Rt(y(Gn),{key:1,class:de([y(g).m("upload-success"),y(g).m("check")])},{default:at(()=>[Qe(y(D_))]),_:1},8,["class"])):St("v-if",!0)],2),y(o)?St("v-if",!0):(se(),Rt(y(Gn),{key:2,class:de(y(g).m("close")),onClick:z=>I(B)},{default:at(()=>[Qe(y(Kc))]),_:2},1032,["class","onClick"])),St(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),St(" This is a bug which needs to be fixed "),St(" TODO: Fix the incorrect navigation interaction "),y(o)?St("v-if",!0):(se(),Pe("i",{key:3,class:de(y(g).m("close-tip"))},wn(y(s)("el.upload.deleteTip")),3)),P.listType==="picture-card"?(se(),Pe("span",{key:4,class:de(y(d).be("list","item-actions"))},[He("span",{class:de(y(d).be("list","item-preview")),onClick:z=>P.handlePreview(B)},[Qe(y(Gn),{class:de(y(g).m("zoom-in"))},{default:at(()=>[Qe(y(tL))]),_:1},8,["class"])],10,["onClick"]),y(o)?St("v-if",!0):(se(),Pe("span",{key:0,class:de(y(d).be("list","item-delete")),onClick:z=>I(B)},[Qe(y(Gn),{class:de(y(g).m("delete"))},{default:at(()=>[Qe(y(QG))]),_:1},8,["class"])],10,["onClick"]))],2)):St("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),_t(P.$slots,"append")]),_:3},8,["class","name"]))}});var i3=bn(rde,[["__file","upload-list.vue"]]);const ide=vn({disabled:{type:Boolean,default:!1}}),ade={file:e=>fn(e)},F4="ElUploadDrag",sde=Ze({name:F4}),lde=Ze({...sde,props:ide,emits:ade,setup(e,{emit:t}){Un(L4)||ha(F4,"usage: <el-upload><el-upload-dragger /></el-upload>");const s=rn("upload"),d=Se(!1),g=Za(),_=S=>{if(g.value)return;d.value=!1,S.stopPropagation();const E=Array.from(S.dataTransfer.files);t("file",E)},o=()=>{g.value||(d.value=!0)};return(S,E)=>(se(),Pe("div",{class:de([y(s).b("dragger"),y(s).is("dragover",d.value)]),onDrop:po(_,["prevent"]),onDragover:po(o,["prevent"]),onDragleave:po(I=>d.value=!1,["prevent"])},[_t(S.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var cde=bn(lde,[["__file","upload-dragger.vue"]]);const ude=vn({...z4,beforeUpload:{type:ut(Function),default:jr},onRemove:{type:ut(Function),default:jr},onStart:{type:ut(Function),default:jr},onSuccess:{type:ut(Function),default:jr},onProgress:{type:ut(Function),default:jr},onError:{type:ut(Function),default:jr},onExceed:{type:ut(Function),default:jr}}),dde=Ze({name:"ElUploadContent",inheritAttrs:!1}),hde=Ze({...dde,props:ude,setup(e,{expose:t}){const i=e,s=rn("upload"),d=Za(),g=gi({}),_=gi(),o=z=>{if(z.length===0)return;const{autoUpload:H,limit:U,fileList:ie,multiple:Z,onStart:G,onExceed:Q}=i;if(U&&ie.length+z.length>U){Q(z,ie);return}Z||(z=z.slice(0,1));for(const oe of z){const le=oe;le.uid=fS(),G(le),H&&S(le)}},S=async z=>{if(_.value.value="",!i.beforeUpload)return I(z);let H,U={};try{const Z=i.data,G=i.beforeUpload(z);U=Jv(i.data)?_b(i.data):i.data,H=await G,Jv(i.data)&&Oa(Z,U)&&(U=_b(i.data))}catch{H=!1}if(H===!1){i.onRemove(z);return}let ie=z;H instanceof Blob&&(H instanceof File?ie=H:ie=new File([H],z.name,{type:z.type})),I(Object.assign(ie,{uid:z.uid}),U)},E=async(z,H)=>Qn(z)?z(H):z,I=async(z,H)=>{const{headers:U,data:ie,method:Z,withCredentials:G,name:Q,action:oe,onProgress:le,onSuccess:me,onError:fe,httpRequest:ce}=i;try{H=await E(H??ie,z)}catch{i.onRemove(z);return}const{uid:pe}=z,ye={headers:U||{},withCredentials:G,file:z,data:H,method:Z,filename:Q,action:oe,onProgress:tt=>{le(tt,z)},onSuccess:tt=>{me(tt,z),delete g.value[pe]},onError:tt=>{fe(tt,z),delete g.value[pe]}},De=ce(ye);g.value[pe]=De,De instanceof Promise&&De.then(ye.onSuccess,ye.onError)},P=z=>{const H=z.target.files;H&&o(Array.from(H))},F=()=>{d.value||(_.value.value="",_.value.click())},B=()=>{F()};return t({abort:z=>{GO(g.value).filter(z?([U])=>String(z.uid)===U:()=>!0).forEach(([U,ie])=>{ie instanceof XMLHttpRequest&&ie.abort(),delete g.value[U]})},upload:S}),(z,H)=>(se(),Pe("div",{class:de([y(s).b(),y(s).m(z.listType),y(s).is("drag",z.drag),y(s).is("disabled",y(d))]),tabindex:y(d)?"-1":"0",onClick:F,onKeydown:ti(po(B,["self"]),["enter","space"])},[z.drag?(se(),Rt(cde,{key:0,disabled:y(d),onFile:o},{default:at(()=>[_t(z.$slots,"default")]),_:3},8,["disabled"])):_t(z.$slots,"default",{key:1}),He("input",{ref_key:"inputRef",ref:_,class:de(y(s).e("input")),name:z.name,disabled:y(d),multiple:z.multiple,accept:z.accept,type:"file",onChange:P,onClick:po(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var a3=bn(hde,[["__file","upload-content.vue"]]);const s3="ElUpload",l3=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},fde=(e,t)=>{const i=FO(e,"fileList",void 0,{passive:!0}),s=B=>i.value.find($=>$.uid===B.uid);function d(B){var $;($=t.value)==null||$.abort(B)}function g(B=["ready","uploading","success","fail"]){i.value=i.value.filter($=>!B.includes($.status))}function _(B){i.value=i.value.filter($=>$!==B)}const o=(B,$)=>{const z=s($);z&&(console.error(B),z.status="fail",_(z),e.onError(B,z,i.value),e.onChange(z,i.value))},S=(B,$)=>{const z=s($);z&&(e.onProgress(B,z,i.value),z.status="uploading",z.percentage=Math.round(B.percent))},E=(B,$)=>{const z=s($);z&&(z.status="success",z.response=B,e.onSuccess(B,z,i.value),e.onChange(z,i.value))},I=B=>{ga(B.uid)&&(B.uid=fS());const $={name:B.name,percentage:0,status:"ready",size:B.size,raw:B,uid:B.uid};if(e.listType==="picture-card"||e.listType==="picture")try{$.url=URL.createObjectURL(B)}catch(z){z.message,e.onError(z,$,i.value)}i.value=[...i.value,$],e.onChange($,i.value)},P=async B=>{const $=B instanceof File?s(B):B;$||ha(s3,"file to be removed not found");const z=H=>{d(H),_(H),e.onRemove(H,i.value),l3(H)};e.beforeRemove?await e.beforeRemove($,i.value)!==!1&&z($):z($)};function F(){i.value.filter(({status:B})=>B==="ready").forEach(({raw:B})=>{var $;return B&&(($=t.value)==null?void 0:$.upload(B))})}return tn(()=>e.listType,B=>{B!=="picture-card"&&B!=="picture"||(i.value=i.value.map($=>{const{raw:z,url:H}=$;if(!H&&z)try{$.url=URL.createObjectURL(z)}catch(U){e.onError(U,$,i.value)}return $}))}),tn(i,B=>{for(const $ of B)$.uid||($.uid=fS()),$.status||($.status="success")},{immediate:!0,deep:!0}),{uploadFiles:i,abort:d,clearFiles:g,handleError:o,handleProgress:S,handleStart:I,handleSuccess:E,handleRemove:P,submit:F,revokeFileObjectURL:l3}},pde=Ze({name:"ElUpload"}),mde=Ze({...pde,props:ede,setup(e,{expose:t}){const i=e,s=Za(),d=gi(),{abort:g,submit:_,clearFiles:o,uploadFiles:S,handleStart:E,handleError:I,handleRemove:P,handleSuccess:F,handleProgress:B,revokeFileObjectURL:$}=fde(i,d),z=te(()=>i.listType==="picture-card"),H=te(()=>({...i,fileList:S.value,onStart:E,onProgress:B,onSuccess:F,onError:I,onRemove:P}));return ni(()=>{S.value.forEach($)}),or(L4,{accept:Vr(i,"accept")}),t({abort:g,submit:_,clearFiles:o,handleStart:E,handleRemove:P}),(U,ie)=>(se(),Pe("div",null,[y(z)&&U.showFileList?(se(),Rt(i3,{key:0,disabled:y(s),"list-type":U.listType,files:y(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(P)},ec({append:at(()=>[Qe(a3,Yo({ref_key:"uploadRef",ref:d},y(H)),{default:at(()=>[U.$slots.trigger?_t(U.$slots,"trigger",{key:0}):St("v-if",!0),!U.$slots.trigger&&U.$slots.default?_t(U.$slots,"default",{key:1}):St("v-if",!0)]),_:3},16)]),_:2},[U.$slots.file?{name:"default",fn:at(({file:Z,index:G})=>[_t(U.$slots,"file",{file:Z,index:G})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):St("v-if",!0),!y(z)||y(z)&&!U.showFileList?(se(),Rt(a3,Yo({key:1,ref_key:"uploadRef",ref:d},y(H)),{default:at(()=>[U.$slots.trigger?_t(U.$slots,"trigger",{key:0}):St("v-if",!0),!U.$slots.trigger&&U.$slots.default?_t(U.$slots,"default",{key:1}):St("v-if",!0)]),_:3},16)):St("v-if",!0),U.$slots.trigger?_t(U.$slots,"default",{key:2}):St("v-if",!0),_t(U.$slots,"tip"),!y(z)&&U.showFileList?(se(),Rt(i3,{key:3,disabled:y(s),"list-type":U.listType,files:y(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(P)},ec({_:2},[U.$slots.file?{name:"default",fn:at(({file:Z,index:G})=>[_t(U.$slots,"file",{file:Z,index:G})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):St("v-if",!0)]))}});var gde=bn(mde,[["__file","upload.vue"]]);const vde=Ao(gde),_de=vn({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:ut([String,Array]),default:"Element Plus"},font:{type:ut(Object)},gap:{type:ut(Array),default:()=>[100,100]},offset:{type:ut(Array)}});function yde(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function bde(e){return Object.keys(e).map(t=>`${yde(t)}: ${e[t]};`).join(" ")}function xde(){return window.devicePixelRatio||1}const wde=(e,t)=>{let i=!1;return e.removedNodes.length&&t&&(i=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(i=!0),i},B4=3;function Gw(e,t,i=1){const s=document.createElement("canvas"),d=s.getContext("2d"),g=e*i,_=t*i;return s.setAttribute("width",`${g}px`),s.setAttribute("height",`${_}px`),d.save(),[d,s,g,_]}function Sde(){function e(t,i,s,d,g,_,o,S){const[E,I,P,F]=Gw(d,g,s);if(t instanceof HTMLImageElement)E.drawImage(t,0,0,P,F);else{const{color:We,fontSize:ot,fontStyle:Oe,fontWeight:Ct,fontFamily:Mt,textAlign:zt,textBaseline:bt}=_,Kt=Number(ot)*s;E.font=`${Oe} normal ${Ct} ${Kt}px/${g}px ${Mt}`,E.fillStyle=We,E.textAlign=zt,E.textBaseline=bt;const $t=fn(t)?t:[t];$t==null||$t.forEach((Re,dn)=>{E.fillText(Re??"",P/2,dn*(Kt+B4*s))})}const B=Math.PI/180*Number(i),$=Math.max(d,g),[z,H,U]=Gw($,$,s);z.translate(U/2,U/2),z.rotate(B),P>0&&F>0&&z.drawImage(I,-P/2,-F/2);function ie(We,ot){const Oe=We*Math.cos(B)-ot*Math.sin(B),Ct=We*Math.sin(B)+ot*Math.cos(B);return[Oe,Ct]}let Z=0,G=0,Q=0,oe=0;const le=P/2,me=F/2;[[0-le,0-me],[0+le,0-me],[0+le,0+me],[0-le,0+me]].forEach(([We,ot])=>{const[Oe,Ct]=ie(We,ot);Z=Math.min(Z,Oe),G=Math.max(G,Oe),Q=Math.min(Q,Ct),oe=Math.max(oe,Ct)});const ce=Z+U/2,pe=Q+U/2,ye=G-Z,De=oe-Q,tt=o*s,Me=S*s,xe=(ye+tt)*2,Ae=De+Me,[Ce,ge]=Gw(xe,Ae);function Ne(We=0,ot=0){Ce.drawImage(H,ce,pe,ye,De,We,ot,ye,De)}return Ne(),Ne(ye+tt,-De/2-Me/2),Ne(ye+tt,+De/2+Me/2),[ge.toDataURL(),xe/s,Ae/s]}return e}const Tde=Ze({name:"ElWatermark"}),Cde=Ze({...Tde,props:_de,setup(e){const t=e,i={position:"relative"},s=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.color)!=null?pe:"rgba(0,0,0,.15)"}),d=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontSize)!=null?pe:16}),g=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontWeight)!=null?pe:"normal"}),_=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontStyle)!=null?pe:"normal"}),o=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontFamily)!=null?pe:"sans-serif"}),S=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.textAlign)!=null?pe:"center"}),E=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.textBaseline)!=null?pe:"hanging"}),I=te(()=>t.gap[0]),P=te(()=>t.gap[1]),F=te(()=>I.value/2),B=te(()=>P.value/2),$=te(()=>{var ce,pe;return(pe=(ce=t.offset)==null?void 0:ce[0])!=null?pe:F.value}),z=te(()=>{var ce,pe;return(pe=(ce=t.offset)==null?void 0:ce[1])!=null?pe:B.value}),H=()=>{const ce={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let pe=$.value-F.value,ye=z.value-B.value;return pe>0&&(ce.left=`${pe}px`,ce.width=`calc(100% - ${pe}px)`,pe=0),ye>0&&(ce.top=`${ye}px`,ce.height=`calc(100% - ${ye}px)`,ye=0),ce.backgroundPosition=`${pe}px ${ye}px`,ce},U=gi(null),ie=gi(),Z=Se(!1),G=()=>{ie.value&&(ie.value.remove(),ie.value=void 0)},Q=(ce,pe)=>{var ye;U.value&&ie.value&&(Z.value=!0,ie.value.setAttribute("style",bde({...H(),backgroundImage:`url('${ce}')`,backgroundSize:`${Math.floor(pe)}px`})),(ye=U.value)==null||ye.append(ie.value),setTimeout(()=>{Z.value=!1}))},oe=ce=>{let pe=120,ye=64;const De=t.image,tt=t.content,Me=t.width,xe=t.height;if(!De&&ce.measureText){ce.font=`${Number(d.value)}px ${o.value}`;const Ae=fn(tt)?tt:[tt],Ce=Ae.map(ge=>{const Ne=ce.measureText(ge);return[Ne.width,Ne.fontBoundingBoxAscent!==void 0?Ne.fontBoundingBoxAscent+Ne.fontBoundingBoxDescent:Ne.actualBoundingBoxAscent+Ne.actualBoundingBoxDescent]});pe=Math.ceil(Math.max(...Ce.map(ge=>ge[0]))),ye=Math.ceil(Math.max(...Ce.map(ge=>ge[1])))*Ae.length+(Ae.length-1)*B4}return[Me??pe,xe??ye]},le=Sde(),me=()=>{const pe=document.createElement("canvas").getContext("2d"),ye=t.image,De=t.content,tt=t.rotate;if(pe){ie.value||(ie.value=document.createElement("div"));const Me=xde(),[xe,Ae]=oe(pe),Ce=ge=>{const[Ne,We]=le(ge||"",tt,Me,xe,Ae,{color:s.value,fontSize:d.value,fontStyle:_.value,fontWeight:g.value,fontFamily:o.value,textAlign:S.value,textBaseline:E.value},I.value,P.value);Q(Ne,We)};if(ye){const ge=new Image;ge.onload=()=>{Ce(ge)},ge.onerror=()=>{Ce(De)},ge.crossOrigin="anonymous",ge.referrerPolicy="no-referrer",ge.src=ye}else Ce(De)}};return No(()=>{me()}),tn(()=>t,()=>{me()},{deep:!0,flush:"post"}),ni(()=>{G()}),zO(U,ce=>{Z.value||ce.forEach(pe=>{wde(pe,ie.value)&&(G(),me())})},{attributes:!0,subtree:!0,childList:!0}),(ce,pe)=>(se(),Pe("div",{ref_key:"containerRef",ref:U,style:to([i])},[_t(ce.$slots,"default")],4))}});var Ede=bn(Cde,[["__file","watermark.vue"]]);const Mde=Ao(Ede),Ide=vn({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:ut(Object)},targetAreaClickable:{type:Boolean,default:!0}}),Ade=(e,t,i,s,d)=>{const g=Se(null),_=()=>{let P;return Zn(e.value)?P=document.querySelector(e.value):Qn(e.value)?P=e.value():P=e.value,P},o=()=>{const P=_();if(!P||!t.value){g.value=null;return}kde(P)||P.scrollIntoView(d.value);const{left:F,top:B,width:$,height:z}=P.getBoundingClientRect();g.value={left:F,top:B,width:$,height:z,radius:0}};No(()=>{tn([t,e],()=>{o()},{immediate:!0}),window.addEventListener("resize",o)}),ni(()=>{window.removeEventListener("resize",o)});const S=P=>{var F;return(F=fn(i.value.offset)?i.value.offset[P]:i.value.offset)!=null?F:6},E=te(()=>{var P;if(!g.value)return g.value;const F=S(0),B=S(1),$=((P=i.value)==null?void 0:P.radius)||2;return{left:g.value.left-F,top:g.value.top-B,width:g.value.width+F*2,height:g.value.height+B*2,radius:$}}),I=te(()=>{const P=_();return!s.value||!P||!window.DOMRect?P||void 0:{getBoundingClientRect(){var F,B,$,z;return window.DOMRect.fromRect({width:((F=E.value)==null?void 0:F.width)||0,height:((B=E.value)==null?void 0:B.height)||0,x:(($=E.value)==null?void 0:$.left)||0,y:((z=E.value)==null?void 0:z.top)||0})}}});return{mergedPosInfo:E,triggerTarget:I}},E1=Symbol("ElTour");function kde(e){const t=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,{top:s,right:d,bottom:g,left:_}=e.getBoundingClientRect();return s>=0&&_>=0&&d<=t&&g<=i}const Pde=(e,t,i,s,d,g,_,o)=>{const S=Se(),E=Se(),I=Se({}),P={x:S,y:E,placement:s,strategy:d,middlewareData:I},F=te(()=>{const U=[_4(y(g)),Dce(),Lce(),Rde()];return y(o)&&y(i)&&U.push(y4({element:y(i)})),U}),B=async()=>{if(!gr)return;const U=y(e),ie=y(t);if(!U||!ie)return;const Z=await b4(U,ie,{placement:y(s),strategy:y(d),middleware:y(F)});bm(P).forEach(G=>{P[G].value=Z[G]})},$=te(()=>{if(!y(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:y(_)};const{overflow:U}=y(I);return{position:y(d),zIndex:y(_),top:y(E)!=null?`${y(E)}px`:"",left:y(S)!=null?`${y(S)}px`:"",maxWidth:U!=null&&U.maxWidth?`${U==null?void 0:U.maxWidth}px`:""}}),z=te(()=>{if(!y(o))return{};const{arrow:U}=y(I);return{left:(U==null?void 0:U.x)!=null?`${U==null?void 0:U.x}px`:"",top:(U==null?void 0:U.y)!=null?`${U==null?void 0:U.y}px`:""}});let H;return No(()=>{const U=y(e),ie=y(t);U&&ie&&(H=Rce(U,ie,B)),Ha(()=>{B()})}),ni(()=>{H&&H()}),{update:B,contentStyle:$,arrowStyle:z}},Rde=()=>({name:"overflow",async fn(e){const t=await Oce(e);let i=0;return t.left>0&&(i=t.left),t.right>0&&(i=t.right),{data:{maxWidth:e.rects.floating.width-i}}}}),Ode=Ze({name:"ElTourMask",inheritAttrs:!1}),Lde=Ze({...Ode,props:Ide,setup(e){const t=e,{ns:i}=Un(E1),s=te(()=>{var o,S;return(S=(o=t.pos)==null?void 0:o.radius)!=null?S:2}),d=te(()=>{const o=s.value,S=`a${o},${o} 0 0 1`;return{topRight:`${S} ${o},${o}`,bottomRight:`${S} ${-o},${o}`,bottomLeft:`${S} ${-o},${-o}`,topLeft:`${S} ${o},${-o}`}}),g=te(()=>{const o=window.innerWidth,S=window.innerHeight,E=d.value,I=`M${o},0 L0,0 L0,${S} L${o},${S} L${o},0 Z`,P=s.value;return t.pos?`${I} M${t.pos.left+P},${t.pos.top} h${t.pos.width-P*2} ${E.topRight} v${t.pos.height-P*2} ${E.bottomRight} h${-t.pos.width+P*2} ${E.bottomLeft} v${-t.pos.height+P*2} ${E.topLeft} z`:I}),_=te(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return $T(Vr(t,"visible"),{ns:i}),(o,S)=>o.visible?(se(),Pe("div",Yo({key:0,class:y(i).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:o.zIndex,pointerEvents:o.pos&&o.targetAreaClickable?"none":"auto"}},o.$attrs),[(se(),Pe("svg",{style:{width:"100%",height:"100%"}},[He("path",{class:de(y(i).e("hollow")),style:to(y(_)),d:y(g)},null,14,["d"])]))],16)):St("v-if",!0)}});var Dde=bn(Lde,[["__file","mask.vue"]]);const zde=["absolute","fixed"],Fde=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],bC=vn({placement:{type:ut(String),values:Fde,default:"bottom"},reference:{type:ut(Object),default:null},strategy:{type:ut(String),values:zde,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),Bde={close:()=>!0},Nde=Ze({name:"ElTourContent"}),$de=Ze({...Nde,props:bC,emits:Bde,setup(e,{emit:t}){const i=e,s=Se(i.placement),d=Se(i.strategy),g=Se(null),_=Se(null);tn(()=>i.placement,()=>{s.value=i.placement});const{contentStyle:o,arrowStyle:S}=Pde(Vr(i,"reference"),g,_,s,d,Vr(i,"offset"),Vr(i,"zIndex"),Vr(i,"showArrow")),E=te(()=>s.value.split("-")[0]),{ns:I}=Un(E1),P=()=>{t("close")},F=B=>{B.detail.focusReason==="pointer"&&B.preventDefault()};return(B,$)=>(se(),Pe("div",{ref_key:"contentRef",ref:g,style:to(y(o)),class:de(y(I).e("content")),"data-side":y(E),tabindex:"-1"},[Qe(y(jm),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":g.value||void 0,onReleaseRequested:P,onFocusoutPrevented:F},{default:at(()=>[_t(B.$slots,"default")]),_:3},8,["focus-trap-el"]),B.showArrow?(se(),Pe("span",{key:0,ref_key:"arrowRef",ref:_,style:to(y(S)),class:de(y(I).e("arrow"))},null,6)):St("v-if",!0)],14,["data-side"]))}});var Vde=bn($de,[["__file","content.vue"]]),Ude=Ze({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:i}){let s=0;return()=>{var d,g;const _=(d=t.default)==null?void 0:d.call(t),o=[];let S=0;function E(I){fn(I)&&I.forEach(P=>{var F;((F=(P==null?void 0:P.type)||{})==null?void 0:F.name)==="ElTourStep"&&(o.push(P),S+=1)})}return _.length&&E(fh((g=_[0])==null?void 0:g.children)),s!==S&&(s=S,i("update-total",S)),o.length?o[e.current]:null}}});const jde=vn({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:Xr},placement:bC.placement,contentStyle:{type:ut([Object])},mask:{type:ut([Boolean,Object]),default:!0},gap:{type:ut(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:ut([Boolean,Object]),default:()=>({block:"center"})},type:{type:ut(String)},appendTo:{type:ut([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),Hde={[Fo]:e=>ai(e),"update:current":e=>ao(e),close:e=>ao(e),finish:()=>!0,change:e=>ao(e)},Gde=Ze({name:"ElTour"}),Wde=Ze({...Gde,props:jde,emits:Hde,setup(e,{emit:t}){const i=e,s=rn("tour"),d=Se(0),g=Se(),_=FO(i,"current",t,{passive:!0}),o=te(()=>{var fe;return(fe=g.value)==null?void 0:fe.target}),S=te(()=>[s.b(),H.value==="primary"?s.m("primary"):""]),E=te(()=>{var fe;return((fe=g.value)==null?void 0:fe.placement)||i.placement}),I=te(()=>{var fe,ce;return(ce=(fe=g.value)==null?void 0:fe.contentStyle)!=null?ce:i.contentStyle}),P=te(()=>{var fe,ce;return(ce=(fe=g.value)==null?void 0:fe.mask)!=null?ce:i.mask}),F=te(()=>!!P.value&&i.modelValue),B=te(()=>ai(P.value)?void 0:P.value),$=te(()=>{var fe,ce;return!!o.value&&((ce=(fe=g.value)==null?void 0:fe.showArrow)!=null?ce:i.showArrow)}),z=te(()=>{var fe,ce;return(ce=(fe=g.value)==null?void 0:fe.scrollIntoViewOptions)!=null?ce:i.scrollIntoViewOptions}),H=te(()=>{var fe,ce;return(ce=(fe=g.value)==null?void 0:fe.type)!=null?ce:i.type}),{nextZIndex:U}=Vm(),ie=U(),Z=te(()=>{var fe;return(fe=i.zIndex)!=null?fe:ie}),{mergedPosInfo:G,triggerTarget:Q}=Ade(o,Vr(i,"modelValue"),Vr(i,"gap"),P,z);tn(()=>i.modelValue,fe=>{fe||(_.value=0)});const oe=()=>{i.closeOnPressEscape&&(t("update:modelValue",!1),t("close",_.value))},le=fe=>{d.value=fe},me=aa();return or(E1,{currentStep:g,current:_,total:d,showClose:Vr(i,"showClose"),closeIcon:Vr(i,"closeIcon"),mergedType:H,ns:s,slots:me,updateModelValue(fe){t("update:modelValue",fe)},onClose(){t("close",_.value)},onFinish(){t("finish")},onChange(){t("change",_.value)}}),(fe,ce)=>(se(),Pe(eo,null,[Qe(y(Hm),{to:fe.appendTo},{default:at(()=>{var pe,ye;return[He("div",Yo({class:y(S)},fe.$attrs),[Qe(Dde,{visible:y(F),fill:(pe=y(B))==null?void 0:pe.color,style:to((ye=y(B))==null?void 0:ye.style),pos:y(G),"z-index":y(Z),"target-area-clickable":fe.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),fe.modelValue?(se(),Rt(Vde,{key:y(_),reference:y(Q),placement:y(E),"show-arrow":y($),"z-index":y(Z),style:to(y(I)),onClose:oe},{default:at(()=>[Qe(y(Ude),{current:y(_),onUpdateTotal:le},{default:at(()=>[_t(fe.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):St("v-if",!0)],16)]}),_:3},8,["to"]),St(" just for IDE "),St("v-if",!0)],64))}});var qde=bn(Wde,[["__file","tour.vue"]]);const Kde=vn({target:{type:ut([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:Xr},showArrow:{type:Boolean,default:void 0},placement:bC.placement,mask:{type:ut([Boolean,Object]),default:void 0},contentStyle:{type:ut([Object])},prevButtonProps:{type:ut(Object)},nextButtonProps:{type:ut(Object)},scrollIntoViewOptions:{type:ut([Boolean,Object]),default:void 0},type:{type:ut(String)}}),Zde={close:()=>!0},Yde=Ze({name:"ElTourStep"}),Xde=Ze({...Yde,props:Kde,emits:Zde,setup(e,{emit:t}){const i=e,{Close:s}=cT,{t:d}=vr(),{currentStep:g,current:_,total:o,showClose:S,closeIcon:E,mergedType:I,ns:P,slots:F,updateModelValue:B,onClose:$,onFinish:z,onChange:H}=Un(E1);tn(i,me=>{g.value=me},{immediate:!0});const U=te(()=>{var me;return(me=i.showClose)!=null?me:S.value}),ie=te(()=>{var me,fe;return(fe=(me=i.closeIcon)!=null?me:E.value)!=null?fe:s}),Z=me=>{if(me)return _H(me,["children","onClick"])},G=()=>{var me,fe;_.value-=1,(me=i.prevButtonProps)!=null&&me.onClick&&((fe=i.prevButtonProps)==null||fe.onClick()),H()},Q=()=>{var me;_.value>=o.value-1?oe():_.value+=1,(me=i.nextButtonProps)!=null&&me.onClick&&i.nextButtonProps.onClick(),H()},oe=()=>{le(),z()},le=()=>{B(!1),$(),t("close")};return(me,fe)=>(se(),Pe(eo,null,[y(U)?(se(),Pe("button",{key:0,"aria-label":"Close",class:de(y(P).e("closebtn")),type:"button",onClick:le},[Qe(y(Gn),{class:de(y(P).e("close"))},{default:at(()=>[(se(),Rt(Wo(y(ie))))]),_:1},8,["class"])],2)):St("v-if",!0),He("header",{class:de([y(P).e("header"),{"show-close":y(S)}])},[_t(me.$slots,"header",{},()=>[He("span",{role:"heading",class:de(y(P).e("title"))},wn(me.title),3)])],2),He("div",{class:de(y(P).e("body"))},[_t(me.$slots,"default",{},()=>[He("span",null,wn(me.description),1)])],2),He("footer",{class:de(y(P).e("footer"))},[He("div",{class:de(y(P).b("indicators"))},[y(F).indicators?(se(),Rt(Wo(y(F).indicators),{key:0,current:y(_),total:y(o)},null,8,["current","total"])):(se(!0),Pe(eo,{key:1},tr(y(o),(ce,pe)=>(se(),Pe("span",{key:ce,class:de([y(P).b("indicator"),pe===y(_)?"is-active":""])},null,2))),128))],2),He("div",{class:de(y(P).b("buttons"))},[y(_)>0?(se(),Rt(y(Ta),Yo({key:0,size:"small",type:y(I)},Z(me.prevButtonProps),{onClick:G}),{default:at(()=>{var ce,pe;return[nr(wn((pe=(ce=me.prevButtonProps)==null?void 0:ce.children)!=null?pe:y(d)("el.tour.previous")),1)]}),_:1},16,["type"])):St("v-if",!0),y(_)<=y(o)-1?(se(),Rt(y(Ta),Yo({key:1,size:"small",type:y(I)==="primary"?"default":"primary"},Z(me.nextButtonProps),{onClick:Q}),{default:at(()=>{var ce,pe;return[nr(wn((pe=(ce=me.nextButtonProps)==null?void 0:ce.children)!=null?pe:y(_)===y(o)-1?y(d)("el.tour.finish"):y(d)("el.tour.next")),1)]}),_:1},16,["type"])):St("v-if",!0)],2)],2)],64))}});var N4=bn(Xde,[["__file","step.vue"]]);const Jde=Ao(qde,{TourStep:N4}),Qde=Oi(N4),ehe=vn({container:{type:ut([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:ut(String),default:"default"},direction:{type:ut(String),default:"vertical"}}),the={change:e=>Zn(e),click:(e,t)=>e instanceof MouseEvent&&(Zn(t)||Hr(t))},$4=Symbol("anchor"),F0=e=>{if(!gr||e==="")return null;if(Zn(e))try{return document.querySelector(e)}catch{return null}return e};function nhe(e){let t=0;const i=(...s)=>{t&&$f(t),t=_h(()=>{e(...s),t=0})};return i.cancel=()=>{$f(t),t=0},i}const ohe=Ze({name:"ElAnchor"}),rhe=Ze({...ohe,props:ehe,emits:the,setup(e,{expose:t,emit:i}){const s=e,d=Se(""),g=Se(null),_=Se(null),o=Se(),S={};let E=!1,I=0;const P=rn("anchor"),F=te(()=>[P.b(),s.type==="underline"?P.m("underline"):"",P.m(s.direction)]),B=me=>{S[me.href]=me.el},$=me=>{delete S[me]},z=me=>{d.value!==me&&(d.value=me,i("change",me))};let H=null;const U=me=>{if(!o.value)return;const fe=F0(me);if(!fe)return;H&&H(),E=!0;const ce=_k(fe,o.value),pe=C2(fe,ce),ye=ce.scrollHeight-ce.clientHeight,De=Math.min(pe-s.offset,ye);H=xG(o.value,I,De,s.duration,()=>{setTimeout(()=>{E=!1},20)})},ie=me=>{me&&(z(me),U(me))},Z=(me,fe)=>{i("click",me,fe),ie(fe)},G=nhe(()=>{o.value&&(I=yk(o.value));const me=Q();E||Hr(me)||z(me)}),Q=()=>{if(!o.value)return;const me=yk(o.value),fe=[];for(const ce of Object.keys(S)){const pe=F0(ce);if(!pe)continue;const ye=_k(pe,o.value),De=C2(pe,ye);fe.push({top:De-s.offset-s.bound,href:ce})}fe.sort((ce,pe)=>ce.top-pe.top);for(let ce=0;ce<fe.length;ce++){const pe=fe[ce],ye=fe[ce+1];if(ce===0&&me===0)return"";if(pe.top<=me&&(!ye||ye.top>me))return pe.href}},oe=()=>{const me=F0(s.container);!me||i1(me)?o.value=window:o.value=me};qr(o,"scroll",G);const le=te(()=>{if(!g.value||!_.value||!d.value)return{};const me=S[d.value];if(!me)return{};const fe=g.value.getBoundingClientRect(),ce=_.value.getBoundingClientRect(),pe=me.getBoundingClientRect();return s.direction==="horizontal"?{left:`${pe.left-fe.left}px`,width:`${pe.width}px`,opacity:1}:{top:`${pe.top-fe.top+(pe.height-ce.height)/2}px`,opacity:1}});return No(()=>{oe();const me=decodeURIComponent(window.location.hash);F0(me)?ie(me):G()}),tn(()=>s.container,()=>{oe()}),or($4,{ns:P,direction:s.direction,currentAnchor:d,addLink:B,removeLink:$,handleClick:Z}),t({scrollTo:ie}),(me,fe)=>(se(),Pe("div",{ref_key:"anchorRef",ref:g,class:de(y(F))},[me.marker?(se(),Pe("div",{key:0,ref_key:"markerRef",ref:_,class:de(y(P).e("marker")),style:to(y(le))},null,6)):St("v-if",!0),He("div",{class:de(y(P).e("list"))},[_t(me.$slots,"default")],2)],2))}});var ihe=bn(rhe,[["__file","anchor.vue"]]);const ahe=vn({title:String,href:String}),she=Ze({name:"ElAnchorLink"}),lhe=Ze({...she,props:ahe,setup(e){const t=e,i=Se(null),{ns:s,direction:d,currentAnchor:g,addLink:_,removeLink:o,handleClick:S}=Un($4),E=te(()=>[s.e("link"),s.is("active",g.value===t.href)]),I=P=>{S(P,t.href)};return tn(()=>t.href,(P,F)=>{oo(()=>{F&&o(F),P&&_({href:P,el:i.value})})}),No(()=>{const{href:P}=t;P&&_({href:P,el:i.value})}),ni(()=>{const{href:P}=t;P&&o(P)}),(P,F)=>(se(),Pe("div",{class:de(y(s).e("item"))},[He("a",{ref_key:"linkRef",ref:i,class:de(y(E)),href:P.href,onClick:I},[_t(P.$slots,"default",{},()=>[nr(wn(P.title),1)])],10,["href"]),P.$slots["sub-link"]&&y(d)==="vertical"?(se(),Pe("div",{key:0,class:de(y(s).e("list"))},[_t(P.$slots,"sub-link")],2)):St("v-if",!0)],2))}});var V4=bn(lhe,[["__file","anchor-link.vue"]]);const che=Ao(ihe,{AnchorLink:V4}),uhe=Oi(V4),dhe=vn({direction:{type:ut(String),default:"horizontal"},options:{type:ut(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:ia,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...Da(["ariaLabel"])}),hhe={[Fo]:e=>Zn(e)||ao(e)||ai(e),[Yr]:e=>Zn(e)||ao(e)||ai(e)},fhe=Ze({name:"ElSegmented"}),phe=Ze({...fhe,props:dhe,emits:hhe,setup(e,{emit:t}){const i=e,s=rn("segmented"),d=La(),g=na(),_=Za(),{formItem:o}=Ka(),{inputId:S,isLabeledByFormItem:E}=ic(i,{formItemContext:o}),I=Se(null),P=HH(),F=Pr({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),B=fe=>{const ce=$(fe);t(Fo,ce),t(Yr,ce)},$=fe=>Vo(fe)?fe.value:fe,z=fe=>Vo(fe)?fe.label:fe,H=fe=>!!(_.value||Vo(fe)&&fe.disabled),U=fe=>i.modelValue===$(fe),ie=fe=>i.options.find(ce=>$(ce)===fe),Z=fe=>[s.e("item"),s.is("selected",U(fe)),s.is("disabled",H(fe))],G=()=>{if(!I.value)return;const fe=I.value.querySelector(".is-selected"),ce=I.value.querySelector(".is-selected input");if(!fe||!ce){F.width=0,F.height=0,F.translateX=0,F.translateY=0,F.focusVisible=!1;return}const pe=fe.getBoundingClientRect();F.isInit=!0,i.direction==="vertical"?(F.height=pe.height,F.translateY=fe.offsetTop):(F.width=pe.width,F.translateX=fe.offsetLeft);try{F.focusVisible=ce.matches(":focus-visible")}catch{}},Q=te(()=>[s.b(),s.m(g.value),s.is("block",i.block)]),oe=te(()=>({width:i.direction==="vertical"?"100%":`${F.width}px`,height:i.direction==="vertical"?`${F.height}px`:"100%",transform:i.direction==="vertical"?`translateY(${F.translateY}px)`:`translateX(${F.translateX}px)`,display:F.isInit?"block":"none"})),le=te(()=>[s.e("item-selected"),s.is("disabled",H(ie(i.modelValue))),s.is("focus-visible",F.focusVisible)]),me=te(()=>i.name||d.value);return Mi(I,G),tn(P,G),tn(()=>i.modelValue,()=>{var fe;G(),i.validateEvent&&((fe=o==null?void 0:o.validate)==null||fe.call(o,"change").catch(ce=>void 0))},{flush:"post"}),(fe,ce)=>fe.options.length?(se(),Pe("div",{key:0,id:y(S),ref_key:"segmentedRef",ref:I,class:de(y(Q)),role:"radiogroup","aria-label":y(E)?void 0:fe.ariaLabel||"segmented","aria-labelledby":y(E)?y(o).labelId:void 0},[He("div",{class:de([y(s).e("group"),y(s).m(i.direction)])},[He("div",{style:to(y(oe)),class:de(y(le))},null,6),(se(!0),Pe(eo,null,tr(fe.options,(pe,ye)=>(se(),Pe("label",{key:ye,class:de(Z(pe))},[He("input",{class:de(y(s).e("item-input")),type:"radio",name:y(me),disabled:H(pe),checked:U(pe),onChange:De=>B(pe)},null,42,["name","disabled","checked","onChange"]),He("div",{class:de(y(s).e("item-label"))},[_t(fe.$slots,"default",{item:pe},()=>[nr(wn(z(pe)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):St("v-if",!0)}});var mhe=bn(phe,[["__file","segmented.vue"]]);const ghe=Ao(mhe),vhe=(e,t)=>{const i=e.toLowerCase();return(t.label||t.value).toLowerCase().includes(i)},_he=(e,t,i)=>{const{selectionEnd:s}=e;if(s===null)return;const d=e.value,g=us(t);let _=-1,o;for(let S=s-1;S>=0;--S){const E=d[S];if(E===i||E===`
`||E==="\r"){_=S;continue}if(g.includes(E)){const I=_===-1?s:_;o={pattern:d.slice(S+1,I),start:S+1,end:I,prefix:E,prefixIndex:S,splitIndex:_,selectionEnd:s};break}}return o},yhe=(e,t={debug:!1,useSelectionEnd:!1})=>{const i=e.selectionStart!==null?e.selectionStart:0,s=e.selectionEnd!==null?e.selectionEnd:0,d=t.useSelectionEnd?s:i,g=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(t.debug){const F=document.querySelector("#input-textarea-caret-position-mirror-div");F!=null&&F.parentNode&&F.parentNode.removeChild(F)}const _=document.createElement("div");_.id="input-textarea-caret-position-mirror-div",document.body.appendChild(_);const o=_.style,S=window.getComputedStyle(e),E=e.nodeName==="INPUT";o.whiteSpace=E?"nowrap":"pre-wrap",E||(o.wordWrap="break-word"),o.position="absolute",t.debug||(o.visibility="hidden"),g.forEach(F=>{if(E&&F==="lineHeight")if(S.boxSizing==="border-box"){const B=Number.parseInt(S.height),$=Number.parseInt(S.paddingTop)+Number.parseInt(S.paddingBottom)+Number.parseInt(S.borderTopWidth)+Number.parseInt(S.borderBottomWidth),z=$+Number.parseInt(S.lineHeight);B>z?o.lineHeight=`${B-$}px`:B===z?o.lineHeight=S.lineHeight:o.lineHeight="0"}else o.lineHeight=S.height;else o[F]=S[F]}),d1()?e.scrollHeight>Number.parseInt(S.height)&&(o.overflowY="scroll"):o.overflow="hidden",_.textContent=e.value.slice(0,Math.max(0,d)),E&&_.textContent&&(_.textContent=_.textContent.replace(/\s/g,""));const I=document.createElement("span");I.textContent=e.value.slice(Math.max(0,d))||".",I.style.position="relative",I.style.left=`${-e.scrollLeft}px`,I.style.top=`${-e.scrollTop}px`,_.appendChild(I);const P={top:I.offsetTop+Number.parseInt(S.borderTopWidth),left:I.offsetLeft+Number.parseInt(S.borderLeftWidth),height:Number.parseInt(S.fontSize)*1.5};return t.debug?I.style.backgroundColor="#aaa":document.body.removeChild(_),P.left>=e.clientWidth&&(P.left=e.clientWidth),P},bhe=vn({...dT,options:{type:ut(Array),default:()=>[]},prefix:{type:ut([String,Array]),default:"@",validator:e=>Zn(e)?e.length===1:e.every(t=>Zn(t)&&t.length===1)},split:{type:String,default:" ",validator:e=>e.length===1},filterOption:{type:ut([Boolean,Function]),default:()=>vhe,validator:e=>e===!1?!0:Qn(e)},placement:{type:ut(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:ut(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})}}),xhe={[Fo]:e=>Zn(e),search:(e,t)=>Zn(e)&&Zn(t),select:(e,t)=>Zn(e.value)&&Zn(t),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},whe=vn({options:{type:ut(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),She={select:e=>Zn(e.value)},The=Ze({name:"ElMentionDropdown"}),Che=Ze({...The,props:whe,emits:She,setup(e,{expose:t,emit:i}){const s=e,d=rn("mention"),{t:g}=vr(),_=Se(-1),o=Se(),S=Se(),E=Se(),I=(Z,G)=>[d.be("dropdown","item"),d.is("hovering",_.value===G),d.is("disabled",Z.disabled||s.disabled)],P=Z=>{Z.disabled||s.disabled||i("select",Z)},F=Z=>{_.value=Z},B=te(()=>s.disabled||s.options.every(Z=>Z.disabled)),$=te(()=>s.options[_.value]),z=()=>{$.value&&i("select",$.value)},H=Z=>{const{options:G}=s;if(G.length===0||B.value)return;Z==="next"?(_.value++,_.value===G.length&&(_.value=0)):Z==="prev"&&(_.value--,_.value<0&&(_.value=G.length-1));const Q=G[_.value];if(Q.disabled){H(Z);return}oo(()=>U(Q))},U=Z=>{var G,Q,oe,le;const{options:me}=s,fe=me.findIndex(pe=>pe.value===Z.value),ce=(G=S.value)==null?void 0:G[fe];if(ce){const pe=(oe=(Q=E.value)==null?void 0:Q.querySelector)==null?void 0:oe.call(Q,`.${d.be("dropdown","wrap")}`);pe&&rT(pe,ce)}(le=o.value)==null||le.handleScroll()};return tn(()=>s.options,()=>{B.value||s.options.length===0?_.value=-1:_.value=0},{immediate:!0}),t({hoveringIndex:_,navigateOptions:H,selectHoverOption:z,hoverOption:$}),(Z,G)=>(se(),Pe("div",{ref_key:"dropdownRef",ref:E,class:de(y(d).b("dropdown"))},[Z.$slots.header?(se(),Pe("div",{key:0,class:de(y(d).be("dropdown","header"))},[_t(Z.$slots,"header")],2)):St("v-if",!0),zo(Qe(y(Pu),{id:Z.contentId,ref_key:"scrollbarRef",ref:o,tag:"ul","wrap-class":y(d).be("dropdown","wrap"),"view-class":y(d).be("dropdown","list"),role:"listbox","aria-label":Z.ariaLabel,"aria-orientation":"vertical"},{default:at(()=>[(se(!0),Pe(eo,null,tr(Z.options,(Q,oe)=>(se(),Pe("li",{id:`${Z.contentId}-${oe}`,ref_for:!0,ref_key:"optionRefs",ref:S,key:oe,class:de(I(Q,oe)),role:"option","aria-disabled":Q.disabled||Z.disabled||void 0,"aria-selected":_.value===oe,onMousemove:le=>F(oe),onClick:po(le=>P(Q),["stop"])},[_t(Z.$slots,"label",{item:Q,index:oe},()=>{var le;return[He("span",null,wn((le=Q.label)!=null?le:Q.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[Cr,Z.options.length>0&&!Z.loading]]),Z.loading?(se(),Pe("div",{key:1,class:de(y(d).be("dropdown","loading"))},[_t(Z.$slots,"loading",{},()=>[nr(wn(y(g)("el.mention.loading")),1)])],2)):St("v-if",!0),Z.$slots.footer?(se(),Pe("div",{key:2,class:de(y(d).be("dropdown","footer"))},[_t(Z.$slots,"footer")],2)):St("v-if",!0)],2))}});var Ehe=bn(Che,[["__file","mention-dropdown.vue"]]);const Mhe=Ze({name:"ElMention",inheritAttrs:!1}),Ihe=Ze({...Mhe,props:bhe,emits:xhe,setup(e,{expose:t,emit:i}){const s=e,d=te(()=>Uc(s,Object.keys(dT))),g=rn("mention"),_=Za(),o=La(),S=Se(),E=Se(),I=Se(),P=Se(!1),F=Se(),B=Se(),$=te(()=>s.showArrow?s.placement:`${s.placement}-start`),z=te(()=>s.showArrow?["bottom","top"]:["bottom-start","top-start"]),H=te(()=>{const{filterOption:ye,options:De}=s;return!B.value||!ye?De:De.filter(tt=>ye(B.value.pattern,tt))}),U=te(()=>P.value&&(!!H.value.length||s.loading)),ie=te(()=>{var ye;return`${o.value}-${(ye=I.value)==null?void 0:ye.hoveringIndex}`}),Z=ye=>{i("update:modelValue",ye),fe()},G=ye=>{var De,tt,Me,xe;if(!(!("code"in ye)||(De=S.value)!=null&&De.isComposing))switch(ye.code){case On.left:case On.right:fe();break;case On.up:case On.down:if(!P.value)return;ye.preventDefault(),(tt=I.value)==null||tt.navigateOptions(ye.code===On.up?"prev":"next");break;case On.enter:case On.numpadEnter:if(!P.value)return;ye.preventDefault(),(Me=I.value)!=null&&Me.hoverOption?(xe=I.value)==null||xe.selectHoverOption():P.value=!1;break;case On.esc:if(!P.value)return;ye.preventDefault(),P.value=!1;break;case On.backspace:if(s.whole&&B.value){const{splitIndex:Ae,selectionEnd:Ce,pattern:ge,prefixIndex:Ne,prefix:We}=B.value,ot=me();if(!ot)return;const Oe=ot.value,Ct=s.options.find(zt=>zt.value===ge);if((Qn(s.checkIsWhole)?s.checkIsWhole(ge,We):Ct)&&Ae!==-1&&Ae+1===Ce){ye.preventDefault();const zt=Oe.slice(0,Ne)+Oe.slice(Ae+1);i(Fo,zt);const bt=Ne;oo(()=>{ot.selectionStart=bt,ot.selectionEnd=bt,pe()})}}}},{wrapperRef:Q}=Ah(S,{beforeFocus(){return _.value},afterFocus(){fe()},beforeBlur(ye){var De;return(De=E.value)==null?void 0:De.isFocusInsideContent(ye)},afterBlur(){P.value=!1}}),oe=()=>{fe()},le=ye=>{if(!B.value)return;const De=me();if(!De)return;const tt=De.value,{split:Me}=s,xe=tt.slice(B.value.end),Ae=xe.startsWith(Me),Ce=`${ye.value}${Ae?"":Me}`,ge=tt.slice(0,B.value.start)+Ce+xe;i(Fo,ge),i("select",ye,B.value.prefix);const Ne=B.value.start+Ce.length+(Ae?1:0);oo(()=>{De.selectionStart=Ne,De.selectionEnd=Ne,De.focus(),pe()})},me=()=>{var ye,De;return s.type==="textarea"?(ye=S.value)==null?void 0:ye.textarea:(De=S.value)==null?void 0:De.input},fe=()=>{setTimeout(()=>{ce(),pe(),oo(()=>{var ye;return(ye=E.value)==null?void 0:ye.updatePopper()})},0)},ce=()=>{const ye=me();if(!ye)return;const De=yhe(ye),tt=ye.getBoundingClientRect(),Me=S.value.$el.getBoundingClientRect();F.value={position:"absolute",width:0,height:`${De.height}px`,left:`${De.left+tt.left-Me.left}px`,top:`${De.top+tt.top-Me.top}px`}},pe=()=>{const ye=me();if(document.activeElement!==ye){P.value=!1;return}const{prefix:De,split:tt}=s;if(B.value=_he(ye,De,tt),B.value&&B.value.splitIndex===-1){P.value=!0,i("search",B.value.pattern,B.value.prefix);return}P.value=!1};return t({input:S,tooltip:E,dropdownVisible:U}),(ye,De)=>(se(),Pe("div",{ref_key:"wrapperRef",ref:Q,class:de(y(g).b())},[Qe(y(hs),Yo(Yo(y(d),ye.$attrs),{ref_key:"elInputRef",ref:S,"model-value":ye.modelValue,disabled:y(_),role:y(U)?"combobox":void 0,"aria-activedescendant":y(U)?y(ie)||"":void 0,"aria-controls":y(U)?y(o):void 0,"aria-expanded":y(U)||void 0,"aria-label":ye.ariaLabel,"aria-autocomplete":y(U)?"none":void 0,"aria-haspopup":y(U)?"listbox":void 0,onInput:Z,onKeydown:G,onMousedown:oe}),ec({_:2},[tr(ye.$slots,(tt,Me)=>({name:Me,fn:at(xe=>[_t(ye.$slots,Me,Vc(mh(xe)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),Qe(y(qa),{ref_key:"tooltipRef",ref:E,visible:y(U),"popper-class":[y(g).e("popper"),ye.popperClass],"popper-options":ye.popperOptions,placement:y($),"fallback-placements":y(z),effect:"light",pure:"",offset:ye.offset,"show-arrow":ye.showArrow},{default:at(()=>[He("div",{style:to(F.value)},null,4)]),content:at(()=>{var tt;return[Qe(Ehe,{ref_key:"dropdownRef",ref:I,options:y(H),disabled:y(_),loading:ye.loading,"content-id":y(o),"aria-label":ye.ariaLabel,onSelect:le,onClick:po((tt=S.value)==null?void 0:tt.focus,["stop"])},ec({_:2},[tr(ye.$slots,(Me,xe)=>({name:xe,fn:at(Ae=>[_t(ye.$slots,xe,Vc(mh(Ae)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var Ahe=bn(Ihe,[["__file","mention.vue"]]);const khe=Ao(Ahe);var Phe=[EG,WW,$7,hle,W7,Q7,kL,dK,hK,Ta,FL,nZ,sZ,TZ,CZ,CY,iD,PY,rc,NZ,YL,zY,JY,QY,m1,CX,IX,$X,VX,UX,jX,HX,tQ,dQ,hQ,TQ,BD,LQ,See,Tee,Cee,qD,Tte,Cte,Gn,zte,YD,hs,XD,Jte,rne,Tne,Cne,Ene,Mne,One,Toe,koe,Noe,EL,az,oD,JZ,XZ,Zoe,ere,sre,Pu,Vf,Tb,roe,$re,Zre,Yre,mie,bie,yz,Pie,$ie,Vie,qie,nse,ose,dle,Mle,Ile,Em,Ole,xJ,Nle,Hle,Gle,qa,Qce,hue,zb,Pue,Kue,vde,Mde,Jde,Qde,che,uhe,ghe,khe];const Zl="ElInfiniteScroll",Rhe=50,Ohe=200,Lhe=0,Dhe={delay:{type:Number,default:Ohe},distance:{type:Number,default:Lhe},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},xC=(e,t)=>Object.entries(Dhe).reduce((i,[s,d])=>{var g,_;const{type:o,default:S}=d,E=e.getAttribute(`infinite-scroll-${s}`);let I=(_=(g=t[E])!=null?g:E)!=null?_:S;return I=I==="false"?!1:I,I=o(I),i[s]=Number.isNaN(I)?S:I,i},{}),U4=e=>{const{observer:t}=e[Zl];t&&(t.disconnect(),delete e[Zl].observer)},zhe=(e,t)=>{const{container:i,containerEl:s,instance:d,observer:g,lastScrollTop:_}=e[Zl],{disabled:o,distance:S}=xC(e,d),{clientHeight:E,scrollHeight:I,scrollTop:P}=s,F=P-_;if(e[Zl].lastScrollTop=P,g||o||F<0)return;let B=!1;if(i===e)B=I-(E+P)<=S;else{const{clientTop:$,scrollHeight:z}=e,H=C2(e,s);B=P+E>=H+$+z-S}B&&t.call(d)};function Ww(e,t){const{containerEl:i,instance:s}=e[Zl],{disabled:d}=xC(e,s);d||i.clientHeight===0||(i.scrollHeight<=i.clientHeight?t.call(s):U4(e))}const Fhe={async mounted(e,t){const{instance:i,value:s}=t;Qn(s)||ha(Zl,"'v-infinite-scroll' binding value must be a function"),await oo();const{delay:d,immediate:g}=xC(e,i),_=oT(e,!0),o=_===window?document.documentElement:_,S=Pf(zhe.bind(null,e,s),d);if(_){if(e[Zl]={instance:i,container:_,containerEl:o,delay:d,cb:s,onScroll:S,lastScrollTop:o.scrollTop},g){const E=new MutationObserver(Pf(Ww.bind(null,e,s),Rhe));e[Zl].observer=E,E.observe(e,{childList:!0,subtree:!0}),Ww(e,s)}_.addEventListener("scroll",S)}},unmounted(e){if(!e[Zl])return;const{container:t,onScroll:i}=e[Zl];t==null||t.removeEventListener("scroll",i),U4(e)},async updated(e){if(!e[Zl])await oo();else{const{containerEl:t,cb:i,observer:s}=e[Zl];t.clientHeight&&s&&Ww(e,i)}}},pS=Fhe;pS.install=e=>{e.directive("InfiniteScroll",pS)};const Bhe=pS;function Nhe(e){let t;const i=Se(!1),s=Pr({...e,originalPosition:"",originalOverflow:"",visible:!1});function d(F){s.text=F}function g(){const F=s.parent,B=P.ns;if(!F.vLoadingAddClassList){let $=F.getAttribute("loading-number");$=Number.parseInt($)-1,$?F.setAttribute("loading-number",$.toString()):(fs(F,B.bm("parent","relative")),F.removeAttribute("loading-number")),fs(F,B.bm("parent","hidden"))}_(),I.unmount()}function _(){var F,B;(B=(F=P.$el)==null?void 0:F.parentNode)==null||B.removeChild(P.$el)}function o(){var F;e.beforeClose&&!e.beforeClose()||(i.value=!0,clearTimeout(t),t=setTimeout(S,400),s.visible=!1,(F=e.closed)==null||F.call(e))}function S(){if(!i.value)return;const F=s.parent;i.value=!1,F.vLoadingAddClassList=void 0,g()}const I=$R(Ze({name:"ElLoading",setup(F,{expose:B}){const{ns:$,zIndex:z}=l1("loading");return B({ns:$,zIndex:z}),()=>{const H=s.spinner||s.svg,U=lo("svg",{class:"circular",viewBox:s.svgViewBox?s.svgViewBox:"0 0 50 50",...H?{innerHTML:H}:{}},[lo("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),ie=s.text?lo("p",{class:$.b("text")},[s.text]):void 0;return lo(Ea,{name:$.b("fade"),onAfterLeave:S},{default:at(()=>[zo(Qe("div",{style:{backgroundColor:s.background||""},class:[$.b("mask"),s.customClass,s.fullscreen?"is-fullscreen":""]},[lo("div",{class:$.b("spinner")},[U,ie])]),[[Cr,s.visible]])])})}}})),P=I.mount(document.createElement("div"));return{...Ca(s),setText:d,removeElLoadingChild:_,close:o,handleAfterLeave:S,vm:P,get $el(){return P.$el}}}let B0;const mS=function(e={}){if(!gr)return;const t=$he(e);if(t.fullscreen&&B0)return B0;const i=Nhe({...t,closed:()=>{var d;(d=t.closed)==null||d.call(t),t.fullscreen&&(B0=void 0)}});Vhe(t,t.parent,i),c3(t,t.parent,i),t.parent.vLoadingAddClassList=()=>c3(t,t.parent,i);let s=t.parent.getAttribute("loading-number");return s?s=`${Number.parseInt(s)+1}`:s="1",t.parent.setAttribute("loading-number",s),t.parent.appendChild(i.$el),oo(()=>i.visible.value=t.visible),t.fullscreen&&(B0=i),i},$he=e=>{var t,i,s,d;let g;return Zn(e.target)?g=(t=document.querySelector(e.target))!=null?t:document.body:g=e.target||document.body,{parent:g===document.body||e.body?document.body:g,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:g===document.body&&((i=e.fullscreen)!=null?i:!0),lock:(s=e.lock)!=null?s:!1,customClass:e.customClass||"",visible:(d=e.visible)!=null?d:!0,beforeClose:e.beforeClose,closed:e.closed,target:g}},Vhe=async(e,t,i)=>{const{nextZIndex:s}=i.vm.zIndex||i.vm._.exposed.zIndex,d={};if(e.fullscreen)i.originalPosition.value=Ju(document.body,"position"),i.originalOverflow.value=Ju(document.body,"overflow"),d.zIndex=s();else if(e.parent===document.body){i.originalPosition.value=Ju(document.body,"position"),await oo();for(const g of["top","left"]){const _=g==="top"?"scrollTop":"scrollLeft";d[g]=`${e.target.getBoundingClientRect()[g]+document.body[_]+document.documentElement[_]-Number.parseInt(Ju(document.body,`margin-${g}`),10)}px`}for(const g of["height","width"])d[g]=`${e.target.getBoundingClientRect()[g]}px`}else i.originalPosition.value=Ju(t,"position");for(const[g,_]of Object.entries(d))i.$el.style[g]=_},c3=(e,t,i)=>{const s=i.vm.ns||i.vm._.exposed.ns;["absolute","fixed","sticky"].includes(i.originalPosition.value)?fs(t,s.bm("parent","relative")):Yl(t,s.bm("parent","relative")),e.fullscreen&&e.lock?Yl(t,s.bm("parent","hidden")):fs(t,s.bm("parent","hidden"))},ib=Symbol("ElLoading"),u3=(e,t)=>{var i,s,d,g;const _=t.instance,o=F=>Vo(t.value)?t.value[F]:void 0,S=F=>{const B=Zn(F)&&(_==null?void 0:_[F])||F;return B&&Se(B)},E=F=>S(o(F)||e.getAttribute(`element-loading-${id(F)}`)),I=(i=o("fullscreen"))!=null?i:t.modifiers.fullscreen,P={text:E("text"),svg:E("svg"),svgViewBox:E("svgViewBox"),spinner:E("spinner"),background:E("background"),customClass:E("customClass"),fullscreen:I,target:(s=o("target"))!=null?s:I?void 0:e,body:(d=o("body"))!=null?d:t.modifiers.body,lock:(g=o("lock"))!=null?g:t.modifiers.lock};e[ib]={options:P,instance:mS(P)}},Uhe=(e,t)=>{for(const i of Object.keys(t))vi(t[i])&&(t[i].value=e[i])},d3={mounted(e,t){t.value&&u3(e,t)},updated(e,t){const i=e[ib];t.oldValue!==t.value&&(t.value&&!t.oldValue?u3(e,t):t.value&&t.oldValue?Vo(t.value)&&Uhe(t.value,i.options):i==null||i.instance.close())},unmounted(e){var t;(t=e[ib])==null||t.instance.close(),e[ib]=null}},jhe={install(e){e.directive("loading",d3),e.config.globalProperties.$loading=mS},directive:d3,service:mS},j4=["success","info","warning","error"],ss=Ri({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:gr?document.body:void 0}),Hhe=vn({customClass:{type:String,default:ss.customClass},center:{type:Boolean,default:ss.center},dangerouslyUseHTMLString:{type:Boolean,default:ss.dangerouslyUseHTMLString},duration:{type:Number,default:ss.duration},icon:{type:Xr,default:ss.icon},id:{type:String,default:ss.id},message:{type:ut([String,Object,Function]),default:ss.message},onClose:{type:ut(Function),default:ss.onClose},showClose:{type:Boolean,default:ss.showClose},type:{type:String,values:j4,default:ss.type},plain:{type:Boolean,default:ss.plain},offset:{type:Number,default:ss.offset},zIndex:{type:Number,default:ss.zIndex},grouping:{type:Boolean,default:ss.grouping},repeatNum:{type:Number,default:ss.repeatNum}}),Ghe={destroy:()=>!0},jc=z3([]),Whe=e=>{const t=jc.findIndex(d=>d.id===e),i=jc[t];let s;return t>0&&(s=jc[t-1]),{current:i,prev:s}},qhe=e=>{const{prev:t}=Whe(e);return t?t.vm.exposed.bottom.value:0},Khe=(e,t)=>jc.findIndex(s=>s.id===e)>0?16:t,Zhe=Ze({name:"ElMessage"}),Yhe=Ze({...Zhe,props:Hhe,emits:Ghe,setup(e,{expose:t}){const i=e,{Close:s}=uT,{ns:d,zIndex:g}=l1("message"),{currentZIndex:_,nextZIndex:o}=g,S=Se(),E=Se(!1),I=Se(0);let P;const F=te(()=>i.type?i.type==="error"?"danger":i.type:"info"),B=te(()=>{const le=i.type;return{[d.bm("icon",le)]:le&&wh[le]}}),$=te(()=>i.icon||wh[i.type]||""),z=te(()=>qhe(i.id)),H=te(()=>Khe(i.id,i.offset)+z.value),U=te(()=>I.value+H.value),ie=te(()=>({top:`${H.value}px`,zIndex:_.value}));function Z(){i.duration!==0&&({stop:P}=Nf(()=>{Q()},i.duration))}function G(){P==null||P()}function Q(){E.value=!1}function oe({code:le}){le===On.esc&&Q()}return No(()=>{Z(),o(),E.value=!0}),tn(()=>i.repeatNum,()=>{G(),Z()}),qr(document,"keydown",oe),Mi(S,()=>{I.value=S.value.getBoundingClientRect().height}),t({visible:E,bottom:U,close:Q}),(le,me)=>(se(),Rt(Ea,{name:y(d).b("fade"),onBeforeLeave:le.onClose,onAfterLeave:fe=>le.$emit("destroy"),persisted:""},{default:at(()=>[zo(He("div",{id:le.id,ref_key:"messageRef",ref:S,class:de([y(d).b(),{[y(d).m(le.type)]:le.type},y(d).is("center",le.center),y(d).is("closable",le.showClose),y(d).is("plain",le.plain),le.customClass]),style:to(y(ie)),role:"alert",onMouseenter:G,onMouseleave:Z},[le.repeatNum>1?(se(),Rt(y(kL),{key:0,value:le.repeatNum,type:y(F),class:de(y(d).e("badge"))},null,8,["value","type","class"])):St("v-if",!0),y($)?(se(),Rt(y(Gn),{key:1,class:de([y(d).e("icon"),y(B)])},{default:at(()=>[(se(),Rt(Wo(y($))))]),_:1},8,["class"])):St("v-if",!0),_t(le.$slots,"default",{},()=>[le.dangerouslyUseHTMLString?(se(),Pe(eo,{key:1},[St(" Caution here, message could've been compromised, never use user's input as message "),He("p",{class:de(y(d).e("content")),innerHTML:le.message},null,10,["innerHTML"])],2112)):(se(),Pe("p",{key:0,class:de(y(d).e("content"))},wn(le.message),3))]),le.showClose?(se(),Rt(y(Gn),{key:2,class:de(y(d).e("closeBtn")),onClick:po(Q,["stop"])},{default:at(()=>[Qe(y(s))]),_:1},8,["class","onClick"])):St("v-if",!0)],46,["id"]),[[Cr,E.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var Xhe=bn(Yhe,[["__file","message.vue"]]);let Jhe=1;const H4=e=>{const t=!e||Zn(e)||Ai(e)||Qn(e)?{message:e}:e,i={...ss,...t};if(!i.appendTo)i.appendTo=document.body;else if(Zn(i.appendTo)){let s=document.querySelector(i.appendTo);Tl(s)||(s=document.body),i.appendTo=s}return ai(Nc.grouping)&&!i.grouping&&(i.grouping=Nc.grouping),ao(Nc.duration)&&i.duration===3e3&&(i.duration=Nc.duration),ao(Nc.offset)&&i.offset===16&&(i.offset=Nc.offset),ai(Nc.showClose)&&!i.showClose&&(i.showClose=Nc.showClose),i},Qhe=e=>{const t=jc.indexOf(e);if(t===-1)return;jc.splice(t,1);const{handler:i}=e;i.close()},efe=({appendTo:e,...t},i)=>{const s=`message_${Jhe++}`,d=t.onClose,g=document.createElement("div"),_={...t,id:s,onClose:()=>{d==null||d(),Qhe(I)},onDestroy:()=>{gh(null,g)}},o=Qe(Xhe,_,Qn(_.message)||Ai(_.message)?{default:Qn(_.message)?_.message:()=>_.message}:null);o.appContext=i||Om._context,gh(o,g),e.appendChild(g.firstElementChild);const S=o.component,I={id:s,vnode:o,vm:S,handler:{close:()=>{S.exposed.visible.value=!1}},props:o.component.props};return I},Om=(e={},t)=>{if(!gr)return{close:()=>{}};const i=H4(e);if(i.grouping&&jc.length){const d=jc.find(({vnode:g})=>{var _;return((_=g.props)==null?void 0:_.message)===i.message});if(d)return d.props.repeatNum+=1,d.props.type=i.type,d.handler}if(ao(Nc.max)&&jc.length>=Nc.max)return{close:()=>{}};const s=efe(i,t);return jc.push(s),s.handler};j4.forEach(e=>{Om[e]=(t={},i)=>{const s=H4(t);return Om({...s,type:e},i)}});function tfe(e){for(const t of jc)(!e||e===t.props.type)&&t.handler.close()}Om.closeAll=tfe;Om._context=null;const nfe=YO(Om,"$message"),gS="_trap-focus-children",Af=[],h3=e=>{if(Af.length===0)return;const t=Af[Af.length-1][gS];if(t.length>0&&e.code===On.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const i=e.shiftKey,s=e.target===t[0],d=e.target===t[t.length-1];s&&i&&(e.preventDefault(),t[t.length-1].focus()),d&&!i&&(e.preventDefault(),t[0].focus())}},ofe={beforeMount(e){e[gS]=Tk(e),Af.push(e),Af.length<=1&&document.addEventListener("keydown",h3)},updated(e){oo(()=>{e[gS]=Tk(e)})},unmounted(){Af.shift(),Af.length===0&&document.removeEventListener("keydown",h3)}},rfe=Ze({name:"ElMessageBox",directives:{TrapFocus:ofe},components:{ElButton:Ta,ElFocusTrap:jm,ElInput:hs,ElOverlay:NT,ElIcon:Gn,...uT},inheritAttrs:!1,props:{buttonSize:{type:String,validator:xz},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:i,zIndex:s,ns:d,size:g}=l1("message-box",te(()=>e.buttonSize)),{t:_}=i,{nextZIndex:o}=s,S=Se(!1),E=Pr({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:uh(Cu),cancelButtonLoadingIcon:uh(Cu),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:o()}),I=te(()=>{const xe=E.type;return{[d.bm("icon",xe)]:xe&&wh[xe]}}),P=La(),F=La(),B=te(()=>E.icon||wh[E.type]||""),$=te(()=>!!E.message),z=Se(),H=Se(),U=Se(),ie=Se(),Z=Se(),G=te(()=>E.confirmButtonClass);tn(()=>E.inputValue,async xe=>{await oo(),e.boxType==="prompt"&&xe!==null&&ye()},{immediate:!0}),tn(()=>S.value,xe=>{var Ae,Ce;xe&&(e.boxType!=="prompt"&&(E.autofocus?U.value=(Ce=(Ae=Z.value)==null?void 0:Ae.$el)!=null?Ce:z.value:U.value=z.value),E.zIndex=o()),e.boxType==="prompt"&&(xe?oo().then(()=>{var ge;ie.value&&ie.value.$el&&(E.autofocus?U.value=(ge=De())!=null?ge:z.value:U.value=z.value)}):(E.editorErrorMessage="",E.validateError=!1))});const Q=te(()=>e.draggable),oe=te(()=>e.overflow);LD(z,H,Q,oe),No(async()=>{await oo(),e.closeOnHashChange&&window.addEventListener("hashchange",le)}),ni(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",le)});function le(){S.value&&(S.value=!1,oo(()=>{E.action&&t("action",E.action)}))}const me=()=>{e.closeOnClickModal&&pe(E.distinguishCancelAndClose?"close":"cancel")},fe=BT(me),ce=xe=>{if(E.inputType!=="textarea")return xe.preventDefault(),pe("confirm")},pe=xe=>{var Ae;e.boxType==="prompt"&&xe==="confirm"&&!ye()||(E.action=xe,E.beforeClose?(Ae=E.beforeClose)==null||Ae.call(E,xe,E,le):le())},ye=()=>{if(e.boxType==="prompt"){const xe=E.inputPattern;if(xe&&!xe.test(E.inputValue||""))return E.editorErrorMessage=E.inputErrorMessage||_("el.messagebox.error"),E.validateError=!0,!1;const Ae=E.inputValidator;if(Qn(Ae)){const Ce=Ae(E.inputValue);if(Ce===!1)return E.editorErrorMessage=E.inputErrorMessage||_("el.messagebox.error"),E.validateError=!0,!1;if(Zn(Ce))return E.editorErrorMessage=Ce,E.validateError=!0,!1}}return E.editorErrorMessage="",E.validateError=!1,!0},De=()=>{const xe=ie.value.$refs;return xe.input||xe.textarea},tt=()=>{pe("close")},Me=()=>{e.closeOnPressEscape&&tt()};return e.lockScroll&&$T(S),{...Ca(E),ns:d,overlayEvent:fe,visible:S,hasMessage:$,typeClass:I,contentId:P,inputId:F,btnSize:g,iconComponent:B,confirmButtonClasses:G,rootRef:z,focusStartRef:U,headerRef:H,inputRef:ie,confirmRef:Z,doClose:le,handleClose:tt,onCloseRequested:Me,handleWrapperClick:me,handleInputEnter:ce,handleAction:pe,t:_}}});function ife(e,t,i,s,d,g){const _=Go("el-icon"),o=Go("close"),S=Go("el-input"),E=Go("el-button"),I=Go("el-focus-trap"),P=Go("el-overlay");return se(),Rt(Ea,{name:"fade-in-linear",onAfterLeave:F=>e.$emit("vanish"),persisted:""},{default:at(()=>[zo(Qe(P,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:at(()=>[He("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:de(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[Qe(I,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:at(()=>[He("div",{ref:"rootRef",class:de([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:to(e.customStyle),tabindex:"-1",onClick:po(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(se(),Pe("div",{key:0,ref:"headerRef",class:de([e.ns.e("header"),{"show-close":e.showClose}])},[He("div",{class:de(e.ns.e("title"))},[e.iconComponent&&e.center?(se(),Rt(_,{key:0,class:de([e.ns.e("status"),e.typeClass])},{default:at(()=>[(se(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])):St("v-if",!0),He("span",null,wn(e.title),1)],2),e.showClose?(se(),Pe("button",{key:0,type:"button",class:de(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:F=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:ti(po(F=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[Qe(_,{class:de(e.ns.e("close"))},{default:at(()=>[Qe(o)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):St("v-if",!0)],2)):St("v-if",!0),He("div",{id:e.contentId,class:de(e.ns.e("content"))},[He("div",{class:de(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(se(),Rt(_,{key:0,class:de([e.ns.e("status"),e.typeClass])},{default:at(()=>[(se(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])):St("v-if",!0),e.hasMessage?(se(),Pe("div",{key:1,class:de(e.ns.e("message"))},[_t(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(se(),Rt(Wo(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(se(),Rt(Wo(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:at(()=>[nr(wn(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):St("v-if",!0)],2),zo(He("div",{class:de(e.ns.e("input"))},[Qe(S,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":F=>e.inputValue=F,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:de({invalid:e.validateError}),onKeydown:ti(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),He("div",{class:de(e.ns.e("errormsg")),style:to({visibility:e.editorErrorMessage?"visible":"hidden"})},wn(e.editorErrorMessage),7)],2),[[Cr,e.showInput]])],10,["id"]),He("div",{class:de(e.ns.e("btns"))},[e.showCancelButton?(se(),Rt(E,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:de([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:F=>e.handleAction("cancel"),onKeydown:ti(po(F=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:at(()=>[nr(wn(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):St("v-if",!0),zo(Qe(E,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:de([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:F=>e.handleAction("confirm"),onKeydown:ti(po(F=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:at(()=>[nr(wn(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[Cr,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[Cr,e.visible]])]),_:3},8,["onAfterLeave"])}var afe=bn(rfe,[["render",ife],["__file","index.vue"]]);const C_=new Map,sfe=e=>{let t=document.body;return e.appendTo&&(Zn(e.appendTo)&&(t=document.querySelector(e.appendTo)),Tl(e.appendTo)&&(t=e.appendTo),Tl(t)||(t=document.body)),t},lfe=(e,t,i=null)=>{const s=Qe(afe,e,Qn(e.message)||Ai(e.message)?{default:Qn(e.message)?e.message:()=>e.message}:null);return s.appContext=i,gh(s,t),sfe(e).appendChild(t.firstElementChild),s.component},cfe=()=>document.createElement("div"),ufe=(e,t)=>{const i=cfe();e.onVanish=()=>{gh(null,i),C_.delete(d)},e.onAction=g=>{const _=C_.get(d);let o;e.showInput?o={value:d.inputValue,action:g}:o=g,e.callback?e.callback(o,s.proxy):g==="cancel"||g==="close"?e.distinguishCancelAndClose&&g!=="cancel"?_.reject("close"):_.reject("cancel"):_.resolve(o)};const s=lfe(e,i,t),d=s.proxy;for(const g in e)Tr(e,g)&&!Tr(d.$props,g)&&(d[g]=e[g]);return d.visible=!0,d};function Km(e,t=null){if(!gr)return Promise.reject();let i;return Zn(e)||Ai(e)?e={message:e}:i=e.callback,new Promise((s,d)=>{const g=ufe(e,t??Km._context);C_.set(g,{options:e,callback:i,resolve:s,reject:d})})}const dfe=["alert","confirm","prompt"],hfe={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};dfe.forEach(e=>{Km[e]=ffe(e)});function ffe(e){return(t,i,s,d)=>{let g="";return Vo(i)?(s=i,g=""):Hr(i)?g="":g=i,Km(Object.assign({title:g,message:t,type:"",...hfe[e]},s,{boxType:e}),d)}}Km.close=()=>{C_.forEach((e,t)=>{t.doClose()}),C_.clear()};Km._context=null;const nh=Km;nh.install=e=>{nh._context=e._context,e.config.globalProperties.$msgbox=nh,e.config.globalProperties.$messageBox=nh,e.config.globalProperties.$alert=nh.alert,e.config.globalProperties.$confirm=nh.confirm,e.config.globalProperties.$prompt=nh.prompt};const pfe=nh,G4=["success","info","warning","error"],mfe=vn({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:Xr},id:{type:String,default:""},message:{type:ut([String,Object,Function]),default:""},offset:{type:Number,default:0},onClick:{type:ut(Function),default:()=>{}},onClose:{type:ut(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...G4,""],default:""},zIndex:Number}),gfe={destroy:()=>!0},vfe=Ze({name:"ElNotification"}),_fe=Ze({...vfe,props:mfe,emits:gfe,setup(e,{expose:t}){const i=e,{ns:s,zIndex:d}=l1("notification"),{nextZIndex:g,currentZIndex:_}=d,{Close:o}=cT,S=Se(!1);let E;const I=te(()=>{const Z=i.type;return Z&&wh[i.type]?s.m(Z):""}),P=te(()=>i.type&&wh[i.type]||i.icon),F=te(()=>i.position.endsWith("right")?"right":"left"),B=te(()=>i.position.startsWith("top")?"top":"bottom"),$=te(()=>{var Z;return{[B.value]:`${i.offset}px`,zIndex:(Z=i.zIndex)!=null?Z:_.value}});function z(){i.duration>0&&({stop:E}=Nf(()=>{S.value&&U()},i.duration))}function H(){E==null||E()}function U(){S.value=!1}function ie({code:Z}){Z===On.delete||Z===On.backspace?H():Z===On.esc?S.value&&U():z()}return No(()=>{z(),g(),S.value=!0}),qr(document,"keydown",ie),t({visible:S,close:U}),(Z,G)=>(se(),Rt(Ea,{name:y(s).b("fade"),onBeforeLeave:Z.onClose,onAfterLeave:Q=>Z.$emit("destroy"),persisted:""},{default:at(()=>[zo(He("div",{id:Z.id,class:de([y(s).b(),Z.customClass,y(F)]),style:to(y($)),role:"alert",onMouseenter:H,onMouseleave:z,onClick:Z.onClick},[y(P)?(se(),Rt(y(Gn),{key:0,class:de([y(s).e("icon"),y(I)])},{default:at(()=>[(se(),Rt(Wo(y(P))))]),_:1},8,["class"])):St("v-if",!0),He("div",{class:de(y(s).e("group"))},[He("h2",{class:de(y(s).e("title")),textContent:wn(Z.title)},null,10,["textContent"]),zo(He("div",{class:de(y(s).e("content")),style:to(Z.title?void 0:{margin:0})},[_t(Z.$slots,"default",{},()=>[Z.dangerouslyUseHTMLString?(se(),Pe(eo,{key:1},[St(" Caution here, message could've been compromised, never use user's input as message "),He("p",{innerHTML:Z.message},null,8,["innerHTML"])],2112)):(se(),Pe("p",{key:0},wn(Z.message),1))])],6),[[Cr,Z.message]]),Z.showClose?(se(),Rt(y(Gn),{key:0,class:de(y(s).e("closeBtn")),onClick:po(U,["stop"])},{default:at(()=>[Qe(y(o))]),_:1},8,["class","onClick"])):St("v-if",!0)],2)],46,["id","onClick"]),[[Cr,S.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var yfe=bn(_fe,[["__file","notification.vue"]]);const Fb={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},vS=16;let bfe=1;const Lm=function(e={},t){if(!gr)return{close:()=>{}};(Zn(e)||Ai(e))&&(e={message:e});const i=e.position||"top-right";let s=e.offset||0;Fb[i].forEach(({vm:I})=>{var P;s+=(((P=I.el)==null?void 0:P.offsetHeight)||0)+vS}),s+=vS;const d=`notification_${bfe++}`,g=e.onClose,_={...e,offset:s,id:d,onClose:()=>{xfe(d,i,g)}};let o=document.body;Tl(e.appendTo)?o=e.appendTo:Zn(e.appendTo)&&(o=document.querySelector(e.appendTo)),Tl(o)||(o=document.body);const S=document.createElement("div"),E=Qe(yfe,_,Qn(_.message)?_.message:()=>_.message);return E.appContext=Hr(t)?Lm._context:t,E.props.onDestroy=()=>{gh(null,S)},gh(E,S),Fb[i].push({vm:E}),o.appendChild(S.firstElementChild),{close:()=>{E.component.exposed.visible.value=!1}}};G4.forEach(e=>{Lm[e]=(t={},i)=>((Zn(t)||Ai(t))&&(t={message:t}),Lm({...t,type:e},i))});function xfe(e,t,i){const s=Fb[t],d=s.findIndex(({vm:E})=>{var I;return((I=E.component)==null?void 0:I.props.id)===e});if(d===-1)return;const{vm:g}=s[d];if(!g)return;i==null||i(g);const _=g.el.offsetHeight,o=t.split("-")[0];s.splice(d,1);const S=s.length;if(!(S<1))for(let E=d;E<S;E++){const{el:I,component:P}=s[E].vm,F=Number.parseInt(I.style[o],10)-_-vS;P.props.offset=F}}function wfe(){for(const e of Object.values(Fb))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}Lm.closeAll=wfe;Lm._context=null;const Sfe=YO(Lm,"$notify");var Tfe=[Bhe,jhe,nfe,pfe,Sfe,iz],Cfe=gG([...Phe,...Tfe]);const W4=$R(Q6);W4.use(Cfe);W4.mount("#app")});export default Efe();
