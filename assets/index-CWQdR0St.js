var yN=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Uhe=yN((ma,ga)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const _ of g.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&a(_)}).observe(document,{childList:!0,subtree:!0});function i(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function a(d){if(d.ep)return;d.ep=!0;const g=i(d);fetch(d.href,g)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function pS(e){const t=Object.create(null);for(const i of e.split(","))t[i]=1;return i=>i in t}const li={},up=[],xr=()=>{},bN=()=>!1,Eb=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),mS=e=>e.startsWith("onUpdate:"),Ii=Object.assign,gS=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},xN=Object.prototype.hasOwnProperty,or=(e,t)=>xN.call(e,t),sn=Array.isArray,dp=e=>Yv(e)==="[object Map]",Mb=e=>Yv(e)==="[object Set]",Yu=e=>Yv(e)==="[object Date]",Nn=e=>typeof e=="function",Bn=e=>typeof e=="string",vl=e=>typeof e=="symbol",So=e=>e!==null&&typeof e=="object",bv=e=>(So(e)||Nn(e))&&Nn(e.then)&&Nn(e.catch),hP=Object.prototype.toString,Yv=e=>hP.call(e),wN=e=>Yv(e).slice(8,-1),xv=e=>Yv(e)==="[object Object]",vS=e=>Bn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,sv=pS(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ib=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},SN=/-(\w)/g,Js=Ib(e=>e.replace(SN,(t,i)=>i?i.toUpperCase():"")),TN=/\B([A-Z])/g,Pc=Ib(e=>e.replace(TN,"-$1").toLowerCase()),Xv=Ib(e=>e.charAt(0).toUpperCase()+e.slice(1)),av=Ib(e=>e?`on${Xv(e)}`:""),Gu=(e,t)=>!Object.is(e,t),M0=(e,...t)=>{for(let i=0;i<e.length;i++)e[i](...t)},fP=(e,t,i,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:i})},Uw=e=>{const t=parseFloat(e);return isNaN(t)?e:t},CN=e=>{const t=Bn(e)?Number(e):NaN;return isNaN(t)?e:t};let NI;const Ab=()=>NI||(NI=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function $n(e){if(sn(e)){const t={};for(let i=0;i<e.length;i++){const a=e[i],d=Bn(a)?AN(a):$n(a);if(d)for(const g in d)t[g]=d[g]}return t}else if(Bn(e)||So(e))return e}const EN=/;(?![^(]*\))/g,MN=/:([^]+)/,IN=/\/\*[^]*?\*\//g;function AN(e){const t={};return e.replace(IN,"").split(EN).forEach(i=>{if(i){const a=i.split(MN);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function ue(e){let t="";if(Bn(e))t=e;else if(sn(e))for(let i=0;i<e.length;i++){const a=ue(e[i]);a&&(t+=a+" ")}else if(So(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}function hl(e){if(!e)return null;let{class:t,style:i}=e;return t&&!Bn(t)&&(e.class=ue(t)),i&&(e.style=$n(i)),e}const kN="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",PN=pS(kN);function pP(e){return!!e||e===""}function RN(e,t){if(e.length!==t.length)return!1;let i=!0;for(let a=0;i&&a<e.length;a++)i=wp(e[a],t[a]);return i}function wp(e,t){if(e===t)return!0;let i=Yu(e),a=Yu(t);if(i||a)return i&&a?e.getTime()===t.getTime():!1;if(i=vl(e),a=vl(t),i||a)return e===t;if(i=sn(e),a=sn(t),i||a)return i&&a?RN(e,t):!1;if(i=So(e),a=So(t),i||a){if(!i||!a)return!1;const d=Object.keys(e).length,g=Object.keys(t).length;if(d!==g)return!1;for(const _ in e){const o=e.hasOwnProperty(_),S=t.hasOwnProperty(_);if(o&&!S||!o&&S||!wp(e[_],t[_]))return!1}}return String(e)===String(t)}function mP(e,t){return e.findIndex(i=>wp(i,t))}const gP=e=>!!(e&&e.__v_isRef===!0),mn=e=>Bn(e)?e:e==null?"":sn(e)||So(e)&&(e.toString===hP||!Nn(e.toString))?gP(e)?mn(e.value):JSON.stringify(e,vP,2):String(e),vP=(e,t)=>gP(t)?vP(e,t.value):dp(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[a,d],g)=>(i[ew(a,g)+" =>"]=d,i),{})}:Mb(t)?{[`Set(${t.size})`]:[...t.values()].map(i=>ew(i))}:vl(t)?ew(t):So(t)&&!sn(t)&&!xv(t)?String(t):t,ew=(e,t="")=>{var i;return vl(e)?`Symbol(${(i=e.description)!=null?i:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ls;class _P{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ls,!t&&Ls&&(this.index=(Ls.scopes||(Ls.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].pause();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].resume();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].resume()}}run(t){if(this._active){const i=Ls;try{return Ls=this,t()}finally{Ls=i}}}on(){Ls=this}off(){Ls=this.parent}stop(t){if(this._active){this._active=!1;let i,a;for(i=0,a=this.effects.length;i<a;i++)this.effects[i].stop();for(this.effects.length=0,i=0,a=this.cleanups.length;i<a;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,a=this.scopes.length;i<a;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0}}}function DN(e){return new _P(e)}function yP(){return Ls}function bP(e,t=!1){Ls&&Ls.cleanups.push(e)}let di;const tw=new WeakSet;class xP{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ls&&Ls.active&&Ls.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,tw.has(this)&&(tw.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||SP(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,$I(this),TP(this);const t=di,i=ml;di=this,ml=!0;try{return this.fn()}finally{CP(this),di=t,ml=i,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)bS(t);this.deps=this.depsTail=void 0,$I(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?tw.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){jw(this)&&this.run()}get dirty(){return jw(this)}}let wP=0,lv,cv;function SP(e,t=!1){if(e.flags|=8,t){e.next=cv,cv=e;return}e.next=lv,lv=e}function _S(){wP++}function yS(){if(--wP>0)return;if(cv){let t=cv;for(cv=void 0;t;){const i=t.next;t.next=void 0,t.flags&=-9,t=i}}let e;for(;lv;){let t=lv;for(lv=void 0;t;){const i=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=i}}if(e)throw e}function TP(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function CP(e){let t,i=e.depsTail,a=i;for(;a;){const d=a.prevDep;a.version===-1?(a===i&&(i=d),bS(a),LN(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=d}e.deps=t,e.depsTail=i}function jw(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(EP(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function EP(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===wv))return;e.globalVersion=wv;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!jw(e)){e.flags&=-3;return}const i=di,a=ml;di=e,ml=!0;try{TP(e);const d=e.fn(e._value);(t.version===0||Gu(d,e._value))&&(e._value=d,t.version++)}catch(d){throw t.version++,d}finally{di=i,ml=a,CP(e),e.flags&=-3}}function bS(e,t=!1){const{dep:i,prevSub:a,nextSub:d}=e;if(a&&(a.nextSub=d,e.prevSub=void 0),d&&(d.prevSub=a,e.nextSub=void 0),i.subs===e&&(i.subs=a,!a&&i.computed)){i.computed.flags&=-5;for(let g=i.computed.deps;g;g=g.nextDep)bS(g,!0)}!t&&!--i.sc&&i.map&&i.map.delete(i.key)}function LN(e){const{prevDep:t,nextDep:i}=e;t&&(t.nextDep=i,e.prevDep=void 0),i&&(i.prevDep=t,e.nextDep=void 0)}let ml=!0;const MP=[];function sd(){MP.push(ml),ml=!1}function ad(){const e=MP.pop();ml=e===void 0?!0:e}function $I(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const i=di;di=void 0;try{t()}finally{di=i}}}let wv=0,ON=class{constructor(t,i){this.sub=t,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class kb{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!di||!ml||di===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==di)i=this.activeLink=new ON(di,this),di.deps?(i.prevDep=di.depsTail,di.depsTail.nextDep=i,di.depsTail=i):di.deps=di.depsTail=i,IP(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const a=i.nextDep;a.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=a),i.prevDep=di.depsTail,i.nextDep=void 0,di.depsTail.nextDep=i,di.depsTail=i,di.deps===i&&(di.deps=a)}return i}trigger(t){this.version++,wv++,this.notify(t)}notify(t){_S();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{yS()}}}function IP(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)IP(a)}const i=e.dep.subs;i!==e&&(e.prevSub=i,i&&(i.nextSub=e)),e.dep.subs=e}}const K0=new WeakMap,mh=Symbol(""),Hw=Symbol(""),Sv=Symbol("");function ps(e,t,i){if(ml&&di){let a=K0.get(e);a||K0.set(e,a=new Map);let d=a.get(i);d||(a.set(i,d=new kb),d.map=a,d.key=i),d.track()}}function Tc(e,t,i,a,d,g){const _=K0.get(e);if(!_){wv++;return}const o=S=>{S&&S.trigger()};if(_S(),t==="clear")_.forEach(o);else{const S=sn(e),E=S&&vS(i);if(S&&i==="length"){const I=Number(a);_.forEach((R,z)=>{(z==="length"||z===Sv||!vl(z)&&z>=I)&&o(R)})}else switch((i!==void 0||_.has(void 0))&&o(_.get(i)),E&&o(_.get(Sv)),t){case"add":S?E&&o(_.get("length")):(o(_.get(mh)),dp(e)&&o(_.get(Hw)));break;case"delete":S||(o(_.get(mh)),dp(e)&&o(_.get(Hw)));break;case"set":dp(e)&&o(_.get(mh));break}}yS()}function zN(e,t){const i=K0.get(e);return i&&i.get(t)}function Zf(e){const t=Ar(e);return t===e?t:(ps(t,"iterate",Sv),Ba(e)?t:t.map(ms))}function Pb(e){return ps(e=Ar(e),"iterate",Sv),e}const BN={__proto__:null,[Symbol.iterator](){return nw(this,Symbol.iterator,ms)},concat(...e){return Zf(this).concat(...e.map(t=>sn(t)?Zf(t):t))},entries(){return nw(this,"entries",e=>(e[1]=ms(e[1]),e))},every(e,t){return bc(this,"every",e,t,void 0,arguments)},filter(e,t){return bc(this,"filter",e,t,i=>i.map(ms),arguments)},find(e,t){return bc(this,"find",e,t,ms,arguments)},findIndex(e,t){return bc(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return bc(this,"findLast",e,t,ms,arguments)},findLastIndex(e,t){return bc(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return bc(this,"forEach",e,t,void 0,arguments)},includes(...e){return ow(this,"includes",e)},indexOf(...e){return ow(this,"indexOf",e)},join(e){return Zf(this).join(e)},lastIndexOf(...e){return ow(this,"lastIndexOf",e)},map(e,t){return bc(this,"map",e,t,void 0,arguments)},pop(){return Kg(this,"pop")},push(...e){return Kg(this,"push",e)},reduce(e,...t){return VI(this,"reduce",e,t)},reduceRight(e,...t){return VI(this,"reduceRight",e,t)},shift(){return Kg(this,"shift")},some(e,t){return bc(this,"some",e,t,void 0,arguments)},splice(...e){return Kg(this,"splice",e)},toReversed(){return Zf(this).toReversed()},toSorted(e){return Zf(this).toSorted(e)},toSpliced(...e){return Zf(this).toSpliced(...e)},unshift(...e){return Kg(this,"unshift",e)},values(){return nw(this,"values",ms)}};function nw(e,t,i){const a=Pb(e),d=a[t]();return a!==e&&!Ba(e)&&(d._next=d.next,d.next=()=>{const g=d._next();return g.value&&(g.value=i(g.value)),g}),d}const FN=Array.prototype;function bc(e,t,i,a,d,g){const _=Pb(e),o=_!==e&&!Ba(e),S=_[t];if(S!==FN[t]){const R=S.apply(e,g);return o?ms(R):R}let E=i;_!==e&&(o?E=function(R,z){return i.call(this,ms(R),z,e)}:i.length>2&&(E=function(R,z){return i.call(this,R,z,e)}));const I=S.call(_,E,a);return o&&d?d(I):I}function VI(e,t,i,a){const d=Pb(e);let g=i;return d!==e&&(Ba(e)?i.length>3&&(g=function(_,o,S){return i.call(this,_,o,S,e)}):g=function(_,o,S){return i.call(this,_,ms(o),S,e)}),d[t](g,...a)}function ow(e,t,i){const a=Ar(e);ps(a,"iterate",Sv);const d=a[t](...i);return(d===-1||d===!1)&&SS(i[0])?(i[0]=Ar(i[0]),a[t](...i)):d}function Kg(e,t,i=[]){sd(),_S();const a=Ar(e)[t].apply(e,i);return yS(),ad(),a}const NN=pS("__proto__,__v_isRef,__isVue"),AP=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(vl));function $N(e){vl(e)||(e=String(e));const t=Ar(this);return ps(t,"has",e),t.hasOwnProperty(e)}class kP{constructor(t=!1,i=!1){this._isReadonly=t,this._isShallow=i}get(t,i,a){if(i==="__v_skip")return t.__v_skip;const d=this._isReadonly,g=this._isShallow;if(i==="__v_isReactive")return!d;if(i==="__v_isReadonly")return d;if(i==="__v_isShallow")return g;if(i==="__v_raw")return a===(d?g?YN:LP:g?DP:RP).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const _=sn(t);if(!d){let S;if(_&&(S=BN[i]))return S;if(i==="hasOwnProperty")return $N}const o=Reflect.get(t,i,Hr(t)?t:a);return(vl(i)?AP.has(i):NN(i))||(d||ps(t,"get",i),g)?o:Hr(o)?_&&vS(i)?o:o.value:So(o)?d?Vp(o):dr(o):o}}class PP extends kP{constructor(t=!1){super(!1,t)}set(t,i,a,d){let g=t[i];if(!this._isShallow){const S=bh(g);if(!Ba(a)&&!bh(a)&&(g=Ar(g),a=Ar(a)),!sn(t)&&Hr(g)&&!Hr(a))return S?!1:(g.value=a,!0)}const _=sn(t)&&vS(i)?Number(i)<t.length:or(t,i),o=Reflect.set(t,i,a,Hr(t)?t:d);return t===Ar(d)&&(_?Gu(a,g)&&Tc(t,"set",i,a):Tc(t,"add",i,a)),o}deleteProperty(t,i){const a=or(t,i);t[i];const d=Reflect.deleteProperty(t,i);return d&&a&&Tc(t,"delete",i,void 0),d}has(t,i){const a=Reflect.has(t,i);return(!vl(i)||!AP.has(i))&&ps(t,"has",i),a}ownKeys(t){return ps(t,"iterate",sn(t)?"length":mh),Reflect.ownKeys(t)}}class VN extends kP{constructor(t=!1){super(!0,t)}set(t,i){return!0}deleteProperty(t,i){return!0}}const UN=new PP,jN=new VN,HN=new PP(!0),Gw=e=>e,i0=e=>Reflect.getPrototypeOf(e);function GN(e,t,i){return function(...a){const d=this.__v_raw,g=Ar(d),_=dp(g),o=e==="entries"||e===Symbol.iterator&&_,S=e==="keys"&&_,E=d[e](...a),I=i?Gw:t?Ww:ms;return!t&&ps(g,"iterate",S?Hw:mh),{next(){const{value:R,done:z}=E.next();return z?{value:R,done:z}:{value:o?[I(R[0]),I(R[1])]:I(R),done:z}},[Symbol.iterator](){return this}}}}function s0(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function WN(e,t){const i={get(d){const g=this.__v_raw,_=Ar(g),o=Ar(d);e||(Gu(d,o)&&ps(_,"get",d),ps(_,"get",o));const{has:S}=i0(_),E=t?Gw:e?Ww:ms;if(S.call(_,d))return E(g.get(d));if(S.call(_,o))return E(g.get(o));g!==_&&g.get(d)},get size(){const d=this.__v_raw;return!e&&ps(Ar(d),"iterate",mh),Reflect.get(d,"size",d)},has(d){const g=this.__v_raw,_=Ar(g),o=Ar(d);return e||(Gu(d,o)&&ps(_,"has",d),ps(_,"has",o)),d===o?g.has(d):g.has(d)||g.has(o)},forEach(d,g){const _=this,o=_.__v_raw,S=Ar(o),E=t?Gw:e?Ww:ms;return!e&&ps(S,"iterate",mh),o.forEach((I,R)=>d.call(g,E(I),E(R),_))}};return Ii(i,e?{add:s0("add"),set:s0("set"),delete:s0("delete"),clear:s0("clear")}:{add(d){!t&&!Ba(d)&&!bh(d)&&(d=Ar(d));const g=Ar(this);return i0(g).has.call(g,d)||(g.add(d),Tc(g,"add",d,d)),this},set(d,g){!t&&!Ba(g)&&!bh(g)&&(g=Ar(g));const _=Ar(this),{has:o,get:S}=i0(_);let E=o.call(_,d);E||(d=Ar(d),E=o.call(_,d));const I=S.call(_,d);return _.set(d,g),E?Gu(g,I)&&Tc(_,"set",d,g):Tc(_,"add",d,g),this},delete(d){const g=Ar(this),{has:_,get:o}=i0(g);let S=_.call(g,d);S||(d=Ar(d),S=_.call(g,d)),o&&o.call(g,d);const E=g.delete(d);return S&&Tc(g,"delete",d,void 0),E},clear(){const d=Ar(this),g=d.size!==0,_=d.clear();return g&&Tc(d,"clear",void 0,void 0),_}}),["keys","values","entries",Symbol.iterator].forEach(d=>{i[d]=GN(d,e,t)}),i}function xS(e,t){const i=WN(e,t);return(a,d,g)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?a:Reflect.get(or(i,d)&&d in a?i:a,d,g)}const qN={get:xS(!1,!1)},KN={get:xS(!1,!0)},ZN={get:xS(!0,!1)},RP=new WeakMap,DP=new WeakMap,LP=new WeakMap,YN=new WeakMap;function XN(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function JN(e){return e.__v_skip||!Object.isExtensible(e)?0:XN(wN(e))}function dr(e){return bh(e)?e:wS(e,!1,UN,qN,RP)}function OP(e){return wS(e,!1,HN,KN,DP)}function Vp(e){return wS(e,!0,jN,ZN,LP)}function wS(e,t,i,a,d){if(!So(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const g=d.get(e);if(g)return g;const _=JN(e);if(_===0)return e;const o=new Proxy(e,_===2?a:i);return d.set(e,o),o}function hp(e){return bh(e)?hp(e.__v_raw):!!(e&&e.__v_isReactive)}function bh(e){return!!(e&&e.__v_isReadonly)}function Ba(e){return!!(e&&e.__v_isShallow)}function SS(e){return e?!!e.__v_raw:!1}function Ar(e){const t=e&&e.__v_raw;return t?Ar(t):e}function Wu(e){return!or(e,"__v_skip")&&Object.isExtensible(e)&&fP(e,"__v_skip",!0),e}const ms=e=>So(e)?dr(e):e,Ww=e=>So(e)?Vp(e):e;function Hr(e){return e?e.__v_isRef===!0:!1}function xe(e){return zP(e,!1)}function qr(e){return zP(e,!0)}function zP(e,t){return Hr(e)?e:new QN(e,t)}class QN{constructor(t,i){this.dep=new kb,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?t:Ar(t),this._value=i?t:ms(t),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(t){const i=this._rawValue,a=this.__v_isShallow||Ba(t)||bh(t);t=a?t:Ar(t),Gu(t,i)&&(this._rawValue=t,this._value=a?t:ms(t),this.dep.trigger())}}function y(e){return Hr(e)?e.value:e}const e5={get:(e,t,i)=>t==="__v_raw"?e:y(Reflect.get(e,t,i)),set:(e,t,i,a)=>{const d=e[t];return Hr(d)&&!Hr(i)?(d.value=i,!0):Reflect.set(e,t,i,a)}};function BP(e){return hp(e)?e:new Proxy(e,e5)}class t5{constructor(t){this.__v_isRef=!0,this._value=void 0;const i=this.dep=new kb,{get:a,set:d}=t(i.track.bind(i),i.trigger.bind(i));this._get=a,this._set=d}get value(){return this._value=this._get()}set value(t){this._set(t)}}function n5(e){return new t5(e)}function Vi(e){const t=sn(e)?new Array(e.length):{};for(const i in e)t[i]=FP(e,i);return t}class o5{constructor(t,i,a){this._object=t,this._key=i,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return zN(Ar(this._object),this._key)}}class r5{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function mr(e,t,i){return Hr(e)?e:Nn(e)?new r5(e):So(e)&&arguments.length>1?FP(e,t,i):xe(e)}function FP(e,t,i){const a=e[t];return Hr(a)?a:new o5(e,t,i)}class i5{constructor(t,i,a){this.fn=t,this.setter=i,this._value=void 0,this.dep=new kb(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=wv-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&di!==this)return SP(this,!0),!0}get value(){const t=this.dep.track();return EP(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function s5(e,t,i=!1){let a,d;return Nn(e)?a=e:(a=e.get,d=e.set),new i5(a,d,i)}const a0={},Z0=new WeakMap;let ih;function a5(e,t=!1,i=ih){if(i){let a=Z0.get(i);a||Z0.set(i,a=[]),a.push(e)}}function l5(e,t,i=li){const{immediate:a,deep:d,once:g,scheduler:_,augmentJob:o,call:S}=i,E=q=>d?q:Ba(q)||d===!1||d===0?Cc(q,1):Cc(q);let I,R,z,N,$=!1,F=!1;if(Hr(e)?(R=()=>e.value,$=Ba(e)):hp(e)?(R=()=>E(e),$=!0):sn(e)?(F=!0,$=e.some(q=>hp(q)||Ba(q)),R=()=>e.map(q=>{if(Hr(q))return q.value;if(hp(q))return E(q);if(Nn(q))return S?S(q,2):q()})):Nn(e)?t?R=S?()=>S(e,2):e:R=()=>{if(z){sd();try{z()}finally{ad()}}const q=ih;ih=I;try{return S?S(e,3,[N]):e(N)}finally{ih=q}}:R=xr,t&&d){const q=R,J=d===!0?1/0:d;R=()=>Cc(q(),J)}const W=yP(),U=()=>{I.stop(),W&&W.active&&gS(W.effects,I)};if(g&&t){const q=t;t=(...J)=>{q(...J),U()}}let re=F?new Array(e.length).fill(a0):a0;const K=q=>{if(!(!(I.flags&1)||!I.dirty&&!q))if(t){const J=I.run();if(d||$||(F?J.some((oe,ae)=>Gu(oe,re[ae])):Gu(J,re))){z&&z();const oe=ih;ih=I;try{const ae=[J,re===a0?void 0:F&&re[0]===a0?[]:re,N];S?S(t,3,ae):t(...ae),re=J}finally{ih=oe}}}else I.run()};return o&&o(K),I=new xP(R),I.scheduler=_?()=>_(K,!1):K,N=q=>a5(q,!1,I),z=I.onStop=()=>{const q=Z0.get(I);if(q){if(S)S(q,4);else for(const J of q)J();Z0.delete(I)}},t?a?K(!0):re=I.run():_?_(K.bind(null,!0),!0):I.run(),U.pause=I.pause.bind(I),U.resume=I.resume.bind(I),U.stop=U,U}function Cc(e,t=1/0,i){if(t<=0||!So(e)||e.__v_skip||(i=i||new Set,i.has(e)))return e;if(i.add(e),t--,Hr(e))Cc(e.value,t,i);else if(sn(e))for(let a=0;a<e.length;a++)Cc(e[a],t,i);else if(Mb(e)||dp(e))e.forEach(a=>{Cc(a,t,i)});else if(xv(e)){for(const a in e)Cc(e[a],t,i);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Cc(e[a],t,i)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Jv(e,t,i,a){try{return a?e(...a):e()}catch(d){Rb(d,t,i)}}function _l(e,t,i,a){if(Nn(e)){const d=Jv(e,t,i,a);return d&&bv(d)&&d.catch(g=>{Rb(g,t,i)}),d}if(sn(e)){const d=[];for(let g=0;g<e.length;g++)d.push(_l(e[g],t,i,a));return d}}function Rb(e,t,i,a=!0){const d=t?t.vnode:null,{errorHandler:g,throwUnhandledErrorInProduction:_}=t&&t.appContext.config||li;if(t){let o=t.parent;const S=t.proxy,E=`https://vuejs.org/error-reference/#runtime-${i}`;for(;o;){const I=o.ec;if(I){for(let R=0;R<I.length;R++)if(I[R](e,S,E)===!1)return}o=o.parent}if(g){sd(),Jv(g,null,10,[e,S,E]),ad();return}}c5(e,i,d,a,_)}function c5(e,t,i,a=!0,d=!1){if(d)throw e;console.error(e)}const Os=[];let $l=-1;const fp=[];let Fu=null,np=0;const NP=Promise.resolve();let Y0=null;function Un(e){const t=Y0||NP;return e?t.then(this?e.bind(this):e):t}function u5(e){let t=$l+1,i=Os.length;for(;t<i;){const a=t+i>>>1,d=Os[a],g=Tv(d);g<e||g===e&&d.flags&2?t=a+1:i=a}return t}function TS(e){if(!(e.flags&1)){const t=Tv(e),i=Os[Os.length-1];!i||!(e.flags&2)&&t>=Tv(i)?Os.push(e):Os.splice(u5(t),0,e),e.flags|=1,$P()}}function $P(){Y0||(Y0=NP.then(UP))}function d5(e){sn(e)?fp.push(...e):Fu&&e.id===-1?Fu.splice(np+1,0,e):e.flags&1||(fp.push(e),e.flags|=1),$P()}function UI(e,t,i=$l+1){for(;i<Os.length;i++){const a=Os[i];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Os.splice(i,1),i--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function VP(e){if(fp.length){const t=[...new Set(fp)].sort((i,a)=>Tv(i)-Tv(a));if(fp.length=0,Fu){Fu.push(...t);return}for(Fu=t,np=0;np<Fu.length;np++){const i=Fu[np];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}Fu=null,np=0}}const Tv=e=>e.id==null?e.flags&2?-1:1/0:e.id;function UP(e){try{for($l=0;$l<Os.length;$l++){const t=Os[$l];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Jv(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;$l<Os.length;$l++){const t=Os[$l];t&&(t.flags&=-2)}$l=-1,Os.length=0,VP(),Y0=null,(Os.length||fp.length)&&UP()}}let Wi=null,jP=null;function X0(e){const t=Wi;return Wi=e,jP=e&&e.type.__scopeId||null,t}function it(e,t=Wi,i){if(!t||e._n)return e;const a=(...d)=>{a._d&&tA(-1);const g=X0(t);let _;try{_=e(...d)}finally{X0(g),a._d&&tA(1)}return _};return a._n=!0,a._c=!0,a._d=!0,a}function vo(e,t){if(Wi===null)return e;const i=Fb(Wi),a=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[g,_,o,S=li]=t[d];g&&(Nn(g)&&(g={mounted:g,updated:g}),g.deep&&Cc(_),a.push({dir:g,instance:i,value:_,oldValue:void 0,arg:o,modifiers:S}))}return e}function eh(e,t,i,a){const d=e.dirs,g=t&&t.dirs;for(let _=0;_<d.length;_++){const o=d[_];g&&(o.oldValue=g[_].value);let S=o.dir[a];S&&(sd(),_l(S,i,8,[e.el,o,e,t]),ad())}}const HP=Symbol("_vte"),GP=e=>e.__isTeleport,uv=e=>e&&(e.disabled||e.disabled===""),jI=e=>e&&(e.defer||e.defer===""),HI=e=>typeof SVGElement<"u"&&e instanceof SVGElement,GI=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,qw=(e,t)=>{const i=e&&e.to;return Bn(i)?t?t(i):null:i},WP={name:"Teleport",__isTeleport:!0,process(e,t,i,a,d,g,_,o,S,E){const{mc:I,pc:R,pbc:z,o:{insert:N,querySelector:$,createText:F,createComment:W}}=E,U=uv(t.props);let{shapeFlag:re,children:K,dynamicChildren:q}=t;if(e==null){const J=t.el=F(""),oe=t.anchor=F("");N(J,i,a),N(oe,i,a);const ae=(ge,ce)=>{re&16&&(d&&d.isCE&&(d.ce._teleportTarget=ge),I(K,ge,ce,d,g,_,o,S))},fe=()=>{const ge=t.target=qw(t.props,$),ce=qP(ge,t,F,N);ge&&(_!=="svg"&&HI(ge)?_="svg":_!=="mathml"&&GI(ge)&&(_="mathml"),U||(ae(ge,ce),I0(t,!1)))};U&&(ae(i,oe),I0(t,!0)),jI(t.props)?Ds(()=>{fe(),t.el.__isMounted=!0},g):fe()}else{if(jI(t.props)&&!e.el.__isMounted){Ds(()=>{WP.process(e,t,i,a,d,g,_,o,S,E),delete e.el.__isMounted},g);return}t.el=e.el,t.targetStart=e.targetStart;const J=t.anchor=e.anchor,oe=t.target=e.target,ae=t.targetAnchor=e.targetAnchor,fe=uv(e.props),ge=fe?i:oe,ce=fe?J:ae;if(_==="svg"||HI(oe)?_="svg":(_==="mathml"||GI(oe))&&(_="mathml"),q?(z(e.dynamicChildren,q,ge,d,g,_,o),PS(e,t,!0)):S||R(e,t,ge,ce,d,g,_,o,!1),U)fe?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):l0(t,i,J,E,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const de=t.target=qw(t.props,$);de&&l0(t,de,null,E,0)}else fe&&l0(t,oe,ae,E,1);I0(t,U)}},remove(e,t,i,{um:a,o:{remove:d}},g){const{shapeFlag:_,children:o,anchor:S,targetStart:E,targetAnchor:I,target:R,props:z}=e;if(R&&(d(E),d(I)),g&&d(S),_&16){const N=g||!uv(z);for(let $=0;$<o.length;$++){const F=o[$];a(F,t,i,N,!!F.dynamicChildren)}}},move:l0,hydrate:h5};function l0(e,t,i,{o:{insert:a},m:d},g=2){g===0&&a(e.targetAnchor,t,i);const{el:_,anchor:o,shapeFlag:S,children:E,props:I}=e,R=g===2;if(R&&a(_,t,i),(!R||uv(I))&&S&16)for(let z=0;z<E.length;z++)d(E[z],t,i,2);R&&a(o,t,i)}function h5(e,t,i,a,d,g,{o:{nextSibling:_,parentNode:o,querySelector:S,insert:E,createText:I}},R){const z=t.target=qw(t.props,S);if(z){const N=uv(t.props),$=z._lpa||z.firstChild;if(t.shapeFlag&16)if(N)t.anchor=R(_(e),t,o(e),i,a,d,g),t.targetStart=$,t.targetAnchor=$&&_($);else{t.anchor=_(e);let F=$;for(;F;){if(F&&F.nodeType===8){if(F.data==="teleport start anchor")t.targetStart=F;else if(F.data==="teleport anchor"){t.targetAnchor=F,z._lpa=t.targetAnchor&&_(t.targetAnchor);break}}F=_(F)}t.targetAnchor||qP(z,t,I,E),R($&&_($),t,z,i,a,d,g)}I0(t,N)}return t.anchor&&_(t.anchor)}const f5=WP;function I0(e,t){const i=e.ctx;if(i&&i.ut){let a,d;for(t?(a=e.el,d=e.anchor):(a=e.targetStart,d=e.targetAnchor);a&&a!==d;)a.nodeType===1&&a.setAttribute("data-v-owner",i.uid),a=a.nextSibling;i.ut()}}function qP(e,t,i,a){const d=t.targetStart=i(""),g=t.targetAnchor=i("");return d[HP]=g,e&&(a(d,e),a(g,e)),g}const Nu=Symbol("_leaveCb"),c0=Symbol("_enterCb");function KP(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return _o(()=>{e.isMounted=!0}),Pr(()=>{e.isUnmounting=!0}),e}const Pa=[Function,Array],ZP={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Pa,onEnter:Pa,onAfterEnter:Pa,onEnterCancelled:Pa,onBeforeLeave:Pa,onLeave:Pa,onAfterLeave:Pa,onLeaveCancelled:Pa,onBeforeAppear:Pa,onAppear:Pa,onAfterAppear:Pa,onAppearCancelled:Pa},YP=e=>{const t=e.subTree;return t.component?YP(t.component):t},p5={name:"BaseTransition",props:ZP,setup(e,{slots:t}){const i=To(),a=KP();return()=>{const d=t.default&&CS(t.default(),!0);if(!d||!d.length)return;const g=XP(d),_=Ar(e),{mode:o}=_;if(a.isLeaving)return rw(g);const S=WI(g);if(!S)return rw(g);let E=Cv(S,_,a,i,R=>E=R);S.type!==Ni&&xh(S,E);let I=i.subTree&&WI(i.subTree);if(I&&I.type!==Ni&&!sh(S,I)&&YP(i).type!==Ni){let R=Cv(I,_,a,i);if(xh(I,R),o==="out-in"&&S.type!==Ni)return a.isLeaving=!0,R.afterLeave=()=>{a.isLeaving=!1,i.job.flags&8||i.update(),delete R.afterLeave,I=void 0},rw(g);o==="in-out"&&S.type!==Ni?R.delayLeave=(z,N,$)=>{const F=JP(a,I);F[String(I.key)]=I,z[Nu]=()=>{N(),z[Nu]=void 0,delete E.delayedLeave,I=void 0},E.delayedLeave=()=>{$(),delete E.delayedLeave,I=void 0}}:I=void 0}else I&&(I=void 0);return g}}};function XP(e){let t=e[0];if(e.length>1){for(const i of e)if(i.type!==Ni){t=i;break}}return t}const m5=p5;function JP(e,t){const{leavingVNodes:i}=e;let a=i.get(t.type);return a||(a=Object.create(null),i.set(t.type,a)),a}function Cv(e,t,i,a,d){const{appear:g,mode:_,persisted:o=!1,onBeforeEnter:S,onEnter:E,onAfterEnter:I,onEnterCancelled:R,onBeforeLeave:z,onLeave:N,onAfterLeave:$,onLeaveCancelled:F,onBeforeAppear:W,onAppear:U,onAfterAppear:re,onAppearCancelled:K}=t,q=String(e.key),J=JP(i,e),oe=(ge,ce)=>{ge&&_l(ge,a,9,ce)},ae=(ge,ce)=>{const de=ce[1];oe(ge,ce),sn(ge)?ge.every(_e=>_e.length<=1)&&de():ge.length<=1&&de()},fe={mode:_,persisted:o,beforeEnter(ge){let ce=S;if(!i.isMounted)if(g)ce=W||S;else return;ge[Nu]&&ge[Nu](!0);const de=J[q];de&&sh(e,de)&&de.el[Nu]&&de.el[Nu](),oe(ce,[ge])},enter(ge){let ce=E,de=I,_e=R;if(!i.isMounted)if(g)ce=U||E,de=re||I,_e=K||R;else return;let Re=!1;const Qe=ge[c0]=Ee=>{Re||(Re=!0,Ee?oe(_e,[ge]):oe(de,[ge]),fe.delayedLeave&&fe.delayedLeave(),ge[c0]=void 0)};ce?ae(ce,[ge,Qe]):Qe()},leave(ge,ce){const de=String(e.key);if(ge[c0]&&ge[c0](!0),i.isUnmounting)return ce();oe(z,[ge]);let _e=!1;const Re=ge[Nu]=Qe=>{_e||(_e=!0,ce(),Qe?oe(F,[ge]):oe($,[ge]),ge[Nu]=void 0,J[de]===e&&delete J[de])};J[de]=e,N?ae(N,[ge,Re]):Re()},clone(ge){const ce=Cv(ge,t,i,a,d);return d&&d(ce),ce}};return fe}function rw(e){if(Db(e))return e=Ic(e),e.children=null,e}function WI(e){if(!Db(e))return GP(e.type)&&e.children?XP(e.children):e;const{shapeFlag:t,children:i}=e;if(i){if(t&16)return i[0];if(t&32&&Nn(i.default))return i.default()}}function xh(e,t){e.shapeFlag&6&&e.component?(e.transition=t,xh(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function CS(e,t=!1,i){let a=[],d=0;for(let g=0;g<e.length;g++){let _=e[g];const o=i==null?_.key:String(i)+String(_.key!=null?_.key:g);_.type===Fn?(_.patchFlag&128&&d++,a=a.concat(CS(_.children,t,o))):(t||_.type!==Ni)&&a.push(o!=null?Ic(_,{key:o}):_)}if(d>1)for(let g=0;g<a.length;g++)a[g].patchFlag=-2;return a}/*! #__NO_SIDE_EFFECTS__ */function qe(e,t){return Nn(e)?Ii({name:e.name},t,{setup:e}):e}function QP(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function J0(e,t,i,a,d=!1){if(sn(e)){e.forEach(($,F)=>J0($,t&&(sn(t)?t[F]:t),i,a,d));return}if(pp(a)&&!d){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&J0(e,t,i,a.component.subTree);return}const g=a.shapeFlag&4?Fb(a.component):a.el,_=d?null:g,{i:o,r:S}=e,E=t&&t.r,I=o.refs===li?o.refs={}:o.refs,R=o.setupState,z=Ar(R),N=R===li?()=>!1:$=>or(z,$);if(E!=null&&E!==S&&(Bn(E)?(I[E]=null,N(E)&&(R[E]=null)):Hr(E)&&(E.value=null)),Nn(S))Jv(S,o,12,[_,I]);else{const $=Bn(S),F=Hr(S);if($||F){const W=()=>{if(e.f){const U=$?N(S)?R[S]:I[S]:S.value;d?sn(U)&&gS(U,g):sn(U)?U.includes(g)||U.push(g):$?(I[S]=[g],N(S)&&(R[S]=I[S])):(S.value=[g],e.k&&(I[e.k]=S.value))}else $?(I[S]=_,N(S)&&(R[S]=_)):F&&(S.value=_,e.k&&(I[e.k]=_))};_?(W.id=-1,Ds(W,i)):W()}}}Ab().requestIdleCallback;Ab().cancelIdleCallback;const pp=e=>!!e.type.__asyncLoader,Db=e=>e.type.__isKeepAlive;function ES(e,t){tR(e,"a",t)}function eR(e,t){tR(e,"da",t)}function tR(e,t,i=ts){const a=e.__wdc||(e.__wdc=()=>{let d=i;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(Lb(t,a,i),i){let d=i.parent;for(;d&&d.parent;)Db(d.parent.vnode)&&g5(a,t,i,d),d=d.parent}}function g5(e,t,i,a){const d=Lb(t,e,a,!0);ld(()=>{gS(a[t],d)},i)}function Lb(e,t,i=ts,a=!1){if(i){const d=i[e]||(i[e]=[]),g=t.__weh||(t.__weh=(..._)=>{sd();const o=Qv(i),S=_l(t,i,e,_);return o(),ad(),S});return a?d.unshift(g):d.push(g),g}}const Rc=e=>(t,i=ts)=>{(!Mv||e==="sp")&&Lb(e,(...a)=>t(...a),i)},Ob=Rc("bm"),_o=Rc("m"),nR=Rc("bu"),Xl=Rc("u"),Pr=Rc("bum"),ld=Rc("um"),v5=Rc("sp"),_5=Rc("rtg"),y5=Rc("rtc");function b5(e,t=ts){Lb("ec",e,t)}const MS="components",x5="directives";function Mo(e,t){return IS(MS,e,!0,t)||e}const oR=Symbol.for("v-ndc");function ko(e){return Bn(e)?IS(MS,e,!1)||e:e||oR}function zb(e){return IS(x5,e)}function IS(e,t,i=!0,a=!1){const d=Wi||ts;if(d){const g=d.type;if(e===MS){const o=i6(g,!1);if(o&&(o===t||o===Js(t)||o===Xv(Js(t))))return g}const _=qI(d[e]||g[e],t)||qI(d.appContext[e],t);return!_&&a?g:_}}function qI(e,t){return e&&(e[t]||e[Js(t)]||e[Xv(Js(t))])}function Fo(e,t,i,a){let d;const g=i,_=sn(e);if(_||Bn(e)){const o=_&&hp(e);let S=!1;o&&(S=!Ba(e),e=Pb(e)),d=new Array(e.length);for(let E=0,I=e.length;E<I;E++)d[E]=t(S?ms(e[E]):e[E],E,void 0,g)}else if(typeof e=="number"){d=new Array(e);for(let o=0;o<e;o++)d[o]=t(o+1,o,void 0,g)}else if(So(e))if(e[Symbol.iterator])d=Array.from(e,(o,S)=>t(o,S,void 0,g));else{const o=Object.keys(e);d=new Array(o.length);for(let S=0,E=o.length;S<E;S++){const I=o[S];d[S]=t(e[I],I,S,g)}}else d=[];return d}function Na(e,t){for(let i=0;i<t.length;i++){const a=t[i];if(sn(a))for(let d=0;d<a.length;d++)e[a[d].name]=a[d].fn;else a&&(e[a.name]=a.key?(...d)=>{const g=a.fn(...d);return g&&(g.key=a.key),g}:a.fn)}return e}function vt(e,t,i={},a,d){if(Wi.ce||Wi.parent&&pp(Wi.parent)&&Wi.parent.ce)return t!=="default"&&(i.name=t),se(),Et(Fn,null,[Ye("slot",i,a&&a())],64);let g=e[t];g&&g._c&&(g._d=!1),se();const _=g&&rR(g(i)),o=i.key||_&&_.key,S=Et(Fn,{key:(o&&!vl(o)?o:`_${t}`)+(!_&&a?"_fb":"")},_||(a?a():[]),_&&e._===1?64:-2);return S.scopeId&&(S.slotScopeIds=[S.scopeId+"-s"]),g&&g._c&&(g._d=!0),S}function rR(e){return e.some(t=>Yr(t)?!(t.type===Ni||t.type===Fn&&!rR(t.children)):!0)?e:null}function w5(e,t){const i={};for(const a in e)i[av(a)]=e[a];return i}const Kw=e=>e?SR(e)?Fb(e):Kw(e.parent):null,dv=Ii(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Kw(e.parent),$root:e=>Kw(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>AS(e),$forceUpdate:e=>e.f||(e.f=()=>{TS(e.update)}),$nextTick:e=>e.n||(e.n=Un.bind(e.proxy)),$watch:e=>j5.bind(e)}),iw=(e,t)=>e!==li&&!e.__isScriptSetup&&or(e,t),S5={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:i,setupState:a,data:d,props:g,accessCache:_,type:o,appContext:S}=e;let E;if(t[0]!=="$"){const N=_[t];if(N!==void 0)switch(N){case 1:return a[t];case 2:return d[t];case 4:return i[t];case 3:return g[t]}else{if(iw(a,t))return _[t]=1,a[t];if(d!==li&&or(d,t))return _[t]=2,d[t];if((E=e.propsOptions[0])&&or(E,t))return _[t]=3,g[t];if(i!==li&&or(i,t))return _[t]=4,i[t];Zw&&(_[t]=0)}}const I=dv[t];let R,z;if(I)return t==="$attrs"&&ps(e.attrs,"get",""),I(e);if((R=o.__cssModules)&&(R=R[t]))return R;if(i!==li&&or(i,t))return _[t]=4,i[t];if(z=S.config.globalProperties,or(z,t))return z[t]},set({_:e},t,i){const{data:a,setupState:d,ctx:g}=e;return iw(d,t)?(d[t]=i,!0):a!==li&&or(a,t)?(a[t]=i,!0):or(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(g[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:a,appContext:d,propsOptions:g}},_){let o;return!!i[_]||e!==li&&or(e,_)||iw(t,_)||(o=g[0])&&or(o,_)||or(a,_)||or(dv,_)||or(d.config.globalProperties,_)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:or(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function Ri(){return iR().slots}function Ph(){return iR().attrs}function iR(){const e=To();return e.setupContext||(e.setupContext=CR(e))}function KI(e){return sn(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let Zw=!0;function T5(e){const t=AS(e),i=e.proxy,a=e.ctx;Zw=!1,t.beforeCreate&&ZI(t.beforeCreate,e,"bc");const{data:d,computed:g,methods:_,watch:o,provide:S,inject:E,created:I,beforeMount:R,mounted:z,beforeUpdate:N,updated:$,activated:F,deactivated:W,beforeDestroy:U,beforeUnmount:re,destroyed:K,unmounted:q,render:J,renderTracked:oe,renderTriggered:ae,errorCaptured:fe,serverPrefetch:ge,expose:ce,inheritAttrs:de,components:_e,directives:Re,filters:Qe}=t;if(E&&C5(E,a,null),_)for(const Me in _){const Te=_[Me];Nn(Te)&&(a[Me]=Te.bind(i))}if(d){const Me=d.call(i,i);So(Me)&&(e.data=dr(Me))}if(Zw=!0,g)for(const Me in g){const Te=g[Me],he=Nn(Te)?Te.bind(i,i):Nn(Te.get)?Te.get.bind(i,i):xr,ke=!Nn(Te)&&Nn(Te.set)?Te.set.bind(i):xr,Ne=ee({get:he,set:ke});Object.defineProperty(a,Me,{enumerable:!0,configurable:!0,get:()=>Ne.value,set:nt=>Ne.value=nt})}if(o)for(const Me in o)sR(o[Me],a,i,Me);if(S){const Me=Nn(S)?S.call(i):S;Reflect.ownKeys(Me).forEach(Te=>{Bo(Te,Me[Te])})}I&&ZI(I,e,"c");function ye(Me,Te){sn(Te)?Te.forEach(he=>Me(he.bind(i))):Te&&Me(Te.bind(i))}if(ye(Ob,R),ye(_o,z),ye(nR,N),ye(Xl,$),ye(ES,F),ye(eR,W),ye(b5,fe),ye(y5,oe),ye(_5,ae),ye(Pr,re),ye(ld,q),ye(v5,ge),sn(ce))if(ce.length){const Me=e.exposed||(e.exposed={});ce.forEach(Te=>{Object.defineProperty(Me,Te,{get:()=>i[Te],set:he=>i[Te]=he})})}else e.exposed||(e.exposed={});J&&e.render===xr&&(e.render=J),de!=null&&(e.inheritAttrs=de),_e&&(e.components=_e),Re&&(e.directives=Re),ge&&QP(e)}function C5(e,t,i=xr){sn(e)&&(e=Yw(e));for(const a in e){const d=e[a];let g;So(d)?"default"in d?g=kn(d.from||a,d.default,!0):g=kn(d.from||a):g=kn(d),Hr(g)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>g.value,set:_=>g.value=_}):t[a]=g}}function ZI(e,t,i){_l(sn(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,i)}function sR(e,t,i,a){let d=a.includes(".")?_R(i,a):()=>i[a];if(Bn(e)){const g=t[e];Nn(g)&&qt(d,g)}else if(Nn(e))qt(d,e.bind(i));else if(So(e))if(sn(e))e.forEach(g=>sR(g,t,i,a));else{const g=Nn(e.handler)?e.handler.bind(i):t[e.handler];Nn(g)&&qt(d,g,e)}}function AS(e){const t=e.type,{mixins:i,extends:a}=t,{mixins:d,optionsCache:g,config:{optionMergeStrategies:_}}=e.appContext,o=g.get(t);let S;return o?S=o:!d.length&&!i&&!a?S=t:(S={},d.length&&d.forEach(E=>Q0(S,E,_,!0)),Q0(S,t,_)),So(t)&&g.set(t,S),S}function Q0(e,t,i,a=!1){const{mixins:d,extends:g}=t;g&&Q0(e,g,i,!0),d&&d.forEach(_=>Q0(e,_,i,!0));for(const _ in t)if(!(a&&_==="expose")){const o=E5[_]||i&&i[_];e[_]=o?o(e[_],t[_]):t[_]}return e}const E5={data:YI,props:XI,emits:XI,methods:nv,computed:nv,beforeCreate:Rs,created:Rs,beforeMount:Rs,mounted:Rs,beforeUpdate:Rs,updated:Rs,beforeDestroy:Rs,beforeUnmount:Rs,destroyed:Rs,unmounted:Rs,activated:Rs,deactivated:Rs,errorCaptured:Rs,serverPrefetch:Rs,components:nv,directives:nv,watch:I5,provide:YI,inject:M5};function YI(e,t){return t?e?function(){return Ii(Nn(e)?e.call(this,this):e,Nn(t)?t.call(this,this):t)}:t:e}function M5(e,t){return nv(Yw(e),Yw(t))}function Yw(e){if(sn(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function Rs(e,t){return e?[...new Set([].concat(e,t))]:t}function nv(e,t){return e?Ii(Object.create(null),e,t):t}function XI(e,t){return e?sn(e)&&sn(t)?[...new Set([...e,...t])]:Ii(Object.create(null),KI(e),KI(t??{})):t}function I5(e,t){if(!e)return t;if(!t)return e;const i=Ii(Object.create(null),e);for(const a in t)i[a]=Rs(e[a],t[a]);return i}function aR(){return{app:null,config:{isNativeTag:bN,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let A5=0;function k5(e,t){return function(a,d=null){Nn(a)||(a=Ii({},a)),d!=null&&!So(d)&&(d=null);const g=aR(),_=new WeakSet,o=[];let S=!1;const E=g.app={_uid:A5++,_component:a,_props:d,_container:null,_context:g,_instance:null,version:a6,get config(){return g.config},set config(I){},use(I,...R){return _.has(I)||(I&&Nn(I.install)?(_.add(I),I.install(E,...R)):Nn(I)&&(_.add(I),I(E,...R))),E},mixin(I){return g.mixins.includes(I)||g.mixins.push(I),E},component(I,R){return R?(g.components[I]=R,E):g.components[I]},directive(I,R){return R?(g.directives[I]=R,E):g.directives[I]},mount(I,R,z){if(!S){const N=E._ceVNode||Ye(a,d);return N.appContext=g,z===!0?z="svg":z===!1&&(z=void 0),R&&t?t(N,I):e(N,I,z),S=!0,E._container=I,I.__vue_app__=E,Fb(N.component)}},onUnmount(I){o.push(I)},unmount(){S&&(_l(o,E._instance,16),e(null,E._container),delete E._container.__vue_app__)},provide(I,R){return g.provides[I]=R,E},runWithContext(I){const R=mp;mp=E;try{return I()}finally{mp=R}}};return E}}let mp=null;function Bo(e,t){if(ts){let i=ts.provides;const a=ts.parent&&ts.parent.provides;a===i&&(i=ts.provides=Object.create(a)),i[e]=t}}function kn(e,t,i=!1){const a=ts||Wi;if(a||mp){const d=mp?mp._context.provides:a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(d&&e in d)return d[e];if(arguments.length>1)return i&&Nn(t)?t.call(a&&a.proxy):t}}const lR={},cR=()=>Object.create(lR),uR=e=>Object.getPrototypeOf(e)===lR;function P5(e,t,i,a=!1){const d={},g=cR();e.propsDefaults=Object.create(null),dR(e,t,d,g);for(const _ in e.propsOptions[0])_ in d||(d[_]=void 0);i?e.props=a?d:OP(d):e.type.props?e.props=d:e.props=g,e.attrs=g}function R5(e,t,i,a){const{props:d,attrs:g,vnode:{patchFlag:_}}=e,o=Ar(d),[S]=e.propsOptions;let E=!1;if((a||_>0)&&!(_&16)){if(_&8){const I=e.vnode.dynamicProps;for(let R=0;R<I.length;R++){let z=I[R];if(Bb(e.emitsOptions,z))continue;const N=t[z];if(S)if(or(g,z))N!==g[z]&&(g[z]=N,E=!0);else{const $=Js(z);d[$]=Xw(S,o,$,N,e,!1)}else N!==g[z]&&(g[z]=N,E=!0)}}}else{dR(e,t,d,g)&&(E=!0);let I;for(const R in o)(!t||!or(t,R)&&((I=Pc(R))===R||!or(t,I)))&&(S?i&&(i[R]!==void 0||i[I]!==void 0)&&(d[R]=Xw(S,o,R,void 0,e,!0)):delete d[R]);if(g!==o)for(const R in g)(!t||!or(t,R))&&(delete g[R],E=!0)}E&&Tc(e.attrs,"set","")}function dR(e,t,i,a){const[d,g]=e.propsOptions;let _=!1,o;if(t)for(let S in t){if(sv(S))continue;const E=t[S];let I;d&&or(d,I=Js(S))?!g||!g.includes(I)?i[I]=E:(o||(o={}))[I]=E:Bb(e.emitsOptions,S)||(!(S in a)||E!==a[S])&&(a[S]=E,_=!0)}if(g){const S=Ar(i),E=o||li;for(let I=0;I<g.length;I++){const R=g[I];i[R]=Xw(d,S,R,E[R],e,!or(E,R))}}return _}function Xw(e,t,i,a,d,g){const _=e[i];if(_!=null){const o=or(_,"default");if(o&&a===void 0){const S=_.default;if(_.type!==Function&&!_.skipFactory&&Nn(S)){const{propsDefaults:E}=d;if(i in E)a=E[i];else{const I=Qv(d);a=E[i]=S.call(null,t),I()}}else a=S;d.ce&&d.ce._setProp(i,a)}_[0]&&(g&&!o?a=!1:_[1]&&(a===""||a===Pc(i))&&(a=!0))}return a}const D5=new WeakMap;function hR(e,t,i=!1){const a=i?D5:t.propsCache,d=a.get(e);if(d)return d;const g=e.props,_={},o=[];let S=!1;if(!Nn(e)){const I=R=>{S=!0;const[z,N]=hR(R,t,!0);Ii(_,z),N&&o.push(...N)};!i&&t.mixins.length&&t.mixins.forEach(I),e.extends&&I(e.extends),e.mixins&&e.mixins.forEach(I)}if(!g&&!S)return So(e)&&a.set(e,up),up;if(sn(g))for(let I=0;I<g.length;I++){const R=Js(g[I]);JI(R)&&(_[R]=li)}else if(g)for(const I in g){const R=Js(I);if(JI(R)){const z=g[I],N=_[R]=sn(z)||Nn(z)?{type:z}:Ii({},z),$=N.type;let F=!1,W=!0;if(sn($))for(let U=0;U<$.length;++U){const re=$[U],K=Nn(re)&&re.name;if(K==="Boolean"){F=!0;break}else K==="String"&&(W=!1)}else F=Nn($)&&$.name==="Boolean";N[0]=F,N[1]=W,(F||or(N,"default"))&&o.push(R)}}const E=[_,o];return So(e)&&a.set(e,E),E}function JI(e){return e[0]!=="$"&&!sv(e)}const fR=e=>e[0]==="_"||e==="$stable",kS=e=>sn(e)?e.map(Vl):[Vl(e)],L5=(e,t,i)=>{if(t._n)return t;const a=it((...d)=>kS(t(...d)),i);return a._c=!1,a},pR=(e,t,i)=>{const a=e._ctx;for(const d in e){if(fR(d))continue;const g=e[d];if(Nn(g))t[d]=L5(d,g,a);else if(g!=null){const _=kS(g);t[d]=()=>_}}},mR=(e,t)=>{const i=kS(t);e.slots.default=()=>i},gR=(e,t,i)=>{for(const a in t)(i||a!=="_")&&(e[a]=t[a])},O5=(e,t,i)=>{const a=e.slots=cR();if(e.vnode.shapeFlag&32){const d=t._;d?(gR(a,t,i),i&&fP(a,"_",d,!0)):pR(t,a)}else t&&mR(e,t)},z5=(e,t,i)=>{const{vnode:a,slots:d}=e;let g=!0,_=li;if(a.shapeFlag&32){const o=t._;o?i&&o===1?g=!1:gR(d,t,i):(g=!t.$stable,pR(t,d)),_=t}else t&&(mR(e,t),_={default:1});if(g)for(const o in d)!fR(o)&&_[o]==null&&delete d[o]},Ds=Y5;function B5(e){return F5(e)}function F5(e,t){const i=Ab();i.__VUE__=!0;const{insert:a,remove:d,patchProp:g,createElement:_,createText:o,createComment:S,setText:E,setElementText:I,parentNode:R,nextSibling:z,setScopeId:N=xr,insertStaticContent:$}=e,F=(Ge,Fe,Nt,Jt=null,Dt=null,xt=null,Ot=void 0,en=null,dn=!!Fe.dynamicChildren)=>{if(Ge===Fe)return;Ge&&!sh(Ge,Fe)&&(Jt=mt(Ge),nt(Ge,Dt,xt,!0),Ge=null),Fe.patchFlag===-2&&(dn=!1,Fe.dynamicChildren=null);const{type:un,ref:Pn,shapeFlag:gt}=Fe;switch(un){case Up:W(Ge,Fe,Nt,Jt);break;case Ni:U(Ge,Fe,Nt,Jt);break;case lw:Ge==null&&re(Fe,Nt,Jt,Ot);break;case Fn:_e(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn);break;default:gt&1?J(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn):gt&6?Re(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn):(gt&64||gt&128)&&un.process(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn,Be)}Pn!=null&&Dt&&J0(Pn,Ge&&Ge.ref,xt,Fe||Ge,!Fe)},W=(Ge,Fe,Nt,Jt)=>{if(Ge==null)a(Fe.el=o(Fe.children),Nt,Jt);else{const Dt=Fe.el=Ge.el;Fe.children!==Ge.children&&E(Dt,Fe.children)}},U=(Ge,Fe,Nt,Jt)=>{Ge==null?a(Fe.el=S(Fe.children||""),Nt,Jt):Fe.el=Ge.el},re=(Ge,Fe,Nt,Jt)=>{[Ge.el,Ge.anchor]=$(Ge.children,Fe,Nt,Jt,Ge.el,Ge.anchor)},K=({el:Ge,anchor:Fe},Nt,Jt)=>{let Dt;for(;Ge&&Ge!==Fe;)Dt=z(Ge),a(Ge,Nt,Jt),Ge=Dt;a(Fe,Nt,Jt)},q=({el:Ge,anchor:Fe})=>{let Nt;for(;Ge&&Ge!==Fe;)Nt=z(Ge),d(Ge),Ge=Nt;d(Fe)},J=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn)=>{Fe.type==="svg"?Ot="svg":Fe.type==="math"&&(Ot="mathml"),Ge==null?oe(Fe,Nt,Jt,Dt,xt,Ot,en,dn):ge(Ge,Fe,Dt,xt,Ot,en,dn)},oe=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en)=>{let dn,un;const{props:Pn,shapeFlag:gt,transition:Sn,dirs:Vn}=Ge;if(dn=Ge.el=_(Ge.type,xt,Pn&&Pn.is,Pn),gt&8?I(dn,Ge.children):gt&16&&fe(Ge.children,dn,null,Jt,Dt,sw(Ge,xt),Ot,en),Vn&&eh(Ge,null,Jt,"created"),ae(dn,Ge,Ge.scopeId,Ot,Jt),Pn){for(const eo in Pn)eo!=="value"&&!sv(eo)&&g(dn,eo,null,Pn[eo],xt,Jt);"value"in Pn&&g(dn,"value",null,Pn.value,xt),(un=Pn.onVnodeBeforeMount)&&Fl(un,Jt,Ge)}Vn&&eh(Ge,null,Jt,"beforeMount");const lo=N5(Dt,Sn);lo&&Sn.beforeEnter(dn),a(dn,Fe,Nt),((un=Pn&&Pn.onVnodeMounted)||lo||Vn)&&Ds(()=>{un&&Fl(un,Jt,Ge),lo&&Sn.enter(dn),Vn&&eh(Ge,null,Jt,"mounted")},Dt)},ae=(Ge,Fe,Nt,Jt,Dt)=>{if(Nt&&N(Ge,Nt),Jt)for(let xt=0;xt<Jt.length;xt++)N(Ge,Jt[xt]);if(Dt){let xt=Dt.subTree;if(Fe===xt||bR(xt.type)&&(xt.ssContent===Fe||xt.ssFallback===Fe)){const Ot=Dt.vnode;ae(Ge,Ot,Ot.scopeId,Ot.slotScopeIds,Dt.parent)}}},fe=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn=0)=>{for(let un=dn;un<Ge.length;un++){const Pn=Ge[un]=en?$u(Ge[un]):Vl(Ge[un]);F(null,Pn,Fe,Nt,Jt,Dt,xt,Ot,en)}},ge=(Ge,Fe,Nt,Jt,Dt,xt,Ot)=>{const en=Fe.el=Ge.el;let{patchFlag:dn,dynamicChildren:un,dirs:Pn}=Fe;dn|=Ge.patchFlag&16;const gt=Ge.props||li,Sn=Fe.props||li;let Vn;if(Nt&&th(Nt,!1),(Vn=Sn.onVnodeBeforeUpdate)&&Fl(Vn,Nt,Fe,Ge),Pn&&eh(Fe,Ge,Nt,"beforeUpdate"),Nt&&th(Nt,!0),(gt.innerHTML&&Sn.innerHTML==null||gt.textContent&&Sn.textContent==null)&&I(en,""),un?ce(Ge.dynamicChildren,un,en,Nt,Jt,sw(Fe,Dt),xt):Ot||Te(Ge,Fe,en,null,Nt,Jt,sw(Fe,Dt),xt,!1),dn>0){if(dn&16)de(en,gt,Sn,Nt,Dt);else if(dn&2&&gt.class!==Sn.class&&g(en,"class",null,Sn.class,Dt),dn&4&&g(en,"style",gt.style,Sn.style,Dt),dn&8){const lo=Fe.dynamicProps;for(let eo=0;eo<lo.length;eo++){const fo=lo[eo],Lo=gt[fo],er=Sn[fo];(er!==Lo||fo==="value")&&g(en,fo,Lo,er,Dt,Nt)}}dn&1&&Ge.children!==Fe.children&&I(en,Fe.children)}else!Ot&&un==null&&de(en,gt,Sn,Nt,Dt);((Vn=Sn.onVnodeUpdated)||Pn)&&Ds(()=>{Vn&&Fl(Vn,Nt,Fe,Ge),Pn&&eh(Fe,Ge,Nt,"updated")},Jt)},ce=(Ge,Fe,Nt,Jt,Dt,xt,Ot)=>{for(let en=0;en<Fe.length;en++){const dn=Ge[en],un=Fe[en],Pn=dn.el&&(dn.type===Fn||!sh(dn,un)||dn.shapeFlag&70)?R(dn.el):Nt;F(dn,un,Pn,null,Jt,Dt,xt,Ot,!0)}},de=(Ge,Fe,Nt,Jt,Dt)=>{if(Fe!==Nt){if(Fe!==li)for(const xt in Fe)!sv(xt)&&!(xt in Nt)&&g(Ge,xt,Fe[xt],null,Dt,Jt);for(const xt in Nt){if(sv(xt))continue;const Ot=Nt[xt],en=Fe[xt];Ot!==en&&xt!=="value"&&g(Ge,xt,en,Ot,Dt,Jt)}"value"in Nt&&g(Ge,"value",Fe.value,Nt.value,Dt)}},_e=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn)=>{const un=Fe.el=Ge?Ge.el:o(""),Pn=Fe.anchor=Ge?Ge.anchor:o("");let{patchFlag:gt,dynamicChildren:Sn,slotScopeIds:Vn}=Fe;Vn&&(en=en?en.concat(Vn):Vn),Ge==null?(a(un,Nt,Jt),a(Pn,Nt,Jt),fe(Fe.children||[],Nt,Pn,Dt,xt,Ot,en,dn)):gt>0&&gt&64&&Sn&&Ge.dynamicChildren?(ce(Ge.dynamicChildren,Sn,Nt,Dt,xt,Ot,en),(Fe.key!=null||Dt&&Fe===Dt.subTree)&&PS(Ge,Fe,!0)):Te(Ge,Fe,Nt,Pn,Dt,xt,Ot,en,dn)},Re=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn)=>{Fe.slotScopeIds=en,Ge==null?Fe.shapeFlag&512?Dt.ctx.activate(Fe,Nt,Jt,Ot,dn):Qe(Fe,Nt,Jt,Dt,xt,Ot,dn):Ee(Ge,Fe,dn)},Qe=(Ge,Fe,Nt,Jt,Dt,xt,Ot)=>{const en=Ge.component=t6(Ge,Jt,Dt);if(Db(Ge)&&(en.ctx.renderer=Be),n6(en,!1,Ot),en.asyncDep){if(Dt&&Dt.registerDep(en,ye,Ot),!Ge.el){const dn=en.subTree=Ye(Ni);U(null,dn,Fe,Nt)}}else ye(en,Ge,Fe,Nt,Dt,xt,Ot)},Ee=(Ge,Fe,Nt)=>{const Jt=Fe.component=Ge.component;if(K5(Ge,Fe,Nt))if(Jt.asyncDep&&!Jt.asyncResolved){Me(Jt,Fe,Nt);return}else Jt.next=Fe,Jt.update();else Fe.el=Ge.el,Jt.vnode=Fe},ye=(Ge,Fe,Nt,Jt,Dt,xt,Ot)=>{const en=()=>{if(Ge.isMounted){let{next:gt,bu:Sn,u:Vn,parent:lo,vnode:eo}=Ge;{const _n=vR(Ge);if(_n){gt&&(gt.el=eo.el,Me(Ge,gt,Ot)),_n.asyncDep.then(()=>{Ge.isUnmounted||en()});return}}let fo=gt,Lo;th(Ge,!1),gt?(gt.el=eo.el,Me(Ge,gt,Ot)):gt=eo,Sn&&M0(Sn),(Lo=gt.props&&gt.props.onVnodeBeforeUpdate)&&Fl(Lo,lo,gt,eo),th(Ge,!0);const er=aw(Ge),Pt=Ge.subTree;Ge.subTree=er,F(Pt,er,R(Pt.el),mt(Pt),Ge,Dt,xt),gt.el=er.el,fo===null&&Z5(Ge,er.el),Vn&&Ds(Vn,Dt),(Lo=gt.props&&gt.props.onVnodeUpdated)&&Ds(()=>Fl(Lo,lo,gt,eo),Dt)}else{let gt;const{el:Sn,props:Vn}=Fe,{bm:lo,m:eo,parent:fo,root:Lo,type:er}=Ge,Pt=pp(Fe);if(th(Ge,!1),lo&&M0(lo),!Pt&&(gt=Vn&&Vn.onVnodeBeforeMount)&&Fl(gt,fo,Fe),th(Ge,!0),Sn&&At){const _n=()=>{Ge.subTree=aw(Ge),At(Sn,Ge.subTree,Ge,Dt,null)};Pt&&er.__asyncHydrate?er.__asyncHydrate(Sn,Ge,_n):_n()}else{Lo.ce&&Lo.ce._injectChildStyle(er);const _n=Ge.subTree=aw(Ge);F(null,_n,Nt,Jt,Ge,Dt,xt),Fe.el=_n.el}if(eo&&Ds(eo,Dt),!Pt&&(gt=Vn&&Vn.onVnodeMounted)){const _n=Fe;Ds(()=>Fl(gt,fo,_n),Dt)}(Fe.shapeFlag&256||fo&&pp(fo.vnode)&&fo.vnode.shapeFlag&256)&&Ge.a&&Ds(Ge.a,Dt),Ge.isMounted=!0,Fe=Nt=Jt=null}};Ge.scope.on();const dn=Ge.effect=new xP(en);Ge.scope.off();const un=Ge.update=dn.run.bind(dn),Pn=Ge.job=dn.runIfDirty.bind(dn);Pn.i=Ge,Pn.id=Ge.uid,dn.scheduler=()=>TS(Pn),th(Ge,!0),un()},Me=(Ge,Fe,Nt)=>{Fe.component=Ge;const Jt=Ge.vnode.props;Ge.vnode=Fe,Ge.next=null,R5(Ge,Fe.props,Jt,Nt),z5(Ge,Fe.children,Nt),sd(),UI(Ge),ad()},Te=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn=!1)=>{const un=Ge&&Ge.children,Pn=Ge?Ge.shapeFlag:0,gt=Fe.children,{patchFlag:Sn,shapeFlag:Vn}=Fe;if(Sn>0){if(Sn&128){ke(un,gt,Nt,Jt,Dt,xt,Ot,en,dn);return}else if(Sn&256){he(un,gt,Nt,Jt,Dt,xt,Ot,en,dn);return}}Vn&8?(Pn&16&&Bt(un,Dt,xt),gt!==un&&I(Nt,gt)):Pn&16?Vn&16?ke(un,gt,Nt,Jt,Dt,xt,Ot,en,dn):Bt(un,Dt,xt,!0):(Pn&8&&I(Nt,""),Vn&16&&fe(gt,Nt,Jt,Dt,xt,Ot,en,dn))},he=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn)=>{Ge=Ge||up,Fe=Fe||up;const un=Ge.length,Pn=Fe.length,gt=Math.min(un,Pn);let Sn;for(Sn=0;Sn<gt;Sn++){const Vn=Fe[Sn]=dn?$u(Fe[Sn]):Vl(Fe[Sn]);F(Ge[Sn],Vn,Nt,null,Dt,xt,Ot,en,dn)}un>Pn?Bt(Ge,Dt,xt,!0,!1,gt):fe(Fe,Nt,Jt,Dt,xt,Ot,en,dn,gt)},ke=(Ge,Fe,Nt,Jt,Dt,xt,Ot,en,dn)=>{let un=0;const Pn=Fe.length;let gt=Ge.length-1,Sn=Pn-1;for(;un<=gt&&un<=Sn;){const Vn=Ge[un],lo=Fe[un]=dn?$u(Fe[un]):Vl(Fe[un]);if(sh(Vn,lo))F(Vn,lo,Nt,null,Dt,xt,Ot,en,dn);else break;un++}for(;un<=gt&&un<=Sn;){const Vn=Ge[gt],lo=Fe[Sn]=dn?$u(Fe[Sn]):Vl(Fe[Sn]);if(sh(Vn,lo))F(Vn,lo,Nt,null,Dt,xt,Ot,en,dn);else break;gt--,Sn--}if(un>gt){if(un<=Sn){const Vn=Sn+1,lo=Vn<Pn?Fe[Vn].el:Jt;for(;un<=Sn;)F(null,Fe[un]=dn?$u(Fe[un]):Vl(Fe[un]),Nt,lo,Dt,xt,Ot,en,dn),un++}}else if(un>Sn)for(;un<=gt;)nt(Ge[un],Dt,xt,!0),un++;else{const Vn=un,lo=un,eo=new Map;for(un=lo;un<=Sn;un++){const Ze=Fe[un]=dn?$u(Fe[un]):Vl(Fe[un]);Ze.key!=null&&eo.set(Ze.key,un)}let fo,Lo=0;const er=Sn-lo+1;let Pt=!1,_n=0;const dt=new Array(er);for(un=0;un<er;un++)dt[un]=0;for(un=Vn;un<=gt;un++){const Ze=Ge[un];if(Lo>=er){nt(Ze,Dt,xt,!0);continue}let vn;if(Ze.key!=null)vn=eo.get(Ze.key);else for(fo=lo;fo<=Sn;fo++)if(dt[fo-lo]===0&&sh(Ze,Fe[fo])){vn=fo;break}vn===void 0?nt(Ze,Dt,xt,!0):(dt[vn-lo]=un+1,vn>=_n?_n=vn:Pt=!0,F(Ze,Fe[vn],Nt,null,Dt,xt,Ot,en,dn),Lo++)}const tn=Pt?$5(dt):up;for(fo=tn.length-1,un=er-1;un>=0;un--){const Ze=lo+un,vn=Fe[Ze],Mn=Ze+1<Pn?Fe[Ze+1].el:Jt;dt[un]===0?F(null,vn,Nt,Mn,Dt,xt,Ot,en,dn):Pt&&(fo<0||un!==tn[fo]?Ne(vn,Nt,Mn,2):fo--)}}},Ne=(Ge,Fe,Nt,Jt,Dt=null)=>{const{el:xt,type:Ot,transition:en,children:dn,shapeFlag:un}=Ge;if(un&6){Ne(Ge.component.subTree,Fe,Nt,Jt);return}if(un&128){Ge.suspense.move(Fe,Nt,Jt);return}if(un&64){Ot.move(Ge,Fe,Nt,Be);return}if(Ot===Fn){a(xt,Fe,Nt);for(let gt=0;gt<dn.length;gt++)Ne(dn[gt],Fe,Nt,Jt);a(Ge.anchor,Fe,Nt);return}if(Ot===lw){K(Ge,Fe,Nt);return}if(Jt!==2&&un&1&&en)if(Jt===0)en.beforeEnter(xt),a(xt,Fe,Nt),Ds(()=>en.enter(xt),Dt);else{const{leave:gt,delayLeave:Sn,afterLeave:Vn}=en,lo=()=>a(xt,Fe,Nt),eo=()=>{gt(xt,()=>{lo(),Vn&&Vn()})};Sn?Sn(xt,lo,eo):eo()}else a(xt,Fe,Nt)},nt=(Ge,Fe,Nt,Jt=!1,Dt=!1)=>{const{type:xt,props:Ot,ref:en,children:dn,dynamicChildren:un,shapeFlag:Pn,patchFlag:gt,dirs:Sn,cacheIndex:Vn}=Ge;if(gt===-2&&(Dt=!1),en!=null&&J0(en,null,Nt,Ge,!0),Vn!=null&&(Fe.renderCache[Vn]=void 0),Pn&256){Fe.ctx.deactivate(Ge);return}const lo=Pn&1&&Sn,eo=!pp(Ge);let fo;if(eo&&(fo=Ot&&Ot.onVnodeBeforeUnmount)&&Fl(fo,Fe,Ge),Pn&6)Rt(Ge.component,Nt,Jt);else{if(Pn&128){Ge.suspense.unmount(Nt,Jt);return}lo&&eh(Ge,null,Fe,"beforeUnmount"),Pn&64?Ge.type.remove(Ge,Fe,Nt,Be,Jt):un&&!un.hasOnce&&(xt!==Fn||gt>0&&gt&64)?Bt(un,Fe,Nt,!1,!0):(xt===Fn&&gt&384||!Dt&&Pn&16)&&Bt(dn,Fe,Nt),Jt&&De(Ge)}(eo&&(fo=Ot&&Ot.onVnodeUnmounted)||lo)&&Ds(()=>{fo&&Fl(fo,Fe,Ge),lo&&eh(Ge,null,Fe,"unmounted")},Nt)},De=Ge=>{const{type:Fe,el:Nt,anchor:Jt,transition:Dt}=Ge;if(Fe===Fn){Ct(Nt,Jt);return}if(Fe===lw){q(Ge);return}const xt=()=>{d(Nt),Dt&&!Dt.persisted&&Dt.afterLeave&&Dt.afterLeave()};if(Ge.shapeFlag&1&&Dt&&!Dt.persisted){const{leave:Ot,delayLeave:en}=Dt,dn=()=>Ot(Nt,xt);en?en(Ge.el,xt,dn):dn()}else xt()},Ct=(Ge,Fe)=>{let Nt;for(;Ge!==Fe;)Nt=z(Ge),d(Ge),Ge=Nt;d(Fe)},Rt=(Ge,Fe,Nt)=>{const{bum:Jt,scope:Dt,job:xt,subTree:Ot,um:en,m:dn,a:un}=Ge;QI(dn),QI(un),Jt&&M0(Jt),Dt.stop(),xt&&(xt.flags|=8,nt(Ot,Ge,Fe,Nt)),en&&Ds(en,Fe),Ds(()=>{Ge.isUnmounted=!0},Fe),Fe&&Fe.pendingBranch&&!Fe.isUnmounted&&Ge.asyncDep&&!Ge.asyncResolved&&Ge.suspenseId===Fe.pendingId&&(Fe.deps--,Fe.deps===0&&Fe.resolve())},Bt=(Ge,Fe,Nt,Jt=!1,Dt=!1,xt=0)=>{for(let Ot=xt;Ot<Ge.length;Ot++)nt(Ge[Ot],Fe,Nt,Jt,Dt)},mt=Ge=>{if(Ge.shapeFlag&6)return mt(Ge.component.subTree);if(Ge.shapeFlag&128)return Ge.suspense.next();const Fe=z(Ge.anchor||Ge.el),Nt=Fe&&Fe[HP];return Nt?z(Nt):Fe};let Gt=!1;const jt=(Ge,Fe,Nt)=>{Ge==null?Fe._vnode&&nt(Fe._vnode,null,null,!0):F(Fe._vnode||null,Ge,Fe,null,null,null,Nt),Fe._vnode=Ge,Gt||(Gt=!0,UI(),VP(),Gt=!1)},Be={p:F,um:nt,m:Ne,r:De,mt:Qe,mc:fe,pc:Te,pbc:ce,n:mt,o:e};let an,At;return{render:jt,hydrate:an,createApp:k5(jt,an)}}function sw({type:e,props:t},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:i}function th({effect:e,job:t},i){i?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function N5(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function PS(e,t,i=!1){const a=e.children,d=t.children;if(sn(a)&&sn(d))for(let g=0;g<a.length;g++){const _=a[g];let o=d[g];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=d[g]=$u(d[g]),o.el=_.el),!i&&o.patchFlag!==-2&&PS(_,o)),o.type===Up&&(o.el=_.el)}}function $5(e){const t=e.slice(),i=[0];let a,d,g,_,o;const S=e.length;for(a=0;a<S;a++){const E=e[a];if(E!==0){if(d=i[i.length-1],e[d]<E){t[a]=d,i.push(a);continue}for(g=0,_=i.length-1;g<_;)o=g+_>>1,e[i[o]]<E?g=o+1:_=o;E<e[i[g]]&&(g>0&&(t[a]=i[g-1]),i[g]=a)}}for(g=i.length,_=i[g-1];g-- >0;)i[g]=_,_=t[_];return i}function vR(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:vR(t)}function QI(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const V5=Symbol.for("v-scx"),U5=()=>kn(V5);function ns(e,t){return RS(e,null,t)}function qt(e,t,i){return RS(e,t,i)}function RS(e,t,i=li){const{immediate:a,deep:d,flush:g,once:_}=i,o=Ii({},i),S=t&&a||!t&&g!=="post";let E;if(Mv){if(g==="sync"){const N=U5();E=N.__watcherHandles||(N.__watcherHandles=[])}else if(!S){const N=()=>{};return N.stop=xr,N.resume=xr,N.pause=xr,N}}const I=ts;o.call=(N,$,F)=>_l(N,I,$,F);let R=!1;g==="post"?o.scheduler=N=>{Ds(N,I&&I.suspense)}:g!=="sync"&&(R=!0,o.scheduler=(N,$)=>{$?N():TS(N)}),o.augmentJob=N=>{t&&(N.flags|=4),R&&(N.flags|=2,I&&(N.id=I.uid,N.i=I))};const z=l5(e,t,o);return Mv&&(E?E.push(z):S&&z()),z}function j5(e,t,i){const a=this.proxy,d=Bn(e)?e.includes(".")?_R(a,e):()=>a[e]:e.bind(a,a);let g;Nn(t)?g=t:(g=t.handler,i=t);const _=Qv(this),o=RS(d,g.bind(a),i);return _(),o}function _R(e,t){const i=t.split(".");return()=>{let a=e;for(let d=0;d<i.length&&a;d++)a=a[i[d]];return a}}const H5=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Js(t)}Modifiers`]||e[`${Pc(t)}Modifiers`];function G5(e,t,...i){if(e.isUnmounted)return;const a=e.vnode.props||li;let d=i;const g=t.startsWith("update:"),_=g&&H5(a,t.slice(7));_&&(_.trim&&(d=i.map(I=>Bn(I)?I.trim():I)),_.number&&(d=i.map(Uw)));let o,S=a[o=av(t)]||a[o=av(Js(t))];!S&&g&&(S=a[o=av(Pc(t))]),S&&_l(S,e,6,d);const E=a[o+"Once"];if(E){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,_l(E,e,6,d)}}function yR(e,t,i=!1){const a=t.emitsCache,d=a.get(e);if(d!==void 0)return d;const g=e.emits;let _={},o=!1;if(!Nn(e)){const S=E=>{const I=yR(E,t,!0);I&&(o=!0,Ii(_,I))};!i&&t.mixins.length&&t.mixins.forEach(S),e.extends&&S(e.extends),e.mixins&&e.mixins.forEach(S)}return!g&&!o?(So(e)&&a.set(e,null),null):(sn(g)?g.forEach(S=>_[S]=null):Ii(_,g),So(e)&&a.set(e,_),_)}function Bb(e,t){return!e||!Eb(t)?!1:(t=t.slice(2).replace(/Once$/,""),or(e,t[0].toLowerCase()+t.slice(1))||or(e,Pc(t))||or(e,t))}function aw(e){const{type:t,vnode:i,proxy:a,withProxy:d,propsOptions:[g],slots:_,attrs:o,emit:S,render:E,renderCache:I,props:R,data:z,setupState:N,ctx:$,inheritAttrs:F}=e,W=X0(e);let U,re;try{if(i.shapeFlag&4){const q=d||a,J=q;U=Vl(E.call(J,q,I,R,N,z,$)),re=o}else{const q=t;U=Vl(q.length>1?q(R,{attrs:o,slots:_,emit:S}):q(R,null)),re=t.props?o:W5(o)}}catch(q){hv.length=0,Rb(q,e,1),U=Ye(Ni)}let K=U;if(re&&F!==!1){const q=Object.keys(re),{shapeFlag:J}=K;q.length&&J&7&&(g&&q.some(mS)&&(re=q5(re,g)),K=Ic(K,re,!1,!0))}return i.dirs&&(K=Ic(K,null,!1,!0),K.dirs=K.dirs?K.dirs.concat(i.dirs):i.dirs),i.transition&&xh(K,i.transition),U=K,X0(W),U}const W5=e=>{let t;for(const i in e)(i==="class"||i==="style"||Eb(i))&&((t||(t={}))[i]=e[i]);return t},q5=(e,t)=>{const i={};for(const a in e)(!mS(a)||!(a.slice(9)in t))&&(i[a]=e[a]);return i};function K5(e,t,i){const{props:a,children:d,component:g}=e,{props:_,children:o,patchFlag:S}=t,E=g.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&S>=0){if(S&1024)return!0;if(S&16)return a?eA(a,_,E):!!_;if(S&8){const I=t.dynamicProps;for(let R=0;R<I.length;R++){const z=I[R];if(_[z]!==a[z]&&!Bb(E,z))return!0}}}else return(d||o)&&(!o||!o.$stable)?!0:a===_?!1:a?_?eA(a,_,E):!0:!!_;return!1}function eA(e,t,i){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let d=0;d<a.length;d++){const g=a[d];if(t[g]!==e[g]&&!Bb(i,g))return!0}return!1}function Z5({vnode:e,parent:t},i){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=i,t=t.parent;else break}}const bR=e=>e.__isSuspense;function Y5(e,t){t&&t.pendingBranch?sn(e)?t.effects.push(...e):t.effects.push(e):d5(e)}const Fn=Symbol.for("v-fgt"),Up=Symbol.for("v-txt"),Ni=Symbol.for("v-cmt"),lw=Symbol.for("v-stc"),hv=[];let fa=null;function se(e=!1){hv.push(fa=e?null:[])}function X5(){hv.pop(),fa=hv[hv.length-1]||null}let Ev=1;function tA(e,t=!1){Ev+=e,e<0&&fa&&t&&(fa.hasOnce=!0)}function xR(e){return e.dynamicChildren=Ev>0?fa||up:null,X5(),Ev>0&&fa&&fa.push(e),e}function Ie(e,t,i,a,d,g){return xR(je(e,t,i,a,d,g,!0))}function Et(e,t,i,a,d){return xR(Ye(e,t,i,a,d,!0))}function Yr(e){return e?e.__v_isVNode===!0:!1}function sh(e,t){return e.type===t.type&&e.key===t.key}const wR=({key:e})=>e??null,A0=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Bn(e)||Hr(e)||Nn(e)?{i:Wi,r:e,k:t,f:!!i}:e:null);function je(e,t=null,i=null,a=0,d=null,g=e===Fn?0:1,_=!1,o=!1){const S={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&wR(t),ref:t&&A0(t),scopeId:jP,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:a,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:Wi};return o?(DS(S,i),g&128&&e.normalize(S)):i&&(S.shapeFlag|=Bn(i)?8:16),Ev>0&&!_&&fa&&(S.patchFlag>0||g&6)&&S.patchFlag!==32&&fa.push(S),S}const Ye=J5;function J5(e,t=null,i=null,a=0,d=null,g=!1){if((!e||e===oR)&&(e=Ni),Yr(e)){const o=Ic(e,t,!0);return i&&DS(o,i),Ev>0&&!g&&fa&&(o.shapeFlag&6?fa[fa.indexOf(e)]=o:fa.push(o)),o.patchFlag=-2,o}if(s6(e)&&(e=e.__vccOpts),t){t=Xu(t);let{class:o,style:S}=t;o&&!Bn(o)&&(t.class=ue(o)),So(S)&&(SS(S)&&!sn(S)&&(S=Ii({},S)),t.style=$n(S))}const _=Bn(e)?1:bR(e)?128:GP(e)?64:So(e)?4:Nn(e)?2:0;return je(e,t,i,a,d,_,g,!0)}function Xu(e){return e?SS(e)||uR(e)?Ii({},e):e:null}function Ic(e,t,i=!1,a=!1){const{props:d,ref:g,patchFlag:_,children:o,transition:S}=e,E=t?Po(d||{},t):d,I={__v_isVNode:!0,__v_skip:!0,type:e.type,props:E,key:E&&wR(E),ref:t&&t.ref?i&&g?sn(g)?g.concat(A0(t)):[g,A0(t)]:A0(t):g,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Fn?_===-1?16:_|16:_,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:S,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ic(e.ssContent),ssFallback:e.ssFallback&&Ic(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return S&&a&&xh(I,S.clone(I)),I}function $o(e=" ",t=0){return Ye(Up,null,e,t)}function yt(e="",t=!1){return t?(se(),Et(Ni,null,e)):Ye(Ni,null,e)}function Vl(e){return e==null||typeof e=="boolean"?Ye(Ni):sn(e)?Ye(Fn,null,e.slice()):Yr(e)?$u(e):Ye(Up,null,String(e))}function $u(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ic(e)}function DS(e,t){let i=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(sn(t))i=16;else if(typeof t=="object")if(a&65){const d=t.default;d&&(d._c&&(d._d=!1),DS(e,d()),d._c&&(d._d=!0));return}else{i=32;const d=t._;!d&&!uR(t)?t._ctx=Wi:d===3&&Wi&&(Wi.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Nn(t)?(t={default:t,_ctx:Wi},i=32):(t=String(t),a&64?(i=16,t=[$o(t)]):i=8);e.children=t,e.shapeFlag|=i}function Po(...e){const t={};for(let i=0;i<e.length;i++){const a=e[i];for(const d in a)if(d==="class")t.class!==a.class&&(t.class=ue([t.class,a.class]));else if(d==="style")t.style=$n([t.style,a.style]);else if(Eb(d)){const g=t[d],_=a[d];_&&g!==_&&!(sn(g)&&g.includes(_))&&(t[d]=g?[].concat(g,_):_)}else d!==""&&(t[d]=a[d])}return t}function Fl(e,t,i,a=null){_l(e,t,7,[i,a])}const Q5=aR();let e6=0;function t6(e,t,i){const a=e.type,d=(t?t.appContext:e.appContext)||Q5,g={uid:e6++,vnode:e,type:a,parent:t,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new _P(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(d.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:hR(a,d),emitsOptions:yR(a,d),emit:null,emitted:null,propsDefaults:li,inheritAttrs:a.inheritAttrs,ctx:li,data:li,props:li,attrs:li,slots:li,refs:li,setupState:li,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=t?t.root:g,g.emit=G5.bind(null,g),e.ce&&e.ce(g),g}let ts=null;const To=()=>ts||Wi;let eb,Jw;{const e=Ab(),t=(i,a)=>{let d;return(d=e[i])||(d=e[i]=[]),d.push(a),g=>{d.length>1?d.forEach(_=>_(g)):d[0](g)}};eb=t("__VUE_INSTANCE_SETTERS__",i=>ts=i),Jw=t("__VUE_SSR_SETTERS__",i=>Mv=i)}const Qv=e=>{const t=ts;return eb(e),e.scope.on(),()=>{e.scope.off(),eb(t)}},nA=()=>{ts&&ts.scope.off(),eb(null)};function SR(e){return e.vnode.shapeFlag&4}let Mv=!1;function n6(e,t=!1,i=!1){t&&Jw(t);const{props:a,children:d}=e.vnode,g=SR(e);P5(e,a,g,t),O5(e,d,i);const _=g?o6(e,t):void 0;return t&&Jw(!1),_}function o6(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,S5);const{setup:a}=i;if(a){sd();const d=e.setupContext=a.length>1?CR(e):null,g=Qv(e),_=Jv(a,e,0,[e.props,d]),o=bv(_);if(ad(),g(),(o||e.sp)&&!pp(e)&&QP(e),o){if(_.then(nA,nA),t)return _.then(S=>{oA(e,S,t)}).catch(S=>{Rb(S,e,0)});e.asyncDep=_}else oA(e,_,t)}else TR(e,t)}function oA(e,t,i){Nn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:So(t)&&(e.setupState=BP(t)),TR(e,i)}let rA;function TR(e,t,i){const a=e.type;if(!e.render){if(!t&&rA&&!a.render){const d=a.template||AS(e).template;if(d){const{isCustomElement:g,compilerOptions:_}=e.appContext.config,{delimiters:o,compilerOptions:S}=a,E=Ii(Ii({isCustomElement:g,delimiters:o},_),S);a.render=rA(d,E)}}e.render=a.render||xr}{const d=Qv(e);sd();try{T5(e)}finally{ad(),d()}}}const r6={get(e,t){return ps(e,"get",""),e[t]}};function CR(e){const t=i=>{e.exposed=i||{}};return{attrs:new Proxy(e.attrs,r6),slots:e.slots,emit:e.emit,expose:t}}function Fb(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(BP(Wu(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in dv)return dv[i](e)},has(t,i){return i in t||i in dv}})):e.proxy}function i6(e,t=!0){return Nn(e)?e.displayName||e.name:e.name||t&&e.__name}function s6(e){return Nn(e)&&"__vccOpts"in e}const ee=(e,t)=>s5(e,t,Mv);function Kn(e,t,i){const a=arguments.length;return a===2?So(t)&&!sn(t)?Yr(t)?Ye(e,null,[t]):Ye(e,t):Ye(e,null,t):(a>3?i=Array.prototype.slice.call(arguments,2):a===3&&Yr(i)&&(i=[i]),Ye(e,t,i))}const a6="3.5.13",l6=xr;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Qw;const iA=typeof window<"u"&&window.trustedTypes;if(iA)try{Qw=iA.createPolicy("vue",{createHTML:e=>e})}catch{}const ER=Qw?e=>Qw.createHTML(e):e=>e,c6="http://www.w3.org/2000/svg",u6="http://www.w3.org/1998/Math/MathML",wc=typeof document<"u"?document:null,sA=wc&&wc.createElement("template"),d6={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,a)=>{const d=t==="svg"?wc.createElementNS(c6,e):t==="mathml"?wc.createElementNS(u6,e):i?wc.createElement(e,{is:i}):wc.createElement(e);return e==="select"&&a&&a.multiple!=null&&d.setAttribute("multiple",a.multiple),d},createText:e=>wc.createTextNode(e),createComment:e=>wc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>wc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,a,d,g){const _=i?i.previousSibling:t.lastChild;if(d&&(d===g||d.nextSibling))for(;t.insertBefore(d.cloneNode(!0),i),!(d===g||!(d=d.nextSibling)););else{sA.innerHTML=ER(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const o=sA.content;if(a==="svg"||a==="mathml"){const S=o.firstChild;for(;S.firstChild;)o.appendChild(S.firstChild);o.removeChild(S)}t.insertBefore(o,i)}return[_?_.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}},Ru="transition",Zg="animation",Sp=Symbol("_vtc"),MR={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},IR=Ii({},ZP,MR),h6=e=>(e.displayName="Transition",e.props=IR,e),Ui=h6((e,{slots:t})=>Kn(m5,AR(e),t)),nh=(e,t=[])=>{sn(e)?e.forEach(i=>i(...t)):e&&e(...t)},aA=e=>e?sn(e)?e.some(t=>t.length>1):e.length>1:!1;function AR(e){const t={};for(const _e in e)_e in MR||(t[_e]=e[_e]);if(e.css===!1)return t;const{name:i="v",type:a,duration:d,enterFromClass:g=`${i}-enter-from`,enterActiveClass:_=`${i}-enter-active`,enterToClass:o=`${i}-enter-to`,appearFromClass:S=g,appearActiveClass:E=_,appearToClass:I=o,leaveFromClass:R=`${i}-leave-from`,leaveActiveClass:z=`${i}-leave-active`,leaveToClass:N=`${i}-leave-to`}=e,$=f6(d),F=$&&$[0],W=$&&$[1],{onBeforeEnter:U,onEnter:re,onEnterCancelled:K,onLeave:q,onLeaveCancelled:J,onBeforeAppear:oe=U,onAppear:ae=re,onAppearCancelled:fe=K}=t,ge=(_e,Re,Qe,Ee)=>{_e._enterCancelled=Ee,Lu(_e,Re?I:o),Lu(_e,Re?E:_),Qe&&Qe()},ce=(_e,Re)=>{_e._isLeaving=!1,Lu(_e,R),Lu(_e,N),Lu(_e,z),Re&&Re()},de=_e=>(Re,Qe)=>{const Ee=_e?ae:re,ye=()=>ge(Re,_e,Qe);nh(Ee,[Re,ye]),lA(()=>{Lu(Re,_e?S:g),Nl(Re,_e?I:o),aA(Ee)||cA(Re,a,F,ye)})};return Ii(t,{onBeforeEnter(_e){nh(U,[_e]),Nl(_e,g),Nl(_e,_)},onBeforeAppear(_e){nh(oe,[_e]),Nl(_e,S),Nl(_e,E)},onEnter:de(!1),onAppear:de(!0),onLeave(_e,Re){_e._isLeaving=!0;const Qe=()=>ce(_e,Re);Nl(_e,R),_e._enterCancelled?(Nl(_e,z),e2()):(e2(),Nl(_e,z)),lA(()=>{_e._isLeaving&&(Lu(_e,R),Nl(_e,N),aA(q)||cA(_e,a,W,Qe))}),nh(q,[_e,Qe])},onEnterCancelled(_e){ge(_e,!1,void 0,!0),nh(K,[_e])},onAppearCancelled(_e){ge(_e,!0,void 0,!0),nh(fe,[_e])},onLeaveCancelled(_e){ce(_e),nh(J,[_e])}})}function f6(e){if(e==null)return null;if(So(e))return[cw(e.enter),cw(e.leave)];{const t=cw(e);return[t,t]}}function cw(e){return CN(e)}function Nl(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e[Sp]||(e[Sp]=new Set)).add(t)}function Lu(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const i=e[Sp];i&&(i.delete(t),i.size||(e[Sp]=void 0))}function lA(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let p6=0;function cA(e,t,i,a){const d=e._endId=++p6,g=()=>{d===e._endId&&a()};if(i!=null)return setTimeout(g,i);const{type:_,timeout:o,propCount:S}=kR(e,t);if(!_)return a();const E=_+"end";let I=0;const R=()=>{e.removeEventListener(E,z),g()},z=N=>{N.target===e&&++I>=S&&R()};setTimeout(()=>{I<S&&R()},o+1),e.addEventListener(E,z)}function kR(e,t){const i=window.getComputedStyle(e),a=$=>(i[$]||"").split(", "),d=a(`${Ru}Delay`),g=a(`${Ru}Duration`),_=uA(d,g),o=a(`${Zg}Delay`),S=a(`${Zg}Duration`),E=uA(o,S);let I=null,R=0,z=0;t===Ru?_>0&&(I=Ru,R=_,z=g.length):t===Zg?E>0&&(I=Zg,R=E,z=S.length):(R=Math.max(_,E),I=R>0?_>E?Ru:Zg:null,z=I?I===Ru?g.length:S.length:0);const N=I===Ru&&/\b(transform|all)(,|$)/.test(a(`${Ru}Property`).toString());return{type:I,timeout:R,propCount:z,hasTransform:N}}function uA(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,a)=>dA(i)+dA(e[a])))}function dA(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function e2(){return document.body.offsetHeight}function m6(e,t,i){const a=e[Sp];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}const tb=Symbol("_vod"),PR=Symbol("_vsh"),ir={beforeMount(e,{value:t},{transition:i}){e[tb]=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):Yg(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:a}){!t!=!i&&(a?t?(a.beforeEnter(e),Yg(e,!0),a.enter(e)):a.leave(e,()=>{Yg(e,!1)}):Yg(e,t))},beforeUnmount(e,{value:t}){Yg(e,t)}};function Yg(e,t){e.style.display=t?e[tb]:"none",e[PR]=!t}const g6=Symbol(""),v6=/(^|;)\s*display\s*:/;function _6(e,t,i){const a=e.style,d=Bn(i);let g=!1;if(i&&!d){if(t)if(Bn(t))for(const _ of t.split(";")){const o=_.slice(0,_.indexOf(":")).trim();i[o]==null&&k0(a,o,"")}else for(const _ in t)i[_]==null&&k0(a,_,"");for(const _ in i)_==="display"&&(g=!0),k0(a,_,i[_])}else if(d){if(t!==i){const _=a[g6];_&&(i+=";"+_),a.cssText=i,g=v6.test(i)}}else t&&e.removeAttribute("style");tb in e&&(e[tb]=g?a.display:"",e[PR]&&(a.display="none"))}const hA=/\s*!important$/;function k0(e,t,i){if(sn(i))i.forEach(a=>k0(e,t,a));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const a=y6(e,t);hA.test(i)?e.setProperty(Pc(a),i.replace(hA,""),"important"):e[a]=i}}const fA=["Webkit","Moz","ms"],uw={};function y6(e,t){const i=uw[t];if(i)return i;let a=Js(t);if(a!=="filter"&&a in e)return uw[t]=a;a=Xv(a);for(let d=0;d<fA.length;d++){const g=fA[d]+a;if(g in e)return uw[t]=g}return t}const pA="http://www.w3.org/1999/xlink";function mA(e,t,i,a,d,g=PN(t)){a&&t.startsWith("xlink:")?i==null?e.removeAttributeNS(pA,t.slice(6,t.length)):e.setAttributeNS(pA,t,i):i==null||g&&!pP(i)?e.removeAttribute(t):e.setAttribute(t,g?"":vl(i)?String(i):i)}function gA(e,t,i,a,d){if(t==="innerHTML"||t==="textContent"){i!=null&&(e[t]=t==="innerHTML"?ER(i):i);return}const g=e.tagName;if(t==="value"&&g!=="PROGRESS"&&!g.includes("-")){const o=g==="OPTION"?e.getAttribute("value")||"":e.value,S=i==null?e.type==="checkbox"?"on":"":String(i);(o!==S||!("_value"in e))&&(e.value=S),i==null&&e.removeAttribute(t),e._value=i;return}let _=!1;if(i===""||i==null){const o=typeof e[t];o==="boolean"?i=pP(i):i==null&&o==="string"?(i="",_=!0):o==="number"&&(i=0,_=!0)}try{e[t]=i}catch{}_&&e.removeAttribute(d||t)}function Vu(e,t,i,a){e.addEventListener(t,i,a)}function b6(e,t,i,a){e.removeEventListener(t,i,a)}const vA=Symbol("_vei");function x6(e,t,i,a,d=null){const g=e[vA]||(e[vA]={}),_=g[t];if(a&&_)_.value=a;else{const[o,S]=w6(t);if(a){const E=g[t]=C6(a,d);Vu(e,o,E,S)}else _&&(b6(e,o,_,S),g[t]=void 0)}}const _A=/(?:Once|Passive|Capture)$/;function w6(e){let t;if(_A.test(e)){t={};let a;for(;a=e.match(_A);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Pc(e.slice(2)),t]}let dw=0;const S6=Promise.resolve(),T6=()=>dw||(S6.then(()=>dw=0),dw=Date.now());function C6(e,t){const i=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=i.attached)return;_l(E6(a,i.value),t,5,[a])};return i.value=e,i.attached=T6(),i}function E6(e,t){if(sn(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(a=>d=>!d._stopped&&a&&a(d))}else return t}const yA=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,M6=(e,t,i,a,d,g)=>{const _=d==="svg";t==="class"?m6(e,a,_):t==="style"?_6(e,i,a):Eb(t)?mS(t)||x6(e,t,i,a,g):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):I6(e,t,a,_))?(gA(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&mA(e,t,a,_,g,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Bn(a))?gA(e,Js(t),a,g,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),mA(e,t,a,_))};function I6(e,t,i,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&yA(t)&&Nn(i));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const d=e.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return yA(t)&&Bn(i)?!1:t in e}const RR=new WeakMap,DR=new WeakMap,nb=Symbol("_moveCb"),bA=Symbol("_enterCb"),A6=e=>(delete e.props.mode,e),k6=A6({name:"TransitionGroup",props:Ii({},IR,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=To(),a=KP();let d,g;return Xl(()=>{if(!d.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!L6(d[0].el,i.vnode.el,_))return;d.forEach(P6),d.forEach(R6);const o=d.filter(D6);e2(),o.forEach(S=>{const E=S.el,I=E.style;Nl(E,_),I.transform=I.webkitTransform=I.transitionDuration="";const R=E[nb]=z=>{z&&z.target!==E||(!z||/transform$/.test(z.propertyName))&&(E.removeEventListener("transitionend",R),E[nb]=null,Lu(E,_))};E.addEventListener("transitionend",R)})}),()=>{const _=Ar(e),o=AR(_);let S=_.tag||Fn;if(d=[],g)for(let E=0;E<g.length;E++){const I=g[E];I.el&&I.el instanceof Element&&(d.push(I),xh(I,Cv(I,o,a,i)),RR.set(I,I.el.getBoundingClientRect()))}g=t.default?CS(t.default()):[];for(let E=0;E<g.length;E++){const I=g[E];I.key!=null&&xh(I,Cv(I,o,a,i))}return Ye(S,null,g)}}}),LR=k6;function P6(e){const t=e.el;t[nb]&&t[nb](),t[bA]&&t[bA]()}function R6(e){DR.set(e,e.el.getBoundingClientRect())}function D6(e){const t=RR.get(e),i=DR.get(e),a=t.left-i.left,d=t.top-i.top;if(a||d){const g=e.el.style;return g.transform=g.webkitTransform=`translate(${a}px,${d}px)`,g.transitionDuration="0s",e}}function L6(e,t,i){const a=e.cloneNode(),d=e[Sp];d&&d.forEach(o=>{o.split(/\s+/).forEach(S=>S&&a.classList.remove(S))}),i.split(/\s+/).forEach(o=>o&&a.classList.add(o)),a.style.display="none";const g=t.nodeType===1?t:t.parentNode;g.appendChild(a);const{hasTransform:_}=kR(a);return g.removeChild(a),_}const Tp=e=>{const t=e.props["onUpdate:modelValue"]||!1;return sn(t)?i=>M0(t,i):t};function O6(e){e.target.composing=!0}function xA(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Mc=Symbol("_assign"),LS={created(e,{modifiers:{lazy:t,trim:i,number:a}},d){e[Mc]=Tp(d);const g=a||d.props&&d.props.type==="number";Vu(e,t?"change":"input",_=>{if(_.target.composing)return;let o=e.value;i&&(o=o.trim()),g&&(o=Uw(o)),e[Mc](o)}),i&&Vu(e,"change",()=>{e.value=e.value.trim()}),t||(Vu(e,"compositionstart",O6),Vu(e,"compositionend",xA),Vu(e,"change",xA))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:i,modifiers:{lazy:a,trim:d,number:g}},_){if(e[Mc]=Tp(_),e.composing)return;const o=(g||e.type==="number")&&!/^0\d/.test(e.value)?Uw(e.value):e.value,S=t??"";o!==S&&(document.activeElement===e&&e.type!=="range"&&(a&&t===i||d&&e.value.trim()===S)||(e.value=S))}},ob={deep:!0,created(e,t,i){e[Mc]=Tp(i),Vu(e,"change",()=>{const a=e._modelValue,d=zR(e),g=e.checked,_=e[Mc];if(sn(a)){const o=mP(a,d),S=o!==-1;if(g&&!S)_(a.concat(d));else if(!g&&S){const E=[...a];E.splice(o,1),_(E)}}else if(Mb(a)){const o=new Set(a);g?o.add(d):o.delete(d),_(o)}else _(BR(e,g))})},mounted:wA,beforeUpdate(e,t,i){e[Mc]=Tp(i),wA(e,t,i)}};function wA(e,{value:t,oldValue:i},a){e._modelValue=t;let d;if(sn(t))d=mP(t,a.props.value)>-1;else if(Mb(t))d=t.has(a.props.value);else{if(t===i)return;d=wp(t,BR(e,!0))}e.checked!==d&&(e.checked=d)}const OR={created(e,{value:t},i){e.checked=wp(t,i.props.value),e[Mc]=Tp(i),Vu(e,"change",()=>{e[Mc](zR(e))})},beforeUpdate(e,{value:t,oldValue:i},a){e[Mc]=Tp(a),t!==i&&(e.checked=wp(t,a.props.value))}};function zR(e){return"_value"in e?e._value:e.value}function BR(e,t){const i=t?"_trueValue":"_falseValue";return i in e?e[i]:t}const z6=["ctrl","shift","alt","meta"],B6={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>z6.some(i=>e[`${i}Key`]&&!t.includes(i))},Xn=(e,t)=>{const i=e._withMods||(e._withMods={}),a=t.join(".");return i[a]||(i[a]=(d,...g)=>{for(let _=0;_<t.length;_++){const o=B6[t[_]];if(o&&o(d,t))return}return e(d,...g)})},F6={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},kr=(e,t)=>{const i=e._withKeys||(e._withKeys={}),a=t.join(".");return i[a]||(i[a]=d=>{if(!("key"in d))return;const g=Pc(d.key);if(t.some(_=>_===g||F6[_]===g))return e(d)})},N6=Ii({patchProp:M6},d6);let SA;function FR(){return SA||(SA=B5(N6))}const Ju=(...e)=>{FR().render(...e)},NR=(...e)=>{const t=FR().createApp(...e),{mount:i}=t;return t.mount=a=>{const d=V6(a);if(!d)return;const g=t._component;!Nn(g)&&!g.render&&!g.template&&(g.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const _=i(d,!1,$6(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},t};function $6(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function V6(e){return Bn(e)?document.querySelector(e):e}var Jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ql(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $R={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){var i,a,d;function g(o,S){if(!i)i=S;else if(!a)a=S;else{var E="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+a+")(sharedChunk); self.onerror = null;",I={};i(I),d=S(I),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}g(["exports"],function(o){function S(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var E,I={},R={};function z(){if(E)return R;E=1,Object.defineProperty(R,"__esModule",{value:!0}),R.setMatrixArrayType=function(m){R.ARRAY_TYPE=n=m},R.toRadian=function(m){return m*u},R.equals=function(m,h){return Math.abs(m-h)<=c*Math.max(1,Math.abs(m),Math.abs(h))},R.RANDOM=R.ARRAY_TYPE=R.EPSILON=void 0;var c=1e-6;R.EPSILON=c;var n=typeof Float32Array<"u"?Float32Array:Array;R.ARRAY_TYPE=n;var s=Math.random;R.RANDOM=s;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)}),R}var N,$={};function F(){if(N)return $;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}N=1,Object.defineProperty($,"__esModule",{value:!0}),$.create=function(){var h=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},$.clone=function(h){var v=new n.ARRAY_TYPE(4);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v},$.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h},$.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},$.fromValues=function(h,v,T,k){var L=new n.ARRAY_TYPE(4);return L[0]=h,L[1]=v,L[2]=T,L[3]=k,L},$.set=function(h,v,T,k,L){return h[0]=v,h[1]=T,h[2]=k,h[3]=L,h},$.transpose=function(h,v){if(h===v){var T=v[1];h[1]=v[2],h[2]=T}else h[0]=v[0],h[1]=v[2],h[2]=v[1],h[3]=v[3];return h},$.invert=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=T*x-L*k;return A?(h[0]=x*(A=1/A),h[1]=-k*A,h[2]=-L*A,h[3]=T*A,h):null},$.adjoint=function(h,v){var T=v[0];return h[0]=v[3],h[1]=-v[1],h[2]=-v[2],h[3]=T,h},$.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},$.multiply=u,$.rotate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=Math.sin(T),M=Math.cos(T);return h[0]=k*M+x*D,h[1]=L*M+A*D,h[2]=k*-D+x*M,h[3]=L*-D+A*M,h},$.scale=function(h,v,T){var k=v[1],L=v[2],x=v[3],A=T[0],D=T[1];return h[0]=v[0]*A,h[1]=k*A,h[2]=L*D,h[3]=x*D,h},$.fromRotation=function(h,v){var T=Math.sin(v),k=Math.cos(v);return h[0]=k,h[1]=T,h[2]=-T,h[3]=k,h},$.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h},$.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},$.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},$.LDU=function(h,v,T,k){return h[2]=k[2]/k[0],T[0]=k[0],T[1]=k[1],T[3]=k[3]-h[2]*T[1],[h,v,T]},$.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h},$.subtract=m,$.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]},$.equals=function(h,v){var T=h[0],k=h[1],L=h[2],x=h[3],A=v[0],D=v[1],M=v[2],P=v[3];return Math.abs(T-A)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(A))&&Math.abs(k-D)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(D))&&Math.abs(L-M)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(M))&&Math.abs(x-P)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(P))},$.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h},$.multiplyScalarAndAdd=function(h,v,T,k){return h[0]=v[0]+T[0]*k,h[1]=v[1]+T[1]*k,h[2]=v[2]+T[2]*k,h[3]=v[3]+T[3]*k,h},$.sub=$.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var k={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var A=L?Object.getOwnPropertyDescriptor(h,x):null;A&&(A.get||A.set)?Object.defineProperty(k,x,A):k[x]=h[x]}return k.default=h,T&&T.set(h,k),k}(z());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(k){return k?T:v})(h)}function u(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=T[0],M=T[1],P=T[2],B=T[3];return h[0]=k*D+x*M,h[1]=L*D+A*M,h[2]=k*P+x*B,h[3]=L*P+A*B,h}function m(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h}return $.mul=u,$.sub=m,$}var W,U={};function re(){if(W)return U;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}W=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var h=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},U.clone=function(h){var v=new n.ARRAY_TYPE(6);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v},U.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h},U.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},U.fromValues=function(h,v,T,k,L,x){var A=new n.ARRAY_TYPE(6);return A[0]=h,A[1]=v,A[2]=T,A[3]=k,A[4]=L,A[5]=x,A},U.set=function(h,v,T,k,L,x,A){return h[0]=v,h[1]=T,h[2]=k,h[3]=L,h[4]=x,h[5]=A,h},U.invert=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],D=v[5],M=T*x-k*L;return M?(h[0]=x*(M=1/M),h[1]=-k*M,h[2]=-L*M,h[3]=T*M,h[4]=(L*D-x*A)*M,h[5]=(k*A-T*D)*M,h):null},U.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},U.multiply=u,U.rotate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=v[4],M=v[5],P=Math.sin(T),B=Math.cos(T);return h[0]=k*B+x*P,h[1]=L*B+A*P,h[2]=k*-P+x*B,h[3]=L*-P+A*B,h[4]=D,h[5]=M,h},U.scale=function(h,v,T){var k=v[1],L=v[2],x=v[3],A=v[4],D=v[5],M=T[0],P=T[1];return h[0]=v[0]*M,h[1]=k*M,h[2]=L*P,h[3]=x*P,h[4]=A,h[5]=D,h},U.translate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=v[4],M=v[5],P=T[0],B=T[1];return h[0]=k,h[1]=L,h[2]=x,h[3]=A,h[4]=k*P+x*B+D,h[5]=L*P+A*B+M,h},U.fromRotation=function(h,v){var T=Math.sin(v),k=Math.cos(v);return h[0]=k,h[1]=T,h[2]=-T,h[3]=k,h[4]=0,h[5]=0,h},U.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h[4]=0,h[5]=0,h},U.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=v[0],h[5]=v[1],h},U.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},U.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},U.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h},U.subtract=m,U.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h},U.multiplyScalarAndAdd=function(h,v,T,k){return h[0]=v[0]+T[0]*k,h[1]=v[1]+T[1]*k,h[2]=v[2]+T[2]*k,h[3]=v[3]+T[3]*k,h[4]=v[4]+T[4]*k,h[5]=v[5]+T[5]*k,h},U.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]},U.equals=function(h,v){var T=h[0],k=h[1],L=h[2],x=h[3],A=h[4],D=h[5],M=v[0],P=v[1],B=v[2],H=v[3],Z=v[4],te=v[5];return Math.abs(T-M)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(M))&&Math.abs(k-P)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(P))&&Math.abs(L-B)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(B))&&Math.abs(x-H)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(H))&&Math.abs(A-Z)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(Z))&&Math.abs(D-te)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(te))},U.sub=U.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var k={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var A=L?Object.getOwnPropertyDescriptor(h,x):null;A&&(A.get||A.set)?Object.defineProperty(k,x,A):k[x]=h[x]}return k.default=h,T&&T.set(h,k),k}(z());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(k){return k?T:v})(h)}function u(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=v[4],M=v[5],P=T[0],B=T[1],H=T[2],Z=T[3],te=T[4],ne=T[5];return h[0]=k*P+x*B,h[1]=L*P+A*B,h[2]=k*H+x*Z,h[3]=L*H+A*Z,h[4]=k*te+x*ne+D,h[5]=L*te+A*ne+M,h}function m(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h}return U.mul=u,U.sub=m,U}var K,q={};function J(){if(K)return q;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}K=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var h=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},q.fromMat4=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[4],h[4]=v[5],h[5]=v[6],h[6]=v[8],h[7]=v[9],h[8]=v[10],h},q.clone=function(h){var v=new n.ARRAY_TYPE(9);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v[6]=h[6],v[7]=h[7],v[8]=h[8],v},q.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},q.fromValues=function(h,v,T,k,L,x,A,D,M){var P=new n.ARRAY_TYPE(9);return P[0]=h,P[1]=v,P[2]=T,P[3]=k,P[4]=L,P[5]=x,P[6]=A,P[7]=D,P[8]=M,P},q.set=function(h,v,T,k,L,x,A,D,M,P){return h[0]=v,h[1]=T,h[2]=k,h[3]=L,h[4]=x,h[5]=A,h[6]=D,h[7]=M,h[8]=P,h},q.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},q.transpose=function(h,v){if(h===v){var T=v[1],k=v[2],L=v[5];h[1]=v[3],h[2]=v[6],h[3]=T,h[5]=v[7],h[6]=k,h[7]=L}else h[0]=v[0],h[1]=v[3],h[2]=v[6],h[3]=v[1],h[4]=v[4],h[5]=v[7],h[6]=v[2],h[7]=v[5],h[8]=v[8];return h},q.invert=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],D=v[5],M=v[6],P=v[7],B=v[8],H=B*A-D*P,Z=-B*x+D*M,te=P*x-A*M,ne=T*H+k*Z+L*te;return ne?(h[0]=H*(ne=1/ne),h[1]=(-B*k+L*P)*ne,h[2]=(D*k-L*A)*ne,h[3]=Z*ne,h[4]=(B*T-L*M)*ne,h[5]=(-D*T+L*x)*ne,h[6]=te*ne,h[7]=(-P*T+k*M)*ne,h[8]=(A*T-k*x)*ne,h):null},q.adjoint=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],D=v[5],M=v[6],P=v[7],B=v[8];return h[0]=A*B-D*P,h[1]=L*P-k*B,h[2]=k*D-L*A,h[3]=D*M-x*B,h[4]=T*B-L*M,h[5]=L*x-T*D,h[6]=x*P-A*M,h[7]=k*M-T*P,h[8]=T*A-k*x,h},q.determinant=function(h){var v=h[3],T=h[4],k=h[5],L=h[6],x=h[7],A=h[8];return h[0]*(A*T-k*x)+h[1]*(-A*v+k*L)+h[2]*(x*v-T*L)},q.multiply=u,q.translate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=v[4],M=v[5],P=v[6],B=v[7],H=v[8],Z=T[0],te=T[1];return h[0]=k,h[1]=L,h[2]=x,h[3]=A,h[4]=D,h[5]=M,h[6]=Z*k+te*A+P,h[7]=Z*L+te*D+B,h[8]=Z*x+te*M+H,h},q.rotate=function(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=v[4],M=v[5],P=v[6],B=v[7],H=v[8],Z=Math.sin(T),te=Math.cos(T);return h[0]=te*k+Z*A,h[1]=te*L+Z*D,h[2]=te*x+Z*M,h[3]=te*A-Z*k,h[4]=te*D-Z*L,h[5]=te*M-Z*x,h[6]=P,h[7]=B,h[8]=H,h},q.scale=function(h,v,T){var k=T[0],L=T[1];return h[0]=k*v[0],h[1]=k*v[1],h[2]=k*v[2],h[3]=L*v[3],h[4]=L*v[4],h[5]=L*v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},q.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=v[0],h[7]=v[1],h[8]=1,h},q.fromRotation=function(h,v){var T=Math.sin(v),k=Math.cos(v);return h[0]=k,h[1]=T,h[2]=0,h[3]=-T,h[4]=k,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},q.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=0,h[4]=v[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},q.fromMat2d=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=0,h[3]=v[2],h[4]=v[3],h[5]=0,h[6]=v[4],h[7]=v[5],h[8]=1,h},q.fromQuat=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=T+T,D=k+k,M=L+L,P=T*A,B=k*A,H=k*D,Z=L*A,te=L*D,ne=L*M,X=x*A,le=x*D,pe=x*M;return h[0]=1-H-ne,h[3]=B-pe,h[6]=Z+le,h[1]=B+pe,h[4]=1-P-ne,h[7]=te-X,h[2]=Z-le,h[5]=te+X,h[8]=1-P-H,h},q.normalFromMat4=function(h,v){var T=v[0],k=v[1],L=v[2],x=v[3],A=v[4],D=v[5],M=v[6],P=v[7],B=v[8],H=v[9],Z=v[10],te=v[11],ne=v[12],X=v[13],le=v[14],pe=v[15],Ce=T*D-k*A,Ue=T*M-L*A,Le=T*P-x*A,ze=k*M-L*D,ot=k*P-x*D,Oe=L*P-x*M,et=B*X-H*ne,ct=B*le-Z*ne,ut=B*pe-te*ne,_t=H*le-Z*X,Mt=H*pe-te*X,kt=Z*pe-te*le,St=Ce*kt-Ue*Mt+Le*_t+ze*ut-ot*ct+Oe*et;return St?(h[0]=(D*kt-M*Mt+P*_t)*(St=1/St),h[1]=(M*ut-A*kt-P*ct)*St,h[2]=(A*Mt-D*ut+P*et)*St,h[3]=(L*Mt-k*kt-x*_t)*St,h[4]=(T*kt-L*ut+x*ct)*St,h[5]=(k*ut-T*Mt-x*et)*St,h[6]=(X*Oe-le*ot+pe*ze)*St,h[7]=(le*Le-ne*Oe-pe*Ue)*St,h[8]=(ne*ot-X*Le+pe*Ce)*St,h):null},q.projection=function(h,v,T){return h[0]=2/v,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/T,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},q.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},q.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},q.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h[6]=v[6]+T[6],h[7]=v[7]+T[7],h[8]=v[8]+T[8],h},q.subtract=m,q.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h[6]=v[6]*T,h[7]=v[7]*T,h[8]=v[8]*T,h},q.multiplyScalarAndAdd=function(h,v,T,k){return h[0]=v[0]+T[0]*k,h[1]=v[1]+T[1]*k,h[2]=v[2]+T[2]*k,h[3]=v[3]+T[3]*k,h[4]=v[4]+T[4]*k,h[5]=v[5]+T[5]*k,h[6]=v[6]+T[6]*k,h[7]=v[7]+T[7]*k,h[8]=v[8]+T[8]*k,h},q.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]&&h[6]===v[6]&&h[7]===v[7]&&h[8]===v[8]},q.equals=function(h,v){var T=h[0],k=h[1],L=h[2],x=h[3],A=h[4],D=h[5],M=h[6],P=h[7],B=h[8],H=v[0],Z=v[1],te=v[2],ne=v[3],X=v[4],le=v[5],pe=v[6],Ce=v[7],Ue=v[8];return Math.abs(T-H)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(H))&&Math.abs(k-Z)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Z))&&Math.abs(L-te)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(te))&&Math.abs(x-ne)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(ne))&&Math.abs(A-X)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(X))&&Math.abs(D-le)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(le))&&Math.abs(M-pe)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(pe))&&Math.abs(P-Ce)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(Ce))&&Math.abs(B-Ue)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ue))},q.sub=q.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var k={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var A=L?Object.getOwnPropertyDescriptor(h,x):null;A&&(A.get||A.set)?Object.defineProperty(k,x,A):k[x]=h[x]}return k.default=h,T&&T.set(h,k),k}(z());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(k){return k?T:v})(h)}function u(h,v,T){var k=v[0],L=v[1],x=v[2],A=v[3],D=v[4],M=v[5],P=v[6],B=v[7],H=v[8],Z=T[0],te=T[1],ne=T[2],X=T[3],le=T[4],pe=T[5],Ce=T[6],Ue=T[7],Le=T[8];return h[0]=Z*k+te*A+ne*P,h[1]=Z*L+te*D+ne*B,h[2]=Z*x+te*M+ne*H,h[3]=X*k+le*A+pe*P,h[4]=X*L+le*D+pe*B,h[5]=X*x+le*M+pe*H,h[6]=Ce*k+Ue*A+Le*P,h[7]=Ce*L+Ue*D+Le*B,h[8]=Ce*x+Ue*M+Le*H,h}function m(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h[6]=v[6]-T[6],h[7]=v[7]-T[7],h[8]=v[8]-T[8],h}return q.mul=u,q.sub=m,q}var oe,ae={};function fe(){if(oe)return ae;function c(x){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},c(x)}oe=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.create=function(){var x=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x},ae.clone=function(x){var A=new n.ARRAY_TYPE(16);return A[0]=x[0],A[1]=x[1],A[2]=x[2],A[3]=x[3],A[4]=x[4],A[5]=x[5],A[6]=x[6],A[7]=x[7],A[8]=x[8],A[9]=x[9],A[10]=x[10],A[11]=x[11],A[12]=x[12],A[13]=x[13],A[14]=x[14],A[15]=x[15],A},ae.copy=function(x,A){return x[0]=A[0],x[1]=A[1],x[2]=A[2],x[3]=A[3],x[4]=A[4],x[5]=A[5],x[6]=A[6],x[7]=A[7],x[8]=A[8],x[9]=A[9],x[10]=A[10],x[11]=A[11],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15],x},ae.fromValues=function(x,A,D,M,P,B,H,Z,te,ne,X,le,pe,Ce,Ue,Le){var ze=new n.ARRAY_TYPE(16);return ze[0]=x,ze[1]=A,ze[2]=D,ze[3]=M,ze[4]=P,ze[5]=B,ze[6]=H,ze[7]=Z,ze[8]=te,ze[9]=ne,ze[10]=X,ze[11]=le,ze[12]=pe,ze[13]=Ce,ze[14]=Ue,ze[15]=Le,ze},ae.set=function(x,A,D,M,P,B,H,Z,te,ne,X,le,pe,Ce,Ue,Le,ze){return x[0]=A,x[1]=D,x[2]=M,x[3]=P,x[4]=B,x[5]=H,x[6]=Z,x[7]=te,x[8]=ne,x[9]=X,x[10]=le,x[11]=pe,x[12]=Ce,x[13]=Ue,x[14]=Le,x[15]=ze,x},ae.identity=u,ae.transpose=function(x,A){if(x===A){var D=A[1],M=A[2],P=A[3],B=A[6],H=A[7],Z=A[11];x[1]=A[4],x[2]=A[8],x[3]=A[12],x[4]=D,x[6]=A[9],x[7]=A[13],x[8]=M,x[9]=B,x[11]=A[14],x[12]=P,x[13]=H,x[14]=Z}else x[0]=A[0],x[1]=A[4],x[2]=A[8],x[3]=A[12],x[4]=A[1],x[5]=A[5],x[6]=A[9],x[7]=A[13],x[8]=A[2],x[9]=A[6],x[10]=A[10],x[11]=A[14],x[12]=A[3],x[13]=A[7],x[14]=A[11],x[15]=A[15];return x},ae.invert=function(x,A){var D=A[0],M=A[1],P=A[2],B=A[3],H=A[4],Z=A[5],te=A[6],ne=A[7],X=A[8],le=A[9],pe=A[10],Ce=A[11],Ue=A[12],Le=A[13],ze=A[14],ot=A[15],Oe=D*Z-M*H,et=D*te-P*H,ct=D*ne-B*H,ut=M*te-P*Z,_t=M*ne-B*Z,Mt=P*ne-B*te,kt=X*Le-le*Ue,St=X*ze-pe*Ue,Yt=X*ot-Ce*Ue,gn=le*ze-pe*Le,Ut=le*ot-Ce*Le,zn=pe*ot-Ce*ze,En=Oe*zn-et*Ut+ct*gn+ut*Yt-_t*St+Mt*kt;return En?(x[0]=(Z*zn-te*Ut+ne*gn)*(En=1/En),x[1]=(P*Ut-M*zn-B*gn)*En,x[2]=(Le*Mt-ze*_t+ot*ut)*En,x[3]=(pe*_t-le*Mt-Ce*ut)*En,x[4]=(te*Yt-H*zn-ne*St)*En,x[5]=(D*zn-P*Yt+B*St)*En,x[6]=(ze*ct-Ue*Mt-ot*et)*En,x[7]=(X*Mt-pe*ct+Ce*et)*En,x[8]=(H*Ut-Z*Yt+ne*kt)*En,x[9]=(M*Yt-D*Ut-B*kt)*En,x[10]=(Ue*_t-Le*ct+ot*Oe)*En,x[11]=(le*ct-X*_t-Ce*Oe)*En,x[12]=(Z*St-H*gn-te*kt)*En,x[13]=(D*gn-M*St+P*kt)*En,x[14]=(Le*et-Ue*ut-ze*Oe)*En,x[15]=(X*ut-le*et+pe*Oe)*En,x):null},ae.adjoint=function(x,A){var D=A[0],M=A[1],P=A[2],B=A[3],H=A[4],Z=A[5],te=A[6],ne=A[7],X=A[8],le=A[9],pe=A[10],Ce=A[11],Ue=A[12],Le=A[13],ze=A[14],ot=A[15];return x[0]=Z*(pe*ot-Ce*ze)-le*(te*ot-ne*ze)+Le*(te*Ce-ne*pe),x[1]=-(M*(pe*ot-Ce*ze)-le*(P*ot-B*ze)+Le*(P*Ce-B*pe)),x[2]=M*(te*ot-ne*ze)-Z*(P*ot-B*ze)+Le*(P*ne-B*te),x[3]=-(M*(te*Ce-ne*pe)-Z*(P*Ce-B*pe)+le*(P*ne-B*te)),x[4]=-(H*(pe*ot-Ce*ze)-X*(te*ot-ne*ze)+Ue*(te*Ce-ne*pe)),x[5]=D*(pe*ot-Ce*ze)-X*(P*ot-B*ze)+Ue*(P*Ce-B*pe),x[6]=-(D*(te*ot-ne*ze)-H*(P*ot-B*ze)+Ue*(P*ne-B*te)),x[7]=D*(te*Ce-ne*pe)-H*(P*Ce-B*pe)+X*(P*ne-B*te),x[8]=H*(le*ot-Ce*Le)-X*(Z*ot-ne*Le)+Ue*(Z*Ce-ne*le),x[9]=-(D*(le*ot-Ce*Le)-X*(M*ot-B*Le)+Ue*(M*Ce-B*le)),x[10]=D*(Z*ot-ne*Le)-H*(M*ot-B*Le)+Ue*(M*ne-B*Z),x[11]=-(D*(Z*Ce-ne*le)-H*(M*Ce-B*le)+X*(M*ne-B*Z)),x[12]=-(H*(le*ze-pe*Le)-X*(Z*ze-te*Le)+Ue*(Z*pe-te*le)),x[13]=D*(le*ze-pe*Le)-X*(M*ze-P*Le)+Ue*(M*pe-P*le),x[14]=-(D*(Z*ze-te*Le)-H*(M*ze-P*Le)+Ue*(M*te-P*Z)),x[15]=D*(Z*pe-te*le)-H*(M*pe-P*le)+X*(M*te-P*Z),x},ae.determinant=function(x){var A=x[0],D=x[1],M=x[2],P=x[3],B=x[4],H=x[5],Z=x[6],te=x[7],ne=x[8],X=x[9],le=x[10],pe=x[11],Ce=x[12],Ue=x[13],Le=x[14],ze=x[15];return(A*H-D*B)*(le*ze-pe*Le)-(A*Z-M*B)*(X*ze-pe*Ue)+(A*te-P*B)*(X*Le-le*Ue)+(D*Z-M*H)*(ne*ze-pe*Ce)-(D*te-P*H)*(ne*Le-le*Ce)+(M*te-P*Z)*(ne*Ue-X*Ce)},ae.multiply=m,ae.translate=function(x,A,D){var M,P,B,H,Z,te,ne,X,le,pe,Ce,Ue,Le=D[0],ze=D[1],ot=D[2];return A===x?(x[12]=A[0]*Le+A[4]*ze+A[8]*ot+A[12],x[13]=A[1]*Le+A[5]*ze+A[9]*ot+A[13],x[14]=A[2]*Le+A[6]*ze+A[10]*ot+A[14],x[15]=A[3]*Le+A[7]*ze+A[11]*ot+A[15]):(P=A[1],B=A[2],H=A[3],Z=A[4],te=A[5],ne=A[6],X=A[7],le=A[8],pe=A[9],Ce=A[10],Ue=A[11],x[0]=M=A[0],x[1]=P,x[2]=B,x[3]=H,x[4]=Z,x[5]=te,x[6]=ne,x[7]=X,x[8]=le,x[9]=pe,x[10]=Ce,x[11]=Ue,x[12]=M*Le+Z*ze+le*ot+A[12],x[13]=P*Le+te*ze+pe*ot+A[13],x[14]=B*Le+ne*ze+Ce*ot+A[14],x[15]=H*Le+X*ze+Ue*ot+A[15]),x},ae.scale=function(x,A,D){var M=D[0],P=D[1],B=D[2];return x[0]=A[0]*M,x[1]=A[1]*M,x[2]=A[2]*M,x[3]=A[3]*M,x[4]=A[4]*P,x[5]=A[5]*P,x[6]=A[6]*P,x[7]=A[7]*P,x[8]=A[8]*B,x[9]=A[9]*B,x[10]=A[10]*B,x[11]=A[11]*B,x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15],x},ae.rotate=function(x,A,D,M){var P,B,H,Z,te,ne,X,le,pe,Ce,Ue,Le,ze,ot,Oe,et,ct,ut,_t,Mt,kt,St,Yt,gn,Ut=M[0],zn=M[1],En=M[2],xn=Math.hypot(Ut,zn,En);return xn<n.EPSILON?null:(Ut*=xn=1/xn,zn*=xn,En*=xn,P=Math.sin(D),B=Math.cos(D),te=A[1],ne=A[2],X=A[3],pe=A[5],Ce=A[6],Ue=A[7],ze=A[9],ot=A[10],Oe=A[11],et=Ut*Ut*(H=1-B)+B,_t=Ut*zn*H-En*P,Mt=zn*zn*H+B,kt=En*zn*H+Ut*P,St=Ut*En*H+zn*P,Yt=zn*En*H-Ut*P,gn=En*En*H+B,x[0]=(Z=A[0])*et+(le=A[4])*(ct=zn*Ut*H+En*P)+(Le=A[8])*(ut=En*Ut*H-zn*P),x[1]=te*et+pe*ct+ze*ut,x[2]=ne*et+Ce*ct+ot*ut,x[3]=X*et+Ue*ct+Oe*ut,x[4]=Z*_t+le*Mt+Le*kt,x[5]=te*_t+pe*Mt+ze*kt,x[6]=ne*_t+Ce*Mt+ot*kt,x[7]=X*_t+Ue*Mt+Oe*kt,x[8]=Z*St+le*Yt+Le*gn,x[9]=te*St+pe*Yt+ze*gn,x[10]=ne*St+Ce*Yt+ot*gn,x[11]=X*St+Ue*Yt+Oe*gn,A!==x&&(x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x)},ae.rotateX=function(x,A,D){var M=Math.sin(D),P=Math.cos(D),B=A[4],H=A[5],Z=A[6],te=A[7],ne=A[8],X=A[9],le=A[10],pe=A[11];return A!==x&&(x[0]=A[0],x[1]=A[1],x[2]=A[2],x[3]=A[3],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x[4]=B*P+ne*M,x[5]=H*P+X*M,x[6]=Z*P+le*M,x[7]=te*P+pe*M,x[8]=ne*P-B*M,x[9]=X*P-H*M,x[10]=le*P-Z*M,x[11]=pe*P-te*M,x},ae.rotateY=function(x,A,D){var M=Math.sin(D),P=Math.cos(D),B=A[0],H=A[1],Z=A[2],te=A[3],ne=A[8],X=A[9],le=A[10],pe=A[11];return A!==x&&(x[4]=A[4],x[5]=A[5],x[6]=A[6],x[7]=A[7],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x[0]=B*P-ne*M,x[1]=H*P-X*M,x[2]=Z*P-le*M,x[3]=te*P-pe*M,x[8]=B*M+ne*P,x[9]=H*M+X*P,x[10]=Z*M+le*P,x[11]=te*M+pe*P,x},ae.rotateZ=function(x,A,D){var M=Math.sin(D),P=Math.cos(D),B=A[0],H=A[1],Z=A[2],te=A[3],ne=A[4],X=A[5],le=A[6],pe=A[7];return A!==x&&(x[8]=A[8],x[9]=A[9],x[10]=A[10],x[11]=A[11],x[12]=A[12],x[13]=A[13],x[14]=A[14],x[15]=A[15]),x[0]=B*P+ne*M,x[1]=H*P+X*M,x[2]=Z*P+le*M,x[3]=te*P+pe*M,x[4]=ne*P-B*M,x[5]=X*P-H*M,x[6]=le*P-Z*M,x[7]=pe*P-te*M,x},ae.fromTranslation=function(x,A){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=A[0],x[13]=A[1],x[14]=A[2],x[15]=1,x},ae.fromScaling=function(x,A){return x[0]=A[0],x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=A[1],x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=A[2],x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},ae.fromRotation=function(x,A,D){var M,P,B,H=D[0],Z=D[1],te=D[2],ne=Math.hypot(H,Z,te);return ne<n.EPSILON?null:(H*=ne=1/ne,Z*=ne,te*=ne,M=Math.sin(A),P=Math.cos(A),x[0]=H*H*(B=1-P)+P,x[1]=Z*H*B+te*M,x[2]=te*H*B-Z*M,x[3]=0,x[4]=H*Z*B-te*M,x[5]=Z*Z*B+P,x[6]=te*Z*B+H*M,x[7]=0,x[8]=H*te*B+Z*M,x[9]=Z*te*B-H*M,x[10]=te*te*B+P,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x)},ae.fromXRotation=function(x,A){var D=Math.sin(A),M=Math.cos(A);return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=M,x[6]=D,x[7]=0,x[8]=0,x[9]=-D,x[10]=M,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},ae.fromYRotation=function(x,A){var D=Math.sin(A),M=Math.cos(A);return x[0]=M,x[1]=0,x[2]=-D,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=D,x[9]=0,x[10]=M,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},ae.fromZRotation=function(x,A){var D=Math.sin(A),M=Math.cos(A);return x[0]=M,x[1]=D,x[2]=0,x[3]=0,x[4]=-D,x[5]=M,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},ae.fromRotationTranslation=h,ae.fromQuat2=function(x,A){var D=new n.ARRAY_TYPE(3),M=-A[0],P=-A[1],B=-A[2],H=A[3],Z=A[4],te=A[5],ne=A[6],X=A[7],le=M*M+P*P+B*B+H*H;return le>0?(D[0]=2*(Z*H+X*M+te*B-ne*P)/le,D[1]=2*(te*H+X*P+ne*M-Z*B)/le,D[2]=2*(ne*H+X*B+Z*P-te*M)/le):(D[0]=2*(Z*H+X*M+te*B-ne*P),D[1]=2*(te*H+X*P+ne*M-Z*B),D[2]=2*(ne*H+X*B+Z*P-te*M)),h(x,A,D),x},ae.getTranslation=function(x,A){return x[0]=A[12],x[1]=A[13],x[2]=A[14],x},ae.getScaling=v,ae.getRotation=function(x,A){var D=new n.ARRAY_TYPE(3);v(D,A);var M=1/D[0],P=1/D[1],B=1/D[2],H=A[0]*M,Z=A[1]*P,te=A[2]*B,ne=A[4]*M,X=A[5]*P,le=A[6]*B,pe=A[8]*M,Ce=A[9]*P,Ue=A[10]*B,Le=H+X+Ue,ze=0;return Le>0?(ze=2*Math.sqrt(Le+1),x[3]=.25*ze,x[0]=(le-Ce)/ze,x[1]=(pe-te)/ze,x[2]=(Z-ne)/ze):H>X&&H>Ue?(ze=2*Math.sqrt(1+H-X-Ue),x[3]=(le-Ce)/ze,x[0]=.25*ze,x[1]=(Z+ne)/ze,x[2]=(pe+te)/ze):X>Ue?(ze=2*Math.sqrt(1+X-H-Ue),x[3]=(pe-te)/ze,x[0]=(Z+ne)/ze,x[1]=.25*ze,x[2]=(le+Ce)/ze):(ze=2*Math.sqrt(1+Ue-H-X),x[3]=(Z-ne)/ze,x[0]=(pe+te)/ze,x[1]=(le+Ce)/ze,x[2]=.25*ze),x},ae.fromRotationTranslationScale=function(x,A,D,M){var P=A[0],B=A[1],H=A[2],Z=A[3],te=P+P,ne=B+B,X=H+H,le=P*te,pe=P*ne,Ce=P*X,Ue=B*ne,Le=B*X,ze=H*X,ot=Z*te,Oe=Z*ne,et=Z*X,ct=M[0],ut=M[1],_t=M[2];return x[0]=(1-(Ue+ze))*ct,x[1]=(pe+et)*ct,x[2]=(Ce-Oe)*ct,x[3]=0,x[4]=(pe-et)*ut,x[5]=(1-(le+ze))*ut,x[6]=(Le+ot)*ut,x[7]=0,x[8]=(Ce+Oe)*_t,x[9]=(Le-ot)*_t,x[10]=(1-(le+Ue))*_t,x[11]=0,x[12]=D[0],x[13]=D[1],x[14]=D[2],x[15]=1,x},ae.fromRotationTranslationScaleOrigin=function(x,A,D,M,P){var B=A[0],H=A[1],Z=A[2],te=A[3],ne=B+B,X=H+H,le=Z+Z,pe=B*ne,Ce=B*X,Ue=B*le,Le=H*X,ze=H*le,ot=Z*le,Oe=te*ne,et=te*X,ct=te*le,ut=M[0],_t=M[1],Mt=M[2],kt=P[0],St=P[1],Yt=P[2],gn=(1-(Le+ot))*ut,Ut=(Ce+ct)*ut,zn=(Ue-et)*ut,En=(Ce-ct)*_t,xn=(1-(pe+ot))*_t,pn=(ze+Oe)*_t,no=(Ue+et)*Mt,Ln=(ze-Oe)*Mt,Gn=(1-(pe+Le))*Mt;return x[0]=gn,x[1]=Ut,x[2]=zn,x[3]=0,x[4]=En,x[5]=xn,x[6]=pn,x[7]=0,x[8]=no,x[9]=Ln,x[10]=Gn,x[11]=0,x[12]=D[0]+kt-(gn*kt+En*St+no*Yt),x[13]=D[1]+St-(Ut*kt+xn*St+Ln*Yt),x[14]=D[2]+Yt-(zn*kt+pn*St+Gn*Yt),x[15]=1,x},ae.fromQuat=function(x,A){var D=A[0],M=A[1],P=A[2],B=A[3],H=D+D,Z=M+M,te=P+P,ne=D*H,X=M*H,le=M*Z,pe=P*H,Ce=P*Z,Ue=P*te,Le=B*H,ze=B*Z,ot=B*te;return x[0]=1-le-Ue,x[1]=X+ot,x[2]=pe-ze,x[3]=0,x[4]=X-ot,x[5]=1-ne-Ue,x[6]=Ce+Le,x[7]=0,x[8]=pe+ze,x[9]=Ce-Le,x[10]=1-ne-le,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},ae.frustum=function(x,A,D,M,P,B,H){var Z=1/(D-A),te=1/(P-M),ne=1/(B-H);return x[0]=2*B*Z,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=2*B*te,x[6]=0,x[7]=0,x[8]=(D+A)*Z,x[9]=(P+M)*te,x[10]=(H+B)*ne,x[11]=-1,x[12]=0,x[13]=0,x[14]=H*B*2*ne,x[15]=0,x},ae.perspectiveNO=T,ae.perspectiveZO=function(x,A,D,M,P){var B,H=1/Math.tan(A/2);return x[0]=H/D,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=H,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,P!=null&&P!==1/0?(x[10]=P*(B=1/(M-P)),x[14]=P*M*B):(x[10]=-1,x[14]=-M),x},ae.perspectiveFromFieldOfView=function(x,A,D,M){var P=Math.tan(A.upDegrees*Math.PI/180),B=Math.tan(A.downDegrees*Math.PI/180),H=Math.tan(A.leftDegrees*Math.PI/180),Z=Math.tan(A.rightDegrees*Math.PI/180),te=2/(H+Z),ne=2/(P+B);return x[0]=te,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=ne,x[6]=0,x[7]=0,x[8]=-(H-Z)*te*.5,x[9]=(P-B)*ne*.5,x[10]=M/(D-M),x[11]=-1,x[12]=0,x[13]=0,x[14]=M*D/(D-M),x[15]=0,x},ae.orthoNO=k,ae.orthoZO=function(x,A,D,M,P,B,H){var Z=1/(A-D),te=1/(M-P),ne=1/(B-H);return x[0]=-2*Z,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*te,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=ne,x[11]=0,x[12]=(A+D)*Z,x[13]=(P+M)*te,x[14]=B*ne,x[15]=1,x},ae.lookAt=function(x,A,D,M){var P,B,H,Z,te,ne,X,le,pe,Ce,Ue=A[0],Le=A[1],ze=A[2],ot=M[0],Oe=M[1],et=M[2],ct=D[0],ut=D[1],_t=D[2];return Math.abs(Ue-ct)<n.EPSILON&&Math.abs(Le-ut)<n.EPSILON&&Math.abs(ze-_t)<n.EPSILON?u(x):(X=Ue-ct,le=Le-ut,pe=ze-_t,P=Oe*(pe*=Ce=1/Math.hypot(X,le,pe))-et*(le*=Ce),B=et*(X*=Ce)-ot*pe,H=ot*le-Oe*X,(Ce=Math.hypot(P,B,H))?(P*=Ce=1/Ce,B*=Ce,H*=Ce):(P=0,B=0,H=0),Z=le*H-pe*B,te=pe*P-X*H,ne=X*B-le*P,(Ce=Math.hypot(Z,te,ne))?(Z*=Ce=1/Ce,te*=Ce,ne*=Ce):(Z=0,te=0,ne=0),x[0]=P,x[1]=Z,x[2]=X,x[3]=0,x[4]=B,x[5]=te,x[6]=le,x[7]=0,x[8]=H,x[9]=ne,x[10]=pe,x[11]=0,x[12]=-(P*Ue+B*Le+H*ze),x[13]=-(Z*Ue+te*Le+ne*ze),x[14]=-(X*Ue+le*Le+pe*ze),x[15]=1,x)},ae.targetTo=function(x,A,D,M){var P=A[0],B=A[1],H=A[2],Z=M[0],te=M[1],ne=M[2],X=P-D[0],le=B-D[1],pe=H-D[2],Ce=X*X+le*le+pe*pe;Ce>0&&(X*=Ce=1/Math.sqrt(Ce),le*=Ce,pe*=Ce);var Ue=te*pe-ne*le,Le=ne*X-Z*pe,ze=Z*le-te*X;return(Ce=Ue*Ue+Le*Le+ze*ze)>0&&(Ue*=Ce=1/Math.sqrt(Ce),Le*=Ce,ze*=Ce),x[0]=Ue,x[1]=Le,x[2]=ze,x[3]=0,x[4]=le*ze-pe*Le,x[5]=pe*Ue-X*ze,x[6]=X*Le-le*Ue,x[7]=0,x[8]=X,x[9]=le,x[10]=pe,x[11]=0,x[12]=P,x[13]=B,x[14]=H,x[15]=1,x},ae.str=function(x){return"mat4("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+", "+x[6]+", "+x[7]+", "+x[8]+", "+x[9]+", "+x[10]+", "+x[11]+", "+x[12]+", "+x[13]+", "+x[14]+", "+x[15]+")"},ae.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15])},ae.add=function(x,A,D){return x[0]=A[0]+D[0],x[1]=A[1]+D[1],x[2]=A[2]+D[2],x[3]=A[3]+D[3],x[4]=A[4]+D[4],x[5]=A[5]+D[5],x[6]=A[6]+D[6],x[7]=A[7]+D[7],x[8]=A[8]+D[8],x[9]=A[9]+D[9],x[10]=A[10]+D[10],x[11]=A[11]+D[11],x[12]=A[12]+D[12],x[13]=A[13]+D[13],x[14]=A[14]+D[14],x[15]=A[15]+D[15],x},ae.subtract=L,ae.multiplyScalar=function(x,A,D){return x[0]=A[0]*D,x[1]=A[1]*D,x[2]=A[2]*D,x[3]=A[3]*D,x[4]=A[4]*D,x[5]=A[5]*D,x[6]=A[6]*D,x[7]=A[7]*D,x[8]=A[8]*D,x[9]=A[9]*D,x[10]=A[10]*D,x[11]=A[11]*D,x[12]=A[12]*D,x[13]=A[13]*D,x[14]=A[14]*D,x[15]=A[15]*D,x},ae.multiplyScalarAndAdd=function(x,A,D,M){return x[0]=A[0]+D[0]*M,x[1]=A[1]+D[1]*M,x[2]=A[2]+D[2]*M,x[3]=A[3]+D[3]*M,x[4]=A[4]+D[4]*M,x[5]=A[5]+D[5]*M,x[6]=A[6]+D[6]*M,x[7]=A[7]+D[7]*M,x[8]=A[8]+D[8]*M,x[9]=A[9]+D[9]*M,x[10]=A[10]+D[10]*M,x[11]=A[11]+D[11]*M,x[12]=A[12]+D[12]*M,x[13]=A[13]+D[13]*M,x[14]=A[14]+D[14]*M,x[15]=A[15]+D[15]*M,x},ae.exactEquals=function(x,A){return x[0]===A[0]&&x[1]===A[1]&&x[2]===A[2]&&x[3]===A[3]&&x[4]===A[4]&&x[5]===A[5]&&x[6]===A[6]&&x[7]===A[7]&&x[8]===A[8]&&x[9]===A[9]&&x[10]===A[10]&&x[11]===A[11]&&x[12]===A[12]&&x[13]===A[13]&&x[14]===A[14]&&x[15]===A[15]},ae.equals=function(x,A){var D=x[0],M=x[1],P=x[2],B=x[3],H=x[4],Z=x[5],te=x[6],ne=x[7],X=x[8],le=x[9],pe=x[10],Ce=x[11],Ue=x[12],Le=x[13],ze=x[14],ot=x[15],Oe=A[0],et=A[1],ct=A[2],ut=A[3],_t=A[4],Mt=A[5],kt=A[6],St=A[7],Yt=A[8],gn=A[9],Ut=A[10],zn=A[11],En=A[12],xn=A[13],pn=A[14],no=A[15];return Math.abs(D-Oe)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(Oe))&&Math.abs(M-et)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(et))&&Math.abs(P-ct)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(ct))&&Math.abs(B-ut)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(ut))&&Math.abs(H-_t)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(_t))&&Math.abs(Z-Mt)<=n.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Mt))&&Math.abs(te-kt)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(kt))&&Math.abs(ne-St)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(St))&&Math.abs(X-Yt)<=n.EPSILON*Math.max(1,Math.abs(X),Math.abs(Yt))&&Math.abs(le-gn)<=n.EPSILON*Math.max(1,Math.abs(le),Math.abs(gn))&&Math.abs(pe-Ut)<=n.EPSILON*Math.max(1,Math.abs(pe),Math.abs(Ut))&&Math.abs(Ce-zn)<=n.EPSILON*Math.max(1,Math.abs(Ce),Math.abs(zn))&&Math.abs(Ue-En)<=n.EPSILON*Math.max(1,Math.abs(Ue),Math.abs(En))&&Math.abs(Le-xn)<=n.EPSILON*Math.max(1,Math.abs(Le),Math.abs(xn))&&Math.abs(ze-pn)<=n.EPSILON*Math.max(1,Math.abs(ze),Math.abs(pn))&&Math.abs(ot-no)<=n.EPSILON*Math.max(1,Math.abs(ot),Math.abs(no))},ae.sub=ae.mul=ae.ortho=ae.perspective=void 0;var n=function(x,A){if(x&&x.__esModule)return x;if(x===null||c(x)!=="object"&&typeof x!="function")return{default:x};var D=s(void 0);if(D&&D.has(x))return D.get(x);var M={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in x)if(B!=="default"&&Object.prototype.hasOwnProperty.call(x,B)){var H=P?Object.getOwnPropertyDescriptor(x,B):null;H&&(H.get||H.set)?Object.defineProperty(M,B,H):M[B]=x[B]}return M.default=x,D&&D.set(x,M),M}(z());function s(x){if(typeof WeakMap!="function")return null;var A=new WeakMap,D=new WeakMap;return(s=function(M){return M?D:A})(x)}function u(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function m(x,A,D){var M=A[0],P=A[1],B=A[2],H=A[3],Z=A[4],te=A[5],ne=A[6],X=A[7],le=A[8],pe=A[9],Ce=A[10],Ue=A[11],Le=A[12],ze=A[13],ot=A[14],Oe=A[15],et=D[0],ct=D[1],ut=D[2],_t=D[3];return x[0]=et*M+ct*Z+ut*le+_t*Le,x[1]=et*P+ct*te+ut*pe+_t*ze,x[2]=et*B+ct*ne+ut*Ce+_t*ot,x[3]=et*H+ct*X+ut*Ue+_t*Oe,x[4]=(et=D[4])*M+(ct=D[5])*Z+(ut=D[6])*le+(_t=D[7])*Le,x[5]=et*P+ct*te+ut*pe+_t*ze,x[6]=et*B+ct*ne+ut*Ce+_t*ot,x[7]=et*H+ct*X+ut*Ue+_t*Oe,x[8]=(et=D[8])*M+(ct=D[9])*Z+(ut=D[10])*le+(_t=D[11])*Le,x[9]=et*P+ct*te+ut*pe+_t*ze,x[10]=et*B+ct*ne+ut*Ce+_t*ot,x[11]=et*H+ct*X+ut*Ue+_t*Oe,x[12]=(et=D[12])*M+(ct=D[13])*Z+(ut=D[14])*le+(_t=D[15])*Le,x[13]=et*P+ct*te+ut*pe+_t*ze,x[14]=et*B+ct*ne+ut*Ce+_t*ot,x[15]=et*H+ct*X+ut*Ue+_t*Oe,x}function h(x,A,D){var M=A[0],P=A[1],B=A[2],H=A[3],Z=M+M,te=P+P,ne=B+B,X=M*Z,le=M*te,pe=M*ne,Ce=P*te,Ue=P*ne,Le=B*ne,ze=H*Z,ot=H*te,Oe=H*ne;return x[0]=1-(Ce+Le),x[1]=le+Oe,x[2]=pe-ot,x[3]=0,x[4]=le-Oe,x[5]=1-(X+Le),x[6]=Ue+ze,x[7]=0,x[8]=pe+ot,x[9]=Ue-ze,x[10]=1-(X+Ce),x[11]=0,x[12]=D[0],x[13]=D[1],x[14]=D[2],x[15]=1,x}function v(x,A){var D=A[4],M=A[5],P=A[6],B=A[8],H=A[9],Z=A[10];return x[0]=Math.hypot(A[0],A[1],A[2]),x[1]=Math.hypot(D,M,P),x[2]=Math.hypot(B,H,Z),x}function T(x,A,D,M,P){var B,H=1/Math.tan(A/2);return x[0]=H/D,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=H,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,P!=null&&P!==1/0?(x[10]=(P+M)*(B=1/(M-P)),x[14]=2*P*M*B):(x[10]=-1,x[14]=-2*M),x}function k(x,A,D,M,P,B,H){var Z=1/(A-D),te=1/(M-P),ne=1/(B-H);return x[0]=-2*Z,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*te,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*ne,x[11]=0,x[12]=(A+D)*Z,x[13]=(P+M)*te,x[14]=(H+B)*ne,x[15]=1,x}function L(x,A,D){return x[0]=A[0]-D[0],x[1]=A[1]-D[1],x[2]=A[2]-D[2],x[3]=A[3]-D[3],x[4]=A[4]-D[4],x[5]=A[5]-D[5],x[6]=A[6]-D[6],x[7]=A[7]-D[7],x[8]=A[8]-D[8],x[9]=A[9]-D[9],x[10]=A[10]-D[10],x[11]=A[11]-D[11],x[12]=A[12]-D[12],x[13]=A[13]-D[13],x[14]=A[14]-D[14],x[15]=A[15]-D[15],x}return ae.perspective=T,ae.ortho=k,ae.mul=m,ae.sub=L,ae}var ge,ce={},de={};function _e(){if(ge)return de;function c(P){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},c(P)}ge=1,Object.defineProperty(de,"__esModule",{value:!0}),de.create=u,de.clone=function(P){var B=new n.ARRAY_TYPE(3);return B[0]=P[0],B[1]=P[1],B[2]=P[2],B},de.length=m,de.fromValues=function(P,B,H){var Z=new n.ARRAY_TYPE(3);return Z[0]=P,Z[1]=B,Z[2]=H,Z},de.copy=function(P,B){return P[0]=B[0],P[1]=B[1],P[2]=B[2],P},de.set=function(P,B,H,Z){return P[0]=B,P[1]=H,P[2]=Z,P},de.add=function(P,B,H){return P[0]=B[0]+H[0],P[1]=B[1]+H[1],P[2]=B[2]+H[2],P},de.subtract=h,de.multiply=v,de.divide=T,de.ceil=function(P,B){return P[0]=Math.ceil(B[0]),P[1]=Math.ceil(B[1]),P[2]=Math.ceil(B[2]),P},de.floor=function(P,B){return P[0]=Math.floor(B[0]),P[1]=Math.floor(B[1]),P[2]=Math.floor(B[2]),P},de.min=function(P,B,H){return P[0]=Math.min(B[0],H[0]),P[1]=Math.min(B[1],H[1]),P[2]=Math.min(B[2],H[2]),P},de.max=function(P,B,H){return P[0]=Math.max(B[0],H[0]),P[1]=Math.max(B[1],H[1]),P[2]=Math.max(B[2],H[2]),P},de.round=function(P,B){return P[0]=Math.round(B[0]),P[1]=Math.round(B[1]),P[2]=Math.round(B[2]),P},de.scale=function(P,B,H){return P[0]=B[0]*H,P[1]=B[1]*H,P[2]=B[2]*H,P},de.scaleAndAdd=function(P,B,H,Z){return P[0]=B[0]+H[0]*Z,P[1]=B[1]+H[1]*Z,P[2]=B[2]+H[2]*Z,P},de.distance=k,de.squaredDistance=L,de.squaredLength=x,de.negate=function(P,B){return P[0]=-B[0],P[1]=-B[1],P[2]=-B[2],P},de.inverse=function(P,B){return P[0]=1/B[0],P[1]=1/B[1],P[2]=1/B[2],P},de.normalize=function(P,B){var H=B[0],Z=B[1],te=B[2],ne=H*H+Z*Z+te*te;return ne>0&&(ne=1/Math.sqrt(ne)),P[0]=B[0]*ne,P[1]=B[1]*ne,P[2]=B[2]*ne,P},de.dot=A,de.cross=function(P,B,H){var Z=B[0],te=B[1],ne=B[2],X=H[0],le=H[1],pe=H[2];return P[0]=te*pe-ne*le,P[1]=ne*X-Z*pe,P[2]=Z*le-te*X,P},de.lerp=function(P,B,H,Z){var te=B[0],ne=B[1],X=B[2];return P[0]=te+Z*(H[0]-te),P[1]=ne+Z*(H[1]-ne),P[2]=X+Z*(H[2]-X),P},de.hermite=function(P,B,H,Z,te,ne){var X=ne*ne,le=X*(2*ne-3)+1,pe=X*(ne-2)+ne,Ce=X*(ne-1),Ue=X*(3-2*ne);return P[0]=B[0]*le+H[0]*pe+Z[0]*Ce+te[0]*Ue,P[1]=B[1]*le+H[1]*pe+Z[1]*Ce+te[1]*Ue,P[2]=B[2]*le+H[2]*pe+Z[2]*Ce+te[2]*Ue,P},de.bezier=function(P,B,H,Z,te,ne){var X=1-ne,le=X*X,pe=ne*ne,Ce=le*X,Ue=3*ne*le,Le=3*pe*X,ze=pe*ne;return P[0]=B[0]*Ce+H[0]*Ue+Z[0]*Le+te[0]*ze,P[1]=B[1]*Ce+H[1]*Ue+Z[1]*Le+te[1]*ze,P[2]=B[2]*Ce+H[2]*Ue+Z[2]*Le+te[2]*ze,P},de.random=function(P,B){B=B||1;var H=2*n.RANDOM()*Math.PI,Z=2*n.RANDOM()-1,te=Math.sqrt(1-Z*Z)*B;return P[0]=Math.cos(H)*te,P[1]=Math.sin(H)*te,P[2]=Z*B,P},de.transformMat4=function(P,B,H){var Z=B[0],te=B[1],ne=B[2],X=H[3]*Z+H[7]*te+H[11]*ne+H[15];return P[0]=(H[0]*Z+H[4]*te+H[8]*ne+H[12])/(X=X||1),P[1]=(H[1]*Z+H[5]*te+H[9]*ne+H[13])/X,P[2]=(H[2]*Z+H[6]*te+H[10]*ne+H[14])/X,P},de.transformMat3=function(P,B,H){var Z=B[0],te=B[1],ne=B[2];return P[0]=Z*H[0]+te*H[3]+ne*H[6],P[1]=Z*H[1]+te*H[4]+ne*H[7],P[2]=Z*H[2]+te*H[5]+ne*H[8],P},de.transformQuat=function(P,B,H){var Z=H[0],te=H[1],ne=H[2],X=B[0],le=B[1],pe=B[2],Ce=te*pe-ne*le,Ue=ne*X-Z*pe,Le=Z*le-te*X,ze=te*Le-ne*Ue,ot=ne*Ce-Z*Le,Oe=Z*Ue-te*Ce,et=2*H[3];return Ue*=et,Le*=et,ot*=2,Oe*=2,P[0]=X+(Ce*=et)+(ze*=2),P[1]=le+Ue+ot,P[2]=pe+Le+Oe,P},de.rotateX=function(P,B,H,Z){var te=[],ne=[];return te[0]=B[0]-H[0],te[1]=B[1]-H[1],te[2]=B[2]-H[2],ne[0]=te[0],ne[1]=te[1]*Math.cos(Z)-te[2]*Math.sin(Z),ne[2]=te[1]*Math.sin(Z)+te[2]*Math.cos(Z),P[0]=ne[0]+H[0],P[1]=ne[1]+H[1],P[2]=ne[2]+H[2],P},de.rotateY=function(P,B,H,Z){var te=[],ne=[];return te[0]=B[0]-H[0],te[1]=B[1]-H[1],te[2]=B[2]-H[2],ne[0]=te[2]*Math.sin(Z)+te[0]*Math.cos(Z),ne[1]=te[1],ne[2]=te[2]*Math.cos(Z)-te[0]*Math.sin(Z),P[0]=ne[0]+H[0],P[1]=ne[1]+H[1],P[2]=ne[2]+H[2],P},de.rotateZ=function(P,B,H,Z){var te=[],ne=[];return te[0]=B[0]-H[0],te[1]=B[1]-H[1],te[2]=B[2]-H[2],ne[0]=te[0]*Math.cos(Z)-te[1]*Math.sin(Z),ne[1]=te[0]*Math.sin(Z)+te[1]*Math.cos(Z),ne[2]=te[2],P[0]=ne[0]+H[0],P[1]=ne[1]+H[1],P[2]=ne[2]+H[2],P},de.angle=function(P,B){var H=P[0],Z=P[1],te=P[2],ne=B[0],X=B[1],le=B[2],pe=Math.sqrt(H*H+Z*Z+te*te)*Math.sqrt(ne*ne+X*X+le*le),Ce=pe&&A(P,B)/pe;return Math.acos(Math.min(Math.max(Ce,-1),1))},de.zero=function(P){return P[0]=0,P[1]=0,P[2]=0,P},de.str=function(P){return"vec3("+P[0]+", "+P[1]+", "+P[2]+")"},de.exactEquals=function(P,B){return P[0]===B[0]&&P[1]===B[1]&&P[2]===B[2]},de.equals=function(P,B){var H=P[0],Z=P[1],te=P[2],ne=B[0],X=B[1],le=B[2];return Math.abs(H-ne)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(ne))&&Math.abs(Z-X)<=n.EPSILON*Math.max(1,Math.abs(Z),Math.abs(X))&&Math.abs(te-le)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(le))},de.forEach=de.sqrLen=de.len=de.sqrDist=de.dist=de.div=de.mul=de.sub=void 0;var n=function(P,B){if(P&&P.__esModule)return P;if(P===null||c(P)!=="object"&&typeof P!="function")return{default:P};var H=s(void 0);if(H&&H.has(P))return H.get(P);var Z={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in P)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(P,ne)){var X=te?Object.getOwnPropertyDescriptor(P,ne):null;X&&(X.get||X.set)?Object.defineProperty(Z,ne,X):Z[ne]=P[ne]}return Z.default=P,H&&H.set(P,Z),Z}(z());function s(P){if(typeof WeakMap!="function")return null;var B=new WeakMap,H=new WeakMap;return(s=function(Z){return Z?H:B})(P)}function u(){var P=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0),P}function m(P){return Math.hypot(P[0],P[1],P[2])}function h(P,B,H){return P[0]=B[0]-H[0],P[1]=B[1]-H[1],P[2]=B[2]-H[2],P}function v(P,B,H){return P[0]=B[0]*H[0],P[1]=B[1]*H[1],P[2]=B[2]*H[2],P}function T(P,B,H){return P[0]=B[0]/H[0],P[1]=B[1]/H[1],P[2]=B[2]/H[2],P}function k(P,B){return Math.hypot(B[0]-P[0],B[1]-P[1],B[2]-P[2])}function L(P,B){var H=B[0]-P[0],Z=B[1]-P[1],te=B[2]-P[2];return H*H+Z*Z+te*te}function x(P){var B=P[0],H=P[1],Z=P[2];return B*B+H*H+Z*Z}function A(P,B){return P[0]*B[0]+P[1]*B[1]+P[2]*B[2]}de.sub=h,de.mul=v,de.div=T,de.dist=k,de.sqrDist=L,de.len=m,de.sqrLen=x;var D,M=(D=u(),function(P,B,H,Z,te,ne){var X,le;for(B||(B=3),H||(H=0),le=Z?Math.min(Z*B+H,P.length):P.length,X=H;X<le;X+=B)D[0]=P[X],D[1]=P[X+1],D[2]=P[X+2],te(D,D,ne),P[X]=D[0],P[X+1]=D[1],P[X+2]=D[2];return P});return de.forEach=M,de}var Re,Qe,Ee={};function ye(){if(Re)return Ee;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(M)}Re=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.create=u,Ee.clone=function(M){var P=new n.ARRAY_TYPE(4);return P[0]=M[0],P[1]=M[1],P[2]=M[2],P[3]=M[3],P},Ee.fromValues=function(M,P,B,H){var Z=new n.ARRAY_TYPE(4);return Z[0]=M,Z[1]=P,Z[2]=B,Z[3]=H,Z},Ee.copy=function(M,P){return M[0]=P[0],M[1]=P[1],M[2]=P[2],M[3]=P[3],M},Ee.set=function(M,P,B,H,Z){return M[0]=P,M[1]=B,M[2]=H,M[3]=Z,M},Ee.add=function(M,P,B){return M[0]=P[0]+B[0],M[1]=P[1]+B[1],M[2]=P[2]+B[2],M[3]=P[3]+B[3],M},Ee.subtract=m,Ee.multiply=h,Ee.divide=v,Ee.ceil=function(M,P){return M[0]=Math.ceil(P[0]),M[1]=Math.ceil(P[1]),M[2]=Math.ceil(P[2]),M[3]=Math.ceil(P[3]),M},Ee.floor=function(M,P){return M[0]=Math.floor(P[0]),M[1]=Math.floor(P[1]),M[2]=Math.floor(P[2]),M[3]=Math.floor(P[3]),M},Ee.min=function(M,P,B){return M[0]=Math.min(P[0],B[0]),M[1]=Math.min(P[1],B[1]),M[2]=Math.min(P[2],B[2]),M[3]=Math.min(P[3],B[3]),M},Ee.max=function(M,P,B){return M[0]=Math.max(P[0],B[0]),M[1]=Math.max(P[1],B[1]),M[2]=Math.max(P[2],B[2]),M[3]=Math.max(P[3],B[3]),M},Ee.round=function(M,P){return M[0]=Math.round(P[0]),M[1]=Math.round(P[1]),M[2]=Math.round(P[2]),M[3]=Math.round(P[3]),M},Ee.scale=function(M,P,B){return M[0]=P[0]*B,M[1]=P[1]*B,M[2]=P[2]*B,M[3]=P[3]*B,M},Ee.scaleAndAdd=function(M,P,B,H){return M[0]=P[0]+B[0]*H,M[1]=P[1]+B[1]*H,M[2]=P[2]+B[2]*H,M[3]=P[3]+B[3]*H,M},Ee.distance=T,Ee.squaredDistance=k,Ee.length=L,Ee.squaredLength=x,Ee.negate=function(M,P){return M[0]=-P[0],M[1]=-P[1],M[2]=-P[2],M[3]=-P[3],M},Ee.inverse=function(M,P){return M[0]=1/P[0],M[1]=1/P[1],M[2]=1/P[2],M[3]=1/P[3],M},Ee.normalize=function(M,P){var B=P[0],H=P[1],Z=P[2],te=P[3],ne=B*B+H*H+Z*Z+te*te;return ne>0&&(ne=1/Math.sqrt(ne)),M[0]=B*ne,M[1]=H*ne,M[2]=Z*ne,M[3]=te*ne,M},Ee.dot=function(M,P){return M[0]*P[0]+M[1]*P[1]+M[2]*P[2]+M[3]*P[3]},Ee.cross=function(M,P,B,H){var Z=B[0]*H[1]-B[1]*H[0],te=B[0]*H[2]-B[2]*H[0],ne=B[0]*H[3]-B[3]*H[0],X=B[1]*H[2]-B[2]*H[1],le=B[1]*H[3]-B[3]*H[1],pe=B[2]*H[3]-B[3]*H[2],Ce=P[0],Ue=P[1],Le=P[2],ze=P[3];return M[0]=Ue*pe-Le*le+ze*X,M[1]=-Ce*pe+Le*ne-ze*te,M[2]=Ce*le-Ue*ne+ze*Z,M[3]=-Ce*X+Ue*te-Le*Z,M},Ee.lerp=function(M,P,B,H){var Z=P[0],te=P[1],ne=P[2],X=P[3];return M[0]=Z+H*(B[0]-Z),M[1]=te+H*(B[1]-te),M[2]=ne+H*(B[2]-ne),M[3]=X+H*(B[3]-X),M},Ee.random=function(M,P){var B,H,Z,te,ne,X;P=P||1;do ne=(B=2*n.RANDOM()-1)*B+(H=2*n.RANDOM()-1)*H;while(ne>=1);do X=(Z=2*n.RANDOM()-1)*Z+(te=2*n.RANDOM()-1)*te;while(X>=1);var le=Math.sqrt((1-ne)/X);return M[0]=P*B,M[1]=P*H,M[2]=P*Z*le,M[3]=P*te*le,M},Ee.transformMat4=function(M,P,B){var H=P[0],Z=P[1],te=P[2],ne=P[3];return M[0]=B[0]*H+B[4]*Z+B[8]*te+B[12]*ne,M[1]=B[1]*H+B[5]*Z+B[9]*te+B[13]*ne,M[2]=B[2]*H+B[6]*Z+B[10]*te+B[14]*ne,M[3]=B[3]*H+B[7]*Z+B[11]*te+B[15]*ne,M},Ee.transformQuat=function(M,P,B){var H=P[0],Z=P[1],te=P[2],ne=B[0],X=B[1],le=B[2],pe=B[3],Ce=pe*H+X*te-le*Z,Ue=pe*Z+le*H-ne*te,Le=pe*te+ne*Z-X*H,ze=-ne*H-X*Z-le*te;return M[0]=Ce*pe+ze*-ne+Ue*-le-Le*-X,M[1]=Ue*pe+ze*-X+Le*-ne-Ce*-le,M[2]=Le*pe+ze*-le+Ce*-X-Ue*-ne,M[3]=P[3],M},Ee.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M[3]=0,M},Ee.str=function(M){return"vec4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+")"},Ee.exactEquals=function(M,P){return M[0]===P[0]&&M[1]===P[1]&&M[2]===P[2]&&M[3]===P[3]},Ee.equals=function(M,P){var B=M[0],H=M[1],Z=M[2],te=M[3],ne=P[0],X=P[1],le=P[2],pe=P[3];return Math.abs(B-ne)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(ne))&&Math.abs(H-X)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(X))&&Math.abs(Z-le)<=n.EPSILON*Math.max(1,Math.abs(Z),Math.abs(le))&&Math.abs(te-pe)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(pe))},Ee.forEach=Ee.sqrLen=Ee.len=Ee.sqrDist=Ee.dist=Ee.div=Ee.mul=Ee.sub=void 0;var n=function(M,P){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var B=s(void 0);if(B&&B.has(M))return B.get(M);var H={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in M)if(te!=="default"&&Object.prototype.hasOwnProperty.call(M,te)){var ne=Z?Object.getOwnPropertyDescriptor(M,te):null;ne&&(ne.get||ne.set)?Object.defineProperty(H,te,ne):H[te]=M[te]}return H.default=M,B&&B.set(M,H),H}(z());function s(M){if(typeof WeakMap!="function")return null;var P=new WeakMap,B=new WeakMap;return(s=function(H){return H?B:P})(M)}function u(){var M=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M}function m(M,P,B){return M[0]=P[0]-B[0],M[1]=P[1]-B[1],M[2]=P[2]-B[2],M[3]=P[3]-B[3],M}function h(M,P,B){return M[0]=P[0]*B[0],M[1]=P[1]*B[1],M[2]=P[2]*B[2],M[3]=P[3]*B[3],M}function v(M,P,B){return M[0]=P[0]/B[0],M[1]=P[1]/B[1],M[2]=P[2]/B[2],M[3]=P[3]/B[3],M}function T(M,P){return Math.hypot(P[0]-M[0],P[1]-M[1],P[2]-M[2],P[3]-M[3])}function k(M,P){var B=P[0]-M[0],H=P[1]-M[1],Z=P[2]-M[2],te=P[3]-M[3];return B*B+H*H+Z*Z+te*te}function L(M){return Math.hypot(M[0],M[1],M[2],M[3])}function x(M){var P=M[0],B=M[1],H=M[2],Z=M[3];return P*P+B*B+H*H+Z*Z}Ee.sub=m,Ee.mul=h,Ee.div=v,Ee.dist=T,Ee.sqrDist=k,Ee.len=L,Ee.sqrLen=x;var A,D=(A=u(),function(M,P,B,H,Z,te){var ne,X;for(P||(P=4),B||(B=0),X=H?Math.min(H*P+B,M.length):M.length,ne=B;ne<X;ne+=P)A[0]=M[ne],A[1]=M[ne+1],A[2]=M[ne+2],A[3]=M[ne+3],Z(A,A,te),M[ne]=A[0],M[ne+1]=A[1],M[ne+2]=A[2],M[ne+3]=A[3];return M});return Ee.forEach=D,Ee}function Me(){if(Qe)return ce;function c(Oe){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et},c(Oe)}Qe=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.create=T,ce.identity=function(Oe){return Oe[0]=0,Oe[1]=0,Oe[2]=0,Oe[3]=1,Oe},ce.setAxisAngle=k,ce.getAxisAngle=function(Oe,et){var ct=2*Math.acos(et[3]),ut=Math.sin(ct/2);return ut>n.EPSILON?(Oe[0]=et[0]/ut,Oe[1]=et[1]/ut,Oe[2]=et[2]/ut):(Oe[0]=1,Oe[1]=0,Oe[2]=0),ct},ce.getAngle=function(Oe,et){var ct=B(Oe,et);return Math.acos(2*ct*ct-1)},ce.multiply=L,ce.rotateX=function(Oe,et,ct){ct*=.5;var ut=et[0],_t=et[1],Mt=et[2],kt=et[3],St=Math.sin(ct),Yt=Math.cos(ct);return Oe[0]=ut*Yt+kt*St,Oe[1]=_t*Yt+Mt*St,Oe[2]=Mt*Yt-_t*St,Oe[3]=kt*Yt-ut*St,Oe},ce.rotateY=function(Oe,et,ct){ct*=.5;var ut=et[0],_t=et[1],Mt=et[2],kt=et[3],St=Math.sin(ct),Yt=Math.cos(ct);return Oe[0]=ut*Yt-Mt*St,Oe[1]=_t*Yt+kt*St,Oe[2]=Mt*Yt+ut*St,Oe[3]=kt*Yt-_t*St,Oe},ce.rotateZ=function(Oe,et,ct){ct*=.5;var ut=et[0],_t=et[1],Mt=et[2],kt=et[3],St=Math.sin(ct),Yt=Math.cos(ct);return Oe[0]=ut*Yt+_t*St,Oe[1]=_t*Yt-ut*St,Oe[2]=Mt*Yt+kt*St,Oe[3]=kt*Yt-Mt*St,Oe},ce.calculateW=function(Oe,et){var ct=et[0],ut=et[1],_t=et[2];return Oe[0]=ct,Oe[1]=ut,Oe[2]=_t,Oe[3]=Math.sqrt(Math.abs(1-ct*ct-ut*ut-_t*_t)),Oe},ce.exp=x,ce.ln=A,ce.pow=function(Oe,et,ct){return A(Oe,et),P(Oe,Oe,ct),x(Oe,Oe),Oe},ce.slerp=D,ce.random=function(Oe){var et=n.RANDOM(),ct=n.RANDOM(),ut=n.RANDOM(),_t=Math.sqrt(1-et),Mt=Math.sqrt(et);return Oe[0]=_t*Math.sin(2*Math.PI*ct),Oe[1]=_t*Math.cos(2*Math.PI*ct),Oe[2]=Mt*Math.sin(2*Math.PI*ut),Oe[3]=Mt*Math.cos(2*Math.PI*ut),Oe},ce.invert=function(Oe,et){var ct=et[0],ut=et[1],_t=et[2],Mt=et[3],kt=ct*ct+ut*ut+_t*_t+Mt*Mt,St=kt?1/kt:0;return Oe[0]=-ct*St,Oe[1]=-ut*St,Oe[2]=-_t*St,Oe[3]=Mt*St,Oe},ce.conjugate=function(Oe,et){return Oe[0]=-et[0],Oe[1]=-et[1],Oe[2]=-et[2],Oe[3]=et[3],Oe},ce.fromMat3=M,ce.fromEuler=function(Oe,et,ct,ut){var _t=.5*Math.PI/180;et*=_t,ct*=_t,ut*=_t;var Mt=Math.sin(et),kt=Math.cos(et),St=Math.sin(ct),Yt=Math.cos(ct),gn=Math.sin(ut),Ut=Math.cos(ut);return Oe[0]=Mt*Yt*Ut-kt*St*gn,Oe[1]=kt*St*Ut+Mt*Yt*gn,Oe[2]=kt*Yt*gn-Mt*St*Ut,Oe[3]=kt*Yt*Ut+Mt*St*gn,Oe},ce.str=function(Oe){return"quat("+Oe[0]+", "+Oe[1]+", "+Oe[2]+", "+Oe[3]+")"},ce.setAxes=ce.sqlerp=ce.rotationTo=ce.equals=ce.exactEquals=ce.normalize=ce.sqrLen=ce.squaredLength=ce.len=ce.length=ce.lerp=ce.dot=ce.scale=ce.mul=ce.add=ce.set=ce.copy=ce.fromValues=ce.clone=void 0;var n=v(z()),s=v(J()),u=v(_e()),m=v(ye());function h(Oe){if(typeof WeakMap!="function")return null;var et=new WeakMap,ct=new WeakMap;return(h=function(ut){return ut?ct:et})(Oe)}function v(Oe,et){if(Oe&&Oe.__esModule)return Oe;if(Oe===null||c(Oe)!=="object"&&typeof Oe!="function")return{default:Oe};var ct=h(et);if(ct&&ct.has(Oe))return ct.get(Oe);var ut={},_t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Mt in Oe)if(Mt!=="default"&&Object.prototype.hasOwnProperty.call(Oe,Mt)){var kt=_t?Object.getOwnPropertyDescriptor(Oe,Mt):null;kt&&(kt.get||kt.set)?Object.defineProperty(ut,Mt,kt):ut[Mt]=Oe[Mt]}return ut.default=Oe,ct&&ct.set(Oe,ut),ut}function T(){var Oe=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(Oe[0]=0,Oe[1]=0,Oe[2]=0),Oe[3]=1,Oe}function k(Oe,et,ct){ct*=.5;var ut=Math.sin(ct);return Oe[0]=ut*et[0],Oe[1]=ut*et[1],Oe[2]=ut*et[2],Oe[3]=Math.cos(ct),Oe}function L(Oe,et,ct){var ut=et[0],_t=et[1],Mt=et[2],kt=et[3],St=ct[0],Yt=ct[1],gn=ct[2],Ut=ct[3];return Oe[0]=ut*Ut+kt*St+_t*gn-Mt*Yt,Oe[1]=_t*Ut+kt*Yt+Mt*St-ut*gn,Oe[2]=Mt*Ut+kt*gn+ut*Yt-_t*St,Oe[3]=kt*Ut-ut*St-_t*Yt-Mt*gn,Oe}function x(Oe,et){var ct=et[0],ut=et[1],_t=et[2],Mt=et[3],kt=Math.sqrt(ct*ct+ut*ut+_t*_t),St=Math.exp(Mt),Yt=kt>0?St*Math.sin(kt)/kt:0;return Oe[0]=ct*Yt,Oe[1]=ut*Yt,Oe[2]=_t*Yt,Oe[3]=St*Math.cos(kt),Oe}function A(Oe,et){var ct=et[0],ut=et[1],_t=et[2],Mt=et[3],kt=Math.sqrt(ct*ct+ut*ut+_t*_t),St=kt>0?Math.atan2(kt,Mt)/kt:0;return Oe[0]=ct*St,Oe[1]=ut*St,Oe[2]=_t*St,Oe[3]=.5*Math.log(ct*ct+ut*ut+_t*_t+Mt*Mt),Oe}function D(Oe,et,ct,ut){var _t,Mt,kt,St,Yt,gn=et[0],Ut=et[1],zn=et[2],En=et[3],xn=ct[0],pn=ct[1],no=ct[2],Ln=ct[3];return(Mt=gn*xn+Ut*pn+zn*no+En*Ln)<0&&(Mt=-Mt,xn=-xn,pn=-pn,no=-no,Ln=-Ln),1-Mt>n.EPSILON?(_t=Math.acos(Mt),kt=Math.sin(_t),St=Math.sin((1-ut)*_t)/kt,Yt=Math.sin(ut*_t)/kt):(St=1-ut,Yt=ut),Oe[0]=St*gn+Yt*xn,Oe[1]=St*Ut+Yt*pn,Oe[2]=St*zn+Yt*no,Oe[3]=St*En+Yt*Ln,Oe}function M(Oe,et){var ct,ut=et[0]+et[4]+et[8];if(ut>0)ct=Math.sqrt(ut+1),Oe[3]=.5*ct,Oe[0]=(et[5]-et[7])*(ct=.5/ct),Oe[1]=(et[6]-et[2])*ct,Oe[2]=(et[1]-et[3])*ct;else{var _t=0;et[4]>et[0]&&(_t=1),et[8]>et[3*_t+_t]&&(_t=2);var Mt=(_t+1)%3,kt=(_t+2)%3;ct=Math.sqrt(et[3*_t+_t]-et[3*Mt+Mt]-et[3*kt+kt]+1),Oe[_t]=.5*ct,Oe[3]=(et[3*Mt+kt]-et[3*kt+Mt])*(ct=.5/ct),Oe[Mt]=(et[3*Mt+_t]+et[3*_t+Mt])*ct,Oe[kt]=(et[3*kt+_t]+et[3*_t+kt])*ct}return Oe}ce.clone=m.clone,ce.fromValues=m.fromValues,ce.copy=m.copy,ce.set=m.set,ce.add=m.add,ce.mul=L;var P=m.scale;ce.scale=P;var B=m.dot;ce.dot=B,ce.lerp=m.lerp;var H=m.length;ce.length=H,ce.len=H;var Z=m.squaredLength;ce.squaredLength=Z,ce.sqrLen=Z;var te=m.normalize;ce.normalize=te,ce.exactEquals=m.exactEquals,ce.equals=m.equals;var ne,X,le,pe=(ne=u.create(),X=u.fromValues(1,0,0),le=u.fromValues(0,1,0),function(Oe,et,ct){var ut=u.dot(et,ct);return ut<-.999999?(u.cross(ne,X,et),u.len(ne)<1e-6&&u.cross(ne,le,et),u.normalize(ne,ne),k(Oe,ne,Math.PI),Oe):ut>.999999?(Oe[0]=0,Oe[1]=0,Oe[2]=0,Oe[3]=1,Oe):(u.cross(ne,et,ct),Oe[0]=ne[0],Oe[1]=ne[1],Oe[2]=ne[2],Oe[3]=1+ut,te(Oe,Oe))});ce.rotationTo=pe;var Ce,Ue,Le=(Ce=T(),Ue=T(),function(Oe,et,ct,ut,_t,Mt){return D(Ce,et,_t,Mt),D(Ue,ct,ut,Mt),D(Oe,Ce,Ue,2*Mt*(1-Mt)),Oe});ce.sqlerp=Le;var ze,ot=(ze=s.create(),function(Oe,et,ct,ut){return ze[0]=ct[0],ze[3]=ct[1],ze[6]=ct[2],ze[1]=ut[0],ze[4]=ut[1],ze[7]=ut[2],ze[2]=-et[0],ze[5]=-et[1],ze[8]=-et[2],te(Oe,M(Oe,ze))});return ce.setAxes=ot,ce}var Te,he={};function ke(){if(Te)return he;function c(D){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},c(D)}Te=1,Object.defineProperty(he,"__esModule",{value:!0}),he.create=function(){var D=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D},he.clone=function(D){var M=new n.ARRAY_TYPE(8);return M[0]=D[0],M[1]=D[1],M[2]=D[2],M[3]=D[3],M[4]=D[4],M[5]=D[5],M[6]=D[6],M[7]=D[7],M},he.fromValues=function(D,M,P,B,H,Z,te,ne){var X=new n.ARRAY_TYPE(8);return X[0]=D,X[1]=M,X[2]=P,X[3]=B,X[4]=H,X[5]=Z,X[6]=te,X[7]=ne,X},he.fromRotationTranslationValues=function(D,M,P,B,H,Z,te){var ne=new n.ARRAY_TYPE(8);ne[0]=D,ne[1]=M,ne[2]=P,ne[3]=B;var X=.5*H,le=.5*Z,pe=.5*te;return ne[4]=X*B+le*P-pe*M,ne[5]=le*B+pe*D-X*P,ne[6]=pe*B+X*M-le*D,ne[7]=-X*D-le*M-pe*P,ne},he.fromRotationTranslation=v,he.fromTranslation=function(D,M){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=.5*M[0],D[5]=.5*M[1],D[6]=.5*M[2],D[7]=0,D},he.fromRotation=function(D,M){return D[0]=M[0],D[1]=M[1],D[2]=M[2],D[3]=M[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},he.fromMat4=function(D,M){var P=s.create();u.getRotation(P,M);var B=new n.ARRAY_TYPE(3);return u.getTranslation(B,M),v(D,P,B),D},he.copy=T,he.identity=function(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D},he.set=function(D,M,P,B,H,Z,te,ne,X){return D[0]=M,D[1]=P,D[2]=B,D[3]=H,D[4]=Z,D[5]=te,D[6]=ne,D[7]=X,D},he.getDual=function(D,M){return D[0]=M[4],D[1]=M[5],D[2]=M[6],D[3]=M[7],D},he.setDual=function(D,M){return D[4]=M[0],D[5]=M[1],D[6]=M[2],D[7]=M[3],D},he.getTranslation=function(D,M){var P=M[4],B=M[5],H=M[6],Z=M[7],te=-M[0],ne=-M[1],X=-M[2],le=M[3];return D[0]=2*(P*le+Z*te+B*X-H*ne),D[1]=2*(B*le+Z*ne+H*te-P*X),D[2]=2*(H*le+Z*X+P*ne-B*te),D},he.translate=function(D,M,P){var B=M[0],H=M[1],Z=M[2],te=M[3],ne=.5*P[0],X=.5*P[1],le=.5*P[2],pe=M[4],Ce=M[5],Ue=M[6],Le=M[7];return D[0]=B,D[1]=H,D[2]=Z,D[3]=te,D[4]=te*ne+H*le-Z*X+pe,D[5]=te*X+Z*ne-B*le+Ce,D[6]=te*le+B*X-H*ne+Ue,D[7]=-B*ne-H*X-Z*le+Le,D},he.rotateX=function(D,M,P){var B=-M[0],H=-M[1],Z=-M[2],te=M[3],ne=M[4],X=M[5],le=M[6],pe=M[7],Ce=ne*te+pe*B+X*Z-le*H,Ue=X*te+pe*H+le*B-ne*Z,Le=le*te+pe*Z+ne*H-X*B,ze=pe*te-ne*B-X*H-le*Z;return s.rotateX(D,M,P),D[4]=Ce*(te=D[3])+ze*(B=D[0])+Ue*(Z=D[2])-Le*(H=D[1]),D[5]=Ue*te+ze*H+Le*B-Ce*Z,D[6]=Le*te+ze*Z+Ce*H-Ue*B,D[7]=ze*te-Ce*B-Ue*H-Le*Z,D},he.rotateY=function(D,M,P){var B=-M[0],H=-M[1],Z=-M[2],te=M[3],ne=M[4],X=M[5],le=M[6],pe=M[7],Ce=ne*te+pe*B+X*Z-le*H,Ue=X*te+pe*H+le*B-ne*Z,Le=le*te+pe*Z+ne*H-X*B,ze=pe*te-ne*B-X*H-le*Z;return s.rotateY(D,M,P),D[4]=Ce*(te=D[3])+ze*(B=D[0])+Ue*(Z=D[2])-Le*(H=D[1]),D[5]=Ue*te+ze*H+Le*B-Ce*Z,D[6]=Le*te+ze*Z+Ce*H-Ue*B,D[7]=ze*te-Ce*B-Ue*H-Le*Z,D},he.rotateZ=function(D,M,P){var B=-M[0],H=-M[1],Z=-M[2],te=M[3],ne=M[4],X=M[5],le=M[6],pe=M[7],Ce=ne*te+pe*B+X*Z-le*H,Ue=X*te+pe*H+le*B-ne*Z,Le=le*te+pe*Z+ne*H-X*B,ze=pe*te-ne*B-X*H-le*Z;return s.rotateZ(D,M,P),D[4]=Ce*(te=D[3])+ze*(B=D[0])+Ue*(Z=D[2])-Le*(H=D[1]),D[5]=Ue*te+ze*H+Le*B-Ce*Z,D[6]=Le*te+ze*Z+Ce*H-Ue*B,D[7]=ze*te-Ce*B-Ue*H-Le*Z,D},he.rotateByQuatAppend=function(D,M,P){var B=P[0],H=P[1],Z=P[2],te=P[3],ne=M[0],X=M[1],le=M[2],pe=M[3];return D[0]=ne*te+pe*B+X*Z-le*H,D[1]=X*te+pe*H+le*B-ne*Z,D[2]=le*te+pe*Z+ne*H-X*B,D[3]=pe*te-ne*B-X*H-le*Z,D[4]=(ne=M[4])*te+(pe=M[7])*B+(X=M[5])*Z-(le=M[6])*H,D[5]=X*te+pe*H+le*B-ne*Z,D[6]=le*te+pe*Z+ne*H-X*B,D[7]=pe*te-ne*B-X*H-le*Z,D},he.rotateByQuatPrepend=function(D,M,P){var B=M[0],H=M[1],Z=M[2],te=M[3],ne=P[0],X=P[1],le=P[2],pe=P[3];return D[0]=B*pe+te*ne+H*le-Z*X,D[1]=H*pe+te*X+Z*ne-B*le,D[2]=Z*pe+te*le+B*X-H*ne,D[3]=te*pe-B*ne-H*X-Z*le,D[4]=B*(pe=P[7])+te*(ne=P[4])+H*(le=P[6])-Z*(X=P[5]),D[5]=H*pe+te*X+Z*ne-B*le,D[6]=Z*pe+te*le+B*X-H*ne,D[7]=te*pe-B*ne-H*X-Z*le,D},he.rotateAroundAxis=function(D,M,P,B){if(Math.abs(B)<n.EPSILON)return T(D,M);var H=Math.hypot(P[0],P[1],P[2]);B*=.5;var Z=Math.sin(B),te=Z*P[0]/H,ne=Z*P[1]/H,X=Z*P[2]/H,le=Math.cos(B),pe=M[0],Ce=M[1],Ue=M[2],Le=M[3];D[0]=pe*le+Le*te+Ce*X-Ue*ne,D[1]=Ce*le+Le*ne+Ue*te-pe*X,D[2]=Ue*le+Le*X+pe*ne-Ce*te,D[3]=Le*le-pe*te-Ce*ne-Ue*X;var ze=M[4],ot=M[5],Oe=M[6],et=M[7];return D[4]=ze*le+et*te+ot*X-Oe*ne,D[5]=ot*le+et*ne+Oe*te-ze*X,D[6]=Oe*le+et*X+ze*ne-ot*te,D[7]=et*le-ze*te-ot*ne-Oe*X,D},he.add=function(D,M,P){return D[0]=M[0]+P[0],D[1]=M[1]+P[1],D[2]=M[2]+P[2],D[3]=M[3]+P[3],D[4]=M[4]+P[4],D[5]=M[5]+P[5],D[6]=M[6]+P[6],D[7]=M[7]+P[7],D},he.multiply=k,he.scale=function(D,M,P){return D[0]=M[0]*P,D[1]=M[1]*P,D[2]=M[2]*P,D[3]=M[3]*P,D[4]=M[4]*P,D[5]=M[5]*P,D[6]=M[6]*P,D[7]=M[7]*P,D},he.lerp=function(D,M,P,B){var H=1-B;return L(M,P)<0&&(B=-B),D[0]=M[0]*H+P[0]*B,D[1]=M[1]*H+P[1]*B,D[2]=M[2]*H+P[2]*B,D[3]=M[3]*H+P[3]*B,D[4]=M[4]*H+P[4]*B,D[5]=M[5]*H+P[5]*B,D[6]=M[6]*H+P[6]*B,D[7]=M[7]*H+P[7]*B,D},he.invert=function(D,M){var P=A(M);return D[0]=-M[0]/P,D[1]=-M[1]/P,D[2]=-M[2]/P,D[3]=M[3]/P,D[4]=-M[4]/P,D[5]=-M[5]/P,D[6]=-M[6]/P,D[7]=M[7]/P,D},he.conjugate=function(D,M){return D[0]=-M[0],D[1]=-M[1],D[2]=-M[2],D[3]=M[3],D[4]=-M[4],D[5]=-M[5],D[6]=-M[6],D[7]=M[7],D},he.normalize=function(D,M){var P=A(M);if(P>0){P=Math.sqrt(P);var B=M[0]/P,H=M[1]/P,Z=M[2]/P,te=M[3]/P,ne=M[4],X=M[5],le=M[6],pe=M[7],Ce=B*ne+H*X+Z*le+te*pe;D[0]=B,D[1]=H,D[2]=Z,D[3]=te,D[4]=(ne-B*Ce)/P,D[5]=(X-H*Ce)/P,D[6]=(le-Z*Ce)/P,D[7]=(pe-te*Ce)/P}return D},he.str=function(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"},he.exactEquals=function(D,M){return D[0]===M[0]&&D[1]===M[1]&&D[2]===M[2]&&D[3]===M[3]&&D[4]===M[4]&&D[5]===M[5]&&D[6]===M[6]&&D[7]===M[7]},he.equals=function(D,M){var P=D[0],B=D[1],H=D[2],Z=D[3],te=D[4],ne=D[5],X=D[6],le=D[7],pe=M[0],Ce=M[1],Ue=M[2],Le=M[3],ze=M[4],ot=M[5],Oe=M[6],et=M[7];return Math.abs(P-pe)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(pe))&&Math.abs(B-Ce)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ce))&&Math.abs(H-Ue)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(Ue))&&Math.abs(Z-Le)<=n.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Le))&&Math.abs(te-ze)<=n.EPSILON*Math.max(1,Math.abs(te),Math.abs(ze))&&Math.abs(ne-ot)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ot))&&Math.abs(X-Oe)<=n.EPSILON*Math.max(1,Math.abs(X),Math.abs(Oe))&&Math.abs(le-et)<=n.EPSILON*Math.max(1,Math.abs(le),Math.abs(et))},he.sqrLen=he.squaredLength=he.len=he.length=he.dot=he.mul=he.setReal=he.getReal=void 0;var n=h(z()),s=h(Me()),u=h(fe());function m(D){if(typeof WeakMap!="function")return null;var M=new WeakMap,P=new WeakMap;return(m=function(B){return B?P:M})(D)}function h(D,M){if(D&&D.__esModule)return D;if(D===null||c(D)!=="object"&&typeof D!="function")return{default:D};var P=m(M);if(P&&P.has(D))return P.get(D);var B={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in D)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(D,Z)){var te=H?Object.getOwnPropertyDescriptor(D,Z):null;te&&(te.get||te.set)?Object.defineProperty(B,Z,te):B[Z]=D[Z]}return B.default=D,P&&P.set(D,B),B}function v(D,M,P){var B=.5*P[0],H=.5*P[1],Z=.5*P[2],te=M[0],ne=M[1],X=M[2],le=M[3];return D[0]=te,D[1]=ne,D[2]=X,D[3]=le,D[4]=B*le+H*X-Z*ne,D[5]=H*le+Z*te-B*X,D[6]=Z*le+B*ne-H*te,D[7]=-B*te-H*ne-Z*X,D}function T(D,M){return D[0]=M[0],D[1]=M[1],D[2]=M[2],D[3]=M[3],D[4]=M[4],D[5]=M[5],D[6]=M[6],D[7]=M[7],D}function k(D,M,P){var B=M[0],H=M[1],Z=M[2],te=M[3],ne=P[4],X=P[5],le=P[6],pe=P[7],Ce=M[4],Ue=M[5],Le=M[6],ze=M[7],ot=P[0],Oe=P[1],et=P[2],ct=P[3];return D[0]=B*ct+te*ot+H*et-Z*Oe,D[1]=H*ct+te*Oe+Z*ot-B*et,D[2]=Z*ct+te*et+B*Oe-H*ot,D[3]=te*ct-B*ot-H*Oe-Z*et,D[4]=B*pe+te*ne+H*le-Z*X+Ce*ct+ze*ot+Ue*et-Le*Oe,D[5]=H*pe+te*X+Z*ne-B*le+Ue*ct+ze*Oe+Le*ot-Ce*et,D[6]=Z*pe+te*le+B*X-H*ne+Le*ct+ze*et+Ce*Oe-Ue*ot,D[7]=te*pe-B*ne-H*X-Z*le+ze*ct-Ce*ot-Ue*Oe-Le*et,D}he.getReal=s.copy,he.setReal=s.copy,he.mul=k;var L=s.dot;he.dot=L;var x=s.length;he.length=x,he.len=x;var A=s.squaredLength;return he.squaredLength=A,he.sqrLen=A,he}var Ne,nt,De={};function Ct(){if(Ne)return De;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(M)}Ne=1,Object.defineProperty(De,"__esModule",{value:!0}),De.create=u,De.clone=function(M){var P=new n.ARRAY_TYPE(2);return P[0]=M[0],P[1]=M[1],P},De.fromValues=function(M,P){var B=new n.ARRAY_TYPE(2);return B[0]=M,B[1]=P,B},De.copy=function(M,P){return M[0]=P[0],M[1]=P[1],M},De.set=function(M,P,B){return M[0]=P,M[1]=B,M},De.add=function(M,P,B){return M[0]=P[0]+B[0],M[1]=P[1]+B[1],M},De.subtract=m,De.multiply=h,De.divide=v,De.ceil=function(M,P){return M[0]=Math.ceil(P[0]),M[1]=Math.ceil(P[1]),M},De.floor=function(M,P){return M[0]=Math.floor(P[0]),M[1]=Math.floor(P[1]),M},De.min=function(M,P,B){return M[0]=Math.min(P[0],B[0]),M[1]=Math.min(P[1],B[1]),M},De.max=function(M,P,B){return M[0]=Math.max(P[0],B[0]),M[1]=Math.max(P[1],B[1]),M},De.round=function(M,P){return M[0]=Math.round(P[0]),M[1]=Math.round(P[1]),M},De.scale=function(M,P,B){return M[0]=P[0]*B,M[1]=P[1]*B,M},De.scaleAndAdd=function(M,P,B,H){return M[0]=P[0]+B[0]*H,M[1]=P[1]+B[1]*H,M},De.distance=T,De.squaredDistance=k,De.length=L,De.squaredLength=x,De.negate=function(M,P){return M[0]=-P[0],M[1]=-P[1],M},De.inverse=function(M,P){return M[0]=1/P[0],M[1]=1/P[1],M},De.normalize=function(M,P){var B=P[0],H=P[1],Z=B*B+H*H;return Z>0&&(Z=1/Math.sqrt(Z)),M[0]=P[0]*Z,M[1]=P[1]*Z,M},De.dot=function(M,P){return M[0]*P[0]+M[1]*P[1]},De.cross=function(M,P,B){var H=P[0]*B[1]-P[1]*B[0];return M[0]=M[1]=0,M[2]=H,M},De.lerp=function(M,P,B,H){var Z=P[0],te=P[1];return M[0]=Z+H*(B[0]-Z),M[1]=te+H*(B[1]-te),M},De.random=function(M,P){P=P||1;var B=2*n.RANDOM()*Math.PI;return M[0]=Math.cos(B)*P,M[1]=Math.sin(B)*P,M},De.transformMat2=function(M,P,B){var H=P[0],Z=P[1];return M[0]=B[0]*H+B[2]*Z,M[1]=B[1]*H+B[3]*Z,M},De.transformMat2d=function(M,P,B){var H=P[0],Z=P[1];return M[0]=B[0]*H+B[2]*Z+B[4],M[1]=B[1]*H+B[3]*Z+B[5],M},De.transformMat3=function(M,P,B){var H=P[0],Z=P[1];return M[0]=B[0]*H+B[3]*Z+B[6],M[1]=B[1]*H+B[4]*Z+B[7],M},De.transformMat4=function(M,P,B){var H=P[0],Z=P[1];return M[0]=B[0]*H+B[4]*Z+B[12],M[1]=B[1]*H+B[5]*Z+B[13],M},De.rotate=function(M,P,B,H){var Z=P[0]-B[0],te=P[1]-B[1],ne=Math.sin(H),X=Math.cos(H);return M[0]=Z*X-te*ne+B[0],M[1]=Z*ne+te*X+B[1],M},De.angle=function(M,P){var B=M[0],H=M[1],Z=P[0],te=P[1],ne=Math.sqrt(B*B+H*H)*Math.sqrt(Z*Z+te*te);return Math.acos(Math.min(Math.max(ne&&(B*Z+H*te)/ne,-1),1))},De.zero=function(M){return M[0]=0,M[1]=0,M},De.str=function(M){return"vec2("+M[0]+", "+M[1]+")"},De.exactEquals=function(M,P){return M[0]===P[0]&&M[1]===P[1]},De.equals=function(M,P){var B=M[0],H=M[1],Z=P[0],te=P[1];return Math.abs(B-Z)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Z))&&Math.abs(H-te)<=n.EPSILON*Math.max(1,Math.abs(H),Math.abs(te))},De.forEach=De.sqrLen=De.sqrDist=De.dist=De.div=De.mul=De.sub=De.len=void 0;var n=function(M,P){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var B=s(void 0);if(B&&B.has(M))return B.get(M);var H={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in M)if(te!=="default"&&Object.prototype.hasOwnProperty.call(M,te)){var ne=Z?Object.getOwnPropertyDescriptor(M,te):null;ne&&(ne.get||ne.set)?Object.defineProperty(H,te,ne):H[te]=M[te]}return H.default=M,B&&B.set(M,H),H}(z());function s(M){if(typeof WeakMap!="function")return null;var P=new WeakMap,B=new WeakMap;return(s=function(H){return H?B:P})(M)}function u(){var M=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0),M}function m(M,P,B){return M[0]=P[0]-B[0],M[1]=P[1]-B[1],M}function h(M,P,B){return M[0]=P[0]*B[0],M[1]=P[1]*B[1],M}function v(M,P,B){return M[0]=P[0]/B[0],M[1]=P[1]/B[1],M}function T(M,P){return Math.hypot(P[0]-M[0],P[1]-M[1])}function k(M,P){var B=P[0]-M[0],H=P[1]-M[1];return B*B+H*H}function L(M){return Math.hypot(M[0],M[1])}function x(M){var P=M[0],B=M[1];return P*P+B*B}De.len=L,De.sub=m,De.mul=h,De.div=v,De.dist=T,De.sqrDist=k,De.sqrLen=x;var A,D=(A=u(),function(M,P,B,H,Z,te){var ne,X;for(P||(P=2),B||(B=0),X=H?Math.min(H*P+B,M.length):M.length,ne=B;ne<X;ne+=P)A[0]=M[ne],A[1]=M[ne+1],Z(A,A,te),M[ne]=A[0],M[ne+1]=A[1];return M});return De.forEach=D,De}function Rt(){if(nt)return I;function c(M){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(M)}nt=1,Object.defineProperty(I,"__esModule",{value:!0}),I.vec4=I.vec3=I.vec2=I.quat2=I.quat=I.mat4=I.mat3=I.mat2d=I.mat2=I.glMatrix=void 0;var n=D(z());I.glMatrix=n;var s=D(F());I.mat2=s;var u=D(re());I.mat2d=u;var m=D(J());I.mat3=m;var h=D(fe());I.mat4=h;var v=D(Me());I.quat=v;var T=D(ke());I.quat2=T;var k=D(Ct());I.vec2=k;var L=D(_e());I.vec3=L;var x=D(ye());function A(M){if(typeof WeakMap!="function")return null;var P=new WeakMap,B=new WeakMap;return(A=function(H){return H?B:P})(M)}function D(M,P){if(M&&M.__esModule)return M;if(M===null||c(M)!=="object"&&typeof M!="function")return{default:M};var B=A(P);if(B&&B.has(M))return B.get(M);var H={},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in M)if(te!=="default"&&Object.prototype.hasOwnProperty.call(M,te)){var ne=Z?Object.getOwnPropertyDescriptor(M,te):null;ne&&(ne.get||ne.set)?Object.defineProperty(H,te,ne):H[te]=M[te]}return H.default=M,B&&B.set(M,H),H}return I.vec4=x,I}var Bt,mt,Gt,jt,Be=Rt(),an=function(){if(mt)return Bt;function c(n,s,u,m){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(m-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=u,this.p2y=m}return mt=1,Bt=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,m=0;m<8;m++){var h=this.sampleCurveX(u)-n;if(Math.abs(h)<s)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=h/v}var T=0,k=1;for(u=n,m=0;m<20&&(h=this.sampleCurveX(u),!(Math.abs(h-n)<s));m++)n>h?T=u:k=u,u=.5*(k-T)+T;return u},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},Bt}(),At=S(an);function Ge(){if(jt)return Gt;function c(n,s){this.x=n,this.y=s}return jt=1,Gt=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,u=n.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),u=Math.sin(n),m=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=m,this},_rotateAround:function(n,s){var u=Math.cos(n),m=Math.sin(n),h=s.y+m*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-m*(this.y-s.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},Gt}var Fe=S(Ge());function Nt(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(!Nt(c[s],n[s]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const s in c)if(!Nt(c[s],n[s]))return!1;return!0}return c===n}const Jt=Math.PI/180,Dt=180/Math.PI;function xt(c){return c*Jt}function Ot(c){return c*Dt}const en=[[0,0],[1,0],[1,1],[0,1]];function dn(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,s=n*c;return 4*(c<.5?s:3*(c-n)+s-.75)}function un(c,n,s,u){const m=new At(c,n,s,u);return function(h){return m.solve(h)}}const Pn=un(.25,.1,.25,1);function gt(c,n,s){return Math.min(s,Math.max(n,c))}function Sn(c,n,s){return(s=gt((s-c)/(n-c),0,1))*s*(3-2*s)}function Vn(c,n,s){const u=s-n,m=((c-n)%u+u)%u+n;return m===n?s:m}function lo(c,n,s){if(!c.length)return s(null,[]);let u=c.length;const m=new Array(c.length);let h=null;c.forEach((v,T)=>{n(v,(k,L)=>{k&&(h=k),m[T]=L,--u==0&&s(h,m)})})}function eo(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}let fo=1;function Lo(){return fo++}function er(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Pt(c,n){c.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function _n(c,n){return c.indexOf(n,c.length-n.length)!==-1}function dt(c,n,s){const u={};for(const m in c)u[m]=n.call(this,c[m],m,c);return u}function tn(c,n,s){const u={};for(const m in c)n.call(this,c[m],m,c)&&(u[m]=c[m]);return u}function Ze(c){return Array.isArray(c)?c.map(Ze):typeof c=="object"&&c?dt(c,Ze):c}const vn={};function Mn(c){vn[c]||(typeof console<"u"&&console.warn(c),vn[c]=!0)}function yo(c,n,s){return(s.y-c.y)*(n.x-c.x)>(n.y-c.y)*(s.x-c.x)}function gr(c){let n=0;for(let s,u,m=0,h=c.length,v=h-1;m<h;v=m++)s=c[m],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function Xr([c,n,s]){const u=xt(n+90),m=xt(s);return{x:c*Math.cos(u)*Math.sin(m),y:c*Math.sin(u)*Math.sin(m),z:c*Math.cos(m),azimuthal:n,polar:s}}function Ur(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Rr(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,m,h)=>{const v=m||h;return n[u]=!v||v.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let Oo=null;function _i(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function ya(c,n,s,u){for(;n<s;){const m=n+s>>1;c[m]<u?n=m+1:s=m}return n}function $t(c,n,s,u){for(;n<s;){const m=n+s>>1;c[m]<=u?n=m+1:s=m}return n}function Se(c){return c>0?1/(1.001-c):1+c}function Ae(c){return c>0?1-1/(1.001-c):-c}const He={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!He.API_URL)return null;try{const c=new URL(He.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ft(c){return He.API_URL_REGEX.test(c)}function tt(c){return He.API_SPRITE_REGEX.test(c)}let bt,zt,Tt,Ft,Kt,Zt;function pt(){return bt==null&&(bt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),bt}const Ht={now:()=>Ft!==void 0?Ft:performance.now(),setNow(c){Ft=c},restoreNow(){Ft=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:s,height:u}=c;Kt||(Kt=document.createElement("canvas"));const m=Kt.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(s>Kt.width||u>Kt.height)&&(Kt.width=s,Kt.height=u),m.clearRect(-n,-n,s+2*n,u+2*n),m.drawImage(c,0,0,s,u),m.getImageData(-n,-n,s+2*n,u+2*n)},resolveURL:c=>(zt||(zt=document.createElement("a")),zt.href=c,zt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Tt==null&&(Tt=window.matchMedia("(prefers-reduced-motion: reduce)")),Tt.matches)},hasCanvasFingerprintNoise(){if(Zt!==void 0)return Zt;if(!pt())return Zt=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let s=0;for(let m=0;m<c.width;++m)n.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,n.fillRect(m,0,1,1);const u=n.getImageData(0,0,c.width,c.height);s=0;for(let m=0;m<u.data.length;++m)if(m%4!=3&&s++!==u.data[m])return Zt=!0,!0;return Zt=!1,!1}};function bn(c,n){const s=c.indexOf("?");if(s<0)return`${c}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(c.slice(s));for(const m in n)u.set(m,n[m]);return`${c.slice(0,s)}?${u.toString()}`}function Yn(c,n={persistentParams:[]}){const s=c.indexOf("?");if(s<0)return c;const u=new URLSearchParams,m=new URLSearchParams(c.slice(s));for(const v of n.persistentParams){const T=m.get(v);T&&u.set(v,T)}const h=u.toString();return`${c.slice(0,s)}${h.length>0?`?${h}`:""}`}const ro="mapbox-tiles";let po=500,ao=50;const Ko=["language","worldview","jobid"];let jo,Ro;function Qt(){try{return caches}catch{}}function On(){const c=Qt();c&&jo==null&&(jo=c.open(ro))}let co=1/0;const Co={supported:!1,testSupport:function(c){!El&&Kr&&(ba?Fh(c):vr=c)}};let vr,Kr,El=!1,ba=!1;const Bh=typeof self<"u"?self:{};function Fh(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,Kr),c.isContextLost())return;Co.supported=!0}catch{}c.deleteTexture(n),El=!0}Bh.document&&(Kr=Bh.document.createElement("img"),Kr.onload=function(){vr&&Fh(vr),vr=null,ba=!0},Kr.onerror=function(){El=!0,vr=null},Kr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Nh={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Nh);class em extends Error{constructor(n,s,u){s===401&&ft(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const tm=Ur()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Bc=function(c,n){if(!(/^file:/.test(s=c.url)||/^file:/.test(tm())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,m){const h=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:tm(),referrerPolicy:u.referrerPolicy,signal:h.signal});let T=!1,k=!1;const L=(x=v.url).indexOf("sku=")>0&&ft(x);var x;u.type==="json"&&v.headers.set("Accept","application/json");const A=(M,P,B)=>{if(k)return;if(M&&M.message!=="SecurityError"&&Mn(M.toString()),P&&B)return D(P);const H=Date.now();fetch(v).then(Z=>{if(Z.ok){const te=L?Z.clone():null;return D(Z,te,H)}return m(new em(Z.statusText,Z.status,u.url))}).catch(Z=>{Z.name!=="AbortError"&&m(new Error(`${Z.message} ${u.url}`))})},D=(M,P,B)=>{(u.type==="arrayBuffer"?M.arrayBuffer():u.type==="json"?M.json():M.text()).then(H=>{k||(P&&B&&function(Z,te,ne){if(On(),jo==null)return;const X=Rr(te.headers.get("Cache-Control")||"");if(X["no-store"])return;const le={status:te.status,statusText:te.statusText,headers:new Headers};te.headers.forEach((Ue,Le)=>le.headers.set(Le,Ue)),X["max-age"]&&le.headers.set("Expires",new Date(ne+1e3*X["max-age"]).toUTCString());const pe=le.headers.get("Expires");if(!pe||new Date(pe).getTime()-ne<42e4)return;let Ce=Yn(Z.url,{persistentParams:Ko});if(te.status===206){const Ue=Z.headers.get("Range");if(!Ue)return;le.status=200,Ce=bn(Ce,{range:Ue})}(function(Ue,Le){if(Ro===void 0)try{new Response(new ReadableStream),Ro=!0}catch{Ro=!1}Ro?Le(Ue.body):Ue.blob().then(Le)})(te,Ue=>{const Le=new Response((ze=te.status)!==200&&ze!==404&&[101,103,204,205,304].includes(ze)?null:Ue,le);var ze;On(),jo!=null&&jo.then(ot=>ot.put(Ce,Le)).catch(ot=>Mn(ot.message))})}(v,P,B),T=!0,m(null,H,M.headers.get("Cache-Control"),M.headers.get("Expires")))}).catch(H=>{k||m(new Error(H.message))})};return L?function(M,P){if(On(),jo==null)return P(null);jo.then(B=>{let H=Yn(M.url,{persistentParams:Ko});const Z=M.headers.get("Range");Z&&(H=bn(H,{range:Z})),B.match(H).then(te=>{const ne=function(X){if(!X)return!1;const le=new Date(X.headers.get("Expires")||0),pe=Rr(X.headers.get("Cache-Control")||"");return le>Date.now()&&!pe["no-cache"]}(te);B.delete(H),ne&&B.put(H,te.clone()),P(null,te,ne)}).catch(P)}).catch(P)}(v,A):A(null,null),{cancel:()=>{k=!0,T||h.abort()}}}(c,n);if(Ur()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var s;return function(u,m){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const v in u.headers)h.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{m(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let v=h.response;if(u.type==="json")try{v=JSON.parse(h.response)}catch(T){return m(T)}m(null,v,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else m(new em(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(c,n)},Fc=function(c,n){return Bc(eo(c,{type:"arrayBuffer"}),n)};function Us(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const ea="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ta,is;ta=[],is=0;const xa=function(c,n){if(Co.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),is>=He.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return ta.push(h),h}is++;let s=!1;const u=()=>{if(!s)for(s=!0,is--;ta.length&&is<He.MAX_PARALLEL_IMAGE_REQUESTS;){const h=ta.shift(),{requestParameters:v,callback:T,cancelled:k}=h;k||(h.cancel=xa(v,T).cancel)}},m=Fc(c,(h,v,T,k)=>{u(),h?n(h):v&&(self.createImageBitmap?function(L,x){const A=new Blob([new Uint8Array(L)],{type:"image/png"});createImageBitmap(A).then(D=>{x(null,D)}).catch(D=>{x(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(L,x)=>n(L,x,T,k)):function(L,x){const A=new Image;A.onload=()=>{x(null,A),URL.revokeObjectURL(A.src),A.onload=null,requestAnimationFrame(()=>{A.src=ea})},A.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(L)],{type:"image/png"});A.src=L.byteLength?URL.createObjectURL(D):ea}(v,(L,x)=>n(L,x,T,k)))});return{cancel:()=>{m.cancel(),u()}}};var hd,nm,om,wa={exports:{}},$h={exports:{}},m_={exports:{}},p1=function(){if(om)return wa.exports;om=1;var c=(hd||(hd=1,$h.exports=function(s,u){var m,h,v,T,k,L,x,A;for(h=s.length-(m=3&s.length),v=u,k=3432918353,L=461845907,A=0;A<h;)x=255&s.charCodeAt(A)|(255&s.charCodeAt(++A))<<8|(255&s.charCodeAt(++A))<<16|(255&s.charCodeAt(++A))<<24,++A,v=27492+(65535&(T=5*(65535&(v=(v^=x=(65535&(x=(x=(65535&x)*k+(((x>>>16)*k&65535)<<16)&4294967295)<<15|x>>>17))*L+(((x>>>16)*L&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(x=0,m){case 3:x^=(255&s.charCodeAt(A+2))<<16;case 2:x^=(255&s.charCodeAt(A+1))<<8;case 1:v^=x=(65535&(x=(x=(65535&(x^=255&s.charCodeAt(A)))*k+(((x>>>16)*k&65535)<<16)&4294967295)<<15|x>>>17))*L+(((x>>>16)*L&65535)<<16)&4294967295}return v^=s.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),$h.exports),n=(nm||(nm=1,m_.exports=function(s,u){for(var m,h=s.length,v=u^h,T=0;h>=4;)m=1540483477*(65535&(m=255&s.charCodeAt(T)|(255&s.charCodeAt(++T))<<8|(255&s.charCodeAt(++T))<<16|(255&s.charCodeAt(++T))<<24))+((1540483477*(m>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),h-=4,++T;switch(h){case 3:v^=(255&s.charCodeAt(T+2))<<16;case 2:v^=(255&s.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&s.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),m_.exports);return wa.exports=c,wa.exports.murmur3=c,wa.exports.murmur2=n,wa.exports}(),ss=S(p1);class Ml{constructor(n,...s){eo(this,s[0]||{}),this.type=n}}class fd extends Ml{constructor(n,s={}){super("error",eo({error:n},s))}}function Nc(c,n,s){s[c]&&s[c].indexOf(n)!==-1||(s[c]=s[c]||[],s[c].push(n))}function rm(c,n,s){if(s&&s[c]){const u=s[c].indexOf(n);u!==-1&&s[c].splice(u,1)}}class $c{on(n,s){return this._listeners=this._listeners||{},Nc(n,s,this._listeners),this}off(n,s){return rm(n,s,this._listeners),rm(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Nc(n,s,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,s){const u=typeof n=="string"?new Ml(n,s):n,m=u.type;if(this.listens(m)){u.target=this;const h=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const k of h)k.call(this,u);const v=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const k of v)rm(m,k,this._oneTimeListeners),k.call(this,u);const T=this._eventedParent;T&&(eo(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(u))}else u instanceof fd&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var im,rr={},sm=function(){if(im)return rr;im=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(h){return(h=Math.round(h))<0?0:h>255?255:h}function s(h){return n(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(v=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:v>1?1:v;var v}function m(h,v,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?h+(v-h)*T*6:2*T<1?v:3*T<2?h+(v-h)*(2/3-T)*6:h}try{rr.parseCSSColor=function(h){var v,T=h.replace(/ /g,"").toLowerCase();if(T in c)return c[T].slice();if(T[0]==="#")return T.length===4?(v=parseInt(T.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:T.length===7&&(v=parseInt(T.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var k=T.indexOf("("),L=T.indexOf(")");if(k!==-1&&L+1===T.length){var x=T.substr(0,k),A=T.substr(k+1,L-(k+1)).split(","),D=1;switch(x){case"rgba":if(A.length!==4)return null;D=u(A.pop());case"rgb":return A.length!==3?null:[s(A[0]),s(A[1]),s(A[2]),D];case"hsla":if(A.length!==4)return null;D=u(A.pop());case"hsl":if(A.length!==3)return null;var M=(parseFloat(A[0])%360+360)%360/360,P=u(A[1]),B=u(A[2]),H=B<=.5?B*(P+1):B+P-B*P,Z=2*B-H;return[n(255*m(Z,H,M+1/3)),n(255*m(Z,H,M)),n(255*m(Z,H,M-1/3)),D];default:return null}}return null}}catch{}return rr}();class pr{constructor(n,s,u,m=1){this.r=n,this.g=s,this.b=u,this.a=m}static parse(n){if(!n)return;if(n instanceof pr)return n;if(typeof n!="string")return;const s=sm.parseCSSColor(n);return s?new pr(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[n,s,u,m]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(u)},${m})`}toRenderColor(n){const{r:s,g:u,b:m,a:h}=this;return new m1(n,s,u,m,h)}}class m1{constructor(n,s,u,m,h){if(n){const v=n.image.height,T=v*v;s=h===0?0:s/h*(v-1),u=h===0?0:u/h*(v-1),m=h===0?0:m/h*(v-1);const k=Math.floor(s),L=Math.floor(u),x=Math.floor(m),A=Math.ceil(s),D=Math.ceil(u),M=Math.ceil(m),P=s-k,B=u-L,H=m-x,Z=n.image.data,te=4*(k+L*T+x*v),ne=4*(k+L*T+M*v),X=4*(k+D*T+x*v),le=4*(k+D*T+M*v),pe=4*(A+L*T+x*v),Ce=4*(A+L*T+M*v),Ue=4*(A+D*T+x*v),Le=4*(A+D*T+M*v);if(te<0||Le>=Z.length)throw new Error("out of range");this.r=mo(mo(mo(Z[te],Z[ne],H),mo(Z[X],Z[le],H),B),mo(mo(Z[pe],Z[Ce],H),mo(Z[Ue],Z[Le],H),B),P)/255*h,this.g=mo(mo(mo(Z[te+1],Z[ne+1],H),mo(Z[X+1],Z[le+1],H),B),mo(mo(Z[pe+1],Z[Ce+1],H),mo(Z[Ue+1],Z[Le+1],H),B),P)/255*h,this.b=mo(mo(mo(Z[te+2],Z[ne+2],H),mo(Z[X+2],Z[le+2],H),B),mo(mo(Z[pe+2],Z[Ce+2],H),mo(Z[Ue+2],Z[Le+2],H),B),P)/255*h,this.a=h}else this.r=s,this.g=u,this.b=m,this.a=h}toArray(){const{r:n,g:s,b:u,a:m}=this;return m===0?[0,0,0,0]:[255*n/m,255*s/m,255*u/m,m]}toArray01(){const{r:n,g:s,b:u,a:m}=this;return m===0?[0,0,0,0]:[n/m,s/m,u/m,m]}toArray01Scaled(n){const{r:s,g:u,b:m,a:h}=this;return h===0?[0,0,0]:[s/h*n,u/h*n,m/h*n]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:u,a:m}=this;return[n,s,u,m]}toArray01Linear(){const{r:n,g:s,b:u,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(n/m,2.2),Math.pow(s/m,2.2),Math.pow(u/m,2.2),m]}}function mo(c,n,s){return c*(1-s)+n*s}function pd(c,n,s){return c.map((u,m)=>mo(u,n[m],s))}pr.black=new pr(0,0,0,1),pr.white=new pr(1,1,1,1),pr.transparent=new pr(0,0,0,0),pr.red=new pr(1,0,0,1),pr.blue=new pr(0,0,1,1);var rc=Object.freeze({__proto__:null,array:pd,color:function(c,n,s){return new pr(mo(c.r,n.r,s),mo(c.g,n.g,s),mo(c.b,n.b,s),mo(c.a,n.a,s))},number:mo});function Vc(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}class na extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class Vh{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[u,m]of s)this.bindings[u]=m}concat(n){return new Vh(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const oa={kind:"null"},qn={kind:"number"},Xo={kind:"string"},Jo={kind:"boolean"},as={kind:"color"},Hi={kind:"object"},tr={kind:"value"},Uh={kind:"collator"},Uc={kind:"formatted"},jc={kind:"resolvedImage"};function Yi(c,n){return{kind:"array",itemType:c,N:n}}function ii(c){if(c.kind==="array"){const n=ii(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const g_=[oa,qn,Xo,Jo,as,Uc,Hi,Yi(tr),jc];function Hc(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Hc(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const s of g_)if(!Hc(s,n))return null}}return`Expected ${ii(c)} but found ${ii(n)} instead.`}function Gc(c,n){return n.some(s=>s.kind===c.kind)}function Sa(c,n){return n.some(s=>s==="null"?c===null:s==="array"?Array.isArray(c):s==="object"?c&&!Array.isArray(c)&&typeof c=="object":s===typeof c)}class jh{constructor(n,s,u){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ws{constructor(n,s,u,m,h){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=u,this.fontStack=m,this.textColor=h}}class Gi{constructor(n){this.sections=n}static fromString(n){return new Gi([new ws(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary.length!==0)}static factory(n){return n instanceof Gi?n:Gi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.namePrimary]);continue}n.push(s.text);const u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class Xi{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),this.available=n.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(n,s){return n?new Xi({namePrimary:n,nameSecondary:s,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function v_(c,n,s,u){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,n,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,n,s,u]:[c,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Il(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof pr||c instanceof jh||c instanceof Gi||c instanceof Xi)return!0;if(Array.isArray(c)){for(const n of c)if(!Il(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!Il(c[n]))return!1;return!0}return!1}function pi(c){if(c===null)return oa;if(typeof c=="string")return Xo;if(typeof c=="boolean")return Jo;if(typeof c=="number")return qn;if(c instanceof pr)return as;if(c instanceof jh)return Uh;if(c instanceof Gi)return Uc;if(c instanceof Xi)return jc;if(Array.isArray(c)){const n=c.length;let s;for(const u of c){const m=pi(u);if(s){if(s===m)continue;s=tr;break}s=m}return Yi(s||tr,n)}return Hi}function Ji(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof pr||c instanceof Gi||c instanceof Xi?c.toString():JSON.stringify(c)}class ra{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Il(n[1]))return s.error("invalid value");const u=n[1];let m=pi(u);const h=s.expectedType;return m.kind!=="array"||m.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(m=h),new ra(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof pr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Gi?this.value.serialize():this.value}}class Ci{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const am={string:Xo,number:qn,boolean:Jo,object:Hi};class ia{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let u,m=1;const h=n[0];if(h==="array"){let T,k;if(n.length>2){const L=n[1];if(typeof L!="string"||!(L in am)||L==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);T=am[L],m++}else T=tr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);k=n[2],m++}u=Yi(T,k)}else u=am[h];const v=[];for(;m<n.length;m++){const T=s.parse(n[m],m,tr);if(!T)return null;v.push(T)}return new ia(u,v)}evaluate(n){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(n);if(!Hc(this.type,pi(u)))return u;if(s===this.args.length-1)throw new Ci(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${ii(pi(u))} but was expected to be of type ${ii(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){s.push(u.kind);const m=n.N;(typeof m=="number"||this.args.length>1)&&s.push(m)}}return s.concat(this.args.map(u=>u.serialize()))}}class Wc{constructor(n){this.type=Uc,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const m=[];let h=!1;for(let v=1;v<=n.length-1;++v){const T=n[v];if(h&&typeof T=="object"&&!Array.isArray(T)){h=!1;let k=null;if(T["font-scale"]&&(k=s.parseObjectValue(T["font-scale"],v,"font-scale",qn),!k))return null;let L=null;if(T["text-font"]&&(L=s.parseObjectValue(T["text-font"],v,"text-font",Yi(Xo)),!L))return null;let x=null;if(T["text-color"]&&(x=s.parseObjectValue(T["text-color"],v,"text-color",as),!x))return null;const A=m[m.length-1];A.scale=k,A.font=L,A.textColor=x}else{const k=s.parse(n[v],v,tr);if(!k)return null;const L=k.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,m.push({content:k,scale:null,font:null,textColor:null})}}return new Wc(m)}evaluate(n){return new Gi(this.sections.map(s=>{const u=s.content.evaluate(n);return pi(u)===jc?new ws("",u,null,null,null):new ws(Ji(u),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),n.push(u)}return n}}class ic{constructor(n,s){this.type=jc,this.inputPrimary=n,this.inputSecondary=s}static parse(n,s){if(n.length<2)return s.error("Expected two or more arguments.");const u=s.parse(n[1],1,Xo);if(!u)return s.error("No image name provided.");if(n.length===2)return new ic(u);const m=s.parse(n[2],1,Xo);return m?new ic(u,m):s.error("Secondary image variant is not a string.")}evaluate(n){const s=Xi.fromString(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0);return s&&n.availableImages&&(s.available=n.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&n.availableImages&&(s.available=n.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(n){n(this.inputPrimary),this.inputSecondary&&n(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function sc(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const Hh={"to-boolean":Jo,"to-color":as,"to-number":qn,"to-string":Xo};class Ha{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[0],m=[];let h=oa;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const v=n[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);h=Yi(s.expectedType.itemType,v)}else{if(!(v>0&&Il(n[1][0])))return null;h=Yi(pi(n[1][0]),v)}for(let T=0;T<v;T++){const k=n[1][T];let L;if(sc(k)==="array")L=s.parse(k,void 0,h.itemType);else{const x=sc(k);if(x!==h.itemType.kind)return s.error(`Expected ${h.itemType.kind} but found ${x}.`);L=s.registry.literal.parse(["literal",k===void 0?null:k],s)}if(!L)return null;m.push(L)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return s.error("Expected one argument.");h=Hh[u];for(let v=1;v<n.length;v++){const T=s.parse(n[v],v,tr);if(!T)return null;m.push(T)}}return new Ha(h,m)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,u;for(const m of this.args){if(s=m.evaluate(n),u=null,s instanceof pr)return s;if(typeof s=="string"){const h=n.parseColor(s);if(h)return h}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:v_(s[0],s[1],s[2],s[3]),!u))return new pr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Ci(u||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const u of this.args){if(s=u.evaluate(n),s===null)return 0;const m=Number(s);if(!isNaN(m))return m}throw new Ci(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Gi.fromString(Ji(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Xi.fromString(Ji(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(s=>s.evaluate(n)):Ji(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Wc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ic(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const g1=["Unknown","Point","LineString","Polygon"];class __{constructor(n,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?g1[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:u,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*s-n[0])+this.featureDistanceData.bearing[1]*(m*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=pr.parse(n)),s}getConfig(n){return this.options?this.options.get(n):null}}class ls{constructor(n,s,u,m,h){this.name=n,this.type=s,this._evaluate=u,this.args=m,this._overloadIndex=h}evaluate(n){if(!this._evaluate){const s=ls.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const u=n[0],m=ls.definitions[u];if(!m)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(m)?m[0]:m.type,v=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=[];let k=null,L=-1;for(const[x,A]of v){if(Array.isArray(x)&&x.length!==n.length-1)continue;T.push(x),L++,k=new k_(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const D=[];let M=!1;for(let P=1;P<n.length;P++){const B=n[P],H=Array.isArray(x)?x[P-1]:x.type,Z=k.parse(B,1+D.length,H);if(!Z){M=!0;break}D.push(Z)}if(!M)if(Array.isArray(x)&&x.length!==D.length)k.error(`Expected ${x.length} arguments, but found ${D.length} instead.`);else{for(let P=0;P<D.length;P++){const B=Array.isArray(x)?x[P]:x.type,H=D[P];k.concat(P+1).checkSubtype(B,H.type)}if(k.errors.length===0)return new ls(u,h,A,D,L)}}if(T.length===1)s.errors.push(...k.errors);else{const x=(T.length?T:v.map(([D])=>D)).map(v1).join(" | "),A=[];for(let D=1;D<n.length;D++){const M=s.parse(n[D],1+A.length);if(!M)return null;A.push(ii(M.type))}s.error(`Expected arguments of type ${x}, but found (${A.join(", ")}) instead.`)}return null}static register(n,s){ls.definitions=s;for(const u in s)n[u]=ls}}function v1(c){return Array.isArray(c)?`(${c.map(ii).join(", ")})`:`(${ii(c.type)}...)`}class Gh{constructor(n,s,u){this.type=Uh,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const m=u["case-sensitive"]===void 0?s.parse(!1,1,Jo):s.parseObjectValue(u["case-sensitive"],1,"case-sensitive",Jo);if(!m)return null;const h=u["diacritic-sensitive"]===void 0?s.parse(!1,1,Jo):s.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",Jo);if(!h)return null;let v=null;return u.locale&&(v=s.parseObjectValue(u.locale,1,"locale",Xo),!v)?null:new Gh(m,h,v)}evaluate(n){return new jh(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function y_(c,n,s=0,u=c.length-1,m=Kc){for(;u>s;){if(u-s>600){const k=u-s+1,L=n-s+1,x=Math.log(k),A=.5*Math.exp(2*x/3),D=.5*Math.sqrt(x*A*(k-A)/k)*(L-k/2<0?-1:1);y_(c,n,Math.max(s,Math.floor(n-L*A/k+D)),Math.min(u,Math.floor(n+(k-L)*A/k+D)),m)}const h=c[n];let v=s,T=u;for(qc(c,s,n),m(c[u],h)>0&&qc(c,s,u);v<T;){for(qc(c,v,T),v++,T--;m(c[v],h)<0;)v++;for(;m(c[T],h)>0;)T--}m(c[s],h)===0?qc(c,s,T):(T++,qc(c,T,u)),T<=n&&(s=T+1),n<=T&&(u=T-1)}}function qc(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function Kc(c,n){return c<n?-1:c>n?1:0}function _1(c){let n=0;for(let s,u,m=0,h=c.length,v=h-1;m<h;v=m++)s=c[m],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function md(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function ac(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function y1(c,n,s){const u=c[0]-n[0],m=c[1]-n[1],h=c[0]-s[0],v=c[1]-s[1];return u*v-h*m==0&&u*h<=0&&m*v<=0}function Zc(c,n,s=!1){let u=!1;for(let T=0,k=n.length;T<k;T++){const L=n[T];for(let x=0,A=L.length,D=A-1;x<A;D=x++){const M=L[D],P=L[x];if(y1(c,M,P))return s;(h=M)[1]>(m=c)[1]!=(v=P)[1]>m[1]&&m[0]<(v[0]-h[0])*(m[1]-h[1])/(v[1]-h[1])+h[0]&&(u=!u)}}var m,h,v;return u}function b_(c,n,s,u){const m=u[0]-s[0],h=u[1]-s[1],v=(c[0]-s[0])*h-m*(c[1]-s[1]),T=(n[0]-s[0])*h-m*(n[1]-s[1]);return v>0&&T<0||v<0&&T>0}function Wh(c,n,s,u){return(m=[u[0]-s[0],u[1]-s[1]])[0]*(h=[n[0]-c[0],n[1]-c[1]])[1]-m[1]*h[0]!=0&&!(!b_(c,n,s,u)||!b_(s,u,c,n));var m,h}const Ss=8192;function Ho(c,n){const s=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,m=Math.pow(2,n.z);return[Math.round(s*m*Ss),Math.round(u*m*Ss)]}function io(c,n){for(let s=0;s<n.length;s++)if(Zc(c,n[s]))return!0;return!1}function lm(c,n,s){for(const u of s)for(let m=0,h=u.length,v=h-1;m<h;v=m++)if(Wh(c,n,u[v],u[m]))return!0;return!1}function Eo(c,n){for(let s=0;s<c.length;++s)if(!Zc(c[s],n))return!1;for(let s=0;s<c.length-1;++s)if(lm(c[s],c[s+1],n))return!1;return!0}function cm(c,n){for(let s=0;s<n.length;s++)if(Eo(c,n[s]))return!0;return!1}function gd(c,n,s){const u=[];for(let m=0;m<c.length;m++){const h=[];for(let v=0;v<c[m].length;v++){const T=Ho(c[m][v],s);md(n,T),h.push(T)}u.push(h)}return u}function bo(c,n,s){const u=[];for(let m=0;m<c.length;m++){const h=gd(c[m],n,s);u.push(h)}return u}function um(c,n,s,u){if(c[0]<s[0]||c[0]>s[2]){const m=.5*u;let h=c[0]-s[0]>m?-u:s[0]-c[0]>m?u:0;h===0&&(h=c[0]-s[2]>m?-u:s[2]-c[0]>m?u:0),c[0]+=h}md(n,c)}function qh(c,n,s,u){const m=Math.pow(2,u.z)*Ss,h=[u.x*Ss,u.y*Ss],v=[];if(!c)return v;for(const T of c)for(const k of T){const L=[k.x+h[0],k.y+h[1]];um(L,n,s,m),v.push(L)}return v}function dm(c,n,s,u){const m=Math.pow(2,u.z)*Ss,h=[u.x*Ss,u.y*Ss],v=[];if(!c)return v;for(const k of c){const L=[];for(const x of k){const A=[x.x+h[0],x.y+h[1]];md(n,A),L.push(A)}v.push(L)}if(n[2]-n[0]<=m/2){(T=n)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const k of v)for(const L of k)um(L,n,s,m)}var T;return v}class Al{constructor(n,s){this.type=Jo,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Il(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let m=0;m<u.features.length;++m){const h=u.features[m].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Al(u,u.features[m].geometry)}else if(u.type==="Feature"){const m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Al(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Al(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=gd(u.coordinates,h,v),k=qh(s.geometry(),m,h,v);if(!ac(m,h))return!1;for(const L of k)if(!Zc(L,T))return!1}if(u.type==="MultiPolygon"){const T=bo(u.coordinates,h,v),k=qh(s.geometry(),m,h,v);if(!ac(m,h))return!1;for(const L of k)if(!io(L,T))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=gd(u.coordinates,h,v),k=dm(s.geometry(),m,h,v);if(!ac(m,h))return!1;for(const L of k)if(!Eo(L,T))return!1}if(u.type==="MultiPolygon"){const T=bo(u.coordinates,h,v),k=dm(s.geometry(),m,h,v);if(!ac(m,h))return!1;for(const L of k)if(!cm(L,T))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const lc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Di=1/298.257223563,Kh=Di*(2-Di),Yc=Math.PI/180;class Xc{static fromTile(n,s,u){const m=Math.PI*(1-2*(n+.5)/Math.pow(2,s)),h=Math.atan(.5*(Math.exp(m)-Math.exp(-m)))/Yc;return new Xc(h,u)}static get units(){return lc}constructor(n,s){if(n===void 0)throw new Error("No latitude given.");if(s&&!lc[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(lc).join(", ")}`);const u=6378.137*Yc*(s?lc[s]:1),m=Math.cos(n*Yc),h=1/(1-Kh*(1-m*m)),v=Math.sqrt(h);this.kx=u*v*m,this.ky=u*v*h*(1-Kh)}distance(n,s){const u=Jr(n[0]-s[0])*this.kx,m=(n[1]-s[1])*this.ky;return Math.sqrt(u*u+m*m)}bearing(n,s){const u=Jr(s[0]-n[0])*this.kx;return Math.atan2(u,(s[1]-n[1])*this.ky)/Yc}destination(n,s,u){const m=u*Yc;return this.offset(n,Math.sin(m)*s,Math.cos(m)*s)}offset(n,s,u){return[n[0]+s/this.kx,n[1]+u/this.ky]}lineDistance(n){let s=0;for(let u=0;u<n.length-1;u++)s+=this.distance(n[u],n[u+1]);return s}area(n){let s=0;for(let u=0;u<n.length;u++){const m=n[u];for(let h=0,v=m.length,T=v-1;h<v;T=h++)s+=Jr(m[h][0]-m[T][0])*(m[h][1]+m[T][1])*(u?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(n,s){let u=0;if(s<=0)return n[0];for(let m=0;m<n.length-1;m++){const h=n[m],v=n[m+1],T=this.distance(h,v);if(u+=T,u>s)return Ga(h,v,(s-(u-T))/T)}return n[n.length-1]}pointToSegmentDistance(n,s,u){let[m,h]=s,v=Jr(u[0]-m)*this.kx,T=(u[1]-h)*this.ky;if(v!==0||T!==0){const k=(Jr(n[0]-m)*this.kx*v+(n[1]-h)*this.ky*T)/(v*v+T*T);k>1?(m=u[0],h=u[1]):k>0&&(m+=v/this.kx*k,h+=T/this.ky*k)}return v=Jr(n[0]-m)*this.kx,T=(n[1]-h)*this.ky,Math.sqrt(v*v+T*T)}pointOnLine(n,s){let u=1/0,m=n[0][0],h=n[0][1],v=0,T=0;for(let k=0;k<n.length-1;k++){let L=n[k][0],x=n[k][1],A=Jr(n[k+1][0]-L)*this.kx,D=(n[k+1][1]-x)*this.ky,M=0;A===0&&D===0||(M=(Jr(s[0]-L)*this.kx*A+(s[1]-x)*this.ky*D)/(A*A+D*D),M>1?(L=n[k+1][0],x=n[k+1][1]):M>0&&(L+=A/this.kx*M,x+=D/this.ky*M)),A=Jr(s[0]-L)*this.kx,D=(s[1]-x)*this.ky;const P=A*A+D*D;P<u&&(u=P,m=L,h=x,v=k,T=M)}return{point:[m,h],index:v,t:Math.max(0,Math.min(1,T))}}lineSlice(n,s,u){let m=this.pointOnLine(u,n),h=this.pointOnLine(u,s);if(m.index>h.index||m.index===h.index&&m.t>h.t){const L=m;m=h,h=L}const v=[m.point],T=m.index+1,k=h.index;!Zh(u[T],v[0])&&T<=k&&v.push(u[T]);for(let L=T+1;L<=k;L++)v.push(u[L]);return Zh(u[k],h.point)||v.push(h.point),v}lineSliceAlong(n,s,u){let m=0;const h=[];for(let v=0;v<u.length-1;v++){const T=u[v],k=u[v+1],L=this.distance(T,k);if(m+=L,m>n&&h.length===0&&h.push(Ga(T,k,(n-(m-L))/L)),m>=s)return h.push(Ga(T,k,(s-(m-L))/L)),h;m>n&&h.push(k)}return h}bufferPoint(n,s){const u=s/this.ky,m=s/this.kx;return[n[0]-m,n[1]-u,n[0]+m,n[1]+u]}bufferBBox(n,s){const u=s/this.ky,m=s/this.kx;return[n[0]-m,n[1]-u,n[2]+m,n[3]+u]}insideBBox(n,s){return Jr(n[0]-s[0])>=0&&Jr(n[0]-s[2])<=0&&n[1]>=s[1]&&n[1]<=s[3]}}function Zh(c,n){return c[0]===n[0]&&c[1]===n[1]}function Ga(c,n,s){const u=Jr(n[0]-c[0]);return[c[0]+u*s,c[1]+(n[1]-c[1])*s]}function Jr(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class hm{constructor(n=[],s=(u,m)=>u<m?-1:u>m?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:u}=this,m=s[n];for(;n>0;){const h=n-1>>1,v=s[h];if(u(m,v)>=0)break;s[n]=v,n=h}s[n]=m}_down(n){const{data:s,compare:u}=this,m=this.length>>1,h=s[n];for(;n<m;){let v=1+(n<<1);const T=v+1;if(T<this.length&&u(s[T],s[v])<0&&(v=T),u(s[v],h)>=0)break;s[n]=s[v],n=v}s[n]=h}}var In=8192;function x_(c,n){return n.dist-c.dist}const Jc=100,Yh=50;function Xh(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==c[s])return!1;return!0}function Jh(c){return c[1]-c[0]+1}function Wa(c,n){const s=c[1]>=c[0]&&c[1]<n;return s||console.warn("Distance Expression: Index is out of range"),s}function fm(c,n){if(c[0]>c[1])return[null,null];const s=Jh(c);if(n){if(s===2)return[c,null];const u=Math.floor(s/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(s===1)return[c,null];const u=Math.floor(s/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function Ts(c,n){const s=[1/0,1/0,-1/0,-1/0];if(!Wa(n,c.length))return s;for(let u=n[0];u<=n[1];++u)md(s,c[u]);return s}function Qh(c){const n=[1/0,1/0,-1/0,-1/0];for(let s=0;s<c.length;++s)for(let u=0;u<c[s].length;++u)md(n,c[s][u]);return n}function Qc(c,n,s){if(Xh(c)||Xh(n))return NaN;let u=0,m=0;return c[2]<n[0]&&(u=n[0]-c[2]),c[0]>n[2]&&(u=c[0]-n[2]),c[1]>n[3]&&(m=c[1]-n[3]),c[3]<n[1]&&(m=n[1]-c[3]),s.distance([0,0],[u,m])}function w_(c){return 360*c-180}function S_(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Cs(c,n){const s=Math.pow(2,n.z),u=(c.y/In+n.y)/s;return[w_((c.x/In+n.x)/s),S_(u)]}function T_(c,n){const s=[];for(let u=0;u<c.length;++u)s.push(Cs(c[u],n));return s}function pm(c,n,s){const u=s.pointOnLine(n,c).point;return s.distance(c,u)}function mm(c,n,s,u,m){const h=s.slice(u[0],u[1]+1);let v=1/0;for(let T=n[0];T<=n[1];++T)if((v=Math.min(v,pm(c[T],h,m)))===0)return 0;return v}function ef(c,n,s,u,m){const h=Math.min(m.pointToSegmentDistance(c,s,u),m.pointToSegmentDistance(n,s,u)),v=Math.min(m.pointToSegmentDistance(s,c,n),m.pointToSegmentDistance(u,c,n));return Math.min(h,v)}function C_(c,n,s,u,m){if(!Wa(n,c.length)||!Wa(u,s.length))return NaN;let h=1/0;for(let v=n[0];v<n[1];++v)for(let T=u[0];T<u[1];++T){if(Wh(c[v],c[v+1],s[T],s[T+1]))return 0;h=Math.min(h,ef(c[v],c[v+1],s[T],s[T+1],m))}return h}function E_(c,n,s,u,m){if(!Wa(n,c.length)||!Wa(u,s.length))return NaN;let h=1/0;for(let v=n[0];v<=n[1];++v)for(let T=u[0];T<=u[1];++T)if((h=Math.min(h,m.distance(c[v],s[T])))===0)return h;return h}function M_(c,n,s){if(Zc(c,n,!0))return 0;let u=1/0;for(const m of n){const h=m.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[h-1]&&(u=Math.min(u,s.pointToSegmentDistance(c,m[h-1],m[0])))===0||(u=Math.min(u,pm(c,m,s)))===0)return u}return u}function I_(c,n,s,u){if(!Wa(n,c.length))return NaN;for(let h=n[0];h<=n[1];++h)if(Zc(c[h],s,!0))return 0;let m=1/0;for(let h=n[0];h<n[1];++h)for(const v of s)for(let T=0,k=v.length,L=k-1;T<k;L=T++){if(Wh(c[h],c[h+1],v[L],v[T]))return 0;m=Math.min(m,ef(c[h],c[h+1],v[L],v[T],u))}return m}function gm(c,n){for(const s of c)for(let u=0;u<=s.length-1;++u)if(Zc(s[u],n,!0))return!0;return!1}function A_(c,n,s,u=1/0){const m=Qh(c),h=Qh(n);if(u!==1/0&&Qc(m,h,s)>=u)return u;if(ac(m,h)){if(gm(c,n))return 0}else if(gm(n,c))return 0;let v=u;for(const T of c)for(let k=0,L=T.length,x=L-1;k<L;x=k++)for(const A of n)for(let D=0,M=A.length,P=M-1;D<M;P=D++){if(Wh(T[x],T[k],A[P],A[D]))return 0;v=Math.min(v,ef(T[x],T[k],A[P],A[D],s))}return v}function vd(c,n,s,u,m,h,v){if(h===null||v===null)return;const T=Qc(Ts(u,h),Ts(m,v),s);T<n&&c.push({dist:T,range1:h,range2:v})}function tf(c,n,s,u,m=1/0){let h=Math.min(u.distance(c[0],s[0][0]),m);if(h===0)return h;const v=new hm([{dist:0,range1:[0,c.length-1],range2:[0,0]}],x_),T=n?Yh:Jc,k=Qh(s);for(;v.length;){const L=v.pop();if(L.dist>=h)continue;const x=L.range1;if(Jh(x)<=T){if(!Wa(x,c.length))return NaN;if(n){const A=I_(c,x,s,u);if((h=Math.min(h,A))===0)return h}else for(let A=x[0];A<=x[1];++A){const D=M_(c[A],s,u);if((h=Math.min(h,D))===0)return h}}else{const A=fm(x,n);if(A[0]!==null){const D=Qc(Ts(c,A[0]),k,u);D<h&&v.push({dist:D,range1:A[0],range2:[0,0]})}if(A[1]!==null){const D=Qc(Ts(c,A[1]),k,u);D<h&&v.push({dist:D,range1:A[1],range2:[0,0]})}}}return h}function _d(c,n,s,u,m,h=1/0){let v=Math.min(h,m.distance(c[0],s[0]));if(v===0)return v;const T=new hm([{dist:0,range1:[0,c.length-1],range2:[0,s.length-1]}],x_),k=n?Yh:Jc,L=u?Yh:Jc;for(;T.length;){const x=T.pop();if(x.dist>=v)continue;const A=x.range1,D=x.range2;if(Jh(A)<=k&&Jh(D)<=L){if(!Wa(A,c.length)||!Wa(D,s.length))return NaN;if(n&&u?v=Math.min(v,C_(c,A,s,D,m)):n||u?n&&!u?v=Math.min(v,mm(s,D,c,A,m)):!n&&u&&(v=Math.min(v,mm(c,A,s,D,m))):v=Math.min(v,E_(c,A,s,D,m)),v===0)return v}else{const M=fm(A,n),P=fm(D,u);vd(T,v,m,c,s,M[0],P[0]),vd(T,v,m,c,s,M[0],P[1]),vd(T,v,m,c,s,M[1],P[0]),vd(T,v,m,c,s,M[1],P[1])}}return v}function eu(c,n,s,u,m=1/0){let h=m;const v=Ts(c,[0,c.length-1]);for(const T of s)if(!(h!==1/0&&Qc(v,Ts(T,[0,T.length-1]),u)>=h)&&(h=Math.min(h,_d(c,n,T,!0,u,h)),h===0))return h;return h}function yd(c,n,s,u,m=1/0){let h=m;const v=Ts(c,[0,c.length-1]);for(const T of s){if(h!==1/0&&Qc(v,Qh(T),u)>=h)continue;const k=tf(c,n,T,u,h);if(isNaN(k))return k;if((h=Math.min(h,k))===0)return h}return h}function nf(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class kl{constructor(n,s){this.type=qn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Il(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let m=0;m<u.features.length;++m)if(nf(u.features[m].geometry.type))return new kl(u,u.features[m].geometry)}else if(u.type==="Feature"){if(nf(u.geometry.type))return new kl(u,u.geometry)}else if(nf(u.type))return new kl(u,u)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const s=n.geometry(),u=n.canonicalID();if(s!=null&&u!=null){if(n.geometryType()==="Point")return function(m,h,v){const T=[];for(const L of m)for(const x of L)T.push(Cs(x,h));const k=new Xc(T[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?_d(T,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",k):v.type==="MultiLineString"?eu(T,!1,v.coordinates,k):v.type==="Polygon"||v.type==="MultiPolygon"?yd(T,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,k):null}(s,u,this.geometries);if(n.geometryType()==="LineString")return function(m,h,v){const T=[];for(const L of m){const x=[];for(const A of L)x.push(Cs(A,h));T.push(x)}const k=new Xc(T[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return eu(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,k);if(v.type==="MultiLineString"){let L=1/0;for(let x=0;x<v.coordinates.length;x++){const A=eu(v.coordinates[x],!0,T,k,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}if(v.type==="Polygon"||v.type==="MultiPolygon"){let L=1/0;for(let x=0;x<T.length;x++){const A=yd(T[x],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,k,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}return null}(s,u,this.geometries);if(n.geometryType()==="Polygon")return function(m,h,v){const T=[];for(const L of function(x,A){const D=x.length;if(D<=1)return[x];const M=[];let P,B;for(let H=0;H<D;H++){const Z=_1(x[H]);Z!==0&&(x[H].area=Math.abs(Z),B===void 0&&(B=Z<0),B===Z<0?(P&&M.push(P),P=[x[H]]):P.push(x[H]))}return P&&M.push(P),M}(m)){const x=[];for(let A=0;A<L.length;++A)x.push(T_(L[A],h));T.push(x)}const k=new Xc(T[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return yd(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,k);if(v.type==="MultiLineString"){let L=1/0;for(let x=0;x<v.coordinates.length;x++){const A=yd(v.coordinates[x],!0,T,k,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}return v.type==="Polygon"||v.type==="MultiPolygon"?function(L,x,A){let D=1/0;for(const M of L)for(const P of x){const B=A_(M,P,A,D);if(isNaN(B))return B;if((D=Math.min(D,B))===0)return D}return D}(v.type==="Polygon"?[v.coordinates]:v.coordinates,T,k):null}(s,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Pl(c,n){switch(c){case"string":return Ji(n);case"number":return+n;case"boolean":return!!n;case"color":return pr.parse(n);case"formatted":return Gi.fromString(Ji(n));case"resolvedImage":return Xi.fromString(Ji(n))}return n}function Yo(c,n,s,u){return u!==void 0&&(c=u*Math.round(c/u)),n!==void 0&&c<n&&(c=n),s!==void 0&&c>s&&(c=s),c}class tu{constructor(n,s,u){this.type=n,this.key=s,this.scope=u}static parse(n,s){let u=s.expectedType;if(u==null&&(u=tr),n.length<2||n.length>3)return s.error("Invalid number of arguments for 'config' expression.");const m=s.parse(n[1],1);if(!(m instanceof ra))return s.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const h=s.parse(n[2],2);return h instanceof ra?new tu(u,Ji(m.value),Ji(h.value)):s.error("Scope of 'config' expression must be a string literal.")}return new tu(u,Ji(m.value))}evaluate(n){const s=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(s);if(!u)return null;const{type:m,value:h,values:v,minValue:T,maxValue:k,stepValue:L}=u,x=u.default.evaluate(n);let A=x;if(h){const D=n.scope;n.scope=(D||"").split("").slice(1).join(""),A=h.evaluate(n),n.scope=D}return m&&(A=Pl(m,A)),A===void 0||T===void 0&&k===void 0&&L===void 0||(typeof A=="number"?A=Yo(A,T,k,L):Array.isArray(A)&&(A=A.map(D=>typeof D=="number"?Yo(D,T,k,L):D))),h!==void 0&&A!==void 0&&v&&!v.includes(A)&&(A=x,m&&(A=Pl(m,A))),(m&&m!==this.type||A!==void 0&&pi(A)!==this.type)&&(A=Pl(this.type.kind,A)),A}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function bd(c){if(c instanceof ls&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Al||c instanceof kl)return!1;let n=!0;return c.eachChild(s=>{n&&!bd(s)&&(n=!1)}),n}function of(c){if(c instanceof ls&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(s=>{n&&!of(s)&&(n=!1)}),n}function xd(c){if(c instanceof tu)return new Set([c.key]);let n=new Set;return c.eachChild(s=>{n=new Set([...n,...xd(s)])}),n}function nu(c,n){if(c instanceof ls&&n.indexOf(c.name)>=0)return!1;let s=!0;return c.eachChild(u=>{s&&!nu(u,n)&&(s=!1)}),s}class Er{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=n[1];return s.scope.has(u)?new Er(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class vm{constructor(n,s=[],u,m=new Vh,h=[],v,T){this.registry=n,this.path=s,this.key=s.map(k=>typeof k=="string"?`['${k}']`:`[${k}]`).join(""),this.scope=m,this.errors=h,this.expectedType=u,this._scope=v,this.options=T}parse(n,s,u,m,h={}){return s||u?this.concat(s,null,u,m)._parse(n,h):this._parse(n,h)}parseObjectValue(n,s,u,m,h,v={}){return this.concat(s,u,m,h)._parse(n,v)}_parse(n,s){function u(m,h,v){return v==="assert"?new ia(h,[m]):v==="coerce"?new Ha(h,[m]):m}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(m){let h=m.parse(n,this);if(!h)return null;if(this.expectedType){const v=this.expectedType,T=h.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else h=u(h,v,s.typeAnnotation||"coerce");else h=u(h,v,s.typeAnnotation||"assert")}if(!(h instanceof ra)&&h.type.kind!=="resolvedImage"&&_m(h)){const v=new __(this._scope,this.options);try{h=new ra(h.type,h.evaluate(v))}catch(T){return this.error(T.message),null}}return h}return Ha.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,u,m){let h=typeof n=="number"?this.path.concat(n):this.path;h=typeof s=="string"?h.concat(s):h;const v=m?this.scope.concat(m):this.scope;return new vm(this.registry,h,u||null,v,this.errors,this._scope,this.options)}error(n,...s){const u=`${this.key}${s.map(m=>`[${m}]`).join("")}`;this.errors.push(new na(u,n))}checkSubtype(n,s){const u=Hc(n,s);return u&&this.error(u),u}}var k_=vm;function _m(c){if(c instanceof Er)return _m(c.boundExpression);if(c instanceof ls&&c.name==="error"||c instanceof Gh||c instanceof Al||c instanceof kl||c instanceof tu)return!1;const n=c instanceof Ha||c instanceof ia;let s=!0;return c.eachChild(u=>{s=n?s&&_m(u):s&&u instanceof ra}),!!s&&bd(c)&&nu(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function rf(c,n){const s=c.length-1;let u,m,h=0,v=s,T=0;for(;h<=v;)if(T=Math.floor((h+v)/2),u=c[T],m=c[T+1],u<=n){if(T===s||n<m)return T;h=T+1}else{if(!(u>n))throw new Ci("Input is not a number.");v=T-1}return 0}class wd{constructor(n,s,u){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[m,h]of u)this.labels.push(m),this.outputs.push(h)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(n[1],1,qn);if(!u)return null;const m=[];let h=null;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);for(let v=1;v<n.length;v+=2){const T=v===1?-1/0:n[v],k=n[v+1],L=v,x=v+1;if(typeof T!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(m.length&&m[m.length-1][0]>=T)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const A=s.parse(k,x,h);if(!A)return null;h=h||A.type,m.push([T,A])}return new wd(h,u,m)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=s[0])return u[0].evaluate(n);const h=s.length;return m>=s[h-1]?u[h-1].evaluate(n):u[rf(s,m)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}const P_=.95047,R_=1.08883,D_=4/29,ou=6/29,L_=3*ou*ou,b1=ou*ou*ou,x1=Math.PI/180,w1=180/Math.PI;function ym(c){return c>b1?Math.pow(c,1/3):c/L_+D_}function bm(c){return c>ou?c*c*c:L_*(c-D_)}function xm(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function wm(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function O_(c){const n=wm(c.r),s=wm(c.g),u=wm(c.b),m=ym((.4124564*n+.3575761*s+.1804375*u)/P_),h=ym((.2126729*n+.7151522*s+.072175*u)/1);return{l:116*h-16,a:500*(m-h),b:200*(h-ym((.0193339*n+.119192*s+.9503041*u)/R_)),alpha:c.a}}function z_(c){let n=(c.l+16)/116,s=isNaN(c.a)?n:n+c.a/500,u=isNaN(c.b)?n:n-c.b/200;return n=1*bm(n),s=P_*bm(s),u=R_*bm(u),new pr(xm(3.2404542*s-1.5371385*n-.4985314*u),xm(-.969266*s+1.8760108*n+.041556*u),xm(.0556434*s-.2040259*n+1.0572252*u),c.alpha)}function S1(c,n,s){const u=n-c;return c+s*(u>180||u<-180?u-360*Math.round(u/360):u)}const Sd={forward:O_,reverse:z_,interpolate:function(c,n,s){return{l:mo(c.l,n.l,s),a:mo(c.a,n.a,s),b:mo(c.b,n.b,s),alpha:mo(c.alpha,n.alpha,s)}}},Td={forward:function(c){const{l:n,a:s,b:u}=O_(c),m=Math.atan2(u,s)*w1;return{h:m<0?m+360:m,c:Math.sqrt(s*s+u*u),l:n,alpha:c.a}},reverse:function(c){const n=c.h*x1,s=c.c;return z_({l:c.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:c.alpha})},interpolate:function(c,n,s){return{h:S1(c.h,n.h,s),c:mo(c.c,n.c,s),l:mo(c.l,n.l,s),alpha:mo(c.alpha,n.alpha,s)}}};var B_=Object.freeze({__proto__:null,hcl:Td,lab:Sd});class Es{constructor(n,s,u,m,h){this.type=n,this.operator=s,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(const[v,T]of h)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(n,s,u,m){let h=0;if(n.name==="exponential")h=Sm(s,n.base,u,m);else if(n.name==="linear")h=Sm(s,1,u,m);else if(n.name==="cubic-bezier"){const v=n.controlPoints;h=new At(v[0],v[1],v[2],v[3]).solve(Sm(s,1,u,m))}return h}static parse(n,s){let[u,m,h,...v]=n;if(!Array.isArray(m)||m.length===0)return s.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const L=m[1];if(typeof L!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:L}}else{if(m[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const L=m.slice(1);if(L.length!==4||L.some(x=>typeof x!="number"||x<0||x>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:L}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(h=s.parse(h,2,qn),!h)return null;const T=[];let k=null;u==="interpolate-hcl"||u==="interpolate-lab"?k=as:s.expectedType&&s.expectedType.kind!=="value"&&(k=s.expectedType);for(let L=0;L<v.length;L+=2){const x=v[L],A=v[L+1],D=L+3,M=L+4;if(typeof x!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(T.length&&T[T.length-1][0]>=x)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const P=s.parse(A,M,k);if(!P)return null;k=k||P.type,T.push([x,P])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new Es(k,u,m,h,T):s.error(`Type ${ii(k)} is not interpolatable.`)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=s[0])return u[0].evaluate(n);const h=s.length;if(m>=s[h-1])return u[h-1].evaluate(n);const v=rf(s,m),T=Es.interpolationFactor(this.interpolation,m,s[v],s[v+1]),k=u[v].evaluate(n),L=u[v+1].evaluate(n);return this.operator==="interpolate"?rc[this.type.kind.toLowerCase()](k,L,T):this.operator==="interpolate-hcl"?Td.reverse(Td.interpolate(Td.forward(k),Td.forward(L),T)):Sd.reverse(Sd.interpolate(Sd.forward(k),Sd.forward(L),T))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];for(let u=0;u<this.labels.length;u++)s.push(this.labels[u],this.outputs[u].serialize());return s}}function Sm(c,n,s,u){const m=u-s,h=c-s;return m===0?0:n===1?h/m:(Math.pow(n,h)-1)/(Math.pow(n,m)-1)}class sf{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let u=null;const m=s.expectedType;m&&m.kind!=="value"&&(u=m);const h=[];for(const T of n.slice(1)){const k=s.parse(T,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!k)return null;u=u||k.type,h.push(k)}const v=m&&h.some(T=>Hc(m,T.type));return new sf(v?tr:u,h)}evaluate(n){let s,u=null,m=0;for(const h of this.args){if(m++,u=h.evaluate(n),u&&u instanceof Xi&&!u.available&&(s||(s=u),u=null,m===this.args.length))return s;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class af{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let h=1;h<n.length-1;h+=2){const v=n[h];if(typeof v!="string")return s.error(`Expected string, but found ${typeof v} instead.`,h);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",h);const T=s.parse(n[h+1],h+1);if(!T)return null;u.push([v,T])}const m=s.parse(n[n.length-1],n.length-1,s.expectedType,u);return m?new af(u,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,u]of this.bindings)n.push(s,u.serialize());return n.push(this.result.serialize()),n}}class Tm{constructor(n,s,u){this.type=n,this.index=s,this.input=u}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,qn),m=s.parse(n[2],2,Yi(s.expectedType||tr));return u&&m?new Tm(m.type.itemType,u,m):null}evaluate(n){const s=this.index.evaluate(n),u=this.input.evaluate(n);if(s<0)throw new Ci(`Array index out of bounds: ${s} < 0.`);if(s>u.length-1)throw new Ci(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s===Math.floor(s))return u[s];const m=Math.floor(s),h=Math.ceil(s),v=u[m],T=u[h];if(typeof v!="number"||typeof T!="number")throw new Ci(`Cannot interpolate between non-number values at index ${s}.`);const k=s-m;return v*(1-k)+T*k}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Cm{constructor(n,s){this.type=Jo,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,tr),m=s.parse(n[2],2,tr);return u&&m?Gc(u.type,[Jo,Xo,qn,oa,tr])?new Cm(u,m):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ii(u.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!Sa(s,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${ii(pi(s))} instead.`);if(!Sa(u,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${ii(pi(u))} instead.`);return u.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class lf{constructor(n,s,u){this.type=qn,this.needle=n,this.haystack=s,this.fromIndex=u}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,tr),m=s.parse(n[2],2,tr);if(!u||!m)return null;if(!Gc(u.type,[Jo,Xo,qn,oa,tr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ii(u.type)} instead`);if(n.length===4){const h=s.parse(n[3],3,qn);return h?new lf(u,m,h):null}return new lf(u,m)}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!Sa(s,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${ii(pi(s))} instead.`);if(!Sa(u,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${ii(pi(u))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(n);return u.indexOf(s,m)}return u.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Em{constructor(n,s,u,m,h,v){this.inputType=n,this.type=s,this.input=u,this.cases=m,this.outputs=h,this.otherwise=v}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let u,m;s.expectedType&&s.expectedType.kind!=="value"&&(m=s.expectedType);const h={},v=[];for(let L=2;L<n.length-1;L+=2){let x=n[L];const A=n[L+1];Array.isArray(x)||(x=[x]);const D=s.concat(L);if(x.length===0)return D.error("Expected at least one branch label.");for(const P of x){if(typeof P!="number"&&typeof P!="string")return D.error("Branch labels must be numbers or strings.");if(typeof P=="number"&&Math.abs(P)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof P=="number"&&Math.floor(P)!==P)return D.error("Numeric branch labels must be integer values.");if(u){if(D.checkSubtype(u,pi(P)))return null}else u=pi(P);if(h[String(P)]!==void 0)return D.error("Branch labels must be unique.");h[String(P)]=v.length}const M=s.parse(A,L,m);if(!M)return null;m=m||M.type,v.push(M)}const T=s.parse(n[1],1,tr);if(!T)return null;const k=s.parse(n[n.length-1],n.length-1,m);return k?T.type.kind!=="value"&&s.concat(1).checkSubtype(u,T.type)?null:new Em(u,m,T,h,v,k):null}evaluate(n){const s=this.input.evaluate(n);return(pi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),u=[],m={};for(const v of s){const T=m[this.cases[v]];T===void 0?(m[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[T][1].push(v)}const h=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,T]of u)n.push(T.length===1?h(T[0]):T.map(h)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}class Cd{constructor(n,s,u){this.type=n,this.branches=s,this.otherwise=u}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const m=[];for(let v=1;v<n.length-1;v+=2){const T=s.parse(n[v],v,Jo);if(!T)return null;const k=s.parse(n[v+1],v+1,u);if(!k)return null;m.push([T,k]),u=u||k.type}const h=s.parse(n[n.length-1],n.length-1,u);return h?new Cd(u,m,h):null}evaluate(n){for(const[s,u]of this.branches)if(s.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,u]of this.branches)n(s),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class cf{constructor(n,s,u,m){this.type=n,this.input=s,this.beginIndex=u,this.endIndex=m}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,tr),m=s.parse(n[2],2,qn);if(!u||!m)return null;if(!Gc(u.type,[Yi(tr),Xo,tr]))return s.error(`Expected first argument to be of type array or string, but found ${ii(u.type)} instead`);if(n.length===4){const h=s.parse(n[3],3,qn);return h?new cf(u.type,u,m,h):null}return new cf(u.type,u,m)}evaluate(n){const s=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!Sa(s,["string","array"]))throw new Ci(`Expected first argument to be of type array or string, but found ${ii(pi(s))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(n);return s.slice(u,m)}return s.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Mm(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function F_(c,n,s,u){return u.compare(n,s)===0}function ru(c,n,s){const u=c!=="=="&&c!=="!=";return class VR{constructor(h,v,T){this.type=Jo,this.lhs=h,this.rhs=v,this.collator=T,this.hasUntypedArgument=h.type.kind==="value"||v.type.kind==="value"}static parse(h,v){if(h.length!==3&&h.length!==4)return v.error("Expected two or three arguments.");const T=h[0];let k=v.parse(h[1],1,tr);if(!k)return null;if(!Mm(T,k.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${ii(k.type)}'.`);let L=v.parse(h[2],2,tr);if(!L)return null;if(!Mm(T,L.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${ii(L.type)}'.`);if(k.type.kind!==L.type.kind&&k.type.kind!=="value"&&L.type.kind!=="value")return v.error(`Cannot compare types '${ii(k.type)}' and '${ii(L.type)}'.`);u&&(k.type.kind==="value"&&L.type.kind!=="value"?k=new ia(L.type,[k]):k.type.kind!=="value"&&L.type.kind==="value"&&(L=new ia(k.type,[L])));let x=null;if(h.length===4){if(k.type.kind!=="string"&&L.type.kind!=="string"&&k.type.kind!=="value"&&L.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(x=v.parse(h[3],3,Uh),!x)return null}return new VR(k,L,x)}evaluate(h){const v=this.lhs.evaluate(h),T=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const k=pi(v),L=pi(T);if(k.kind!==L.kind||k.kind!=="string"&&k.kind!=="number")throw new Ci(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${k.kind}, ${L.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const k=pi(v),L=pi(T);if(k.kind!=="string"||L.kind!=="string")return n(h,v,T)}return this.collator?s(h,v,T,this.collator.evaluate(h)):n(h,v,T)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[c];return this.eachChild(v=>{h.push(v.serialize())}),h}}}const T1=ru("==",function(c,n,s){return n===s},F_),N_=ru("!=",function(c,n,s){return n!==s},function(c,n,s,u){return!F_(0,n,s,u)}),$_=ru("<",function(c,n,s){return n<s},function(c,n,s,u){return u.compare(n,s)<0}),iu=ru(">",function(c,n,s){return n>s},function(c,n,s,u){return u.compare(n,s)>0}),V_=ru("<=",function(c,n,s){return n<=s},function(c,n,s,u){return u.compare(n,s)<=0}),U_=ru(">=",function(c,n,s){return n>=s},function(c,n,s,u){return u.compare(n,s)>=0});class Im{constructor(n,s,u,m,h,v){this.type=Xo,this.number=n,this.locale=s,this.currency=u,this.unit=m,this.minFractionDigits=h,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const u=s.parse(n[1],1,qn);if(!u)return null;const m=n[2];if(typeof m!="object"||Array.isArray(m))return s.error("NumberFormat options argument must be an object.");let h=null;if(m.locale&&(h=s.parseObjectValue(m.locale,2,"locale",Xo),!h))return null;let v=null;if(m.currency&&(v=s.parseObjectValue(m.currency,2,"currency",Xo),!v))return null;let T=null;if(m.unit&&(T=s.parseObjectValue(m.unit,2,"unit",Xo),!T))return null;let k=null;if(m["min-fraction-digits"]&&(k=s.parseObjectValue(m["min-fraction-digits"],2,"min-fraction-digits",qn),!k))return null;let L=null;return m["max-fraction-digits"]&&(L=s.parseObjectValue(m["max-fraction-digits"],2,"max-fraction-digits",qn),!L)?null:new Im(u,h,v,T,k,L)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Ed{constructor(n){this.type=qn,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=s.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${ii(u.type)} instead.`):new Ed(u):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Ci(`Expected value to be of type string or array, but found ${ii(pi(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}function uf(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const su={"==":T1,"!=":N_,">":iu,"<":$_,">=":U_,"<=":V_,array:ia,at:Tm,boolean:ia,case:Cd,coalesce:sf,collator:Gh,format:Wc,image:ic,in:Cm,"index-of":lf,interpolate:Es,"interpolate-hcl":Es,"interpolate-lab":Es,length:Ed,let:af,literal:ra,match:Em,number:ia,"number-format":Im,object:ia,slice:cf,step:wd,string:ia,"to-boolean":Ha,"to-color":Ha,"to-number":Ha,"to-string":Ha,var:Er,within:Al,distance:kl,config:tu};function j_(c,[n,s,u,m]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const h=m?m.evaluate(c):1,v=v_(n,s,u,h);if(v)throw new Ci(v);return new pr(n/255*h,s/255*h,u/255*h,h)}function Am(c,[n,s,u,m]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const h=m?m.evaluate(c):1,v=function(L,x,A,D){return typeof L=="number"&&L>=0&&L<=360?typeof x=="number"&&x>=0&&x<=100&&typeof A=="number"&&A>=0&&A<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[L,x,A,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[L,x,A,D]:[L,x,A]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[L,x,A,D]:[L,x,A]).join(", ")}]: 'h' must be between 0 and 360.`}(n,s,u,h);if(v)throw new Ci(v);const T=`hsla(${n}, ${s}%, ${u}%, ${h})`,k=pr.parse(T);if(!k)throw new Ci(`Failed to parse HSLA color: ${T}`);return k}function km(c,n){return c in n}function Pm(c,n){const s=n[c];return s===void 0?null:s}function cc(c){return{type:c}}function H_(c){return{result:"success",value:c}}function qa(c){return{result:"error",value:c}}function df(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function uc(c){return c["property-type"]==="data-driven"}function G_(c){return df(c.expression,"measure-light")}function Rm(c){return df(c.expression,"zoom")}function Dm(c){return!!c.expression&&c.expression.interpolated}function Lm(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function W_(c){return c}function Om(c,n){const s=n.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",m=u||!(u||c.property!==void 0),h=c.type||(Dm(n)?"exponential":"interval");if(s&&((c=Vc({},c)).stops&&(c.stops=c.stops.map(L=>[L[0],pr.parse(L[1])])),c.default=pr.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!B_[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let v,T,k;if(h==="exponential")v=zm;else if(h==="interval")v=E1;else if(h==="categorical"){v=C1,T=Object.create(null);for(const L of c.stops)T[L[0]]=L[1];k=typeof c.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);v=M1}if(u){const L={},x=[];for(let M=0;M<c.stops.length;M++){const P=c.stops[M],B=P[0].zoom;L[B]===void 0&&(L[B]={zoom:B,type:c.type,property:c.property,default:c.default,stops:[]},x.push(B)),L[B].stops.push([P[0].value,P[1]])}const A=[];for(const M of x)A.push([L[M].zoom,Om(L[M],n)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:Es.interpolationFactor.bind(void 0,D),zoomStops:A.map(M=>M[0]),evaluate:({zoom:M},P)=>zm({stops:A,base:c.base},n,M).evaluate(M,P)}}if(m){const L=h==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:Es.interpolationFactor.bind(void 0,L),zoomStops:c.stops.map(x=>x[0]),evaluate:({zoom:x})=>v(c,n,x,T,k)}}return{kind:"source",evaluate(L,x){const A=x&&x.properties?x.properties[c.property]:void 0;return A===void 0?Md(c.default,n.default):v(c,n,A,T,k)}}}function Md(c,n,s){return c!==void 0?c:n!==void 0?n:s!==void 0?s:void 0}function C1(c,n,s,u,m){return Md(typeof s===m?u[s]:void 0,c.default,n.default)}function E1(c,n,s){if(sc(s)!=="number")return Md(c.default,n.default);const u=c.stops.length;if(u===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[u-1][0])return c.stops[u-1][1];const m=rf(c.stops.map(h=>h[0]),s);return c.stops[m][1]}function zm(c,n,s){const u=c.base!==void 0?c.base:1;if(sc(s)!=="number")return Md(c.default,n.default);const m=c.stops.length;if(m===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[m-1][0])return c.stops[m-1][1];const h=rf(c.stops.map(x=>x[0]),s),v=function(x,A,D,M){const P=M-D,B=x-D;return P===0?0:A===1?B/P:(Math.pow(A,B)-1)/(Math.pow(A,P)-1)}(s,u,c.stops[h][0],c.stops[h+1][0]),T=c.stops[h][1],k=c.stops[h+1][1];let L=rc[n.type]||W_;if(c.colorSpace&&c.colorSpace!=="rgb"){const x=B_[c.colorSpace];L=(A,D)=>x.reverse(x.interpolate(x.forward(A),x.forward(D),v))}return typeof T.evaluate=="function"?{evaluate(...x){const A=T.evaluate.apply(void 0,x),D=k.evaluate.apply(void 0,x);if(A!==void 0&&D!==void 0)return L(A,D,v)}}:L(T,k,v)}function M1(c,n,s){return n.type==="color"?s=pr.parse(s):n.type==="formatted"?s=Gi.fromString(s.toString()):n.type==="resolvedImage"?s=Xi.fromString(s.toString()):sc(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),Md(s,c.default,n.default)}ls.register(su,{error:[{kind:"error"},[Xo],(c,[n])=>{throw new Ci(n.evaluate(c))}],typeof:[Xo,[tr],(c,[n])=>ii(pi(n.evaluate(c)))],"to-rgba":[Yi(qn,4),[as],(c,[n])=>n.evaluate(c).toRenderColor(null).toArray()],rgb:[as,[qn,qn,qn],j_],rgba:[as,[qn,qn,qn,qn],j_],hsl:[as,[qn,qn,qn],Am],hsla:[as,[qn,qn,qn,qn],Am],has:{type:Jo,overloads:[[[Xo],(c,[n])=>km(n.evaluate(c),c.properties())],[[Xo,Hi],(c,[n,s])=>km(n.evaluate(c),s.evaluate(c))]]},get:{type:tr,overloads:[[[Xo],(c,[n])=>Pm(n.evaluate(c),c.properties())],[[Xo,Hi],(c,[n,s])=>Pm(n.evaluate(c),s.evaluate(c))]]},"feature-state":[tr,[Xo],(c,[n])=>Pm(n.evaluate(c),c.featureState||{})],properties:[Hi,[],c=>c.properties()],"geometry-type":[Xo,[],c=>c.geometryType()],id:[tr,[],c=>c.id()],zoom:[qn,[],c=>c.globals.zoom],pitch:[qn,[],c=>c.globals.pitch||0],"distance-from-center":[qn,[],c=>c.distanceFromCenter()],"measure-light":[qn,[Xo],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[qn,[],c=>c.globals.heatmapDensity||0],"line-progress":[qn,[],c=>c.globals.lineProgress||0],"raster-value":[qn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[qn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[qn,[],c=>c.globals.skyRadialProgress||0],accumulated:[tr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[qn,cc(qn),(c,n)=>{let s=0;for(const u of n)s+=u.evaluate(c);return s}],"*":[qn,cc(qn),(c,n)=>{let s=1;for(const u of n)s*=u.evaluate(c);return s}],"-":{type:qn,overloads:[[[qn,qn],(c,[n,s])=>n.evaluate(c)-s.evaluate(c)],[[qn],(c,[n])=>-n.evaluate(c)]]},"/":[qn,[qn,qn],(c,[n,s])=>n.evaluate(c)/s.evaluate(c)],"%":[qn,[qn,qn],(c,[n,s])=>n.evaluate(c)%s.evaluate(c)],ln2:[qn,[],()=>Math.LN2],pi:[qn,[],()=>Math.PI],e:[qn,[],()=>Math.E],"^":[qn,[qn,qn],(c,[n,s])=>Math.pow(n.evaluate(c),s.evaluate(c))],sqrt:[qn,[qn],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))],log2:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[qn,[qn],(c,[n])=>Math.sin(n.evaluate(c))],cos:[qn,[qn],(c,[n])=>Math.cos(n.evaluate(c))],tan:[qn,[qn],(c,[n])=>Math.tan(n.evaluate(c))],asin:[qn,[qn],(c,[n])=>Math.asin(n.evaluate(c))],acos:[qn,[qn],(c,[n])=>Math.acos(n.evaluate(c))],atan:[qn,[qn],(c,[n])=>Math.atan(n.evaluate(c))],min:[qn,cc(qn),(c,n)=>Math.min(...n.map(s=>s.evaluate(c)))],max:[qn,cc(qn),(c,n)=>Math.max(...n.map(s=>s.evaluate(c)))],abs:[qn,[qn],(c,[n])=>Math.abs(n.evaluate(c))],round:[qn,[qn],(c,[n])=>{const s=n.evaluate(c);return s<0?-Math.round(-s):Math.round(s)}],floor:[qn,[qn],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[qn,[qn],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[Jo,[Xo,tr],(c,[n,s])=>c.properties()[n.value]===s.value],"filter-id-==":[Jo,[tr],(c,[n])=>c.id()===n.value],"filter-type-==":[Jo,[Xo],(c,[n])=>c.geometryType()===n.value],"filter-<":[Jo,[Xo,tr],(c,[n,s])=>{const u=c.properties()[n.value],m=s.value;return typeof u==typeof m&&u<m}],"filter-id-<":[Jo,[tr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<u}],"filter->":[Jo,[Xo,tr],(c,[n,s])=>{const u=c.properties()[n.value],m=s.value;return typeof u==typeof m&&u>m}],"filter-id->":[Jo,[tr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>u}],"filter-<=":[Jo,[Xo,tr],(c,[n,s])=>{const u=c.properties()[n.value],m=s.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[Jo,[tr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<=u}],"filter->=":[Jo,[Xo,tr],(c,[n,s])=>{const u=c.properties()[n.value],m=s.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[Jo,[tr],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>=u}],"filter-has":[Jo,[tr],(c,[n])=>n.value in c.properties()],"filter-has-id":[Jo,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Jo,[Yi(Xo)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[Jo,[Yi(tr)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[Jo,[Xo,Yi(tr)],(c,[n,s])=>s.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[Jo,[Xo,Yi(tr)],(c,[n,s])=>function(u,m,h,v){for(;h<=v;){const T=h+v>>1;if(m[T]===u)return!0;m[T]>u?v=T-1:h=T+1}return!1}(c.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Jo,overloads:[[[Jo,Jo],(c,[n,s])=>n.evaluate(c)&&s.evaluate(c)],[cc(Jo),(c,n)=>{for(const s of n)if(!s.evaluate(c))return!1;return!0}]]},any:{type:Jo,overloads:[[[Jo,Jo],(c,[n,s])=>n.evaluate(c)||s.evaluate(c)],[cc(Jo),(c,n)=>{for(const s of n)if(s.evaluate(c))return!0;return!1}]]},"!":[Jo,[Jo],(c,[n])=>!n.evaluate(c)],"is-supported-script":[Jo,[Xo],(c,[n])=>{const s=c.globals&&c.globals.isSupportedScript;return!s||s(n.evaluate(c))}],upcase:[Xo,[Xo],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[Xo,[Xo],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[Xo,cc(tr),(c,n)=>n.map(s=>Ji(s.evaluate(c))).join("")],"resolved-locale":[Xo,[Uh],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[qn,[qn,qn,tr],(c,n)=>{const[s,u,m]=n.map(v=>v.evaluate(c));if(s>u||s===u)return s;let h;if(typeof m=="string")h=function(v){let T=0;if(v.length===0)return T;for(let k=0;k<v.length;k++)T=(T<<5)-T+v.charCodeAt(k),T|=0;return T}(m);else{if(typeof m!="number")throw new Ci(`Invalid seed input: ${m}`);h=m}return s+uf(h)()*(u-s)}]});class Bm{constructor(n,s,u,m){this.expression=n,this._warningHistory={},this._evaluator=new __(u,m),this._defaultValue=s?function(h){return h.type==="color"&&(Lm(h.default)||Array.isArray(h.default))?new pr(0,0,0,0):h.type==="color"?pr.parse(h.default)||null:h.default===void 0?null:h.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=xd(n)}evaluateWithoutErrorHandling(n,s,u,m,h,v,T,k){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,u,m,h,v,T,k){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=k||null;try{const L=this.expression.evaluate(this._evaluator);if(L==null||typeof L=="number"&&L!=L)return this._defaultValue;if(this._enumValues&&!(L in this._enumValues))throw new Ci(`Expected value to be one of ${Object.keys(this._enumValues).map(x=>JSON.stringify(x)).join(", ")}, but found ${JSON.stringify(L)} instead.`);return L}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${L.message}`)),this._defaultValue}}}function hf(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in su}function au(c,n,s,u){const m=new k_(su,[],n?function(v){const T={color:as,string:Xo,number:qn,enum:Xo,boolean:Jo,formatted:Uc,resolvedImage:jc};return v.type==="array"?Yi(T[v.value]||tr,v.length):T[v.type]}(n):void 0,void 0,void 0,s,u),h=m.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?H_(new Bm(h,n,s,u)):qa(m.errors)}class ff{constructor(n,s,u){this.kind=n,this._styleExpression=s,this.isLightConstant=u,this.isStateDependent=n!=="constant"&&!of(s.expression),this.configDependencies=xd(s.expression)}evaluateWithoutErrorHandling(n,s,u,m,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,m,h,v)}evaluate(n,s,u,m,h,v){return this._styleExpression.evaluate(n,s,u,m,h,v)}}class Id{constructor(n,s,u,m,h){this.kind=n,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!of(s.expression),this.isLightConstant=h,this.configDependencies=xd(s.expression),this.interpolationType=m}evaluateWithoutErrorHandling(n,s,u,m,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,m,h,v)}evaluate(n,s,u,m,h,v){return this._styleExpression.evaluate(n,s,u,m,h,v)}interpolationFactor(n,s,u){return this.interpolationType?Es.interpolationFactor(this.interpolationType,n,s,u):0}}function dc(c,n,s,u){if((c=au(c,n,s,u)).result==="error")return c;const m=c.value.expression,h=bd(m);if(!h&&!uc(n))return qa([new na("","data expressions not supported")]);const v=nu(m,["zoom","pitch","distance-from-center"]);if(!v&&!Rm(n))return qa([new na("","zoom expressions not supported")]);const T=nu(m,["measure-light"]);if(!T&&!G_(n))return qa([new na("","measure-light expression not supported")]);const k=nu(m,["line-progress"]);if(!k&&!function(A){return df(A.expression,"line-progress")}(n))return qa([new na("","line-progress expression not supported")]);const L=n.expression&&n.expression.relaxZoomRestriction,x=mf(m);return x||v||L?x instanceof na?qa([x]):x instanceof Es&&!Dm(n)?qa([new na("",'"interpolate" expressions cannot be used with this property')]):H_(x?new Id(h&&k?"camera":"composite",c.value,x.labels,x instanceof Es?x.interpolation:void 0,T):new ff(h&&k?"constant":"source",c.value,T)):qa([new na("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class pf{constructor(n,s){this._parameters=n,this._specification=s,Vc(this,Om(this._parameters,this._specification))}static deserialize(n){return new pf(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function mf(c){let n=null;if(c instanceof af)n=mf(c.result);else if(c instanceof sf){for(const s of c.args)if(n=mf(s),n)break}else(c instanceof wd||c instanceof Es)&&c.input instanceof ls&&c.input.name==="zoom"&&(n=c);return n instanceof na||c.eachChild(s=>{const u=mf(s);u instanceof na?n=u:n&&u&&n!==u&&(n=new na("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var Fm,Nm,q_=function(){if(Nm)return Fm;Nm=1,Fm=n;var c=3;function n(s,u,m){var h=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var v=new Int32Array(this.arrayBuffer);s=v[0],this.d=(u=v[1])+2*(m=v[2]);for(var T=0;T<this.d*this.d;T++){var k=v[c+T],L=v[c+T+1];h.push(k===L?null:v.subarray(k,L))}var x=v[c+h.length+1];this.keys=v.subarray(v[c+h.length],x),this.bboxes=v.subarray(x),this.insert=this._insertReadonly}else{this.d=u+2*m;for(var A=0;A<this.d*this.d;A++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=m,this.scale=u/s,this.uid=0;var D=m/u*s;this.min=-D,this.max=s+D}return n.prototype.insert=function(s,u,m,h,v){this._forEachCell(u,m,h,v,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(h),this.bboxes.push(v)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(s,u,m,h,v,T){this.cells[v].push(T)},n.prototype.query=function(s,u,m,h,v){var T=this.min,k=this.max;if(s<=T&&u<=T&&k<=m&&k<=h&&!v)return Array.prototype.slice.call(this.keys);var L=[];return this._forEachCell(s,u,m,h,this._queryCell,L,{},v),L},n.prototype._queryCell=function(s,u,m,h,v,T,k,L){var x=this.cells[v];if(x!==null)for(var A=this.keys,D=this.bboxes,M=0;M<x.length;M++){var P=x[M];if(k[P]===void 0){var B=4*P;(L?L(D[B+0],D[B+1],D[B+2],D[B+3]):s<=D[B+2]&&u<=D[B+3]&&m>=D[B+0]&&h>=D[B+1])?(k[P]=!0,T.push(A[P])):k[P]=!1}}},n.prototype._forEachCell=function(s,u,m,h,v,T,k,L){for(var x=this._convertToCellCoord(s),A=this._convertToCellCoord(u),D=this._convertToCellCoord(m),M=this._convertToCellCoord(h),P=x;P<=D;P++)for(var B=A;B<=M;B++){var H=this.d*B+P;if((!L||L(this._convertFromCellCoord(P),this._convertFromCellCoord(B),this._convertFromCellCoord(P+1),this._convertFromCellCoord(B+1)))&&v.call(this,s,u,m,h,H,T,k,L))return}},n.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},n.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,u=c+this.cells.length+1+1,m=0,h=0;h<this.cells.length;h++)m+=this.cells[h].length;var v=new Int32Array(u+m+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var T=u,k=0;k<s.length;k++){var L=s[k];v[c+k]=T,v.set(L,T),T+=L.length}return v[c+s.length]=T,v.set(this.keys,T),v[c+s.length+1]=T+=this.keys.length,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer},Fm}(),hc=S(q_);const Ad={};function jn(c,n,s={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),Ad[n]={klass:c,omit:s.omit||[]}}jn(Object,"Object"),hc.serialize=function(c,n){const s=c.toArrayBuffer();return n&&n.add(s),{buffer:s}},hc.deserialize=function(c){return new hc(c.buffer)},Object.defineProperty(hc,"name",{value:"Grid"}),jn(hc,"Grid"),jn(pr,"Color"),jn(Error,"Error"),jn(Gi,"Formatted"),jn(ws,"FormattedSection"),jn(em,"AJAXError"),jn(Xi,"ResolvedImage"),jn(pf,"StylePropertyFunction"),jn(Bm,"StyleExpression",{omit:["_evaluator"]}),jn(Id,"ZoomDependentExpression"),jn(ff,"ZoomConstantExpression"),jn(ls,"CompoundExpression",{omit:["_evaluate"]});for(const c in su)Ad[su[c]._classRegistryKey]||jn(su[c],`Expression${c}`);function gf(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function $m(c){return self.ImageBitmap&&c instanceof ImageBitmap}function fc(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(gf(c)||$m(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c)){const s=c;return n&&n.add(s.buffer),s}if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const s=[];for(const u of c)s.push(fc(u,n));return s}if(c instanceof Map){const s={$name:"Map"};for(const[u,m]of c.entries())s[u]=fc(m);return s}if(c instanceof Set){const s={$name:"Set"};let u=0;for(const m of c.values())s[++u]=fc(m);return s}if(typeof c=="object"){const s=c.constructor,u=s._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const m=s.serialize?s.serialize(c,n):{};if(!s.serialize){for(const h in c)c.hasOwnProperty(h)&&(Ad[u].omit.indexOf(h)>=0||(m[h]=fc(c[h],n)));c instanceof Error&&(m.message=c.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(m.$name=u),m}throw new Error("can't serialize object of type "+typeof c)}function cs(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||gf(c)||$m(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(cs);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const m=new Map;for(const h of Object.keys(c))h!=="$name"&&m.set(h,cs(c[h]));return m}if(n==="Set"){const m=new Set;for(const h of Object.keys(c))h!=="$name"&&m.add(cs(c[h]));return m}const{klass:s}=Ad[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(c);const u=Object.create(s.prototype);for(const m of Object.keys(c))m!=="$name"&&(u[m]=cs(c[m]));return u}throw new Error("can't deserialize object of type "+typeof c)}const Jn={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function Vm(c){for(const n of c)if(lu(n.charCodeAt(0)))return!0;return!1}function K_(c){for(const n of c)if(!I1(n.charCodeAt(0)))return!1;return!0}function I1(c){return!(Jn.Arabic(c)||Jn["Arabic Supplement"](c)||Jn["Arabic Extended-A"](c)||Jn["Arabic Presentation Forms-A"](c)||Jn["Arabic Presentation Forms-B"](c))}function lu(c){return!(c!==746&&c!==747&&(c<4352||!(Jn["Bopomofo Extended"](c)||Jn.Bopomofo(c)||Jn["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Jn["CJK Compatibility Ideographs"](c)||Jn["CJK Compatibility"](c)||Jn["CJK Radicals Supplement"](c)||Jn["CJK Strokes"](c)||!(!Jn["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Jn["CJK Unified Ideographs Extension A"](c)||Jn["CJK Unified Ideographs"](c)||Jn["Enclosed CJK Letters and Months"](c)||Jn["Hangul Compatibility Jamo"](c)||Jn["Hangul Jamo Extended-A"](c)||Jn["Hangul Jamo Extended-B"](c)||Jn["Hangul Jamo"](c)||Jn["Hangul Syllables"](c)||Jn.Hiragana(c)||Jn["Ideographic Description Characters"](c)||Jn.Kanbun(c)||Jn["Kangxi Radicals"](c)||Jn["Katakana Phonetic Extensions"](c)||Jn.Katakana(c)&&c!==12540||!(!Jn["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Jn["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Jn["Unified Canadian Aboriginal Syllabics"](c)||Jn["Unified Canadian Aboriginal Syllabics Extended"](c)||Jn["Vertical Forms"](c)||Jn["Yijing Hexagram Symbols"](c)||Jn["Yi Syllables"](c)||Jn["Yi Radicals"](c))))}function Um(c){return!(lu(c)||function(n){return!!(Jn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Jn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Jn["Letterlike Symbols"](n)||Jn["Number Forms"](n)||Jn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Jn["Control Pictures"](n)&&n!==9251||Jn["Optical Character Recognition"](n)||Jn["Enclosed Alphanumerics"](n)||Jn["Geometric Shapes"](n)||Jn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Jn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Jn["CJK Symbols and Punctuation"](n)||Jn.Katakana(n)||Jn["Private Use Area"](n)||Jn["CJK Compatibility Forms"](n)||Jn["Small Form Variants"](n)||Jn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function kd(c){return c>=1424&&c<=2303||Jn["Arabic Presentation Forms-A"](c)||Jn["Arabic Presentation Forms-B"](c)}function Z_(c,n){return!(!n&&kd(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Jn.Khmer(c))}function A1(c){for(const n of c)if(kd(n.charCodeAt(0)))return!0;return!1}const jm="deferred",Pd="loading",Rd="loaded";let vf=null,Li="unavailable",Ms=null;const Y_=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Li="error"),vf&&vf(c)};function Hm(){Gm.fire(new Ml("pluginStateChange",{pluginStatus:Li,pluginURL:Ms}))}const Gm=new $c,Wm=function(){return Li},X_=function(){if(Li!==jm||!Ms)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Li=Pd,Hm(),Ms&&Fc({url:Ms},c=>{c?Y_(c):(Li=Rd,Hm())})},Is={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Li===Rd||Is.applyArabicShaping!=null,isLoading:()=>Li===Pd,setState(c){Li=c.pluginStatus,Ms=c.pluginURL},isParsed:()=>Is.applyArabicShaping!=null&&Is.processBidirectionalText!=null&&Is.processStyledBidirectionalText!=null,getPluginURL:()=>Ms};class Zr{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(s,u){for(const m of s)if(!Z_(m.charCodeAt(0),u))return!1;return!0}(n,Is.isLoaded())}}class _f{constructor(n,s,u,m){this.property=n,this.value=s,this.expression=function(h,v,T,k){if(Lm(h))return new pf(h,v);if(hf(h)||Array.isArray(h)&&h.length>0){const L=dc(h,v,T,k);if(L.result==="error")throw new Error(L.value.map(x=>`${x.key}: ${x.message}`).join(", "));return L.value}{let L=h;return typeof h=="string"&&v.type==="color"&&(L=pr.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>L}}}(s===void 0?n.specification.default:s,n.specification,u,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,u){return this.property.possiblyEvaluate(this,n,s,u)}}class qm{constructor(n,s,u){this.property=n,this.value=new _f(n,void 0,s,u)}transitioned(n,s){return new Q_(this.property,this.value,s,eo({},n.transition,this.transition),n.now)}untransitioned(){return new Q_(this.property,this.value,null,{},0)}}class J_{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return Ze(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new qm(this._values[n].property,this._scope,this._options)),this._values[n].value=new _f(this._values[n].property,s===null?void 0:Ze(s),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,s){s&&(this._options=s);const u=this._properties.properties;if(n)for(const m in n){const h=n[m];if(_n(m,"-transition")){const v=m.slice(0,-11);u[v]&&this.setTransition(v,h)}else u.hasOwnProperty(m)&&this.setValue(m,h)}}getTransition(n){return Ze(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new qm(this._values[n].property)),this._values[n].transition=Ze(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u);const m=this.getTransition(s);m!==void 0&&(n[`${s}-transition`]=m)}return n}transitioned(n,s){const u=new ey(this._properties);for(const m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(n,s._values[m]);return u}untransitioned(){const n=new ey(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Q_{constructor(n,s,u,m,h){const v=m.delay||0,T=m.duration||0;h=h||0,this.property=n,this.value=s,this.begin=h+v,this.end=this.begin+T,n.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(n,s,u){const m=n.now||0,h=this.value.possiblyEvaluate(n,s,u),v=this.prior;if(v){if(m>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(m<this.begin)return v.possiblyEvaluate(n,s,u);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,s,u),h,dn(T))}}return h}}class ey{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,u){const m=new uu(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(n,s,u);return m}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class k1{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return Ze(this._values[n].value)}setValue(n,s){this._values[n]=new _f(this._values[n].property,s===null?void 0:Ze(s),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u)}return n}possiblyEvaluate(n,s,u){const m=new uu(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(n,s,u);return m}}class cu{constructor(n,s,u){this.property=n,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,u,m){return this.property.evaluate(this.value,this.parameters,n,s,u,m)}}class uu{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class wn{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,u){const m=rc[this.specification.type];return m?m(n,s,u):n}}class Qn{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,u,m){return new cu(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},u,m)}:n.expression,s)}interpolate(n,s,u){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new cu(this,{kind:"constant",value:void 0},n.parameters);const m=rc[this.specification.type];return m?new cu(this,{kind:"constant",value:m(n.value.value,s.value.value,u)},n.parameters):n}evaluate(n,s,u,m,h,v){return n.kind==="constant"?n.value:n.evaluate(s,u,m,h,v)}}class du{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,m){return!!n.expression.evaluate(s,null,{},u,m)}interpolate(){return!1}}class zr{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new Zr(0,{});for(const u in n){const m=n[u];m.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new _f(m,void 0),v=this.defaultTransitionablePropertyValues[u]=new qm(m);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(s)}}}jn(Qn,"DataDrivenProperty"),jn(wn,"DataConstantProperty"),jn(du,"ColorRampProperty");var It=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,90],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"rain":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Km(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function pc(c){if(Array.isArray(c))return c.map(pc);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const s in c)n[s]=pc(c[s]);return n}return Km(c)}function Zm(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!Zm(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function yf(c,n="",s=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zm(c)||(c=bf(c));const m=c;let h=!0;try{h=function(x){if(!sa(x))return x;let A=pc(x);return Ym(A),A=Ka(A),A}(m)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(m,null,2)}
        `)}let v=null,T=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){T=It[`filter_${u}`];const x=au(h,T,n,s);if(x.result==="error")throw new Error(x.value.map(A=>`${A.key}: ${A.message}`).join(", "));v=(A,D,M)=>x.value.evaluate(A,D,{},M)}let k=null,L=null;if(h!==m){const x=au(m,T,n,s);if(x.result==="error")throw new Error(x.value.map(A=>`${A.key}: ${A.message}`).join(", "));k=(A,D,M,P,B)=>x.value.evaluate(A,D,{},M,void 0,void 0,P,B),L=!bd(x.value.expression)}return{filter:v,dynamicFilter:k||void 0,needGeometry:ty(h),needFeature:!!L}}function Ka(c){if(!Array.isArray(c))return c;const n=function(s){if(P1.has(s[0])){for(let u=1;u<s.length;u++)if(sa(s[u]))return!0}return s}(c);return n===!0?n:n.map(s=>Ka(s))}function Ym(c){let n=!1;const s=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)n=n||sa(c[u]),s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="match"){n=n||sa(c[1]);for(let u=2;u<c.length-1;u+=2)s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="step"){n=n||sa(c[1]);for(let u=1;u<c.length-1;u+=2)s.push(c[u+1])}n&&(c.length=0,c.push("any",...s));for(let u=1;u<c.length;u++)Ym(c[u])}function sa(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<c.length;s++)if(sa(c[s]))return!0;return!1}const P1=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function R1(c,n){return c<n?-1:c>n?1:0}function ty(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(ty(c[n]))return!0;return!1}function bf(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?Xm(c[1],c[2],"=="):n==="!="?mc(Xm(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Xm(c[1],c[2],n):n==="any"?(s=c.slice(1),["any"].concat(s.map(bf))):n==="all"?["all"].concat(c.slice(1).map(bf)):n==="none"?["all"].concat(c.slice(1).map(bf).map(mc)):n==="in"?Jm(c[1],c.slice(2)):n==="!in"?mc(Jm(c[1],c.slice(2))):n==="has"?xf(c[1]):n!=="!has"||mc(xf(c[1]));var s}function Xm(c,n,s){switch(c){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,c,n]}}function Jm(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",c,["literal",n.sort(R1)]]:["filter-in-small",c,["literal",n]]}}function xf(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function mc(c){return["!",c]}const Dd="";function wf(c,n){return n?`${c}${Dd}${n}`:c}const ny="-transition",Ta=new Set(["fill","line","background","hillshade","raster"]);class Qi extends $c{constructor(n,s,u,m,h){if(super(),this.id=n.id,this.fqid=wf(this.id,u),this.type=n.type,this.scope=u,this.lut=m,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const v=au(this.filter,It[`filter_${n.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),s.layout&&(this._unevaluatedLayout=new k1(s.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new J_(s.paint,this.scope,h);for(const v in n.paint)this.setPaintProperty(v,n.paint[v]);for(const v in n.layout)this.setLayoutProperty(v,n.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new uu(s.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&Ta.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s){if(this.type==="custom"&&n==="visibility")return void(this.visibility=s);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return _n(n,ny)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s){const u=this._transitionablePaint,m=u._properties.properties;if(_n(n,ny)){const A=n.slice(0,-11);return m[A]&&u.setTransition(A,s||void 0),!1}if(!m[n])return!1;const h=u._values[n],v=h.value.isDataDriven(),T=h.value;u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const k=u._values[n].value,L=k.isDataDriven(),x=_n(n,"pattern")||n==="line-dasharray";return L||v||x||this._handleOverridablePaintPropertyUpdate(n,T,k)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,s,u){return null}_handleOverridablePaintPropertyUpdate(n,s,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){return tn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof cu&&uc(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=yf(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,s,u,m,h,v,T,k,L){}queryIntersectsMatchingFeature(n,s,u,m){}}const oy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ld{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Br{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function sr(c,n=1){let s=0,u=0;return{members:c.map(m=>{const h=oy[m.type].BYTES_PER_ELEMENT,v=s=ry(s,Math.max(n,h)),T=m.components||1;return u=Math.max(u,h),s+=h*T,{name:m.name,type:m.type,components:T,offset:v}}),size:ry(s,Math.max(u,n)),alignment:n}}function ry(c,n){return Math.ceil(c/n)*n}class Rl extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const m=2*n;return this.int16[m+0]=s,this.int16[m+1]=u,n}}Rl.prototype.bytesPerElement=4,jn(Rl,"StructArrayLayout2i4");class Sf extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,u)}emplace(n,s,u,m){const h=3*n;return this.int16[h+0]=s,this.int16[h+1]=u,this.int16[h+2]=m,n}}Sf.prototype.bytesPerElement=6,jn(Sf,"StructArrayLayout3i6");class hu extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,m)}emplace(n,s,u,m,h){const v=4*n;return this.int16[v+0]=s,this.int16[v+1]=u,this.int16[v+2]=m,this.int16[v+3]=h,n}}hu.prototype.bytesPerElement=8,jn(hu,"StructArrayLayout4i8");class Qm extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,m,h)}emplace(n,s,u,m,h,v){const T=5*n;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=m,this.int16[T+3]=h,this.int16[T+4]=v,n}}Qm.prototype.bytesPerElement=10,jn(Qm,"StructArrayLayout5i10");class Od extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,u,m,h,v,T)}emplace(n,s,u,m,h,v,T,k){const L=6*n,x=12*n,A=3*n;return this.int16[L+0]=s,this.int16[L+1]=u,this.uint8[x+4]=m,this.uint8[x+5]=h,this.uint8[x+6]=v,this.uint8[x+7]=T,this.float32[A+2]=k,n}}Od.prototype.bytesPerElement=12,jn(Od,"StructArrayLayout2i4ub1f12");class Za extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,m)}emplace(n,s,u,m,h){const v=4*n;return this.float32[v+0]=s,this.float32[v+1]=u,this.float32[v+2]=m,this.float32[v+3]=h,n}}Za.prototype.bytesPerElement=16,jn(Za,"StructArrayLayout4f16");class Dl extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,u)}emplace(n,s,u,m){const h=3*n;return this.float32[h+0]=s,this.float32[h+1]=u,this.float32[h+2]=m,n}}Dl.prototype.bytesPerElement=12,jn(Dl,"StructArrayLayout3f12");class Ya extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,m,h)}emplace(n,s,u,m,h,v){const T=6*n,k=3*n;return this.uint16[T+0]=s,this.uint16[T+1]=u,this.uint16[T+2]=m,this.uint16[T+3]=h,this.float32[k+2]=v,n}}Ya.prototype.bytesPerElement=12,jn(Ya,"StructArrayLayout4ui1f12");class Tf extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,m)}emplace(n,s,u,m,h){const v=4*n;return this.uint16[v+0]=s,this.uint16[v+1]=u,this.uint16[v+2]=m,this.uint16[v+3]=h,n}}Tf.prototype.bytesPerElement=8,jn(Tf,"StructArrayLayout4ui8");class zd extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,m,h,v)}emplace(n,s,u,m,h,v,T){const k=6*n;return this.int16[k+0]=s,this.int16[k+1]=u,this.int16[k+2]=m,this.int16[k+3]=h,this.int16[k+4]=v,this.int16[k+5]=T,n}}zd.prototype.bytesPerElement=12,jn(zd,"StructArrayLayout6i12");class fu extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T,k,L,x,A,D){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,u,m,h,v,T,k,L,x,A,D)}emplace(n,s,u,m,h,v,T,k,L,x,A,D,M){const P=12*n;return this.int16[P+0]=s,this.int16[P+1]=u,this.int16[P+2]=m,this.int16[P+3]=h,this.uint16[P+4]=v,this.uint16[P+5]=T,this.uint16[P+6]=k,this.uint16[P+7]=L,this.int16[P+8]=x,this.int16[P+9]=A,this.int16[P+10]=D,this.int16[P+11]=M,n}}fu.prototype.bytesPerElement=24,jn(fu,"StructArrayLayout4i4ui4i24");class eg extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,m,h,v)}emplace(n,s,u,m,h,v,T){const k=10*n,L=5*n;return this.int16[k+0]=s,this.int16[k+1]=u,this.int16[k+2]=m,this.float32[L+2]=h,this.float32[L+3]=v,this.float32[L+4]=T,n}}eg.prototype.bytesPerElement=20,jn(eg,"StructArrayLayout3i3f20");class tg extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}tg.prototype.bytesPerElement=4,jn(tg,"StructArrayLayout1ul4");class Ll extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const m=2*n;return this.uint16[m+0]=s,this.uint16[m+1]=u,n}}Ll.prototype.bytesPerElement=4,jn(Ll,"StructArrayLayout2ui4");class ng extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T,k,L,x,A,D,M){const P=this.length;return this.resize(P+1),this.emplace(P,n,s,u,m,h,v,T,k,L,x,A,D,M)}emplace(n,s,u,m,h,v,T,k,L,x,A,D,M,P){const B=20*n,H=10*n;return this.int16[B+0]=s,this.int16[B+1]=u,this.int16[B+2]=m,this.int16[B+3]=h,this.int16[B+4]=v,this.float32[H+3]=T,this.float32[H+4]=k,this.float32[H+5]=L,this.float32[H+6]=x,this.int16[B+14]=A,this.uint32[H+8]=D,this.uint16[B+18]=M,this.uint16[B+19]=P,n}}ng.prototype.bytesPerElement=40,jn(ng,"StructArrayLayout5i4f1i1ul2ui40");class Cf extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,u,m,h,v,T)}emplace(n,s,u,m,h,v,T,k){const L=8*n;return this.int16[L+0]=s,this.int16[L+1]=u,this.int16[L+2]=m,this.int16[L+4]=h,this.int16[L+5]=v,this.int16[L+6]=T,this.int16[L+7]=k,n}}Cf.prototype.bytesPerElement=16,jn(Cf,"StructArrayLayout3i2i2i16");class pu extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,m,h)}emplace(n,s,u,m,h,v){const T=4*n,k=8*n;return this.float32[T+0]=s,this.float32[T+1]=u,this.float32[T+2]=m,this.int16[k+6]=h,this.int16[k+7]=v,n}}pu.prototype.bytesPerElement=16,jn(pu,"StructArrayLayout2f1f2i16");class mu extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,m,h,v)}emplace(n,s,u,m,h,v,T){const k=20*n,L=5*n;return this.uint8[k+0]=s,this.uint8[k+1]=u,this.float32[L+1]=m,this.float32[L+2]=h,this.float32[L+3]=v,this.float32[L+4]=T,n}}mu.prototype.bytesPerElement=20,jn(mu,"StructArrayLayout2ub4f20");class Gr extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,u)}emplace(n,s,u,m){const h=3*n;return this.uint16[h+0]=s,this.uint16[h+1]=u,this.uint16[h+2]=m,n}}Gr.prototype.bytesPerElement=6,jn(Gr,"StructArrayLayout3ui6");class gu extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z,te,ne,X,le){const pe=this.length;return this.resize(pe+1),this.emplace(pe,n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z,te,ne,X,le)}emplace(n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z,te,ne,X,le,pe){const Ce=30*n,Ue=15*n,Le=60*n;return this.int16[Ce+0]=s,this.int16[Ce+1]=u,this.int16[Ce+2]=m,this.float32[Ue+2]=h,this.float32[Ue+3]=v,this.uint16[Ce+8]=T,this.uint16[Ce+9]=k,this.uint32[Ue+5]=L,this.uint32[Ue+6]=x,this.uint32[Ue+7]=A,this.uint16[Ce+16]=D,this.uint16[Ce+17]=M,this.uint16[Ce+18]=P,this.float32[Ue+10]=B,this.float32[Ue+11]=H,this.uint8[Le+48]=Z,this.uint8[Le+49]=te,this.uint8[Le+50]=ne,this.uint32[Ue+13]=X,this.int16[Ce+28]=le,this.uint8[Le+58]=pe,n}}gu.prototype.bytesPerElement=60,jn(gu,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class og extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z,te,ne,X,le,pe,Ce,Ue,Le,ze,ot,Oe,et,ct,ut,_t){const Mt=this.length;return this.resize(Mt+1),this.emplace(Mt,n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z,te,ne,X,le,pe,Ce,Ue,Le,ze,ot,Oe,et,ct,ut,_t)}emplace(n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z,te,ne,X,le,pe,Ce,Ue,Le,ze,ot,Oe,et,ct,ut,_t,Mt){const kt=20*n,St=40*n,Yt=80*n;return this.float32[kt+0]=s,this.float32[kt+1]=u,this.int16[St+4]=m,this.int16[St+5]=h,this.int16[St+6]=v,this.int16[St+7]=T,this.int16[St+8]=k,this.int16[St+9]=L,this.int16[St+10]=x,this.int16[St+11]=A,this.int16[St+12]=D,this.uint16[St+13]=M,this.uint16[St+14]=P,this.uint16[St+15]=B,this.uint16[St+16]=H,this.uint16[St+17]=Z,this.uint16[St+18]=te,this.uint16[St+19]=ne,this.uint16[St+20]=X,this.uint16[St+21]=le,this.uint16[St+22]=pe,this.uint16[St+23]=Ce,this.uint16[St+24]=Ue,this.uint16[St+25]=Le,this.uint16[St+26]=ze,this.uint16[St+27]=ot,this.uint32[kt+14]=Oe,this.float32[kt+15]=et,this.float32[kt+16]=ct,this.float32[kt+17]=ut,this.float32[kt+18]=_t,this.uint8[Yt+76]=Mt,n}}og.prototype.bytesPerElement=80,jn(og,"StructArrayLayout2f9i15ui1ul4f1ub80");class vu extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}vu.prototype.bytesPerElement=4,jn(vu,"StructArrayLayout1f4");class gc extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,m,h)}emplace(n,s,u,m,h,v){const T=5*n;return this.float32[T+0]=s,this.float32[T+1]=u,this.float32[T+2]=m,this.float32[T+3]=h,this.float32[T+4]=v,n}}gc.prototype.bytesPerElement=20,jn(gc,"StructArrayLayout5f20");class rg extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,u,m,h,v,T)}emplace(n,s,u,m,h,v,T,k){const L=7*n;return this.float32[L+0]=s,this.float32[L+1]=u,this.float32[L+2]=m,this.float32[L+3]=h,this.float32[L+4]=v,this.float32[L+5]=T,this.float32[L+6]=k,n}}rg.prototype.bytesPerElement=28,jn(rg,"StructArrayLayout7f28");class Ef extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T,k,L,x,A){const D=this.length;return this.resize(D+1),this.emplace(D,n,s,u,m,h,v,T,k,L,x,A)}emplace(n,s,u,m,h,v,T,k,L,x,A,D){const M=11*n;return this.float32[M+0]=s,this.float32[M+1]=u,this.float32[M+2]=m,this.float32[M+3]=h,this.float32[M+4]=v,this.float32[M+5]=T,this.float32[M+6]=k,this.float32[M+7]=L,this.float32[M+8]=x,this.float32[M+9]=A,this.float32[M+10]=D,n}}Ef.prototype.bytesPerElement=44,jn(Ef,"StructArrayLayout11f44");class iy extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T,k,L){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,u,m,h,v,T,k,L)}emplace(n,s,u,m,h,v,T,k,L,x){const A=9*n;return this.float32[A+0]=s,this.float32[A+1]=u,this.float32[A+2]=m,this.float32[A+3]=h,this.float32[A+4]=v,this.float32[A+5]=T,this.float32[A+6]=k,this.float32[A+7]=L,this.float32[A+8]=x,n}}iy.prototype.bytesPerElement=36,jn(iy,"StructArrayLayout9f36");class Bd extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,m)}emplace(n,s,u,m,h){const v=6*n;return this.uint32[3*n+0]=s,this.uint16[v+2]=u,this.uint16[v+3]=m,this.uint16[v+4]=h,n}}Bd.prototype.bytesPerElement=12,jn(Bd,"StructArrayLayout1ul3ui12");class ig extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}ig.prototype.bytesPerElement=2,jn(ig,"StructArrayLayout1ui2");class Fd extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const m=2*n;return this.float32[m+0]=s,this.float32[m+1]=u,n}}Fd.prototype.bytesPerElement=8,jn(Fd,"StructArrayLayout2f8");class Nd extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H){const Z=this.length;return this.resize(Z+1),this.emplace(Z,n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H)}emplace(n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z){const te=16*n;return this.float32[te+0]=s,this.float32[te+1]=u,this.float32[te+2]=m,this.float32[te+3]=h,this.float32[te+4]=v,this.float32[te+5]=T,this.float32[te+6]=k,this.float32[te+7]=L,this.float32[te+8]=x,this.float32[te+9]=A,this.float32[te+10]=D,this.float32[te+11]=M,this.float32[te+12]=P,this.float32[te+13]=B,this.float32[te+14]=H,this.float32[te+15]=Z,n}}Nd.prototype.bytesPerElement=64,jn(Nd,"StructArrayLayout16f64");class Mf extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,m,h,v,T){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,u,m,h,v,T)}emplace(n,s,u,m,h,v,T,k){const L=10*n,x=5*n;return this.uint16[L+0]=s,this.uint16[L+1]=u,this.uint16[L+2]=m,this.uint16[L+3]=h,this.float32[x+2]=v,this.float32[x+3]=T,this.float32[x+4]=k,n}}Mf.prototype.bytesPerElement=20,jn(Mf,"StructArrayLayout4ui3f20");class If extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.int16[1*n+0]=s,n}}If.prototype.bytesPerElement=2,jn(If,"StructArrayLayout1i2");class Af extends Br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint8[1*n+0]=s,n}}Af.prototype.bytesPerElement=1,jn(Af,"StructArrayLayout1ub1");class sy extends Ld{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}sy.prototype.size=40;class kf extends ng{get(n){return new sy(this,n)}}jn(kf,"CollisionBoxArray");class $d extends Ld{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}$d.prototype.size=60;class sg extends gu{get(n){return new $d(this,n)}}jn(sg,"PlacedSymbolArray");class ay extends Ld{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}ay.prototype.size=80;class ag extends og{get(n){return new ay(this,n)}}jn(ag,"SymbolInstanceArray");class ly extends vu{getoffsetX(n){return this.float32[1*n+0]}}jn(ly,"GlyphOffsetArray");class Pf extends Rl{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}jn(Pf,"SymbolLineVertexArray");class cy extends Ld{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}cy.prototype.size=12;class uy extends Bd{get(n){return new cy(this,n)}}jn(uy,"FeatureIndexArray");class dy extends Ll{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}jn(dy,"FillExtrusionCentroidArray");class hy extends Ld{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}hy.prototype.size=6;class lg extends Sf{get(n){return new hy(this,n)}}jn(lg,"FillExtrusionWallArray");const D1=sr([{name:"a_pos",components:2,type:"Int16"}],4),L1=sr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ti{constructor(n=[]){this.segments=n}_prepareSegment(n,s,u,m){let h=this.segments[this.segments.length-1];return n>ti.MAX_VERTEX_ARRAY_LENGTH&&Mn(`Max vertices per segment is ${ti.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!h||h.vertexLength+n>ti.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==m)&&(h={vertexOffset:s,primitiveOffset:u,vertexLength:0,primitiveLength:0},m!==void 0&&(h.sortKey=m),this.segments.push(h)),h}prepareSegment(n,s,u,m){return this._prepareSegment(n,s.length,u.length,m)}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,u,m){return new ti([{vertexOffset:n,primitiveOffset:s,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function fy(c,n){return 256*(c=gt(Math.floor(c),0,255))+gt(Math.floor(n),0,255)}ti.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jn(ti,"SegmentVector");const O1=sr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),z1=sr([{name:"a_dash",components:4,type:"Uint16"}]);class Vd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,s,u,m){this.ids.push(py(n)),this.positions.push(s,u,m)}eachPosition(n,s){const u=py(n);let m=0,h=this.ids.length-1;for(;m<h;){const v=m+h>>1;this.ids[v]>=u?h=v:m=v+1}for(;this.ids[m]===u;)s(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(n,s){const u=new Float64Array(n.ids),m=new Uint32Array(n.positions);return _u(u,m,0,u.length-1),s&&(s.add(u.buffer),s.add(m.buffer)),{ids:u,positions:m}}static deserialize(n){const s=new Vd;let u;s.ids=n.ids,s.positions=n.positions;for(const m of s.ids)m!==u&&s.uniqueIds.push(m),u=m;return s.indexed=!0,s}}function py(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:ss(String(c))}function _u(c,n,s,u){for(;s<u;){const m=c[s+u>>1];let h=s-1,v=u+1;for(;;){do h++;while(c[h]<m);do v--;while(c[v]>m);if(h>=v)break;Rf(c,h,v),Rf(n,3*h,3*v),Rf(n,3*h+1,3*v+1),Rf(n,3*h+2,3*v+2)}v-s<u-v?(_u(c,n,s,v),s=v+1):(_u(c,n,v+1,u),u=v)}}function Rf(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}jn(Vd,"FeaturePositionMap");class Xa{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}set(n,s,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class vc extends Xa{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class wi extends Xa{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Ca extends Xa{constructor(n){super(n),this.current=[0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class cg extends Xa{constructor(n){super(n),this.current=[0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Df extends Xa{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class ug extends Xa{constructor(n){super(n),this.current=pr.transparent.toRenderColor(null)}set(n,s,u){this.fetchUniformLocation(n,s)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const my=new Float32Array(16);class Ud extends Xa{constructor(n){super(n),this.current=my}set(n,s,u){if(this.fetchUniformLocation(n,s)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let m=1;m<16;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const B1=new Float32Array(9),gy=new Float32Array(4);class Lf extends Xa{constructor(n){super(n),this.current=gy}set(n,s,u){if(this.fetchUniformLocation(n,s)){for(let m=0;m<4;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function dg(c){return[fy(255*c.r,255*c.g),fy(255*c.b,255*c.a)]}class jd{constructor(n,s,u,m){this.value=n,this.uniformNames=s.map(h=>`u_${h}`),this.type=u,this.context=m}setUniform(n,s,u,m,h){const v=m.constantOr(this.value);s.set(n,h,v instanceof pr?v.toRenderColor(this.context.lut):v)}getBinding(n,s){return this.type==="color"?new ug(n):new wi(n)}}class yu{constructor(n,s){this.uniformNames=s.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,u,m,h){const v=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;v&&s.set(n,h,v)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new Df(n):new wi(n)}}class Ja{constructor(n,s,u,m){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(n,s,u,m,h,v,T){const k=this.paintVertexArray.length,L=this.expression.evaluate(new Zr(0,{brightness:v}),s,{},h,m,T);this.paintVertexArray.resize(n),this._setPaintValue(k,n,L,this.context)}updatePaintArray(n,s,u,m,h,v,T){const k=this.expression.evaluate({zoom:0,brightness:T},u,m,void 0,h);this._setPaintValue(n,s,k,this.context)}_setPaintValue(n,s,u,m){if(this.type==="color"){const h=dg(u.toRenderColor(m.lut));for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,h[0],h[1])}else{for(let h=n;h<s;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class aa{constructor(n,s,u,m,h,v){this.expression=n,this.uniformNames=s.map(T=>`u_${T}_t`),this.type=u,this.useIntegerZoom=m,this.context=h,this.maxValue=0,this.paintVertexAttributes=s.map(T=>({name:`a_${T}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,s,u,m,h,v,T){const k=this.expression.evaluate(new Zr(this.context.zoom,{brightness:v}),s,{},h,m,T),L=this.expression.evaluate(new Zr(this.context.zoom+1,{brightness:v}),s,{},h,m,T),x=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(x,n,k,L,this.context)}updatePaintArray(n,s,u,m,h,v,T){const k=this.expression.evaluate({zoom:this.context.zoom,brightness:T},u,m,void 0,h),L=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},u,m,void 0,h);this._setPaintValue(n,s,k,L,this.context)}_setPaintValue(n,s,u,m,h){if(this.type==="color"){const v=dg(u.toRenderColor(h.lut)),T=dg(u.toRenderColor(h.lut));for(let k=n;k<s;k++)this.paintVertexArray.emplace(k,v[0],v[1],T[0],T[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,u,m,h){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,T=gt(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);s.set(n,h,T)}getBinding(n,s){return new wi(n)}}class Qa{constructor(n,s,u,m,h){this.expression=n,this.layerId=h,this.paintVertexAttributes=(u==="array"?z1:O1).members;for(let v=0;v<s.length;++v);this.paintVertexArray=new m}populatePaintArray(n,s,u,m){const h=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(h,n,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(n,s,u,m,h,v,T){this._setPaintValues(n,s,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(n,s,u,m){if(!m||!u)return;const h=m[u];if(!h)return;const{tl:v,br:T,pixelRatio:k}=h;for(let L=n;L<s;L++)this.paintVertexArray.emplace(L,v[0],v[1],T[0],T[1],k)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class el{constructor(n,s,u=()=>!0){this.binders={},this._buffers=[],this.context=s;const m=[];for(const h in n.paint._values){const v=n.paint.get(h);if(!u(h)||!(v instanceof cu&&uc(v.property.specification)))continue;const T=N1(h,n.type),k=v.value,L=v.property.specification.type,x=!!v.property.useIntegerZoom,A=h==="line-dasharray"||h.endsWith("pattern"),D=h==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(k.kind!=="constant"||D)if(k.kind==="source"||D||A){const M=vy(h,L,"source");this.binders[h]=A?new Qa(k,T,L,M,n.id):new Ja(k,T,L,M),m.push(`/a_${h}`)}else{const M=vy(h,L,"composite");this.binders[h]=new aa(k,T,L,x,s,M),m.push(`/z_${h}`)}else this.binders[h]=A?new yu(k.value,T):new jd(k.value,T,L,s),m.push(`/u_${h}`)}this.cacheKey=m.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Ja||s instanceof aa?s.maxValue:0}populatePaintArrays(n,s,u,m,h,v,T){for(const k in this.binders){const L=this.binders[k];L.context=this.context,(L instanceof Ja||L instanceof aa||L instanceof Qa)&&L.populatePaintArray(n,s,u,m,h,v,T)}}setConstantPatternPositions(n){for(const s in this.binders){const u=this.binders[s];u instanceof yu&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,s,u,m,h,v,T,k){let L=!1;const x=Object.keys(n),A=x.length!==0,D=A?x:s.uniqueIds;this.context.lut=h.lut;for(const M in this.binders){const P=this.binders[M];if(P.context=this.context,(P instanceof Ja||P instanceof aa||P instanceof Qa)&&(P.expression.isStateDependent===!0||P.expression.isLightConstant===!1)){const B=h.paint.get(M);P.expression=B.value;for(const H of D){const Z=n[H.toString()];s.eachPosition(H,(te,ne,X)=>{const le=m.feature(te);P.updatePaintArray(ne,X,le,Z,v,T,k)})}if(!A)for(const H of u.uniqueIds){const Z=n[H.toString()];u.eachPosition(H,(te,ne,X)=>{const le=m.feature(te);P.updatePaintArray(ne,X,le,Z,v,T,k)})}L=!0}}return L}defines(){const n=[];for(const s in this.binders){const u=this.binders[s];(u instanceof jd||u instanceof yu)&&n.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Ja||u instanceof aa||u instanceof Qa)for(let m=0;m<u.paintVertexAttributes.length;m++)n.push(u.paintVertexAttributes[m].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof jd||u instanceof yu||u instanceof aa)for(const m of u.uniformNames)n.push(m)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const u in this.binders){const m=this.binders[u];if(m instanceof jd||m instanceof yu||m instanceof aa)for(const h of m.uniformNames)s.push({name:h,property:u,binding:m.getBinding(n,h)})}return s}setUniforms(n,s,u,m,h){for(const{name:v,property:T,binding:k}of u)this.binders[T].setUniform(n,k,h,m.get(T),v)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Ja||s instanceof aa||s instanceof Qa)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const u=this.binders[s];(u instanceof Ja||u instanceof aa||u instanceof Qa)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Ja||s instanceof aa||s instanceof Qa)&&s.destroy()}}}class Ea{constructor(n,s,u=()=>!0){this.programConfigurations={};for(const m of n)this.programConfigurations[m.id]=new el(m,s,u);this.needsUpload=!1,this._featureMap=new Vd,this._featureMapWithoutIds=new Vd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,s,u,m,h,v,T,k){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(n,s,m,h,v,T,k);s.id!==void 0?this._featureMap.add(s.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,u,m,h,v){for(const T of u)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,s,T,m,h,v||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const F1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function N1(c,n){return F1[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const $1={"line-pattern":{source:Ya,composite:Ya},"fill-pattern":{source:Ya,composite:Ya},"fill-extrusion-pattern":{source:Ya,composite:Ya},"line-dasharray":{source:Tf,composite:Tf}},V1={color:{source:Fd,composite:Za},number:{source:vu,composite:Fd}};function vy(c,n,s){const u=$1[c];return u&&u[s]||V1[n][s]}jn(jd,"ConstantBinder"),jn(yu,"PatternConstantBinder"),jn(Ja,"SourceExpressionBinder"),jn(Qa,"PatternCompositeBinder"),jn(aa,"CompositeExpressionBinder"),jn(el,"ProgramConfiguration",{omit:["_buffers"]}),jn(Ea,"ProgramConfigurationSet");const Oi=In/Math.PI/2,_y=5,f=6,r=16383,l=64,p=[l,32,16],b=-Oi,w=Oi;function C(c,n,s,u=Oi){return s=xt(s),[c*Math.sin(s)*u,-n*u,c*Math.cos(s)*u]}function O(c,n,s){return C(Math.cos(xt(c)),Math.sin(xt(c)),n,s)}const V=63710088e-1,G=2*Math.PI*V;class j{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new j(Vn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,u=this.lat*s,m=n.lat*s,h=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((n.lng-this.lng)*s);return V*Math.acos(Math.min(h,1))}toBounds(n=0){const s=360*n/40075017,u=s/Math.cos(Math.PI/180*this.lat);return new Y({lng:this.lng-u,lat:this.lat-s},{lng:this.lng+u,lat:this.lat+s})}toEcef(n){return O(this.lat,this.lng,Oi+n*Oi/V)}static convert(n){if(n instanceof j)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new j(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new j(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Y{constructor(n,s){if(n)if(s)this.setSouthWest(n).setNorthEast(s);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof j?new j(n.lng,n.lat):j.convert(n),this}setSouthWest(n){return this._sw=n instanceof j?new j(n.lng,n.lat):j.convert(n),this}extend(n){const s=this._sw,u=this._ne;let m,h;if(n instanceof j)m=n,h=n;else{if(!(n instanceof Y))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Y.convert(n)):this.extend(j.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(j.convert(n)):this;if(m=n._sw,h=n._ne,!m||!h)return this}return s||u?(s.lng=Math.min(m.lng,s.lng),s.lat=Math.min(m.lat,s.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new j(m.lng,m.lat),this._ne=new j(h.lng,h.lat)),this}getCenter(){return new j((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new j(this.getWest(),this.getNorth())}getSouthEast(){return new j(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:u}=j.convert(n);let m=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&m}static convert(n){if(n)return n instanceof Y?n:new Y(n)}}const Q=0,ie=25.5;function ve(c){return G*Math.cos(c*Math.PI/180)}function me(c){return(180+c)/360}function we(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function be(c,n){return c/ve(n)}function Pe(c){return 360*c-180}function $e(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Ve(c,n){return c*ve($e(n))}const We=85.051129;function Xe(c){return Math.cos(xt(gt(c,-We,We)))}function Ke(c,n){const s=gt(n,Q,ie),u=Math.pow(2,s);return Xe(c)*G/(512*u)}function Je(c){return 1/Math.cos(c*Math.PI/180)}function rt(c,n=0){const s=Math.exp(Math.PI*(1-(c.y+n/In)/(1<<c.z)*2));return 80150034*s/(s*s+1)/In/(1<<c.z)}class ht{constructor(n,s,u=0){this.x=+n,this.y=+s,this.z=+u}static fromLngLat(n,s=0){const u=j.convert(n);return new ht(me(u.lng),we(u.lat),be(s,u.lat))}toLngLat(){return new j(Pe(this.x),$e(this.y))}toAltitude(){return Ve(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/G*Je($e(this.y))}}function lt(c,n,s,u,m,h,v,T,k){const L=(n+u)/2,x=(s+m)/2,A=new Fe(L,x);T(A),function(D,M,P,B,H,Z){const te=P-H,ne=B-Z;return Math.abs((B-M)*te-(P-D)*ne)/Math.hypot(te,ne)}(A.x,A.y,h.x,h.y,v.x,v.y)>=k?(lt(c,n,s,L,x,h,A,T,k),lt(c,L,x,u,m,A,v,T,k)):c.push(v)}function st(c,n,s){let u=c[0],m=u.x,h=u.y;n(u);const v=[u];for(let T=1;T<c.length;T++){const k=c[T],{x:L,y:x}=k;n(k),lt(v,m,h,L,x,u,k,n,s),m=L,h=x,u=k}return v}function Lt(c,n,s,u){if(u(n,s)){const m=n.add(s)._mult(.5);Lt(c,n,m,u),Lt(c,m,s,u)}else c.push(s)}function Wt(c,n){let s=c[0];const u=[s];for(let m=1;m<c.length;m++){const h=c[m];Lt(u,s,h,n),s=h}return u}const ln=Math.pow(2,14)-1,yn=-ln-1;function Tn(c,n){const s=Math.round(c.x*n),u=Math.round(c.y*n);return c.x=gt(s,yn,ln),c.y=gt(u,yn,ln),(s<c.x||s>c.x+1||u<c.y||u>c.y+1)&&Mn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function wt(c,n,s){const u=c.loadGeometry(),m=c.extent,h=In/m;if(n&&s&&s.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:T,x:k,y:L,projection:x}=s,A=D=>{const M=Pe((n.x+D.x/m)/v),P=$e((n.y+D.y/m)/v),B=x.project(M,P);D.x=(B.x*T-k)*m,D.y=(B.y*T-L)*m};for(let D=0;D<u.length;D++)if(c.type!==1)u[D]=st(u[D],A,1);else{const M=[];for(const P of u[D])P.x<0||P.x>=m||P.y<0||P.y>=m||(A(P),M.push(P));u[D]=M}}for(const v of u)for(const T of v)Tn(T,h);return u}function on(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?wt(c):[]}}function Vt(c,n,s,u,m){c.emplaceBack(2*n+(u+1)/2,2*s+(m+1)/2)}function rn(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class hn{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new Rl,this.indexArray=new Gr,this.segments=new ti,this.programConfigurations=new Ea(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(n,s){}populate(n,s,u,m){const h=this.layers[0],v=[];let T=null;h.type==="circle"&&(T=h.layout.get("circle-sort-key"));for(const{feature:L,id:x,index:A,sourceLayerIndex:D}of n){const M=this.layers[0]._featureFilter.needGeometry,P=on(L,M);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom),P,u))continue;const B=T?T.evaluate(P,{},u):void 0,H={id:x,properties:L.properties,type:L.type,sourceLayerIndex:D,index:A,geometry:M?P.geometry:wt(L,u,m),patterns:{},sortKey:B};v.push(H)}T&&v.sort((L,x)=>L.sortKey-x.sortKey);let k=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new zd,k=m.projection);for(const L of v){const{geometry:x,index:A,sourceLayerIndex:D}=L,M=n[A].feature;this.addFeature(L,x,A,s.availableImages,u,k,s.brightness),s.featureIndex.insert(M,x,A,D,this.index)}}update(n,s,u,m,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,v?this.stateDependentLayers:this.layers,u,m,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,D1.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,L1.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,u,m,h,v,T){for(const k of s)for(const L of k){const x=L.x,A=L.y;if(x<0||x>=In||A<0||A>=In)continue;if(v){const P=v.projectTilePoint(x,A,h),B=v.upVector(h,x,A),H=this.globeExtVertexArray;rn(H,P,B),rn(H,P,B),rn(H,P,B),rn(H,P,B)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),M=D.vertexLength;Vt(this.layoutVertexArray,x,A,-1,-1),Vt(this.layoutVertexArray,x,A,1,-1),Vt(this.layoutVertexArray,x,A,1,1),Vt(this.layoutVertexArray,x,A,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+2,M+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},m,h,T)}}function nn(c,n){for(let s=0;s<c.length;s++)if(Go(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(Go(c,n[s]))return!0;return!!Hn(c,n)}function An(c,n,s){return!!Go(c,n)||!!Rn(n,c,s)}function Zn(c,n){if(c.length===1)return Io(n,c[0]);for(let s=0;s<n.length;s++){const u=n[s];for(let m=0;m<u.length;m++)if(Go(c,u[m]))return!0}for(let s=0;s<c.length;s++)if(Io(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(Hn(c,n[s]))return!0;return!1}function to(c,n,s){if(c.length>1){if(Hn(c,n))return!0;for(let u=0;u<n.length;u++)if(Rn(n[u],c,s))return!0}for(let u=0;u<c.length;u++)if(Rn(c[u],n,s))return!0;return!1}function Hn(c,n){if(c.length===0||n.length===0)return!1;for(let s=0;s<c.length-1;s++){const u=c[s],m=c[s+1];for(let h=0;h<n.length-1;h++)if(oo(u,m,n[h],n[h+1]))return!0}return!1}function oo(c,n,s,u){return yo(c,s,u)!==yo(n,s,u)&&yo(c,n,s)!==yo(c,n,u)}function Rn(c,n,s){const u=s*s;if(n.length===1)return c.distSqr(n[0])<u;for(let m=1;m<n.length;m++)if(ho(c,n[m-1],n[m])<u)return!0;return!1}function ho(c,n,s){const u=n.distSqr(s);if(u===0)return c.distSqr(n);const m=((c.x-n.x)*(s.x-n.x)+(c.y-n.y)*(s.y-n.y))/u;return c.distSqr(m<0?n:m>1?s:s.sub(n)._mult(m)._add(n))}function Io(c,n){let s,u,m,h=!1;for(let v=0;v<c.length;v++){s=c[v];for(let T=0,k=s.length-1;T<s.length;k=T++)u=s[T],m=s[k],u.y>n.y!=m.y>n.y&&n.x<(m.x-u.x)*(n.y-u.y)/(m.y-u.y)+u.x&&(h=!h)}return h}function Go(c,n){let s=!1;for(let u=0,m=c.length-1;u<c.length;m=u++){const h=c[u],v=c[m];h.y>n.y!=v.y>n.y&&n.x<(v.x-h.x)*(n.y-h.y)/(v.y-h.y)+h.x&&(s=!s)}return s}function Sr(c,n,s,u,m){for(const v of c)if(n<=v.x&&s<=v.y&&u>=v.x&&m>=v.y)return!0;const h=[new Fe(n,s),new Fe(n,m),new Fe(u,m),new Fe(u,s)];if(c.length>2){for(const v of h)if(Go(c,v))return!0}for(let v=0;v<c.length-1;v++)if(nr(c[v],c[v+1],h))return!0;return!1}function nr(c,n,s){const u=s[0],m=s[2];if(c.x<u.x&&n.x<u.x||c.x>m.x&&n.x>m.x||c.y<u.y&&n.y<u.y||c.y>m.y&&n.y>m.y)return!1;const h=yo(c,n,s[0]);return h!==yo(c,n,s[1])||h!==yo(c,n,s[2])||h!==yo(c,n,s[3])}function Dr(c,n,s,u,m,h){let v=n.y-c.y,T=c.x-n.x;if(h=h||0){const k=v*v+T*T;if(k===0)return!0;const L=Math.sqrt(k);v/=L,T/=L}return!((s.x-c.x)*v+(s.y-c.y)*T-h<0||(u.x-c.x)*v+(u.y-c.y)*T-h<0||(m.x-c.x)*v+(m.y-c.y)*T-h<0)}function ar(c,n,s,u,m,h,v){return!(Dr(c,n,u,m,h,v)||Dr(n,s,u,m,h,v)||Dr(s,c,u,m,h,v)||Dr(u,m,c,n,s,v)||Dr(m,h,c,n,s,v)||Dr(h,u,c,n,s,v))}function Tr(c,n,s){const u=n.paint.get(c).value;return u.kind==="constant"?u.value:s.programConfigurations.get(n.id).getMaxValue(c)}function Vo(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function yr(c,n,s,u,m){if(!n[0]&&!n[1])return c;const h=Fe.convert(n)._mult(m);s==="viewport"&&h._rotate(-u);const v=[];for(let T=0;T<c.length;T++)v.push(c[T].sub(h));return v}function _r(c,n,s,u){const m=Fe.convert(c)._mult(u);return n==="viewport"&&m._rotate(-s),m}let cr,Nr;jn(hn,"CircleBucket",{omit:["layers"]});var yi,As={exports:{}},js=(yi||(yi=1,function(c,n){(function(s){function u(h,v,T){var k=m(256*h,256*(v=Math.pow(2,T)-v-1),T),L=m(256*(h+1),256*(v+1),T);return k[0]+","+k[1]+","+L[0]+","+L[1]}function m(h,v,T){var k=2*Math.PI*6378137/256/Math.pow(2,T);return[h*k-2*Math.PI*6378137/2,v*k-2*Math.PI*6378137/2]}s.getURL=function(h,v,T,k,L,x){return x=x||{},h+"?"+["bbox="+u(T,k,L),"format="+(x.format||"image/png"),"service="+(x.service||"WMS"),"version="+(x.version||"1.1.1"),"request="+(x.request||"GetMap"),"srs="+(x.srs||"EPSG:3857"),"width="+(x.width||256),"height="+(x.height||256),"layers="+v].join("&")},s.getTileBBox=u,s.getMercCoords=m,Object.defineProperty(s,"__esModule",{value:!0})})(n)}(0,As.exports)),As.exports);class Si{constructor(n,s,u){this.z=n,this.x=s,this.y=u,this.key=lr(0,n,n,s,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const u=js.getTileBBox(this.x,this.y,this.z),m=function(h,v,T){let k,L="";for(let x=h;x>0;x--)k=1<<x-1,L+=(v&k?1:0)+(T&k?2:0);return L}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Qo{constructor(n,s){this.wrap=n,this.canonical=s,this.key=lr(n,s.z,s.z,s.x,s.y)}}class Zo{constructor(n,s,u,m,h){this.overscaledZ=n,this.wrap=s,this.canonical=new Si(u,+m,+h),this.key=s===0&&n===u?this.canonical.key:lr(s,n,u,m,h)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new Zo(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zo(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return lr(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return lr(this.wrap*+s,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new Zo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new Zo(s,this.wrap,s,u,m),new Zo(s,this.wrap,s,u+1,m),new Zo(s,this.wrap,s,u,m+1),new Zo(s,this.wrap,s,u+1,m+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Zo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Zo(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Qo(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function lr(c,n,s,u,m){const h=1<<Math.min(s,22);let v=h*(m%h)+u%h;return c&&s<22&&(v+=h*h*((c<0?-2*c-1:2*c)%(1<<2*(22-s)))),16*(32*v+s)+(n-s)}const Mr=[c=>{let n=c.canonical.x-1,s=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,s--),new Zo(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,s=c.wrap;return n===1<<c.canonical.z&&(n=0,s++),new Zo(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>new Zo(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new Zo(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];jn(Si,"CanonicalTileID"),jn(Zo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ni=sr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:$r}=ni,Ei=sr([{name:"a_pos_3",components:3,type:"Int16"}]);var Ma=sr([{name:"a_pos",type:"Int16",components:2}]);class us{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,u){const m=Be.vec3.dot(s,this.dir);if(Math.abs(m)<1e-6)return!1;const h=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/m;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(n,s,u){if(Be.vec3.equals(this.pos,n)||s===0)return u[0]=u[1]=u[2]=0,!1;const[m,h,v]=this.dir,T=this.pos[0]-n[0],k=this.pos[1]-n[1],L=this.pos[2]-n[2],x=m*m+h*h+v*v,A=2*(T*m+k*h+L*v),D=A*A-4*x*(T*T+k*k+L*L-s*s);if(D<0){const M=Math.max(-A/2,0),P=T+m*M,B=k+h*M,H=L+v*M,Z=Math.hypot(P,B,H);return u[0]=P*s/Z,u[1]=B*s/Z,u[2]=H*s/Z,!1}{const M=(-A-Math.sqrt(D))/(2*x);if(M<0){const P=Math.hypot(T,k,L);return u[0]=T*s/P,u[1]=k*s/P,u[2]=L*s/P,!1}return u[0]=T+m*M,u[1]=k+h*M,u[2]=L+v*M,!0}}}class ds{constructor(n,s,u,m,h){this.TL=n,this.TR=s,this.BR=u,this.BL=m,this.horizon=h}static fromInvProjectionMatrix(n,s,u){const m=[-1,1,1],h=[1,1,1],v=[1,-1,1],T=[-1,-1,1],k=Be.vec3.transformMat4(m,m,n),L=Be.vec3.transformMat4(h,h,n),x=Be.vec3.transformMat4(v,v,n),A=Be.vec3.transformMat4(T,T,n);return new ds(k,L,x,A,s/u)}}function Hs(c,n,s){let u=1/0,m=-1/0;const h=[];for(const v of c){Be.vec3.sub(h,v,n);const T=Be.vec3.dot(h,s);u=Math.min(u,T),m=Math.max(m,T)}return[u,m]}function la(c,n){let s=!0;for(let u=0;u<c.planes.length;u++){const m=c.planes[u];let h=0;for(let v=0;v<n.length;v++)h+=Be.vec3.dot(m,n[v])+m[3]>=0;if(h===0)return 0;h!==n.length&&(s=!1)}return s?2:1}function hs(c,n){for(const s of c.projections){const u=Hs(n,c.points[0],s.axis);if(s.projection[1]<u[0]||s.projection[0]>u[1])return 0}return 1}function tl(c,n){let s=0;const u=[0,0,0,0];for(let m=0;m<c.length;m++)u[0]=c[m][0],u[1]=c[m][1],u[2]=c[m][2],u[3]=1,Be.vec4.dot(u,n)>=0&&s++;return s}class Gs{constructor(n,s){this.points=n||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=hr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Be.vec3.sub([],this.points[2],this.points[3]),Be.vec3.sub([],this.points[0],this.points[3]),Be.vec3.sub([],this.points[4],this.points[0]),Be.vec3.sub([],this.points[5],this.points[1]),Be.vec3.sub([],this.points[6],this.points[2]),Be.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const m=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:m,projection:Hs(this.points,this.points[0],m)}),this.projections.push({axis:h,projection:Hs(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(n,s,u,m){const h=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>{const x=Be.vec4.transformMat4([],L,n),A=1/x[3]/s*h;return Be.vec4.mul(x,x,[A,A,m?1/x[3]:A,A])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(L=>{const x=Be.vec3.sub([],v[L[0]],v[L[1]]),A=Be.vec3.sub([],v[L[2]],v[L[1]]),D=Be.vec3.normalize([],Be.vec3.cross([],x,A)),M=-Be.vec3.dot(D,v[L[1]]);return D.concat(M)}),k=[];for(let L=0;L<v.length;L++)k.push([v[L][0],v[L][1],v[L][2]]);return new Gs(k,T)}intersectsPrecise(n,s,u){for(let m=0;m<s.length;m++)if(!tl(n,s[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!tl(n,this.planes[m]))return 0;for(const m of u)for(const h of this.frustumEdges){const v=Be.vec3.cross([],m,h),T=Be.vec3.length(v);if(T===0)continue;Be.vec3.scale(v,v,1/T);const k=Hs(this.points,this.points[0],v),L=Hs(n,this.points[0],v);if(k[0]>L[1]||L[0]>k[1])return 0}return 1}containsPoint(n){for(const s of this.planes){const u=s[3];if(Be.vec3.dot([s[0],s[1],s[2]],n)+u<0)return!1}return!0}}class hr{static fromPoints(n){const s=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const m of n)Be.vec3.min(s,s,m),Be.vec3.max(u,u,m);return new hr(s,u)}static fromTileIdAndHeight(n,s,u){const m=1<<n.canonical.z,h=n.canonical.x,v=n.canonical.y;return new hr([h/m,v/m,s],[(h+1)/m,(v+1)/m,u])}static applyTransform(n,s){const u=n.getCorners();for(let m=0;m<u.length;++m)Be.vec3.transformMat4(u[m],u[m],s);return hr.fromPoints(u)}static applyTransformFast(n,s){const u=[s[12],s[13],s[14]],m=[...u];for(let h=0;h<3;h++)for(let v=0;v<3;v++){const T=s[4*v+h],k=T*n.min[v],L=T*n.max[v];u[h]+=Math.min(k,L),m[h]+=Math.max(k,L)}return new hr(u,m)}static projectAabbCorners(n,s){const u=n.getCorners();for(let m=0;m<u.length;++m)Be.vec3.transformMat4(u[m],u[m],s);return u}constructor(n,s){this.min=n,this.max=s,this.center=Be.vec3.scale([],Be.vec3.add([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],u=Be.vec3.clone(this.min),m=Be.vec3.clone(this.max);for(let h=0;h<s.length;h++)u[h]=s[h]?this.min[h]:this.center[h],m[h]=s[h]?this.center[h]:this.max[h];return m[2]=this.max[2],new hr(u,m)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?la(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?la(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,s){return s||this.intersects(n)?hs(n,this.getCorners()):0}intersectsPreciseFlat(n,s){return s||this.intersectsFlat(n)?hs(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let s=0;s<3;++s)if(this.min[s]>n.max[s]||n.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n.min[s]),this.max[s]=Math.max(this.max[s],n.max[s])}encapsulatePoint(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n[s]),this.max[s]=Math.max(this.max[s],n[s])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function bu(c){return c*Oi/V}jn(hr,"Aabb");const hg=[new hr([b,b,b],[w,w,w]),new hr([b,b,b],[0,0,w]),new hr([0,b,b],[w,0,w]),new hr([b,0,b],[0,w,w]),new hr([0,0,b],[w,w,w])];function xu(c,n,s,u=!0){const m=Be.vec3.scale([],c._camera.position,c.worldSize),h=[n,s,1,1];Be.vec4.transformMat4(h,h,c.pixelMatrixInverse),Be.vec4.scale(h,h,1/h[3]);const v=Be.vec3.sub([],h,m),T=Be.vec3.normalize([],v),k=c.globeMatrix,L=[k[12],k[13],k[14]],x=Be.vec3.sub([],L,m),A=Be.vec3.length(x),D=Be.vec3.normalize([],x),M=c.worldSize/(2*Math.PI),P=Be.vec3.dot(D,T),B=Math.asin(M/A);if(B<Math.acos(P)){if(!u)return null;const ot=[],Oe=[];Be.vec3.scale(ot,T,A/P),Be.vec3.normalize(Oe,Be.vec3.sub(Oe,ot,x)),Be.vec3.normalize(T,Be.vec3.add(T,x,Be.vec3.scale(T,Oe,Math.tan(B)*A)))}const H=[];new us(m,T).closestPointOnSphere(L,M,H);const Z=Be.vec3.normalize([],_i(k,0)),te=Be.vec3.normalize([],_i(k,1)),ne=Be.vec3.normalize([],_i(k,2)),X=Be.vec3.dot(Z,H),le=Be.vec3.dot(te,H),pe=Be.vec3.dot(ne,H),Ce=Ot(Math.asin(-le/M));let Ue=Ot(Math.atan2(X,pe));Ue=c.center.lng+function(ot,Oe){const et=(Oe-ot+180)%360-180;return et<-180?et+360:et}(c.center.lng,Ue);const Le=me(Ue),ze=gt(we(Ce),0,1);return new ht(Le,ze)}class fg{constructor(n,s,u){this.a=Be.vec3.sub([],n,u),this.b=Be.vec3.sub([],s,u),this.center=u;const m=Be.vec3.normalize([],this.a),h=Be.vec3.normalize([],this.b);this.angle=Math.acos(Be.vec3.dot(m,h))}}function Hd(c,n){if(c.angle===0)return null;let s;return s=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),s<0||s>1?null:function(u,m,h,v){const T=Math.sin(h);return u*(Math.sin((1-v)*h)/T)+m*(Math.sin(v*h)/T)}(c.a[n],c.b[n],c.angle,gt(s,0,1))+c.center[n]}function Ol(c){if(c.z<=1)return hg[c.z+2*c.y+c.x];const n=U1(yy(c));return hr.fromPoints(n)}function _c(c,n,s){return Be.vec3.scale(c,c,1-s),Be.vec3.scaleAndAdd(c,c,n,s)}function xC(c,n,s){for(const u of c)Be.vec3.transformMat4(u,u,n),Be.vec3.scale(u,u,s)}function wC(c,n,s,u){const m=n/c.worldSize,h=c.globeMatrix;if(s.z<=1){const Le=Ol(s).getCorners();return xC(Le,h,m),hr.fromPoints(Le)}const v=yy(s,u),T=U1(v,Oi+bu(c._tileCoverLift));xC(T,h,m);const k=Number.MAX_VALUE,L=[-k,-k,-k],x=[k,k,k];if(v.contains(c.center)){for(const ot of T)Be.vec3.min(x,x,ot),Be.vec3.max(L,L,ot);L[2]=0;const Le=c.point,ze=[Le.x*m,Le.y*m,0];return Be.vec3.min(x,x,ze),Be.vec3.max(L,L,ze),new hr(x,L)}if(c._tileCoverLift>0){for(const Le of T)Be.vec3.min(x,x,Le),Be.vec3.max(L,L,Le);return new hr(x,L)}const A=[h[12]*m,h[13]*m,h[14]*m],D=v.getCenter(),M=gt(c.center.lat,-We,We),P=gt(D.lat,-We,We),B=me(c.center.lng),H=we(M);let Z=B-me(D.lng);const te=H-we(P);Z>.5?Z-=1:Z<-.5&&(Z+=1);let ne=0;if(Math.abs(Z)>Math.abs(te))ne=Z>=0?1:3;else{ne=te>=0?0:2;const Le=[h[4]*m,h[5]*m,h[6]*m],ze=-Math.sin(xt(te>=0?v.getSouth():v.getNorth()))*Oi;Be.vec3.scaleAndAdd(A,A,Le,ze)}const X=T[ne],le=T[(ne+1)%4],pe=new fg(X,le,A),Ce=[Hd(pe,0)||X[0],Hd(pe,1)||X[1],Hd(pe,2)||X[2]],Ue=wu(c.zoom);if(Ue>0){const Le=function({x:ot,y:Oe,z:et},ct,ut,_t,Mt){const kt=1/(1<<et);let St=ot*kt,Yt=St+kt,gn=Oe*kt,Ut=gn+kt,zn=0;const En=(St+Yt)/2-_t;return En>.5?zn=-1:En<-.5&&(zn=1),St=((St+zn)*ct-(_t*=ct))*ut+_t,Yt=((Yt+zn)*ct-_t)*ut+_t,gn=(gn*ct-(Mt*=ct))*ut+Mt,Ut=(Ut*ct-Mt)*ut+Mt,[[St,Ut,0],[Yt,Ut,0],[Yt,gn,0],[St,gn,0]]}(s,n,c._pixelsPerMercatorPixel,B,H);for(let ot=0;ot<T.length;ot++)_c(T[ot],Le[ot],Ue);const ze=Be.vec3.add([],Le[ne],Le[(ne+1)%4]);Be.vec3.scale(ze,ze,.5),_c(Ce,ze,Ue)}for(const Le of T)Be.vec3.min(x,x,Le),Be.vec3.max(L,L,Le);return x[2]=Math.min(X[2],le[2]),Be.vec3.min(x,x,Ce),Be.vec3.max(L,L,Ce),new hr(x,L)}function yy({x:c,y:n,z:s},u=!1){const m=1/(1<<s),h=new j(Pe(c*m),n===(1<<s)-1&&u?-90:$e((n+1)*m)),v=new j(Pe((c+1)*m),n===0&&u?90:$e(n*m));return new Y(h,v)}function U1(c,n=Oi){const s=xt(c.getNorth()),u=xt(c.getSouth()),m=Math.cos(s),h=Math.cos(u),v=Math.sin(s),T=Math.sin(u),k=c.getWest(),L=c.getEast();return[C(h,T,k,n),C(h,T,L,n),C(m,v,L,n),C(m,v,k,n)]}function pg(c,n,s,u){const m=1<<s.z,h=(c/In+s.x)/m;return O($e((n/In+s.y)/m),Pe(h),u)}function by({min:c,max:n}){return r/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const SC=new Float64Array(16);function xy(c){const n=by(c),s=Be.mat4.fromScaling(SC,[n,n,n]);return Be.mat4.translate(s,s,Be.vec3.negate([],c.min))}function j1(c){const n=Be.mat4.fromTranslation(SC,c.min),s=1/by(c);return Be.mat4.scale(n,n,[s,s,s])}function H1(c){const n=In/(2*Math.PI);return c/(2*Math.PI)/n}function TC(c,n){return In/(512*Math.pow(2,c))*by(Ol(n))}function CC(c,n,s,u,m){const h=H1(s),v=[c,n,-s/(2*Math.PI)],T=Be.mat4.identity(new Float64Array(16));return Be.mat4.translate(T,T,v),Be.mat4.scale(T,T,[h,h,h]),Be.mat4.rotateX(T,T,xt(-m)),Be.mat4.rotateY(T,T,xt(-u)),T}function wu(c){return Sn(_y,f,c)}function EC(c,n){const s=O(n.lat,n.lng),u=function(h){const v=O(h._center.lat,h._center.lng),T=Be.vec3.fromValues(0,1,0);let k=Be.vec3.cross([],T,v);const L=Be.mat4.fromRotation([],-h.angle,v);k=Be.vec3.transformMat4(k,k,L),Be.mat4.fromRotation(L,-h._pitch,k);const x=Be.vec3.normalize([],v);return Be.vec3.scale(x,x,bu(h.cameraToCenterDistance/h.pixelsPerMeter)),Be.vec3.transformMat4(x,x,L),Be.vec3.add([],v,x)}(c),m=Be.vec3.subtract([],u,s);return Be.vec3.angle(m,s)}function G1(c,n){return EC(c,n)>Math.PI/2*1.01}const MC=xt(85),V4=Math.cos(MC),U4=Math.sin(MC),j4=Be.mat4.create(),IC=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function AC(c,n,s,u,m,h,v,T,k){if(h&&c.queryGeometry.isAboveHorizon)return!1;h&&(k*=c.pixelToTileUnitsFactor);const L=c.tileID.canonical,x=s.projection.upVectorScale(L,s.center.lat,s.worldSize).metersToTile;for(const A of n)for(const D of A){const M=D.add(T),P=m&&s.elevation?s.elevation.exaggeration()*m.getElevationAt(M.x,M.y,!0):0,B=s.projection.projectTilePoint(M.x,M.y,L);if(P>0){const ne=s.projection.upVector(L,M.x,M.y);B.x+=ne[0]*x*P,B.y+=ne[1]*x*P,B.z+=ne[2]*x*P}const H=h?M:H4(B.x,B.y,B.z,u),Z=h?c.tilespaceRays.map(ne=>W4(ne,P)):c.queryGeometry.screenGeometry,te=Be.vec4.transformMat4([],[B.x,B.y,B.z,1],u);if(!v&&h?k*=te[3]/s.cameraToCenterDistance:v&&!h&&(k*=s.cameraToCenterDistance/te[3]),h){const ne=$e((D.y/In+L.y)/(1<<L.z));k/=s.projection.pixelsPerMeter(ne,1)/be(1,ne)}if(An(Z,H,k))return!0}return!1}function H4(c,n,s,u){const m=Be.vec4.transformMat4([],[c,n,s,1],u);return new Fe(m[0]/m[3],m[1]/m[3])}const kC=Be.vec3.fromValues(0,0,0),G4=Be.vec3.fromValues(0,0,1);function W4(c,n){const s=Be.vec3.create();return kC[2]=n,c.intersectsPlane(kC,G4,s),new Fe(s[0],s[1])}class PC extends hn{}let RC,DC,LC,OC;function zC(c,{width:n,height:s},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==n*s*u)throw new RangeError("mismatched image size")}else m=new Uint8Array(n*s*u);return c.width=n,c.height=s,c.data=m,c}function BC(c,n,s){const{width:u,height:m}=n;u===c.width&&m===c.height||(W1(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,m)},s,null),c.width=u,c.height=m,c.data=n.data)}function W1(c,n,s,u,m,h,v,T){if(m.width===0||m.height===0)return n;if(m.width>c.width||m.height>c.height||s.x>c.width-m.width||s.y>c.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>n.width||m.height>n.height||u.x>n.width-m.width||u.y>n.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const k=c.data,L=n.data,x=h===4&&T;for(let A=0;A<m.height;A++){const D=((s.y+A)*c.width+s.x)*h,M=((u.y+A)*n.width+u.x)*h;if(x)for(let P=0;P<m.width;P++){const B=D+P*h+3,H=M+P*h;L[H+0]=255,L[H+1]=255,L[H+2]=255,L[H+3]=k[B]}else if(v)for(let P=0;P<m.width;P++){const B=D+P*h,H=M+P*h,Z=k[B+3],te=new pr(k[B+0]/255*Z,k[B+1]/255*Z,k[B+2]/255*Z,Z).toRenderColor(v).toArray();L[H+0]=te[0],L[H+1]=te[1],L[H+2]=te[2],L[H+3]=te[3]}else for(let P=0;P<m.width*h;P++)L[M+P]=k[D+P]}return n}jn(PC,"HeatmapBucket",{omit:["layers"]});class Su{constructor(n,s){zC(this,n,1,s)}resize(n){BC(this,new Su(n),1)}clone(){return new Su({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,m,h){W1(n,s,u,m,h,1,null)}}class es{constructor(n,s){zC(this,n,4,s)}resize(n){BC(this,new es(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new es({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,m,h,v,T){W1(n,s,u,m,h,4,v,T)}}class FC{constructor(n,s){this.width=n.width,this.height=n.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function mg(c){const n={},s=c.resolution||256,u=c.clips?c.clips.length:1,m=c.image||new es({width:s,height:u}),h=(v,T,k)=>{n[c.evaluationKey]=k;const L=c.expression.evaluate(n);L&&(m.data[v+T+0]=Math.floor(255*L.r/L.a),m.data[v+T+1]=Math.floor(255*L.g/L.a),m.data[v+T+2]=Math.floor(255*L.b/L.a),m.data[v+T+3]=Math.floor(255*L.a))};if(c.clips)for(let v=0,T=0;v<u;++v,T+=4*s)for(let k=0,L=0;k<s;k++,L+=4){const x=k/(s-1),{start:A,end:D}=c.clips[v];h(T,L,A*(1-x)+D*x)}else for(let v=0,T=0;v<s;v++,T+=4)h(0,T,v/(s-1));return m}jn(Su,"AlphaImage"),jn(es,"RGBAImage");const q4=sr([{name:"a_pos",components:2,type:"Int16"}],4),{members:K4}=q4;function gg(c,n,s=2){const u=n&&n.length,m=u?n[0]*s:c.length;let h=NC(c,0,m,s,!0);const v=[];if(!h||h.next===h.prev)return v;let T,k,L;if(u&&(h=function(x,A,D,M){const P=[];for(let B=0,H=A.length;B<H;B++){const Z=NC(x,A[B]*M,B<H-1?A[B+1]*M:x.length,M,!1);Z===Z.next&&(Z.steiner=!0),P.push(nB(Z))}P.sort(Q4);for(let B=0;B<P.length;B++)D=eB(P[B],D);return D}(c,n,h,s)),c.length>80*s){T=1/0,k=1/0;let x=-1/0,A=-1/0;for(let D=s;D<m;D+=s){const M=c[D],P=c[D+1];M<T&&(T=M),P<k&&(k=P),M>x&&(x=M),P>A&&(A=P)}L=Math.max(x-T,A-k),L=L!==0?32767/L:0}return vg(h,v,s,T,k,L,0),v}function NC(c,n,s,u,m){let h;if(m===function(v,T,k,L){let x=0;for(let A=T,D=k-L;A<k;A+=L)x+=(v[D]-v[A])*(v[A+1]+v[D+1]),D=A;return x}(c,n,s,u)>0)for(let v=n;v<s;v+=u)h=UC(v/u|0,c[v],c[v+1],h);else for(let v=s-u;v>=n;v-=u)h=UC(v/u|0,c[v],c[v+1],h);return h&&wy(h,h.next)&&(yg(h),h=h.next),h}function Gd(c,n){if(!c)return c;n||(n=c);let s,u=c;do if(s=!1,u.steiner||!wy(u,u.next)&&Ti(u.prev,u,u.next)!==0)u=u.next;else{if(yg(u),u=n=u.prev,u===u.next)break;s=!0}while(s||u!==n);return n}function vg(c,n,s,u,m,h,v){if(!c)return;!v&&h&&function(k,L,x,A){let D=k;do D.z===0&&(D.z=q1(D.x,D.y,L,x,A)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==k);D.prevZ.nextZ=null,D.prevZ=null,function(M){let P,B=1;do{let H,Z=M;M=null;let te=null;for(P=0;Z;){P++;let ne=Z,X=0;for(let pe=0;pe<B&&(X++,ne=ne.nextZ,ne);pe++);let le=B;for(;X>0||le>0&&ne;)X!==0&&(le===0||!ne||Z.z<=ne.z)?(H=Z,Z=Z.nextZ,X--):(H=ne,ne=ne.nextZ,le--),te?te.nextZ=H:M=H,H.prevZ=te,te=H;Z=ne}te.nextZ=null,B*=2}while(P>1)}(D)}(c,u,m,h);let T=c;for(;c.prev!==c.next;){const k=c.prev,L=c.next;if(h?Y4(c,u,m,h):Z4(c))n.push(k.i,c.i,L.i),yg(c),c=L.next,T=L.next;else if((c=L)===T){v?v===1?vg(c=X4(Gd(c),n),n,s,u,m,h,2):v===2&&J4(c,n,s,u,m,h):vg(Gd(c),n,s,u,m,h,1);break}}}function Z4(c){const n=c.prev,s=c,u=c.next;if(Ti(n,s,u)>=0)return!1;const m=n.x,h=s.x,v=u.x,T=n.y,k=s.y,L=u.y,x=m<h?m<v?m:v:h<v?h:v,A=T<k?T<L?T:L:k<L?k:L,D=m>h?m>v?m:v:h>v?h:v,M=T>k?T>L?T:L:k>L?k:L;let P=u.next;for(;P!==n;){if(P.x>=x&&P.x<=D&&P.y>=A&&P.y<=M&&Of(m,T,h,k,v,L,P.x,P.y)&&Ti(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function Y4(c,n,s,u){const m=c.prev,h=c,v=c.next;if(Ti(m,h,v)>=0)return!1;const T=m.x,k=h.x,L=v.x,x=m.y,A=h.y,D=v.y,M=T<k?T<L?T:L:k<L?k:L,P=x<A?x<D?x:D:A<D?A:D,B=T>k?T>L?T:L:k>L?k:L,H=x>A?x>D?x:D:A>D?A:D,Z=q1(M,P,n,s,u),te=q1(B,H,n,s,u);let ne=c.prevZ,X=c.nextZ;for(;ne&&ne.z>=Z&&X&&X.z<=te;){if(ne.x>=M&&ne.x<=B&&ne.y>=P&&ne.y<=H&&ne!==m&&ne!==v&&Of(T,x,k,A,L,D,ne.x,ne.y)&&Ti(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,X.x>=M&&X.x<=B&&X.y>=P&&X.y<=H&&X!==m&&X!==v&&Of(T,x,k,A,L,D,X.x,X.y)&&Ti(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;ne&&ne.z>=Z;){if(ne.x>=M&&ne.x<=B&&ne.y>=P&&ne.y<=H&&ne!==m&&ne!==v&&Of(T,x,k,A,L,D,ne.x,ne.y)&&Ti(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;X&&X.z<=te;){if(X.x>=M&&X.x<=B&&X.y>=P&&X.y<=H&&X!==m&&X!==v&&Of(T,x,k,A,L,D,X.x,X.y)&&Ti(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function X4(c,n){let s=c;do{const u=s.prev,m=s.next.next;!wy(u,m)&&$C(u,s,s.next,m)&&_g(u,m)&&_g(m,u)&&(n.push(u.i,s.i,m.i),yg(s),yg(s.next),s=c=m),s=s.next}while(s!==c);return Gd(s)}function J4(c,n,s,u,m,h){let v=c;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&oB(v,T)){let k=VC(v,T);return v=Gd(v,v.next),k=Gd(k,k.next),vg(v,n,s,u,m,h,0),void vg(k,n,s,u,m,h,0)}T=T.next}v=v.next}while(v!==c)}function Q4(c,n){return c.x-n.x}function eB(c,n){const s=function(m,h){let v=h;const T=m.x,k=m.y;let L,x=-1/0;do{if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){const B=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(B<=T&&B>x&&(x=B,L=v.x<v.next.x?v:v.next,B===T))return L}v=v.next}while(v!==h);if(!L)return null;const A=L,D=L.x,M=L.y;let P=1/0;v=L;do{if(T>=v.x&&v.x>=D&&T!==v.x&&Of(k<M?T:x,k,D,M,k<M?x:T,k,v.x,v.y)){const B=Math.abs(k-v.y)/(T-v.x);_g(v,m)&&(B<P||B===P&&(v.x>L.x||v.x===L.x&&tB(L,v)))&&(L=v,P=B)}v=v.next}while(v!==A);return L}(c,n);if(!s)return n;const u=VC(s,c);return Gd(u,u.next),Gd(s,s.next)}function tB(c,n){return Ti(c.prev,c,n.prev)<0&&Ti(n.next,c,c.next)<0}function q1(c,n,s,u,m){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-s)*m|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*m|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function nB(c){let n=c,s=c;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==c);return s}function Of(c,n,s,u,m,h,v,T){return(m-v)*(n-T)>=(c-v)*(h-T)&&(c-v)*(u-T)>=(s-v)*(n-T)&&(s-v)*(h-T)>=(m-v)*(u-T)}function oB(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(s,u){let m=s;do{if(m.i!==s.i&&m.next.i!==s.i&&m.i!==u.i&&m.next.i!==u.i&&$C(m,m.next,s,u))return!0;m=m.next}while(m!==s);return!1}(c,n)&&(_g(c,n)&&_g(n,c)&&function(s,u){let m=s,h=!1;const v=(s.x+u.x)/2,T=(s.y+u.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&v<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(h=!h),m=m.next;while(m!==s);return h}(c,n)&&(Ti(c.prev,c,n.prev)||Ti(c,n.prev,n))||wy(c,n)&&Ti(c.prev,c,c.next)>0&&Ti(n.prev,n,n.next)>0)}function Ti(c,n,s){return(n.y-c.y)*(s.x-n.x)-(n.x-c.x)*(s.y-n.y)}function wy(c,n){return c.x===n.x&&c.y===n.y}function $C(c,n,s,u){const m=Ty(Ti(c,n,s)),h=Ty(Ti(c,n,u)),v=Ty(Ti(s,u,c)),T=Ty(Ti(s,u,n));return m!==h&&v!==T||!(m!==0||!Sy(c,s,n))||!(h!==0||!Sy(c,u,n))||!(v!==0||!Sy(s,c,u))||!(T!==0||!Sy(s,n,u))}function Sy(c,n,s){return n.x<=Math.max(c.x,s.x)&&n.x>=Math.min(c.x,s.x)&&n.y<=Math.max(c.y,s.y)&&n.y>=Math.min(c.y,s.y)}function Ty(c){return c>0?1:c<0?-1:0}function _g(c,n){return Ti(c.prev,c,c.next)<0?Ti(c,n,c.next)>=0&&Ti(c,c.prev,n)>=0:Ti(c,n,c.prev)<0||Ti(c,c.next,n)<0}function VC(c,n){const s=K1(c.i,c.x,c.y),u=K1(n.i,n.x,n.y),m=c.next,h=n.prev;return c.next=n,n.prev=c,s.next=m,m.prev=s,u.next=s,s.prev=u,h.next=u,u.prev=h,u}function UC(c,n,s,u){const m=K1(c,n,s);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function yg(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function K1(c,n,s){return{i:c,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Cy(c,n){const s=c.length;if(s<=1)return[c];const u=[];let m,h;for(let v=0;v<s;v++){const T=gr(c[v]);T!==0&&(c[v].area=Math.abs(T),h===void 0&&(h=T<0),h===T<0?(m&&u.push(m),m=[c[v]]):m.push(c[v]))}if(m&&u.push(m),n>1)for(let v=0;v<u.length;v++)u[v].length<=n||(y_(u[v],n,1,u[v].length-1,rB),u[v]=u[v].slice(0,n));return u}function rB(c,n){return n.area-c.area}function Z1(c,n,s){const u=s.patternDependencies;let m=!1;for(const h of n){const v=h.paint.get(`${c}-pattern`);v.isConstant()||(m=!0);const T=v.constantOr(null);T&&(m=!0,u[T]=!0)}return m}function Y1(c,n,s,u,m){const h=m.patternDependencies;for(const v of n){const T=v.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let k=T.evaluate({zoom:u},s,{},m.availableImages);k=k&&k.name?k.name:k,h[k]=!0,s.patterns[v.id]=k}}return s}class X1{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Rl,this.indexArray=new Gr,this.indexArray2=new Ll,this.programConfigurations=new Ea(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ti,this.segments2=new ti,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}updateFootprints(n,s){}populate(n,s,u,m){this.hasPattern=Z1("fill",this.layers,s);const h=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:T,id:k,index:L,sourceLayerIndex:x}of n){const A=this.layers[0]._featureFilter.needGeometry,D=on(T,A);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom),D,u))continue;const M=h?h.evaluate(D,{},u,s.availableImages):void 0,P={id:k,properties:T.properties,type:T.type,sourceLayerIndex:x,index:L,geometry:A?D.geometry:wt(T,u,m),patterns:{},sortKey:M};v.push(P)}h&&v.sort((T,k)=>T.sortKey-k.sortKey);for(const T of v){const{geometry:k,index:L,sourceLayerIndex:x}=T;if(this.hasPattern){const A=Y1("fill",this.layers,T,this.zoom,s);this.patternFeatures.push(A)}else this.addFeature(T,k,L,u,{},s.availableImages,s.brightness);s.featureIndex.insert(n[L].feature,k,L,x,this.index)}}update(n,s,u,m,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,v?this.stateDependentLayers:this.layers,u,m,h)}addFeatures(n,s,u,m,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,u,m,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,K4),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,u,m,h,v=[],T){for(const k of Cy(s,500)){let L=0;for(const B of k)L+=B.length;const x=this.segments.prepareSegment(L,this.layoutVertexArray,this.indexArray),A=x.vertexLength,D=[],M=[];for(const B of k){if(B.length===0)continue;B!==k[0]&&M.push(D.length/2);const H=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),Z=H.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(Z+B.length-1,Z),D.push(B[0].x),D.push(B[0].y);for(let te=1;te<B.length;te++)this.layoutVertexArray.emplaceBack(B[te].x,B[te].y),this.indexArray2.emplaceBack(Z+te-1,Z+te),D.push(B[te].x),D.push(B[te].y);H.vertexLength+=B.length,H.primitiveLength+=B.length}const P=gg(D,M);for(let B=0;B<P.length;B+=3)this.indexArray.emplaceBack(A+P[B],A+P[B+1],A+P[B+2]);x.vertexLength+=L,x.primitiveLength+=P.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,m,T)}}let jC,HC,GC,WC;jn(X1,"FillBucket",{omit:["layers","patternFeatures"]});class J1{constructor(n,s,u,m){if(this.triangleCount=s.length/3,this.min=new Fe(0,0),this.max=new Fe(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[h,v]=[n[0].clone(),n[0].clone()];for(let A=1;A<n.length;++A){const D=n[A];h.x=Math.min(h.x,D.x),h.y=Math.min(h.y,D.y),v.x=Math.max(v.x,D.x),v.y=Math.max(v.y,D.y)}if(m){const A=Math.ceil(Math.max(v.x-h.x,v.y-h.y)/m);u=Math.max(u,A)}if(u===0)return;this.min=h,this.max=v;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const k=Math.max(T.x,T.y)/u;this.cellsX=Math.max(1,Math.ceil(T.x/k)),this.cellsY=Math.max(1,Math.ceil(T.y/k)),this.xScale=1/k,this.yScale=1/k;const L=[];for(let A=0;A<this.triangleCount;A++){const D=n[s[3*A+0]].sub(this.min),M=n[s[3*A+1]].sub(this.min),P=n[s[3*A+2]].sub(this.min),B=zl(Math.floor(Math.min(D.x,M.x,P.x)),this.xScale,this.cellsX),H=zl(Math.floor(Math.max(D.x,M.x,P.x)),this.xScale,this.cellsX),Z=zl(Math.floor(Math.min(D.y,M.y,P.y)),this.yScale,this.cellsY),te=zl(Math.floor(Math.max(D.y,M.y,P.y)),this.yScale,this.cellsY),ne=new Fe(0,0),X=new Fe(0,0),le=new Fe(0,0),pe=new Fe(0,0);for(let Ce=Z;Ce<=te;++Ce){ne.y=X.y=Ce*k,le.y=pe.y=(Ce+1)*k;for(let Ue=B;Ue<=H;++Ue)ne.x=le.x=Ue*k,X.x=pe.x=(Ue+1)*k,(ar(D,M,P,ne,X,pe)||ar(D,M,P,ne,pe,le))&&L.push({cellIdx:Ce*this.cellsX+Ue,triIdx:A})}}if(L.length===0)return;L.sort((A,D)=>A.cellIdx-D.cellIdx||A.triIdx-D.triIdx);let x=0;for(;x<L.length;){const A=L[x].cellIdx,D={start:this.payload.length,len:0};for(;x<L.length&&L[x].cellIdx===A;)++D.len,this.payload.push(L[x++].triIdx);this.cells[A]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,s){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=zl(n.x-this.min.x,this.xScale,this.cellsX),m=zl(n.y-this.min.y,this.yScale,this.cellsY),h=this.cells[m*this.cellsX+u];if(h){this._lazyInitLookup();for(let v=0;v<h.len;v++){const T=this.payload[h.start+v],k=Math.floor(T/8),L=1<<T%8;if(!(this.lookup[k]&L)&&(this.lookup[k]|=L,s.push(T),s.length===this.triangleCount))return}}}query(n,s,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>s.x||n.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const m=zl(n.x-this.min.x,this.xScale,this.cellsX),h=zl(s.x-this.min.x,this.xScale,this.cellsX),v=zl(n.y-this.min.y,this.yScale,this.cellsY),T=zl(s.y-this.min.y,this.yScale,this.cellsY);for(let k=v;k<=T;k++)for(let L=m;L<=h;L++){const x=this.cells[k*this.cellsX+L];if(x)for(let A=0;A<x.len;A++){const D=this.payload[x.start+A],M=Math.floor(D/8),P=1<<D%8;if(!(this.lookup[M]&P)&&(this.lookup[M]|=P,u.push(D),u.length===this.triangleCount))return}}}}function zl(c,n,s){return Math.max(0,Math.min(s-1,Math.floor(c*n)))}jn(J1,"TriangleGridIndex");class qC{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(n,s){for(const u of this.footprints)s.push({footprint:u,id:n})}populate(n,s,u,m){const h=[];for(const{feature:v,id:T,index:k,sourceLayerIndex:L}of n){const x=this.layers[0]._featureFilter.needGeometry,A=on(v,x);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom),A,u))continue;const D={id:T,properties:v.properties,type:v.type,sourceLayerIndex:L,index:k,geometry:x?A.geometry:wt(v,u,m),patterns:{}};h.push(D)}for(const v of h){const{geometry:T,index:k,sourceLayerIndex:L}=v;this.addFeature(v,T,k,u,{},s.availableImages,s.brightness),s.featureIndex.insert(n[k].feature,T,k,L,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,s,u,m,h){}destroy(){}addFeature(n,s,u,m,h,v=[],T){for(const k of Cy(s,2)){const L=[],x=[],A=[],D=new Fe(1/0,1/0),M=new Fe(-1/0,-1/0);for(const H of k)if(H.length!==0){H!==k[0]&&A.push(x.length/2);for(let Z=0;Z<H.length;Z++)x.push(H[Z].x),x.push(H[Z].y),L.push(H[Z]),D.x=Math.min(D.x,H[Z].x),D.y=Math.min(D.y,H[Z].y),M.x=Math.max(M.x,H[Z].x),M.y=Math.max(M.y,H[Z].y)}const P=gg(x,A),B=new J1(L,P,8,256);this.footprints.push({vertices:L,indices:P,grid:B,min:D,max:M})}}}jn(qC,"ClipBucket",{omit:["layers"]});const iB=sr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),sB=sr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),aB=sr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),lB=sr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),cB=sr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),uB=sr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:dB}=iB;var Q1,KC,ex,ZC,tx,YC,XC,Ey={};function JC(){if(KC)return Q1;KC=1;var c=Ge();function n(m,h,v,T,k){this.properties={},this.extent=v,this.type=0,this._pbf=m,this._geometry=-1,this._keys=T,this._values=k,m.readFields(s,this,h)}function s(m,h,v){m==1?h.id=v.readVarint():m==2?function(T,k){for(var L=T.readVarint()+T.pos;T.pos<L;){var x=k._keys[T.readVarint()],A=k._values[T.readVarint()];k.properties[x]=A}}(v,h):m==3?h.type=v.readVarint():m==4&&(h._geometry=v.pos)}function u(m){for(var h,v,T=0,k=0,L=m.length,x=L-1;k<L;x=k++)T+=((v=m[x]).x-(h=m[k]).x)*(h.y+v.y);return T}return Q1=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,v=m.readVarint()+m.pos,T=1,k=0,L=0,x=0,A=[];m.pos<v;){if(k<=0){var D=m.readVarint();T=7&D,k=D>>3}if(k--,T===1||T===2)L+=m.readSVarint(),x+=m.readSVarint(),T===1&&(h&&A.push(h),h=[]),h.push(new c(L,x));else{if(T!==7)throw new Error("unknown command "+T);h&&h.push(h[0].clone())}}return h&&A.push(h),A},n.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,v=1,T=0,k=0,L=0,x=1/0,A=-1/0,D=1/0,M=-1/0;m.pos<h;){if(T<=0){var P=m.readVarint();v=7&P,T=P>>3}if(T--,v===1||v===2)(k+=m.readSVarint())<x&&(x=k),k>A&&(A=k),(L+=m.readSVarint())<D&&(D=L),L>M&&(M=L);else if(v!==7)throw new Error("unknown command "+v)}return[x,D,A,M]},n.prototype.toGeoJSON=function(m,h,v){var T,k,L=this.extent*Math.pow(2,v),x=this.extent*m,A=this.extent*h,D=this.loadGeometry(),M=n.types[this.type];function P(Z){for(var te=0;te<Z.length;te++){var ne=Z[te];Z[te]=[360*(ne.x+x)/L-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+A)/L)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(T=0;T<D.length;T++)B[T]=D[T][0];P(D=B);break;case 2:for(T=0;T<D.length;T++)P(D[T]);break;case 3:for(D=function(Z){var te=Z.length;if(te<=1)return[Z];for(var ne,X,le=[],pe=0;pe<te;pe++){var Ce=u(Z[pe]);Ce!==0&&(X===void 0&&(X=Ce<0),X===Ce<0?(ne&&le.push(ne),ne=[Z[pe]]):ne.push(Z[pe]))}return ne&&le.push(ne),le}(D),T=0;T<D.length;T++)for(k=0;k<D[T].length;k++)P(D[T][k])}D.length===1?D=D[0]:M="Multi"+M;var H={type:"Feature",geometry:{type:M,coordinates:D},properties:this.properties};return"id"in this&&(H.id=this.id),H},Q1}function QC(){if(ZC)return ex;ZC=1;var c=JC();function n(u,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(s,this,m),this.length=this._features.length}function s(u,m,h){u===15?m.version=h.readVarint():u===1?m.name=h.readString():u===5?m.extent=h.readVarint():u===2?m._features.push(h.pos):u===3?m._keys.push(h.readString()):u===4&&m._values.push(function(v){for(var T=null,k=v.readVarint()+v.pos;v.pos<k;){var L=v.readVarint()>>3;T=L===1?v.readString():L===2?v.readFloat():L===3?v.readDouble():L===4?v.readVarint64():L===5?v.readVarint():L===6?v.readSVarint():L===7?v.readBoolean():null}return T}(h))}return ex=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var m=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,m,this.extent,this._keys,this._values)},ex}function eE(){return XC||(XC=1,Ey.VectorTile=function(){if(YC)return tx;YC=1;var c=QC();function n(s,u,m){if(s===3){var h=new c(m,m.readVarint()+m.pos);h.length&&(u[h.name]=h)}}return tx=function(s,u){this.layers=s.readFields(n,{},u)},tx}(),Ey.VectorTileFeature=JC(),Ey.VectorTileLayer=QC()),Ey}var zf=eE();class Wd extends Fe{constructor(n,s,u){super(n,s),this.z=u}}class tE extends Wd{constructor(n,s,u,m){super(n,s,u),this.w=m}}function My(c,n,s,u){const m=[],h=u===0?(v,T,k,L,x,A)=>{v.push(new Fe(A,k+(A-T)/(L-T)*(x-k)))}:(v,T,k,L,x,A)=>{v.push(new Fe(T+(A-k)/(x-k)*(L-T),A))};for(const v of c){const T=[];for(const k of v){if(k.length<=2)continue;const L=[];for(let D=0;D<k.length-1;D++){const M=k[D].x,P=k[D].y,B=k[D+1].x,H=k[D+1].y,Z=u===0?M:P,te=u===0?B:H;Z<n?te>n&&h(L,M,P,B,H,n):Z>s?te<s&&h(L,M,P,B,H,s):L.push(k[D]),te<n&&Z>=n&&h(L,M,P,B,H,n),te>s&&Z<=s&&h(L,M,P,B,H,s)}let x=k[k.length-1];const A=u===0?x.x:x.y;A>=n&&A<=s&&L.push(x),L.length&&(x=L[L.length-1],L[0].x===x.x&&L[0].y===x.y||L.push(L[0]),T.push(L))}T.length&&m.push(T)}return m}function nE(c,n,s,u){const m=s==="x"?"y":"x",h=(u-c[s])/(n[s]-c[s]);c[m]=c[m]+(n[m]-c[m])*h,c[s]=u,c.hasOwnProperty("z")&&(c.z=mo(c.z,n.z,h)),c.hasOwnProperty("w")&&(c.w=mo(c.w,n.w,h))}function oE(c,n,s,u){const m=s,h=u;for(const v of["x","y"]){let T=c,k=n;T[v]>=k[v]&&(T=n,k=c),T[v]<m&&k[v]>m&&nE(T,k,v,m),T[v]<h&&k[v]>h&&nE(k,T,v,h)}}const Iy=Number.MAX_SAFE_INTEGER;function rE(c,n,s,u){return c.order<n||c.order===Iy||!(c.clipMask&s)||function(m,h){return h.length!==0&&h.find(v=>v===m)===void 0}(u,c.clipScope)}function Ay(c,n){return c.x-n.x||c.y-n.y}function iE(c,n){return Ay(c.min,n.min)===0&&Ay(c.max,n.max)===0}function nx(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function ox(c,n){if(c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(c[s].sourceId!==n[s].sourceId||!iE(c[s],n[s])||c[s].order!==n[s].order||c[s].clipMask!==n[s].clipMask||!Nt(c[s].clipScope,n[s].clipScope))return!1;return!0}function sE(c,n,s){const u=1/In,m=1/(1<<s.canonical.z),h=(n.x*u+s.canonical.x)*m+s.wrap,v=(n.y*u+s.canonical.y)*m;return{min:new Fe((c.x*u+s.canonical.x)*m+s.wrap,(c.y*u+s.canonical.y)*m),max:new Fe(h,v)}}function hB(c,n,s){const u=1<<s.canonical.z,m=((n.x-s.wrap)*u-s.canonical.x)*In,h=(n.y*u-s.canonical.y)*In;return{min:new Fe(((c.x-s.wrap)*u-s.canonical.x)*In,(c.y*u-s.canonical.y)*In),max:new Fe(m,h)}}function aE(c,n,s,u,m,h,v){const T=c.indices,k=c.vertices,L=[];for(let x=u;x<u+m;x+=3){const A=n[s[x+0]+h],D=n[s[x+1]+h],M=n[s[x+2]+h],P=Math.min(A.x,D.x,M.x),B=Math.max(A.x,D.x,M.x),H=Math.min(A.y,D.y,M.y),Z=Math.max(A.y,D.y,M.y);L.length=0,c.grid.query(new Fe(P,H),new Fe(B,Z),L);for(let te=0;te<L.length;te++){const ne=L[te];if(ar(k[T[3*ne+0]],k[T[3*ne+1]],k[T[3*ne+2]],A,D,M,v))return!0}}return!1}function lE(c,n,s,u){if(!c||!s)return!1;let m=c.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(s.vertices.length<c.vertices.length)return lE(s,u,c,n);const h=n.canonical,v=u.canonical,T=Math.pow(2,v.z-h.z);m=c.vertices.map(k=>new Fe((k.x+h.x*In)*T-v.x*In,(k.y+h.y*In)*T-v.y*In))}return aE(s,m,c.indices,0,c.indices.length,0,0)}function cE(c,n,s,u){const m=Math.pow(2,u.z-s.z);return new Fe((c+s.x*In)*m-u.x*In,(n+s.y*In)*m-u.y*In)}function uE(c,n){const s=[];n.grid.queryPoint(c,s);const u=n.indices,m=n.vertices;for(let h=0;h<s.length;h++){const v=s[h];if(Go([m[u[3*v+0]],m[u[3*v+1]],m[u[3*v+2]]],c))return!0}return!1}const rx=[new Fe(0,0),new Fe(In,0),new Fe(In,In),new Fe(0,In)];function dE(c,n){const s=[];let u=[];if(!n||c.length<2)return[c];if(c.length===2)return nr(c[0],c[1],rx)?[c]:[];for(let m=0;m<c.length+2;m++){const h=c[m%c.length],v=c[(m+1)%c.length],T=nr(m===0?c[c.length-1]:c[(m-1)%c.length],h,rx),k=nr(h,v,rx),L=T||k;L&&u.push(h),L&&k||u.length>0&&(u.length>1&&s.push(u),u=[])}return u.length>1&&s.push(u),s}const ix=zf.VectorTileFeature.types,fB=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],pB=["fill-extrusion-flood-light-ground-radius"],mB=Math.pow(2,13),gB=Math.pow(2,15)-1,hE=new Fe(0,1),Tu=2147483648;function bg(c,n,s,u,m,h,v,T){c.emplaceBack((n<<1)+v,(s<<1)+h,(Math.floor(u*mB)<<1)+m,Math.round(T))}function xg(c,n,s){c.emplaceBack(n.x*In,n.y*In,s?1:0)}function ky(c,n,s,u,m,h){c.emplaceBack(n.x,n.y,(s.x<<1)+u,(s.y<<1)+m,h)}function wg(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class fE{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class pE{constructor(){this.centroidXY=new Fe(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Fe(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Fe(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Fe(this.max.x-this.min.x,this.max.y-this.min.y)}}class mE{constructor(){this.acc=new Fe(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,s){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=s.x,n.min.y=n.max.y=s.y)}appendEdge(n,s,u){this.accCount++,this.acc._add(s);let m=!!this.borders;s.x<n.min.x?(n.min.x=s.x,m=!0):s.x>n.max.x&&(n.max.x=s.x,m=!0),s.y<n.min.y?(n.min.y=s.y,m=!0):s.y>n.max.y&&(n.max.y=s.y,m=!0),((s.x===0||s.x===In)&&s.x===u.x)!=((s.y===0||s.y===In)&&s.y===u.y)&&this.processBorderOverlap(s,u),m&&this.checkBorderIntersection(s,u)}checkBorderIntersection(n,s){s.x<0!=n.x<0&&this.addBorderIntersection(0,mo(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>In!=n.x>In&&this.addBorderIntersection(1,mo(s.y,n.y,(In-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,mo(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>In!=n.y>In&&this.addBorderIntersection(3,mo(s.x,n.x,(In-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];s<u[0]&&(u[0]=s),s>u[1]&&(u[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,s.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,s.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new Fe(0,0):new Fe(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0):0}}function gE(c,n){const s=c.add(n)._unit(),u=gt(c.x*s.x+c.y*s.y,-1,1);var m,h,v;return v=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(v)))/4*gB*((m=c).x*(h=n).y-m.y*h.x<0?-1:1)}const vB=[c=>c.x<0,c=>c.x>In,c=>c.y<0,c=>c.y>In];function _B(c,n,s,u){const m=[4];if(u===0)return m;s._mult(u);const h=c.sub(s),v=n.sub(s),T=[c,n,h,v];for(let k=0;k<4;k++)for(const L of T)if(vB[k](L)){m.push(k);break}return m}class vE{constructor(n){this.vertexArray=new Qm,this.indexArray=new Gr,this.programConfigurations=new Ea(n.layers,{zoom:n.zoom,lut:n.lut},s=>pB.includes(s)),this._segments=new ti,this.hiddenByLandmarkVertexArray=new Af,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ti}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,s,u,m=!1){const h=n.length;if(h>2){let v=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let k;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const L=n[0],x=n[1];k=gE(L.sub(n[h-1])._perp()._unit(),x.sub(L)._perp()._unit())}for(let L=0;L<h;L++){const x=L===h-1?0:L+1,A=n[L],D=n[x],M=n[x===h-1?0:x+1],P=D.sub(A)._perp()._unit(),B=gE(P,M.sub(D)._perp()._unit()),H=k,Z=B;if(sx(A,D,s)||m&&bE(A,s)&&bE(D,s)){k=B;continue}const te=T.vertexLength;ky(this.vertexArray,A,D,1,1,H),ky(this.vertexArray,A,D,1,0,H),ky(this.vertexArray,A,D,0,1,Z),ky(this.vertexArray,A,D,0,0,Z),T.vertexLength+=4;const ne=_B(A,D,P,u);for(const X of ne)this._segmentToGroundQuads[v].push({id:te,region:X}),this._segmentToRegionTriCounts[v][X]+=2,T.primitiveLength+=2;k=B}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),s=n.length;for(let u=0;u<s;u++)this._segmentToGroundQuads[u].sort((m,h)=>m.region-h.region);for(let u=0;u<s;u++){const m=this._segmentToGroundQuads[u],h=n[u],v=this._segmentToRegionTriCounts[u];v.reduce((k,L)=>k+L,0);let T=0;for(let k=0;k<=4;k++){const L=v[k];if(L!==0){let x=this.regionSegments[k];x||(x=this.regionSegments[k]=new ti);const A={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+T,vertexLength:h.vertexLength,primitiveLength:L};x.get().push(A)}T+=L}for(let k=0;k<m.length;k++){const L=m[k].id;this.indexArray.emplaceBack(L,L+1,L+3),this.indexArray.emplaceBack(L,L+3,L+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,s,u,m,h,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,s,u,m,h,v)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,sB.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,s,u,m,h,v){this.hasData()&&this.programConfigurations.updatePaintArrays(n,s,u,m,h,v)}updateHiddenByLandmark(n){if(!this.hasData())return;const s=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&Tu?1:0;for(let m=n.groundVertexArrayOffset;m<s;++m)this.hiddenByLandmarkVertexArray.emplace(m,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,cB.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const s=this.regionSegments[n];s&&s.destroy()}}}}class Py{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Gr,this.footprintVertices=new Rl,this.footprintSegments=[],this.layoutVertexArray=new hu,this.centroidVertexArray=new dy,this.wallVertexArray=new lg,this.indexArray=new Gr,this.programConfigurations=new Ea(n.layers,{zoom:n.zoom,lut:n.lut},s=>fB.includes(s)),this.segments=new ti,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new vE(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,s){}populate(n,s,u,m){this.features=[],this.hasPattern=Z1("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=rt(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:v,index:T,sourceLayerIndex:k}of n){const L=this.layers[0]._featureFilter.needGeometry,x=on(h,L);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom),x,u))continue;const A={id:v,sourceLayerIndex:k,index:T,geometry:L?x.geometry:wt(h,u,m),properties:h.properties,type:h.type,patterns:{}},D=this.layoutVertexArray.length,M=ix[A.type]==="Polygon";if(this.hasPattern)this.features.push(Y1("fill-extrusion",this.layers,A,this.zoom,s));else if(this.wallMode)for(const P of A.geometry)for(const B of dE(P,M))this.addFeature(A,[B],T,u,{},s.availableImages,m,s.brightness);else this.addFeature(A,A.geometry,T,u,{},s.availableImages,m,s.brightness);s.featureIndex.insert(h,A.geometry,T,k,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,s,u,m,h,v){for(const T of this.features){const k=ix[T.type]==="Polygon",{geometry:L}=T;if(this.wallMode)for(const x of L)for(const A of dE(x,k))this.addFeature(T,[A],T.index,s,u,m,h,v);else this.addFeature(T,L,T.index,s,u,m,h,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,s,u,m,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(n,s,T,u,m,h),this.groundEffect.update(n,s,T,u,m,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,dB),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,lB.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,uB.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,aB.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,u,m,h,v,T,k){const L=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,x=[new Fe(0,0),new Fe(In,In)],A=T.projection,D=A.name==="globe",M=this.wallMode||ix[n.type]==="Polygon",P=new mE;P.centroidDataIndex=this.centroidData.length;const B=new pE,H=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},m)<=0,Z=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},m);let te;if(B.height=Z,B.vertexArrayOffset=this.layoutVertexArray.length,B.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new zd),this.wallMode){if(D)return void Mn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;te=function(ze){const ot=ze[0].x===ze[ze.length-1].x&&ze[0].y===ze[ze.length-1].y;(function(xn){let pn=0;const no=xn.length;for(let Ln=0;Ln<no;Ln++)pn+=(xn[(Ln+1)%no].x-xn[Ln].x)*(xn[(Ln+1)%no].y+xn[Ln].y);return pn>=0})(ze)||(ze=ze.reverse());const et={geometry:[],joinNormals:[],indices:[]},ct=[],ut=[],_t=[];let Mt=ze.length;if(Mt<(ot?3:2))return et;for(;Mt>=2&&ze[Mt-1].equals(ze[Mt-2]);)Mt--;let kt,St,Yt,gn,Ut,zn=0;for(;zn<Mt-1&&ze[zn].equals(ze[zn+1]);)zn++;ot&&(kt=ze[Mt-2],Ut=ze[zn].sub(kt)._unit()._perp());for(let xn=zn;xn<Mt;xn++){if(Yt=xn===Mt-1?ot?ze[zn+1]:void 0:ze[xn+1],Yt&&ze[xn].equals(Yt))continue;Ut&&(gn=Ut),kt&&(St=kt),kt=ze[xn],Ut=Yt?Yt.sub(kt)._unit()._perp():gn,gn=gn||Ut;let pn=gn.add(Ut);pn.x===0&&pn.y===0||pn._unit();const no=pn.x*Ut.x+pn.y*Ut.y,Ln=no!==0?1/no:1/0,Gn=gn.x*Ut.y-gn.y*Ut.x>0;let wo="miter";const Do=2;wo==="miter"&&Ln>Do&&(wo="bevel"),wo==="bevel"&&(Ln>100&&(wo="flipbevel"),Ln<Do&&(wo="miter"));const zo=(Ao,Uo,No,Ir)=>{const br=new Fe(Ao.x,Ao.y),go=new Fe(Ao.x,Ao.y);br.x+=Uo.x*Ir,br.y+=Uo.y*Ir,go.x-=Uo.x*Math.max(No,1),go.y-=Uo.y*Math.max(No,1),_t.push(Uo),ct.push(br),ut.push(go)};if(wo==="miter")pn._mult(Ln),zo(kt,pn,0,0);else if(wo==="flipbevel")pn=Ut.mult(-1),zo(kt,pn,0,0),zo(kt,pn.mult(-1),0,0);else{const Ao=-Math.sqrt(Ln*Ln-1),Uo=Gn?Ao:0,No=Gn?0:Ao;St&&zo(kt,gn,Uo,No),Yt&&zo(kt,Ut,Uo,No)}}et.geometry=[...ct,...ut.reverse(),ct[0]],et.joinNormals=[..._t,..._t.reverse(),_t[_t.length-1]];const En=et.geometry.length-1;for(let xn=0;xn<En/2;xn++)if(xn+1<En/2){let pn=xn,no=xn+1,Ln=En-1-xn,Gn=En-2-xn;pn=pn===0?En-1:pn-1,no=no===0?En-1:no-1,Ln=Ln===0?En-1:Ln-1,Gn=Gn===0?En-1:Gn-1,et.indices.push(Ln),et.indices.push(no),et.indices.push(pn),et.indices.push(Ln),et.indices.push(Gn),et.indices.push(no)}return et}(s[0]),s=[te.geometry]}const ne=(ze,ot)=>ze<(ot.length-1)/2||ze===ot.length-1,X=this.wallMode?[s]:Cy(s,500);for(let ze=X.length-1;ze>=0;ze--){const ot=X[ze];(ot.length===0||(le=ot[0]).every(Oe=>Oe.x<=0)||le.every(Oe=>Oe.x>=In)||le.every(Oe=>Oe.y<=0)||le.every(Oe=>Oe.y>=In))&&X.splice(ze,1)}var le;let pe;if(D)pe=TE(X,x,m);else{pe=[];for(const ze of X)pe.push({polygon:ze,bounds:x})}const Ce=M?this.edgeRadius:0,Ue=Ce>0&&this.zoom<17,Le=(ze,ot)=>{if(ze.length===0)return!1;const Oe=ze[ze.length-1];return ot.x===Oe.x&&ot.y===Oe.y};for(const{polygon:ze,bounds:ot}of pe){let Oe=0,et=0;for(const Mt of ze)M&&!Mt[0].equals(Mt[Mt.length-1])&&Mt.push(Mt[0]),et+=M?Mt.length-1:Mt.length;const ct=this.segments.prepareSegment((M?5:4)*et,this.layoutVertexArray,this.indexArray);B.footprintSegIdx<0&&(B.footprintSegIdx=this.footprintSegments.length),B.polygonSegIdx<0&&(B.polygonSegIdx=this.polygonSegments.length);const ut={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},_t=new fE;if(_t.vertexOffset=this.footprintVertices.length,_t.indexOffset=3*this.footprintIndices.length,_t.ringIndices=[],M){const Mt=[],kt=[];Oe=ct.vertexLength;for(let Yt=0;Yt<ze.length;Yt++){const gn=ze[Yt];gn.length&&Yt!==0&&kt.push(Mt.length/2);const Ut=[];let zn,En;zn=gn[1].sub(gn[0])._perp()._unit(),_t.ringIndices.push(gn.length-1);for(let xn=1;xn<gn.length;xn++){const pn=gn[xn],no=gn[xn===gn.length-1?1:xn+1],Ln=pn.clone();if(Ce){En=no.sub(pn)._perp()._unit();const Gn=zn.add(En)._unit(),wo=Ce*Math.min(4,1/(zn.x*Gn.x+zn.y*Gn.y));Ln.x+=wo*Gn.x,Ln.y+=wo*Gn.y,Ln.x=Math.round(Ln.x),Ln.y=Math.round(Ln.y),zn=En}if(!H||Ce!==0&&!Ue||Le(Ut,Ln)||Ut.push(Ln),bg(this.layoutVertexArray,Ln.x,Ln.y,0,0,1,1,0),this.wallMode){const Gn=ne(xn,gn);xg(this.wallVertexArray,te.joinNormals[xn],!Gn)}ct.vertexLength++,this.footprintVertices.emplaceBack(pn.x,pn.y),Mt.push(pn.x,pn.y),D&&wg(this.layoutVertexExtArray,A.projectTilePoint(Ln.x,Ln.y,m),A.upVector(m,Ln.x,Ln.y))}H&&(Ce===0||Ue)&&(Ut.length!==0&&Le(Ut,Ut[0])&&Ut.pop(),this.groundEffect.addData(Ut,ot,L))}const St=this.wallMode?te.indices:gg(Mt,kt);for(let Yt=0;Yt<St.length;Yt+=3)this.footprintIndices.emplaceBack(_t.vertexOffset+St[Yt+0],_t.vertexOffset+St[Yt+1],_t.vertexOffset+St[Yt+2]),this.indexArray.emplaceBack(Oe+St[Yt],Oe+St[Yt+2],Oe+St[Yt+1]),ct.primitiveLength++;_t.indexCount+=St.length,_t.vertexCount+=this.footprintVertices.length-_t.vertexOffset}for(let Mt=0;Mt<ze.length;Mt++){const kt=ze[Mt];P.startRing(B,kt[0]);let St=kt.length>4&&xE(kt[kt.length-2],kt[0],kt[1]),Yt=Ce?yB(kt[kt.length-2],kt[0],kt[1],Ce):0;const gn=[];let Ut,zn,En;zn=kt[1].sub(kt[0])._perp()._unit();let xn=!0;for(let pn=1,no=0;pn<kt.length;pn++){let Ln=kt[pn-1],Gn=kt[pn];const wo=kt[pn===kt.length-1?1:pn+1];if(P.appendEdge(B,Gn,Ln),sx(Gn,Ln,ot)){Ce&&(zn=wo.sub(Gn)._perp()._unit(),xn=!xn);continue}const Do=Gn.sub(Ln)._perp(),zo=Do.x/(Math.abs(Do.x)+Math.abs(Do.y)),Ao=Do.y>0?1:0,Uo=Ln.dist(Gn);if(no+Uo>32768&&(no=0),Ce){En=wo.sub(Gn)._perp()._unit();let go=yE(Ln,Gn,wo,_E(zn,En),Ce);isNaN(go)&&(go=0);const ur=Gn.sub(Ln)._unit();Ln=Ln.add(ur.mult(Yt))._round(),Gn=Gn.add(ur.mult(-go))._round(),Yt=go,zn=En,H&&this.zoom>=17&&(Le(gn,Ln)||gn.push(Ln),Le(gn,Gn)||gn.push(Gn))}const No=ct.vertexLength,Ir=kt.length>4&&xE(Ln,Gn,wo);let br=wE(no,St,xn);if(bg(this.layoutVertexArray,Ln.x,Ln.y,zo,Ao,0,0,br),bg(this.layoutVertexArray,Ln.x,Ln.y,zo,Ao,0,1,br),this.wallMode){const go=ne(pn-1,kt),ur=te.joinNormals[pn-1];xg(this.wallVertexArray,ur,go),xg(this.wallVertexArray,ur,go)}if(no+=Uo,br=wE(no,Ir,!xn),St=Ir,bg(this.layoutVertexArray,Gn.x,Gn.y,zo,Ao,0,0,br),bg(this.layoutVertexArray,Gn.x,Gn.y,zo,Ao,0,1,br),this.wallMode){const go=ne(pn,kt),ur=te.joinNormals[pn];xg(this.wallVertexArray,ur,go),xg(this.wallVertexArray,ur,go)}if(ct.vertexLength+=4,this.indexArray.emplaceBack(No+0,No+1,No+2),this.indexArray.emplaceBack(No+1,No+3,No+2),ct.primitiveLength+=2,Ce){const go=Oe+(pn===1?kt.length-2:pn-2),ur=pn===1?Oe:go+1;if(this.indexArray.emplaceBack(No+1,go,No+3),this.indexArray.emplaceBack(go,ur,No+3),ct.primitiveLength+=2,Ut===void 0&&(Ut=No),!sx(wo,kt[pn],ot)){const fr=pn===kt.length-1?Ut:ct.vertexLength;this.indexArray.emplaceBack(No+2,No+3,fr),this.indexArray.emplaceBack(No+3,fr+1,fr),this.indexArray.emplaceBack(No+3,ur,fr+1),ct.primitiveLength+=3}xn=!xn}if(D){const go=this.layoutVertexExtArray,ur=A.projectTilePoint(Ln.x,Ln.y,m),fr=A.projectTilePoint(Gn.x,Gn.y,m),Vr=A.upVector(m,Ln.x,Ln.y),si=A.upVector(m,Gn.x,Gn.y);wg(go,ur,Vr),wg(go,ur,Vr),wg(go,fr,si),wg(go,fr,si)}}M&&(Oe+=kt.length-1),H&&Ce&&this.zoom>=17&&(gn.length!==0&&Le(gn,gn[0])&&gn.pop(),this.groundEffect.addData(gn,ot,L,Ce>0))}this.footprintSegments.push(_t),ut.triangleCount=this.indexArray.length-ut.triangleArrayOffset,this.polygonSegments.push(ut),++B.footprintSegLen,++B.polygonSegLen}if(B.vertexCount=this.layoutVertexArray.length-B.vertexArrayOffset,B.groundVertexCount=this.groundEffect.vertexArray.length-B.groundVertexArrayOffset,B.vertexCount!==0){if(B.centroidXY=P.borders?hE:this.encodeCentroid(P,B),this.centroidData.push(B),P.borders){this.featuresOnBorder.push(P);const ze=this.featuresOnBorder.length-1;for(let ot=0;ot<P.borders.length;ot++)P.borders[ot][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ot].push(ze)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,m,k),this.groundEffect.addPaintPropertiesData(n,u,h,v,m,k),this.maxHeight=Math.max(this.maxHeight,Z)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((s,u)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let T=0;T<this.centroidData.length;T++){const k=this.centroidData[T],L=+(k.min.y+k.max.y>In),x=2*L+(+(k.min.x+k.max.x>In)^L);for(let A=0;A<k.polygonSegLen;A++){const D=k.polygonSegIdx+A;n.push({centroidIdx:T,subtile:x,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const s=new Gr;n.sort((T,k)=>T.triangleSegmentIdx===k.triangleSegmentIdx?T.subtile-k.subtile:T.triangleSegmentIdx-k.triangleSegmentIdx);let u=0,m=0,h=0;for(const T of n){if(T.triangleSegmentIdx!==u)break;h++}const v=n.length;for(;m!==n.length;){u=n[m].triangleSegmentIdx;let T=0,k=m,L=m;for(let x=k;x<h&&n[x].subtile===T;x++)L++;for(;k!==h;){const x=n[k];T=x.subtile;const A=this.centroidData[x.centroidIdx].min.clone(),D=this.centroidData[x.centroidIdx].max.clone(),M={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let P=k;P<L;P++){const B=n[P],H=this.polygonSegments[B.polygonSegmentIdx],Z=this.centroidData[B.centroidIdx].min,te=this.centroidData[B.centroidIdx].max,ne=this.indexArray.uint16;for(let X=H.triangleArrayOffset;X<H.triangleArrayOffset+H.triangleCount;X++)s.emplaceBack(ne[3*X],ne[3*X+1],ne[3*X+2]);M.primitiveLength+=H.triangleCount,A.x=Math.min(A.x,Z.x),A.y=Math.min(A.y,Z.y),D.x=Math.max(D.x,te.x),D.y=Math.max(D.y,te.y)}M.primitiveLength>0&&this.triangleSubSegments.push({segment:M,min:A,max:D}),k=L;for(let P=k;P<h&&n[P].subtile===n[k].subtile;P++)L++}m=h;for(let x=m;x<v&&n[x].triangleSegmentIdx===n[m].triangleSegmentIdx;x++)h++}s._trim(),this.indexArray=s}getVisibleSegments(n,s,u){const m=new ti;if(this.wallMode){for(const B of this.triangleSubSegments)m.segments.push(B.segment);return m}let h=0,v=0;const T=1<<n.canonical.z;if(s){const B=s.getMinMaxForTile(n);B&&(h=B.min,v=B.max)}v+=this.maxHeight;const k=n.toUnwrapped();let L;const x=[k.canonical.x/T+k.wrap,k.canonical.y/T],A=[(k.canonical.x+1)/T+k.wrap,(k.canonical.y+1)/T],D=(B,H,Z)=>[B[0]*(1-Z[0])+H[0]*Z[0],B[1]*(1-Z[1])+H[1]*Z[1]],M=[],P=[];for(const B of this.triangleSubSegments){M[0]=B.min.x/In,M[1]=B.min.y/In,P[0]=B.max.x/In,P[1]=B.max.y/In;const H=D(x,A,M),Z=D(x,A,P);if(new hr([H[0],H[1],h],[Z[0],Z[1],v]).intersectsPrecise(u)===0){L&&(m.segments.push(L),L=void 0);continue}const te=B.segment;L&&L.vertexOffset!==te.vertexOffset&&(m.segments.push(L),L=void 0),L?(L.vertexLength+=te.vertexLength,L.primitiveLength+=te.primitiveLength):L={vertexOffset:te.vertexOffset,primitiveLength:te.primitiveLength,vertexLength:te.vertexLength,primitiveOffset:te.primitiveOffset,sortKey:void 0,vaos:{}}}return L&&m.segments.push(L),m}encodeCentroid(n,s){const u=n.centroid(),m=s.span(),h=Math.min(7,Math.round(m.x*this.tileToMeter/10)),v=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new Fe(gt(u.x,1,In-1)<<3|h,gt(u.y,1,In-1)<<3|v)}encodeBorderCentroid(n){if(!n.borders)return new Fe(0,0);const s=n.borders,u=Number.MAX_VALUE;if(s[0][0]!==u||s[1][0]!==u){const m=s[0][0]!==u?0:1;return new Fe(6|(s[0][0]!==u?0:65528),(s[m][0]+s[m][1])/2<<3|6)}{const m=s[2][0]!==u?2:3;return new Fe((s[m][0]+s[m][1])/2<<3|6,6|(s[2][0]!==u?0:65528))}}showCentroid(n){const s=this.centroidData[n.centroidDataIndex];s.flags&=Tu,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const s=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,m=n.flags&Tu?hE:n.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==m.y||h!==m.x){for(let v=s;v<u;++v)this.centroidVertexArray.emplace(v,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,s,u){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const m=s.getReplacementRegionsForTile(n.toUnwrapped());if(ox(this.activeReplacements,m))return;if(this.activeReplacements=m,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const h=[];for(const v of this.activeReplacements){if(v.order<u)continue;const T=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-n.canonical.z));for(const k of this.centroidData)if(!(k.flags&Tu||v.min.x>k.max.x||k.min.x>v.max.x||v.min.y>k.max.y||k.min.y>v.max.y))for(let L=0;L<k.footprintSegLen;L++){const x=this.footprintSegments[k.footprintSegIdx+L];if(h.length=0,bB(this.footprintVertices,x.vertexOffset,x.vertexCount,v.footprintTileId.canonical,n.canonical,h),aE(v.footprint,h,this.footprintIndices.uint16,x.indexOffset,x.indexCount,-x.vertexOffset,-T)){k.flags|=Tu;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,s,u){let m=!1;for(let h=0;h<u.footprintSegLen;h++){const v=this.footprintSegments[u.footprintSegIdx+h];let T=0;for(const k of v.ringIndices){for(let L=T,x=k+T-1;L<k+T;x=L++){const A=this.footprintVertices.int16[2*(L+v.vertexOffset)+0],D=this.footprintVertices.int16[2*(L+v.vertexOffset)+1],M=this.footprintVertices.int16[2*(x+v.vertexOffset)+1];D>s!=M>s&&n<(this.footprintVertices.int16[2*(x+v.vertexOffset)+0]-A)*(s-D)/(M-D)+A&&(m=!m)}T=k}}return m}getHeightAtTileCoord(n,s){let u=Number.NEGATIVE_INFINITY,m=!0;const h=4*(n+In)*In+(s+In);if(this.partLookup.hasOwnProperty(h)){const v=this.partLookup[h];return v?{height:v.height,hidden:!!(v.flags&Tu)}:void 0}for(const v of this.centroidData)n>v.max.x||v.min.x>n||s>v.max.y||v.min.y>s||this.footprintContainsPoint(n,s,v)&&v&&v.height>u&&(u=v.height,this.partLookup[h]=v,m=!!(v.flags&Tu));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:m};this.partLookup[h]=void 0}}function _E(c,n){const s=c.add(n)._unit();return c.x*s.x+c.y*s.y}function yB(c,n,s,u){const m=n.sub(c)._perp()._unit(),h=s.sub(n)._perp()._unit();return yE(c,n,s,_E(m,h),u)}function yE(c,n,s,u,m){const h=Math.sqrt(1-u*u);return Math.min(c.dist(n)/3,n.dist(s)/3,m*h/u)}function sx(c,n,s){return c.x<s[0].x&&n.x<s[0].x||c.x>s[1].x&&n.x>s[1].x||c.y<s[0].y&&n.y<s[0].y||c.y>s[1].y&&n.y>s[1].y}function bE(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function xE(c,n,s){if(c.x<0||c.x>=In||n.x<0||n.x>=In||s.x<0||s.x>=In)return!1;const u=s.sub(n),m=u.perp(),h=c.sub(n);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&m.x*h.x+m.y*h.y<0}function wE(c,n,s){const u=n?2|c:-3&c;return s?1|u:-2&u}function SE(){const c=Math.PI/32,n=Math.tan(c),s=V;return s*Math.sqrt(1+2*n*n)-s}function TE(c,n,s){const u=1<<s.z,m=Pe(s.x/u),h=Pe((s.x+1)/u),v=$e(s.y/u),T=$e((s.y+1)/u);return function(k,L,x,A,D=0,M){const P=[];if(!k.length||!x||!A)return P;const B=(pe,Ce)=>{for(const Ue of pe)P.push({polygon:Ue,bounds:Ce})},H=Math.ceil(Math.log2(x)),Z=Math.ceil(Math.log2(A)),te=H-Z,ne=[];for(let pe=0;pe<Math.abs(te);pe++)ne.push(te>0?0:1);for(let pe=0;pe<Math.min(H,Z);pe++)ne.push(0),ne.push(1);let X=k;if(X=My(X,L[0].y-D,L[1].y+D,1),X=My(X,L[0].x-D,L[1].x+D,0),!X.length)return P;const le=[];for(ne.length?le.push({polygons:X,bounds:L,depth:0}):B(X,L);le.length;){const pe=le.pop(),Ce=pe.depth,Ue=ne[Ce],Le=pe.bounds[0],ze=pe.bounds[1],ot=Ue===0?Le.x:Le.y,Oe=Ue===0?ze.x:ze.y,et=M?M(Ue,ot,Oe):.5*(ot+Oe),ct=My(pe.polygons,ot-D,et+D,Ue),ut=My(pe.polygons,et-D,Oe+D,Ue);if(ct.length){const _t=[Le,new Fe(Ue===0?et:ze.x,Ue===1?et:ze.y)];ne.length>Ce+1?le.push({polygons:ct,bounds:_t,depth:Ce+1}):B(ct,_t)}if(ut.length){const _t=[new Fe(Ue===0?et:Le.x,Ue===1?et:Le.y),ze];ne.length>Ce+1?le.push({polygons:ut,bounds:_t,depth:Ce+1}):B(ut,_t)}}return P}(c,n,Math.ceil((h-m)/11.25),Math.ceil((v-T)/11.25),1,(k,L,x)=>{if(k===0)return .5*(L+x);{const A=$e((s.y+L/In)/u);return(we(.5*($e((s.y+x/In)/u)+A))*u-s.y)*In}})}function bB(c,n,s,u,m,h){const v=Math.pow(2,u.z-m.z);for(let T=0;T<s;T++){let k=c.int16[2*(T+n)+0],L=c.int16[2*(T+n)+1];k=(k+m.x*In)*v-u.x*In,L=(L+m.y*In)*v-u.y*In,h.push(new Fe(k,L))}}let CE,EE;function Sg(c,n){return c.x*n.x+c.y*n.y}function ME(c,n){if(c.length===1){let s=0;const u=n[s++];let m;for(;!m||u.equals(m);)if(m=n[s++],!m)return 1/0;for(;s<n.length;s++){const h=n[s],v=c[0],T=m.sub(u),k=h.sub(u),L=v.sub(u),x=Sg(T,T),A=Sg(T,k),D=Sg(k,k),M=Sg(L,T),P=Sg(L,k),B=x*D-A*A,H=(D*M-A*P)/B,Z=(x*P-A*M)/B,te=u.z*(1-H-Z)+m.z*H+h.z*Z;if(isFinite(te))return te}return 1/0}{let s=1/0;for(const u of n)s=Math.min(s,u.z);return s}}function IE(c,n,s,u,m,h,v,T){const k=v*m.getElevationAt(c,n,!0,!0),L=h[0]!==0,x=L?h[1]===0?v*(h[0]/7-450):v*function(A,D,M){const P=Math.floor(D[0]/8),B=Math.floor(D[1]/8),H=10*(D[0]-8*P),Z=10*(D[1]-8*B),te=A.getElevationAt(P,B,!0,!0),ne=A.getMeterToDEM(M),X=Math.floor(.5*(H*ne-1)),le=Math.floor(.5*(Z*ne-1)),pe=A.tileCoordToPixel(P,B),Ce=2*X+1,Ue=2*le+1,Le=function(ut,_t,Mt,kt,St){return[ut.getElevationAtPixel(_t,Mt,!0),ut.getElevationAtPixel(_t+St,Mt,!0),ut.getElevationAtPixel(_t,Mt+St,!0),ut.getElevationAtPixel(_t+kt,Mt+St,!0)]}(A,pe.x-X,pe.y-le,Ce,Ue),ze=Math.abs(Le[0]-Le[1]),ot=Math.abs(Le[2]-Le[3]),Oe=Math.abs(Le[0]-Le[2])+Math.abs(Le[1]-Le[3]),et=Math.min(.25,.5*ne*(ze+ot)/Ce),ct=Math.min(.25,.5*ne*Oe/Ue);return te+Math.max(et*H,ct*Z)}(m,h,T):k;return{base:k+(s===0?-1:s),top:L?Math.max(x+u,k+s+2):k+u}}jn(Py,"FillExtrusionBucket",{omit:["layers","features"]}),jn(pE,"PartData"),jn(fE,"FootprintSegment"),jn(mE,"BorderCentroidData"),jn(vE,"GroundEffect");const xB=sr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),wB=sr([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:SB}=xB,TB=sr([{name:"a_packed",components:4,type:"Float32"}]),{members:CB}=TB,EB=sr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:MB}=EB;class AE{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new Su({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const u=this.getKey(n,s);return this.positions[u]}trim(){const n=this.width,s=this.height=er(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,u){const m=[];let h=n.length%2==1?-n[n.length-1]*u:0,v=n[0]*u,T=!0;m.push({left:h,right:v,isDash:T,zeroLength:n[0]===0});let k=n[0];for(let L=1;L<n.length;L++){T=!T;const x=n[L];h=k*u,k+=x,v=k*u,m.push({left:h,right:v,isDash:T,zeroLength:x===0})}return m}addRoundDash(n,s,u){const m=s/2;for(let h=-u;h<=u;h++){const v=this.width*(this.nextRow+u+h);let T=0,k=n[T];for(let L=0;L<this.width;L++){L/k.right>1&&(k=n[++T]);const x=Math.abs(L-k.left),A=Math.abs(L-k.right),D=Math.min(x,A);let M;const P=h/u*(m+1);if(k.isDash){const B=m-Math.abs(P);M=Math.sqrt(D*D+B*B)}else M=m-Math.sqrt(D*D+P*P);this.image.data[v+L]=Math.max(0,Math.min(255,M+128))}}}addRegularDash(n,s){for(let k=n.length-1;k>=0;--k){const L=n[k],x=n[k+1];L.zeroLength?n.splice(k,1):x&&x.isDash===L.isDash&&(x.left=L.left,n.splice(k,1))}const u=n[0],m=n[n.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const h=this.width*this.nextRow;let v=0,T=n[v];for(let k=0;k<this.width;k++){k/T.right>1&&(T=n[++v]);const L=Math.abs(k-T.left),x=Math.abs(k-T.right),A=Math.min(L,x);this.image.data[h+k]=Math.max(0,Math.min(255,(T.isDash?A:-A)+s+128))}}addDash(n,s){const u=this.getKey(n,s);if(this.positions[u])return this.positions[u];const m=s==="round",h=m?7:0,v=2*h+1;if(this.nextRow+v>this.height)return Mn("LineAtlas out of space"),null;n.length===0&&n.push(1);let T=0;for(let x=0;x<n.length;x++)n[x]<0&&(Mn("Negative value is found in line dasharray, replacing values with 0"),n[x]=0),T+=n[x];if(T!==0){const x=this.width/T,A=this.getDashRanges(n,this.width,x);m?this.addRoundDash(A,x,h):this.addRegularDash(A,s==="square"?.5*x:0)}const k=this.nextRow+h;this.nextRow+=v;const L={tl:[k,h],br:[T,0]};return this.positions[u]=L,L}}jn(AE,"LineAtlas");const IB=zf.VectorTileFeature.types,AB=Math.cos(Math.PI/180*37.5),kB=Math.cos(Math.PI/180*5);class ax{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Od,this.layoutVertexArray2=new Za,this.patternVertexArray=new Dl,this.indexArray=new Gr,this.programConfigurations=new Ea(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ti,this.maxLineLength=0,this.zOffsetVertexArray=new vu,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:In/64}updateFootprints(n,s){}populate(n,s,u,m){this.hasPattern=Z1("line",this.layers,s);const h=this.layers[0].layout.get("line-sort-key");this.hasZOffset=!this.layers[0].isDraped();const v=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&v==="none"&&Mn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const T=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&T!==void 0;const k=[];for(const{feature:D,id:M,index:P,sourceLayerIndex:B}of n){const H=this.layers[0]._featureFilter.needGeometry,Z=on(D,H);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom),Z,u))continue;const te=h?h.evaluate(Z,{},u):void 0,ne={id:M,properties:D.properties,type:D.type,sourceLayerIndex:B,index:P,geometry:H?Z.geometry:wt(D,u,m),patterns:{},sortKey:te};k.push(ne)}h&&k.sort((D,M)=>D.sortKey-M.sortKey);const{lineAtlas:L,featureIndex:x}=s,A=this.addConstantDashes(L);for(const D of k){const{geometry:M,index:P,sourceLayerIndex:B}=D;if(A&&this.addFeatureDashes(D,L),this.hasPattern){const H=Y1("line",this.layers,D,this.zoom,s);this.patternFeatures.push(H)}else this.addFeature(D,M,P,u,L.positions,s.availableImages,s.brightness);x.insert(n[P].feature,M,P,B,this.index)}}addConstantDashes(n){let s=!1;for(const u of this.layers){const m=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(m.kind!=="constant"||h.kind!=="constant")s=!0;else{const v=h.value,T=m.value;if(!T)continue;n.addDash(T,v)}}return s}addFeatureDashes(n,s){const u=this.zoom;for(const m of this.layers){const h=m.paint.get("line-dasharray").value,v=m.layout.get("line-cap").value;if(h.kind==="constant"&&v.kind==="constant")continue;let T,k;if(h.kind==="constant"){if(T=h.value,!T)continue}else T=h.evaluate({zoom:u},n);k=v.kind==="constant"?v.value:v.evaluate({zoom:u},n),s.addDash(T,k),n.patterns[m.id]=s.getKey(T,k)}}update(n,s,u,m,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,v?this.stateDependentLayers:this.layers,u,m,h)}addFeatures(n,s,u,m,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,u,m,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,CB)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,MB)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,wB.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,SB),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,u,m,h,v,T){const k=this.layers[0].layout,L=k.get("line-join").evaluate(n,{}),x=k.get("line-cap").evaluate(n,{}),A=k.get("line-miter-limit"),D=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=k.get("line-z-offset").value;for(const M of s)this.addLine(M,n,m,L,x,A,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,m,T)}addLine(n,s,u,m,h,v,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const k=m==="none";if(this.patternJoinNone=this.hasPattern&&k,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<n.length-1;ne++)this.totalDistance+=n[ne].dist(n[ne+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=IB[s.type]==="Polygon";let x=n.length;for(;x>=2&&n[x-1].equals(n[x-2]);)x--;let A=0;for(;A<x-1&&n[A].equals(n[A+1]);)A++;if(x<(L?3:2))return;m==="bevel"&&(v=1.05);const D=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let M,P,B,H,Z,te;this.e1=this.e2=-1,L&&(M=n[x-2],Z=n[A].sub(M)._unit()._perp());for(let ne=A;ne<x;ne++){if(B=ne===x-1?L?n[A+1]:void 0:n[ne+1],B&&n[ne].equals(B))continue;Z&&(H=Z),M&&(P=M),M=n[ne],te=this.hasZOffset?this.evaluateElevationValue(P?P.dist(M):0):null,Z=B?B.sub(M)._unit()._perp():H,H=H||Z;const X=P&&B;let le=X?m:L||k?"butt":h;const pe=H.x*Z.x+H.y*Z.y;if(k){const ct=function(ut){if(ut.patternJoinNone){const _t=ut.segmentPoints.length/2,Mt=ut.lineSoFar-ut.segmentStart;for(let kt=0;kt<_t;++kt){const St=ut.segmentPoints[2*kt+1],Yt=Math.round(ut.segmentPoints[2*kt])+.5+.25*St;ut.patternVertexArray.emplaceBack(Yt,Mt,ut.segmentStart),ut.patternVertexArray.emplaceBack(Yt,Mt,ut.segmentStart)}ut.segmentPoints.length=0}ut.e1=ut.e2=-1};if(X&&pe<kB){this.updateDistance(P,M),this.addCurrentVertex(M,H,1,1,D,te),ct(this),this.addCurrentVertex(M,Z,-1,-1,D,te);continue}if(P){if(!B){this.updateDistance(P,M),this.addCurrentVertex(M,H,1,1,D,te),ct(this);continue}le="miter"}}let Ce=H.add(Z);Ce.x===0&&Ce.y===0||Ce._unit();const Ue=Ce.x*Z.x+Ce.y*Z.y,Le=Ue!==0?1/Ue:1/0,ze=2*Math.sqrt(2-2*Ue),ot=Ue<AB&&P&&B,Oe=H.x*Z.y-H.y*Z.x>0,et=this.overscaling<=16?15*In/(512*this.overscaling):0;if(X&&le==="round"){if(Le<T)le="miter";else if(Le<=2){const ct=lx(M,-10,In+10);le=this.hasZOffset&&(ct||this.hasCrossSlope)?"miter":"fakeround"}}if(le==="miter"&&Le>v&&(le="bevel"),le==="bevel"&&(Le>2&&(le="flipbevel"),Le<v&&(le="miter")),P&&!(le==="miter"&&ot)&&this.updateDistance(P,M),le==="miter")if(ot){const ct=M.dist(P);if(ct>2*et){const _t=M.sub(M.sub(P)._mult(et/ct)._round());this.updateDistance(P,_t),this.addCurrentVertex(_t,H,0,0,D,te),P=_t}this.updateDistance(P,M),Ce._mult(Le),this.addCurrentVertex(M,Ce,0,0,D,te);const ut=M.dist(B);if(ut>2*et){const _t=M.add(B.sub(M)._mult(et/ut)._round());this.updateDistance(M,_t),this.addCurrentVertex(_t,Z,0,0,D,te),M=_t}}else Ce._mult(Le),this.addCurrentVertex(M,Ce,0,0,D,te);else if(le==="flipbevel"){if(Le>100)Ce=Z.mult(-1);else{const ct=Le*H.add(Z).mag()/H.sub(Z).mag();Ce._perp()._mult(ct*(Oe?-1:1))}this.addCurrentVertex(M,Ce,0,0,D,te),this.addCurrentVertex(M,Ce.mult(-1),0,0,D,te)}else if(le==="bevel"||le==="fakeround"){te!=null&&P&&this.addCurrentVertex(M,H,-1,-1,D,te);const ct=M.dist(P)<=2*et&&le!=="bevel",ut=Ce.mult(Oe?1:-1);ut._mult(Le);const _t=Z.mult(Oe?-1:1),Mt=H.mult(Oe?-1:1),kt=this.evaluateElevationValue(this.distance);if(te==null&&(this.addHalfVertex(M,ut.x,ut.y,!1,!Oe,0,D,kt),ct||this.addHalfVertex(M,ut.x+2*Mt.x,ut.y+2*Mt.y,!1,Oe,0,D,kt)),le==="fakeround"){const St=Math.round(180*ze/Math.PI/20);this.addHalfVertex(M,Mt.x,Mt.y,!1,Oe,0,D,kt);for(let Yt=0;Yt<St;Yt++){let gn=Yt/St;if(gn!==.5){const zn=gn-.5;gn+=gn*zn*(gn-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*zn*zn+(.848013+pe*(.215638*pe-1.06021)))}const Ut=_t.sub(Mt)._mult(gn)._add(Mt)._unit();this.addHalfVertex(M,Ut.x,Ut.y,!1,Oe,0,D,kt)}this.addHalfVertex(M,_t.x,_t.y,!1,Oe,0,D,kt)}ct||te!=null||this.addHalfVertex(M,ut.x+2*_t.x,ut.y+2*_t.y,!1,Oe,0,D,kt),te!=null&&B&&this.addCurrentVertex(M,Z,1,1,D,te)}else le==="butt"?this.addCurrentVertex(M,Ce,0,0,D,te):le==="square"?(P||this.addCurrentVertex(M,Ce,-1,-1,D,te),this.addCurrentVertex(M,Ce,0,0,D,te),P&&this.addCurrentVertex(M,Ce,1,1,D,te)):le==="round"&&(P&&(this.addCurrentVertex(M,H,0,0,D,te),this.addCurrentVertex(M,H,1,1,D,te,!0)),B&&(this.addCurrentVertex(M,Z,-1,-1,D,te,!0),this.addCurrentVertex(M,Z,0,0,D,te)))}}addVerticesTo(n,s,u,m,h,v,T,k,L,x){const A=(s.w-n.w)/this.tessellationStep|0;let D=0;const M=this.scaledDistance;if(A>1){this.lineSoFar=n.w;const B=(s.x-n.x)/A,H=(s.y-n.y)/A,Z=(s.z-n.z)/A,te=(s.w-n.w)/A;for(let ne=1;ne<A;++ne){n.x+=B,n.y+=H,n.z+=Z,this.lineSoFar+=te,D+=te;const X=this.evaluateElevationValue(this.prevDistance+D);this.scaledDistance=(this.prevDistance+D)/this.totalDistance,this.addHalfVertex(n,u,m,x,!1,T,L,X),this.addHalfVertex(n,h,v,x,!0,-k,L,X)}}this.lineSoFar=s.w,this.scaledDistance=M;const P=this.evaluateElevationValue(this.distance);this.addHalfVertex(s,u,m,x,!1,T,L,P),this.addHalfVertex(s,h,v,x,!0,-k,L,P)}evaluateElevationValue(n){return this.hasZOffset?this.zOffsetValue.kind==="constant"?this.zOffsetValue.value:(this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):Mn(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0):void 0}addCurrentVertex(n,s,u,m,h,v,T=!1){const k=s.x+s.y*u,L=s.y-s.x*u,x=s.y*m-s.x,A=-s.y-s.x*m;if(v!=null){const M=In+10,P=v,B=new tE(n.x,n.y,P,this.lineSoFar),H=lx(n,-10,M),Z=this.lineSoFar,te=this.distance;if(this.currentVertex)if(H){const ne=this.currentVertexIsOutside,X=this.currentVertex,le=new tE(n.x,n.y,P,this.lineSoFar);if(oE(X,le,-10,M),!lx(le,-10,M)){if(ne){this.e1=this.e2=-1,this.distance-=X.dist(B),this.lineSoFar=X.w;const pe=this.evaluateElevationValue(X.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(X,k,L,T,!1,u,h,pe),this.addHalfVertex(X,x,A,T,!0,-m,h,pe),this.prevDistance=this.distance}this.distance=this.prevDistance+X.dist(le),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(X,le,k,L,x,A,u,m,h,T),this.distance=te,this.scaledDistance=this.distance/this.totalDistance}}else{const ne=this.currentVertex;if(this.currentVertexIsOutside){oE(ne,B,-10,M),this.e1=this.e2=-1,this.distance-=ne.dist(B),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ne.w;const X=this.evaluateElevationValue(ne.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ne,k,L,T,!1,u,h,X),this.addHalfVertex(ne,x,A,T,!0,-m,h,X),this.prevDistance=this.distance,this.distance=te,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ne,B,k,L,x,A,u,m,h,T)}else H||(this.addHalfVertex(n,k,L,T,!1,u,h,v),this.addHalfVertex(n,x,A,T,!0,-m,h,v));this.currentVertex=B,this.currentVertexIsOutside=H,this.lineSoFar=Z}else this.addHalfVertex(n,k,L,T,!1,u,h,v),this.addHalfVertex(n,x,A,T,!0,-m,h,v)}addHalfVertex({x:n,y:s},u,m,h,v,T,k,L){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((n<<1)+(h?1:0),(s<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const x=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),k.primitiveLength++),v?this.e2=x:this.e1=x,L!=null&&this.zOffsetVertexArray.emplaceBack(L)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,s){this.prevDistance=this.distance,this.distance+=n.dist(s),this.updateScaledDistance()}}function lx(c,n,s){return c.x<n||c.x>s||c.y<n||c.y>s}let kE,PE;function RE(c,n,s){return n*(In/(c.tileSize*Math.pow(2,s-c.tileID.overscaledZ)))}jn(ax,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const DE=(c,n,s)=>(1-s)*c+s*n;function LE(c,n){return 1/RE(c,1,n.tileZoom)}function OE(c,n,s,u){return c.translatePosMatrix(u||n.tileID.projMatrix,n,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const zE=c=>{const n=[];BE(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const s=c.paint.get("line-trim-offset");s[0]===0&&s[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",m=!!c.paint.get("line-pattern").constantOr(1);return u&&m&&n.push("LINE_JOIN_NONE"),n};function BE(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let cx;const FE=()=>cx||(cx={layout:kE||(kE=new zr({"line-cap":new Qn(It.layout_line["line-cap"]),"line-join":new Qn(It.layout_line["line-join"]),"line-miter-limit":new wn(It.layout_line["line-miter-limit"]),"line-round-limit":new wn(It.layout_line["line-round-limit"]),"line-sort-key":new Qn(It.layout_line["line-sort-key"]),"line-z-offset":new Qn(It.layout_line["line-z-offset"]),"line-elevation-reference":new wn(It.layout_line["line-elevation-reference"]),"line-cross-slope":new wn(It.layout_line["line-cross-slope"]),visibility:new wn(It.layout_line.visibility)})),paint:PE||(PE=new zr({"line-opacity":new Qn(It.paint_line["line-opacity"]),"line-color":new Qn(It.paint_line["line-color"]),"line-translate":new wn(It.paint_line["line-translate"]),"line-translate-anchor":new wn(It.paint_line["line-translate-anchor"]),"line-width":new Qn(It.paint_line["line-width"]),"line-gap-width":new Qn(It.paint_line["line-gap-width"]),"line-offset":new Qn(It.paint_line["line-offset"]),"line-blur":new Qn(It.paint_line["line-blur"]),"line-dasharray":new Qn(It.paint_line["line-dasharray"]),"line-pattern":new Qn(It.paint_line["line-pattern"]),"line-gradient":new du(It.paint_line["line-gradient"]),"line-trim-offset":new wn(It.paint_line["line-trim-offset"]),"line-trim-fade-range":new wn(It.paint_line["line-trim-fade-range"]),"line-trim-color":new wn(It.paint_line["line-trim-color"]),"line-emissive-strength":new wn(It.paint_line["line-emissive-strength"]),"line-border-width":new Qn(It.paint_line["line-border-width"]),"line-border-color":new Qn(It.paint_line["line-border-color"]),"line-occlusion-opacity":new wn(It.paint_line["line-occlusion-opacity"])}))},cx);class PB extends Qn{possiblyEvaluate(n,s){return s=new Zr(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,u,m){return s=eo({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,u,m)}}let Tg;function NE(c,n){return n>0?n+2*c:c}const RB=sr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),DB=sr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),LB=sr([{name:"a_projected_pos",components:4,type:"Float32"}],4);sr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const OB=sr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),zB=sr([{name:"a_texb",components:2,type:"Uint16"}]),BB=sr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),FB=sr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);sr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const $E=sr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),NB=sr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);sr([{name:"triangle",components:3,type:"Uint16"}]),sr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),sr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),sr([{type:"Float32",name:"offsetX"}]),sr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var zi=24;const nl=128;function ux(c,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Zr(c+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:m}=s;let h=0;for(;h<u.length&&u[h]<=c;)h++;h=Math.max(0,h-1);let v=h;for(;v<u.length&&u[v]<c+1;)v++;v=Math.min(u.length-1,v);const T=u[h],k=u[v];return s.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:k,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:k,minSize:s.evaluate(new Zr(T)),maxSize:s.evaluate(new Zr(k)),interpolationType:m}}}function Ry(c,{uSize:n,uSizeT:s},{lowerSize:u,upperSize:m}){return c.kind==="source"?u/nl:c.kind==="composite"?mo(u/nl,m/nl,s):n}function Bf(c,n,s=1){let u=0,m=0;if(c.kind==="constant")m=c.layoutSize*s;else if(c.kind!=="source"){const{interpolationType:h,minZoom:v,maxZoom:T}=c,k=h?gt(Es.interpolationFactor(h,n,v,T),0,1):0;c.kind==="camera"?m=mo(c.minSize,c.maxSize,k)*s:u=k*s}return{uSizeT:u,uSize:m}}var $B=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:nl,evaluateSizeForFeature:Ry,evaluateSizeForZoom:Bf,getSizeData:ux});function VB(c,n,s){return c.sections.forEach(u=>{u.text=function(m,h,v){const T=h.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),Is.applyArabicShaping&&(m=Is.applyArabicShaping(m)),m}(u.text,n,s)}),c}const Cg={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function UB(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function jB(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var VE,dx,UE,hx={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function HB(){return VE||(VE=1,hx.read=function(c,n,s,u,m){var h,v,T=8*m-u-1,k=(1<<T)-1,L=k>>1,x=-7,A=s?m-1:0,D=s?-1:1,M=c[n+A];for(A+=D,h=M&(1<<-x)-1,M>>=-x,x+=T;x>0;h=256*h+c[n+A],A+=D,x-=8);for(v=h&(1<<-x)-1,h>>=-x,x+=u;x>0;v=256*v+c[n+A],A+=D,x-=8);if(h===0)h=1-L;else{if(h===k)return v?NaN:1/0*(M?-1:1);v+=Math.pow(2,u),h-=L}return(M?-1:1)*v*Math.pow(2,h-u)},hx.write=function(c,n,s,u,m,h){var v,T,k,L=8*h-m-1,x=(1<<L)-1,A=x>>1,D=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=u?0:h-1,P=u?1:-1,B=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(T=isNaN(n)?1:0,v=x):(v=Math.floor(Math.log(n)/Math.LN2),n*(k=Math.pow(2,-v))<1&&(v--,k*=2),(n+=v+A>=1?D/k:D*Math.pow(2,1-A))*k>=2&&(v++,k/=2),v+A>=x?(T=0,v=x):v+A>=1?(T=(n*k-1)*Math.pow(2,m),v+=A):(T=n*Math.pow(2,A-1)*Math.pow(2,m),v=0));m>=8;c[s+M]=255&T,M+=P,T/=256,m-=8);for(v=v<<m|T,L+=m;L>0;c[s+M]=255&v,M+=P,v/=256,L-=8);c[s+M-P]|=128*B}),hx}function jE(){if(UE)return dx;UE=1,dx=n;var c=HB();function n(X){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(X)?X:new Uint8Array(X||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,u=1/s,m=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(X){return X.type===n.Bytes?X.readVarint()+X.pos:X.pos+1}function v(X,le,pe){return pe?4294967296*le+(X>>>0):4294967296*(le>>>0)+(X>>>0)}function T(X,le,pe){var Ce=le<=16383?1:le<=2097151?2:le<=268435455?3:Math.floor(Math.log(le)/(7*Math.LN2));pe.realloc(Ce);for(var Ue=pe.pos-1;Ue>=X;Ue--)pe.buf[Ue+Ce]=pe.buf[Ue]}function k(X,le){for(var pe=0;pe<X.length;pe++)le.writeVarint(X[pe])}function L(X,le){for(var pe=0;pe<X.length;pe++)le.writeSVarint(X[pe])}function x(X,le){for(var pe=0;pe<X.length;pe++)le.writeFloat(X[pe])}function A(X,le){for(var pe=0;pe<X.length;pe++)le.writeDouble(X[pe])}function D(X,le){for(var pe=0;pe<X.length;pe++)le.writeBoolean(X[pe])}function M(X,le){for(var pe=0;pe<X.length;pe++)le.writeFixed32(X[pe])}function P(X,le){for(var pe=0;pe<X.length;pe++)le.writeSFixed32(X[pe])}function B(X,le){for(var pe=0;pe<X.length;pe++)le.writeFixed64(X[pe])}function H(X,le){for(var pe=0;pe<X.length;pe++)le.writeSFixed64(X[pe])}function Z(X,le){return(X[le]|X[le+1]<<8|X[le+2]<<16)+16777216*X[le+3]}function te(X,le,pe){X[pe]=le,X[pe+1]=le>>>8,X[pe+2]=le>>>16,X[pe+3]=le>>>24}function ne(X,le){return(X[le]|X[le+1]<<8|X[le+2]<<16)+(X[le+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(X,le,pe){for(pe=pe||this.length;this.pos<pe;){var Ce=this.readVarint(),Ue=Ce>>3,Le=this.pos;this.type=7&Ce,X(Ue,le,this),this.pos===Le&&this.skip(Ce)}return le},readMessage:function(X,le){return this.readFields(X,le,this.readVarint()+this.pos)},readFixed32:function(){var X=Z(this.buf,this.pos);return this.pos+=4,X},readSFixed32:function(){var X=ne(this.buf,this.pos);return this.pos+=4,X},readFixed64:function(){var X=Z(this.buf,this.pos)+Z(this.buf,this.pos+4)*s;return this.pos+=8,X},readSFixed64:function(){var X=Z(this.buf,this.pos)+ne(this.buf,this.pos+4)*s;return this.pos+=8,X},readFloat:function(){var X=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,X},readDouble:function(){var X=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,X},readVarint:function(X){var le,pe,Ce=this.buf;return le=127&(pe=Ce[this.pos++]),pe<128?le:(le|=(127&(pe=Ce[this.pos++]))<<7,pe<128?le:(le|=(127&(pe=Ce[this.pos++]))<<14,pe<128?le:(le|=(127&(pe=Ce[this.pos++]))<<21,pe<128?le:function(Ue,Le,ze){var ot,Oe,et=ze.buf;if(ot=(112&(Oe=et[ze.pos++]))>>4,Oe<128||(ot|=(127&(Oe=et[ze.pos++]))<<3,Oe<128)||(ot|=(127&(Oe=et[ze.pos++]))<<10,Oe<128)||(ot|=(127&(Oe=et[ze.pos++]))<<17,Oe<128)||(ot|=(127&(Oe=et[ze.pos++]))<<24,Oe<128)||(ot|=(1&(Oe=et[ze.pos++]))<<31,Oe<128))return v(Ue,ot,Le);throw new Error("Expected varint not more than 10 bytes")}(le|=(15&(pe=Ce[this.pos]))<<28,X,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var X=this.readVarint();return X%2==1?(X+1)/-2:X/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var X=this.readVarint()+this.pos,le=this.pos;return this.pos=X,X-le>=12&&m?function(pe,Ce,Ue){return m.decode(pe.subarray(Ce,Ue))}(this.buf,le,X):function(pe,Ce,Ue){for(var Le="",ze=Ce;ze<Ue;){var ot,Oe,et,ct=pe[ze],ut=null,_t=ct>239?4:ct>223?3:ct>191?2:1;if(ze+_t>Ue)break;_t===1?ct<128&&(ut=ct):_t===2?(192&(ot=pe[ze+1]))==128&&(ut=(31&ct)<<6|63&ot)<=127&&(ut=null):_t===3?(Oe=pe[ze+2],(192&(ot=pe[ze+1]))==128&&(192&Oe)==128&&((ut=(15&ct)<<12|(63&ot)<<6|63&Oe)<=2047||ut>=55296&&ut<=57343)&&(ut=null)):_t===4&&(Oe=pe[ze+2],et=pe[ze+3],(192&(ot=pe[ze+1]))==128&&(192&Oe)==128&&(192&et)==128&&((ut=(15&ct)<<18|(63&ot)<<12|(63&Oe)<<6|63&et)<=65535||ut>=1114112)&&(ut=null)),ut===null?(ut=65533,_t=1):ut>65535&&(ut-=65536,Le+=String.fromCharCode(ut>>>10&1023|55296),ut=56320|1023&ut),Le+=String.fromCharCode(ut),ze+=_t}return Le}(this.buf,le,X)},readBytes:function(){var X=this.readVarint()+this.pos,le=this.buf.subarray(this.pos,X);return this.pos=X,le},readPackedVarint:function(X,le){if(this.type!==n.Bytes)return X.push(this.readVarint(le));var pe=h(this);for(X=X||[];this.pos<pe;)X.push(this.readVarint(le));return X},readPackedSVarint:function(X){if(this.type!==n.Bytes)return X.push(this.readSVarint());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readSVarint());return X},readPackedBoolean:function(X){if(this.type!==n.Bytes)return X.push(this.readBoolean());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readBoolean());return X},readPackedFloat:function(X){if(this.type!==n.Bytes)return X.push(this.readFloat());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readFloat());return X},readPackedDouble:function(X){if(this.type!==n.Bytes)return X.push(this.readDouble());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readDouble());return X},readPackedFixed32:function(X){if(this.type!==n.Bytes)return X.push(this.readFixed32());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readFixed32());return X},readPackedSFixed32:function(X){if(this.type!==n.Bytes)return X.push(this.readSFixed32());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readSFixed32());return X},readPackedFixed64:function(X){if(this.type!==n.Bytes)return X.push(this.readFixed64());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readFixed64());return X},readPackedSFixed64:function(X){if(this.type!==n.Bytes)return X.push(this.readSFixed64());var le=h(this);for(X=X||[];this.pos<le;)X.push(this.readSFixed64());return X},skip:function(X){var le=7&X;if(le===n.Varint)for(;this.buf[this.pos++]>127;);else if(le===n.Bytes)this.pos=this.readVarint()+this.pos;else if(le===n.Fixed32)this.pos+=4;else{if(le!==n.Fixed64)throw new Error("Unimplemented type: "+le);this.pos+=8}},writeTag:function(X,le){this.writeVarint(X<<3|le)},realloc:function(X){for(var le=this.length||16;le<this.pos+X;)le*=2;if(le!==this.length){var pe=new Uint8Array(le);pe.set(this.buf),this.buf=pe,this.length=le}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(X){this.realloc(4),te(this.buf,X,this.pos),this.pos+=4},writeSFixed32:function(X){this.realloc(4),te(this.buf,X,this.pos),this.pos+=4},writeFixed64:function(X){this.realloc(8),te(this.buf,-1&X,this.pos),te(this.buf,Math.floor(X*u),this.pos+4),this.pos+=8},writeSFixed64:function(X){this.realloc(8),te(this.buf,-1&X,this.pos),te(this.buf,Math.floor(X*u),this.pos+4),this.pos+=8},writeVarint:function(X){(X=+X||0)>268435455||X<0?function(le,pe){var Ce,Ue;if(le>=0?(Ce=le%4294967296|0,Ue=le/4294967296|0):(Ue=~(-le/4294967296),4294967295^(Ce=~(-le%4294967296))?Ce=Ce+1|0:(Ce=0,Ue=Ue+1|0)),le>=18446744073709552e3||le<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");pe.realloc(10),function(Le,ze,ot){ot.buf[ot.pos++]=127&Le|128,Le>>>=7,ot.buf[ot.pos++]=127&Le|128,Le>>>=7,ot.buf[ot.pos++]=127&Le|128,Le>>>=7,ot.buf[ot.pos++]=127&Le|128,ot.buf[ot.pos]=127&(Le>>>=7)}(Ce,0,pe),function(Le,ze){var ot=(7&Le)<<4;ze.buf[ze.pos++]|=ot|((Le>>>=3)?128:0),Le&&(ze.buf[ze.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(ze.buf[ze.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(ze.buf[ze.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(ze.buf[ze.pos++]=127&Le|((Le>>>=7)?128:0),Le&&(ze.buf[ze.pos++]=127&Le)))))}(Ue,pe)}(X,this):(this.realloc(4),this.buf[this.pos++]=127&X|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=X>>>7&127))))},writeSVarint:function(X){this.writeVarint(X<0?2*-X-1:2*X)},writeBoolean:function(X){this.writeVarint(!!X)},writeString:function(X){X=String(X),this.realloc(4*X.length),this.pos++;var le=this.pos;this.pos=function(Ce,Ue,Le){for(var ze,ot,Oe=0;Oe<Ue.length;Oe++){if((ze=Ue.charCodeAt(Oe))>55295&&ze<57344){if(!ot){ze>56319||Oe+1===Ue.length?(Ce[Le++]=239,Ce[Le++]=191,Ce[Le++]=189):ot=ze;continue}if(ze<56320){Ce[Le++]=239,Ce[Le++]=191,Ce[Le++]=189,ot=ze;continue}ze=ot-55296<<10|ze-56320|65536,ot=null}else ot&&(Ce[Le++]=239,Ce[Le++]=191,Ce[Le++]=189,ot=null);ze<128?Ce[Le++]=ze:(ze<2048?Ce[Le++]=ze>>6|192:(ze<65536?Ce[Le++]=ze>>12|224:(Ce[Le++]=ze>>18|240,Ce[Le++]=ze>>12&63|128),Ce[Le++]=ze>>6&63|128),Ce[Le++]=63&ze|128)}return Le}(this.buf,X,this.pos);var pe=this.pos-le;pe>=128&&T(le,pe,this),this.pos=le-1,this.writeVarint(pe),this.pos+=pe},writeFloat:function(X){this.realloc(4),c.write(this.buf,X,this.pos,!0,23,4),this.pos+=4},writeDouble:function(X){this.realloc(8),c.write(this.buf,X,this.pos,!0,52,8),this.pos+=8},writeBytes:function(X){var le=X.length;this.writeVarint(le),this.realloc(le);for(var pe=0;pe<le;pe++)this.buf[this.pos++]=X[pe]},writeRawMessage:function(X,le){this.pos++;var pe=this.pos;X(le,this);var Ce=this.pos-pe;Ce>=128&&T(pe,Ce,this),this.pos=pe-1,this.writeVarint(Ce),this.pos+=Ce},writeMessage:function(X,le,pe){this.writeTag(X,n.Bytes),this.writeRawMessage(le,pe)},writePackedVarint:function(X,le){le.length&&this.writeMessage(X,k,le)},writePackedSVarint:function(X,le){le.length&&this.writeMessage(X,L,le)},writePackedBoolean:function(X,le){le.length&&this.writeMessage(X,D,le)},writePackedFloat:function(X,le){le.length&&this.writeMessage(X,x,le)},writePackedDouble:function(X,le){le.length&&this.writeMessage(X,A,le)},writePackedFixed32:function(X,le){le.length&&this.writeMessage(X,M,le)},writePackedSFixed32:function(X,le){le.length&&this.writeMessage(X,P,le)},writePackedFixed64:function(X,le){le.length&&this.writeMessage(X,B,le)},writePackedSFixed64:function(X,le){le.length&&this.writeMessage(X,H,le)},writeBytesField:function(X,le){this.writeTag(X,n.Bytes),this.writeBytes(le)},writeFixed32Field:function(X,le){this.writeTag(X,n.Fixed32),this.writeFixed32(le)},writeSFixed32Field:function(X,le){this.writeTag(X,n.Fixed32),this.writeSFixed32(le)},writeFixed64Field:function(X,le){this.writeTag(X,n.Fixed64),this.writeFixed64(le)},writeSFixed64Field:function(X,le){this.writeTag(X,n.Fixed64),this.writeSFixed64(le)},writeVarintField:function(X,le){this.writeTag(X,n.Varint),this.writeVarint(le)},writeSVarintField:function(X,le){this.writeTag(X,n.Varint),this.writeSVarint(le)},writeStringField:function(X,le){this.writeTag(X,n.Bytes),this.writeString(le)},writeFloatField:function(X,le){this.writeTag(X,n.Fixed32),this.writeFloat(le)},writeDoubleField:function(X,le){this.writeTag(X,n.Fixed64),this.writeDouble(le)},writeBooleanField:function(X,le){this.writeVarintField(X,!!le)}},dx}var Dy=S(jE());const fx=3;function GB(c,n,s){n.glyphs=[],c===1&&s.readMessage(WB,n)}function WB(c,n,s){if(c===3){const{id:u,bitmap:m,width:h,height:v,left:T,top:k,advance:L}=s.readMessage(qB,{});n.glyphs.push({id:u,bitmap:new Su({width:h+2*fx,height:v+2*fx},m),metrics:{width:h,height:v,left:T,top:k,advance:L}})}else c===4?n.ascender=s.readSVarint():c===5&&(n.descender=s.readSVarint())}function qB(c,n,s){c===1?n.id=s.readVarint():c===2?n.bitmap=s.readBytes():c===3?n.width=s.readVarint():c===4?n.height=s.readVarint():c===5?n.left=s.readSVarint():c===6?n.top=s.readSVarint():c===7&&(n.advance=s.readVarint())}const HE=fx,ca={horizontal:1,vertical:2,horizontalOnly:3};class Eg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const u=new Eg;return u.scale=n||1,u.fontStack=s,u}static forImage(n){const s=new Eg;return s.imageName=n,s}}class Ff{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const u=new Ff;for(let m=0;m<n.sections.length;m++){const h=n.sections[m];h.image?u.addImageSection(h):u.addTextSection(h,s)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(s,u){let m="";for(let h=0;h<s.length;h++){const v=s.charCodeAt(h+1)||null,T=s.charCodeAt(h-1)||null;m+=!u&&(v&&Um(v)&&!Cg[s[h+1]]||T&&Um(T)&&!Cg[s[h-1]])||!Cg[s[h]]?s[h]:Cg[s[h]]}return m}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&Ly[this.text.charCodeAt(u)];u++)n++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&Ly[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const u=new Ff;return u.text=this.text.substring(n,s),u.sectionIndex=this.sectionIndex.slice(n,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Eg.forText(n.scale,n.fontStack||s));const u=this.sections.length-1;for(let m=0;m<n.text.length;++m)this.sectionIndex.push(u)}addImageSection(n){const s=n.image?n.image.namePrimary:"";if(s.length===0)return void Mn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(Eg.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Mn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function px(c,n,s,u,m,h,v,T,k,L,x,A,D,M,P){const B=Ff.fromFeature(c,m);A===ca.vertical&&B.verticalizePunctuation(D);let H=[];const Z=function(pe,Ce,Ue,Le,ze,ot){if(!pe)return[];const Oe=[],et=function(Mt,kt,St,Yt,gn,Ut){let zn=0;for(let En=0;En<Mt.length();En++){const xn=Mt.getSection(En);zn+=GE(Mt.getCodePoint(En),xn,Yt,gn,kt,Ut)}return zn/Math.max(1,Math.ceil(zn/St))}(pe,Ce,Ue,Le,ze,ot),ct=pe.text.indexOf("​")>=0;let ut=0;for(let Mt=0;Mt<pe.length();Mt++){const kt=pe.getSection(Mt),St=pe.getCodePoint(Mt);if(Ly[St]||(ut+=GE(St,kt,Le,ze,Ce,ot)),Mt<pe.length()-1){const Yt=!((_t=St)<11904||!(Jn["Bopomofo Extended"](_t)||Jn.Bopomofo(_t)||Jn["CJK Compatibility Forms"](_t)||Jn["CJK Compatibility Ideographs"](_t)||Jn["CJK Compatibility"](_t)||Jn["CJK Radicals Supplement"](_t)||Jn["CJK Strokes"](_t)||Jn["CJK Symbols and Punctuation"](_t)||Jn["CJK Unified Ideographs Extension A"](_t)||Jn["CJK Unified Ideographs"](_t)||Jn["Enclosed CJK Letters and Months"](_t)||Jn["Halfwidth and Fullwidth Forms"](_t)||Jn.Hiragana(_t)||Jn["Ideographic Description Characters"](_t)||Jn["Kangxi Radicals"](_t)||Jn["Katakana Phonetic Extensions"](_t)||Jn.Katakana(_t)||Jn["Vertical Forms"](_t)||Jn["Yi Radicals"](_t)||Jn["Yi Syllables"](_t)));(KB[St]||Yt||kt.imageName)&&Oe.push(qE(Mt+1,ut,et,Oe,ZB(St,pe.getCodePoint(Mt+1),Yt&&ct),!1))}}var _t;return KE(qE(pe.length(),ut,et,Oe,0,!0))}(B,L,h,n,u,M),{processBidirectionalText:te,processStyledBidirectionalText:ne}=Is;if(te&&B.sections.length===1){const pe=te(B.toString(),Z);for(const Ce of pe){const Ue=new Ff;Ue.text=Ce,Ue.sections=B.sections;for(let Le=0;Le<Ce.length;Le++)Ue.sectionIndex.push(0);H.push(Ue)}}else if(ne){const pe=ne(B.text,B.sectionIndex,Z);for(const Ce of pe){const Ue=new Ff;Ue.text=Ce[0],Ue.sectionIndex=Ce[1],Ue.sections=B.sections,H.push(Ue)}}else H=function(pe,Ce){const Ue=[],Le=pe.text;let ze=0;for(const ot of Ce)Ue.push(pe.substring(ze,ot)),ze=ot;return ze<Le.length&&Ue.push(pe.substring(ze,Le.length)),Ue}(B,Z);const X=[],le={positionedLines:X,text:B.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:A,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(pe,Ce,Ue,Le,ze,ot,Oe,et,ct,ut,_t,Mt){let kt=0,St=0,Yt=0;const gn=et==="right"?1:et==="left"?0:.5;let Ut=!1;for(const Ln of ze){const Gn=Ln.getSections();for(const wo of Gn){if(wo.imageName)continue;const Do=Ce[wo.fontStack];if(Do&&(Ut=Do.ascender!==void 0&&Do.descender!==void 0,!Ut))break}if(!Ut)break}let zn=0;for(const Ln of ze){Ln.trim();const Gn=Ln.getMaxScale(),wo=(Gn-1)*zi,Do={positionedGlyphs:[],lineOffset:0};pe.positionedLines[zn]=Do;const zo=Do.positionedGlyphs;let Ao=0;if(!Ln.length()){St+=ot,++zn;continue}let Uo=0,No=0;for(let br=0;br<Ln.length();br++){const go=Ln.getSection(br),ur=Ln.getSectionIndex(br),fr=Ln.getCodePoint(br);let Vr=go.scale,si=null,gi=null,ai=null,Qr=zi,ci=0;const bi=!(ct===ca.horizontal||!_t&&!lu(fr)||_t&&(Ly[fr]||(En=fr,Jn.Arabic(En)||Jn["Arabic Supplement"](En)||Jn["Arabic Extended-A"](En)||Jn["Arabic Presentation Forms-A"](En)||Jn["Arabic Presentation Forms-B"](En))));if(go.imageName){const Bi=Le[go.imageName];if(!Bi)continue;ai=go.imageName,pe.iconsInText=pe.iconsInText||!0,gi=Bi.paddedRect;const Fr=Bi.displaySize;Vr=Vr*zi/Mt,si={width:Fr[0],height:Fr[1],left:0,top:-HE,advance:bi?Fr[1]:Fr[0],localGlyph:!1},ci=Ut?-si.height*Vr:Gn*zi-17-Fr[1]*Vr,Qr=si.advance;const ks=(bi?Fr[0]:Fr[1])*Vr-zi*Gn;ks>0&&ks>Ao&&(Ao=ks)}else{const Bi=Ue[go.fontStack];if(!Bi)continue;Bi[fr]&&(gi=Bi[fr]);const Fr=Ce[go.fontStack];if(!Fr)continue;const ks=Fr.glyphs[fr];if(!ks)continue;if(si=ks.metrics,Qr=fr!==8203?zi:0,Ut){const al=Fr.ascender!==void 0?Math.abs(Fr.ascender):0,Aa=Fr.descender!==void 0?Math.abs(Fr.descender):0,ka=(al+Aa)*Vr;Uo<ka&&(Uo=ka,No=(al-Aa)/2*Vr),ci=-al*Vr}else ci=(Gn-Vr)*zi-17}bi?(pe.verticalizable=!0,zo.push({glyph:fr,imageName:ai,x:kt,y:St+ci,vertical:bi,scale:Vr,localGlyph:si.localGlyph,fontStack:go.fontStack,sectionIndex:ur,metrics:si,rect:gi}),kt+=Qr*Vr+ut):(zo.push({glyph:fr,imageName:ai,x:kt,y:St+ci,vertical:bi,scale:Vr,localGlyph:si.localGlyph,fontStack:go.fontStack,sectionIndex:ur,metrics:si,rect:gi}),kt+=si.advance*Vr+ut)}zo.length!==0&&(Yt=Math.max(kt-ut,Yt),Ut?ZE(zo,gn,Ao,No,ot*Gn/2):ZE(zo,gn,Ao,0,ot/2)),kt=0;const Ir=ot*Gn+Ao;Do.lineOffset=Math.max(Ao,wo),St+=Ir,++zn}var En;const xn=St,{horizontalAlign:pn,verticalAlign:no}=mx(Oe);(function(Ln,Gn,wo,Do,zo,Ao){const Uo=(Gn-wo)*zo,No=-Ao*Do;for(const Ir of Ln)for(const br of Ir.positionedGlyphs)br.x+=Uo,br.y+=No})(pe.positionedLines,gn,pn,no,Yt,xn),pe.top+=-no*xn,pe.bottom=pe.top+xn,pe.left+=-pn*Yt,pe.right=pe.left+Yt,pe.hasBaseline=Ut}(le,n,s,u,H,v,T,k,A,L,D,P),!function(pe){for(const Ce of pe)if(Ce.positionedGlyphs.length!==0)return!1;return!0}(X)&&le}const Ly={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},KB={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function GE(c,n,s,u,m,h){if(n.imageName){const v=u[n.imageName];return v?v.displaySize[0]*n.scale*zi/h+m:0}{const v=s[n.fontStack],T=v&&v.glyphs[c];return T?T.metrics.advance*n.scale+m:0}}function WE(c,n,s,u){const m=Math.pow(c-n,2);return u?c<n?m/2:2*m:m+Math.abs(s)*s}function ZB(c,n,s){let u=0;return c===10&&(u-=1e4),s&&(u+=150),c!==40&&c!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function qE(c,n,s,u,m,h){let v=null,T=WE(n,s,m,h);for(const k of u){const L=WE(n-k.x,s,m,h)+k.badness;L<=T&&(v=k,T=L)}return{index:c,x:n,priorBreak:v,badness:T}}function KE(c){return c?KE(c.priorBreak).concat(c.index):[]}function mx(c){let n=.5,s=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function ZE(c,n,s,u,m){if(!(n||s||u||m))return;const h=c.length-1,v=c[h],T=(v.x+v.metrics.advance*v.scale)*n;for(let k=0;k<=h;k++)c[k].x-=T,c[k].y+=s+u+m}function YB(c,n,s,u){const{horizontalAlign:m,verticalAlign:h}=mx(u),v=s[0]-c.displaySize[0]*m,T=s[1]-c.displaySize[1]*h;return{imagePrimary:c,imageSecondary:n,top:T,bottom:T+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function YE(c,n,s,u,m,h){const v=c.imagePrimary;let T;if(v.content){const H=v.content,Z=v.pixelRatio||1;T=[H[0]/Z,H[1]/Z,v.displaySize[0]-H[2]/Z,v.displaySize[1]-H[3]/Z]}const k=n.left*h,L=n.right*h;let x,A,D,M;s==="width"||s==="both"?(M=m[0]+k-u[3],A=m[0]+L+u[1]):(M=m[0]+(k+L-v.displaySize[0])/2,A=M+v.displaySize[0]);const P=n.top*h,B=n.bottom*h;return s==="height"||s==="both"?(x=m[1]+P-u[0],D=m[1]+B+u[2]):(x=m[1]+(P+B-v.displaySize[1])/2,D=x+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:x,right:A,bottom:D,left:M,collisionPadding:T}}class yc extends Fe{constructor(n,s,u,m,h){super(n,s),this.angle=m,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new yc(this.x,this.y,this.z,this.angle,this.segment)}}function XE(c,n,s,u,m){if(n.segment===void 0)return!0;let h=n,v=n.segment+1,T=0;for(;T>-s/2;){if(v--,v<0)return!1;T-=c[v].dist(h),h=c[v]}T+=c[v].dist(c[v+1]),v++;const k=[];let L=0;for(;T<s/2;){const x=c[v],A=c[v+1];if(!A)return!1;let D=c[v-1].angleTo(x)-x.angleTo(A);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:T,angleDelta:D}),L+=D;T-k[0].distance>u;)L-=k.shift().angleDelta;if(L>m)return!1;v++,T+=x.dist(A)}return!0}function JE(c){let n=0;for(let s=0;s<c.length-1;s++)n+=c[s].dist(c[s+1]);return n}function QE(c,n,s){return c?.6*n*s:0}function eM(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function XB(c,n,s,u,m,h){const v=QE(s,m,h),T=eM(s,u)*h;let k=0;const L=JE(c)/2;for(let x=0;x<c.length-1;x++){const A=c[x],D=c[x+1],M=A.dist(D);if(k+M>L){const P=(L-k)/M,B=mo(A.x,D.x,P),H=mo(A.y,D.y,P),Z=new yc(B,H,0,D.angleTo(A),x);return!v||XE(c,Z,T,v,n)?Z:void 0}k+=M}}function JB(c,n,s,u,m,h,v,T,k){const L=QE(u,h,v),x=eM(u,m),A=x*v,D=c[0].x===0||c[0].x===k||c[0].y===0||c[0].y===k;return n-A<n/4&&(n=A+n/4),tM(c,D?n/2*T%n:(x/2+2*h)*v*T%n,n,L,s,A,D,!1,k)}function tM(c,n,s,u,m,h,v,T,k){const L=h/2,x=JE(c);let A=0,D=n-s,M=[];for(let P=0;P<c.length-1;P++){const B=c[P],H=c[P+1],Z=B.dist(H),te=H.angleTo(B);for(;D+s<A+Z;){D+=s;const ne=(D-A)/Z,X=mo(B.x,H.x,ne),le=mo(B.y,H.y,ne);if(X>=0&&X<k&&le>=0&&le<k&&D-L>=0&&D+L<=x){const pe=new yc(X,le,0,te,P);u&&!XE(c,pe,h,u,m)||M.push(pe)}}A+=Z}return T||M.length||v||(M=tM(c,A/2,s,u,m,h,v,!0,k)),M}function nM(c,n,s,u,m){const h=[];for(let v=0;v<c.length;v++){const T=c[v];let k;for(let L=0;L<T.length-1;L++){let x=T[L],A=T[L+1];x.x<n&&A.x<n||(x.x<n?x=new Fe(n,x.y+(n-x.x)/(A.x-x.x)*(A.y-x.y))._round():A.x<n&&(A=new Fe(n,x.y+(n-x.x)/(A.x-x.x)*(A.y-x.y))._round()),x.y<s&&A.y<s||(x.y<s?x=new Fe(x.x+(s-x.y)/(A.y-x.y)*(A.x-x.x),s)._round():A.y<s&&(A=new Fe(x.x+(s-x.y)/(A.y-x.y)*(A.x-x.x),s)._round()),x.x>=u&&A.x>=u||(x.x>=u?x=new Fe(u,x.y+(u-x.x)/(A.x-x.x)*(A.y-x.y))._round():A.x>=u&&(A=new Fe(u,x.y+(u-x.x)/(A.x-x.x)*(A.y-x.y))._round()),x.y>=m&&A.y>=m||(x.y>=m?x=new Fe(x.x+(m-x.y)/(A.y-x.y)*(A.x-x.x),m)._round():A.y>=m&&(A=new Fe(x.x+(m-x.y)/(A.y-x.y)*(A.x-x.x),m)._round()),k&&x.equals(k[k.length-1])||(k=[x],h.push(k)),k.push(A)))))}}return h}function oM(c){let n=0,s=0;for(const v of c)n+=v.w*v.h,s=Math.max(s,v.w);c.sort((v,T)=>T.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let m=0,h=0;for(const v of c)for(let T=u.length-1;T>=0;T--){const k=u[T];if(!(v.w>k.w||v.h>k.h)){if(v.x=k.x,v.y=k.y,h=Math.max(h,v.y+v.h),m=Math.max(m,v.x+v.w),v.w===k.w&&v.h===k.h){const L=u.pop();T<u.length&&(u[T]=L)}else v.h===k.h?(k.x+=v.w,k.w-=v.w):v.w===k.w?(k.y+=v.h,k.h-=v.h):(u.push({x:k.x+v.w,y:k.y,w:k.w-v.w,h:v.h}),k.y+=v.h,k.h-=v.h);break}}return{w:m,h,fill:n/(m*h)||0}}jn(yc,"Anchor");const Mg=1;class gx{constructor(n,{pixelRatio:s,version:u,stretchX:m,stretchY:h,content:v},T){this.paddedRect=n,this.pixelRatio=s,this.stretchX=m,this.stretchY=h,this.content=v,this.version=u,this.padding=T}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class rM{constructor(n,s,u){const m={},h={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,m,Mg,v),this.addImages(s,h,2,v);const{w:T,h:k}=oM(v),L=new es({width:T||1,height:k||1});for(const x in n){const A=n[x],D=m[x].paddedRect;es.copy(A.data,L,{x:0,y:0},{x:D.x+Mg,y:D.y+Mg},A.data,u,A.sdf)}for(const x in s){const A=s[x],D=h[x].paddedRect;let M=h[x].padding;const P=D.x+M,B=D.y+M,H=A.data.width,Z=A.data.height;M=M>1?M-1:M,es.copy(A.data,L,{x:0,y:0},{x:P,y:B},A.data,u),es.copy(A.data,L,{x:0,y:Z-M},{x:P,y:B-M},{width:H,height:M},u),es.copy(A.data,L,{x:0,y:0},{x:P,y:B+Z},{width:H,height:M},u),es.copy(A.data,L,{x:H-M,y:0},{x:P-M,y:B},{width:M,height:Z},u),es.copy(A.data,L,{x:0,y:0},{x:P+H,y:B},{width:M,height:Z},u),es.copy(A.data,L,{x:H-M,y:Z-M},{x:P-M,y:B-M},{width:M,height:M},u),es.copy(A.data,L,{x:0,y:Z-M},{x:P+H,y:B-M},{width:M,height:M},u),es.copy(A.data,L,{x:0,y:0},{x:P+H,y:B+Z},{width:M,height:M},u),es.copy(A.data,L,{x:H-M,y:0},{x:P-M,y:B+Z},{width:M,height:M},u)}this.image=L,this.iconPositions=m,this.patternPositions=h}addImages(n,s,u,m){for(const h in n){const v=n[h],T={x:0,y:0,w:v.data.width+2*u,h:v.data.height+2*u};m.push(T),s[h]=new gx(T,v,u),v.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(n,s,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>n.hasImage(m,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const m in n.getUpdatedImages(u))this.patchUpdatedImage(this.iconPositions[m],n.getImage(m,u),s),this.patchUpdatedImage(this.patternPositions[m],n.getImage(m,u),s)}patchUpdatedImage(n,s,u){if(!n||!s||n.version===s.version)return;n.version=s.version;const[m,h]=n.tl;u.update(s.data,{position:{x:m,y:h}})}}jn(gx,"ImagePosition"),jn(rM,"ImageAtlas");const Ig=1e20;function iM(c,n,s,u,m,h,v,T,k){for(let L=n;L<n+u;L++)sM(c,s*h+L,h,m,v,T,k);for(let L=s;L<s+m;L++)sM(c,L*h+n,1,u,v,T,k)}function sM(c,n,s,u,m,h,v){h[0]=0,v[0]=-Ig,v[1]=Ig,m[0]=c[n];for(let T=1,k=0,L=0;T<u;T++){m[T]=c[n+T*s];const x=T*T;do{const A=h[k];L=(m[T]-m[A]+x-A*A)/(T-A)/2}while(L<=v[k]&&--k>-1);k++,h[k]=T,v[k]=L,v[k+1]=Ig}for(let T=0,k=0;T<u;T++){for(;v[k+1]<T;)k++;const L=h[k],x=T-L;c[n+T*s]=m[L]+x*x}}const ol=2,vx={none:0,ideographs:1,all:2};class Nf{constructor(n,s,u){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,s){this.urls[s]=n}getGlyphs(n,s,u){const m=[],h=this.urls[s]||He.GLYPHS_URL;for(const v in n)for(const T of n[v])m.push({stack:v,id:T});lo(m,({stack:v,id:T},k)=>{let L=this.entries[v];L||(L=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=L.glyphs[T];if(x!==void 0)return void k(null,{stack:v,id:T,glyph:x});if(x=this._tinySDF(L,v,T),x)return L.glyphs[T]=x,void k(null,{stack:v,id:T,glyph:x});const A=Math.floor(T/256);if(256*A>65535)return Mn("glyphs > 65535 not supported"),void k(null,{stack:v,id:T,glyph:x});if(L.ranges[A])return void k(null,{stack:v,id:T,glyph:x});let D=L.requests[A];D||(D=L.requests[A]=[],Nf.loadGlyphRange(v,A,h,this.requestManager,(M,P)=>{if(P){L.ascender=P.ascender,L.descender=P.descender;for(const B in P.glyphs)this._doesCharSupportLocalGlyph(+B)||(L.glyphs[+B]=P.glyphs[+B]);L.ranges[A]=!0}for(const B of D)B(M,P);delete L.requests[A]})),D.push((M,P)=>{M?k(M):P&&k(null,{stack:v,id:T,glyph:P.glyphs[T]||null})})},(v,T)=>{if(v)u(v);else if(T){const k={};for(const{stack:L,id:x,glyph:A}of T)k[L]===void 0&&(k[L]={}),k[L].glyphs===void 0&&(k[L].glyphs={}),k[L].glyphs[x]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},k[L].ascender=this.entries[L].ascender,k[L].descender=this.entries[L].descender;u(null,k)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==vx.none&&(this.localGlyphMode===vx.all?!!this.localFontFamily:!!this.localFontFamily&&(Jn["CJK Unified Ideographs"](n)||Jn["Hangul Syllables"](n)||Jn.Hiragana(n)||Jn.Katakana(n)||Jn["CJK Symbols and Punctuation"](n)||Jn["CJK Unified Ideographs Extension A"](n)||Jn["CJK Unified Ideographs Extension B"](n)||Jn.Osage(n)))}_tinySDF(n,s,u){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(u))return;let h=n.tinySDF;if(!h){let B="400";/bold/i.test(s)?B="900":/medium/i.test(s)?B="500":/light/i.test(s)&&(B="200"),h=n.tinySDF=new Nf.TinySDF({fontFamily:m,fontWeight:B,fontSize:24*ol,buffer:3*ol,radius:8*ol}),h.fontWeight=B}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const v=String.fromCodePoint(u),{data:T,width:k,height:L,glyphWidth:x,glyphHeight:A,glyphLeft:D,glyphTop:M,glyphAdvance:P}=h.draw(v);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new Su({width:k,height:L},T),metrics:{width:x/ol,height:A/ol,left:D/ol,top:M/ol-27,advance:P/ol,localGlyph:!0}}}}Nf.loadGlyphRange=function(c,n,s,u,m){const h=256*n,v=h+255,T=u.transformRequest(u.normalizeGlyphsURL(s).replace("{fontstack}",c).replace("{range}",`${h}-${v}`),Nh.Glyphs);Fc(T,(k,L)=>{if(k)m(k);else if(L){const x={},A=function(D){return new Dy(D).readFields(GB,{})}(L);for(const D of A.glyphs)x[D.id]=D;m(null,{glyphs:x,ascender:A.ascender,descender:A.descender})}})},Nf.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:s=8,cutoff:u=.25,fontFamily:m="sans-serif",fontWeight:h="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=s;const T=this.size=c+4*n,k=this._createCanvas(T),L=this.ctx=k.getContext("2d",{willReadFrequently:!0});L.font=`${v} ${h} ${c}px ${m}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:m,actualBoundingBoxRight:h}=this.ctx.measureText(c),v=Math.ceil(s),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-m))),k=Math.min(this.size-this.buffer,v+Math.ceil(u)),L=T+2*this.buffer,x=k+2*this.buffer,A=Math.max(L*x,0),D=new Uint8ClampedArray(A),M={data:D,width:L,height:x,glyphWidth:T,glyphHeight:k,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(T===0||k===0)return M;const{ctx:P,buffer:B,gridInner:H,gridOuter:Z}=this;P.clearRect(B,B,T,k),P.fillText(c,B,B+v);const te=P.getImageData(B,B,T,k);Z.fill(Ig,0,A),H.fill(0,0,A);for(let ne=0;ne<k;ne++)for(let X=0;X<T;X++){const le=te.data[4*(ne*T+X)+3]/255;if(le===0)continue;const pe=(ne+B)*L+X+B;if(le===1)Z[pe]=0,H[pe]=Ig;else{const Ce=.5-le;Z[pe]=Ce>0?Ce*Ce:0,H[pe]=Ce<0?Ce*Ce:0}}iM(Z,0,0,L,x,L,this.f,this.v,this.z),iM(H,B,B,T,k,L,this.f,this.v,this.z);for(let ne=0;ne<A;ne++){const X=Math.sqrt(Z[ne])-Math.sqrt(H[ne]);D[ne]=Math.round(255-255*(X/this.radius+this.cutoff))}return M}};const Cu=Mg;function aM(c,n,s,u,m=1){const h=[],v=c.imagePrimary,T=v.pixelRatio,k=v.paddedRect.w-2*Cu,L=v.paddedRect.h-2*Cu,x=(c.right-c.left)*m,A=(c.bottom-c.top)*m,D=v.stretchX||[[0,k]],M=v.stretchY||[[0,L]],P=(Oe,et)=>Oe+et[1]-et[0],B=D.reduce(P,0),H=M.reduce(P,0),Z=k-B,te=L-H;let ne=0,X=B,le=0,pe=H,Ce=0,Ue=Z,Le=0,ze=te;if(v.content&&u){const Oe=v.content;ne=Oy(D,0,Oe[0]),le=Oy(M,0,Oe[1]),X=Oy(D,Oe[0],Oe[2]),pe=Oy(M,Oe[1],Oe[3]),Ce=Oe[0]-ne,Le=Oe[1]-le,Ue=Oe[2]-Oe[0]-X,ze=Oe[3]-Oe[1]-pe}const ot=(Oe,et,ct,ut)=>{const _t=zy(Oe.stretch-ne,X,x,c.left*m),Mt=By(Oe.fixed-Ce,Ue,Oe.stretch,B),kt=zy(et.stretch-le,pe,A,c.top*m),St=By(et.fixed-Le,ze,et.stretch,H),Yt=zy(ct.stretch-ne,X,x,c.left*m),gn=By(ct.fixed-Ce,Ue,ct.stretch,B),Ut=zy(ut.stretch-le,pe,A,c.top*m),zn=By(ut.fixed-Le,ze,ut.stretch,H),En=new Fe(_t,kt),xn=new Fe(Yt,kt),pn=new Fe(Yt,Ut),no=new Fe(_t,Ut),Ln=new Fe(Mt/T,St/T),Gn=new Fe(gn/T,zn/T),wo=n*Math.PI/180;if(wo){const Ir=Math.sin(wo),br=Math.cos(wo),go=[br,-Ir,Ir,br];En._matMult(go),xn._matMult(go),no._matMult(go),pn._matMult(go)}const Do=Oe.stretch+Oe.fixed,zo=ct.stretch+ct.fixed,Ao=et.stretch+et.fixed,Uo=ut.stretch+ut.fixed,No=c.imageSecondary;return{tl:En,tr:xn,bl:no,br:pn,texPrimary:{x:v.paddedRect.x+Cu+Do,y:v.paddedRect.y+Cu+Ao,w:zo-Do,h:Uo-Ao},texSecondary:No?{x:No.paddedRect.x+Cu+Do,y:No.paddedRect.y+Cu+Ao,w:zo-Do,h:Uo-Ao}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ln,pixelOffsetBR:Gn,minFontScaleX:Ue/T/x,minFontScaleY:ze/T/A,isSDF:s}};if(u&&(v.stretchX||v.stretchY)){const Oe=lM(D,Z,B),et=lM(M,te,H);for(let ct=0;ct<Oe.length-1;ct++){const ut=Oe[ct],_t=Oe[ct+1];for(let Mt=0;Mt<et.length-1;Mt++)h.push(ot(ut,et[Mt],_t,et[Mt+1]))}}else h.push(ot({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:L+1}));return h}function Oy(c,n,s){let u=0;for(const m of c)u+=Math.max(n,Math.min(s,m[1]))-Math.max(n,Math.min(s,m[0]));return u}function lM(c,n,s){const u=[{fixed:-Cu,stretch:0}];for(const[m,h]of c){const v=u[u.length-1];u.push({fixed:m-v.stretch,stretch:v.stretch}),u.push({fixed:m-v.stretch,stretch:v.stretch+(h-m)})}return u.push({fixed:n+Cu,stretch:s}),u}function zy(c,n,s,u){return c/n*s+u}function By(c,n,s,u){return c-n*s/u}function QB(c,n,s,u){const m=n+c.positionedLines[u].lineOffset;return u===0?s+m/2:s+(m+(n+c.positionedLines[u-1].lineOffset))/2}function eF(c,n=1,s=!1){let u=1/0,m=1/0,h=-1/0,v=-1/0;const T=c[0];for(let M=0;M<T.length;M++){const P=T[M];(!M||P.x<u)&&(u=P.x),(!M||P.y<m)&&(m=P.y),(!M||P.x>h)&&(h=P.x),(!M||P.y>v)&&(v=P.y)}const k=Math.min(h-u,v-m);let L=k/2;const x=new hm([],tF);if(k===0)return new Fe(u,m);for(let M=u;M<h;M+=k)for(let P=m;P<v;P+=k)x.push(new $f(M+L,P+L,L,c));let A=function(M){let P=0,B=0,H=0;const Z=M[0];for(let te=0,ne=Z.length,X=ne-1;te<ne;X=te++){const le=Z[te],pe=Z[X],Ce=le.x*pe.y-pe.x*le.y;B+=(le.x+pe.x)*Ce,H+=(le.y+pe.y)*Ce,P+=3*Ce}return new $f(B/P,H/P,0,M)}(c),D=x.length;for(;x.length;){const M=x.pop();(M.d>A.d||!A.d)&&(A=M,s&&console.log("found best %d after %d probes",Math.round(1e4*M.d)/1e4,D)),M.max-A.d<=n||(L=M.h/2,x.push(new $f(M.p.x-L,M.p.y-L,L,c)),x.push(new $f(M.p.x+L,M.p.y-L,L,c)),x.push(new $f(M.p.x-L,M.p.y+L,L,c)),x.push(new $f(M.p.x+L,M.p.y+L,L,c)),D+=4)}return s&&(console.log(`num probes: ${D}`),console.log(`best distance: ${A.d}`)),A.p}function tF(c,n){return n.max-c.max}class $f{constructor(n,s,u,m){this.p=new Fe(n,s),this.h=u,this.d=function(h,v){let T=!1,k=1/0;for(let L=0;L<v.length;L++){const x=v[L];for(let A=0,D=x.length,M=D-1;A<D;M=A++){const P=x[A],B=x[M];P.y>h.y!=B.y>h.y&&h.x<(B.x-P.x)*(h.y-P.y)/(B.y-P.y)+P.x&&(T=!T),k=Math.min(k,ho(h,P,B))}}return(T?1:-1)*Math.sqrt(k)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const _x=Number.POSITIVE_INFINITY,nF=Math.sqrt(2);function cM(c,[n,s]){let u=0,m=0;if(s===_x){n<0&&(n=0);const h=n/nF;switch(c){case"top-right":case"top-left":m=h-7;break;case"bottom-right":case"bottom-left":m=7-h;break;case"bottom":m=7-n;break;case"top":m=n-7}switch(c){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),c){case"top-right":case"top-left":case"top":m=s-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-s}switch(c){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,m]}function yx(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function oF(c,n,s,u,m,h,v,T,k,L,x,A,D,M,P){let B=h.textMaxSize.evaluate(n,{},A);B===void 0?B=v*h.textScaleFactor:B*=h.textScaleFactor;const H=c.layers[0].layout,Z=H.get("icon-offset").evaluate(n,{},A),te=dM(s.horizontal)||s.vertical,ne=D.name==="globe",X=zi,le=v*h.textScaleFactor/X,pe=c.tilePixelRatio*B/X,Ce=(ut=c.overscaling,c.zoom>18&&ut>2&&(ut>>=1),Math.max(In/(512*ut),1)*H.get("symbol-spacing")),Ue=H.get("text-padding")*c.tilePixelRatio,Le=H.get("icon-padding")*c.tilePixelRatio,ze=xt(H.get("text-max-angle")),ot=H.get("text-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",Oe=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",et=H.get("symbol-placement"),ct=Ce/2;var ut;const _t=H.get("icon-text-fit").evaluate(n,{},A),Mt=H.get("icon-text-fit-padding").evaluate(n,{},A),kt=_t!=="none";let St;c.hasAnyIconTextFit===!1&&kt&&(c.hasAnyIconTextFit=!0),u&&kt&&(c.allowVerticalPlacement&&s.vertical&&(St=YE(u,s.vertical,_t,Mt,Z,le)),te&&(u=YE(u,te,_t,Mt,Z,le)));const Yt=(gn,Ut,zn)=>{if(Ut.x<0||Ut.x>=In||Ut.y<0||Ut.y>=In)return;let En=null;if(ne){const{x:xn,y:pn,z:no}=D.projectTilePoint(Ut.x,Ut.y,zn);En={anchor:new yc(xn,pn,no,0,void 0),up:D.upVector(zn,Ut.x,Ut.y)}}(function(xn,pn,no,Ln,Gn,wo,Do,zo,Ao,Uo,No,Ir,br,go,ur,fr,Vr,si,gi,ai,Qr,ci,bi,Bi,Fr,ks,al){const Aa=xn.addToLineVertexArray(pn,Ln);let ka,Yd,ku,Xd,qg,PI,RI,DI=0,LI=0,OI=0,zI=0,Kx=-1,Zx=-1;const Bl={};let BI=ss("");const Jd=no?no.anchor:pn,Yx=Ao.layout.get("icon-text-fit").evaluate(Qr,{},Fr)!=="none";let Xx=0,Jx=0;if(Ao._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Xx,Jx]=Ao.layout.get("text-offset").evaluate(Qr,{},Fr).map(Ws=>Ws*zi):(Xx=Ao.layout.get("text-radial-offset").evaluate(Qr,{},Fr)*zi,Jx=_x),xn.allowVerticalPlacement&&Gn.vertical){const Ws=Gn.vertical;if(ur)PI=bx(Ws),zo&&(RI=bx(zo));else{const qs=Ao.layout.get("text-rotate").evaluate(Qr,{},Fr)+90;ku=Fy(Uo,Jd,pn,No,Ir,br,Ws,go,qs,fr),zo&&(Xd=Fy(Uo,Jd,pn,No,Ir,br,zo,si,qs))}}if(wo){const Ws=Ao.layout.get("icon-rotate").evaluate(Qr,{},Fr),qs=aM(wo,Ws,bi,Yx,ci.iconScaleFactor),Kf=zo?aM(zo,Ws,bi,Yx,ci.iconScaleFactor):void 0;Yd=Fy(Uo,Jd,pn,No,Ir,br,wo,si,Ws),DI=4*qs.length;const FI=xn.iconSizeData;let Qd=null;FI.kind==="source"?(Qd=[nl*Ao.layout.get("icon-size").evaluate(Qr,{},Fr)*ci.iconScaleFactor],Qd[0]>Eu&&Mn(`${xn.layerIds[0]}: Value for "icon-size" is >= ${Ag}. Reduce your "icon-size".`)):FI.kind==="composite"&&(Qd=[nl*ci.compositeIconSizes[0].evaluate(Qr,{},Fr)*ci.iconScaleFactor,nl*ci.compositeIconSizes[1].evaluate(Qr,{},Fr)*ci.iconScaleFactor],(Qd[0]>Eu||Qd[1]>Eu)&&Mn(`${xn.layerIds[0]}: Value for "icon-size" is >= ${Ag}. Reduce your "icon-size".`)),xn.addSymbols(xn.icon,qs,Qd,ai,gi,Qr,!1,no,pn,Aa.lineStartIndex,Aa.lineLength,-1,Bi,Fr,ks,al),Kx=xn.icon.placedSymbolArray.length-1,Kf&&(LI=4*Kf.length,xn.addSymbols(xn.icon,Kf,Qd,ai,gi,Qr,ca.vertical,no,pn,Aa.lineStartIndex,Aa.lineLength,-1,Bi,Fr,ks,al),Zx=xn.icon.placedSymbolArray.length-1)}for(const Ws in Gn.horizontal){const qs=Gn.horizontal[Ws];ka||(BI=ss(qs.text),ur?qg=bx(qs):ka=Fy(Uo,Jd,pn,No,Ir,br,qs,go,Ao.layout.get("text-rotate").evaluate(Qr,{},Fr),fr));const Kf=qs.positionedLines.length===1;if(OI+=uM(xn,no,pn,qs,Do,Ao,ur,Qr,fr,Aa,Gn.vertical?ca.horizontal:ca.horizontalOnly,Kf?Object.keys(Gn.horizontal):[Ws],Bl,Kx,ci,Bi,Fr,ks),Kf)break}Gn.vertical&&(zI+=uM(xn,no,pn,Gn.vertical,Do,Ao,ur,Qr,fr,Aa,ca.vertical,["vertical"],Bl,Zx,ci,Bi,Fr,ks));let Pu=-1;const Qx=(Ws,qs)=>Ws?Math.max(Ws,qs):qs;Pu=Qx(qg,Pu),Pu=Qx(PI,Pu),Pu=Qx(RI,Pu);const _N=Pu>-1?1:0;xn.glyphOffsetArray.length>=65535&&Mn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Qr.sortKey!==void 0&&xn.addToSortKeyRanges(xn.symbolInstances.length,Qr.sortKey),xn.symbolInstances.emplaceBack(pn.x,pn.y,Jd.x,Jd.y,Jd.z,Bl.right>=0?Bl.right:-1,Bl.center>=0?Bl.center:-1,Bl.left>=0?Bl.left:-1,Bl.vertical>=0?Bl.vertical:-1,Kx,Zx,BI,ka!==void 0?ka:xn.collisionBoxArray.length,ka!==void 0?ka+1:xn.collisionBoxArray.length,ku!==void 0?ku:xn.collisionBoxArray.length,ku!==void 0?ku+1:xn.collisionBoxArray.length,Yd!==void 0?Yd:xn.collisionBoxArray.length,Yd!==void 0?Yd+1:xn.collisionBoxArray.length,Xd||xn.collisionBoxArray.length,Xd?Xd+1:xn.collisionBoxArray.length,No,OI,zI,DI,LI,_N,0,Xx,Jx,Pu,0,Yx?1:0)})(c,Ut,En,gn,s,u,m,St,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,Ue,ot,k,0,Le,Oe,Z,n,h,L,x,A,M,P)};if(et==="line")for(const gn of nM(n.geometry,0,0,In,In)){const Ut=JB(gn,Ce,ze,s.vertical||te,u,X,pe,c.overscaling,In);for(const zn of Ut)te&&rF(c,te.text,ct,zn)||Yt(gn,zn,A)}else if(et==="line-center"){for(const gn of n.geometry)if(gn.length>1){const Ut=XB(gn,ze,s.vertical||te,u,X,pe);Ut&&Yt(gn,Ut,A)}}else if(n.type==="Polygon")for(const gn of Cy(n.geometry,0)){const Ut=eF(gn,16);Yt(gn[0],new yc(Ut.x,Ut.y,0,0,void 0),A)}else if(n.type==="LineString")for(const gn of n.geometry)Yt(gn,new yc(gn[0].x,gn[0].y,0,0,void 0),A);else if(n.type==="Point")for(const gn of n.geometry)for(const Ut of gn)Yt([Ut],new yc(Ut.x,Ut.y,0,0,void 0),A)}const Ag=255,Eu=Ag*nl;function uM(c,n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H,Z){const te=function(le,pe,Ce,Ue,Le,ze,ot,Oe){const et=[];if(pe.positionedLines.length===0)return et;const ct=Ue.layout.get("text-rotate").evaluate(ze,{})*Math.PI/180,ut=function(Yt){const gn=Yt[0],Ut=Yt[1],zn=gn*Ut;return zn>0?[gn,-Ut]:zn<0?[-gn,Ut]:gn===0?[Ut,gn]:[Ut,-gn]}(Ce);let _t=Math.abs(pe.top-pe.bottom);for(const Yt of pe.positionedLines)_t-=Yt.lineOffset;const Mt=pe.positionedLines.length,kt=_t/Mt;let St=pe.top-Ce[1];for(let Yt=0;Yt<Mt;++Yt){const gn=pe.positionedLines[Yt];St=QB(pe,kt,St,Yt);for(const Ut of gn.positionedGlyphs){if(!Ut.rect)continue;const zn=Ut.rect||{};let En=HE+1,xn=!0,pn=1,no=0;if(Ut.imageName){const ai=ot[Ut.imageName];if(!ai)continue;if(ai.sdf){Mn("SDF images are not supported in formatted text and will be ignored.");continue}xn=!1,pn=ai.pixelRatio,En=Mg/pn}const Ln=(Le||Oe)&&Ut.vertical,Gn=Ut.metrics.advance*Ut.scale/2,wo=Ut.metrics,Do=Ut.rect;if(Do===null)continue;Oe&&pe.verticalizable&&(no=Ut.imageName?Gn-Ut.metrics.width*Ut.scale/2:0);const zo=Le?[Ut.x+Gn,Ut.y]:[0,0];let Ao=[0,0],Uo=[0,0],No=!1;Le||(Ln?(Uo=[Ut.x+Gn+ut[0],Ut.y+ut[1]-no],No=!0):Ao=[Ut.x+Gn+Ce[0],Ut.y+Ce[1]-no]);const Ir=Do.w*Ut.scale/(pn*(Ut.localGlyph?ol:1)),br=Do.h*Ut.scale/(pn*(Ut.localGlyph?ol:1));let go,ur,fr,Vr;if(Ln){const ai=Ut.y-St,Qr=new Fe(-Gn,Gn-ai),ci=-Math.PI/2,bi=new Fe(...Uo);go=new Fe(-Gn+Ao[0],Ao[1]),go._rotateAround(ci,Qr)._add(bi),go.x+=-ai+Gn,go.y-=(wo.left-En)*Ut.scale;const Bi=Ut.imageName?wo.advance*Ut.scale:zi*Ut.scale,Fr=String.fromCodePoint(Ut.glyph);UB(Fr)?go.x+=(1-En)*Ut.scale:jB(Fr)?go.x+=Bi-wo.height*Ut.scale+(-En-1)*Ut.scale:go.x+=Ut.imageName||wo.width+2*En===Do.w&&wo.height+2*En===Do.h?(Bi-br)/2:(Bi-(wo.height+2*En)*Ut.scale)/2,ur=new Fe(go.x,go.y-Ir),fr=new Fe(go.x+br,go.y),Vr=new Fe(go.x+br,go.y-Ir)}else{const ai=(wo.left-En)*Ut.scale-Gn+Ao[0],Qr=(-wo.top-En)*Ut.scale+Ao[1],ci=ai+Ir,bi=Qr+br;go=new Fe(ai,Qr),ur=new Fe(ci,Qr),fr=new Fe(ai,bi),Vr=new Fe(ci,bi)}if(ct){let ai;ai=Le?new Fe(0,0):No?new Fe(ut[0],ut[1]):new Fe(Ce[0],Ce[1]),go._rotateAround(ct,ai),ur._rotateAround(ct,ai),fr._rotateAround(ct,ai),Vr._rotateAround(ct,ai)}const si=new Fe(0,0),gi=new Fe(0,0);et.push({tl:go,tr:ur,bl:fr,br:Vr,texPrimary:zn,texSecondary:void 0,writingMode:pe.writingMode,glyphOffset:zo,sectionIndex:Ut.sectionIndex,isSDF:xn,pixelOffsetTL:si,pixelOffsetBR:gi,minFontScaleX:0,minFontScaleY:0})}}return et}(0,u,k,h,v,T,m,c.allowVerticalPlacement),ne=c.textSizeData;let X=null;ne.kind==="source"?(X=[nl*h.layout.get("text-size").evaluate(T,{},H)*P.textScaleFactor],X[0]>Eu&&Mn(`${c.layerIds[0]}: Value for "text-size" is >= ${Ag}. Reduce your "text-size".`)):ne.kind==="composite"&&(X=[nl*P.compositeTextSizes[0].evaluate(T,{},H)*P.textScaleFactor,nl*P.compositeTextSizes[1].evaluate(T,{},H)*P.textScaleFactor],(X[0]>Eu||X[1]>Eu)&&Mn(`${c.layerIds[0]}: Value for "text-size" is >= ${Ag}. Reduce your "text-size".`)),c.addSymbols(c.text,te,X,k,v,T,x,n,s,L.lineStartIndex,L.lineLength,M,B,H,Z,!1);for(const le of A)D[le]=c.text.placedSymbolArray.length-1;return 4*te.length}function dM(c){for(const n in c)return c[n];return null}function Fy(c,n,s,u,m,h,v,T,k,L){let x=v.top,A=v.bottom,D=v.left,M=v.right;const P=v.collisionPadding;if(P&&(D-=P[0],x-=P[1],M+=P[2],A+=P[3]),k){const B=new Fe(D,x),H=new Fe(M,x),Z=new Fe(D,A),te=new Fe(M,A),ne=xt(k);let X=new Fe(0,0);L&&(X=new Fe(L[0],L[1])),B._rotateAround(ne,X),H._rotateAround(ne,X),Z._rotateAround(ne,X),te._rotateAround(ne,X),D=Math.min(B.x,H.x,Z.x,te.x),M=Math.max(B.x,H.x,Z.x,te.x),x=Math.min(B.y,H.y,Z.y,te.y),A=Math.max(B.y,H.y,Z.y,te.y)}return c.emplaceBack(n.x,n.y,n.z,s.x,s.y,D,x,M,A,T,u,m,h),c.length-1}function bx(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function rF(c,n,s,u){const m=c.compareText;if(n in m){const h=m[n];for(let v=h.length-1;v>=0;v--)if(u.dist(h[v])<s)return!0}else m[n]=[];return m[n].push(u),!1}function hM(c,n){const s=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,m=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),h=Math.sin(s)*m/Math.sin(Math.max(Math.PI/2-c._pitch-s,.01));let v=Math.sin(c._pitch)*h+m;const T=m*(1/c._horizonShift);return c.elevation&&c.elevation.exaggeration()!==0||(v*=1+Math.max(c.zoom-17,0)),Math.min(1.01*v,T)}function kg(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const s=Math.pow(2,-c.z),u=c.x*s,m=(c.x+1)*s,h=c.y*s,v=(c.y+1)*s,T=Pe(u),k=Pe(m),L=$e(h),x=$e(v),A=n.project(T,L),D=n.project(k,L),M=n.project(k,x),P=n.project(T,x);let B=Math.min(A.x,D.x,M.x,P.x),H=Math.min(A.y,D.y,M.y,P.y),Z=Math.max(A.x,D.x,M.x,P.x),te=Math.max(A.y,D.y,M.y,P.y);const ne=s/16;function X(pe,Ce,Ue,Le,ze,ot){const Oe=(Ue+ze)/2,et=(Le+ot)/2,ct=n.project(Pe(Oe),$e(et)),ut=Math.max(0,B-ct.x,H-ct.y,ct.x-Z,ct.y-te);B=Math.min(B,ct.x),Z=Math.max(Z,ct.x),H=Math.min(H,ct.y),te=Math.max(te,ct.y),ut>ne&&(X(pe,ct,Ue,Le,Oe,et),X(ct,Ce,Oe,et,ze,ot))}X(A,D,u,h,m,h),X(D,M,m,h,m,v),X(M,P,m,v,u,v),X(P,A,u,v,u,h),B-=ne,H-=ne,Z+=ne,te+=ne;const le=1/Math.max(Z-B,te-H);return{scale:le,x:B*le,y:H*le,x2:Z*le,y2:te*le,projection:n}}function fM(c,{x:n,y:s},u=0){return new Fe(((n-u)*c.scale-c.x)*In,(s*c.scale-c.y)*In)}const iF=Be.mat4.identity(new Float32Array(16));class Mu{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new j(0,0)}projectTilePoint(n,s,u){return{x:n,y:s,z:0}}locationPoint(n,s,u=!0){return n._coordinatePoint(n.locationCoordinate(s),u)}pixelsPerMeter(n,s){return be(1,n)*s}pixelSpaceConversion(n,s,u){return 1}farthestPixelDistance(n){return hM(n,n.pixelsPerMeter)}pointCoordinate(n,s,u,m){const h=n.horizonLineFromTop(!1),v=new Fe(s,Math.max(h,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,m))}pointCoordinate3D(n,s,u){const m=new Fe(s,u);if(n.elevation)return n.elevation.pointCoordinate(m);{const h=this.pointCoordinate(n,m.x,m.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(n,s){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,s.x,s.y);const u=n.horizonLineFromTop();return s.y<u}createInversionMatrix(n,s){return iF}createTileMatrix(n,s,u){let m,h,v;const T=u.canonical,k=Be.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const L=kg(T,this);m=1,h=L.x+u.wrap*L.scale,v=L.y,Be.mat4.scale(k,k,[m/L.scale,m/L.scale,n.pixelsPerMeter/s])}else m=s/n.zoomScale(T.z),h=(T.x+Math.pow(2,T.z)*u.wrap)*m,v=T.y*m;return Be.mat4.translate(k,k,[h,v,0]),Be.mat4.scale(k,k,[m/In,m/In,1]),k}upVector(n,s,u){return[0,0,1]}upVectorScale(n,s,u){return{metersToTile:1}}}class sF extends Mu{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,u]=this.parallels=n.parallels||[29.5,45.5],m=Math.sin(xt(s));this.n=(m+Math.sin(xt(u)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:u,c:m,r0:h}=this,v=xt(n-this.center[0]),T=xt(s),k=Math.sqrt(m-2*u*Math.sin(T))/u;return{x:k*Math.sin(v*u),y:k*Math.cos(v*u)-h,z:0}}unproject(n,s){const{n:u,c:m,r0:h}=this,v=h+s;let T=Math.atan2(n,Math.abs(v))*Math.sign(v);v*u<0&&(T-=Math.PI*Math.sign(n)*Math.sign(v));const k=xt(this.center[0])*u;T=Vn(T,-Math.PI-k,Math.PI-k);const L=gt(Ot(T/u)+this.center[0],-180,180),x=Math.asin(gt((m-(n*n+v*v)*u*u)/(2*u),-1,1)),A=gt(Ot(x),-We,We);return new j(L,A)}}const Pg=1.340264,Rg=-.081106,Dg=893e-6,Lg=.003796,Ny=Math.sqrt(3)/2;class aF extends Mu{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(Ny*Math.sin(s)),m=u*u,h=m*m*m;return{x:.5*(n*Math.cos(u)/(Ny*(Pg+3*Rg*m+h*(7*Dg+9*Lg*m)))/Math.PI+.5),y:1-.5*(u*(Pg+Rg*m+h*(Dg+Lg*m))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,m=u*u,h=m*m*m;for(let x,A,D,M=0;M<12&&(A=u*(Pg+Rg*m+h*(Dg+Lg*m))-s,D=Pg+3*Rg*m+h*(7*Dg+9*Lg*m),x=A/D,u=gt(u-x,-Math.PI/3,Math.PI/3),m=u*u,h=m*m*m,!(Math.abs(x)<1e-12));++M);const v=Ny*n*(Pg+3*Rg*m+h*(7*Dg+9*Lg*m))/Math.cos(u),T=Math.asin(Math.sin(u)/Ny),k=gt(180*v/Math.PI,-180,180),L=gt(180*T/Math.PI,-We,We);return new j(k,L)}}class lF extends Mu{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const u=360*(n-.5),m=gt(360*(.5-s),-We,We);return new j(u,m)}}const Vf=Math.PI/2;function $y(c){return Math.tan((Vf+c)/2)}class cF extends Mu{constructor(n){super(n),this.center=n.center||[0,30];const[s,u]=this.parallels=n.parallels||[30,30];let m=xt(s),h=xt(u);this.southernCenter=m+h<0,this.southernCenter&&(m=-m,h=-h);const v=Math.cos(m),T=$y(m);this.n=m===h?Math.sin(m):Math.log(v/Math.cos(h))/Math.log($y(h)/T),this.f=v*Math.pow($y(m),this.n)/this.n}project(n,s){s=xt(s),this.southernCenter&&(s=-s),n=xt(n-this.center[0]);const u=1e-6,{n:m,f:h}=this;h>0?s<-Vf+u&&(s=-Vf+u):s>Vf-u&&(s=Vf-u);const v=h/Math.pow($y(s),m);let T=v*Math.sin(m*n),k=h-v*Math.cos(m*n);return T=.5*(T/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:T,y:this.southernCenter?k:1-k,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:u,f:m}=this,h=m-s,v=Math.sign(h),T=Math.sign(u)*Math.sqrt(n*n+h*h);let k=Math.atan2(n,Math.abs(h))*v;h*u<0&&(k-=Math.PI*Math.sign(n)*v);const L=gt(Ot(k/u)+this.center[0],-180,180),x=gt(Ot(2*Math.atan(Math.pow(m/T,1/u))-Vf),-We,We);return new j(L,this.southernCenter?-x:x)}}class pM extends Mu{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:me(n),y:we(s),z:0}}unproject(n,s){const u=Pe(n),m=$e(s);return new j(u,m)}}const mM=xt(We);class uF extends Mu{project(n,s){const u=(s=xt(s))*s,m=u*u;return{x:.5*((n=xt(n))*(.8707-.131979*u+m*(m*(.003971*u-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+u*(.015085+m*(.028874*u-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,m=25,h=0,v=u*u;do{v=u*u;const L=v*v;h=(u*(1.007226+v*(.015085+L*(.028874*v-.044475-.005916*L)))-s)/(1.007226+v*(.045255+L*(.259866*v-.311325-.005916*11*L))),u=gt(u-h,-mM,mM)}while(Math.abs(h)>1e-6&&--m>0);v=u*u;const T=gt(Ot(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),k=Ot(u);return new j(T,k)}}const gM=xt(We);class dF extends Mu{project(n,s){s=xt(s),n=xt(n);const u=Math.cos(s),m=2/Math.PI,h=Math.acos(u*Math.cos(n/2)),v=Math.sin(h)/h,T=.5*(n*m+2*u*Math.sin(n/2)/v)||0,k=.5*(s+Math.sin(s)/v)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(n,s){let u=n=(2*n-.5)*Math.PI,m=s=(2*(1-s)-1)*Math.PI,h=25;const v=1e-6;let T=0,k=0;do{const L=Math.cos(m),x=Math.sin(m),A=2*x*L,D=x*x,M=L*L,P=Math.cos(u/2),B=Math.sin(u/2),H=2*P*B,Z=B*B,te=1-M*P*P,ne=te?1/te:0,X=te?Math.acos(L*P)*Math.sqrt(1/te):0,le=.5*(2*X*L*B+2*u/Math.PI)-n,pe=.5*(X*x+m)-s,Ce=.5*ne*(M*Z+X*L*P*D)+1/Math.PI,Ue=ne*(H*A/4-X*x*B),Le=.125*ne*(A*B-X*x*M*H),ze=.5*ne*(D*P+X*Z*L)+.5,ot=Ue*Le-ze*Ce;T=(pe*Ue-le*ze)/ot,k=(le*Le-pe*Ce)/ot,u=gt(u-T,-Math.PI,Math.PI),m=gt(m-k,-gM,gM)}while((Math.abs(T)>v||Math.abs(k)>v)&&--h>0);return new j(Ot(u),Ot(m))}}class vM extends Mu{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(xt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:u,cosPhi:m}=this;return{x:xt(n)*m*u+.5,y:-Math.sin(xt(s))/m*u+.5,z:0}}unproject(n,s){const{scale:u,cosPhi:m}=this,h=-(s-.5)/u,v=gt(Ot((n-.5)/u)/m,-180,180),T=Math.asin(gt(h*m,-1,1)),k=gt(Ot(T),-We,We);return new j(v,k)}}class hF extends pM{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,u){const m=pg(n,s,u),h=xy(Ol(u));return Be.vec3.transformMat4(m,m,h),{x:m[0],y:m[1],z:m[2]}}locationPoint(n,s){const u=O(s.lat,s.lng),m=Be.vec3.normalize([],u),h=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude,v=be(1,0)*In*h;Be.vec3.scaleAndAdd(u,u,m,v);const T=Be.mat4.identity(new Float64Array(16));return Be.mat4.multiply(T,n.pixelMatrix,n.globeMatrix),Be.vec3.transformMat4(u,u,T),new Fe(u[0],u[1])}pixelsPerMeter(n,s){return be(1,0)*s}pixelSpaceConversion(n,s,u){const m=be(1,n)*s,h=mo(be(1,45)*s,m,u);return this.pixelsPerMeter(n,s)/h}createTileMatrix(n,s,u){const m=j1(Ol(u.canonical));return Be.mat4.multiply(new Float64Array(16),n.globeMatrix,m)}createInversionMatrix(n,s){const{center:u}=n,m=xy(Ol(s));return Be.mat4.rotateY(m,m,xt(u.lng)),Be.mat4.rotateX(m,m,xt(u.lat)),Be.mat4.scale(m,m,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(n,s,u,m){return xu(n,s,u,!0)||new ht(0,0)}pointCoordinate3D(n,s,u){const m=this.pointCoordinate(n,s,u,0);return[m.x,m.y,m.z]}isPointAboveHorizon(n,s){return!xu(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(m,h){const v=m.cameraToCenterDistance,T=m._centerAltitude*h,k=m._camera,L=m._camera.forward(),x=Be.vec3.add([],Be.vec3.scale([],L,-v),[0,0,T]),A=m.worldSize/(2*Math.PI),D=[0,0,-A],M=m.width/m.height,P=Math.tan(m.fovAboveCenter),B=Be.vec3.scale([],k.up(),P),H=Be.vec3.scale([],k.right(),P*M),Z=Be.vec3.normalize([],Be.vec3.add([],Be.vec3.add([],L,B),H)),te=[];let ne;if(new us(x,Z).closestPointOnSphere(D,A,te)){const X=Be.vec3.add([],te,D),le=Be.vec3.sub([],X,x);ne=Math.cos(m.fovAboveCenter)*Be.vec3.length(le)}else{const X=Be.vec3.sub([],x,D),le=Be.vec3.sub([],D,x);Be.vec3.normalize(le,le);const pe=Be.vec3.length(X)-A;ne=Math.sqrt(pe*(pe+2*A));const Ce=Math.acos(ne/(A+pe))-Math.acos(Be.vec3.dot(L,le));ne*=Math.cos(Ce)}return 1.01*ne}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=wu(n.zoom);if(u>0){const m=hM(n,be(1,n.center.lat)*n.worldSize),h=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return mo(s,m+h*(1-Math.cos(v)),Math.pow(u,10))}return s}upVector(n,s,u){return pg(s,u,n,1)}upVectorScale(n){return{metersToTile:bu(by(Ol(n)))}}}function _M(c){const n=c.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new pM(c);case"equirectangular":return new lF(c);case"naturalEarth":return new uF(c);case"equalEarth":return new aF(c);case"winkelTripel":return new dF(c);case"albers":return s?new vM(c):new sF(c);case"lambertConformalConic":return s?new vM(c):new cF(c);case"globe":return new hF(c)}throw new Error(`Invalid projection name: ${c.name}`)}const fF=zf.VectorTileFeature.types,pF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vy(c,n,s,u,m,h,v,T,k,L,x,A,D){const M=T?Math.min(Eu,Math.round(T[0])):0,P=T?Math.min(Eu,Math.round(T[1])):0;c.emplaceBack(n,s,Math.round(32*u),Math.round(32*m),h,v,(M<<1)+(k?1:0),P,16*L,16*x,256*A,256*D)}function Uy(c,n,s){c.emplaceBack(n,s)}function jy(c,n,s,u,m,h,v){c.emplaceBack(n,s,u,m,h,v)}function Hy(c,n,s,u,m){c.emplaceBack(n,s,u,m),c.emplaceBack(n,s,u,m),c.emplaceBack(n,s,u,m),c.emplaceBack(n,s,u,m)}function mF(c){for(const n of c.sections)if(A1(n.text))return!0;return!1}class xx{constructor(n){this.layoutVertexArray=new fu,this.indexArray=new Gr,this.programConfigurations=n,this.segments=new ti,this.dynamicLayoutVertexArray=new Za,this.opacityVertexArray=new tg,this.placedSymbolArray=new sg,this.iconTransitioningVertexArray=new Ll,this.globeExtVertexArray=new eg,this.zOffsetVertexArray=new vu}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,s,u,m,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,RB.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,LB.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,pF,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,zB.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,DB.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,OB.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}jn(xx,"SymbolBuffers");class wx{constructor(n,s,u){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new u,this.segments=new ti,this.collisionVertexArray=new mu,this.collisionVertexArrayExt=new Za}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,BB.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,FB.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}jn(wx,"CollisionBuffers");class Gy{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Be.mat4.identity([]),this.placementViewportMatrix=Be.mat4.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ux(this.zoom,s["text-size"]),this.iconSizeData=ux(this.zoom,s["icon-size"]);const u=this.layers[0].layout,m=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(v=>ca[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new xx(new Ea(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new xx(new Ea(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new ly,this.lineVertexArray=new Pf,this.symbolInstances=new ag}calculateGlyphDependencies(n,s,u,m,h){for(const v of n){const T=v.codePointAt(0);if(T===void 0)break;if(s[T]=!0,m&&h&&T<=65535){const k=Cg[v];k&&(s[k.charCodeAt(0)]=!0)}}}updateFootprints(n,s){}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!ox(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,s,u,m){const h=this.layers[0],v=h.layout,T=this.projection.name==="globe",k=v.get("text-font"),L=v.get("text-field"),x=v.get("icon-image"),A=(L.value.kind!=="constant"||L.value.value instanceof Gi&&!L.value.value.isEmpty()||L.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),D=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,M=v.get("symbol-sort-key");if(this.features=[],!A&&!D)return;const P=s.iconDependencies,B=s.glyphDependencies,H=s.availableImages,Z=new Zr(this.zoom);for(const{feature:te,id:ne,index:X,sourceLayerIndex:le}of n){const pe=h._featureFilter.needGeometry,Ce=on(te,pe);if(!h._featureFilter.filter(Z,Ce,u))continue;if(pe||(Ce.geometry=wt(te,u,m)),T&&te.type!==1&&u.z<=5){const ot=Ce.geometry,Oe=.98078528056,et=(ct,ut)=>{const _t=pg(ct.x,ct.y,u,1),Mt=pg(ut.x,ut.y,u,1);return Be.vec3.dot(_t,Mt)<Oe};for(let ct=0;ct<ot.length;ct++)ot[ct]=Wt(ot[ct],et)}let Ue,Le;if(A){const ot=h.getValueAndResolveTokens("text-field",Ce,u,H),Oe=Gi.factory(ot);mF(Oe)&&(this.hasRTLText=!0),(!this.hasRTLText||Wm()==="unavailable"||this.hasRTLText&&Is.isParsed())&&(Ue=VB(Oe,h,Ce))}if(D){const ot=h.getValueAndResolveTokens("icon-image",Ce,u,H);Le=ot instanceof Xi?ot:Xi.fromString(ot)}if(!Ue&&!Le)continue;const ze=this.sortFeaturesByKey?M.evaluate(Ce,{},u):void 0;if(this.features.push({id:ne,text:Ue,icon:Le,index:X,sourceLayerIndex:le,geometry:Ce.geometry,properties:te.properties,type:fF[te.type],sortKey:ze}),Le&&(P[Le.namePrimary]=!0,Le.nameSecondary&&(P[Le.nameSecondary]=!0)),Ue){const ot=k.evaluate(Ce,{},u).join(","),Oe=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ca.vertical)>=0;for(const et of Ue.sections)if(et.image)P[et.image.namePrimary]=!0;else{const ct=Vm(Ue.toString()),ut=et.fontStack||ot,_t=B[ut]=B[ut]||{};this.calculateGlyphDependencies(et.text,_t,Oe,this.allowVerticalPlacement,ct)}}}v.get("symbol-placement")==="line"&&(this.features=function(te){const ne={},X={},le=[];let pe=0;function Ce(ot){le.push(te[ot]),pe++}function Ue(ot,Oe,et){const ct=X[ot];return delete X[ot],X[Oe]=ct,le[ct].geometry[0].pop(),le[ct].geometry[0]=le[ct].geometry[0].concat(et[0]),ct}function Le(ot,Oe,et){const ct=ne[Oe];return delete ne[Oe],ne[ot]=ct,le[ct].geometry[0].shift(),le[ct].geometry[0]=et[0].concat(le[ct].geometry[0]),ct}function ze(ot,Oe,et){const ct=et?Oe[0][Oe[0].length-1]:Oe[0][0];return`${ot}:${ct.x}:${ct.y}`}for(let ot=0;ot<te.length;ot++){const Oe=te[ot],et=Oe.geometry,ct=Oe.text?Oe.text.toString():null;if(!ct){Ce(ot);continue}const ut=ze(ct,et),_t=ze(ct,et,!0);if(ut in X&&_t in ne&&X[ut]!==ne[_t]){const Mt=Le(ut,_t,et),kt=Ue(ut,_t,le[Mt].geometry);delete ne[ut],delete X[_t],X[ze(ct,le[kt].geometry,!0)]=kt,le[Mt].geometry=null}else ut in X?Ue(ut,_t,et):_t in ne?Le(ut,_t,et):(Ce(ot),ne[ut]=pe-1,X[_t]=pe-1)}return le.filter(ot=>ot.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((te,ne)=>te.sortKey-ne.sortKey)}update(n,s,u,m,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(n,s,T,u,m,h),this.icon.programConfigurations.updatePaintArrays(n,s,T,u,m,h)}updateZOffset(){const n=(h,v,T)=>{u+=v,u>h.length&&h.resize(u);for(let k=-v;k<0;k++)h.emplace(k+u,T)},s=(h,v,T)=>{m+=v,m>h.length&&h.resize(m);for(let k=-v;k<0;k++)h.emplace(k+m,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,m=0;for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:k,numIconVertices:L}=v,x=v.zOffset,A=L>0;if((T>0||k>0)&&(n(this.text.zOffsetVertexArray,T,x),n(this.text.zOffsetVertexArray,k,x)),A){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:M}=v;D>=0&&s(this.icon.zOffsetVertexArray,L,x),M>=0&&s(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,x)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=_M(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:m,y:h}of s)this.lineVertexArray.emplaceBack(m,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,s,u,m,h,v,T,k,L,x,A,D,M,P,B,H){const Z=n.indexArray,te=n.layoutVertexArray,ne=n.globeExtVertexArray,X=n.segments.prepareSegment(4*s.length,te,Z,this.canOverlap?v.sortKey:void 0),le=this.glyphOffsetArray.length,pe=X.vertexLength,Ce=this.allowVerticalPlacement&&T===ca.vertical?Math.PI/2:0,Ue=v.text&&v.text.sections;for(let ze=0;ze<s.length;ze++){const{tl:ot,tr:Oe,bl:et,br:ct,texPrimary:ut,texSecondary:_t,pixelOffsetTL:Mt,pixelOffsetBR:kt,minFontScaleX:St,minFontScaleY:Yt,glyphOffset:gn,isSDF:Ut,sectionIndex:zn}=s[ze],En=X.vertexLength,xn=gn[1];if(Vy(te,L.x,L.y,ot.x,xn+ot.y,ut.x,ut.y,u,Ut,Mt.x,Mt.y,St,Yt),Vy(te,L.x,L.y,Oe.x,xn+Oe.y,ut.x+ut.w,ut.y,u,Ut,kt.x,Mt.y,St,Yt),Vy(te,L.x,L.y,et.x,xn+et.y,ut.x,ut.y+ut.h,u,Ut,Mt.x,kt.y,St,Yt),Vy(te,L.x,L.y,ct.x,xn+ct.y,ut.x+ut.w,ut.y+ut.h,u,Ut,kt.x,kt.y,St,Yt),k){const{x:pn,y:no,z:Ln}=k.anchor,[Gn,wo,Do]=k.up;jy(ne,pn,no,Ln,Gn,wo,Do),jy(ne,pn,no,Ln,Gn,wo,Do),jy(ne,pn,no,Ln,Gn,wo,Do),jy(ne,pn,no,Ln,Gn,wo,Do),Hy(n.dynamicLayoutVertexArray,pn,no,Ln,Ce)}else Hy(n.dynamicLayoutVertexArray,L.x,L.y,L.z,Ce);if(H){const pn=_t||ut;Uy(n.iconTransitioningVertexArray,pn.x,pn.y),Uy(n.iconTransitioningVertexArray,pn.x+pn.w,pn.y),Uy(n.iconTransitioningVertexArray,pn.x,pn.y+pn.h),Uy(n.iconTransitioningVertexArray,pn.x+pn.w,pn.y+pn.h)}Z.emplaceBack(En,En+1,En+2),Z.emplaceBack(En+1,En+2,En+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gn[0]),ze!==s.length-1&&zn===s[ze+1].sectionIndex||n.programConfigurations.populatePaintArrays(te.length,v,v.index,{},M,P,B,Ue&&Ue[zn])}const Le=k?k.anchor:L;n.placedSymbolArray.emplaceBack(Le.x,Le.y,Le.z,L.x,L.y,le,this.glyphOffsetArray.length-le,pe,x,A,L.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],T,0,!1,0,D,0)}_commitLayoutVertex(n,s,u,m,h,v,T){n.emplaceBack(s,u,m,h,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(n,s,u,m,h,v,T){const k=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),L=k.vertexLength,x=T.tileAnchorX,A=T.tileAnchorY;for(let M=0;M<4;M++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,s,n.padding,T.zOffset),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Fe(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Fe(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Fe(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,m,h,v,x,A,new Fe(n.x1,n.y2)),k.vertexLength+=4;const D=u.indexArray;D.emplaceBack(L,L+1),D.emplaceBack(L+1,L+2),D.emplaceBack(L+2,L+3),D.emplaceBack(L+3,L),k.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,u,m,h,v){for(let T=m;T<h;T++){const k=u.get(T),L=this.getSymbolInstanceTextSize(n,v,s,T);this._addCollisionDebugVertices(k,L,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,s,u,m,h,v){for(let T=m;T<h;T++){const k=u.get(T),L=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._addCollisionDebugVertices(k,L,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,s,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wx(Cf,$E.members,Ll),this.iconCollisionBox=new wx(Cf,$E.members,Ll);const m=Bf(this.iconSizeData,n),h=Bf(this.textSizeData,n,u);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(h,n,s,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(h,n,s,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,n,s,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(m,n,s,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(n,s,u,m){const h=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:m),v=Ry(this.textSizeData,n,h)/zi;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,s,u){const m=this.icon.placedSymbolArray.get(u),h=Ry(this.iconSizeData,n,m);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(n,s,u,m){n.emplaceBack(s,-u,-u,m),n.emplaceBack(s,u,-u,m),n.emplaceBack(s,u,u,m),n.emplaceBack(s,-u,u,m)}_updateTextDebugCollisionBoxes(n,s,u,m,h,v,T){for(let k=m;k<h;k++){const L=u.get(k),x=this.getSymbolInstanceTextSize(n,v,s,k);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,x,L.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(n,s,u,m,h,v,T){for(let k=m;k<h;k++){const L=u.get(k),x=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,x,L.padding,v.zOffset)}}updateCollisionDebugBuffers(n,s,u,m){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=Bf(this.iconSizeData,n,m),v=Bf(this.textSizeData,n,u);for(let T=0;T<this.symbolInstances.length;T++){const k=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(v,n,s,k.textBoxStartIndex,k.textBoxEndIndex,k,u),this._updateTextDebugCollisionBoxes(v,n,s,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k,u),this._updateIconDebugCollisionBoxes(h,n,s,k.iconBoxStartIndex,k.iconBoxEndIndex,k,m),this._updateIconDebugCollisionBoxes(h,n,s,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,u,m,h,v,T,k,L){const x={};if(s<u){const{x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X,featureIndex:le}=n.get(s);x.textBox={x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X},x.textFeatureIndex=le}if(m<h){const{x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X,featureIndex:le}=n.get(m);x.verticalTextBox={x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X},x.verticalTextFeatureIndex=le}if(v<T){const{x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X,featureIndex:le}=n.get(v);x.iconBox={x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X},x.iconFeatureIndex=le}if(k<L){const{x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X,featureIndex:le}=n.get(k);x.verticalIconBox={x1:A,y1:D,x2:M,y2:P,padding:B,projectedAnchorX:H,projectedAnchorY:Z,projectedAnchorZ:te,tileAnchorX:ne,tileAnchorY:X},x.verticalIconFeatureIndex=le}return x}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,s){const u=n.placedSymbolArray.get(s),m=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<m;h+=4)n.indexArray.emplaceBack(h,h+1,h+2),n.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),u=Math.cos(n),m=[],h=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const k=this.symbolInstances.get(T);m.push(0|Math.round(s*k.tileAnchorX+u*k.tileAnchorY)),h.push(k.featureIndex)}return v.sort((T,k)=>m[T]-m[k]||h[k]-h[T]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:L}=u;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),h>=0&&h!==m&&this.addIndicesForPlacedSymbol(this.text,h),v>=0&&v!==h&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),L>=0&&this.addIndicesForPlacedSymbol(this.icon,L)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let yM,bM,Sx;jn(Gy,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Gy.addDynamicAttributes=Hy;class xM{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:oa,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}jn(xM,"FormatSectionOverride",{omit:["defaultValue"]});const Tx=()=>Sx||(Sx={layout:yM||(yM=new zr({"symbol-placement":new wn(It.layout_symbol["symbol-placement"]),"symbol-spacing":new wn(It.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wn(It.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qn(It.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wn(It.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new wn(It.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new wn(It.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new wn(It.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new wn(It.layout_symbol["icon-ignore-placement"]),"icon-optional":new wn(It.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wn(It.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qn(It.layout_symbol["icon-size"]),"icon-size-scale-range":new wn(It.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Qn(It.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qn(It.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qn(It.layout_symbol["icon-image"]),"icon-rotate":new Qn(It.layout_symbol["icon-rotate"]),"icon-padding":new wn(It.layout_symbol["icon-padding"]),"icon-keep-upright":new wn(It.layout_symbol["icon-keep-upright"]),"icon-offset":new Qn(It.layout_symbol["icon-offset"]),"icon-anchor":new Qn(It.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wn(It.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wn(It.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wn(It.layout_symbol["text-rotation-alignment"]),"text-field":new Qn(It.layout_symbol["text-field"]),"text-font":new Qn(It.layout_symbol["text-font"]),"text-size":new Qn(It.layout_symbol["text-size"]),"text-size-scale-range":new wn(It.layout_symbol["text-size-scale-range"]),"text-max-width":new Qn(It.layout_symbol["text-max-width"]),"text-line-height":new Qn(It.layout_symbol["text-line-height"]),"text-letter-spacing":new Qn(It.layout_symbol["text-letter-spacing"]),"text-justify":new Qn(It.layout_symbol["text-justify"]),"text-radial-offset":new Qn(It.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wn(It.layout_symbol["text-variable-anchor"]),"text-anchor":new Qn(It.layout_symbol["text-anchor"]),"text-max-angle":new wn(It.layout_symbol["text-max-angle"]),"text-writing-mode":new wn(It.layout_symbol["text-writing-mode"]),"text-rotate":new Qn(It.layout_symbol["text-rotate"]),"text-padding":new wn(It.layout_symbol["text-padding"]),"text-keep-upright":new wn(It.layout_symbol["text-keep-upright"]),"text-transform":new Qn(It.layout_symbol["text-transform"]),"text-offset":new Qn(It.layout_symbol["text-offset"]),"text-allow-overlap":new wn(It.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new wn(It.layout_symbol["text-ignore-placement"]),"text-optional":new wn(It.layout_symbol["text-optional"]),visibility:new wn(It.layout_symbol.visibility)})),paint:bM||(bM=new zr({"icon-opacity":new Qn(It.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Qn(It.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Qn(It.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Qn(It.paint_symbol["text-emissive-strength"]),"icon-color":new Qn(It.paint_symbol["icon-color"]),"icon-halo-color":new Qn(It.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qn(It.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qn(It.paint_symbol["icon-halo-blur"]),"icon-translate":new wn(It.paint_symbol["icon-translate"]),"icon-translate-anchor":new wn(It.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Qn(It.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Qn(It.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Qn(It.paint_symbol["text-occlusion-opacity"]),"text-color":new Qn(It.paint_symbol["text-color"],{runtimeType:as,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Qn(It.paint_symbol["text-halo-color"]),"text-halo-width":new Qn(It.paint_symbol["text-halo-width"]),"text-halo-blur":new Qn(It.paint_symbol["text-halo-blur"]),"text-translate":new wn(It.paint_symbol["text-translate"]),"text-translate-anchor":new wn(It.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new wn(It.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new wn(It.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new wn(It.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new wn(It.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Qn(It.paint_symbol["symbol-z-offset"])}))},Sx);class Wy extends Qi{constructor(n,s,u,m){super(n,Tx(),s,u,m),this._colorAdjustmentMatrix=Be.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const m=[];for(const h of u)m.indexOf(h)<0&&m.push(h);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,s,u,m){return this._saturation===n&&this._contrast===s&&this._brightnessMin===u&&this._brightnessMax===m||(this._colorAdjustmentMatrix=function(h,v,T,k){h=Ae(h),v=Se(v);const L=Be.mat4.create(),x=h/3,A=1-2*x,D=[A,x,x,0,x,A,x,0,x,x,A,0,0,0,0,1],M=.5-.5*v,P=k-T;return Be.mat4.multiply(L,[P,0,0,0,0,P,0,0,0,0,P,0,T,T,T,1],[v,0,0,0,0,v,0,0,0,0,v,0,M,M,M,1]),Be.mat4.multiply(L,L,D),L}(n,s,u,m),this._saturation=n,this._contrast=s,this._brightnessMin=u,this._brightnessMax=m),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,s,u,m){const h=this.layout.get(n).evaluate(s,{},u,m),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||hf(v.value)||!h?h:function(T,k){return k.replace(/{([^{}]+)}/g,(L,x)=>x in T?String(T[x]):"")}(s.properties,h)}createBucket(n){return new Gy(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of Tx().paint.overridableProperties){if(!Wy.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),u=new xM(s),m=new Bm(u,s.property.specification,this.scope,this.options);let h=null;h=s.value.kind==="constant"||s.value.kind==="source"?new ff("source",m):new Id("composite",m,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new cu(s.property,h,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&Wy.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const u=n.get("text-field"),m=Tx().paint.properties[s];let h=!1;const v=T=>{for(const k of T)if(m.overrides&&m.overrides.hasOverride(k))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Gi)v(u.value.value.sections);else if(u.value.kind==="source"){const T=L=>{h||(L instanceof ra&&pi(L.value)===Uc?v(L.value.sections):L instanceof Wc?v(L.sections):L.eachChild(T))},k=u.value;k._styleExpression&&T(k._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,s,u){return{config:new el(this,{zoom:s,lut:u}),overrideFog:!1}}}let wM,SM,TM,CM;var Cx=sr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Ex(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Mx(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Ix{constructor(n,s,u,m){this.context=n,this.format=u,this.useMipmap=m&&m.useMipmap,this.texture=n.gl.createTexture(),this.update(s,{premultiply:m&&m.premultiply})}update(n,s){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,m=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:h}=this,{gl:v}=h,{x:T,y:k}=s&&s.position?s.position:{x:0,y:0},L=Math.max(T+u,this.size?this.size[0]:0),x=Math.max(k+m,this.size?this.size[1]:0);!this.size||this.size[0]===L&&this.size[1]===x||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!s||s.premultiply!==!1));const A=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&L>0&&x>0){const D=this.useMipmap?Math.floor(Math.log2(Math.max(L,x)))+1:1;v.texStorage2D(v.TEXTURE_2D,D,this.format,L,x),this.size=[L,x]}if(this.size)if(A)v.texSubImage2D(v.TEXTURE_2D,0,T,k,Ex(this.format),Mx(this.format),n);else{const D=n.data;D&&v.texSubImage2D(v.TEXTURE_2D,0,T,k,u,m,Ex(this.format),Mx(this.format),D)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,s,u=!1){const{context:m}=this,{gl:h}=m;h.bindTexture(h.TEXTURE_2D,this.texture),n!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),s!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,s),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(n,s,u,m){const{context:h}=this,{gl:v}=h;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),this.magFilter=s),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),this.wrapS=u),m!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class qy{constructor(n,s){this.context=n,this.texture=s}bind(n,s){const{context:u}=this,{gl:m}=u;m.bindTexture(m.TEXTURE_2D,this.texture),n!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,n),this.minFilter=n),s!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrapS=s)}}function Ky(c,n,s,u,m,h,v,T){const k=[c,n,1,s,u,1,m,h,1],L=[v,T,1],x=Be.mat3.adjoint([],k),[A,D,M]=Be.vec3.transformMat3(L,L,x);return Be.mat3.multiply(k,k,[A,0,0,0,D,0,0,0,M])}function EM(c,n,s,u,m,h,v,T){const k=function(L,x,A,D,M,P,B,H){const Z=Ky(0,0,1,0,1,1,0,1),te=Ky(L,x,A,D,M,P,B,H),ne=Be.mat3.adjoint([],Z);return Be.mat3.multiply(te,te,ne)}(c,n,s,u,m,h,v,T);return[k[2]/k[8]/In,k[5]/k[8]/In]}function Zy(c){return[c[0],Math.min(Math.max(c[1],-We),We)]}class MM extends $c{constructor(n,s,u,m){super(),this.id=n,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=s,this._dirty=!1}load(n,s){if(this._loaded=s||!1,this.fire(new Ml("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=xa(this.map._requestManager.transformRequest(this.url,Nh.Image),(u,m)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new fd(u)):m&&(this.image=m instanceof HTMLImageElement?Ht.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new qy(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ml("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof qy||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=n[0][1],u=n[0][1];for(const h of n)h[1]>u&&(u=h[1]),h[1]<s&&(s=h[1]);const m=(u+s)/2;if(m>We?this.onNorthPole=!0:m<-We&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=n.map(ht.fromLngLat);this.tileID=function(v){let T=1/0,k=1/0,L=-1/0,x=-1/0;for(const B of v)T=Math.min(T,B.x),k=Math.min(k,B.y),L=Math.max(L,B.x),x=Math.max(x,B.y);const A=Math.max(L-T,x-k),D=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),M=Math.pow(2,D);let P=Math.floor((T+L)/2*M);return P>1&&(P-=1),new Si(D,P,Math.floor((k+x)/2*M))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ml("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const Z in this.tiles){const te=this.tiles[Z];te.state!=="loaded"&&(te.state="loaded",te.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=kg(new Si(0,0,0),this.map.transform.projection),u=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Z){const te=Z[1].x-Z[0].x,ne=Z[1].y-Z[0].y,X=Z[2].x-Z[1].x,le=Z[2].y-Z[1].y,pe=Z[3].x-Z[2].x,Ce=Z[3].y-Z[2].y,Ue=Z[0].x-Z[3].x,Le=Z[0].y-Z[3].y,ze=te*le-X*ne,ot=X*Ce-pe*le,Oe=pe*Le-Ue*Ce,et=Ue*ne-te*Le;return ze>0&&ot>0&&Oe>0&&et>0||ze<0&&ot<0&&Oe<0&&et<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=kg(this.tileID,this.map.transform.projection),[h,v,T,k]=this.coordinates.map(Z=>{const te=m.projection.project(Z[0],Z[1]);return fM(m,te)._round()});this.perspectiveTransform=EM(h.x,h.y,v.x,v.y,T.x,T.y,k.x,k.y);const L=this._boundsArray=new hu;L.emplaceBack(h.x,h.y,0,0),L.emplaceBack(v.x,v.y,In,0),L.emplaceBack(k.x,k.y,0,In),L.emplaceBack(T.x,T.y,In,In),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(L,Cx.members),this.boundsSegments=ti.simpleSegment(0,0,4,2);const x=[],A=[Zy((D=this.coordinates)[0]),Zy(D[1]),Zy(D[2]),Zy(D[3])];var D;const[M,P,B,H]=function(Z){let te=Z[0][0],ne=te,X=Z[0][1],le=X;for(let pe=1;pe<Z.length;pe++)Z[pe][0]<te?te=Z[pe][0]:Z[pe][0]>ne&&(ne=Z[pe][0]),Z[pe][1]<X?X=Z[pe][1]:Z[pe][1]>le&&(le=Z[pe][1]);return[te,X,ne-te,le-X]}(A);{const Z=new hu,[te,ne,X,le]=function(Mt){let kt=Mt[0].x,St=kt,Yt=Mt[0].y,gn=Yt;for(let Ut=1;Ut<Mt.length;Ut++)Mt[Ut].x<kt?kt=Mt[Ut].x:Mt[Ut].x>St&&(St=Mt[Ut].x),Mt[Ut].y<Yt?Yt=Mt[Ut].y:Mt[Ut].y>gn&&(gn=Mt[Ut].y);return[kt,Yt,St-kt,gn-Yt]}(u),pe=Mt=>[(Mt.x-te)/X,(Mt.y-ne)/le],[Ce,Ue,Le,ze]=u.map(pe),ot=function(Mt,kt,St,Yt,gn,Ut,zn,En){const xn=Ky(0,0,1,0,1,1,0,1),pn=Ky(Mt,kt,St,Yt,gn,Ut,zn,En),no=Be.mat3.adjoint([],pn);return Be.mat3.multiply(xn,xn,no)}(Ce[0],Ce[1],Ue[0],Ue[1],Le[0],Le[1],ze[0],ze[1]);this.elevatedGlobePerspectiveTransform=EM(Ce[0],Ce[1],Ue[0],Ue[1],Le[0],Le[1],ze[0],ze[1]);const Oe=(Mt,kt)=>{x.push(Mt.lng);const St=Math.round((Mt.lng-M)/B*In),Yt=Math.round((Mt.lat-P)/H*In),gn=pe(kt),Ut=Be.vec3.transformMat3([],[gn[0],gn[1],1],ot),zn=Math.round(Ut[0]/Ut[2]*In),En=Math.round(Ut[1]/Ut[2]*In);Z.emplaceBack(St,Yt,zn,En)},et=u[3].x-u[0].x,ct=u[3].y-u[0].y,ut=u[2].x-u[1].x,_t=u[2].y-u[1].y;for(let Mt=0;Mt<65;Mt++){const kt=Mt/64,St=[u[0].x+kt*et,u[0].y+kt*ct],Yt=[u[1].x+kt*ut,u[1].y+kt*_t],gn=Yt[0]-St[0],Ut=Yt[1]-St[1];for(let zn=0;zn<65;zn++){const En=zn/64,xn={x:St[0]+gn*En,y:St[1]+Ut*En};Oe(s.projection.unproject(xn.x,xn.y),xn)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(Z,Cx.members)}{this.maxLongitudeTriangleSize=0;let Z=[],te=new Gr;const ne=(X,le,pe)=>{te.emplaceBack(X,le,pe);const Ce=x[X],Ue=x[le],Le=x[pe],ze=Math.min(Math.min(Ce,Ue),Le),ot=Math.max(Math.max(Ce,Ue),Le)-ze;ot>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ot),Z.push(ze+ot/2)};for(let X=0;X<64;X++)for(let le=0;le<64;le++){const pe=65*X+le,Ce=pe+1,Ue=pe+65,Le=Ue+1;ne(pe,Ue,Ce),ne(Ce,Ue,Le)}[Z,te]=function(X,le){const pe=Array.from({length:X.length},(Le,ze)=>ze);pe.sort((Le,ze)=>X[Le]-X[ze]);const Ce=[],Ue=new Gr;for(let Le=0;Le<pe.length;Le++){const ze=pe[Le];Ce.push(X[ze]);const ot=3*ze,Oe=ot+1;Ue.emplaceBack(le.uint16[ot],le.uint16[Oe],le.uint16[Oe+1])}return[Ce,Ue]}(Z,te),this.elevatedGlobeTrianglesCenterLongitudes=Z,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(te)}this.elevatedGlobeSegments=ti.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,B/In,0,H/In,0,0,P,M,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const s=this.map.painter.context,u=s.gl;!this._dirty||this.texture instanceof qy||(this.texture?this.texture.update(this.image):(this.texture=new Ix(s,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(s)}loadTile(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let m=(h=n+180)+360*Math.round((u[0]-h)/360);var h;const v=new ti,T=(A,D)=>{v.segments.push({vertexOffset:0,primitiveOffset:A,vertexLength:s.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},k=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-m)<=k){const A=$t(u,0,u.length,m+k);return A===u.length||T(A,ya(u,A+1,u.length,m+360-k)-A),v}m<u[0]&&(m+=360);const L=ya(u,0,u.length,m-k);if(L===u.length)return T(0,u.length),v;T(0,L-0);const x=$t(u,L+1,u.length,m+k);return x!==u.length&&T(x,u.length-x),v}}const gF=(Math.pow(256,2)-1)/16907520;class IM extends Qi{constructor(n,s,u,m){super(n,{layout:TM||(TM=new zr({visibility:new wn(It.layout_raster.visibility)})),paint:CM||(CM=new zr({"raster-opacity":new wn(It.paint_raster["raster-opacity"]),"raster-color":new du(It.paint_raster["raster-color"]),"raster-color-mix":new wn(It.paint_raster["raster-color-mix"]),"raster-color-range":new wn(It.paint_raster["raster-color-range"]),"raster-hue-rotate":new wn(It.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wn(It.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wn(It.paint_raster["raster-brightness-max"]),"raster-saturation":new wn(It.paint_raster["raster-saturation"]),"raster-contrast":new wn(It.paint_raster["raster-contrast"]),"raster-resampling":new wn(It.paint_raster["raster-resampling"]),"raster-fade-duration":new wn(It.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new wn(It.paint_raster["raster-emissive-strength"]),"raster-array-band":new wn(It.paint_raster["raster-array-band"]),"raster-elevation":new wn(It.paint_raster["raster-elevation"])}))},s,u,m),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof MM&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[u,m]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(m)||u===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=mg({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,m])}}let AM,kM,PM,RM,DM;class LM extends Qi{constructor(n,s,u,m){super(n,{layout:AM||(AM=new zr({visibility:new wn(It["layout_raster-particle"].visibility)})),paint:kM||(kM=new zr({"raster-particle-array-band":new wn(It["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new wn(It["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new du(It["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new wn(It["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new wn(It["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new wn(It["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new wn(It["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new wn(It["paint_raster-particle"]["raster-particle-elevation"])}))},s,u,m),this._updateColorRamp(),this.lastInvalidatedAt=Ht.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=mg({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ht.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class vF extends Qi{constructor(n,s){super(n,{},s,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function Ax(c,n,s){const u=[0,0,1],m=Be.quat.identity([]);return Be.quat.rotateY(m,m,s?-xt(c)+Math.PI:xt(c)),Be.quat.rotateX(m,m,-xt(n)),Be.vec3.transformQuat(u,u,m),Be.vec3.normalize(u,u)}function OM(c,n){const s=Yy(c.projection,c.zoom,c.width,c.height),u=function(h,v,T,k,L){const x=new j(T.lng-180*Iu,T.lat),A=new j(T.lng+180*Iu,T.lat),D=h.project(x.lng,x.lat),M=h.project(A.lng,A.lat),P=-Math.atan2(M.y-D.y,M.x-D.x),B=ht.fromLngLat(T);B.y=gt(B.y,-1+Iu,1-Iu);const H=B.toLngLat(),Z=h.project(H.lng,H.lat),te=ht.fromLngLat(H);te.x+=Iu;const ne=te.toLngLat(),X=h.project(ne.lng,ne.lat),le=BM(X.x-Z.x,X.y-Z.y,P),pe=ht.fromLngLat(H);pe.y+=Iu;const Ce=pe.toLngLat(),Ue=h.project(Ce.lng,Ce.lat),Le=BM(Ue.x-Z.x,Ue.y-Z.y,P),ze=Math.abs(le.x)/Math.abs(Le.y),ot=Be.mat4.identity([]);Be.mat4.rotateZ(ot,ot,-P*(1-(L?0:k)));const Oe=Be.mat4.identity([]);return Be.mat4.scale(Oe,Oe,[1,1-(1-ze)*k,1]),Oe[4]=-Le.x/Le.y*k,Be.mat4.rotateZ(Oe,Oe,P),Be.mat4.multiply(Oe,ot,Oe),Oe}(c.projection,0,c.center,s,n),m=zM(c);return Be.mat4.scale(u,u,[m,m,1]),u}function zM(c){const n=c.projection,s=Yy(c.projection,c.zoom,c.width,c.height),u=kx(n,c.center),m=kx(n,j.convert(n.center));return Math.pow(2,u*s+(1-s)*m)}function Yy(c,n,s,u,m=1/0){const h=c.range;if(!h)return 0;const v=Math.min(m,Math.max(s,u)),T=Math.log(v/1024)/Math.LN2;return Sn(h[0]+T,h[1]+T,n)}const Iu=1/4e4;function kx(c,n){const s=gt(n.lat,-We,We),u=new j(n.lng-180*Iu,s),m=new j(n.lng+180*Iu,s),h=c.project(u.lng,s),v=c.project(m.lng,s),T=ht.fromLngLat(u),k=ht.fromLngLat(m),L=v.x-h.x,x=v.y-h.y,A=k.x-T.x,D=k.y-T.y,M=Math.sqrt((A*A+D*D)/(L*L+x*x));return Math.log(M)/Math.LN2}function BM(c,n,s){const u=Math.cos(s),m=Math.sin(s);return{x:c*u-n*m,y:c*m+n*u}}function FM(c,n,s){Be.mat4.identity(c),Be.mat4.rotateZ(c,c,xt(n[2])),Be.mat4.rotateX(c,c,xt(n[0])),Be.mat4.rotateY(c,c,xt(n[1])),Be.mat4.scale(c,c,s),Be.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Xy(c,n,s,u,m,h,v,T){const k=[s[0]-n[0],s[1]-n[1],0],L=[u[0]-n[0],u[1]-n[1],0];if(Be.vec3.length(k)<1e-12||Be.vec3.length(L)<1e-12)return Be.quat.identity(c);const x=Be.vec3.cross([],k,L);Be.vec3.normalize(x,x),Be.vec3.subtract(L,u,n),k[2]=(h-m)*T,L[2]=(v-m)*T;const A=k;return Be.vec3.cross(A,k,L),Be.vec3.normalize(A,A),Be.quat.rotationTo(c,x,A)}function Px(c,n,s=!1){const u=wu(n.zoom),m=function(h,v,T){const k=v.worldSize,L=[h[12],h[13],h[14]],x=$e(L[1]/k),A=Pe(L[0]/k),D=Be.mat4.identity([]),M=be(1,x)*k,P=be(1,0)*k*Ke(x,v.zoom),B=1/H1(k);let H=P*B;if(T){const X=Yy(v.projection,v.zoom,v.width,v.height,1024);H=B*v.projection.pixelSpaceConversion(v.center.lat,k,X)}const Z=O(x,A);Be.vec3.add(Z,Z,Be.vec3.scale([],Be.vec3.normalize([],Z),M*H*L[2]));const te=function(X){const le=[X[0],X[1],X[2]];let pe=[0,1,0];const Ce=Be.vec3.cross([],pe,le);return Be.vec3.cross(pe,le,Ce),Be.vec3.squaredLength(pe)===0&&(pe=[0,1,0],Be.vec3.cross(Ce,le,pe)),Be.vec3.normalize(Ce,Ce),Be.vec3.normalize(pe,pe),Be.vec3.normalize(le,le),[Ce[0],Ce[1],Ce[2],0,pe[0],pe[1],pe[2],0,le[0],le[1],le[2],0,X[0],X[1],X[2],1]}(Z);Be.mat4.scale(D,D,[H,H,H*M]),Be.mat4.translate(D,D,[-L[0],-L[1],-L[2]]);const ne=Be.mat4.multiply([],v.globeMatrix,te);return Be.mat4.multiply(ne,ne,D),Be.mat4.multiply(ne,ne,h),ne}(c,n,s);if(u>0){const h=function(v,T){const k=T.worldSize,L=be(1,0)*k*Ke(T.center.lat,T.zoom)/H1(k),x=be(1,T.center.lat)*k,A=Be.mat4.identity([]);return Be.mat4.rotateY(A,A,xt(T.center.lng)),Be.mat4.rotateX(A,A,xt(T.center.lat)),Be.mat4.translate(A,A,[0,0,Oi]),Be.mat4.scale(A,A,[L,L,L*x]),Be.mat4.translate(A,A,[T.point.x-.5*k,T.point.y-.5*k,0]),Be.mat4.multiply(A,A,v),Be.mat4.multiply(A,T.globeMatrix,A)}(c,n);return function(v,T,k){const L=(P,B,H)=>{const Z=Be.vec3.length(P),te=Be.vec3.length(B),ne=_c(P,B,H);return Be.vec3.scale(ne,ne,1/Be.vec3.length(ne)*mo(Z,te,H))},x=L([v[0],v[1],v[2]],[T[0],T[1],T[2]],k),A=L([v[4],v[5],v[6]],[T[4],T[5],T[6]],k),D=L([v[8],v[9],v[10]],[T[8],T[9],T[10]],k),M=_c([v[12],v[13],v[14]],[T[12],T[13],T[14]],k);return[x[0],x[1],x[2],0,A[0],A[1],A[2],0,D[0],D[1],D[2],0,M[0],M[1],M[2],1]}(m,h,u)}return m}function NM(c,n,s,u){const m=hr.projectAabbCorners(u,s);let h=Number.MAX_VALUE,v=-1;for(let L=0;L<m.length;++L){const x=m[L];x[0]=(.5*x[0]+.5)*n.width,x[1]=(.5-.5*x[1])*n.height,x[2]<h&&(v=L,h=x[2])}const T=L=>new Fe(m[L][0],m[L][1]);let k;switch(v){case 0:case 6:k=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:k=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:k=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:k=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(nn(c,k))return h}const _F=sr([{name:"a_pos_3f",components:3,type:"Float32"}]),yF=sr([{name:"a_color_3f",components:3,type:"Float32"}]),bF=sr([{name:"a_color_4f",components:4,type:"Float32"}]),xF=sr([{name:"a_uv_2f",components:2,type:"Float32"}]),wF=sr([{name:"a_normal_3f",components:3,type:"Float32"}]),SF=sr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),TF=sr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),$M={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Jy{constructor(n,s,u,m){this.message=(n?`${n}: `:"")+u,m&&(this.identifier=m),s!=null&&s.__line__&&(this.line=s.__line__)}}function VM(c,n){const s=c.indexOf("://")===-1;try{return new URL(c,s&&n?"http://example.com":void 0),!0}catch{return!1}}class UM{constructor(n,s){this.feature=n,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class jM{constructor(){this.instancedDataArray=new Nd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Rx{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,s){}populate(n,s,u,m){this.tileToMeter=rt(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:T,index:k,sourceLayerIndex:L}of n){const x=T??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),A=on(v,h);if(!this.layers[0]._featureFilter.filter(new Zr(this.zoom),A,u))continue;const D={id:x,sourceLayerIndex:L,index:k,geometry:h?A.geometry:wt(v,u,m),properties:v.properties,type:v.type,patterns:{}},M=this.addFeature(D,D.geometry,A);M&&s.featureIndex.insert(v,D.geometry,k,L,this.index,this.instancesPerModel[M].instancedDataArray.length,In/32)}this.lookup=null}update(n,s,u,m){for(const h in this.instancesPerModel){const v=this.instancesPerModel[h];for(const T in n)v.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(v.features[v.idToFeaturesIndex[T]],n[T],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];for(const m of u.features){const h=this.layers[0],v=m.feature,T=this.canonical,k=h.paint.get("model-rotation").evaluate(v,{},T),L=h.paint.get("model-scale").evaluate(v,{},T),x=h.paint.get("model-translation").evaluate(v,{},T);Be.vec3.exactEquals(m.rotation,k)&&Be.vec3.exactEquals(m.scale,L)&&Be.vec3.exactEquals(m.translation,x)||(this.evaluate(m,m.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,s,u,m){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(ox(this.activeReplacements,h))return!1;this.activeReplacements=h;let v=!1;for(const T in this.instancesPerModel){const k=this.instancesPerModel[T],L=k.instancedDataArray;for(const x of k.features){const A=x.instancedDataOffset,D=x.instancedDataCount;for(let M=0;M<D;M++){const P=16*(M+A);let B=L.float32[P+0];const H=B>In;B=H?B-In:B;const Z=Math.floor(B),te=L.float32[P+1];let ne=!1;for(const X of this.activeReplacements)if(!rE(X,u,$M.Model,m)&&!(X.min.x>Z||Z>X.max.x||X.min.y>te||te>X.max.y)&&(ne=uE(cE(Z,te,n.canonical,X.footprintTileId.canonical),X.footprint),ne))break;L.float32[P]=ne?B+In:B,v=v||ne!==H}}}return v}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,SF.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const s of this.modelUris)n.removeModel(s,"")}addFeature(n,s,u){const m=this.layers[0],h=m.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return Mn(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),h;VM(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new jM);const v=this.instancesPerModel[h],T=v.instancedDataArray,k=new UM(u,T.length);for(const L of s)for(const x of L){if(x.x<0||x.x>=In||x.y<0||x.y>=In)continue;const A=(this.lookupDim-1)/In,D=this.lookupDim*(x.y*A|0)+x.x*A|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const M=T.length;T.resize(M+1),v.instancesEvaluatedElevation.push(0),T.float32[16*M]=x.x,T.float32[16*M+1]=x.y}return k.instancedDataCount=v.instancedDataArray.length-k.instancedDataOffset,k.instancedDataCount>0&&(n.id&&(v.idToFeaturesIndex[n.id]=v.features.length),v.features.push(k),this.evaluate(k,{},v,!1)),h}getModelUris(){return this.modelUris}evaluate(n,s,u,m){const h=this.layers[0],v=n.feature,T=this.canonical,k=n.rotation=h.paint.get("model-rotation").evaluate(v,s,T),L=n.scale=h.paint.get("model-scale").evaluate(v,s,T),x=n.translation=h.paint.get("model-translation").evaluate(v,s,T),A=h.paint.get("model-color").evaluate(v,s,T);A.a=h.paint.get("model-color-mix-intensity").evaluate(v,s,T);const D=[];this.maxVerticalOffset<x[2]&&(this.maxVerticalOffset=x[2]),this.maxScale=Math.max(Math.max(this.maxScale,L[0]),Math.max(L[1],L[2])),FM(D,k,L);const M=Math.round(100*A.a)+A.b/1.05;for(let P=0;P<n.instancedDataCount;++P){const B=n.instancedDataOffset+P,H=16*B,Z=u.instancedDataArray.float32;let te=0;m&&(te=Z[H+6]-u.instancesEvaluatedElevation[B]);const ne=0|Z[H+1];Z[H]=(0|Z[H])+A.r/1.05,Z[H+1]=ne+A.g/1.05,Z[H+2]=M,Z[H+3]=1/(T.z>10?this.tileToMeter:rt(T,ne)),Z[H+4]=x[0],Z[H+5]=x[1],Z[H+6]=x[2]+te,Z[H+7]=D[0],Z[H+8]=D[1],Z[H+9]=D[2],Z[H+10]=D[4],Z[H+11]=D[5],Z[H+12]=D[6],Z[H+13]=D[8],Z[H+14]=D[9],Z[H+15]=D[10],u.instancesEvaluatedElevation[B]=x[2]}}}let HM,GM;jn(Rx,"ModelBucket",{omit:["layers"]}),jn(jM,"PerModelAttributes"),jn(UM,"ModelFeature");const qd=64,Uf={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function WM(c,n,s,u,m,h,v,T,k,L=!1){const x=s.zoom,A=s.project(u),D=Ke(u.lat,x),M=1/D;Be.mat4.identity(c),Be.mat4.translate(c,c,[A.x+v[0]*M,A.y+v[1]*M,v[2]]);let P=1,B=1;const H=s.worldSize;if(L){if(s.projection.name==="mercator"){let X=0;s.elevation&&(X=s.elevation.getAtPointOrZero(new ht(A.x/H,A.y/H),0));const le=Be.vec4.transformMat4([],[A.x,A.y,X,1],s.projMatrix)[3]/s.cameraToCenterDistance;P=le,B=le*Ke(s.center.lat,x)}else if(s.projection.name==="globe"){const X=Px(c,s),le=Be.mat4.multiply([],s.projMatrix,X),pe=[0,0,0,1];Be.vec4.transformMat4(pe,pe,le);const Ce=pe[3]/s.cameraToCenterDistance,Ue=wu(x),Le=s.projection.pixelsPerMeter(u.lat,H)*Ke(u.lat,x),ze=s.projection.pixelsPerMeter(s.center.lat,H)*Ke(s.center.lat,x);P=Ce/mo(Le,Xe(s.center.lat),Ue),B=Ce*D/Le,P*=ze,B*=ze}}else P=M;Be.mat4.scale(c,c,[P,P,B]);const Z=[...c],te=n.orientation,ne=[];if(FM(ne,[te[0]+m[0],te[1]+m[1],te[2]+m[2]],h),Be.mat4.multiply(c,Z,ne),T&&s.elevation){let X=0;const le=[];if(k&&s.elevation){X=function(Ue,Le,ze,ot,Oe){const et=Le.elevation;if(!et)return 0;const ct=hr.projectAabbCorners(ze,ot),ut=be(1,Oe.lat)*Le.worldSize,_t=function(no,Ln){const Gn=[0,0,1],wo=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Do of wo){const zo=no[Do.corners[0]],Ao=no[Do.corners[1]],Uo=no[Do.corners[2]],No=[Ao[0]-zo[0],Ao[1]-zo[1],Ln*(Ao[2]-zo[2])],Ir=Be.vec3.cross(No,No,[Uo[0]-zo[0],Uo[1]-zo[1],Ln*(Uo[2]-zo[2])]);Be.vec3.normalize(Ir,Ir),Do.dotProductWithUp=Be.vec3.dot(Ir,Gn)}return wo.sort((Do,zo)=>Do.dotProductWithUp-zo.dotProductWithUp),wo[0].corners}(ct,ut),Mt=ct[_t[0]],kt=ct[_t[1]],St=ct[_t[2]],Yt=ct[_t[3]],gn=et.getAtPointOrZero(new ht(Mt[0]/Le.worldSize,Mt[1]/Le.worldSize),0),Ut=et.getAtPointOrZero(new ht(kt[0]/Le.worldSize,kt[1]/Le.worldSize),0),zn=et.getAtPointOrZero(new ht(St[0]/Le.worldSize,St[1]/Le.worldSize),0),En=et.getAtPointOrZero(new ht(Yt[0]/Le.worldSize,Yt[1]/Le.worldSize),0),xn=(gn+En)/2,pn=(Ut+zn)/2;return xn>pn?Ut<zn?Xy(Ue,kt,Yt,Mt,Ut,En,gn,ut):Xy(Ue,St,Mt,Yt,zn,gn,En,ut):gn<En?Xy(Ue,Mt,kt,St,gn,Ut,zn,ut):Xy(Ue,Yt,St,kt,En,zn,Ut,ut),Math.max(xn,pn)}(le,s,n.aabb,c,u);const pe=Be.mat4.fromQuat([],le),Ce=Be.mat4.multiply([],pe,ne);Be.mat4.multiply(c,Z,Ce)}else X=s.elevation.getAtPointOrZero(new ht(A.x/H,A.y/H),0);X!==0&&(c[14]+=X)}}function Og(c,n,s=!1){c.uploaded||(c.gfxTexture=new Ix(n,c.image,s?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function CF(c,n,s){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,_F.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,wF.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,xF.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?yF:bF).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,TF.members,!0)),c.segments=ti.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&Og(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&Og(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&Og(u.normalTexture,n),u.occlusionTexture&&Og(u.occlusionTexture,n,s),u.emissionTexture&&Og(u.emissionTexture,n)}function Dx(c,n,s){if(c.meshes)for(const u of c.meshes)CF(u,n,s);if(c.children)for(const u of c.children)Dx(u,n,s)}function Qy(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)Qy(n)}function Lx(c){if(c.meshes)for(const s of c.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((n=s.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const s of c.children)Lx(s)}class jf{constructor(n,s,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=u}static create(n,s,u){const m=u||n.findDEMTileFor(s);if(!m||!m.dem)return;const h=m.dem,v=m.tileID,T=1<<s.canonical.z-v.canonical.z;return new jf(m,h.dim/In/T,[(s.canonical.x/T-v.canonical.x)*h.dim,(s.canonical.y/T-v.canonical.y)*h.dim])}tileCoordToPixel(n,s){const u=s*this._scale+this._offset[1],m=Math.floor(n*this._scale+this._offset[0]),h=Math.floor(u);return new Fe(m,h)}getElevationAt(n,s,u,m){const h=n*this._scale+this._offset[0],v=s*this._scale+this._offset[1],T=Math.floor(h),k=Math.floor(v),L=this._dem;return m=!!m,u?mo(mo(L.get(T,k,m),L.get(T,k+1,m),v-k),mo(L.get(T+1,k,m),L.get(T+1,k+1,m),v-k),h-T):L.get(T,k,m)}getElevationAtPixel(n,s,u){return this._dem.get(n,s,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*be(1,n)*this._dem.stride}}const Ox=new Float32Array(262144),Kd=new Uint8Array(262144);function qM(c){let n=0;if(c.meshes)for(const s of c.meshes)n=Math.max(n,s.aabb.max[2]);if(c.children)for(const s of c.children)n=Math.max(n,qM(s));return n}function KM(c,n,s){if(c.meshes)for(const u of c.meshes){if(u.aabb.min[0]===1/0)continue;const m=hr.applyTransform(u.aabb,c.matrix);s.insert(n,m.min[0],m.min[1],m.max[0],m.max[1])}if(c.children)for(const u of c.children)KM(u,n,s)}const ZM=["","wall","door","roof","window","lamp","logo"];class YM{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:qM(n)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new hr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const s=new hr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=hr.applyTransformFast(u.aabb,this.node.matrix),s.encapsulate(u.transformedAabb)),n++;this.aabb=s}return this.aabb}}class e0{constructor(n,s,u,m,h,v,T){this.id=u,this.layers=n,this.layerIds=this.layers.map(k=>k.fqid),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.modelTraits|=Uf.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,m&&(this.modelTraits|=Uf.HasMapboxMeshFeatures),h&&(this.modelTraits|=Uf.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const k of s)this.nodesInfo.push(new YM(k)),KM(k,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0)}updateFootprints(n,s){for(const u of this.getNodesInfo()){const m=u.node;m.footprint&&s.push({footprint:m.footprint,id:n})}}update(n){const s=Object.keys(n).length!==0;if(s&&!this.stateDependentLayers.length)return;const u=s?this.stateDependentLayers:this.layers;for(const m of u)this.evaluate(m,n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const u of s){const m=u.node;this.uploaded?this.updatePbrBuffer(m):Dx(m,n,!0)}for(const u of s)Qy(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let s=!1;if(!n.meshes)return s;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),s=!0);return s}needsReEvaluation(n,s,u){const m=n.transform.projectionOptions,h=n.style.getBrightness(),v=this.brightness!==h;return!!(!this.uploaded||this.dirty||m.name!==this.projection.name||zg(u.paint.get("model-color").value,v)||zg(u.paint.get("model-color-mix-intensity").value,v)||zg(u.paint.get("model-roughness").value,v)||zg(u.paint.get("model-emissive-strength").value,v)||zg(u.paint.get("model-height-based-emissive-strength-multiplier").value,v))&&(this.projection=m,this.brightness=h,!0)}evaluateScale(n,s){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),m=this.id.canonical;for(const h of u){const v=h.feature;h.evaluatedScale=s.paint.get("model-scale").evaluate(v,{},m)}}evaluate(n,s){const u=this.getNodesInfo();for(const m of u){if(!m.node.meshes)continue;const h=m.feature,v=s&&s[h.id],T=m.node.meshes&&m.node.meshes[0].featureData,k=m.evaluatedColor[2],L=m.evaluatedRMEA[2],x=this.id.canonical;if(m.hasTranslucentParts=!1,T){for(let A=0;A<ZM.length;A++){const D=ZM[A];D.length&&(h.properties.part=D);const M=n.paint.get("model-color").evaluate(h,v,x).toRenderColor(null),P=n.paint.get("model-color-mix-intensity").evaluate(h,v,x);m.evaluatedColor[A]=[M.r,M.g,M.b,P],m.evaluatedRMEA[A][0]=n.paint.get("model-roughness").evaluate(h,v,x),m.evaluatedRMEA[A][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x),m.evaluatedRMEA[A][3]=M.a,m.emissionHeightBasedParams[A]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,v,x),!m.hasTranslucentParts&&M.a<1&&(m.hasTranslucentParts=!0)}delete h.properties.part,MF(m,k!==m.evaluatedColor[2]||L!==m.evaluatedRMEA[2],this.modelTraits)}else m.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x);m.evaluatedScale=n.paint.get("model-scale").evaluate(h,v,x),this.updatePbrBuffer(m.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,s,u,m){const h=n.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const v=jf.create(n,u,h);if(!v)return;this.modelTraits&Uf.HasMapboxMeshFeatures&&this.updateDEM(n,v,u,m);for(const T of this.getNodesInfo()){const k=T.node;if(!k.footprint||!k.footprint.vertices||!k.footprint.vertices.length)continue;const L=k.footprint.vertices;let x=v.getElevationAt(L[0].x,L[0].y,!0,!0);for(let A=1;A<L.length;A++)x=Math.min(x,v.getElevationAt(L[A].x,L[A].y,!0,!0));k.elevation=x}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=s}}updateDEM(n,s,u,m){let h=s._dem._modifiedForSources[m];if(h===void 0&&(s._dem._modifiedForSources[m]=[],h=s._dem._modifiedForSources[m]),h.includes(u.canonical))return;const v=s._dem.dim;h.push(u.canonical);let T=!1;for(const k of this.getNodesInfo()){const L=k.node;if(!L.footprint||!L.footprint.grid)continue;const x=L.footprint.grid,A=s.tileCoordToPixel(x.min.x,x.min.y),D=s.tileCoordToPixel(x.max.x,x.max.y),M=Math.min(Math.min(v-D.y,A.x),Math.min(A.y,v-D.x));if(M<0)continue;const P=gt(M,2,5);let B=Math.max(0,A.x-P),H=Math.max(0,A.y-P),Z=Math.min(D.x+P,v-1),te=Math.min(D.y+P,v-1);for(let pe=H;pe<=te;++pe)for(let Ce=B;Ce<=Z;++Ce)Kd[pe*v+Ce]=255;let ne=0,X=0;for(let pe=0;pe<x.cellsY;++pe)for(let Ce=0;Ce<x.cellsX;++Ce){if(!x.cells[pe*x.cellsX+Ce])continue;const Ue=s.tileCoordToPixel(x.min.x+Ce/x.xScale,x.min.y+pe/x.yScale),Le=s.tileCoordToPixel(x.min.x+(Ce+1)/x.xScale,x.min.y+(pe+1)/x.yScale);for(let ze=Ue.y;ze<=Math.min(Le.y+1,v-1);++ze)for(let ot=Ue.x;ot<=Math.min(Le.x+1,v-1);++ot)Kd[ze*v+ot]===255&&(Kd[ze*v+ot]=0,ne+=s.getElevationAtPixel(ot,ze),X++)}const le=ne/X;B=Math.max(1,A.x-P),H=Math.max(1,A.y-P),Z=Math.min(D.x+P,v-2),te=Math.min(D.y+P,v-2),T=!0;for(let pe=H;pe<=te;++pe)for(let Ce=B;Ce<=Z;++Ce)Kd[pe*v+Ce]===0&&(Ox[pe*v+Ce]=s._dem.set(Ce,pe,le));for(let pe=1;pe<P;++pe){B=Math.max(1,A.x-pe),H=Math.max(1,A.y-pe),Z=Math.min(D.x+pe,v-2),te=Math.min(D.y+pe,v-2);for(let Ce=H;Ce<=te;++Ce)for(let Ue=B;Ue<=Z;++Ue){const Le=Ce*v+Ue;if(Kd[Le]===255){let ze=0,ot=0,Oe=-1,et=-1;for(let ct=-1;ct<=1;++ct)for(let ut=-1;ut<=1;++ut){const _t=(Ce+ct)*v+Ue+ut;if(Kd[_t]>=pe)continue;const Mt=Ox[_t],kt=Math.abs(Mt);kt>ot&&(ze=Mt,ot=kt,Oe=ut,et=ct)}if(ot>.1){const ct=1-(pe+.5*Math.abs(Oe*et))/P;let ut=s._dem.get(Ue,Ce)+ze*ct;const _t=s._dem.get(Ue+Oe,Ce+et),Mt=s._dem.get(Ue-Oe,Ce-et,!0);(ut-_t)*(ut-Mt)>0&&(ut=(_t+Mt)/2),Ox[Le]=s._dem.set(Ue,Ce,ut),Kd[Le]=pe}}}}}T&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Ht.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const s of n)Qy(s.node),Lx(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped()),m=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const v=m[h].node;m[h].hiddenByReplacement=!!v.footprint&&!u.find(T=>T.footprint===v.footprint)}}getHeightAtTileCoord(n,s){const u=this.getNodesInfo(),m=[],h=[0,0,0],v=Be.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const k=u[T],L=k.node.meshes[0],x=L.transformedAabb;if(n<x.min[0]||s<x.min[1]||n>x.max[0]||s>x.max[1])continue;if(k.node.hidden===!0)return{height:1/0,maxHeight:k.feature.properties.height,hidden:!1,verticalScale:k.evaluatedScale[2]};Be.mat4.invert(v,k.node.matrix),h[0]=n,h[1]=s,Be.vec3.transformMat4(h,h,v);const A=(h[0]-L.aabb.min[0])/(L.aabb.max[0]-L.aabb.min[0])*qd|0,D=Math.min(63,(h[1]-L.aabb.min[1])/(L.aabb.max[1]-L.aabb.min[1])*qd|0)*qd+Math.min(63,A),M=L.heightmap[D];if(!(M<0&&k.node.footprint))return k.hiddenByReplacement?void 0:{height:M,maxHeight:k.feature.properties.height,hidden:!1,verticalScale:k.evaluatedScale[2]};if(k.node.footprint.grid.query(new Fe(n,s),new Fe(n,s),m),m.length>0)return{height:void 0,maxHeight:k.feature.properties.height,hidden:k.hiddenByReplacement,verticalScale:k.evaluatedScale[2]}}}}function zg(c,n){return!c.isLightConstant&&n}function EF(c,n,s,u,m,h,v,T){let k=(61440&n|(61440&n)>>4)>>8,L=(3840&n|(3840&n)>>4)>>4,x=240&n|(240&n)>>4;s[3]>0&&(k=mo(k,255*s[0],s[3]),L=mo(L,255*s[1],s[3]),x=mo(x,255*s[2],s[3]));const A=k<<8|L,D=x<<8|Math.floor(255*u[3]),M=function(pe){const Ce=gt(pe,0,2);return Math.min(Math.round(.5*Ce*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],P=gt(m[0],0,1),B=gt(m[1],0,1),H=gt(m[2],0,1),Z=gt(m[3],0,1);let te,ne,X,le;if(P!==B&&v!==h&&B!==P){const pe=v-h;ne=1/(pe*(B-P)),X=-(h+pe*P)/(pe*(B-P));const Ce=gt(m[4],-1,1);le=Math.pow(10,Ce),te=255*H<<8|255*Z}else te=65535,ne=0,X=1,le=1;if(c.emplaceBack(A,D,M,te,ne,X,le),T){const pe=T.length;T.clear();for(let Ce=0;Ce<pe;Ce++)T.emplaceBack(A,D,M,te,ne,X,le)}}function MF(c,n,s){const u=c.node;let m=0;const h=s&Uf.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===m||!v.featureData)continue;v.featureArray=new Mf,v.featureArray.reserve(v.featureData.length);let T=n;for(const k of v.featureData){const L=h?65535&k:k>>16&65535,x=h?k>>16&65535:65535&k,A=(15&x)<8?15&x:0,D=c.evaluatedRMEA[A],M=c.evaluatedColor[A],P=c.emissionHeightBasedParams[A];let B;if(T&&A===2&&u.lights&&(B=new Mf,B.resize(10*u.lights.length)),EF(v.featureArray,L,M,D,P,v.aabb.min[2],v.aabb.max[2],B),B&&T){T=!1;const H=u.meshes[u.lightMeshIndex];H.featureArray=B,H.featureArray._trim()}}v.featureArray._trim(),m++}}jn(e0,"Tiled3dModelBucket",{omit:["layers"]}),jn(YM,"Tiled3dModelFeature");const IF=["id","tile","layer","source","sourceLayer","state"];class Bg{constructor(n,s,u,m,h){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=u,this._y=m,this.properties=n.properties,this.id=h}clone(){const n=new Bg(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state={...this.state}),this.layer&&(n.layer={...this.layer}),this.namespace&&(n.namespace=this.namespace),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of IF)this[s]!==void 0&&(n[s]=this[s]);return n}}function XM(c,n,s,u){const m=1<<c.z;n.lat=$e((u/In+c.y)/m),n.lng=Pe((s/In+c.x)/m)}const AF={circle:class extends Qi{constructor(c,n,s,u){super(c,{layout:cr||(cr=new zr({"circle-sort-key":new Qn(It.layout_circle["circle-sort-key"]),visibility:new wn(It.layout_circle.visibility)})),paint:Nr||(Nr=new zr({"circle-radius":new Qn(It.paint_circle["circle-radius"]),"circle-color":new Qn(It.paint_circle["circle-color"]),"circle-blur":new Qn(It.paint_circle["circle-blur"]),"circle-opacity":new Qn(It.paint_circle["circle-opacity"]),"circle-translate":new wn(It.paint_circle["circle-translate"]),"circle-translate-anchor":new wn(It.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wn(It.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wn(It.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qn(It.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qn(It.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qn(It.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new wn(It.paint_circle["circle-emissive-strength"])}))},n,s,u)}createBucket(c){return new hn(c)}queryRadius(c){const n=c;return Tr("circle-radius",this,n)+Tr("circle-stroke-width",this,n)+Vo(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,s,u,m,h,v,T){const k=_r(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),L=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return AC(c,u,h,v,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",k,L)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,s){const u=IC(this);return{config:new el(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}},heatmap:class extends Qi{createBucket(c){return new PC(c)}constructor(c,n,s,u){super(c,{layout:RC||(RC=new zr({visibility:new wn(It.layout_heatmap.visibility)})),paint:DC||(DC=new zr({"heatmap-radius":new Qn(It.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qn(It.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wn(It.paint_heatmap["heatmap-intensity"]),"heatmap-color":new du(It.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wn(It.paint_heatmap["heatmap-opacity"])}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Tr("heatmap-radius",this,c)}queryIntersectsFeature(c,n,s,u,m,h,v,T){const k=this.paint.get("heatmap-radius").evaluate(n,s);return AC(c,u,h,v,T,!0,!0,new Fe(0,0),k)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,s){return c==="heatmap"?{config:new el(this,{zoom:n,lut:s}),overrideFog:!1}:{}}},hillshade:class extends Qi{constructor(c,n,s,u){super(c,{layout:LC||(LC=new zr({visibility:new wn(It.layout_hillshade.visibility)})),paint:OC||(OC=new zr({"hillshade-illumination-direction":new wn(It.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wn(It.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wn(It.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wn(It.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wn(It.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wn(It.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new wn(It.paint_hillshade["hillshade-emissive-strength"])}))},n,s,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}},fill:class extends Qi{constructor(c,n,s,u){super(c,{layout:jC||(jC=new zr({"fill-sort-key":new Qn(It.layout_fill["fill-sort-key"]),visibility:new wn(It.layout_fill.visibility),"fill-elevation-reference":new wn(It.layout_fill["fill-elevation-reference"])})),paint:HC||(HC=new zr({"fill-antialias":new wn(It.paint_fill["fill-antialias"]),"fill-opacity":new Qn(It.paint_fill["fill-opacity"]),"fill-color":new Qn(It.paint_fill["fill-color"]),"fill-outline-color":new Qn(It.paint_fill["fill-outline-color"]),"fill-translate":new wn(It.paint_fill["fill-translate"]),"fill-translate-anchor":new wn(It.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qn(It.paint_fill["fill-pattern"]),"fill-emissive-strength":new wn(It.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Qn(It.paint_fill["fill-z-offset"])}))},n,s,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(c,n,s){return{config:new el(this,{zoom:n,lut:s}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new X1(c)}queryRadius(){return Vo(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,s,u,m,h){return!c.queryGeometry.isAboveHorizon&&Zn(yr(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Qi{constructor(c,n,s,u){super(c,{layout:CE||(CE=new zr({visibility:new wn(It["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new wn(It["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:EE||(EE=new zr({"fill-extrusion-opacity":new wn(It["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qn(It["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wn(It["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wn(It["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qn(It["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qn(It["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qn(It["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new wn(It["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new wn(It["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new wn(It["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new wn(It["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new wn(It["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new wn(It["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new wn(It["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new wn(It["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new wn(It["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new wn(It["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Qn(It["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Qn(It["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new wn(It["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new wn(It["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new wn(It["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new wn(It["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Qn(It["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Qn(It["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new wn(It["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Py(c)}queryRadius(){return Vo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,s,u,m,h,v,T,k){const L=_r(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),x=this.paint.get("fill-extrusion-height").evaluate(n,s),A=this.paint.get("fill-extrusion-base").evaluate(n,s),D=[0,0],M=T&&h.elevation,P=h.elevation?h.elevation.exaggeration():1,B=c.tile.getBucket(this);if(M&&B instanceof Py){const X=B.centroidVertexArray,le=k+1;le<X.length&&(D[0]=X.geta_centroid_pos0(le),D[1]=X.geta_centroid_pos1(le))}if(D[0]===0&&D[1]===1)return!1;h.projection.name==="globe"&&(u=TE([u],[new Fe(0,0),new Fe(In,In)],c.tileID.canonical).map(X=>X.polygon).flat());const H=M?T:null,[Z,te]=function(X,le,pe,Ce,Ue,Le,ze,ot,Oe,et,ct){return X.projection.name==="globe"?function(ut,_t,Mt,kt,St,Yt,gn,Ut,zn,En,xn){const pn=[],no=[],Ln=ut.projection.upVectorScale(xn,ut.center.lat,ut.worldSize).metersToTile,Gn=[0,0,0,1],wo=[0,0,0,1],Do=(Ao,Uo,No,Ir)=>{Ao[0]=Uo,Ao[1]=No,Ao[2]=Ir,Ao[3]=1},zo=SE();Mt>0&&(Mt+=zo),kt+=zo;for(const Ao of _t){const Uo=[],No=[];for(const Ir of Ao){const br=Ir.x+St.x,go=Ir.y+St.y,ur=ut.projection.projectTilePoint(br,go,xn),fr=ut.projection.upVector(xn,Ir.x,Ir.y);let Vr=Mt,si=kt;if(gn){const gi=IE(br,go,Mt,kt,gn,Ut,zn,En);Vr+=gi.base,si+=gi.top}Mt!==0?Do(Gn,ur.x+fr[0]*Ln*Vr,ur.y+fr[1]*Ln*Vr,ur.z+fr[2]*Ln*Vr):Do(Gn,ur.x,ur.y,ur.z),Do(wo,ur.x+fr[0]*Ln*si,ur.y+fr[1]*Ln*si,ur.z+fr[2]*Ln*si),Be.vec3.transformMat4(Gn,Gn,Yt),Be.vec3.transformMat4(wo,wo,Yt),Uo.push(new Wd(Gn[0],Gn[1],Gn[2])),No.push(new Wd(wo[0],wo[1],wo[2]))}pn.push(Uo),no.push(No)}return[pn,no]}(X,le,pe,Ce,Ue,Le,ze,ot,Oe,et,ct):ze?function(ut,_t,Mt,kt,St,Yt,gn,Ut,zn){const En=[],xn=[],pn=[0,0,0,1];for(const no of ut){const Ln=[],Gn=[];for(const wo of no){const Do=wo.x+kt.x,zo=wo.y+kt.y,Ao=IE(Do,zo,_t,Mt,Yt,gn,Ut,zn);pn[0]=Do,pn[1]=zo,pn[2]=Ao.base,pn[3]=1,Be.vec4.transformMat4(pn,pn,St),pn[3]=Math.max(pn[3],1e-5);const Uo=new Wd(pn[0]/pn[3],pn[1]/pn[3],pn[2]/pn[3]);pn[0]=Do,pn[1]=zo,pn[2]=Ao.top,pn[3]=1,Be.vec4.transformMat4(pn,pn,St),pn[3]=Math.max(pn[3],1e-5);const No=new Wd(pn[0]/pn[3],pn[1]/pn[3],pn[2]/pn[3]);Ln.push(Uo),Gn.push(No)}En.push(Ln),xn.push(Gn)}return[En,xn]}(le,pe,Ce,Ue,Le,ze,ot,Oe,et):function(ut,_t,Mt,kt,St){const Yt=[],gn=[],Ut=St[8]*_t,zn=St[9]*_t,En=St[10]*_t,xn=St[11]*_t,pn=St[8]*Mt,no=St[9]*Mt,Ln=St[10]*Mt,Gn=St[11]*Mt;for(const wo of ut){const Do=[],zo=[];for(const Ao of wo){const Uo=Ao.x+kt.x,No=Ao.y+kt.y,Ir=St[0]*Uo+St[4]*No+St[12],br=St[1]*Uo+St[5]*No+St[13],go=St[2]*Uo+St[6]*No+St[14],ur=St[3]*Uo+St[7]*No+St[15],fr=Ir+Ut,Vr=br+zn,si=go+En,gi=Math.max(ur+xn,1e-5),ai=Ir+pn,Qr=br+no,ci=go+Ln,bi=Math.max(ur+Gn,1e-5);Do.push(new Wd(fr/gi,Vr/gi,si/gi)),zo.push(new Wd(ai/bi,Qr/bi,ci/bi))}Yt.push(Do),gn.push(zo)}return[Yt,gn]}(le,pe,Ce,Ue,Le)}(h,u,A,x,L,v,H,D,P,h.center.lat,c.tileID.canonical),ne=c.queryGeometry;return function(X,le,pe){let Ce=1/0;Zn(pe,le)&&(Ce=ME(pe,le[0]));for(let Ue=0;Ue<le.length;Ue++){const Le=le[Ue],ze=X[Ue];for(let ot=0;ot<Le.length-1;ot++){const Oe=Le[ot],et=[Oe,Le[ot+1],ze[ot+1],ze[ot],Oe];nn(pe,et)&&(Ce=Math.min(Ce,ME(pe,et)))}}return Ce!==1/0&&Ce}(Z,te,ne.isPointQuery()?ne.screenBounds:ne.screenGeometry)}},line:class extends Qi{constructor(c,n,s,u){const m=FE();super(c,m,n,s,u),m.layout&&(this.layout=new uu(m.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof wd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(Tg)return Tg;const s=FE();return Tg=new PB(s.paint.properties["line-width"].specification),Tg.useIntegerZoom=!0,Tg})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new ax(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,s){const u=zE(this);return{config:new el(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}queryRadius(c){const n=c,s=NE(Tr("line-width",this,n),Tr("line-gap-width",this,n)),u=Tr("line-offset",this,n);return s/2+Math.abs(u)+Vo(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,s,u,m,h){if(c.queryGeometry.isAboveHorizon)return!1;const v=yr(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),T=c.pixelToTileUnitsFactor/2*NE(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),k=this.paint.get("line-offset").evaluate(n,s);return k&&(u=function(L,x){const A=[],D=new Fe(0,0);for(let M=0;M<L.length;M++){const P=L[M],B=[];for(let H=0;H<P.length;H++){const Z=P[H],te=P[H+1],ne=H===0?D:Z.sub(P[H-1])._unit()._perp(),X=H===P.length-1?D:te.sub(Z)._unit()._perp(),le=ne._add(X)._unit();le._mult(1/(le.x*X.x+le.y*X.y)),B.push(le._mult(x)._add(Z))}A.push(B)}return A}(u,k*c.pixelToTileUnitsFactor)),function(L,x,A){for(let D=0;D<x.length;D++){const M=x[D];if(L.length>=3){for(let P=0;P<M.length;P++)if(Go(L,M[P]))return!0}if(to(L,M,A))return!0}return!1}(v,u,T)}isTileClipped(){return!0}isDraped(c){const n=this.layout.get("line-z-offset"),s=n.isConstant()&&!n.constantOr(0),u=this.layout.get("line-elevation-reference");return!(u==="sea"||u==="ground")&&(s||u!=="none")}},symbol:Wy,background:class extends Qi{constructor(c,n,s,u){super(c,{layout:wM||(wM=new zr({visibility:new wn(It.layout_background.visibility)})),paint:SM||(SM=new zr({"background-pitch-alignment":new wn(It.paint_background["background-pitch-alignment"]),"background-color":new wn(It.paint_background["background-color"]),"background-pattern":new wn(It.paint_background["background-pattern"]),"background-opacity":new wn(It.paint_background["background-opacity"]),"background-emissive-strength":new wn(It.paint_background["background-emissive-strength"])}))},n,s,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:IM,"raster-particle":LM,sky:class extends Qi{constructor(c,n,s,u){super(c,{layout:PM||(PM=new zr({visibility:new wn(It.layout_sky.visibility)})),paint:RM||(RM=new zr({"sky-type":new wn(It.paint_sky["sky-type"]),"sky-atmosphere-sun":new wn(It.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new wn(It.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new wn(It.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new wn(It.paint_sky["sky-gradient-radius"]),"sky-gradient":new du(It.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new wn(It.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new wn(It.paint_sky["sky-atmosphere-color"]),"sky-opacity":new wn(It.paint_sky["sky-opacity"])}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=mg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),m=!u,h=c.style.light,v=h.properties.get("position");return m&&h.properties.get("anchor")==="viewport"&&Mn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?Ax(v.azimuthal,90-v.polar,n):Ax(u[0],90-u[1],n)}const s=this.paint.get("sky-gradient-center");return Ax(s[0],90-s[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Qi{constructor(c,n,s,u){super(c,{paint:DM||(DM=new zr({}))},n,null)}},model:class extends Qi{constructor(c,n,s,u){super(c,{layout:HM||(HM=new zr({visibility:new wn(It.layout_model.visibility),"model-id":new Qn(It.layout_model["model-id"])})),paint:GM||(GM=new zr({"model-opacity":new wn(It.paint_model["model-opacity"]),"model-rotation":new Qn(It.paint_model["model-rotation"]),"model-scale":new Qn(It.paint_model["model-scale"]),"model-translation":new Qn(It.paint_model["model-translation"]),"model-color":new Qn(It.paint_model["model-color"]),"model-color-mix-intensity":new Qn(It.paint_model["model-color-mix-intensity"]),"model-type":new wn(It.paint_model["model-type"]),"model-cast-shadows":new wn(It.paint_model["model-cast-shadows"]),"model-receive-shadows":new wn(It.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new wn(It.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Qn(It.paint_model["model-emissive-strength"]),"model-roughness":new Qn(It.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Qn(It.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new wn(It.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new wn(It.paint_model["model-front-cutoff"])}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Rx(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof e0?In-1:0}queryIntersectsFeature(c,n,s,u,m,h){if(!this.modelManager)return!1;const v=this.modelManager,T=c.tile.getBucket(this);if(!(T&&T instanceof Rx))return!1;const k=T;for(const L in k.instancesPerModel){const x=k.instancesPerModel[L],A=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(x.idToFeaturesIndex.hasOwnProperty(A)){const D=x.features[x.idToFeaturesIndex[A]],M=v.getModel(L,this.scope);if(!M)return!1;let P=Be.mat4.create();const B=new j(0,0),H=k.canonical;let Z=Number.MAX_VALUE;for(let te=0;te<D.instancedDataCount;++te){const ne=16*(D.instancedDataOffset+te),X=x.instancedDataArray.float32,le=[X[ne+4],X[ne+5],X[ne+6]];XM(H,B,X[ne],0|X[ne+1]),WM(P,M,h,B,D.rotation,D.scale,le,!1,!1,!1),h.projection.name==="globe"&&(P=Px(P,h));const pe=Be.mat4.multiply([],h.projMatrix,P),Ce=c.queryGeometry,Ue=NM(Ce.isPointQuery()?Ce.screenBounds:Ce.screenGeometry,h,pe,M.aabb);Ue!=null&&(Z=Math.min(Ue,Z))}return Z!==Number.MAX_VALUE&&Z}}return!1}_handleOverridablePaintPropertyUpdate(c,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Id}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(c,n,s,u){const m=c.tile,h=m.getBucket(this);let v=null,T=Number.MAX_VALUE;if(!(h&&h instanceof e0))return{queryFeature:v,intersectionZ:T};const k=h.getNodesInfo()[n];if(k.hiddenByReplacement||!k.node.meshes||!s.filter(new Zr(m.tileID.overscaledZ),k.feature,m.tileID.canonical))return{queryFeature:v,intersectionZ:T};const L=k.node,x=u.calculatePosMatrix(m.tileID.toUnwrapped(),u.worldSize),A=k.evaluatedScale;let D=0;u.elevation&&L.elevation&&(D=L.elevation*u.elevation.exaggeration()),Be.mat4.translate(x,x,[(L.anchor?L.anchor[0]:0)*(A[0]-1),(L.anchor?L.anchor[1]:0)*(A[1]-1),D]),Be.mat4.scale(x,x,A);const M=c.queryGeometry,P=M.isPointQuery()?M.screenBounds:M.screenGeometry,B=function(X){const le=Be.mat4.multiply([],x,X.matrix);Be.mat4.multiply(le,u.expandedFarZProjMatrix,le);for(let pe=0;pe<X.meshes.length;++pe){const Ce=X.meshes[pe];if(pe===X.lightMeshIndex)continue;const Ue=NM(P,u,le,Ce.aabb);Ue!=null&&(T=Math.min(Ue,T))}if(X.children)for(const pe of X.children)B(pe)};if(B(L),T===Number.MAX_VALUE)return{queryFeature:v,intersectionZ:T};const H=new j(0,0);XM(m.tileID.canonical,H,k.node.anchor[0],k.node.anchor[1]);const{z:Z,x:te,y:ne}=m.tileID.canonical;return v=new Bg({},Z,te,ne,k.feature.id),v.properties=k.feature.properties,v.geometry={type:"Point",coordinates:[H.lng,H.lat]},v.layer={...this.serialize(),id:this.fqid},v.state={},v.tile=m.tileID.canonical,{queryFeature:v,intersectionZ:T}}},clip:class extends Qi{constructor(c,n,s,u){super(c,{layout:GC||(GC=new zr({"clip-layer-types":new wn(It.layout_clip["clip-layer-types"]),"clip-layer-scope":new wn(It.layout_clip["clip-layer-scope"])})),paint:WC||(WC=new zr({}))},n,s,u)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new qC(c)}isTileClipped(){return!0}is3D(){return!0}}};class kF{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class PF{constructor(){this.tasks={},this.taskQueue=[],Pt(["process"],this),this.invoker=new kF(this.process),this.nextId=0}add(n,s){const u=this.nextId++,m=function({type:h,isSymbolTile:v,zoom:T}){return T=T||0,h==="message"?0:h!=="maybePrepare"||v?h!=="parseTile"||v?h==="parseTile"&&v?300-T:h==="maybePrepare"&&v?400-T:500:200-T:100-T}(s);if(m===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:s,priority:m,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let m=0;m<this.taskQueue.length;m++){const h=this.tasks[this.taskQueue[m]];h.priority<s&&(s=h.priority,n=m)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class JM{constructor(n,s,u){this.target=n,this.parent=s,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Pt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new PF}send(n,s,u,m,h=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[T]=u);const k=new Set;return this.target.postMessage({id:T,type:n,hasCallback:!!u,targetMapId:m,mustQueue:h,sourceMapId:this.mapId,data:fc(s,k)},k),{cancel:()=>{u&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(n){const s=n.data,u=s.id;if(u&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const m=this.cancelCallbacks[u];delete this.cancelCallbacks[u],m&&m.cancel()}else if(s.mustQueue||Ur()){const m=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,s),m&&m.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,s)}processTask(n,s){if(delete this.cancelCallbacks[n],s.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(s.error?u(cs(s.error)):u(null,cs(s.data)))}else{const u=new Set,m=s.hasCallback?(v,T)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:v?fc(v):null,data:fc(T,u)},u)}:()=>{},h=cs(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,h,m);else if(this.parent.getWorkerSource){const v=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,v[0],h.source,h.scope)[v[1]](h,m)}else m(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Hf{constructor(n,s){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=Lo();const u=this.workerPool.acquire(this.id);for(let m=0;m<u.length;m++){const h=new Hf.Actor(u[m],s,this.id);h.name=`Worker ${m}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,s,u){lo(this.actors,(m,h)=>{m.send(n,s,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}Hf.Actor=JM;class QM{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const u=this.toIdx(n,s);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function eI(c,n,s,u){let m=0,h=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(s[v]<c[v]||s[v]>n[v])return null}else{const T=1/u[v];let k=(c[v]-s[v])*T,L=(n[v]-s[v])*T;if(k>L){const x=k;k=L,L=x}if(k>m&&(m=k),L<h&&(h=L),m>h)return null}return m}function tI(c,n,s,u,m,h,v,T,k,L,x){const A=u-c,D=m-n,M=h-s,P=v-c,B=T-n,H=k-s,Z=x[1]*H-x[2]*B,te=x[2]*P-x[0]*H,ne=x[0]*B-x[1]*P,X=A*Z+D*te+M*ne;if(Math.abs(X)<1e-15)return null;const le=1/X,pe=L[0]-c,Ce=L[1]-n,Ue=L[2]-s,Le=(pe*Z+Ce*te+Ue*ne)*le;if(Le<0||Le>1)return null;const ze=Ce*M-Ue*D,ot=Ue*A-pe*M,Oe=pe*D-Ce*A,et=(x[0]*ze+x[1]*ot+x[2]*Oe)*le;return et<0||Le+et>1?null:(P*ze+B*ot+H*Oe)*le}function nI(c,n,s){return(c-n)/(s-n)}function oI(c,n,s,u,m,h,v,T,k){const L=1<<s,x=h-u,A=v-m,D=(c+1)/L*x+u,M=(n+0)/L*A+m,P=(n+1)/L*A+m;T[0]=(c+0)/L*x+u,T[1]=M,k[0]=D,k[1]=P}class rI{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(h){const v=Math.ceil(Math.log2(h.dim/8)),T=[];let k=Math.ceil(Math.pow(2,v));const L=1/k,x=(M,P,B,H,Z)=>{const te=H?1:0,ne=(M+1)*B-te,X=P*B,le=(P+1)*B-te;Z[0]=M*B,Z[1]=X,Z[2]=ne,Z[3]=le};let A=new QM(k);const D=[];for(let M=0;M<k*k;M++){x(M%k,Math.floor(M/k),L,!1,D);const P=Au(D[0],D[1],h),B=Au(D[2],D[1],h),H=Au(D[2],D[3],h),Z=Au(D[0],D[3],h);A.minimums.push(Math.min(P,B,H,Z)),A.maximums.push(Math.max(P,B,H,Z)),A.leaves.push(1)}for(T.push(A),k/=2;k>=1;k/=2){const M=T[T.length-1];A=new QM(k);for(let P=0;P<k*k;P++){x(P%k,Math.floor(P/k),2,!0,D);const B=M.getElevation(D[0],D[1]),H=M.getElevation(D[2],D[1]),Z=M.getElevation(D[2],D[3]),te=M.getElevation(D[0],D[3]),ne=M.isLeaf(D[0],D[1]),X=M.isLeaf(D[2],D[1]),le=M.isLeaf(D[2],D[3]),pe=M.isLeaf(D[0],D[3]),Ce=Math.min(B.min,H.min,Z.min,te.min),Ue=Math.max(B.max,H.max,Z.max,te.max),Le=ne&&X&&le&&pe;A.maximums.push(Ue),A.minimums.push(Ce),A.leaves.push(Ue-Ce<=5&&Le?1:0)}T.push(A)}return T}(this.dem),u=s.length-1,m=s[u];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(s,0,0,u,0)}raycastRoot(n,s,u,m,h,v,T=1){return eI([n,s,-100],[u,m,this.maximums[0]*T],h,v)}raycast(n,s,u,m,h,v,T=1){if(!this.nodeCount)return null;const k=this.raycastRoot(n,s,u,m,h,v,T);if(k==null)return null;const L=[],x=[],A=[],D=[],M=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;M.length>0;){const{idx:P,t:B,nodex:H,nodey:Z,depth:te}=M.pop();if(this.leaves[P]){oI(H,Z,te,n,s,u,m,A,D);const X=1<<te,le=(H+0)/X,pe=(H+1)/X,Ce=(Z+0)/X,Ue=(Z+1)/X,Le=Au(le,Ce,this.dem)*T,ze=Au(pe,Ce,this.dem)*T,ot=Au(pe,Ue,this.dem)*T,Oe=Au(le,Ue,this.dem)*T,et=tI(A[0],A[1],Le,D[0],A[1],ze,D[0],D[1],ot,h,v),ct=tI(D[0],D[1],ot,A[0],D[1],Oe,A[0],A[1],Le,h,v),ut=Math.min(et!==null?et:Number.MAX_VALUE,ct!==null?ct:Number.MAX_VALUE);if(ut!==Number.MAX_VALUE)return ut;{const _t=Be.vec3.scaleAndAdd([],h,v,B);if(iI(Le,ze,Oe,ot,nI(_t[0],A[0],D[0]),nI(_t[1],A[1],D[1]))>=_t[2])return B}continue}let ne=0;for(let X=0;X<this._siblingOffset.length;X++){oI((H<<1)+this._siblingOffset[X][0],(Z<<1)+this._siblingOffset[X][1],te+1,n,s,u,m,A,D),A[2]=-100,D[2]=this.maximums[this.childOffsets[P]+X]*T;const le=eI(A,D,h,v);if(le!=null){const pe=le;L[X]=pe;let Ce=!1;for(let Ue=0;Ue<ne&&!Ce;Ue++)pe>=L[x[Ue]]&&(x.splice(Ue,0,X),Ce=!0);Ce||(x[ne]=X),ne++}}for(let X=0;X<ne;X++){const le=x[X];M.push({idx:this.childOffsets[P]+le,t:L[le],nodex:(H<<1)+this._siblingOffset[le][0],nodey:(Z<<1)+this._siblingOffset[le][1],depth:te+1})}}return null}_addNode(n,s,u){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,u,m,h){if(n[m].isLeaf(s,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const v=m-1,T=n[v];let k=0,L=0;for(let x=0;x<this._siblingOffset.length;x++){const A=2*s+this._siblingOffset[x][0],D=2*u+this._siblingOffset[x][1],M=T.getElevation(A,D),P=T.isLeaf(A,D),B=this._addNode(M.min,M.max,P);P&&(k|=1<<x),L||(L=B)}for(let x=0;x<this._siblingOffset.length;x++)k&1<<x||this._construct(n,2*s+this._siblingOffset[x][0],2*u+this._siblingOffset[x][1],v,L+x)}}function iI(c,n,s,u,m,h){return mo(mo(c,s,h),mo(n,u,h),m)}function Au(c,n,s){const u=s.dim,m=gt(c*u-.5,0,u-1),h=gt(n*u-.5,0,u-1),v=Math.floor(m),T=Math.floor(h),k=Math.min(v+1,u-1),L=Math.min(T+1,u-1);return iI(s.get(v,T),s.get(k,T),s.get(v,L),s.get(k,L),m-v,h-T)}const RF={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function DF(c,n,s){return(256*c*256+256*n+s)/10-1e4}function LF(c,n,s){return 256*c+n+s/256-32768}class t0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,u,m=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void Mn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const h=this.dim=s.height-2,v=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let k=0;k<h;k++)v[this._idx(-1,k)]=v[this._idx(0,k)],v[this._idx(h,k)]=v[this._idx(h-1,k)],v[this._idx(k,-1)]=v[this._idx(k,0)],v[this._idx(k,h)]=v[this._idx(k,h-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(h,-1)]=v[this._idx(h-1,0)],v[this._idx(-1,h)]=v[this._idx(0,h-1)],v[this._idx(h,h)]=v[this._idx(h-1,h-1)]}const T=u==="terrarium"?LF:DF;for(let k=0;k<v.length;++k){const L=4*k;this.floatView[k]=T(this.pixels[L],this.pixels[L+1],this.pixels[L+2])}this._timestamp=Ht.now()}_buildQuadTree(){this._tree=new rI(this)}get(n,s,u=!1){u&&(n=gt(n,-1,this.dim),s=gt(s,-1,this.dim));const m=this._idx(n,s);return this.floatView[m]}set(n,s,u){const m=this._idx(n,s),h=this.floatView[m];return this.floatView[m]=u,u-h}static getUnpackVector(n){return RF[n]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const u=[0,0,0,0],m=t0.getUnpackVector(s);let h=Math.floor((n+m[3])/m[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new FC({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let m=s*this.dim,h=s*this.dim+this.dim,v=u*this.dim,T=u*this.dim+this.dim;switch(s){case-1:m=h-1;break;case 1:h=m+1}switch(u){case-1:v=T-1;break;case 1:T=v+1}const k=-s*this.dim,L=-u*this.dim;for(let x=v;x<T;x++)for(let A=m;A<h;A++){const D=4*this._idx(A,x),M=4*this._idx(A+k,x+L);this.pixels[D+0]=n.pixels[M+0],this.pixels[D+1]=n.pixels[M+1],this.pixels[D+2]=n.pixels[M+2],this.pixels[D+3]=n.pixels[M+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function OF(c,n,s){c===1?n.headerLength=s.readFixed32():c===2?n.x=s.readVarint():c===3?n.y=s.readVarint():c===4?n.z=s.readVarint():c===5&&n.layers.push(function(u,m){return u.readFields($F,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},m)}(s,s.readVarint()+s.pos))}function zF(c,n,s){c===1?(n.delta_filter=function(u,m){return u.readFields(BF,{blockSize:0},m)}(s,s.readVarint()+s.pos),n.filter="delta_filter"):c===2?(s.readVarint(),n.filter="zigzag_filter"):c===3?(s.readVarint(),n.filter="bitshuffle_filter"):c===4&&(s.readVarint(),n.filter="byteshuffle_filter")}function BF(c,n,s){c===1&&(n.blockSize=s.readVarint())}function FF(c,n,s){c===1?(s.readVarint(),n.codec="gzip_data"):c===2?(s.readVarint(),n.codec="jpeg_image"):c===3?(s.readVarint(),n.codec="webp_image"):c===4&&(s.readVarint(),n.codec="png_image")}function NF(c,n,s){let u=0,m=0;c===1?n.firstByte=s.readFixed64():c===2?n.lastByte=s.readFixed64():c===3?n.filters.push(function(h,v){return h.readFields(zF,{},v)}(s,s.readVarint()+s.pos)):c===4?n.codec=function(h,v){return h.readFields(FF,{},v)}(s,s.readVarint()+s.pos):c===5?m=s.readFloat():c===6?u=s.readFloat():c===7?n.bands.push(s.readString()):c===8?n.offset=s.readDouble():c===9&&(n.scale=s.readDouble()),n.offset===0&&(n.offset=m),n.scale===0&&(n.scale=u)}function $F(c,n,s){c===1?n.version=s.readVarint():c===2?n.name=s.readString():c===3?n.units=s.readString():c===4?n.tileSize=s.readVarint():c===5?n.buffer=s.readVarint():c===6?n.pixelFormat=s.readVarint():c===7&&n.dataIndex.push(function(u,m){return u.readFields(NF,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},m)}(s,s.readVarint()+s.pos))}function VF(c,n,s){if(c===2)(function(u,m,h){u.readFields(UF,h,m)})(s,s.readVarint()+s.pos,n);else if(c===3)throw new Error("Not implemented")}function UF(c,n,s){if(c===1){let u=0;const m=s.readVarint()+s.pos;for(;s.pos<m;)n[u++]=s.readVarint()}}jn(t0,"DEMData"),jn(rI,"DemMinMaxQuadTree",{omit:["dem"]});class jF{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const s=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,s),s}put(n,s){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,s)}}function HF(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let s=n[3];for(let u=2;u>=1;u--){const m=u===1?1:0,h=u===2?1:0;for(let v=0;v<n[0];v++){const T=n[1]*v;for(let k=m;k<n[1];k++){const L=n[2]*(k+T);for(let x=h;x<n[2];x++){const A=n[3]*(x+L);for(let D=0;D<n[3];D++){const M=A+D;c[M]+=c[M-s]}}}}s*=n[u]}return c}function GF(c){for(let n=0,s=c.length;n<s;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function WF(c,n){switch(n){case"uint32":return c;case"uint16":for(let s=0;s<c.length;s+=2){const u=c[s],m=c[s+1];c[s]=(240&u)>>4|(61440&u)>>8|(240&m)<<4|61440&m,c[s+1]=15&u|(3840&u)>>4|(15&m)<<8|(3840&m)<<4}return c;case"uint8":for(let s=0;s<c.length;s+=4){const u=c[s],m=c[s+1],h=c[s+2],v=c[s+3];c[s+0]=(192&u)>>6|(192&m)>>4|(192&h)>>2|192&v,c[s+1]=(48&u)>>4|(48&m)>>2|48&h|(48&v)<<2,c[s+2]=(12&u)>>2|12&m|(12&h)<<2|(12&v)<<4,c[s+3]=3&u|(3&m)<<2|(3&h)<<4|(3&v)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}var ua=Uint8Array,Fg=Uint16Array,qF=Int32Array,sI=new ua([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),aI=new ua([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),KF=new ua([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lI=function(c,n){for(var s=new Fg(31),u=0;u<31;++u)s[u]=n+=1<<c[u-1];var m=new qF(s[30]);for(u=1;u<30;++u)for(var h=s[u];h<s[u+1];++h)m[h]=h-s[u]<<5|u;return{b:s,r:m}},cI=lI(sI,2),uI=cI.b,ZF=cI.r;uI[28]=258,ZF[258]=28;for(var YF=lI(aI,0).b,dI=new Fg(32768),mi=0;mi<32768;++mi){var Gf=(43690&mi)>>1|(21845&mi)<<1;dI[mi]=((65280&(Gf=(61680&(Gf=(52428&Gf)>>2|(13107&Gf)<<2))>>4|(3855&Gf)<<4))>>8|(255&Gf)<<8)>>1}var Ng=function(c,n,s){for(var u=c.length,m=0,h=new Fg(n);m<u;++m)c[m]&&++h[c[m]-1];var v,T=new Fg(n);for(m=1;m<n;++m)T[m]=T[m-1]+h[m-1]<<1;v=new Fg(1<<n);var k=15-n;for(m=0;m<u;++m)if(c[m])for(var L=m<<4|c[m],x=n-c[m],A=T[c[m]-1]++<<x,D=A|(1<<x)-1;A<=D;++A)v[dI[A]>>k]=L;return v},$g=new ua(288);for(mi=0;mi<144;++mi)$g[mi]=8;for(mi=144;mi<256;++mi)$g[mi]=9;for(mi=256;mi<280;++mi)$g[mi]=7;for(mi=280;mi<288;++mi)$g[mi]=8;var hI=new ua(32);for(mi=0;mi<32;++mi)hI[mi]=5;var XF=Ng($g,9),JF=Ng(hI,5),zx=function(c){for(var n=c[0],s=1;s<c.length;++s)c[s]>n&&(n=c[s]);return n},rl=function(c,n,s){var u=n/8|0;return(c[u]|c[u+1]<<8)>>(7&n)&s},Bx=function(c,n){var s=n/8|0;return(c[s]|c[s+1]<<8|c[s+2]<<16)>>(7&n)},QF=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],il=function(c,n,s){var u=new Error(n||QF[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,il),!s)throw u;return u},eN=new ua(0),tN=typeof TextDecoder<"u"&&new TextDecoder;try{tN.decode(eN,{stream:!0})}catch{}const nN={gzip_data:"gzip"};class Ia extends Error{constructor(n){super(n),this.name="MRTError"}}const oN={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},fI={uint32:1,uint16:2,uint8:4},rN={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Fx;class Nx{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const s=this.layers[n];if(!s)throw new Ia(`Layer '${n}' not found`);return s}getHeaderLength(n){const s=new Uint8Array(n),u=new DataView(n);if(s[0]!==13)throw new Ia("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const s=new Uint8Array(n),u=this.getHeaderLength(n);if(s.length<u)throw new Ia(`Expected header with length >= ${u} but got buffer of length ${s.length}`);const m=function(h,v){return h.readFields(OF,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Fx(s.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new Ia(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const h of m.layers)this.layers[h.name]=new iN(h,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const s=[],u=this.getLayer(n.layerName);for(let m of n.blockIndices){const h=u.dataIndex[m],v=h.firstByte-n.firstByte,T=h.lastByte-n.firstByte;if(u._blocksInProgress.has(m))continue;const k={layerName:u.name,firstByte:v,lastByte:T,pixelFormat:u.pixelFormat,blockIndex:m,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(L=>L.filter)};u._blocksInProgress.add(m),s.push(k)}return new pI(s,()=>{s.forEach(m=>u._blocksInProgress.delete(m.blockIndex))},(m,h)=>{if(s.forEach(v=>u._blocksInProgress.delete(v.blockIndex)),m)throw m;h.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class iN{constructor({version:n,name:s,units:u,tileSize:m,pixelFormat:h,buffer:v,dataIndex:T},k){if(this.version=n,this.version!==1)throw new Ia(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=s,this.units=u,this.tileSize=m,this.buffer=v,this.pixelFormat=oN[h],this.dataIndex=T,this.bandShape=[m+2*v,m+2*v,fI[this.pixelFormat]],this._decodedBlocks=new jF(k?k.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return fI[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const s=n.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,n.data)}getBlockForBand(n){let s=0;switch(typeof n){case"string":for(const[u,m]of this.dataIndex.entries()){for(const[h,v]of m.bands.entries())if(v===n)return{bandIndex:s+h,blockIndex:u,blockBandIndex:h};s+=m.bands.length}break;case"number":for(const[u,m]of this.dataIndex.entries()){if(n>=s&&n<s+m.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-s};s+=m.bands.length}break;default:throw new Ia(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new Ia(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let s=1/0,u=-1/0;const m=[],h=new Set;for(const v of n){const{blockIndex:T}=this.getBlockForBand(v);if(T<0)throw new Ia(`Invalid band: ${JSON.stringify(v)}`);const k=this.dataIndex[T];m.includes(T)||m.push(T),h.add(T),s=Math.min(s,k.firstByte),u=Math.max(u,k.lastByte)}if(h.size>this.cacheSize)throw new Ia(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:u,blockIndices:m}}hasBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0}hasDataForBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(n){const{blockIndex:s,blockBandIndex:u}=this.getBlockForBand(n),m=this._decodedBlocks.get(s.toString());if(!m)throw new Ia(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[s],v=this.bandShape.reduce((L,x)=>L*x,1),T=u*v,k=m.subarray(T,T+v);return{data:k,bytes:new Uint8Array(k.buffer).subarray(k.byteOffset,k.byteOffset+k.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}Nx.setPbf=function(c){Fx=c};class pI{constructor(n,s,u){this.tasks=n,this._onCancel=s,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,s){this._finalized||(this._onComplete(n,s),this._finalized=!0)}}Nx.performDecoding=function(c,n){const s=new Uint8Array(c);return Promise.all(n.tasks.map(u=>{const{layerName:m,firstByte:h,lastByte:v,pixelFormat:T,blockShape:k,blockIndex:L,filters:x,codec:A}=u,D=s.subarray(h,v+1),M=new Uint32Array(k[0]*k[1]*k[2]);let P;if(A!=="gzip_data")throw new Ia(`Unhandled codec: ${A}`);return P=function(B,H){if(!globalThis.DecompressionStream&&H==="gzip_data")return Promise.resolve(((X=function(Ce){Ce[0]==31&&Ce[1]==139&&Ce[2]==8||il(6,"invalid gzip data");var Ue=Ce[3],Le=10;4&Ue&&(Le+=2+(Ce[10]|Ce[11]<<8));for(var ze=(Ue>>3&1)+(Ue>>4&1);ze>0;ze-=!Ce[Le++]);return Le+(2&Ue)}(ne=B))+8>ne.length&&il(6,"invalid gzip data"),function(Ce,Ue,Le,ze){var ot=Ce.length;if(!ot||Ue.f&&!Ue.l)return Le||new ua(0);var Oe=!Le,et=Oe||Ue.i!=2,ct=Ue.i;Oe&&(Le=new ua(3*ot));var ut,_t,Mt=function(ku){var Xd=Le.length;if(ku>Xd){var qg=new ua(Math.max(2*Xd,ku));qg.set(Le),Le=qg}},kt=Ue.f||0,St=Ue.p||0,Yt=Ue.b||0,gn=Ue.l,Ut=Ue.d,zn=Ue.m,En=Ue.n,xn=8*ot;do{if(!gn){kt=rl(Ce,St,1);var pn=rl(Ce,St+1,3);if(St+=3,!pn){var no=Ce[(go=4+((St+7)/8|0))-4]|Ce[go-3]<<8,Ln=go+no;if(Ln>ot){ct&&il(0);break}et&&Mt(Yt+no),Le.set(Ce.subarray(go,Ln),Yt),Ue.b=Yt+=no,Ue.p=St=8*Ln,Ue.f=kt;continue}if(pn==1)gn=XF,Ut=JF,zn=9,En=5;else if(pn==2){var Gn=rl(Ce,St,31)+257,wo=rl(Ce,St+10,15)+4,Do=Gn+rl(Ce,St+5,31)+1;St+=14;for(var zo=new ua(Do),Ao=new ua(19),Uo=0;Uo<wo;++Uo)Ao[KF[Uo]]=rl(Ce,St+3*Uo,7);St+=3*wo;var No=zx(Ao),Ir=(1<<No)-1,br=Ng(Ao,No);for(Uo=0;Uo<Do;){var go,ur=br[rl(Ce,St,Ir)];if(St+=15&ur,(go=ur>>4)<16)zo[Uo++]=go;else{var fr=0,Vr=0;for(go==16?(Vr=3+rl(Ce,St,3),St+=2,fr=zo[Uo-1]):go==17?(Vr=3+rl(Ce,St,7),St+=3):go==18&&(Vr=11+rl(Ce,St,127),St+=7);Vr--;)zo[Uo++]=fr}}var si=zo.subarray(0,Gn),gi=zo.subarray(Gn);zn=zx(si),En=zx(gi),gn=Ng(si,zn),Ut=Ng(gi,En)}else il(1);if(St>xn){ct&&il(0);break}}et&&Mt(Yt+131072);for(var ai=(1<<zn)-1,Qr=(1<<En)-1,ci=St;;ci=St){var bi=(fr=gn[Bx(Ce,St)&ai])>>4;if((St+=15&fr)>xn){ct&&il(0);break}if(fr||il(2),bi<256)Le[Yt++]=bi;else{if(bi==256){ci=St,gn=null;break}var Bi=bi-254;bi>264&&(Bi=rl(Ce,St,(1<<(al=sI[Uo=bi-257]))-1)+uI[Uo],St+=al);var Fr=Ut[Bx(Ce,St)&Qr],ks=Fr>>4;if(Fr||il(3),St+=15&Fr,gi=YF[ks],ks>3){var al=aI[ks];gi+=Bx(Ce,St)&(1<<al)-1,St+=al}if(St>xn){ct&&il(0);break}et&&Mt(Yt+131072);var Aa=Yt+Bi;if(Yt<gi){var ka=0-gi,Yd=Math.min(gi,Aa);for(ka+Yt<0&&il(3);Yt<Yd;++Yt)Le[Yt]=(void 0)[ka+Yt]}for(;Yt<Aa;++Yt)Le[Yt]=Le[Yt-gi]}}Ue.l=gn,Ue.p=ci,Ue.b=Yt,Ue.f=kt,gn&&(kt=1,Ue.m=zn,Ue.d=Ut,Ue.n=En)}while(!kt);return Yt!=Le.length&&Oe?(ut=Le,((_t=Yt)==null||_t>ut.length)&&(_t=ut.length),new ua(ut.subarray(0,_t))):Le.subarray(0,Yt)}(ne.subarray(X,-8),{i:2},new ua(((Z=ne)[(te=Z.length)-4]|Z[te-3]<<8|Z[te-2]<<16|Z[te-1]<<24)>>>0))));var Z,te,ne,X;const le=nN[H];if(!le)throw new Error(`Unhandled codec: ${H}`);const pe=new globalThis.DecompressionStream(le);return new Response(new Blob([B]).stream().pipeThrough(pe)).arrayBuffer().then(Ce=>new Uint8Array(Ce))}(D,A).then(B=>(function(H,Z){H.readFields(VF,Z)}(new Fx(B),M),new rN[T](M.buffer))),P.then(B=>{for(let H=x.length-1;H>=0;H--)switch(x[H]){case"delta_filter":HF(B,k);break;case"zigzag_filter":GF(B);break;case"bitshuffle_filter":WF(B,T);break;default:throw new Ia(`Unhandled filter "${x[H]}"`)}return{layerName:m,blockIndex:L,data:B}}).catch(B=>{throw B})}))},jn(pI,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var Vg={workerUrl:"",workerClass:null,workerParams:void 0};const $x="mapboxgl_preloaded_worker_pool";class Ug{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Ug.workerCount;)this.workers.push(Vg.workerClass!=null?new Vg.workerClass:new self.Worker(Vg.workerUrl,Vg.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[$x]}numActive(){return Object.keys(this.active).length}}let jg;function n0(){return jg||(jg=new Ug),jg}Ug.workerCount=2;let Hg,Vx,sl,Wf,Ux,qf=null;function mI(){return Ur()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Vx||He.DRACO_URL}function gI(){if(Ur()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Wf)return Wf;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Wf=WebAssembly.validate(c)?He.MESHOPT_SIMD_URL:He.MESHOPT_URL,Wf}const o0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},sN={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Gg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function vI(c,n,s){const u=s.json.bufferViews.length,m=s.buffers.length;n.bufferView=u,s.json.bufferViews[u]={buffer:m,byteLength:c.byteLength},s.buffers[m]=c}const jx="KHR_draco_mesh_compression";function aN(c,n){const s=c.extensions&&c.extensions[jx];if(!s)return;const u=new sl.Decoder,m=xI(n,s.bufferView),h=new sl.Mesh;if(!u.DecodeArrayToMesh(m,m.byteLength,h))throw new Error("Failed to decode Draco mesh");const v=n.json.accessors[c.indices],T=o0[v.componentType],k=v.count*T.BYTES_PER_ELEMENT,L=sl._malloc(k);T===Uint16Array?u.GetTrianglesUInt16Array(h,k,L):u.GetTrianglesUInt32Array(h,k,L),vI(sl.memory.buffer.slice(L,L+k),v,n),sl._free(L);for(const x of Object.keys(s.attributes)){const A=u.GetAttributeByUniqueId(h,s.attributes[x]),D=n.json.accessors[c.attributes[x]],M=sN[D.componentType],P=D.count*Gg[D.type]*o0[D.componentType].BYTES_PER_ELEMENT,B=sl._malloc(P);u.GetAttributeDataArrayForAllPoints(h,A,sl[M],P,B),vI(sl.memory.buffer.slice(B,B+P),D,n),sl._free(B)}u.destroy(),h.destroy(),delete c.extensions[jx]}const r0="EXT_meshopt_compression";function lN(c,n){if(!c.extensions||!c.extensions[r0])return;const s=c.extensions[r0],u=new Uint8Array(n.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),m=new Uint8Array(s.count*s.byteStride);Ux.decodeGltfBuffer(m,s.count,s.byteStride,u,s.mode,s.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=m.buffer,delete c.extensions[r0]}const _I=1179937895,yI=new TextDecoder("utf8");function bI(c,n){return new URL(c,n).href}function cN(c,n,s,u){return fetch(bI(c.uri,u)).then(m=>m.arrayBuffer()).then(m=>{n.buffers[s]=m})}function xI(c,n){const s=c.json.bufferViews[n];return new Uint8Array(c.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function uN(c,n,s,u){if(c.uri){const m=bI(c.uri,u);return fetch(m).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{n.images[s]=h})}if(c.bufferView!==void 0){const m=xI(n,c.bufferView),h=new Blob([m],{type:c.mimeType});return createImageBitmap(h).then(v=>{n.images[s]=v})}}function wI(c,n=0,s){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===_I){const x=new Uint32Array(c,n);let A=2;const D=(x[A++]>>2)-3,M=x[A++]>>2;if(A++,u.json=JSON.parse(yI.decode(x.subarray(A,A+M))),A+=M,A<D){const P=x[A++];A++;const B=n+(A<<2);u.buffers[0]=c.slice(B,B+P)}}else u.json=JSON.parse(yI.decode(new Uint8Array(c,n)));const{buffers:m,images:h,meshes:v,extensionsUsed:T,bufferViews:k}=u.json;let L=Promise.resolve();if(m){const x=[];for(let A=0;A<m.length;A++){const D=m[A];D.uri?x.push(cN(D,u,A,s)):u.buffers[A]||(u.buffers[A]=null)}L=Promise.all(x)}return L.then(()=>{const x=[],A=T&&T.includes(jx),D=T&&T.includes(r0);if(A&&x.push(function(){if(!sl)return Hg??(Hg=function(M){let P,B=null;function H(){P=new Uint8Array(B.buffer)}function Z(){throw new Error("Unexpected Draco error.")}const te={a:{a:Z,d:function(ne,X,le){return P.copyWithin(ne,X,X+le)},c:function(ne){const X=P.length,le=Math.max(ne>>>0,Math.ceil(1.2*X)),pe=Math.ceil((le-X)/65536);try{return B.grow(pe),H(),!0}catch{return!1}},b:Z}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(M,te):M.then(ne=>ne.arrayBuffer()).then(ne=>WebAssembly.instantiate(ne,te))).then(ne=>{const{Rb:X,Qb:le,P:pe,T:Ce,X:Ue,Ja:Le,La:ze,Qa:ot,Va:Oe,Wa:et,eb:ct,jb:ut,f:_t,e:Mt,yb:kt,zb:St,Ab:Yt,Bb:gn,Db:Ut,Gb:zn}=ne.instance.exports;B=Mt;const En=(()=>{let xn=0,pn=0,no=0,Ln=0;return Gn=>{no&&(X(Ln),X(xn),pn+=no,no=xn=0),xn||(pn+=128,xn=le(pn));const wo=Gn.length+7&-8;let Do=xn;wo>=pn&&(no=wo,Do=Ln=le(wo));for(let zo=0;zo<Gn.length;zo++)P[Do+zo]=Gn[zo];return Do}})();return H(),_t(),{memory:Mt,_free:X,_malloc:le,Mesh:class{constructor(){this.ptr=pe()}destroy(){Ce(this.ptr)}},Decoder:class{constructor(){this.ptr=Le()}destroy(){ut(this.ptr)}DecodeArrayToMesh(xn,pn,no){const Ln=En(xn),Gn=ze(this.ptr,Ln,pn,no.ptr);return!!Ue(Gn)}GetAttributeByUniqueId(xn,pn){return{ptr:ot(this.ptr,xn.ptr,pn)}}GetTrianglesUInt16Array(xn,pn,no){Oe(this.ptr,xn.ptr,pn,no)}GetTrianglesUInt32Array(xn,pn,no){et(this.ptr,xn.ptr,pn,no)}GetAttributeDataArrayForAllPoints(xn,pn,no,Ln,Gn){ct(this.ptr,xn.ptr,pn.ptr,no,Ln,Gn)}},DT_INT8:kt(),DT_UINT8:St(),DT_INT16:Yt(),DT_UINT16:gn(),DT_UINT32:Ut(),DT_FLOAT32:zn()}})}(fetch(mI())),Hg.then(M=>{sl=M,Hg=void 0}))}()),D&&x.push(function(){if(Ux)return;const M=function(P){let B;const H=WebAssembly.instantiateStreaming(P,{}).then(ne=>{B=ne.instance,B.exports.__wasm_call_ctors()}),Z={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},te={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:H,supported:!0,decodeGltfBuffer(ne,X,le,pe,Ce,Ue){(function(Le,ze,ot,Oe,et,ct,ut){const _t=Le.exports.sbrk,Mt=Oe+3&-4,kt=_t(Mt*et),St=_t(ct.length),Yt=new Uint8Array(Le.exports.memory.buffer);Yt.set(ct,St);const gn=ze(kt,Oe,et,St,ct.length);if(gn===0&&ut&&ut(kt,Mt,et),ot.set(Yt.subarray(kt,kt+Oe*et)),_t(kt-_t(0)),gn!==0)throw new Error(`Malformed buffer data: ${gn}`)})(B,B.exports[te[Ce]],ne,X,le,pe,B.exports[Z[Ue]])}}}(fetch(gI()));return M.ready.then(()=>{Ux=M})}()),h)for(let M=0;M<h.length;M++)x.push(uN(h[M],u,M,s));return(x.length?Promise.all(x):Promise.resolve()).then(()=>{if(A&&v)for(const{primitives:M}of v)for(const P of M)aN(P,u);if(D&&v&&k)for(const M of k)lN(M,u);return u})})}function Zd(c,n){const s=c.json.bufferViews[n.bufferView],u=o0[n.componentType];return new u(c.buffers[s.buffer],(n.byteOffset||0)+(s.byteOffset||0),n.count*(s.byteStride&&s.byteStride!==Gg[n.type]*u.BYTES_PER_ELEMENT?s.byteStride/u.BYTES_PER_ELEMENT:Gg[n.type]))}function Hx(c,n,s,u){const m=o0[n.componentType],h=function(x){switch(x){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),v=c.json.bufferViews[n.bufferView],T=v.byteStride?v.byteStride/m.BYTES_PER_ELEMENT:Gg[n.type],k=s.float32,L=k.length/s.capacity;for(let x=0,A=0;x<n.count*T;x+=T,A+=L)for(let D=0;D<L;D++)k[A+D]=u[x+D]*h;s._trim()}function dN(c,n,s){const u=c.indices,m=c.attributes,h={};h.indexArray=new Gr;const v=n.json.accessors[u],T=v.count/3;h.indexArray.reserve(T);const k=Zd(n,v);for(let D=0;D<T;D++)h.indexArray.emplaceBack(k[3*D],k[3*D+1],k[3*D+2]);h.indexArray._trim(),h.vertexArray=new Dl;const L=n.json.accessors[m.POSITION];h.vertexArray.reserve(L.count);const x=Zd(n,L);for(let D=0;D<L.count;D++)h.vertexArray.emplaceBack(x[3*D],x[3*D+1],x[3*D+2]);if(h.vertexArray._trim(),h.aabb=new hr(L.min,L.max),h.centroid=function(D,M){const P=[0,0,0],B=D.length;if(B>0){for(let H=0;H<B;H++){const Z=3*D[H];P[0]+=M[Z],P[1]+=M[Z+1],P[2]+=M[Z+2]}P[0]/=B,P[1]/=B,P[2]/=B}return P}(k,x),m.COLOR_0!==void 0){const D=n.json.accessors[m.COLOR_0],M=Gg[D.type],P=Zd(n,D);h.colorArray=M===3?new Dl:new Za,h.colorArray.resize(D.count),Hx(n,D,h.colorArray,P)}if(m.NORMAL!==void 0){h.normalArray=new Dl;const D=n.json.accessors[m.NORMAL];h.normalArray.resize(D.count);const M=Zd(n,D);Hx(n,D,h.normalArray,M)}if(m.TEXCOORD_0!==void 0&&s.length>0){h.texcoordArray=new Fd;const D=n.json.accessors[m.TEXCOORD_0];h.texcoordArray.resize(D.count);const M=Zd(n,D);Hx(n,D,h.texcoordArray,M)}if(m._FEATURE_ID_RGBA4444!==void 0){const D=n.json.accessors[m._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=Zd(n,D))}m._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Zd(n,n.json.accessors[m._FEATURE_RGBA4444]).buffer));const A=c.material;return h.material=function(D,M){const{emissiveFactor:P=[0,0,0],alphaMode:B="OPAQUE",alphaCutoff:H=.5,normalTexture:Z,occlusionTexture:te,emissiveTexture:ne,doubleSided:X}=D,{baseColorFactor:le=[1,1,1,1],metallicFactor:pe=1,roughnessFactor:Ce=1,baseColorTexture:Ue,metallicRoughnessTexture:Le}=D.pbrMetallicRoughness||{},ze=te?M[te.index]:void 0;if(te&&te.extensions&&te.extensions.KHR_texture_transform&&ze){const ot=te.extensions.KHR_texture_transform;ze.offsetScale=[ot.offset[0],ot.offset[1],ot.scale[0],ot.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new pr(...le),metallicFactor:pe,roughnessFactor:Ce,baseColorTexture:Ue?M[Ue.index]:void 0,metallicRoughnessTexture:Le?M[Le.index]:void 0},doubleSided:X,emissiveFactor:P,alphaMode:B,alphaCutoff:H,normalTexture:Z?M[Z.index]:void 0,occlusionTexture:ze,emissionTexture:ne?M[ne.index]:void 0,defined:D.defined===void 0}}(A!==void 0?n.json.materials[A]:{defined:!1},s),h}function SI(c,n,s){const{matrix:u,rotation:m,translation:h,scale:v,mesh:T,extras:k,children:L}=c,x={};if(x.matrix=u||Be.mat4.fromRotationTranslationScale([],m||[0,0,0,1],h||[0,0,0],v||[1,1,1]),T!==void 0){x.meshes=s[T];const A=x.anchor=[0,0];for(const D of x.meshes){const{min:M,max:P}=D.aabb;A[0]+=M[0]+P[0],A[1]+=M[1]+P[1]}A[0]=Math.floor(A[0]/x.meshes.length/2),A[1]=Math.floor(A[1]/x.meshes.length/2)}if(k&&(k.id&&(x.id=k.id),k.lights&&(x.lights=function(A){if(!A.length)return[];const D=function(Z){const te=atob(Z),ne=new Uint8Array(te.length);for(let X=0;X<te.length;X++)ne[X]=te.codePointAt(X);return ne}(A),M=[],P=D.length/24,B=new Uint16Array(D.buffer),H=new Float32Array(D.buffer);for(let Z=0;Z<P;Z++){const te=B[2*Z*6]/30,ne=B[2*Z*6+1]/30,X=B[2*Z*6+10]/100,le=H[6*Z+1],pe=H[6*Z+2],Ce=H[6*Z+3],Ue=H[6*Z+4],Le=Ce-le,ze=Ue-pe,ot=Math.hypot(Le,ze);M.push({pos:[le+.5*Le,pe+.5*ze,ne],normal:[ze/ot,-Le/ot,0],width:ot,height:te,depth:X,points:[le,pe,Ce,Ue]})}return M}(k.lights))),L){const A=[];for(const D of L)A.push(SI(n.json.nodes[D],n,s));x.children=A}return x}function hN(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new J1(c.vertices,c.indices,8,256),[s,u]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:s,max:u}}function fN(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const s=n[0];if(!s||!Array.isArray(s)||s.length===0)return null;const u=[];for(const v of s){if(!Array.isArray(v)||v.length!==2)continue;const T=v[0],k=v[1];typeof T=="number"&&typeof k=="number"&&u.push(new Fe(T,k))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let m=0;for(let v=0;v<u.length;v++){const T=u[v],k=u[(v+1)%u.length],L=u[(v+2)%u.length];m+=(T.x-k.x)*(L.y-k.y)-(L.x-k.x)*(T.y-k.y)}m>0&&u.reverse();const h=gg(u.flatMap(v=>[v.x,v.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function pN(c,n){const s=[],u=[];let m=0;const h=[];for(const v of c){m=s.length;const T=v.vertexArray.float32,k=v.indexArray.uint16;for(let L=0;L<v.vertexArray.length;L++)h[0]=T[3*L+0],h[1]=T[3*L+1],h[2]=T[3*L+2],Be.vec3.transformMat4(h,h,n),s.push(new Fe(h[0],h[1]));for(let L=0;L<3*v.indexArray.length;L++)u.push(k[L]+m)}if(u.length%3!=0)return null;for(let v=0;v<u.length;v+=3){const T=s[u[v+0]],k=s[u[v+1]],L=s[u[v+2]];(T.x-k.x)*(L.y-k.y)-(L.x-k.x)*(T.y-k.y)>0&&([u[v+1],u[v+2]]=[u[v+2],u[v+1]])}return{vertices:s,indices:u}}function TI(c){const n=function(k,L){const x=[],A=WebGL2RenderingContext;if(k.json.textures)for(const D of k.json.textures){const M={magFilter:A.LINEAR,minFilter:A.NEAREST,wrapS:A.REPEAT,wrapT:A.REPEAT};D.sampler!==void 0&&Object.assign(M,k.json.samplers[D.sampler]),x.push({image:L[D.source],sampler:M,uploaded:!1})}return x}(c,c.images),s=function(k,L){const x=[];for(const A of k.json.meshes){const D=[];for(const M of A.primitives)D.push(dN(M,k,L));x.push(D)}return x}(c,n),{scenes:u,scene:m,nodes:h}=c.json,v=u?u[m||0].nodes:h,T=[];for(const k of v)T.push(SI(h[k],c,s));return function(k,L,x){const A={},D=new Set;for(let M=0;M<k.length;M++){const P=x[L[M]];if(!P.extras)continue;const B=P.extras["mapbox:footprint:version"],H=P.extras["mapbox:footprint:id"];(B||H)&&D.add(M),B==="1.0.0"&&H&&(A[H]=M)}for(let M=0;M<k.length;M++){if(D.has(M))continue;const P=k[M],B=x[L[M]];if(!B.extras)continue;let H=null;P.id in A&&(H=pN(k[A[P.id]].meshes,P.matrix)),H||(H=fN(B)),H&&(P.footprint=hN(H))}if(D.size>0){const M=Array.from(D.values()).sort((P,B)=>P-B);for(let P=M.length-1;P>=0;P--)k.splice(M[P],1)}}(T,v,c.json.nodes),T}function mN(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,s=c.aabb.min[0]-1,u=c.aabb.min[1]-1,m=qd/(c.aabb.max[0]-s+2),h=qd/(c.aabb.max[1]-u+2);for(let v=0;v<n.length;v+=3){const T=n[v+2],k=(n[v+0]-s)*m|0,L=(n[v+1]-u)*h|0;T>c.heightmap[L*qd+k]&&(c.heightmap[L*qd+k]=T)}}function gN(c,n){const s={};s.indexArray=new Gr,s.indexArray.reserve(4*c.length),s.vertexArray=new Dl,s.vertexArray.reserve(10*c.length),s.colorArray=new Za,s.vertexArray.reserve(10*c.length);let u=0;for(const v of c){const T=Math.min(10,Math.max(4,1.3*v.height))*n,k=[-v.normal[1],v.normal[0],0],L=Math.min(.29,.1*v.width/v.depth),x=v.width-2*v.depth*n*(L+.01),A=Be.vec3.scaleAndAdd([],v.pos,k,x/2),D=Be.vec3.scaleAndAdd([],v.pos,k,-x/2),M=[A[0],A[1],A[2]+v.height],P=[D[0],D[1],D[2]+v.height],B=Be.vec3.scaleAndAdd([],v.normal,k,L);Be.vec3.scale(B,B,T);const H=Be.vec3.scaleAndAdd([],v.normal,k,-L);Be.vec3.scale(H,H,T),Be.vec3.add(B,A,B),Be.vec3.add(H,D,H),A[2]+=.1,D[2]+=.1,s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(H[0],H[1],H[2]),s.vertexArray.emplaceBack(A[0],A[1],A[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(M[0],M[1],M[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(A[0],A[1],A[2]),s.vertexArray.emplaceBack(D[0],D[1],D[2]),s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(H[0],H[1],H[2]);const Z=x/T/2;s.colorArray.emplaceBack(-Z-L,-1,Z,.8),s.colorArray.emplaceBack(Z+L,-1,Z,.8),s.colorArray.emplaceBack(-Z,0,Z,1.3),s.colorArray.emplaceBack(Z,0,Z,1.3),s.colorArray.emplaceBack(Z+L,-.8,Z,.7),s.colorArray.emplaceBack(Z+L,-.8,Z,.7),s.colorArray.emplaceBack(0,0,Z,1.3),s.colorArray.emplaceBack(0,0,Z,1.3),s.colorArray.emplaceBack(Z+L,-1.2,Z,.8),s.colorArray.emplaceBack(Z+L,-1.2,Z,.8),s.indexArray.emplaceBack(6+u,4+u,8+u),s.indexArray.emplaceBack(7+u,9+u,5+u),s.indexArray.emplaceBack(0+u,1+u,2+u),s.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const m={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=pr.white,m.pbrMetallicRoughness=h,s.material=m,s.aabb=new hr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class CI{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const u=n[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}class EI{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new hc(In,16,0),this.featureIndexArray=new uy,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,s,u,m,h,v=0,T=0){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,h,v);const L=this.grid;for(let x=0;x<s.length;x++){const A=s[x],D=[1/0,1/0,-1/0,-1/0];for(let M=0;M<A.length;M++){const P=A[M];D[0]=Math.min(D[0],P.x),D[1]=Math.min(D[1],P.y),D[2]=Math.max(D[2],P.x),D[3]=Math.max(D[3],P.y)}T!==0&&(D[0]-=T,D[1]-=T,D[2]+=T,D[3]+=T),D[0]<In&&D[1]<In&&D[2]>=0&&D[3]>=0&&L.insert(k,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new zf.VectorTile(new Dy(this.rawTileData)).layers,this.sourceLayerCoder=new CI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s,u){this.loadVTLayers(),this.serializedLayersCache.clear();const m=yf(n.filter),h=n.tileResult,v=n.transform,T=h.bufferedTilespaceBounds,k=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(D,M,P,B)=>Sr(h.bufferedTilespaceGeometry,D,M,P,B));k.sort(vN);let L=null;v.elevation&&k.length>0&&(L=jf.create(v.elevation,this.tileID));const x={};let A;for(let D=0;D<k.length;D++){const M=k[D];if(M===A)continue;A=M;const P=this.featureIndexArray.get(M);let B=null;if(this.is3DTile){const H=this.bucketLayerIDs[0][0],Z=s[H];if(Z.type!=="model")continue;const{queryFeature:te,intersectionZ:ne}=Z.queryIntersectsMatchingFeature(h,P.featureIndex,m,v);te&&this.appendToResult(x,H,P.featureIndex,te,ne)}else this.loadMatchingFeature(x,P,m,n.layers,n.availableImages,s,u,(H,Z,te,ne=0)=>(B||(B=wt(H,this.tileID.canonical,n.tileTransform)),Z.queryIntersectsFeature(h,H,te,B,this.z,n.transform,n.pixelPosMatrix,L,ne)))}return x}loadMatchingFeature(n,s,u,m,h,v,T,k){const{featureIndex:L,bucketIndex:x,sourceLayerIndex:A,layoutVertexArrayOffset:D}=s,M=this.bucketLayerIDs[x];if(m.length&&!function(Z,te){for(let ne=0;ne<Z.length;ne++)if(te.indexOf(Z[ne])>=0)return!0;return!1}(m,M))return;const P=this.sourceLayerCoder.decode(A),B=this.vtLayers[P].feature(L);if(u.needGeometry){const Z=on(B,!0);if(!u.filter(new Zr(this.tileID.overscaledZ),Z,this.tileID.canonical))return}else if(!u.filter(new Zr(this.tileID.overscaledZ),B))return;const H=this.getId(B,P);for(let Z=0;Z<M.length;Z++){const te=M[Z];if(m.length&&m.indexOf(te)<0)continue;const ne=v[te];if(!ne)continue;let X={};H!==void 0&&T&&(X=T.getState(ne.sourceLayer||"_geojsonTileLayer",H));const le=!k||k(B,ne,X,D);if(!le)continue;const pe=new Bg(B,this.z,this.x,this.y,H);let Ce=this.serializedLayersCache.get(te);Ce||(Ce=ne.serialize(),Ce.id=te,this.serializedLayersCache.set(te,Ce)),pe.layer=eo({},Ce),pe.tile=this.tileID.canonical,pe.layer.paint=MI(Ce.paint,ne.paint,B,X,h),pe.layer.layout=MI(Ce.layout,ne.layout,B,X,h),this.appendToResult(n,te,L,pe,le)}}appendToResult(n,s,u,m,h){let v=n[s];v===void 0&&(v=n[s]=[]),v.push({featureIndex:u,feature:m,intersectionZ:h})}lookupSymbolFeatures(n,s,u,m,h,v,T){const k={};this.loadVTLayers();const L=yf(m);for(const x of n)this.loadMatchingFeature(k,{bucketIndex:s,sourceLayerIndex:u,featureIndex:x,layoutVertexArrayOffset:0},L,h,v,T);return k}loadFeature(n){const{featureIndex:s,sourceLayerIndex:u}=n;this.loadVTLayers();const m=this.sourceLayerCoder.decode(u),h=this.vtFeatures[m];if(h[s])return h[s];const v=this.vtLayers[m].feature(s);return h[s]=v,v}hasLayer(n){for(const s of this.bucketLayerIDs)for(const u of s)if(n===u)return!0;return!1}getId(n,s){let u=n.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];m!=null&&(u=n.properties[m]),typeof u=="boolean"&&(u=Number(u))}return u}}function MI(c,n,s,u,m){return dt(c,(h,v)=>{const T=n instanceof uu?n.get(v):null;return T&&T.evaluate?T.evaluate(s,u,m):T})}function vN(c,n){return n-c}jn(EI,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const II=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Gx{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=u>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const h=II[15&u];if(!h)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[T]=new Uint32Array(n,4,1);return new Gx(T,v,h,n)}constructor(n,s=64,u=Float64Array,m){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const h=II.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,T=n*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-T%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+k,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+k),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+k,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=s,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Wx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:v,nodeSize:T}=this,k=[0,h.length-1,0],L=[];for(;k.length;){const x=k.pop()||0,A=k.pop()||0,D=k.pop()||0;if(A-D<=T){for(let H=D;H<=A;H++){const Z=v[2*H],te=v[2*H+1];Z>=n&&Z<=u&&te>=s&&te<=m&&L.push(h[H])}continue}const M=D+A>>1,P=v[2*M],B=v[2*M+1];P>=n&&P<=u&&B>=s&&B<=m&&L.push(h[M]),(x===0?n<=P:s<=B)&&(k.push(D),k.push(M-1),k.push(1-x)),(x===0?u>=P:m>=B)&&(k.push(M+1),k.push(A),k.push(1-x))}return L}within(n,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:h,nodeSize:v}=this,T=[0,m.length-1,0],k=[],L=u*u;for(;T.length;){const x=T.pop()||0,A=T.pop()||0,D=T.pop()||0;if(A-D<=v){for(let H=D;H<=A;H++)kI(h[2*H],h[2*H+1],n,s)<=L&&k.push(m[H]);continue}const M=D+A>>1,P=h[2*M],B=h[2*M+1];kI(P,B,n,s)<=L&&k.push(m[M]),(x===0?n-u<=P:s-u<=B)&&(T.push(D),T.push(M-1),T.push(1-x)),(x===0?n+u>=P:s+u>=B)&&(T.push(M+1),T.push(A),T.push(1-x))}return k}}function Wx(c,n,s,u,m,h){if(m-u<=s)return;const v=u+m>>1;AI(c,n,v,u,m,h),Wx(c,n,s,u,v-1,1-h),Wx(c,n,s,v+1,m,1-h)}function AI(c,n,s,u,m,h){for(;m>u;){if(m-u>600){const L=m-u+1,x=s-u+1,A=Math.log(L),D=.5*Math.exp(2*A/3),M=.5*Math.sqrt(A*D*(L-D)/L)*(x-L/2<0?-1:1);AI(c,n,s,Math.max(u,Math.floor(s-x*D/L+M)),Math.min(m,Math.floor(s+(L-x)*D/L+M)),h)}const v=n[2*s+h];let T=u,k=m;for(Wg(c,n,u,s),n[2*m+h]>v&&Wg(c,n,u,m);T<k;){for(Wg(c,n,T,k),T++,k--;n[2*T+h]<v;)T++;for(;n[2*k+h]>v;)k--}n[2*u+h]===v?Wg(c,n,u,k):(k++,Wg(c,n,k,m)),k<=s&&(u=k+1),s<=k&&(m=k-1)}}function Wg(c,n,s,u){qx(c,s,u),qx(n,2*s,2*u),qx(n,2*s+1,2*u+1)}function qx(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function kI(c,n,s,u){const m=c-s,h=n-u;return m*m+h*h}o.$=J_,o.A=class extends Jy{},o.B=sc,o.C=Vc,o.D=Km,o.E=$c,o.F=Dm,o.G=uc,o.H=Rm,o.I=gx,o.J=hf,o.K=pc,o.L=dc,o.M=au,o.N=of,o.O=nu,o.P=Fe,o.Q=bd,o.R=Nh,o.S=ls,o.T=Ix,o.U=sm,o.V=Jy,o.W=Zm,o.X=Lm,o.Y=G_,o.Z=function(c){const n=c.value;let s=[];if(!n)return s;const u=sc(n);return u!=="string"?(s=s.concat([new Jy(c.key,n,`string expected, "${u}" found`)]),s):(VM(n,!0)||(s=s.concat([new Jy(c.key,n,`invalid url "${n}"`)])),s)},o._=It,o.a=function(c){return He.API_CDN_URL_REGEX.test(c)},o.a$=Rl,o.a0=zr,o.a1=wn,o.a2=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return Xr(c.expression.evaluate(n))}interpolate(c,n,s){return{x:mo(c.x,n.x,s),y:mo(c.y,n.y,s),z:mo(c.z,n.z,s),azimuthal:mo(c.azimuthal,n.azimuthal,s),polar:mo(c.polar,n.polar,s)}}},o.a3=Zr,o.a4=Id,o.a5=ht,o.a6=Be,o.a7=Sn,o.a8=uu,o.a9=wu,o.aA=Zo,o.aB=IM,o.aC=LM,o.aD=MM,o.aE=function(c,n){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let u=0;u<c.length;u++){const m=document.createElement("source");Us(c[u])||(s.crossOrigin="Anonymous"),m.src=c[u],s.appendChild(m)}return{cancel:()=>{}}},o.aF=qy,o.aG=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>wI(n,0,c))},o.aH=TI,o.aI=class{constructor(c,n,s,u){this.id=c,this.position=n!=null?new j(n[0],n[1]):new j(0,0),this.orientation=s??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new hr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(Be.mat4.multiply(c.matrix,n,c.matrix),c.meshes)for(const s of c.meshes){const u=hr.applyTransformFast(s.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const s of c.children)this._applyTransformations(s,c.matrix)}computeBoundsAndApplyParent(){const c=Be.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,s,u,m,h,v=!1){WM(this.matrix,this,c.transform,this.position,n,s,u,m,h,v)}upload(c){if(!this.uploaded){for(const n of this.nodes)Dx(n,c);for(const n of this.nodes)Qy(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)Lx(c)}},o.aJ=Pt,o.aK=function(c){return c.indexOf(Dd)>=0},o.aL=kg,o.aM=Pe,o.aN=$e,o.aO=hu,o.aP=Gr,o.aQ=Lo,o.aR=kf,o.aS=Gy,o.aT=function(){Is.isLoading()||Is.isLoaded()||Wm()!=="deferred"||X_()},o.aU=yf,o.aV=on,o.aW=Bg,o.aX=Rr,o.aY=ax,o.aZ=X1,o.a_=wt,o.aa=mo,o.ab=In,o.ac=pd,o.ad=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([s,u]){const m=Xr([1,s,u]);return{x:m.x,y:m.y,z:m.z}}(c.expression.evaluate(n))}interpolate(c,n,s){return{x:mo(c.x,n.x,s),y:mo(c.y,n.y,s),z:mo(c.z,n.z,s)}}},o.ae=function(c,n,s=0,u=!0){const m=new Fe(s,s),h=c.sub(m),v=n.add(m),T=[h,new Fe(v.x,h.y),v,new Fe(h.x,v.y)];return u&&T.push(h.clone()),T},o.af=function(c,n){const s=[];for(let u=0;u<c.length;u++){const m=Vn(u-1,-1,c.length-1),h=Vn(u+1,-1,c.length-1),v=c[u],T=c[h],k=c[m].sub(v).unit(),L=T.sub(v).unit(),x=L.angleWithSep(k.x,k.y),A=k.add(L).unit().mult(-1*n/Math.sin(x/2));s.push(v.add(A))}return s},o.ag=fM,o.ah=Sr,o.ai=function(c,n,s=0){return Be.vec3.fromValues(((n.x-s)*c.scale-c.x)*In,(n.y*c.scale-c.y)*In,Ve(n.z,n.y))},o.aj=us,o.ak=RE,o.al=function(c){let n=1/0,s=1/0,u=-1/0,m=-1/0;for(const h of c)n=Math.min(n,h.x),s=Math.min(s,h.y),u=Math.max(u,h.x),m=Math.max(m,h.y);return{min:new Fe(n,s),max:new Fe(u,m)}},o.am=me,o.an=Go,o.ao=st,o.ap=gt,o.aq=Oi,o.ar=function(c,n){const s={};for(let u=0;u<n.length;u++){const m=n[u];m in c&&(s[m]=c[m])}return s},o.as=Y,o.at=we,o.au=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,s,u){const m=this.entries[c]=this.entries[c]||{callbacks:[]};if(m.result){const[h,v]=m.result;return this.scheduler?this.scheduler.add(()=>{u(h,v)},n):u(h,v),()=>{}}return m.callbacks.push(u),m.cancel||(m.cancel=s((h,v)=>{m.result=[h,v];for(const T of m.callbacks)this.scheduler?this.scheduler.add(()=>{T(h,v)},n):T(h,v);setTimeout(()=>delete this.entries[c],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(h=>h!==u),m.callbacks.length||(m.cancel(),delete this.entries[c]))}}},o.av=wf,o.aw=function(c,n,s){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},m=>{const h=Fc(c.request,(v,T,k,L)=>{v?m(v):T&&m(null,{vectorTile:s?void 0:new zf.VectorTile(new Dy(T)),rawData:T,cacheControl:k,expires:L})});return()=>{h.cancel(),m()}},n)},o.ax=function(c){co++,co>ao&&(c.getActor().send("enforceCacheSizeLimit",po),co=0)},o.ay=pt,o.az=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},o.b=function(c){return He.API_FONTS_REGEX.test(c)},o.b$=ds,o.b0=ig,o.b1=Ma,o.b2=ti,o.b3=gg,o.b4=Cx,o.b5=function(c,n){const s=wu(n.zoom);if(s===0)return Ol(c);const u=yy(c),m=U1(u),h=me(u.getWest())*n.worldSize,v=me(u.getEast())*n.worldSize,T=we(u.getNorth())*n.worldSize,k=we(u.getSouth())*n.worldSize,L=[h,T,0],x=[v,T,0],A=[h,k,0],D=[v,k,0],M=Be.mat4.invert([],n.globeMatrix);return Be.vec3.transformMat4(L,L,M),Be.vec3.transformMat4(x,x,M),Be.vec3.transformMat4(A,A,M),Be.vec3.transformMat4(D,D,M),m[0]=_c(m[0],A,s),m[1]=_c(m[1],D,s),m[2]=_c(m[2],x,s),m[3]=_c(m[3],L,s),hr.fromPoints(m)},o.b6=xy,o.b7=pg,o.b8=_c,o.b9=Sf,o.bA=pr,o.bB=Vn,o.bC=xt,o.bD=_i,o.bE=be,o.bF=function(c,n,s){c[4*n+0]=s[0],c[4*n+1]=s[1],c[4*n+2]=s[2],c[4*n+3]=s[3]},o.bG=Ud,o.bH=Ca,o.bI=cg,o.bJ=wi,o.bK=vc,o.bL=j,o.bM=_M,o.bN=Qo,o.bO=Gs,o.bP=zM,o.bQ=Si,o.bR=wC,o.bS=function(c,n,s,u,m,h,v,T,k){if(k.name==="globe")return wC(c,n,new Si(s,u,m),!1);const L=kg({z:s,x:u,y:m},k);return new hr([(h+L.x/L.scale)*n,n*(L.y/L.scale),v],[(h+L.x2/L.scale)*n,n*(L.y2/L.scale),T])},o.bT=function(c,n,s){let u=0;for(let m=0;m<2;++m)c[m]>0&&(u+=(c[m]-0)*(c[m]-0)),n[m]<0&&(u+=(0-n[m])*(0-n[m]));return u},o.bU=We,o.bV=f,o.bW=function(c){const n=Be.mat4.identity(new Float64Array(16));Be.mat4.multiply(n,c.pixelMatrix,c.globeMatrix);const s=[0,b,0],u=[0,w,0];return Be.vec3.transformMat4(s,s,n),Be.vec3.transformMat4(u,u,n),[s[0]>0&&s[0]<=c.width&&s[1]>0&&s[1]<=c.height&&!G1(c,new j(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!G1(c,new j(c.center.lat,-90))]},o.bX=function(c,n){const{scale:s}=c.tileTransform,u=s*In/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return Be.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},o.bY=Yy,o.bZ=OM,o.b_=function(c){const n=OM(c,!0);return Be.mat2.invert([],[n[0],n[1],n[4],n[5]])},o.ba=Ei,o.bb=Nx,o.bc=Dy,o.bd=Fc,o.be=function(c){const n=[];for(const s in c)n.push(c[s]);return n},o.bf=function(c,n){const s=[];for(const u in c)u in n||s.push(u);return s},o.bg=lo,o.bh=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bi=Nt,o.bj=function(c,n){const{x:s,y:u}=c.point,m=CC(s,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Be.mat4.multiply(m,m,j1(Ol(n)))},o.bk=Bf,o.bl=ca,o.bm=Ry,o.bn=function(c,n,s,u,m){const h=5*n+2;c.float32[h+0]=s,c.float32[h+1]=u,c.float32[h+2]=m},o.bo=Hy,o.bp=nM,o.bq=nn,o.br=zi,o.bs=rE,o.bt=$M,o.bu=cE,o.bv=uE,o.bw=yx,o.bx=cM,o.by=mx,o.bz=Gx,o.c=tt,o.c$=Mr,o.c0=function(c){const{x:n,y:s}=c.point,{lng:u,lat:m}=c._center;return CC(n,s,c.worldSize,u,m)},o.c1=Ot,o.c2=lr,o.c3=_y,o.c4=function(c){const n=Math.round((c+45+360)%360/90)%4;return en[n]},o.c5=45,o.c6=ve,o.c7=Df,o.c8=function(c,n,s){const u=Math.sqrt(c*c+n*n+s*s),m=u>0?Math.acos(s/u)*Dt:0;let h=c!==0||n!==0?Math.atan2(-n,-c)*Dt+90:0;return h<0&&(h+=360),[u,h,m]},o.c9=rt,o.cA=function(c){const n=We-5;c=gt(c,-n,n)/n*90;const s=Math.pow(Math.abs(Math.sin(xt(c))),3);return Math.round(s*(p.length-1))},o.cB=function(c,n,s,u){const m=n.getNorth(),h=n.getSouth(),v=n.getWest(),T=n.getEast(),k=1<<c.z,L=T-v,x=m-h,A=L/l,D=-x/p[s],M=[0,A,0,D,0,0,m,v,0];if(c.z>0){const P=180/u;Be.mat3.multiply(M,M,[P/L+1,0,0,0,P/x+1,0,-.5*P/A,.5*P/D,1])}return M[2]=k,M[5]=c.x,M[8]=c.y,M},o.cC=Ol,o.cD=function(c,n,s){const u=Be.mat4.identity(new Float64Array(16)),m=(n/(1<<c)-.5)*Math.PI*2;return Be.mat4.rotateY(u,s.globeMatrix,m),Float32Array.from(u)},o.cE=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const s=n.getSource().maxzoom,u=1<<s,m=Math.floor(c.x),h=Math.floor((c.x-m)*u),v=Math.floor(c.y*u),T=this.findDEMTileFor(new Zo(s,m,s,h,v));return!(!T||!T.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||c.y<0||c.y>1)return n;const m=u.getSource().maxzoom,h=1<<m,v=Math.floor(c.x),T=c.x-v,k=new Zo(m,v,m,Math.floor(T*h),Math.floor(c.y*h)),L=this.findDEMTileFor(k);if(!L||!L.dem)return n;const x=L.dem,A=1<<L.tileID.canonical.z,D=(T*A-L.tileID.canonical.x)*x.dim,M=(c.y*A-L.tileID.canonical.y)*x.dim,P=Math.floor(D),B=Math.floor(M);return(s?this.exaggeration():1)*mo(mo(x.get(P,B),x.get(P,B+1),M-B),mo(x.get(P+1,B),x.get(P+1,B+1),M-B),D-P)}getAtTileOffset(c,n,s){const u=1<<c.canonical.z;return this.getAtPointOrZero(new ht(c.wrap+(c.canonical.x+n/In)/u,(c.canonical.y+s/In)/u))}getAtTileOffsetFunc(c,n,s,u){return m=>{const h=this.getAtTileOffset(c,m.x,m.y),v=u.upVector(c.canonical,m.x,m.y),T=u.upVectorScale(c.canonical,n,s).metersToTile;return Be.vec3.scale(v,v,h*T),v}}getForTilePoints(c,n,s,u){if(this.isUsingMockSource())return!1;const m=jf.create(this,c,u);return!!m&&(n.forEach(h=>{h[2]=this.exaggeration()*m.getElevationAt(h[0],h[1],s)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const s=n.dem.tree,u=n.tileID,m=1<<c.canonical.z-u.canonical.z;let h=c.canonical.x/m-u.canonical.x,v=c.canonical.y/m-u.canonical.y,T=0;for(let k=0;k<c.canonical.z-u.canonical.z&&!s.leaves[T];k++){h*=2,v*=2;const L=2*Math.floor(v)+Math.floor(h);T=s.childOffsets[T]+L,h%=1,v%=1}return{min:this.exaggeration()*s.minimums[T],max:this.exaggeration()*s.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,s=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const m of c){const h=this.getMinMaxForTile(m.tileID);h&&(s=Math.min(s,h.min),u=Math.max(u,h.max),n=!0)}return n?{min:s,max:u}:null}},o.cF=FC,o.cG=bu,o.cH=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},o.cI=TC,o.cJ=Ae,o.cK=Se,o.cL=256,o.cM=function(c,n){const s=[0,0,0],u=xy(Ol(n.canonical));return Be.vec3.transformMat4(s,s,u),Be.vec3.transformMat4(s,s,c),s},o.cN=c=>({u_camera_to_center_distance:new wi(c),u_extrude_scale:new Lf(c),u_device_pixel_ratio:new wi(c),u_matrix:new Ud(c),u_inv_rot_matrix:new Ud(c),u_merc_center:new Ca(c),u_tile_id:new cg(c),u_zoom_transition:new wi(c),u_up_dir:new cg(c),u_emissive_strength:new wi(c)}),o.cO=c=>({u_matrix:new Ud(c),u_pixels_to_tile_units:new Lf(c),u_device_pixel_ratio:new wi(c),u_units_to_pixels:new Ca(c),u_dash_image:new vc(c),u_gradient_image:new vc(c),u_image_height:new wi(c),u_texsize:new Ca(c),u_tile_units_to_pixels:new wi(c),u_alpha_discard_threshold:new wi(c),u_trim_offset:new Ca(c),u_trim_fade_range:new Ca(c),u_trim_color:new Df(c),u_emissive_strength:new wi(c),u_zbias_factor:new wi(c),u_tile_to_meter:new wi(c)}),o.cP=c=>({u_matrix:new Ud(c),u_texsize:new Ca(c),u_pixels_to_tile_units:new Lf(c),u_device_pixel_ratio:new wi(c),u_image:new vc(c),u_units_to_pixels:new Ca(c),u_tile_units_to_pixels:new wi(c),u_alpha_discard_threshold:new wi(c),u_trim_offset:new Ca(c),u_emissive_strength:new wi(c),u_zbias_factor:new wi(c),u_tile_to_meter:new wi(c)}),o.cQ=pu,o.cR=NB,o.cS=$B,o.cT=IC,o.cU=(c,n,s,u,m,h)=>{const v=c.transform,T=v.projection.name==="globe";let k;if(h.paint.get("circle-pitch-alignment")==="map")if(T){const x=TC(v.zoom,n.canonical)*v._pixelsPerMercatorPixel;k=Float32Array.from([x,0,0,x])}else k=v.calculatePixelsToTileUnitsMatrix(s);else k=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const L={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(v.projection),u_matrix:c.translatePosMatrix(n.projMatrix,s,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ht.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:j4,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(T){L.u_inv_rot_matrix=u,L.u_merc_center=m,L.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],L.u_zoom_transition=wu(v.zoom);const x=m[0]*In,A=m[1]*In;L.u_up_dir=v.projection.upVector(new Si(0,0,0),x,A)}return L},o.cV=zE,o.cW=(c,n,s,u,m,h)=>{const v=c.transform,T=v.pitch<15?DE(.07,.7,gt((14-v.zoom)/5,0,1)):.07;return{u_matrix:OE(c,n,s,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:v.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:m,u_image:0,u_tile_units_to_pixels:LE(n,v),u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:h,u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:T,u_tile_to_meter:rt(n.tileID.canonical,0)}},o.cX=(c,n,s,u,m,h,v)=>{const T=c.transform,k=T.calculatePixelsToTileUnitsMatrix(n),L=T.pitch<15?DE(.07,.7,gt((14-T.zoom)/5,0,1)):.07;return{u_matrix:OE(c,n,s,u),u_pixels_to_tile_units:k,u_device_pixel_ratio:h,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:BE(s)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:LE(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:v,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:rt(n.tileID.canonical,0)}},o.cY=er,o.cZ=mg,o.c_=SE,o.ca=hr,o.cb=Xr,o.cc=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},o.cd=function(c){return c({pluginStatus:Li,pluginURL:Ms}),Gm.on("pluginStateChange",c),c},o.ce=Hf,o.cf=n0,o.cg=Nf,o.ch=vx,o.ci=tm,o.cj=Y_,o.ck=Yn,o.cl=ss,o.cm=Ze,o.cn=function(c){const n=c.indexOf(Dd);return n>=0?c.slice(0,n):c},o.co=function(c){const n=c.indexOf(Dd);return n>=0?c.slice(n+1):""},o.cp=function(c){const n=[],s=c.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},o.cq=function(c,n,s,u){return c.type==="custom"?new vF(c,n):new AF[c.type](c,n,s,u)},o.cr=tn,o.cs=Gm,o.ct=Bc,o.cu=ug,o.cv=class extends Xa{constructor(c){super(c),this.current=B1}set(c,n,s){if(this.fetchUniformLocation(c,n)){for(let u=0;u<9;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},o.cw=dn,o.cx=function(c,n,s){const u=wu(s.zoom),m=c.style.map._antialias,h=n.options.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return u===0&&!m&&!h},o.cy=function(c){const n=c.pixelsPerMeter,s=n/be(1,c.center.lat),u=Be.mat4.identity(new Float64Array(16));return Be.mat4.translate(u,u,[c.point.x,c.point.y,0]),Be.mat4.scale(u,u,[s,s,n]),Float32Array.from(u)},o.cz=yy,o.d=function(c){return He.API_TILEJSON_REGEX.test(c)},o.d$=S,o.d0=Py,o.d1=Tu,o.d2=450,o.d3=7,o.d4=gF,o.d5=sr,o.d6=If,o.d7=256,o.d8=j1,o.d9=Dl,o.dA=EC,o.dB=function(c){const n=[0,0,0],s=Be.mat4.identity(new Float64Array(16));return Be.mat4.multiply(s,c.pixelMatrix,c.globeMatrix),Be.vec3.transformMat4(n,n,s),new Fe(n[0],n[1])},o.dC=function(c,n,s=!1){if(Li===jm||Li===Pd||Li===Rd)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ms=Ht.resolveURL(c),Li=jm,vf=n,Hm(),s||X_()},o.dD=Wm,o.dE=function(){n0().acquire($x)},o.dF=function(){const c=jg;c&&(c.isPreloaded()&&c.numActive()===1?(c.release($x),jg=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.dG=Ug,o.dH=function(c){const n=Qt();if(!n)return;const s=n.delete(ro);c&&s.catch(c).then(()=>c())},o.dI=Vg,o.dJ=mI,o.dK=function(c){Vx=Ht.resolveURL(c),qf||(qf=new Hf(n0(),new $c)),qf.broadcast("setDracoUrl",Vx)},o.dL=gI,o.dM=function(c){Wf=Ht.resolveURL(c),qf||(qf=new Hf(n0(),new $c)),qf.broadcast("setMeshoptUrl",Wf)},o.dN=jn,o.dO=Su,o.dP=ol,o.dQ=CI,o.dR=EI,o.dS=AE,o.dT=dt,o.dU=rM,o.dV=function(c,n,s,u,m,h,v,T,k,L,x=1,A){c.createArrays(),c.tilePixelRatio=In/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const D=c.layers[0].layout,M=c.layers[0]._unevaluatedLayout._values,P={};if(P.scaleFactor=x,P.textSizeScaleRange=D.get("text-size-scale-range"),P.iconSizeScaleRange=D.get("icon-size-scale-range"),P.textScaleFactor=gt(P.scaleFactor,P.textSizeScaleRange[0],P.textSizeScaleRange[1]),P.iconScaleFactor=gt(P.scaleFactor,P.iconSizeScaleRange[0],P.iconSizeScaleRange[1]),c.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:ne}=c.textSizeData;P.compositeTextSizes=[M["text-size"].possiblyEvaluate(new Zr(te),T),M["text-size"].possiblyEvaluate(new Zr(ne),T)]}if(c.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:ne}=c.iconSizeData;P.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new Zr(te),T),M["icon-size"].possiblyEvaluate(new Zr(ne),T)]}P.layoutTextSize=M["text-size"].possiblyEvaluate(new Zr(k+1),T),P.layoutIconSize=M["icon-size"].possiblyEvaluate(new Zr(k+1),T),P.textMaxSize=M["text-size"].possiblyEvaluate(new Zr(18),T);const B=D.get("text-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",H=D.get("text-size");let Z=!1;for(const te of c.features)if(te.icon&&te.icon.nameSecondary){Z=!0;break}for(const te of c.features){const ne=D.get("text-font").evaluate(te,{},T).join(","),X=H.evaluate(te,{},T)*P.textScaleFactor,le=P.layoutTextSize.evaluate(te,{},T)*P.textScaleFactor,pe=(P.layoutIconSize.evaluate(te,{},T),{horizontal:{},vertical:void 0}),Ce=te.text;let Ue,Le=[0,0];if(Ce){const Oe=Ce.toString(),et=D.get("text-letter-spacing").evaluate(te,{},T)*zi,ct=D.get("text-line-height").evaluate(te,{},T)*zi,ut=K_(Oe)?et:0,_t=D.get("text-anchor").evaluate(te,{},T),Mt=D.get("text-variable-anchor");if(!Mt){const Ut=D.get("text-radial-offset").evaluate(te,{},T);Le=Ut?cM(_t,[Ut*zi,_x]):D.get("text-offset").evaluate(te,{},T).map(zn=>zn*zi)}let kt=B?"center":D.get("text-justify").evaluate(te,{},T);const St=D.get("symbol-placement")==="point",Yt=St?D.get("text-max-width").evaluate(te,{},T)*zi:1/0,gn=Ut=>{c.allowVerticalPlacement&&Vm(Oe)&&(pe.vertical=px(Ce,n,s,m,ne,Yt,ct,_t,Ut,ut,Le,ca.vertical,!0,le,X))};if(!B&&Mt){const Ut=kt==="auto"?Mt.map(En=>yx(En)):[kt];let zn=!1;for(let En=0;En<Ut.length;En++){const xn=Ut[En];if(!pe.horizontal[xn])if(zn)pe.horizontal[xn]=pe.horizontal[0];else{const pn=px(Ce,n,s,m,ne,Yt,ct,"center",xn,ut,Le,ca.horizontal,!1,le,X);pn&&(pe.horizontal[xn]=pn,zn=pn.positionedLines.length===1)}}gn("left")}else{if(kt==="auto"&&(kt=yx(_t)),St||D.get("text-writing-mode").indexOf("horizontal")>=0||!Vm(Oe)){const Ut=px(Ce,n,s,m,ne,Yt,ct,_t,kt,ut,Le,ca.horizontal,!1,le,X);Ut&&(pe.horizontal[kt]=Ut)}gn(St?"left":kt)}}let ze=!1;if(te.icon&&te.icon.namePrimary){const Oe=u[te.icon.namePrimary];Oe&&(Ue=YB(m[te.icon.namePrimary],te.icon.nameSecondary?m[te.icon.nameSecondary]:void 0,D.get("icon-offset").evaluate(te,{},T),D.get("icon-anchor").evaluate(te,{},T)),ze=Oe.sdf,c.sdfIcons===void 0?c.sdfIcons=Oe.sdf:c.sdfIcons!==Oe.sdf&&Mn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Oe.pixelRatio!==c.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const ot=dM(pe.horizontal)||pe.vertical;c.iconsInText||(c.iconsInText=!!ot&&ot.iconsInText),(ot||Ue)&&oF(c,te,pe,Ue,u,P,le,0,Le,ze,v,T,L,A,Z)}h&&c.generateCollisionDebugBuffers(k,c.collisionBoxArray,P.textScaleFactor)},o.dW=zf,o.dX=t0,o.dY=Ge,o.dZ=eE,o.d_=jE,o.da=gc,o.db=rg,o.dc=function(c,n,s,u,m){return gt((c-n)/(s-n)*(m-u)+u,u,m)},o.dd=uf,o.de=Ke,o.df=class{constructor(c,n,s,u){this.context=c,this.format=u,this.size=s,this.texture=c.gl.createTexture();const[m,h,v]=this.size,{gl:T}=c;T.bindTexture(T.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,m,h,v,0,Ex(this.format),Mx(this.format),n.data)}bind(c,n){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},o.dg=Px,o.dh=[1,1,1],o.di=jf,o.dj=Uf,o.dk=Ll,o.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Fe(1/0,1/0),max:new Fe(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const s=sE(new Fe(0,0),new Fe(In,In),c),u=[];if(n&&!nx(s,this._globalClipBounds))return u;for(const m of this._activeRegions){if(m.hiddenByOverlap||!nx(s,m))continue;const h=hB(m.min,m.max,c);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[m.priority],footprint:m.footprint,footprintTileId:m.tileId,order:m.order,clipMask:m.clipMask,clipScope:m.clipScope})}return u}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const s=[];for(const u of n.cache.getVisibleCoordinates()){const m=n.cache.getTile(u).buckets[n.layer];m&&m.updateFootprints(u.toUnwrapped(),s)}return s},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const s=c.getOrder(),u=c.getClipMask(),m=c.getClipScope();for(const h of n){if(!h.footprint)continue;const v=sE(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:s,clipMask:u,clipScope:m})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,s)=>n.priority-s.priority||Ay(n.min,s.min)||Ay(n.max,s.max)||n.order-s.order||n.clipMask-s.clipMask||function(u,m){const h=(v,T)=>v+T;return u.length-m.length||u.reduce(h,"").localeCompare(m.reduce(h,""))}(n.clipScope,s.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const s=this._activeRegions[n],u=this._prevRegions[n];c=s.priority!==u.priority||!iE(s,u)||s.order!==u.order||s.clipMask!==u.clipMask||!Nt(s.clipScope,u.clipScope),++n}}if(c){++this._updateTime;for(const s of this._activeRegions)s.order!==Iy&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const n=s=>{const u=this._activeRegions;if(s>=u.length)return s;const m=u[s].priority;for(;s<u.length&&u[s].priority===m;)++s;return s};if(this._sourceIds.length>1){let s=0,u=n(s);for(;s!==u;){let m=s;const h=s;for(;m!==u;){const v=this._activeRegions[m];v.hiddenByOverlap=!1;for(let T=0;T<h;T++){const k=this._activeRegions[T];if(!k.hiddenByOverlap&&v.order===Iy&&nx(v,k)&&(v.hiddenByOverlap=lE(v.footprint,v.tileId,k.footprint,k.tileId),v.hiddenByOverlap))break}++m}s=u,u=n(s)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},o.dm=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const s=new Rl,u=new Gr,m=[],h=c+1+2,v=n[0]+1,T=n[0]+1+(1+n.length),k=(L,x,A)=>{let D=L===h-1?L-2:L===0?L:L-1;return D+=A?24575:0,[D,x]};for(let L=0;L<h;++L)s.emplaceBack(...k(L,0,!0));for(let L=0;L<v;++L)for(let x=0;x<h;++x)s.emplaceBack(...k(x,L,(x===0||x===h-1)&&!0));for(let L=0;L<n.length;++L){const x=n[L];for(let A=0;A<h;++A)s.emplaceBack(...k(A,x,!0))}for(let L=0;L<n.length;++L){const x=u.length,A=n[L]+1+2,D=new Gr;for(let B=0;B<A-1;B++){const H=B===A-2,Z=H?h*(T-n.length+L-B):h;for(let te=0;te<h-1;te++){const ne=B*h+te;B===0||H||te===0||te===h-2?(D.emplaceBack(ne+1,ne,ne+Z),D.emplaceBack(ne+Z,ne+Z+1,ne+1)):(u.emplaceBack(ne+1,ne,ne+Z),u.emplaceBack(ne+Z,ne+Z+1,ne+1))}}const M=ti.simpleSegment(0,x,s.length,u.length-x);for(let B=0;B<D.uint16.length;B+=3)u.emplaceBack(D.uint16[B],D.uint16[B+1],D.uint16[B+2]);const P=ti.simpleSegment(0,x,s.length,u.length-x);m.push({withoutSkirts:M,withSkirts:P})}return{vertices:s,indices:u,segments:m}}_createGrid(c){const n=this._fillGridMeshWithLods(l,p);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,Ma.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new Gr;for(let v=0;v<=l;v++)n.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const s=new gc,u=new gc,m=new gc,h=new gc;this._poleSegments=[];for(let v=0,T=0;v<_y;v++){const k=360/(1<<v);s.emplaceBack(0,-Oi,0,.5,0),u.emplaceBack(0,-Oi,0,.5,1),m.emplaceBack(0,-Oi,0,.5,.5),h.emplaceBack(0,-Oi,0,.5,.5);for(let L=0;L<=l;L++){let x=L/l,A=0;const D=mo(0,k,x),[M,P,B]=C(V4,U4,D,Oi);s.emplaceBack(M,P,B,x,A),u.emplaceBack(M,P,B,x,1-A);const H=xt(D);x=.5+.5*Math.sin(H),A=.5+.5*Math.cos(H),m.emplaceBack(M,P,B,x,A),h.emplaceBack(M,P,B,x,1-A)}this._poleSegments.push(ti.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(s,$r,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,$r,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(m,$r,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(h,$r,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},o.dn=Iy,o.dp=un,o.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.dr=Pn,o.ds=Je,o.dt=O,o.du=function([c,n,s]){const u=Math.hypot(c,n,s),m=Math.atan2(c,s),h=.5*Math.PI-Math.acos(-n/u);return new j(Ot(m),Ot(h))},o.dv=kx,o.dw=V,o.dx=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(s){if(Oo==null){const u=s.navigator?s.navigator.userAgent:null;Oo=!!s.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Oo}(c)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.dy=function(c,n){po=c,ao=n},o.dz=G1,o.e=He,o.e0=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==_I){const s=new Uint32Array(c,0,7),[,,u,m,h,v]=s;n=s.byteLength+m+h+v+h,(u!==c.byteLength||n>=c.byteLength)&&Mn("Invalid b3dm header information.")}return wI(c,n)},o.e1=function(c,n){const s=TI(c);for(const u of s){for(const m of u.meshes)mN(m);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(gN(u.lights,n)))}return s},o.e2=e0,o.e3=JM,o.e4=Is,o.e5=function(c){On(),jo!=null&&jo.then(n=>{n.keys().then(s=>{for(let u=0;u<s.length-c;u++)n.delete(s[u])})})},o.f=function(c){return c.indexOf("mapbox:")===0},o.g=function(c,n){return Bc(eo(c,{method:"GET"}),n)},o.h=ft,o.i=function(c){return He.API_STYLE_REGEX.test(c)&&!tt(c)},o.j=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,s)=>String.fromCharCode(+("0x"+s))))},o.l=eo,o.m=Co,o.n=function(c,n){return Bc(eo(c,{type:"json"}),n)},o.o=xa,o.p=function(c,n){return Bc(eo(c,{method:"POST"}),n)},o.q=Ht,o.r=es,o.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=fd,o.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},o.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},o.w=Mn,o.x=Ml,o.y=2,o.z=oM}),g(["./shared"],function(o){function S($t){const Se=$t?$t.url.toString():void 0;return Se?performance.getEntriesByName(Se):[]}function E($t){if(typeof $t=="number"||typeof $t=="boolean"||typeof $t=="string"||$t==null)return JSON.stringify($t);if(Array.isArray($t)){let Ae="[";for(const He of $t)Ae+=`${E(He)},`;return`${Ae}]`}let Se="{";for(const Ae of Object.keys($t).sort())Se+=`${Ae}:${E($t[Ae])},`;return`${Se}}`}function I($t){let Se="";for(const Ae of o.bh)Se+=`/${E($t[Ae])}`;return Se}class R{constructor(Se){this.keyCache={},this._layers={},this._layerConfigs={},Se&&this.replace(Se)}replace(Se,Ae){this._layerConfigs={},this._layers={},this.update(Se,[],Ae)}update(Se,Ae,He){this._options=He;for(const tt of Se)this._layerConfigs[tt.id]=tt,(this._layers[tt.id]=o.cq(tt,this.scope,null,this._options)).compileFilter(He),this.keyCache[tt.id]&&delete this.keyCache[tt.id];for(const tt of Ae)delete this.keyCache[tt],delete this._layerConfigs[tt],delete this._layers[tt];this.familiesBySource={};const ft=function(tt,bt){const zt={};for(let Ft=0;Ft<tt.length;Ft++){const Kt=bt&&bt[tt[Ft].id]||I(tt[Ft]);bt&&(bt[tt[Ft].id]=Kt);let Zt=zt[Kt];Zt||(Zt=zt[Kt]=[]),Zt.push(tt[Ft])}const Tt=[];for(const Ft in zt)Tt.push(zt[Ft]);return Tt}(o.be(this._layerConfigs),this.keyCache);for(const tt of ft){const bt=tt.map(pt=>this._layers[pt.id]),zt=bt[0];if(zt.visibility==="none")continue;const Tt=zt.source||"";let Ft=this.familiesBySource[Tt];Ft||(Ft=this.familiesBySource[Tt]={});const Kt=zt.sourceLayer||"_geojsonTileLayer";let Zt=Ft[Kt];Zt||(Zt=Ft[Kt]=[]),Zt.push(bt)}}}const z=1*o.dP;class N{constructor(Se){const Ae={},He=[];for(const zt in Se){const Tt=Se[zt],Ft=Ae[zt]={};for(const Kt in Tt.glyphs){const Zt=Tt.glyphs[+Kt];if(!Zt||Zt.bitmap.width===0||Zt.bitmap.height===0)continue;const pt=Zt.metrics.localGlyph?z:1,Ht={x:0,y:0,w:Zt.bitmap.width+2*pt,h:Zt.bitmap.height+2*pt};He.push(Ht),Ft[Kt]=Ht}}const{w:ft,h:tt}=o.z(He),bt=new o.dO({width:ft||1,height:tt||1});for(const zt in Se){const Tt=Se[zt];for(const Ft in Tt.glyphs){const Kt=Tt.glyphs[+Ft];if(!Kt||Kt.bitmap.width===0||Kt.bitmap.height===0)continue;const Zt=Ae[zt][Ft],pt=Kt.metrics.localGlyph?z:1;o.dO.copy(Kt.bitmap,bt,{x:0,y:0},{x:Zt.x+pt,y:Zt.y+pt},Kt.bitmap)}}this.image=bt,this.positions=Ae}}o.dN(N,"GlyphAtlas");class ${constructor(Se){this.tileID=new o.aA(Se.tileID.overscaledZ,Se.tileID.wrap,Se.tileID.canonical.z,Se.tileID.canonical.x,Se.tileID.canonical.y),this.tileZoom=Se.tileZoom,this.uid=Se.uid,this.zoom=Se.zoom,this.lut=Se.lut,this.canonical=Se.tileID.canonical,this.pixelRatio=Se.pixelRatio,this.tileSize=Se.tileSize,this.source=Se.source,this.scope=Se.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Se.showCollisionBoxes,this.collectResourceTiming=!!Se.request&&Se.request.collectResourceTiming,this.promoteId=Se.promoteId,this.isSymbolTile=Se.isSymbolTile,this.tileTransform=o.aL(Se.tileID.canonical,Se.projection),this.projection=Se.projection,this.worldview=Se.worldview,this.localizableLayerIds=Se.localizableLayerIds,this.brightness=Se.brightness,this.extraShadowCaster=!!Se.extraShadowCaster,this.tessellationStep=Se.tessellationStep,this.scaleFactor=Se.scaleFactor}parse(Se,Ae,He,ft,tt){this.status="parsing",this.data=Se,this.collisionBoxArray=new o.aR;const bt=new o.dQ(Object.keys(Se.layers).sort()),zt=new o.dR(this.tileID,this.promoteId);zt.bucketLayerIDs=[];const Tt={},Ft=new o.dS(256,256),Kt={featureIndex:zt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Ft,availableImages:He,brightness:this.brightness},Zt=Ae.familiesBySource[this.source];for(const ao in Zt){const Ko=Se.layers[ao];if(!Ko)continue;let jo=!1,Ro=!1,Qt=!1;for(const Co of Zt[ao])Co[0].type==="symbol"?jo=!0:Ro=!0,Co[0].is3D()&&Co[0].type!=="model"&&(Qt=!0);if(this.extraShadowCaster&&!Qt||this.isSymbolTile===!0&&!jo||this.isSymbolTile===!1&&!Ro)continue;Ko.version===1&&o.w(`Vector tile source "${this.source}" layer "${ao}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const On=bt.encode(ao),co=[];for(let Co=0,vr=0;Co<Ko.length;Co++){const Kr=Ko.feature(Co),El=zt.getId(Kr,ao);if(this.localizableLayerIds&&this.localizableLayerIds.has(ao)){const ba=Kr.properties?Kr.properties.worldview:null;if(this.worldview&&typeof ba=="string")if(ba==="all")Kr.properties.$localized=!0;else{if(!ba.split(",").includes(this.worldview))continue;Kr.properties.$localized=!0,Kr.properties.worldview=this.worldview}}co.push({feature:Kr,id:El,index:vr,sourceLayerIndex:On}),vr++}for(const Co of Zt[ao]){const vr=Co[0];(!this.extraShadowCaster||vr.is3D()&&vr.type!=="model")&&(this.isSymbolTile!==void 0&&vr.type==="symbol"!==this.isSymbolTile||vr.minzoom&&this.zoom<Math.floor(vr.minzoom)||vr.maxzoom&&this.zoom>=vr.maxzoom||vr.visibility!=="none"&&(F(Co,this.zoom,Kt.brightness,He),(Tt[vr.id]=vr.createBucket({index:zt.bucketLayerIDs.length,layers:Co,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:On,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(co,Kt,this.tileID.canonical,this.tileTransform),zt.bucketLayerIDs.push(Co.map(Kr=>o.av(Kr.id,Kr.scope)))))}}let pt,Ht,bn,Yn;Ft.trim();const ro={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},po=()=>{if(pt)return this.status="done",tt(pt);if(this.extraShadowCaster)this.status="done",tt(null,{buckets:o.be(Tt).filter(ao=>!ao.isEmpty()),featureIndex:zt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Kt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Ht&&bn&&Yn){const ao=new N(Ht),Ko=new o.dU(bn,Yn,this.lut);for(const jo in Tt){const Ro=Tt[jo];Ro instanceof o.aS?(F(Ro.layers,this.zoom,Kt.brightness,He),o.dV(Ro,Ht,ao.positions,bn,Ko.iconPositions,this.showCollisionBoxes,He,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.brightness)):Ro.hasPattern&&(Ro instanceof o.aY||Ro instanceof o.aZ||Ro instanceof o.d0)&&(F(Ro.layers,this.zoom,Kt.brightness,He),Ro.addFeatures(Kt,this.tileID.canonical,Ko.patternPositions,He,this.tileTransform,this.brightness))}this.status="done",tt(null,{buckets:o.be(Tt).filter(jo=>!jo.isEmpty()),featureIndex:zt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ao.image,lineAtlas:Ft,imageAtlas:Ko,brightness:Kt.brightness})}};if(!this.extraShadowCaster){const ao=o.dT(Kt.glyphDependencies,Ro=>Object.keys(Ro).map(Number));Object.keys(ao).length?ft.send("getGlyphs",{uid:this.uid,stacks:ao,scope:this.scope},(Ro,Qt)=>{pt||(pt=Ro,Ht=Qt,po())},void 0,!1,ro):Ht={};const Ko=Object.keys(Kt.iconDependencies);Ko.length?ft.send("getImages",{icons:Ko,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Ro,Qt)=>{pt||(pt=Ro,bn=Qt,po())},void 0,!1,ro):bn={};const jo=Object.keys(Kt.patternDependencies);jo.length?ft.send("getImages",{icons:jo,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Ro,Qt)=>{pt||(pt=Ro,Yn=Qt,po())},void 0,!1,ro):Yn={}}po()}}function F($t,Se,Ae,He){const ft=new o.a3(Se,{brightness:Ae});for(const tt of $t)tt.recalculate(ft,He)}class W extends o.E{constructor(Se,Ae,He,ft,tt,bt){super(),this.actor=Se,this.layerIndex=Ae,this.availableImages=He,this.loadVectorData=tt||o.aw,this.loading={},this.loaded={},this.deduped=new o.au(Se.scheduler),this.isSpriteLoaded=ft,this.scheduler=Se.scheduler,this.brightness=bt}loadTile(Se,Ae){const He=Se.uid,ft=Se&&Se.request,tt=ft&&ft.collectResourceTiming,bt=this.loading[He]=new $(Se);bt.abort=this.loadVectorData(Se,(zt,Tt)=>{const Ft=!this.loading[He];if(delete this.loading[He],Ft||zt||!Tt)return bt.status="done",Ft||(this.loaded[He]=bt),Ae(zt);const Kt=Tt.rawData,Zt={};Tt.expires&&(Zt.expires=Tt.expires),Tt.cacheControl&&(Zt.cacheControl=Tt.cacheControl),bt.vectorTile=Tt.vectorTile||new o.dW.VectorTile(new o.bc(Kt));const pt=()=>{bt.parse(bt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ht,bn)=>{if(Ht||!bn)return Ae(Ht);const Yn={};if(tt){const ro=S(ft);ro.length>0&&(Yn.resourceTiming=JSON.parse(JSON.stringify(ro)))}Ae(null,o.l({rawTileData:Kt.slice(0)},bn,Zt,Yn))})};this.isSpriteLoaded?pt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(pt,{type:"parseTile",isSymbolTile:Se.isSymbolTile,zoom:Se.tileZoom}):pt()}),this.loaded=this.loaded||{},this.loaded[He]=bt})}reloadTile(Se,Ae){const He=this.loaded,ft=Se.uid;if(He&&He[ft]){const tt=He[ft];tt.scaleFactor=Se.scaleFactor,tt.showCollisionBoxes=Se.showCollisionBoxes,tt.projection=Se.projection,tt.brightness=Se.brightness,tt.tileTransform=o.aL(Se.tileID.canonical,Se.projection),tt.extraShadowCaster=Se.extraShadowCaster,tt.lut=Se.lut;const bt=(zt,Tt)=>{const Ft=tt.reloadCallback;Ft&&(delete tt.reloadCallback,tt.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor,Ft)),Ae(zt,Tt)};tt.status==="parsing"?tt.reloadCallback=bt:tt.status==="done"&&(tt.vectorTile?tt.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor,bt):bt())}else Ae(null,void 0)}abortTile(Se,Ae){const He=Se.uid,ft=this.loading[He];ft&&(ft.abort&&ft.abort(),delete this.loading[He]),Ae()}removeTile(Se,Ae){const He=this.loaded,ft=Se.uid;He&&He[ft]&&delete He[ft],Ae()}}class U{loadTile(Se,Ae){const{uid:He,encoding:ft,rawImageData:tt,padding:bt}=Se,zt=ImageBitmap&&tt instanceof ImageBitmap?this.getImageData(tt,bt):tt;Ae(null,new o.dX(He,zt,ft,bt<1))}getImageData(Se,Ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Se.width,Se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Se.width,this.offscreenCanvas.height=Se.height,this.offscreenCanvasContext.drawImage(Se,0,0,Se.width,Se.height);const He=this.offscreenCanvasContext.getImageData(-Ae,-Ae,Se.width+2*Ae,Se.height+2*Ae);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),He}}o.bb.setPbf(o.bc);class re{decodeRasterArray({task:Se,buffer:Ae},He){o.bb.performDecoding(Ae,Se).then(ft=>{He(null,ft)},ft=>{He(ft)})}}const K=o.dW.VectorTileFeature.prototype.toGeoJSON;class q{constructor(Se){this._feature=Se,this.extent=o.ab,this.type=Se.type,this.properties=Se.tags,"id"in Se&&!isNaN(Se.id)&&(this.id=parseInt(Se.id,10))}loadGeometry(){if(this._feature.type===1){const Se=[];for(const Ae of this._feature.geometry)Se.push([new o.P(Ae[0],Ae[1])]);return Se}{const Se=[];for(const Ae of this._feature.geometry){const He=[];for(const ft of Ae)He.push(new o.P(ft[0],ft[1]));Se.push(He)}return Se}}toGeoJSON(Se,Ae,He){return K.call(this,Se,Ae,He)}}class J{constructor(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.ab,this.length=Se.length,this._features=Se}feature(Se){return new q(this._features[Se])}}const oe=64/4096,ae=128;class fe{constructor(){this.features=new Map}clear(){this.features.clear()}load(Se=[],Ae){for(const He of Se){const ft=He.id;if(ft==null)continue;let tt=this.features.get(ft);tt&&this.updateCache(tt,Ae),He.geometry?(tt=ce(He),this.updateCache(tt,Ae),this.features.set(ft,tt)):this.features.delete(ft),this.updateCache(tt,Ae)}}updateCache(Se,Ae){for(const{canonical:He,uid:ft}of Object.values(Ae)){const{z:tt,x:bt,y:zt}=He;ge(Se,Math.pow(2,tt),bt,zt)&&delete Ae[ft]}}getTile(Se,Ae,He){const ft=Math.pow(2,Se),tt=[];for(const bt of this.features.values())ge(bt,ft,Ae,He)&&tt.push(Qe(bt,ft,Ae,He));return{features:tt}}getFeatures(){return[...this.features.values()]}}function ge({minX:$t,minY:Se,maxX:Ae,maxY:He},ft,tt,bt){return $t<(tt+1+oe)/ft&&Se<(bt+1+oe)/ft&&Ae>(tt-oe)/ft&&He>(bt-oe)/ft}function ce($t){const{id:Se,geometry:Ae,properties:He}=$t;if(!Ae)return;if(Ae.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ft,coordinates:tt}=Ae,bt={id:Se,type:1,geometry:[],tags:He,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},zt=bt.geometry;if(ft==="Point")de(tt,zt,bt);else if(ft==="MultiPoint")for(const Tt of tt)de(Tt,zt,bt);else if(ft==="LineString")bt.type=2,_e(tt,zt,bt);else if(ft==="MultiLineString")bt.type=2,Re(tt,zt,bt);else if(ft==="Polygon")bt.type=3,Re(tt,zt,bt,!0);else{if(ft!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");bt.type=3;for(const Tt of tt)Re(Tt,zt,bt,!0)}return bt}function de([$t,Se],Ae,He){const ft=o.am($t);let tt=o.at(Se);tt=tt<0?0:tt>1?1:tt,Ae.push(ft,tt),He.minX=Math.min(He.minX,ft),He.minY=Math.min(He.minY,tt),He.maxX=Math.max(He.maxX,ft),He.maxY=Math.max(He.maxY,tt)}function _e($t,Se,Ae,He=!1,ft=!1){const tt=[];for(const bt of $t)de(bt,tt,Ae);Se.push(tt),He&&function(bt,zt){let Tt=0;for(let Ft=0,Kt=bt.length,Zt=Kt-2;Ft<Kt;Zt=Ft,Ft+=2)Tt+=(bt[Ft]-bt[Zt])*(bt[Ft+1]+bt[Zt+1]);if(Tt>0===zt)for(let Ft=0,Kt=bt.length;Ft<Kt/2;Ft+=2){const Zt=bt[Ft],pt=bt[Ft+1];bt[Ft]=bt[Kt-2-Ft],bt[Ft+1]=bt[Kt-1-Ft],bt[Kt-2-Ft]=Zt,bt[Kt-1-Ft]=pt}}(tt,ft)}function Re($t,Se,Ae,He=!1){for(let ft=0;ft<$t.length;ft++)_e($t[ft],Se,Ae,He,ft===0)}function Qe($t,Se,Ae,He){const{id:ft,type:tt,geometry:bt,tags:zt}=$t,Tt=[];if(tt===1)(function(Ft,Kt,Zt,pt,Ht){for(let bn=0;bn<Ft.length;bn+=2){const Yn=Math.round(o.ab*(Ft[bn+0]*Kt-Zt)),ro=Math.round(o.ab*(Ft[bn+1]*Kt-pt));Ht.push([Yn,ro])}})(bt,Se,Ae,He,Tt);else for(const Ft of bt)Ee(Ft,Se,Ae,He,Tt);return{id:ft,type:tt,geometry:Tt,tags:zt}}function Ee($t,Se,Ae,He,ft){const tt=-ae,bt=o.ab+ae;let zt;for(let Tt=0;Tt<$t.length-2;Tt+=2){let Ft=Math.round(o.ab*($t[Tt+0]*Se-Ae)),Kt=Math.round(o.ab*($t[Tt+1]*Se-He)),Zt=Math.round(o.ab*($t[Tt+2]*Se-Ae)),pt=Math.round(o.ab*($t[Tt+3]*Se-He));const Ht=Zt-Ft,bn=pt-Kt;Ft<tt&&Zt<tt||(Ft<tt?(Kt+=Math.round(bn*((tt-Ft)/Ht)),Ft=tt):Zt<tt&&(pt=Kt+Math.round(bn*((tt-Ft)/Ht)),Zt=tt),Kt<tt&&pt<tt||(Kt<tt?(Ft+=Math.round(Ht*((tt-Kt)/bn)),Kt=tt):pt<tt&&(Zt=Ft+Math.round(Ht*((tt-Kt)/bn)),pt=tt),Ft>=bt&&Zt>=bt||(Ft>=bt?(Kt+=Math.round(bn*((bt-Ft)/Ht)),Ft=bt):Zt>=bt&&(pt=Kt+Math.round(bn*((bt-Ft)/Ht)),Zt=bt),Kt>=bt&&pt>=bt||(Kt>=bt?(Ft+=Math.round(Ht*((bt-Kt)/bn)),Kt=bt):pt>=bt&&(Zt=Ft+Math.round(Ht*((bt-Kt)/bn)),pt=bt),zt&&Ft===zt[zt.length-1][0]&&Kt===zt[zt.length-1][1]||(zt=[[Ft,Kt]],ft.push(zt)),zt.push([Zt,pt])))))}}var ye,Me,Te,he={exports:{}},ke=function(){if(Te)return he.exports;Te=1;var $t=o.d_(),Se=function(){if(Me)return ye;Me=1;var Kt=o.dY(),Zt=o.dZ().VectorTileFeature;function pt(bn,Yn){this.options=Yn||{},this.features=bn,this.length=bn.length}function Ht(bn,Yn){this.id=typeof bn.id=="number"?bn.id:void 0,this.type=bn.type,this.rawGeometry=bn.type===1?[bn.geometry]:bn.geometry,this.properties=bn.tags,this.extent=Yn||4096}return ye=pt,pt.prototype.feature=function(bn){return new Ht(this.features[bn],this.options.extent)},Ht.prototype.loadGeometry=function(){var bn=this.rawGeometry;this.geometry=[];for(var Yn=0;Yn<bn.length;Yn++){for(var ro=bn[Yn],po=[],ao=0;ao<ro.length;ao++)po.push(new Kt(ro[ao][0],ro[ao][1]));this.geometry.push(po)}return this.geometry},Ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var bn=this.geometry,Yn=1/0,ro=-1/0,po=1/0,ao=-1/0,Ko=0;Ko<bn.length;Ko++)for(var jo=bn[Ko],Ro=0;Ro<jo.length;Ro++){var Qt=jo[Ro];Yn=Math.min(Yn,Qt.x),ro=Math.max(ro,Qt.x),po=Math.min(po,Qt.y),ao=Math.max(ao,Qt.y)}return[Yn,po,ro,ao]},Ht.prototype.toGeoJSON=Zt.prototype.toGeoJSON,ye}();function Ae(Kt){var Zt=new $t;return function(pt,Ht){for(var bn in pt.layers)Ht.writeMessage(3,He,pt.layers[bn])}(Kt,Zt),Zt.finish()}function He(Kt,Zt){var pt;Zt.writeVarintField(15,Kt.version||1),Zt.writeStringField(1,Kt.name||""),Zt.writeVarintField(5,Kt.extent||4096);var Ht={keys:[],values:[],keycache:{},valuecache:{}};for(pt=0;pt<Kt.length;pt++)Ht.feature=Kt.feature(pt),Zt.writeMessage(2,ft,Ht);var bn=Ht.keys;for(pt=0;pt<bn.length;pt++)Zt.writeStringField(3,bn[pt]);var Yn=Ht.values;for(pt=0;pt<Yn.length;pt++)Zt.writeMessage(4,Ft,Yn[pt])}function ft(Kt,Zt){var pt=Kt.feature;pt.id!==void 0&&Zt.writeVarintField(1,pt.id),Zt.writeMessage(2,tt,Kt),Zt.writeVarintField(3,pt.type),Zt.writeMessage(4,Tt,pt)}function tt(Kt,Zt){var pt=Kt.feature,Ht=Kt.keys,bn=Kt.values,Yn=Kt.keycache,ro=Kt.valuecache;for(var po in pt.properties){var ao=pt.properties[po],Ko=Yn[po];if(ao!==null){Ko===void 0&&(Ht.push(po),Yn[po]=Ko=Ht.length-1),Zt.writeVarint(Ko);var jo=typeof ao;jo!=="string"&&jo!=="boolean"&&jo!=="number"&&(ao=JSON.stringify(ao));var Ro=jo+":"+ao,Qt=ro[Ro];Qt===void 0&&(bn.push(ao),ro[Ro]=Qt=bn.length-1),Zt.writeVarint(Qt)}}}function bt(Kt,Zt){return(Zt<<3)+(7&Kt)}function zt(Kt){return Kt<<1^Kt>>31}function Tt(Kt,Zt){for(var pt=Kt.loadGeometry(),Ht=Kt.type,bn=0,Yn=0,ro=pt.length,po=0;po<ro;po++){var ao=pt[po],Ko=1;Ht===1&&(Ko=ao.length),Zt.writeVarint(bt(1,Ko));for(var jo=Ht===3?ao.length-1:ao.length,Ro=0;Ro<jo;Ro++){Ro===1&&Ht!==1&&Zt.writeVarint(bt(2,jo-1));var Qt=ao[Ro].x-bn,On=ao[Ro].y-Yn;Zt.writeVarint(zt(Qt)),Zt.writeVarint(zt(On)),bn+=Qt,Yn+=On}Ht===3&&Zt.writeVarint(bt(7,1))}}function Ft(Kt,Zt){var pt=typeof Kt;pt==="string"?Zt.writeStringField(1,Kt):pt==="boolean"?Zt.writeBooleanField(7,Kt):pt==="number"&&(Kt%1!=0?Zt.writeDoubleField(3,Kt):Kt<0?Zt.writeSVarintField(6,Kt):Zt.writeVarintField(5,Kt))}return he.exports=Ae,he.exports.fromVectorTileJs=Ae,he.exports.fromGeojsonVt=function(Kt,Zt){Zt=Zt||{};var pt={};for(var Ht in Kt)pt[Ht]=new Se(Kt[Ht].features,Zt),pt[Ht].name=Ht,pt[Ht].version=Zt.version,pt[Ht].extent=Zt.extent;return Ae({layers:pt})},he.exports.GeoJSONWrapper=Se,he.exports}(),Ne=o.d$(ke);const nt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$t=>$t},De=Math.fround||(Ct=new Float32Array(1),$t=>(Ct[0]=+$t,Ct[0]));var Ct;const Rt=3,Bt=5,mt=6;class Gt{constructor(Se){this.options=Object.assign(Object.create(nt),Se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Se){const{log:Ae,minZoom:He,maxZoom:ft}=this.options;Ae&&console.time("total time");const tt=`prepare ${Se.length} points`;Ae&&console.time(tt),this.points=Se;const bt=[];for(let Tt=0;Tt<Se.length;Tt++){const Ft=Se[Tt];if(!Ft.geometry)continue;const[Kt,Zt]=Ft.geometry.coordinates,pt=De(an(Kt)),Ht=De(At(Zt));bt.push(pt,Ht,1/0,Tt,-1,1),this.options.reduce&&bt.push(0)}let zt=this.trees[ft+1]=this._createTree(bt);Ae&&console.timeEnd(tt);for(let Tt=ft;Tt>=He;Tt--){const Ft=+Date.now();zt=this.trees[Tt]=this._createTree(this._cluster(zt,Tt)),Ae&&console.log("z%d: %d clusters in %dms",Tt,zt.numItems,+Date.now()-Ft)}return Ae&&console.timeEnd("total time"),this}getClusters(Se,Ae){let He=((Se[0]+180)%360+360)%360-180;const ft=Math.max(-90,Math.min(90,Se[1]));let tt=Se[2]===180?180:((Se[2]+180)%360+360)%360-180;const bt=Math.max(-90,Math.min(90,Se[3]));if(Se[2]-Se[0]>=360)He=-180,tt=180;else if(He>tt){const Zt=this.getClusters([He,ft,180,bt],Ae),pt=this.getClusters([-180,ft,tt,bt],Ae);return Zt.concat(pt)}const zt=this.trees[this._limitZoom(Ae)],Tt=zt.range(an(He),At(bt),an(tt),At(ft)),Ft=zt.data,Kt=[];for(const Zt of Tt){const pt=this.stride*Zt;Kt.push(Ft[pt+Bt]>1?jt(Ft,pt,this.clusterProps):this.points[Ft[pt+Rt]])}return Kt}getChildren(Se){const Ae=this._getOriginId(Se),He=this._getOriginZoom(Se),ft="No cluster with the specified id.",tt=this.trees[He];if(!tt)throw new Error(ft);const bt=tt.data;if(Ae*this.stride>=bt.length)throw new Error(ft);const zt=this.options.radius/(this.options.extent*Math.pow(2,He-1)),Tt=tt.within(bt[Ae*this.stride],bt[Ae*this.stride+1],zt),Ft=[];for(const Kt of Tt){const Zt=Kt*this.stride;bt[Zt+4]===Se&&Ft.push(bt[Zt+Bt]>1?jt(bt,Zt,this.clusterProps):this.points[bt[Zt+Rt]])}if(Ft.length===0)throw new Error(ft);return Ft}getLeaves(Se,Ae,He){const ft=[];return this._appendLeaves(ft,Se,Ae=Ae||10,He=He||0,0),ft}getTile(Se,Ae,He){const ft=this.trees[this._limitZoom(Se)],tt=Math.pow(2,Se),{extent:bt,radius:zt}=this.options,Tt=zt/bt,Ft=(He-Tt)/tt,Kt=(He+1+Tt)/tt,Zt={features:[]};return this._addTileFeatures(ft.range((Ae-Tt)/tt,Ft,(Ae+1+Tt)/tt,Kt),ft.data,Ae,He,tt,Zt),Ae===0&&this._addTileFeatures(ft.range(1-Tt/tt,Ft,1,Kt),ft.data,tt,He,tt,Zt),Ae===tt-1&&this._addTileFeatures(ft.range(0,Ft,Tt/tt,Kt),ft.data,-1,He,tt,Zt),Zt.features.length?Zt:null}getClusterExpansionZoom(Se){let Ae=this._getOriginZoom(Se)-1;for(;Ae<=this.options.maxZoom;){const He=this.getChildren(Se);if(Ae++,He.length!==1)break;Se=He[0].properties.cluster_id}return Ae}_appendLeaves(Se,Ae,He,ft,tt){const bt=this.getChildren(Ae);for(const zt of bt){const Tt=zt.properties;if(Tt&&Tt.cluster?tt+Tt.point_count<=ft?tt+=Tt.point_count:tt=this._appendLeaves(Se,Tt.cluster_id,He,ft,tt):tt<ft?tt++:Se.push(zt),Se.length===He)break}return tt}_createTree(Se){const Ae=new o.bz(Se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let He=0;He<Se.length;He+=this.stride)Ae.add(Se[He],Se[He+1]);return Ae.finish(),Ae.data=Se,Ae}_addTileFeatures(Se,Ae,He,ft,tt,bt){for(const zt of Se){const Tt=zt*this.stride,Ft=Ae[Tt+Bt]>1;let Kt,Zt,pt;if(Ft)Kt=Be(Ae,Tt,this.clusterProps),Zt=Ae[Tt],pt=Ae[Tt+1];else{const Yn=this.points[Ae[Tt+Rt]];Kt=Yn.properties;const[ro,po]=Yn.geometry.coordinates;Zt=an(ro),pt=At(po)}const Ht={type:1,geometry:[[Math.round(this.options.extent*(Zt*tt-He)),Math.round(this.options.extent*(pt*tt-ft))]],tags:Kt};let bn;bn=Ft||this.options.generateId?Ae[Tt+Rt]:this.points[Ae[Tt+Rt]].id,bn!==void 0&&(Ht.id=bn),bt.features.push(Ht)}}_limitZoom(Se){return Math.max(this.options.minZoom,Math.min(Math.floor(+Se),this.options.maxZoom+1))}_cluster(Se,Ae){const{radius:He,extent:ft,reduce:tt,minPoints:bt}=this.options,zt=He/(ft*Math.pow(2,Ae)),Tt=Se.data,Ft=[],Kt=this.stride;for(let Zt=0;Zt<Tt.length;Zt+=Kt){if(Tt[Zt+2]<=Ae)continue;Tt[Zt+2]=Ae;const pt=Tt[Zt],Ht=Tt[Zt+1],bn=Se.within(Tt[Zt],Tt[Zt+1],zt),Yn=Tt[Zt+Bt];let ro=Yn;for(const po of bn){const ao=po*Kt;Tt[ao+2]>Ae&&(ro+=Tt[ao+Bt])}if(ro>Yn&&ro>=bt){let po,ao=pt*Yn,Ko=Ht*Yn,jo=-1;const Ro=(Zt/Kt<<5)+(Ae+1)+this.points.length;for(const Qt of bn){const On=Qt*Kt;if(Tt[On+2]<=Ae)continue;Tt[On+2]=Ae;const co=Tt[On+Bt];ao+=Tt[On]*co,Ko+=Tt[On+1]*co,Tt[On+4]=Ro,tt&&(po||(po=this._map(Tt,Zt,!0),jo=this.clusterProps.length,this.clusterProps.push(po)),tt(po,this._map(Tt,On)))}Tt[Zt+4]=Ro,Ft.push(ao/ro,Ko/ro,1/0,Ro,-1,ro),tt&&Ft.push(jo)}else{for(let po=0;po<Kt;po++)Ft.push(Tt[Zt+po]);if(ro>1)for(const po of bn){const ao=po*Kt;if(!(Tt[ao+2]<=Ae)){Tt[ao+2]=Ae;for(let Ko=0;Ko<Kt;Ko++)Ft.push(Tt[ao+Ko])}}}}return Ft}_getOriginId(Se){return Se-this.points.length>>5}_getOriginZoom(Se){return(Se-this.points.length)%32}_map(Se,Ae,He){if(Se[Ae+Bt]>1){const bt=this.clusterProps[Se[Ae+mt]];return He?Object.assign({},bt):bt}const ft=this.points[Se[Ae+Rt]].properties,tt=this.options.map(ft);return He&&tt===ft?Object.assign({},tt):tt}}function jt($t,Se,Ae){return{type:"Feature",id:$t[Se+Rt],properties:Be($t,Se,Ae),geometry:{type:"Point",coordinates:[(He=$t[Se],360*(He-.5)),Ge($t[Se+1])]}};var He}function Be($t,Se,Ae){const He=$t[Se+Bt],ft=He>=1e4?`${Math.round(He/1e3)}k`:He>=1e3?Math.round(He/100)/10+"k":He,tt=$t[Se+mt],bt=tt===-1?{}:Object.assign({},Ae[tt]);return Object.assign(bt,{cluster:!0,cluster_id:$t[Se+Rt],point_count:He,point_count_abbreviated:ft})}function an($t){return $t/360+.5}function At($t){const Se=Math.sin($t*Math.PI/180),Ae=.5-.25*Math.log((1+Se)/(1-Se))/Math.PI;return Ae<0?0:Ae>1?1:Ae}function Ge($t){const Se=(180-360*$t)*Math.PI/180;return 360*Math.atan(Math.exp(Se))/Math.PI-90}function Fe($t,Se,Ae,He){let ft=He;const tt=Se+(Ae-Se>>1);let bt,zt=Ae-Se;const Tt=$t[Se],Ft=$t[Se+1],Kt=$t[Ae],Zt=$t[Ae+1];for(let pt=Se+3;pt<Ae;pt+=3){const Ht=Nt($t[pt],$t[pt+1],Tt,Ft,Kt,Zt);if(Ht>ft)bt=pt,ft=Ht;else if(Ht===ft){const bn=Math.abs(pt-tt);bn<zt&&(bt=pt,zt=bn)}}ft>He&&(bt-Se>3&&Fe($t,Se,bt,He),$t[bt+2]=ft,Ae-bt>3&&Fe($t,bt,Ae,He))}function Nt($t,Se,Ae,He,ft,tt){let bt=ft-Ae,zt=tt-He;if(bt!==0||zt!==0){const Tt=(($t-Ae)*bt+(Se-He)*zt)/(bt*bt+zt*zt);Tt>1?(Ae=ft,He=tt):Tt>0&&(Ae+=bt*Tt,He+=zt*Tt)}return bt=$t-Ae,zt=Se-He,bt*bt+zt*zt}function Jt($t,Se,Ae,He){const ft={id:$t??null,type:Se,geometry:Ae,tags:He,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")Dt(ft,Ae);else if(Se==="Polygon")Dt(ft,Ae[0]);else if(Se==="MultiLineString")for(const tt of Ae)Dt(ft,tt);else if(Se==="MultiPolygon")for(const tt of Ae)Dt(ft,tt[0]);return ft}function Dt($t,Se){for(let Ae=0;Ae<Se.length;Ae+=3)$t.minX=Math.min($t.minX,Se[Ae]),$t.minY=Math.min($t.minY,Se[Ae+1]),$t.maxX=Math.max($t.maxX,Se[Ae]),$t.maxY=Math.max($t.maxY,Se[Ae+1])}function xt($t,Se,Ae,He){if(!Se.geometry)return;const ft=Se.geometry.coordinates;if(ft&&ft.length===0)return;const tt=Se.geometry.type,bt=Math.pow(Ae.tolerance/((1<<Ae.maxZoom)*Ae.extent),2);let zt=[],Tt=Se.id;if(Ae.promoteId?Tt=Se.properties[Ae.promoteId]:Ae.generateId&&(Tt=He||0),tt==="Point")Ot(ft,zt);else if(tt==="MultiPoint")for(const Ft of ft)Ot(Ft,zt);else if(tt==="LineString")en(ft,zt,bt,!1);else if(tt==="MultiLineString"){if(Ae.lineMetrics){for(const Ft of ft)zt=[],en(Ft,zt,bt,!1),$t.push(Jt(Tt,"LineString",zt,Se.properties));return}dn(ft,zt,bt,!1)}else if(tt==="Polygon")dn(ft,zt,bt,!0);else{if(tt!=="MultiPolygon"){if(tt==="GeometryCollection"){for(const Ft of Se.geometry.geometries)xt($t,{id:Tt,geometry:Ft,properties:Se.properties},Ae,He);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ft of ft){const Kt=[];dn(Ft,Kt,bt,!0),zt.push(Kt)}}$t.push(Jt(Tt,tt,zt,Se.properties))}function Ot($t,Se){Se.push(un($t[0]),Pn($t[1]),0)}function en($t,Se,Ae,He){let ft,tt,bt=0;for(let Tt=0;Tt<$t.length;Tt++){const Ft=un($t[Tt][0]),Kt=Pn($t[Tt][1]);Se.push(Ft,Kt,0),Tt>0&&(bt+=He?(ft*Kt-Ft*tt)/2:Math.sqrt(Math.pow(Ft-ft,2)+Math.pow(Kt-tt,2))),ft=Ft,tt=Kt}const zt=Se.length-3;Se[2]=1,Fe(Se,0,zt,Ae),Se[zt+2]=1,Se.size=Math.abs(bt),Se.start=0,Se.end=Se.size}function dn($t,Se,Ae,He){for(let ft=0;ft<$t.length;ft++){const tt=[];en($t[ft],tt,Ae,He),Se.push(tt)}}function un($t){return $t/360+.5}function Pn($t){const Se=Math.sin($t*Math.PI/180),Ae=.5-.25*Math.log((1+Se)/(1-Se))/Math.PI;return Ae<0?0:Ae>1?1:Ae}function gt($t,Se,Ae,He,ft,tt,bt,zt){if(He/=Se,tt>=(Ae/=Se)&&bt<He)return $t;if(bt<Ae||tt>=He)return null;const Tt=[];for(const Ft of $t){const Kt=Ft.geometry;let Zt=Ft.type;const pt=ft===0?Ft.minX:Ft.minY,Ht=ft===0?Ft.maxX:Ft.maxY;if(pt>=Ae&&Ht<He){Tt.push(Ft);continue}if(Ht<Ae||pt>=He)continue;let bn=[];if(Zt==="Point"||Zt==="MultiPoint")Sn(Kt,bn,Ae,He,ft);else if(Zt==="LineString")Vn(Kt,bn,Ae,He,ft,!1,zt.lineMetrics);else if(Zt==="MultiLineString")eo(Kt,bn,Ae,He,ft,!1);else if(Zt==="Polygon")eo(Kt,bn,Ae,He,ft,!0);else if(Zt==="MultiPolygon")for(const Yn of Kt){const ro=[];eo(Yn,ro,Ae,He,ft,!0),ro.length&&bn.push(ro)}if(bn.length){if(zt.lineMetrics&&Zt==="LineString"){for(const Yn of bn)Tt.push(Jt(Ft.id,Zt,Yn,Ft.tags));continue}Zt!=="LineString"&&Zt!=="MultiLineString"||(bn.length===1?(Zt="LineString",bn=bn[0]):Zt="MultiLineString"),Zt!=="Point"&&Zt!=="MultiPoint"||(Zt=bn.length===3?"Point":"MultiPoint"),Tt.push(Jt(Ft.id,Zt,bn,Ft.tags))}}return Tt.length?Tt:null}function Sn($t,Se,Ae,He,ft){for(let tt=0;tt<$t.length;tt+=3){const bt=$t[tt+ft];bt>=Ae&&bt<=He&&fo(Se,$t[tt],$t[tt+1],$t[tt+2])}}function Vn($t,Se,Ae,He,ft,tt,bt){let zt=lo($t);const Tt=ft===0?Lo:er;let Ft,Kt,Zt=$t.start;for(let ro=0;ro<$t.length-3;ro+=3){const po=$t[ro],ao=$t[ro+1],Ko=$t[ro+2],jo=$t[ro+3],Ro=$t[ro+4],Qt=ft===0?po:ao,On=ft===0?jo:Ro;let co=!1;bt&&(Ft=Math.sqrt(Math.pow(po-jo,2)+Math.pow(ao-Ro,2))),Qt<Ae?On>Ae&&(Kt=Tt(zt,po,ao,jo,Ro,Ae),bt&&(zt.start=Zt+Ft*Kt)):Qt>He?On<He&&(Kt=Tt(zt,po,ao,jo,Ro,He),bt&&(zt.start=Zt+Ft*Kt)):fo(zt,po,ao,Ko),On<Ae&&Qt>=Ae&&(Kt=Tt(zt,po,ao,jo,Ro,Ae),co=!0),On>He&&Qt<=He&&(Kt=Tt(zt,po,ao,jo,Ro,He),co=!0),!tt&&co&&(bt&&(zt.end=Zt+Ft*Kt),Se.push(zt),zt=lo($t)),bt&&(Zt+=Ft)}let pt=$t.length-3;const Ht=$t[pt],bn=$t[pt+1],Yn=ft===0?Ht:bn;Yn>=Ae&&Yn<=He&&fo(zt,Ht,bn,$t[pt+2]),pt=zt.length-3,tt&&pt>=3&&(zt[pt]!==zt[0]||zt[pt+1]!==zt[1])&&fo(zt,zt[0],zt[1],zt[2]),zt.length&&Se.push(zt)}function lo($t){const Se=[];return Se.size=$t.size,Se.start=$t.start,Se.end=$t.end,Se}function eo($t,Se,Ae,He,ft,tt){for(const bt of $t)Vn(bt,Se,Ae,He,ft,tt,!1)}function fo($t,Se,Ae,He){$t.push(Se,Ae,He)}function Lo($t,Se,Ae,He,ft,tt){const bt=(tt-Se)/(He-Se);return fo($t,tt,Ae+(ft-Ae)*bt,1),bt}function er($t,Se,Ae,He,ft,tt){const bt=(tt-Ae)/(ft-Ae);return fo($t,Se+(He-Se)*bt,tt,1),bt}function Pt($t,Se){const Ae=[];for(let He=0;He<$t.length;He++){const ft=$t[He],tt=ft.type;let bt;if(tt==="Point"||tt==="MultiPoint"||tt==="LineString")bt=_n(ft.geometry,Se);else if(tt==="MultiLineString"||tt==="Polygon"){bt=[];for(const zt of ft.geometry)bt.push(_n(zt,Se))}else if(tt==="MultiPolygon"){bt=[];for(const zt of ft.geometry){const Tt=[];for(const Ft of zt)Tt.push(_n(Ft,Se));bt.push(Tt)}}Ae.push(Jt(ft.id,tt,bt,ft.tags))}return Ae}function _n($t,Se){const Ae=[];Ae.size=$t.size,$t.start!==void 0&&(Ae.start=$t.start,Ae.end=$t.end);for(let He=0;He<$t.length;He+=3)Ae.push($t[He]+Se,$t[He+1],$t[He+2]);return Ae}function dt($t,Se){if($t.transformed)return $t;const Ae=1<<$t.z,He=$t.x,ft=$t.y;for(const tt of $t.features){const bt=tt.geometry,zt=tt.type;if(tt.geometry=[],zt===1)for(let Tt=0;Tt<bt.length;Tt+=2)tt.geometry.push(tn(bt[Tt],bt[Tt+1],Se,Ae,He,ft));else for(let Tt=0;Tt<bt.length;Tt++){const Ft=[];for(let Kt=0;Kt<bt[Tt].length;Kt+=2)Ft.push(tn(bt[Tt][Kt],bt[Tt][Kt+1],Se,Ae,He,ft));tt.geometry.push(Ft)}}return $t.transformed=!0,$t}function tn($t,Se,Ae,He,ft,tt){return[Math.round(Ae*($t*He-ft)),Math.round(Ae*(Se*He-tt))]}function Ze($t,Se,Ae,He,ft){const tt=Se===ft.maxZoom?0:ft.tolerance/((1<<Se)*ft.extent),bt={features:[],numPoints:0,numSimplified:0,numFeatures:$t.length,source:null,x:Ae,y:He,z:Se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const zt of $t)vn(bt,zt,tt,ft);return bt}function vn($t,Se,Ae,He){const ft=Se.geometry,tt=Se.type,bt=[];if($t.minX=Math.min($t.minX,Se.minX),$t.minY=Math.min($t.minY,Se.minY),$t.maxX=Math.max($t.maxX,Se.maxX),$t.maxY=Math.max($t.maxY,Se.maxY),tt==="Point"||tt==="MultiPoint")for(let zt=0;zt<ft.length;zt+=3)bt.push(ft[zt],ft[zt+1]),$t.numPoints++,$t.numSimplified++;else if(tt==="LineString")Mn(bt,ft,$t,Ae,!1,!1);else if(tt==="MultiLineString"||tt==="Polygon")for(let zt=0;zt<ft.length;zt++)Mn(bt,ft[zt],$t,Ae,tt==="Polygon",zt===0);else if(tt==="MultiPolygon")for(let zt=0;zt<ft.length;zt++){const Tt=ft[zt];for(let Ft=0;Ft<Tt.length;Ft++)Mn(bt,Tt[Ft],$t,Ae,!0,Ft===0)}if(bt.length){let zt=Se.tags||null;if(tt==="LineString"&&He.lineMetrics){zt={};for(const Ft in Se.tags)zt[Ft]=Se.tags[Ft];zt.mapbox_clip_start=ft.start/ft.size,zt.mapbox_clip_end=ft.end/ft.size}const Tt={geometry:bt,type:tt==="Polygon"||tt==="MultiPolygon"?3:tt==="LineString"||tt==="MultiLineString"?2:1,tags:zt};Se.id!==null&&(Tt.id=Se.id),$t.features.push(Tt)}}function Mn($t,Se,Ae,He,ft,tt){const bt=He*He;if(He>0&&Se.size<(ft?bt:He))return void(Ae.numPoints+=Se.length/3);const zt=[];for(let Tt=0;Tt<Se.length;Tt+=3)(He===0||Se[Tt+2]>bt)&&(Ae.numSimplified++,zt.push(Se[Tt],Se[Tt+1])),Ae.numPoints++;ft&&function(Tt,Ft){let Kt=0;for(let Zt=0,pt=Tt.length,Ht=pt-2;Zt<pt;Ht=Zt,Zt+=2)Kt+=(Tt[Zt]-Tt[Ht])*(Tt[Zt+1]+Tt[Ht+1]);if(Kt>0===Ft)for(let Zt=0,pt=Tt.length;Zt<pt/2;Zt+=2){const Ht=Tt[Zt],bn=Tt[Zt+1];Tt[Zt]=Tt[pt-2-Zt],Tt[Zt+1]=Tt[pt-1-Zt],Tt[pt-2-Zt]=Ht,Tt[pt-1-Zt]=bn}}(zt,tt),$t.push(zt)}const yo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class gr{constructor(Se,Ae){const He=(Ae=this.options=function(tt,bt){for(const zt in bt)tt[zt]=bt[zt];return tt}(Object.create(yo),Ae)).debug;if(He&&console.time("preprocess data"),Ae.maxZoom<0||Ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ae.promoteId&&Ae.generateId)throw new Error("promoteId and generateId cannot be used together.");let ft=function(tt,bt){const zt=[];if(tt.type==="FeatureCollection")for(let Tt=0;Tt<tt.features.length;Tt++)xt(zt,tt.features[Tt],bt,Tt);else xt(zt,tt.type==="Feature"?tt:{geometry:tt},bt);return zt}(Se,Ae);this.tiles={},this.tileCoords=[],He&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ae.indexMaxZoom,Ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ft=function(tt,bt){const zt=bt.buffer/bt.extent;let Tt=tt;const Ft=gt(tt,1,-1-zt,zt,0,-1,2,bt),Kt=gt(tt,1,1-zt,2+zt,0,-1,2,bt);return(Ft||Kt)&&(Tt=gt(tt,1,-zt,1+zt,0,-1,2,bt)||[],Ft&&(Tt=Pt(Ft,1).concat(Tt)),Kt&&(Tt=Tt.concat(Pt(Kt,-1)))),Tt}(ft,Ae),ft.length&&this.splitTile(ft,0,0,0),He&&(ft.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Se,Ae,He,ft,tt,bt,zt){const Tt=[Se,Ae,He,ft],Ft=this.options,Kt=Ft.debug;for(;Tt.length;){ft=Tt.pop(),He=Tt.pop(),Ae=Tt.pop(),Se=Tt.pop();const Zt=1<<Ae,pt=Xr(Ae,He,ft);let Ht=this.tiles[pt];if(!Ht&&(Kt>1&&console.time("creation"),Ht=this.tiles[pt]=Ze(Se,Ae,He,ft,Ft),this.tileCoords.push({z:Ae,x:He,y:ft}),Kt)){Kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ae,He,ft,Ht.numFeatures,Ht.numPoints,Ht.numSimplified),console.timeEnd("creation"));const co=`z${Ae}`;this.stats[co]=(this.stats[co]||0)+1,this.total++}if(Ht.source=Se,tt==null){if(Ae===Ft.indexMaxZoom||Ht.numPoints<=Ft.indexMaxPoints)continue}else{if(Ae===Ft.maxZoom||Ae===tt)continue;if(tt!=null){const co=tt-Ae;if(He!==bt>>co||ft!==zt>>co)continue}}if(Ht.source=null,Se.length===0)continue;Kt>1&&console.time("clipping");const bn=.5*Ft.buffer/Ft.extent,Yn=.5-bn,ro=.5+bn,po=1+bn;let ao=null,Ko=null,jo=null,Ro=null,Qt=gt(Se,Zt,He-bn,He+ro,0,Ht.minX,Ht.maxX,Ft),On=gt(Se,Zt,He+Yn,He+po,0,Ht.minX,Ht.maxX,Ft);Se=null,Qt&&(ao=gt(Qt,Zt,ft-bn,ft+ro,1,Ht.minY,Ht.maxY,Ft),Ko=gt(Qt,Zt,ft+Yn,ft+po,1,Ht.minY,Ht.maxY,Ft),Qt=null),On&&(jo=gt(On,Zt,ft-bn,ft+ro,1,Ht.minY,Ht.maxY,Ft),Ro=gt(On,Zt,ft+Yn,ft+po,1,Ht.minY,Ht.maxY,Ft),On=null),Kt>1&&console.timeEnd("clipping"),Tt.push(ao||[],Ae+1,2*He,2*ft),Tt.push(Ko||[],Ae+1,2*He,2*ft+1),Tt.push(jo||[],Ae+1,2*He+1,2*ft),Tt.push(Ro||[],Ae+1,2*He+1,2*ft+1)}}getTile(Se,Ae,He){Se=+Se,Ae=+Ae,He=+He;const ft=this.options,{extent:tt,debug:bt}=ft;if(Se<0||Se>24)return null;const zt=1<<Se,Tt=Xr(Se,Ae=Ae+zt&zt-1,He);if(this.tiles[Tt])return dt(this.tiles[Tt],tt);bt>1&&console.log("drilling down to z%d-%d-%d",Se,Ae,He);let Ft,Kt=Se,Zt=Ae,pt=He;for(;!Ft&&Kt>0;)Kt--,Zt>>=1,pt>>=1,Ft=this.tiles[Xr(Kt,Zt,pt)];return Ft&&Ft.source?(bt>1&&(console.log("found parent tile z%d-%d-%d",Kt,Zt,pt),console.time("drilling down")),this.splitTile(Ft.source,Kt,Zt,pt,Se,Ae,He),bt>1&&console.timeEnd("drilling down"),this.tiles[Tt]?dt(this.tiles[Tt],tt):null):null}}function Xr($t,Se,Ae){return 32*((1<<$t)*Ae+Se)+$t}function Ur($t,Se){const Ae=$t.tileID.canonical;if(!this._geoJSONIndex)return void Se(null,null);const He=this._geoJSONIndex.getTile(Ae.z,Ae.x,Ae.y);if(!He)return void Se(null,null);const ft=new J(He.features);let tt=Ne(ft);tt.byteOffset===0&&tt.byteLength===tt.buffer.byteLength||(tt=new Uint8Array(tt)),Se(null,{vectorTile:ft,rawData:tt.buffer})}class Rr extends W{constructor(Se,Ae,He,ft,tt,bt){super(Se,Ae,He,ft,Ur,bt),tt&&(this.loadGeoJSON=tt),this._dynamicIndex=new fe}loadData(Se,Ae){const He=Se&&Se.request,ft=He&&He.collectResourceTiming;this.loadGeoJSON(Se,(tt,bt)=>{if(tt||!bt)return Ae(tt);if(typeof bt!="object")return Ae(new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`));{try{if(Se.filter){const Tt=o.M(Se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Tt.result==="error")throw new Error(Tt.value.map(Ft=>`${Ft.key}: ${Ft.message}`).join(", "));bt.features=bt.features.filter(Ft=>Tt.value.evaluate({zoom:0},Ft))}Se.dynamic?(bt.type==="Feature"&&(bt={type:"FeatureCollection",features:[bt]}),Se.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(bt.features,this.loaded),Se.cluster&&(bt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Se.cluster?new Gt(function({superclusterOptions:Tt,clusterProperties:Ft}){if(!Ft||!Tt)return Tt;const Kt={},Zt={},pt={accumulated:null,zoom:0},Ht={properties:null},bn=Object.keys(Ft);for(const Yn of bn){const[ro,po]=Ft[Yn],ao=o.M(po),Ko=o.M(typeof ro=="string"?[ro,["accumulated"],["get",Yn]]:ro);Kt[Yn]=ao.value,Zt[Yn]=Ko.value}return Tt.map=Yn=>{Ht.properties=Yn;const ro={};for(const po of bn)ro[po]=Kt[po].evaluate(pt,Ht);return ro},Tt.reduce=(Yn,ro)=>{Ht.properties=ro;for(const po of bn)pt.accumulated=Yn[po],Yn[po]=Zt[po].evaluate(pt,Ht)},Tt}(Se)).load(bt.features):Se.dynamic?this._dynamicIndex:function(Tt,Ft){return new gr(Tt,Ft)}(bt,Se.geojsonVtOptions)}catch(Tt){return Ae(Tt)}const zt={};if(ft){const Tt=S(He);Tt&&(zt.resourceTiming={},zt.resourceTiming[Se.source]=JSON.parse(JSON.stringify(Tt)))}Ae(null,zt)}})}reloadTile(Se,Ae){const He=this.loaded;return He&&He[Se.uid]?Se.partial?Ae(null,void 0):super.reloadTile(Se,Ae):this.loadTile(Se,Ae)}loadGeoJSON(Se,Ae){if(Se.request)o.n(Se.request,Ae);else{if(typeof Se.data!="string")return Ae(new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`));try{return Ae(null,JSON.parse(Se.data))}catch{return Ae(new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Se,Ae){try{Ae(null,this._geoJSONIndex.getClusterExpansionZoom(Se.clusterId))}catch(He){Ae(He)}}getClusterChildren(Se,Ae){try{Ae(null,this._geoJSONIndex.getChildren(Se.clusterId))}catch(He){Ae(He)}}getClusterLeaves(Se,Ae){try{Ae(null,this._geoJSONIndex.getLeaves(Se.clusterId,Se.limit,Se.offset))}catch(He){Ae(He)}}}class Oo{constructor(Se,Ae){this.tileID=new o.aA(Se.tileID.overscaledZ,Se.tileID.wrap,Se.tileID.canonical.z,Se.tileID.canonical.x,Se.tileID.canonical.y),this.tileZoom=Se.tileZoom,this.uid=Se.uid,this.zoom=Se.zoom,this.canonical=Se.tileID.canonical,this.pixelRatio=Se.pixelRatio,this.tileSize=Se.tileSize,this.source=Se.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Se.projection,this.brightness=Ae}parse(Se,Ae,He,ft){this.status="parsing";const tt=new o.aA(He.tileID.overscaledZ,He.tileID.wrap,He.tileID.canonical.z,He.tileID.canonical.x,He.tileID.canonical.y),bt=[],zt=Ae.familiesBySource[He.source],Tt=new o.dR(tt,He.promoteId);return Tt.bucketLayerIDs=[],Tt.is3DTile=!0,o.e0(Se).then(Ft=>{if(!Ft)return ft(new Error("Could not parse tile"));const Kt=o.e1(Ft,1/o.c9(He.tileID.canonical)),Zt=Ft.json.extensionsUsed&&Ft.json.extensionsUsed.includes("MAPBOX_mesh_features")||Ft.json.asset.extras&&Ft.json.asset.extras.MAPBOX_mesh_features,pt=Ft.json.extensionsUsed&&Ft.json.extensionsUsed.includes("EXT_meshopt_compression"),Ht=new o.a3(this.zoom,{brightness:this.brightness});for(const bn in zt)for(const Yn of zt[bn]){const ro=Yn[0];Tt.bucketLayerIDs.push(Yn.map(ao=>o.av(ao.id,ao.scope))),ro.recalculate(Ht,[]);const po=new o.e2(Yn,Kt,tt,Zt,pt,this.brightness,Tt);Zt||(po.needsUpload=!0),bt.push(po),po.evaluate(ro)}this.status="done",ft(null,{buckets:bt,featureIndex:Tt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Ft=>ft(new Error(Ft.message)))}}class _i{constructor(Se,Ae,He,ft,tt,bt){this.actor=Se,this.layerIndex=Ae,this.availableImages=He,this.brightness=bt,this.loading={},this.loaded={}}loadTile(Se,Ae){const He=Se.uid,ft=this.loading[He]=new Oo(Se,this.brightness);o.bd(Se.request,(tt,bt)=>{const zt=!this.loading[He];return delete this.loading[He],zt||tt?(ft.status="done",zt||(this.loaded[He]=ft),Ae(tt)):bt&&bt.byteLength!==0?void ft.parse(bt,this.layerIndex,Se,(Tt,Ft)=>{ft.status="done",this.loaded=this.loaded||{},this.loaded[He]=ft,Tt||!Ft?Ae(Tt):Ae(null,Ft)}):(ft.status="done",this.loaded[He]=ft,Ae())})}reloadTile(Se,Ae){const He=this.loaded,ft=Se.uid;if(He&&He[ft]){const tt=He[ft];tt.projection=Se.projection,tt.brightness=Se.brightness;const bt=(zt,Tt)=>{tt.reloadCallback&&(delete tt.reloadCallback,this.loadTile(Se,Ae)),Ae(zt,Tt)};tt.status==="parsing"?tt.reloadCallback=bt:tt.status==="done"&&this.loadTile(Se,Ae)}}abortTile(Se,Ae){const He=Se.uid;this.loading[He]&&delete this.loading[He],Ae()}removeTile(Se,Ae){const He=this.loaded,ft=Se.uid;He&&He[ft]&&delete He[ft],Ae()}}class ya{constructor(Se){this.self=Se,this.actor=new o.e3(Se,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.bM({name:"mercator"}),this.workerSourceTypes={vector:W,geojson:Rr,"batched-model":_i},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ae,He)=>{if(this.workerSourceTypes[Ae])throw new Error(`Worker source with name "${Ae}" already registered.`);this.workerSourceTypes[Ae]=He},this.self.registerRTLTextPlugin=Ae=>{if(o.e4.isParsed())throw new Error("RTL text plugin already registered.");o.e4.applyArabicShaping=Ae.applyArabicShaping,o.e4.processBidirectionalText=Ae.processBidirectionalText,o.e4.processStyledBidirectionalText=Ae.processStyledBidirectionalText}}clearCaches(Se,Ae,He){delete this.layerIndexes[Se],delete this.availableImages[Se],delete this.workerSources[Se],delete this.demWorkerSources[Se],delete this.rasterArrayWorkerSource,He()}checkIfReady(Se,Ae,He){He()}setReferrer(Se,Ae){this.referrer=Ae}spriteLoaded(Se,{scope:Ae,isLoaded:He}){if(this.isSpriteLoaded[Se]||(this.isSpriteLoaded[Se]={}),this.isSpriteLoaded[Se][Ae]=He,this.workerSources[Se]&&this.workerSources[Se][Ae])for(const ft in this.workerSources[Se][Ae]){const tt=this.workerSources[Se][Ae][ft];for(const bt in tt){const zt=tt[bt];zt instanceof W&&(zt.isSpriteLoaded=He,zt.fire(new o.x("isSpriteLoaded")))}}}setImages(Se,{scope:Ae,images:He},ft){if(this.availableImages[Se]||(this.availableImages[Se]={}),this.availableImages[Se][Ae]=He,this.workerSources[Se]&&this.workerSources[Se][Ae]){for(const tt in this.workerSources[Se][Ae]){const bt=this.workerSources[Se][Ae][tt];for(const zt in bt)bt[zt].availableImages=He}ft()}else ft()}setProjection(Se,Ae){this.projections[Se]=o.bM(Ae)}setBrightness(Se,Ae,He){this.brightness=Ae,He()}setLayers(Se,Ae,He){this.getLayerIndex(Se,Ae.scope).replace(Ae.layers,Ae.options),He()}updateLayers(Se,Ae,He){this.getLayerIndex(Se,Ae.scope).update(Ae.layers,Ae.removedIds,Ae.options),He()}loadTile(Se,Ae,He){Ae.projection=this.projections[Se]||this.defaultProjection,this.getWorkerSource(Se,Ae.type,Ae.source,Ae.scope).loadTile(Ae,He)}loadDEMTile(Se,Ae,He){this.getDEMWorkerSource(Se,Ae.source,Ae.scope).loadTile(Ae,He)}decodeRasterArray(Se,Ae,He){this.getRasterArrayWorkerSource().decodeRasterArray(Ae,He)}reloadTile(Se,Ae,He){Ae.projection=this.projections[Se]||this.defaultProjection,this.getWorkerSource(Se,Ae.type,Ae.source,Ae.scope).reloadTile(Ae,He)}abortTile(Se,Ae,He){this.getWorkerSource(Se,Ae.type,Ae.source,Ae.scope).abortTile(Ae,He)}removeTile(Se,Ae,He){this.getWorkerSource(Se,Ae.type,Ae.source,Ae.scope).removeTile(Ae,He)}removeSource(Se,Ae,He){if(!(this.workerSources[Se]&&this.workerSources[Se][Ae.scope]&&this.workerSources[Se][Ae.scope][Ae.type]&&this.workerSources[Se][Ae.scope][Ae.type][Ae.source]))return;const ft=this.workerSources[Se][Ae.scope][Ae.type][Ae.source];delete this.workerSources[Se][Ae.scope][Ae.type][Ae.source],ft.removeSource!==void 0?ft.removeSource(Ae,He):He()}loadWorkerSource(Se,Ae,He){try{this.self.importScripts(Ae.url),He()}catch(ft){He(ft.toString())}}syncRTLPluginState(Se,Ae,He){try{o.e4.setState(Ae);const ft=o.e4.getPluginURL();if(o.e4.isLoaded()&&!o.e4.isParsed()&&ft!=null){this.self.importScripts(ft);const tt=o.e4.isParsed();He(tt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ft}`),tt)}}catch(ft){He(ft.toString())}}setDracoUrl(Se,Ae){this.dracoUrl=Ae}getAvailableImages(Se,Ae){this.availableImages[Se]||(this.availableImages[Se]={});let He=this.availableImages[Se][Ae];return He||(He=[]),He}getLayerIndex(Se,Ae){this.layerIndexes[Se]||(this.layerIndexes[Se]={});let He=this.layerIndexes[Se][Ae];return He||(He=this.layerIndexes[Se][Ae]=new R,He.scope=Ae),He}getWorkerSource(Se,Ae,He,ft){return this.workerSources[Se]||(this.workerSources[Se]={}),this.workerSources[Se][ft]||(this.workerSources[Se][ft]={}),this.workerSources[Se][ft][Ae]||(this.workerSources[Se][ft][Ae]={}),this.isSpriteLoaded[Se]||(this.isSpriteLoaded[Se]={}),this.workerSources[Se][ft][Ae][He]||(this.workerSources[Se][ft][Ae][He]=new this.workerSourceTypes[Ae]({send:(tt,bt,zt,Tt,Ft,Kt)=>{this.actor.send(tt,bt,zt,Se,Ft,Kt)},scheduler:this.actor.scheduler},this.getLayerIndex(Se,ft),this.getAvailableImages(Se,ft),this.isSpriteLoaded[Se][ft],void 0,this.brightness)),this.workerSources[Se][ft][Ae][He]}getDEMWorkerSource(Se,Ae,He){return this.demWorkerSources[Se]||(this.demWorkerSources[Se]={}),this.demWorkerSources[Se][He]||(this.demWorkerSources[Se][He]={}),this.demWorkerSources[Se][He][Ae]||(this.demWorkerSources[Se][He][Ae]=new U),this.demWorkerSources[Se][He][Ae]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new re),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Se,Ae){o.e5(Ae)}getWorkerPerformanceMetrics(Se,Ae,He){He(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ya(self)),ya}),g(["./shared"],function(o){var S="3.8.0";const E={create:"create",load:"load",fullLoad:"fullLoad"},I={mark(f){performance.mark(f)},measure(f,r,l){performance.measure(f,r,l)}};function R(f){const r=f.name.split("?")[0];return o.a(r)&&r.includes("mapbox-gl.js")?"javascript":o.a(r)&&r.includes("mapbox-gl.css")?"css":o.b(r)?"fontRange":o.c(r)?"sprite":o.i(r)?"style":o.d(r)?"tilejson":"other"}var z,N={},$=function(){if(z)return N;function f(p){return!r(p)}function r(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,C,O=new Blob([""],{type:"text/javascript"}),V=URL.createObjectURL(O);try{C=new Worker(V),w=!0}catch{w=!1}return C&&C.terminate(),URL.revokeObjectURL(V),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var C=w.getContext("2d");if(!C)return!1;var O=C.getImageData(0,0,1,1);return O&&O.width===w.width}()?(l[b=p&&p.failIfMajorPerformanceCaveat]===void 0&&(l[b]=function(w){var C,O=function(V){var G=document.createElement("canvas"),j=Object.create(f.webGLContextAttributes);return j.failIfMajorPerformanceCaveat=V,G.getContext("webgl2",j)}(w);if(!O)return!1;try{C=O.createShader(O.VERTEX_SHADER)}catch{return!1}return!(!C||O.isContextLost())&&(O.shaderSource(C,"void main() {}"),O.compileShader(C),O.getShaderParameter(C,O.COMPILE_STATUS)===!0)}(b)),l[b]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var b}z=1,N.supported=f,N.notSupportedReason=r;var l={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},N}();function F(f,r,l){const p=document.createElement(f);return r!=null&&(p.className=r),l&&l.appendChild(p),p}function W(f,r,l){const p=document.createElementNS("http://www.w3.org/2000/svg",f);for(const b of Object.keys(r))p.setAttributeNS(null,b,String(r[b]));return l&&l.appendChild(p),p}const U=typeof document<"u"?document.documentElement&&document.documentElement.style:null,re=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let K;function q(){U&&re&&(K=U[re],U[re]="none")}function J(){U&&re&&(U[re]=K)}function oe(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",oe,!0)}function ae(){window.addEventListener("click",oe,!0),window.setTimeout(()=>{window.removeEventListener("click",oe,!0)},0)}function fe(f,r){const l=f.getBoundingClientRect();return de(f,l,r)}function ge(f,r){const l=f.getBoundingClientRect(),p=[];for(let b=0;b<r.length;b++)p.push(de(f,l,r[b]));return p}function ce(f){return window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function de(f,r,l){const p=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new o.P((l.clientX-r.left)*p,(l.clientY-r.top)*p)}const _e="01",Re="NO_ACCESS_TOKEN";class Qe{constructor(r,l,p){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let p=0;p<10;p++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_e,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!o.f(r))return r;const p=ye(r);return p.params.push(`sdk=js-${S}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!o.f(r))return r;const p=ye(r);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeModelURL(r,l){if(!o.f(r))return r;const p=ye(r);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeSourceURL(r,l,p,b){if(!o.f(r))return r;const w=ye(r);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),p&&w.params.push(`language=${p}`),b&&w.params.push(`worldview=${b}`),this._makeAPIURL(w,this._customAccessToken||l)}normalizeSpriteURL(r,l,p,b){const w=ye(r);return o.f(r)?(w.path=`/styles/v1${w.path}/sprite${l}${p}`,this._makeAPIURL(w,this._customAccessToken||b)):(w.path+=`${l}${p}`,Me(w))}normalizeTileURL(r,l,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!o.f(r))return r;const b=ye(r);b.path=b.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||p&&b.authority!=="raster"&&p===512?"@2x":""}${o.m.supported?".webp":"$1"}`),b.authority==="raster"?b.path=`/${o.e.RASTER_URL_PREFIX}${b.path}`:b.authority==="rasterarrays"?b.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${b.path}`:b.authority==="3dtiles"?b.path=`/${o.e.TILES3D_URL_PREFIX}${b.path}`:(b.path=b.path.replace(/^.+\/v4\//,"/"),b.path=`/${o.e.TILE_URL_VERSION}${b.path}`);const w=this._customAccessToken||function(C){for(const O of C){const V=O.match(/^access_token=(.*)$/);if(V)return V[1]}return null}(b.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&b.params.push(`sku=${this._skuToken}`),this._makeAPIURL(b,w)}canonicalizeTileURL(r,l){const p=ye(r);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return r;let b="mapbox://";p.path.match(/^\/raster\/v1\//)?b+=`raster/${p.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?b+=`rasterarrays/${p.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:b+=`tiles/${p.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let w=p.params;return l&&(w=w.filter(C=>!C.match(/^access_token=/))),w.length&&(b+=`?${w.join("&")}`),b}canonicalizeTileset(r,l){const p=!!l&&o.f(l),b=[];for(const w of r.tiles||[])o.h(w)?b.push(this.canonicalizeTileURL(w,p)):b.push(w);return b}_makeAPIURL(r,l){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",b=ye(o.e.API_URL);if(r.protocol=b.protocol,r.authority=b.authority,r.protocol==="http"){const w=r.params.indexOf("secure");w>=0&&r.params.splice(w,1)}if(b.path!=="/"&&(r.path=`${b.path}${r.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return Me(r);if(l=l||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return r.params=r.params.filter(w=>w.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Me(r)}}const Ee=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ye(f){const r=f.match(Ee);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Me(f){const r=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${r}`}const Te="mapbox.eventData";function he(f){if(!f)return null;const r=f.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(o.j(r[1]))}catch{return null}}class ke{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=he(o.e.ACCESS_TOKEN);let p="";return p=l&&l.u?o.k(l.u):o.e.ACCESS_TOKEN||"",r?`${Te}.${r}:${p}`:`${Te}:${p}`}fetchEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{const b=localStorage.getItem(l);b&&(this.eventData=JSON.parse(b));const w=localStorage.getItem(p);w&&(this.anonId=w)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid"),b=this.anonId;if(r&&b)try{localStorage.setItem(p,b),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,p,b){if(!o.e.EVENTS_URL)return;const w=ye(o.e.EVENTS_URL);w.params.push(`access_token=${b||o.e.ACCESS_TOKEN||""}`);const C={event:this.type,created:new Date(r).toISOString()},O=l?o.l(C,l):C,V={url:Me(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([O])};this.pendingRequest=o.p(V,G=>{this.pendingRequest=null,p(G),this.saveEventData(),this.processRequests(b)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const Ne=new class extends ke{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,r){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(l=>o.f(l)||o.h(l))&&this.queueRequest(Date.now(),r)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=he(o.e.ACCESS_TOKEN),l=r?r.u:o.e.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),p=!0);const b=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),C=new Date(b),O=(b-this.eventData.lastSuccess)/864e5;p=p||O>=1||O<-1||w.getDate()!==C.getDate()}else p=!0;p?this.postEvent(b,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:_e,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=b,this.eventData.tokenU=l)},f):this.processRequests()}},nt=Ne.postTurnstileEvent.bind(Ne),De=new class extends ke{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,r,l,p){this.skuToken=r,this.errorCb=p,o.e.EVENTS_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(Re)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:_e,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f))}remove(){this.errorCb=null}},Ct=De.postMapLoadEvent.bind(De),Rt=new class extends ke{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let r=this.mapInstanceIdMap.get(f);return r||(r=o.u(),this.mapInstanceIdMap.set(f,r)),r}getEventId(f){const r=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,r+1),r}postStyleLoadEvent(f,r){const{map:l,style:p,importedStyles:b}=r;if(!o.e.EVENTS_URL||!f&&!o.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(l),C={mapInstanceId:w,eventId:this.getEventId(w),style:p};b.length&&(C.importedStyles=b),this.queueRequest({timestamp:Date.now(),payload:C},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},f)}},Bt=Rt.postStyleLoadEvent.bind(Rt),mt=new class extends ke{constructor(){super("gljs.performance")}postPerformanceEvent(f,r){o.e.EVENTS_URL&&(f||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),p=function(b){const w=performance.getEntriesByType("resource"),C=performance.getEntriesByType("mark"),O=function(ie){const ve={};if(ie){for(const me in ie)if(me!=="other")for(const we of ie[me]){const be=`${me}ResolveRangeMin`,Pe=`${me}ResolveRangeMax`,$e=`${me}RequestCount`,Ve=`${me}RequestCachedCount`;ve[be]=Math.min(ve[be]||1/0,we.startTime),ve[Pe]=Math.max(ve[Pe]||-1/0,we.responseEnd);const We=Xe=>{ve[Xe]===void 0&&(ve[Xe]=0),++ve[Xe]};we.transferSize!==void 0&&we.transferSize===0&&We(Ve),We($e)}}return ve}(function(ie,ve){const me={};if(ie)for(const we of ie){const be=ve(we);me[be]===void 0&&(me[be]=[]),me[be].push(we)}return me}(w,R)),V=window.devicePixelRatio,G=navigator.connection||navigator.mozConnection||navigator.webkitConnection,j=G?G.effectiveType:void 0,Y={counters:[],metadata:[],attributes:[]},Q=(ie,ve,me)=>{me!=null&&ie.push({name:ve,value:me.toString()})};for(const ie in O)Q(Y.counters,ie,O[ie]);if(b.interactionRange[0]!==1/0&&b.interactionRange[1]!==-1/0&&(Q(Y.counters,"interactionRangeMin",b.interactionRange[0]),Q(Y.counters,"interactionRangeMax",b.interactionRange[1])),C)for(const ie of Object.keys(E)){const ve=E[ie],me=C.find(we=>we.name===ve);me&&Q(Y.counters,ve,me.startTime)}return Q(Y.counters,"visibilityHidden",b.visibilityHidden),Q(Y.attributes,"style",function(ie){if(ie)for(const ve of ie){const me=ve.name.split("?")[0];if(o.i(me)){const we=me.split("/").slice(-2);if(we.length===2)return`mapbox://styles/${we[0]}/${we[1]}`}}}(w)),Q(Y.attributes,"terrainEnabled",b.terrainEnabled?"true":"false"),Q(Y.attributes,"fogEnabled",b.fogEnabled?"true":"false"),Q(Y.attributes,"projection",b.projection),Q(Y.attributes,"zoom",b.zoom),Q(Y.metadata,"devicePixelRatio",V),Q(Y.metadata,"connectionEffectiveType",j),Q(Y.metadata,"navigatorUserAgent",navigator.userAgent),Q(Y.metadata,"screenWidth",window.screen.width),Q(Y.metadata,"screenHeight",window.screen.height),Q(Y.metadata,"windowWidth",window.innerWidth),Q(Y.metadata,"windowHeight",window.innerHeight),Q(Y.metadata,"mapWidth",b.width/V),Q(Y.metadata,"mapHeight",b.height/V),Q(Y.metadata,"webglRenderer",b.renderer),Q(Y.metadata,"webglVendor",b.vendor),Q(Y.metadata,"sdkVersion",S),Q(Y.metadata,"sdkIdentifier","mapbox-gl-js"),Y}(l);for(const b of p.metadata);for(const b of p.counters);for(const b of p.attributes);this.postEvent(r,p,()=>{},f)}},Gt=mt.postPerformanceEvent.bind(mt),jt=new class extends ke{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,r,l,p){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const b=ye(o.e.API_URL+o.e.SESSION_PATH);b.params.push(`sku=${r||""}`),b.params.push(`access_token=${p||o.e.ACCESS_TOKEN||""}`);const w={url:Me(b),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(w,C=>{this.pendingRequest=null,l(C),this.saveEventData(),this.processRequests(p)})}getSessionAPI(f,r,l,p){this.skuToken=r,this.errorCb=p,o.e.SESSION_PATH&&o.e.API_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(Re)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f)}remove(){this.errorCb=null}},Be=jt.getSessionAPI.bind(jt),an=new Set;function At(f,r){r?an.add(f):an.delete(f)}class Ge{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Fe(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class Nt extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new o.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:p,callback:b}of this.requestors)this._notify(p,l,b);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,p){this._validate(r,p)&&(this.images[l][r]=p)}_validate(r,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,l){if(!r)return!0;let p=0;for(const b of r){if(b[0]<p||b[1]<b[0]||l<b[1])return!1;p=b[1]}return!0}_validateContent(r,l){return!(r&&(r.length!==4||r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,l,p){p.version=this.images[l][r].version+1,this.images[l][r]=p,this.updatedImages[l][r]=!0}removeImage(r,l){const p=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,p){let b=!0;const w=!!this.loaded[l];if(!w)for(const C of r)this.images[l][C]||(b=!1);w||b?this._notify(r,l,p):this.requestors.push({ids:r,scope:l,callback:p})}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,p){const b={};for(const w of r){this.images[l][w]||this.fire(new o.x("styleimagemissing",{id:w}));const C=this.images[l][w];C?b[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:o.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,b)}getPixelSize(r){const{width:l,height:p}=this.atlasImage[r];return{width:l,height:p}}getPattern(r,l,p){const b=this.patterns[l][r],w=this.getImage(r,l);if(!w)return null;if(b&&b.position.version===w.version)return b.position;if(b)b.position.version=w.version;else{const C={w:w.data.width+2*o.y,h:w.data.height+2*o.y,x:0,y:0},O=new o.I(C,w,o.y);this.patterns[l][r]={bin:C,position:O}}return this._updatePatternAtlas(l,p),this.patterns[l][r].position}bind(r,l){const p=r.gl;let b=this.atlasTexture[l];b?this.dirty&&(b.update(this.atlasImage[l]),this.dirty=!1):(b=new o.T(r,this.atlasImage[l],p.RGBA8),this.atlasTexture[l]=b),b.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const p=[];for(const O in this.patterns[r])p.push(this.patterns[r][O].bin);const{w:b,h:w}=o.z(p),C=this.atlasImage[r];C.resize({width:b||1,height:w||1});for(const O in this.patterns[r]){const{bin:V,position:G}=this.patterns[r][O];let j=G.padding;const Y=V.x+j,Q=V.y+j,ie=this.images[r][O].data,ve=ie.width,me=ie.height;j=j>1?j-1:j,o.r.copy(ie,C,{x:0,y:0},{x:Y,y:Q},{width:ve,height:me},l),o.r.copy(ie,C,{x:0,y:me-j},{x:Y,y:Q-j},{width:ve,height:j},l),o.r.copy(ie,C,{x:0,y:0},{x:Y,y:Q+me},{width:ve,height:j},l),o.r.copy(ie,C,{x:ve-j,y:0},{x:Y-j,y:Q},{width:j,height:me},l),o.r.copy(ie,C,{x:0,y:0},{x:Y+ve,y:Q},{width:j,height:me},l),o.r.copy(ie,C,{x:ve-j,y:me-j},{x:Y-j,y:Q-j},{width:j,height:j},l),o.r.copy(ie,C,{x:0,y:me-j},{x:Y+ve,y:Q-j},{width:j,height:j},l),o.r.copy(ie,C,{x:0,y:0},{x:Y+ve,y:Q+me},{width:j,height:j},l),o.r.copy(ie,C,{x:ve-j,y:0},{x:Y-j,y:Q+me},{width:j,height:j},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const p of r){if(this.callbackDispatchedThisFrame[l][p])continue;this.callbackDispatchedThisFrame[l][p]=!0;const b=this.images[l][p];Fe(b)&&this.updateImage(p,l,b)}}}function Jt(f){const r=f.key,l=f.value,p=f.valueSpec||{},b=f.objectElementValidators||{},w=f.style,C=f.styleSpec;let O=[];const V=o.B(l);if(V!=="object")return[new o.V(r,l,`object expected, ${V} found`)];for(const G in l){const j=G.split(".")[0];let Y;b[j]?Y=b[j]:p[j]?Y=Mn:b["*"]?Y=b["*"]:p["*"]&&(Y=Mn),Y?O=O.concat(Y({key:(r&&`${r}.`)+G,value:l[G],valueSpec:p[j]||p["*"],style:w,styleSpec:C,object:l,objectKey:G},l)):O.push(new o.A(r,l[G],`unknown property "${G}"`))}for(const G in p)b[G]||p[G].required&&p[G].default===void 0&&l[G]===void 0&&O.push(new o.V(r,l,`missing required property "${G}"`));return O}function Dt(f){const r=f.value,l=f.valueSpec,p=f.style,b=f.styleSpec,w=f.key,C=f.arrayElementValidator||Mn;if(o.B(r)!=="array")return[new o.V(w,r,`array expected, ${o.B(r)} found`)];if(l.length&&r.length!==l.length)return[new o.V(w,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new o.V(w,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let O={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};b.$version<7&&(O.function=l.function),o.B(l.value)==="object"&&(O=l.value);let V=[];for(let G=0;G<r.length;G++)V=V.concat(C({array:r,arrayIndex:G,value:r[G],valueSpec:O,style:p,styleSpec:b,key:`${w}[${G}]`},!0));return V}function xt(f){const r=f.key,l=f.value,p=f.valueSpec;let b=o.B(l);if(b==="number"&&l!=l&&(b="NaN"),b!=="number")return[new o.V(r,l,`number expected, ${b} found`)];if("minimum"in p){let w=p.minimum;if(o.B(p.minimum)==="array"&&(w=p.minimum[f.arrayIndex]),l<w)return[new o.V(r,l,`${l} is less than the minimum value ${w}`)]}if("maximum"in p){let w=p.maximum;if(o.B(p.maximum)==="array"&&(w=p.maximum[f.arrayIndex]),l>w)return[new o.V(r,l,`${l} is greater than the maximum value ${w}`)]}return[]}function Ot(f){const r=f.valueSpec,l=o.D(f.value.type);let p,b,w,C={};const O=l!=="categorical"&&f.value.property===void 0,V=!O,G=o.B(f.value.stops)==="array"&&o.B(f.value.stops[0])==="array"&&o.B(f.value.stops[0][0])==="object",j=Jt({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ie){if(l==="identity")return[new o.V(ie.key,ie.value,'identity function may not have a "stops" property')];let ve=[];const me=ie.value;return ve=ve.concat(Dt({key:ie.key,value:me,valueSpec:ie.valueSpec,style:ie.style,styleSpec:ie.styleSpec,arrayElementValidator:Y})),o.B(me)==="array"&&me.length===0&&ve.push(new o.V(ie.key,me,"array must have at least one stop")),ve},default:function(ie){return Mn({key:ie.key,value:ie.value,valueSpec:r,style:ie.style,styleSpec:ie.styleSpec})}}});return l==="identity"&&O&&j.push(new o.V(f.key,f.value,'missing required property "property"')),l==="identity"||f.value.stops||j.push(new o.V(f.key,f.value,'missing required property "stops"')),l==="exponential"&&f.valueSpec.expression&&!o.F(f.valueSpec)&&j.push(new o.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(V&&!o.G(f.valueSpec)?j.push(new o.V(f.key,f.value,"property functions not supported")):O&&!o.H(f.valueSpec)&&j.push(new o.V(f.key,f.value,"zoom functions not supported"))),l!=="categorical"&&!G||f.value.property!==void 0||j.push(new o.V(f.key,f.value,'"property" property is required')),j;function Y(ie){let ve=[];const me=ie.value,we=ie.key;if(o.B(me)!=="array")return[new o.V(we,me,`array expected, ${o.B(me)} found`)];if(me.length!==2)return[new o.V(we,me,`array length 2 expected, length ${me.length} found`)];if(G){if(o.B(me[0])!=="object")return[new o.V(we,me,`object expected, ${o.B(me[0])} found`)];if(me[0].zoom===void 0)return[new o.V(we,me,"object stop key must have zoom")];if(me[0].value===void 0)return[new o.V(we,me,"object stop key must have value")];const be=o.D(me[0].zoom);if(typeof be!="number")return[new o.V(we,me[0].zoom,"stop zoom values must be numbers")];if(w&&w>be)return[new o.V(we,me[0].zoom,"stop zoom values must appear in ascending order")];be!==w&&(w=be,b=void 0,C={}),ve=ve.concat(Jt({key:`${we}[0]`,value:me[0],valueSpec:{zoom:{}},style:ie.style,styleSpec:ie.styleSpec,objectElementValidators:{zoom:xt,value:Q}}))}else ve=ve.concat(Q({key:`${we}[0]`,value:me[0]},me));return o.J(o.K(me[1]))?ve.concat([new o.V(`${we}[1]`,me[1],"expressions are not allowed in function stops.")]):ve.concat(Mn({key:`${we}[1]`,value:me[1],valueSpec:r,style:ie.style,styleSpec:ie.styleSpec}))}function Q(ie,ve){const me=o.B(ie.value),we=o.D(ie.value),be=ie.value!==null?ie.value:ve;if(p){if(me!==p)return[new o.V(ie.key,be,`${me} stop domain type must match previous stop domain type ${p}`)]}else p=me;if(me!=="number"&&me!=="string"&&me!=="boolean"&&typeof we!="number"&&typeof we!="string"&&typeof we!="boolean")return[new o.V(ie.key,be,"stop domain value must be a number, string, or boolean")];if(me!=="number"&&l!=="categorical"){let Pe=`number expected, ${me} found`;return o.G(r)&&l===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(ie.key,be,Pe)]}return l!=="categorical"||me!=="number"||typeof we=="number"&&isFinite(we)&&Math.floor(we)===we?l!=="categorical"&&me==="number"&&typeof we=="number"&&typeof b=="number"&&b!==void 0&&we<b?[new o.V(ie.key,be,"stop domain values must appear in ascending order")]:(b=we,l==="categorical"&&we in C?[new o.V(ie.key,be,"stop domain values must be unique")]:(C[we]=!0,[])):[new o.V(ie.key,be,`integer expected, found ${String(we)}`)]}}function en(f){const r=(f.expressionContext==="property"?o.L:o.M)(o.K(f.value),f.valueSpec);if(r.result==="error")return r.value.map(p=>new o.V(`${f.key}${p.key}`,f.value,p.message));const l=r.value.expression||r.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!l.outputDefined())return[new o.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!o.N(l))return[new o.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return dn(l,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!o.O(l,["zoom","feature-state"]))return[new o.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!o.Q(l))return[new o.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dn(f,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const b of r.valueSpec.expression.parameters)l.delete(b);if(l.size===0)return[];const p=[];return f instanceof o.S&&l.has(f.name)?[new o.V(r.key,r.value,`["${f.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(f.eachChild(b=>{p.push(...dn(b,r))}),p)}function un(f){const r=f.key,l=f.value,p=f.valueSpec,b=[];return Array.isArray(p.values)?p.values.indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),b}function Pn(f){return o.W(o.K(f.value))?en(o.C({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):gt(f)}function gt(f){const r=f.value,l=f.key;if(o.B(r)!=="array")return[new o.V(l,r,`array expected, ${o.B(r)} found`)];const p=f.styleSpec;let b,w=[];if(r.length<1)return[new o.V(l,r,"filter array must have at least 1 element")];switch(w=w.concat(un({key:`${l}[0]`,value:r[0],valueSpec:p.filter_operator})),o.D(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&o.D(r[1])==="$type"&&w.push(new o.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&w.push(new o.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(b=o.B(r[1]),b!=="string"&&w.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`)));for(let C=2;C<r.length;C++)b=o.B(r[C]),o.D(r[1])==="$type"?w=w.concat(un({key:`${l}[${C}]`,value:r[C],valueSpec:p.geometry_type})):b!=="string"&&b!=="number"&&b!=="boolean"&&w.push(new o.V(`${l}[${C}]`,r[C],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let C=1;C<r.length;C++)w=w.concat(gt({key:`${l}[${C}]`,value:r[C],styleSpec:f.styleSpec}));break;case"has":case"!has":b=o.B(r[1]),r.length!==2?w.push(new o.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):b!=="string"&&w.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`))}return w}function Sn(f,r){const l=f.key,p=f.style,b=f.layer,w=f.styleSpec,C=f.value,O=f.objectKey,V=w[`${r}_${f.layerType}`];if(!V)return[];const G=O.match(/^(.*)-transition$/);if(r==="paint"&&G&&V[G[1]]&&V[G[1]].transition)return Mn({key:l,value:C,valueSpec:w.transition,style:p,styleSpec:w});const j=f.valueSpec||V[O];if(!j)return[new o.A(l,C,`unknown property "${O}"`)];let Y;if(o.B(C)==="string"&&o.G(j)&&!j.tokens&&(Y=/^{([^}]+)}$/.exec(C))){const ie=`\`{ "type": "identity", "property": ${Y?JSON.stringify(Y[1]):'"_"'} }\``;return[new o.V(l,C,`"${O}" does not support interpolation syntax
Use an identity property function instead: ${ie}.`)]}const Q=[];if(f.layerType==="symbol")O!=="text-field"||!p||p.glyphs||p.imports||Q.push(new o.V(l,C,'use of "text-field" requires a style "glyphs" property')),O==="text-font"&&o.X(o.K(C))&&o.D(C.type)==="identity"&&Q.push(new o.V(l,C,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&r==="paint"&&b&&b.layout&&b.layout.hasOwnProperty("model-id")&&o.G(j)&&(o.Y(j)||o.H(j))){const ie=o.L(o.K(C),j),ve=ie.value.expression||ie.value._styleExpression.expression;ve&&!o.O(ve,["measure-light"])&&(O==="model-emissive-strength"&&o.Q(ve)&&o.N(ve)||Q.push(new o.V(l,C,`${O} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Q.concat(Mn({key:f.key,value:C,valueSpec:j,style:p,styleSpec:w,expressionContext:"property",propertyType:r,propertyKey:O}))}function Vn(f){return Sn(f,"paint")}function lo(f){return Sn(f,"layout")}function eo(f){let r=[];const l=f.value,p=f.key,b=f.style,w=f.styleSpec;l.type||l.ref||r.push(new o.V(p,l,'either "type" or "ref" is required'));let C=o.D(l.type);const O=o.D(l.ref);if(l.id){const V=o.D(l.id);for(let G=0;G<f.arrayIndex;G++){const j=b.layers[G];o.D(j.id)===V&&r.push(new o.V(p,l.id,`duplicate layer id "${l.id}", previously used at line ${j.id.__line__}`))}}if("ref"in l){let V;["type","source","source-layer","filter","layout"].forEach(G=>{G in l&&r.push(new o.V(p,l[G],`"${G}" is prohibited for ref layers`))}),b.layers.forEach(G=>{o.D(G.id)===O&&(V=G)}),V?V.ref?r.push(new o.V(p,l.ref,"ref cannot reference another ref layer")):C=o.D(V.type):typeof O=="string"&&r.push(new o.V(p,l.ref,`ref layer "${O}" not found`))}else if(C!=="background"&&C!=="sky"&&C!=="slot")if(l.source){const V=b.sources&&b.sources[l.source],G=V&&o.D(V.type);V?G==="vector"&&C==="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a raster source`)):G==="raster"&&C!=="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a vector source`)):G!=="vector"||l["source-layer"]?G==="raster-dem"&&C!=="hillshade"?r.push(new o.V(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):G!=="raster-array"||["raster","raster-particle"].includes(C)?C!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||G==="geojson"&&V.lineMetrics?C==="raster-particle"&&G!=="raster-array"&&r.push(new o.V(p,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new o.V(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new o.V(p,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new o.V(p,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new o.V(p,l.source,`source "${l.source}" not found`))}else r.push(new o.V(p,l,'missing required property "source"'));return r=r.concat(Jt({key:p,value:l,valueSpec:w.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Mn({key:`${p}.type`,value:l.type,valueSpec:w.layer.type,style:f.style,styleSpec:f.styleSpec,object:l,objectKey:"type"}),filter:V=>Pn(o.C({layerType:C},V)),layout:V=>Jt({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":G=>lo(o.C({layerType:C},G))}}),paint:V=>Jt({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":G=>Vn(o.C({layerType:C,layer:l},G))}})}})),r}function fo(f){const r=f.value,l=f.key,p=o.B(r);return p!=="string"?[new o.V(l,r,`string expected, ${p} found`)]:[]}const Lo={promoteId:function({key:f,value:r}){if(o.B(r)==="string")return fo({key:f,value:r});{const l=[];for(const p in r)l.push(...fo({key:`${f}.${p}`,value:r[p]}));return l}}};function er(f){const r=f.value,l=f.key,p=f.styleSpec,b=f.style;if(!r.type)return[new o.V(l,r,'"type" is required')];const w=o.D(r.type);let C=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(r.url||r.tiles||C.push(new o.A(l,r,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return C=C.concat(Jt({key:l,value:r,valueSpec:p[`source_${w.replace("-","_")}`],style:f.style,styleSpec:p,objectElementValidators:Lo})),C;case"geojson":if(C=Jt({key:l,value:r,valueSpec:p.source_geojson,style:b,styleSpec:p,objectElementValidators:Lo}),r.cluster)for(const O in r.clusterProperties){const[V,G]=r.clusterProperties[O],j=typeof V=="string"?[V,["accumulated"],["get",O]]:V;C.push(...en({key:`${l}.${O}.map`,value:G,expressionContext:"cluster-map"})),C.push(...en({key:`${l}.${O}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return C;case"video":return Jt({key:l,value:r,valueSpec:p.source_video,style:b,styleSpec:p});case"image":return Jt({key:l,value:r,valueSpec:p.source_image,style:b,styleSpec:p});case"canvas":return[new o.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return un({key:`${l}.type`,value:r.type,valueSpec:{values:Pt(p)}})}}function Pt(f){return f.source.reduce((r,l)=>{const p=f[l];return p.type.type==="enum"&&(r=r.concat(Object.keys(p.type.values))),r},[])}function _n(f){const r=f.value,l=f.styleSpec,p=l.light,b=f.style;let w=[];const C=o.B(r);if(r===void 0)return w;if(C!=="object")return w=w.concat([new o.V("light",r,`object expected, ${C} found`)]),w;for(const O in r){const V=O.match(/^(.*)-transition$/);w=w.concat(V&&p[V[1]]&&p[V[1]].transition?Mn({key:O,value:r[O],valueSpec:l.transition,style:b,styleSpec:l}):p[O]?Mn({key:O,value:r[O],valueSpec:p[O],style:b,styleSpec:l}):[new o.V(O,r[O],`unknown property "${O}"`)])}return w}function dt(f){const r=f.value;let l=[];if(!r)return l;const p=o.B(r);if(p!=="object")return l=l.concat([new o.V("light-3d",r,`object expected, ${p} found`)]),l;const b=f.styleSpec,w=b["light-3d"],C=f.key,O=f.style,V=f.style.lights;for(const Y of["type","id"])if(!(Y in r))return l=l.concat([new o.V("light-3d",r,`missing property ${Y} on light`)]),l;if(r.type&&V)for(let Y=0;Y<f.arrayIndex;Y++){const Q=o.D(r.type),ie=V[Y];o.D(ie.type)===Q&&l.push(new o.V(C,r.id,`duplicate light type "${r.type}", previously defined at line ${ie.id.__line__}`))}const G=`properties_light_${r.type}`;if(!(G in b))return l=l.concat([new o.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const j=b[G];for(const Y in r)if(Y==="properties"){const Q=r[Y],ie=o.B(Q);if(ie!=="object")return l=l.concat([new o.V("properties",Q,`object expected, ${ie} found`)]),l;for(const ve in Q)l=l.concat(j[ve]?Mn({key:ve,value:Q[ve],valueSpec:j[ve],style:O,styleSpec:b}):[new o.A(f.key,Q[ve],`unknown property "${ve}"`)])}else{const Q=Y.match(/^(.*)-transition$/);l=l.concat(Q&&w[Q[1]]&&w[Q[1]].transition?Mn({key:Y,value:r[Y],valueSpec:b.transition,style:O,styleSpec:b}):w[Y]?Mn({key:Y,value:r[Y],valueSpec:w[Y],style:O,styleSpec:b}):[new o.A(Y,r[Y],`unknown property "${Y}"`)])}return l}function tn(f){const r=f.value,l=f.key,p=f.style,b=f.styleSpec,w=b.terrain;let C=[];const O=o.B(r);if(r===void 0||O==="null")return C;if(O!=="object")return C=C.concat([new o.V("terrain",r,`object expected, ${O} found`)]),C;for(const V in r){const G=V.match(/^(.*)-transition$/);C=C.concat(G&&w[G[1]]&&w[G[1]].transition?Mn({key:V,value:r[V],valueSpec:b.transition,style:p,styleSpec:b}):w[V]?Mn({key:V,value:r[V],valueSpec:w[V],style:p,styleSpec:b}):[new o.A(V,r[V],`unknown property "${V}"`)])}if(r.source){const V=p.sources&&p.sources[r.source],G=V&&o.D(V.type);V?G!=="raster-dem"&&C.push(new o.V(l,r.source,`terrain cannot be used with a source of type ${String(G)}, it only be used with a "raster-dem" source type`)):C.push(new o.V(l,r.source,`source "${r.source}" not found`))}else C.push(new o.V(l,r,'terrain is missing required property "source"'));return C}function Ze(f){const r=f.value,l=f.style,p=f.styleSpec,b=p.fog;let w=[];const C=o.B(r);if(r===void 0)return w;if(C!=="object")return w=w.concat([new o.V("fog",r,`object expected, ${C} found`)]),w;for(const O in r){const V=O.match(/^(.*)-transition$/);w=w.concat(V&&b[V[1]]&&b[V[1]].transition?Mn({key:O,value:r[O],valueSpec:p.transition,style:l,styleSpec:p}):b[O]?Mn({key:O,value:r[O],valueSpec:b[O],style:l,styleSpec:p}):[new o.A(O,r[O],`unknown property "${O}"`)])}return w}const vn={"*":()=>[],array:Dt,boolean:function(f){const r=f.value,l=f.key,p=o.B(r);return p!=="boolean"?[new o.V(l,r,`boolean expected, ${p} found`)]:[]},number:xt,color:function(f){const r=f.key,l=f.value,p=o.B(l);return p!=="string"?[new o.V(r,l,`color expected, ${p} found`)]:o.U.parseCSSColor(l)===null?[new o.V(r,l,`color expected, "${l}" found`)]:[]},enum:un,filter:Pn,function:Ot,layer:eo,object:Jt,source:er,model:o.Z,light:_n,"light-3d":dt,terrain:tn,fog:Ze,string:fo,formatted:function(f){return fo(f).length===0?[]:en(f)},resolvedImage:function(f){return fo(f).length===0?[]:en(f)},projection:function(f){const r=f.value,l=f.styleSpec,p=l.projection,b=f.style;let w=[];const C=o.B(r);if(C==="object")for(const O in r)w=w.concat(Mn({key:O,value:r[O],valueSpec:p[O],style:b,styleSpec:l}));else C!=="string"&&(w=w.concat([new o.V("projection",r,`object or string expected, ${C} found`)]));return w},import:function(f){const{value:r,styleSpec:l}=f,{data:p,...b}=r;Object.defineProperty(b,"__line__",{value:r.__line__,enumerable:!1});let w=Jt(o.C({},f,{value:b,valueSpec:l.import}));return o.D(b.id)===""&&w.push(new o.V(`${f.key}.id`,b,"import id can't be an empty string")),p&&(w=w.concat(gr(p,l,{key:`${f.key}.data`}))),w}};function Mn(f,r=!1){const l=f.value,p=f.valueSpec,b=f.styleSpec;if(p.expression&&o.X(o.D(l)))return Ot(f);if(p.expression&&o.J(o.K(l)))return en(f);if(p.type&&vn[p.type]){const w=vn[p.type](f);return r===!0&&w.length>0&&o.B(f.value)==="array"?en(f):w}return Jt(o.C({},f,{valueSpec:p.type?b[p.type]:p}))}function yo(f){const r=f.value,l=f.key,p=fo(f);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{range}" token'))),p}function gr(f,r=o._,l={}){return Mn({key:l.key||"",value:f,valueSpec:r.$root,styleSpec:r,style:f,objectElementValidators:{glyphs:yo,"*":()=>[]}})}function Xr(f,r=o._){return tt(gr(f,r))}const Ur=f=>tt(er(f)),Rr=f=>tt(_n(f)),Oo=f=>tt(dt(f)),_i=f=>tt(tn(f)),ya=f=>tt(Ze(f)),$t=f=>tt(eo(f)),Se=f=>tt(Pn(f)),Ae=f=>tt(Vn(f)),He=f=>tt(lo(f)),ft=f=>tt(o.Z(f));function tt(f){return f.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function bt(f,r){let l=!1;if(r&&r.length)for(const p of r)p instanceof o.A?o.w(p.message):(f.fire(new o.t(new Error(p.message))),l=!0);return l}let zt;class Tt extends o.E{constructor(r,l="flat"){super(),this._transitionable=new o.$(zt||(zt=new o.a0({anchor:new o.a1(o._.light.anchor),position:new o.a2(o._.light.position),color:new o.a1(o._.light.color),intensity:new o.a1(o._.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,p={}){this._validate(Rr,r,p)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&bt(this,r.call(Xr,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}let Ft=class extends o.E{constructor(f,r,l,p){super(),this.scope=l,this._transitionable=new o.$(new o.a0({source:new o.a1(o._.terrain.source),exaggeration:new o.a1(o._.terrain.exaggeration)}),l,p),this._transitionable.setTransitionOrValue(f,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(f,r){this._transitionable.setTransitionOrValue(f,r)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new o.a3(f)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const f=this._transitionable._values.exaggeration;if(!f)return null;const r=f.value.expression;if(!r)return null;let l=-1,p=-1,b=1;for(const w of r.zoomStops)b=r.evaluate(new o.a3(w)),b>.01?(l=w,p=-1):p=w;return b<.01&&l>0&&p>l?[l,p]:null}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof o.a4}};const Kt=45,Zt=65,pt=.05;function Ht(f,r,l,p){const b=o.a7(Kt,Zt,l),[w,C]=bn(f,p);let O=1-Math.min(1,Math.exp((r-w)/(C-w)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*b*f.alpha}function bn(f,r){const l=.5/Math.tan(.5*r);return[f.range[0]+l,f.range[1]+l]}function Yn(f,r,l,p,b){const w=o.a6.vec3.transformMat4([],[r,l,p],b.mercatorFogMatrix);return Ht(f,o.a6.vec3.length(w),b.pitch,b._fov)}function ro(f,r,l,p,b,w,C){const O=[[l,p,0],[b,p,0],[b,w,0],[l,w,0]];let V=Number.MAX_VALUE,G=-Number.MAX_VALUE;for(const j of O){const Y=o.a6.vec3.transformMat4([],j,r),Q=o.a6.vec3.length(Y);V=Math.min(V,Q),G=Math.max(G,Q)}return[Ht(f,V,C.pitch,C._fov),Ht(f,G,C.pitch,C._fov)]}class po extends o.E{constructor(r,l,p,b){super();const w=new o.a0({range:new o.a1(o._.fog.range),color:new o.a1(o._.fog.color),"high-color":new o.a1(o._.fog["high-color"]),"space-color":new o.a1(o._.fog["space-color"]),"horizon-blend":new o.a1(o._.fog["horizon-blend"]),"star-intensity":new o.a1(o._.fog["star-intensity"]),"vertical-range":new o.a1(o._.fog["vertical-range"])});this._transitionable=new o.$(w,p,new Map(b)),this.set(r,b),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new o.a8(w),this.scope=p}get state(){const r=this._transform,l=r.projection.name==="globe",p=o.a9(r.zoom),b=this.properties.get("range"),w=[.5,3];return{range:l?[o.aa(w[0],b[0],p),o.aa(w[1],b[1],p)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,p={}){if(this._validate(ya,r,p))return;const b=o.l({},r);for(const w of Object.keys(o._.fog))b[w]===void 0&&(b[w]=o._.fog[w].default);this._options=b,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.a7(Kt,Zt,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(p,b,w){const C=o.a5.fromLngLat(b),O=w.elevation?w.elevation.getAtPointOrZero(C):0;return Yn(p,C.x,C.y,O,w)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return ro(this.state,l,0,0,o.ab,o.ab,this._transform)}getOpacityForBounds(r,l,p,b,w){return this._transform.projection.supportsFog?ro(this.state,r,l,p,b,w,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?bn(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const p of l){const b=r.points[p];let w;if(b[2]>=0)w=b;else{const C=r.points[p-4];w=o.ac(C,b,C[2]/(C[2]-b[2]))}if(Yn(this.state,w[0],w[1],0,this._transform)>=pt)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&bt(this,r.call(Xr,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}class ao extends o.E{constructor(r,l,p,b){super(),this.scope=p,this._options=r,this.properties=new o.a8(l),this._transitionable=new o.$(l,p,new Map(b)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let Ko,jo;class Ro{constructor(r,l,p,b){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(r,l){let p,b;if(r instanceof o.P||typeof r[0]=="number"){const w=o.P.convert(r);p=[w],b=l.isPointAboveHorizon(w)}else{const w=o.P.convert(r[0]),C=o.P.convert(r[1]);p=[w,C],b=o.ae(w,C).every(O=>l.isPointAboveHorizon(O))}return new Ro(p,l.getCameraPoint(),b,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?b[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(b[3]=this.cameraPoint)),o.af(b,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,p,r),w=this.cameraPoint.clone();switch(3*((w.y>l.y)+(w.y>p.y))+((w.x>l.x)+(w.x>p.x))){case 0:b[0]=w,b[4]=w.clone();break;case 1:b.splice(1,0,w);break;case 2:b[1]=w;break;case 3:b.splice(4,0,w);break;case 5:b.splice(2,0,w);break;case 6:b[3]=w;break;case 7:b.splice(3,0,w);break;case 8:b[2]=w}return b}containsTile(r,l,p,b=0){const w=r.queryPadding/l._pixelsPerMercatorPixel+1,C=p?this._bufferedCameraMercator(w,l):this._bufferedScreenMercator(w,l);let O=r.tileID.wrap+(C.unwrapped?b:0);const V=C.polygon.map(we=>o.ag(r.tileTransform,we,O));if(!o.ah(V,0,0,o.ab,o.ab))return;O=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const G=this.screenGeometryMercator.polygon.map(we=>o.ai(r.tileTransform,we,O)),j=G.map(we=>new o.P(we[0],we[1])),Y=l.getFreeCameraOptions().position||new o.a5(0,0,0),Q=o.ai(r.tileTransform,Y,O),ie=G.map(we=>{const be=o.a6.vec3.sub(we,we,Q);return o.a6.vec3.normalize(be,be),new o.aj(Q,be)}),ve=o.ak(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:ie,bufferedTilespaceGeometry:V,bufferedTilespaceBounds:(me=o.al(V),me.min.x=o.ap(me.min.x,0,o.ab),me.min.y=o.ap(me.min.y,0,o.ab),me.max.x=o.ap(me.max.x,0,o.ab),me.max.y=o.ap(me.max.y,0,o.ab),me),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ve};var me}_bufferedScreenMercator(r,l){const p=co(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[p]=b,b}}_bufferedCameraMercator(r,l){const p=co(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[p]=b,b}}_projectAndResample(r,l){const p=function(w,C){const O=o.a6.mat4.multiply([],C.pixelMatrix,C.globeMatrix),V=[0,-o.aq,0,1],G=[0,o.aq,0,1],j=[0,0,0,1];o.a6.vec4.transformMat4(V,V,O),o.a6.vec4.transformMat4(G,G,O),o.a6.vec4.transformMat4(j,j,O);const Y=new o.P(V[0]/V[3],V[1]/V[3]),Q=new o.P(G[0]/G[3],G[1]/G[3]),ie=o.an(w,Y)&&V[3]<j[3],ve=o.an(w,Q)&&G[3]<j[3];if(!ie&&!ve)return null;const me=function(Ke,Je,rt){for(let ht=1;ht<Ke.length;ht++){const lt=On(Je.pointCoordinate3D(Ke[ht-1]).x),st=On(Je.pointCoordinate3D(Ke[ht]).x);if(rt<0){if(lt<st)return{idx:ht,t:-lt/(st-1-lt)}}else if(st<lt)return{idx:ht,t:(1-lt)/(st+1-lt)}}return null}(w,C,ie?-1:1);if(!me)return null;const{idx:we,t:be}=me;let Pe=we>1?Qt(w.slice(0,we),C):[],$e=we<w.length?Qt(w.slice(we),C):[];Pe=Pe.map(Ke=>new o.P(On(Ke.x),Ke.y)),$e=$e.map(Ke=>new o.P(On(Ke.x),Ke.y));const Ve=[...Pe];Ve.length===0&&Ve.push($e[$e.length-1]);const We=o.aa(Ve[Ve.length-1].y,($e.length===0?Pe[0]:$e[0]).y,be);let Xe;return Xe=ie?[new o.P(0,We),new o.P(0,0),new o.P(1,0),new o.P(1,We)]:[new o.P(1,We),new o.P(1,1),new o.P(0,1),new o.P(0,We)],Ve.push(...Xe),$e.length===0?Ve.push(Pe[0]):Ve.push(...$e),{polygon:Ve.map(Ke=>new o.a5(Ke.x,Ke.y)),unwrapped:!1}}(r,l);if(p)return p;const b=function(w,C){let O=!1,V=-1/0,G=0;for(let Y=0;Y<w.length-1;Y++)w[Y].x>V&&(V=w[Y].x,G=Y);for(let Y=0;Y<w.length-1;Y++){const Q=(G+Y)%(w.length-1),ie=w[Q],ve=w[Q+1];Math.abs(ie.x-ve.x)>.5&&(ie.x<ve.x?(ie.x+=1,Q===0&&(w[w.length-1].x+=1)):(ve.x+=1,Q+1===w.length-1&&(w[0].x+=1)),O=!0)}const j=o.am(C.center.lng);return O&&j<Math.abs(j-1)&&w.forEach(Y=>{Y.x-=1}),{polygon:w,unwrapped:O}}(Qt(r,l).map(w=>new o.P(On(w.x),w.y)),l);return{polygon:b.polygon.map(w=>new o.a5(w.x,w.y)),unwrapped:b.unwrapped}}}function Qt(f,r){return o.ao(f,l=>{const p=r.pointCoordinate3D(l);l.x=p.x,l.y=p.y},1/256)}function On(f){return f<0?1+f%1:f%1}function co(f){return 100*f|0}function Co(f,r,l,p,b){const w=function(O,V){if(O)return b(O);if(V){if(f.url&&V.tiles&&f.tiles&&delete f.tiles,V.variants){if(!Array.isArray(V.variants))return b(new Error("variants must be an array"));for(const j of V.variants){if(j==null||typeof j!="object"||j.constructor!==Object)return b(new Error("variant must be an object"));if(!Array.isArray(j.capabilities))return b(new Error("capabilities must be an array"));if(j.capabilities.length===1&&j.capabilities[0]==="meshopt"){V=o.l(V,j);break}}}const G=o.ar(o.l({},V,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);G.tiles=r.canonicalizeTileset(G,f.url),b(null,G)}},C=function(O,V,G){if(!O)return null;if(!V&&!G)return O;G=G||O.worldview_default;const j=Object.values(O.language||{});if(j.length===0)return null;const Y=Object.values(O.worldview||{});if(Y.length===0)return null;const Q=j.every(ve=>ve===V),ie=Y.every(ve=>ve===G);return Q&&ie?O:V in(O.language_options||{})||G in(O.worldview_options||{})?null:O.language_options&&O.worldview_options?O:null}(f.data,l,p);return C?o.q.frame(()=>w(null,C)):f.url?o.n(r.transformRequest(r.normalizeSourceURL(f.url,null,l,p),o.R.Source),w):o.q.frame(()=>{const{data:O,...V}=f;w(null,V)})}class vr{constructor(r,l,p){this.bounds=o.as.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),p=Math.floor(o.am(this.bounds.getWest())*l),b=Math.floor(o.at(this.bounds.getNorth())*l),w=Math.ceil(o.am(this.bounds.getEast())*l),C=Math.ceil(o.at(this.bounds.getSouth())*l);return r.x>=p&&r.x<w&&r.y>=b&&r.y<C}}class Kr extends o.E{constructor(r,l,p,b){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.l(this,o.ar(l,["url","scheme","tileSize","promoteId"])),this._options=o.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new o.au}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=Co(this._options,this.map._requestManager,l,p,(b,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,b)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new o.t(b));else if(w){if(o.l(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const C of w.vector_layers)this.vectorLayerIds.push(C.id),w.worldview&&w.worldview[C.source]&&this.localizableLayerIds.add(C.id)}w.bounds&&(this.tileBounds=new vr(w.bounds,this.minzoom,this.maxzoom)),nt(w.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}r&&r(b)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}loadTile(r,l){const p=r.tileID.canonical.url(this.tiles,this.scheme),b=this.map._requestManager.normalizeTileURL(p),w=this.map._requestManager.transformRequest(b,o.R.Tile),C=this.map.style?this.map.style.getLut(this.scope):null,O=C?{image:C.image.clone()}:null,V={request:w,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:O,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&o.f(p)&&(V.worldview=this.map.getWorldview()||this.worldviewDefault,V.localizableLayerIds=this.localizableLayerIds),V.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",V,G.bind(this));else if(r.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",V,G.bind(this),void 0,!0);else{const j=o.aw.call({deduped:this._deduped},V,(Y,Q)=>{Y||!Q?G.call(this,Y):(V.data={cacheControl:Q.cacheControl,expires:Q.expires,rawData:Q.rawData.slice(0)},r.actor&&r.actor.send("loadTile",V,G.bind(this),void 0,!0))},!0);r.request={cancel:j}}function G(j,Y){return delete r.request,r.aborted?l(null):j&&j.status!==404?l(j):(Y&&Y.resourceTiming&&(r.resourceTiming=Y.resourceTiming),this.map._refreshExpiredTiles&&Y&&r.setExpiryData(Y),r.loadVectorData(Y,this.map.painter),o.ax(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class El extends o.E{constructor(r,l,p,b){super(),this.id=r,this.dispatcher=p,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.l({type:"raster"},l),o.l(this,o.ar(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._tileJSONRequest=Co(this._options,this.map._requestManager,null,null,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new o.t(l)):p&&(o.l(this,p),p.raster_layers&&(this.rasterLayers=p.raster_layers,this.rasterLayerIds=this.rasterLayers.map(b=>b.id)),p.bounds&&(this.tileBounds=new vr(p.bounds,this.minzoom,this.maxzoom)),nt(p.tiles),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const p=o.q.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=o.o(this.map._requestManager.transformRequest(b,o.R.Tile),(w,C,O,V)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):w?(r.state="errored",l(w)):C?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:O,expires:V}),r.setTexture(C,this.map.painter),r.state="loaded",o.ax(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof o.T?(r.destroy(!0),r.texture&&r.texture instanceof o.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ba extends El{constructor(r,l,p,b){super(r,l,p,b),this.type="raster-array",this.maxzoom=22,this._options=o.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);l&&l.enabled&&p&&l._clearRenderCacheForTile(p.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),b=this.map._requestManager.transformRequest(p,o.R.Tile);r.requestParams=b,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(w,C,O,V)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(w)return w.code===20?void 0:(r.state="errored",l(w));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:O,expires:V}),r.state="empty",l(null)})}unloadTile(r,l){const p=r.texture;p&&p instanceof o.T?(r.destroy(!0),this.map.painter.saveTileTexture(p)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,p){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,p,(b,w)=>{if(b)return r.state="errored",this.fire(new o.t(b)),void this.triggerRepaint(r);w&&(r.setTexture(w,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:w})=>w===r),p=l&&l.fields,b=p&&p.bands&&p.bands;return b?b[0]:0}getTextureDescriptor(r,l,p){if(!r)return;const b=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!b)return;let w=null;l instanceof o.aB?w=l.paint.get("raster-array-band"):l instanceof o.aC&&(w=l.paint.get("raster-particle-array-band"));const C=w||this.getInitialBand(b);if(C!=null)if(r.textureDescriptor){if(!r.updateNeeded(b,C)||p)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,b,C)}}const Bh={vector:Kr,raster:El,"raster-dem":class extends El{constructor(f,r,l,p){super(f,r,l,p),this.type="raster-dem",this.maxzoom=22,this._options=o.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(b,w){b&&(f.state="errored",r(b)),w&&(f.dem=w,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=o.o(this.map._requestManager.transformRequest(l,o.R.Tile),(function(b,w,C,O){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(b)f.state="errored",r(b);else if(w){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:C,expires:O});const V=ImageBitmap&&w instanceof ImageBitmap&&o.ay(),G=1-(w.width-o.az(w.width))/2;G<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const j=V?w:o.q.getImageData(w,G),Y={uid:f.uid,coord:f.tileID,source:this.id,scope:this.scope,rawImageData:j,encoding:this.encoding,padding:G};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",Y,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const r=f.canonical,l=Math.pow(2,r.z),p=(r.x-1+l)%l,b=r.x===0?f.wrap-1:f.wrap,w=(r.x+1+l)%l,C=r.x+1===l?f.wrap+1:f.wrap,O={};return O[new o.aA(f.overscaledZ,b,r.z,p,r.y).key]={backfilled:!1},O[new o.aA(f.overscaledZ,C,r.z,w,r.y).key]={backfilled:!1},r.y>0&&(O[new o.aA(f.overscaledZ,b,r.z,p,r.y-1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,C,r.z,w,r.y-1).key]={backfilled:!1}),r.y+1<l&&(O[new o.aA(f.overscaledZ,b,r.z,p,r.y+1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},O[new o.aA(f.overscaledZ,C,r.z,w,r.y+1).key]={backfilled:!1}),O}},"raster-array":ba,geojson:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=r.data,this._options=o.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const b=o.ab/this.tileSize;this.workerOptions=o.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*b,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*b,extent:o.ab,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.ab,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*b,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new o.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new o.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of f.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterLeaves(f,r,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:r,offset:l},p),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.x("dataloading",{dataType:"source"})),this._loaded=!1;const r=o.l({append:f},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(o.q.resolveURL(l),o.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(p,b)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new o.t(p));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(w.resourceTiming=b.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new o.x("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const l=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,b=p?{image:p.image.clone()}:null,w=this._partialReload,C={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:b,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:w};f.request=this.actor.send(l,C,(O,V)=>w&&!V?(f.state="loaded",r(null)):(delete f.request,f.destroy(),f.aborted?r(null):O?r(O):(f.loadVectorData(V,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,r){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aD{constructor(f,r,l,p){super(f,r,l,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.R.Source).url);o.aE(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new o.t(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new o.t(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(f,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aD,model:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const f=[];for(const r in this._options.models){const l=this._options.models[r],p=o.aG(this.map._requestManager.transformRequest(l.uri,o.R.Model).url).then(b=>{if(!b)return;const w=o.aH(b),C=new o.aI(r,l.position,l.orientation,w);C.computeBoundsAndApplyParent(),this.models.push(C)}).catch(b=>{this.fire(new o.t(new Error(`Could not load model ${r} from ${l.uri}: ${b.message}`)))});f.push(p)}return Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new o.t(new Error(`Could not load models: ${r.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,r){}serialize(){return{type:"model"}}},"batched-model":class extends o.E{constructor(f,r,l,p){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(f){this.map=f,this.load()}load(f){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=Co(this._options,this.map._requestManager,r,l,(p,b)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new o.t(p))):b&&(o.l(this,b),b.bounds&&(this.tileBounds=new vr(b.bounds,this.minzoom,this.maxzoom)),nt(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),f&&f(p)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,o.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=r;else{if(f.buckets){const w=Object.values(f.buckets);for(const C of w)C.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",p,b.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",p,b.bind(this),void 0,!0);function b(w,C){return f.aborted?r(null):w&&w.status!==404?r(w):(this.map._refreshExpiredTiles&&C&&f.setExpiryData(C),f.loadModelData(C,this.map.painter),f.state="loaded",void r(null))}}serialize(){return o.l({},this._options)}},canvas:class extends o.aD{constructor(f,r,l,p){super(f,r,l,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(w=>typeof w!="number"))||this.fire(new o.t(new o.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.t(new o.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.t(new o.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof o.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends o.E{constructor(f,r,l,p){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new vr(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.l(this,o.ar(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:l,z:p}=f.canonical;return this._implementation.hasTile({x:r,y:l,z:p})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:l,y:p,z:b}=f.tileID.canonical,w=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:l,y:p,z:b},{signal:w.signal})).then((function(C){return delete f.request,f.aborted?(f.state="unloaded",r(null)):C===void 0?(f.state="errored",r(null)):C===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(O){return O instanceof ImageData||O instanceof HTMLCanvasElement||O instanceof ImageBitmap||O instanceof HTMLImageElement}(C)?(this.loadTileData(f,C),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(C=>{C.code!==20&&(f.state="errored",r(C))}),f.request.cancel=()=>w.abort()}loadTileData(f,r){f.setTexture(r,this.map.painter)}unloadTile(f,r){if(f.texture&&f.texture instanceof o.T?(f.destroy(!0),f.texture&&f.texture instanceof o.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:l,y:p,z:b}=f.tileID.canonical;this._implementation.unloadTile({x:l,y:p,z:b})}r&&r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=o.av(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}}},Fh=function(f,r,l,p){const b=new Bh[r.type](f,r,l,p);if(b.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${b.id}`);return o.aJ(["load","abort","unload","serialize","prepare"],b),b};function Nh(f,r){const l=o.a6.mat4.identity([]);return o.a6.mat4.scale(l,l,[.5*f.width,.5*-f.height,1]),o.a6.mat4.translate(l,l,[1,-1,0]),o.a6.mat4.multiply(l,l,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(l)}function em(f,r,l,p,b,w,C,O,V=!1){const G=f.tilesIn(l,O,V);G.sort(Bc);const j=[];for(const Q of G)j.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(r,f._state,Q,p,b,w,C,Nh(f.transform,Q.tile.tileID),V)});const Y=function(Q){const ie={},ve={};for(const me of Q){const we=me.queryResults,be=me.wrappedTileID,Pe=ve[be]=ve[be]||{};for(const $e in we){const Ve=we[$e],We=Pe[$e]=Pe[$e]||{},Xe=ie[$e]=ie[$e]||[];for(const Ke of Ve)We[Ke.featureIndex]||(We[Ke.featureIndex]=!0,Xe.push(Ke))}}return ie}(j);for(const Q in Y)Y[Q].forEach(ie=>{const ve=ie.feature,me=ve.layer;me&&me.type!=="background"&&me.type!=="sky"&&me.type!=="slot"&&(o.aK(Q)||(ve.source=me.source,me["source-layer"]&&(ve.sourceLayer=me["source-layer"])),ve.state=ve.id!==void 0?f.getFeatureState(me["source-layer"],ve.id):{})});return Y}function tm(f,r){const l=f.getRenderableIds().map(w=>f.getTileByID(w)),p=[],b={};for(let w=0;w<l.length;w++){const C=l[w],O=C.tileID.canonical.key;b[O]||(b[O]=!0,C.querySourceFeatures(p,r))}return p}function Bc(f,r){const l=f.tileID,p=r.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function Fc(f,r){const l={};if(!r)return l;for(const p of f){const b=p.layerIds.map(w=>r.getLayer(w)).filter(Boolean);if(b.length!==0){p.layers=b,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(w=>b.filter(C=>C.id===w)[0]));for(const w of b)l[w.fqid]=p}}return l}const Us=32,ea=33,ta=new Uint16Array(8184);for(let f=0;f<2046;f++){let r=f+2,l=0,p=0,b=0,w=0,C=0,O=0;for(1&r?b=w=C=Us:l=p=O=Us;(r>>=1)>1;){const G=l+b>>1,j=p+w>>1;1&r?(b=l,w=p,l=C,p=O):(l=b,p=w,b=C,w=O),C=G,O=j}const V=4*f;ta[V+0]=l,ta[V+1]=p,ta[V+2]=b,ta[V+3]=w}const is=new Uint16Array(2178),xa=new Uint8Array(1089),hd=new Uint16Array(1089);function nm(f){return f===0?-.03125:f===32?.03125:0}const om={type:2,extent:o.ab,loadGeometry:()=>[[new o.P(0,0),new o.P(o.ab+1,0),new o.P(o.ab+1,o.ab+1),new o.P(0,o.ab+1),new o.P(0,0)]]};class wa{constructor(r,l,p,b,w){this.tileID=r,this.uid=o.aQ(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,b&&b.style&&(this._lastUpdatedBrightness=b.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",b&&b.transform&&(this.projection=b.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<o.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aL(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,p){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=Fc(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const w=this.buckets[b];if(w instanceof o.aS){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const w=this.buckets[b];if(w instanceof o.aS&&w.hasRTLText){this.hasRTLText=!0,o.aT();break}}this.queryPadding=0;for(const b in this.buckets){const w=this.buckets[b],C=l.style.getOwnLayer(b);if(!C)continue;const O=C.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,O)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new o.aR}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,p){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets={...this.buckets,...Fc(r.buckets,l.style)},r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const b in this.buckets){const w=this.buckets[b];w.uploadPending()&&w.upload(r)}const l=r.gl,p=this.imageAtlas;if(p&&!p.uploaded){const b=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new o.T(r,p.image,l.RGBA8,{useMipmap:b}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,p),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const b=l.style.getBrightness();(this._lastUpdatedBrightness||b)&&(this._lastUpdatedBrightness&&b&&Math.abs(this._lastUpdatedBrightness-b)<.001||(this._lastUpdatedBrightness=b,this.updateBuckets(l)))}queryRenderedFeatures(r,l,p,b,w,C,O,V,G){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:V,transform:O,filter:b,layers:w,availableImages:C,tileTransform:this.tileTransform},r,l):{}}querySourceFeatures(r,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const b=p.loadVTLayers(),w=l?l.sourceLayer:"",C=b._geojsonTileLayer||b[w];if(!C)return;const O=o.aU(l&&l.filter),{z:V,x:G,y:j}=this.tileID.canonical,Y={z:V,x:G,y:j};for(let Q=0;Q<C.length;Q++){const ie=C.feature(Q);if(O.needGeometry){const we=o.aV(ie,!0);if(!O.filter(new o.a3(this.tileID.overscaledZ),we,this.tileID.canonical))continue}else if(!O.filter(new o.a3(this.tileID.overscaledZ),ie))continue;const ve=p.getId(ie,w),me=new o.aW(ie,V,G,j,ve);me.tile=Y,r.push(me)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const p=o.aX(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let b=!1;if(this.expirationTime>p)b=!1;else if(l)if(this.expirationTime<l)b=!0;else{const w=this.expirationTime-l;w?this.expirationTime=p+Math.max(w,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),p=r.style.listImages(),b=r.style.getBrightness();for(const w in this.buckets){if(!r.style.hasLayer(w))continue;const C=this.buckets[w],O=C.layers[0],V=O.sourceLayer||"_geojsonTileLayer",G=l[V],j=r.style.getSourceCache(O.source,O.scope);let Y={};j&&(Y=j._state.getState(V,void 0)),C.update(Y,G,p,this.imageAtlas&&this.imageAtlas.patternPositions||{},b),(C instanceof o.aY||C instanceof o.aZ)&&r._terrain&&r._terrain.enabled&&j&&C.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(j.id,this.tileID);const Q=r&&r.style&&r.style.getOwnLayer(w);Q&&(this.queryPadding=Math.max(this.queryPadding,Q.queryRadius(C)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=o.q.now()+r}setTexture(r,l){const p=l.context,b=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r):(this.texture=new o.T(p,r,b.RGBA8,{useMipmap:!0}),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE))}setDependencies(r,l){const p={};for(const b of l)p[b]=!0;this.dependencies[r]=p}hasDependency(r,l){for(const p of r){const b=this.dependencies[p];if(b){for(const w of l)if(b[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const p=o.a_(om,this.tileID.canonical,this.tileTransform)[0],b=new o.a$,w=new o.b0;for(let C=0;C<p.length;C++){const{x:O,y:V}=p[C];b.emplaceBack(O,V),w.emplaceBack(C)}w.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(w),this._tileDebugBuffer=r.createVertexBuffer(b,o.b1.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,b.length,w.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const p=o.a_(om,this.tileID.canonical,this.tileTransform)[0];let b,w;if(this.isRaster){const C=function(O,V){const G=o.aL(O,V),j=Math.pow(2,O.z);for(let we=0;we<ea;we++)for(let be=0;be<ea;be++){const Pe=o.aM((O.x+(be+nm(be))/Us)/j),$e=o.aN((O.y+(we+nm(we))/Us)/j),Ve=V.project(Pe,$e),We=we*ea+be;is[2*We+0]=Math.round((Ve.x*G.scale-G.x)*o.ab),is[2*We+1]=Math.round((Ve.y*G.scale-G.y)*o.ab)}xa.fill(0),hd.fill(0);for(let we=2045;we>=0;we--){const be=4*we,Pe=ta[be+0],$e=ta[be+1],Ve=ta[be+2],We=ta[be+3],Xe=Pe+Ve>>1,Ke=$e+We>>1,Je=Xe+Ke-$e,rt=Ke+Pe-Xe,ht=$e*ea+Pe,lt=We*ea+Ve,st=Ke*ea+Xe,Lt=Math.hypot((is[2*ht+0]+is[2*lt+0])/2-is[2*st+0],(is[2*ht+1]+is[2*lt+1])/2-is[2*st+1])>=16;xa[st]=xa[st]||(Lt?1:0),we<1022&&(xa[st]=xa[st]||xa[($e+rt>>1)*ea+(Pe+Je>>1)]||xa[(We+rt>>1)*ea+(Ve+Je>>1)])}const Y=new o.aO,Q=new o.aP;let ie=0;function ve(we,be){const Pe=be*ea+we;return hd[Pe]===0&&(Y.emplaceBack(is[2*Pe+0],is[2*Pe+1],we*o.ab/Us,be*o.ab/Us),hd[Pe]=++ie),hd[Pe]-1}function me(we,be,Pe,$e,Ve,We){const Xe=we+Pe>>1,Ke=be+$e>>1;if(Math.abs(we-Ve)+Math.abs(be-We)>1&&xa[Ke*ea+Xe])me(Ve,We,we,be,Xe,Ke),me(Pe,$e,Ve,We,Xe,Ke);else{const Je=ve(we,be),rt=ve(Pe,$e),ht=ve(Ve,We);Q.emplaceBack(Je,rt,ht)}}return me(0,0,Us,Us,Us,0),me(Us,Us,0,0,0,Us),{vertices:Y,indices:Q}}(this.tileID.canonical,l);b=C.vertices,w=C.indices}else{b=new o.aO,w=new o.aP;for(const{x:O,y:V}of p)b.emplaceBack(O,V,0,0);const C=o.b3(b.int16,void 0,4);for(let O=0;O<C.length;O+=3)w.emplaceBack(C[O],C[O+1],C[O+2])}this._tileBoundsBuffer=r.createVertexBuffer(b,o.b4.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(w),this._tileBoundsSegments=o.b2.simpleSegment(0,0,b.length,w.length)}_makeGlobeTileDebugBuffers(r,l){const p=l.projection;if(!p||p.name!=="globe"||l.freezeTileCoverage)return;const b=this.tileID.canonical,w=o.b5(b,l),C=o.b6(w),O=o.a9(l.zoom);let V;O>0&&(V=o.a6.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,b,l,C,V,O),this._makeGlobeTileDebugTextBuffer(r,b,l,C,V,O)}_globePoint(r,l,p,b,w,C,O){let V=o.b7(r,l,p);if(C){const G=1<<p.z,j=o.am(b.center.lng),Y=o.at(b.center.lat),Q=(p.x+.5)/G-j;let ie=0;Q>.5?ie=-1:Q<-.5&&(ie=1);let ve=(r/o.ab+p.x)/G+ie,me=(l/o.ab+p.y)/G;ve=(ve-j)*b._pixelsPerMercatorPixel+j,me=(me-Y)*b._pixelsPerMercatorPixel+Y;const we=[ve*b.worldSize,me*b.worldSize,0];o.a6.vec3.transformMat4(we,we,C),V=o.b8(V,we,O)}return o.a6.vec3.transformMat4(V,V,w)}_makeGlobeTileDebugBorderBuffer(r,l,p,b,w,C){const O=new o.a$,V=new o.b0,G=new o.b9,j=(Q,ie,ve,me,we)=>{const be=(ve-Q)/(we-1),Pe=(me-ie)/(we-1),$e=O.length;for(let Ve=0;Ve<we;Ve++){const We=Q+Ve*be,Xe=ie+Ve*Pe;O.emplaceBack(We,Xe);const Ke=this._globePoint(We,Xe,l,p,b,w,C);G.emplaceBack(Ke[0],Ke[1],Ke[2]),V.emplaceBack($e+Ve)}},Y=o.ab;j(0,0,Y,0,16),j(Y,0,Y,Y,16),j(Y,Y,0,Y,16),j(0,Y,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(V),this._tileDebugBuffer=r.createVertexBuffer(O,o.b1.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(G,o.ba.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,O.length,V.length)}_makeGlobeTileDebugTextBuffer(r,l,p,b,w,C){const O=o.ab/4,V=new o.a$,G=new o.aP,j=new o.b9,Y=25;G.reserve(32),V.reserve(Y),j.reserve(Y);const Q=(ie,ve)=>Y*ie+ve;for(let ie=0;ie<Y;ie++){const ve=ie*O;for(let me=0;me<Y;me++){const we=me*O;V.emplaceBack(we,ve);const be=this._globePoint(we,ve,l,p,b,w,C);j.emplaceBack(be[0],be[1],be[2])}}for(let ie=0;ie<4;ie++)for(let ve=0;ve<4;ve++){const me=Q(ie,ve),we=Q(ie,ve+1),be=Q(ie+1,ve),Pe=Q(ie+1,ve+1);G.emplaceBack(me,we,be),G.emplaceBack(be,we,Pe)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(G),this._tileDebugTextBuffer=r.createVertexBuffer(V,o.b1.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(j,o.ba.members),this._tileDebugTextSegments=o.b2.simpleSegment(0,0,Y,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.bb.setPbf(o.bc);class $h extends wa{constructor(r,l,p,b,w){super(r,l,p,b,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const p=l.context,b=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r,{premultiply:!1}):this.texture=new o.T(p,r,b.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const p=this._mrt=new o.bb(30),b=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=o.bd(b,(w,C,O,V)=>{if(w)l(w);else try{const G=p.getHeaderLength(C);if(G>r)return void(this.request=this.fetchHeader(G,l));p.parseHeader(C),this._isHeaderLoaded=!0;let j=0;for(const Y of Object.values(p.layers))j=Math.max(j,Y.dataIndex[Y.dataIndex.length-1].last_byte);C.byteLength>=j&&(this.entireBuffer=C),l(null,this.entireBuffer||C,O,V)}catch(G){l(G)}}),this.request}fetchBand(r,l,p){const b=this._mrt;if(!this._isHeaderLoaded||!b)return void p(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void p(new Error("Can't fetch tile band without an actor"));let C;const O=(Y,Q)=>{C.complete(Y,Q),Y?p(Y):(this.updateTextureDescriptor(r,l),p(null,this.textureDescriptor&&this.textureDescriptor.img))},V=(Y,Q)=>{if(Y)return p(Y);const ie=w.send("decodeRasterArray",{buffer:Q,task:C},O,void 0,!0);this._workQueue.push(()=>{ie&&ie.cancel(),C.cancel()})},G=b.getLayer(r);if(!G)return void p(new Error(`Unknown sourceLayer "${r}"`));if(G.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const j=G.getDataRange([l]);if(C=b.createDecodingTask(j),!C||C.tasks.length)if(this.flushQueues(),this.entireBuffer)V(null,this.entireBuffer.slice(j.firstByte,j.lastByte+1));else{const Y=Object.assign({},this.requestParams,{headers:{Range:`bytes=${j.firstByte}-${j.lastByte}`}}),Q=o.bd(Y,V);this._fetchQueue.push(()=>{Q.cancel(),C.cancel()})}else p(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const p=this._mrt.getLayer(r);if(!p||!p.hasBand(l)||!p.hasDataForBand(l))return;const{bytes:b,tileSize:w,buffer:C,offset:O,scale:V}=p.getBandView(l),G=w+2*C,j={data:b,width:G,height:G},Y=this.texture;Y&&Y instanceof o.T&&Y.update(j,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:j,buffer:C,offset:O,tileSize:w,format:p.pixelFormat,mix:[V,256*V,65536*V,16777216*V]}}}class m_{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,p){const b=r.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const w={value:l,timeout:void 0};if(p!==void 0&&(w.timeout=setTimeout(()=>{this.remove(r,w)},p)),this.data[b].push(w),this.order.push(b),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const p=r.wrapped().key,b=l===void 0?0:this.data[p].indexOf(l),w=this.data[p][b];return this.data[p].splice(b,1),w.timeout&&clearTimeout(w.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const p in this.data)for(const b of this.data[p])r(b.value)||l.push(b);for(const p of l)this.remove(p.value.tileID,p)}}class p1{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,p){const b=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][b]=this.stateChanges[r][b]||{},o.l(this.stateChanges[r][b],p),this.deletedStates[r]===null){this.deletedStates[r]={};for(const w in this.state[r])w!==b&&(this.deletedStates[r][w]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][b]===null){this.deletedStates[r][b]={};for(const w in this.state[r][b])p[w]||(this.deletedStates[r][b][w]=null)}else for(const w in p)this.deletedStates[r]&&this.deletedStates[r][b]&&this.deletedStates[r][b][w]===null&&delete this.deletedStates[r][b][w]}removeFeatureState(r,l,p){if(this.deletedStates[r]===null)return;const b=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&l!==void 0)this.deletedStates[r][b]!==null&&(this.deletedStates[r][b]=this.deletedStates[r][b]||{},this.deletedStates[r][b][p]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][b])for(p in this.deletedStates[r][b]={},this.stateChanges[r][b])this.deletedStates[r][b][p]=null;else this.deletedStates[r][b]=null;else this.deletedStates[r]=null}getState(r,l){const p=this.state[r]||{},b=this.stateChanges[r]||{},w=this.deletedStates[r];if(w===null)return{};if(l!==void 0){const O=String(l),V=o.l({},p[O],b[O]);if(w){const G=w[l];if(G===null)return{};for(const j in G)delete V[j]}return V}const C=o.l({},p,b);if(w)for(const O in w)delete C[O];return C}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const p={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const w={};for(const C in this.stateChanges[b])this.state[b][C]||(this.state[b][C]={}),o.l(this.state[b][C],this.stateChanges[b][C]),w[C]=this.state[b][C];p[b]=w}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const w={};if(this.deletedStates[b]===null)for(const C in this.state[b])w[C]={},this.state[b][C]={};else for(const C in this.deletedStates[b]){if(this.deletedStates[b][C]===null)this.state[b][C]={};else if(this.state[b][C])for(const O of Object.keys(this.deletedStates[b][C]))delete this.state[b][C][O];w[C]=this.state[b][C]}p[b]=p[b]||{},o.l(p[b],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const b in r)r[b].refreshFeatureState(l)}}class ss extends o.E{constructor(r,l,p){super(),this.id=r,this._onlySymbols=p,l.on("data",b=>{b.dataType==="source"&&b.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&b.dataType==="source"&&b.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new m_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new p1,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(r),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return o.be(this._tiles).map(r=>r.tileID).sort(Ml).map(r=>r.key)}getRenderableIds(r,l){const p=[];for(const b in this._tiles)this._isIdRenderable(+b,r,l)&&p.push(this._tiles[b]);return r?p.sort((b,w)=>{const C=b.tileID,O=w.tileID,V=new o.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),G=new o.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-O.overscaledZ||G.y-V.y||G.x-V.x}).map(b=>b.tileID.key):p.map(b=>b.tileID).sort(Ml).map(b=>b.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,p){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(p||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const p=this._tiles[r];p&&(p.state!=="loading"&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,r,l)))}_tileLoaded(r,l,p,b){if(b)if(r.state="errored",b.status!==404)this._source.fire(new o.t(b,{tile:r}));else{if(this._source.fire(new o.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=o.q.now(),p==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new o.x("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let b=0;b<l.length;b++){const w=l[b];if(r.neighboringTiles&&r.neighboringTiles[w]){const C=this.getTileByID(w);p(r,C),p(C,r)}}function p(b,w){if(!b.dem||b.dem.borderReady)return;b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0;let C=w.tileID.canonical.x-b.tileID.canonical.x;const O=w.tileID.canonical.y-b.tileID.canonical.y,V=Math.pow(2,b.tileID.canonical.z),G=w.tileID.key;C===0&&O===0||Math.abs(O)>1||(Math.abs(C)>1&&(Math.abs(C+V)===1?C+=V:Math.abs(C-V)===1&&(C-=V)),w.dem&&b.dem&&(b.dem.backfillBorder(w.dem,C,O),b.neighboringTiles&&b.neighboringTiles[G]&&(b.neighboringTiles[G].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,p,b){for(const w in this._tiles){let C=this._tiles[w];if(b[w]||!C.hasData()||C.tileID.overscaledZ<=l||C.tileID.overscaledZ>p)continue;let O=C.tileID;for(;C&&C.tileID.overscaledZ>l+1;){const G=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[G.key],C&&C.hasData()&&(O=G)}let V=O;for(;V.overscaledZ>l;)if(V=V.scaledTo(V.overscaledZ-1),r[V.key]){b[O.key]=O;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=r.overscaledZ-1;p>=l;p--){const b=r.scaledTo(p),w=this._getLoadedTile(b);if(w)return w}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const p=Math.ceil(r.width/l)+1,b=Math.ceil(r.height/l)+1,w=Math.floor(p*b*5),C=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(O)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const p={};for(const b in this._tiles){const w=this._tiles[b];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),p[w.tileID.key]=w}this._tiles=p;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(+b,this._tiles[b])}}update(r,l,p,b){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const w=this._source.type==="batched-model";let C,O=this._source.maxzoom;const V=this.map&&this.map.painter?this.map.painter._terrain:null;if(V&&V.sourceCache===this&&V.attenuationRange()){const Y=V.attenuationRange()[0],Q=Math.floor(Y)-Math.log2(V.getDemUpscale());O>Q&&(O=Q)}if(this.used||this.usedForTerrain){if(this._source.tileID)C=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(Y=>new o.aA(Y.canonical.z,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y));else if(this.tileCoverLift!==0){const Y=r.clone();Y.tileCoverLift=this.tileCoverLift,C=Y.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.minzoom<=1&&r.projection.name==="globe"&&(C.push(new o.aA(1,0,1,0,0)),C.push(new o.aA(1,0,1,1,0)),C.push(new o.aA(1,0,1,0,1)),C.push(new o.aA(1,0,1,1,1)))}else if(C=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.hasTile){const Y=this._source.hasTile.bind(this._source);C=C.filter(Q=>Y(Q))}}else C=[];if(C.length>0&&this.castsShadows&&b&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!fd(this._source.type)){const Y=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),Q=Math.min(Y,this._source.maxzoom);if(w){const ie=r.extendTileCover(C,Q);for(const ve of ie)C.push(ve)}else{const ie=r.extendTileCover(C,Q,b);for(const ve of ie)this._shadowCasterTiles[ve.key]=!0,C.push(ve)}}const G=this._updateRetainedTiles(C);if(fd(this._source.type)&&C.length!==0){const Y={},Q={},ie=Object.keys(G);for(const me of ie){const we=G[me],be=this._tiles[me];if(!be||be.fadeEndTime&&be.fadeEndTime<=o.q.now())continue;const Pe=this.findLoadedParent(we,Math.max(we.overscaledZ-ss.maxOverzooming,this._source.minzoom));Pe&&(this._addTile(Pe.tileID),Y[Pe.tileID.key]=Pe.tileID),Q[me]=we}const ve=C[C.length-1].overscaledZ;for(const me in this._tiles){const we=this._tiles[me];if(G[me]||!we.hasData())continue;let be=we.tileID;for(;be.overscaledZ>ve;){be=be.scaledTo(be.overscaledZ-1);const Pe=this._tiles[be.key];if(Pe&&Pe.hasData()&&Q[be.key]){G[me]=we.tileID;break}}}for(const me in Y)G[me]||(this._coveredTiles[me]=!0,G[me]=Y[me])}for(const Y in G)this._tiles[Y].clearFadeHold();const j=o.bf(this._tiles,G);for(const Y of j){const Q=this._tiles[Y];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+Y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const p={},b=r.reduce((G,j)=>Math.min(G,j.overscaledZ),1/0),w=r[0].overscaledZ,C=Math.max(w-ss.maxOverzooming,this._source.minzoom),O=Math.max(w+ss.maxUnderzooming,this._source.minzoom),V={};for(const G of r){const j=this._addTile(G);l[G.key]=G,j.hasData()||b<this._source.maxzoom&&(V[G.key]=G)}this._retainLoadedChildren(V,b,O,l);for(const G of r){let j=this._tiles[G.key];if(j.hasData())continue;if(G.canonical.z>=this._source.maxzoom){const Q=G.children(this._source.maxzoom)[0],ie=this.getTile(Q);if(ie&&ie.hasData()){l[Q.key]=Q;continue}}else{const Q=G.children(this._source.maxzoom);if(l[Q[0].key]&&l[Q[1].key]&&l[Q[2].key]&&l[Q[3].key])continue}let Y=j.wasRequested();for(let Q=G.overscaledZ-1;Q>=C;--Q){const ie=G.scaledTo(Q);if(p[ie.key]||(p[ie.key]=!0,j=this.getTile(ie),!j&&Y&&(j=this._addTile(ie)),j&&(l[ie.key]=ie,Y=j.wasRequested(),j.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let p,b=this._tiles[r].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){p=this._loadedParentTiles[b.key];break}l.push(b.key);const w=b.scaledTo(b.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;b=w}for(const w of l)this._loadedParentTiles[w]=p}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const p=!!l;if(!p){const b=this.map?this.map.painter:null,w=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new $h(r,w,this.transform.tileZoom,b,this._isRaster):new wa(r,w,this.transform.tileZoom,b,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,p||this._source.fire(new o.x("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=l.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,p){const b=[],w=this.transform;if(!w)return b;const C=w.projection.name==="globe",O=o.am(w.center.lng);for(const V in this._tiles){const G=this._tiles[V];if(p&&G.clearQueryDebugViz(),G.holdingForFade())continue;let j;if(C){const Y=G.tileID.canonical;if(Y.z===0){const Q=[Math.abs(o.ap(O,...Nc(Y,-1))-O),Math.abs(o.ap(O,...Nc(Y,1))-O)];j=[0,2*Q.indexOf(Math.min(...Q))-1]}else{const Q=[Math.abs(o.ap(O,...Nc(Y,-1))-O),Math.abs(o.ap(O,...Nc(Y,0))-O),Math.abs(o.ap(O,...Nc(Y,1))-O)];j=[Q.indexOf(Math.min(...Q))-1]}}else j=[0];for(const Y of j){const Q=r.containsTile(G,w,l,Y);Q&&b.push(Q)}}return b}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const p=this.getRenderableIds(r,l).map(w=>this._tiles[w].tileID),b=this.transform.projection.name==="globe";for(const w of p)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=b?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return p}sortCoordinatesByDistance(r){const l=r.slice(),p=this.transform._camera.position,b=this.transform._camera.forward(),w={};for(const C of l){const O=1/(1<<C.canonical.z);w[C.key]=((C.canonical.x+.5)*O+C.wrap-p[0])*b[0]+((C.canonical.y+.5)*O-p[1])*b[1]-p[2]*b[2]}return l.sort((C,O)=>w[C.key]-w[O.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(fd(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.q.now())return!0}return!1}setFeatureState(r,l,p){this._state.updateState(r=r||"_geojsonTileLayer",l,p)}removeFeatureState(r,l,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,p)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,p){const b=this._tiles[r];b&&b.setDependencies(l,p)}reloadTilesForDependencies(r,l){for(const p in this._tiles)this._tiles[p].hasDependency(r,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const V=()=>{this._sourceLoaded&&(this._source.off("data",V),this._preloadTiles(r,l))};return void this._source.on("data",V)}const p=new Map,b=Array.isArray(r)?r:[r],w=this.map.painter.terrain,C=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const V of b){const G=V.coveringTiles({tileSize:C,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const j of G)p.set(j.key,j);this.usedForTerrain&&V.updateElevation(!1)}const O=Array.from(p.values());o.bg(O,(V,G)=>{const j=new wa(V,this._source.tileSize*V.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(j,Y=>{this._source.type==="raster-dem"&&j.dem&&this._backfillDEM(j),G(Y,j)})},l)}}function Ml(f,r){const l=Math.abs(2*f.wrap)-+(f.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return f.overscaledZ-r.overscaledZ||p-l||r.canonical.y-f.canonical.y||r.canonical.x-f.canonical.x}function fd(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function Nc(f,r){const l=1<<f.z;return[f.x/l+r,(f.x+1)/l+r]}ss.maxOverzooming=10,ss.maxUnderzooming=3;class rm{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const p in this.style._mergedLayers){const b=this.style._mergedLayers[p];if(b.type==="fill-extrusion")this.layers.push({layer:b,visible:r,visibilityChanged:l});else if(b.type==="model"){const w=this.style.getLayerSource(b);w&&w.type==="batched-model"&&this.layers.push({layer:b,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const p=l.layer;let b=!1;p.type==="fill-extrusion"?b=!p.isHidden(r)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(b=!p.isHidden(r)&&p.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!b&&l.visible,l.visible=b}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const b of this.layers){const w=b.layer,C=this.style.getLayerSourceCache(w);let O=1;w.type==="fill-extrusion"&&(O=b.visible?w.paint.get("fill-extrusion-vertical-scale"):0);let V=C?C.getTile(l):null;if(!V&&C&&l.canonical.z>C.getSource().minzoom){let G=l.scaledTo(Math.min(C.getSource().maxzoom,l.overscaledZ-1));for(;G.overscaledZ>=C.getSource().minzoom&&(V=C.getTile(G),!V&&G.overscaledZ!==0);)G=G.scaledTo(G.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:V?V.getBucket(w):null,tileID:V?V.tileID:l,verticalScale:O})}r.hasAnyZOffset=!1;let p=!1;for(let b=0;b<r.symbolInstances.length;b++){const w=r.symbolInstances.get(b),C=w.zOffset,O=this._getHeightAtTileOffset(l,w.tileAnchorX,w.tileAnchorY);w.zOffset=O!==Number.NEGATIVE_INFINITY?O:C,p||C===w.zOffset||(p=!0),r.hasAnyZOffset||w.zOffset===0||(r.hasAnyZOffset=!0)}p&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,p,b){let w=l,C=p;if(r.canonical.z!==b.canonical.z){const O=b.canonical,V=1/(1<<r.canonical.z-O.z);w=(l+r.canonical.x*o.ab)*V-O.x*o.ab|0,C=(p+r.canonical.y*o.ab)*V-O.y*o.ab|0}return{tileX:w,tileY:C}}_getHeightAtTileOffset(r,l,p){let b,w;for(let C=0;C<this.layers.length;++C){if(this.layers[C].layer.type!=="fill-extrusion")continue;const{bucket:O,tileID:V,verticalScale:G}=this.currentBuildingBuckets[C];if(!O)continue;const{tileX:j,tileY:Y}=this._mapCoordToOverlappingTile(r,l,p,V),Q=O.getHeightAtTileCoord(j,Y);Q&&Q.height!==void 0&&(Q.hidden?b=Q.height:w=Math.max(Q.height*G,w||0))}if(w!==void 0)return w;for(let C=0;C<this.layers.length;++C){const O=this.layers[C];if(O.layer.type!=="model"||!O.visible)continue;const{bucket:V,tileID:G}=this.currentBuildingBuckets[C];if(!V)continue;const{tileX:j,tileY:Y}=this._mapCoordToOverlappingTile(r,l,p,G),Q=V.getHeightAtTileCoord(j,Y);if(Q&&!Q.hidden)return Q.height===void 0&&b!==void 0?Math.min(Q.maxHeight,b)*Q.verticalScale:Q.height?Q.height*Q.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function $c(f,r){const l={};for(const p in f)p!=="ref"&&(l[p]=f[p]);return o.bh.forEach(p=>{p in r&&(l[p]=r[p])}),l}function im(f){f=f.slice();const r=Object.create(null);for(let l=0;l<f.length;l++)r[f[l].id]=f[l];for(let l=0;l<f.length;l++)"ref"in f[l]&&(f[l]=$c(f[l],r[f[l].ref]));return f}const rr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function sm(f,r,l){l.push({command:rr.addSource,args:[f,r[f]]})}function pr(f,r,l){r.push({command:rr.removeSource,args:[f]}),l[f]=!0}function m1(f,r,l,p){pr(f,l,p),sm(f,r,l)}function mo(f,r,l){let p;for(p in f[l])if(f[l].hasOwnProperty(p)&&p!=="data"&&!o.bi(f[l][p],r[l][p]))return!1;for(p in r[l])if(r[l].hasOwnProperty(p)&&p!=="data"&&!o.bi(f[l][p],r[l][p]))return!1;return!0}function pd(f,r,l,p,b,w){let C;for(C in r=r||{},f=f||{})f.hasOwnProperty(C)&&(o.bi(f[C],r[C])||l.push({command:w,args:[p,C,r[C],b]}));for(C in r)r.hasOwnProperty(C)&&!f.hasOwnProperty(C)&&(o.bi(f[C],r[C])||l.push({command:w,args:[p,C,r[C],b]}))}function rc(f){return f.id}function Vc(f,r){return f[r.id]=r,f}class na{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ap(r,0,1);let l=1,p=this._distances[l];const b=r*this.paddedLength+this.padding;for(;p<b&&l<this._distances.length;)p=this._distances[++l];const w=l-1,C=this._distances[w],O=p-C,V=O>0?(b-C)/O:0;return this.points[w].mult(1-V).add(this.points[l].mult(V))}}class Vh{constructor(r,l,p){const b=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(l/p);for(let C=0;C<this.xCellCount*this.yCellCount;C++)b.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,p,b,w){this._forEachCell(l,p,b,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(w)}insertCircle(r,l,p,b){this._forEachCell(l-b,p-b,l+b,p+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(p),this.circles.push(b)}_insertBoxCell(r,l,p,b,w,C){this.boxCells[w].push(C)}_insertCircleCell(r,l,p,b,w,C){this.circleCells[w].push(C)}_query(r,l,p,b,w,C){if(p<0||r>this.width||b<0||l>this.height)return!w&&[];const O=[];if(r<=0&&l<=0&&this.width<=p&&this.height<=b){if(w)return!0;for(let V=0;V<this.boxKeys.length;V++)O.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const G=this.circles[3*V],j=this.circles[3*V+1],Y=this.circles[3*V+2];O.push({key:this.circleKeys[V],x1:G-Y,y1:j-Y,x2:G+Y,y2:j+Y})}return C?O.filter(C):O}return this._forEachCell(r,l,p,b,this._queryCell,O,{hitTest:w,seenUids:{box:{},circle:{}}},C),w?O.length>0:O}_queryCircle(r,l,p,b,w){const C=r-p,O=r+p,V=l-p,G=l+p;if(O<0||C>this.width||G<0||V>this.height)return!b&&[];const j=[];return this._forEachCell(C,V,O,G,this._queryCellCircle,j,{hitTest:b,circle:{x:r,y:l,radius:p},seenUids:{box:{},circle:{}}},w),b?j.length>0:j}query(r,l,p,b,w){return this._query(r,l,p,b,!1,w)}hitTest(r,l,p,b,w){return this._query(r,l,p,b,!0,w)}hitTestCircle(r,l,p,b){return this._queryCircle(r,l,p,!0,b)}_queryCell(r,l,p,b,w,C,O,V){const G=O.seenUids,j=this.boxCells[w];if(j!==null){const Q=this.bboxes;for(const ie of j)if(!G.box[ie]){G.box[ie]=!0;const ve=4*ie;if(r<=Q[ve+2]&&l<=Q[ve+3]&&p>=Q[ve+0]&&b>=Q[ve+1]&&(!V||V(this.boxKeys[ie]))){if(O.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[ie],x1:Q[ve],y1:Q[ve+1],x2:Q[ve+2],y2:Q[ve+3]})}}}const Y=this.circleCells[w];if(Y!==null){const Q=this.circles;for(const ie of Y)if(!G.circle[ie]){G.circle[ie]=!0;const ve=3*ie;if(this._circleAndRectCollide(Q[ve],Q[ve+1],Q[ve+2],r,l,p,b)&&(!V||V(this.circleKeys[ie]))){if(O.hitTest)return C.push(!0),!0;{const me=Q[ve],we=Q[ve+1],be=Q[ve+2];C.push({key:this.circleKeys[ie],x1:me-be,y1:we-be,x2:me+be,y2:we+be})}}}}}_queryCellCircle(r,l,p,b,w,C,O,V){const G=O.circle,j=O.seenUids,Y=this.boxCells[w];if(Y!==null){const ie=this.bboxes;for(const ve of Y)if(!j.box[ve]){j.box[ve]=!0;const me=4*ve;if(this._circleAndRectCollide(G.x,G.y,G.radius,ie[me+0],ie[me+1],ie[me+2],ie[me+3])&&(!V||V(this.boxKeys[ve])))return C.push(!0),!0}}const Q=this.circleCells[w];if(Q!==null){const ie=this.circles;for(const ve of Q)if(!j.circle[ve]){j.circle[ve]=!0;const me=3*ve;if(this._circlesCollide(ie[me],ie[me+1],ie[me+2],G.x,G.y,G.radius)&&(!V||V(this.circleKeys[ve])))return C.push(!0),!0}}}_forEachCell(r,l,p,b,w,C,O,V){const G=this._convertToXCellCoord(r),j=this._convertToYCellCoord(l),Y=this._convertToXCellCoord(p),Q=this._convertToYCellCoord(b);for(let ie=G;ie<=Y;ie++)for(let ve=j;ve<=Q;ve++)if(w.call(this,r,l,p,b,this.xCellCount*ve+ie,C,O,V))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,p,b,w,C){const O=b-r,V=w-l,G=p+C;return G*G>O*O+V*V}_circleAndRectCollide(r,l,p,b,w,C,O){const V=(C-b)/2,G=Math.abs(r-(b+V));if(G>V+p)return!1;const j=(O-w)/2,Y=Math.abs(l-(w+j));if(Y>j+p)return!1;if(G<=V||Y<=j)return!0;const Q=G-V,ie=Y-j;return Q*Q+ie*ie<=p*p}}const oa={unknown:0,flipRequired:1,flipNotRequired:2},qn=Math.tan(85*Math.PI/180);function Xo(f,r,l,p,b,w,C){const O=o.a6.mat4.create();if(l)if(w.name==="globe"){const V=o.bj(b,r);o.a6.mat4.multiply(O,O,V)}else{const V=o.a6.mat2.invert([],C);O[0]=V[0],O[1]=V[1],O[4]=V[2],O[5]=V[3],p||o.a6.mat4.rotateZ(O,O,b.angle)}else o.a6.mat4.multiply(O,b.labelPlaneMatrix,f);return O}function Jo(f,r,l,p,b,w,C){const O=Xo(f,r,l,p,b,w,C);return w.name==="globe"&&l||(O[2]=O[6]=O[10]=O[14]=0),O}function as(f,r,l,p,b,w,C){if(l){if(w.name==="globe"){const O=Xo(f,r,l,p,b,w,C);return o.a6.mat4.invert(O,O),o.a6.mat4.multiply(O,f,O),O}{const O=o.a6.mat4.clone(f),V=o.a6.mat4.identity([]);return V[0]=C[0],V[1]=C[1],V[4]=C[2],V[5]=C[3],o.a6.mat4.multiply(O,O,V),p||o.a6.mat4.rotateZ(O,O,-b.angle),O}}return b.glCoordMatrix}function Hi(f,r,l,p){const b=[f,r,l,1];l?o.a6.vec4.transformMat4(b,b,p):jh(b,b,p);const w=b[3];return b[0]/=w,b[1]/=w,b[2]/=w,b}function tr(f,r){return Math.min(.5+f/r*.5,1.5)}function Uh(f,r){const l=f[0]/f[3],p=f[1]/f[3];return l>=-r[0]&&l<=r[0]&&p>=-r[1]&&p<=r[1]}function Uc(f,r,l,p,b,w,C,O,V,G){const j=l.transform,Y=p?f.textSizeData:f.iconSizeData,Q=o.bk(Y,l.transform.zoom),ie=j.projection.name==="globe",ve=[256/l.width*2+1,256/l.height*2+1],me=p?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;me.clear();let we=null;ie&&(we=p?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const be=f.lineVertexArray,Pe=p?f.text.placedSymbolArray:f.icon.placedSymbolArray,$e=l.transform.width/l.transform.height;let Ve,We=!1;for(let Xe=0;Xe<Pe.length;Xe++){const Ke=Pe.get(Xe),{numGlyphs:Je,writingMode:rt}=Ke;if(rt!==o.bl.vertical||We||Ve===o.bl.horizontal||(We=!0),Ve=rt,(Ke.hidden||rt===o.bl.vertical)&&!We){Sa(Je,me);continue}We=!1;const ht=new o.P(Ke.tileAnchorX,Ke.tileAnchorY);let{x:lt,y:st,z:Lt}=j.projection.projectTilePoint(ht.x,ht.y,G.canonical);if(V){const[nn,An,Zn]=V(ht);lt+=nn,st+=An,Lt+=Zn}const Wt=[lt,st,Lt,1];if(o.a6.vec4.transformMat4(Wt,Wt,r),!Uh(Wt,ve)){Sa(Je,me);continue}const ln=Wt[3],yn=tr(l.transform.getCameraToCenterDistance(j.projection),ln),Tn=o.bm(Y,Q,Ke),wt=C?Tn/yn:Tn*yn,on=Hi(lt,st,Lt,b);if(on[3]<=0){Sa(Je,me);continue}let Vt={};const rn=C?null:V,hn=ii(Ke,wt,!1,O,r,b,w,f.glyphOffsetArray,be,me,we,on,ht,Vt,$e,rn,j.projection,G,C);We=hn.useVertical,rn&&hn.needsFlipping&&(Vt={}),(hn.notEnoughRoom||We||hn.needsFlipping&&ii(Ke,wt,!0,O,r,b,w,f.glyphOffsetArray,be,me,we,on,ht,Vt,$e,rn,j.projection,G,C).notEnoughRoom)&&Sa(Je,me)}p?(f.text.dynamicLayoutVertexBuffer.updateData(me),we&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(we)):(f.icon.dynamicLayoutVertexBuffer.updateData(me),we&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(we))}function jc(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me){const{lineStartIndex:we,glyphStartIndex:be,segment:Pe}=O,$e=be+O.numGlyphs,Ve=we+O.lineLength,We=r.getoffsetX(be),Xe=r.getoffsetX($e-1),Ke=Gc(f*We,l,p,b,w,C,Pe,we,Ve,V,G,j,Y,Q,!0,ie,ve,me);if(!Ke)return null;const Je=Gc(f*Xe,l,p,b,w,C,Pe,we,Ve,V,G,j,Y,Q,!0,ie,ve,me);return Je?{first:Ke,last:Je}:null}function Yi(f,r,l,p){return f===o.bl.horizontal&&Math.abs(p)>Math.abs(l)?{useVertical:!0}:f===o.bl.vertical?p>0?{needsFlipping:!0}:null:r!==oa.unknown&&function(b,w){return b===0||Math.abs(w/b)>qn}(l,p)?r===oa.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function ii(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we,be,Pe){const $e=r/24,Ve=f.lineOffsetX*$e,We=f.lineOffsetY*$e,{lineStartIndex:Xe,glyphStartIndex:Ke,numGlyphs:Je,segment:rt,writingMode:ht,flipState:lt}=f,st=Xe+f.lineLength,Lt=Wt=>{if(j){const[wt,on,Vt]=Wt.up,rn=G.length;o.bn(j,rn+0,wt,on,Vt),o.bn(j,rn+1,wt,on,Vt),o.bn(j,rn+2,wt,on,Vt),o.bn(j,rn+3,wt,on,Vt)}const[ln,yn,Tn]=Wt.point;o.bo(G,ln,yn,Tn,Wt.angle)};if(Je>1){const Wt=jc($e,O,Ve,We,l,Y,Q,f,V,w,ie,me,!1,we,be,Pe);if(!Wt)return{notEnoughRoom:!0};if(p&&!l){let[ln,yn,Tn]=Wt.first.point,[wt,on,Vt]=Wt.last.point;[ln,yn]=Hi(ln,yn,Tn,C),[wt,on]=Hi(wt,on,Vt,C);const rn=Yi(ht,lt,(wt-ln)*ve,on-yn);if(f.flipState=rn&&rn.needsFlipping?oa.flipRequired:oa.flipNotRequired,rn)return rn}Lt(Wt.first);for(let ln=Ke+1;ln<Ke+Je-1;ln++){const yn=Gc($e*O.getoffsetX(ln),Ve,We,l,Y,Q,rt,Xe,st,V,w,ie,me,!1,!1,we,be,Pe);if(!yn)return G.length-=4*(ln-Ke),{notEnoughRoom:!0};Lt(yn)}Lt(Wt.last)}else{if(p&&!l){const ln=Hi(Q.x,Q.y,0,b),yn=Xe+rt+1,Tn=new o.P(V.getx(yn),V.gety(yn)),wt=Hi(Tn.x,Tn.y,0,b),on=wt[3]>0?wt:Hc(Q,Tn,ln,1,b,void 0,we,be.canonical),Vt=Yi(ht,lt,(on[0]-ln[0])*ve,on[1]-ln[1]);if(f.flipState=Vt&&Vt.needsFlipping?oa.flipRequired:oa.flipNotRequired,Vt)return Vt}const Wt=Gc($e*O.getoffsetX(Ke),Ve,We,l,Y,Q,rt,Xe,st,V,w,ie,me,!1,!1,we,be,Pe);if(!Wt)return{notEnoughRoom:!0};Lt(Wt)}return{}}function g_(f,r,l,p,b){const{x:w,y:C,z:O}=p.projectTilePoint(f.x,f.y,r);if(!b)return Hi(w,C,O,l);const[V,G,j]=b(f);return Hi(w+V,C+G,O+j,l)}function Hc(f,r,l,p,b,w,C,O){const V=g_(f.sub(r)._unit()._add(f),O,b,C,w);return o.a6.vec3.sub(V,l,V),o.a6.vec3.normalize(V,V),o.a6.vec3.scaleAndAdd(V,l,V,p)}function Gc(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we,be){const Pe=p?f-r:f+r;let $e=Pe>0?1:-1,Ve=0;p&&($e*=-1,Ve=Math.PI),$e<0&&(Ve+=Math.PI);let We=O+C+($e>0?0:1)|0,Xe=b,Ke=b,Je=0,rt=0;const ht=Math.abs(Pe),lt=[],st=[];let Lt=w,Wt=Lt;const ln=()=>Hc(Wt,Lt,Ke,ht-Je+1,j,Q,me,we.canonical);for(;Je+rt<=ht;){if(We+=$e,We<O||We>=V)return null;if(Ke=Xe,Wt=Lt,lt.push(Ke),ie&&st.push(Wt),Lt=new o.P(G.getx(We),G.gety(We)),Xe=Y[We],!Xe){const An=g_(Lt,we.canonical,j,me,Q);Xe=An[3]>0?Y[We]=An:ln()}Je+=rt,rt=o.a6.vec3.distance(Ke,Xe)}ve&&Q&&(Y[We]&&(Xe=ln(),rt=o.a6.vec3.distance(Ke,Xe)),Y[We]=Xe);const yn=(ht-Je)/rt,Tn=Lt.sub(Wt)._mult(yn)._add(Wt),wt=o.a6.vec3.sub([],Xe,Ke),on=o.a6.vec3.scaleAndAdd([],Ke,wt,yn);let Vt=[0,0,1],rn=wt[0],hn=wt[1];if(be&&(Vt=me.upVector(we.canonical,Tn.x,Tn.y),Vt[0]!==0||Vt[1]!==0||Vt[2]!==1)){const An=[Vt[2],0,-Vt[0]],Zn=o.a6.vec3.cross([],Vt,An);o.a6.vec3.normalize(An,An),o.a6.vec3.normalize(Zn,Zn),rn=o.a6.vec3.dot(wt,An),hn=o.a6.vec3.dot(wt,Zn)}if(l){const An=o.a6.vec3.cross([],Vt,wt);o.a6.vec3.normalize(An,An),o.a6.vec3.scaleAndAdd(on,on,An,l*$e)}const nn=Ve+Math.atan2(hn,rn);return lt.push(on),ie&&st.push(Tn),{point:on,angle:nn,path:lt,tilePath:st,up:Vt}}function Sa(f,r){const l=r.length,p=l+4*f;r.resize(p),r.float32.fill(-1/0,4*l,4*p)}function jh(f,r,l){const p=r[0],b=r[1];return f[0]=l[0]*p+l[4]*b+l[12],f[1]=l[1]*p+l[5]*b+l[13],f[3]=l[3]*p+l[7]*b+l[15],f}const ws=100;class Gi{constructor(r,l,p=new Vh(r.width+200,r.height+200,25),b=new Vh(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=b,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+ws,this.screenBottomBoundary=r.height+ws,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,p,b,w,C,O,V){let G=p.projectedAnchorX,j=p.projectedAnchorY,Y=p.projectedAnchorZ;const Q=p.elevation,ie=p.tileID,ve=r.getProjection();if(Q&&ie){const[Xe,Ke,Je]=ve.upVector(ie.canonical,p.tileAnchorX,p.tileAnchorY),rt=ve.upVectorScale(ie.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=Xe*Q*rt,j+=Ke*Q*rt,Y+=Je*Q*rt}const me=this.projectAndGetPerspectiveRatio(O,G,j,Y,p.tileID,ve.name==="globe"||!!Q||this.transform.pitch>0,ve),we=C*me.perspectiveRatio,be=(p.x1*l+b.x-p.padding)*we+me.point.x,Pe=(p.y1*l+b.y-p.padding)*we+me.point.y,$e=(p.x2*l+b.x+p.padding)*we+me.point.x,Ve=(p.y2*l+b.y+p.padding)*we+me.point.y,We=me.perspectiveRatio<=.55||me.occluded;return!this.isInsideGrid(be,Pe,$e,Ve)||!w&&this.grid.hitTest(be,Pe,$e,Ve,V)||We?{box:[],offscreen:!1,occluded:me.occluded}:{box:[be,Pe,$e,Ve],offscreen:this.isOffscreen(be,Pe,$e,Ve),occluded:!1}}placeCollisionCircles(r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me){const we=[],be=this.transform.elevation,Pe=r.getProjection(),$e=be?be.getAtTileOffsetFunc(me,this.transform.center.lat,this.transform.worldSize,Pe):null,Ve=new o.P(p.tileAnchorX,p.tileAnchorY);let{x:We,y:Xe,z:Ke}=Pe.projectTilePoint(Ve.x,Ve.y,me.canonical);if($e){const[Tn,wt,on]=$e(Ve);We+=Tn,Xe+=wt,Ke+=on}const Je=Pe.name==="globe",rt=this.projectAndGetPerspectiveRatio(O,We,Xe,Ke,me,Je||!!be||this.transform.pitch>0,Pe),{perspectiveRatio:ht}=rt,lt=(Y?C/ht:C*ht)/o.br,st=Hi(We,Xe,Ke,V),Lt=rt.signedDistanceFromCamera>0?jc(lt,w,p.lineOffsetX*lt,p.lineOffsetY*lt,!1,st,Ve,p,b,V,{},be&&!Y?$e:null,Y&&!!be,Pe,me,Y):null;let Wt=!1,ln=!1,yn=!0;if(Lt&&!rt.occluded){const Tn=.5*ie*ht+ve,wt=new o.P(-100,-100),on=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Vt=new na,{first:rn,last:hn}=Lt,nn=rn.path.length;let An=[];for(let Hn=nn-1;Hn>=1;Hn--)An.push(rn.path[Hn]);for(let Hn=1;Hn<hn.path.length;Hn++)An.push(hn.path[Hn]);const Zn=2.5*Tn;G&&(An=An.map(([Hn,oo,Rn],ho)=>($e&&!Je&&(Rn=$e(ho<nn-1?rn.tilePath[nn-1-ho]:hn.tilePath[ho-nn+2])[2]),Hi(Hn,oo,Rn,G))),An.some(Hn=>Hn[3]<=0)&&(An=[]));let to=[];if(An.length>0){let Hn=1/0,oo=-1/0,Rn=1/0,ho=-1/0;for(const Io of An)Hn=Math.min(Hn,Io[0]),Rn=Math.min(Rn,Io[1]),oo=Math.max(oo,Io[0]),ho=Math.max(ho,Io[1]);oo>=wt.x&&Hn<=on.x&&ho>=wt.y&&Rn<=on.y&&(to=[An.map(Io=>new o.P(Io[0],Io[1]))],(Hn<wt.x||oo>on.x||Rn<wt.y||ho>on.y)&&(to=o.bp(to,wt.x,wt.y,on.x,on.y)))}for(const Hn of to){Vt.reset(Hn,.25*Tn);let oo=0;oo=Vt.length<=.5*Tn?1:Math.ceil(Vt.paddedLength/Zn)+1;for(let Rn=0;Rn<oo;Rn++){const ho=Rn/Math.max(oo-1,1),Io=Vt.lerp(ho),Go=Io.x+ws,Sr=Io.y+ws;we.push(Go,Sr,Tn,0);const nr=Go-Tn,Dr=Sr-Tn,ar=Go+Tn,Tr=Sr+Tn;if(yn=yn&&this.isOffscreen(nr,Dr,ar,Tr),ln=ln||this.isInsideGrid(nr,Dr,ar,Tr),!l&&this.grid.hitTestCircle(Go,Sr,Tn,Q)&&(Wt=!0,!j))return{circles:[],offscreen:!1,collisionDetected:Wt,occluded:!1}}}}return{circles:!j&&Wt||!ln?[]:we,offscreen:yn,collisionDetected:Wt,occluded:rt.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let p=1/0,b=1/0,w=-1/0,C=-1/0;for(const j of r){const Y=new o.P(j.x+ws,j.y+ws);p=Math.min(p,Y.x),b=Math.min(b,Y.y),w=Math.max(w,Y.x),C=Math.max(C,Y.y),l.push(Y)}const O=this.grid.query(p,b,w,C).concat(this.ignoredGrid.query(p,b,w,C)),V={},G={};for(const j of O){const Y=j.key;if(V[Y.bucketInstanceId]===void 0&&(V[Y.bucketInstanceId]={}),V[Y.bucketInstanceId][Y.featureIndex])continue;const Q=[new o.P(j.x1,j.y1),new o.P(j.x2,j.y1),new o.P(j.x2,j.y2),new o.P(j.x1,j.y2)];o.bq(l,Q)&&(V[Y.bucketInstanceId][Y.featureIndex]=!0,G[Y.bucketInstanceId]===void 0&&(G[Y.bucketInstanceId]=[]),G[Y.bucketInstanceId].push(Y.featureIndex))}return G}insertCollisionBox(r,l,p,b,w){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:b,collisionGroupID:w},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,p,b,w){const C=l?this.ignoredGrid:this.grid,O={bucketInstanceId:p,featureIndex:b,collisionGroupID:w};for(let V=0;V<r.length;V+=4)C.insertCircle(O,r[V],r[V+1],r[V+2])}projectAndGetPerspectiveRatio(r,l,p,b,w,C,O){const V=[l,p,b,1];let G=!1;b||this.transform.pitch>0?(o.a6.vec4.transformMat4(V,V,r),this.fogState&&w&&O.name!=="globe"&&(G=function(Q,ie,ve,me,we,be){const Pe=be.calculateFogTileMatrix(we),$e=[ie,ve,me];return o.a6.vec3.transformMat4($e,$e,Pe),Ht(Q,o.a6.vec3.length($e),be.pitch,be._fov)}(this.fogState,l,p,b,w.toUnwrapped(),this.transform)>.9)):jh(V,V,r);const j=V[3];return{point:new o.P((V[0]/j+1)/2*this.transform.width+ws,(-V[1]/j+1)/2*this.transform.height+ws),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/j*.5,1.5),signedDistanceFromCamera:j,occluded:C&&V[2]>j||G}}isOffscreen(r,l,p,b){return p<ws||r>=this.screenRightBoundary||b<ws||l>this.screenBottomBoundary}isInsideGrid(r,l,p,b){return p>=0&&r<this.gridRightBoundary&&b>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=o.a6.mat4.identity([]);return o.a6.mat4.translate(r,r,[-100,-100,0]),r}}function Xi(f,r,l){const p=r.createTileMatrix(f,f.worldSize,l.toUnwrapped());return o.a6.mat4.multiply(new Float32Array(16),f.projMatrix,p)}function v_(f,r,l){if(r.projection.name===l.projection.name)return f.projMatrix;const p=l.clone();return p.setProjection(r.projection),Xi(p,r.getProjection(),f)}function Il(f,r,l){return r.name===l.projection.name?f.projMatrix:Xi(l,r,f)}class pi{constructor(r,l,p,b){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):b&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Ji{constructor(r,l,p,b,w,C=!1){this.text=new pi(r?r.text:null,l,p,w),this.icon=new pi(r?r.icon:null,l,b,w),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ra{constructor(r,l,p,b=!1){this.text=r,this.icon=l,this.skipFade=p,this.clipped=b}}class Ci{constructor(){this.invProjMatrix=o.a6.mat4.create(),this.viewportMatrix=o.a6.mat4.create(),this.circles=[]}}class am{constructor(r,l,p,b,w){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=b,this.tileID=w}}class ia{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[r]}}function Wc(f,r,l,p,b){const{horizontalAlign:w,verticalAlign:C}=o.by(f),O=-(w-.5)*r,V=-(C-.5)*l,G=o.bx(f,p);return new o.P(O+G[0]*b,V+G[1]*b)}function ic(f,r,l,p,b){const w=new o.P(f,r);return l&&w._rotate(p?b:-b),w}class sc{constructor(r,l,p,b,w,C){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Gi(this.transform,w),this.buildingIndex=C,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new ia(p),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,p,b,w=1){const C=p.getBucket(l),O=p.latestFeatureIndex;if(!C||!O||l.fqid!==C.layerIds[0])return;const V=C.layers[0].layout,G=C.layers[0].paint,j=p.collisionBoxArray,Y=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),Q=p.tileSize/o.ab,ie=p.tileID.toUnwrapped();this.transform.setProjection(C.projection);const ve=(me=p.tileID,we=C.getProjection(),be=this.transform,we.name===this.projection?be.calculateProjMatrix(me.toUnwrapped()):Xi(be,we,me));var me,we,be;const Pe=V.get("text-pitch-alignment")==="map",$e=V.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const Ve=l.dynamicFilter(),We=l.dynamicFilterNeedsFeature(),Xe=this.transform.calculatePixelsToTileUnitsMatrix(p),Ke=Jo(ve,p.tileID.canonical,Pe,$e,this.transform,C.getProjection(),Xe);let Je=null;if(Pe){const ln=as(ve,p.tileID.canonical,Pe,$e,this.transform,C.getProjection(),Xe);Je=o.a6.mat4.multiply([],this.transform.labelPlaneMatrix,ln)}let rt=null;Ve&&p.latestFeatureIndex&&(rt={unwrappedTileID:ie,dynamicFilter:Ve,dynamicFilterNeedsFeature:We}),this.retainedQueryData[C.bucketInstanceId]=new am(C.bucketInstanceId,O,C.sourceLayerIndex,C.index,p.tileID);const ht=C.layers[0].layout.get("text-size-scale-range"),lt=o.ap(w,ht[0],ht[1]),st=C.layers[0].layout.get("icon-size-scale-range"),Lt=o.ap(w,st[0],st[1]),Wt={bucket:C,layout:V,paint:G,posMatrix:ve,textLabelPlaneMatrix:Ke,labelToScreenMatrix:Je,clippingData:rt,scale:Y,textPixelRatio:Q,holdingForFade:p.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:o.bk(C.textSizeData,this.transform.zoom,lt),partiallyEvaluatedIconSize:o.bk(C.iconSizeData,this.transform.zoom,Lt),collisionGroup:this.collisionGroups.get(C.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(b)for(const ln of C.sortKeyRanges){const{sortKey:yn,symbolInstanceStart:Tn,symbolInstanceEnd:wt}=ln;r.push({sortKey:yn,symbolInstanceStart:Tn,symbolInstanceEnd:wt,parameters:Wt})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Wt})}attemptAnchorPlacement(r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we,be,Pe){const{textOffset0:$e,textOffset1:Ve,crossTileID:We}=Q,Xe=[$e,Ve],Ke=Wc(r,p,b,Xe,w),Je=this.collisionIndex.placeCollisionBox(ve,w,l,ic(Ke.x,Ke.y,C,O,this.transform.angle),Y,V,G,j.predicate);if(we){const rt=ve.getSymbolInstanceIconSize(Pe,this.transform.zoom,Q.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ve,rt,we,ic(Ke.x,Ke.y,C,O,this.transform.angle),Y,V,G,j.predicate).box.length===0)return}if(Je.box.length>0){let rt;return this.prevPlacement&&this.prevPlacement.variableOffsets[We]&&this.prevPlacement.placements[We]&&this.prevPlacement.placements[We].text&&(rt=this.prevPlacement.variableOffsets[We].anchor),this.variableOffsets[We]={textOffset:Xe,width:p,height:b,anchor:r,textScale:w,prevAnchor:rt},this.markUsedJustification(ve,r,Q,me),ve.allowVerticalPlacement&&(this.markUsedOrientation(ve,me,Q),this.placedOrientations[We]=me),{shift:Ke,placedGlyphBoxes:Je}}}placeLayerBucketPart(r,l,p,b,w=1){const{bucket:C,layout:O,paint:V,posMatrix:G,textLabelPlaneMatrix:j,labelToScreenMatrix:Y,clippingData:Q,textPixelRatio:ie,holdingForFade:ve,collisionBoxArray:me,partiallyEvaluatedTextSize:we,partiallyEvaluatedIconSize:be,collisionGroup:Pe,latestFeatureIndex:$e}=r.parameters,Ve=O.get("text-optional"),We=O.get("icon-optional"),Xe=O.get("text-allow-overlap"),Ke=O.get("icon-allow-overlap"),Je=O.get("text-rotation-alignment")==="map",rt=O.get("text-pitch-alignment")==="map",ht=O.get("symbol-z-elevate"),lt=V.get("symbol-z-offset"),st=O.get("symbol-elevation-reference")==="sea",Lt=O.get("text-size-scale-range"),Wt=O.get("icon-size-scale-range"),ln=o.ap(w,Lt[0],Lt[1]),yn=o.ap(w,Wt[0],Wt[1]);this.transform.setProjection(C.projection);let Tn=Xe&&(Ke||!C.hasIconData()||We),wt=Ke&&(Xe||!C.hasTextData()||Ve);const on=!lt.isConstant();!C.collisionArrays&&me&&C.deserializeCollisionBoxes(me),p&&b&&C.updateCollisionDebugBuffers(this.transform.zoom,me,ln,yn);const Vt=(rn,hn,nn)=>{const{crossTileID:An,numVerticalGlyphVertices:Zn}=rn;let to=null;if(Q&&Q.dynamicFilterNeedsFeature||on){const Qo=this.retainedQueryData[C.bucketInstanceId];to=$e.loadFeature({featureIndex:rn.featureIndex,bucketIndex:Qo.bucketIndex,sourceLayerIndex:Qo.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Q&&!(0,Q.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},to,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new o.P(rn.tileAnchorX,rn.tileAnchorY),this.transform.calculateDistanceTileData(Q.unwrappedTileID)))return this.placements[An]=new ra(!1,!1,!1,!0),void l.add(An);const Hn=lt.evaluate(to,{});if(l.has(An))return;if(ve)return void(this.placements[An]=new ra(!1,!1,!1));let oo=!1,Rn=!1,ho=!0,Io=!1,Go=!1,Sr=null,nr={box:null,offscreen:null,occluded:null},Dr={box:null,offscreen:null,occluded:null},ar=null,Tr=null,Vo=null,yr=0,_r=0,cr=0;nn.textFeatureIndex?yr=nn.textFeatureIndex:rn.useRuntimeCollisionCircles&&(yr=rn.featureIndex),nn.verticalTextFeatureIndex&&(_r=nn.verticalTextFeatureIndex);const Nr=Qo=>{Qo.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const Zo=this.transform.elevation;Qo.elevation=st?Hn:Hn+(Zo?Zo.getAtTileOffset(Qo.tileID,Qo.tileAnchorX,Qo.tileAnchorY):0),Qo.elevation+=rn.zOffset},yi=nn.textBox;if(yi){Nr(yi);const Qo=lr=>{let Mr=o.bl.horizontal;if(C.allowVerticalPlacement&&!lr&&this.prevPlacement){const ni=this.prevPlacement.placedOrientations[An];ni&&(this.placedOrientations[An]=ni,Mr=ni,this.markUsedOrientation(C,Mr,rn))}return Mr},Zo=(lr,Mr)=>{if(C.allowVerticalPlacement&&Zn>0&&nn.verticalTextBox){for(const ni of C.writingModes)if(ni===o.bl.vertical?(nr=Mr(),Dr=nr):nr=lr(),nr&&nr.box&&nr.box.length)break}else nr=lr()};if(O.get("text-variable-anchor")){let lr=O.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[An]){const $r=this.prevPlacement.variableOffsets[An];lr.indexOf($r.anchor)>0&&(lr=lr.filter(Ei=>Ei!==$r.anchor),lr.unshift($r.anchor))}const Mr=($r,Ei,Ma)=>{const us=C.getSymbolInstanceTextSize(we,rn,this.transform.zoom,hn),ds=($r.x2-$r.x1)*us+2*$r.padding,Hs=($r.y2-$r.y1)*us+2*$r.padding,la=rn.hasIconTextFit&&!Ke?Ei:null;la&&Nr(la);let hs={box:[],offscreen:!1,occluded:!1};const tl=Xe?2*lr.length:lr.length;for(let Gs=0;Gs<tl;++Gs){const hr=this.attemptAnchorPlacement(lr[Gs%lr.length],$r,ds,Hs,us,Je,rt,ie,G,Pe,Gs>=lr.length,rn,hn,C,Ma,la,we,be);if(hr&&(hs=hr.placedGlyphBoxes,hs&&hs.box&&hs.box.length)){oo=!0,Sr=hr.shift;break}}return hs};Zo(()=>Mr(yi,nn.iconBox,o.bl.horizontal),()=>{const $r=nn.verticalTextBox;return $r&&Nr($r),C.allowVerticalPlacement&&!(nr&&nr.box&&nr.box.length)&&Zn>0&&$r?Mr($r,nn.verticalIconBox,o.bl.vertical):{box:null,offscreen:null,occluded:null}}),nr&&(oo=nr.box,ho=nr.offscreen,Io=nr.occluded);const ni=Qo(!(!nr||!nr.box));if(!oo&&this.prevPlacement){const $r=this.prevPlacement.variableOffsets[An];$r&&(this.variableOffsets[An]=$r,this.markUsedJustification(C,$r.anchor,rn,ni))}}else{const lr=(Mr,ni)=>{const $r=C.getSymbolInstanceTextSize(we,rn,this.transform.zoom,hn,w),Ei=this.collisionIndex.placeCollisionBox(C,$r,Mr,new o.P(0,0),Xe,ie,G,Pe.predicate);return Ei&&Ei.box&&Ei.box.length&&(this.markUsedOrientation(C,ni,rn),this.placedOrientations[An]=ni),Ei};Zo(()=>lr(yi,o.bl.horizontal),()=>{const Mr=nn.verticalTextBox;return C.allowVerticalPlacement&&Zn>0&&Mr?(Nr(Mr),lr(Mr,o.bl.vertical)):{box:null,offscreen:null,occluded:null}}),Qo(!!(nr&&nr.box&&nr.box.length))}}if(ar=nr,oo=ar&&ar.box&&ar.box.length>0,ho=ar&&ar.offscreen,Io=ar&&ar.occluded,rn.useRuntimeCollisionCircles){const Qo=C.text.placedSymbolArray.get(rn.centerJustifiedTextSymbolIndex>=0?rn.centerJustifiedTextSymbolIndex:rn.verticalPlacedTextSymbolIndex),Zo=o.bm(C.textSizeData,we,Qo),lr=O.get("text-padding");Tr=this.collisionIndex.placeCollisionCircles(C,Xe,Qo,C.lineVertexArray,C.glyphOffsetArray,Zo,G,j,Y,p,rt,Pe.predicate,rn.collisionCircleDiameter*Zo/o.br,lr,this.retainedQueryData[C.bucketInstanceId].tileID),oo=Xe||Tr.circles.length>0&&!Tr.collisionDetected,ho=ho&&Tr.offscreen,Io=Tr.occluded}if(nn.iconFeatureIndex&&(cr=nn.iconFeatureIndex),nn.iconBox){const Qo=Zo=>{Nr(Zo);const lr=rn.hasIconTextFit&&Sr?ic(Sr.x,Sr.y,Je,rt,this.transform.angle):new o.P(0,0),Mr=C.getSymbolInstanceIconSize(be,this.transform.zoom,rn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Mr,Zo,lr,Ke,ie,G,Pe.predicate)};Dr&&Dr.box&&Dr.box.length&&nn.verticalIconBox?(Vo=Qo(nn.verticalIconBox),Rn=Vo.box.length>0):(Vo=Qo(nn.iconBox),Rn=Vo.box.length>0),ho=ho&&Vo.offscreen,Go=Vo.occluded}const As=Ve||rn.numHorizontalGlyphVertices===0&&Zn===0,js=We||rn.numIconVertices===0;if(As||js?js?As||(Rn=Rn&&oo):oo=Rn&&oo:Rn=oo=Rn&&oo,oo&&ar&&ar.box&&this.collisionIndex.insertCollisionBox(ar.box,O.get("text-ignore-placement"),C.bucketInstanceId,Dr&&Dr.box&&_r?_r:yr,Pe.ID),Rn&&Vo&&this.collisionIndex.insertCollisionBox(Vo.box,O.get("icon-ignore-placement"),C.bucketInstanceId,cr,Pe.ID),Tr&&(oo&&this.collisionIndex.insertCollisionCircles(Tr.circles,O.get("text-ignore-placement"),C.bucketInstanceId,yr,Pe.ID),p)){const Qo=C.bucketInstanceId;let Zo=this.collisionCircleArrays[Qo];Zo===void 0&&(Zo=this.collisionCircleArrays[Qo]=new Ci);for(let lr=0;lr<Tr.circles.length;lr+=4)Zo.circles.push(Tr.circles[lr+0]),Zo.circles.push(Tr.circles[lr+1]),Zo.circles.push(Tr.circles[lr+2]),Zo.circles.push(Tr.collisionDetected?1:0)}const Si=C.projection.name!=="globe";Tn=Tn&&(Si||!Io),wt=wt&&(Si||!Go),this.placements[An]=new ra(oo||Tn,Rn||wt,ho||C.justReloaded),l.add(An)};if(ht&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,this.retainedQueryData[C.bucketInstanceId].tileID),C.updateZOffset()),C.sortFeaturesByY){const rn=C.getSortedSymbolIndexes(this.transform.angle);for(let hn=rn.length-1;hn>=0;--hn){const nn=rn[hn];Vt(C.symbolInstances.get(nn),nn,C.collisionArrays[nn])}C.hasAnyZOffset&&o.w(`${C.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(C.hasAnyZOffset){const rn=C.getSortedIndexesByZOffset();for(let hn=0;hn<rn.length;++hn){const nn=rn[hn];Vt(C.symbolInstances.get(nn),nn,C.collisionArrays[nn])}}else for(let rn=r.symbolInstanceStart;rn<r.symbolInstanceEnd;rn++)Vt(C.symbolInstances.get(rn),rn,C.collisionArrays[rn]);if(p&&C.bucketInstanceId in this.collisionCircleArrays){const rn=this.collisionCircleArrays[C.bucketInstanceId];o.a6.mat4.invert(rn.invProjMatrix,G),rn.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(r,l,p,b){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:V,crossTileID:G}=p,j=o.bw(l),Y=b===o.bl.vertical?V:j==="left"?w:j==="center"?C:j==="right"?O:-1;w>=0&&(r.text.placedSymbolArray.get(w).crossTileID=Y>=0&&w!==Y?0:G),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=Y>=0&&C!==Y?0:G),O>=0&&(r.text.placedSymbolArray.get(O).crossTileID=Y>=0&&O!==Y?0:G),V>=0&&(r.text.placedSymbolArray.get(V).crossTileID=Y>=0&&V!==Y?0:G)}markUsedOrientation(r,l,p){const b=l===o.bl.horizontal||l===o.bl.horizontalOnly?l:0,w=l===o.bl.vertical?l:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:V,verticalPlacedTextSymbolIndex:G}=p,j=r.text.placedSymbolArray;C>=0&&(j.get(C).placedOrientation=b),O>=0&&(j.get(O).placedOrientation=b),V>=0&&(j.get(V).placedOrientation=b),G>=0&&(j.get(G).placedOrientation=w)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const b=l?l.symbolFadeChange(r):1,w=l?l.opacities:{},C=l?l.variableOffsets:{},O=l?l.placedOrientations:{};for(const V in this.placements){const G=this.placements[V],j=w[V];j?(this.opacities[V]=new Ji(j,b,G.text,G.icon,null,G.clipped),p=p||G.text!==j.text.placed||G.icon!==j.icon.placed):(this.opacities[V]=new Ji(null,b,G.text,G.icon,G.skipFade,G.clipped),p=p||G.text||G.icon)}for(const V in w){const G=w[V];if(!this.opacities[V]){const j=new Ji(G,b,!1,!1);j.isHidden()||(this.opacities[V]=j,p=p||G.text.placed||G.icon.placed)}}for(const V in C)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=C[V]);for(const V in O)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=O[V]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,p,b){const w=new Set;for(const C of l){const O=C.getBucket(r);O&&C.latestFeatureIndex&&r.fqid===O.layerIds[0]&&(this.updateBucketOpacities(O,w,C,C.collisionBoxArray,p,b,C.tileID,r.scope),O.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(O,C.tileID),O.updateZOffset()))}}updateBucketOpacities(r,l,p,b,w,C,O,V){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const G=r.layers[0].layout,j=r.layers[0].paint,Y=!!r.layers[0].dynamicFilter(),Q=new Ji(null,0,!1,!1,!0),ie=G.get("text-allow-overlap"),ve=G.get("icon-allow-overlap"),me=G.get("text-variable-anchor"),we=G.get("text-rotation-alignment")==="map",be=G.get("text-pitch-alignment")==="map",Pe=j.get("symbol-z-offset"),$e=G.get("symbol-elevation-reference")==="sea",Ve=!Pe.isConstant(),We=new Ji(null,0,ie&&(ve||!r.hasIconData()||G.get("icon-optional")),ve&&(ie||!r.hasTextData()||G.get("text-optional")),!0);!r.collisionArrays&&b&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(b);const Xe=(Je,rt,ht)=>{for(let lt=0;lt<rt/4;lt++)Je.opacityVertexArray.emplaceBack(ht)};let Ke=0;C&&r.updateReplacement(O,C);for(let Je=0;Je<r.symbolInstances.length;Je++){const rt=r.symbolInstances.get(Je),{numHorizontalGlyphVertices:ht,numVerticalGlyphVertices:lt,crossTileID:st,numIconVertices:Lt,tileAnchorX:Wt,tileAnchorY:ln}=rt;let yn=null;const Tn=this.retainedQueryData[r.bucketInstanceId];Ve&&rt&&Tn&&(yn=p.latestFeatureIndex.loadFeature({featureIndex:rt.featureIndex,bucketIndex:Tn.bucketIndex,sourceLayerIndex:Tn.sourceLayerIndex,layoutVertexArrayOffset:0}));const wt=Pe.evaluate(yn,{}),on=l.has(st);let Vt=this.opacities[st];on?Vt=Q:Vt||(Vt=We,this.opacities[st]=Vt),l.add(st);const rn=ht>0||lt>0,hn=Lt>0,nn=this.placedOrientations[st],An=nn===o.bl.vertical,Zn=nn===o.bl.horizontal||nn===o.bl.horizontalOnly;!rn&&!hn||Vt.isHidden()||Ke++;let to=!1;if((rn||hn)&&C)for(const Hn of r.activeReplacements){if(o.bs(Hn,w,o.bt.Symbol,V)||Hn.min.x>Wt||Wt>Hn.max.x||Hn.min.y>ln||ln>Hn.max.y)continue;const oo=o.bu(Wt,ln,O.canonical,Hn.footprintTileId.canonical);if(to=o.bv(oo,Hn.footprint),to)break}if(rn){const Hn=to?Kc:qc(Vt.text);Xe(r.text,ht,An?Kc:Hn),Xe(r.text,lt,Zn?Kc:Hn);const oo=Vt.text.isHidden(),{leftJustifiedTextSymbolIndex:Rn,centerJustifiedTextSymbolIndex:ho,rightJustifiedTextSymbolIndex:Io,verticalPlacedTextSymbolIndex:Go}=rt,Sr=r.text.placedSymbolArray,nr=oo||An?1:0;Rn>=0&&(Sr.get(Rn).hidden=nr),ho>=0&&(Sr.get(ho).hidden=nr),Io>=0&&(Sr.get(Io).hidden=nr),Go>=0&&(Sr.get(Go).hidden=oo||Zn?1:0);const Dr=this.variableOffsets[st];Dr&&this.markUsedJustification(r,Dr.anchor,rt,nn);const ar=this.placedOrientations[st];ar&&(this.markUsedJustification(r,"left",rt,ar),this.markUsedOrientation(r,ar,rt))}if(hn){const Hn=to?Kc:qc(Vt.icon),{placedIconSymbolIndex:oo,verticalPlacedIconSymbolIndex:Rn}=rt,ho=r.icon.placedSymbolArray,Io=Vt.icon.isHidden()?1:0;oo>=0&&(Xe(r.icon,Lt,An?Kc:Hn),ho.get(oo).hidden=Io),Rn>=0&&(Xe(r.icon,rt.numVerticalIconVertices,Zn?Kc:Hn),ho.get(Rn).hidden=Io)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Hn=r.collisionArrays[Je];if(Hn){let oo=new o.P(0,0),Rn=!0;if(Hn.textBox||Hn.verticalTextBox){if(me){const Io=this.variableOffsets[st];Io?(oo=Wc(Io.anchor,Io.width,Io.height,Io.textOffset,Io.textScale),we&&oo._rotate(be?this.transform.angle:-this.transform.angle)):Rn=!1}Y&&(Rn=!Vt.clipped),Hn.textBox&&Hh(r.textCollisionBox.collisionVertexArray,Vt.text.placed,!Rn||An,wt,$e,oo.x,oo.y),Hn.verticalTextBox&&Hh(r.textCollisionBox.collisionVertexArray,Vt.text.placed,!Rn||Zn,wt,$e,oo.x,oo.y)}const ho=Rn&&!!(!Zn&&Hn.verticalIconBox);Hn.iconBox&&Hh(r.iconCollisionBox.collisionVertexArray,Vt.icon.placed,ho,wt,$e,rt.hasIconTextFit?oo.x:0,rt.hasIconTextFit?oo.y:0),Hn.verticalIconBox&&Hh(r.iconCollisionBox.collisionVertexArray,Vt.icon.placed,!ho,wt,$e,rt.hasIconTextFit?oo.x:0,rt.hasIconTextFit?oo.y:0)}}}if(r.fullyClipped=Ke===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const Je=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Je.invProjMatrix,r.placementViewportMatrix=Je.viewportMatrix,r.collisionCircleArray=Je.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function Hh(f,r,l,p,b,w,C){f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,b?1:0)}const Ha=Math.pow(2,25),g1=Math.pow(2,24),__=Math.pow(2,17),ls=Math.pow(2,16),v1=Math.pow(2,9),Gh=Math.pow(2,8),y_=Math.pow(2,1);function qc(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,l=Math.floor(127*f.opacity);return l*Ha+r*g1+l*__+r*ls+l*v1+r*Gh+l*y_+r}const Kc=0;class _1{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,p,b,w,C){const O=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(O,b,r[this._currentTileIndex],this._sortAcrossTiles,C),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort((V,G)=>V.sortKey-G.sortKey));this._currentPartIndex<O.length;){const V=O[this._currentPartIndex];if(l.placeLayerBucketPart(V,this._seenCrossTileIDs,p,V.symbolInstanceStart===0,C),this._currentPartIndex++,w())return!0}return!1}}class md{constructor(r,l,p,b,w,C,O,V,G){this.placement=new sc(r,w,C,O,V,G),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(r,l,p,b,w){const C=o.q.now(),O=()=>{const V=o.q.now()-C;return!this._forceFullPlacement&&V>2};for(;this._currentPlacementIndex>=0;){const V=l[r[this._currentPlacementIndex]],G=this.placement.collisionIndex.transform.zoom;if(V.type==="symbol"&&(!V.minzoom||V.minzoom<=G)&&(!V.maxzoom||V.maxzoom>G)){const j=V,Y=j.layout.get("symbol-z-elevate"),Q=j.layout.get("symbol-sort-key").constantOr(1)!==void 0,ie=j.layout.get("symbol-z-order"),ve=ie==="viewport-y"||ie==="auto"&&!(ie!=="viewport-y"&&Q),me=j.layout.get("text-allow-overlap")||j.layout.get("icon-allow-overlap")||j.layout.get("text-ignore-placement")||j.layout.get("icon-ignore-placement"),we=ve&&me,be=this._inProgressLayer=this._inProgressLayer||new _1(j),Pe=o.av(V.source,V.scope);if(be.continuePlacement(Y||we?b[Pe]:p[Pe],this.placement,this._showCollisionBoxes,V,O,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const ac=512/o.ab/2;class y1{constructor(r,l,p){this.tileID=r,this.bucketInstanceId=p,this.index=new o.bz(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=r.canonical.x*o.ab,w=r.canonical.y*o.ab;for(let C=0;C<l.length;C++){const{key:O,crossTileID:V,tileAnchorX:G,tileAnchorY:j}=l.get(C),Y=Math.floor((b+G)*ac),Q=Math.floor((w+j)*ac);this.index.add(Y,Q),this.keys.push(O),this.crossTileIDs.push(V)}this.index.finish()}findMatches(r,l,p){const b=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),w=ac/Math.pow(2,l.canonical.z-this.tileID.canonical.z),C=l.canonical.x*o.ab,O=l.canonical.y*o.ab;for(let V=0;V<r.length;V++){const G=r.get(V);if(G.crossTileID)continue;const{key:j,tileAnchorX:Y,tileAnchorY:Q}=G,ie=Math.floor((C+Y)*w),ve=Math.floor((O+Q)*w),me=this.index.range(ie-b,ve-b,ie+b,ve+b);for(const we of me){const be=this.crossTileIDs[we];if(this.keys[we]===j&&!p.has(be)){p.add(be),G.crossTileID=be;break}}}}}class Zc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class b_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const p in this.indexes){const b=this.indexes[p],w={};for(const C in b){const O=b[C];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+l),w[O.tileID.key]=O}this.indexes[p]=w}this.lng=r}addBucket(r,l,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const b=this.usedCrossTileIDs[r.overscaledZ];for(const w in this.indexes){const C=this.indexes[w];if(Number(w)>r.overscaledZ)for(const O in C){const V=C[O];V.tileID.isChildOf(r)&&V.findMatches(l.symbolInstances,r,b)}else{const O=C[r.scaledTo(Number(w)).key];O&&O.findMatches(l.symbolInstances,r,b)}}for(let w=0;w<l.symbolInstances.length;w++){const C=l.symbolInstances.get(w);C.crossTileID||(C.crossTileID=p.generate(),b.add(C.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new y1(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const p of l.crossTileIDs)this.usedCrossTileIDs[r].delete(p)}removeStaleBuckets(r){let l=!1;for(const p in this.indexes){const b=this.indexes[p];for(const w in b)r[b[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,b[w]),delete b[w],l=!0)}return l}}class Wh{constructor(){this.layerIndexes={},this.crossTileIDs=new Zc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,p,b){let w=this.layerIndexes[r.fqid];w===void 0&&(w=this.layerIndexes[r.fqid]=new b_);let C=!1;const O={};b.name!=="globe"&&w.handleWrapJump(p);for(const V of l){const G=V.getBucket(r);G&&r.fqid===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(V.tileID,G,this.crossTileIDs)&&(C=!0),O[G.bucketInstanceId]=!0)}return w.removeStaleBuckets(O)&&(C=!0),C}pruneUnusedLayers(r){const l={};r.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const Ss=771;class Ho{constructor(r,l,p,b){this.blendFunction=r,this.blendColor=l,this.mask=p,this.blendEquation=b}}Ho.Replace=[1,0,1,0],Ho.disabled=new Ho(Ho.Replace,o.bA.transparent,[!1,!1,!1,!1]),Ho.unblended=new Ho(Ho.Replace,o.bA.transparent,[!0,!0,!0,!0]),Ho.alphaBlended=new Ho([1,Ss,1,Ss],o.bA.transparent,[!0,!0,!0,!0]),Ho.alphaBlendedNonPremultiplied=new Ho([770,Ss,770,Ss],o.bA.transparent,[!0,!0,!0,!0]),Ho.multiply=new Ho([774,0,774,0],o.bA.transparent,[!0,!0,!0,!0]);class io{constructor(r,l,p){this.func=r,this.mask=l,this.range=p}}io.ReadOnly=!1,io.ReadWrite=!0,io.disabled=new io(519,io.ReadOnly,[0,1]);const lm=7680;class Eo{constructor(r,l,p,b,w,C){this.test=r,this.ref=l,this.mask=p,this.fail=b,this.depthFail=w,this.pass=C}}Eo.disabled=new Eo({func:519,mask:0},0,0,lm,lm,lm);const cm=1029,gd=2305;class bo{constructor(r,l,p){this.enable=r,this.mode=l,this.frontFace=p}}function um(f,r){const l=o.bD(f,3);o.a6.mat4.fromQuat(f,r),o.bF(f,3,l)}function qh(f,r){const l=o.a6.quat.identity([]);return o.a6.quat.rotateZ(l,l,-r),o.a6.quat.rotateX(l,l,-f),l}function dm(f,r){const l=[f[0],f[1],0],p=[r[0],r[1],0];if(o.a6.vec3.length(l)>=1e-15){const C=o.a6.vec3.normalize([],l);o.a6.vec3.scale(p,C,o.a6.vec3.dot(p,C)),r[0]=p[0],r[1]=p[1]}const b=o.a6.vec3.cross([],r,f);if(o.a6.vec3.len(b)<1e-15)return null;const w=Math.atan2(-b[1],b[0]);return qh(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),w)}bo.disabled=new bo(!1,cm,gd),bo.backCCW=new bo(!0,cm,gd),bo.backCW=new bo(!0,cm,2304),bo.frontCW=new bo(!0,1028,2304),bo.frontCCW=new bo(!0,1028,gd);class Al{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof o.a5?r:new o.a5(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=o.bB(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const p=this.position,b=this._elevation?this._elevation.getAtPointOrZero(o.a5.fromLngLat(r)):0,w=o.a5.fromLngLat(r,b),C=[w.x-p.x,w.y-p.y,w.z-p.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=dm(C,l)}setPitchBearing(r,l){this.orientation=qh(o.bC(r),o.bC(-l))}}class lc{constructor(r,l){this._transform=o.a6.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new o.a5(r[0],r[1],r[2])}get position(){const r=o.bD(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&o.bF(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.a6.quat.identity([]),r&&um(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=qh(r,l),um(this._transform,this._orientation)}forward(){const r=o.bD(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.bD(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.bD(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const p=new Float64Array(16);return o.a6.mat4.invert(p,this.getWorldToCamera(r,l)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,p){const b=this.position;o.a6.vec3.scale(b,b,-r);const w=new Float64Array(16);return o.a6.mat4.fromScaling(w,[p,p,p]),o.a6.mat4.translate(w,w,b),w[10]*=l,w}getWorldToCamera(r,l){const p=new Float64Array(16),b=new Float64Array(4),w=this.position;return o.a6.quat.conjugate(b,this._orientation),o.a6.vec3.scale(w,w,-r),o.a6.mat4.fromQuat(p,b),o.a6.mat4.translate(p,p,w),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(r,l,p,b){const w=new Float64Array(16);return o.a6.mat4.perspective(w,r,l,p,b),w}getCameraToClipOrthographic(r,l,p,b,w,C){const O=new Float64Array(16);return o.a6.mat4.ortho(O,r,l,p,b,w,C),O}getDistanceToElevation(r,l=!1){const p=r===0?0:o.bE(r,l?o.aN(this.position[1]):this.position[1]),b=this.forward();return(p-this.position[2])/b[2]}clone(){return new lc([...this.position],[...this.orientation])}}const Di={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Kh{constructor(r=0,l=0,p=0,b=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=p,this.right=b}interpolate(r,l,p){return l.top!=null&&r.top!=null&&(this.top=o.aa(r.top,l.top,p)),l.bottom!=null&&r.bottom!=null&&(this.bottom=o.aa(r.bottom,l.bottom,p)),l.left!=null&&r.left!=null&&(this.left=o.aa(r.left,l.left,p)),l.right!=null&&r.right!=null&&(this.right=o.aa(r.right,l.right,p)),this}getCenter(r,l){const p=o.ap((this.left+r-this.right)/2,0,r),b=o.ap((this.top+l-this.bottom)/2,0,l);return new o.P(p,b)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Kh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Yc=(f,r,l)=>(1-l)*f+l*r,Xc=f=>f*f*f*f*f;class Zh{constructor(r,l,p,b,w,C,O){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=p??0,this._maxPitch=b??60,this.setProjection(C),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new o.bL(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Kh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new lc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new Zh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(r||p)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return o.ar(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=o.bM(this.projectionOptions);const p=this.getProjection(),b=!o.bi(l,p);return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.bM({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.bE(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bB(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=o.a6.mat2.create(),o.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=o.ap(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.bC(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let b=0,w=0;for(let C=0;C<l.length;C++){const O=new o.P(l[C][0]*this.width,p+l[C][1]*(this.height-p)),V=r.pointCoordinate(O);if(!V)continue;const G=1/Math.hypot(V[0]-this._camera.position[0],V[1]-this._camera.position[1]);b+=V[3]*G,w+=G}return w===0?NaN:b/w}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,b=this._mercatorZfromZoom(r),w=this._mercatorZfromZoom(this._maxZoom),C=Math.max(b-p,w);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const b=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,p));return o.ap(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!o.a6.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];o.a6.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new Al;return l.position=new o.a5(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!o.a6.quat.length(r))return!1;o.a6.quat.normalize(r,r);const l=o.a6.vec3.transformQuat([],[0,0,-1],r),p=o.a6.vec3.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const b=dm(l,p);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;r[2]=o.ap(r[2],b/p,b/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,p){this._unmodified=!1,this._edgeInsets.interpolate(r,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new o.bN(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new o.P(0,0)),b=this.pointCoordinate(new o.P(this.width,0)),w=this.pointCoordinate(new o.P(this.width,this.height)),C=this.pointCoordinate(new o.P(0,this.height)),O=Math.floor(Math.min(p.x,b.x,w.x,C.x)),V=Math.floor(Math.max(p.x,b.x,w.x,C.x)),G=1;for(let j=O-G;j<=V+G;j++)j!==0&&l.push(new o.bN(j,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,p){let b=[];const w=p!==void 0,C=!w;if(C&&this.zoom<l||w&&p[0]===0&&p[1]===0)return b;const O=new Set,V=(j,Y,Q,ie,ve)=>{const me=o.c2(Y,j,Q,ie,ve);O.has(me)||(b.push(new o.aA(j,Y,Q,ie,ve)),O.add(me))};for(let j=0;j<r.length;j++){const Y=r[j];if(C&&Y.canonical.z!==l)continue;const Q=Y.canonical,ie=Y.overscaledZ,ve=Y.wrap,me=1<<Q.z,we=Q.x+1<me,be=Q.x>0,Pe=Q.y+1<me,$e=Q.y>0,Ve=Y.wrap-(be?0:1),We=Y.wrap+(we?0:1),Xe=be?Q.x-1:me-1,Ke=we?Q.x+1:0;if(w)p[0]<0?(V(ie,We,Q.z,Ke,Q.y),p[1]<0&&Pe&&(V(ie,ve,Q.z,Q.x,Q.y+1),V(ie,We,Q.z,Ke,Q.y+1)),p[1]>0&&$e&&(V(ie,ve,Q.z,Q.x,Q.y-1),V(ie,We,Q.z,Ke,Q.y-1))):p[0]>0?(V(ie,Ve,Q.z,Xe,Q.y),p[1]<0&&Pe&&(V(ie,ve,Q.z,Q.x,Q.y+1),V(ie,Ve,Q.z,Xe,Q.y+1)),p[1]>0&&$e&&(V(ie,ve,Q.z,Q.x,Q.y-1),V(ie,Ve,Q.z,Xe,Q.y-1))):p[1]<0&&Pe?V(ie,ve,Q.z,Q.x,Q.y+1):$e&&V(ie,ve,Q.z,Q.x,Q.y-1);else{const Je=Y.visibleQuadrants;1&Je&&(V(ie,Ve,Q.z,Xe,Q.y),$e&&(V(ie,ve,Q.z,Q.x,Q.y-1),V(ie,Ve,Q.z,Xe,Q.y-1))),2&Je&&(V(ie,We,Q.z,Ke,Q.y),$e&&(V(ie,ve,Q.z,Q.x,Q.y-1),V(ie,We,Q.z,Ke,Q.y-1))),4&Je&&(V(ie,Ve,Q.z,Xe,Q.y),Pe&&(V(ie,ve,Q.z,Q.x,Q.y+1),V(ie,Ve,Q.z,Xe,Q.y+1))),8&Je&&(V(ie,We,Q.z,Ke,Q.y),Pe&&(V(ie,ve,Q.z,Q.x,Q.y+1),V(ie,We,Q.z,Ke,Q.y+1)))}}const G=[];for(const j of b)b.some(Y=>j.isChildOf(Y))||G.push(j);if(b=G.filter(j=>!r.some(Y=>!!(j.overscaledZ<l&&Y.isChildOf(j))||j.equals(Y)||j.isChildOf(Y))),C){const j=1<<l,Y=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Q=[j*Y.x,j*Y.y],ie=4,ve=ie*ie;b=b.filter(me=>{const we=me.canonical.x+.5-Q[0],be=me.canonical.y+.5-Q[1];return we*we+be*be<ve})}return b}coveringTiles(r){let l=this.coveringZoomLevel(r);const p=l,b=this.elevation&&this.elevation.exaggeration(),w=b&&!r.isTerrainDEM,C=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const O=this.locationCoordinate(this.center),V=this.center.lat,G=1<<l,j=[G*O.x,G*O.y,0],Y=this.projection.name==="globe",Q=!Y,ie=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,Q),ve=Y?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),me=G*o.bE(1,this.center.lat),we=this._camera.position[2]/o.bE(1,this.center.lat),be=[G*ve.x,G*ve.y,we*(Q?1:me)],Pe=Y||b,$e=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Ve=this.isLODDisabled(!0)?l:0;let We;if(this._elevation&&r.isTerrainDEM)We=1e4*this._elevation.exaggeration();else if(this._elevation){const wt=this._elevation.getMinMaxForVisibleTiles();We=wt?wt.max:this._centerAltitude}else We=this._centerAltitude;const Xe=r.isTerrainDEM?-We:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ke=this.projection.isReprojectedInTileSpace?o.bP(this):1,Je=wt=>{const Vt=new o.a5(wt.x+25e-6,wt.y,wt.z),rn=new o.a5(wt.x,wt.y+25e-6,wt.z),hn=wt.toLngLat(),nn=Vt.toLngLat(),An=rn.toLngLat(),Zn=this.locationCoordinate(hn),to=this.locationCoordinate(nn),Hn=this.locationCoordinate(An),oo=Math.hypot(to.x-Zn.x,to.y-Zn.y),Rn=Math.hypot(Hn.x-Zn.x,Hn.y-Zn.y);return Math.sqrt(oo*Rn)*Ke/25e-6},rt=wt=>{const on=We,Vt=Xe;return{aabb:o.bS(this,G,0,0,0,wt,Vt,on,this.projection),zoom:0,x:0,y:0,minZ:Vt,maxZ:on,wrap:wt,fullyVisible:!1}},ht=[];let lt=[];const st=l,Lt=r.reparseOverscaled?p:l,Wt=(we-this._centerAltitude)*me,ln=wt=>{if(!this._elevation||!wt.tileID||!C)return;const on=this._elevation.getMinMaxForTile(wt.tileID),Vt=wt.aabb;on?(Vt.min[2]=on.min,Vt.max[2]=on.max,Vt.center[2]=(Vt.min[2]+Vt.max[2])/2):(wt.shouldSplit=Tn(wt),wt.shouldSplit||(Vt.min[2]=Vt.max[2]=Vt.center[2]=this._centerAltitude))},yn=(wt,on)=>{if(.707*on<wt)return 1;const Vt=on/wt;return Vt/(1.4144271570014144+(Math.pow(1.1,Vt-1.4144271570014144+1)-1)/(1.1-1)-1)},Tn=wt=>{if(wt.zoom<Ve)return!0;if(wt.zoom===st)return!1;if(wt.shouldSplit!=null)return wt.shouldSplit;const on=wt.aabb.distanceX(be),Vt=wt.aabb.distanceY(be);let rn=Wt,hn=1;if(Y){rn=wt.aabb.distanceZ(be);const Rn=Math.pow(2,wt.zoom),ho=o.aN((wt.y+1)/Rn),Io=o.aN(wt.y/Rn),Go=Math.min(Math.max(V,ho),Io),Sr=o.c6(Go)/o.c6(V);if(hn=Go===V?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Sr/this._mercatorScaleRatio),this.zoom<=o.c3&&wt.zoom===st-1&&Sr>=.9)return!0}else if(w&&(rn=wt.aabb.distanceZ(be)*me),this.projection.isReprojectedInTileSpace&&p<=5){const Rn=Math.pow(2,wt.zoom),ho=Je(new o.a5((wt.x+.5)/Rn,(wt.y+.5)/Rn));hn=ho>.85?1:ho}if(!C){const Rn=Math.sqrt(on*on+Vt*Vt+rn*rn);let ho=(1<<st-wt.zoom)*$e*hn;return ho*=yn(Math.max(rn,Wt),Rn),Rn<ho}let nn=Number.MAX_VALUE,An=0;const Zn=wt.aabb.getCorners(),to=[];for(const Rn of Zn){o.a6.vec3.sub(to,Rn,be),Y||(w?to[2]*=me:to[2]=Wt);const ho=o.a6.vec3.dot(to,this._camera.forward());ho<nn&&(nn=ho,An=Math.abs(to[2]))}let Hn=(1<<st-wt.zoom)*$e*hn;if(Hn*=yn(Math.max(An,Wt),nn),nn<Hn)return!0;const oo=wt.aabb.closestPoint(j);return oo[0]===j[0]&&oo[1]===j[1]};if(this.renderWorldCopies)for(let wt=1;wt<=3;wt++)ht.push(rt(-wt)),ht.push(rt(wt));for(ht.push(rt(0));ht.length>0;){const wt=ht.pop(),on=wt.x,Vt=wt.y;let rn=wt.fullyVisible;const hn=()=>this.projection.name==="globe"&&(wt.y===0||wt.y===(1<<wt.zoom)-1);if(!rn){let nn=Pe?wt.aabb.intersects(ie):wt.aabb.intersectsFlat(ie);if(nn===0&&hn()){const An=new o.bQ(wt.zoom,on,Vt);nn=o.bR(this,G,An,!0).intersects(ie)}if(nn===0)continue;rn=nn===2}if(wt.zoom!==st&&Tn(wt))for(let nn=0;nn<4;nn++){const An=(on<<1)+nn%2,Zn=(Vt<<1)+(nn>>1),to={aabb:C?wt.aabb.quadrant(nn):o.bS(this,G,wt.zoom+1,An,Zn,wt.wrap,wt.minZ,wt.maxZ,this.projection),zoom:wt.zoom+1,x:An,y:Zn,wrap:wt.wrap,fullyVisible:rn,tileID:void 0,shouldSplit:void 0,minZ:wt.minZ,maxZ:wt.maxZ};w&&!Y&&(to.tileID=new o.aA(wt.zoom+1===st?Lt:wt.zoom+1,wt.wrap,wt.zoom+1,An,Zn),ln(to)),ht.push(to)}else{const nn=wt.zoom===st?Lt:wt.zoom;if(r.minzoom&&r.minzoom>nn)continue;let An=0;if(!rn){let oo=Pe?wt.aabb.intersectsPrecise(ie):wt.aabb.intersectsPreciseFlat(ie);if(oo===0&&hn()){const Rn=new o.bQ(wt.zoom,on,Vt);oo=o.bR(this,G,Rn,!0).intersectsPrecise(ie)}if(oo===0)continue;if(r.calculateQuadrantVisibility)if(ie.containsPoint(wt.aabb.center))An=15;else for(let Rn=0;Rn<4;Rn++)wt.aabb.quadrant(Rn).intersects(ie)!==0&&(An|=1<<Rn)}const Zn=j[0]-(.5+on+(wt.wrap<<wt.zoom))*(1<<l-wt.zoom),to=j[1]-.5-Vt,Hn=wt.tileID?wt.tileID:new o.aA(nn,wt.wrap,wt.zoom,on,Vt);r.calculateQuadrantVisibility&&(Hn.visibleQuadrants=An),lt.push({tileID:Hn,distanceSq:Zn*Zn+to*to})}}if(this.fogCullDistSq){const wt=this.fogCullDistSq,on=this.horizonLineFromTop();lt=lt.filter(Vt=>{const rn=[0,0,0,1],hn=[o.ab,o.ab,0,1],nn=this.calculateFogTileMatrix(Vt.tileID.toUnwrapped());o.a6.vec4.transformMat4(rn,rn,nn),o.a6.vec4.transformMat4(hn,hn,nn);const An=o.a6.vec4.min([],rn,hn),Zn=o.a6.vec4.max([],rn,hn),to=o.bT(An,Zn);if(to===0)return!0;let Hn=!1;const oo=this._elevation;if(oo&&to>wt&&on!==0){const Rn=this.calculateProjMatrix(Vt.tileID.toUnwrapped());let ho;r.isTerrainDEM||(ho=oo.getMinMaxForTile(Vt.tileID)),ho||(ho={min:Xe,max:We});const Io=o.c4(this.rotation),Go=[Io[0]*o.ab,Io[1]*o.ab,ho.max];o.a6.vec3.transformMat4(Go,Go,Rn),Hn=(1-Go[1])*this.height*.5<on}return to<wt||Hn})}return lt.sort((wt,on)=>wt.distanceSq-on.distanceSq).map(wt=>wt.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=o.ap(r.lat,-o.bU,o.bU),p=this.projection.project(r.lng,l);return new o.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.bE(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let p,b;const w=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;p=(l.x-w.x)/O,b=(l.y-w.y)/O}else{const O=this.pointCoordinate(l),V=this.pointCoordinate(w);p=O.x-V.x,b=O.y-V.y}const C=this.locationCoordinate(r);this.setLocation(new o.a5(C.x-p,C.y-b))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const p=l?o.bE(l,r.lat):void 0,b=this.projection.project(r.lng,r.lat);return new o.a5(b.x,b.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const p=l??this._centerAltitude,b=[r.x,r.y,0,1],w=[r.x,r.y,1,1];o.a6.vec4.transformMat4(b,b,this.pixelMatrixInverse),o.a6.vec4.transformMat4(w,w,this.pixelMatrixInverse);const C=w[3];o.a6.vec4.scale(b,b,1/b[3]),o.a6.vec4.scale(w,w,1/C);const O=b[2],V=w[2];return{p0:b,p1:w,t:O===V?0:(p-O)/(V-O)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return o.a6.vec4.transformMat4(l,l,this.pixelMatrixInverse),o.a6.vec4.transformMat4(p,p,this.pixelMatrixInverse),o.a6.vec4.scale(l,l,1/l[3]),o.a6.vec4.scale(p,p,1/p[3]),l[2]=o.bE(l[2],this._center.lat)*this.worldSize,p[2]=o.bE(p[2],this._center.lat)*this.worldSize,o.a6.vec4.scale(l,l,1/this.worldSize),o.a6.vec4.scale(p,p,1/this.worldSize),new o.aj([l[0],l[1],l[2]],o.a6.vec3.normalize([],o.a6.vec3.sub([],p,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:p,t:b}=r,w=o.bE(l[2],this._center.lat),C=o.bE(p[2],this._center.lat);return new o.a5(o.aa(l[0],p[0],b)/this.worldSize,o.aa(l[1],p[1],b)/this.worldSize,o.aa(w,C,b))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new o.a5(l[0],l[1],l[2]);let p=0,b=this.horizonLineFromTop();if(r.y>b)return this.pointCoordinate(r);const w=.02*b,C=r.clone();for(let O=0;O<10&&b-p>w;O++){C.y=o.aa(p,b,.66);const V=this.projection.pointCoordinate3D(this,C.x,C.y);V?(b=C.y,l=V):p=C.y}return l?new o.a5(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=o.bV)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,b=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return o.a6.vec4.transformMat4(b,b,this.pixelMatrix),b[3]>0?new o.P(b[0]/b[3],b[1]/b[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,w=this.pointLocation3D(new o.P(l,r)),C=this.pointLocation3D(new o.P(b,r)),O=this.pointLocation3D(new o.P(b,p)),V=this.pointLocation3D(new o.P(l,p));let G=Math.min(w.lng,C.lng,O.lng,V.lng),j=Math.max(w.lng,C.lng,O.lng,V.lng),Y=Math.min(w.lat,C.lat,O.lat,V.lat),Q=Math.max(w.lat,C.lat,O.lat,V.lat);const ie=Math.pow(2,-this.zoom)/16*270,ve=this.projection.name==="globe"?1:4,me=(we,be,Pe,$e,Ve)=>{const We=(we+Pe)/2,Xe=(be+$e)/2,Ke=new o.P(We,Xe),{lng:Je,lat:rt}=this.pointLocation3D(Ke),ht=Math.max(0,G-Je,Y-rt,Je-j,rt-Q);G=Math.min(G,Je),j=Math.max(j,Je),Y=Math.min(Y,rt),Q=Math.max(Q,rt),(Ve<ve||ht>ie)&&(me(we,be,We,Xe,Ve+1),me(We,Xe,Pe,$e,Ve+1))};if(me(l,r,b,r,1),me(b,r,b,p,1),me(b,p,l,p,1),me(l,p,l,r,1),this.projection.name==="globe"){const[we,be]=o.bW(this);we?(Q=90,j=180,G=-180):be&&(Y=-90,j=180,G=-180)}return new o.as(new o.bL(G,Y),new o.bL(j,Q))}_getBoundsRectangular(r,l){const{top:p,left:b}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,O=new o.P(b,p),V=new o.P(C,p),G=new o.P(C,w),j=new o.P(b,w);let Y=this.pointCoordinate(O,r),Q=this.pointCoordinate(V,r);const ie=this.pointCoordinate(G,l),ve=this.pointCoordinate(j,l),me=(we,be)=>(be.y-we.y)/(be.x-we.x);return Y.y>1&&Q.y>=0?Y=new o.a5((1-ve.y)/me(ve,Y)+ve.x,1):Y.y<0&&Q.y<=1&&(Y=new o.a5(-ve.y/me(ve,Y)+ve.x,0)),Q.y>1&&Y.y>=0?Q=new o.a5((1-ie.y)/me(ie,Q)+ie.x,1):Q.y<0&&Y.y<=1&&(Q=new o.a5(-ie.y/me(ie,Q)+ie.x,0)),new o.as().extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(ie))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((p,b)=>{if(b.dem){const w=b.dem.tree;p.min=Math.min(p.min,w.minimums[0]),p.max=Math.max(p.max,w.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.bU,this.maxLat=o.bU,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.am(this.minLng)*this.tileSize,this.worldMaxX=o.am(this.maxLng)*this.tileSize,this.worldMinY=o.at(this.maxLat)*this.tileSize,this.worldMaxY=o.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,p=this._distanceTileDataCache;if(p[l])return p[l];const b=r.canonical,w=1/this.height,C=this.cameraWorldSize,O=C/this.zoomScale(b.z),V=(b.x+Math.pow(2,b.z)*r.wrap)*O,G=b.y*O,j=this.point;j.x*=C/this.worldSize,j.y*=C/this.worldSize;const Y=this.angle,Q=Math.sin(-Y),ie=-Math.cos(-Y);return p[l]={bearing:[Q,ie],center:[(j.x-V)*w,(j.y-G)*w],scale:O/o.ab*w},p[l]}calculateFogTileMatrix(r){const l=r.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.a6.mat4.multiply(b,this.worldToFogMatrix,b),p[l]=new Float32Array(b),p[l]}calculateProjMatrix(r,l=!1,p=!1){const b=r.key;let w;if(w=p?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,w[b])return w[b];const C=this.calculatePosMatrix(r,this.worldSize);let O;return O=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,o.a6.mat4.multiply(C,O,C),w[b]=new Float32Array(C),w[b]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const b=o.bX(r,this);return p[l]=b,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=o.a6.mat4.fromScaling([],[r,r,r]);return o.a6.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=o.bE(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),b=this._camera.forward(),w=o.bE(1,this._center.lat);p[2]/=w,b[2]/=w,o.a6.vec3.normalize(b,b);const C=r.raycast(p,b,r.exaggeration());if(C){const O=o.a6.vec3.scaleAndAdd([],p,b,C),V=new o.a5(O[0],O[1],o.bE(O[2],o.aN(O[1]))),G=(V.z+o.a6.vec3.length([V.x-p[0],V.y-p[1],V.z-p[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=V.toAltitude(),this._center=this.coordinateLocation(V),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,p=o.bE(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(p),w=l.getAtPointOrZero(new o.a5(...b)),C=this.pixelsPerMeter/this.worldSize*w,O=this._minimumHeightOverTerrain(),V=b[2]-C;if(V<=O)if(V<0||r){const G=this.locationCoordinate(this._center,this._centerAltitude),j=[b[0],b[1],G.z-b[2]],Y=o.a6.vec3.length(j);j[2]-=(O-V)/this._pixelsPerMercatorPixel;const Q=o.a6.vec3.length(j);if(Q===0)return;o.a6.vec3.scale(j,j,Y/Q*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],G.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const Q=this.center;return Q.lat=o.ap(Q.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(Q.lng=o.ap(Q.lng,this.minLng,this.maxLng)),this.center=Q,void(this._constraining=!1)}const l=this._unmodified,{x:p,y:b}=this.point;let w=0,C=p,O=b;const V=this.width/2,G=this.height/2,j=this.worldMinY*this.scale,Y=this.worldMaxY*this.scale;if(b-G<j&&(O=j+G),b+G>Y&&(O=Y-G),Y-j<this.height&&(w=Math.max(w,this.height/(Y-j)),O=(Y+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Q=this.worldMinX*this.scale,ie=this.worldMaxX*this.scale,ve=this.worldSize/2-(Q+ie)/2;C=(p+ve+this.worldSize)%this.worldSize-ve,C-V<Q&&(C=Q+V),C+V>ie&&(C=ie-V),ie-Q<this.width&&(w=Math.max(w,this.width/(ie-Q)),C=(ie+Q)/2)}C===p&&O===b||(this.center=this.unproject(new o.P(C,O))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.bE(1,this.center.lat)/o.bE(1,o.c5));const b=o.bY(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?p:1,C=this._camera.getWorldToCamera(this.worldSize,w);let O;const V=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(V[8]=2*-r.x/this.width,V[9]=2*r.y/this.height,this.isOrthographic){let rt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ht=rt*this.aspect,lt=-ht,st=-rt;ht-=r.x,lt-=r.x,rt+=r.y,st+=r.y,O=this._camera.getCameraToClipOrthographic(lt,ht,st,rt,this._nearZ,this._farZ),((Lt,Wt,ln,yn)=>{for(let Tn=0;Tn<16;Tn++)Lt[Tn]=Yc(Wt[Tn],ln[Tn],yn)})(O,O,V,Xc(this.pitch>=15?1:this.pitch/15))}else O=V;const G=o.a6.mat4.mul([],V,C);let j=o.a6.mat4.mul([],O,C);if(this.projection.isReprojectedInTileSpace){const rt=this.locationCoordinate(this.center),ht=o.a6.mat4.identity([]);o.a6.mat4.translate(ht,ht,[rt.x*this.worldSize,rt.y*this.worldSize,0]),o.a6.mat4.multiply(ht,ht,o.bZ(this)),o.a6.mat4.translate(ht,ht,[-rt.x*this.worldSize,-rt.y*this.worldSize,0]),o.a6.mat4.multiply(j,j,ht),o.a6.mat4.multiply(G,G,ht),this.inverseAdjustmentMatrix=o.b_(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.a6.mat4.scale([],j,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=j,this.invProjMatrix=o.a6.mat4.invert(new Float64Array(16),this.projMatrix),l){const rt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);rt[8]=2*-r.x/this.width,rt[9]=2*r.y/this.height,this.expandedFarZProjMatrix=o.a6.mat4.mul([],rt,C)}else this.expandedFarZProjMatrix=this.projMatrix;const Y=o.a6.mat4.invert([],O);this.frustumCorners=o.b$.fromInvProjectionMatrix(Y,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const Q=new Float32Array(16);o.a6.mat4.identity(Q),o.a6.mat4.scale(Q,Q,[1,-1,1]),o.a6.mat4.rotateX(Q,Q,this._pitch),o.a6.mat4.rotateZ(Q,Q,this.angle);const ie=o.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.a6.mat4.clone(ie);const ve=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ie[8]=2*-r.x/this.width,ie[9]=2*(r.y+ve)/this.height,this.skyboxMatrix=o.a6.mat4.multiply(Q,ie,Q);const me=this.point,we=me.x,be=me.y,Pe=this.width%2/2,$e=this.height%2/2,Ve=Math.cos(this.angle),We=Math.sin(this.angle),Xe=we-Math.round(we)+Ve*Pe+We*$e,Ke=be-Math.round(be)+Ve*$e+We*Pe,Je=new Float64Array(j);if(o.a6.mat4.translate(Je,Je,[Xe>.5?Xe-1:Xe,Ke>.5?Ke-1:Ke,0]),this.alignedProjMatrix=Je,j=o.a6.mat4.create(),o.a6.mat4.scale(j,j,[this.width/2,-this.height/2,1]),o.a6.mat4.translate(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=o.a6.mat4.create(),o.a6.mat4.scale(j,j,[1,-1,1]),o.a6.mat4.translate(j,j,[-1,-1,0]),o.a6.mat4.scale(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=o.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,G),this._calcFogMatrices(),this._distanceTileDataCache={},j=o.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!j)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=j,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.c0(this);const rt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.a6.vec3.transformMat4(rt,rt,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=j;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,p=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,w=[r,r,l];o.a6.vec3.scale(w,w,b),o.a6.vec3.scale(p,p,-1),o.a6.vec3.multiply(p,p,w);const C=o.a6.mat4.create();o.a6.mat4.translate(C,C,p),o.a6.mat4.scale(C,C,w),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,b)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),b=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-p[0]*w,b.y/this.worldSize-p[1]*w,r/this.worldSize*this._centerAltitude-p[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],b=r[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(w=Math.min((l-p)/b,1)),this._camera.position=o.a6.vec3.scaleAndAdd([],this._camera.position,r,w),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:b}=this._camera.getPitchBearing(),w=o.bE(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.bC(this._maxPitch)),O=Math.max((r[2]-w)/Math.cos(p),C),V=this._zoomFromMercatorZ(O);o.a6.vec3.scaleAndAdd(r,r,l,O),this._pitch=o.ap(p,o.bC(this.minPitch),o.bC(this.maxPitch)),this.angle=o.bB(b,-Math.PI,Math.PI),this._setZoom(o.ap(V,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.a5(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,p=o.bV,b=0,w=1/0;for(;p-l>1e-6&&p>l;){const C=l+.5*(p-l),O=this.tileSize*Math.pow(2,C),V=this.getCameraToCenterDistance(this.projection,C,O),G=this.scaleZoom(V/(r*this.tileSize)),j=Math.abs(C-G);j<w&&(w=j,b=C),C<G?l=C:p=C}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const p=Math.min(r.x,l.x),b=Math.max(r.x,l.x),w=Math.min(r.y,l.y),C=Math.max(r.y,l.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new o.P(p,w),new o.P(b,C),new o.P(p,C),new o.P(b,w)],V=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const j of O){const Y=this.pointRayIntersection(j);if(Y.t<0)return!0;const Q=this.rayIntersectionCoordinate(Y);if(Q.x<V||Q.y<0||Q.x>G||Q.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.c1(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(r,l){const p=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,r)),b=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,p,b],w){const C=[l,p,b,1];o.a6.vec4.transformMat4(C,C,w);const O=C[3]=Math.max(C[3],1e-6);return C[0]/=O,C[1]/=O,C[2]/=O,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,p=this.worldSize){const b=o.bY(r,l,this.width,this.height,1024),w=r.pixelSpaceConversion(this.center.lat,p,b);let C=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(C=Yc(1,C,Xc(this.pitch>=15?1:this.pitch/15))),C}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.a6.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const Ga=(f,r)=>{if(r>0&&f.terrain&&o.w("Cutoff is currently disabled on terrain"),r<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=f.transform,p=Math.max(Math.abs(l._zoom-(f.minCutoffZoom-1)),1),b=l.isLODDisabled(!1)?o.a7(60,45,l.pitch):o.a7(30,15,l.pitch),w=l._farZ-l._nearZ,C=r*l.height,O=((1-(V=b))*l.cameraToCenterDistance+V*(l._farZ+C))*p;var V;return{shouldRenderCutoff:b<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(O-l._nearZ)/w,(O-C-l._nearZ)/w]}}},Jr={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class hm{constructor(r,l){this.aabb=r,this.lastCascade=l}}class In{add(r,l){const p=this.receivers[r.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],l.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],l.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],l.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],l.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],l.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],l.max[2])):this.receivers[r.key]=new hm(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,p){const b=o.ca.fromPoints(r.points);let w=0;for(const C in this.receivers){const O=this.receivers[C];if(!O||!b.intersectsAabb(O.aabb))continue;O.aabb.min=b.closestPoint(O.aabb.min),O.aabb.max=b.closestPoint(O.aabb.max);const V=O.aabb.getCorners();for(let G=0;G<p.length;G++){let j=!0;for(const Y of V){const Q=[Y[0]*l,Y[1]*l,Y[2]];if(o.a6.vec3.transformMat4(Q,Q,p[G].matrix),Q[0]<-1||Q[0]>1||Q[1]<-1||Q[1]>1){j=!1;break}}if(O.lastCascade=G,w=Math.max(w,G),j)break}}return w+1}}class x_{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new In,this._depthMode=new io(r.context.gl.LEQUAL,io.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(Jr,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(Jr,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(Jr,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const b=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||b<=0||(this._shadowLayerCount=p.style.order.reduce((ve,me)=>{const we=p.style._mergedLayers[me];return ve+(we.hasShadowPass()&&!we.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=p.context,C=Jr.shadowMapResolution,O=Jr.shadowMapResolution;if(this._cascades.length===0||Jr.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ve=0;ve<Jr.cascadeCount;++ve){const me=p._shadowMapDebug,we=w.gl,be=w.createFramebuffer(C,O,me,"texture"),Pe=new o.T(w,{width:C,height:O,data:null},we.DEPTH_COMPONENT16);if(be.depthAttachment.set(Pe.texture),me){const $e=new o.T(w,{width:C,height:O,data:null},we.RGBA8);be.colorAttachment.set($e.texture)}this._cascades.push({framebuffer:be,texture:Pe,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.bO,scale:0})}}this.shadowDirection=Yh(l);let V=0;if(r.elevation){const ve=r.elevation,me=[1e4,-1e4];ve.visibleDemTiles.filter(we=>we.dem).forEach(we=>{const be=we.dem.tree;me[0]=Math.min(me[0],be.minimums[0]),me[1]=Math.max(me[1],be.maximums[0])}),me[0]!==1e4&&(V=(me[1]-me[0])*ve.exaggeration())}const G=1.5*r.cameraToCenterDistance,j=3*G,Y=new Float64Array(16);for(let ve=0;ve<this._cascades.length;++ve){const me=this._cascades[ve];let we=r.height/50,be=1;Jr.cascadeCount===1?be=j:ve===0?be=G:(we=G,be=j);const[Pe,$e]=Jh(r,this.shadowDirection,we,be,Jr.shadowMapResolution,V);me.scale=r.scale,me.matrix=Pe,me.boundingSphereRadius=$e,o.a6.mat4.invert(Y,me.matrix),me.frustum=o.bO.fromInvProjectionMatrix(Y,1,0,!0),me.far=be}const Q=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Q].far,this._cascades[Q].far],this._uniformValues.u_shadow_intensity=b,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Jr.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Jr.shadowMapResolution,this._uniformValues.u_shadowmap_0=Di.ShadowMap0,this._uniformValues.u_shadowmap_1=Di.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ie=p.transform.elevation;for(const ve of this._groundShadowTiles){let me={min:0,max:0};if(ie){const we=ie.getMinMaxForTile(ve);we&&(me=we)}this.addShadowReceiver(ve.toUnwrapped(),me.min,me.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const p=this.painter,b=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),b.viewport.set([0,0,Jr.shadowMapResolution,Jr.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){p.currentShadowCascade=w,b.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),b.clear({color:o.bA.white,depth:1});for(const C of r.order){const O=r._mergedLayers[C];if(!O.hasShadowPass()||O.isHidden(p.transform.zoom))continue;const V=r.getLayerSourceCache(O),G=V?l[V.id]:void 0;(O.type==="model"||G&&G.length)&&p.renderLayer(p,V,O,G)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,p=r.context,b=l.directionalLight,w=l.ambientLight;if(!b||!w)return;const C=[],O=Ga(r,r.longestCutoffRange);O.shouldRenderCutoff&&C.push("RENDER_CUTOFF"),C.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&C.push("NORMAL_OFFSET");const V=Xh(l,b,w),G=new io(p.gl.LEQUAL,io.ReadOnly,r.depthRangeFor3D);for(const j of this._groundShadowTiles){const Y=j.toUnwrapped(),Q=r.isTileAffectedByFog(j),ie=r.getOrCreateProgram("groundShadow",{defines:C,overrideFog:Q});this.setupShadows(Y,ie),r.uploadCommonUniforms(p,ie,Y,null,O);const ve={u_matrix:r.transform.calculateProjMatrix(Y),u_ground_shadow_factor:V};ie.draw(r,p.gl.TRIANGLES,G,Eo.disabled,Ho.multiply,bo.disabled,ve,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ho.unblended:Ho.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,p=l.calculatePosMatrix(r,l.worldSize);return o.a6.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(r){return o.a6.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,p,b=0){if(!this.enabled)return;const w=this.painter.transform,C=this.painter.context,O=C.gl,V=this._uniformValues,G=new Float64Array(16),j=w.calculatePosMatrix(r,w.worldSize);for(let Y=0;Y<this._cascades.length;Y++)o.a6.mat4.multiply(G,this._cascades[Y].matrix,j),V[Y===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(G),C.activeTexture.set(O.TEXTURE0+Di.ShadowMap0+Y),this._cascades[Y].texture.bind(O.NEAREST,O.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const Y=o.c9(r.canonical),Q=2/w.tileSize*o.ab/Jr.shadowMapResolution,ie=Q*this._cascades[0].boundingSphereRadius,ve=Q*this._cascades[this._cascades.length-1].boundingSphereRadius,me=(p==="vector-tile"?1:3)/Math.pow(2,b-r.canonical.z-(1-w.zoom+Math.floor(w.zoom)));V.u_shadow_normal_offset=[Y,ie*me,ve*me],V.u_shadow_bias=[6e-5,.0012,.012]}else V.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(C,V)}setupShadowsFromMatrix(r,l,p=!1){if(!this.enabled)return;const b=this.painter.context,w=b.gl,C=this._uniformValues,O=new Float64Array(16);for(let V=0;V<Jr.cascadeCount;V++)o.a6.mat4.multiply(O,this._cascades[V].matrix,r),C[V===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),b.activeTexture.set(w.TEXTURE0+Di.ShadowMap0+V),this._cascades[V].texture.bind(w.NEAREST,w.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const V=Jr.normalOffset;C.u_shadow_normal_offset=[1,V,V],C.u_shadow_bias=[6e-5,.0012,.012]}else C.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(b,C)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,p,b){if(b[2]>=0)return{};const w=function(V,G,j){const Y=j/(1<<V.canonical.z);return new o.ca([V.canonical.x*Y+V.wrap*j,V.canonical.y*Y+V.wrap*j,0],[(V.canonical.x+1)*Y+V.wrap*j,(V.canonical.y+1)*Y+V.wrap*j,G])}(r,l,p).getCorners(),C=l/-b[2];b[0]<0?(o.a6.vec3.add(w[0],w[0],[b[0]*C,0,0]),o.a6.vec3.add(w[3],w[3],[b[0]*C,0,0])):b[0]>0&&(o.a6.vec3.add(w[1],w[1],[b[0]*C,0,0]),o.a6.vec3.add(w[2],w[2],[b[0]*C,0,0])),b[1]<0?(o.a6.vec3.add(w[0],w[0],[0,b[1]*C,0]),o.a6.vec3.add(w[1],w[1],[0,b[1]*C,0])):b[1]>0&&(o.a6.vec3.add(w[2],w[2],[0,b[1]*C,0]),o.a6.vec3.add(w[3],w[3],[0,b[1]*C,0]));const O={};return O.vertices=w,O.planes=[Jc(w[1],w[0],w[4]),Jc(w[2],w[1],w[5]),Jc(w[3],w[2],w[6]),Jc(w[0],w[3],w[7])],O}addShadowReceiver(r,l,p){this._receivers.add(r,o.ca.fromTileIdAndHeight(r,l,p))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function Jc(f,r,l){const p=o.a6.vec3.sub([],l,r),b=o.a6.vec3.sub([],f,r),w=o.a6.vec3.cross([],p,b),C=o.a6.vec3.length(w);return C===0?[0,0,1,0]:(o.a6.vec3.scale(w,w,1/C),[w[0],w[1],w[2],-o.a6.vec3.dot(w,r)])}function Yh(f){const r=f.properties.get("direction"),l=o.c8(r.x,r.y,r.z);l[2]=o.ap(l[2],0,75);const p=o.cb([l[0],l[1],l[2]]);return o.a6.vec3.fromValues(p.x,p.y,p.z)}function Xh(f,r,l){const p=r.properties.get("color"),b=r.properties.get("intensity"),w=r.properties.get("direction"),C=[w.x,w.y,w.z],O=l.properties.get("color"),V=l.properties.get("intensity"),G=Math.max(o.a6.vec3.dot([0,0,1],C),0),j=[0,0,0];o.a6.vec3.scale(j,O.toRenderColor(f.getLut(r.scope)).toArray01Linear().slice(0,3),V);const Y=[0,0,0];return o.a6.vec3.scale(Y,p.toRenderColor(f.getLut(l.scope)).toArray01Linear().slice(0,3),G*b),o.cc([j[0]>0?j[0]/(j[0]+Y[0]):0,j[1]>0?j[1]/(j[1]+Y[1]):0,j[2]>0?j[2]/(j[2]+Y[2]):0])}function Jh(f,r,l,p,b,w){const C=f.zoom,O=f.scale,V=f.worldSize,G=1/V,j=f.aspect,Y=Math.sqrt(1+j*j)*Math.tan(.5*f.fovX),Q=Y*Y,ie=p-l,ve=p+l;let me,we;Q>ie/ve?(me=p,we=p*Y):(me=.5*ve*(1+Q),we=.5*Math.sqrt(ie*ie+2*(p*p+l*l)*Q+ve*ve*Q*Q));const be=f.projection.pixelsPerMeter(f.center.lat,V),Pe=f._camera.getCameraToWorldMercator(),$e=[0,0,-me*G];o.a6.vec3.transformMat4($e,$e,Pe);let Ve=we*G;const We=f._edgeInsets;if(!(We.left===0&&We.top===0&&We.right===0&&We.bottom===0||We.left===We.right&&We.top===We.bottom)){const rn=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?be:1),hn=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,l,p);hn[8]=2*-f.centerOffset.x/f.width,hn[9]=2*f.centerOffset.y/f.height;const nn=new Float64Array(16);o.a6.mat4.mul(nn,hn,rn);const An=new Float64Array(16);o.a6.mat4.invert(An,nn);const Zn=o.bO.fromInvProjectionMatrix(An,V,C,!0);for(const to of Zn.points){const Hn=((Xe=to)[0]/=O,Xe[1]/=O,Xe[2]=o.bE(Xe[2],f._center.lat),Xe);Ve=Math.max(Ve,o.a6.vec3.len(o.a6.vec3.subtract([],$e,Hn)))}}var Xe;Ve*=b/(b-1);const Ke=Math.acos(r[2]),Je=Math.atan2(-r[0],-r[1]),rt=new lc;rt.position=$e,rt.setPitchBearing(Ke,Je);const ht=rt.getWorldToCamera(V,be),lt=Ve*V,st=Math.min(f._mercatorZfromZoom(17)*V*-2,-2*lt),Lt=rt.getCameraToClipOrthographic(-lt,lt,-lt,lt,st,(lt+w*be)/r[2]),Wt=new Float64Array(16);o.a6.mat4.multiply(Wt,Lt,ht);const ln=o.a6.vec3.fromValues(Math.floor(1e6*$e[0])/1e6*V,Math.floor(1e6*$e[1])/1e6*V,0),yn=.5*b,Tn=[0,0,0];o.a6.vec3.transformMat4(Tn,ln,Wt),o.a6.vec3.scale(Tn,Tn,yn);const wt=[Math.floor(Tn[0]),Math.floor(Tn[1]),Math.floor(Tn[2])],on=[0,0,0];o.a6.vec3.sub(on,Tn,wt),o.a6.vec3.scale(on,on,-1/yn);const Vt=new Float64Array(16);return o.a6.mat4.identity(Vt),o.a6.mat4.translate(Vt,Vt,on),o.a6.mat4.multiply(Wt,Vt,Wt),[Wt,lt]}class Wa extends o.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.numModelsLoading={}}loadModel(r,l){return o.aG(this.requestManager.transformRequest(l,o.R.Model).url).then(p=>{if(!p)return;const b=o.aH(p),w=new o.aI(r,void 0,void 0,b);return w.computeBoundsAndApplyParent(),w}).catch(p=>{if(p&&p.status===404)return null;this.fire(new o.t(new Error(`Could not load model ${r} from ${l}: ${p.message}`)))})}load(r,l){this.models[l]||(this.models[l]={});const p=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+p.length;const b=[];for(const w of p)b.push(this.loadModel(w,r[w]));Promise.allSettled(b).then(w=>{for(let C=0;C<w.length;C++){const{status:O,value:V}=w[C];O==="fulfilled"&&V&&(this.models[l][p[C]]={model:V,numReferences:1})}this.numModelsLoading[l]-=p.length,this.fire(new o.x("data",{dataType:"style"}))}).catch(w=>{this.fire(new o.t(new Error(`Could not load models: ${w.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,p){this.models[p]||(this.models[p]={}),this.hasModel(r,p)&&this.models[p][r].numReferences++,this.load({[r]:this.requestManager.normalizeModelURL(l)},p)}addModels(r,l){this.models[l]||(this.models[l]={});const p={};for(const b in r)this.models[l][b]={},p[b]=this.requestManager.normalizeModelURL(r[b]);this.load(p,l)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={});const p={};for(const b of r)this.hasModel(b,l)?this.models[l][b].numReferences++:p[b]=this.requestManager.normalizeModelURL(b);this.load(p,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const p=this.models[l][r].model;delete this.models[l][r],p.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const p in this.models[l])this.models[l][p].model&&this.models[l][p].model.upload(r.context)}}const fm=new o.a0({data:new o.a1(o._.colorTheme.data)}),Ts=(f,r)=>bt(f,r&&r.filter(l=>l.identifier!=="source.canvas")),Qh=o.ar(rr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Qc=o.ar(rr,["setCenter","setZoom","setBearing","setPitch"]),w_={version:8,layers:[],sources:{}},S_={duration:300,delay:0};class Cs extends o.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=o.l({},S_),this._buildingIndex=new rm(this),this.crossTileSymbolIndex=new Wh,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._mergedLayerSelectors=new Map,this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new Ge,this.dispatcher=l.dispatcher?l.dispatcher:new o.ce(o.cf(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Nt,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new o.cg(r._requestManager,l.localFontFamily?o.ch.all:l.localIdeographFontFamily?o.ch.ideographs:o.ch.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new Wa(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",o.ci());const p=this;this._rtlTextPluginCallback=Cs.registerForPluginStateChange(b=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(w,C)=>{if(o.cj(w),C&&C.every(O=>O))for(const O in p._sourceCaches){const V=p._sourceCaches[O],G=V.getSource().type;G!=="vector"&&G!=="geojson"||V.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const w=this.getOwnSource(b.sourceId);if(w&&w.vectorLayerIds)for(const C in this._layers){const O=this._layers[C];O.source===w.id&&this._validateLayer(O)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(o.f(r))return r;const l=o.ck(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${o.cl(JSON.stringify(r))}`}_diffStyle(r,l,p){this.globalId=this._getGlobalId(r);const b=(w,C)=>{try{C(null,this.setState(w,p))}catch(O){C(O,!1)}};if(typeof r=="string"){const w=this.map._requestManager.normalizeStyleURL(r),C=this.map._requestManager.transformRequest(w,o.R.Style);o.n(C,(O,V)=>{O?this.fire(new o.t(O)):V&&b(V,l)})}else typeof r=="object"&&b(r,l)}loadURL(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"}));const p=typeof l.validate=="boolean"?l.validate:!o.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const b=this.importsCache.get(r);if(b)return this._load(b,p);const w=this.map._requestManager.transformRequest(r,o.R.Style);this._request=o.n(w,(C,O)=>{if(this._request=null,C)this.fire(new o.t(C));else if(O)return this.importsCache.set(r,O),this._load(O,p)})}loadJSON(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=o.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new o.x("dataloading",{dataType:"style"})),this._load(w_,!1)}_loadImports(r,l,p){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const b=[];for(const w of r){const C=this._createFragmentStyle(w),O=new Promise(j=>{C.once("style.import.load",j),C.once("error",j)}).then(()=>this.mergeAll());if(b.push(O),this.resolvedImports.has(w.url)){C.loadEmpty();continue}const V=w.data||this.importsCache.get(w.url);V?(C.loadJSON(V,{validate:l}),this._isInternalStyle(V)&&(C.globalId=null)):w.url?C.loadURL(w.url,{validate:l}):C.loadEmpty();const G={style:C,id:w.id,config:w.config};if(p){const j=this.fragments.findIndex(({id:Y})=>Y===p);this.fragments=this.fragments.slice(0,j).concat(G).concat(this.fragments.slice(j))}else this.fragments.push(G)}return Promise.allSettled(b)}getImportGlobalIds(r=this,l=new Set){for(const p of r.fragments)p.style.globalId&&l.add(p.style.globalId),this.getImportGlobalIds(p.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?o.av(r.id,this.scope):r.id;let p;const b=this._initialConfig&&this._initialConfig[l];(r.config||b)&&(p=o.l({},r.config,b));const w=new Cs(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const p=r.schema;if(this._isInternalStyle(r)){const C=o.l({},w_,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(C,l)}if(this.updateConfig(this._config,p),l&&Ts(this,Xr(r)))return;this._loaded=!0,this.stylesheet=o.cm(r);const b=()=>{for(const G in r.sources)this.addSource(G,r.sources[G],{validate:!1,isInitialLoad:!0});r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const C=im(this.stylesheet.layers);if(this._order=C.map(G=>G.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const G=this.stylesheet.lights[0];this.light=new Tt(G.properties,G.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Tt(this.stylesheet.light)),this._layers={};for(const G of C){const j=o.cq(G,this.scope,this._styleColorTheme.lut,this.options);j.configDependencies.size!==0&&this._configDependentLayers.add(j.fqid),j.setEventedParent(this,{layer:{id:j.id}}),this._layers[j.id]=j;const Y=this.getOwnLayerSourceCache(j),Q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Y&&j.canCastShadows()&&Q&&(Y.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const O=this.stylesheet.terrain;O&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(O,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.x("data",{dataType:"style"}));const V=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load")))},w=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=w,w){const C=this._evaluateColorThemeData(w);this._loadColorTheme(C).then(()=>{b()}).catch(O=>{o.w(`Couldn't load color theme from the stylesheet: ${O}`),b()})}else this._styleColorTheme.lut=null,b()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,p,b,w,C,O,V;const G={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(j=>{if(j.stylesheet){if(j.light!=null&&(r=j.light),j.stylesheet.lights)for(const Y of j.stylesheet.lights)Y.type==="ambient"&&j.ambientLight!=null&&(l=j.ambientLight),Y.type==="directional"&&j.directionalLight!=null&&(p=j.directionalLight);b=this._prioritizeTerrain(b,j.terrain,j.stylesheet.terrain),j.stylesheet.fog&&j.fog!=null&&(w=j.fog),j.stylesheet.camera!=null&&(V=j.stylesheet.camera),j.stylesheet.projection!=null&&(C=j.stylesheet.projection),j.stylesheet.transition!=null&&(O=j.stylesheet.transition),G[j.scope]=j._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=p,this.fog=w,this._styleColorThemeForScope=G,b===null?delete this.terrain:this.terrain=b,this.camera=V||{"camera-projection":"perspective"},this.projection=C||{name:"mercator"},this.transition=o.l({},S_,O),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=p=>{for(const b of p.fragments)l(b.style);r(p)};l(this)}_prioritizeTerrain(r,l,p){const b=r&&r.drapeRenderMode===0;return p===null?l&&l.drapeRenderMode===0?l:b?r:null:l!=null&&(!r||b||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},p={};this.forEachFragmentStyle(b=>{for(const w in b._sourceCaches){const C=o.av(w,b.scope);r[C]=b._sourceCaches[w]}for(const w in b._otherSourceCaches){const C=o.av(w,b.scope);l[C]=b._otherSourceCaches[w]}for(const w in b._symbolSourceCaches){const C=o.av(w,b.scope);p[C]=b._symbolSourceCaches[w]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=p}mergeLayers(){const r={},l=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._mergedLayerSelectors.clear(),this.forEachFragmentStyle(w=>{for(const O of w._order){const V=w._layers[O];if(V.type==="slot"){const G=o.cn(O);if(r[G])continue;r[G]=[]}V.slot&&r[V.slot]?r[V.slot].push(V):l.push(V)}const{featuresets:C}=w.stylesheet||{};if(C)for(const O in C){const{selectors:V}=C[O];for(const G of V){const j=w._layers[G.layer],Y=this._mergedLayerSelectors.get(j.fqid)||[];let Q;if(G.properties)for(const ie in G.properties){const ve=o.M(G.properties[ie]);ve.result==="success"&&(Q=Q||{},Q[ie]=ve.value)}Y.push({featuresetId:O,featureNamespace:G.featureNamespace,properties:Q}),this._mergedLayerSelectors.set(j.fqid,Y)}}}),this._mergedOrder=[];const b=(w=[])=>{for(const C of w)if(C.type==="slot"){const O=o.cn(C.id);r[O]&&b(r[O]),this._mergedSlots.push(O)}else{const O=o.av(C.id,C.scope);this._mergedOrder.push(O),p[O]=C,C.is3D()&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&(this._clipLayerPresent=!0)}};b(l),this._mergedOrder.sort((w,C)=>{const O=p[w],V=p[C];return O.hasInitialOcclusionOpacityProperties?V.is3D()?1:0:O.is3D()&&V.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=o.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,p,b){const w=o.l({},p);for(const O of Object.keys(o._.colorTheme))w[O]===void 0&&(w[O]=o._.colorTheme[O].default);const C=new o.$(fm,l,new Map(b));return C.setTransitionOrValue(w,b),C.untransitioned().possiblyEvaluate(new o.a3(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,b)=>{const w="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let C=r;C.startsWith(w)||(C=w+C);const O="mapbox-reserved-lut",V=new Image;V.src=C,V.onerror=()=>{this._styleColorTheme.lutLoading=!1,b(new Error("Failed to load image data"))},V.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void p();this._styleColorTheme.lutLoading=!1;const{width:G,height:j,data:Y}=o.q.getImageData(V);if(j>32)return void b(new Error("The height of the image must be less than or equal to 32 pixels."));if(G!==j*j)return void b(new Error("The width of the image must be equal to the height squared."));this.getImage(O)&&this.removeImage(O),this.addImage(O,{data:new o.r({width:G,height:j},Y),pixelRatio:1,sdf:!1,version:0});const Q=this.imageManager.getImage(O,this.scope);Q?(this._styleColorTheme.lut={image:Q.data,data:r},p()):b(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,p,b){let w,C,O;const V=o.q.devicePixelRatio>1?"@2x":"";let G=o.n(p.transformRequest(p.normalizeSpriteURL(l,V,".json"),o.R.SpriteJSON),(Q,ie)=>{G=null,O||(O=Q,w=ie,Y())}),j=o.o(p.transformRequest(p.normalizeSpriteURL(l,V,".png"),o.R.SpriteImage),(Q,ie)=>{j=null,O||(O=Q,C=ie,Y())});function Y(){if(O)b(O);else if(w&&C){const Q=o.q.getImageData(C),ie={};for(const ve in w){const{width:me,height:we,x:be,y:Pe,sdf:$e,pixelRatio:Ve,stretchX:We,stretchY:Xe,content:Ke}=w[ve],Je=new o.r({width:me,height:we});o.r.copy(Q,Je,{x:be,y:Pe},{x:0,y:0},{width:me,height:we},null),ie[ve]={data:Je,pixelRatio:Ve,sdf:$e,stretchX:We,stretchY:Xe,content:Ke}}b(null,ie)}}return{cancel(){G&&(G.cancel(),G=null),j&&(j.cancel(),j=null)}}}(r,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new o.t(l));else if(p)for(const b in p)this.imageManager.addImage(b,this.scope,p[b]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.x("data",{dataType:"style"}))})}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const p=r.sourceLayer;p&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(p)===-1)&&this.fire(new o.t(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const p=this.fragments[l];return p&&p.style&&(r.data=p.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();r[p.id]||(r[p.id]=p.serialize())}return r}_serializeLayers(r){const l=[];for(const p of r){const b=this._layers[p];b&&b.type!=="custom"&&l.push(b.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new o.t(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new o.t(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const p=this.map.painter;if(p)for(let b=r.minzoom||0;b<(r.maxzoom||25.5);b++){const w=r.getProgramIds();if(w)for(const C of w){const O=r.getDefaultProgramParams(C,l.zoom,this._styleColorTheme.lut);O&&(p.style=this,this.fog&&(p._fogVisible=!0,O.overrideFog=!0,p.getOrCreateProgram(C,O)),p._fogVisible=!1,O.overrideFog=!1,p.getOrCreateProgram(C,O),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(O.overrideRtt=!0,p.getOrCreateProgram(C,O)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const p=this._changes.isDirty();let b=!1;if(this._changes.isDirty()){const C=this._changes.getLayerUpdatesByScope();for(const O in C){const{updatedIds:V,removedIds:G}=C[O];(V||G)&&(this._updateWorkerLayers(O,V,G),b=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._changes.reset()}const w={};for(const C in this._mergedSourceCaches){const O=this._mergedSourceCaches[C];w[C]=O.used,O.used=!1,O.tileCoverLift=0}for(const C of this._mergedOrder){const O=this._mergedLayers[C];if(O.recalculate(r,this._availableImages),!O.isHidden(r.zoom)){const V=this.getLayerSourceCache(O);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,O.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(O,r)}):this.precompilePrograms(O,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&b&&this.mergeLayers();for(const C in w){const O=this._mergedSourceCaches[C];w[C]!==O.used&&O.getSource().fire(new o.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:O.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new o.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,p){const b=this.getFragmentStyle(r);b&&this.dispatcher.broadcast("updateLayers",{layers:l?b._serializeLayers(l):[],scope:r,removedIds:p||[],options:b.options})}setState(r,l){if(this._checkLoaded(),Ts(this,Xr(r)))return!1;(r=o.cm(r)).layers=im(r.layers);const p=function(C,O){if(!C)return[{command:rr.setStyle,args:[O]}];let V=[];try{if(!o.bi(C.version,O.version))return[{command:rr.setStyle,args:[O]}];if(o.bi(C.center,O.center)||V.push({command:rr.setCenter,args:[O.center]}),o.bi(C.zoom,O.zoom)||V.push({command:rr.setZoom,args:[O.zoom]}),o.bi(C.bearing,O.bearing)||V.push({command:rr.setBearing,args:[O.bearing]}),o.bi(C.pitch,O.pitch)||V.push({command:rr.setPitch,args:[O.pitch]}),o.bi(C.sprite,O.sprite)||V.push({command:rr.setSprite,args:[O.sprite]}),o.bi(C.glyphs,O.glyphs)||V.push({command:rr.setGlyphs,args:[O.glyphs]}),o.bi(C.imports,O.imports)||function(ie=[],ve=[],me){ve=ve||[];const we=(ie=ie||[]).map(rc),be=ve.map(rc),Pe=ie.reduce(Vc,{}),$e=ve.reduce(Vc,{}),Ve=we.slice();let We,Xe,Ke,Je;for(We=0,Xe=0;We<we.length;We++)Ke=we[We],$e.hasOwnProperty(Ke)?Xe++:(me.push({command:rr.removeImport,args:[Ke]}),Ve.splice(Ve.indexOf(Ke,Xe),1));for(We=0,Xe=0;We<be.length;We++)Ke=be[be.length-1-We],Ve[Ve.length-1-We]!==Ke&&(Pe.hasOwnProperty(Ke)?(me.push({command:rr.removeImport,args:[Ke]}),Ve.splice(Ve.lastIndexOf(Ke,Ve.length-Xe),1)):Xe++,Je=Ve[Ve.length-We],me.push({command:rr.addImport,args:[$e[Ke],Je]}),Ve.splice(Ve.length-We,0,Ke));for(const rt of ve){const ht=Pe[rt.id];ht&&!o.bi(ht,rt)&&me.push({command:rr.updateImport,args:[rt.id,rt]})}}(C.imports,O.imports,V),o.bi(C.transition,O.transition)||V.push({command:rr.setTransition,args:[O.transition]}),o.bi(C.light,O.light)||V.push({command:rr.setLight,args:[O.light]}),o.bi(C.fog,O.fog)||V.push({command:rr.setFog,args:[O.fog]}),o.bi(C.projection,O.projection)||V.push({command:rr.setProjection,args:[O.projection]}),o.bi(C.lights,O.lights)||V.push({command:rr.setLights,args:[O.lights]}),o.bi(C.camera,O.camera)||V.push({command:rr.setCamera,args:[O.camera]}),!o.bi(C["color-theme"],O["color-theme"]))return[{command:rr.setStyle,args:[O]}];const G={},j=[];(function(ie,ve,me,we){let be;for(be in ve=ve||{},ie=ie||{})ie.hasOwnProperty(be)&&(ve.hasOwnProperty(be)||pr(be,me,we));for(be in ve){if(!ve.hasOwnProperty(be))continue;const Pe=ve[be];ie.hasOwnProperty(be)?o.bi(ie[be],Pe)||(ie[be].type==="geojson"&&Pe.type==="geojson"&&mo(ie,ve,be)?me.push({command:rr.setGeoJSONSourceData,args:[be,Pe.data]}):m1(be,ve,me,we)):sm(be,ve,me)}})(C.sources,O.sources,j,G);const Y=[];C.layers&&C.layers.forEach(ie=>{ie.source&&G[ie.source]?V.push({command:rr.removeLayer,args:[ie.id]}):Y.push(ie)});let Q=C.terrain;Q&&G[Q.source]&&(V.push({command:rr.setTerrain,args:[void 0]}),Q=void 0),V=V.concat(j),o.bi(Q,O.terrain)||V.push({command:rr.setTerrain,args:[O.terrain]}),function(ie,ve,me){ve=ve||[];const we=(ie=ie||[]).map(rc),be=ve.map(rc),Pe=ie.reduce(Vc,{}),$e=ve.reduce(Vc,{}),Ve=we.slice(),We=Object.create(null);let Xe,Ke,Je,rt,ht,lt,st;for(Xe=0,Ke=0;Xe<we.length;Xe++)Je=we[Xe],$e.hasOwnProperty(Je)?Ke++:(me.push({command:rr.removeLayer,args:[Je]}),Ve.splice(Ve.indexOf(Je,Ke),1));for(Xe=0,Ke=0;Xe<be.length;Xe++)Je=be[be.length-1-Xe],Ve[Ve.length-1-Xe]!==Je&&(Pe.hasOwnProperty(Je)?(me.push({command:rr.removeLayer,args:[Je]}),Ve.splice(Ve.lastIndexOf(Je,Ve.length-Ke),1)):Ke++,lt=Ve[Ve.length-Xe],me.push({command:rr.addLayer,args:[$e[Je],lt]}),Ve.splice(Ve.length-Xe,0,Je),We[Je]=!0);for(Xe=0;Xe<be.length;Xe++)if(Je=be[Xe],rt=Pe[Je],ht=$e[Je],!We[Je]&&!o.bi(rt,ht))if(o.bi(rt.source,ht.source)&&o.bi(rt["source-layer"],ht["source-layer"])&&o.bi(rt.type,ht.type)){for(st in pd(rt.layout,ht.layout,me,Je,null,rr.setLayoutProperty),pd(rt.paint,ht.paint,me,Je,null,rr.setPaintProperty),o.bi(rt.slot,ht.slot)||me.push({command:rr.setSlot,args:[Je,ht.slot]}),o.bi(rt.filter,ht.filter)||me.push({command:rr.setFilter,args:[Je,ht.filter]}),o.bi(rt.minzoom,ht.minzoom)&&o.bi(rt.maxzoom,ht.maxzoom)||me.push({command:rr.setLayerZoomRange,args:[Je,ht.minzoom,ht.maxzoom]}),rt)rt.hasOwnProperty(st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&st!=="slot"&&(st.indexOf("paint.")===0?pd(rt[st],ht[st],me,Je,st.slice(6),rr.setPaintProperty):o.bi(rt[st],ht[st])||me.push({command:rr.setLayerProperty,args:[Je,st,ht[st]]}));for(st in ht)ht.hasOwnProperty(st)&&!rt.hasOwnProperty(st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&st!=="slot"&&(st.indexOf("paint.")===0?pd(rt[st],ht[st],me,Je,st.slice(6),rr.setPaintProperty):o.bi(rt[st],ht[st])||me.push({command:rr.setLayerProperty,args:[Je,st,ht[st]]}))}else me.push({command:rr.removeLayer,args:[Je]}),lt=Ve[Ve.lastIndexOf(Je)+1],me.push({command:rr.addLayer,args:[ht,lt]})}(Y,O.layers,V)}catch(G){console.warn("Unable to compute style diff:",G),V=[{command:rr.setStyle,args:[O]}]}return V}(this.serialize(),r).filter(C=>!(C.command in Qc));if(p.length===0)return!1;const b=p.filter(C=>!(C.command in Qh));if(b.length>0)throw new Error(`Unimplemented: ${b.map(C=>C.command).join(", ")}.`);const w=[];return p.forEach(C=>{w.push(this[C.command].apply(this,C.args))}),l&&Promise.all(w).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new o.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l){this.imageManager.updateImage(r,this.scope,l)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new o.t(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new o.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,p={}){return this._checkLoaded(),this._validate(ft,`models.${r}`,l,null,p)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new o.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,p={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Ur,`sources.${r}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const b=Fh(r,l,this.dispatcher,this);b.scope=this.scope,b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(b.id),source:b.serialize(),sourceId:b.id}));const w=C=>{const O=(C?"symbol:":"other:")+b.id,V=o.av(O,this.scope),G=this._sourceCaches[O]=new ss(V,b,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[b.id]=G,G.onAdd(this.map)};w(!1),l.type!=="vector"&&l.type!=="geojson"||w(!0),b.onAdd&&b.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(r);for(const b of p){const w=o.cn(b.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(b.id),b.fire(new o.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const p=this.getOwnSourceCache(l);p&&r.push(p.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const p=r[l]._tiles;for(const b in p){const w=p[b];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const b of r){if(this._validate(Oo,"lights",b))return;switch(b.type){case"ambient":if(this.ambientLight){const w=this.ambientLight;w.set(b),w.updateTransitions(l)}else this.ambientLight=new ao(b,Ko||(Ko=new o.a0({color:new o.a1(o._.properties_light_ambient.color),intensity:new o.a1(o._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const w=this.directionalLight;w.set(b),w.updateTransitions(l)}else this.directionalLight=new ao(b,jo||(jo=new o.a0({direction:new o.ad(o._.properties_light_directional.direction),color:new o.a1(o._.properties_light_directional.color),intensity:new o.a1(o._.properties_light_directional.intensity),"cast-shadows":new o.a1(o._.properties_light_directional["cast-shadows"]),"shadow-intensity":new o.a1(o._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new o.a3(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const p=Q=>.2126*(Q[0]<=.03928?Q[0]/12.92:Math.pow((Q[0]+.055)/1.055,2.4))+.7152*(Q[1]<=.03928?Q[1]/12.92:Math.pow((Q[1]+.055)/1.055,2.4))+.0722*(Q[2]<=.03928?Q[2]/12.92:Math.pow((Q[2]+.055)/1.055,2.4)),b=r.properties.get("color").toRenderColor(null).toArray01(),w=r.properties.get("intensity"),C=r.properties.get("direction"),O=1-o.c8(C.x,C.y,C.z)[2]/90,V=p(b)*w*O,G=l.properties.get("color").toRenderColor(null).toArray01(),j=l.properties.get("intensity"),Y=p(G)*j;return Number(((V+Y)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(o.aK(r)){const l=o.co(r),p=this.fragments.find(({id:w})=>w===l);if(!p)throw new Error(`Style import '${r}' not found`);const b=o.cn(r);return p.style.getFragmentStyle(b)}{const l=this.fragments.find(({id:p})=>p===r);if(!l)throw new Error(`Style import '${r}' not found`);return l.style}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const p=[];for(const b in l.stylesheet.featuresets)p.push({featuresetId:b,importId:l.scope?l.scope:void 0});return p}getFeaturesetLayers(r,l){const p=this.getFragmentStyle(l),b=p.stylesheet.featuresets;if(!b||!b[r])return this.fire(new o.t(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const C of b[r].selectors){const O=p.getOwnLayer(C.layer);O&&w.push(O)}return w}getConfigProperty(r,l){const p=this.getFragmentStyle(r);if(!p)return null;const b=o.av(l,p.scope),w=p.options.get(b),C=w?w.value||w.default:null;return C?C.serialize():null}setConfigProperty(r,l,p){const b=this.getFragmentStyle(r);if(!b)return;const w=b.stylesheet.schema;if(!w||!w[l])return;const C=o.M(p);if(C.result!=="success")return void Ts(this,C.value);const O=C.value.expression,V=o.av(l,b.scope),G=b.options.get(V);if(!G)return;let j;const{minValue:Y,maxValue:Q,stepValue:ie,type:ve,values:me}=w[l],we=o.M(w[l].default);we.result==="success"&&(j=we.value.expression),j?(this.options.set(V,{...G,value:O,default:j,minValue:Y,maxValue:Q,stepValue:ie,type:ve,values:me}),this.updateConfigDependencies(l)):this.fire(new o.t(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const p=l.stylesheet.schema;if(!p)return null;const b={};for(const w in p){const C=o.av(w,l.scope),O=l.options.get(C),V=O?O.value||O.default:null;b[w]=V?V.serialize():null}return b}setConfig(r,l){const p=this.getFragmentStyle(r);p&&(p.updateConfig(l,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const p=this.getFragmentStyle(r);p&&(p.stylesheet.schema=l,p.updateConfig(p._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const p in l){let b,w;const C=o.M(l[p].default);if(C.result==="success"&&(b=C.value.expression),r&&r[p]!==void 0){const Q=o.M(r[p]);Q.result==="success"&&(w=Q.value.expression)}const{minValue:O,maxValue:V,stepValue:G,type:j,values:Y}=l[p];if(b){const Q=o.av(p,this.scope);this.options.set(Q,{default:b,value:w,minValue:O,maxValue:V,stepValue:G,type:j,values:Y})}else this.fire(new o.t(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new o.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const p=this.getLayer(l);if(p){if(r&&!p.configDependencies.has(r))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const p=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut&&p!==""||l._styleColorTheme.lut&&p!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(r,l,p={}){this._checkLoaded();const b=r.id;if(this._layers[b])return void this.fire(new o.t(new Error(`Layer with id "${b}" already exists on this map`)));let w;if(r.type==="custom"){if(Ts(this,o.cp(r)))return;w=o.cq(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(b,r.source),r=o.cm(r),r=o.l(r,{source:b})),this._validate($t,`layers.${b}`,r,{arrayIndex:-1},p))return;w=o.cq(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:b}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let C=this._order.length;if(l){const j=this._order.indexOf(l);if(j===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));w.slot===this._layers[l].slot?C=j:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,b),this._layerOrderChanged=!0,this._layers[b]=w;const O=this.getOwnLayerSourceCache(w),V=!!this.directionalLight&&this.directionalLight.shadowsEnabled();O&&w.canCastShadows()&&V&&(O.castsShadows=!0);const G=this._changes.getRemovedLayer(w);if(G&&w.source&&O&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const j=o.av(w.source,w.scope);G.type!==w.type?this._changes.updateSourceCache(j,"clear"):(this._changes.updateSourceCache(j,"reload"),O.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const p=this._checkLayer(r);if(!p||r===l)return;const b=this._order.indexOf(r);this._order.splice(b,1);let w=this._order.length;if(l){const C=this._order.indexOf(l);if(C===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));p.slot===this._layers[l].slot?w=C:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const p=this._order.indexOf(r);this._order.splice(p,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const b=this.getOwnLayerSourceCache(l);if(b&&b.castsShadows){let w=!1;for(const C in this._layers)if(this._layers[C].source===l.source&&this._layers[C].canCastShadows()){w=!0;break}b.castsShadows=w}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,p){this._checkLoaded();const b=this._checkLayer(r);b&&(b.minzoom===l&&b.maxzoom===p||(l!=null&&(b.minzoom=l),p!=null&&(b.maxzoom=p),this._updateLayer(b)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const p=this._checkLayer(r);p&&p.slot!==l&&(p.slot=l,this._updateLayer(p))}setFilter(r,l,p={}){this._checkLoaded();const b=this._checkLayer(r);if(b&&!o.bi(b.filter,l))return l==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(Se,`layers.${b.id}.filter`,l,{layerType:b.type},p)||(b.filter=o.cm(l),this._updateLayer(b)))}getFilter(r){const l=this._checkLayer(r);if(l)return o.cm(l.filter)}setLayoutProperty(r,l,p,b={}){this._checkLoaded();const w=this._checkLayer(r);if(w&&!o.bi(w.getLayoutProperty(l),p)){if(p!=null&&(!b||b.validate!==!1)&&Ts(w,He.call(Xr,{key:`layers.${r}.layout.${l}`,layerType:w.type,objectKey:l,value:p,styleSpec:o._,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(l,p),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(r,l){const p=this._checkLayer(r);if(p)return p.getLayoutProperty(l)}setPaintProperty(r,l,p,b={}){this._checkLoaded();const w=this._checkLayer(r);if(!w||o.bi(w.getPaintProperty(l),p)||p!=null&&(!b||b.validate!==!1)&&Ts(w,Ae.call(Xr,{key:`layers.${r}.paint.${l}`,layerType:w.type,objectKey:l,value:p,styleSpec:o._})))return;const C=w.setPaintProperty(l,p);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),C&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(r,l){const p=this._checkLayer(r);if(p)return p.getPaintProperty(l)}setFeatureState(r,l){this._checkLoaded();const p=r.featureset;if(p){if("featuresetId"in p){const G=this.getFragmentStyle(p.importId),j=G.getFeaturesetLayers(p.featuresetId);for(const{source:Y,sourceLayer:Q}of j)G.setFeatureState({id:r.id,source:Y,sourceLayer:Q},l)}else if("layerId"in p){const G=this.getLayer(p.layerId);this.setFeatureState({id:r.id,source:G.source,sourceLayer:G.sourceLayer},l)}return}const b=r.source,w=r.sourceLayer,C=this._checkSource(b);if(!C)return;const O=C.type;if(O==="geojson"&&w)return void this.fire(new o.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(O==="vector"&&!w)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided.")));const V=this.getOwnSourceCaches(b);for(const G of V)G.setFeatureState(w,r.id,l)}removeFeatureState(r,l){this._checkLoaded();const p=r.featureset;if(p){if("featuresetId"in p){const G=this.getFragmentStyle(p.importId),j=G.getFeaturesetLayers(p.featuresetId);for(const{source:Y,sourceLayer:Q}of j)G.removeFeatureState({id:r.id,source:Y,sourceLayer:Q},l)}else if("layerId"in p){const G=this.getLayer(p.layerId);this.removeFeatureState({id:r.id,source:G.source,sourceLayer:G.sourceLayer},l)}return}const b=r.source,w=this._checkSource(b);if(!w)return;const C=w.type,O=C==="vector"?r.sourceLayer:void 0;if(C==="vector"&&!O)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.t(new Error("A feature id is required to remove its specific state property.")));const V=this.getOwnSourceCaches(b);for(const G of V)G.removeFeatureState(O,r.id,l)}getFeatureState(r){this._checkLoaded();const l=r.featureset;if(l){let C;if("featuresetId"in l){const O=this.getFragmentStyle(l.importId),V=O.getFeaturesetLayers(l.featuresetId);for(const{source:G,sourceLayer:j}of V){const Y=O.getFeatureState({id:r.id,source:G,sourceLayer:j});if(Y&&!C)C=Y;else if(!o.bi(C,Y))return void this.fire(new o.t(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r){const O=this.getLayer(l.layerId);C=this.getFeatureState({id:r.id,source:O.source,sourceLayer:O.sourceLayer})}return C}const p=r.source,b=r.sourceLayer,w=this._checkSource(p);if(w){if(w.type!=="vector"||b)return r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(p)[0].getFeatureState(b,r.id);this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=o.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return o.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return o.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),p=o.av(r.source,r.scope),b=this._changes.getUpdatedSourceCaches();r.source&&!b[p]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=O=>this._mergedLayers[O].is3D(),p=this.order,b={},w=[];for(let O=p.length-1;O>=0;O--){const V=p[O];if(l(V)){b[V]=O;for(const G of r){const j=G[V];if(j)for(const Y of j)w.push(Y)}}}w.sort((O,V)=>V.intersectionZ-O.intersectionZ);const C=[];for(let O=p.length-1;O>=0;O--){const V=p[O];if(l(V))for(let G=w.length-1;G>=0;G--){const j=w[G].feature;if(j.layer&&b[j.layer.id]<O)break;C.push(j),w.pop()}else for(const G of r){const j=G[V];if(j)for(const Y of j)C.push(Y.feature)}}return C}queryRenderedFeatures(r,l,p){l&&!Array.isArray(l)&&l.filter&&this._validate(Se,"queryRenderedFeatures.filter",l.filter,null,l);let b,w=!1;const C=new Set;if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.t(new Error("parameters.layers must be an Array."))),[];b=[];for(const j of l.layers){const Y=this._mergedLayers[j];if(!Y)return this.fire(new o.t(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];Y.is3D()&&(w=!0),C.add(Y.source),b.push(j)}}else w=this.has3DLayers();const O=this._queryRenderedFeatures(r,p,{layerIds:b,filter:l.filter,has3DLayers:w,includedSources:C}),V=this._flattenAndSortRenderedFeatures(O),G=[];for(const j of V)o.co(j.layer.id)===this.scope&&G.push(j);return G}queryRenderedFeaturesForInteractions(r,l,p){let b=[];for(const{featureset:V,filter:G,radius:j}of l){let Y=!1;const Q=[],ie=new Set;if("featuresetId"in V){const me=this.getFeaturesetLayers(V.featuresetId,V.importId);if(me.length===0)continue;for(const we of me)we.is3D()&&(Y=!0),ie.add(we.source),Q.push(we.fqid)}else if("layerId"in V){const me=this._mergedLayers[V.layerId];if(!me)return this.fire(new o.t(new Error(`The layer '${V.layerId}' does not exist in the map's style and cannot be queried for features.`))),[];me.is3D()&&(Y=!0),ie.add(me.source),Q.push(V.layerId)}let ve=r;if(j)if(r instanceof o.P||typeof r[0]=="number"){const me=o.P.convert(r);ve=[[me.x-j,me.y-j],[me.x+j,me.y+j]]}else{const me=o.P.convert(r[0]),we=o.P.convert(r[1]);ve=[[me.x-j,me.y-j],[we.x+j,we.y+j]]}b=b.concat(this._queryRenderedFeatures(ve,p,{layerIds:Q,filter:G,has3DLayers:Y,includedSources:ie}))}const w=this._flattenAndSortRenderedFeatures(b),C=(V,G,j)=>{const Y=V.clone();if(delete Y.layer,Y.featureset=G,j&&j.featureNamespace&&(Y.namespace=j.featureNamespace),j&&j.properties){const Q={},ie=this.map.transform.zoom;for(const ve of Object.keys(j.properties)){const me=j.properties[ve].evaluate({zoom:ie},V._vectorTileFeature,V.state,V.tile,this._availableImages);me!=null&&(Q[ve]=me)}Y.properties=Q}return Y},O=[];for(const V of w){const G=V.layer.id,j=o.cn(G),Y=o.co(G);for(const{featureset:Q}of l){if("layerId"in Q&&Q.layerId!==G)continue;if("layerId"in Q&&Q.layerId===G){const ve=C(V,Q);O.push(ve);continue}if("featuresetId"in Q&&(Q.importId!==Y||!this.getFeaturesetLayers(Q.featuresetId,Q.importId).map(ve=>ve.id).includes(j)))continue;const ie=this._mergedLayerSelectors.get(G)||[];for(const ve of ie){const me=C(V,Q,ve);O.push(me)}}}return O}_queryRenderedFeatures(r,l,p){const{layerIds:b,filter:w,has3DLayers:C,includedSources:O}=p,V=[],G=Ro.createFromScreenPoints(r,l);for(const j in this._mergedSourceCaches){if(!this._mergedSourceCaches[j].getSource())continue;const Y=this._mergedSourceCaches[j].getSource().id;b&&!O.has(Y)||V.push(em(this._mergedSourceCaches[j],this._mergedLayers,G,w,b||[],this._availableImages,l,C,!!this.map._showQueryGeometry))}return this.placement&&V.push(function(j,Y,Q,ie,ve,me,we,be){const Pe={},$e=we.queryRenderedSymbols(Q),Ve=[];for(const We of Object.keys($e).map(Number))Ve.push(be[We]);Ve.sort(Bc);for(const We of Ve){const Xe=We.featureIndex.lookupSymbolFeatures($e[We.bucketInstanceId],We.bucketIndex,We.sourceLayerIndex,ie,ve,me,j);for(const Ke in Xe){const Je=Pe[Ke]=Pe[Ke]||[],rt=Xe[Ke];rt.sort((ht,lt)=>{const st=We.featureSortOrder;if(st){const Lt=st.indexOf(ht.featureIndex);return st.indexOf(lt.featureIndex)-Lt}return lt.featureIndex-ht.featureIndex});for(const ht of rt)Je.push(ht)}}for(const We in Pe)Pe[We].forEach(Xe=>{const Ke=Xe.feature,Je=j[We],rt=Y(Je);if(!rt)return;const ht=rt.getFeatureState(Ke.layer["source-layer"],Ke.id);Ke.state=ht,o.aK(Je.id)||(Ke.source=Ke.layer.source,Ke.layer["source-layer"]&&(Ke.sourceLayer=Ke.layer["source-layer"]))});return Pe}(this._mergedLayers,this.getLayerSourceCache.bind(this),G.screenGeometry,w,b||[],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData)),V}querySourceFeatures(r,l){const p=l&&l.filter;p&&this._validate(Se,"querySourceFeatures.filter",p,null,l);let b=[];const w=this.getOwnSourceCaches(r);for(const C of w)b=b.concat(tm(C,l));return b}addSourceType(r,l,p){return Cs.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(Cs.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,p={}){this._checkLoaded();const b=this.light.getLight();let w=!1;for(const O in r)if(!o.bi(r[O],b[O])){w=!0;break}if(!w)return;const C=this._getTransitionParameters();this.light.setLight(r,l,p),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=r;const b=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const O="terrain-dem-src";this.addSource(O,p.source),p=o.cm(p),p=o.l(p,{source:O})}const w=o.l({},p),C={};if(this.terrain&&b){w.source=this.terrain.get().source;const O=this.terrain?this.getFragmentStyle(this.terrain.scope):null;O&&(C.style=O.serialize())}if(this._validate(_i,"terrain",w,C))return}if(!this.terrain||this.terrain.scope!==this.scope&&!b||this.terrain&&l!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,l),this.fire(new o.x("data",{dataType:"style"}))}else{const w=this.terrain,C=w.get();for(const O of Object.keys(o._.terrain))!p.hasOwnProperty(O)&&o._.terrain[O].default&&(p[O]=o._.terrain[O].default);for(const O in r)if(!o.bi(r[O],C[O])){w.set(r,this.options),this.stylesheet.terrain=r;const V=this._getTransitionParameters({duration:0});w.updateTransitions(V),this.fire(new o.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new po(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!o.bi(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}}else this._createFog(r);this._markersNeedUpdate=!0}setColorTheme(r){this._checkLoaded();const l=()=>{for(const b in this._layers)this._layers[b].lut=this._styleColorTheme.lut;for(const b in this._sourceCaches)this._sourceCaches[b].clearTiles()};if(this._styleColorTheme.colorTheme=r,!r)return this._styleColorTheme.lut=null,void l();const p=this._evaluateColorThemeData(r);this._loadColorTheme(p).then(()=>{this.fire(new o.x("colorthemeset")),l()}).catch(b=>{o.w(`Couldn't set color theme: ${b}`)})}_getTransitionParameters(r){return{now:o.q.now(),transition:o.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?r.push(p):l.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const p=this.terrain=new Ft(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const b=this._getTransitionParameters({duration:0});p.updateTransitions(b)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,p,b,w={}){if(w&&w.validate===!1)return!1;const C=o.l({},this.serialize());return Ts(this,r.call(Xr,o.l({key:l,style:C,value:p,styleSpec:o._},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const p of l)p.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const p of l)p.resume(),p.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}updateSources(r){let l;this.directionalLight&&(l=Yh(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,p,b,w,C,O=!1){let V=!1,G=!1;const j={},Y={};for(const Q of this._mergedOrder){const ie=this._mergedLayers[Q];if(ie.type!=="symbol")continue;const ve=o.av(ie.source,ie.scope);let me=j[ve];if(!me){const be=this.getLayerSourceCache(ie);if(!be)continue;const Pe=be.getRenderableIds(!0).map($e=>be.getTileByID($e));Y[ve]=Pe.slice(),me=j[ve]=Pe.sort(($e,Ve)=>Ve.tileID.overscaledZ-$e.tileID.overscaledZ||($e.tileID.isLessThan(Ve.tileID)?-1:1))}const we=this.crossTileSymbolIndex.addLayer(ie,me,l.center.lng,l.projection);V=V||we}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),O=O||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new o.x("neworder")),(O||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.q.now(),l.zoom))&&(this.pauseablePlacement=new md(l,this._mergedOrder,O,p,b,w,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,j,Y,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.q.now()),G=!0),V&&this.pauseablePlacement.placement.setStale()),G||V){this._buildingIndex.onNewFrame(l.zoom);for(let Q=0;Q<this._mergedOrder.length;Q++){const ie=this._mergedLayers[this._mergedOrder[Q]];if(ie.type!=="symbol")continue;const ve=this.isLayerClipped(ie);this.placement.updateLayerOpacities(ie,j[o.av(ie.source,ie.scope)],Q,ve?C:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:w})=>w===r.id)!==-1)return void this.fire(new o.t(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return p.push(r),this._loadImports([r],!0);const b=p.findIndex(({id:w})=>w===l);return b===-1&&this.fire(new o.t(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,b).concat(r).concat(p.slice(b)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],b=this.getImportIndex(r);return b===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==p[b].url&&this.setImportUrl(r,l.url),o.bi(l.config,p[b].config)||this.setImportConfig(r,l.config),o.bi(l.data,p[b].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let p=this.stylesheet.imports||[];const b=this.getImportIndex(r);if(b===-1)return this;const w=this.getImportIndex(l);if(w===-1)return this;const C=p[b],O=this.fragments[b];return p=p.filter(({id:V})=>V!==r),this.fragments=this.fragments.filter(({id:V})=>V!==r),this.stylesheet.imports=p.slice(0,w).concat(C).concat(p.slice(w)),this.fragments=this.fragments.slice(0,w).concat(O).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],b=this.getImportIndex(r);if(b===-1)return this;p[b].url=l;const w=this.fragments[b];return w.style=this._createFragmentStyle(p[b]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const p=this.getImportIndex(r),b=this.stylesheet.imports||[];return p===-1?this:l?(this.fragments[p].style.setState(l),this._reloadImports(),this):(delete b[p].data,this.setImportUrl(r,b[p].url))}setImportConfig(r,l){this._checkLoaded();const p=this.getImportIndex(r),b=this.stylesheet.imports||[];if(p===-1)return this;l?b[p].config=l:delete b[p].config;const w=this.fragments[p],C=w.style.stylesheet&&w.style.stylesheet.schema;return w.config=l,w.style.updateConfig(l,C),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],p=this.getImportIndex(r);p!==-1&&(l.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(p=>p.id===r);return l===-1&&this.fire(new o.t(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[l];p&&r.push(p.getSource())}return r}getSource(r,l){const p=this.getSourceCache(r,l);return p&&p.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const p=o.av(r,l);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(r){const l=o.av(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const p=r[l];p==="reload"?this.reloadSource(l):p==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const p of l){const b=this.getLayer(p);b&&b.updateTransitions(r)}}getImages(r,l,p){this.imageManager.getImages(l.icons,l.scope,p),this._updateTilesForChangedImages();const b=w=>{w&&w.setDependencies(l.tileID.key,l.type,l.icons)};b(this._otherSourceCaches[l.source]),b(this._symbolSourceCaches[l.source])}getGlyphs(r,l,p){this.glyphManager.getGlyphs(l.stacks,l.scope,p)}getResource(r,l,p){return o.ct(l,p)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new o.t(new Error(`There is no source with ID '${r}'`))),!1):l.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const p=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(p||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Cs.getSourceType=function(f){return Bh[f]},Cs.setSourceType=function(f,r){Bh[f]=r},Cs.registerForPluginStateChange=o.cd;var T_=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,pm=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,mm=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,ef="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",C_=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,E_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,M_=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,I_=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,gm=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,A_=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,vd=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const tf=[];Pl(T_,tf),Pl(mm,tf),Pl(pm,tf);const _d={"_prelude_fog.vertex.glsl":E_,"_prelude_terrain.vertex.glsl":C_,"_prelude_shadow.vertex.glsl":A_,"_prelude_fog.fragment.glsl":M_,"_prelude_shadow.fragment.glsl":vd,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":I_,"_prelude_raster_particle.glsl":gm},eu={};Yo("",C_),Yo(M_,E_),Yo(vd,A_),Yo(I_,""),Yo(gm,"");const yd=Yo(pm,mm),nf=T_;var kl={background:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Yo("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Yo(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Yo(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Yo("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Yo("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Yo("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Yo(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Yo(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Yo(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Yo(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Yo("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Yo("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Yo(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Yo(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Yo("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Yo(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ef),skyboxGradient:Yo(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ef),skyboxCapture:Yo(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Yo(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Yo(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Yo(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Yo(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Yo("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Yo("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),occlusion:Yo("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Pl(f,r){const l=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of l)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=p.split(" ");for(const w of b)r.includes(w)||r.push(w)}}function Yo(f,r){const l=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let b=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);b&&(b=b.map(G=>{const j=G.split(" ");return j[j.length-1]}),b=[...new Set(b)]);const w={},C=[],O=[];if(f=f.replace(l,(G,j)=>(O.push(j),"")),(r=r.replace(l,(G,j)=>(C.push(j),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let V=[...tf];Pl(f,V),Pl(r,V);for(const G of[...C,...O])_d[G]||console.error(`Undefined include: ${G}`),eu[G]||(eu[G]=[],Pl(_d[G],eu[G])),V=[...V,...eu[G]];return{fragmentSource:f=f.replace(p,(G,j,Y,Q,ie)=>(w[ie]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
in ${Y} ${Q} ${ie};
#else
uniform ${Y} ${Q} u_${ie};
#endif
`:j==="initialize"?`
#ifdef HAS_UNIFORM_u_${ie}
    ${Y} ${Q} ${ie} = u_${ie};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    in ${Y} ${Q} ${ie};
#endif
`:j==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(p,(G,j,Y,Q,ie)=>{const ve=Q==="float"?"vec2":Q,me=ie.match(/color/)?"color":ve;return j==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
in ${Y} ${Q} a_${ie};
#endif
`:w[ie]?j==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
in ${Y} ${ve} a_${ie};
out ${Y} ${Q} ${ie};
#else
uniform ${Y} ${Q} u_${ie};
#endif
`:j==="initialize"?me==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = a_${ie};
#else
    ${Y} ${Q} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = unpack_mix_${me}(a_${ie}, u_${ie}_t);
#else
    ${Y} ${Q} ${ie} = u_${ie};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    in ${Y} ${Q} a_${ie};
    out ${Y} ${Q} ${ie};
#endif
`:j==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    ${ie} = a_${ie};
#endif
`:void 0:j==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
in ${Y} ${ve} a_${ie};
#else
uniform ${Y} ${Q} u_${ie};
#endif
`:j==="define-instanced"?me==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ie}0;
in vec4 a_${ie}1;
in vec4 a_${ie}2;
in vec4 a_${ie}3;
#else
uniform ${Y} ${Q} u_${ie};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Y} ${ve} a_${ie};
#else
uniform ${Y} ${Q} u_${ie};
#endif
`:j==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ie}
    ${Y} ${Q} ${ie} = a_${ie};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${Y} ${Q} ${ie} = a_${ie};
#else
    ${Y} ${Q} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${Y} ${Q} ${ie} = unpack_mix_${me}(a_${ie}, u_${ie}_t);
#else
    ${Y} ${Q} ${ie} = u_${ie};
#endif
`}),staticAttributes:b,usedDefines:V,vertexIncludes:C,fragmentIncludes:O}}class tu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,p,b,w,C,O,V){this.context=r;let G=this.boundPaintVertexBuffers.length!==b.length;for(let Y=0;!G&&Y<b.length;Y++)this.boundPaintVertexBuffers[Y]!==b[Y]&&(G=!0);let j=this.boundDynamicVertexBuffers.length!==O.length;for(let Y=0;!j&&Y<O.length;Y++)this.boundDynamicVertexBuffers[Y]!==O[Y]&&(j=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||G||j||this.boundIndexBuffer!==w||this.boundVertexOffset!==C)this.freshBind(l,p,b,w,C,O,V);else{r.bindVertexArrayOES.set(this.vao);for(const Y of O)Y&&(Y.bind(),V&&Y.instanceCount&&Y.setVertexAttribDivisor(r.gl,l,V));w&&w.dynamicDraw&&w.bind()}}freshBind(r,l,p,b,w,C,O){const V=r.numAttributes,G=this.context,j=G.gl;this.vao&&this.destroy(),this.vao=G.gl.createVertexArray(),G.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=b,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=C,l.enableAttributes(j,r),l.bind(),l.setVertexAttribPointers(j,r,w);for(const Y of p)Y.enableAttributes(j,r),Y.bind(),Y.setVertexAttribPointers(j,r,w);for(const Y of C)Y&&(Y.enableAttributes(j,r),Y.bind(),Y.setVertexAttribPointers(j,r,w),O&&Y.instanceCount&&Y.setVertexAttribDivisor(j,r,O));b&&b.bind(),G.currentNumAttributes=V}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function bd(f,r){const l=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new o.a5(0,p/l).toLngLat().lat,new o.a5(0,(p+1)/l).toLngLat().lat]}function of(f,r,l,p,b,w,C){const O=f.context,V=O.gl,G=l.hillshadeFBO;if(!G)return;f.prepareDrawTile();const j=f.isTileAffectedByFog(r),Y=f.getOrCreateProgram("hillshade",{overrideFog:j});O.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,G.colorAttachment.get());const Q=((we,be,Pe,$e)=>{const Ve=Pe.paint.get("hillshade-shadow-color"),We=Pe.paint.get("hillshade-highlight-color"),Xe=Pe.paint.get("hillshade-accent-color"),Ke=Pe.paint.get("hillshade-emissive-strength");let Je=o.bC(Pe.paint.get("hillshade-illumination-direction"));if(Pe.paint.get("hillshade-illumination-anchor")==="viewport")Je-=we.transform.angle;else if(we.style&&we.style.enable3dLights()&&we.style.directionalLight){const ht=we.style.directionalLight.properties.get("direction"),lt=o.c8(ht.x,ht.y,ht.z);Je=o.bC(lt[1])}const rt=!we.options.moving;return{u_matrix:$e||we.transform.calculateProjMatrix(be.tileID.toUnwrapped(),rt),u_image:0,u_latrange:bd(0,be.tileID),u_light:[Pe.paint.get("hillshade-exaggeration"),Je],u_shadow:Ve.toRenderColor(Pe.lut),u_highlight:We.toRenderColor(Pe.lut),u_emissive_strength:Ke,u_accent:Xe.toRenderColor(Pe.lut)}})(f,l,p,f.terrain?r.projMatrix:null);f.uploadCommonUniforms(O,Y,r.toUnwrapped());const{tileBoundsBuffer:ie,tileBoundsIndexBuffer:ve,tileBoundsSegments:me}=f.getTileBoundsBuffers(l);Y.draw(f,V.TRIANGLES,b,w,C,bo.disabled,Q,p.id,ie,ve,me)}function xd(f,r,l){if(!r.needsDEMTextureUpload)return;const p=f.context,b=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(l.stride);const w=l.getPixels();r.demTexture?r.demTexture.update(w,{premultiply:!1}):r.demTexture=new o.T(p,w,b.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function nu(f,r,l){const p=f.context,b=p.gl;if(!r.dem)return;const w=r.dem;if(p.activeTexture.set(b.TEXTURE1),xd(f,r,w),!r.demTexture)return;r.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);const C=w.dim;p.activeTexture.set(b.TEXTURE0);let O=r.hillshadeFBO;if(!O){const Q=new o.T(p,{width:C,height:C,data:null},b.RGBA8);Q.bind(b.LINEAR,b.CLAMP_TO_EDGE),O=r.hillshadeFBO=p.createFramebuffer(C,C,!0,"renderbuffer"),O.colorAttachment.set(Q.texture)}p.bindFramebuffer.set(O.framebuffer),p.viewport.set([0,0,C,C]);const{tileBoundsBuffer:V,tileBoundsIndexBuffer:G,tileBoundsSegments:j}=f.getMercatorTileBoundsBuffers(),Y=[];f.linearFloatFilteringSupported()&&Y.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:Y}).draw(f,b.TRIANGLES,io.disabled,Eo.disabled,Ho.unblended,bo.disabled,((Q,ie)=>{const ve=ie.stride,me=o.a6.mat4.create();return o.a6.mat4.ortho(me,0,o.ab,-o.ab,0,0,1),o.a6.mat4.translate(me,me,[0,-o.ab,0]),{u_matrix:me,u_image:1,u_dimension:[ve,ve],u_zoom:Q.overscaledZ}})(r.tileID,w),l.id,V,G,j),r.needsHillshadePrepare=!1}class Er{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vm extends Er{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class k_ extends Er{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class _m extends Er{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class rf extends Er{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class wd extends Er{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class P_ extends Er{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class R_ extends Er{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class D_ extends Er{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class ou extends Er{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class L_ extends Er{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class b1 extends Er{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class x1 extends Er{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class w1 extends Er{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class ym extends Er{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class bm extends Er{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class xm extends Er{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class wm extends Er{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class O_ extends Er{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class z_ extends Er{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let S1=class extends Er{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class Sd extends Er{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Td extends Er{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class B_ extends Er{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Es extends Er{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Sm extends Er{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class sf extends Er{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class af extends Er{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Tm extends Er{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class Cm extends Er{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class lf extends Er{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Em extends Er{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Cd extends Er{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class cf extends Cd{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Mm extends Cd{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class F_ extends Cd{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ru extends Mm{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const T1=(f,r,l)=>({u_matrix:f,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),N_=(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:l,u_zoom_transition:b,u_merc_center:w,u_image0:0,u_frustum_tl:C,u_frustum_tr:O,u_frustum_br:V,u_frustum_bl:G,u_globe_pos:j,u_globe_radius:Y,u_viewport:Q,u_grid_matrix:me?Float32Array.from(me):new Float32Array(9),u_skirt_height:ie,u_far_z_cutoff:ve});function $_(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const iu=new class{constructor(){this.operations={}}newMorphing(f,r,l,p,b){if(f in this.operations){const w=this.operations[f];w.to.tileID.key!==l.tileID.key&&(w.queued=l)}else this.operations[f]={startTime:p,phase:0,duration:b,from:r,to:l,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const l=this.operations[r];for(l.phase=(f-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},V_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function U_(f,r,l){if(r===0)return 0;const p=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-f)*Math.max(r,1)*p}function Im(f,r){const l=1<<f.z;return!r&&(f.x===0||f.x===l-1)||f.y===0||f.y===l-1}const Ed=f=>({u_matrix:f});function uf(f,r,l,p,b){if(b>0){const w=o.q.now(),C=(w-f.timeAdded)/b,O=r?(w-r.timeAdded)/b:-1,V=l.getSource(),G=p.coveringZoomLevel({tileSize:V.tileSize,roundZoom:V.roundZoom}),j=!r||Math.abs(r.tileID.overscaledZ-G)>Math.abs(f.tileID.overscaledZ-G),Y=j&&f.refreshedUponExpiration?1:o.ap(j?C:1-O,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}class su extends ss{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new o.ce(o.cf(),null),b=Fh("mock-dem",l,p,r.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class j_ extends ss{constructor(r){const l=Fh("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new o.ce(o.cf(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,p){if(r.freezeTileCoverage)return;this.transform=r;const b=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,C)=>{if(w[C.key]="",!this._tiles[C.key]){const O=new wa(C,this._source.tileSize*C.overscaleFactor(),r.tileZoom);O.state="loaded",this._tiles[C.key]=O}return w},{});for(const w in this._tiles)w in b||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Am extends o.aA{constructor(r,l,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class km extends o.cE{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,b,w]=function(V){const G=new o.a$,j=new o.aP,Y=131;G.reserve(17161),j.reserve(33800);const Q=o.ab/128,ie=o.ab+Q/2,ve=ie+Q;for(let we=-Q;we<ve;we+=Q)for(let be=-Q;be<ve;be+=Q){const Pe=be<0||be>ie||we<0||we>ie?24575:0,$e=o.ap(Math.round(be),0,o.ab),Ve=o.ap(Math.round(we),0,o.ab);G.emplaceBack($e+Pe,Ve)}const me=(we,be)=>{const Pe=be*Y+we;j.emplaceBack(Pe+1,Pe,Pe+Y),j.emplaceBack(Pe+Y,Pe+Y+1,Pe+1)};for(let we=1;we<129;we++)for(let be=1;be<129;be++)me(be,we);return[0,129].forEach(we=>{for(let be=0;be<130;be++)me(be,we),me(we,be)}),[G,j,32768]}(),C=r.context;this.gridBuffer=C.createVertexBuffer(p,o.b1.members),this.gridIndexBuffer=C.createIndexBuffer(b),this.gridSegments=o.b2.simpleSegment(0,0,p.length,b.length),this.gridNoSkirtSegments=o.b2.simpleSegment(0,0,p.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new j_(l.map),this.orthoMatrix=o.a6.mat4.create(),o.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.ab,0,o.ab,0,1);const O=C.gl;this._overlapStencilMode=new Eo({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new su(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,p){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const b=r.terrain.properties,w=r.terrain.drapeRenderMode===0,C=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.q.now();const O=r.terrain&&r.terrain.scope,V=b.get("source"),G=w?this._mockSourceCache:r.getSourceCache(V,O);if(!G)return void o.w(`Couldn't find terrain source "${V}".`);if(this.sourceCache=G,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=C?this.calculateExaggeration(l):b.get("exaggeration"),!l.projection.requiresDraping&&C&&this._exaggeration===0)return void this._disable();this.enabled=!0;const j=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Y=this.getScaledDemTileSize();this.sourceCache.update(l,Y,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),l.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,p=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=p;const b=l!=null?p-l:Number.MAX_VALUE;if(Math.abs(b)<2)return this._exaggeration;const w=r.zoom,C=this._style.terrain;if(!this._previousUpdateTimestamp)return C.getExaggeration(w);let O=w-this._previousZoom;const V=this._previousUpdateTimestamp;let G=w;this._evaluationZoom!=null&&(G=this._evaluationZoom,Math.abs(w-G)>.5&&(O=.5*(w-G+O)),O*b<0&&(G+=O)),this._evaluationZoom=G;const j=C.getExaggeration(G),Y=j===C.getExaggeration(Math.max(0,G-.1));if(Y&&Math.abs(j-this._exaggeration)<.01)return j;let Q=Math.min(.1,.00375*(this._updateTimestamp-V));return(Y||j<.1||Math.abs(O)<1e-4)&&(Q=Math.min(.2,4*Q)),o.aa(this._exaggeration,j,Q)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(o.a5.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=l.getIds().map(V=>{const G=l.getTileByID(V).tileID;return G.projMatrix=p.calculateProjMatrix(G.toUnwrapped()),G});(function(V,G){const j=G.transform.pointCoordinate(G.transform.getCameraPoint()),Y=new o.P(j.x,j.y);V.sort((Q,ie)=>{if(ie.overscaledZ-Q.overscaledZ)return ie.overscaledZ-Q.overscaledZ;const ve=new o.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),me=new o.P(ie.canonical.x+(1<<ie.canonical.z)*ie.wrap,ie.canonical.y),we=Y.mult(1<<Q.canonical.z);return we.x-=.5,we.y-=.5,we.distSqr(ve)-we.distSqr(me)})})(b,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},b.forEach(V=>{this.proxyToSource[V.key]={}}),this.terrainTileForTile={};const C=this._style._mergedSourceCaches;for(const V in C){const G=C[V];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,r[V],w),G.usedForTerrain))continue;const j=r[V];G.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[l.id]=b.map(V=>new Am(V,V.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const O={};this._visibleDemTiles=[];for(const V of this.proxyCoords){const G=this.terrainTileForTile[V.key];if(!G)continue;const j=G.tileID.key;j in O||(this._visibleDemTiles.push(G),O[j]=j)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const p in this.terrainTileForTile){const b=this.terrainTileForTile[p],w=b.dem;!w||b.demTexture&&!b.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),xd(this.painter,b,w))}}_prepareDemTileUniforms(r,l,p,b){if(!l||l.demTexture==null)return!1;const w=r.tileID.canonical,C=Math.pow(2,l.tileID.canonical.z-w.z),O=b||"";return p[`u_dem_tl${O}`]=[w.x*C%1,w.y*C%1],p[`u_dem_scale${O}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((p,b)=>{if(!b.dem)return p;const w=b.dem.tree.minimums[0];return w>0&&r++,p+w},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),b=new o.cF({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(b,{premultiply:!1}):w=this._emptyDEMTexture=new o.T(r,b,l.R32F,{premultiply:!1}),w}setupElevationDraw(r,l,p){const b=this.painter.context,w=b.gl,C={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};C.u_exaggeration=this.exaggeration();let O=null,V=null,G=1;if(p&&p.morphing&&this._useVertexMorphing){const ie=p.morphing.srcDemTile,ve=p.morphing.dstDemTile;G=p.morphing.phase,ie&&ve&&(this._prepareDemTileUniforms(r,ie,C,"_prev")&&(V=ie),this._prepareDemTileUniforms(r,ve,C)&&(O=ve))}const j=ie=>ie&&ie.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let Y=null;var Q;if(this.enabled?V&&O?(Y=O.demTexture,b.activeTexture.set(w.TEXTURE4),V.demTexture.bind(j(V),w.CLAMP_TO_EDGE),C.u_dem_lerp=G):(O=this.terrainTileForTile[r.tileID.key],Y=this._prepareDemTileUniforms(r,O,C)?O.demTexture:this.emptyDEMTexture):Y=this.emptyDEMTexture,b.activeTexture.set(w.TEXTURE2),Y&&(C.u_dem_size=(Q=Y).size[0]===1?1:Q.size[0]-2,Y.bind(j(O),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,l,C),p&&p.useMeterToDem&&O){const ie=(1<<O.tileID.canonical.z)*o.bE(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=ie}if(p&&p.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(b,C),this.painter.transform.projection.name==="globe"){const ie=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);l.setGlobeUniformValues(b,ie)}}globeUniformValues(r,l,p){const b=r.projection;return{u_tile_tl_up:b.upVector(l,0,0),u_tile_tr_up:b.upVector(l,o.ab,0),u_tile_br_up:b.upVector(l,o.ab,o.ab),u_tile_bl_up:b.upVector(l,0,o.ab),u_tile_up_scale:p?o.cG(1):b.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,w,C,O,V){if(b.transform.projection.name==="globe")(function(G,j,Y,Q,ie){const ve=G.context,me=ve.gl;let we,be;const Pe=G.transform,$e=o.cx(G,ve,Pe),Ve=(Lt,Wt)=>{if(be===Wt)return;const ln=[V_[Wt],"PROJECTION_GLOBE_VIEW"];$e&&ln.push("CUSTOM_ANTIALIASING");const yn=G.isTileAffectedByFog(Lt);we=G.getOrCreateProgram("globeRaster",{defines:ln,overrideFog:yn}),be=Wt},We=G.colorModeForRenderPass(),Xe=new io(me.LEQUAL,io.ReadWrite,G.depthRangeFor3D);iu.update(ie);const Ke=o.cy(Pe),Je=[o.am(Pe.center.lng),o.at(Pe.center.lat)],rt=G.globeSharedBuffers,ht=[Pe.width*o.q.devicePixelRatio,Pe.height*o.q.devicePixelRatio],lt=Float32Array.from(Pe.globeMatrix),st={useDenormalizedUpVectorScale:!0};{const Lt=G.transform,Wt=U_(Lt.zoom,j.exaggeration(),j.sourceCache._source.tileSize);be=-1;const ln=me.TRIANGLES;for(const yn of Q){const Tn=Y.getTile(yn),wt=Eo.disabled,on=j.prevTerrainTileForTile[yn.key],Vt=j.terrainTileForTile[yn.key];$_(on,Vt)&&iu.newMorphing(yn.key,on,Vt,ie,250),ve.activeTexture.set(me.TEXTURE0),Tn.texture&&Tn.texture.bind(me.LINEAR,me.CLAMP_TO_EDGE);const rn=iu.getMorphValuesForProxy(yn.key),hn=rn?1:0;rn&&o.C(st,{morphing:{srcDemTile:rn.from,dstDemTile:rn.to,phase:o.cw(rn.phase)}});const nn=o.cz(yn.canonical),An=o.cA(nn.getCenter().lat),Zn=o.cB(yn.canonical,nn,An,Lt.worldSize/Lt._pixelsPerMercatorPixel),to=o.b6(o.cC(yn.canonical)),Hn=N_(Lt.expandedFarZProjMatrix,lt,Ke,to,o.a9(Lt.zoom),Je,Lt.frustumCorners.TL,Lt.frustumCorners.TR,Lt.frustumCorners.BR,Lt.frustumCorners.BL,Lt.globeCenterInViewSpace,Lt.globeRadius,ht,Wt,Lt._farZ,Zn);if(Ve(yn,hn),we&&(j.setupElevationDraw(Tn,we,st),G.uploadCommonUniforms(ve,we,yn.toUnwrapped()),rt)){const[oo,Rn,ho]=rt.getGridBuffers(An,Wt!==0);we.draw(G,ln,Xe,wt,We,bo.backCCW,Hn,"globe_raster",oo,Rn,ho)}}}if(rt&&(G.renderDefaultNorthPole||G.renderDefaultSouthPole)){const Lt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];$e&&Lt.push("CUSTOM_ANTIALIASING"),we=G.getOrCreateProgram("globeRaster",{defines:Lt});for(const Wt of Q){const{x:ln,y:yn,z:Tn}=Wt.canonical,wt=yn===0,on=yn===(1<<Tn)-1,[Vt,rn,hn,nn]=rt.getPoleBuffers(Tn,!1);if(nn&&(wt||on)){const An=Y.getTile(Wt);ve.activeTexture.set(me.TEXTURE0),An.texture&&An.texture.bind(me.LINEAR,me.CLAMP_TO_EDGE);let Zn=o.cD(Tn,ln,Pe);const to=o.b6(o.cC(Wt.canonical)),Hn=(oo,Rn)=>oo.draw(G,me.TRIANGLES,Xe,Eo.disabled,We,bo.disabled,N_(Pe.expandedFarZProjMatrix,Zn,Zn,to,0,Je,Pe.frustumCorners.TL,Pe.frustumCorners.TR,Pe.frustumCorners.BR,Pe.frustumCorners.BL,Pe.globeCenterInViewSpace,Pe.globeRadius,ht,0,Pe._farZ),"globe_pole_raster",Rn,hn,nn);j.setupElevationDraw(An,we,st),G.uploadCommonUniforms(ve,we,Wt.toUnwrapped()),wt&&G.renderDefaultNorthPole&&Hn(we,Vt),on&&G.renderDefaultSouthPole&&(Zn=o.a6.mat4.scale(o.a6.mat4.create(),Zn,[1,-1,1]),Hn(we,rn))}}}})(b,w,C,O,V);else{const G=b.context,j=G.gl;let Y,Q;const ie=b.shadowRenderer,ve=Ga(b,b.longestCutoffRange),me=We=>{if(Q===We)return;const Xe=[];Xe.push(V_[We]),ve.shouldRenderCutoff&&Xe.push("RENDER_CUTOFF"),ie&&(Xe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ie.useNormalOffset&&Xe.push("NORMAL_OFFSET")),Y=b.getOrCreateProgram("terrainRaster",{defines:Xe}),Q=We},we=b.colorModeForRenderPass(),be=new io(j.LEQUAL,io.ReadWrite,b.depthRangeFor3D);iu.update(V);const Pe=b.transform,$e=U_(Pe.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let Ve=[0,0,0];if(ie){const We=b.style.directionalLight,Xe=b.style.ambientLight;We&&Xe&&(Ve=Xh(b.style,We,Xe))}{Q=-1;const We=j.TRIANGLES,[Xe,Ke]=[w.gridIndexBuffer,w.gridSegments];for(const Je of O){const rt=C.getTile(Je),ht=Eo.disabled,lt=w.prevTerrainTileForTile[Je.key],st=w.terrainTileForTile[Je.key];$_(lt,st)&&iu.newMorphing(Je.key,lt,st,V,250),G.activeTexture.set(j.TEXTURE0),rt.texture&&rt.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Lt=iu.getMorphValuesForProxy(Je.key),Wt=Lt?1:0;let ln;Lt&&(ln={morphing:{srcDemTile:Lt.from,dstDemTile:Lt.to,phase:o.cw(Lt.phase)}});const yn=T1(Je.projMatrix,Im(Je.canonical,Pe.renderWorldCopies)?$e/10:$e,Ve);if(me(Wt),!Y)continue;w.setupElevationDraw(rt,Y,ln);const Tn=Je.toUnwrapped();ie&&ie.setupShadows(Tn,Y),b.uploadCommonUniforms(G,Y,Tn,null,ve),Y.draw(b,We,be,ht,we,bo.backCCW,yn,"terrain_raster",w.gridBuffer,Xe,Ke)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,b=this.proxySourceCache,w=this.proxiedCoords[b.id],C=this._drapedRenderBatches.shift(),O=l.style.order,V=[];let G=0;for(const j of w){const Y=b.getTileByID(j.proxyTileKey),Q=b.proxyCachedFBO[j.key]?b.proxyCachedFBO[j.key][r]:void 0,ie=Q!==void 0?b.renderCache[Q]:this.pool[G++],ve=Q!==void 0;if(Y.texture=ie.tex,ve&&!ie.dirty){V.push(Y.tileID);continue}let me;p.bindFramebuffer.set(ie.fb.framebuffer),this.renderedToTile=!1,ie.dirty&&(p.clear({color:o.bA.transparent,stencil:0}),ie.dirty=!1);for(let we=C.start;we<=C.end;++we){const be=l.style._mergedLayers[O[we]];if(be.isHidden(l.transform.zoom))continue;const Pe=l.style.getLayerSourceCache(be),$e=Pe?this.proxyToSource[j.key][Pe.id]:[j];if(!$e)continue;const Ve=$e;p.viewport.set([0,0,ie.fb.width,ie.fb.height]),me!==(Pe?Pe.id:null)&&(this._setupStencil(ie,$e,be,Pe),me=Pe?Pe.id:null),l.renderLayer(l,Pe,be,Ve)}if(this._drapedRenderBatches.length===0)for(const we of this._pendingGroundEffectLayers){const be=l.style._mergedLayers[O[we]];if(be.isHidden(l.transform.zoom))continue;const Pe=l.style.getLayerSourceCache(be),$e=Pe?this.proxyToSource[j.key][Pe.id]:[j];if(!$e)continue;const Ve=$e;p.viewport.set([0,0,ie.fb.width,ie.fb.height]),me!==(Pe?Pe.id:null)&&(this._setupStencil(ie,$e,be,Pe),me=Pe?Pe.id:null),l.renderLayer(l,Pe,be,Ve)}this.renderedToTile?(ie.dirty=!0,V.push(Y.tileID)):ve||--G,G===5&&(G=0,this.renderToBackBuffer(V))}return this.renderToBackBuffer(V),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),C.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let p=-1,b=l;for(let w=0;w<l;++w)this._style.isLayerDraped(r._mergedLayers[r.order[w]])?p=Math.max(p,w):b=Math.min(b,w);return b>p}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,p){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const C=w.tileID,O=1<<C.overscaledZ,{x:V,y:G}=C.canonical,j=V/O,Y=(V+1)/O,Q=G/O,ie=(G+1)/O;return{minx:j,miny:Q,maxx:Y,maxy:ie,t:w.dem.tree.raycastRoot(j,Q,Y,ie,r,l,p),tile:w}});b.sort((w,C)=>(w.t!==null?w.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const w of b){if(w.t==null)return null;const C=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,r,l,p);if(C!=null)return C}return null}_createFBO(){const r=this.painter.context,l=r.gl,p=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const b=new o.T(r,{width:p[0],height:p[1],data:null},l.RGBA8);b.bind(l.LINEAR,l.CLAMP_TO_EDGE);const w=r.createFramebuffer(p[0],p[1],!0,null);return w.colorAttachment.set(b.texture),w.depthAttachment=new ru(r,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:w,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],p=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!p&&l.shouldRedrape():!p&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const p of this._style.getSources())if(p instanceof Kr){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const b=this._style._mergedLayers[this._style.order[p]],w=this._style.getLayerSourceCache(b);if(w&&!l[w.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof o.a4){l[w.id]=!0;for(const C of this.proxyCoords){const O=this.proxyToSource[C.key][w.id];if(O)for(const V of O)this._clearRenderCacheForTile(w.id,V)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof El){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const b=this._style._mergedLayers[this._style.order[p]],w=this._style.getLayerSourceCache(b);if(!w||l[w.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const C=b.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const V=this.proxyToSource[O.key][w.id];if(V)for(const G of V){const j=uf(w.getTile(G),w.findLoadedParent(G,0),w,this.painter.transform,C);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(w.id,G)}}}}_setupDrapedRenderBatches(){const r=this._style.order,l=r.length;if(l===0)return;const p=[];this._pendingGroundEffectLayers=[];let b,w=0,C=this._style._mergedLayers[r[w]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++w<l;)C=this._style._mergedLayers[r[w]];for(;w<l;++w){const O=this._style._mergedLayers[r[w]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?b===void 0&&(b=w):(O.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),b!==void 0&&(p.push({start:b,end:w-1}),b=void 0)))}if(b!==void 0&&p.push({start:b,end:w-1}),p.length!==0){const O=p[p.length-1];this._pendingGroundEffectLayers.every(V=>V>O.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const C=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let O=0;O<C.length;++O){const V=Object.values(C[O]);l.renderCachePool.push(...V)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,b=this._tilesDirty;for(let C=p.length-1;C>=0;C--){const O=p[C];if(l.getTileByID(O.key),l.proxyCachedFBO[O.key]!==void 0){const V=r[O.key],G=this.proxyToSource[O.key];let j=0;for(const Y in G){const Q=G[Y],ie=V[Y];if(!ie||ie.length!==Q.length||Q.some((ve,me)=>ve!==ie[me]||b[Y]&&b[Y].hasOwnProperty(ve.key))){j=-1;break}++j}for(const Y in l.proxyCachedFBO[O.key])l.renderCache[l.proxyCachedFBO[O.key][Y]].dirty=j<0||j!==Object.values(V).length}}const w=[...this._drapedRenderBatches];w.sort((C,O)=>O.end-O.start-(C.end-C.start));for(const C of w)for(const O of p){if(l.proxyCachedFBO[O.key])continue;let V=l.renderCachePool.pop();V===void 0&&l.renderCache.length<50&&(V=l.renderCache.length,l.renderCache.push(this._createFBO())),V!==void 0&&(l.proxyCachedFBO[O.key]={},l.proxyCachedFBO[O.key][C.start]=V,l.renderCache[V].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,p,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,C=w.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let O;if(p.isTileClipped())O=l.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Eo.disabled}_renderTileClippingMasks(r,l){const p=this.painter,b=this.painter.context,w=b.gl;p._tileClippingMaskIDs={},b.setColorMode(Ho.disabled),b.setDepthMode(io.disabled);const C=p.getOrCreateProgram("clippingMask");for(const O of r){const V=p._tileClippingMaskIDs[O.key]=--l;C.draw(p,w.TRIANGLES,io.disabled,new Eo({func:w.ALWAYS,mask:0},V,255,w.KEEP,w.KEEP,w.REPLACE),Ho.disabled,bo.disabled,Ed(O.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const p=[r.x,r.y,1,1];o.a6.vec4.transformMat4(p,p,l.pixelMatrixInverse),o.a6.vec4.scale(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const b=l._camera.position,w=o.bE(1,l.center.lat),C=[b[0],b[1],b[2]/w,0],O=o.a6.vec3.subtract([],p.slice(0,3),C);o.a6.vec3.normalize(O,O);const V=this.raycast(C,O,this._exaggeration);return V!==null&&V?(o.a6.vec3.scaleAndAdd(C,C,O,V),C[3]=C[2],C[2]*=w,C):null}_setupProxiedCoordsForOrtho(r,l,p){if(r.getSource()instanceof o.aD)return this._setupProxiedCoordsForImageSource(r,l,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const b=this.proxiedCoords[r.id]=[],w=this.proxyCoords;for(let V=0;V<w.length;V++){const G=w[V],j=this._findTileCoveringTileID(G,r);if(j){const Y=this._createProxiedId(G,j,p[G.key]&&p[G.key][r.id]);b.push(Y),this.proxyToSource[G.key][r.id]=[Y]}}let C=!1;const O=new Set;for(let V=0;V<l.length;V++){const G=r.getTile(l[V]);if(!G||!G.hasData())continue;const j=this._findTileCoveringTileID(G.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==G.tileID.canonical.z){const Y=this.proxyToSource[j.tileID.key][r.id],Q=this._createProxiedId(j.tileID,G,p[j.tileID.key]&&p[j.tileID.key][r.id]);Y?Y.splice(Y.length-1,0,Q):this.proxyToSource[j.tileID.key][r.id]=[Q];const ie=this.proxyToSource[j.tileID.key][r.id];O.has(ie)||O.add(ie),b.push(Q),C=!0}}if(this._sourceTilesOverlap[r.id]=C,C&&this._debugParams.sortTilesHiZFirst)for(const V of O)V.sort((G,j)=>j.overscaledZ-G.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,p){if(!r.getSource().loaded())return;const b=this.proxiedCoords[r.id]=[],w=this.proxyCoords,C=r.getSource(),O=C.tileID;if(!O)return;const V=new o.P(O.x,O.y)._div(1<<O.z),G=C.coordinates.map(o.a5.fromLngLat).reduce((Y,Q)=>(Y.min.x=Math.min(Y.min.x,Q.x-V.x),Y.min.y=Math.min(Y.min.y,Q.y-V.y),Y.max.x=Math.max(Y.max.x,Q.x-V.x),Y.max.y=Math.max(Y.max.y,Q.y-V.y),Y),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(Y,Q)=>{const ie=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),ve=Y.canonical.y/(1<<Y.canonical.z),me=o.ab/(1<<Y.canonical.z),we=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),be=Q.canonical.y/(1<<Q.canonical.z);return ie+me<we+G.min.x||ie>we+G.max.x||ve+me<be+G.min.y||ve>be+G.max.y};for(let Y=0;Y<w.length;Y++){const Q=w[Y];for(let ie=0;ie<l.length;ie++){const ve=r.getTile(l[ie]);if(!ve||!ve.hasData()||j(Q,ve.tileID))continue;const me=this._createProxiedId(Q,ve,p[Q.key]&&p[Q.key][r.id]),we=this.proxyToSource[Q.key][r.id];we?we.push(me):this.proxyToSource[Q.key][r.id]=[me],b.push(me)}}}_createProxiedId(r,l,p){let b=this.orthoMatrix;if(p){const w=p.find(C=>C.key===l.tileID.key);if(w)return w}if(l.tileID.key!==r.key){const w=r.canonical.z-l.tileID.canonical.z;let C,O,V;b=o.a6.mat4.create();const G=l.tileID.wrap-r.wrap<<r.overscaledZ;w>0?(C=o.ab>>w,O=C*((l.tileID.canonical.x<<w)-r.canonical.x+G),V=C*((l.tileID.canonical.y<<w)-r.canonical.y)):(C=o.ab<<-w,O=o.ab*(l.tileID.canonical.x-(r.canonical.x+G<<-w)),V=o.ab*(l.tileID.canonical.y-(r.canonical.y<<-w))),o.a6.mat4.ortho(b,0,C,0,C,0,1),o.a6.mat4.translate(b,b,[O,V,0])}return new Am(l.tileID,r.key,b)}_findTileCoveringTileID(r,l){let p=l.getTile(r);if(p&&p.hasData())return p;const b=this._findCoveringTileCache[l.id],w=b[r.key];if(p=w?l.getTileByID(w):null,p&&p.hasData()||w===null)return p;let C=p?p.tileID:r,O=C.overscaledZ;const V=l.getSource().minzoom,G=[];if(!w){const Y=l.getSource().maxzoom;if(r.canonical.z>=Y){const Q=r.canonical.z-Y;l.getSource().reparseOverscaled?(O=Math.max(r.canonical.z+2,l.transform.tileZoom),C=new o.aA(O,r.wrap,Y,r.canonical.x>>Q,r.canonical.y>>Q)):Q!==0&&(O=Y,C=new o.aA(O,r.wrap,Y,r.canonical.x>>Q,r.canonical.y>>Q))}C.key!==r.key&&(G.push(C.key),p=l.getTile(C))}const j=Y=>{G.forEach(Q=>{b[Q]=Y}),G.length=0};for(O-=1;O>=V&&(!p||!p.hasData());O--){p&&j(p.tileID.key);const Y=C.calculateScaledKey(O);if(p=l.getTileByID(Y),p&&p.hasData())break;const Q=b[Y];if(Q===null)break;Q===void 0?G.push(Y):p=l.getTileByID(Q)}return j(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[l.key]=!0}}function Pm(f,r,l){const p=function(O,V,G){const j=o.a6.vec3.dot(V,O),Y=o.a6.vec3.dot(G,[.2126,.7152,.0722]),Q=(ve,me,we)=>(1-we)*ve+we*me,ie=Q(1-.3*Math.min(Y,1),1,Math.min(j+1,1));return Q(.92,1,Math.asin(o.ap(V[2],-1,1))/Math.PI+.5)*ie}(f,[0,0,1],r),b=[0,0,0];o.a6.vec3.scale(b,l.slice(0,3),p);const w=[0,0,0];o.a6.vec3.scale(w,r.slice(0,3),f[2]);const C=[0,0,0];return o.a6.vec3.add(C,b,w),o.cc(C)}const cc=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],H_=["stars","rain_particle","snow_particle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class qa{static cacheKey(r,l,p,b){let w=`${l}${b?b.cacheKey:""}`;for(const C of p)r.usedDefines.includes(C)&&(w+=`/${C}`);return w}constructor(r,l,p,b,w,C){const O=r.gl;this.program=O.createProgram(),this.configuration=b,this.name=l,this.fixedDefines=[...C];const V=b?b.getBinderAttributes():[],G=(p.staticAttributes||[]).concat(V);let j=b?b.defines():[];j=j.concat(C.map(we=>`#define ${we}`));const Y=`#version 300 es
`;let Q=Y+j.concat("precision mediump float;",nf,yd.fragmentSource).join(`
`);for(const we of p.fragmentIncludes)Q+=`
${_d[we]}`;Q+=`
${p.fragmentSource}`;let ie=Y+j.concat("precision highp float;",nf,yd.vertexSource).join(`
`);for(const we of p.vertexIncludes)ie+=`
${_d[we]}`;ie+=`
${p.vertexSource}`;const ve=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(ve,Q),O.compileShader(ve),O.attachShader(this.program,ve);const me=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(me,ie),O.compileShader(me),O.attachShader(this.program,me),this.attributes={},this.numAttributes=G.length;for(let we=0;we<this.numAttributes;we++)if(G[we]){const be=G[we].startsWith("a_")?G[we]:`a_${G[we]}`;O.bindAttribLocation(this.program,we,be),this.attributes[be]=we}O.linkProgram(this.program),O.deleteShader(me),O.deleteShader(ve),this.fixedUniforms=w(r),this.binderUniforms=b?b.getUniforms(r):[],(C.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(we=>({u_dem:new o.bK(we),u_dem_prev:new o.bK(we),u_dem_tl:new o.bH(we),u_dem_scale:new o.bJ(we),u_dem_tl_prev:new o.bH(we),u_dem_scale_prev:new o.bJ(we),u_dem_size:new o.bJ(we),u_dem_lerp:new o.bJ(we),u_exaggeration:new o.bJ(we),u_depth:new o.bK(we),u_depth_size_inv:new o.bH(we),u_depth_range_unpack:new o.bH(we),u_occluder_half_size:new o.bJ(we),u_occlusion_depth_offset:new o.bJ(we),u_meter_to_dem:new o.bJ(we),u_label_plane_matrix_inv:new o.bG(we)}))(r)),C.includes("GLOBE")&&(this.globeUniforms=(we=>({u_tile_tl_up:new o.bI(we),u_tile_tr_up:new o.bI(we),u_tile_br_up:new o.bI(we),u_tile_bl_up:new o.bI(we),u_tile_up_scale:new o.bJ(we)}))(r)),C.includes("FOG")&&(this.fogUniforms=(we=>({u_fog_matrix:new o.bG(we),u_fog_range:new o.bH(we),u_fog_color:new o.c7(we),u_fog_horizon_blend:new o.bJ(we),u_fog_vertical_limit:new o.bH(we),u_fog_temporal_offset:new o.bJ(we),u_frustum_tl:new o.bI(we),u_frustum_tr:new o.bI(we),u_frustum_br:new o.bI(we),u_frustum_bl:new o.bI(we),u_globe_pos:new o.bI(we),u_globe_radius:new o.bJ(we),u_globe_transition:new o.bJ(we),u_is_globe:new o.bK(we),u_viewport:new o.bH(we)}))(r)),C.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(we=>({u_cutoff_params:new o.c7(we)}))(r)),C.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(we=>({u_lighting_ambient_color:new o.bI(we),u_lighting_directional_dir:new o.bI(we),u_lighting_directional_color:new o.bI(we),u_ground_radiance:new o.bI(we)}))(r)),C.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(we=>({u_light_matrix_0:new o.bG(we),u_light_matrix_1:new o.bG(we),u_fade_range:new o.bH(we),u_shadow_normal_offset:new o.bI(we),u_shadow_intensity:new o.bJ(we),u_shadow_texel_size:new o.bJ(we),u_shadow_map_resolution:new o.bJ(we),u_shadow_direction:new o.bI(we),u_shadow_bias:new o.bI(we),u_shadowmap_0:new o.bK(we),u_shadowmap_1:new o.bK(we)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b]&&p[b].set(this.program,b,l[b])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b]&&p[b].set(this.program,b,l[b])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;r.program.set(this.program);for(const b in l)p[b].set(this.program,b,l[b])}_drawDebugWireframe(r,l,p,b,w,C,O,V,G,j){const Y=r.options.wireframe;if(Y.terrain===!1&&Y.layers2D===!1&&Y.layers3D===!1)return;const Q=r.context;if(!(!(!Y.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Y.layers2D||r._terrain&&r._terrain.renderingToTexture||!cc.includes(this.name))||!(!Y.layers3D||!H_.includes(this.name))))return;const ie=Q.gl,ve=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,w,Q);if(!ve)return;const me=[...this.fixedDefines];me.push("DEBUG_WIREFRAME");const we=r.getOrCreateProgram(this.name,{config:this.configuration,defines:me});Q.program.set(we.program);const be=(Ve,We,Xe)=>{if(We[Ve]&&Xe[Ve])for(const Ke in We[Ve])Xe[Ve][Ke]&&Xe[Ve][Ke].set(Xe.program,Ke,We[Ve][Ke].current)};G&&G.setUniforms(we.program,Q,we.binderUniforms,O,{zoom:V}),be("fixedUniforms",this,we),be("terrainUniforms",this,we),be("globeUniforms",this,we),be("fogUniforms",this,we),be("lightsUniforms",this,we),be("shadowUniforms",this,we),ve.bind(),Q.setColorMode(new Ho([ie.ONE,ie.ONE_MINUS_SRC_ALPHA,ie.ZERO,ie.ONE],o.bA.transparent,[!0,!0,!0,!1])),Q.setDepthMode(new io(l.func===ie.LESS?ie.LEQUAL:l.func,io.ReadOnly,l.range)),Q.setStencilMode(Eo.disabled);const Pe=3*C.primitiveLength*2,$e=3*C.primitiveOffset*2*2;j&&j>1?ie.drawElementsInstanced(ie.LINES,Pe,ie.UNSIGNED_SHORT,$e,j):ie.drawElements(ie.LINES,Pe,ie.UNSIGNED_SHORT,$e),w.bind(),Q.program.set(this.program),Q.setDepthMode(l),Q.setStencilMode(p),Q.setColorMode(b)}checkUniforms(r,l,p){if(this.fixedDefines.includes(l)){for(const b of Object.keys(p))if(!p[b].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${b} not set but required by ${l} being defined`)}}draw(r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we){const be=r.context,Pe=be.gl;if(this.failedToCreate)return;be.program.set(this.program),be.setDepthMode(p),be.setStencilMode(b),be.setColorMode(w),be.setCullFace(C);for(const We of Object.keys(this.fixedUniforms))this.fixedUniforms[We].set(this.program,We,O[We]);ve&&ve.setUniforms(this.program,be,this.binderUniforms,Q,{zoom:ie});const $e={[Pe.POINTS]:1,[Pe.LINES]:2,[Pe.TRIANGLES]:3,[Pe.LINE_STRIP]:1}[l];this.checkUniforms(V,"RENDER_SHADOWS",this.shadowUniforms);const Ve=we&&we>0?1:void 0;for(const We of Y.get()){const Xe=We.vaos||(We.vaos={});(Xe[V]||(Xe[V]=new tu)).bind(be,this,G,ve?ve.getPaintVertexBuffers():[],j,We.vertexOffset,me||[],Ve),we&&we>1?Pe.drawElementsInstanced(l,We.primitiveLength*$e,Pe.UNSIGNED_SHORT,We.primitiveOffset*$e*2,we):j?Pe.drawElements(l,We.primitiveLength*$e,Pe.UNSIGNED_SHORT,We.primitiveOffset*$e*2):Pe.drawArrays(l,We.vertexOffset,We.vertexLength),l===Pe.TRIANGLES&&j&&this._drawDebugWireframe(r,p,b,w,j,We,Q,ie,ve,we)}}}function df(f,r){const l=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,f.transform.tileZoom)/l,b=p*(r.tileID.canonical.x+r.tileID.wrap*l),w=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ak(r,1,f.transform.tileZoom),u_pixel_coord_upper:[b>>16,w>>16],u_pixel_coord_lower:[65535&b,65535&w]}}const uc={terrain:0,flat:1},G_=o.a6.mat4.create(),Rm=(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we,be)=>{const Pe=r.style.light,$e=Pe.properties.get("position"),Ve=[$e.x,$e.y,$e.z],We=o.a6.mat3.create();Pe.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(We,-r.transform.angle),o.a6.vec3.transformMat3(Ve,Ve,We));const Xe=Pe.properties.get("color"),Ke=r.transform,Je={u_matrix:f,u_lightpos:Ve,u_lightintensity:Pe.properties.get("intensity"),u_lightcolor:[Xe.r,Xe.g,Xe.b],u_vertical_gradient:+l,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:G_,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:uc[G],u_base_type:uc[j],u_ao:b,u_edge_radius:w,u_width_scale:C,u_flood_light_color:ve,u_vertical_scale:me,u_flood_light_intensity:we,u_ground_shadow_factor:be};return Ke.projection.name==="globe"&&(Je.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],Je.u_zoom_transition=Y,Je.u_inv_rot_matrix=ie,Je.u_merc_center=Q,Je.u_up_dir=Ke.projection.upVector(new o.bQ(0,0,0),Q[0]*o.ab,Q[1]*o.ab),Je.u_height_lift=V),Je},Dm=(f,r,l,p,b,w)=>({u_matrix:f,u_edge_radius:r,u_width_scale:l,u_vertical_scale:p,u_height_type:uc[b],u_base_type:uc[w]}),Lm=(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we)=>{const be=Rm(f,r,l,p,b,w,C,O,G,j,Y,Q,ie,ve,me,we,1,[0,0,0]),Pe={u_height_factor:-Math.pow(2,O.overscaledZ)/V.tileSize/8};return o.l(be,df(r,V),Pe)},W_=(f,r)=>({u_matrix:f,u_emissive_strength:r}),Om=(f,r,l,p)=>o.l(W_(f,r),df(l,p)),Md=(f,r,l)=>({u_matrix:f,u_world:l,u_emissive_strength:r}),C1=(f,r,l,p,b)=>o.l(Om(f,r,l,p),{u_world:b}),E1=(f,r,l,p)=>{const b=o.ab/l.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/b,r.pixelsToGLUnits[1]/b]}},zm=(f,r,l=1)=>({u_matrix:f,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),M1=o.a6.mat4.create(),Bm=(f,r,l,p,b,w,C)=>{const O=f.transform,V=O.projection.name==="globe",G=V?o.cI(O.zoom,r.canonical)*O._pixelsPerMercatorPixel:o.ak(l,1,w),j={u_matrix:r.projMatrix,u_extrude_scale:G,u_intensity:C,u_inv_rot_matrix:M1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(V){j.u_inv_rot_matrix=p,j.u_merc_center=b,j.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],j.u_zoom_transition=o.a9(O.zoom);const Y=b[0]*o.ab,Q=b[1]*o.ab;j.u_up_dir=O.projection.upVector(new o.bQ(0,0,0),Y,Q)}return j};function hf(f,[r,l,p,b],[w,C]){if(w===C)return[0,0,0,0];const O=255*(f-1)/(f*(C-w));return[r*O,l*O,p*O,b*O]}function au(f,r,[l,p]){return l===p?0:.5/f+(r-l)*(f-1)/(f*(p-l))}const ff=(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we,be,Pe,$e,Ve)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:b,u_tl_parent:w,u_scale_parent:G,u_fade_t:j.mix,u_opacity:j.opacity*Y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Y.paint.get("raster-brightness-min"),u_brightness_high:Y.paint.get("raster-brightness-max"),u_saturation_factor:o.cJ(Y.paint.get("raster-saturation")),u_contrast_factor:o.cK(Y.paint.get("raster-contrast")),u_spin_weights:Id(Y.paint.get("raster-hue-rotate")),u_perspective_transform:Q,u_raster_elevation:ie,u_zoom_transition:C,u_merc_center:O,u_cutoff_params:V,u_colorization_mix:hf(o.cL,me,be),u_colorization_offset:au(o.cL,we,be),u_color_ramp:ve,u_texture_offset:[$e/(Pe+2*$e),Pe/(Pe+2*$e)],u_texture_res:[Pe+2*$e,Pe+2*$e],u_emissive_strength:Ve});function Id(f){f*=Math.PI/180;const r=Math.sin(f),l=Math.cos(f);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const dc=.05,pf=(f,r,l,p,b,w,C,O,V,G,j,Y)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:b,u_tl_parent:w,u_scale_parent:G,u_fade_t:j.mix,u_opacity:j.opacity,u_image0:0,u_image1:1,u_raster_elevation:Y,u_zoom_transition:C,u_merc_center:O,u_cutoff_params:V}),mf=(f,r,l,p,b,w,C,O,V,G)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:p,u_color_ramp:w,u_velocity_res:b,u_max_speed:C,u_uv_offset:O,u_data_scale:[255*V[0],255*V[1]],u_data_offset:G,u_particle_pos_scale:1.1,u_particle_pos_offset:[dc,dc]}),Fm=(f,r,l,p,b,w,C,O,V,G)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:p,u_max_speed:b,u_speed_factor:w,u_reset_rate:C,u_rand_seed:Math.random(),u_uv_offset:O,u_data_scale:[255*V[0],255*V[1]],u_data_offset:G,u_particle_pos_scale:1.1,u_particle_pos_offset:[dc,dc]}),Nm=o.a6.mat4.create(),q_=(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we,be,Pe,$e,Ve,We)=>{const Xe=b.transform,Ke={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:Xe.getCameraToCenterDistance(Pe),u_rotate_symbol:+l,u_aspect_ratio:Xe.width/Xe.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:C,u_coord_matrix:O,u_is_text:+G,u_elevation_from_sea:V?1:0,u_pitch_with_map:+p,u_texsize:j,u_texsize_icon:Y,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Nm,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Nm,u_up_vector:[0,-1,0],u_color_adj_mat:$e,u_icon_transition:Ve||0,u_gamma_scale:p?b.transform.getCameraToCenterDistance(Pe)*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:o.q.devicePixelRatio,u_is_halo:+Q,u_scale_factor:We||1};return Pe.name==="globe"&&(Ke.u_tile_id=[ie.canonical.x,ie.canonical.y,1<<ie.canonical.z],Ke.u_zoom_transition=ve,Ke.u_inv_rot_matrix=we,Ke.u_merc_center=me,Ke.u_camera_forward=Xe._camera.forward(),Ke.u_ecef_origin=o.cM(Xe.globeMatrix,ie.toUnwrapped()),Ke.u_tile_matrix=Float32Array.from(Xe.globeMatrix),Ke.u_up_vector=be),Ke},hc=(f,r,l,p)=>({u_matrix:f,u_emissive_strength:r,u_opacity:l,u_color:p}),Ad=(f,r,l,p,b,w,C,O,V)=>o.l(function(G,j,Y,Q,ie,ve){const{width:me,height:we}=Q.imageManager.getPixelSize(j),be=Math.pow(2,ve.tileID.overscaledZ),Pe=ve.tileSize*Math.pow(2,Q.transform.tileZoom)/be,$e=Pe*(ve.tileID.canonical.x+ve.tileID.wrap*be),Ve=Pe*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl:Y.tl,u_pattern_br:Y.br,u_texsize:[me,we],u_pattern_size:Y.displaySize,u_pattern_units_to_pixels:ie?[Q.transform.width,-1*Q.transform.height]:[1/o.ak(ve,1,Q.transform.tileZoom),1/o.ak(ve,1,Q.transform.tileZoom)],u_pixel_coord_upper:[$e>>16,Ve>>16],u_pixel_coord_lower:[65535&$e,65535&Ve]}}(0,w,C,p,O,V),{u_matrix:f,u_emissive_strength:r,u_opacity:l}),jn=new Float32Array(o.a6.mat4.identity([])),gf=(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie=[0,0,0],ve)=>{const me=b.style.light,we=me.properties.get("position"),be=[-we.x,-we.y,we.z],Pe=o.a6.mat3.create();me.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(Pe,-b.transform.angle),o.a6.vec3.transformMat3(be,be,Pe));const $e=j.alphaMode==="MASK",Ve=me.properties.get("color").toRenderColor(null),We=Q.paint.get("model-ambient-occlusion-intensity"),Xe=Q.paint.get("model-color").constantOr(o.bA.white).toRenderColor(null),Ke=Q.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:p||jn,u_lightpos:be,u_lightintensity:me.properties.get("intensity"),u_lightcolor:[Ve.r,Ve.g,Ve.b],u_camera_pos:ie,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+$e,u_alphaCutoff:j.alphaCutoff,u_baseColorFactor:[C.r,C.g,C.b,C.a],u_emissiveFactor:[O[0],O[1],O[2],1],u_metallicFactor:V,u_roughnessFactor:G,u_baseColorTexture:Di.BaseColor,u_metallicRoughnessTexture:Di.MetallicRoughness,u_normalTexture:Di.Normal,u_occlusionTexture:Di.Occlusion,u_emissionTexture:Di.Emission,u_lutTexture:Di.LUT,u_color_mix:[Xe.r,Xe.g,Xe.b,Ke],u_aoIntensity:We,u_emissive_strength:Y,u_occlusionTextureTransform:ve||[0,0,0,0]}},$m=(f,r=jn,l=jn)=>({u_matrix:f,u_instance:r,u_node_matrix:l}),fc={fillExtrusion:f=>({u_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_vertical_gradient:new o.bJ(f),u_opacity:new o.bJ(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_ao:new o.bH(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_up_dir:new o.bI(f),u_height_lift:new o.bJ(f),u_flood_light_color:new o.bI(f),u_vertical_scale:new o.bJ(f),u_flood_light_intensity:new o.bJ(f),u_ground_shadow_factor:new o.bI(f)}),fillExtrusionDepth:f=>({u_matrix:new o.bG(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_vertical_scale:new o.bJ(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f)}),fillExtrusionPattern:f=>({u_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_vertical_gradient:new o.bJ(f),u_height_factor:new o.bJ(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_ao:new o.bH(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_up_dir:new o.bI(f),u_height_lift:new o.bJ(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f),u_opacity:new o.bJ(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new o.bG(f),u_opacity:new o.bJ(f),u_ao_pass:new o.bJ(f),u_meter_to_tile:new o.bJ(f),u_ao:new o.bH(f),u_flood_light_intensity:new o.bJ(f),u_flood_light_color:new o.bI(f),u_attenuation:new o.bJ(f),u_edge_radius:new o.bJ(f),u_fb:new o.bK(f),u_fb_size:new o.bJ(f),u_dynamic_offset:new o.bJ(f)}),fill:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f)}),fillPattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f)}),fillOutline:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_world:new o.bH(f)}),fillOutlinePattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_world:new o.bH(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f)}),circle:o.cN,collisionBox:f=>({u_matrix:new o.bG(f),u_camera_to_center_distance:new o.bJ(f),u_extrude_scale:new o.bH(f)}),collisionCircle:f=>({u_matrix:new o.bG(f),u_inv_matrix:new o.bG(f),u_camera_to_center_distance:new o.bJ(f),u_viewport_size:new o.bH(f)}),debug:f=>({u_color:new o.cu(f),u_matrix:new o.bG(f),u_overlay:new o.bK(f),u_overlay_scale:new o.bJ(f)}),clippingMask:f=>({u_matrix:new o.bG(f)}),heatmap:f=>({u_extrude_scale:new o.bJ(f),u_intensity:new o.bJ(f),u_matrix:new o.bG(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_up_dir:new o.bI(f)}),heatmapTexture:f=>({u_image:new o.bK(f),u_color_ramp:new o.bK(f),u_opacity:new o.bJ(f)}),hillshade:f=>({u_matrix:new o.bG(f),u_image:new o.bK(f),u_latrange:new o.bH(f),u_light:new o.bH(f),u_shadow:new o.cu(f),u_highlight:new o.cu(f),u_emissive_strength:new o.bJ(f),u_accent:new o.cu(f)}),hillshadePrepare:f=>({u_matrix:new o.bG(f),u_image:new o.bK(f),u_dimension:new o.bH(f),u_zoom:new o.bJ(f)}),line:o.cO,linePattern:o.cP,raster:f=>({u_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bH(f),u_scale_parent:new o.bJ(f),u_fade_t:new o.bJ(f),u_opacity:new o.bJ(f),u_image0:new o.bK(f),u_image1:new o.bK(f),u_brightness_low:new o.bJ(f),u_brightness_high:new o.bJ(f),u_saturation_factor:new o.bJ(f),u_contrast_factor:new o.bJ(f),u_spin_weights:new o.bI(f),u_perspective_transform:new o.bH(f),u_raster_elevation:new o.bJ(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_cutoff_params:new o.c7(f),u_colorization_mix:new o.c7(f),u_colorization_offset:new o.bJ(f),u_color_ramp:new o.bK(f),u_texture_offset:new o.bH(f),u_texture_res:new o.bH(f),u_emissive_strength:new o.bJ(f)}),rasterParticle:f=>({u_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bH(f),u_scale_parent:new o.bJ(f),u_fade_t:new o.bJ(f),u_opacity:new o.bJ(f),u_image0:new o.bK(f),u_image1:new o.bK(f),u_raster_elevation:new o.bJ(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_cutoff_params:new o.c7(f)}),rasterParticleTexture:f=>({u_texture:new o.bK(f),u_opacity:new o.bJ(f)}),rasterParticleDraw:f=>({u_particle_texture:new o.bK(f),u_particle_texture_side_len:new o.bJ(f),u_tile_offset:new o.bH(f),u_velocity:new o.bK(f),u_color_ramp:new o.bK(f),u_velocity_res:new o.bH(f),u_max_speed:new o.bJ(f),u_uv_offset:new o.bH(f),u_data_scale:new o.bH(f),u_data_offset:new o.bJ(f),u_particle_pos_scale:new o.bJ(f),u_particle_pos_offset:new o.bH(f)}),rasterParticleUpdate:f=>({u_particle_texture:new o.bK(f),u_particle_texture_side_len:new o.bJ(f),u_velocity:new o.bK(f),u_velocity_res:new o.bH(f),u_max_speed:new o.bJ(f),u_speed_factor:new o.bJ(f),u_reset_rate:new o.bJ(f),u_rand_seed:new o.bJ(f),u_uv_offset:new o.bH(f),u_data_scale:new o.bH(f),u_data_offset:new o.bJ(f),u_particle_pos_scale:new o.bJ(f),u_particle_pos_offset:new o.bH(f)}),symbol:f=>({u_is_size_zoom_constant:new o.bK(f),u_is_size_feature_constant:new o.bK(f),u_size_t:new o.bJ(f),u_size:new o.bJ(f),u_camera_to_center_distance:new o.bJ(f),u_rotate_symbol:new o.bK(f),u_aspect_ratio:new o.bJ(f),u_fade_change:new o.bJ(f),u_matrix:new o.bG(f),u_label_plane_matrix:new o.bG(f),u_coord_matrix:new o.bG(f),u_is_text:new o.bK(f),u_elevation_from_sea:new o.bK(f),u_pitch_with_map:new o.bK(f),u_texsize:new o.bH(f),u_texsize_icon:new o.bH(f),u_texture:new o.bK(f),u_texture_icon:new o.bK(f),u_gamma_scale:new o.bJ(f),u_device_pixel_ratio:new o.bJ(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_camera_forward:new o.bI(f),u_tile_matrix:new o.bG(f),u_up_vector:new o.bI(f),u_ecef_origin:new o.bI(f),u_is_halo:new o.bK(f),u_icon_transition:new o.bJ(f),u_color_adj_mat:new o.bG(f),u_scale_factor:new o.bJ(f)}),background:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_opacity:new o.bJ(f),u_color:new o.cu(f)}),backgroundPattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_opacity:new o.bJ(f),u_image:new o.bK(f),u_pattern_tl:new o.bH(f),u_pattern_br:new o.bH(f),u_texsize:new o.bH(f),u_pattern_size:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_pattern_units_to_pixels:new o.bH(f)}),terrainRaster:f=>({u_matrix:new o.bG(f),u_image0:new o.bK(f),u_skirt_height:new o.bJ(f),u_ground_shadow_factor:new o.bI(f)}),skybox:f=>({u_matrix:new o.bG(f),u_sun_direction:new o.bI(f),u_cubemap:new o.bK(f),u_opacity:new o.bJ(f),u_temporal_offset:new o.bJ(f)}),skyboxGradient:f=>({u_matrix:new o.bG(f),u_color_ramp:new o.bK(f),u_center_direction:new o.bI(f),u_radius:new o.bJ(f),u_opacity:new o.bJ(f),u_temporal_offset:new o.bJ(f)}),skyboxCapture:f=>({u_matrix_3f:new o.cv(f),u_sun_direction:new o.bI(f),u_sun_intensity:new o.bJ(f),u_color_tint_r:new o.c7(f),u_color_tint_m:new o.c7(f),u_luminance:new o.bJ(f)}),globeRaster:f=>({u_proj_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_image0:new o.bK(f),u_grid_matrix:new o.cv(f),u_skirt_height:new o.bJ(f),u_far_z_cutoff:new o.bJ(f),u_frustum_tl:new o.bI(f),u_frustum_tr:new o.bI(f),u_frustum_br:new o.bI(f),u_frustum_bl:new o.bI(f),u_globe_pos:new o.bI(f),u_globe_radius:new o.bJ(f),u_viewport:new o.bH(f)}),globeAtmosphere:f=>({u_frustum_tl:new o.bI(f),u_frustum_tr:new o.bI(f),u_frustum_br:new o.bI(f),u_frustum_bl:new o.bI(f),u_horizon:new o.bJ(f),u_transition:new o.bJ(f),u_fadeout_range:new o.bJ(f),u_color:new o.c7(f),u_high_color:new o.c7(f),u_space_color:new o.c7(f),u_temporal_offset:new o.bJ(f),u_horizon_angle:new o.bJ(f)}),model:f=>({u_matrix:new o.bG(f),u_lighting_matrix:new o.bG(f),u_normal_matrix:new o.bG(f),u_node_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_camera_pos:new o.bI(f),u_opacity:new o.bJ(f),u_baseColorFactor:new o.c7(f),u_emissiveFactor:new o.c7(f),u_metallicFactor:new o.bJ(f),u_roughnessFactor:new o.bJ(f),u_baseTextureIsAlpha:new o.bK(f),u_alphaMask:new o.bK(f),u_alphaCutoff:new o.bJ(f),u_baseColorTexture:new o.bK(f),u_metallicRoughnessTexture:new o.bK(f),u_normalTexture:new o.bK(f),u_occlusionTexture:new o.bK(f),u_emissionTexture:new o.bK(f),u_lutTexture:new o.bK(f),u_color_mix:new o.c7(f),u_aoIntensity:new o.bJ(f),u_emissive_strength:new o.bJ(f),u_occlusionTextureTransform:new o.c7(f)}),modelDepth:f=>({u_matrix:new o.bG(f),u_instance:new o.bG(f),u_node_matrix:new o.bG(f)}),groundShadow:f=>({u_matrix:new o.bG(f),u_ground_shadow_factor:new o.bI(f)}),stars:f=>({u_matrix:new o.bG(f),u_up:new o.bI(f),u_right:new o.bI(f),u_intensity_multiplier:new o.bJ(f)}),snowParticle:f=>({u_modelview:new o.bG(f),u_projection:new o.bG(f),u_time:new o.bJ(f),u_cam_pos:new o.bI(f),u_velocityConeAperture:new o.bJ(f),u_velocity:new o.bJ(f),u_horizontalOscillationRadius:new o.bJ(f),u_horizontalOscillationRate:new o.bJ(f),u_boxSize:new o.bJ(f),u_billboardSize:new o.bJ(f),u_simpleShapeParameters:new o.bH(f),u_screenSize:new o.bH(f),u_thinningCenterPos:new o.bH(f),u_thinningShape:new o.bI(f),u_thinningAffectedRatio:new o.bJ(f),u_thinningParticleOffset:new o.bJ(f),u_particleColor:new o.c7(f),u_direction:new o.bI(f)}),rainParticle:f=>({u_modelview:new o.bG(f),u_projection:new o.bG(f),u_time:new o.bJ(f),u_cam_pos:new o.bI(f),u_texScreen:new o.bK(f),u_velocityConeAperture:new o.bJ(f),u_velocity:new o.bJ(f),u_boxSize:new o.bJ(f),u_rainDropletSize:new o.bH(f),u_distortionStrength:new o.bJ(f),u_rainDirection:new o.bI(f),u_color:new o.c7(f),u_screenSize:new o.bH(f),u_thinningCenterPos:new o.bH(f),u_thinningShape:new o.bI(f),u_thinningAffectedRatio:new o.bJ(f),u_thinningParticleOffset:new o.bJ(f),u_shapeDirectionalPower:new o.bJ(f),u_mode:new o.bJ(f)}),occlusion:f=>({u_matrix:new o.bG(f),u_anchorPos:new o.bI(f),u_screenSizePx:new o.bH(f),u_occluderSizePx:new o.bH(f),u_color:new o.c7(f)})};class cs{constructor(r,l,p,b){this.id=cs.uniqueIdxCounter,cs.uniqueIdxCounter++,this.context=r;const w=r.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||b||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=cs.uniqueIdxCounter,cs.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}cs.uniqueIdxCounter=0;const Jn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Vm{constructor(r,l,p,b,w,C){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=b,this.instanceCount=C,this.context=r;const O=r.gl;this.buffer=O.createBuffer(),r.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||w||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let p=0;p<this.attributes.length;p++){const b=l.attributes[this.attributes[p].name];b!==void 0&&r.enableVertexAttribArray(b)}}setVertexAttribPointers(r,l,p){for(let b=0;b<this.attributes.length;b++){const w=this.attributes[b],C=l.attributes[w.name];C!==void 0&&r.vertexAttribPointer(C,w.components,r[Jn[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(r,l,p){for(let b=0;b<this.attributes.length;b++){const w=l.attributes[this.attributes[b].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(w,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class K_{constructor(r,l,p,b,w){this.context=r,this.width=l,this.height=p;const C=this.framebuffer=r.gl.createFramebuffer();b&&(this.colorAttachment=new cf(r,C)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new Mm(r,C):new F_(r,C))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class I1{constructor(r,l){this.gl=r,this.clearColor=new vm(this),this.clearDepth=new k_(this),this.clearStencil=new _m(this),this.colorMask=new rf(this),this.depthMask=new wd(this),this.stencilMask=new P_(this),this.stencilFunc=new R_(this),this.stencilOp=new D_(this),this.stencilTest=new ou(this),this.depthRange=new L_(this),this.depthTest=new b1(this),this.depthFunc=new x1(this),this.blend=new w1(this),this.blendFunc=new ym(this),this.blendColor=new bm(this),this.blendEquation=new xm(this),this.cullFace=new wm(this),this.cullFaceSide=new O_(this),this.frontFace=new z_(this),this.program=new S1(this),this.activeTexture=new Sd(this),this.viewport=new Td(this),this.bindFramebuffer=new B_(this),this.bindRenderbuffer=new Es(this),this.bindTexture=new Sm(this),this.bindVertexBuffer=new sf(this),this.bindElementBuffer=new af(this),this.bindVertexArrayOES=new Tm(this),this.pixelStoreUnpack=new Cm(this),this.pixelStoreUnpackPremultiplyAlpha=new lf(this),this.pixelStoreUnpackFlipY=new Em(this),this.options=l?{...l}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,p){return new cs(this,r,l,p)}createVertexBuffer(r,l,p,b,w){return new Vm(this,r,l,p,b,w)}createRenderbuffer(r,l,p){const b=this.gl,w=b.createRenderbuffer();return this.bindRenderbuffer.set(w),b.renderbufferStorage(b.RENDERBUFFER,r,l,p),this.bindRenderbuffer.set(null),w}createFramebuffer(r,l,p,b){return new K_(this,r,l,p,b)}clear({color:r,depth:l,stencil:p,colorMask:b}){const w=this.gl;let C=0;r&&(C|=w.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(b||[!0,!0,!0,!0])),l!==void 0&&(C|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(C|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),w.clear(C)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.bi(r.blendFunction,Ho.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let lu;function Um(f,r,l,p,b,w,C){const O=f.context,V=O.gl,G=f.transform,j=f.getOrCreateProgram("collisionBox"),Y=[];let Q=0,ie=0;for(let Ve=0;Ve<p.length;Ve++){const We=p[Ve],Xe=r.getTile(We),Ke=Xe.getBucket(l);if(!Ke)continue;const Je=v_(We,Ke,G);let rt=Je;b[0]===0&&b[1]===0||(rt=f.translatePosMatrix(Je,Xe,b,w));const ht=C?Ke.textCollisionBox:Ke.iconCollisionBox,lt=Ke.collisionCircleArray;if(lt.length>0){const st=o.a6.mat4.create(),Lt=rt;o.a6.mat4.mul(st,Ke.placementInvProjMatrix,G.glCoordMatrix),o.a6.mat4.mul(st,st,Ke.placementViewportMatrix),Y.push({circleArray:lt,circleOffset:ie,transform:Lt,invTransform:st,projection:Ke.getProjection()}),Q+=lt.length/4,ie=Q}ht&&(f.terrain&&f.terrain.setupElevationDraw(Xe,j),j.draw(f,V.LINES,io.disabled,Eo.disabled,f.colorModeForRenderPass(),bo.disabled,E1(rt,G,Xe,Ke.getProjection()),l.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,null,G.zoom,null,[ht.collisionVertexBuffer,ht.collisionVertexBufferExt]))}if(!C||!Y.length)return;const ve=f.getOrCreateProgram("collisionCircle"),me=new o.cQ;me.resize(4*Q),me._trim();let we=0;for(const Ve of Y)for(let We=0;We<Ve.circleArray.length/4;We++){const Xe=4*We,Ke=Ve.circleArray[Xe+0],Je=Ve.circleArray[Xe+1],rt=Ve.circleArray[Xe+2],ht=Ve.circleArray[Xe+3];me.emplace(we++,Ke,Je,rt,ht,0),me.emplace(we++,Ke,Je,rt,ht,1),me.emplace(we++,Ke,Je,rt,ht,2),me.emplace(we++,Ke,Je,rt,ht,3)}(!lu||lu.length<2*Q)&&(lu=function(Ve){const We=2*Ve,Xe=new o.aP;Xe.resize(We),Xe._trim();for(let Ke=0;Ke<We;Ke++){const Je=6*Ke;Xe.uint16[Je+0]=4*Ke+0,Xe.uint16[Je+1]=4*Ke+1,Xe.uint16[Je+2]=4*Ke+2,Xe.uint16[Je+3]=4*Ke+2,Xe.uint16[Je+4]=4*Ke+3,Xe.uint16[Je+5]=4*Ke+0}return Xe}(Q));const be=O.createIndexBuffer(lu,!0),Pe=O.createVertexBuffer(me,o.cR.members,!0);for(const Ve of Y){const We={u_matrix:Ve.transform,u_inv_matrix:Ve.invTransform,u_camera_to_center_distance:($e=G).getCameraToCenterDistance(Ve.projection),u_viewport_size:[$e.width,$e.height]};ve.draw(f,V.TRIANGLES,io.disabled,Eo.disabled,f.colorModeForRenderPass(),bo.disabled,We,l.id,Pe,be,o.b2.simpleSegment(0,2*Ve.circleOffset,Ve.circleArray.length,Ve.circleArray.length/2),null,G.zoom)}var $e;Pe.destroy(),be.destroy()}const kd=o.a6.mat4.create();function Z_(f){const r=f._camera.getWorldToCamera(f.worldSize,1),l=o.a6.mat4.multiply([],r,f.globeMatrix);o.a6.mat4.invert(l,l);const p=[0,0,0],b=[0,1,0,0];return o.a6.vec4.transformMat4(b,b,l),p[0]=b[0],p[1]=b[1],p[2]=b[2],o.a6.vec3.normalize(p,p),p}function A1({width:f,height:r,anchor:l,textOffset:p,textScale:b},w){const{horizontalAlign:C,verticalAlign:O}=o.by(l),V=-(C-.5)*f,G=-(O-.5)*r,j=o.bx(l,p);return new o.P((V/b+j[0])*w,(G/b+j[1])*w)}function jm(f,r,l,p,b,w,C,O,V,G,j){const Y=f.text.placedSymbolArray,Q=f.text.dynamicLayoutVertexArray,ie=f.icon.dynamicLayoutVertexArray,ve={},me=f.getProjection(),we=Il(O,me,w),be=w.elevation,Pe=me.upVectorScale(O.canonical,w.center.lat,w.worldSize).metersToTile;Q.clear();for(let $e=0;$e<Y.length;$e++){const Ve=Y.get($e),{tileAnchorX:We,tileAnchorY:Xe,numGlyphs:Ke}=Ve,Je=Ve.hidden||!Ve.crossTileID||f.allowVerticalPlacement&&!Ve.placedOrientation?null:p[Ve.crossTileID];if(Je){let rt=0,ht=0,lt=0;if(be){const Vt=be?be.getAtTileOffset(O,We,Xe):0,[rn,hn,nn]=me.upVector(O.canonical,We,Xe);rt=Vt*rn*Pe,ht=Vt*hn*Pe,lt=Vt*nn*Pe}let[st,Lt,Wt,ln]=Hi(Ve.projectedAnchorX+rt,Ve.projectedAnchorY+ht,Ve.projectedAnchorZ+lt,l?we:C);const yn=tr(w.getCameraToCenterDistance(me),ln);let Tn=b.evaluateSizeForFeature(f.textSizeData,G,Ve)*yn/o.br;l&&(Tn*=f.tilePixelRatio/V);const wt=A1(Je,Tn);l?({x:st,y:Lt,z:Wt}=me.projectTilePoint(We+wt.x,Xe+wt.y,O.canonical),[st,Lt,Wt]=Hi(st+rt,Lt+ht,Wt+lt,C)):(r&&wt._rotate(-w.angle),st+=wt.x,Lt+=wt.y,Wt=0);const on=f.allowVerticalPlacement&&Ve.placedOrientation===o.bl.vertical?Math.PI/2:0;for(let Vt=0;Vt<Ke;Vt++)o.bo(Q,st,Lt,Wt,on);j&&Ve.associatedIconIndex>=0&&(ve[Ve.associatedIconIndex]={x:st,y:Lt,z:Wt,angle:on})}else Sa(Ke,Q)}if(j){ie.clear();const $e=f.icon.placedSymbolArray;for(let Ve=0;Ve<$e.length;Ve++){const We=$e.get(Ve),{numGlyphs:Xe}=We,Ke=ve[Ve];if(We.hidden||!Ke)Sa(Xe,ie);else{const{x:Je,y:rt,z:ht,angle:lt}=Ke;for(let st=0;st<Xe;st++)o.bo(ie,Je,rt,ht,lt)}}f.icon.dynamicLayoutVertexBuffer.updateData(ie)}f.text.dynamicLayoutVertexBuffer.updateData(Q)}function Pd(f,r,l,p,b,w,C={}){const O=l.paint.get("icon-translate"),V=l.paint.get("text-translate"),G=l.paint.get("icon-translate-anchor"),j=l.paint.get("text-translate-anchor"),Y=l.layout.get("icon-rotation-alignment"),Q=l.layout.get("text-rotation-alignment"),ie=l.layout.get("icon-pitch-alignment"),ve=l.layout.get("text-pitch-alignment"),me=l.layout.get("icon-keep-upright"),we=l.layout.get("text-keep-upright"),be=l.paint.get("icon-color-saturation"),Pe=l.paint.get("icon-color-contrast"),$e=l.paint.get("icon-color-brightness-min"),Ve=l.paint.get("icon-color-brightness-max"),We=l.layout.get("symbol-elevation-reference")==="sea",Xe=f.context,Ke=Xe.gl,Je=f.transform,rt=Y==="map",ht=Q==="map",lt=ie==="map",st=ve==="map",Lt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Wt=!1;const ln=f.depthModeForSublayer(0,io.ReadOnly),yn=[o.am(Je.center.lng),o.at(Je.center.lat)],Tn=l.layout.get("text-variable-anchor"),wt=Je.projection.name==="globe",on=[],Vt=[0,-1,0];for(const rn of p){const hn=r.getTile(rn),nn=hn.getBucket(l);if(!nn||nn.projection.name==="mercator"&&wt||nn.fullyClipped)continue;const An=nn.projection.name==="globe",Zn=An?o.a9(Je.zoom):0,to=Il(rn,nn.getProjection(),Je),Hn=Je.calculatePixelsToTileUnitsMatrix(hn),oo=Tn&&nn.hasTextData(),Rn=nn.hasIconTextFit()&&oo&&nn.hasIconData(),ho=nn.getProjection().createInversionMatrix(Je,rn.canonical),Io=_r=>{Je.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||f.terrain)&&(_r.push("DEPTH_D24"),_r.push("DEPTH_OCCLUSION"))},Go=()=>{const _r=rt&&l.layout.get("symbol-placement")!=="point",cr=[];Io(cr);const Nr=_r||Rn,yi=l.paint.get("icon-image-cross-fade").constantOr(0);f.terrainRenderModeElevated()&&lt&&cr.push("PITCH_WITH_MAP_TERRAIN"),An&&(cr.push("PROJECTION_GLOBE_VIEW"),Nr&&cr.push("PROJECTED_POS_ON_VIEWPORT")),yi>0&&cr.push("ICON_TRANSITION"),nn.icon.zOffsetVertexBuffer&&cr.push("Z_OFFSET"),be===0&&Pe===0&&$e===0&&Ve===1||cr.push("COLOR_ADJUSTMENT"),nn.sdfIcons&&cr.push("RENDER_SDF");const As=nn.icon.programConfigurations.get(l.id),js=f.getOrCreateProgram("symbol",{config:As,defines:cr}),Si=hn.imageAtlasTexture?hn.imageAtlasTexture.size:[0,0],Qo=nn.iconSizeData,Zo=o.bk(Qo,Je.zoom),lr=lt||Je.pitch!==0,Mr=Xo(to,hn.tileID.canonical,lt,rt,Je,nn.getProjection(),Hn),ni=as(to,hn.tileID.canonical,lt,rt,Je,nn.getProjection(),Hn),$r=f.translatePosMatrix(ni,hn,O,G,!0),Ei=f.translatePosMatrix(to,hn,O,G),Ma=Nr?kd:Mr,us=rt&&!lt&&!_r;let ds=Vt;!wt&&!Je.mercatorFromTransition||rt||(ds=Z_(Je));const Hs=An?ds:Vt,la=l.getColorAdjustmentMatrix(be,Pe,$e,Ve),hs=q_(Qo.kind,Zo,us,lt,f,Ei,Ma,$r,We,!1,Si,[0,0],!0,rn,Zn,yn,ho,Hs,nn.getProjection(),la,yi),tl=hn.imageAtlasTexture?hn.imageAtlasTexture:null,Gs=l.layout.get("icon-size").constantOr(0)!==1||nn.iconsNeedLinear,hr=nn.sdfIcons||f.options.rotating||f.options.zooming||Gs||lr?Ke.LINEAR:Ke.NEAREST,bu=nn.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,hg=f.terrain&&lt&&_r?o.a6.mat4.invert(o.a6.mat4.create(),Mr):kd;if(_r&&nn.icon){const xu=Je.elevation,fg=xu?xu.getAtTileOffsetFunc(rn,Je.center.lat,Je.worldSize,nn.getProjection()):null,Hd=Jo(to,hn.tileID.canonical,lt,rt,Je,nn.getProjection(),Hn);Uc(nn,to,f,!1,Hd,ni,lt,me,fg,rn)}return{program:js,buffers:nn.icon,uniformValues:hs,atlasTexture:tl,atlasTextureIcon:null,atlasInterpolation:hr,atlasInterpolationIcon:null,isSDF:nn.sdfIcons,hasHalo:bu,tile:hn,labelPlaneMatrixInv:hg}},Sr=()=>{const _r=ht&&l.layout.get("symbol-placement")!=="point",cr=[],Nr=_r||Tn||Rn;f.terrainRenderModeElevated()&&st&&cr.push("PITCH_WITH_MAP_TERRAIN"),An&&(cr.push("PROJECTION_GLOBE_VIEW"),Nr&&cr.push("PROJECTED_POS_ON_VIEWPORT")),nn.text.zOffsetVertexBuffer&&cr.push("Z_OFFSET"),nn.iconsInText&&cr.push("RENDER_TEXT_AND_SYMBOL"),cr.push("RENDER_SDF"),Io(cr);const yi=nn.text.programConfigurations.get(l.id),As=f.getOrCreateProgram("symbol",{config:yi,defines:cr});let js,Si=[0,0],Qo=null;const Zo=nn.textSizeData;nn.iconsInText&&(Si=hn.imageAtlasTexture?hn.imageAtlasTexture.size:[0,0],Qo=hn.imageAtlasTexture?hn.imageAtlasTexture:null,js=st||Je.pitch!==0||f.options.rotating||f.options.zooming||Zo.kind==="composite"||Zo.kind==="camera"?Ke.LINEAR:Ke.NEAREST);const lr=hn.glyphAtlasTexture?hn.glyphAtlasTexture.size:[0,0],Mr=l.layout.get("text-size-scale-range"),ni=o.ap(f.scaleFactor,Mr[0],Mr[1]),$r=o.bk(Zo,Je.zoom,ni),Ei=Xo(to,hn.tileID.canonical,st,ht,Je,nn.getProjection(),Hn),Ma=as(to,hn.tileID.canonical,st,ht,Je,nn.getProjection(),Hn),us=f.translatePosMatrix(Ma,hn,V,j,!0),ds=f.translatePosMatrix(to,hn,V,j),Hs=Nr?kd:Ei,la=ht&&!st&&!_r;let hs=Vt;!wt&&!Je.mercatorFromTransition||ht||(hs=Z_(Je));const tl=q_(Zo.kind,$r,la,st,f,ds,Hs,us,We,!0,lr,Si,!0,rn,Zn,yn,ho,An?hs:Vt,nn.getProjection(),null,null,ni),Gs=hn.glyphAtlasTexture?hn.glyphAtlasTexture:null,hr=Ke.LINEAR,bu=l.paint.get("text-halo-width").constantOr(1)!==0,hg=f.terrain&&st&&_r?o.a6.mat4.invert(o.a6.mat4.create(),Ei):kd;if(_r&&nn.text){const xu=Je.elevation,fg=xu?xu.getAtTileOffsetFunc(rn,Je.center.lat,Je.worldSize,nn.getProjection()):null,Hd=Jo(to,hn.tileID.canonical,st,ht,Je,nn.getProjection(),Hn);Uc(nn,to,f,!0,Hd,Ma,st,we,fg,rn)}return{program:As,buffers:nn.text,uniformValues:tl,atlasTexture:Gs,atlasTextureIcon:Qo,atlasInterpolation:hr,atlasInterpolationIcon:js,isSDF:!0,hasHalo:bu,tile:hn,labelPlaneMatrixInv:hg}},nr=nn.icon.segments.get().length,Dr=nn.text.segments.get().length,ar=nr&&!C.onlyText?Go():null,Tr=Dr&&!C.onlyIcons?Sr():null,Vo=l.paint.get("icon-opacity").constantOr(1),yr=l.paint.get("text-opacity").constantOr(1);if(Lt&&nn.canOverlap){Wt=!0;const _r=Vo&&!C.onlyText?nn.icon.segments.get():[],cr=yr&&!C.onlyIcons?nn.text.segments.get():[];for(const Nr of _r)on.push({segments:new o.b2([Nr]),sortKey:Nr.sortKey,state:ar});for(const Nr of cr)on.push({segments:new o.b2([Nr]),sortKey:Nr.sortKey,state:Tr})}else C.onlyText||on.push({segments:Vo?nn.icon.segments:new o.b2([]),sortKey:0,state:ar}),C.onlyIcons||on.push({segments:yr?nn.text.segments:new o.b2([]),sortKey:0,state:Tr})}Wt&&on.sort((rn,hn)=>rn.sortKey-hn.sortKey);for(const rn of on){const hn=rn.state;if(hn)if(f.terrain?f.terrain.setupElevationDraw(hn.tile,hn.program,{useDepthForOcclusion:Je.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:hn.labelPlaneMatrixInv}):f.setupDepthForOcclusion(Je.depthOcclusionForSymbolsAndCircles,hn.program),Xe.activeTexture.set(Ke.TEXTURE0),hn.atlasTexture&&hn.atlasTexture.bind(hn.atlasInterpolation,Ke.CLAMP_TO_EDGE,!0),hn.atlasTextureIcon&&(Xe.activeTexture.set(Ke.TEXTURE1),hn.atlasTextureIcon&&hn.atlasTextureIcon.bind(hn.atlasInterpolationIcon,Ke.CLAMP_TO_EDGE,!0)),f.uploadCommonLightUniforms(f.context,hn.program),hn.hasHalo){const nn=hn.uniformValues;nn.u_is_halo=1,Rd(hn.buffers,rn.segments,l,f,hn.program,ln,b,w,nn,2),nn.u_is_halo=0}else{if(hn.isSDF){const nn=hn.uniformValues;hn.hasHalo&&(nn.u_is_halo=1,Rd(hn.buffers,rn.segments,l,f,hn.program,ln,b,w,nn,1)),nn.u_is_halo=0}Rd(hn.buffers,rn.segments,l,f,hn.program,ln,b,w,hn.uniformValues,1)}}}function Rd(f,r,l,p,b,w,C,O,V,G){const j=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];b.draw(p,p.context.gl.TRIANGLES,w,C,O,bo.disabled,V,l.id,f.layoutVertexBuffer,f.indexBuffer,r,l.paint,p.transform.zoom,f.programConfigurations.get(l.id),j,G)}function vf(f,r,l,p,b,w,C){const O=f.context.gl,V=l.paint.get("fill-pattern"),G=l.is3D(),j=G?f.stencilModeFor3D():Eo.disabled,Y=V&&V.constantOr(1);let Q,ie,ve,me,we;C?(ie=Y&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=O.LINES):(ie=Y?"fillPattern":"fill",Q=O.TRIANGLES);for(const be of p){const Pe=r.getTile(be);if(Y&&!Pe.patternsLoaded())continue;const $e=Pe.getBucket(l);if(!$e)continue;f.prepareDrawTile();const Ve=$e.programConfigurations.get(l.id),We=f.isTileAffectedByFog(be),Xe=f.getOrCreateProgram(ie,{config:Ve,overrideFog:We});Y&&(f.context.activeTexture.set(O.TEXTURE0),Pe.imageAtlasTexture&&Pe.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ve.updatePaintBuffers());const Ke=V.constantOr(null);if(Ke&&Pe.imageAtlas){const ht=Pe.imageAtlas.patternPositions[Ke.toString()];ht&&Ve.setConstantPatternPositions(ht)}const Je=f.translatePosMatrix(be.projMatrix,Pe,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),rt=l.paint.get("fill-emissive-strength");if(C){me=$e.indexBuffer2,we=$e.segments2;const ht=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];ve=ie==="fillOutlinePattern"&&Y?C1(Je,rt,f,Pe,ht):Md(Je,rt,ht)}else me=$e.indexBuffer,we=$e.segments,ve=Y?Om(Je,rt,f,Pe):W_(Je,rt);f.uploadCommonUniforms(f.context,Xe,be.toUnwrapped()),Xe.draw(f,Q,b,G?j:f.stencilModeForClipping(be),w,bo.disabled,ve,l.id,$e.layoutVertexBuffer,me,we,l.paint,f.transform.zoom,Ve,void 0)}}function Li(f,r,l,p,b,w,C,O){l.resetLayerRenderingStats(f);const V=f.context,G=V.gl,j=f.transform,Y=l.paint.get("fill-extrusion-pattern"),Q=Y.constantOr(1),ie=l.paint.get("fill-extrusion-opacity"),ve=f.style.enable3dLights(),me=l.paint.get(ve&&!Q?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),we=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),me],be=l.layout.get("fill-extrusion-edge-radius"),Pe=be>0&&!l.paint.get("fill-extrusion-rounded-roof"),$e=Pe?0:be,Ve=j.projection.name==="globe"?o.c_():0,We=j.projection.name==="globe",Xe=We?o.a9(j.zoom):0,Ke=[o.am(j.center.lng),o.at(j.center.lat)],Je=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),rt=l.paint.get("fill-extrusion-flood-light-intensity"),ht=l.paint.get("fill-extrusion-vertical-scale"),lt=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,st=l.paint.get("fill-extrusion-height-alignment"),Lt=l.paint.get("fill-extrusion-base-alignment"),Wt=Ga(f,l.paint.get("fill-extrusion-cutoff-fade-range")),ln=[];let yn;We&&ln.push("PROJECTION_GLOBE_VIEW"),we[0]>0&&ln.push("FAUX_AO"),Pe&&ln.push("ZERO_ROOF_RADIUS"),O&&ln.push("HAS_CENTROID"),rt>0&&ln.push("FLOOD_LIGHT"),Wt.shouldRenderCutoff&&ln.push("RENDER_CUTOFF"),lt&&ln.push("RENDER_WALL_MODE");const Tn=f.renderPass==="shadow",wt=f.shadowRenderer,on=Tn&&!!wt;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Vt=[0,0,0];if(wt){const nn=f.style.directionalLight,An=f.style.ambientLight;nn&&An&&(Vt=Xh(f.style,nn,An)),Tn||(ln.push("RENDER_SHADOWS","DEPTH_TEXTURE"),wt.useNormalOffset&&ln.push("NORMAL_OFFSET")),yn=ln.concat(["SHADOWS_SINGLE_CASCADE"])}const rn=on?"fillExtrusionDepth":Q?"fillExtrusionPattern":"fillExtrusion",hn=l.getLayerRenderingStats();for(const nn of p){const An=r.getTile(nn),Zn=An.getBucket(l);if(!Zn||Zn.projection.name!==j.projection.name)continue;let to=!1;wt&&(to=wt.getMaxCascadeForTile(nn.toUnwrapped())===0);const Hn=f.isTileAffectedByFog(nn),oo=Zn.programConfigurations.get(l.id),Rn=f.getOrCreateProgram(rn,{config:oo,defines:to?yn:ln,overrideFog:Hn});if(f.terrain&&f.terrain.setupElevationDraw(An,Rn,{useMeterToDem:!0}),!Zn.centroidVertexBuffer){const ar=Rn.attributes.a_centroid_pos;ar!==void 0&&G.vertexAttrib2f(ar,0,0)}!Tn&&wt&&wt.setupShadows(An.tileID.toUnwrapped(),Rn,"vector-tile",An.tileID.overscaledZ),Q&&(f.context.activeTexture.set(G.TEXTURE0),An.imageAtlasTexture&&An.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),oo.updatePaintBuffers());const ho=Y.constantOr(null);if(ho&&An.imageAtlas){const ar=An.imageAtlas.patternPositions[ho.toString()];ar&&oo.setConstantPatternPositions(ar)}const Io=l.paint.get("fill-extrusion-vertical-gradient"),Go=1/Zn.tileToMeter;let Sr;if(Tn&&wt){if(X_(An.tileID,Zn,f))continue;const ar=wt.calculateShadowPassMatrixFromTile(An.tileID.toUnwrapped());Sr=Dm(ar,$e,Go,ht,st,Lt)}else{const ar=f.translatePosMatrix(nn.expandedProjMatrix,An,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Tr=j.projection.createInversionMatrix(j,nn.canonical);Sr=Q?Lm(ar,f,Io,ie,we,$e,Go,nn,An,Ve,st,Lt,Xe,Ke,Tr,Je,ht):Rm(ar,f,Io,ie,we,$e,Go,nn,Ve,st,Lt,Xe,Ke,Tr,Je,ht,rt,Vt)}f.uploadCommonUniforms(V,Rn,nn.toUnwrapped(),null,Wt);let nr=Zn.segments;if(j.projection.name==="mercator"&&!Tn&&(nr=Zn.getVisibleSegments(An.tileID,f.terrain,f.transform.getFrustum(0)),!nr.get().length))continue;if(hn)if(Tn)for(const ar of nr.get())hn.numRenderedVerticesInShadowPass+=ar.primitiveLength;else for(const ar of nr.get())hn.numRenderedVerticesInTransparentPass+=ar.primitiveLength;const Dr=[];(f.terrain||O)&&Dr.push(Zn.centroidVertexBuffer),We&&Dr.push(Zn.layoutVertexExtBuffer),lt&&Dr.push(Zn.wallVertexBuffer),Rn.draw(f,V.gl.TRIANGLES,b,w,C,bo.backCCW,Sr,l.id,Zn.layoutVertexBuffer,Zn.indexBuffer,nr,l.paint,f.transform.zoom,oo,Dr)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function Ms(f,r,l,p,b,w,C,O,V,G,j,Y,Q,ie,ve,me,we,be,Pe){const $e=f.context,Ve=$e.gl,We=f.transform,Xe=f.transform.zoom,Ke=[],Je=Ga(f,l.paint.get("fill-extrusion-cutoff-fade-range"));G==="clear"?(Ke.push("CLEAR_SUBPASS"),Pe&&(Ke.push("CLEAR_FROM_TEXTURE"),$e.activeTexture.set(Ve.TEXTURE0),Pe.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE))):G==="sdf"&&Ke.push("SDF_SUBPASS"),we&&Ke.push("HAS_CENTROID"),Je.shouldRenderCutoff&&Ke.push("RENDER_CUTOFF");const rt=l.layout.get("fill-extrusion-edge-radius"),ht=(lt,st,Lt,Wt,ln)=>{const yn=st.programConfigurations.get(l.id),Tn=f.isTileAffectedByFog(lt),wt=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:yn,defines:Ke,overrideFog:Tn}),on=((rn,hn,nn,An,Zn,to,Hn,oo,Rn,ho,Io)=>({u_matrix:hn,u_opacity:nn,u_ao_pass:An?1:0,u_meter_to_tile:Zn,u_ao:to,u_flood_light_intensity:Hn,u_flood_light_color:oo,u_attenuation:Rn,u_edge_radius:ho,u_fb:0,u_fb_size:Io,u_dynamic_offset:1}))(0,Wt,j,V,ln,[Y,Q*ln],ie,ve,me,Xe>=17?0:rt*ln,Pe?Pe.size[0]:0),Vt=[];we&&Vt.push(st.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms($e,wt,lt.toUnwrapped(),null,Je),wt.draw(f,$e.gl.TRIANGLES,b,w,C,O,on,l.id,st.vertexBuffer,st.indexBuffer,Lt,l.paint,Xe,yn,Vt)};for(const lt of p){const st=r.getTile(lt),Lt=st.getBucket(l);if(!Lt||Lt.projection.name!==We.projection.name||!Lt.groundEffect||Lt.groundEffect&&!Lt.groundEffect.hasData())continue;const Wt=Lt.groundEffect,ln=1/Lt.tileToMeter;{const yn=f.translatePosMatrix(lt.projMatrix,st,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Tn=Wt.getDefaultSegment();ht(lt,Wt,Tn,yn,ln)}if(be)for(let yn=0;yn<4;yn++){const Tn=o.c$[yn](lt),wt=r.getTile(Tn);if(!wt)continue;const on=wt.getBucket(l);if(!on||on.projection.name!==We.projection.name||!on.groundEffect||on.groundEffect&&!on.groundEffect.hasData())continue;const Vt=on.groundEffect;let rn,hn;yn===0?(rn=[-o.ab,0,0],hn=1):yn===1?(rn=[o.ab,0,0],hn=0):yn===2?(rn=[0,-o.ab,0],hn=3):(rn=[0,o.ab,0],hn=2);const nn=Vt.regionSegments[hn];if(!nn)continue;const An=new Float32Array(16);o.a6.mat4.translate(An,lt.projMatrix,rn),ht(lt,Vt,nn,f.translatePosMatrix(An,st,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),ln)}}}function Y_(f,r,l,p,b,w,C){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const O=w?w.findDEMTileFor(l):null;if(!(O&&O.dem||C))return;const V=be=>new o.P(Math.ceil((be+o.d2)*o.d3),0),G=be=>{const Pe=r.getSource().minzoom,$e=We=>{const Xe=r.getTileByID(We);if(Xe&&Xe.hasData())return Xe.getBucket(b)},Ve=[0,-1,1];for(const We of Ve){if(be.overscaledZ+We<Pe)continue;const Xe=$e(be.calculateScaledKey(be.overscaledZ+We));if(Xe)return Xe}},j=[0,0,0],Y=(be,Pe)=>(j[0]=Math.min(be.min.y,Pe.min.y),j[1]=Math.max(be.max.y,Pe.max.y),j[2]=o.ab-Pe.min.x>be.max.x?Pe.min.x-o.ab:be.max.x,j),Q=(be,Pe)=>(j[0]=Math.min(be.min.x,Pe.min.x),j[1]=Math.max(be.max.x,Pe.max.x),j[2]=o.ab-Pe.min.y>be.max.y?Pe.min.y-o.ab:be.max.y,j),ie=[(be,Pe)=>Y(be,Pe),(be,Pe)=>Y(Pe,be),(be,Pe)=>Q(be,Pe),(be,Pe)=>Q(Pe,be)],ve=(be,Pe,$e,Ve,We,Xe,Ke)=>{if(!w)return 0;const Je=[[Xe?$e:be,Xe?be:$e,0],[Xe?$e:Pe,Xe?Pe:$e,0]],rt=Ke<0?o.ab+Ke:Ke,ht=[Xe?rt:(be+Pe)/2,Xe?(be+Pe)/2:rt,0];return $e===0&&Ke<0||$e!==0&&Ke>0?w.getForTilePoints(We,[ht],!0,Ve):Je.push(ht),w.getForTilePoints(l,Je,!0,O),Math.max(Je[0][2],Je[1][2],ht[2])/w.exaggeration()};for(let be=0;be<4;be++){const Pe=p.borderFeatureIndices[be];if(Pe.length===0)continue;const $e=o.c$[be](l),Ve=G($e);if(!(Ve&&Ve instanceof o.d0)||p.borderDoneWithNeighborZ[be]===Ve.canonical.z)continue;Ve.centroidVertexArray.length===0&&Ve.createCentroidsBuffer();const We=w?w.findDEMTileFor($e):null;if(!(We&&We.dem||C))continue;const Xe=(be<2?1:5)-be,Ke=Ve.borderDoneWithNeighborZ[Xe]!==p.canonical.z,Je=Ve.borderFeatureIndices[Xe];let rt=0;if(p.canonical.z!==Ve.canonical.z){for(const ht of Pe)p.showCentroid(p.featuresOnBorder[ht]);if(Ke)for(const ht of Je)Ve.showCentroid(Ve.featuresOnBorder[ht]);p.borderDoneWithNeighborZ[be]=Ve.canonical.z,Ve.borderDoneWithNeighborZ[Xe]=p.canonical.z}for(const ht of Pe){const lt=p.featuresOnBorder[ht],st=p.centroidData[lt.centroidDataIndex],Lt=lt.borders[be];let Wt;for(;rt<Je.length;){Wt=Ve.featuresOnBorder[Je[rt]];const ln=Wt.borders[Xe];if(ln[1]>Lt[0]+3||ln[0]>Lt[0]-3)break;Ve.showCentroid(Wt),rt++}if(Wt&&rt<Je.length){const ln=rt;let yn=0;for(;!(Wt.borders[Xe][0]>Lt[1]-3)&&(yn++,++rt!==Je.length);)Wt=Ve.featuresOnBorder[Je[rt]];Wt=Ve.featuresOnBorder[Je[ln]];let Tn=!1;if(yn>=1){const Vt=Wt.borders[Xe];Math.abs(Lt[0]-Vt[0])<3&&Math.abs(Lt[1]-Vt[1])<3&&(yn=1,Tn=!0,rt=ln+1)}else if(yn===0){p.showCentroid(lt);continue}const wt=Ve.centroidData[Wt.centroidDataIndex];C&&Tn&&(((me=st).flags|(we=wt).flags)&o.d1?(me.flags|=o.d1,we.flags|=o.d1):(me.flags&=~o.d1,we.flags&=~o.d1));const on=lt.intersectsCount()>1||Wt.intersectsCount()>1;if(yn>1)rt=ln,st.centroidXY=wt.centroidXY=new o.P(0,0);else if(We&&We.dem&&!on){const Vt=ie[be](st,wt),rn=be%2?o.ab-1:0,hn=ve(Vt[0],Math.min(o.ab-1,Vt[1]),rn,We,$e,be<2,Vt[2]);st.centroidXY=wt.centroidXY=V(hn)}else on?st.centroidXY=wt.centroidXY=new o.P(0,0):(st.centroidXY=p.encodeBorderCentroid(lt),wt.centroidXY=Ve.encodeBorderCentroid(Wt));p.writeCentroidToBuffer(st),Ve.writeCentroidToBuffer(wt)}else p.showCentroid(lt)}p.borderDoneWithNeighborZ[be]=Ve.canonical.z,Ve.borderDoneWithNeighborZ[Xe]=p.canonical.z}var me,we;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(f)}const Hm=[1,0,0],Gm=[0,1,0],Wm=[0,0,1];function X_(f,r,l){const p=l.transform,b=l.shadowRenderer;if(!b)return!0;const w=f.toUnwrapped(),C=p.tileSize*b._cascades[l.currentShadowCascade].scale;let O=r.maxHeight;if(p.elevation){const me=p.elevation.getMinMaxForTile(f);me&&(O+=me.max)}const V=[...b.shadowDirection];V[2]=-V[2];const G=b.computeSimplifiedTileShadowVolume(w,O,C,V);if(!G)return!1;const j=[Hm,Gm,Wm,V,[V[0],0,V[2]],[0,V[1],V[2]]],Y=p.projection.name==="globe",Q=p.scaleZoom(C),ie=o.bO.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,Q,!Y),ve=b.getCurrentCascadeFrustum();return ie.intersectsPrecise(G.vertices,G.planes,j)===0||ve.intersectsPrecise(G.vertices,G.planes,j)===0}function Is(f){return[f[0]*o.d4,f[1]*o.d4,f[2]*o.d4,0]}function Zr(f,r,l,p,b,w,C,O,V){const G=p.getSource(),j=l.globeSharedBuffers;if(!j)return;let Y,Q,ie;if(r&&(Y=p.getTile(r)),G instanceof o.aD?(Q=G.texture,ie=o.cD(0,0,l.transform)):Y&&r&&(Q=Y.texture,ie=o.cD(r.canonical.z,r.canonical.x,l.transform)),!Q||!ie)return;f||(ie=o.a6.mat4.scale(o.a6.mat4.create(),ie,[1,-1,1]));const ve=l.context,me=ve.gl,we=b.paint.get("raster-resampling")==="nearest"?me.NEAREST:me.LINEAR,be=l.colorModeForDrapableLayerRenderPass(w),Pe=C.defines;Pe.push("GLOBE_POLES");const $e=new io(me.LEQUAL,io.ReadWrite,l.depthRangeFor3D),Ve=Float32Array.from(l.transform.expandedFarZProjMatrix),We=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ve.activeTexture.set(me.TEXTURE0),Q.bind(we,me.CLAMP_TO_EDGE),ve.activeTexture.set(me.TEXTURE1),Q.bind(we,me.CLAMP_TO_EDGE),Q.useMipmap&&ve.extTextureFilterAnisotropic&&l.transform.pitch>20&&me.texParameterf(me.TEXTURE_2D,ve.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ve.extTextureFilterAnisotropicMax);const[Xe,Ke,Je,rt]=r?j.getPoleBuffers(r.canonical.z,!1):j.getPoleBuffers(0,!0),ht=b.paint.get("raster-elevation");let lt;f?(lt=Xe,l.renderDefaultNorthPole=ht!==0):(lt=Ke,l.renderDefaultSouthPole=ht!==0);const st=Is(C.mix),Lt=((ln,yn,Tn,wt,on,Vt,rn,hn,nn,An,Zn,to,Hn)=>ff(ln,yn,Tn,new Float32Array(16),new Float32Array(9),[0,0],wt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Vt,[0,0],hn,2,An,Zn,to,1,0,Hn))(Ve,We,ie,o.a9(l.transform.zoom),0,b,0,ht,0,st,C.offset,C.range,w),Wt=l.getOrCreateProgram("raster",{defines:Pe});l.uploadCommonUniforms(ve,Wt,null),Wt.draw(l,me.TRIANGLES,$e,V,be,O,Lt,b.id,lt,Je,rt)}function _f(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,b=.2*f.height,w=r+b;return[r,l,(w-b-r)/p,(w-r)/p]}function qm(f,r,l,p){if(f)return r instanceof ba&&f instanceof $h?r.getTextureDescriptor(f,l,!0):{texture:f.texture,mix:Is(p.mix),offset:p.offset,buffer:0,tileSize:1}}var J_=o.d5([{name:"a_index",type:"Int16",components:1}]);class Q_{constructor(r,l,p,b){const w={width:p[0],height:p[1],data:null},C=r.gl;this.targetColorTexture=new o.T(r,w,C.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(r,w,C.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,b),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,b=l.width*l.height;this.particleTexture0=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1});const w=new o.d6;w.reserve(b);for(let C=0;C<b;C++)w.emplaceBack(C);this.particleIndexBuffer=this.context.createVertexBuffer(w,J_.members,!0),this.particleSegment=o.b2.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=o.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function ey(f,r,l){if(!f)return null;const p=r.getTextureDescriptor(f,l,!0);if(!p)return null;let{texture:b,mix:w,offset:C,tileSize:O,buffer:V,format:G}=p;if(!b||!G)return null;let j=!1;return G==="uint32"&&(j=!0,w[3]=0,w=hf(o.d7,w,[0,l.paint.get("raster-particle-max-speed")]),C=au(o.d7,C,[0,l.paint.get("raster-particle-max-speed")])),{texture:b,textureOffset:[V/(O+2*V),O/(O+2*V)],tileSize:O,scalarData:j,scale:w,offset:C,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[G]]}}function k1(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,b=.2*f.height,w=r+b;return[r,l,(w-b-r)/p,(w-r)/p]}const cu=new o.bA(1,0,0,1),uu=new o.bA(0,1,0,1),wn=new o.bA(0,0,1,1),Qn=new o.bA(1,0,1,1),du=new o.bA(0,1,1,1);function zr(f,r,l,p,b,w,C){const O=f.context,V=f.transform,G=O.gl,j=V.projection.name==="globe",Y=j?["PROJECTION_GLOBE_VIEW"]:[];let Q=o.a6.mat4.clone(l.projMatrix);if(j&&o.a9(V.zoom)>0){const st=o.b5(l.canonical,V),Lt=o.d8(st);Q=o.a6.mat4.multiply(new Float32Array(16),V.globeMatrix,Lt),o.a6.mat4.multiply(Q,V.projMatrix,Q)}const ie=o.a6.mat4.create();ie[12]+=2*b/(o.q.devicePixelRatio*V.width),ie[13]+=2*w/(o.q.devicePixelRatio*V.height),o.a6.mat4.multiply(Q,ie,Q);const ve=f.getOrCreateProgram("debug",{defines:Y}),me=r.getTileByID(l.key);f.terrain&&f.terrain.setupElevationDraw(me,ve);const we=io.disabled,be=Eo.disabled,Pe=f.colorModeForRenderPass(),$e="$debug";O.activeTexture.set(G.TEXTURE0),f.emptyTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),j?me._makeGlobeTileDebugBuffers(f.context,V):me._makeDebugTileBoundsBuffers(f.context,V.projection);const Ve=me._tileDebugBuffer||f.debugBuffer,We=me._tileDebugIndexBuffer||f.debugIndexBuffer,Xe=me._tileDebugSegments||f.debugSegments;if(ve.draw(f,G.LINE_STRIP,we,be,Pe,bo.disabled,zm(Q,p),$e,Ve,We,Xe,null,null,null,[me._globeTileDebugBorderBuffer]),C){const st=me.latestRawTileData,Lt=Math.floor((st&&st.byteLength||0)/1024);let Wt=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Wt+=` => ${l.overscaledZ}`),Wt+=` ${me.state}`,Wt+=` ${Lt}kb`,function(ln,yn){ln.initDebugOverlayCanvas();const Tn=ln.debugOverlayCanvas,wt=ln.context.gl,on=ln.debugOverlayCanvas.getContext("2d");on.clearRect(0,0,Tn.width,Tn.height),on.shadowColor="white",on.shadowBlur=2,on.lineWidth=1.5,on.strokeStyle="white",on.textBaseline="top",on.font="bold 36px Open Sans, sans-serif",on.fillText(yn,5,5),on.strokeText(yn,5,5),ln.debugOverlayTexture.update(Tn),ln.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)}(f,Wt)}const Ke=r.getTile(l).tileSize,Je=512/Math.min(Ke,512)*(l.overscaledZ/V.zoom)*.5,rt=me._tileDebugTextBuffer||f.debugBuffer,ht=me._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,lt=me._tileDebugTextSegments||f.debugSegments;ve.draw(f,G.TRIANGLES,we,be,Ho.alphaBlended,bo.disabled,zm(Q,o.bA.transparent,Je),$e,rt,ht,lt,null,null,null,[me._globeTileDebugTextBuffer])}function It(f,r,l,p){pc(f,0,r+l/2,f.transform.width,l,p)}function Km(f,r,l,p){pc(f,r-l/2,0,l,f.transform.height,p)}function pc(f,r,l,p,b,w){const C=f.context,O=C.gl;O.enable(O.SCISSOR_TEST),O.scissor(r*o.q.devicePixelRatio,l*o.q.devicePixelRatio,p*o.q.devicePixelRatio,b*o.q.devicePixelRatio),C.clear({color:w}),O.disable(O.SCISSOR_TEST)}const Zm=o.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:yf}=Zm;function Ka(f,r,l,p){f.emplaceBack(r,l,p)}class Ym{constructor(r){this.vertexArray=new o.d9,this.indices=new o.aP,Ka(this.vertexArray,-1,-1,1),Ka(this.vertexArray,1,-1,1),Ka(this.vertexArray,-1,1,1),Ka(this.vertexArray,1,1,1),Ka(this.vertexArray,-1,-1,-1),Ka(this.vertexArray,1,-1,-1),Ka(this.vertexArray,-1,1,-1),Ka(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,yf),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.b2.simpleSegment(0,0,36,12)}}function sa(f,r,l,p,b,w){const C=f.context.gl,O=r.paint.get("sky-atmosphere-color"),V=r.paint.get("sky-atmosphere-halo-color"),G=r.paint.get("sky-atmosphere-sun-intensity"),j=((Y,Q,ie,ve,me)=>({u_matrix_3f:Y,u_sun_direction:Q,u_sun_intensity:ie,u_color_tint_r:[ve.r,ve.g,ve.b,ve.a],u_color_tint_m:[me.r,me.g,me.b,me.a],u_luminance:5e-5}))(o.a6.mat3.fromMat4(o.a6.mat3.create(),p),b,G,O,V);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+w,r.skyboxTexture,0),l.draw(f,C.TRIANGLES,io.disabled,Eo.disabled,Ho.unblended,bo.frontCW,j,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const P1=o.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class R1{constructor(r){const l=new o.da;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const p=new o.aP;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,P1.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=o.b2.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ty=o.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class bf{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Xm{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Ho([1,Ss,1,Ss],o.bA.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ho([1,0,1,0],o.bA.transparent,[!1,!1,!1,!0]),this.params=new bf,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new R1(l);const p=this.params.sizeRange,b=this.params.intensityRange,w=function(j){const Y=o.dd(30),Q=[];for(let ie=0;ie<j;++ie){const ve=2*Math.PI*Y(),me=Math.acos(1-2*Y())-.5*Math.PI;Q.push(o.a6.vec3.fromValues(Math.cos(me)*Math.cos(ve),Math.cos(me)*Math.sin(ve),Math.sin(me)))}return Q}(this.params.starsCount),C=o.dd(300),O=new o.db,V=new o.aP;let G=0;for(let j=0;j<w.length;++j){const Y=o.a6.vec3.scale([],w[j],200),Q=Math.max(0,1+.01*p*(1*C()-.5)),ie=Math.max(0,1+.01*b*(1*C()-.5));O.emplaceBack(Y[0],Y[1],Y[2],-1,-1,Q,ie),O.emplaceBack(Y[0],Y[1],Y[2],1,-1,Q,ie),O.emplaceBack(Y[0],Y[1],Y[2],1,1,Q,ie),O.emplaceBack(Y[0],Y[1],Y[2],-1,1,Q,ie),V.emplaceBack(G+0,G+1,G+2),V.emplaceBack(G+0,G+2,G+3),G+=4}this.starsVx=l.createVertexBuffer(O,ty.members),this.starsIdx=l.createIndexBuffer(V),this.starsSegments=o.b2.simpleSegment(0,0,O.length,V.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const p=r.context,b=p.gl,w=r.transform,C=new io(b.LEQUAL,io.ReadOnly,[0,1]),O=o.a9(w.zoom),V=r.style.getLut(l.scope),G=l.properties.get("color").toRenderColor(V).toArray01(),j=l.properties.get("high-color").toRenderColor(V).toArray01(),Y=l.properties.get("space-color").toRenderColor(V).toArray01PremultipliedAlpha(),Q=5e-4,ie=o.dc(l.properties.get("horizon-blend"),0,1,Q,.25),ve=o.cx(r,p,w)&&ie===Q?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,me=r.frameCounter/1e3%1,we=o.a6.vec3.length(w.globeCenterInViewSpace),be=Math.sqrt(Math.pow(we,2)-Math.pow(ve,2)),Pe=Math.acos(be/we),$e=Ve=>{const We=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ve&&We.push("ALPHA_PASS");const Xe=r.getOrCreateProgram("globeAtmosphere",{defines:We}),Ke=((rt,ht,lt,st,Lt,Wt,ln,yn,Tn,wt,on,Vt)=>({u_frustum_tl:rt,u_frustum_tr:ht,u_frustum_br:lt,u_frustum_bl:st,u_horizon:Lt,u_transition:Wt,u_fadeout_range:ln,u_color:yn,u_high_color:Tn,u_space_color:wt,u_temporal_offset:on,u_horizon_angle:Vt}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,O,ie,G,j,Y,me,Pe);r.uploadCommonUniforms(p,Xe);const Je=this.atmosphereBuffer;Je&&Xe.draw(r,b.TRIANGLES,C,Eo.disabled,Ve?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,bo.backCW,Ke,Ve?"atmosphere_glow_alpha":"atmosphere_glow",Je.vertexBuffer,Je.indexBuffer,Je.segments)};$e(!1),$e(!0)}drawStars(r,l){const p=o.ap(l.properties.get("star-intensity"),0,1);if(p===0)return;const b=r.context,w=b.gl,C=r.transform,O=r.getOrCreateProgram("stars"),V=o.a6.quat.identity([]);o.a6.quat.rotateX(V,V,-C._pitch),o.a6.quat.rotateZ(V,V,-C.angle),o.a6.quat.rotateX(V,V,o.bC(C._center.lat)),o.a6.quat.rotateY(V,V,-o.bC(C._center.lng));const G=o.a6.mat4.fromQuat(new Float32Array(16),V),j=o.a6.mat4.multiply([],C.starsProjMatrix,G),Y=o.a6.mat3.fromMat4([],G),Q=o.a6.mat3.invert([],Y),ie=[0,1,0];o.a6.vec3.transformMat3(ie,ie,Q),o.a6.vec3.scale(ie,ie,this.params.sizeMultiplier);const ve=[1,0,0];o.a6.vec3.transformMat3(ve,ve,Q),o.a6.vec3.scale(ve,ve,this.params.sizeMultiplier);const me=(we=ie,be=ve,Pe=p,{u_matrix:Float32Array.from(j),u_up:we,u_right:be,u_intensity_multiplier:Pe});var we,be,Pe;r.uploadCommonUniforms(b,O),this.starsVx&&this.starsIdx&&O.draw(r,w.TRIANGLES,io.disabled,Eo.disabled,this.colorModeAlphaBlendedWriteRGB,bo.disabled,me,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Jm(f,r){const l=[...f],p=r.cameraWorldSizeForFog/r.worldSize,b=o.a6.mat4.identity([]);return o.a6.mat4.scale(b,b,[p,p,1]),o.a6.mat4.multiply(l,b,l),o.a6.mat4.multiply(l,r.worldToFogMatrix,l),l}function xf(f,r,l,p,b){const w=l.material,C=p.context,{baseColorTexture:O,metallicRoughnessTexture:V}=w.pbrMetallicRoughness,{normalTexture:G,occlusionTexture:j,emissionTexture:Y}=w;function Q(ve,me,we){if(ve&&(f.push(me),C.activeTexture.set(C.gl.TEXTURE0+we),ve.gfxTexture)){const{minFilter:be,magFilter:Pe,wrapS:$e,wrapT:Ve}=ve.sampler;ve.gfxTexture.bindExtraParam(be,Pe,$e,Ve)}}Q(O,"HAS_TEXTURE_u_baseColorTexture",Di.BaseColor),Q(V,"HAS_TEXTURE_u_metallicRoughnessTexture",Di.MetallicRoughness),Q(G,"HAS_TEXTURE_u_normalTexture",Di.Normal),Q(j,"HAS_TEXTURE_u_occlusionTexture",Di.Occlusion),Q(Y,"HAS_TEXTURE_u_emissionTexture",Di.Emission),b&&(b.texture||(b.texture=new o.df(p.context,b.image,[b.image.height,b.image.height,b.image.height],C.gl.RGBA8)),C.activeTexture.set(C.gl.TEXTURE0+Di.LUT),b.texture&&b.texture.bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(f.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||f.push("DIFFUSE_SHADED"),f.push("USE_STANDARD_DERIVATIVES");const ie=p.shadowRenderer;ie&&(f.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ie.useNormalOffset&&f.push("NORMAL_OFFSET"))}function mc(f,r,l,p,b,w){const C=l.paint.get("model-opacity"),O=r.context,V=new io(r.context.gl.LEQUAL,io.ReadWrite,r.depthRangeFor3D),G=r.transform,j=f.mesh,Y=j.material,Q=Y.pbrMetallicRoughness,ie=r.style.fog;let ve;ve=r.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:o.a6.mat4.multiply([],p.zScaleMatrix,f.nodeModelMatrix),o.a6.mat4.multiply(ve,p.negCameraPosMatrix,ve);const me=o.a6.mat4.invert([],ve);o.a6.mat4.transpose(me,me);const we=l.paint.get("model-emissive-strength").constantOr(0),be=gf(new Float32Array(f.worldViewProjection),new Float32Array(ve),new Float32Array(me),null,r,C,Q.baseColorFactor.toRenderColor(null),Y.emissiveFactor,Q.metallicFactor,Q.roughnessFactor,Y,we,l),Pe={defines:[]},$e=[],Ve=r.shadowRenderer;Ve&&(Ve.useNormalOffset=!1),xf(Pe.defines,$e,j,r,l.lut);let We=null;if(ie){const Je=Jm(f.nodeModelMatrix,r.transform);if(We=new Float32Array(Je),G.projection.name!=="globe"){const rt=j.aabb.min,ht=j.aabb.max,[lt,st]=ie.getOpacityForBounds(Je,rt[0],rt[1],ht[0],ht[1]);Pe.overrideFog=lt>=pt||st>=pt}}const Xe=Ga(r,l.paint.get("model-cutoff-fade-range"));Xe.shouldRenderCutoff&&Pe.defines.push("RENDER_CUTOFF");const Ke=r.getOrCreateProgram("model",Pe);r.uploadCommonUniforms(O,Ke,null,We,Xe),r.renderPass!=="shadow"&&Ve&&Ve.setupShadowsFromMatrix(f.nodeModelMatrix,Ke),Ke.draw(r,O.gl.TRIANGLES,V,b,w,j.material.doubleSided?bo.disabled:bo.backCCW,be,l.id,j.vertexBuffer,j.indexBuffer,j.segments,l.paint,r.transform.zoom,void 0,$e)}function Dd(f,r,l,p,b,w,C){let O;O=f.projection.name==="globe"?o.dg(l,f):[...l],o.a6.mat4.multiply(O,O,r.matrix);const V=o.a6.mat4.multiply([],p,O);if(r.meshes)for(const G of r.meshes){if(G.material.alphaMode!=="BLEND"){C.push({mesh:G,depth:0,modelIndex:b,worldViewProjection:V,nodeModelMatrix:O});continue}const j=o.a6.vec3.transformMat4([],G.centroid,V);j[2]>0&&w.push({mesh:G,depth:j[2],modelIndex:b,worldViewProjection:V,nodeModelMatrix:O})}if(r.children)for(const G of r.children)Dd(f,G,l,p,b,w,C)}function wf(f,r,l,p){const b=l.shadowRenderer;if(!b)return;const w=b.getShadowPassDepthMode(),C=b.getShadowPassColorMode(),O=b.calculateShadowPassMatrixFromMatrix(r),V=$m(O);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,w,Eo.disabled,C,bo.backCCW,V,p.id,f.vertexBuffer,f.indexBuffer,f.segments,p.paint,l.transform.zoom,void 0,void 0)}function ny(f,r,l){const p=r.updateZoomBasedPaintProperties(),b=function(w,C,O){let V,G,j,Y=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&Y>0){const Q=w.terrain,ie=Q.findDEMTileFor(O);ie&&ie.dem?V=o.di.create(Q,O,ie):Y=0}if(Y===0&&(C.terrainElevationMin=0,C.terrainElevationMax=0),Y===C.validForExaggeration&&(Y===0||V&&V._demTile&&V._demTile.tileID===C.validForDEMTile.id&&V._dem._timestamp===C.validForDEMTile.timestamp))return!1;for(const Q in C.instancesPerModel){const ie=C.instancesPerModel[Q];for(let ve=0;ve<ie.instancedDataArray.length;++ve){const me=(V?Y*V.getElevationAt(0|ie.instancedDataArray.float32[16*ve],0|ie.instancedDataArray.float32[16*ve+1],!0,!0):0)+ie.instancesEvaluatedElevation[ve];ie.instancedDataArray.float32[16*ve+6]=me,G=G?Math.min(C.terrainElevationMin,me):me,j=j?Math.max(C.terrainElevationMax,me):me}}return C.terrainElevationMin=G||0,C.terrainElevationMax=j||0,C.validForExaggeration=Y,C.validForDEMTile=V&&V._demTile?{id:V._demTile.tileID,timestamp:V._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,r,l);(p||b)&&(r.uploaded=!1,r.upload(f.context))}const Ta={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.ca([0,0,0],[o.ab,o.ab,0])};function Qi(f,r){const l=1<<f.canonical.z,p=r.getFreeCameraOptions().position,b=r.elevation,w=f.canonical.x/l,C=(f.canonical.x+1)/l,O=f.canonical.y/l,V=(f.canonical.y+1)/l;let G=r._centerAltitude;if(b){const ie=b.getMinMaxForTile(f);ie&&ie.max>G&&(G=ie.max)}const j=o.ap(p.x,w,C)-p.x,Y=o.ap(p.y,O,V)-p.y,Q=o.bE(G,r.center.lat)-p.z;return r._zoomFromMercatorZ(Math.sqrt(j*j+Y*Y+Q*Q))}function oy(f,r,l,p,b,w,C){const O=f.context,V=f.renderPass==="shadow",G=f.shadowRenderer,j=V&&G?G.getShadowPassDepthMode():new io(O.gl.LEQUAL,io.ReadWrite,f.depthRangeFor3D),Y=f.isTileAffectedByFog(w);if(l.meshes)for(const Q of l.meshes){const ie=["MODEL_POSITION_ON_GPU"],ve=[];let me,we,be;p.instancedDataArray.length>20&&ie.push("INSTANCED_ARRAYS");const Pe=Ga(f,r.paint.get("model-cutoff-fade-range"));if(Pe.shouldRenderCutoff&&ie.push("RENDER_CUTOFF"),V&&G)me=f.getOrCreateProgram("modelDepth",{defines:ie}),we=$m(C.shadowTileMatrix,C.shadowTileMatrix,Float32Array.from(l.matrix)),be=G.getShadowPassColorMode();else{xf(ie,ve,Q,f,r.lut),me=f.getOrCreateProgram("model",{defines:ie,overrideFog:Y});const Ve=Q.material,We=Ve.pbrMetallicRoughness,Xe=r.paint.get("model-opacity"),Ke=r.paint.get("model-emissive-strength").constantOr(0);we=gf(w.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,f,Xe,We.baseColorFactor.toRenderColor(null),Ve.emissiveFactor,We.metallicFactor,We.roughnessFactor,Ve,Ke,r,b),G&&(C.shadowUniformsInitialized?me.setShadowUniformValues(O,G.getShadowUniformValues()):(G.setupShadows(w.toUnwrapped(),me,"model-tile",w.overscaledZ),C.shadowUniformsInitialized=!0)),be=Pe.shouldRenderCutoff||Xe<1||Ve.alphaMode!=="OPAQUE"?Ho.alphaBlended:Ho.unblended}f.uploadCommonUniforms(O,me,w.toUnwrapped(),null,Pe);const $e=Q.material.doubleSided?bo.disabled:bo.backCCW;if(p.instancedDataArray.length>20)ve.push(p.instancedDataBuffer),me.draw(f,O.gl.TRIANGLES,j,Eo.disabled,be,$e,we,r.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,r.paint,f.transform.zoom,void 0,ve,p.instancedDataArray.length);else{const Ve=V?"u_instance":"u_normal_matrix";for(let We=0;We<p.instancedDataArray.length;++We)we[Ve]=new Float32Array(p.instancedDataArray.arrayBuffer,64*We,16),me.draw(f,O.gl.TRIANGLES,j,Eo.disabled,be,$e,we,r.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,r.paint,f.transform.zoom,void 0,ve)}}if(l.children)for(const Q of l.children)oy(f,r,Q,p,b,w,C)}const Ld=[1,-1,1];function Br(f,r,l,p){if(!l.modelManager)return!0;const b=l.modelManager;if(!l.shadowRenderer)return!0;const w=l.shadowRenderer,C=r.aabb;let O=!0,V=f.maxHeight;if(V===0){let j=0;for(const Y in f.instancesPerModel){const Q=b.getModel(Y,p);Q?j=Math.max(j,Math.max(Math.max(Q.aabb.max[0],Q.aabb.max[1]),Q.aabb.max[2])):O=!1}V=f.maxScale*j*1.41+f.maxVerticalOffset,O&&(f.maxHeight=V)}C.max[2]=V,C.min[2]+=f.terrainElevationMin,C.max[2]+=f.terrainElevationMax,o.a6.vec3.transformMat4(C.min,C.min,r.tileMatrix),o.a6.vec3.transformMat4(C.max,C.max,r.tileMatrix);const G=C.intersects(w.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=G===2),G===0}function sr(f,r){const l=f.uniformValues.u_cutoff_params[0],p=f.uniformValues.u_cutoff_params[1],b=f.uniformValues.u_cutoff_params[2],w=f.uniformValues.u_cutoff_params[3];return p===l||w===b?1:o.ap(((r-l)/(p-l)-b)/(w-b),0,1)}function ry(f,r,l,p){if(r.pitch<20)return 1;const b=r.getWorldToCameraMatrix();o.a6.mat4.multiply(b,b,f);const w=o.a6.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),O=C,V=C;w[1]=l.max[1],C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),O=C[1]<O[1]?C:O,V=C[1]>V[1]?C:V,w[0]=l.max[0],C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),O=C[1]<O[1]?C:O,V=C[1]>V[1]?C:V,w[1]=l.min[1],C=o.a6.vec4.transformMat4(o.a6.vec4.create(),w,b),O=C[1]<O[1]?C:O,V=C[1]>V[1]?C:V;const G=o.ap(p[0],0,1),j=100*r.pixelsPerMeter*o.ap(p[1],0,1),Y=o.ap(p[2],0,1),Q=o.a6.vec4.lerp(o.a6.vec4.create(),O,V,G),ie=Math.tan(.5*r.fovX),ve=-Q[2]*ie;if(j===0)return Q[1]<-Math.abs(ve)?Y:1;const me=(-Math.abs(ve)-Q[1])/j,we=(Pe,$e,Ve)=>(1-Ve)*Pe+Ve*$e,be=o.ap(we(1,Y,me),Y,1);return we(1,be,o.ap((r.pitch-20)/20,0,1))}class Rl{}class Sf{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,p){{const Y=this._storage.get(l.id);if(Y)return Y.lastUsedFrameIdx=r,Y.buf}const b=p.gl,w=b.getBufferParameter(b.ELEMENT_ARRAY_BUFFER,b.BUFFER_SIZE),C=new ArrayBuffer(w),O=new Int16Array(C);b.getBufferSubData(b.ELEMENT_ARRAY_BUFFER,0,new Int16Array(C));const V=new o.dk;for(let Y=0;Y<w/2;Y+=3){const Q=O[Y],ie=O[Y+1],ve=O[Y+2];V.emplaceBack(Q,ie),V.emplaceBack(ie,ve),V.emplaceBack(ve,Q)}const G=p.bindVertexArrayOES.current,j=new Rl;return j.buf=new cs(p,V),j.lastUsedFrameIdx=r,this._storage.set(l.id,j),p.bindVertexArrayOES.set(G),j.buf}update(r){for(const[l,p]of this._storage)r-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class hu{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}class Qm{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Od={symbol:function(f,r,l,p,b){if(f.renderPass!=="translucent")return;const w=Eo.disabled,C=f.colorModeForRenderPass(),O=l.layout.get("text-variable-anchor"),V=l.layout.get("text-size-scale-range"),G=o.ap(f.scaleFactor,V[0],V[1]);O&&function(Q,ie,ve,me,we,be,Pe,$e){const Ve=ie.transform,We=we==="map",Xe=be==="map";for(const Ke of Q){const Je=me.getTile(Ke),rt=Je.getBucket(ve);if(!rt||!rt.text||!rt.text.segments.get().length)continue;const ht=o.bk(rt.textSizeData,Ve.zoom,$e),lt=Il(Ke,rt.getProjection(),Ve),st=Ve.calculatePixelsToTileUnitsMatrix(Je),Lt=Xo(lt,Je.tileID.canonical,Xe,We,Ve,rt.getProjection(),st),Wt=rt.hasIconTextFit()&&rt.hasIconData();if(ht){const ln=Math.pow(2,Ve.zoom-Je.tileID.overscaledZ);jm(rt,We,Xe,Pe,o.cS,Ve,Lt,Ke,ln,ht,Wt)}}}(p,f,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),b,G);const j=l.paint.get("icon-opacity").constantOr(1)!==0,Y=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(j||Y)?Pd(f,r,l,p,w,C):(j&&Pd(f,r,l,p,w,C,{onlyIcons:!0}),Y&&Pd(f,r,l,p,w,C,{onlyText:!0})),r.map.showCollisionBoxes&&(Um(f,r,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Um(f,r,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,l,p){if(f.renderPass!=="translucent")return;const b=l.paint.get("circle-opacity"),w=l.paint.get("circle-stroke-width"),C=l.paint.get("circle-stroke-opacity"),O=l.layout.get("circle-sort-key").constantOr(1)!==void 0,V=l.paint.get("circle-emissive-strength");if(b.constantOr(1)===0&&(w.constantOr(1)===0||C.constantOr(1)===0))return;const G=f.context,j=G.gl,Y=f.transform,Q=f.depthModeForSublayer(0,io.ReadOnly),ie=Eo.disabled,ve=f.colorModeForDrapableLayerRenderPass(V),me=Y.projection.name==="globe",we=[o.am(Y.center.lng),o.at(Y.center.lat)],be=[];for(let $e=0;$e<p.length;$e++){const Ve=p[$e],We=r.getTile(Ve),Xe=We.getBucket(l);if(!Xe||Xe.projection.name!==Y.projection.name)continue;const Ke=Xe.programConfigurations.get(l.id),Je=o.cT(l),rt=f.isTileAffectedByFog(Ve);me&&Je.push("PROJECTION_GLOBE_VIEW"),Je.push("DEPTH_D24"),f.terrain&&Y.depthOcclusionForSymbolsAndCircles&&Je.push("DEPTH_OCCLUSION");const ht=f.getOrCreateProgram("circle",{config:Ke,defines:Je,overrideFog:rt}),lt=Xe.layoutVertexBuffer,st=Xe.globeExtVertexBuffer,Lt=Xe.indexBuffer,Wt=Y.projection.createInversionMatrix(Y,Ve.canonical),ln={programConfiguration:Ke,program:ht,layoutVertexBuffer:lt,globeExtVertexBuffer:st,indexBuffer:Lt,uniformValues:o.cU(f,Ve,We,Wt,we,l),tile:We};if(O){const yn=Xe.segments.get();for(const Tn of yn)be.push({segments:new o.b2([Tn]),sortKey:Tn.sortKey,state:ln})}else be.push({segments:Xe.segments,sortKey:0,state:ln})}O&&be.sort(($e,Ve)=>$e.sortKey-Ve.sortKey);const Pe={useDepthForOcclusion:Y.depthOcclusionForSymbolsAndCircles};for(const $e of be){const{programConfiguration:Ve,program:We,layoutVertexBuffer:Xe,globeExtVertexBuffer:Ke,indexBuffer:Je,uniformValues:rt,tile:ht}=$e.state,lt=$e.segments;f.terrain&&f.terrain.setupElevationDraw(ht,We,Pe),f.uploadCommonUniforms(G,We,ht.tileID.toUnwrapped()),We.draw(f,j.TRIANGLES,Q,ie,ve,bo.disabled,rt,l.id,Xe,Je,lt,l.paint,Y.zoom,Ve,[Ke])}},heatmap:function(f,r,l,p){if(l.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const b=f.context,w=b.gl,C=Eo.disabled,O=new Ho([w.ONE,w.ONE,w.ONE,w.ONE],o.bA.transparent,[!0,!0,!0,!0]);(function(ie,ve,me,we){const be=ie.gl,Pe=ve.width*we,$e=ve.height*we;ie.activeTexture.set(be.TEXTURE1),ie.viewport.set([0,0,Pe,$e]);let Ve=me.heatmapFbo;if(!Ve||Ve&&(Ve.width!==Pe||Ve.height!==$e)){Ve&&Ve.destroy();const We=be.createTexture();be.bindTexture(be.TEXTURE_2D,We),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MIN_FILTER,be.LINEAR),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MAG_FILTER,be.LINEAR),Ve=me.heatmapFbo=ie.createFramebuffer(Pe,$e,!0,null),function(Xe,Ke,Je,rt,ht,lt){const st=Xe.gl;st.texImage2D(st.TEXTURE_2D,0,Xe.extRenderToTextureHalfFloat?st.RGBA16F:st.RGBA,ht,lt,0,st.RGBA,Xe.extRenderToTextureHalfFloat?st.HALF_FLOAT:st.UNSIGNED_BYTE,null),rt.colorAttachment.set(Je)}(ie,0,We,Ve,Pe,$e)}else be.bindTexture(be.TEXTURE_2D,Ve.colorAttachment.get()),ie.bindFramebuffer.set(Ve.framebuffer)})(b,f,l,f.transform.projection.name==="globe"?.5:.25),b.clear({color:o.bA.transparent});const V=f.transform,G=V.projection.name==="globe",j=G?["PROJECTION_GLOBE_VIEW"]:[],Y=G?bo.frontCCW:bo.disabled,Q=[o.am(V.center.lng),o.at(V.center.lat)];for(let ie=0;ie<p.length;ie++){const ve=p[ie];if(r.hasRenderableParent(ve))continue;const me=r.getTile(ve),we=me.getBucket(l);if(!we||we.projection.name!==V.projection.name)continue;const be=f.isTileAffectedByFog(ve),Pe=we.programConfigurations.get(l.id),$e=f.getOrCreateProgram("heatmap",{config:Pe,defines:j,overrideFog:be}),{zoom:Ve}=f.transform;f.terrain&&f.terrain.setupElevationDraw(me,$e),f.uploadCommonUniforms(b,$e,ve.toUnwrapped());const We=V.projection.createInversionMatrix(V,ve.canonical);$e.draw(f,w.TRIANGLES,io.disabled,C,O,Y,Bm(f,ve,me,We,Q,Ve,l.paint.get("heatmap-intensity")),l.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,l.paint,f.transform.zoom,Pe,G?[we.globeExtVertexBuffer]:null)}b.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(b,w){const C=b.context,O=C.gl,V=w.heatmapFbo;if(!V)return;C.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,V.colorAttachment.get()),C.activeTexture.set(O.TEXTURE1);let G=w.colorRampTexture;G||(G=w.colorRampTexture=new o.T(C,w.colorRamp,O.RGBA8)),G.bind(O.LINEAR,O.CLAMP_TO_EDGE),b.getOrCreateProgram("heatmapTexture").draw(b,O.TRIANGLES,io.disabled,Eo.disabled,b.colorModeForRenderPass(),bo.disabled,((j,Y,Q,ie)=>({u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}))(0,w),w.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,w.paint,b.transform.zoom)}(f,l))},line:function(f,r,l,p){if(f.renderPass!=="translucent")return;const b=l.paint.get("line-opacity"),w=l.paint.get("line-width");if(b.constantOr(1)===0||w.constantOr(1)===0)return;const C=l.paint.get("line-emissive-strength"),O=l.paint.get("line-occlusion-opacity"),V=l.layout.get("line-elevation-reference")==="sea",G=f.context,j=G.gl,Y=!l.isDraped();if(Y&&f.transform.projection.name==="globe")return;const Q=l.layout.get("line-cross-slope"),ie=Q!==void 0,ve=Q<1,me=Y?new io(f.depthOcclusion?j.GREATER:j.LEQUAL,io.ReadOnly,f.depthRangeFor3D):f.depthModeForSublayer(0,io.ReadOnly),we=f.colorModeForDrapableLayerRenderPass(C),be=f.terrain&&f.terrain.renderingToTexture,Pe=be?1:o.q.devicePixelRatio,$e=l.paint.get("line-dasharray"),Ve=$e.constantOr(1),We=l.layout.get("line-cap"),Xe=$e.constantOr(null),Ke=We.constantOr(null),Je=l.paint.get("line-pattern"),rt=Je.constantOr(1),ht=Je.constantOr(null),lt=l.paint.get("line-opacity").constantOr(1);let st=!rt&&lt!==1||f.depthOcclusion&&O>0&&O<1;const Lt=l.paint.get("line-gradient"),Wt=rt?"linePattern":"line",ln=o.cV(l);let yn;if(be&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(st=!1),O!==0&&f.depthOcclusion){const wt=l.paint._values["line-opacity"];wt&&wt.value&&wt.value.kind==="constant"?yn=wt.value:o.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}if(Y&&(f.forceTerrainMode=!0),!Y&&O!==0&&f.terrain&&!be)return void o.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`);const Tn=st&&Y?f.stencilModeFor3D():Eo.disabled;Y&&(ln.push("ELEVATED"),ie&&ln.push(ve?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),V&&ln.push("ELEVATION_REFERENCE_SEA"));for(const wt of p){const on=r.getTile(wt);if(rt&&!on.patternsLoaded())continue;const Vt=on.getBucket(l);if(!Vt)continue;f.prepareDrawTile();const rn=Vt.programConfigurations.get(l.id),hn=f.isTileAffectedByFog(wt),nn=f.getOrCreateProgram(Wt,{config:rn,defines:ln,overrideFog:hn,overrideRtt:!Y&&void 0});if(ht&&on.imageAtlas){const Rn=on.imageAtlas.patternPositions[ht.toString()];Rn&&rn.setConstantPatternPositions(Rn)}if(!rt&&Xe&&Ke&&on.lineAtlas){const Rn=on.lineAtlas.getDash(Xe,Ke);Rn&&rn.setConstantPatternPositions(Rn)}let[An,Zn]=l.paint.get("line-trim-offset");(Ke==="round"||Ke==="square")&&An!==Zn&&(An===0&&(An-=1),Zn===1&&(Zn+=1));const to=be?wt.projMatrix:null,Hn=rt?o.cW(f,on,l,to,Pe,[An,Zn]):o.cX(f,on,l,to,Vt.lineClipsArray.length,Pe,[An,Zn]);if(Lt){const Rn=Vt.gradients[l.id];let ho=Rn.texture;if(l.gradientVersion!==Rn.version){let Io=256;if(l.stepInterpolant){const Go=r.getSource().maxzoom,Sr=wt.canonical.z===Go?Math.ceil(1<<f.transform.maxZoom-wt.canonical.z):1;Io=o.ap(o.cY(Vt.maxLineLength/o.ab*1024*Sr),256,G.maxTextureSize)}Rn.gradient=o.cZ({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Io,image:Rn.gradient||void 0,clips:Vt.lineClipsArray}),Rn.texture?Rn.texture.update(Rn.gradient):Rn.texture=new o.T(G,Rn.gradient,j.RGBA8),Rn.version=l.gradientVersion,ho=Rn.texture}G.activeTexture.set(j.TEXTURE1),ho.bind(l.stepInterpolant?j.NEAREST:j.LINEAR,j.CLAMP_TO_EDGE)}Ve&&(G.activeTexture.set(j.TEXTURE0),on.lineAtlasTexture&&on.lineAtlasTexture.bind(j.LINEAR,j.REPEAT),rn.updatePaintBuffers()),rt&&(G.activeTexture.set(j.TEXTURE0),on.imageAtlasTexture&&on.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),rn.updatePaintBuffers()),Y&&!V&&f.terrain.setupElevationDraw(on,nn),f.uploadCommonUniforms(G,nn,wt.toUnwrapped());const oo=Rn=>{yn!=null&&(yn.value=lt*O),nn.draw(f,j.TRIANGLES,me,Rn,we,bo.disabled,Hn,l.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,l.paint,f.transform.zoom,rn,[Vt.layoutVertexBuffer2,Vt.patternVertexBuffer,Vt.zOffsetVertexBuffer]),yn!=null&&(yn.value=lt)};if(st&&!Y){const Rn=f.stencilModeForClipping(wt).ref;Rn===0&&be&&G.clear({stencil:0});const ho={func:j.EQUAL,mask:255};Hn.u_alpha_discard_threshold=.8,oo(new Eo(ho,Rn,255,j.KEEP,j.KEEP,j.INVERT)),Hn.u_alpha_discard_threshold=0,oo(new Eo(ho,Rn,255,j.KEEP,j.KEEP,j.KEEP))}else st&&Y&&(Hn.u_alpha_discard_threshold=.001),oo(Y?Tn:f.stencilModeForClipping(wt))}Y&&(f.forceTerrainMode=!1),st&&(f.resetStencilClippingMasks(),be&&G.clear({stencil:0})),O===0||f.depthOcclusion||be||f.layersWithOcclusionOpacity.push(f.currentLayer)},fill:function(f,r,l,p){const b=l.paint.get("fill-color"),w=l.paint.get("fill-opacity"),C=l.is3D(),O=new io(f.context.gl.LEQUAL,io.ReadWrite,f.depthRangeFor3D);if(w.constantOr(1)===0)return;const V=l.paint.get("fill-emissive-strength"),G=f.colorModeForDrapableLayerRenderPass(V),j=l.paint.get("fill-pattern"),Y=f.opaquePassEnabledForLayer()&&!j.constantOr(1)&&b.constantOr(o.bA.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===Y){const Q=C?O:f.depthModeForSublayer(1,f.renderPass==="opaque"?io.ReadWrite:io.ReadOnly);vf(f,r,l,p,Q,G,!1)}if(!C&&f.renderPass==="translucent"&&l.paint.get("fill-antialias")){const Q=C?O:f.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,io.ReadOnly);vf(f,r,l,p,Q,G,!0)}},"fill-extrusion":function(f,r,l,p){const b=l.paint.get("fill-extrusion-opacity"),w=f.context,C=w.gl,O=f.terrain,V=O&&O.renderingToTexture;if(b===0)return;const G=f.conflationActive&&f.style.isLayerClipped(l,r.getSource()),j=f.style.order.indexOf(l.fqid);if(G&&function(Y,Q,ie,ve,me){for(const we of ve){const be=Q.getTile(we).getBucket(ie);be&&(be.updateReplacement(we,Y.replacementSource,me),be.uploadCentroid(Y.context))}}(f,r,l,p,j),O||G)for(const Y of p){const Q=r.getTile(Y).getBucket(l);Q&&Y_(f.context,r,Y,Q,l,O,G)}if(f.renderPass==="shadow"&&f.shadowRenderer){const Y=f.shadowRenderer;if(O&&b<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.a4)return;const Q=Y.getShadowPassDepthMode(),ie=Y.getShadowPassColorMode();Li(f,r,l,p,Q,Eo.disabled,ie,G)}else if(f.renderPass==="translucent"){const Y=!l.paint.get("fill-extrusion-pattern").constantOr(1),Q=l.paint.get("fill-extrusion-color").constantOr(o.bA.white);if(!V&&Q.a!==0){const ie=new io(f.context.gl.LEQUAL,io.ReadWrite,f.depthRangeFor3D);b===1&&Y?Li(f,r,l,p,ie,Eo.disabled,Ho.unblended,G):(Li(f,r,l,p,ie,Eo.disabled,Ho.disabled,G),Li(f,r,l,p,ie,f.stencilModeFor3D(),f.colorModeForRenderPass(),G),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&Y&&(!O&&f.transform.projection.name!=="globe"||V)){const ie=l.paint.get("fill-extrusion-opacity"),ve=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),me=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),we=l.paint.get("fill-extrusion-flood-light-intensity"),be=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),Pe=ve>0&&me>0,$e=we>0,Ve=(Xe,Ke,Je)=>(1-Je)*Xe+Je*Ke,We=Xe=>{const Ke=f.depthModeForSublayer(1,io.ReadOnly,C.LEQUAL,!0),Je=l.paint.get(Xe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),rt=Ve(.1,3,Je),ht=f._showOverdrawInspector;if(!ht){const lt=new Eo({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),st=new Ho([C.ONE,C.ONE,C.ONE,C.ONE],o.bA.transparent,[!1,!1,!1,!0],C.MIN);Ms(f,r,l,p,Ke,lt,st,bo.disabled,Xe,"sdf",ie,ve,me,we,be,rt,G,!1)}{const lt=ht?Eo.disabled:new Eo({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),st=ht?f.colorModeForRenderPass():new Ho([C.ONE_MINUS_DST_ALPHA,C.DST_ALPHA,C.ONE,C.ONE],o.bA.transparent,[!0,!0,!0,!0]);Ms(f,r,l,p,Ke,lt,st,bo.disabled,Xe,"color",ie,ve,me,we,be,rt,G,!1)}};if(V){const Xe=(Ke,Je,rt)=>{const ht=f.depthModeForSublayer(1,io.ReadOnly,C.LEQUAL,!1),lt=l.paint.get(Ke?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),st=Ve(.1,3,lt);{const Lt=new Ho([C.ONE,C.ONE,C.ONE,C.ONE],o.bA.transparent,[!1,!1,!1,!0]);Ms(f,r,l,p,ht,Eo.disabled,Lt,bo.disabled,Ke,"clear",ie,ve,me,we,be,st,G,Je)}{const Lt=new Eo({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),Wt=new Ho([C.ONE,C.ONE,C.ONE,C.ONE],o.bA.transparent,[!1,!1,!1,!0],C.MIN);Ms(f,r,l,p,ht,Lt,Wt,bo.disabled,Ke,"sdf",ie,ve,me,we,be,st,G,Je)}{const Lt=Ke?C.ZERO:C.ONE_MINUS_DST_ALPHA,Wt=new Eo({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),ln=new Ho([Lt,C.DST_ALPHA,C.ONE_MINUS_DST_ALPHA,C.ZERO],o.bA.transparent,[!0,!0,!0,!0]);Ms(f,r,l,p,ht,Wt,ln,bo.disabled,Ke,"color",ie,ve,me,we,be,st,G,Je)}{const Lt=new Ho([C.ONE,C.ONE,C.ONE,Ke?C.ZERO:C.ONE],o.bA.transparent,[!1,!1,!1,!0],Ke?C.FUNC_ADD:C.MAX);Ms(f,r,l,p,ht,Eo.disabled,Lt,bo.disabled,Ke,"clear",ie,ve,me,we,be,st,G,Je,rt)}};if(Pe||$e){let Ke;if(f.prepareDrawTile(),O){const Je=O.drapeBufferSize[0],rt=O.drapeBufferSize[1];Ke=O.framebufferCopyTexture,Ke&&(!Ke||Ke.size[0]===Je&&Ke.size[1]===rt)||(Ke&&Ke.destroy(),Ke=O.framebufferCopyTexture=new o.T(w,new o.r({width:Je,height:rt}),C.RGBA8)),Ke.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.copyTexSubImage2D(C.TEXTURE_2D,0,0,0,0,0,Je,rt)}Pe&&Xe(!0,!1,Ke),$e&&Xe(!1,!0,Ke)}}else Pe&&We(!0),$e&&We(!1),(Pe||$e)&&f.resetStencilClippingMasks()}}},hillshade:function(f,r,l,p){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const b=f.context,w=f.terrain&&f.terrain.renderingToTexture,[C,O]=f.renderPass!=="translucent"||w?[{},p]:f.stencilConfigForOverlap(p);for(const V of O){const G=r.getTile(V);if(G.needsHillshadePrepare&&f.renderPass==="offscreen")nu(f,G,l);else if(f.renderPass==="translucent"){const j=f.depthModeForSublayer(0,io.ReadOnly),Y=l.paint.get("hillshade-emissive-strength"),Q=f.colorModeForDrapableLayerRenderPass(Y),ie=w&&f.terrain?f.terrain.stencilModeForRTTOverlap(V):C[V.overscaledZ];of(f,V,G,l,j,ie,Q)}}b.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,l,p,b,w){if(f.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const C=f.transform.projection.name==="globe",O=l.paint.get("raster-elevation")!==0,V=O&&C;if(f.renderElevatedRasterBackface&&!V)return;const G=f.context,j=G.gl,Y=r.getSource(),Q=function(Xe,Ke,Je,rt){const ht=Ke.paint.get("raster-color"),lt=Xe.type==="raster-array",st=[],Lt=Ke.paint.get("raster-resampling"),Wt=Ke.paint.get("raster-color-mix");let ln=Ke.paint.get("raster-color-range");const yn=[Wt[0],Wt[1],Wt[2],0],Tn=Wt[3];let wt=Lt==="nearest"?rt.NEAREST:rt.LINEAR;if(lt&&(st.push("RASTER_ARRAY"),ht||st.push("RASTER_COLOR"),Lt==="linear"&&st.push("RASTER_ARRAY_LINEAR"),wt=rt.NEAREST,!ln&&Xe.rasterLayers)){const on=Xe.rasterLayers.find(({id:Vt})=>Vt===Ke.sourceLayer);on&&on.fields&&on.fields.range&&(ln=on.fields.range)}if(ln=ln||[0,1],ht){st.push("RASTER_COLOR"),Je.activeTexture.set(rt.TEXTURE2),Ke.updateColorRamp(ln);let on=Ke.colorRampTexture;on||(on=Ke.colorRampTexture=new o.T(Je,Ke.colorRamp,rt.RGBA8)),on.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)}return{mix:yn,range:ln,offset:Tn,defines:st,resampling:wt}}(Y,l,G,j);if(Y instanceof o.aD&&!p.length&&!C)return;const ie=l.paint.get("raster-emissive-strength"),ve=f.colorModeForDrapableLayerRenderPass(ie),me=f.terrain&&f.terrain.renderingToTexture,we=!f.options.moving,be=l.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;if(Y instanceof o.aD&&!p.length&&(Y.onNorthPole||Y.onSouthPole)){const Xe=O?f.stencilModeFor3D():Eo.disabled;return void Zr(!!Y.onNorthPole,null,f,r,l,ie,Q,bo.disabled,Xe)}if(!p.length)return;const[Pe,$e]=Y instanceof o.aD||me?[{},p]:f.stencilConfigForOverlap(p),Ve=$e[$e.length-1].overscaledZ;V&&Q.defines.push("PROJECTION_GLOBE_VIEW"),O&&Q.defines.push("RENDER_CUTOFF");const We=(Xe,Ke,Je)=>{for(const rt of Xe){const ht=rt.toUnwrapped(),lt=r.getTile(rt);if(me&&(!lt||!lt.hasData()))continue;G.activeTexture.set(j.TEXTURE0);const st=qm(lt,Y,l,Q);if(!st||!st.texture)continue;const{texture:Lt,mix:Wt,offset:ln,tileSize:yn,buffer:Tn}=st;let wt,on;me?(wt=io.disabled,on=rt.projMatrix):O?(wt=new io(j.LEQUAL,io.ReadWrite,f.depthRangeFor3D),on=C?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix(ht,we)):(wt=f.depthModeForSublayer(rt.overscaledZ-Ve,l.paint.get("raster-opacity")===1?io.ReadWrite:io.ReadOnly,j.LESS),on=f.transform.calculateProjMatrix(ht,we));const Vt=f.terrain&&me?f.terrain.stencilModeForRTTOverlap(rt):Pe[rt.overscaledZ],rn=w?0:l.paint.get("raster-fade-duration");lt.registerFadeDuration(rn);const hn=r.findLoadedParent(rt,0),nn=uf(lt,hn,r,f.transform,rn);let An,Zn;f.terrain&&f.terrain.prepareDrawTile(),G.activeTexture.set(j.TEXTURE0),Lt.bind(be,j.CLAMP_TO_EDGE),G.activeTexture.set(j.TEXTURE1),hn?(hn.texture&&hn.texture.bind(be,j.CLAMP_TO_EDGE),An=Math.pow(2,hn.tileID.overscaledZ-lt.tileID.overscaledZ),Zn=[lt.tileID.canonical.x*An%1,lt.tileID.canonical.y*An%1]):Lt.bind(be,j.CLAMP_TO_EDGE),Lt.useMipmap&&G.extTextureFilterAnisotropic&&f.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax);const to=f.transform;let Hn;const oo=O?_f(to):[0,0,0,0];let Rn,ho,Io,Go,Sr,nr=0;if(V&&Y instanceof o.aD&&Y.coordinates.length>3)Rn=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0)))),ho=Float32Array.from(to.globeMatrix),Io=Float32Array.from(o.cy(to)),Go=[o.am(to.center.lng),o.at(to.center.lat)],Hn=Y.elevatedGlobePerspectiveTransform,Sr=Y.elevatedGlobeGridMatrix||new Float32Array(9);else if(V){const Vo=o.cz(rt.canonical);nr=o.cA(Vo.getCenter().lat),Rn=Float32Array.from(o.b6(o.cC(rt.canonical))),ho=Float32Array.from(to.globeMatrix),Io=Float32Array.from(o.cy(to)),Go=[o.am(to.center.lng),o.at(to.center.lat)],Hn=[0,0],Sr=Float32Array.from(o.cB(rt.canonical,Vo,nr,to.worldSize/to._pixelsPerMercatorPixel))}else Hn=Y instanceof o.aD?Y.perspectiveTransform:[0,0],Rn=new Float32Array(16),ho=new Float32Array(9),Io=new Float32Array(16),Go=[0,0],Sr=new Float32Array(9);const Dr=ff(on,Rn,ho,Io,Sr,Zn||[0,0],o.a9(f.transform.zoom),Go,oo,An||1,nn,l,Hn,O?l.paint.get("raster-elevation"):0,2,Wt,ln,Q.range,yn,Tn,ie),ar=f.isTileAffectedByFog(rt),Tr=f.getOrCreateProgram("raster",{defines:Q.defines,overrideFog:ar});if(f.uploadCommonUniforms(G,Tr,ht),Y instanceof o.aD){const Vo=Y.elevatedGlobeVertexBuffer,yr=Y.elevatedGlobeIndexBuffer;if(me||!C)Y.boundsBuffer&&Y.boundsSegments&&Tr.draw(f,j.TRIANGLES,wt,Eo.disabled,ve,bo.disabled,Dr,l.id,Y.boundsBuffer,f.quadTriangleIndexBuffer,Y.boundsSegments);else if(Vo&&yr){const _r=to.zoom<=o.c3?Y.elevatedGlobeSegments:Y.getSegmentsForLongitude(to.center.lng);_r&&Tr.draw(f,j.TRIANGLES,wt,Eo.disabled,ve,Ke,Dr,l.id,Vo,yr,_r)}}else if(V){wt=new io(j.LEQUAL,io.ReadOnly,f.depthRangeFor3D);const Vo=f.globeSharedBuffers;if(Vo){const[yr,_r,cr]=Vo.getGridBuffers(nr,!1);Tr.draw(f,j.TRIANGLES,wt,Je||Vt,f.colorModeForRenderPass(),Ke,Dr,l.id,yr,_r,cr)}}else{const{tileBoundsBuffer:Vo,tileBoundsIndexBuffer:yr,tileBoundsSegments:_r}=f.getTileBoundsBuffers(lt);Tr.draw(f,j.TRIANGLES,wt,Vt,ve,bo.disabled,Dr,l.id,Vo,yr,_r)}}if(!(Y instanceof o.aD)&&V)for(const rt of Xe){const ht=rt.canonical.y===(1<<rt.canonical.z)-1;rt.canonical.y===0&&Zr(!0,rt,f,r,l,ie,Q,Ke,Je||Eo.disabled),ht&&Zr(!1,rt,f,r,l,ie,Q,Ke===bo.frontCW?bo.backCW:bo.frontCW,Je||Eo.disabled)}};V?We($e,f.renderElevatedRasterBackface?bo.backCW:bo.frontCW,f.stencilModeFor3D()):We($e,bo.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,r,l,p,b,w){f.renderPass==="offscreen"&&function(C,O,V,G){if(!G.length)return;const j=C.context,Y=j.gl,Q=O.getSource();if(!(Q instanceof ba))return;const ie=Math.ceil(Math.sqrt(V.paint.get("raster-particle-count")));let ve=V.particlePositionRGBAImage;if(!ve||ve.width!==ie){const $e=function(Ve){const We=Ve*Ve,Xe=new Uint8Array(4*We),Ke=function(rt){return rt|=0,rt=Math.imul(2747636419^rt,2654435769),rt=Math.imul(rt^rt>>>16,2654435769),((rt=Math.imul(rt^rt>>>16,2654435769))>>>0)/4294967296},Je=1/1.1;for(let rt=0;rt<We;rt++){const ht=Je*(Ke(2*rt+0)+dc),lt=Je*(Ke(2*rt+1)+dc),st=255*ht%1,Lt=255*lt%1,Wt=st,ln=lt-Lt/255,yn=Lt;Xe[4*rt+0]=255*(ht-st/255),Xe[4*rt+1]=255*Wt,Xe[4*rt+2]=255*ln,Xe[4*rt+3]=255*yn}return Xe}(ie);ve=V.particlePositionRGBAImage=new o.r({width:ie,height:ie},$e)}let me=V.particleFramebuffer;me?me.width!==ie&&(me.destroy(),me=V.particleFramebuffer=j.createFramebuffer(ie,ie,!0,null)):me=V.particleFramebuffer=j.createFramebuffer(ie,ie,!0,null);const we=[];for(const $e of G){const Ve=O.getTile($e);if(!(Ve instanceof $h))continue;const We=ey(Ve,Q,V);if(!We)continue;const Xe=[Ve.tileSize,Ve.tileSize];let Ke=V.tileFramebuffer;Ke||(Ke=V.tileFramebuffer=j.createFramebuffer(Xe[0],Xe[1],!0,null));let Je=Ve.rasterParticleState;Je||(Je=Ve.rasterParticleState=new Q_(j,$e,Xe,ve));const rt=Je.update(V.lastInvalidatedAt);Je.particleTextureDimension!==ie&&Je.updateParticleTexture($e,ve);const ht=Je.targetColorTexture;Je.targetColorTexture=Je.backgroundColorTexture,Je.backgroundColorTexture=ht;const lt=Je.particleTexture0;Je.particleTexture0=Je.particleTexture1,Je.particleTexture1=lt,we.push([$e,We,Je,rt])}if(we.length===0)return;const be=o.q.now(),Pe=V.previousDrawTimestamp?.001*(be-V.previousDrawTimestamp):.0167;if(V.previousDrawTimestamp=be,V.hasColorMap()){j.activeTexture.set(Y.TEXTURE0+2);let $e=V.colorRampTexture;$e||($e=V.colorRampTexture=new o.T(j,V.colorRamp,Y.RGBA8)),$e.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}j.bindFramebuffer.set(V.tileFramebuffer.framebuffer),function($e,Ve,We){const Xe=$e.context,Ke=Xe.gl,Je=Ve.tileFramebuffer;Xe.activeTexture.set(Ke.TEXTURE0);const rt={u_texture:0,u_opacity:1.05*(lt=Ve.paint.get("raster-particle-fade-opacity-factor"))/(lt+.05)},ht=$e.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var lt;for(const st of We){const[,,Lt,Wt]=st;Je.colorAttachment.set(Lt.targetColorTexture.texture),Xe.viewport.set([0,0,Je.width,Je.height]),Xe.clear({color:o.bA.transparent}),Wt&&(Lt.backgroundColorTexture.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE),ht.draw($e,Ke.TRIANGLES,io.disabled,Eo.disabled,Ho.alphaBlended,bo.disabled,rt,Ve.id,$e.viewportBuffer,$e.quadTriangleIndexBuffer,$e.viewportSegments))}}(C,V,we),function($e,Ve,We,Xe){const Ke=$e.context,Je=Ke.gl,rt=We.tileFramebuffer,ht=$e.transform.projection.name==="globe",lt=We.paint.get("raster-particle-max-speed");for(const st of Xe){const[Lt,Wt,ln]=st;Ke.activeTexture.set(Je.TEXTURE0+0),Wt.texture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE),rt.colorAttachment.set(ln.targetColorTexture.texture);const yn=$e.getOrCreateProgram("rasterParticleDraw",{defines:Wt.defines,overrideFog:!1});Ke.activeTexture.set(Je.TEXTURE0+1);const Tn=Wt.scalarData?[]:[0,1,2,3].map(Vt=>o.c$[Vt](Lt));Tn.push(Lt);const wt=Lt.canonical.x,on=Lt.canonical.y;for(const Vt of Tn){const rn=Ve.getTile(ht?Vt.wrapped():Vt);if(!rn)continue;const hn=rn.rasterParticleState;if(!hn)continue;const nn=Vt.canonical.x+(1<<Vt.canonical.z)*(Vt.wrap-Lt.wrap),An=Vt.canonical.y;hn.particleTexture0.bind(Je.NEAREST,Je.CLAMP_TO_EDGE);const Zn=mf(1,hn.particleTexture0.size[0],[nn-wt,An-on],0,Wt.texture.size,2,lt,Wt.textureOffset,Wt.scale,Wt.offset);yn.draw($e,Je.POINTS,io.disabled,Eo.disabled,Ho.alphaBlended,bo.disabled,Zn,We.id,hn.particleIndexBuffer,void 0,hn.particleSegment)}}}(C,O,V,we),j.bindFramebuffer.set(V.particleFramebuffer.framebuffer),function($e,Ve,We,Xe){const Ke=$e.context,Je=Ke.gl,rt=Ve.paint.get("raster-particle-max-speed"),ht=Xe*Ve.paint.get("raster-particle-speed-factor")*.15,lt=function(Lt){return Math.pow(Lt,6)}(.01+1*Ve.paint.get("raster-particle-reset-rate-factor")),st=Ve.particleFramebuffer;Ke.viewport.set([0,0,st.width,st.height]);for(const Lt of We){const[,Wt,ln]=Lt;Ke.activeTexture.set(Je.TEXTURE0+0),Wt.texture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE),Ke.activeTexture.set(Je.TEXTURE0+1);const yn=ln.particleTexture0;yn.bind(Je.NEAREST,Je.CLAMP_TO_EDGE);const Tn=Fm(1,yn.size[0],0,Wt.texture.size,rt,ht,lt,Wt.textureOffset,Wt.scale,Wt.offset);st.colorAttachment.set(ln.particleTexture1.texture),Ke.clear({color:o.bA.transparent}),$e.getOrCreateProgram("rasterParticleUpdate",{defines:Wt.defines}).draw($e,Je.TRIANGLES,io.disabled,Eo.disabled,Ho.unblended,bo.disabled,Tn,Ve.id,$e.viewportBuffer,$e.quadTriangleIndexBuffer,$e.viewportSegments)}}(C,V,we,Pe)}(f,r,l,p),f.renderPass==="translucent"&&(function(C,O,V,G,j){const Y=C.context,Q=Y.gl,ie=O.getSource().tileSize,ve=5*(1-o.a7(o.bV,o.bV+1,C.transform.zoom))*ie+V.paint.get("raster-particle-elevation"),me=!C.options.moving,we=C.transform.projection.name==="globe";if(!G.length)return;const[be,Pe]=C.stencilConfigForOverlap(G),$e=[];we&&$e.push("PROJECTION_GLOBE_VIEW");const Ve=C.stencilModeFor3D();for(const We of Pe){const Xe=We.toUnwrapped(),Ke=O.getTile(We);if(!Ke.rasterParticleState)continue;const Je=Ke.rasterParticleState,rt=100;Ke.registerFadeDuration(rt);const ht=O.findLoadedParent(We,0),lt=uf(Ke,ht,O,C.transform,rt);let st,Lt;C.terrain&&C.terrain.prepareDrawTile(),Y.activeTexture.set(Q.TEXTURE0),Je.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Y.activeTexture.set(Q.TEXTURE1),ht&&ht.rasterParticleState?(ht.rasterParticleState.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),st=Math.pow(2,ht.tileID.overscaledZ-Ke.tileID.overscaledZ),Lt=[Ke.tileID.canonical.x*st%1,Ke.tileID.canonical.y*st%1]):Je.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Wt=we?Float32Array.from(C.transform.expandedFarZProjMatrix):C.transform.calculateProjMatrix(Xe,me),ln=C.transform,yn=k1(ln),Tn=o.cz(We.canonical),wt=o.cA(Tn.getCenter().lat);let on,Vt,rn,hn,nn;we?(on=Float32Array.from(o.b6(o.cC(We.canonical))),Vt=Float32Array.from(ln.globeMatrix),rn=Float32Array.from(o.cy(ln)),hn=[o.am(ln.center.lng),o.at(ln.center.lat)],nn=Float32Array.from(o.cB(We.canonical,Tn,wt,ln.worldSize/ln._pixelsPerMercatorPixel))):(on=new Float32Array(16),Vt=new Float32Array(9),rn=new Float32Array(16),hn=[0,0],nn=new Float32Array(9));const An=pf(Wt,on,Vt,rn,nn,Lt||[0,0],o.a9(C.transform.zoom),hn,yn,st||1,lt,ve),Zn=C.isTileAffectedByFog(We),to=C.getOrCreateProgram("rasterParticle",{defines:$e,overrideFog:Zn});if(C.uploadCommonUniforms(Y,to,Xe),we){const Hn=new io(Q.LEQUAL,io.ReadOnly,C.depthRangeFor3D),oo=0,Rn=C.globeSharedBuffers;if(Rn){const[ho,Io,Go]=Rn.getGridBuffers(wt,oo!==0);to.draw(C,Q.TRIANGLES,Hn,Ve,Ho.alphaBlended,C.renderElevatedRasterBackface?bo.frontCCW:bo.backCCW,An,V.id,ho,Io,Go)}}else{const Hn=C.depthModeForSublayer(0,io.ReadOnly),oo=be[We.overscaledZ],{tileBoundsBuffer:Rn,tileBoundsIndexBuffer:ho,tileBoundsSegments:Io}=C.getTileBoundsBuffers(Ke);to.draw(C,Q.TRIANGLES,Hn,oo,Ho.alphaBlended,bo.disabled,An,V.id,Rn,ho,Io)}}C.resetStencilClippingMasks()}(f,r,l,p),f.style.map.triggerRepaint())},background:function(f,r,l,p){const b=l.paint.get("background-color"),w=l.paint.get("background-opacity"),C=l.paint.get("background-emissive-strength"),O=l.paint.get("background-pitch-alignment")==="viewport";if(w===0)return;const V=f.context,G=V.gl,j=f.transform,Y=j.tileSize,Q=l.paint.get("background-pattern");let ie;if(Q!==void 0&&(Q===null||(ie=f.imageManager.getPattern(Q.toString(),l.scope,f.style.getLut(l.scope)),!ie)))return;const ve=!Q&&b.a===1&&w===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==ve)return;const me=Eo.disabled,we=f.depthModeForSublayer(0,ve==="opaque"?io.ReadWrite:io.ReadOnly),be=f.colorModeForDrapableLayerRenderPass(C),Pe=Q?"backgroundPattern":"background";let $e,Ve=p;if(Ve||($e=f.getBackgroundTiles(),Ve=Object.values($e).map(We=>We.tileID)),Q&&(V.activeTexture.set(G.TEXTURE0),f.imageManager.bind(f.context,l.scope)),O){const We=f.getOrCreateProgram(Pe,{overrideFog:!1,overrideRtt:!0}),Xe=new Float32Array(o.a6.mat4.identity([])),Ke=new o.aA(0,0,0,0,0),Je=Q?Ad(Xe,C,w,f,0,l.scope,ie,O,{tileID:Ke,tileSize:Y}):hc(Xe,C,w,b.toRenderColor(l.lut));We.draw(f,G.TRIANGLES,we,me,be,bo.disabled,Je,l.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const We of Ve){const Xe=f.isTileAffectedByFog(We),Ke=f.getOrCreateProgram(Pe,{overrideFog:Xe}),Je=We.toUnwrapped(),rt=p?We.projMatrix:f.transform.calculateProjMatrix(Je);f.prepareDrawTile();const ht=r?r.getTile(We):$e?$e[We.key]:new wa(We,Y,j.zoom,f),lt=Q?Ad(rt,C,w,f,0,l.scope,ie,O,{tileID:We,tileSize:Y}):hc(rt,C,w,b.toRenderColor(l.lut));f.uploadCommonUniforms(V,Ke,Je);const{tileBoundsBuffer:st,tileBoundsIndexBuffer:Lt,tileBoundsSegments:Wt}=f.getTileBoundsBuffers(ht);Ke.draw(f,G.TRIANGLES,we,me,be,bo.disabled,lt,l.id,st,Lt,Wt)}},sky:function(f,r,l){const p=f._atmosphere?o.a9(f.transform.zoom):1,b=l.paint.get("sky-opacity")*p;if(b===0)return;const w=f.context,C=l.paint.get("sky-type"),O=new io(w.gl.LEQUAL,io.ReadOnly,[0,1]),V=f.frameCounter/1e3%1;C==="atmosphere"?f.renderPass==="offscreen"?l.needsSkyboxCapture(f)&&(function(G,j,Y,Q){const ie=G.context,ve=ie.gl;let me=j.skyboxFbo;if(!me){me=j.skyboxFbo=ie.createFramebuffer(32,32,!0,null),j.skyboxGeometry=new Ym(ie),j.skyboxTexture=ie.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,j.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let $e=0;$e<6;++$e)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}ie.bindFramebuffer.set(me.framebuffer),ie.viewport.set([0,0,32,32]);const we=j.getCenter(G,!0),be=G.getOrCreateProgram("skyboxCapture"),Pe=new Float64Array(16);o.a6.mat4.identity(Pe),o.a6.mat4.rotateY(Pe,Pe,.5*-Math.PI),sa(G,j,be,Pe,we,0),o.a6.mat4.identity(Pe),o.a6.mat4.rotateY(Pe,Pe,.5*Math.PI),sa(G,j,be,Pe,we,1),o.a6.mat4.identity(Pe),o.a6.mat4.rotateX(Pe,Pe,.5*-Math.PI),sa(G,j,be,Pe,we,2),o.a6.mat4.identity(Pe),o.a6.mat4.rotateX(Pe,Pe,.5*Math.PI),sa(G,j,be,Pe,we,3),o.a6.mat4.identity(Pe),sa(G,j,be,Pe,we,4),o.a6.mat4.identity(Pe),o.a6.mat4.rotateY(Pe,Pe,Math.PI),sa(G,j,be,Pe,we,5),ie.viewport.set([0,0,G.width,G.height])}(f,l),l.markSkyboxValid(f)):f.renderPass==="sky"&&function(G,j,Y,Q,ie){const ve=G.context,me=ve.gl,we=G.transform,be=G.getOrCreateProgram("skybox");ve.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_CUBE_MAP,j.skyboxTexture);const Pe=(($e,Ve,We,Xe,Ke)=>({u_matrix:$e,u_sun_direction:Ve,u_cubemap:0,u_opacity:Xe,u_temporal_offset:Ke}))(we.skyboxMatrix,j.getCenter(G,!1),0,Q,ie);G.uploadCommonUniforms(ve,be),be.draw(G,me.TRIANGLES,Y,Eo.disabled,G.colorModeForRenderPass(),bo.backCW,Pe,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,l,O,b,V):C==="gradient"&&f.renderPass==="sky"&&function(G,j,Y,Q,ie){const ve=G.context,me=ve.gl,we=G.transform,be=G.getOrCreateProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new Ym(ve)),ve.activeTexture.set(me.TEXTURE0);let Pe=j.colorRampTexture;Pe||(Pe=j.colorRampTexture=new o.T(ve,j.colorRamp,me.RGBA8)),Pe.bind(me.LINEAR,me.CLAMP_TO_EDGE);const $e=((Ve,We,Xe,Ke,Je)=>({u_matrix:Ve,u_color_ramp:0,u_center_direction:We,u_radius:o.bC(Xe),u_opacity:Ke,u_temporal_offset:Je}))(we.skyboxMatrix,j.getCenter(G,!1),j.paint.get("sky-gradient-radius"),Q,ie);G.uploadCommonUniforms(ve,be),be.draw(G,me.TRIANGLES,Y,Eo.disabled,G.colorModeForRenderPass(),bo.backCW,$e,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,l,O,b,V)},debug:function(f,r,l,p,b,w){for(let C=0;C<l.length;C++)if(b){const G=new o.bA(p.r*.8,p.g*.8,p.b*.8,1);zr(f,r,l[C],p,-1,-1,w),zr(f,r,l[C],p,-1,1,w),zr(f,r,l[C],p,1,1,w),zr(f,r,l[C],p,1,-1,w),zr(f,r,l[C],G,0,0,w)}else zr(f,r,l[C],p,0,0,w)},custom:function(f,r,l,p){const b=f.context,w=l.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&l.isDraped(r)){if(f.renderPass==="offscreen"){const C=w.prerender;if(C){if(f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const O=f.transform.pointMerc;C.call(w,b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[O.x,O.y],f.transform.pixelsPerMeterRatio)}else C.call(w,b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const O=w.renderToTile;if(O){const V=p[0].canonical,G=new o.a5(V.x+p[0].wrap*(1<<V.z),V.y,V.z);b.setDepthMode(io.disabled),b.setStencilMode(Eo.disabled),b.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),O.call(w,b.gl,G),b.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),b.setStencilMode(Eo.disabled);const C=w.renderingMode==="3d"?new io(f.context.gl.LEQUAL,io.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,io.ReadOnly);if(b.setDepthMode(C),f.transform.projection.name==="globe"){const O=f.transform.pointMerc;w.render(b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[O.x,O.y],f.transform.pixelsPerMeterRatio)}else w.render(b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState(),b.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,r,l,p){if(f.renderPass==="opaque")return;const b=l.paint.get("model-opacity");if(b===0)return;const w=l.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!w||f.terrain&&b<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof o.a4))return;const C=f.shadowRenderer,O=l.paint.get("model-receive-shadows");C&&(C.useNormalOffset=!0,O||(C.enabled=!1));const V=()=>{C&&(C.useNormalOffset=!0,O||(C.enabled=!0))},G=r.getSource();if(f.renderPass==="light-beam"&&G.type!=="batched-model")return;if(G.type==="vector"||G.type==="geojson")return function(be,Pe,$e,Ve,We){const Xe=be.transform;if(Xe.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${Xe.projection.name} projection is not yet implemented`);const Ke=Xe.getFreeCameraOptions().position;if(!be.modelManager)return;const Je=be.modelManager;$e.modelManager=Je;const rt=be.shadowRenderer;if(!$e._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ht=$e._unevaluatedLayout._values["model-id"],lt={...$e.layout.get("model-id").parameters},st=be.style.order.indexOf($e.fqid);for(const Lt of Ve){const Wt=Pe.getTile(Lt).getBucket($e);if(!Wt||Wt.projection.name!==Xe.projection.name)continue;const ln=Wt.getModelUris();ln&&!Wt.modelsRequested&&(Je.addModelsFromBucket(ln,We),Wt.modelsRequested=!0);const yn=Qi(Lt,Xe);lt.zoom=yn;const Tn=ht.possiblyEvaluate(lt);if(ny(be,Wt,Lt),Ta.shadowUniformsInitialized=!1,Ta.useSingleShadowCascade=!!rt&&rt.getMaxCascadeForTile(Lt.toUnwrapped())===0,be.renderPass==="shadow"&&rt){if(be.currentShadowCascade===1&&Wt.isInsideFirstShadowMapFrustum)continue;const Vt=Xe.calculatePosMatrix(Lt.toUnwrapped(),Xe.worldSize);if(Ta.tileMatrix.set(Vt),Ta.shadowTileMatrix=Float32Array.from(rt.calculateShadowPassMatrixFromMatrix(Vt)),Ta.aabb.min.fill(0),Ta.aabb.max[0]=Ta.aabb.max[1]=o.ab,Ta.aabb.max[2]=0,Br(Wt,Ta,be,$e.scope))continue}const wt=1<<Lt.canonical.z,on=[((Ke.x-Lt.wrap)*wt-Lt.canonical.x)*o.ab,(Ke.y*wt-Lt.canonical.y)*o.ab,Ke.z*wt*o.ab];be.conflationActive&&Object.keys(Wt.instancesPerModel).length>0&&be.style.isLayerClipped($e,Pe.getSource())&&Wt.updateReplacement(Lt,be.replacementSource,st,We)&&(Wt.uploaded=!1,Wt.upload(be.context));for(let Vt in Wt.instancesPerModel){const rn=Wt.instancesPerModel[Vt];rn.features.length>0&&(Vt=Tn.evaluate(rn.features[0].feature,{}));const hn=Je.getModel(Vt,We);if(hn&&hn.uploaded)for(const nn of hn.nodes)oy(be,$e,nn,rn,on,Lt,Ta)}}}(f,r,l,p,G.type==="vector"?l.scope:""),void V();if(!G.loaded())return;if(G.type==="batched-model")return function(be,Pe,$e,Ve){$e.resetLayerRenderingStats(be);const We=be.context,Xe=be.transform,Ke=be.style.fog,Je=be.shadowRenderer;if(Xe.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${Xe.projection.name} projection is not yet implemented`);const rt=be.transform.getFreeCameraOptions().position,ht=o.a6.vec3.scale([],[rt.x,rt.y,rt.z],be.transform.worldSize),lt=o.a6.vec3.negate([],ht),st=o.a6.mat4.identity([]),Lt=o.de(Xe.center.lat,Xe.zoom),Wt=o.a6.mat4.fromScaling([],[1,1,1/Lt]);o.a6.mat4.translate(st,st,lt);const ln=$e.paint.get("model-opacity"),yn=new io(We.gl.LEQUAL,io.ReadWrite,be.depthRangeFor3D),Tn=new io(We.gl.LEQUAL,io.ReadOnly,be.depthRangeFor3D),wt=new o.ca([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),on=be.renderPass==="shadow",Vt=on&&Je?Je.getCurrentCascadeFrustum():Xe.getFrustum(Xe.scaleZoom(Xe.worldSize)),rn=$e.paint.get("model-front-cutoff"),hn=rn[2]<1,nn=Ga(be,$e.paint.get("model-cutoff-fade-range")),An=$e.getLayerRenderingStats();(function(Zn,to,Hn,oo){const Rn=Zn.terrain?Zn.terrain.exaggeration():0,ho=Zn.transform.zoom;for(const Io of oo){const Go=to.getTile(Io).getBucket(Hn);Go&&(Zn.conflationActive&&Go.updateReplacement(Io,Zn.replacementSource),Go.evaluateScale(Zn,Hn),Zn.terrain&&Rn>0&&Go.elevationUpdate(Zn.terrain,Rn,Io,Hn.source),Go.needsReEvaluation(Zn,ho,Hn)&&Go.evaluate(Hn))}})(be,Pe,$e,Ve),function(){let Zn,to,Hn;hn?(Zn=Ve.length-1,to=-1,Hn=-1):(Zn=0,to=Ve.length,Hn=1);const oo=new Float64Array(16),Rn=o.a6.vec3.create(),ho=new o.P(0,0);for(let Io=Zn;Io!==to;Io+=Hn){const Go=Ve[Io],Sr=Pe.getTile(Go).getBucket($e);if(!Sr||!Sr.uploaded)continue;let nr=!1;Je&&(nr=Je.getMaxCascadeForTile(Go.toUnwrapped())===0);const Dr=Xe.calculatePosMatrix(Go.toUnwrapped(),Xe.worldSize),ar=Sr.modelTraits;!on&&hn&&(o.a6.mat4.invert(oo,Dr),o.a6.vec3.transformMat4(Rn,ht,oo),ho.x=Rn[0],ho.y=Rn[1]);const Tr=[];for(const Vo of Sr.getNodesInfo()){if(Vo.hiddenByReplacement||!Vo.node.meshes)continue;const yr=Vo.node;let _r=0;be.terrain&&yr.elevation&&(_r=yr.elevation*be.terrain.exaggeration());const cr=(()=>{const ni=Vo.aabb;return wt.min=[...ni.min],wt.max=[...ni.max],wt.min[2]+=_r,wt.max[2]+=_r,o.a6.vec3.transformMat4(wt.min,wt.min,Dr),o.a6.vec3.transformMat4(wt.max,wt.max,Dr),wt})(),Nr=Vo.evaluatedScale;if(Nr[0]<=1&&Nr[1]<=1&&Nr[2]<=1&&cr.intersects(Vt)===0)continue;if(!on&&hn){const ni=.16666666666666666;Vo.cameraCollisionOpacity=ht[0]>cr.min[0]&&ht[0]<cr.max[0]&&ht[1]>cr.min[1]&&ht[1]<cr.max[1]&&ht[2]*Lt<cr.max[2]&&yr.footprint&&o.bv(ho,yr.footprint)?Math.max(Vo.cameraCollisionOpacity-ni,0):Math.min(1,Vo.cameraCollisionOpacity+ni)}const yi=[...Dr],As=yr.anchor?yr.anchor[0]:0,js=yr.anchor?yr.anchor[1]:0;o.a6.mat4.translate(yi,yi,[As*(Nr[0]-1),js*(Nr[1]-1),_r]),o.a6.vec3.exactEquals(Nr,o.dh)||o.a6.mat4.scale(yi,yi,Nr);const Si=o.a6.mat4.multiply([],yi,yr.matrix),Qo=o.a6.mat4.multiply([],Xe.expandedFarZProjMatrix,Si),Zo=o.a6.mat4.multiply([],Xe.expandedFarZProjMatrix,yi),lr=o.a6.vec4.transformMat4([],[As,js,_r,1],Qo)[2];yr.hidden=!1;let Mr=ln;on||(hn&&(Mr*=Vo.cameraCollisionOpacity,Mr*=ry(yi,Xe,Vo.aabb,rn)),Mr*=sr(nn,lr)),Mr!==0?Tr.push({nodeInfo:Vo,depth:lr,opacity:Mr,wvpForNode:Qo,wvpForTile:Zo,nodeModelMatrix:Si,tileModelMatrix:yi}):yr.hidden=!0}on||Tr.sort((Vo,yr)=>!hn||Vo.opacity===1&&yr.opacity===1?Vo.depth<yr.depth?-1:1:Vo.opacity===1?-1:yr.opacity===1?1:Vo.depth>yr.depth?-1:1);for(const Vo of Tr){const yr=Vo.nodeInfo,_r=yr.node;let cr=o.a6.mat4.multiply([],Wt,Vo.tileModelMatrix);o.a6.mat4.multiply(cr,st,cr);const Nr=o.a6.mat4.invert([],cr);o.a6.mat4.transpose(Nr,Nr),o.a6.mat4.scale(Nr,Nr,Ld),cr=o.a6.mat4.multiply(cr,cr,_r.matrix);const yi=be.renderPass==="light-beam",As=ar&o.dj.HasMapboxMeshFeatures,js=As?0:yr.evaluatedRMEA[0][2];for(let Si=0;Si<_r.meshes.length;++Si){const Qo=_r.meshes[Si],Zo=Si===_r.lightMeshIndex;let lr=Vo.wvpForNode;if(Zo){if(!yi&&!be.terrain&&be.shadowRenderer){be.currentLayer<be.firstLightBeamLayer&&(be.firstLightBeamLayer=be.currentLayer);continue}lr=Vo.wvpForTile}else if(yi)continue;const Mr={defines:[]},ni=[];if(!on&&Je&&(Je.useNormalOffset=!!Qo.normalBuffer),xf(Mr.defines,ni,Qo,be,$e.lut),As||Mr.defines.push("DIFFUSE_SHADED"),nr&&Mr.defines.push("SHADOWS_SINGLE_CASCADE"),An&&(on?An.numRenderedVerticesInShadowPass+=Qo.vertexArray.length:An.numRenderedVerticesInTransparentPass+=Qo.vertexArray.length),on){wf(Qo,Vo.nodeModelMatrix,be,$e);continue}let $r=null;if(Ke){const la=Jm(Vo.nodeModelMatrix,be.transform);if($r=new Float32Array(la),Xe.projection.name!=="globe"){const hs=Qo.aabb.min,tl=Qo.aabb.max,[Gs,hr]=Ke.getOpacityForBounds(la,hs[0],hs[1],tl[0],tl[1]);Mr.overrideFog=Gs>=pt||hr>=pt}}const Ei=Qo.material;let Ma;Ei.occlusionTexture&&Ei.occlusionTexture.offsetScale&&(Ma=Ei.occlusionTexture.offsetScale,Mr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const us=be.getOrCreateProgram("model",Mr);!on&&Je&&Je.setupShadowsFromMatrix(Vo.tileModelMatrix,us,Je.useNormalOffset),be.uploadCommonUniforms(We,us,null,$r);const ds=Ei.pbrMetallicRoughness;ds.metallicFactor=.9,ds.roughnessFactor=.5;const Hs=gf(new Float32Array(lr),new Float32Array(cr),new Float32Array(Nr),new Float32Array(_r.matrix),be,Vo.opacity,ds.baseColorFactor.toRenderColor(null),Ei.emissiveFactor,ds.metallicFactor,ds.roughnessFactor,Ei,js,$e,[0,0,0],Ma);!Zo&&(yr.hasTranslucentParts||Vo.opacity<1)&&us.draw(be,We.gl.TRIANGLES,yn,Eo.disabled,Ho.disabled,bo.backCCW,Hs,$e.id,Qo.vertexBuffer,Qo.indexBuffer,Qo.segments,$e.paint,be.transform.zoom,void 0,ni),us.draw(be,We.gl.TRIANGLES,Zo?Tn:yn,Eo.disabled,Zo||Vo.opacity<1||yr.hasTranslucentParts?Ho.alphaBlended:Ho.unblended,bo.backCCW,Hs,$e.id,Qo.vertexBuffer,Qo.indexBuffer,Qo.segments,$e.paint,be.transform.zoom,void 0,ni)}}}}()}(f,r,l,p),void V();if(G.type!=="model")return;const j=G.getModels(),Y=[],Q=f.transform.getFreeCameraOptions().position,ie=o.a6.vec3.scale([],[Q.x,Q.y,Q.z],f.transform.worldSize);o.a6.vec3.negate(ie,ie);const ve=[],me=[];let we=0;for(const be of j){const Pe=l.paint.get("model-rotation").constantOr(null),$e=l.paint.get("model-scale").constantOr(null),Ve=l.paint.get("model-translation").constantOr(null);be.computeModelMatrix(f,Pe,$e,Ve,!0,!0,!1);const We=o.a6.mat4.identity([]),Xe=o.de(be.position.lat,f.transform.zoom),Ke=o.a6.mat4.fromScaling([],[1,1,1/Xe]);o.a6.mat4.translate(We,We,ie),Y.push({zScaleMatrix:Ke,negCameraPosMatrix:We});for(const Je of be.nodes)Dd(f.transform,Je,be.matrix,f.transform.expandedFarZProjMatrix,we,ve,me);we++}if(ve.sort((be,Pe)=>Pe.depth-be.depth),f.renderPass!=="shadow"){if(b===1)for(const be of me)mc(be,f,l,Y[be.modelIndex],Eo.disabled,f.colorModeForRenderPass());else{for(const be of me)mc(be,f,l,Y[be.modelIndex],Eo.disabled,Ho.disabled);for(const be of me)mc(be,f,l,Y[be.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const be of ve)mc(be,f,l,Y[be.modelIndex],Eo.disabled,f.colorModeForRenderPass());V()}else{for(const be of me)wf(be.mesh,be.nodeModelMatrix,f,l);for(const be of ve)wf(be.mesh,be.nodeModelMatrix,f,l);V()}}},Za={model:function(f,r,l){const p=r.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,p.type==="vector"?f.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const b=p.getModels();for(const w of b)w.upload(l.context)},raster:function(f,r,l){const p=r.getSource();if(!(p instanceof ba&&p.loaded()))return;const b=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!b)return;const w=f.paint.get("raster-array-band")||p.getInitialBand(b);if(w==null)return;const C=r.getIds().map(O=>r.getTileByID(O));for(const O of C)O.updateNeeded(b,w)&&p.prepareTile(O,b,w)},"raster-particle":function(f,r,l){const p=r.getSource();if(!(p instanceof ba&&p.loaded()))return;const b=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!b)return;const w=f.paint.get("raster-particle-array-band")||p.getInitialBand(b);if(w==null)return;const C=r.getIds().map(O=>r.getTileByID(O));for(const O of C)O.updateNeeded(b,w)&&p.prepareTile(O,b,w)}};class Dl{constructor(r,l,p,b,w){this.context=new I1(r,l),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=o.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const C=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const V of C)this._debugParams.enabledLayers[V]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const V of C)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],V);this.occlusionParams=new hu(w),this.setup(),this.numSublayers=ss.maxUnderzooming+ss.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new x_(this),this._wireframeDebugCache=new Sf,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const O=new o.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,O,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=b}updateTerrain(r,l){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new km(this,r));const b=this._terrain;this.transform.elevation=p?b:null,b.update(r,this.transform,l),this.transform.elevation&&!b.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,b]=l.getFovAdjustedRange(this.transform._fov);if(p>b)return void(this.transform.fogCullDistSq=null);const w=p+.78*(b-p);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new km(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*o.q.devicePixelRatio,this.height=l*o.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const r=this.context,l=new o.a$;l.emplaceBack(0,0),l.emplaceBack(o.ab,0),l.emplaceBack(0,o.ab),l.emplaceBack(o.ab,o.ab),this.tileExtentBuffer=r.createVertexBuffer(l,o.b1.members),this.tileExtentSegments=o.b2.simpleSegment(0,0,4,2);const p=new o.a$;p.emplaceBack(0,0),p.emplaceBack(o.ab,0),p.emplaceBack(0,o.ab),p.emplaceBack(o.ab,o.ab),this.debugBuffer=r.createVertexBuffer(p,o.b1.members),this.debugSegments=o.b2.simpleSegment(0,0,4,5);const b=new o.a$;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(b,o.b1.members),this.viewportSegments=o.b2.simpleSegment(0,0,4,2);const w=new o.aO;w.emplaceBack(0,0,0,0),w.emplaceBack(o.ab,0,o.ab,0),w.emplaceBack(0,o.ab,0,o.ab),w.emplaceBack(o.ab,o.ab,o.ab,o.ab),this.mercatorBoundsBuffer=r.createVertexBuffer(w,o.b4.members),this.mercatorBoundsSegments=o.b2.simpleSegment(0,0,4,2);const C=new o.aP;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(C);const O=new o.b0;for(const G of[0,1,3,2,0])O.emplaceBack(G);this.debugIndexBuffer=r.createIndexBuffer(O),this.emptyTexture=new o.T(r,new o.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=o.a6.mat4.create();const V=this.context.gl;this.stencilClearMode=new Eo({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,io.disabled,this.stencilClearMode,Ho.disabled,bo.disabled,Ed(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,p){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const V of p)if(this._tileClippingMaskIDs[V.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=l.id;const b=this.context,w=b.gl;this.nextStencilID+p.length>256&&this.clearStencil(),b.setColorMode(Ho.disabled),b.setDepthMode(io.disabled);const C=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of p){const V=l.getTile(O),G=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:Y,tileBoundsSegments:Q}=this.getTileBoundsBuffers(V);C.draw(this,w.TRIANGLES,io.disabled,new Eo({func:w.ALWAYS,mask:0},G,255,w.KEEP,w.KEEP,w.REPLACE),Ho.disabled,bo.disabled,Ed(O.projMatrix),"$clipping",j,Y,Q)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Eo({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Eo({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,p=r.sort((C,O)=>O.overscaledZ-C.overscaledZ),b=p[p.length-1].overscaledZ,w=p[0].overscaledZ-b+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const C={};for(let O=0;O<w;O++)C[O+b]=new Eo({func:l.GEQUAL,mask:255},O+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[C,p]}return[{[b]:Eo.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Ho([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new o.bA(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ho.unblended:Ho.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Ho([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new o.bA(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,p,b=!1){if(this.depthOcclusion)return new io(this.context.gl.GREATER,io.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!b)return io.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new io(p||this.context.gl.LEQUAL,l,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),p=Math.ceil(this.height),b=this.context.bindFramebuffer.get(),w=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&p!==0&&(this.depthFBO=new K_(this.context,l,p,!1,"texture"),this.depthTexture=new o.T(this.context,{width:l,height:p,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(b),r.bindTexture(r.TEXTURE_2D,w),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,p,0,0,l,p,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const p=o.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const b=this.style._mergedLayers,w=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(lt=>{const st=b[lt];return!(st.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[st.type]});let C=!1,O=!1;for(const lt of w){const st=b[lt];st.type==="circle"&&(C=!0),st.type==="symbol"&&(st.hasInitialOcclusionOpacityProperties?O=!0:C=!0)}const V=w.map(lt=>b[lt]),G=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.q.now()),this.imageManager.beginFrame();let j=0,Y=!1;for(const lt in G){const st=G[lt];st.used&&(st.prepare(this.context),st.getSource().usedInConflation&&++j)}let Q=!1;for(const lt of V)lt.isHidden(this.transform.zoom)||(lt.type==="clip"&&(Q=!0),this.prepareLayer(lt));const ie={},ve={},me={},we={},be={};for(const lt in G){const st=G[lt];ie[lt]=st.getVisibleCoordinates(),ve[lt]=ie[lt].slice().reverse(),me[lt]=st.getVisibleCoordinates(!0).reverse(),we[lt]=st.getShadowCasterCoordinates(),be[lt]=st.sortCoordinatesByDistance(ie[lt])}const Pe=lt=>{const st=this.style.getLayerSourceCache(lt);return st&&st.used?st.getSource():null};if(j||Q||this._clippingActiveLastFrame){const lt=[],st=[];let Lt=0;for(const Wt of V)this.isSourceForClippingOrConflation(Wt,Pe(Wt))&&(lt.push(Wt),st.push(Lt)),Lt++;if(lt&&(Q||lt.length>1)||this._clippingActiveLastFrame){Q=!1;const Wt=[];for(let ln=0;ln<lt.length;ln++){const yn=lt[ln],Tn=st[ln],wt=this.style.getLayerSourceCache(yn);if(!wt||!wt.used||!wt.getSource().usedInConflation&&yn.type!=="clip")continue;let on=o.dn,Vt=o.bt.None;const rn=[];let hn=!0;if(yn.type==="clip"){on=Tn;for(const nn of yn.layout.get("clip-layer-types"))Vt|=nn==="model"?o.bt.Model:nn==="symbol"?o.bt.Symbol:o.bt.FillExtrusion;for(const nn of yn.layout.get("clip-layer-scope"))rn.push(nn);yn.isHidden(this.transform.zoom)?hn=!1:Q=!0}hn&&Wt.push({layer:yn.fqid,cache:wt,order:on,clipMask:Vt,clipScope:rn})}this.replacementSource.setSources(Wt),Y=!0}}this._clippingActiveLastFrame=Q,Y||this.replacementSource.clear(),this.conflationActive=Y,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let lt=0;lt<V.length;lt++){const st=V[lt],Lt=st.cutoffRange();if(this.longestCutoffRange=Math.max(Lt,this.longestCutoffRange),Lt>0){const Wt=Pe(st);Wt&&(this.minCutoffZoom=Math.max(Wt.minzoom,this.minCutoffZoom)),st.minzoom&&(this.minCutoffZoom=Math.max(st.minzoom,this.minCutoffZoom))}st.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=lt),this._lastOcclusionLayer=lt)}const $e=this.style&&this.style.fog;$e?(this._fogVisible=$e.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=$e.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(me),this.opaquePassCutoff=0);const Ve=this._shadowRenderer;if(Ve){Ve.updateShadowParameters(this.transform,this.style.directionalLight);for(const lt in G)for(const st of ie[lt]){let Lt={min:0,max:0};this.terrain&&(Lt=this.terrain.getMinMaxForTile(st)||Lt),Ve.addShadowReceiver(st.toUnwrapped(),Lt.min,Lt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Xm(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!an.has(this.context.gl))return;this.renderPass="offscreen";for(const lt of V){const st=r.getLayerSourceCache(lt);if(!lt.hasOffscreenPass()||lt.isHidden(this.transform.zoom))continue;const Lt=st?ve[st.id]:void 0;(lt.type==="custom"||lt.type==="raster"||lt.type==="raster-particle"||lt.isSky()||Lt&&Lt.length)&&this.renderLayer(this,st,lt,Lt)}this.depthRangeFor3D=[0,1-(V.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,we)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const We=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Xe=(()=>{if(l.showOverdrawInspector)return o.bA.black;const lt=this.style.fog;if(lt&&this.transform.projection.supportsFog){const st=this.style.getLut(lt.scope);if(!We){const Lt=lt.properties.get("color").toRenderColor(st).toArray01();return new o.bA(...Lt)}if(We){const Lt=lt.properties.get("space-color").toRenderColor(st).toArray01();return new o.bA(...Lt)}}return o.bA.transparent})();if(this.context.clear({color:Xe,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const lt=V[this.currentLayer],st=r.getLayerSourceCache(lt);if(lt.isSky())continue;const Lt=st?(lt.is3D()?be:ve)[st.id]:void 0;this._renderTileClippingMasks(lt,st,Lt),this.renderLayer(this,st,lt,Lt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const lt=V[this.currentLayer],st=r.getLayerSourceCache(lt);lt.isSky()&&this.renderLayer(this,st,lt,st?ve[st.id]:void 0)}function Ke(lt,st){let Lt;return st&&(Lt=(lt.type==="symbol"?me:lt.is3D()?be:ve)[st.id]),Lt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<w.length;){const lt=V[this.currentLayer];if(lt.type==="raster"||lt.type==="raster-particle"){const st=r.getLayerSourceCache(lt);this.renderLayer(this,st,lt,Ke(lt,st))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Je=0;Ve&&(Je=Ve.getShadowCastingLayerCount());let rt=!1,ht=-1;for(let lt=0;lt<w.length;++lt){const st=V[lt];st.isHidden(this.transform.zoom)||st.is3D()&&(ht=lt)}for(O&&ht===-1&&(C=!0);this.currentLayer<w.length;){const lt=V[this.currentLayer],st=r.getLayerSourceCache(lt);if(lt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(lt)){if(lt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(C&&!rt&&this.terrain&&!this.transform.isOrthographic&&(rt=!0,this.blitDepth()),O&&ht!==-1&&this.currentLayer===ht+1&&!this.transform.isOrthographic&&this.blitDepth(),lt.is3D()||this.terrain||this._renderTileClippingMasks(lt,st,st?ie[st.id]:void 0),this.renderLayer(this,st,lt,Ke(lt,st)),!this.terrain&&Ve&&Je>0&&lt.hasShadowPass()&&--Je==0&&(Ve.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Lt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Lt;this.currentLayer++){const Wt=V[this.currentLayer];if(!Wt.hasLightBeamPass())continue;const ln=r.getLayerSourceCache(Wt);this.renderLayer(this,ln,Wt,ln?ve[ln.id]:void 0)}this.currentLayer=Lt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Lt=this.currentLayer;this.depthOcclusion=!0;for(const Wt of this.layersWithOcclusionOpacity){this.currentLayer=Wt;const ln=V[this.currentLayer],yn=r.getLayerSourceCache(ln),Tn=yn?ve[yn.id]:void 0;ln.is3D()||this.terrain||this._renderTileClippingMasks(ln,yn,yn?ie[yn.id]:void 0),this.renderLayer(this,yn,ln,Tn)}this.depthOcclusion=!1,this.currentLayer=Lt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let lt=null;V.forEach(st=>{const Lt=r.getLayerSourceCache(st);Lt&&!st.isHidden(this.transform.zoom)&&Lt.getVisibleCoordinates().length&&(!lt||lt.getSource().maxzoom<Lt.getSource().maxzoom)&&(lt=Lt)}),lt&&this.options.showTileBoundaries&&Od.debug(this,lt,lt.getVisibleCoordinates(),o.bA.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Od.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.bA(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(lt){const st=lt.transform.padding;It(lt,lt.transform.height-(st.top||0),3,cu),It(lt,st.bottom||0,3,uu),Km(lt,st.left||0,3,wn),Km(lt,lt.transform.width-(st.right||0),3,Qn);const Lt=lt.transform.centerPoint;(function(Wt,ln,yn,Tn){pc(Wt,ln-1,yn-10,2,20,Tn),pc(Wt,ln-10,yn-1,20,2,Tn)})(lt,Lt.x,lt.transform.height-Lt.y,du)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),Y||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,p=!l||!l.includes(r.type);if(Za[r.type]&&(p||this.terrain&&r.type==="custom")){const b=this.style.getLayerSourceCache(r);Za[r.type](r,b,this)}this.gpuTimingEnd()}renderLayer(r,l,p,b){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||b&&b.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)&&(!r.terrain||p.type!=="custom")||p.type==="clip"||Od[p.type](r,l,p,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,p=this.context.gl;let b=this.gpuTimers[r.id];b||(b=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:p.createQuery()}),b.calls++,p.beginQuery(l.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,p=l.createQuery();this.deferredRenderGpuTimeQueries.push(p),l.beginQuery(r.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const p in r){const b=r[p],w=this.context.extTimerQuery,C=w.getQueryParameter(b.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(b.query),l[p]=C}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let p=0;for(const b of r)p+=l.getQueryParameter(b,l.QUERY_RESULT)/1e6,l.deleteQuery(b);return p}translatePosMatrix(r,l,p,b,w){if(!p[0]&&!p[1])return r;const C=w?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(C){const G=Math.sin(C),j=Math.cos(C);p=[p[0]*j-p[1]*G,p[0]*G+p[1]*j]}const O=[w?p[0]:o.ak(l,p[0],this.transform.zoom),w?p[1]:o.ak(l,p[1],this.transform.zoom),0],V=new Float32Array(16);return o.a6.mat4.translate(V,r,O),V}saveTileTexture(r){const l=r.size[0],p=this._tileTextures[l];p?p.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,p){const b=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,w=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):b||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||b||l!==void 0&&!l||w.push("FOG","FOG_DITHERING"),b&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(r,l){this.cache=this.cache||{};const p=l&&l.defines||[],b=l&&l.config,w=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(p),C=qa.cacheKey(kl[r],r,w,b);return this.cache[C]||(this.cache[C]=new qa(this.context,r,kl[r],b,fc[r],w)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const p=this.style.directionalLight,b=this.style.ambientLight;if(p&&b){const w=((C,O,V)=>{const G=C.properties.get("direction"),j=C.properties.get("color").toRenderColor(V.getLut(C.scope)).toArray01(),Y=C.properties.get("intensity"),Q=O.properties.get("color").toRenderColor(V.getLut(O.scope)).toArray01(),ie=O.properties.get("intensity"),ve=[G.x,G.y,G.z],me=o.cH(Q,ie),we=o.cH(j,Y);return{u_lighting_ambient_color:me,u_lighting_directional_dir:ve,u_lighting_directional_color:we,u_ground_radiance:Pm(ve,we,me)}})(p,b,this.style);l.setLightsUniformValues(r,w)}}}uploadCommonUniforms(r,l,p,b,w){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const O=C.getOpacity(this.transform.pitch),V=((G,j,Y,Q,ie,ve,me,we,be,Pe,$e,Ve)=>{const We=G.transform,Xe=j.properties.get("color").toRenderColor(G.style.getLut(j.scope)).toArray01();Xe[3]=Q;const Ke=G.frameCounter/1e3%1,[Je,rt]=j.properties.get("vertical-range");return{u_fog_matrix:Y?We.calculateFogTileMatrix(Y):Ve||G.identityMat,u_fog_range:j.getFovAdjustedRange(We._fov),u_fog_color:Xe,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Je,rt),rt],u_fog_temporal_offset:Ke,u_frustum_tl:ie,u_frustum_tr:ve,u_frustum_br:me,u_frustum_bl:we,u_globe_pos:be,u_globe_radius:Pe,u_viewport:$e,u_globe_transition:o.a9(We.zoom),u_is_globe:+(We.projection.name==="globe")}})(this,C,p,O,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.q.devicePixelRatio,this.transform.height*o.q.devicePixelRatio],b);l.setFogUniformValues(r,V)}w&&l.setCutoffUniformValues(r,w.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const b of p)l[b.key]=r[b.key]||new wa(b,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=pt||l[1]>=pt}setupDepthForOcclusion(r,l,p){const b=this.context,w=b.gl,C=!!p;var O;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),b.activeTexture.set(w.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((O=this.depthRangeFor3D)[1]-O[0]),-1-2*O[0]/(O[1]-O[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),b.activeTexture.set(w.TEXTURE0),C||l.setTerrainUniformValues(b,p)}}function Ya(f,r){let l=!1,p=null;const b=()=>{p=null,l&&(f(),p=setTimeout(b,r),l=!1)};return()=>(l=!0,p||b(),p)}class Tf{constructor(r){this._hashName=r&&encodeURIComponent(r),o.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ya(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=zd(r);if(this._hashName){const p=this._hashName;let b=!1;const w=location.hash.slice(1).split("&").map(C=>{const O=C.split("=")[0];return O===p?(b=!0,`${O}=${l}`):C}).filter(C=>C);return b||w.push(`${p}=${l}`),`#${w.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function zd(f,r){const l=f.getCenter(),p=Math.round(100*f.getZoom())/100,b=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,b),C=Math.round(l.lng*w)/w,O=Math.round(l.lat*w)/w,V=f.getBearing(),G=f.getPitch();let j=r?`/${C}/${O}/${p}`:`${p}/${O}/${C}`;return(V||G)&&(j+="/"+Math.round(10*V)/10),G&&(j+=`/${Math.round(G)}`),j}const fu={linearity:.3,easing:o.dp(0,0,.3,1)},eg=o.l({deceleration:2500,maxSpeed:1400},fu),tg=o.l({deceleration:20,maxSpeed:1400},fu),Ll=o.l({deceleration:1e3,maxSpeed:360},fu),ng=o.l({deceleration:1e3,maxSpeed:90},fu);class Cf{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=o.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(l.pan.mag()){const w=mu(l.pan.mag(),p,o.l({},eg,r||{}));b.offset=l.pan.mult(w.amount/l.pan.mag()),b.center=this._map.transform.center,pu(b,w)}if(l.zoom){const w=mu(l.zoom,p,tg);b.zoom=this._map.transform.zoom+w.amount,pu(b,w)}if(l.bearing){const w=mu(l.bearing,p,Ll);b.bearing=this._map.transform.bearing+o.ap(w.amount,-179,179),pu(b,w)}if(l.pitch){const w=mu(l.pitch,p,ng);b.pitch=this._map.transform.pitch+w.amount,pu(b,w)}if(b.zoom||b.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;b.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function pu(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function mu(f,r,l){const{maxSpeed:p,linearity:b,deceleration:w}=l,C=o.ap(f*b/(r/1e3),-p,p),O=Math.abs(C)/(w*b);return{easing:l.easing,duration:1e3*O,amount:C*(O/2)}}class Gr extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p,b={}){const w=fe(l.getCanvasContainer(),p),C=l.unproject(w);super(r,o.l({point:w,lngLat:C,originalEvent:p},b)),this._defaultPrevented=!1,this.target=l}}class gu extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){const b=r==="touchend"?p.changedTouches:p.touches,w=ge(l.getCanvasContainer(),b),C=w.map(V=>l.unproject(V)),O=w.reduce((V,G,j,Y)=>V.add(G.div(Y.length)),new o.P(0,0));super(r,{points:w,point:O,lngLats:C,lngLat:l.unproject(O),originalEvent:p}),this._defaultPrevented=!1}}class og extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class vu{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new og(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new Gr(r.type,this._map,r))}mouseup(r){this._map.fire(new Gr(r.type,this._map,r))}preclick(r){const l=o.l({},r);l.type="preclick",this._map.fire(new Gr(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Gr(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Gr(r.type,this._map,r))}mouseover(r){this._map.fire(new Gr(r.type,this._map,r))}mouseout(r){this._map.fire(new Gr(r.type,this._map,r))}touchstart(r){return this._firePreventable(new gu(r.type,this._map,r))}touchmove(r){this._map.fire(new gu(r.type,this._map,r))}touchend(r){this._map.fire(new gu(r.type,this._map,r))}touchcancel(r){this._map.fire(new gu(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gc{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Gr(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Gr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Gr(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class rg{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(q(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const p=l,b=this._startPos,w=this._lastPos;if(!b||!w||w.equals(p)||!this._box&&p.dist(b)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=F("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const C=Math.min(b.x,p.x),O=Math.max(b.x,p.x),V=Math.min(b.y,p.y),G=Math.max(b.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${V}px)`,this._box.style.width=O-C+"px",this._box.style.height=G-V+"px")})}mouseupWindow(r,l){if(!this._active)return;const p=this._startPos,b=l;if(p&&r.button===0){if(this.reset(),ae(),p.x!==b.x||p.y!==b.y)return this._map.fire(new o.x("boxzoomend",{originalEvent:r})),{cameraAnimation:w=>w.fitScreenCoordinates(p,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),J(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new o.x(r,{originalEvent:l}))}}function Ef(f,r){const l={};for(let p=0;p<f.length;p++)l[f[p].identifier]=r[p];return l}class iy{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(b){const w=new o.P(0,0);for(const C of b)w._add(C);return w.div(b.length)}(l),this.touches=Ef(p,l)))}touchmove(r,l,p){if(this.aborted||!this.centroid)return;const b=Ef(p,l);for(const w in this.touches){const C=b[w];(!C||C.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(r,l,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Bd{constructor(r){this.singleTap=new iy(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,p){this.singleTap.touchstart(r,l,p)}touchmove(r,l,p){this.singleTap.touchmove(r,l,p)}touchend(r,l,p){const b=this.singleTap.touchend(r,l,p);if(b){const w=r.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(b)<30;if(w&&C||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class ig{constructor(){this._zoomIn=new Bd({numTouches:1,numTaps:2}),this._zoomOut=new Bd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,p){this._zoomIn.touchstart(r,l,p),this._zoomOut.touchstart(r,l,p)}touchmove(r,l,p){this._zoomIn.touchmove(r,l,p),this._zoomOut.touchmove(r,l,p)}touchend(r,l,p){const b=this._zoomIn.touchend(r,l,p),w=this._zoomOut.touchend(r,l,p);return b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(b)},{originalEvent:r})}):w?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(w)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Fd={0:1,2:2};class Nd{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const p=ce(r);this._correctButton(r,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(r,l){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(b,w){const C=Fd[w];return b.buttons===void 0||(b.buttons&C)!==C}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}}mouseupWindow(r){this._lastPoint&&ce(r)===this._eventButton&&(this._moved&&ae(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mf extends Nd{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class If extends Nd{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=.8*(l.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Af extends Nd{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=-.5*(l.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class sy{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),o.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(r,l,p){return this._calculateTransform(r,l,p)}touchmove(r,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!o.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,p)}}touchend(r,l,p){this._calculateTransform(r,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,p){p.length>0&&(this._active=!0);const b=Ef(p,l),w=new o.P(0,0),C=new o.P(0,0);let O=0;for(const G in b){const j=b[G],Y=this._touches[G];Y&&(w._add(j),C._add(j.sub(Y)),O++,b[G]=j)}if(this._touches=b,O<this._minTouches||!C.mag())return;const V=C.div(O);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(O),panDelta:V}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class kf{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,p){return{}}touchstart(r,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,p){const b=this._firstTwoTouches;if(!b)return;r.preventDefault();const[w,C]=b,O=$d(p,l,w),V=$d(p,l,C);if(!O||!V)return;const G=this._aroundCenter?null:O.add(V).div(2);return this._move([O,V],G,r)}touchend(r,l,p){if(!this._firstTwoTouches)return;const[b,w]=this._firstTwoTouches,C=$d(p,l,b),O=$d(p,l,w);C&&O||(this._active&&ae(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function $d(f,r,l){for(let p=0;p<f.length;p++)if(f[p].identifier===l)return r[p]}function sg(f,r){return Math.log(f/r)/Math.LN2}class ay extends kf{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(sg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:sg(this._distance,p),pinchAround:l}}}function ag(f,r){return 180*f.angleWith(r)/Math.PI}class ly extends kf{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ag(this._vector,p),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const b=ag(r,p);return Math.abs(b)<l}}function Pf(f){return Math.abs(f.y)>Math.abs(f.x)}class cy extends kf{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Pf(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,p){const b=this._lastPoints;if(!b)return;const w=r[0].sub(b[0]),C=r[1].sub(b[1]);return this._map._cooperativeGestures&&!o.dq()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(w,C,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(w.y+C.y)/2*-.5})}gestureBeginsVertically(r,l,p){if(this._valid!==void 0)return this._valid;const b=r.mag()>=2,w=l.mag()>=2;if(!b&&!w)return;if(!b||!w)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const C=r.y>0==l.y>0;return Pf(r)&&Pf(l)&&C}}const uy={panStep:100,bearingStep:15,pitchStep:10};class dy{constructor(){const r=uy;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,p=0,b=0,w=0,C=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),w=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),w=1);break;case 38:r.shiftKey?b=1:(r.preventDefault(),C=-1);break;case 40:r.shiftKey?b=-1:(r.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(p=0,b=0),{cameraAnimation:O=>{const V=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:hy,zoom:l?Math.round(V)+l*(r.shiftKey?2:1):V,bearing:O.getBearing()+p*this._bearingStep,pitch:O.getPitch()+b*this._pitchStep,offset:[-w*this._panStep,-C*this._panStep],center:O.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function hy(f){return f*(2-f)}const lg=4.000244140625,D1=1/450;class L1{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=D1,o.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=o.q.now(),b=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%lg==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(b*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=fe(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const G=this._type==="wheel"&&Math.abs(this._delta)>lg?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*G)));this._delta<0&&j!==0&&(j=1/j);const Y=l(),Q=Math.pow(2,Y),ie=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(ie*j))),this._type==="wheel"&&(this._startZoom=Y,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l(),b=this._startZoom,w=this._easing;let C,O=!1;if(this._type==="wheel"&&b&&w){const G=Math.min((o.q.now()-this._lastWheelEventTime)/200,1),j=w(G);C=o.aa(b,p,j),G<1?this._frameId||(this._frameId=!0):O=!0}else C=p,O=!0;this._active=!0,O&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let V=C-l();return V*this._lastDelta<0&&(V=0),{noInertia:!0,needsRenderFrame:!O,zoomDelta:V,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=o.dr;if(this._prevEase){const p=this._prevEase,b=(o.q.now()-p.start)/p.duration,w=p.easing(b+.01)-p.easing(b),C=.27/Math.sqrt(w*w+1e-4)*.01,O=Math.sqrt(.0729-C*C);l=o.dp(C,O,.25,1)}return this._prevEase={start:o.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ti{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fy{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class O1{constructor(){this._tap=new Bd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,l,p))}touchmove(r,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const b=l[0],w=b.y-this._swipePoint.y;return this._swipePoint=b,r.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(r,l,p)}touchend(r,l,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,l,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class z1{constructor(r,l,p){this._el=r,this._mousePan=l,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vd{constructor(r,l,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class py{constructor(r,l,p,b){this._el=r,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _u=f=>f.zoom||f.drag||f.pitch||f.rotate;class Rf extends o.x{}class Xa{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const p=o.a6.vec3.sub([],l,r);this.radius=o.a6.vec3.length(p[2]<0?o.a6.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){o.a6.vec3.div(r,r,this.constants),o.a6.vec3.normalize(r,r),o.a6.vec3.mul(r,r,this.constants);const l=o.a6.vec3.scale([],r,this.radius);if(l[2]>0){const p=o.a6.vec3.scale([],[0,0,1],o.a6.vec3.dot(l,[0,0,1])),b=o.a6.vec3.scale([],o.a6.vec3.normalize([],[l[0],l[1],0]),this.radius),w=o.a6.vec3.add([],l,o.a6.vec3.scale([],o.a6.vec3.sub([],o.a6.vec3.add([],b,p),l),2));l[0]=w[0],l[1]=w[1]}return l}}function vc(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class wi{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Cf(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Xa,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),o.aJ(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,w,C]of this._listeners){const O=b===document?this.handleWindowEvent:this.handleEvent;b.addEventListener(w,O,C)}}destroy(){for(const[r,l,p]of this._listeners){const b=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,b,p)}}_addDefaultHandlers(r){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new vu(l,r));const b=l.boxZoom=new rg(l,r);this._add("boxZoom",b);const w=new ig,C=new fy;l.doubleClickZoom=new ti(C,w),this._add("tapZoom",w),this._add("clickZoom",C);const O=new O1;this._add("tapDragZoom",O);const V=l.touchPitch=new cy(l);this._add("touchPitch",V);const G=new If(r),j=new Af(r);l.dragRotate=new Vd(r,G,j),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const Y=new Mf(r),Q=new sy(l,r);l.dragPan=new z1(p,Y,Q),this._add("mousePan",Y),this._add("touchPan",Q,["touchZoom","touchRotate"]);const ie=new ly,ve=new ay;l.touchZoomRotate=new py(p,ve,ie,O),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),this._add("blockableMapEvent",new gc(l));const me=l.scrollZoom=new L1(l,this);this._add("scrollZoom",me,["mousePan"]);const we=l.keyboard=new dy;this._add("keyboard",we);for(const be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[be]&&l[be].enable(r[be])}_add(r,l,p){this._handlers.push({handlerName:r,handler:l,allowed:p}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_u(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,p){for(const b in r)if(b!==p&&(!l||l.indexOf(b)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const p of r)this._el.contains(p.target)&&l.push(p);return l}handleEvent(r,l){this._updatingCamera=!0;const p=r.type==="renderFrame",b=p?void 0:r,w={needsRenderFrame:!1},C={},O={},V=r.touches?this._getMapTouches(r.touches):void 0,G=V?ge(this._el,V):p?void 0:fe(this._el,r);for(const{handlerName:Q,handler:ie,allowed:ve}of this._handlers){if(!ie.isEnabled())continue;let me;this._blockedByActive(O,ve,Q)?ie.reset():ie[l||r.type]&&(me=ie[l||r.type](r,G,V),this.mergeHandlerResult(w,C,me,Q,b),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||ie.isActive())&&(O[Q]=ie)}const j={};for(const Q in this._previousActiveHandlers)O[Q]||(j[Q]=b);this._previousActiveHandlers=O,(Object.keys(j).length||vc(w))&&(this._changes.push([w,C,j]),this._triggerRenderFrame()),(Object.keys(O).length||vc(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=w;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))}mergeHandlerResult(r,l,p,b,w){if(!p)return;o.l(r,p);const C={handlerName:b,originalEvent:p.originalEvent||w};p.zoomDelta!==void 0&&(l.zoom=C),p.panDelta!==void 0&&(l.drag=C),p.pitchDelta!==void 0&&(l.pitch=C),p.bearingDelta!==void 0&&(l.rotate=C)}_applyChanges(){const r={},l={},p={};for(const[b,w,C]of this._changes)b.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(b.panDelta)),b.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(r.around=b.around),b.aroundCoord!==void 0&&(r.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(r.pinchAround=b.pinchAround),b.noInertia&&(r.noInertia=b.noInertia),o.l(l,w),o.l(p,C);this._updateMapTransform(r,l,p),this._changes=[]}_updateMapTransform(r,l,p){const b=this._map,w=b.transform,C=Pe=>[Pe.x,Pe.y,Pe.z];if((Pe=>{const $e=this._eventsInProgress.drag;return $e&&!this._handlersById[$e.handlerName].isActive()})()&&!vc(r)){const Pe=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),Pe!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&b._stop(!0),!vc(r))return void this._fireEvents(l,p,!0);let{panDelta:O,zoomDelta:V,bearingDelta:G,pitchDelta:j,around:Y,aroundCoord:Q,pinchAround:ie}=r;w._isCameraConstrained&&(V>0&&(V=0),w._isCameraConstrained=!1),ie!==void 0&&(Y=ie),(V||(Pe=>l[Pe]&&!this._eventsInProgress[Pe])("drag"))&&Y&&(this._dragOrigin=C(w.pointCoordinate3D(Y)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",b._stop(!0),Y=Y||b.transform.centerPoint,G&&(w.bearing+=G),j&&(w.pitch+=j),w._updateCameraState();const ve=[0,0,0];if(O)if(w.projection.name==="mercator"){const Pe=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(Y).dir),$e=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(Y.sub(O)).dir);ve[0]=$e[0]-Pe[0],ve[1]=$e[1]-Pe[1]}else{const Pe=w.pointCoordinate(Y);if(w.projection.name==="globe"){O=O.rotate(-w.angle);const $e=w._pixelsPerMercatorPixel/w.worldSize;ve[0]=-O.x*o.ds(o.aN(Pe.y))*$e,ve[1]=-O.y*o.ds(w.center.lat)*$e}else{const $e=w.pointCoordinate(Y.sub(O));Pe&&$e&&(ve[0]=$e.x-Pe.x,ve[1]=$e.y-Pe.y)}}const me=w.zoom,we=[0,0,0];if(V){const Pe=C(Q||w.pointCoordinate3D(Y)),$e={dir:o.a6.vec3.normalize([],o.a6.vec3.sub([],Pe,w._camera.position))};if($e.dir[2]<0){const Ve=w.zoomDeltaToMovement(Pe,V);o.a6.vec3.scale(we,$e.dir,Ve)}}const be=o.a6.vec3.add(ve,ve,we);w._translateCameraConstrained(be),V&&Math.abs(w.zoom-me)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,p,!0)}_fireEvents(r,l,p){const b=_u(this._eventsInProgress),w=_u(r),C={};for(const j in r){const{originalEvent:Y}=r[j];this._eventsInProgress[j]||(C[`${j}start`]=Y),this._eventsInProgress[j]=r[j]}!b&&w&&this._fireEvent("movestart",w.originalEvent);for(const j in C)this._fireEvent(j,C[j]);w&&this._fireEvent("move",w.originalEvent);for(const j in r){const{originalEvent:Y}=r[j];this._fireEvent(j,Y)}const O={};let V;for(const j in this._eventsInProgress){const{handlerName:Y,originalEvent:Q}=this._eventsInProgress[j];this._handlersById[Y].isActive()||(delete this._eventsInProgress[j],V=l[Y]||Q,O[`${j}end`]=V)}for(const j in O)this._fireEvent(j,O[j]);const G=_u(this._eventsInProgress);if(p&&(b||w)&&!G){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;j?(Y(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:V})):(this._map.fire(new o.x("moveend",{originalEvent:V})),Y(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new o.x(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Rf("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ca="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class cg extends o.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,o.aJ(["_renderFrameCallback"],this)}getCenter(){return new o.bL(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,p){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.l({offset:r},l),p)}panTo(r,l,p){return this.easeTo(o.l({center:r},l),p)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,p){return this.easeTo(o.l({zoom:r},l),p)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,p){return this.easeTo(o.l({bearing:r},l),p)}resetNorth(r,l){return this.rotateTo(0,o.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(o.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=o.as.convert(r);const p=l&&l.bearing||0,b=l&&l.pitch||0,w=r.getNorthWest(),C=r.getSouthEast();return this._cameraForBounds(this.transform,w,C,p,b,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?o.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:o.l({},l,r)}_extendCameraOptions(r){return(r=o.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const p=l.max[0]-l.min[0],b=l.max[1]-l.min[1];return p/b>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):b/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,p,b,w,C){const O=r.clone(),V=this._extendCameraOptions(C);O.bearing=b,O.pitch=w;const G=o.bL.convert(l),j=o.bL.convert(p),Y=.5*(G.lat+j.lat),Q=.5*(G.lng+j.lng),ie=o.dt(Y,Q),ve=o.a6.vec3.normalize([],ie),me=o.a6.vec3.normalize([],o.a6.vec3.cross([],ve,[0,1,0])),we=o.a6.vec3.cross([],me,ve),be=[me[0],me[1],me[2],0,we[0],we[1],we[2],0,ve[0],ve[1],ve[2],0,0,0,0,1],Pe=[ie,o.dt(G.lat,G.lng),o.dt(j.lat,G.lng),o.dt(j.lat,j.lng),o.dt(G.lat,j.lng),o.dt(Y,G.lng),o.dt(Y,j.lng),o.dt(G.lat,Q),o.dt(j.lat,Q)];let $e=o.ca.fromPoints(Pe.map(Vt=>[o.a6.vec3.dot(me,Vt),o.a6.vec3.dot(we,Vt),o.a6.vec3.dot(ve,Vt)]));const Ve=o.a6.vec3.transformMat4([],$e.center,be);o.a6.vec3.squaredLength(Ve)===0&&o.a6.vec3.set(Ve,0,0,1),o.a6.vec3.normalize(Ve,Ve),o.a6.vec3.scale(Ve,Ve,o.aq),O.center=o.du(Ve);const We=O.getWorldToCameraMatrix(),Xe=o.a6.mat4.invert(new Float64Array(16),We);$e=o.ca.applyTransform($e,o.a6.mat4.multiply([],We,be));const Ke=this._extendAABB($e,O,V,b);if(!Ke)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");$e=Ke,o.a6.vec3.transformMat4(Ve,Ve,We);const Je=.5*($e.max[2]-$e.min[2]),rt=this._minimumAABBFrustumDistance(O,$e),ht=o.a6.vec3.scale([],[0,0,1],Je),lt=o.a6.vec3.add(ht,Ve,ht),st=rt+(O.pitch===0?0:o.a6.vec3.distance(Ve,lt)),Lt=O.globeCenterInViewSpace,Wt=o.a6.vec3.sub([],Ve,[Lt[0],Lt[1],Lt[2]]);o.a6.vec3.normalize(Wt,Wt),o.a6.vec3.scale(Wt,Wt,st);const ln=o.a6.vec3.add([],Ve,Wt);o.a6.vec3.transformMat4(ln,ln,Xe);const yn=o.dw/o.aq,Tn=o.a6.vec3.length(ln),wt=o.bE(Math.max(Tn*yn-o.dw,Number.EPSILON),0),on=Math.min(O.zoomFromMercatorZAdjusted(wt),V.maxZoom);return on>.5*(o.c3+o.bV)?(O.setProjection({name:"mercator"}),O.zoom=on,this._cameraForBounds(O,l,p,b,w,C)):{center:O.center,zoom:on,bearing:b,pitch:w}}_extendAABB(r,l,p,b){const w=.5*((p.padding.left||0)+(p.padding.right||0)),C=.5*((p.padding.top||0)+(p.padding.bottom||0)),O=C,V=w,G=w,j=C,Y=l.width-(V+G),Q=l.height-(O+j),ie=o.a6.vec3.sub([],r.max,r.min),ve=Math.min(Y/ie[0],Q/ie[1]),me=Math.min(l.scaleZoom(l.scale*ve),p.maxZoom);if(isNaN(me))return null;const we=l.scale/l.zoomScale(me),be=new o.ca([r.min[0]-V*we,r.min[1]-j*we,r.min[2]],[r.max[0]+G*we,r.max[1]+O*we,r.max[2]]),Pe=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new o.P(p.offset.x,p.offset.y):o.P.convert(p.offset)).rotate(-o.bC(b));return be.center[0]-=Pe.x*we,be.center[1]+=Pe.y*we,be}queryTerrainElevation(r,l){const p=this.transform.elevation;return p?(l=o.l({},{exaggerated:!0},l),p.getAtPoint(o.a5.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,p,b,w,C){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,p,b,w,C);const O=r.clone(),V=this._extendCameraOptions(C);O.bearing=b,O.pitch=w;const G=o.bL.convert(l),j=o.bL.convert(p),Y=new o.bL(G.lng,j.lat),Q=new o.bL(j.lng,G.lat),ie=O.project(G),ve=O.project(j),me=this.queryTerrainElevation(G),we=this.queryTerrainElevation(j),be=this.queryTerrainElevation(Y),Pe=this.queryTerrainElevation(Q),$e=[[ie.x,ie.y,Math.min(me||0,we||0,be||0,Pe||0)],[ve.x,ve.y,Math.max(me||0,we||0,be||0,Pe||0)]];let Ve=o.ca.fromPoints($e);const We=O.getWorldToCameraMatrix(),Xe=o.a6.mat4.invert(new Float64Array(16),We);Ve=o.ca.applyTransform(Ve,We);const Ke=this._extendAABB(Ve,O,V,b);if(!Ke)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ve=Ke;const Je=.5*o.a6.vec3.sub([],Ve.max,Ve.min)[2],rt=this._minimumAABBFrustumDistance(O,Ve),ht=[0,0,1,0];o.a6.vec4.transformMat4(ht,ht,We),o.a6.vec4.normalize(ht,ht);const lt=o.a6.vec3.scale([],ht,rt+Je),st=o.a6.vec3.add([],Ve.center,lt);o.a6.vec3.transformMat4(Ve.center,Ve.center,Xe),o.a6.vec3.transformMat4(st,st,Xe);const Lt=O.unproject(new o.P(Ve.center[0],Ve.center[1])),Wt=o.dv(O.projection,Lt),ln=Math.pow(2,Wt),yn=Math.min(O._zoomFromMercatorZ(st[2]*O.pixelsPerMeter*ln/O.worldSize),V.maxZoom);return O.mercatorFromTransition&&yn<.5*(o.c3+o.bV)?(O.setProjection({name:"globe"}),O.zoom=yn,this._cameraForBounds(O,l,p,b,w,C)):{center:Lt,zoom:yn,bearing:b,pitch:w}}fitBounds(r,l,p){const b=this.cameraForBounds(r,l);return this._fitInternal(b,l,p)}fitScreenCoordinates(r,l,p,b,w){const C=o.P.convert(r),O=o.P.convert(l),V=new o.P(Math.min(C.x,O.x),Math.min(C.y,O.y)),G=new o.P(Math.max(C.x,O.x),Math.max(C.y,O.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,O))return this;const j=this.transform.pointLocation3D(V),Y=this.transform.pointLocation3D(G),Q=this.transform.pointLocation3D(new o.P(V.x,G.y)),ie=this.transform.pointLocation3D(new o.P(G.x,V.y)),ve=[Math.min(j.lng,Y.lng,Q.lng,ie.lng),Math.min(j.lat,Y.lat,Q.lat,ie.lat)],me=[Math.max(j.lng,Y.lng,Q.lng,ie.lng),Math.max(j.lat,Y.lat,Q.lat,ie.lat)],we=b&&b.pitch?b.pitch:this.getPitch(),be=this._cameraForBounds(this.transform,ve,me,p,we,b);return this._fitInternal(be,b,w)}_fitInternal(r,l,p){return r?(l=o.l(r,l)).linear?this.easeTo(l,p):this.flyTo(l,p):this}jumpTo(r,l){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let b=!1,w=!1,C=!1;"zoom"in r&&p.zoom!==+r.zoom&&(b=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=o.bL.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(w=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(C=!0,p.pitch=+r.pitch);const O=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!p.isPaddingEqual(O))if(r.retainPadding===!1){const V=p.clone();V.padding=O,p.setLocationAtPoint(p.center,V.centerPoint)}else p.padding=O;return r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),b&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),w&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),C&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(Ca),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return o.w(Ca),this;this.stop();const b=p.zoom,w=p.pitch,C=p.bearing;p.setFreeCameraOptions(r);const O=b!==p.zoom,V=w!==p.pitch,G=C!==p.bearing;return this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),O&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),G&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),V&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=o.l({offset:[0,0],duration:500,easing:o.dr},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const p=this.transform,b=this.getZoom(),w=this.getBearing(),C=this.getPitch(),O=this.getPadding(),V="zoom"in r?+r.zoom:b,G="bearing"in r?this._normalizeBearing(r.bearing,w):w,j="pitch"in r?+r.pitch:C,Y=this._extendPadding(r.padding),Q=o.P.convert(r.offset);let ie,ve,me;if(p.projection.name==="globe"){const ht=o.a5.fromLngLat(p.center),lt=Q.rotate(-p.angle);ht.x+=lt.x/p.worldSize,ht.y+=lt.y/p.worldSize;const st=ht.toLngLat(),Lt=o.bL.convert(r.center||st);this._normalizeCenter(Lt),ie=p.centerPoint.add(lt),ve=new o.P(ht.x,ht.y).mult(p.worldSize),me=new o.P(o.am(Lt.lng),o.at(Lt.lat)).mult(p.worldSize).sub(ve)}else{ie=p.centerPoint.add(Q);const ht=p.pointLocation(ie),lt=o.bL.convert(r.center||ht);this._normalizeCenter(lt),ve=p.project(ht),me=p.project(lt).sub(ve)}const we=p.zoomScale(V-b);let be,Pe;r.around&&(be=o.bL.convert(r.around),Pe=p.locationPoint(be));const $e=this._zooming||V!==b,Ve=this._rotating||w!==G,We=this._pitching||j!==C,Xe=!p.isPaddingEqual(Y),Ke=r.retainPadding===!1?p.clone():p,Je=ht=>lt=>{if($e&&(ht.zoom=o.aa(b,V,lt)),Ve&&(ht.bearing=o.aa(w,G,lt)),We&&(ht.pitch=o.aa(C,j,lt)),Xe&&(Ke.interpolatePadding(O,Y,lt),ie=Ke.centerPoint.add(Q)),be)ht.setLocationAtPoint(be,Pe);else{const st=ht.zoomScale(ht.zoom-b),Lt=V>b?Math.min(2,we):Math.max(.5,we),Wt=Math.pow(Lt,1-lt),ln=ht.unproject(ve.add(me.mult(lt*Wt)).mult(st));ht.setLocationAtPoint(ht.renderWorldCopies?ln.wrap():ln,ie)}return r.preloadOnly||this._fireMoveEvents(l),ht};if(r.preloadOnly){const ht=this._emulate(Je,r.duration,p);return this._preloadTiles(ht),this}const rt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=$e,this._rotating=Ve,this._pitching=We,this._padding=Xe,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,rt),this._ease(Je(p),ht=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(l,ht)},r),this}_prepareEase(r,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||p.moving||this.fire(new o.x("movestart",r)),this._zooming&&!p.zooming&&this.fire(new o.x("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new o.x("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new o.x("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.x("move",r)),this._zooming&&this.fire(new o.x("zoom",r)),this._rotating&&this.fire(new o.x("rotate",r)),this._pitching&&this.fire(new o.x("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,b=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new o.x("zoomend",r)),b&&this.fire(new o.x("rotateend",r)),w&&this.fire(new o.x("pitchend",r)),this.fire(new o.x("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const Vt=o.ar(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Vt,l)}this.stop(),r=o.l({offset:[0,0],speed:1.2,curve:1.42,easing:o.dr},r);const p=this.transform,b=this.getZoom(),w=this.getBearing(),C=this.getPitch(),O=this.getPadding(),V="zoom"in r?o.ap(+r.zoom,p.minZoom,p.maxZoom):b,G="bearing"in r?this._normalizeBearing(r.bearing,w):w,j="pitch"in r?+r.pitch:C,Y=this._extendPadding(r.padding),Q=p.zoomScale(V-b),ie=o.P.convert(r.offset);let ve=p.centerPoint.add(ie);const me=p.pointLocation(ve),we=o.bL.convert(r.center||me);this._normalizeCenter(we);const be=p.project(me),Pe=p.project(we).sub(be);let $e=r.curve;const Ve=Math.max(p.width,p.height),We=Ve/Q,Xe=Pe.mag();if("minZoom"in r){const Vt=o.ap(Math.min(r.minZoom,b,V),p.minZoom,p.maxZoom),rn=Ve/p.zoomScale(Vt-b);$e=Math.sqrt(rn/Xe*2)}const Ke=$e*$e;function Je(Vt){const rn=(We*We-Ve*Ve+(Vt?-1:1)*Ke*Ke*Xe*Xe)/(2*(Vt?We:Ve)*Ke*Xe);return Math.log(Math.sqrt(rn*rn+1)-rn)}function rt(Vt){return(Math.exp(Vt)-Math.exp(-Vt))/2}function ht(Vt){return(Math.exp(Vt)+Math.exp(-Vt))/2}const lt=Je(0);let st=function(Vt){return ht(lt)/ht(lt+$e*Vt)},Lt=function(Vt){return Ve*((ht(lt)*(rt(rn=lt+$e*Vt)/ht(rn))-rt(lt))/Ke)/Xe;var rn},Wt=(Je(1)-lt)/$e;if(Math.abs(Xe)<1e-6||!isFinite(Wt)){if(Math.abs(Ve-We)<1e-6)return this.easeTo(r,l);const Vt=We<Ve?-1:1;Wt=Math.abs(Math.log(We/Ve))/$e,Lt=function(){return 0},st=function(rn){return Math.exp(Vt*$e*rn)}}r.duration="duration"in r?+r.duration:1e3*Wt/("screenSpeed"in r?+r.screenSpeed/$e:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const ln=w!==G,yn=j!==C,Tn=!p.isPaddingEqual(Y),wt=r.retainPadding===!1?p.clone():p,on=Vt=>rn=>{const hn=rn*Wt,nn=1/st(hn);Vt.zoom=rn===1?V:b+Vt.scaleZoom(nn),ln&&(Vt.bearing=o.aa(w,G,rn)),yn&&(Vt.pitch=o.aa(C,j,rn)),Tn&&(wt.interpolatePadding(O,Y,rn),ve=wt.centerPoint.add(ie));const An=rn===1?we:Vt.unproject(be.add(Pe.mult(Lt(hn))).mult(nn));return Vt.setLocationAtPoint(Vt.renderWorldCopies?An.wrap():An,ve),Vt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),Vt};if(r.preloadOnly){const Vt=this._emulate(on,r.duration,p);return this._preloadTiles(Vt),this}return this._zooming=!0,this._rotating=ln,this._pitching=yn,this._padding=Tn,this._prepareEase(l,!1),this._ease(on(p),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,l)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,l,p){p.animate===!1||p.duration===0?(r(1),l()):(this._easeStart=o.q.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=o.bB(r,-180,180);const p=Math.abs(r-l);return Math.abs(r-360-l)<p&&(r-=360),Math.abs(r+360-l)<p&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const p=r.lng-l.center.lng;r.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&o.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,p){const b=Math.ceil(15*l/1e3),w=[],C=r(p.clone());for(let O=0;O<=b;O++){const V=C(O/b);w.push(V.clone())}return w}_preloadTiles(r,l){}}class Df{constructor(r={}){this.options=r,o.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,p=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const b=F("span","mapboxgl-ctrl-icon",this._compactButton);return b.setAttribute("aria-hidden","true"),b.setAttribute("title",p),this._innerContainer=F("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(r){const p=l.reduce((b,w,C)=>(w.value&&(b+=`${w.key}=${w.value}${C<l.length-1?"&":""}`),b),"?");r.href=`${o.e.FEEDBACK_URL}/${p}#${zd(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const l=this._map.style._mergedSourceCaches;for(const b in l){const w=l[b];if(w.used){const C=w.getSource();C.attribution&&r.indexOf(C.attribution)<0&&r.push(C.attribution)}}r.sort((b,w)=>b.length-w.length),r=r.filter((b,w)=>{for(let C=w+1;C<r.length;C++)if(r[C].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class ug{constructor(){o.aJ(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=F("div","mapboxgl-ctrl");const l=F("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const p=r[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class my{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const b of p)if(b.id===r)return void(b.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Ud{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=o.cw((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,p){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+p}}const B1={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},gy=["mouseenter","mouseover","mouseleave","mouseout"];class Lf extends o.x{constructor(r,l,p,b){const{point:w,lngLat:C,originalEvent:O,target:V}=r;super(r.type,{point:w,lngLat:C,originalEvent:O,target:V}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=p,this.feature=b}}class dg{constructor(r){this.map=r,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const{type:p,filter:b}=l;if(b){const C=o.M(b,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(C.result==="error")throw new Error(C.value.map(O=>`${O.key}: ${O.message}`).join(", "));this.filters.set(r,C.value)}const w=this.interactionsByType.get(p)||new Map;w.size===0&&(gy.includes(p)?this.map.on(p,l.featureset,this.handleType):this.map.on(p,this.handleType),this.interactionsByType.set(p,w)),w.set(r,l),this.typeById.set(r,p)}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const p=this.interactionsByType.get(l);p&&(p.delete(r),p.size===0&&this.map.off(l,this.handleType))}handleType(r){const l=this.interactionsByType.get(r.type),p=Array.from(l).reverse(),b=[];for(const[,O]of p)O.featureset&&b.push({featureset:O.featureset,filter:O.filter,radius:O.radius});let w=this.map.style.queryRenderedFeaturesForInteractions(r.point,b,this.map.transform);!w.length&&gy.includes(r.type)&&(w=[null]);let C=!1;for(const O of w){for(const[V,G]of p){const{handler:j,featureset:Y}=G;if(Y&&(O==null||o.bi(O.featureset,Y))&&j(new Lf(r,V,G,O))!==!1){C=!0;break}}if(C)break}if(!C)for(const[O,V]of p){const{handler:G,featureset:j}=V;if(!j&&G(new Lf(r,O,V,null))!==!1)break}}}function jd(f,r){if(Array.isArray(f)&&Array.isArray(r)){const l=new Set(f),p=new Set(r);return l.size===p.size&&f.every(b=>p.has(b))}return o.bi(f,r)}const yu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1},Ja={showCompass:!0,showZoom:!0,visualizePitch:!1};class aa{constructor(r,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new If({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Af({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),q()}move(r,l){const p=this.map,b=this.mouseRotate.mousemoveWindow(r,l),w=b&&b.bearingDelta;if(w&&p.setBearing(p.getBearing()+w),this.mousePitch){const C=this.mousePitch.mousemoveWindow(r,l),O=C&&C.pitchDelta;O&&p.setPitch(p.getPitch()+O)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){J(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),fe(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,fe(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ge(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=ge(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Qa(f,r,l){if(f=new o.bL(f.lng,f.lat),r){const p=new o.bL(f.lng-360,f.lat),b=new o.bL(f.lng+360,f.lat),w=360*Math.ceil(Math.abs(f.lng-l.center.lng)/360),C=l.locationPoint(f).distSqr(r),O=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(p).distSqr(r)<C&&(O||Math.abs(p.lng-l.center.lng)<w)?f=p:l.locationPoint(b).distSqr(r)<C&&(O||Math.abs(b.lng-l.center.lng)<w)&&(f=b)}for(;Math.abs(f.lng-l.center.lng)>180;){const p=l.locationPoint(f);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;f.lng>l.center.lng?f.lng-=360:f.lng+=360}return f}const el={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ea extends o.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=o.l({element:r},l)),o.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=F("div");const w=41,C=27,O=W("svg",{display:"block",height:w*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${w}`},this._element),V=W("radialGradient",{id:"shadowGradient"},W("defs",{},O));W("stop",{offset:"10%","stop-opacity":.4},V),W("stop",{offset:"100%","stop-opacity":.05},V),W("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},O),W("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},O),W("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},O),W("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},O),this._offset=o.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const p=this._element.classList;for(const w in el)p.remove(`mapboxgl-marker-anchor-${w}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const b=r&&r.className?r.className.trim().split(/\s+/):[];p.add(...b),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.bL.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,p=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const p=r.unproject(l),b=r.getFreeCameraOptions();if(!b.position)return!1;const w=b.position.toLngLat();return w.distanceTo(p)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(l);let b;r._showingGlobe()&&o.dz(r.transform,this._lngLat)?b=0:(b=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${el[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,p=this.getPitchAlignment();if(!l||!r||p!=="map")return"";if(!l._showingGlobe()){const V=l.getPitch();return V?`rotateX(${V}deg)`:""}const b=o.c1(o.dA(l.transform,this._lngLat)),w=r.sub(o.dB(l.transform)),C=Math.abs(w.x)+Math.abs(w.y);if(C===0)return"";const O=b/C;return`rotateX(${-w.y*O}deg) rotateY(${w.x*O}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let p=0;const b=this.getRotationAlignment();if(b==="map")if(l._showingGlobe()){const w=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat+.001)),C=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);p=o.c1(Math.atan2(C.y,C.x))-90}else p=-l.getBearing();else if(b==="horizon"){const w=o.a7(4,6,l.getZoom()),C=o.dB(l.transform);C.y+=w*l.transform.height;const O=r.sub(C),V=o.c1(Math.atan2(O.y,O.x));p=(V>90?V-270:V+90)*(1-w)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=Qa(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const p=this._pointerdownPos,b=this._positionDelta;if(p&&b){if(!this._isDragging){const w=this._clickTolerance||l._clickTolerance;if(r.point.dist(p)<w)return;this._isDragging=!0}this._pos=r.point.sub(b),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.x("dragstart"))),this.fire(new o.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.x("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,p=this._pos;l&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const F1={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},N1={maxWidth:100,unit:"metric"},$1={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},V1={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},vy=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Oi(f=new o.P(0,0),r="bottom"){if(typeof f=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new o.P(0,f);case"top-left":return new o.P(l,l);case"top-right":return new o.P(-l,l);case"bottom":return new o.P(0,-f);case"bottom-left":return new o.P(l,-l);case"bottom-right":return new o.P(-l,-l);case"left":return new o.P(f,0);case"right":return new o.P(-f,0)}return new o.P(0,0)}return f instanceof o.P||Array.isArray(f)?o.P.convert(f):o.P.convert(f[r]||[0,0])}return{version:S,supported:$.supported,setRTLTextPlugin:o.dC,getRTLTextPluginStatus:o.dD,Map:class extends cg{constructor(f){I.mark(E.create);const r=f;if((f=o.l({},yu,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&o.dx(window)&&(f.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Zh(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new my,this._domRenderTaskQueue=new my,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.aQ(),this._locale=o.l({},B1,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ud(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=f.scaleFactor,this._requestManager=new Qe(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?{...f.contextCreateOptions}:{},typeof f.container=="string"){const l=document.getElementById(f.container);if(!l)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=l}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),o.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Qm),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new wi(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||o.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),f.hash&&(this._hash=new Tf(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const l=f.bounds;l&&(this.resize(),this.fitBounds(l,o.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new Df({customAttribution:f.customAttribution})),this._logoControl=new ug,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.x(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.x(`${l.dataType}dataloading`,l))}),this._interactions=new dg(this)}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new o.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=f.onAdd(this);this._controls.push(f);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new o.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.x("movestart",f)).fire(new o.x("move",f)),this.fire(new o.x("resize",f)),r&&this.fire(new o.x("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(o.as.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(f){return this._scaleFactor=f,this.painter.scaleFactor=f,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let l;r==="globe"&&f.zoom>=o.bV?(f.setMercatorFromTransition(),l=!0):r==="mercator"&&f.zoom<o.bV&&(f.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;return r=f.name==="globe"&&this.transform.zoom>=o.bV?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f){return this.transform.locationPoint3D(o.bL.convert(f))}unproject(f){return this.transform.pointLocation3D(o.P.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,l){const p=b=>{let w=[];if(Array.isArray(r)){const C=r.filter(O=>this.getLayer(O));w=C.length?this.queryRenderedFeatures(b,{layers:C}):[]}else w=this.queryRenderedFeatures(b,{featureset:r});return w};if(f==="mouseenter"||f==="mouseover"){let b=!1;return{listener:l,targets:r,delegates:{mousemove:C=>{const O=p(C.point);O.length?b||(b=!0,l.call(this,new Gr(f,this,C.originalEvent,{features:O}))):b=!1},mouseout:()=>{b=!1}}}}if(f==="mouseleave"||f==="mouseout"){let b=!1;return{listener:l,targets:r,delegates:{mousemove:O=>{p(O.point).length?b=!0:b&&(b=!1,l.call(this,new Gr(f,this,O.originalEvent)))},mouseout:O=>{b&&(b=!1,l.call(this,new Gr(f,this,O.originalEvent)))}}}}{const b=w=>{const C=p(w.point);C.length&&(w.features=C,l.call(this,w),delete w.features)};return{listener:l,targets:r,delegates:{[f]:b}}}}on(f,r,l){if(typeof r=="function"||l===void 0)return super.on(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(p);for(const b in p.delegates)this.on(b,p.delegates[b]);return this}once(f,r,l){if(typeof r=="function"||l===void 0)return super.once(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,l);for(const b in p.delegates)this.once(b,p.delegates[b]);return this}off(f,r,l){if(typeof r=="function"||l===void 0)return super.off(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._delegatedListeners?this._delegatedListeners[f]:void 0;return p&&(b=>{for(let w=0;w<b.length;w++){const C=b[w];if(C.listener===l&&jd(C.targets,r)){for(const O in C.delegates)this.off(O,C.delegates[O]);return b.splice(w,1),this}}})(p),this}queryRenderedFeatures(f,r){if(!this.style)return[];if(r!==void 0||f===void 0||f instanceof o.P||Array.isArray(f)||(r=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],"featureset"in(r=r||{}))return this._isFeaturesetDescriptorValid(r.featureset)?this.style.queryRenderedFeaturesForInteractions(f,[r],this.transform):[];if(r.layers&&Array.isArray(r.layers)){for(const l of r.layers)if(!this._isValidId(l))return[]}return this.style.queryRenderedFeatures(f,r,this.transform)}querySourceFeatures(f,r){return!f||typeof f=="string"&&!this._isValidId(f)?[]:this.style.querySourceFeatures(f,r)}isPointOnSurface(f){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&o.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(f))}addInteraction(f,r){return this._interactions.add(f,r),this}removeInteraction(f){return this._interactions.remove(f),this}setStyle(f,r){return r=o.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&f&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(f,(l,p)=>{l?(o.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(f,r)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const l=o.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new Cs(this,l).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Cs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new o.t(new Error("IDs can't be empty."))),!1):!o.aK(f)||(this.fire(new o.t(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}_isFeaturesetDescriptorValid(f){return"featuresetId"in f?this._isValidId(f.featuresetId):"layerId"in f&&this._isValidId(f.layerId)}_areTargetsValid(f){if(Array.isArray(f)){for(const r of f)if(!this._isValidId(r))return!1;return!0}return this._isFeaturesetDescriptorValid(f)}addSource(f,r){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,l)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,r,{pixelRatio:l=1,sdf:p=!1,stretchX:b,stretchY:w,content:C}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:O,height:V,data:G}=o.q.getImageData(r);this.style.addImage(f,{data:new o.r({width:O,height:V},G),pixelRatio:l,stretchX:b,stretchY:w,content:C,sdf:p,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:V}=r,G=r;this.style.addImage(f,{data:new o.r({width:O,height:V},new Uint8Array(G.data)),pixelRatio:l,stretchX:b,stretchY:w,content:C,sdf:p,version:0,userImage:G}),G.onAdd&&G.onAdd(this,f)}}updateImage(f,r){this._lazyInitEmptyStyle();const l=this.style.getImage(f);if(!l)return void this.fire(new o.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?o.q.getImageData(r):r,{width:b,height:w,data:C}=p;if(b===void 0||w===void 0)return void this.fire(new o.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==l.data.width||w!==l.data.height)return void this.fire(new o.t(new Error(`The width and height of the updated image (${b}, ${w})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const O=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);l.data.replace(C,O),this.style.updateImage(f,l)}hasImage(f){return f?!!this.style&&!!this.style.getImage(f):(this.fire(new o.t(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){o.o(this._requestManager.transformRequest(f,o.R.Image),(l,p)=>{r(l,p instanceof HTMLImageElement?o.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(f,r){this._lazyInitEmptyStyle(),this.style.addModel(f,r)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new o.t(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,r){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)):this}getSlot(f){const r=this.getLayer(f);return r&&r.slot||null}setSlot(f,r){return this.style.setSlot(f,r),this.style.mergeLayers(),this._update(!0)}addImport(f,r){return this.style.addImport(f,r),this}updateImport(f,r){return typeof r!="string"&&r.id!==f?(this.removeImport(f),this.addImport(r)):(this.style.updateImport(f,r),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,r){return this.style.moveImport(f,r),this._update(!0)}moveLayer(f,r){return this._isValidId(f)?(this.style.moveLayer(f,r),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const r=this.style.getOwnLayer(f);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,r,l){return this._isValidId(f)?(this.style.setLayerZoomRange(f,r,l),this._update(!0)):this}setFilter(f,r,l={}){return this._isValidId(f)?(this.style.setFilter(f,r,l),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setPaintProperty(f,r,l,p),this._update(!0)):this}getPaintProperty(f,r){return this._isValidId(f)?this.style.getPaintProperty(f,r):null}setLayoutProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,r,l,p),this._update(!0)):this}getLayoutProperty(f,r){return this._isValidId(f)?this.style.getLayoutProperty(f,r):null}getSchema(f){return this.style.getSchema(f)}setSchema(f,r){return this.style.setSchema(f,r),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,r){return this.style.setConfig(f,r),this._update(!0)}getConfigProperty(f,r){return this.style.getConfigProperty(f,r)}setConfigProperty(f,r,l){return this.style.setConfigProperty(f,r,l),this._update(!0)}getFeaturesetDescriptors(f){return this.style.getFeaturesetDescriptors(f)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const r=f[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.bL.convert(f),this.transform):0}setFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.setFeatureState(f,r),this._update())}removeFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.removeFeatureState(f,r),this._update())}getFeatureState(f){return f.source&&!this._isValidId(f.source)?null:this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,p,b,w=this._container;for(;w&&(!p||!b);){const C=window.getComputedStyle(w).transform;C&&C!=="none"&&(l=C.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(p=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(b=l[3])),w=w.parentElement}this._containerWidth=p?Math.abs(f/p):f,this._containerHeight=b?Math.abs(r/b):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=F("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=F("div","mapboxgl-canvas-container",f);this._canvas=F("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=F("div","mapboxgl-control-container",f),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(b=>{p[b]=F("div",`mapboxgl-ctrl-${b}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const l=o.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(f),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=o.l({},$.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",f);r?(At(r,!0),this.painter=new Dl(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.m.testSupport(r)):this.fire(new o.t(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.x("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new o.x("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;this.fire(new o.x("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,p=o.q.now(),b=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=b.createQuery(),b.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,j=this.transform.pitch,Y=o.q.now(),Q=new o.a3(G,{now:Y,fadeDuration:w,pitch:j,transition:this.style.transition});this.style.update(Q)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(p);const O=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),O&&(this._placementDirty=O.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,I.mark(E.load),this.fire(new o.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const G=o.q.now()-p;b.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const j=b.getQueryParameter(r,b.QUERY_RESULT)/1e6;b.deleteQuery(r),this.fire(new o.x("gpu-timing-frame",{cpuTime:G,gpuTime:j}))},50)}if(this.listens("gpu-timing-layer")){const G=this.painter.collectGpuTimers();setTimeout(()=>{const j=this.painter.queryGpuTimers(G);this.fire(new o.x("gpu-timing-layer",{layerTimes:j}))},50)}if(this.listens("gpu-timing-deferred-render")){const G=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const j=this.painter.queryGpuTimeDeferredRender(G);this.fire(new o.x("gpu-timing-deferred-render",{gpuTime:j}))},50)}const V=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(V||this._repaint)this.triggerRepaint();else{const G=this.idle();if(G&&(C=this._updateAverageElevation(p,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),G&&(this.fire(new o.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const j=this._calculateSpeedIndex();this.fire(new o.x("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||V||(this._fullyLoaded=!0,I.mark(E.fullLoad),this._performanceMetricsCollection&&Gt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const l=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const b=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=f;const C=Math.abs(b-w);if(C>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(w),l(w);this._averageElevation.easeTo(w,f,300)}else if(C>1e-4)return this._averageElevation.jumpTo(w),l(w)}return!!this._averageElevation.isEasing(f)&&l(this._averageElevation.getValue(f))}_authenticate(){Be(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===Re||f.status===401)){const r=this.painter.context.gl;At(r,!1),this._logoControl instanceof ug&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ct(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Bt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function b(w){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,w,0);const C=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,C),C}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(b(f),r.canvasCopies.map(b),r.timeStamps)}_canvasPixelComparison(f,r,l){let p=l[1]-l[0];const b=f.length/4;for(let w=0;w<r.length;w++){const C=r[w];let O=0;for(let V=0;V<C.length;V+=4)C[V]===f[V]&&C[V+1]===f[V+1]&&C[V+2]===f[V+2]&&C[V+3]===f[V+3]&&(O+=1);p+=(l[w+2]-l[w+1])*(1-O/b)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),an.delete(this.painter.context.gl),jt.remove(),De.remove(),this._removed=!0,this.fire(new o.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=o.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(f){const r=this.style?this.style.getSourceCaches():[];return o.bg(r,(l,p)=>l._preloadTiles(f,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,r){o.dy(f,r)}get version(){return S}},NavigationControl:class{constructor(f={}){this.options=o.l({},Ja,f),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),F("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),F("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=F("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),l=r===f.getMaxZoom(),p=r===f.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new aa(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const l=F("button",f,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(f,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",l),f.firstElementChild&&f.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends o.E{constructor(f={}){super();const r=navigator.geolocation;this.options=o.l({geolocation:r},F1,f),o.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ya(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,f(l)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),l=f.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new o.x("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("geolocate",f)),this._finish()}}_updateCamera(f){const r=new o.bL(f.coords.longitude,f.coords.latitude),l=f.coords.accuracy,p=this._map.getBearing(),b=o.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),b,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new o.bL(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=o.bE(1,f._center.lat)*f.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=F("button","mapboxgl-ctrl-geolocate",this._container),F("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F("div","mapboxgl-user-location"),this._dotElement.appendChild(F("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(F("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ea({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=F("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ea({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.x("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Df,ScaleControl:class{constructor(f={}){this.options=o.l({},N1,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,p=r._containerWidth/2-f/2,b=r.unproject([p,l]),w=r.unproject([p+f,l]),C=b.distanceTo(w);if(this.options.unit==="imperial"){const O=3.2808*C;O>5280?this._setScale(f,O/5280,"mile"):this._setScale(f,O,"foot")}else this.options.unit==="nautical"?this._setScale(f,C/1852,"nautical-mile"):C>=1e3?this._setScale(f,C/1e3,"kilometer"):this._setScale(f,C,"meter")}_setScale(f,r,l){this._map._requestDomTask(()=>{const p=function(w){const C=Math.pow(10,`${Math.floor(w)}`.length-1);let O=w/C;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(V){const G=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*G)/G}(O),C*O}(r),b=p/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(p):`${p}&nbsp;${$1[l]}`,this._container.style.width=f*b+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:o.w("Full screen control 'container' must be a DOM element.")),o.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=F("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(f){super(),this.options=o.l(Object.create(V1),f),o.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new o.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new o.x("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=o.bL.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const r=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=f;p=l.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=F("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const l=this._closeButton=F("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,p=this._pos;if(!r||!l||!p)return"bottom";const b=l.offsetWidth,w=l.offsetHeight,C=p.x<b/2,O=p.x>r.transform.width-b/2;if(p.y+f<w)return C?"top-left":O?"top-right":"top";if(p.y>r.transform.height-w){if(C)return"bottom-left";if(O)return"bottom-right"}return C?"left":O?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let p=this._container;if(p||(p=this._container=F("div","mapboxgl-popup",r.getContainer()),this._tip=F("div","mapboxgl-popup-tip",p),p.appendChild(l)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qa(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const b=this._pos=this._trackPointer&&f instanceof o.P?f:r.project(this._lngLat),w=Oi(this.options.offset),C=this._anchor=this._getAnchor(w.y),O=Oi(this.options.offset,C),V=b.add(O).round();r._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${el[C]} translate(${V.x}px,${V.y}px)`)})}if(!this._marker&&r._showingGlobe()){const b=o.dz(r.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(vy);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Ea,Style:Cs,LngLat:o.bL,LngLatBounds:o.as,Point:o.P,MercatorCoordinate:o.a5,FreeCameraOptions:Al,Evented:o.E,config:o.e,prewarm:o.dE,clearPrewarmedResources:o.dF,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(f){o.e.ACCESS_TOKEN=f},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(f){o.e.API_URL=f},get workerCount(){return o.dG.workerCount},set workerCount(f){o.dG.workerCount=f},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){o.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){o.dH(f)},get workerUrl(){return o.dI.workerUrl},set workerUrl(f){o.dI.workerUrl=f},get workerClass(){return o.dI.workerClass},set workerClass(f){o.dI.workerClass=f},get workerParams(){return o.dI.workerParams},set workerParams(f){o.dI.workerParams=f},get dracoUrl(){return o.dJ()},set dracoUrl(f){o.dK(f)},get meshoptUrl(){return o.dL()},set meshoptUrl(f){o.dM(f)},setNow:o.q.setNow,restoreNow:o.q.restoreNow}});var _=d;return _})})($R);var U6=$R.exports;const TA=Ql(U6),j6={class:"control-panel"},H6={key:0,class:"file-name"},G6={__name:"App",setup(e){TA.accessToken="pk.eyJ1IjoibHZ1c2xmY29vIiwiYSI6ImNsbzJ0Zjd2ejBiN3AydmxlN25pa3E5c3cifQ.qNGUVfyvKHJZqfKlaH_5XQ";const t=xe(null),i=xe(!0),a=xe("");_o(()=>{t.value=new TA.Map({container:"mapContainer",style:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://khms0.google.com/kh/v=988?x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles"}]},center:[121.544,31.221],zoom:14,pitch:60,bearing:130}),t.value.on("load",()=>{console.log("Map loaded.")})});const d=o=>{const S=o.target.files[0];if(S){a.value=S.name;const E=new FileReader;E.onload=I=>{try{const R=JSON.parse(I.target.result);g(R)}catch(R){console.error("无法解析JSON文件：",R)}},E.readAsText(S)}},g=o=>{t.value.getLayer("3d-buildings")&&t.value.removeLayer("3d-buildings"),t.value.getSource("geojson-source")&&t.value.removeSource("geojson-source"),t.value.addSource("geojson-source",{type:"geojson",data:o}),t.value.addLayer({id:"3d-buildings",source:"geojson-source",type:"fill-extrusion",paint:{"fill-extrusion-color":["interpolate",["linear"],["*",["get","Height"],5],0,"rgb(255, 235, 238)",30,"rgb(255, 193, 193)",60,"rgb(244, 67, 54)",100,"rgb(183, 28, 28)"],"fill-extrusion-height":["*",5,["get","Height"]],"fill-extrusion-opacity":.9}})},_=()=>{i.value=!i.value;const o=i.value?"visible":"none";t.value.setLayoutProperty("3d-buildings","visibility",o)};return(o,S)=>(se(),Ie("div",null,[S[0]||(S[0]=je("div",{id:"mapContainer",class:"map-container"},null,-1)),je("div",j6,[je("input",{type:"file",accept:".json",onChange:d,class:"file-input"},null,32),a.value?(se(),Ie("span",H6,"已选择文件："+mn(a.value),1)):yt("",!0),je("button",{class:"toggle-button",onClick:_},mn(i.value?"隐藏围栏":"显示围栏"),1)])]))}},W6='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',q6=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,CA=e=>Array.from(e.querySelectorAll(W6)).filter(t=>t2(t)&&q6(t)),t2=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},P0=function(e,t,...i){let a;t.includes("mouse")||t.includes("click")?a="MouseEvents":t.includes("key")?a="KeyboardEvent":a="HTMLEvents";const d=document.createEvent(a);return d.initEvent(t,...i),e.dispatchEvent(d),e},UR=e=>!e.getAttribute("aria-owns"),jR=(e,t,i)=>{const{parentNode:a}=e;if(!a)return null;const d=a.querySelectorAll(i),g=Array.prototype.indexOf.call(d,e);return d[g+t]||null},R0=e=>{e&&(e.focus(),!UR(e)&&e.click())},hi=(e,t,{checkForDefaultPrevented:i=!0}={})=>d=>{const g=e==null?void 0:e(d);if(i===!1||!g)return t==null?void 0:t(d)},EA=e=>t=>t.pointerType==="mouse"?e(t):void 0;var K6=Object.defineProperty,Z6=Object.defineProperties,Y6=Object.getOwnPropertyDescriptors,MA=Object.getOwnPropertySymbols,X6=Object.prototype.hasOwnProperty,J6=Object.prototype.propertyIsEnumerable,IA=(e,t,i)=>t in e?K6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Q6=(e,t)=>{for(var i in t||(t={}))X6.call(t,i)&&IA(e,i,t[i]);if(MA)for(var i of MA(t))J6.call(t,i)&&IA(e,i,t[i]);return e},e$=(e,t)=>Z6(e,Y6(t));function n2(e,t){var i;const a=qr();return ns(()=>{a.value=e()},e$(Q6({},t),{flush:(i=void 0)!=null?i:"sync"})),Vp(a)}var AA;const Wo=typeof window<"u",t$=e=>typeof e<"u",o2=e=>typeof e=="function",n$=e=>typeof e=="string",Cp=()=>{},r2=Wo&&((AA=window==null?void 0:window.navigator)==null?void 0:AA.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Qu(e){return typeof e=="function"?e():y(e)}function HR(e,t){function i(...a){return new Promise((d,g)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(d).catch(g)})}return i}function o$(e,t={}){let i,a,d=Cp;const g=o=>{clearTimeout(o),d(),d=Cp};return o=>{const S=Qu(e),E=Qu(t.maxWait);return i&&g(i),S<=0||E!==void 0&&E<=0?(a&&(g(a),a=null),Promise.resolve(o())):new Promise((I,R)=>{d=t.rejectOnCancel?R:I,E&&!a&&(a=setTimeout(()=>{i&&g(i),a=null,I(o())},E)),i=setTimeout(()=>{a&&g(a),a=null,I(o())},S)})}}function r$(e,t=!0,i=!0,a=!1){let d=0,g,_=!0,o=Cp,S;const E=()=>{g&&(clearTimeout(g),g=void 0,o(),o=Cp)};return R=>{const z=Qu(e),N=Date.now()-d,$=()=>S=R();return E(),z<=0?(d=Date.now(),$()):(N>z&&(i||!_)?(d=Date.now(),$()):t&&(S=new Promise((F,W)=>{o=a?W:F,g=setTimeout(()=>{d=Date.now(),_=!0,F($()),E()},Math.max(0,z-N))})),!i&&!g&&(g=setTimeout(()=>_=!0,z)),_=!1,S)}}function i$(e){return e}function s$(e,t){let i,a,d;const g=xe(!0),_=()=>{g.value=!0,d()};qt(e,_,{flush:"sync"});const o=o2(t)?t:t.get,S=o2(t)?void 0:t.set,E=n5((I,R)=>(a=I,d=R,{get(){return g.value&&(i=o(),g.value=!1),a(),i},set(z){S==null||S(z)}}));return Object.isExtensible(E)&&(E.trigger=_),E}function e_(e){return yP()?(bP(e),!0):!1}function a$(e,t=200,i={}){return HR(o$(t,i),e)}function l$(e,t=200,i={}){const a=xe(e.value),d=a$(()=>{a.value=e.value},t,i);return qt(e,()=>d()),a}function GR(e,t=200,i=!1,a=!0,d=!1){return HR(r$(t,i,a,d),e)}function OS(e,t=!0){To()?_o(e):t?e():Un(e)}function wh(e,t,i={}){const{immediate:a=!0}=i,d=xe(!1);let g=null;function _(){g&&(clearTimeout(g),g=null)}function o(){d.value=!1,_()}function S(...E){_(),d.value=!0,g=setTimeout(()=>{d.value=!1,g=null,e(...E)},Qu(t))}return a&&(d.value=!0,Wo&&S()),e_(o),{isPending:Vp(d),start:S,stop:o}}function Bs(e){var t;const i=Qu(e);return(t=i==null?void 0:i.$el)!=null?t:i}const cd=Wo?window:void 0,c$=Wo?window.document:void 0;function wr(...e){let t,i,a,d;if(n$(e[0])||Array.isArray(e[0])?([i,a,d]=e,t=cd):[t,i,a,d]=e,!t)return Cp;Array.isArray(i)||(i=[i]),Array.isArray(a)||(a=[a]);const g=[],_=()=>{g.forEach(I=>I()),g.length=0},o=(I,R,z,N)=>(I.addEventListener(R,z,N),()=>I.removeEventListener(R,z,N)),S=qt(()=>[Bs(t),Qu(d)],([I,R])=>{_(),I&&g.push(...i.flatMap(z=>a.map(N=>o(I,z,N,R))))},{immediate:!0,flush:"post"}),E=()=>{S(),_()};return e_(E),E}let kA=!1;function zS(e,t,i={}){const{window:a=cd,ignore:d=[],capture:g=!0,detectIframe:_=!1}=i;if(!a)return;r2&&!kA&&(kA=!0,Array.from(a.document.body.children).forEach(z=>z.addEventListener("click",Cp)));let o=!0;const S=z=>d.some(N=>{if(typeof N=="string")return Array.from(a.document.querySelectorAll(N)).some($=>$===z.target||z.composedPath().includes($));{const $=Bs(N);return $&&(z.target===$||z.composedPath().includes($))}}),I=[wr(a,"click",z=>{const N=Bs(e);if(!(!N||N===z.target||z.composedPath().includes(N))){if(z.detail===0&&(o=!S(z)),!o){o=!0;return}t(z)}},{passive:!0,capture:g}),wr(a,"pointerdown",z=>{const N=Bs(e);N&&(o=!z.composedPath().includes(N)&&!S(z))},{passive:!0}),_&&wr(a,"blur",z=>{var N;const $=Bs(e);((N=a.document.activeElement)==null?void 0:N.tagName)==="IFRAME"&&!($!=null&&$.contains(a.document.activeElement))&&t(z)})].filter(Boolean);return()=>I.forEach(z=>z())}function u$(e={}){var t;const{window:i=cd}=e,a=(t=e.document)!=null?t:i==null?void 0:i.document,d=s$(()=>null,()=>a==null?void 0:a.activeElement);return i&&(wr(i,"blur",g=>{g.relatedTarget===null&&d.trigger()},!0),wr(i,"focus",d.trigger,!0)),d}function WR(e,t=!1){const i=xe(),a=()=>i.value=!!e();return a(),OS(a,t),i}function d$(e){return JSON.parse(JSON.stringify(e))}const PA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},RA="__vueuse_ssr_handlers__";PA[RA]=PA[RA]||{};function h$(e,t,{window:i=cd,initialValue:a=""}={}){const d=xe(a),g=ee(()=>{var _;return Bs(t)||((_=i==null?void 0:i.document)==null?void 0:_.documentElement)});return qt([g,()=>Qu(e)],([_,o])=>{var S;if(_&&i){const E=(S=i.getComputedStyle(_).getPropertyValue(o))==null?void 0:S.trim();d.value=E||a}},{immediate:!0}),qt(d,_=>{var o;(o=g.value)!=null&&o.style&&g.value.style.setProperty(Qu(e),_)}),d}function f$({document:e=c$}={}){if(!e)return xe("visible");const t=xe(e.visibilityState);return wr(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var DA=Object.getOwnPropertySymbols,p$=Object.prototype.hasOwnProperty,m$=Object.prototype.propertyIsEnumerable,g$=(e,t)=>{var i={};for(var a in e)p$.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&DA)for(var a of DA(e))t.indexOf(a)<0&&m$.call(e,a)&&(i[a]=e[a]);return i};function ei(e,t,i={}){const a=i,{window:d=cd}=a,g=g$(a,["window"]);let _;const o=WR(()=>d&&"ResizeObserver"in d),S=()=>{_&&(_.disconnect(),_=void 0)},E=qt(()=>Bs(e),R=>{S(),o.value&&d&&R&&(_=new ResizeObserver(t),_.observe(R,g))},{immediate:!0,flush:"post"}),I=()=>{S(),E()};return e_(I),{isSupported:o,stop:I}}function LA(e,t={}){const{reset:i=!0,windowResize:a=!0,windowScroll:d=!0,immediate:g=!0}=t,_=xe(0),o=xe(0),S=xe(0),E=xe(0),I=xe(0),R=xe(0),z=xe(0),N=xe(0);function $(){const F=Bs(e);if(!F){i&&(_.value=0,o.value=0,S.value=0,E.value=0,I.value=0,R.value=0,z.value=0,N.value=0);return}const W=F.getBoundingClientRect();_.value=W.height,o.value=W.bottom,S.value=W.left,E.value=W.right,I.value=W.top,R.value=W.width,z.value=W.x,N.value=W.y}return ei(e,$),qt(()=>Bs(e),F=>!F&&$()),d&&wr("scroll",$,{capture:!0,passive:!0}),a&&wr("resize",$,{passive:!0}),OS(()=>{g&&$()}),{height:_,bottom:o,left:S,right:E,top:I,width:R,x:z,y:N,update:$}}var OA=Object.getOwnPropertySymbols,v$=Object.prototype.hasOwnProperty,_$=Object.prototype.propertyIsEnumerable,y$=(e,t)=>{var i={};for(var a in e)v$.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&OA)for(var a of OA(e))t.indexOf(a)<0&&_$.call(e,a)&&(i[a]=e[a]);return i};function qR(e,t,i={}){const a=i,{window:d=cd}=a,g=y$(a,["window"]);let _;const o=WR(()=>d&&"MutationObserver"in d),S=()=>{_&&(_.disconnect(),_=void 0)},E=qt(()=>Bs(e),R=>{S(),o.value&&d&&R&&(_=new MutationObserver(t),_.observe(R,g))},{immediate:!0}),I=()=>{S(),E()};return e_(I),{isSupported:o,stop:I}}var zA;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(zA||(zA={}));var b$=Object.defineProperty,BA=Object.getOwnPropertySymbols,x$=Object.prototype.hasOwnProperty,w$=Object.prototype.propertyIsEnumerable,FA=(e,t,i)=>t in e?b$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,S$=(e,t)=>{for(var i in t||(t={}))x$.call(t,i)&&FA(e,i,t[i]);if(BA)for(var i of BA(t))w$.call(t,i)&&FA(e,i,t[i]);return e};const T$={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};S$({linear:i$},T$);function KR(e,t,i,a={}){var d,g,_;const{clone:o=!1,passive:S=!1,eventName:E,deep:I=!1,defaultValue:R}=a,z=To(),N=i||(z==null?void 0:z.emit)||((d=z==null?void 0:z.$emit)==null?void 0:d.bind(z))||((_=(g=z==null?void 0:z.proxy)==null?void 0:g.$emit)==null?void 0:_.bind(z==null?void 0:z.proxy));let $=E;t||(t="modelValue"),$=E||$||`update:${t.toString()}`;const F=U=>o?o2(o)?o(U):d$(U):U,W=()=>t$(e[t])?F(e[t]):R;if(S){const U=W(),re=xe(U);return qt(()=>e[t],K=>re.value=F(K)),qt(re,K=>{(K!==e[t]||I)&&N($,K)},{deep:I}),re}else return ee({get(){return W()},set(U){N($,U)}})}function C$({window:e=cd}={}){if(!e)return xe(!1);const t=xe(e.document.hasFocus());return wr(e,"blur",()=>{t.value=!1}),wr(e,"focus",()=>{t.value=!0}),t}function E$(e={}){const{window:t=cd,initialWidth:i=1/0,initialHeight:a=1/0,listenOrientation:d=!0,includeScrollbar:g=!0}=e,_=xe(i),o=xe(a),S=()=>{t&&(g?(_.value=t.innerWidth,o.value=t.innerHeight):(_.value=t.document.documentElement.clientWidth,o.value=t.document.documentElement.clientHeight))};return S(),OS(S),wr("resize",S,{passive:!0}),d&&wr("orientationchange",S,{passive:!0}),{width:_,height:o}}const BS=()=>Wo&&/firefox/i.test(window.navigator.userAgent),M$=(e,t)=>{if(!Wo||!e||!t)return!1;const i=e.getBoundingClientRect();let a;return t instanceof Element?a=t.getBoundingClientRect():a={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},i.top<a.bottom&&i.bottom>a.top&&i.right>a.left&&i.left<a.right},NA=e=>{let t=0,i=e;for(;i;)t+=i.offsetTop,i=i.offsetParent;return t},i2=(e,t)=>Math.abs(NA(e)-NA(t)),FS=e=>{let t,i;return e.type==="touchend"?(i=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(i=e.touches[0].clientY,t=e.touches[0].clientX):(i=e.clientY,t=e.clientX),{clientX:t,clientY:i}};function I$(e,t,i,a){const d=i-t;return e/=a/2,e<1?d/2*e*e*e+t:d/2*((e-=2)*e*e+2)+t}var ZR=typeof global=="object"&&global&&global.Object===Object&&global,A$=typeof self=="object"&&self&&self.Object===Object&&self,wl=ZR||A$||Function("return this")(),$a=wl.Symbol,YR=Object.prototype,k$=YR.hasOwnProperty,P$=YR.toString,Xg=$a?$a.toStringTag:void 0;function R$(e){var t=k$.call(e,Xg),i=e[Xg];try{e[Xg]=void 0;var a=!0}catch{}var d=P$.call(e);return a&&(t?e[Xg]=i:delete e[Xg]),d}var D$=Object.prototype,L$=D$.toString;function O$(e){return L$.call(e)}var z$="[object Null]",B$="[object Undefined]",$A=$a?$a.toStringTag:void 0;function Rh(e){return e==null?e===void 0?B$:z$:$A&&$A in Object(e)?R$(e):O$(e)}function Wl(e){return e!=null&&typeof e=="object"}var F$="[object Symbol]";function Nb(e){return typeof e=="symbol"||Wl(e)&&Rh(e)==F$}function NS(e,t){for(var i=-1,a=e==null?0:e.length,d=Array(a);++i<a;)d[i]=t(e[i],i,e);return d}var $s=Array.isArray,N$=1/0,VA=$a?$a.prototype:void 0,UA=VA?VA.toString:void 0;function XR(e){if(typeof e=="string")return e;if($s(e))return NS(e,XR)+"";if(Nb(e))return UA?UA.call(e):"";var t=e+"";return t=="0"&&1/e==-N$?"-0":t}var $$=/\s/;function V$(e){for(var t=e.length;t--&&$$.test(e.charAt(t)););return t}var U$=/^\s+/;function j$(e){return e&&e.slice(0,V$(e)+1).replace(U$,"")}function Vs(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var jA=NaN,H$=/^[-+]0x[0-9a-f]+$/i,G$=/^0b[01]+$/i,W$=/^0o[0-7]+$/i,q$=parseInt;function HA(e){if(typeof e=="number")return e;if(Nb(e))return jA;if(Vs(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Vs(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=j$(e);var i=G$.test(e);return i||W$.test(e)?q$(e.slice(2),i?2:8):H$.test(e)?jA:+e}function $S(e){return e}var K$="[object AsyncFunction]",Z$="[object Function]",Y$="[object GeneratorFunction]",X$="[object Proxy]";function VS(e){if(!Vs(e))return!1;var t=Rh(e);return t==Z$||t==Y$||t==K$||t==X$}var hw=wl["__core-js_shared__"],GA=function(){var e=/[^.]+$/.exec(hw&&hw.keys&&hw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function J$(e){return!!GA&&GA in e}var Q$=Function.prototype,eV=Q$.toString;function Dh(e){if(e!=null){try{return eV.call(e)}catch{}try{return e+""}catch{}}return""}var tV=/[\\^$.*+?()[\]{}|]/g,nV=/^\[object .+?Constructor\]$/,oV=Function.prototype,rV=Object.prototype,iV=oV.toString,sV=rV.hasOwnProperty,aV=RegExp("^"+iV.call(sV).replace(tV,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function lV(e){if(!Vs(e)||J$(e))return!1;var t=VS(e)?aV:nV;return t.test(Dh(e))}function cV(e,t){return e==null?void 0:e[t]}function Lh(e,t){var i=cV(e,t);return lV(i)?i:void 0}var s2=Lh(wl,"WeakMap"),WA=Object.create,uV=function(){function e(){}return function(t){if(!Vs(t))return{};if(WA)return WA(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function dV(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function hV(){}function JR(e,t){var i=-1,a=e.length;for(t||(t=Array(a));++i<a;)t[i]=e[i];return t}var fV=800,pV=16,mV=Date.now;function gV(e){var t=0,i=0;return function(){var a=mV(),d=pV-(a-i);if(i=a,d>0){if(++t>=fV)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function vV(e){return function(){return e}}var rb=function(){try{var e=Lh(Object,"defineProperty");return e({},"",{}),e}catch{}}(),_V=rb?function(e,t){return rb(e,"toString",{configurable:!0,enumerable:!1,value:vV(t),writable:!0})}:$S,QR=gV(_V);function yV(e,t){for(var i=-1,a=e==null?0:e.length;++i<a&&t(e[i],i,e)!==!1;);return e}function eD(e,t,i,a){for(var d=e.length,g=i+(a?1:-1);a?g--:++g<d;)if(t(e[g],g,e))return g;return-1}function bV(e){return e!==e}function xV(e,t,i){for(var a=i-1,d=e.length;++a<d;)if(e[a]===t)return a;return-1}function wV(e,t,i){return t===t?xV(e,t,i):eD(e,bV,i)}function SV(e,t){var i=e==null?0:e.length;return!!i&&wV(e,t,0)>-1}var TV=9007199254740991,CV=/^(?:0|[1-9]\d*)$/;function $b(e,t){var i=typeof e;return t=t??TV,!!t&&(i=="number"||i!="symbol"&&CV.test(e))&&e>-1&&e%1==0&&e<t}function US(e,t,i){t=="__proto__"&&rb?rb(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function t_(e,t){return e===t||e!==e&&t!==t}var EV=Object.prototype,MV=EV.hasOwnProperty;function jS(e,t,i){var a=e[t];(!(MV.call(e,t)&&t_(a,i))||i===void 0&&!(t in e))&&US(e,t,i)}function jp(e,t,i,a){var d=!i;i||(i={});for(var g=-1,_=t.length;++g<_;){var o=t[g],S=void 0;S===void 0&&(S=e[o]),d?US(i,o,S):jS(i,o,S)}return i}var qA=Math.max;function tD(e,t,i){return t=qA(t===void 0?e.length-1:t,0),function(){for(var a=arguments,d=-1,g=qA(a.length-t,0),_=Array(g);++d<g;)_[d]=a[t+d];d=-1;for(var o=Array(t+1);++d<t;)o[d]=a[d];return o[t]=i(_),dV(e,this,o)}}function nD(e,t){return QR(tD(e,t,$S),e+"")}var IV=9007199254740991;function HS(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=IV}function Hp(e){return e!=null&&HS(e.length)&&!VS(e)}function AV(e,t,i){if(!Vs(i))return!1;var a=typeof t;return(a=="number"?Hp(i)&&$b(t,i.length):a=="string"&&t in i)?t_(i[t],e):!1}function kV(e){return nD(function(t,i){var a=-1,d=i.length,g=d>1?i[d-1]:void 0,_=d>2?i[2]:void 0;for(g=e.length>3&&typeof g=="function"?(d--,g):void 0,_&&AV(i[0],i[1],_)&&(g=d<3?void 0:g,d=1),t=Object(t);++a<d;){var o=i[a];o&&e(t,o,a,g)}return t})}var PV=Object.prototype;function GS(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||PV;return e===i}function RV(e,t){for(var i=-1,a=Array(e);++i<e;)a[i]=t(i);return a}var DV="[object Arguments]";function KA(e){return Wl(e)&&Rh(e)==DV}var oD=Object.prototype,LV=oD.hasOwnProperty,OV=oD.propertyIsEnumerable,Iv=KA(function(){return arguments}())?KA:function(e){return Wl(e)&&LV.call(e,"callee")&&!OV.call(e,"callee")};function zV(){return!1}var rD=typeof ma=="object"&&ma&&!ma.nodeType&&ma,ZA=rD&&typeof ga=="object"&&ga&&!ga.nodeType&&ga,BV=ZA&&ZA.exports===rD,YA=BV?wl.Buffer:void 0,FV=YA?YA.isBuffer:void 0,Av=FV||zV,NV="[object Arguments]",$V="[object Array]",VV="[object Boolean]",UV="[object Date]",jV="[object Error]",HV="[object Function]",GV="[object Map]",WV="[object Number]",qV="[object Object]",KV="[object RegExp]",ZV="[object Set]",YV="[object String]",XV="[object WeakMap]",JV="[object ArrayBuffer]",QV="[object DataView]",e8="[object Float32Array]",t8="[object Float64Array]",n8="[object Int8Array]",o8="[object Int16Array]",r8="[object Int32Array]",i8="[object Uint8Array]",s8="[object Uint8ClampedArray]",a8="[object Uint16Array]",l8="[object Uint32Array]",vi={};vi[e8]=vi[t8]=vi[n8]=vi[o8]=vi[r8]=vi[i8]=vi[s8]=vi[a8]=vi[l8]=!0;vi[NV]=vi[$V]=vi[JV]=vi[VV]=vi[QV]=vi[UV]=vi[jV]=vi[HV]=vi[GV]=vi[WV]=vi[qV]=vi[KV]=vi[ZV]=vi[YV]=vi[XV]=!1;function c8(e){return Wl(e)&&HS(e.length)&&!!vi[Rh(e)]}function WS(e){return function(t){return e(t)}}var iD=typeof ma=="object"&&ma&&!ma.nodeType&&ma,fv=iD&&typeof ga=="object"&&ga&&!ga.nodeType&&ga,u8=fv&&fv.exports===iD,fw=u8&&ZR.process,Ep=function(){try{var e=fv&&fv.require&&fv.require("util").types;return e||fw&&fw.binding&&fw.binding("util")}catch{}}(),XA=Ep&&Ep.isTypedArray,qS=XA?WS(XA):c8,d8=Object.prototype,h8=d8.hasOwnProperty;function sD(e,t){var i=$s(e),a=!i&&Iv(e),d=!i&&!a&&Av(e),g=!i&&!a&&!d&&qS(e),_=i||a||d||g,o=_?RV(e.length,String):[],S=o.length;for(var E in e)(t||h8.call(e,E))&&!(_&&(E=="length"||d&&(E=="offset"||E=="parent")||g&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||$b(E,S)))&&o.push(E);return o}function aD(e,t){return function(i){return e(t(i))}}var f8=aD(Object.keys,Object),p8=Object.prototype,m8=p8.hasOwnProperty;function g8(e){if(!GS(e))return f8(e);var t=[];for(var i in Object(e))m8.call(e,i)&&i!="constructor"&&t.push(i);return t}function n_(e){return Hp(e)?sD(e):g8(e)}function v8(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var _8=Object.prototype,y8=_8.hasOwnProperty;function b8(e){if(!Vs(e))return v8(e);var t=GS(e),i=[];for(var a in e)a=="constructor"&&(t||!y8.call(e,a))||i.push(a);return i}function o_(e){return Hp(e)?sD(e,!0):b8(e)}var x8=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,w8=/^\w*$/;function KS(e,t){if($s(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||Nb(e)?!0:w8.test(e)||!x8.test(e)||t!=null&&e in Object(t)}var kv=Lh(Object,"create");function S8(){this.__data__=kv?kv(null):{},this.size=0}function T8(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var C8="__lodash_hash_undefined__",E8=Object.prototype,M8=E8.hasOwnProperty;function I8(e){var t=this.__data__;if(kv){var i=t[e];return i===C8?void 0:i}return M8.call(t,e)?t[e]:void 0}var A8=Object.prototype,k8=A8.hasOwnProperty;function P8(e){var t=this.__data__;return kv?t[e]!==void 0:k8.call(t,e)}var R8="__lodash_hash_undefined__";function D8(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=kv&&t===void 0?R8:t,this}function Sh(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}Sh.prototype.clear=S8;Sh.prototype.delete=T8;Sh.prototype.get=I8;Sh.prototype.has=P8;Sh.prototype.set=D8;function L8(){this.__data__=[],this.size=0}function Vb(e,t){for(var i=e.length;i--;)if(t_(e[i][0],t))return i;return-1}var O8=Array.prototype,z8=O8.splice;function B8(e){var t=this.__data__,i=Vb(t,e);if(i<0)return!1;var a=t.length-1;return i==a?t.pop():z8.call(t,i,1),--this.size,!0}function F8(e){var t=this.__data__,i=Vb(t,e);return i<0?void 0:t[i][1]}function N8(e){return Vb(this.__data__,e)>-1}function $8(e,t){var i=this.__data__,a=Vb(i,e);return a<0?(++this.size,i.push([e,t])):i[a][1]=t,this}function Dc(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}Dc.prototype.clear=L8;Dc.prototype.delete=B8;Dc.prototype.get=F8;Dc.prototype.has=N8;Dc.prototype.set=$8;var Pv=Lh(wl,"Map");function V8(){this.size=0,this.__data__={hash:new Sh,map:new(Pv||Dc),string:new Sh}}function U8(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ub(e,t){var i=e.__data__;return U8(t)?i[typeof t=="string"?"string":"hash"]:i.map}function j8(e){var t=Ub(this,e).delete(e);return this.size-=t?1:0,t}function H8(e){return Ub(this,e).get(e)}function G8(e){return Ub(this,e).has(e)}function W8(e,t){var i=Ub(this,e),a=i.size;return i.set(e,t),this.size+=i.size==a?0:1,this}function Lc(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}Lc.prototype.clear=V8;Lc.prototype.delete=j8;Lc.prototype.get=H8;Lc.prototype.has=G8;Lc.prototype.set=W8;var q8="Expected a function";function jb(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(q8);var i=function(){var a=arguments,d=t?t.apply(this,a):a[0],g=i.cache;if(g.has(d))return g.get(d);var _=e.apply(this,a);return i.cache=g.set(d,_)||g,_};return i.cache=new(jb.Cache||Lc),i}jb.Cache=Lc;var K8=500;function Z8(e){var t=jb(e,function(a){return i.size===K8&&i.clear(),a}),i=t.cache;return t}var Y8=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,X8=/\\(\\)?/g,J8=Z8(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Y8,function(i,a,d,g){t.push(d?g.replace(X8,"$1"):a||i)}),t});function Q8(e){return e==null?"":XR(e)}function Gp(e,t){return $s(e)?e:KS(e,t)?[e]:J8(Q8(e))}var eU=1/0;function Wp(e){if(typeof e=="string"||Nb(e))return e;var t=e+"";return t=="0"&&1/e==-eU?"-0":t}function Hb(e,t){t=Gp(t,e);for(var i=0,a=t.length;e!=null&&i<a;)e=e[Wp(t[i++])];return i&&i==a?e:void 0}function xi(e,t,i){var a=e==null?void 0:Hb(e,t);return a===void 0?i:a}function ZS(e,t){for(var i=-1,a=t.length,d=e.length;++i<a;)e[d+i]=t[i];return e}var JA=$a?$a.isConcatSpreadable:void 0;function tU(e){return $s(e)||Iv(e)||!!(JA&&e&&e[JA])}function r_(e,t,i,a,d){var g=-1,_=e.length;for(i||(i=tU),d||(d=[]);++g<_;){var o=e[g];t>0&&i(o)?t>1?r_(o,t-1,i,a,d):ZS(d,o):a||(d[d.length]=o)}return d}function lD(e){var t=e==null?0:e.length;return t?r_(e,1):[]}function cD(e){return QR(tD(e,void 0,lD),e+"")}var YS=aD(Object.getPrototypeOf,Object),nU="[object Object]",oU=Function.prototype,rU=Object.prototype,uD=oU.toString,iU=rU.hasOwnProperty,sU=uD.call(Object);function dD(e){if(!Wl(e)||Rh(e)!=nU)return!1;var t=YS(e);if(t===null)return!0;var i=iU.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&uD.call(i)==sU}function aU(e,t,i){var a=-1,d=e.length;t<0&&(t=-t>d?0:d+t),i=i>d?d:i,i<0&&(i+=d),d=t>i?0:i-t>>>0,t>>>=0;for(var g=Array(d);++a<d;)g[a]=e[a+t];return g}function gs(){if(!arguments.length)return[];var e=arguments[0];return $s(e)?e:[e]}function lU(){this.__data__=new Dc,this.size=0}function cU(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function uU(e){return this.__data__.get(e)}function dU(e){return this.__data__.has(e)}var hU=200;function fU(e,t){var i=this.__data__;if(i instanceof Dc){var a=i.__data__;if(!Pv||a.length<hU-1)return a.push([e,t]),this.size=++i.size,this;i=this.__data__=new Lc(a)}return i.set(e,t),this.size=i.size,this}function gl(e){var t=this.__data__=new Dc(e);this.size=t.size}gl.prototype.clear=lU;gl.prototype.delete=cU;gl.prototype.get=uU;gl.prototype.has=dU;gl.prototype.set=fU;function pU(e,t){return e&&jp(t,n_(t),e)}function mU(e,t){return e&&jp(t,o_(t),e)}var hD=typeof ma=="object"&&ma&&!ma.nodeType&&ma,QA=hD&&typeof ga=="object"&&ga&&!ga.nodeType&&ga,gU=QA&&QA.exports===hD,ek=gU?wl.Buffer:void 0,tk=ek?ek.allocUnsafe:void 0;function fD(e,t){if(t)return e.slice();var i=e.length,a=tk?tk(i):new e.constructor(i);return e.copy(a),a}function vU(e,t){for(var i=-1,a=e==null?0:e.length,d=0,g=[];++i<a;){var _=e[i];t(_,i,e)&&(g[d++]=_)}return g}function pD(){return[]}var _U=Object.prototype,yU=_U.propertyIsEnumerable,nk=Object.getOwnPropertySymbols,XS=nk?function(e){return e==null?[]:(e=Object(e),vU(nk(e),function(t){return yU.call(e,t)}))}:pD;function bU(e,t){return jp(e,XS(e),t)}var xU=Object.getOwnPropertySymbols,mD=xU?function(e){for(var t=[];e;)ZS(t,XS(e)),e=YS(e);return t}:pD;function wU(e,t){return jp(e,mD(e),t)}function gD(e,t,i){var a=t(e);return $s(e)?a:ZS(a,i(e))}function a2(e){return gD(e,n_,XS)}function vD(e){return gD(e,o_,mD)}var l2=Lh(wl,"DataView"),c2=Lh(wl,"Promise"),gp=Lh(wl,"Set"),ok="[object Map]",SU="[object Object]",rk="[object Promise]",ik="[object Set]",sk="[object WeakMap]",ak="[object DataView]",TU=Dh(l2),CU=Dh(Pv),EU=Dh(c2),MU=Dh(gp),IU=Dh(s2),dl=Rh;(l2&&dl(new l2(new ArrayBuffer(1)))!=ak||Pv&&dl(new Pv)!=ok||c2&&dl(c2.resolve())!=rk||gp&&dl(new gp)!=ik||s2&&dl(new s2)!=sk)&&(dl=function(e){var t=Rh(e),i=t==SU?e.constructor:void 0,a=i?Dh(i):"";if(a)switch(a){case TU:return ak;case CU:return ok;case EU:return rk;case MU:return ik;case IU:return sk}return t});var AU=Object.prototype,kU=AU.hasOwnProperty;function PU(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&kU.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var ib=wl.Uint8Array;function JS(e){var t=new e.constructor(e.byteLength);return new ib(t).set(new ib(e)),t}function RU(e,t){var i=t?JS(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var DU=/\w*$/;function LU(e){var t=new e.constructor(e.source,DU.exec(e));return t.lastIndex=e.lastIndex,t}var lk=$a?$a.prototype:void 0,ck=lk?lk.valueOf:void 0;function OU(e){return ck?Object(ck.call(e)):{}}function _D(e,t){var i=t?JS(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var zU="[object Boolean]",BU="[object Date]",FU="[object Map]",NU="[object Number]",$U="[object RegExp]",VU="[object Set]",UU="[object String]",jU="[object Symbol]",HU="[object ArrayBuffer]",GU="[object DataView]",WU="[object Float32Array]",qU="[object Float64Array]",KU="[object Int8Array]",ZU="[object Int16Array]",YU="[object Int32Array]",XU="[object Uint8Array]",JU="[object Uint8ClampedArray]",QU="[object Uint16Array]",ej="[object Uint32Array]";function tj(e,t,i){var a=e.constructor;switch(t){case HU:return JS(e);case zU:case BU:return new a(+e);case GU:return RU(e,i);case WU:case qU:case KU:case ZU:case YU:case XU:case JU:case QU:case ej:return _D(e,i);case FU:return new a;case NU:case UU:return new a(e);case $U:return LU(e);case VU:return new a;case jU:return OU(e)}}function yD(e){return typeof e.constructor=="function"&&!GS(e)?uV(YS(e)):{}}var nj="[object Map]";function oj(e){return Wl(e)&&dl(e)==nj}var uk=Ep&&Ep.isMap,rj=uk?WS(uk):oj,ij="[object Set]";function sj(e){return Wl(e)&&dl(e)==ij}var dk=Ep&&Ep.isSet,aj=dk?WS(dk):sj,lj=1,cj=2,uj=4,bD="[object Arguments]",dj="[object Array]",hj="[object Boolean]",fj="[object Date]",pj="[object Error]",xD="[object Function]",mj="[object GeneratorFunction]",gj="[object Map]",vj="[object Number]",wD="[object Object]",_j="[object RegExp]",yj="[object Set]",bj="[object String]",xj="[object Symbol]",wj="[object WeakMap]",Sj="[object ArrayBuffer]",Tj="[object DataView]",Cj="[object Float32Array]",Ej="[object Float64Array]",Mj="[object Int8Array]",Ij="[object Int16Array]",Aj="[object Int32Array]",kj="[object Uint8Array]",Pj="[object Uint8ClampedArray]",Rj="[object Uint16Array]",Dj="[object Uint32Array]",ui={};ui[bD]=ui[dj]=ui[Sj]=ui[Tj]=ui[hj]=ui[fj]=ui[Cj]=ui[Ej]=ui[Mj]=ui[Ij]=ui[Aj]=ui[gj]=ui[vj]=ui[wD]=ui[_j]=ui[yj]=ui[bj]=ui[xj]=ui[kj]=ui[Pj]=ui[Rj]=ui[Dj]=!0;ui[pj]=ui[xD]=ui[wj]=!1;function vp(e,t,i,a,d,g){var _,o=t&lj,S=t&cj,E=t&uj;if(i&&(_=d?i(e,a,d,g):i(e)),_!==void 0)return _;if(!Vs(e))return e;var I=$s(e);if(I){if(_=PU(e),!o)return JR(e,_)}else{var R=dl(e),z=R==xD||R==mj;if(Av(e))return fD(e,o);if(R==wD||R==bD||z&&!d){if(_=S||z?{}:yD(e),!o)return S?wU(e,mU(_,e)):bU(e,pU(_,e))}else{if(!ui[R])return d?e:{};_=tj(e,R,o)}}g||(g=new gl);var N=g.get(e);if(N)return N;g.set(e,_),aj(e)?e.forEach(function(W){_.add(vp(W,t,i,W,e,g))}):rj(e)&&e.forEach(function(W,U){_.set(U,vp(W,t,i,U,e,g))});var $=E?S?vD:a2:S?o_:n_,F=I?void 0:$(e);return yV(F||e,function(W,U){F&&(U=W,W=e[U]),jS(_,U,vp(W,t,i,U,e,g))}),_}var Lj=4;function hk(e){return vp(e,Lj)}var Oj=1,zj=4;function sb(e){return vp(e,Oj|zj)}var Bj="__lodash_hash_undefined__";function Fj(e){return this.__data__.set(e,Bj),this}function Nj(e){return this.__data__.has(e)}function Rv(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new Lc;++t<i;)this.add(e[t])}Rv.prototype.add=Rv.prototype.push=Fj;Rv.prototype.has=Nj;function $j(e,t){for(var i=-1,a=e==null?0:e.length;++i<a;)if(t(e[i],i,e))return!0;return!1}function SD(e,t){return e.has(t)}var Vj=1,Uj=2;function TD(e,t,i,a,d,g){var _=i&Vj,o=e.length,S=t.length;if(o!=S&&!(_&&S>o))return!1;var E=g.get(e),I=g.get(t);if(E&&I)return E==t&&I==e;var R=-1,z=!0,N=i&Uj?new Rv:void 0;for(g.set(e,t),g.set(t,e);++R<o;){var $=e[R],F=t[R];if(a)var W=_?a(F,$,R,t,e,g):a($,F,R,e,t,g);if(W!==void 0){if(W)continue;z=!1;break}if(N){if(!$j(t,function(U,re){if(!SD(N,re)&&($===U||d($,U,i,a,g)))return N.push(re)})){z=!1;break}}else if(!($===F||d($,F,i,a,g))){z=!1;break}}return g.delete(e),g.delete(t),z}function jj(e){var t=-1,i=Array(e.size);return e.forEach(function(a,d){i[++t]=[d,a]}),i}function QS(e){var t=-1,i=Array(e.size);return e.forEach(function(a){i[++t]=a}),i}var Hj=1,Gj=2,Wj="[object Boolean]",qj="[object Date]",Kj="[object Error]",Zj="[object Map]",Yj="[object Number]",Xj="[object RegExp]",Jj="[object Set]",Qj="[object String]",eH="[object Symbol]",tH="[object ArrayBuffer]",nH="[object DataView]",fk=$a?$a.prototype:void 0,pw=fk?fk.valueOf:void 0;function oH(e,t,i,a,d,g,_){switch(i){case nH:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case tH:return!(e.byteLength!=t.byteLength||!g(new ib(e),new ib(t)));case Wj:case qj:case Yj:return t_(+e,+t);case Kj:return e.name==t.name&&e.message==t.message;case Xj:case Qj:return e==t+"";case Zj:var o=jj;case Jj:var S=a&Hj;if(o||(o=QS),e.size!=t.size&&!S)return!1;var E=_.get(e);if(E)return E==t;a|=Gj,_.set(e,t);var I=TD(o(e),o(t),a,d,g,_);return _.delete(e),I;case eH:if(pw)return pw.call(e)==pw.call(t)}return!1}var rH=1,iH=Object.prototype,sH=iH.hasOwnProperty;function aH(e,t,i,a,d,g){var _=i&rH,o=a2(e),S=o.length,E=a2(t),I=E.length;if(S!=I&&!_)return!1;for(var R=S;R--;){var z=o[R];if(!(_?z in t:sH.call(t,z)))return!1}var N=g.get(e),$=g.get(t);if(N&&$)return N==t&&$==e;var F=!0;g.set(e,t),g.set(t,e);for(var W=_;++R<S;){z=o[R];var U=e[z],re=t[z];if(a)var K=_?a(re,U,z,t,e,g):a(U,re,z,e,t,g);if(!(K===void 0?U===re||d(U,re,i,a,g):K)){F=!1;break}W||(W=z=="constructor")}if(F&&!W){var q=e.constructor,J=t.constructor;q!=J&&"constructor"in e&&"constructor"in t&&!(typeof q=="function"&&q instanceof q&&typeof J=="function"&&J instanceof J)&&(F=!1)}return g.delete(e),g.delete(t),F}var lH=1,pk="[object Arguments]",mk="[object Array]",u0="[object Object]",cH=Object.prototype,gk=cH.hasOwnProperty;function uH(e,t,i,a,d,g){var _=$s(e),o=$s(t),S=_?mk:dl(e),E=o?mk:dl(t);S=S==pk?u0:S,E=E==pk?u0:E;var I=S==u0,R=E==u0,z=S==E;if(z&&Av(e)){if(!Av(t))return!1;_=!0,I=!1}if(z&&!I)return g||(g=new gl),_||qS(e)?TD(e,t,i,a,d,g):oH(e,t,S,i,a,d,g);if(!(i&lH)){var N=I&&gk.call(e,"__wrapped__"),$=R&&gk.call(t,"__wrapped__");if(N||$){var F=N?e.value():e,W=$?t.value():t;return g||(g=new gl),d(F,W,i,a,g)}}return z?(g||(g=new gl),aH(e,t,i,a,d,g)):!1}function Gb(e,t,i,a,d){return e===t?!0:e==null||t==null||!Wl(e)&&!Wl(t)?e!==e&&t!==t:uH(e,t,i,a,Gb,d)}var dH=1,hH=2;function fH(e,t,i,a){var d=i.length,g=d;if(e==null)return!g;for(e=Object(e);d--;){var _=i[d];if(_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++d<g;){_=i[d];var o=_[0],S=e[o],E=_[1];if(_[2]){if(S===void 0&&!(o in e))return!1}else{var I=new gl,R;if(!(R===void 0?Gb(E,S,dH|hH,a,I):R))return!1}}return!0}function CD(e){return e===e&&!Vs(e)}function pH(e){for(var t=n_(e),i=t.length;i--;){var a=t[i],d=e[a];t[i]=[a,d,CD(d)]}return t}function ED(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==void 0||e in Object(i))}}function mH(e){var t=pH(e);return t.length==1&&t[0][2]?ED(t[0][0],t[0][1]):function(i){return i===e||fH(i,e,t)}}function gH(e,t){return e!=null&&t in Object(e)}function vH(e,t,i){t=Gp(t,e);for(var a=-1,d=t.length,g=!1;++a<d;){var _=Wp(t[a]);if(!(g=e!=null&&i(e,_)))break;e=e[_]}return g||++a!=d?g:(d=e==null?0:e.length,!!d&&HS(d)&&$b(_,d)&&($s(e)||Iv(e)))}function MD(e,t){return e!=null&&vH(e,t,gH)}var _H=1,yH=2;function bH(e,t){return KS(e)&&CD(t)?ED(Wp(e),t):function(i){var a=xi(i,e);return a===void 0&&a===t?MD(i,e):Gb(t,a,_H|yH)}}function xH(e){return function(t){return t==null?void 0:t[e]}}function wH(e){return function(t){return Hb(t,e)}}function SH(e){return KS(e)?xH(Wp(e)):wH(e)}function ID(e){return typeof e=="function"?e:e==null?$S:typeof e=="object"?$s(e)?bH(e[0],e[1]):mH(e):SH(e)}function TH(e){return function(t,i,a){for(var d=-1,g=Object(t),_=a(t),o=_.length;o--;){var S=_[++d];if(i(g[S],S,g)===!1)break}return t}}var AD=TH();function CH(e,t){return e&&AD(e,t,n_)}function EH(e,t){return function(i,a){if(i==null)return i;if(!Hp(i))return e(i,a);for(var d=i.length,g=-1,_=Object(i);++g<d&&a(_[g],g,_)!==!1;);return i}}var MH=EH(CH),mw=function(){return wl.Date.now()},IH="Expected a function",AH=Math.max,kH=Math.min;function Qs(e,t,i){var a,d,g,_,o,S,E=0,I=!1,R=!1,z=!0;if(typeof e!="function")throw new TypeError(IH);t=HA(t)||0,Vs(i)&&(I=!!i.leading,R="maxWait"in i,g=R?AH(HA(i.maxWait)||0,t):g,z="trailing"in i?!!i.trailing:z);function N(oe){var ae=a,fe=d;return a=d=void 0,E=oe,_=e.apply(fe,ae),_}function $(oe){return E=oe,o=setTimeout(U,t),I?N(oe):_}function F(oe){var ae=oe-S,fe=oe-E,ge=t-ae;return R?kH(ge,g-fe):ge}function W(oe){var ae=oe-S,fe=oe-E;return S===void 0||ae>=t||ae<0||R&&fe>=g}function U(){var oe=mw();if(W(oe))return re(oe);o=setTimeout(U,F(oe))}function re(oe){return o=void 0,z&&a?N(oe):(a=d=void 0,_)}function K(){o!==void 0&&clearTimeout(o),E=0,a=S=d=o=void 0}function q(){return o===void 0?_:re(mw())}function J(){var oe=mw(),ae=W(oe);if(a=arguments,d=this,S=oe,ae){if(o===void 0)return $(S);if(R)return clearTimeout(o),o=setTimeout(U,t),N(S)}return o===void 0&&(o=setTimeout(U,t)),_}return J.cancel=K,J.flush=q,J}function u2(e,t,i){(i!==void 0&&!t_(e[t],i)||i===void 0&&!(t in e))&&US(e,t,i)}function kD(e){return Wl(e)&&Hp(e)}function d2(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function PH(e){return jp(e,o_(e))}function RH(e,t,i,a,d,g,_){var o=d2(e,i),S=d2(t,i),E=_.get(S);if(E){u2(e,i,E);return}var I=g?g(o,S,i+"",e,t,_):void 0,R=I===void 0;if(R){var z=$s(S),N=!z&&Av(S),$=!z&&!N&&qS(S);I=S,z||N||$?$s(o)?I=o:kD(o)?I=JR(o):N?(R=!1,I=fD(S,!0)):$?(R=!1,I=_D(S,!0)):I=[]:dD(S)||Iv(S)?(I=o,Iv(o)?I=PH(o):(!Vs(o)||VS(o))&&(I=yD(S))):R=!1}R&&(_.set(S,I),d(I,S,a,g,_),_.delete(S)),u2(e,i,I)}function PD(e,t,i,a,d){e!==t&&AD(t,function(g,_){if(d||(d=new gl),Vs(g))RH(e,t,_,i,PD,a,d);else{var o=a?a(d2(e,_),g,_+"",e,t,d):void 0;o===void 0&&(o=g),u2(e,_,o)}},o_)}function DH(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function RD(e,t,i){var a=e==null?0:e.length;if(!a)return-1;var d=a-1;return eD(e,ID(t),d,!0)}function LH(e,t){var i=-1,a=Hp(e)?Array(e.length):[];return MH(e,function(d,g,_){a[++i]=t(d,g,_)}),a}function OH(e,t){var i=$s(e)?NS:LH;return i(e,ID(t))}function zH(e,t){return r_(OH(e,t),1)}var BH=1/0;function FH(e){var t=e==null?0:e.length;return t?r_(e,BH):[]}function Dv(e){for(var t=-1,i=e==null?0:e.length,a={};++t<i;){var d=e[t];a[d[0]]=d[1]}return a}function NH(e,t){return t.length<2?e:Hb(e,aU(t,0,-1))}function qi(e,t){return Gb(e,t)}function Pi(e){return e==null}function DD(e){return e===void 0}var LD=kV(function(e,t,i){PD(e,t,i)});function $H(e,t){return t=Gp(t,e),e=NH(e,t),e==null||delete e[Wp(DH(t))]}function VH(e){return dD(e)?void 0:e}var UH=1,jH=2,HH=4,GH=cD(function(e,t){var i={};if(e==null)return i;var a=!1;t=NS(t,function(g){return g=Gp(g,e),a||(a=g.length>1),g}),jp(e,vD(e),i),a&&(i=vp(i,UH|jH|HH,VH));for(var d=t.length;d--;)$H(i,t[d]);return i});function OD(e,t,i,a){if(!Vs(e))return e;t=Gp(t,e);for(var d=-1,g=t.length,_=g-1,o=e;o!=null&&++d<g;){var S=Wp(t[d]),E=i;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(d!=_){var I=o[S];E=void 0,E===void 0&&(E=Vs(I)?I:$b(t[d+1])?[]:{})}jS(o,S,E),o=o[S]}return e}function WH(e,t,i){for(var a=-1,d=t.length,g={};++a<d;){var _=t[a],o=Hb(e,_);i(o,_)&&OD(g,Gp(_,e),o)}return g}function qH(e,t){return WH(e,t,function(i,a){return MD(e,a)})}var fl=cD(function(e,t){return e==null?{}:qH(e,t)});function KH(e,t,i){return e==null?e:OD(e,t,i)}var ZH="Expected a function";function gh(e,t,i){var a=!0,d=!0;if(typeof e!="function")throw new TypeError(ZH);return Vs(i)&&(a="leading"in i?!!i.leading:a,d="trailing"in i?!!i.trailing:d),Qs(e,t,{leading:a,maxWait:t,trailing:d})}var YH=1/0,XH=gp&&1/QS(new gp([,-0]))[1]==YH?function(e){return new gp(e)}:hV,JH=200;function QH(e,t,i){var a=-1,d=SV,g=e.length,_=!0,o=[],S=o;if(g>=JH){var E=XH(e);if(E)return QS(E);_=!1,d=SD,S=new Rv}else S=o;e:for(;++a<g;){var I=e[a],R=I;if(I=I!==0?I:0,_&&R===R){for(var z=S.length;z--;)if(S[z]===R)continue e;o.push(I)}else d(S,R,i)||(S!==o&&S.push(R),o.push(I))}return o}var gw=nD(function(e){return QH(r_(e,1,kD,!0))});const jr=e=>e===void 0,Lr=e=>typeof e=="boolean",Wn=e=>typeof e=="number",ha=e=>!e&&e!==0||sn(e)&&e.length===0||So(e)&&!Object.keys(e).length,va=e=>typeof Element>"u"?!1:e instanceof Element,Th=e=>Pi(e),eG=e=>Bn(e)?!Number.isNaN(Number(e)):!1,Wb=e=>e===window,ed=e=>Wo?window.requestAnimationFrame(e):setTimeout(e,16),Ch=e=>Wo?window.cancelAnimationFrame(e):clearTimeout(e),eT=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Ul=e=>Xv(e),Mp=e=>Object.keys(e),tG=e=>Object.entries(e),D0=(e,t,i)=>({get value(){return xi(e,t,i)},set value(a){KH(e,t,a)}});class nG extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function Ai(e,t){throw new nG(`[${e}] ${t}`)}const zD=(e="")=>e.split(" ").filter(t=>!!t.trim()),Zs=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},Oa=(e,t)=>{!e||!t.trim()||e.classList.add(...zD(t))},ys=(e,t)=>{!e||!t.trim()||e.classList.remove(...zD(t))},Uu=(e,t)=>{var i;if(!Wo||!e||!t)return"";let a=Js(t);a==="float"&&(a="cssFloat");try{const d=e.style[a];if(d)return d;const g=(i=document.defaultView)==null?void 0:i.getComputedStyle(e,"");return g?g[a]:""}catch{return e.style[a]}};function fi(e,t="px"){if(!e)return"";if(Wn(e)||eG(e))return`${e}${t}`;if(Bn(e))return e}const oG=(e,t)=>{if(!Wo)return!1;const i={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],a=Uu(e,i);return["scroll","auto","overlay"].some(d=>a.includes(d))},tT=(e,t)=>{if(!Wo)return;let i=e;for(;i;){if([window,document,document.documentElement].includes(i))return window;if(oG(i,t))return i;i=i.parentNode}return i};let d0;const BD=e=>{var t;if(!Wo)return 0;if(d0!==void 0)return d0;const i=document.createElement("div");i.className=`${e}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const a=i.offsetWidth;i.style.overflow="scroll";const d=document.createElement("div");d.style.width="100%",i.appendChild(d);const g=d.offsetWidth;return(t=i.parentNode)==null||t.removeChild(i),d0=a-g,d0};function nT(e,t){if(!Wo)return;if(!t){e.scrollTop=0;return}const i=[];let a=t.offsetParent;for(;a!==null&&e!==a&&e.contains(a);)i.push(a),a=a.offsetParent;const d=t.offsetTop+i.reduce((S,E)=>S+E.offsetTop,0),g=d+t.offsetHeight,_=e.scrollTop,o=_+e.clientHeight;d<_?e.scrollTop=d:g>o&&(e.scrollTop=g-e.clientHeight)}function rG(e,t,i,a,d){const g=Date.now();let _;const o=()=>{const E=Date.now()-g,I=I$(E>a?a:E,t,i,a);Wb(e)?e.scrollTo(window.pageXOffset,I):e.scrollTop=I,E<a?_=ed(o):Nn(d)&&d()};return o(),()=>{_&&Ch(_)}}const vk=(e,t)=>Wb(t)?e.ownerDocument.documentElement:t,_k=e=>Wb(e)?window.scrollY:e.scrollTop,h0=e=>{if(!Wo||e==="")return null;if(Bn(e))try{return document.querySelector(e)}catch{return null}return e};/*! Element Plus Icons Vue v2.3.1 */var iG=qe({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),Oc=iG,sG=qe({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),td=sG,aG=qe({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),Fs=aG,lG=qe({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),oT=lG,cG=qe({name:"Back",__name:"back",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),je("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),uG=cG,dG=qe({name:"Calendar",__name:"calendar",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),hG=dG,fG=qe({name:"CaretRight",__name:"caret-right",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),FD=fG,pG=qe({name:"CaretTop",__name:"caret-top",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),mG=pG,gG=qe({name:"Check",__name:"check",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),i_=gG,vG=qe({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),_G=vG,yG=qe({name:"CircleCheck",__name:"circle-check",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),je("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),rT=yG,bG=qe({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),iT=bG,xG=qe({name:"CircleClose",__name:"circle-close",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),je("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),ud=xG,wG=qe({name:"Clock",__name:"clock",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),je("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),je("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),ND=wG,SG=qe({name:"Close",__name:"close",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),yl=SG,TG=qe({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),nd=TG,CG=qe({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),od=CG,EG=qe({name:"Delete",__name:"delete",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),MG=EG,IG=qe({name:"Document",__name:"document",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),AG=IG,kG=qe({name:"FullScreen",__name:"full-screen",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),PG=kG,RG=qe({name:"Hide",__name:"hide",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),je("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),DG=RG,LG=qe({name:"InfoFilled",__name:"info-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),sT=LG,OG=qe({name:"Loading",__name:"loading",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),ql=OG,zG=qe({name:"Minus",__name:"minus",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),BG=zG,FG=qe({name:"MoreFilled",__name:"more-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),yk=FG,NG=qe({name:"More",__name:"more",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),$G=NG,VG=qe({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),UG=VG,jG=qe({name:"Plus",__name:"plus",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),$D=jG,HG=qe({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),GG=HG,WG=qe({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),qG=WG,KG=qe({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),ZG=KG,YG=qe({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),XG=YG,JG=qe({name:"Search",__name:"search",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),QG=JG,eW=qe({name:"SortDown",__name:"sort-down",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),tW=eW,nW=qe({name:"SortUp",__name:"sort-up",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),oW=nW,rW=qe({name:"StarFilled",__name:"star-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),f0=rW,iW=qe({name:"Star",__name:"star",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),sW=iW,aW=qe({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),VD=aW,lW=qe({name:"View",__name:"view",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),cW=lW,uW=qe({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),qb=uW,dW=qe({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),UD=dW,hW=qe({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,i)=>(se(),Ie("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[je("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),fW=hW;const jD="__epPropKey",at=e=>e,pW=e=>So(e)&&!!e[jD],Sl=(e,t)=>{if(!So(e)||pW(e))return e;const{values:i,required:a,default:d,type:g,validator:_}=e,S={type:g,required:!!a,validator:i||_?E=>{let I=!1,R=[];if(i&&(R=Array.from(i),or(e,"default")&&R.push(d),I||(I=R.includes(E))),_&&(I||(I=_(E))),!I&&R.length>0){const z=[...new Set(R)].map(N=>JSON.stringify(N)).join(", ");l6(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${z}], got value ${JSON.stringify(E)}.`)}return I}:void 0,[jD]:!0};return or(e,"default")&&(S.default=d),S},cn=e=>Dv(Object.entries(e).map(([t,i])=>[t,Sl(i,t)])),Cr=at([String,Object,Function]),aT={Close:yl},lT={Close:yl,SuccessFilled:VD,InfoFilled:sT,WarningFilled:qb,CircleCloseFilled:iT},rd={success:VD,warning:qb,error:iT,info:sT},cT={validating:ql,success:rT,error:ud},uo=(e,t)=>{if(e.install=i=>{for(const a of[e,...Object.values(t??{})])i.component(a.name,a)},t)for(const[i,a]of Object.entries(t))e[i]=a;return e},HD=(e,t)=>(e.install=i=>{e._context=i._context,i.config.globalProperties[t]=e},e),mW=(e,t)=>(e.install=i=>{i.directive(t,e)},e),ri=e=>(e.install=xr,e),Kb=(...e)=>t=>{e.forEach(i=>{Nn(i)?i(t):i.value=t})},Cn={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},gW=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],vw=["sun","mon","tue","wed","thu","fri","sat"],xo="update:modelValue",Wr="change",Ns="input",bk=Symbol("INSTALLED_KEY"),ec=["","default","small","large"],GD=e=>["",...ec].includes(e);var Da=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Da||{});function h2(e){return Yr(e)&&e.type===Fn}function vW(e){return Yr(e)&&e.type===Ni}function _W(e){return Yr(e)&&!h2(e)&&!vW(e)}const yW=e=>{if(!Yr(e))return{};const t=e.props||{},i=(Yr(e.type)?e.type.props:void 0)||{},a={};return Object.keys(i).forEach(d=>{or(i[d],"default")&&(a[d]=i[d].default)}),Object.keys(t).forEach(d=>{a[Js(d)]=t[d]}),a},bW=e=>{if(!sn(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},qu=e=>{const t=sn(e)?e:[e],i=[];return t.forEach(a=>{var d;sn(a)?i.push(...qu(a)):Yr(a)&&((d=a.component)!=null&&d.subTree)?i.push(a,...qu(a.component.subTree)):Yr(a)&&sn(a.children)?i.push(...qu(a.children)):i.push(a)}),i},xk=e=>[...new Set(e)],zs=e=>!e&&e!==0?[]:sn(e)?e:[e],xW=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e),oi=e=>e;function wW(e){let t=0;const i=(...a)=>{t&&Ch(t),t=ed(()=>{e(...a),t=0})};return i.cancel=()=>{Ch(t),t=0},i}const SW=["class","style"],TW=/^on[A-Z]/,Zb=(e={})=>{const{excludeListeners:t=!1,excludeKeys:i}=e,a=ee(()=>((i==null?void 0:i.value)||[]).concat(SW)),d=To();return ee(d?()=>{var g;return Dv(Object.entries((g=d.proxy)==null?void 0:g.$attrs).filter(([_])=>!a.value.includes(_)&&!(t&&TW.test(_))))}:()=>({}))},Ku=({from:e,replacement:t,scope:i,version:a,ref:d,type:g="API"},_)=>{qt(()=>y(_),o=>{},{immediate:!0})},WD=(e,t,i,a)=>{let d={offsetX:0,offsetY:0};const g=E=>{const I=E.clientX,R=E.clientY,{offsetX:z,offsetY:N}=d,$=e.value.getBoundingClientRect(),F=$.left,W=$.top,U=$.width,re=$.height,K=document.documentElement.clientWidth,q=document.documentElement.clientHeight,J=-F+z,oe=-W+N,ae=K-F-U+z,fe=q-W-re+N,ge=de=>{let _e=z+de.clientX-I,Re=N+de.clientY-R;a!=null&&a.value||(_e=Math.min(Math.max(_e,J),ae),Re=Math.min(Math.max(Re,oe),fe)),d={offsetX:_e,offsetY:Re},e.value&&(e.value.style.transform=`translate(${fi(_e)}, ${fi(Re)})`)},ce=()=>{document.removeEventListener("mousemove",ge),document.removeEventListener("mouseup",ce)};document.addEventListener("mousemove",ge),document.addEventListener("mouseup",ce)},_=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",g)},o=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",g)},S=()=>{d={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")};return _o(()=>{ns(()=>{i.value?_():o()})}),Pr(()=>{o()}),{resetPosition:S}};var CW={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const EW=e=>(t,i)=>MW(t,i,y(e)),MW=(e,t,i)=>xi(i,e,e).replace(/\{(\w+)\}/g,(a,d)=>{var g;return`${(g=t==null?void 0:t[d])!=null?g:`{${d}}`}`}),IW=e=>{const t=ee(()=>y(e).name),i=Hr(e)?e:xe(e);return{lang:t,locale:i,t:EW(e)}},qD=Symbol("localeContextKey"),qo=e=>{const t=e||kn(qD,xe());return IW(ee(()=>t.value||CW))},pv="el",AW="is-",oh=(e,t,i,a,d)=>{let g=`${e}-${t}`;return i&&(g+=`-${i}`),a&&(g+=`__${a}`),d&&(g+=`--${d}`),g},KD=Symbol("namespaceContextKey"),uT=e=>{const t=e||(To()?kn(KD,xe(pv)):xe(pv));return ee(()=>y(t)||pv)},Xt=(e,t)=>{const i=uT(t);return{namespace:i,b:(F="")=>oh(i.value,e,F,"",""),e:F=>F?oh(i.value,e,"",F,""):"",m:F=>F?oh(i.value,e,"","",F):"",be:(F,W)=>F&&W?oh(i.value,e,F,W,""):"",em:(F,W)=>F&&W?oh(i.value,e,"",F,W):"",bm:(F,W)=>F&&W?oh(i.value,e,F,"",W):"",bem:(F,W,U)=>F&&W&&U?oh(i.value,e,F,W,U):"",is:(F,...W)=>{const U=W.length>=1?W[0]:!0;return F&&U?`${AW}${F}`:""},cssVar:F=>{const W={};for(const U in F)F[U]&&(W[`--${i.value}-${U}`]=F[U]);return W},cssVarName:F=>`--${i.value}-${F}`,cssVarBlock:F=>{const W={};for(const U in F)F[U]&&(W[`--${i.value}-${e}-${U}`]=F[U]);return W},cssVarBlockName:F=>`--${i.value}-${e}-${F}`}},dT=(e,t={})=>{Hr(e)||Ai("[useLockscreen]","You need to pass a ref param to this function");const i=t.ns||Xt("popup"),a=ee(()=>i.bm("parent","hidden"));if(!Wo||Zs(document.body,a.value))return;let d=0,g=!1,_="0";const o=()=>{setTimeout(()=>{typeof document>"u"||(ys(document==null?void 0:document.body,a.value),g&&document&&(document.body.style.width=_))},200)};qt(e,S=>{if(!S){o();return}g=!Zs(document.body,a.value),g&&(_=document.body.style.width),d=BD(i.namespace.value);const E=document.documentElement.clientHeight<document.body.scrollHeight,I=Uu(document.body,"overflowY");d>0&&(E||I==="scroll")&&g&&(document.body.style.width=`calc(100% - ${d}px)`),Oa(document.body,a.value)}),bP(()=>o())},kW=Sl({type:at(Boolean),default:null}),PW=Sl({type:at(Function)}),RW=e=>{const t=`update:${e}`,i=`onUpdate:${e}`,a=[t],d={[e]:kW,[i]:PW};return{useModelToggle:({indicator:_,toggleReason:o,shouldHideWhenRouteChanges:S,shouldProceed:E,onShow:I,onHide:R})=>{const z=To(),{emit:N}=z,$=z.props,F=ee(()=>Nn($[i])),W=ee(()=>$[e]===null),U=ae=>{_.value!==!0&&(_.value=!0,o&&(o.value=ae),Nn(I)&&I(ae))},re=ae=>{_.value!==!1&&(_.value=!1,o&&(o.value=ae),Nn(R)&&R(ae))},K=ae=>{if($.disabled===!0||Nn(E)&&!E())return;const fe=F.value&&Wo;fe&&N(t,!0),(W.value||!fe)&&U(ae)},q=ae=>{if($.disabled===!0||!Wo)return;const fe=F.value&&Wo;fe&&N(t,!1),(W.value||!fe)&&re(ae)},J=ae=>{Lr(ae)&&($.disabled&&ae?F.value&&N(t,!1):_.value!==ae&&(ae?U():re()))},oe=()=>{_.value?q():K()};return qt(()=>$[e],J),S&&z.appContext.config.globalProperties.$route!==void 0&&qt(()=>({...z.proxy.$route}),()=>{S.value&&_.value&&q()}),_o(()=>{J($[e])}),{hide:q,show:K,toggle:oe,hasUpdateHandler:F}},useModelToggleProps:d,useModelToggleEmits:a}},ZD=e=>{const t=To();return ee(()=>{var i,a;return(a=(i=t==null?void 0:t.proxy)==null?void 0:i.$props)==null?void 0:a[e]})};var Ys="top",Va="bottom",Ua="right",Xs="left",hT="auto",s_=[Ys,Va,Ua,Xs],Ip="start",Lv="end",DW="clippingParents",YD="viewport",Jg="popper",LW="reference",wk=s_.reduce(function(e,t){return e.concat([t+"-"+Ip,t+"-"+Lv])},[]),zc=[].concat(s_,[hT]).reduce(function(e,t){return e.concat([t,t+"-"+Ip,t+"-"+Lv])},[]),OW="beforeRead",zW="read",BW="afterRead",FW="beforeMain",NW="main",$W="afterMain",VW="beforeWrite",UW="write",jW="afterWrite",HW=[OW,zW,BW,FW,NW,$W,VW,UW,jW];function Kl(e){return e?(e.nodeName||"").toLowerCase():null}function Tl(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ap(e){var t=Tl(e).Element;return e instanceof t||e instanceof Element}function Fa(e){var t=Tl(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function fT(e){if(typeof ShadowRoot>"u")return!1;var t=Tl(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function GW(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var a=t.styles[i]||{},d=t.attributes[i]||{},g=t.elements[i];!Fa(g)||!Kl(g)||(Object.assign(g.style,a),Object.keys(d).forEach(function(_){var o=d[_];o===!1?g.removeAttribute(_):g.setAttribute(_,o===!0?"":o)}))})}function WW(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(a){var d=t.elements[a],g=t.attributes[a]||{},_=Object.keys(t.styles.hasOwnProperty(a)?t.styles[a]:i[a]),o=_.reduce(function(S,E){return S[E]="",S},{});!Fa(d)||!Kl(d)||(Object.assign(d.style,o),Object.keys(g).forEach(function(S){d.removeAttribute(S)}))})}}var XD={name:"applyStyles",enabled:!0,phase:"write",fn:GW,effect:WW,requires:["computeStyles"]};function Hl(e){return e.split("-")[0]}var vh=Math.max,ab=Math.min,kp=Math.round;function Pp(e,t){t===void 0&&(t=!1);var i=e.getBoundingClientRect(),a=1,d=1;if(Fa(e)&&t){var g=e.offsetHeight,_=e.offsetWidth;_>0&&(a=kp(i.width)/_||1),g>0&&(d=kp(i.height)/g||1)}return{width:i.width/a,height:i.height/d,top:i.top/d,right:i.right/a,bottom:i.bottom/d,left:i.left/a,x:i.left/a,y:i.top/d}}function pT(e){var t=Pp(e),i=e.offsetWidth,a=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-a)<=1&&(a=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:a}}function JD(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&fT(i)){var a=t;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function Ac(e){return Tl(e).getComputedStyle(e)}function qW(e){return["table","td","th"].indexOf(Kl(e))>=0}function dd(e){return((Ap(e)?e.ownerDocument:e.document)||window.document).documentElement}function Yb(e){return Kl(e)==="html"?e:e.assignedSlot||e.parentNode||(fT(e)?e.host:null)||dd(e)}function Sk(e){return!Fa(e)||Ac(e).position==="fixed"?null:e.offsetParent}function KW(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,i=navigator.userAgent.indexOf("Trident")!==-1;if(i&&Fa(e)){var a=Ac(e);if(a.position==="fixed")return null}var d=Yb(e);for(fT(d)&&(d=d.host);Fa(d)&&["html","body"].indexOf(Kl(d))<0;){var g=Ac(d);if(g.transform!=="none"||g.perspective!=="none"||g.contain==="paint"||["transform","perspective"].indexOf(g.willChange)!==-1||t&&g.willChange==="filter"||t&&g.filter&&g.filter!=="none")return d;d=d.parentNode}return null}function a_(e){for(var t=Tl(e),i=Sk(e);i&&qW(i)&&Ac(i).position==="static";)i=Sk(i);return i&&(Kl(i)==="html"||Kl(i)==="body"&&Ac(i).position==="static")?t:i||KW(e)||t}function mT(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function mv(e,t,i){return vh(e,ab(t,i))}function ZW(e,t,i){var a=mv(e,t,i);return a>i?i:a}function QD(){return{top:0,right:0,bottom:0,left:0}}function eL(e){return Object.assign({},QD(),e)}function tL(e,t){return t.reduce(function(i,a){return i[a]=e,i},{})}var YW=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,eL(typeof e!="number"?e:tL(e,s_))};function XW(e){var t,i=e.state,a=e.name,d=e.options,g=i.elements.arrow,_=i.modifiersData.popperOffsets,o=Hl(i.placement),S=mT(o),E=[Xs,Ua].indexOf(o)>=0,I=E?"height":"width";if(!(!g||!_)){var R=YW(d.padding,i),z=pT(g),N=S==="y"?Ys:Xs,$=S==="y"?Va:Ua,F=i.rects.reference[I]+i.rects.reference[S]-_[S]-i.rects.popper[I],W=_[S]-i.rects.reference[S],U=a_(g),re=U?S==="y"?U.clientHeight||0:U.clientWidth||0:0,K=F/2-W/2,q=R[N],J=re-z[I]-R[$],oe=re/2-z[I]/2+K,ae=mv(q,oe,J),fe=S;i.modifiersData[a]=(t={},t[fe]=ae,t.centerOffset=ae-oe,t)}}function JW(e){var t=e.state,i=e.options,a=i.element,d=a===void 0?"[data-popper-arrow]":a;d!=null&&(typeof d=="string"&&(d=t.elements.popper.querySelector(d),!d)||!JD(t.elements.popper,d)||(t.elements.arrow=d))}var QW={name:"arrow",enabled:!0,phase:"main",fn:XW,effect:JW,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rp(e){return e.split("-")[1]}var e9={top:"auto",right:"auto",bottom:"auto",left:"auto"};function t9(e){var t=e.x,i=e.y,a=window,d=a.devicePixelRatio||1;return{x:kp(t*d)/d||0,y:kp(i*d)/d||0}}function Tk(e){var t,i=e.popper,a=e.popperRect,d=e.placement,g=e.variation,_=e.offsets,o=e.position,S=e.gpuAcceleration,E=e.adaptive,I=e.roundOffsets,R=e.isFixed,z=_.x,N=z===void 0?0:z,$=_.y,F=$===void 0?0:$,W=typeof I=="function"?I({x:N,y:F}):{x:N,y:F};N=W.x,F=W.y;var U=_.hasOwnProperty("x"),re=_.hasOwnProperty("y"),K=Xs,q=Ys,J=window;if(E){var oe=a_(i),ae="clientHeight",fe="clientWidth";if(oe===Tl(i)&&(oe=dd(i),Ac(oe).position!=="static"&&o==="absolute"&&(ae="scrollHeight",fe="scrollWidth")),oe=oe,d===Ys||(d===Xs||d===Ua)&&g===Lv){q=Va;var ge=R&&oe===J&&J.visualViewport?J.visualViewport.height:oe[ae];F-=ge-a.height,F*=S?1:-1}if(d===Xs||(d===Ys||d===Va)&&g===Lv){K=Ua;var ce=R&&oe===J&&J.visualViewport?J.visualViewport.width:oe[fe];N-=ce-a.width,N*=S?1:-1}}var de=Object.assign({position:o},E&&e9),_e=I===!0?t9({x:N,y:F}):{x:N,y:F};if(N=_e.x,F=_e.y,S){var Re;return Object.assign({},de,(Re={},Re[q]=re?"0":"",Re[K]=U?"0":"",Re.transform=(J.devicePixelRatio||1)<=1?"translate("+N+"px, "+F+"px)":"translate3d("+N+"px, "+F+"px, 0)",Re))}return Object.assign({},de,(t={},t[q]=re?F+"px":"",t[K]=U?N+"px":"",t.transform="",t))}function n9(e){var t=e.state,i=e.options,a=i.gpuAcceleration,d=a===void 0?!0:a,g=i.adaptive,_=g===void 0?!0:g,o=i.roundOffsets,S=o===void 0?!0:o,E={placement:Hl(t.placement),variation:Rp(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:d,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Tk(Object.assign({},E,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:_,roundOffsets:S})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Tk(Object.assign({},E,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:S})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var nL={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:n9,data:{}},p0={passive:!0};function o9(e){var t=e.state,i=e.instance,a=e.options,d=a.scroll,g=d===void 0?!0:d,_=a.resize,o=_===void 0?!0:_,S=Tl(t.elements.popper),E=[].concat(t.scrollParents.reference,t.scrollParents.popper);return g&&E.forEach(function(I){I.addEventListener("scroll",i.update,p0)}),o&&S.addEventListener("resize",i.update,p0),function(){g&&E.forEach(function(I){I.removeEventListener("scroll",i.update,p0)}),o&&S.removeEventListener("resize",i.update,p0)}}var oL={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:o9,data:{}},r9={left:"right",right:"left",bottom:"top",top:"bottom"};function L0(e){return e.replace(/left|right|bottom|top/g,function(t){return r9[t]})}var i9={start:"end",end:"start"};function Ck(e){return e.replace(/start|end/g,function(t){return i9[t]})}function gT(e){var t=Tl(e),i=t.pageXOffset,a=t.pageYOffset;return{scrollLeft:i,scrollTop:a}}function vT(e){return Pp(dd(e)).left+gT(e).scrollLeft}function s9(e){var t=Tl(e),i=dd(e),a=t.visualViewport,d=i.clientWidth,g=i.clientHeight,_=0,o=0;return a&&(d=a.width,g=a.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(_=a.offsetLeft,o=a.offsetTop)),{width:d,height:g,x:_+vT(e),y:o}}function a9(e){var t,i=dd(e),a=gT(e),d=(t=e.ownerDocument)==null?void 0:t.body,g=vh(i.scrollWidth,i.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),_=vh(i.scrollHeight,i.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),o=-a.scrollLeft+vT(e),S=-a.scrollTop;return Ac(d||i).direction==="rtl"&&(o+=vh(i.clientWidth,d?d.clientWidth:0)-g),{width:g,height:_,x:o,y:S}}function _T(e){var t=Ac(e),i=t.overflow,a=t.overflowX,d=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+d+a)}function rL(e){return["html","body","#document"].indexOf(Kl(e))>=0?e.ownerDocument.body:Fa(e)&&_T(e)?e:rL(Yb(e))}function gv(e,t){var i;t===void 0&&(t=[]);var a=rL(e),d=a===((i=e.ownerDocument)==null?void 0:i.body),g=Tl(a),_=d?[g].concat(g.visualViewport||[],_T(a)?a:[]):a,o=t.concat(_);return d?o:o.concat(gv(Yb(_)))}function f2(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function l9(e){var t=Pp(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function Ek(e,t){return t===YD?f2(s9(e)):Ap(t)?l9(t):f2(a9(dd(e)))}function c9(e){var t=gv(Yb(e)),i=["absolute","fixed"].indexOf(Ac(e).position)>=0,a=i&&Fa(e)?a_(e):e;return Ap(a)?t.filter(function(d){return Ap(d)&&JD(d,a)&&Kl(d)!=="body"}):[]}function u9(e,t,i){var a=t==="clippingParents"?c9(e):[].concat(t),d=[].concat(a,[i]),g=d[0],_=d.reduce(function(o,S){var E=Ek(e,S);return o.top=vh(E.top,o.top),o.right=ab(E.right,o.right),o.bottom=ab(E.bottom,o.bottom),o.left=vh(E.left,o.left),o},Ek(e,g));return _.width=_.right-_.left,_.height=_.bottom-_.top,_.x=_.left,_.y=_.top,_}function iL(e){var t=e.reference,i=e.element,a=e.placement,d=a?Hl(a):null,g=a?Rp(a):null,_=t.x+t.width/2-i.width/2,o=t.y+t.height/2-i.height/2,S;switch(d){case Ys:S={x:_,y:t.y-i.height};break;case Va:S={x:_,y:t.y+t.height};break;case Ua:S={x:t.x+t.width,y:o};break;case Xs:S={x:t.x-i.width,y:o};break;default:S={x:t.x,y:t.y}}var E=d?mT(d):null;if(E!=null){var I=E==="y"?"height":"width";switch(g){case Ip:S[E]=S[E]-(t[I]/2-i[I]/2);break;case Lv:S[E]=S[E]+(t[I]/2-i[I]/2);break}}return S}function Ov(e,t){t===void 0&&(t={});var i=t,a=i.placement,d=a===void 0?e.placement:a,g=i.boundary,_=g===void 0?DW:g,o=i.rootBoundary,S=o===void 0?YD:o,E=i.elementContext,I=E===void 0?Jg:E,R=i.altBoundary,z=R===void 0?!1:R,N=i.padding,$=N===void 0?0:N,F=eL(typeof $!="number"?$:tL($,s_)),W=I===Jg?LW:Jg,U=e.rects.popper,re=e.elements[z?W:I],K=u9(Ap(re)?re:re.contextElement||dd(e.elements.popper),_,S),q=Pp(e.elements.reference),J=iL({reference:q,element:U,placement:d}),oe=f2(Object.assign({},U,J)),ae=I===Jg?oe:q,fe={top:K.top-ae.top+F.top,bottom:ae.bottom-K.bottom+F.bottom,left:K.left-ae.left+F.left,right:ae.right-K.right+F.right},ge=e.modifiersData.offset;if(I===Jg&&ge){var ce=ge[d];Object.keys(fe).forEach(function(de){var _e=[Ua,Va].indexOf(de)>=0?1:-1,Re=[Ys,Va].indexOf(de)>=0?"y":"x";fe[de]+=ce[Re]*_e})}return fe}function d9(e,t){t===void 0&&(t={});var i=t,a=i.placement,d=i.boundary,g=i.rootBoundary,_=i.padding,o=i.flipVariations,S=i.allowedAutoPlacements,E=S===void 0?zc:S,I=Rp(a),R=I?o?wk:wk.filter(function($){return Rp($)===I}):s_,z=R.filter(function($){return E.indexOf($)>=0});z.length===0&&(z=R);var N=z.reduce(function($,F){return $[F]=Ov(e,{placement:F,boundary:d,rootBoundary:g,padding:_})[Hl(F)],$},{});return Object.keys(N).sort(function($,F){return N[$]-N[F]})}function h9(e){if(Hl(e)===hT)return[];var t=L0(e);return[Ck(e),t,Ck(t)]}function f9(e){var t=e.state,i=e.options,a=e.name;if(!t.modifiersData[a]._skip){for(var d=i.mainAxis,g=d===void 0?!0:d,_=i.altAxis,o=_===void 0?!0:_,S=i.fallbackPlacements,E=i.padding,I=i.boundary,R=i.rootBoundary,z=i.altBoundary,N=i.flipVariations,$=N===void 0?!0:N,F=i.allowedAutoPlacements,W=t.options.placement,U=Hl(W),re=U===W,K=S||(re||!$?[L0(W)]:h9(W)),q=[W].concat(K).reduce(function(Ct,Rt){return Ct.concat(Hl(Rt)===hT?d9(t,{placement:Rt,boundary:I,rootBoundary:R,padding:E,flipVariations:$,allowedAutoPlacements:F}):Rt)},[]),J=t.rects.reference,oe=t.rects.popper,ae=new Map,fe=!0,ge=q[0],ce=0;ce<q.length;ce++){var de=q[ce],_e=Hl(de),Re=Rp(de)===Ip,Qe=[Ys,Va].indexOf(_e)>=0,Ee=Qe?"width":"height",ye=Ov(t,{placement:de,boundary:I,rootBoundary:R,altBoundary:z,padding:E}),Me=Qe?Re?Ua:Xs:Re?Va:Ys;J[Ee]>oe[Ee]&&(Me=L0(Me));var Te=L0(Me),he=[];if(g&&he.push(ye[_e]<=0),o&&he.push(ye[Me]<=0,ye[Te]<=0),he.every(function(Ct){return Ct})){ge=de,fe=!1;break}ae.set(de,he)}if(fe)for(var ke=$?3:1,Ne=function(Ct){var Rt=q.find(function(Bt){var mt=ae.get(Bt);if(mt)return mt.slice(0,Ct).every(function(Gt){return Gt})});if(Rt)return ge=Rt,"break"},nt=ke;nt>0;nt--){var De=Ne(nt);if(De==="break")break}t.placement!==ge&&(t.modifiersData[a]._skip=!0,t.placement=ge,t.reset=!0)}}var p9={name:"flip",enabled:!0,phase:"main",fn:f9,requiresIfExists:["offset"],data:{_skip:!1}};function Mk(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Ik(e){return[Ys,Ua,Va,Xs].some(function(t){return e[t]>=0})}function m9(e){var t=e.state,i=e.name,a=t.rects.reference,d=t.rects.popper,g=t.modifiersData.preventOverflow,_=Ov(t,{elementContext:"reference"}),o=Ov(t,{altBoundary:!0}),S=Mk(_,a),E=Mk(o,d,g),I=Ik(S),R=Ik(E);t.modifiersData[i]={referenceClippingOffsets:S,popperEscapeOffsets:E,isReferenceHidden:I,hasPopperEscaped:R},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":I,"data-popper-escaped":R})}var g9={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:m9};function v9(e,t,i){var a=Hl(e),d=[Xs,Ys].indexOf(a)>=0?-1:1,g=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,_=g[0],o=g[1];return _=_||0,o=(o||0)*d,[Xs,Ua].indexOf(a)>=0?{x:o,y:_}:{x:_,y:o}}function _9(e){var t=e.state,i=e.options,a=e.name,d=i.offset,g=d===void 0?[0,0]:d,_=zc.reduce(function(I,R){return I[R]=v9(R,t.rects,g),I},{}),o=_[t.placement],S=o.x,E=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=S,t.modifiersData.popperOffsets.y+=E),t.modifiersData[a]=_}var y9={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:_9};function b9(e){var t=e.state,i=e.name;t.modifiersData[i]=iL({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}var sL={name:"popperOffsets",enabled:!0,phase:"read",fn:b9,data:{}};function x9(e){return e==="x"?"y":"x"}function w9(e){var t=e.state,i=e.options,a=e.name,d=i.mainAxis,g=d===void 0?!0:d,_=i.altAxis,o=_===void 0?!1:_,S=i.boundary,E=i.rootBoundary,I=i.altBoundary,R=i.padding,z=i.tether,N=z===void 0?!0:z,$=i.tetherOffset,F=$===void 0?0:$,W=Ov(t,{boundary:S,rootBoundary:E,padding:R,altBoundary:I}),U=Hl(t.placement),re=Rp(t.placement),K=!re,q=mT(U),J=x9(q),oe=t.modifiersData.popperOffsets,ae=t.rects.reference,fe=t.rects.popper,ge=typeof F=="function"?F(Object.assign({},t.rects,{placement:t.placement})):F,ce=typeof ge=="number"?{mainAxis:ge,altAxis:ge}:Object.assign({mainAxis:0,altAxis:0},ge),de=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,_e={x:0,y:0};if(oe){if(g){var Re,Qe=q==="y"?Ys:Xs,Ee=q==="y"?Va:Ua,ye=q==="y"?"height":"width",Me=oe[q],Te=Me+W[Qe],he=Me-W[Ee],ke=N?-fe[ye]/2:0,Ne=re===Ip?ae[ye]:fe[ye],nt=re===Ip?-fe[ye]:-ae[ye],De=t.elements.arrow,Ct=N&&De?pT(De):{width:0,height:0},Rt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:QD(),Bt=Rt[Qe],mt=Rt[Ee],Gt=mv(0,ae[ye],Ct[ye]),jt=K?ae[ye]/2-ke-Gt-Bt-ce.mainAxis:Ne-Gt-Bt-ce.mainAxis,Be=K?-ae[ye]/2+ke+Gt+mt+ce.mainAxis:nt+Gt+mt+ce.mainAxis,an=t.elements.arrow&&a_(t.elements.arrow),At=an?q==="y"?an.clientTop||0:an.clientLeft||0:0,Ge=(Re=de==null?void 0:de[q])!=null?Re:0,Fe=Me+jt-Ge-At,Nt=Me+Be-Ge,Jt=mv(N?ab(Te,Fe):Te,Me,N?vh(he,Nt):he);oe[q]=Jt,_e[q]=Jt-Me}if(o){var Dt,xt=q==="x"?Ys:Xs,Ot=q==="x"?Va:Ua,en=oe[J],dn=J==="y"?"height":"width",un=en+W[xt],Pn=en-W[Ot],gt=[Ys,Xs].indexOf(U)!==-1,Sn=(Dt=de==null?void 0:de[J])!=null?Dt:0,Vn=gt?un:en-ae[dn]-fe[dn]-Sn+ce.altAxis,lo=gt?en+ae[dn]+fe[dn]-Sn-ce.altAxis:Pn,eo=N&&gt?ZW(Vn,en,lo):mv(N?Vn:un,en,N?lo:Pn);oe[J]=eo,_e[J]=eo-en}t.modifiersData[a]=_e}}var S9={name:"preventOverflow",enabled:!0,phase:"main",fn:w9,requiresIfExists:["offset"]};function T9(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function C9(e){return e===Tl(e)||!Fa(e)?gT(e):T9(e)}function E9(e){var t=e.getBoundingClientRect(),i=kp(t.width)/e.offsetWidth||1,a=kp(t.height)/e.offsetHeight||1;return i!==1||a!==1}function M9(e,t,i){i===void 0&&(i=!1);var a=Fa(t),d=Fa(t)&&E9(t),g=dd(t),_=Pp(e,d),o={scrollLeft:0,scrollTop:0},S={x:0,y:0};return(a||!a&&!i)&&((Kl(t)!=="body"||_T(g))&&(o=C9(t)),Fa(t)?(S=Pp(t,!0),S.x+=t.clientLeft,S.y+=t.clientTop):g&&(S.x=vT(g))),{x:_.left+o.scrollLeft-S.x,y:_.top+o.scrollTop-S.y,width:_.width,height:_.height}}function I9(e){var t=new Map,i=new Set,a=[];e.forEach(function(g){t.set(g.name,g)});function d(g){i.add(g.name);var _=[].concat(g.requires||[],g.requiresIfExists||[]);_.forEach(function(o){if(!i.has(o)){var S=t.get(o);S&&d(S)}}),a.push(g)}return e.forEach(function(g){i.has(g.name)||d(g)}),a}function A9(e){var t=I9(e);return HW.reduce(function(i,a){return i.concat(t.filter(function(d){return d.phase===a}))},[])}function k9(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function P9(e){var t=e.reduce(function(i,a){var d=i[a.name];return i[a.name]=d?Object.assign({},d,a,{options:Object.assign({},d.options,a.options),data:Object.assign({},d.data,a.data)}):a,i},{});return Object.keys(t).map(function(i){return t[i]})}var Ak={placement:"bottom",modifiers:[],strategy:"absolute"};function kk(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function yT(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,a=i===void 0?[]:i,d=t.defaultOptions,g=d===void 0?Ak:d;return function(_,o,S){S===void 0&&(S=g);var E={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ak,g),modifiersData:{},elements:{reference:_,popper:o},attributes:{},styles:{}},I=[],R=!1,z={state:E,setOptions:function(F){var W=typeof F=="function"?F(E.options):F;$(),E.options=Object.assign({},g,E.options,W),E.scrollParents={reference:Ap(_)?gv(_):_.contextElement?gv(_.contextElement):[],popper:gv(o)};var U=A9(P9([].concat(a,E.options.modifiers)));return E.orderedModifiers=U.filter(function(re){return re.enabled}),N(),z.update()},forceUpdate:function(){if(!R){var F=E.elements,W=F.reference,U=F.popper;if(kk(W,U)){E.rects={reference:M9(W,a_(U),E.options.strategy==="fixed"),popper:pT(U)},E.reset=!1,E.placement=E.options.placement,E.orderedModifiers.forEach(function(fe){return E.modifiersData[fe.name]=Object.assign({},fe.data)});for(var re=0;re<E.orderedModifiers.length;re++){if(E.reset===!0){E.reset=!1,re=-1;continue}var K=E.orderedModifiers[re],q=K.fn,J=K.options,oe=J===void 0?{}:J,ae=K.name;typeof q=="function"&&(E=q({state:E,options:oe,name:ae,instance:z})||E)}}}},update:k9(function(){return new Promise(function(F){z.forceUpdate(),F(E)})}),destroy:function(){$(),R=!0}};if(!kk(_,o))return z;z.setOptions(S).then(function(F){!R&&S.onFirstUpdate&&S.onFirstUpdate(F)});function N(){E.orderedModifiers.forEach(function(F){var W=F.name,U=F.options,re=U===void 0?{}:U,K=F.effect;if(typeof K=="function"){var q=K({state:E,name:W,instance:z,options:re}),J=function(){};I.push(q||J)}})}function $(){I.forEach(function(F){return F()}),I=[]}return z}}yT();var R9=[oL,sL,nL,XD];yT({defaultModifiers:R9});var D9=[oL,sL,nL,XD,y9,p9,S9,QW,g9],L9=yT({defaultModifiers:D9});const O9=(e,t,i={})=>{const a={name:"updateState",enabled:!0,phase:"write",fn:({state:S})=>{const E=z9(S);Object.assign(_.value,E)},requires:["computeStyles"]},d=ee(()=>{const{onFirstUpdate:S,placement:E,strategy:I,modifiers:R}=y(i);return{onFirstUpdate:S,placement:E||"bottom",strategy:I||"absolute",modifiers:[...R||[],a,{name:"applyStyles",enabled:!1}]}}),g=qr(),_=xe({styles:{popper:{position:y(d).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),o=()=>{g.value&&(g.value.destroy(),g.value=void 0)};return qt(d,S=>{const E=y(g);E&&E.setOptions(S)},{deep:!0}),qt([e,t],([S,E])=>{o(),!(!S||!E)&&(g.value=L9(S,E,y(d)))}),Pr(()=>{o()}),{state:ee(()=>{var S;return{...((S=y(g))==null?void 0:S.state)||{}}}),styles:ee(()=>y(_).styles),attributes:ee(()=>y(_).attributes),update:()=>{var S;return(S=y(g))==null?void 0:S.update()},forceUpdate:()=>{var S;return(S=y(g))==null?void 0:S.forceUpdate()},instanceRef:ee(()=>y(g))}};function z9(e){const t=Object.keys(e.elements),i=Dv(t.map(d=>[d,e.styles[d]||{}])),a=Dv(t.map(d=>[d,e.attributes[d]]));return{styles:i,attributes:a}}const bT=e=>{if(!e)return{onClick:xr,onMousedown:xr,onMouseup:xr};let t=!1,i=!1;return{onClick:_=>{t&&i&&e(_),t=i=!1},onMousedown:_=>{t=_.target===_.currentTarget},onMouseup:_=>{i=_.target===_.currentTarget}}},B9=(e,t=0)=>{if(t===0)return e;const i=So(t)&&!!t.initVal,a=xe(i);let d=null;const g=o=>{if(jr(o)){a.value=e.value;return}d&&clearTimeout(d),d=setTimeout(()=>{a.value=e.value},o)},_=o=>{o==="leading"?Wn(t)?g(t):g(t.leading):So(t)?g(t.trailing):a.value=!1};return _o(()=>_("leading")),qt(()=>e.value,o=>{_(o?"leading":"trailing")}),a};function Pk(){let e;const t=(a,d)=>{i(),e=window.setTimeout(a,d)},i=()=>window.clearTimeout(e);return e_(()=>i()),{registerTimeout:t,cancelTimeout:i}}const Rk={prefix:Math.floor(Math.random()*1e4),current:0},F9=Symbol("elIdInjection"),xT=()=>To()?kn(F9,Rk):Rk,Ki=e=>{const t=xT(),i=uT();return n2(()=>y(e)||`${i.value}-id-${t.prefix}-${t.current++}`)};let op=[];const Dk=e=>{e.code===Cn.esc&&op.forEach(t=>t(e))},N9=e=>{_o(()=>{op.length===0&&document.addEventListener("keydown",Dk),Wo&&op.push(e)}),Pr(()=>{op=op.filter(t=>t!==e),op.length===0&&Wo&&document.removeEventListener("keydown",Dk)})},aL=()=>{const e=uT(),t=xT(),i=ee(()=>`${e.value}-popper-container-${t.prefix}`),a=ee(()=>`#${i.value}`);return{id:i,selector:a}},$9=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},V9=()=>{const{id:e,selector:t}=aL();return Ob(()=>{Wo&&(document.body.querySelector(t.value)||$9(e.value))}),{id:e,selector:t}},U9=cn({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),j9=({showAfter:e,hideAfter:t,autoClose:i,open:a,close:d})=>{const{registerTimeout:g}=Pk(),{registerTimeout:_,cancelTimeout:o}=Pk();return{onOpen:I=>{g(()=>{a(I);const R=y(i);Wn(R)&&R>0&&_(()=>{d(I)},R)},y(e))},onClose:I=>{o(),g(()=>{d(I)},y(t))}}},lL=Symbol("elForwardRef"),H9=e=>{Bo(lL,{setForwardRef:i=>{e.value=i}})},G9=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),Lk={current:0},Ok=xe(0),cL=2e3,zk=Symbol("elZIndexContextKey"),uL=Symbol("zIndexContextKey"),qp=e=>{const t=To()?kn(zk,Lk):Lk,i=e||(To()?kn(uL,void 0):void 0),a=ee(()=>{const _=y(i);return Wn(_)?_:cL}),d=ee(()=>a.value+Ok.value),g=()=>(t.current++,Ok.value=t.current,d.value);return!Wo&&kn(zk),{initialZIndex:a,currentZIndex:d,nextZIndex:g}},Dp=Math.min,_h=Math.max,lb=Math.round,m0=Math.floor,Gl=e=>({x:e,y:e}),W9={left:"right",right:"left",bottom:"top",top:"bottom"},q9={start:"end",end:"start"};function p2(e,t,i){return _h(e,Dp(t,i))}function l_(e,t){return typeof e=="function"?e(t):e}function Eh(e){return e.split("-")[0]}function c_(e){return e.split("-")[1]}function dL(e){return e==="x"?"y":"x"}function wT(e){return e==="y"?"height":"width"}function Lp(e){return["top","bottom"].includes(Eh(e))?"y":"x"}function ST(e){return dL(Lp(e))}function K9(e,t,i){i===void 0&&(i=!1);const a=c_(e),d=ST(e),g=wT(d);let _=d==="x"?a===(i?"end":"start")?"right":"left":a==="start"?"bottom":"top";return t.reference[g]>t.floating[g]&&(_=cb(_)),[_,cb(_)]}function Z9(e){const t=cb(e);return[m2(e),t,m2(t)]}function m2(e){return e.replace(/start|end/g,t=>q9[t])}function Y9(e,t,i){const a=["left","right"],d=["right","left"],g=["top","bottom"],_=["bottom","top"];switch(e){case"top":case"bottom":return i?t?d:a:t?a:d;case"left":case"right":return t?g:_;default:return[]}}function X9(e,t,i,a){const d=c_(e);let g=Y9(Eh(e),i==="start",a);return d&&(g=g.map(_=>_+"-"+d),t&&(g=g.concat(g.map(m2)))),g}function cb(e){return e.replace(/left|right|bottom|top/g,t=>W9[t])}function J9(e){return{top:0,right:0,bottom:0,left:0,...e}}function hL(e){return typeof e!="number"?J9(e):{top:e,right:e,bottom:e,left:e}}function ub(e){const{x:t,y:i,width:a,height:d}=e;return{width:a,height:d,top:i,left:t,right:t+a,bottom:i+d,x:t,y:i}}function Bk(e,t,i){let{reference:a,floating:d}=e;const g=Lp(t),_=ST(t),o=wT(_),S=Eh(t),E=g==="y",I=a.x+a.width/2-d.width/2,R=a.y+a.height/2-d.height/2,z=a[o]/2-d[o]/2;let N;switch(S){case"top":N={x:I,y:a.y-d.height};break;case"bottom":N={x:I,y:a.y+a.height};break;case"right":N={x:a.x+a.width,y:R};break;case"left":N={x:a.x-d.width,y:R};break;default:N={x:a.x,y:a.y}}switch(c_(t)){case"start":N[_]-=z*(i&&E?-1:1);break;case"end":N[_]+=z*(i&&E?-1:1);break}return N}const Q9=async(e,t,i)=>{const{placement:a="bottom",strategy:d="absolute",middleware:g=[],platform:_}=i,o=g.filter(Boolean),S=await(_.isRTL==null?void 0:_.isRTL(t));let E=await _.getElementRects({reference:e,floating:t,strategy:d}),{x:I,y:R}=Bk(E,a,S),z=a,N={},$=0;for(let F=0;F<o.length;F++){const{name:W,fn:U}=o[F],{x:re,y:K,data:q,reset:J}=await U({x:I,y:R,initialPlacement:a,placement:z,strategy:d,middlewareData:N,rects:E,platform:_,elements:{reference:e,floating:t}});I=re??I,R=K??R,N={...N,[W]:{...N[W],...q}},J&&$<=50&&($++,typeof J=="object"&&(J.placement&&(z=J.placement),J.rects&&(E=J.rects===!0?await _.getElementRects({reference:e,floating:t,strategy:d}):J.rects),{x:I,y:R}=Bk(E,z,S)),F=-1)}return{x:I,y:R,placement:z,strategy:d,middlewareData:N}};async function TT(e,t){var i;t===void 0&&(t={});const{x:a,y:d,platform:g,rects:_,elements:o,strategy:S}=e,{boundary:E="clippingAncestors",rootBoundary:I="viewport",elementContext:R="floating",altBoundary:z=!1,padding:N=0}=l_(t,e),$=hL(N),W=o[z?R==="floating"?"reference":"floating":R],U=ub(await g.getClippingRect({element:(i=await(g.isElement==null?void 0:g.isElement(W)))==null||i?W:W.contextElement||await(g.getDocumentElement==null?void 0:g.getDocumentElement(o.floating)),boundary:E,rootBoundary:I,strategy:S})),re=R==="floating"?{x:a,y:d,width:_.floating.width,height:_.floating.height}:_.reference,K=await(g.getOffsetParent==null?void 0:g.getOffsetParent(o.floating)),q=await(g.isElement==null?void 0:g.isElement(K))?await(g.getScale==null?void 0:g.getScale(K))||{x:1,y:1}:{x:1,y:1},J=ub(g.convertOffsetParentRelativeRectToViewportRelativeRect?await g.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:re,offsetParent:K,strategy:S}):re);return{top:(U.top-J.top+$.top)/q.y,bottom:(J.bottom-U.bottom+$.bottom)/q.y,left:(U.left-J.left+$.left)/q.x,right:(J.right-U.right+$.right)/q.x}}const eq=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:a,placement:d,rects:g,platform:_,elements:o,middlewareData:S}=t,{element:E,padding:I=0}=l_(e,t)||{};if(E==null)return{};const R=hL(I),z={x:i,y:a},N=ST(d),$=wT(N),F=await _.getDimensions(E),W=N==="y",U=W?"top":"left",re=W?"bottom":"right",K=W?"clientHeight":"clientWidth",q=g.reference[$]+g.reference[N]-z[N]-g.floating[$],J=z[N]-g.reference[N],oe=await(_.getOffsetParent==null?void 0:_.getOffsetParent(E));let ae=oe?oe[K]:0;(!ae||!await(_.isElement==null?void 0:_.isElement(oe)))&&(ae=o.floating[K]||g.floating[$]);const fe=q/2-J/2,ge=ae/2-F[$]/2-1,ce=Dp(R[U],ge),de=Dp(R[re],ge),_e=ce,Re=ae-F[$]-de,Qe=ae/2-F[$]/2+fe,Ee=p2(_e,Qe,Re),ye=!S.arrow&&c_(d)!=null&&Qe!==Ee&&g.reference[$]/2-(Qe<_e?ce:de)-F[$]/2<0,Me=ye?Qe<_e?Qe-_e:Qe-Re:0;return{[N]:z[N]+Me,data:{[N]:Ee,centerOffset:Qe-Ee-Me,...ye&&{alignmentOffset:Me}},reset:ye}}}),tq=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var i,a;const{placement:d,middlewareData:g,rects:_,initialPlacement:o,platform:S,elements:E}=t,{mainAxis:I=!0,crossAxis:R=!0,fallbackPlacements:z,fallbackStrategy:N="bestFit",fallbackAxisSideDirection:$="none",flipAlignment:F=!0,...W}=l_(e,t);if((i=g.arrow)!=null&&i.alignmentOffset)return{};const U=Eh(d),re=Lp(o),K=Eh(o)===o,q=await(S.isRTL==null?void 0:S.isRTL(E.floating)),J=z||(K||!F?[cb(o)]:Z9(o)),oe=$!=="none";!z&&oe&&J.push(...X9(o,F,$,q));const ae=[o,...J],fe=await TT(t,W),ge=[];let ce=((a=g.flip)==null?void 0:a.overflows)||[];if(I&&ge.push(fe[U]),R){const Qe=K9(d,_,q);ge.push(fe[Qe[0]],fe[Qe[1]])}if(ce=[...ce,{placement:d,overflows:ge}],!ge.every(Qe=>Qe<=0)){var de,_e;const Qe=(((de=g.flip)==null?void 0:de.index)||0)+1,Ee=ae[Qe];if(Ee)return{data:{index:Qe,overflows:ce},reset:{placement:Ee}};let ye=(_e=ce.filter(Me=>Me.overflows[0]<=0).sort((Me,Te)=>Me.overflows[1]-Te.overflows[1])[0])==null?void 0:_e.placement;if(!ye)switch(N){case"bestFit":{var Re;const Me=(Re=ce.filter(Te=>{if(oe){const he=Lp(Te.placement);return he===re||he==="y"}return!0}).map(Te=>[Te.placement,Te.overflows.filter(he=>he>0).reduce((he,ke)=>he+ke,0)]).sort((Te,he)=>Te[1]-he[1])[0])==null?void 0:Re[0];Me&&(ye=Me);break}case"initialPlacement":ye=o;break}if(d!==ye)return{reset:{placement:ye}}}return{}}}};async function nq(e,t){const{placement:i,platform:a,elements:d}=e,g=await(a.isRTL==null?void 0:a.isRTL(d.floating)),_=Eh(i),o=c_(i),S=Lp(i)==="y",E=["left","top"].includes(_)?-1:1,I=g&&S?-1:1,R=l_(t,e);let{mainAxis:z,crossAxis:N,alignmentAxis:$}=typeof R=="number"?{mainAxis:R,crossAxis:0,alignmentAxis:null}:{mainAxis:R.mainAxis||0,crossAxis:R.crossAxis||0,alignmentAxis:R.alignmentAxis};return o&&typeof $=="number"&&(N=o==="end"?$*-1:$),S?{x:N*I,y:z*E}:{x:z*E,y:N*I}}const oq=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var i,a;const{x:d,y:g,placement:_,middlewareData:o}=t,S=await nq(t,e);return _===((i=o.offset)==null?void 0:i.placement)&&(a=o.arrow)!=null&&a.alignmentOffset?{}:{x:d+S.x,y:g+S.y,data:{...S,placement:_}}}}},rq=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:a,placement:d}=t,{mainAxis:g=!0,crossAxis:_=!1,limiter:o={fn:W=>{let{x:U,y:re}=W;return{x:U,y:re}}},...S}=l_(e,t),E={x:i,y:a},I=await TT(t,S),R=Lp(Eh(d)),z=dL(R);let N=E[z],$=E[R];if(g){const W=z==="y"?"top":"left",U=z==="y"?"bottom":"right",re=N+I[W],K=N-I[U];N=p2(re,N,K)}if(_){const W=R==="y"?"top":"left",U=R==="y"?"bottom":"right",re=$+I[W],K=$-I[U];$=p2(re,$,K)}const F=o.fn({...t,[z]:N,[R]:$});return{...F,data:{x:F.x-i,y:F.y-a,enabled:{[z]:g,[R]:_}}}}}};function Xb(){return typeof window<"u"}function Kp(e){return fL(e)?(e.nodeName||"").toLowerCase():"#document"}function _a(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function tc(e){var t;return(t=(fL(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function fL(e){return Xb()?e instanceof Node||e instanceof _a(e).Node:!1}function bl(e){return Xb()?e instanceof Element||e instanceof _a(e).Element:!1}function Zl(e){return Xb()?e instanceof HTMLElement||e instanceof _a(e).HTMLElement:!1}function Fk(e){return!Xb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof _a(e).ShadowRoot}function u_(e){const{overflow:t,overflowX:i,overflowY:a,display:d}=xl(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+i)&&!["inline","contents"].includes(d)}function iq(e){return["table","td","th"].includes(Kp(e))}function Jb(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function CT(e){const t=ET(),i=bl(e)?xl(e):e;return i.transform!=="none"||i.perspective!=="none"||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","perspective","filter"].some(a=>(i.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(i.contain||"").includes(a))}function sq(e){let t=id(e);for(;Zl(t)&&!Op(t);){if(CT(t))return t;if(Jb(t))return null;t=id(t)}return null}function ET(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Op(e){return["html","body","#document"].includes(Kp(e))}function xl(e){return _a(e).getComputedStyle(e)}function Qb(e){return bl(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function id(e){if(Kp(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Fk(e)&&e.host||tc(e);return Fk(t)?t.host:t}function pL(e){const t=id(e);return Op(t)?e.ownerDocument?e.ownerDocument.body:e.body:Zl(t)&&u_(t)?t:pL(t)}function zv(e,t,i){var a;t===void 0&&(t=[]),i===void 0&&(i=!0);const d=pL(e),g=d===((a=e.ownerDocument)==null?void 0:a.body),_=_a(d);if(g){const o=g2(_);return t.concat(_,_.visualViewport||[],u_(d)?d:[],o&&i?zv(o):[])}return t.concat(d,zv(d,[],i))}function g2(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function mL(e){const t=xl(e);let i=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const d=Zl(e),g=d?e.offsetWidth:i,_=d?e.offsetHeight:a,o=lb(i)!==g||lb(a)!==_;return o&&(i=g,a=_),{width:i,height:a,$:o}}function MT(e){return bl(e)?e:e.contextElement}function _p(e){const t=MT(e);if(!Zl(t))return Gl(1);const i=t.getBoundingClientRect(),{width:a,height:d,$:g}=mL(t);let _=(g?lb(i.width):i.width)/a,o=(g?lb(i.height):i.height)/d;return(!_||!Number.isFinite(_))&&(_=1),(!o||!Number.isFinite(o))&&(o=1),{x:_,y:o}}const aq=Gl(0);function gL(e){const t=_a(e);return!ET()||!t.visualViewport?aq:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function lq(e,t,i){return t===void 0&&(t=!1),!i||t&&i!==_a(e)?!1:t}function Mh(e,t,i,a){t===void 0&&(t=!1),i===void 0&&(i=!1);const d=e.getBoundingClientRect(),g=MT(e);let _=Gl(1);t&&(a?bl(a)&&(_=_p(a)):_=_p(e));const o=lq(g,i,a)?gL(g):Gl(0);let S=(d.left+o.x)/_.x,E=(d.top+o.y)/_.y,I=d.width/_.x,R=d.height/_.y;if(g){const z=_a(g),N=a&&bl(a)?_a(a):a;let $=z,F=g2($);for(;F&&a&&N!==$;){const W=_p(F),U=F.getBoundingClientRect(),re=xl(F),K=U.left+(F.clientLeft+parseFloat(re.paddingLeft))*W.x,q=U.top+(F.clientTop+parseFloat(re.paddingTop))*W.y;S*=W.x,E*=W.y,I*=W.x,R*=W.y,S+=K,E+=q,$=_a(F),F=g2($)}}return ub({width:I,height:R,x:S,y:E})}function IT(e,t){const i=Qb(e).scrollLeft;return t?t.left+i:Mh(tc(e)).left+i}function vL(e,t,i){i===void 0&&(i=!1);const a=e.getBoundingClientRect(),d=a.left+t.scrollLeft-(i?0:IT(e,a)),g=a.top+t.scrollTop;return{x:d,y:g}}function cq(e){let{elements:t,rect:i,offsetParent:a,strategy:d}=e;const g=d==="fixed",_=tc(a),o=t?Jb(t.floating):!1;if(a===_||o&&g)return i;let S={scrollLeft:0,scrollTop:0},E=Gl(1);const I=Gl(0),R=Zl(a);if((R||!R&&!g)&&((Kp(a)!=="body"||u_(_))&&(S=Qb(a)),Zl(a))){const N=Mh(a);E=_p(a),I.x=N.x+a.clientLeft,I.y=N.y+a.clientTop}const z=_&&!R&&!g?vL(_,S,!0):Gl(0);return{width:i.width*E.x,height:i.height*E.y,x:i.x*E.x-S.scrollLeft*E.x+I.x+z.x,y:i.y*E.y-S.scrollTop*E.y+I.y+z.y}}function uq(e){return Array.from(e.getClientRects())}function dq(e){const t=tc(e),i=Qb(e),a=e.ownerDocument.body,d=_h(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),g=_h(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let _=-i.scrollLeft+IT(e);const o=-i.scrollTop;return xl(a).direction==="rtl"&&(_+=_h(t.clientWidth,a.clientWidth)-d),{width:d,height:g,x:_,y:o}}function hq(e,t){const i=_a(e),a=tc(e),d=i.visualViewport;let g=a.clientWidth,_=a.clientHeight,o=0,S=0;if(d){g=d.width,_=d.height;const E=ET();(!E||E&&t==="fixed")&&(o=d.offsetLeft,S=d.offsetTop)}return{width:g,height:_,x:o,y:S}}function fq(e,t){const i=Mh(e,!0,t==="fixed"),a=i.top+e.clientTop,d=i.left+e.clientLeft,g=Zl(e)?_p(e):Gl(1),_=e.clientWidth*g.x,o=e.clientHeight*g.y,S=d*g.x,E=a*g.y;return{width:_,height:o,x:S,y:E}}function Nk(e,t,i){let a;if(t==="viewport")a=hq(e,i);else if(t==="document")a=dq(tc(e));else if(bl(t))a=fq(t,i);else{const d=gL(e);a={x:t.x-d.x,y:t.y-d.y,width:t.width,height:t.height}}return ub(a)}function _L(e,t){const i=id(e);return i===t||!bl(i)||Op(i)?!1:xl(i).position==="fixed"||_L(i,t)}function pq(e,t){const i=t.get(e);if(i)return i;let a=zv(e,[],!1).filter(o=>bl(o)&&Kp(o)!=="body"),d=null;const g=xl(e).position==="fixed";let _=g?id(e):e;for(;bl(_)&&!Op(_);){const o=xl(_),S=CT(_);!S&&o.position==="fixed"&&(d=null),(g?!S&&!d:!S&&o.position==="static"&&!!d&&["absolute","fixed"].includes(d.position)||u_(_)&&!S&&_L(e,_))?a=a.filter(I=>I!==_):d=o,_=id(_)}return t.set(e,a),a}function mq(e){let{element:t,boundary:i,rootBoundary:a,strategy:d}=e;const _=[...i==="clippingAncestors"?Jb(t)?[]:pq(t,this._c):[].concat(i),a],o=_[0],S=_.reduce((E,I)=>{const R=Nk(t,I,d);return E.top=_h(R.top,E.top),E.right=Dp(R.right,E.right),E.bottom=Dp(R.bottom,E.bottom),E.left=_h(R.left,E.left),E},Nk(t,o,d));return{width:S.right-S.left,height:S.bottom-S.top,x:S.left,y:S.top}}function gq(e){const{width:t,height:i}=mL(e);return{width:t,height:i}}function vq(e,t,i){const a=Zl(t),d=tc(t),g=i==="fixed",_=Mh(e,!0,g,t);let o={scrollLeft:0,scrollTop:0};const S=Gl(0);if(a||!a&&!g)if((Kp(t)!=="body"||u_(d))&&(o=Qb(t)),a){const z=Mh(t,!0,g,t);S.x=z.x+t.clientLeft,S.y=z.y+t.clientTop}else d&&(S.x=IT(d));const E=d&&!a&&!g?vL(d,o):Gl(0),I=_.left+o.scrollLeft-S.x-E.x,R=_.top+o.scrollTop-S.y-E.y;return{x:I,y:R,width:_.width,height:_.height}}function _w(e){return xl(e).position==="static"}function $k(e,t){if(!Zl(e)||xl(e).position==="fixed")return null;if(t)return t(e);let i=e.offsetParent;return tc(e)===i&&(i=i.ownerDocument.body),i}function yL(e,t){const i=_a(e);if(Jb(e))return i;if(!Zl(e)){let d=id(e);for(;d&&!Op(d);){if(bl(d)&&!_w(d))return d;d=id(d)}return i}let a=$k(e,t);for(;a&&iq(a)&&_w(a);)a=$k(a,t);return a&&Op(a)&&_w(a)&&!CT(a)?i:a||sq(e)||i}const _q=async function(e){const t=this.getOffsetParent||yL,i=this.getDimensions,a=await i(e.floating);return{reference:vq(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function yq(e){return xl(e).direction==="rtl"}const bq={convertOffsetParentRelativeRectToViewportRelativeRect:cq,getDocumentElement:tc,getClippingRect:mq,getOffsetParent:yL,getElementRects:_q,getClientRects:uq,getDimensions:gq,getScale:_p,isElement:bl,isRTL:yq};function xq(e,t){let i=null,a;const d=tc(e);function g(){var o;clearTimeout(a),(o=i)==null||o.disconnect(),i=null}function _(o,S){o===void 0&&(o=!1),S===void 0&&(S=1),g();const{left:E,top:I,width:R,height:z}=e.getBoundingClientRect();if(o||t(),!R||!z)return;const N=m0(I),$=m0(d.clientWidth-(E+R)),F=m0(d.clientHeight-(I+z)),W=m0(E),re={rootMargin:-N+"px "+-$+"px "+-F+"px "+-W+"px",threshold:_h(0,Dp(1,S))||1};let K=!0;function q(J){const oe=J[0].intersectionRatio;if(oe!==S){if(!K)return _();oe?_(!1,oe):a=setTimeout(()=>{_(!1,1e-7)},1e3)}K=!1}try{i=new IntersectionObserver(q,{...re,root:d.ownerDocument})}catch{i=new IntersectionObserver(q,re)}i.observe(e)}return _(!0),g}function wq(e,t,i,a){a===void 0&&(a={});const{ancestorScroll:d=!0,ancestorResize:g=!0,elementResize:_=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:S=!1}=a,E=MT(e),I=d||g?[...E?zv(E):[],...zv(t)]:[];I.forEach(U=>{d&&U.addEventListener("scroll",i,{passive:!0}),g&&U.addEventListener("resize",i)});const R=E&&o?xq(E,i):null;let z=-1,N=null;_&&(N=new ResizeObserver(U=>{let[re]=U;re&&re.target===E&&N&&(N.unobserve(t),cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var K;(K=N)==null||K.observe(t)})),i()}),E&&!S&&N.observe(E),N.observe(t));let $,F=S?Mh(e):null;S&&W();function W(){const U=Mh(e);F&&(U.x!==F.x||U.y!==F.y||U.width!==F.width||U.height!==F.height)&&i(),F=U,$=requestAnimationFrame(W)}return i(),()=>{var U;I.forEach(re=>{d&&re.removeEventListener("scroll",i),g&&re.removeEventListener("resize",i)}),R==null||R(),(U=N)==null||U.disconnect(),N=null,S&&cancelAnimationFrame($)}}const Sq=TT,bL=oq,Tq=rq,Cq=tq,xL=eq,wL=(e,t,i)=>{const a=new Map,d={platform:bq,...i},g={...d.platform,_c:a};return Q9(e,t,{...d,platform:g})};cn({});const Eq=e=>{if(!Wo)return;if(!e)return e;const t=Bs(e);return t||(Hr(e)?t:e)},Mq=({middleware:e,placement:t,strategy:i})=>{const a=xe(),d=xe(),g=xe(),_=xe(),o=xe({}),S={x:g,y:_,placement:t,strategy:i,middlewareData:o},E=async()=>{if(!Wo)return;const I=Eq(a),R=Bs(d);if(!I||!R)return;const z=await wL(I,R,{placement:y(t),strategy:y(i),middleware:y(e)});Mp(S).forEach(N=>{S[N].value=z[N]})};return _o(()=>{ns(()=>{E()})}),{...S,update:E,referenceRef:a,contentRef:d}},Iq=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(i){const a=y(e);return a?xL({element:a,padding:t}).fn(i):{}}});function Aq(e){let t;function i(){if(e.value==null)return;const{selectionStart:d,selectionEnd:g,value:_}=e.value;if(d==null||g==null)return;const o=_.slice(0,Math.max(0,d)),S=_.slice(Math.max(0,g));t={selectionStart:d,selectionEnd:g,value:_,beforeTxt:o,afterTxt:S}}function a(){if(e.value==null||t==null)return;const{value:d}=e.value,{beforeTxt:g,afterTxt:_,selectionStart:o}=t;if(g==null||_==null||o==null)return;let S=d.length;if(d.endsWith(_))S=d.length-_.length;else if(d.startsWith(g))S=g.length;else{const E=g[o-1],I=d.indexOf(E,o-1);I!==-1&&(S=I+1)}e.value.setSelectionRange(S,S)}return[i,a]}const kq=(e,t,i)=>qu(e.subTree).filter(g=>{var _;return Yr(g)&&((_=g.type)==null?void 0:_.name)===t&&!!g.component}).map(g=>g.component.uid).map(g=>i[g]).filter(g=>!!g),AT=(e,t)=>{const i={},a=qr([]);return{children:a,addChild:_=>{i[_.uid]=_,a.value=kq(e,t,i)},removeChild:_=>{delete i[_],a.value=a.value.filter(o=>o.uid!==_)}}},ki=Sl({type:String,values:ec,required:!1}),SL=Symbol("size"),TL=()=>{const e=kn(SL,{});return ee(()=>y(e.size)||"")};function Oh(e,{beforeFocus:t,afterFocus:i,beforeBlur:a,afterBlur:d}={}){const g=To(),{emit:_}=g,o=qr(),S=xe(!1),E=z=>{Nn(t)&&t(z)||S.value||(S.value=!0,_("focus",z),i==null||i())},I=z=>{var N;Nn(a)&&a(z)||z.relatedTarget&&((N=o.value)!=null&&N.contains(z.relatedTarget))||(S.value=!1,_("blur",z),d==null||d())},R=()=>{var z,N;(z=o.value)!=null&&z.contains(document.activeElement)&&o.value!==document.activeElement||(N=e.value)==null||N.focus()};return qt(o,z=>{z&&z.setAttribute("tabindex","-1")}),wr(o,"focus",E,!0),wr(o,"blur",I,!0),wr(o,"click",R,!0),{isFocused:S,wrapperRef:o,handleFocus:E,handleBlur:I}}function e1({afterComposition:e,emit:t}){const i=xe(!1),a=o=>{t==null||t("compositionstart",o),i.value=!0},d=o=>{var S;t==null||t("compositionupdate",o);const E=(S=o.target)==null?void 0:S.value,I=E[E.length-1]||"";i.value=!xW(I)},g=o=>{t==null||t("compositionend",o),i.value&&(i.value=!1,Un(()=>e(o)))};return{isComposing:i,handleComposition:o=>{o.type==="compositionend"?g(o):d(o)},handleCompositionStart:a,handleCompositionUpdate:d,handleCompositionEnd:g}}const CL=Symbol("emptyValuesContextKey"),Pq=["",void 0,null],Rq=void 0,Zp=cn({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>Nn(e)?!e():!e}}),t1=(e,t)=>{const i=To()?kn(CL,xe({})):xe({}),a=ee(()=>e.emptyValues||i.value.emptyValues||Pq),d=ee(()=>Nn(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:Nn(i.value.valueOnClear)?i.value.valueOnClear():i.value.valueOnClear!==void 0?i.value.valueOnClear:t!==void 0?t:Rq),g=_=>a.value.includes(_);return a.value.includes(d.value),{emptyValues:a,valueOnClear:d,isEmptyValue:g}},Dq=cn({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),Zi=e=>fl(Dq,e),EL=Symbol(),db=xe();function n1(e,t=void 0){const i=To()?kn(EL,db):db;return e?ee(()=>{var a,d;return(d=(a=i.value)==null?void 0:a[e])!=null?d:t}):i}function o1(e,t){const i=n1(),a=Xt(e,ee(()=>{var o;return((o=i.value)==null?void 0:o.namespace)||pv})),d=qo(ee(()=>{var o;return(o=i.value)==null?void 0:o.locale})),g=qp(ee(()=>{var o;return((o=i.value)==null?void 0:o.zIndex)||cL})),_=ee(()=>{var o;return y(t)||((o=i.value)==null?void 0:o.size)||""});return kT(ee(()=>y(i)||{})),{ns:a,locale:d,zIndex:g,size:_}}const kT=(e,t,i=!1)=>{var a;const d=!!To(),g=d?n1():void 0,_=(a=t==null?void 0:t.provide)!=null?a:d?Bo:void 0;if(!_)return;const o=ee(()=>{const S=y(e);return g!=null&&g.value?Lq(g.value,S):S});return _(EL,o),_(qD,ee(()=>o.value.locale)),_(KD,ee(()=>o.value.namespace)),_(uL,ee(()=>o.value.zIndex)),_(SL,{size:ee(()=>o.value.size||"")}),_(CL,ee(()=>({emptyValues:o.value.emptyValues,valueOnClear:o.value.valueOnClear}))),(i||!db.value)&&(db.value=o.value),o},Lq=(e,t)=>{const i=[...new Set([...Mp(e),...Mp(t)])],a={};for(const d of i)a[d]=t[d]!==void 0?t[d]:e[d];return a},Oq=cn({a11y:{type:Boolean,default:!0},locale:{type:at(Object)},size:ki,button:{type:at(Object)},experimentalFeatures:{type:at(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:at(Object)},zIndex:Number,namespace:{type:String,default:"el"},...Zp}),ul={},zq=qe({name:"ElConfigProvider",props:Oq,setup(e,{slots:t}){qt(()=>e.message,a=>{Object.assign(ul,a??{})},{immediate:!0,deep:!0});const i=kT(e);return()=>vt(t,"default",{config:i==null?void 0:i.value})}}),Bq=uo(zq),Fq="2.8.8",Nq=(e=[])=>({version:Fq,install:(i,a)=>{i[bk]||(i[bk]=!0,e.forEach(d=>i.use(d)),a&&kT(a,i,!0))}}),$q=cn({zIndex:{type:at([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),Vq={scroll:({scrollTop:e,fixed:t})=>Wn(e)&&Lr(t),[Wr]:e=>Lr(e)};var fn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,d]of t)i[a]=d;return i};const ML="ElAffix",Uq=qe({name:ML}),jq=qe({...Uq,props:$q,emits:Vq,setup(e,{expose:t,emit:i}){const a=e,d=Xt("affix"),g=qr(),_=qr(),o=qr(),{height:S}=E$(),{height:E,width:I,top:R,bottom:z,update:N}=LA(_,{windowScroll:!1}),$=LA(g),F=xe(!1),W=xe(0),U=xe(0),re=ee(()=>({height:F.value?`${E.value}px`:"",width:F.value?`${I.value}px`:""})),K=ee(()=>{if(!F.value)return{};const oe=a.offset?fi(a.offset):0;return{height:`${E.value}px`,width:`${I.value}px`,top:a.position==="top"?oe:"",bottom:a.position==="bottom"?oe:"",transform:U.value?`translateY(${U.value}px)`:"",zIndex:a.zIndex}}),q=()=>{if(!o.value)return;W.value=o.value instanceof Window?document.documentElement.scrollTop:o.value.scrollTop||0;const{position:oe,target:ae,offset:fe}=a,ge=fe+E.value;if(oe==="top")if(ae){const ce=$.bottom.value-ge;F.value=fe>R.value&&$.bottom.value>0,U.value=ce<0?ce:0}else F.value=fe>R.value;else if(ae){const ce=S.value-$.top.value-ge;F.value=S.value-fe<z.value&&S.value>$.top.value,U.value=ce<0?-ce:0}else F.value=S.value-fe<z.value},J=()=>{N(),i("scroll",{scrollTop:W.value,fixed:F.value})};return qt(F,oe=>i("change",oe)),_o(()=>{var oe;a.target?(g.value=(oe=document.querySelector(a.target))!=null?oe:void 0,g.value||Ai(ML,`Target does not exist: ${a.target}`)):g.value=document.documentElement,o.value=tT(_.value,!0),N()}),wr(o,"scroll",J),ns(q),t({update:q,updateRoot:N}),(oe,ae)=>(se(),Ie("div",{ref_key:"root",ref:_,class:ue(y(d).b()),style:$n(y(re))},[je("div",{class:ue({[y(d).m("fixed")]:F.value}),style:$n(y(K))},[vt(oe.$slots,"default")],6)],6))}});var Hq=fn(jq,[["__file","affix.vue"]]);const Gq=uo(Hq),Wq=cn({size:{type:at([Number,String])},color:{type:String}}),qq=qe({name:"ElIcon",inheritAttrs:!1}),Kq=qe({...qq,props:Wq,setup(e){const t=e,i=Xt("icon"),a=ee(()=>{const{size:d,color:g}=t;return!d&&!g?{}:{fontSize:jr(d)?void 0:fi(d),"--color":g}});return(d,g)=>(se(),Ie("i",Po({class:y(i).b(),style:y(a)},d.$attrs),[vt(d.$slots,"default")],16))}});var Zq=fn(Kq,[["__file","icon.vue"]]);const Dn=uo(Zq),Yq=["light","dark"],Xq=cn({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Mp(rd),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:Yq,default:"light"}}),Jq={close:e=>e instanceof MouseEvent},Qq=qe({name:"ElAlert"}),e7=qe({...Qq,props:Xq,emits:Jq,setup(e,{emit:t}){const i=e,{Close:a}=lT,d=Ri(),g=Xt("alert"),_=xe(!0),o=ee(()=>rd[i.type]),S=ee(()=>[g.e("icon"),{[g.is("big")]:!!i.description||!!d.default}]),E=ee(()=>({"with-description":i.description||d.default})),I=R=>{_.value=!1,t("close",R)};return(R,z)=>(se(),Et(Ui,{name:y(g).b("fade"),persisted:""},{default:it(()=>[vo(je("div",{class:ue([y(g).b(),y(g).m(R.type),y(g).is("center",R.center),y(g).is(R.effect)]),role:"alert"},[R.showIcon&&y(o)?(se(),Et(y(Dn),{key:0,class:ue(y(S))},{default:it(()=>[(se(),Et(ko(y(o))))]),_:1},8,["class"])):yt("v-if",!0),je("div",{class:ue(y(g).e("content"))},[R.title||R.$slots.title?(se(),Ie("span",{key:0,class:ue([y(g).e("title"),y(E)])},[vt(R.$slots,"title",{},()=>[$o(mn(R.title),1)])],2)):yt("v-if",!0),R.$slots.default||R.description?(se(),Ie("p",{key:1,class:ue(y(g).e("description"))},[vt(R.$slots,"default",{},()=>[$o(mn(R.description),1)])],2)):yt("v-if",!0),R.closable?(se(),Ie(Fn,{key:2},[R.closeText?(se(),Ie("div",{key:0,class:ue([y(g).e("close-btn"),y(g).is("customed")]),onClick:I},mn(R.closeText),3)):(se(),Et(y(Dn),{key:1,class:ue(y(g).e("close-btn")),onClick:I},{default:it(()=>[Ye(y(a))]),_:1},8,["class"]))],64)):yt("v-if",!0)],2)],2),[[ir,_.value]])]),_:3},8,["name"]))}});var t7=fn(e7,[["__file","alert.vue"]]);const n7=uo(t7),zh=Symbol("formContextKey"),Yl=Symbol("formItemContextKey"),Mi=(e,t={})=>{const i=xe(void 0),a=t.prop?i:ZD("size"),d=t.global?i:TL(),g=t.form?{size:void 0}:kn(zh,void 0),_=t.formItem?{size:void 0}:kn(Yl,void 0);return ee(()=>a.value||y(e)||(_==null?void 0:_.size)||(g==null?void 0:g.size)||d.value||"")},bs=e=>{const t=ZD("disabled"),i=kn(zh,void 0);return ee(()=>t.value||y(e)||(i==null?void 0:i.disabled)||!1)},xs=()=>{const e=kn(zh,void 0),t=kn(Yl,void 0);return{form:e,formItem:t}},Cl=(e,{formItemContext:t,disableIdGeneration:i,disableIdManagement:a})=>{i||(i=xe(!1)),a||(a=xe(!1));const d=xe();let g;const _=ee(()=>{var o;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((o=t.inputIds)==null?void 0:o.length)<=1)});return _o(()=>{g=qt([mr(e,"id"),i],([o,S])=>{const E=o??(S?void 0:Ki().value);E!==d.value&&(t!=null&&t.removeInputId&&(d.value&&t.removeInputId(d.value),!(a!=null&&a.value)&&!S&&E&&t.addInputId(E)),d.value=E)},{immediate:!0})}),ld(()=>{g&&g(),t!=null&&t.removeInputId&&d.value&&t.removeInputId(d.value)}),{isLabeledByFormItem:_,inputId:d}},o7=cn({size:{type:String,values:ec},disabled:Boolean}),r7=cn({...o7,model:Object,rules:{type:at(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),i7={validate:(e,t,i)=>(sn(e)||Bn(e))&&Lr(t)&&Bn(i)};function s7(){const e=xe([]),t=ee(()=>{if(!e.value.length)return"0";const g=Math.max(...e.value);return g?`${g}px`:""});function i(g){const _=e.value.indexOf(g);return _===-1&&t.value,_}function a(g,_){if(g&&_){const o=i(_);e.value.splice(o,1,g)}else g&&e.value.push(g)}function d(g){const _=i(g);_>-1&&e.value.splice(_,1)}return{autoLabelWidth:t,registerLabelWidth:a,deregisterLabelWidth:d}}const g0=(e,t)=>{const i=gs(t);return i.length>0?e.filter(a=>a.prop&&i.includes(a.prop)):e},a7="ElForm",l7=qe({name:a7}),c7=qe({...l7,props:r7,emits:i7,setup(e,{expose:t,emit:i}){const a=e,d=[],g=Mi(),_=Xt("form"),o=ee(()=>{const{labelPosition:K,inline:q}=a;return[_.b(),_.m(g.value||"default"),{[_.m(`label-${K}`)]:K,[_.m("inline")]:q}]}),S=K=>d.find(q=>q.prop===K),E=K=>{d.push(K)},I=K=>{K.prop&&d.splice(d.indexOf(K),1)},R=(K=[])=>{a.model&&g0(d,K).forEach(q=>q.resetField())},z=(K=[])=>{g0(d,K).forEach(q=>q.clearValidate())},N=ee(()=>!!a.model),$=K=>{if(d.length===0)return[];const q=g0(d,K);return q.length?q:[]},F=async K=>U(void 0,K),W=async(K=[])=>{if(!N.value)return!1;const q=$(K);if(q.length===0)return!0;let J={};for(const oe of q)try{await oe.validate("")}catch(ae){J={...J,...ae}}return Object.keys(J).length===0?!0:Promise.reject(J)},U=async(K=[],q)=>{const J=!Nn(q);try{const oe=await W(K);return oe===!0&&await(q==null?void 0:q(oe)),oe}catch(oe){if(oe instanceof Error)throw oe;const ae=oe;return a.scrollToError&&re(Object.keys(ae)[0]),await(q==null?void 0:q(!1,ae)),J&&Promise.reject(ae)}},re=K=>{var q;const J=g0(d,K)[0];J&&((q=J.$el)==null||q.scrollIntoView(a.scrollIntoViewOptions))};return qt(()=>a.rules,()=>{a.validateOnRuleChange&&F().catch(K=>void 0)},{deep:!0}),Bo(zh,dr({...Vi(a),emit:i,resetFields:R,clearValidate:z,validateField:U,getField:S,addField:E,removeField:I,...s7()})),t({validate:F,validateField:U,resetFields:R,clearValidate:z,scrollToField:re,fields:d}),(K,q)=>(se(),Ie("form",{class:ue(y(o))},[vt(K.$slots,"default")],2))}});var u7=fn(c7,[["__file","form.vue"]]);function ch(){return ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},ch.apply(this,arguments)}function d7(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Bv(e,t)}function v2(e){return v2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},v2(e)}function Bv(e,t){return Bv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,d){return a.__proto__=d,a},Bv(e,t)}function h7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O0(e,t,i){return h7()?O0=Reflect.construct.bind():O0=function(d,g,_){var o=[null];o.push.apply(o,g);var S=Function.bind.apply(d,o),E=new S;return _&&Bv(E,_.prototype),E},O0.apply(null,arguments)}function f7(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function _2(e){var t=typeof Map=="function"?new Map:void 0;return _2=function(a){if(a===null||!f7(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(a))return t.get(a);t.set(a,d)}function d(){return O0(a,arguments,v2(this).constructor)}return d.prototype=Object.create(a.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),Bv(d,a)},_2(e)}var p7=/%[sdj%]/g,m7=function(){};function y2(e){if(!e||!e.length)return null;var t={};return e.forEach(function(i){var a=i.field;t[a]=t[a]||[],t[a].push(i)}),t}function pa(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];var d=0,g=i.length;if(typeof e=="function")return e.apply(null,i);if(typeof e=="string"){var _=e.replace(p7,function(o){if(o==="%%")return"%";if(d>=g)return o;switch(o){case"%s":return String(i[d++]);case"%d":return Number(i[d++]);case"%j":try{return JSON.stringify(i[d++])}catch{return"[Circular]"}break;default:return o}});return _}return e}function g7(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function ji(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||g7(t)&&typeof e=="string"&&!e)}function v7(e,t,i){var a=[],d=0,g=e.length;function _(o){a.push.apply(a,o||[]),d++,d===g&&i(a)}e.forEach(function(o){t(o,_)})}function Vk(e,t,i){var a=0,d=e.length;function g(_){if(_&&_.length){i(_);return}var o=a;a=a+1,o<d?t(e[o],g):i([])}g([])}function _7(e){var t=[];return Object.keys(e).forEach(function(i){t.push.apply(t,e[i]||[])}),t}var Uk=function(e){d7(t,e);function t(i,a){var d;return d=e.call(this,"Async Validation Error")||this,d.errors=i,d.fields=a,d}return t}(_2(Error));function y7(e,t,i,a,d){if(t.first){var g=new Promise(function(z,N){var $=function(U){return a(U),U.length?N(new Uk(U,y2(U))):z(d)},F=_7(e);Vk(F,i,$)});return g.catch(function(z){return z}),g}var _=t.firstFields===!0?Object.keys(e):t.firstFields||[],o=Object.keys(e),S=o.length,E=0,I=[],R=new Promise(function(z,N){var $=function(W){if(I.push.apply(I,W),E++,E===S)return a(I),I.length?N(new Uk(I,y2(I))):z(d)};o.length||(a(I),z(d)),o.forEach(function(F){var W=e[F];_.indexOf(F)!==-1?Vk(W,i,$):v7(W,i,$)})});return R.catch(function(z){return z}),R}function b7(e){return!!(e&&e.message!==void 0)}function x7(e,t){for(var i=e,a=0;a<t.length;a++){if(i==null)return i;i=i[t[a]]}return i}function jk(e,t){return function(i){var a;return e.fullFields?a=x7(t,e.fullFields):a=t[i.field||e.fullField],b7(i)?(i.field=i.field||e.fullField,i.fieldValue=a,i):{message:typeof i=="function"?i():i,fieldValue:a,field:i.field||e.fullField}}}function Hk(e,t){if(t){for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];typeof a=="object"&&typeof e[i]=="object"?e[i]=ch({},e[i],a):e[i]=a}}return e}var IL=function(t,i,a,d,g,_){t.required&&(!a.hasOwnProperty(t.field)||ji(i,_||t.type))&&d.push(pa(g.messages.required,t.fullField))},w7=function(t,i,a,d,g){(/^\s+$/.test(i)||i==="")&&d.push(pa(g.messages.whitespace,t.fullField))},v0,S7=function(){if(v0)return v0;var e="[a-fA-F\\d:]",t=function(q){return q&&q.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",a="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+a+":){7}(?:"+a+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+a+":){6}(?:"+i+"|:"+a+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+a+":){5}(?::"+i+"|(?::"+a+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+a+":){4}(?:(?::"+a+"){0,1}:"+i+"|(?::"+a+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+a+":){3}(?:(?::"+a+"){0,2}:"+i+"|(?::"+a+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+a+":){2}(?:(?::"+a+"){0,3}:"+i+"|(?::"+a+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+a+":){1}(?:(?::"+a+"){0,4}:"+i+"|(?::"+a+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+a+"){0,5}:"+i+"|(?::"+a+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),g=new RegExp("(?:^"+i+"$)|(?:^"+d+"$)"),_=new RegExp("^"+i+"$"),o=new RegExp("^"+d+"$"),S=function(q){return q&&q.exact?g:new RegExp("(?:"+t(q)+i+t(q)+")|(?:"+t(q)+d+t(q)+")","g")};S.v4=function(K){return K&&K.exact?_:new RegExp(""+t(K)+i+t(K),"g")},S.v6=function(K){return K&&K.exact?o:new RegExp(""+t(K)+d+t(K),"g")};var E="(?:(?:[a-z]+:)?//)",I="(?:\\S+(?::\\S*)?@)?",R=S.v4().source,z=S.v6().source,N="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",$="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",F="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",W="(?::\\d{2,5})?",U='(?:[/?#][^\\s"]*)?',re="(?:"+E+"|www\\.)"+I+"(?:localhost|"+R+"|"+z+"|"+N+$+F+")"+W+U;return v0=new RegExp("(?:^"+re+"$)","i"),v0},Gk={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},ov={integer:function(t){return ov.number(t)&&parseInt(t,10)===t},float:function(t){return ov.number(t)&&!ov.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!ov.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(Gk.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(S7())},hex:function(t){return typeof t=="string"&&!!t.match(Gk.hex)}},T7=function(t,i,a,d,g){if(t.required&&i===void 0){IL(t,i,a,d,g);return}var _=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=t.type;_.indexOf(o)>-1?ov[o](i)||d.push(pa(g.messages.types[o],t.fullField,t.type)):o&&typeof i!==t.type&&d.push(pa(g.messages.types[o],t.fullField,t.type))},C7=function(t,i,a,d,g){var _=typeof t.len=="number",o=typeof t.min=="number",S=typeof t.max=="number",E=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,I=i,R=null,z=typeof i=="number",N=typeof i=="string",$=Array.isArray(i);if(z?R="number":N?R="string":$&&(R="array"),!R)return!1;$&&(I=i.length),N&&(I=i.replace(E,"_").length),_?I!==t.len&&d.push(pa(g.messages[R].len,t.fullField,t.len)):o&&!S&&I<t.min?d.push(pa(g.messages[R].min,t.fullField,t.min)):S&&!o&&I>t.max?d.push(pa(g.messages[R].max,t.fullField,t.max)):o&&S&&(I<t.min||I>t.max)&&d.push(pa(g.messages[R].range,t.fullField,t.min,t.max))},Yf="enum",E7=function(t,i,a,d,g){t[Yf]=Array.isArray(t[Yf])?t[Yf]:[],t[Yf].indexOf(i)===-1&&d.push(pa(g.messages[Yf],t.fullField,t[Yf].join(", ")))},M7=function(t,i,a,d,g){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(i)||d.push(pa(g.messages.pattern.mismatch,t.fullField,i,t.pattern));else if(typeof t.pattern=="string"){var _=new RegExp(t.pattern);_.test(i)||d.push(pa(g.messages.pattern.mismatch,t.fullField,i,t.pattern))}}},Or={required:IL,whitespace:w7,type:T7,range:C7,enum:E7,pattern:M7},I7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i,"string")&&!t.required)return a();Or.required(t,i,d,_,g,"string"),ji(i,"string")||(Or.type(t,i,d,_,g),Or.range(t,i,d,_,g),Or.pattern(t,i,d,_,g),t.whitespace===!0&&Or.whitespace(t,i,d,_,g))}a(_)},A7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),i!==void 0&&Or.type(t,i,d,_,g)}a(_)},k7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(i===""&&(i=void 0),ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),i!==void 0&&(Or.type(t,i,d,_,g),Or.range(t,i,d,_,g))}a(_)},P7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),i!==void 0&&Or.type(t,i,d,_,g)}a(_)},R7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),ji(i)||Or.type(t,i,d,_,g)}a(_)},D7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),i!==void 0&&(Or.type(t,i,d,_,g),Or.range(t,i,d,_,g))}a(_)},L7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),i!==void 0&&(Or.type(t,i,d,_,g),Or.range(t,i,d,_,g))}a(_)},O7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(i==null&&!t.required)return a();Or.required(t,i,d,_,g,"array"),i!=null&&(Or.type(t,i,d,_,g),Or.range(t,i,d,_,g))}a(_)},z7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),i!==void 0&&Or.type(t,i,d,_,g)}a(_)},B7="enum",F7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g),i!==void 0&&Or[B7](t,i,d,_,g)}a(_)},N7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i,"string")&&!t.required)return a();Or.required(t,i,d,_,g),ji(i,"string")||Or.pattern(t,i,d,_,g)}a(_)},$7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i,"date")&&!t.required)return a();if(Or.required(t,i,d,_,g),!ji(i,"date")){var S;i instanceof Date?S=i:S=new Date(i),Or.type(t,S,d,_,g),S&&Or.range(t,S.getTime(),d,_,g)}}a(_)},V7=function(t,i,a,d,g){var _=[],o=Array.isArray(i)?"array":typeof i;Or.required(t,i,d,_,g,o),a(_)},yw=function(t,i,a,d,g){var _=t.type,o=[],S=t.required||!t.required&&d.hasOwnProperty(t.field);if(S){if(ji(i,_)&&!t.required)return a();Or.required(t,i,d,o,g,_),ji(i,_)||Or.type(t,i,d,o,g)}a(o)},U7=function(t,i,a,d,g){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(ji(i)&&!t.required)return a();Or.required(t,i,d,_,g)}a(_)},vv={string:I7,method:A7,number:k7,boolean:P7,regexp:R7,integer:D7,float:L7,array:O7,object:z7,enum:F7,pattern:N7,date:$7,url:yw,hex:yw,email:yw,required:V7,any:U7};function b2(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var x2=b2(),d_=function(){function e(i){this.rules=null,this._messages=x2,this.define(i)}var t=e.prototype;return t.define=function(a){var d=this;if(!a)throw new Error("Cannot configure a schema with no rules");if(typeof a!="object"||Array.isArray(a))throw new Error("Rules must be an object");this.rules={},Object.keys(a).forEach(function(g){var _=a[g];d.rules[g]=Array.isArray(_)?_:[_]})},t.messages=function(a){return a&&(this._messages=Hk(b2(),a)),this._messages},t.validate=function(a,d,g){var _=this;d===void 0&&(d={}),g===void 0&&(g=function(){});var o=a,S=d,E=g;if(typeof S=="function"&&(E=S,S={}),!this.rules||Object.keys(this.rules).length===0)return E&&E(null,o),Promise.resolve(o);function I(F){var W=[],U={};function re(q){if(Array.isArray(q)){var J;W=(J=W).concat.apply(J,q)}else W.push(q)}for(var K=0;K<F.length;K++)re(F[K]);W.length?(U=y2(W),E(W,U)):E(null,o)}if(S.messages){var R=this.messages();R===x2&&(R=b2()),Hk(R,S.messages),S.messages=R}else S.messages=this.messages();var z={},N=S.keys||Object.keys(this.rules);N.forEach(function(F){var W=_.rules[F],U=o[F];W.forEach(function(re){var K=re;typeof K.transform=="function"&&(o===a&&(o=ch({},o)),U=o[F]=K.transform(U)),typeof K=="function"?K={validator:K}:K=ch({},K),K.validator=_.getValidationMethod(K),K.validator&&(K.field=F,K.fullField=K.fullField||F,K.type=_.getType(K),z[F]=z[F]||[],z[F].push({rule:K,value:U,source:o,field:F}))})});var $={};return y7(z,S,function(F,W){var U=F.rule,re=(U.type==="object"||U.type==="array")&&(typeof U.fields=="object"||typeof U.defaultField=="object");re=re&&(U.required||!U.required&&F.value),U.field=F.field;function K(oe,ae){return ch({},ae,{fullField:U.fullField+"."+oe,fullFields:U.fullFields?[].concat(U.fullFields,[oe]):[oe]})}function q(oe){oe===void 0&&(oe=[]);var ae=Array.isArray(oe)?oe:[oe];!S.suppressWarning&&ae.length&&e.warning("async-validator:",ae),ae.length&&U.message!==void 0&&(ae=[].concat(U.message));var fe=ae.map(jk(U,o));if(S.first&&fe.length)return $[U.field]=1,W(fe);if(!re)W(fe);else{if(U.required&&!F.value)return U.message!==void 0?fe=[].concat(U.message).map(jk(U,o)):S.error&&(fe=[S.error(U,pa(S.messages.required,U.field))]),W(fe);var ge={};U.defaultField&&Object.keys(F.value).map(function(_e){ge[_e]=U.defaultField}),ge=ch({},ge,F.rule.fields);var ce={};Object.keys(ge).forEach(function(_e){var Re=ge[_e],Qe=Array.isArray(Re)?Re:[Re];ce[_e]=Qe.map(K.bind(null,_e))});var de=new e(ce);de.messages(S.messages),F.rule.options&&(F.rule.options.messages=S.messages,F.rule.options.error=S.error),de.validate(F.value,F.rule.options||S,function(_e){var Re=[];fe&&fe.length&&Re.push.apply(Re,fe),_e&&_e.length&&Re.push.apply(Re,_e),W(Re.length?Re:null)})}}var J;if(U.asyncValidator)J=U.asyncValidator(U,F.value,q,F.source,S);else if(U.validator){try{J=U.validator(U,F.value,q,F.source,S)}catch(oe){console.error==null||console.error(oe),S.suppressValidatorError||setTimeout(function(){throw oe},0),q(oe.message)}J===!0?q():J===!1?q(typeof U.message=="function"?U.message(U.fullField||U.field):U.message||(U.fullField||U.field)+" fails"):J instanceof Array?q(J):J instanceof Error&&q(J.message)}J&&J.then&&J.then(function(){return q()},function(oe){return q(oe)})},function(F){I(F)},o)},t.getType=function(a){if(a.type===void 0&&a.pattern instanceof RegExp&&(a.type="pattern"),typeof a.validator!="function"&&a.type&&!vv.hasOwnProperty(a.type))throw new Error(pa("Unknown rule type %s",a.type));return a.type||"string"},t.getValidationMethod=function(a){if(typeof a.validator=="function")return a.validator;var d=Object.keys(a),g=d.indexOf("message");return g!==-1&&d.splice(g,1),d.length===1&&d[0]==="required"?vv.required:vv[this.getType(a)]||void 0},e}();d_.register=function(t,i){if(typeof i!="function")throw new Error("Cannot register a validator by type, validator is not a function");vv[t]=i};d_.warning=m7;d_.messages=x2;d_.validators=vv;const j7=["","error","validating","success"],H7=cn({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:at([String,Array])},required:{type:Boolean,default:void 0},rules:{type:at([Object,Array])},error:String,validateStatus:{type:String,values:j7},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:ec}}),Wk="ElLabelWrap";var G7=qe({name:Wk,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const i=kn(zh,void 0),a=kn(Yl);a||Ai(Wk,"usage: <el-form-item><label-wrap /></el-form-item>");const d=Xt("form"),g=xe(),_=xe(0),o=()=>{var I;if((I=g.value)!=null&&I.firstElementChild){const R=window.getComputedStyle(g.value.firstElementChild).width;return Math.ceil(Number.parseFloat(R))}else return 0},S=(I="update")=>{Un(()=>{t.default&&e.isAutoWidth&&(I==="update"?_.value=o():I==="remove"&&(i==null||i.deregisterLabelWidth(_.value)))})},E=()=>S("update");return _o(()=>{E()}),Pr(()=>{S("remove")}),Xl(()=>E()),qt(_,(I,R)=>{e.updateAll&&(i==null||i.registerLabelWidth(I,R))}),ei(ee(()=>{var I,R;return(R=(I=g.value)==null?void 0:I.firstElementChild)!=null?R:null}),E),()=>{var I,R;if(!t)return null;const{isAutoWidth:z}=e;if(z){const N=i==null?void 0:i.autoLabelWidth,$=a==null?void 0:a.hasLabel,F={};if($&&N&&N!=="auto"){const W=Math.max(0,Number.parseInt(N,10)-_.value),re=(a.labelPosition||i.labelPosition)==="left"?"marginRight":"marginLeft";W&&(F[re]=`${W}px`)}return Ye("div",{ref:g,class:[d.be("item","label-wrap")],style:F},[(I=t.default)==null?void 0:I.call(t)])}else return Ye(Fn,{ref:g},[(R=t.default)==null?void 0:R.call(t)])}}});const W7=qe({name:"ElFormItem"}),q7=qe({...W7,props:H7,setup(e,{expose:t}){const i=e,a=Ri(),d=kn(zh,void 0),g=kn(Yl,void 0),_=Mi(void 0,{formItem:!1}),o=Xt("form-item"),S=Ki().value,E=xe([]),I=xe(""),R=l$(I,100),z=xe(""),N=xe();let $,F=!1;const W=ee(()=>i.labelPosition||(d==null?void 0:d.labelPosition)),U=ee(()=>{if(W.value==="top")return{};const Gt=fi(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return Gt?{width:Gt}:{}}),re=ee(()=>{if(W.value==="top"||d!=null&&d.inline)return{};if(!i.label&&!i.labelWidth&&ce)return{};const Gt=fi(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return!i.label&&!a.label?{marginLeft:Gt}:{}}),K=ee(()=>[o.b(),o.m(_.value),o.is("error",I.value==="error"),o.is("validating",I.value==="validating"),o.is("success",I.value==="success"),o.is("required",Ee.value||i.required),o.is("no-asterisk",d==null?void 0:d.hideRequiredAsterisk),(d==null?void 0:d.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[o.m("feedback")]:d==null?void 0:d.statusIcon,[o.m(`label-${W.value}`)]:W.value}]),q=ee(()=>Lr(i.inlineMessage)?i.inlineMessage:(d==null?void 0:d.inlineMessage)||!1),J=ee(()=>[o.e("error"),{[o.em("error","inline")]:q.value}]),oe=ee(()=>i.prop?Bn(i.prop)?i.prop:i.prop.join("."):""),ae=ee(()=>!!(i.label||a.label)),fe=ee(()=>i.for||(E.value.length===1?E.value[0]:void 0)),ge=ee(()=>!fe.value&&ae.value),ce=!!g,de=ee(()=>{const Gt=d==null?void 0:d.model;if(!(!Gt||!i.prop))return D0(Gt,i.prop).value}),_e=ee(()=>{const{required:Gt}=i,jt=[];i.rules&&jt.push(...gs(i.rules));const Be=d==null?void 0:d.rules;if(Be&&i.prop){const an=D0(Be,i.prop).value;an&&jt.push(...gs(an))}if(Gt!==void 0){const an=jt.map((At,Ge)=>[At,Ge]).filter(([At])=>Object.keys(At).includes("required"));if(an.length>0)for(const[At,Ge]of an)At.required!==Gt&&(jt[Ge]={...At,required:Gt});else jt.push({required:Gt})}return jt}),Re=ee(()=>_e.value.length>0),Qe=Gt=>_e.value.filter(Be=>!Be.trigger||!Gt?!0:sn(Be.trigger)?Be.trigger.includes(Gt):Be.trigger===Gt).map(({trigger:Be,...an})=>an),Ee=ee(()=>_e.value.some(Gt=>Gt.required)),ye=ee(()=>{var Gt;return R.value==="error"&&i.showMessage&&((Gt=d==null?void 0:d.showMessage)!=null?Gt:!0)}),Me=ee(()=>`${i.label||""}${(d==null?void 0:d.labelSuffix)||""}`),Te=Gt=>{I.value=Gt},he=Gt=>{var jt,Be;const{errors:an,fields:At}=Gt;(!an||!At)&&console.error(Gt),Te("error"),z.value=an?(Be=(jt=an==null?void 0:an[0])==null?void 0:jt.message)!=null?Be:`${i.prop} is required`:"",d==null||d.emit("validate",i.prop,!1,z.value)},ke=()=>{Te("success"),d==null||d.emit("validate",i.prop,!0,"")},Ne=async Gt=>{const jt=oe.value;return new d_({[jt]:Gt}).validate({[jt]:de.value},{firstFields:!0}).then(()=>(ke(),!0)).catch(an=>(he(an),Promise.reject(an)))},nt=async(Gt,jt)=>{if(F||!i.prop)return!1;const Be=Nn(jt);if(!Re.value)return jt==null||jt(!1),!1;const an=Qe(Gt);return an.length===0?(jt==null||jt(!0),!0):(Te("validating"),Ne(an).then(()=>(jt==null||jt(!0),!0)).catch(At=>{const{fields:Ge}=At;return jt==null||jt(!1,Ge),Be?!1:Promise.reject(Ge)}))},De=()=>{Te(""),z.value="",F=!1},Ct=async()=>{const Gt=d==null?void 0:d.model;if(!Gt||!i.prop)return;const jt=D0(Gt,i.prop);F=!0,jt.value=hk($),await Un(),De(),F=!1},Rt=Gt=>{E.value.includes(Gt)||E.value.push(Gt)},Bt=Gt=>{E.value=E.value.filter(jt=>jt!==Gt)};qt(()=>i.error,Gt=>{z.value=Gt||"",Te(Gt?"error":"")},{immediate:!0}),qt(()=>i.validateStatus,Gt=>Te(Gt||""));const mt=dr({...Vi(i),$el:N,size:_,validateState:I,labelId:S,inputIds:E,isGroup:ge,hasLabel:ae,fieldValue:de,addInputId:Rt,removeInputId:Bt,resetField:Ct,clearValidate:De,validate:nt});return Bo(Yl,mt),_o(()=>{i.prop&&(d==null||d.addField(mt),$=hk(de.value))}),Pr(()=>{d==null||d.removeField(mt)}),t({size:_,validateMessage:z,validateState:I,validate:nt,clearValidate:De,resetField:Ct}),(Gt,jt)=>{var Be;return se(),Ie("div",{ref_key:"formItemRef",ref:N,class:ue(y(K)),role:y(ge)?"group":void 0,"aria-labelledby":y(ge)?y(S):void 0},[Ye(y(G7),{"is-auto-width":y(U).width==="auto","update-all":((Be=y(d))==null?void 0:Be.labelWidth)==="auto"},{default:it(()=>[y(ae)?(se(),Et(ko(y(fe)?"label":"div"),{key:0,id:y(S),for:y(fe),class:ue(y(o).e("label")),style:$n(y(U))},{default:it(()=>[vt(Gt.$slots,"label",{label:y(Me)},()=>[$o(mn(y(Me)),1)])]),_:3},8,["id","for","class","style"])):yt("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),je("div",{class:ue(y(o).e("content")),style:$n(y(re))},[vt(Gt.$slots,"default"),Ye(LR,{name:`${y(o).namespace.value}-zoom-in-top`},{default:it(()=>[y(ye)?vt(Gt.$slots,"error",{key:0,error:z.value},()=>[je("div",{class:ue(y(J))},mn(z.value),3)]):yt("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var AL=fn(q7,[["__file","form-item.vue"]]);const K7=uo(u7,{FormItem:AL}),Z7=ri(AL);let ll;const Y7=`
  height:0 !important;
  visibility:hidden !important;
  ${BS()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,X7=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function J7(e){const t=window.getComputedStyle(e),i=t.getPropertyValue("box-sizing"),a=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),d=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:X7.map(_=>`${_}:${t.getPropertyValue(_)}`).join(";"),paddingSize:a,borderSize:d,boxSizing:i}}function qk(e,t=1,i){var a;ll||(ll=document.createElement("textarea"),document.body.appendChild(ll));const{paddingSize:d,borderSize:g,boxSizing:_,contextStyle:o}=J7(e);ll.setAttribute("style",`${o};${Y7}`),ll.value=e.value||e.placeholder||"";let S=ll.scrollHeight;const E={};_==="border-box"?S=S+g:_==="content-box"&&(S=S-d),ll.value="";const I=ll.scrollHeight-d;if(Wn(t)){let R=I*t;_==="border-box"&&(R=R+d+g),S=Math.max(R,S),E.minHeight=`${R}px`}if(Wn(i)){let R=I*i;_==="border-box"&&(R=R+d+g),S=Math.min(R,S)}return E.height=`${S}px`,(a=ll.parentNode)==null||a.removeChild(ll),ll=void 0,E}const PT=cn({id:{type:String,default:void 0},size:ki,disabled:Boolean,modelValue:{type:at([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:at([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:Cr},prefixIcon:{type:Cr},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:at([Object,Array,String]),default:()=>oi({})},autofocus:Boolean,rows:{type:Number,default:2},...Zi(["ariaLabel"])}),Q7={[xo]:e=>Bn(e),input:e=>Bn(e),change:e=>Bn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},eK=qe({name:"ElInput",inheritAttrs:!1}),tK=qe({...eK,props:PT,emits:Q7,setup(e,{expose:t,emit:i}){const a=e,d=Ph(),g=Zb(),_=Ri(),o=ee(()=>[a.type==="textarea"?F.b():$.b(),$.m(z.value),$.is("disabled",N.value),$.is("exceed",nt.value),{[$.b("group")]:_.prepend||_.append,[$.m("prefix")]:_.prefix||a.prefixIcon,[$.m("suffix")]:_.suffix||a.suffixIcon||a.clearable||a.showPassword,[$.bm("suffix","password-clear")]:Te.value&&he.value,[$.b("hidden")]:a.type==="hidden"},d.class]),S=ee(()=>[$.e("wrapper"),$.is("focus",fe.value)]),{form:E,formItem:I}=xs(),{inputId:R}=Cl(a,{formItemContext:I}),z=Mi(),N=bs(),$=Xt("input"),F=Xt("textarea"),W=qr(),U=qr(),re=xe(!1),K=xe(!1),q=xe(),J=qr(a.inputStyle),oe=ee(()=>W.value||U.value),{wrapperRef:ae,isFocused:fe,handleFocus:ge,handleBlur:ce}=Oh(oe,{beforeFocus(){return N.value},afterBlur(){var gt;a.validateEvent&&((gt=I==null?void 0:I.validate)==null||gt.call(I,"blur").catch(Sn=>void 0))}}),de=ee(()=>{var gt;return(gt=E==null?void 0:E.statusIcon)!=null?gt:!1}),_e=ee(()=>(I==null?void 0:I.validateState)||""),Re=ee(()=>_e.value&&cT[_e.value]),Qe=ee(()=>K.value?cW:DG),Ee=ee(()=>[d.style]),ye=ee(()=>[a.inputStyle,J.value,{resize:a.resize}]),Me=ee(()=>Pi(a.modelValue)?"":String(a.modelValue)),Te=ee(()=>a.clearable&&!N.value&&!a.readonly&&!!Me.value&&(fe.value||re.value)),he=ee(()=>a.showPassword&&!N.value&&!!Me.value&&(!!Me.value||fe.value)),ke=ee(()=>a.showWordLimit&&!!a.maxlength&&(a.type==="text"||a.type==="textarea")&&!N.value&&!a.readonly&&!a.showPassword),Ne=ee(()=>Me.value.length),nt=ee(()=>!!ke.value&&Ne.value>Number(a.maxlength)),De=ee(()=>!!_.suffix||!!a.suffixIcon||Te.value||a.showPassword||ke.value||!!_e.value&&de.value),[Ct,Rt]=Aq(W);ei(U,gt=>{if(Gt(),!ke.value||a.resize!=="both")return;const Sn=gt[0],{width:Vn}=Sn.contentRect;q.value={right:`calc(100% - ${Vn+15+6}px)`}});const Bt=()=>{const{type:gt,autosize:Sn}=a;if(!(!Wo||gt!=="textarea"||!U.value))if(Sn){const Vn=So(Sn)?Sn.minRows:void 0,lo=So(Sn)?Sn.maxRows:void 0,eo=qk(U.value,Vn,lo);J.value={overflowY:"hidden",...eo},Un(()=>{U.value.offsetHeight,J.value=eo})}else J.value={minHeight:qk(U.value).minHeight}},Gt=(gt=>{let Sn=!1;return()=>{var Vn;if(Sn||!a.autosize)return;((Vn=U.value)==null?void 0:Vn.offsetParent)===null||(gt(),Sn=!0)}})(Bt),jt=()=>{const gt=oe.value,Sn=a.formatter?a.formatter(Me.value):Me.value;!gt||gt.value===Sn||(gt.value=Sn)},Be=async gt=>{Ct();let{value:Sn}=gt.target;if(a.formatter&&(Sn=a.parser?a.parser(Sn):Sn),!At.value){if(Sn===Me.value){jt();return}i(xo,Sn),i("input",Sn),await Un(),jt(),Rt()}},an=gt=>{i("change",gt.target.value)},{isComposing:At,handleCompositionStart:Ge,handleCompositionUpdate:Fe,handleCompositionEnd:Nt}=e1({emit:i,afterComposition:Be}),Jt=()=>{K.value=!K.value,Dt()},Dt=async()=>{var gt;await Un(),(gt=oe.value)==null||gt.focus()},xt=()=>{var gt;return(gt=oe.value)==null?void 0:gt.blur()},Ot=gt=>{re.value=!1,i("mouseleave",gt)},en=gt=>{re.value=!0,i("mouseenter",gt)},dn=gt=>{i("keydown",gt)},un=()=>{var gt;(gt=oe.value)==null||gt.select()},Pn=()=>{i(xo,""),i("change",""),i("clear"),i("input","")};return qt(()=>a.modelValue,()=>{var gt;Un(()=>Bt()),a.validateEvent&&((gt=I==null?void 0:I.validate)==null||gt.call(I,"change").catch(Sn=>void 0))}),qt(Me,()=>jt()),qt(()=>a.type,async()=>{await Un(),jt(),Bt()}),_o(()=>{!a.formatter&&a.parser,jt(),Un(Bt)}),t({input:W,textarea:U,ref:oe,textareaStyle:ye,autosize:mr(a,"autosize"),isComposing:At,focus:Dt,blur:xt,select:un,clear:Pn,resizeTextarea:Bt}),(gt,Sn)=>(se(),Ie("div",{class:ue([y(o),{[y($).bm("group","append")]:gt.$slots.append,[y($).bm("group","prepend")]:gt.$slots.prepend}]),style:$n(y(Ee)),onMouseenter:en,onMouseleave:Ot},[yt(" input "),gt.type!=="textarea"?(se(),Ie(Fn,{key:0},[yt(" prepend slot "),gt.$slots.prepend?(se(),Ie("div",{key:0,class:ue(y($).be("group","prepend"))},[vt(gt.$slots,"prepend")],2)):yt("v-if",!0),je("div",{ref_key:"wrapperRef",ref:ae,class:ue(y(S))},[yt(" prefix slot "),gt.$slots.prefix||gt.prefixIcon?(se(),Ie("span",{key:0,class:ue(y($).e("prefix"))},[je("span",{class:ue(y($).e("prefix-inner"))},[vt(gt.$slots,"prefix"),gt.prefixIcon?(se(),Et(y(Dn),{key:0,class:ue(y($).e("icon"))},{default:it(()=>[(se(),Et(ko(gt.prefixIcon)))]),_:1},8,["class"])):yt("v-if",!0)],2)],2)):yt("v-if",!0),je("input",Po({id:y(R),ref_key:"input",ref:W,class:y($).e("inner")},y(g),{minlength:gt.minlength,maxlength:gt.maxlength,type:gt.showPassword?K.value?"text":"password":gt.type,disabled:y(N),readonly:gt.readonly,autocomplete:gt.autocomplete,tabindex:gt.tabindex,"aria-label":gt.ariaLabel,placeholder:gt.placeholder,style:gt.inputStyle,form:gt.form,autofocus:gt.autofocus,role:gt.containerRole,onCompositionstart:y(Ge),onCompositionupdate:y(Fe),onCompositionend:y(Nt),onInput:Be,onChange:an,onKeydown:dn}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),yt(" suffix slot "),y(De)?(se(),Ie("span",{key:1,class:ue(y($).e("suffix"))},[je("span",{class:ue(y($).e("suffix-inner"))},[!y(Te)||!y(he)||!y(ke)?(se(),Ie(Fn,{key:0},[vt(gt.$slots,"suffix"),gt.suffixIcon?(se(),Et(y(Dn),{key:0,class:ue(y($).e("icon"))},{default:it(()=>[(se(),Et(ko(gt.suffixIcon)))]),_:1},8,["class"])):yt("v-if",!0)],64)):yt("v-if",!0),y(Te)?(se(),Et(y(Dn),{key:1,class:ue([y($).e("icon"),y($).e("clear")]),onMousedown:Xn(y(xr),["prevent"]),onClick:Pn},{default:it(()=>[Ye(y(ud))]),_:1},8,["class","onMousedown"])):yt("v-if",!0),y(he)?(se(),Et(y(Dn),{key:2,class:ue([y($).e("icon"),y($).e("password")]),onClick:Jt},{default:it(()=>[(se(),Et(ko(y(Qe))))]),_:1},8,["class"])):yt("v-if",!0),y(ke)?(se(),Ie("span",{key:3,class:ue(y($).e("count"))},[je("span",{class:ue(y($).e("count-inner"))},mn(y(Ne))+" / "+mn(gt.maxlength),3)],2)):yt("v-if",!0),y(_e)&&y(Re)&&y(de)?(se(),Et(y(Dn),{key:4,class:ue([y($).e("icon"),y($).e("validateIcon"),y($).is("loading",y(_e)==="validating")])},{default:it(()=>[(se(),Et(ko(y(Re))))]),_:1},8,["class"])):yt("v-if",!0)],2)],2)):yt("v-if",!0)],2),yt(" append slot "),gt.$slots.append?(se(),Ie("div",{key:1,class:ue(y($).be("group","append"))},[vt(gt.$slots,"append")],2)):yt("v-if",!0)],64)):(se(),Ie(Fn,{key:1},[yt(" textarea "),je("textarea",Po({id:y(R),ref_key:"textarea",ref:U,class:[y(F).e("inner"),y($).is("focus",y(fe))]},y(g),{minlength:gt.minlength,maxlength:gt.maxlength,tabindex:gt.tabindex,disabled:y(N),readonly:gt.readonly,autocomplete:gt.autocomplete,style:y(ye),"aria-label":gt.ariaLabel,placeholder:gt.placeholder,form:gt.form,autofocus:gt.autofocus,rows:gt.rows,role:gt.containerRole,onCompositionstart:y(Ge),onCompositionupdate:y(Fe),onCompositionend:y(Nt),onInput:Be,onFocus:y(ge),onBlur:y(ce),onChange:an,onKeydown:dn}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),y(ke)?(se(),Ie("span",{key:0,style:$n(q.value),class:ue(y($).e("count"))},mn(y(Ne))+" / "+mn(gt.maxlength),7)):yt("v-if",!0)],64))],38))}});var nK=fn(tK,[["__file","input.vue"]]);const _s=uo(nK),Xf=4,kL={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},oK=({move:e,size:t,bar:i})=>({[i.size]:t,transform:`translate${i.axis}(${e}%)`}),RT=Symbol("scrollbarContextKey"),rK=cn({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),iK="Thumb",sK=qe({__name:"thumb",props:rK,setup(e){const t=e,i=kn(RT),a=Xt("scrollbar");i||Ai(iK,"can not inject scrollbar context");const d=xe(),g=xe(),_=xe({}),o=xe(!1);let S=!1,E=!1,I=Wo?document.onselectstart:null;const R=ee(()=>kL[t.vertical?"vertical":"horizontal"]),z=ee(()=>oK({size:t.size,move:t.move,bar:R.value})),N=ee(()=>d.value[R.value.offset]**2/i.wrapElement[R.value.scrollSize]/t.ratio/g.value[R.value.offset]),$=oe=>{var ae;if(oe.stopPropagation(),oe.ctrlKey||[1,2].includes(oe.button))return;(ae=window.getSelection())==null||ae.removeAllRanges(),W(oe);const fe=oe.currentTarget;fe&&(_.value[R.value.axis]=fe[R.value.offset]-(oe[R.value.client]-fe.getBoundingClientRect()[R.value.direction]))},F=oe=>{if(!g.value||!d.value||!i.wrapElement)return;const ae=Math.abs(oe.target.getBoundingClientRect()[R.value.direction]-oe[R.value.client]),fe=g.value[R.value.offset]/2,ge=(ae-fe)*100*N.value/d.value[R.value.offset];i.wrapElement[R.value.scroll]=ge*i.wrapElement[R.value.scrollSize]/100},W=oe=>{oe.stopImmediatePropagation(),S=!0,document.addEventListener("mousemove",U),document.addEventListener("mouseup",re),I=document.onselectstart,document.onselectstart=()=>!1},U=oe=>{if(!d.value||!g.value||S===!1)return;const ae=_.value[R.value.axis];if(!ae)return;const fe=(d.value.getBoundingClientRect()[R.value.direction]-oe[R.value.client])*-1,ge=g.value[R.value.offset]-ae,ce=(fe-ge)*100*N.value/d.value[R.value.offset];i.wrapElement[R.value.scroll]=ce*i.wrapElement[R.value.scrollSize]/100},re=()=>{S=!1,_.value[R.value.axis]=0,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",re),J(),E&&(o.value=!1)},K=()=>{E=!1,o.value=!!t.size},q=()=>{E=!0,o.value=S};Pr(()=>{J(),document.removeEventListener("mouseup",re)});const J=()=>{document.onselectstart!==I&&(document.onselectstart=I)};return wr(mr(i,"scrollbarElement"),"mousemove",K),wr(mr(i,"scrollbarElement"),"mouseleave",q),(oe,ae)=>(se(),Et(Ui,{name:y(a).b("fade"),persisted:""},{default:it(()=>[vo(je("div",{ref_key:"instance",ref:d,class:ue([y(a).e("bar"),y(a).is(y(R).key)]),onMousedown:F},[je("div",{ref_key:"thumb",ref:g,class:ue(y(a).e("thumb")),style:$n(y(z)),onMousedown:$},null,38)],34),[[ir,oe.always||o.value]])]),_:1},8,["name"]))}});var Kk=fn(sK,[["__file","thumb.vue"]]);const aK=cn({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),lK=qe({__name:"bar",props:aK,setup(e,{expose:t}){const i=e,a=kn(RT),d=xe(0),g=xe(0),_=xe(""),o=xe(""),S=xe(1),E=xe(1);return t({handleScroll:z=>{if(z){const N=z.offsetHeight-Xf,$=z.offsetWidth-Xf;g.value=z.scrollTop*100/N*S.value,d.value=z.scrollLeft*100/$*E.value}},update:()=>{const z=a==null?void 0:a.wrapElement;if(!z)return;const N=z.offsetHeight-Xf,$=z.offsetWidth-Xf,F=N**2/z.scrollHeight,W=$**2/z.scrollWidth,U=Math.max(F,i.minSize),re=Math.max(W,i.minSize);S.value=F/(N-F)/(U/(N-U)),E.value=W/($-W)/(re/($-re)),o.value=U+Xf<N?`${U}px`:"",_.value=re+Xf<$?`${re}px`:""}}),(z,N)=>(se(),Ie(Fn,null,[Ye(Kk,{move:d.value,ratio:E.value,size:_.value,always:z.always},null,8,["move","ratio","size","always"]),Ye(Kk,{move:g.value,ratio:S.value,size:o.value,vertical:"",always:z.always},null,8,["move","ratio","size","always"])],64))}});var cK=fn(lK,[["__file","bar.vue"]]);const uK=cn({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:at([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...Zi(["ariaLabel","ariaOrientation"])}),dK={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(Wn)},hK="ElScrollbar",fK=qe({name:hK}),pK=qe({...fK,props:uK,emits:dK,setup(e,{expose:t,emit:i}){const a=e,d=Xt("scrollbar");let g,_,o=0,S=0;const E=xe(),I=xe(),R=xe(),z=xe(),N=ee(()=>{const J={};return a.height&&(J.height=fi(a.height)),a.maxHeight&&(J.maxHeight=fi(a.maxHeight)),[a.wrapStyle,J]}),$=ee(()=>[a.wrapClass,d.e("wrap"),{[d.em("wrap","hidden-default")]:!a.native}]),F=ee(()=>[d.e("view"),a.viewClass]),W=()=>{var J;I.value&&((J=z.value)==null||J.handleScroll(I.value),o=I.value.scrollTop,S=I.value.scrollLeft,i("scroll",{scrollTop:I.value.scrollTop,scrollLeft:I.value.scrollLeft}))};function U(J,oe){So(J)?I.value.scrollTo(J):Wn(J)&&Wn(oe)&&I.value.scrollTo(J,oe)}const re=J=>{Wn(J)&&(I.value.scrollTop=J)},K=J=>{Wn(J)&&(I.value.scrollLeft=J)},q=()=>{var J;(J=z.value)==null||J.update()};return qt(()=>a.noresize,J=>{J?(g==null||g(),_==null||_()):({stop:g}=ei(R,q),_=wr("resize",q))},{immediate:!0}),qt(()=>[a.maxHeight,a.height],()=>{a.native||Un(()=>{var J;q(),I.value&&((J=z.value)==null||J.handleScroll(I.value))})}),Bo(RT,dr({scrollbarElement:E,wrapElement:I})),ES(()=>{I.value&&(I.value.scrollTop=o,I.value.scrollLeft=S)}),_o(()=>{a.native||Un(()=>{q()})}),Xl(()=>q()),t({wrapRef:I,update:q,scrollTo:U,setScrollTop:re,setScrollLeft:K,handleScroll:W}),(J,oe)=>(se(),Ie("div",{ref_key:"scrollbarRef",ref:E,class:ue(y(d).b())},[je("div",{ref_key:"wrapRef",ref:I,class:ue(y($)),style:$n(y(N)),tabindex:J.tabindex,onScroll:W},[(se(),Et(ko(J.tag),{id:J.id,ref_key:"resizeRef",ref:R,class:ue(y(F)),style:$n(J.viewStyle),role:J.role,"aria-label":J.ariaLabel,"aria-orientation":J.ariaOrientation},{default:it(()=>[vt(J.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),J.native?yt("v-if",!0):(se(),Et(cK,{key:0,ref_key:"barRef",ref:z,always:J.always,"min-size":J.minSize},null,8,["always","min-size"]))],2))}});var mK=fn(pK,[["__file","scrollbar.vue"]]);const nc=uo(mK),DT=Symbol("popper"),PL=Symbol("popperContent"),gK=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],RL=cn({role:{type:String,values:gK,default:"tooltip"}}),vK=qe({name:"ElPopper",inheritAttrs:!1}),_K=qe({...vK,props:RL,setup(e,{expose:t}){const i=e,a=xe(),d=xe(),g=xe(),_=xe(),o=ee(()=>i.role),S={triggerRef:a,popperInstanceRef:d,contentRef:g,referenceRef:_,role:o};return t(S),Bo(DT,S),(E,I)=>vt(E.$slots,"default")}});var yK=fn(_K,[["__file","popper.vue"]]);const DL=cn({arrowOffset:{type:Number,default:5}}),bK=qe({name:"ElPopperArrow",inheritAttrs:!1}),xK=qe({...bK,props:DL,setup(e,{expose:t}){const i=e,a=Xt("popper"),{arrowOffset:d,arrowRef:g,arrowStyle:_}=kn(PL,void 0);return qt(()=>i.arrowOffset,o=>{d.value=o}),Pr(()=>{g.value=void 0}),t({arrowRef:g}),(o,S)=>(se(),Ie("span",{ref_key:"arrowRef",ref:g,class:ue(y(a).e("arrow")),style:$n(y(_)),"data-popper-arrow":""},null,6))}});var wK=fn(xK,[["__file","arrow.vue"]]);const SK="ElOnlyChild",LL=qe({name:SK,setup(e,{slots:t,attrs:i}){var a;const d=kn(lL),g=G9((a=d==null?void 0:d.setForwardRef)!=null?a:xr);return()=>{var _;const o=(_=t.default)==null?void 0:_.call(t,i);if(!o||o.length>1)return null;const S=OL(o);return S?vo(Ic(S,i),[[g]]):null}}});function OL(e){if(!e)return null;const t=e;for(const i of t){if(So(i))switch(i.type){case Ni:continue;case Up:case"svg":return Zk(i);case Fn:return OL(i.children);default:return i}return Zk(i)}return null}function Zk(e){const t=Xt("only-child");return Ye("span",{class:t.e("content")},[e])}const zL=cn({virtualRef:{type:at(Object)},virtualTriggering:Boolean,onMouseenter:{type:at(Function)},onMouseleave:{type:at(Function)},onClick:{type:at(Function)},onKeydown:{type:at(Function)},onFocus:{type:at(Function)},onBlur:{type:at(Function)},onContextmenu:{type:at(Function)},id:String,open:Boolean}),TK=qe({name:"ElPopperTrigger",inheritAttrs:!1}),CK=qe({...TK,props:zL,setup(e,{expose:t}){const i=e,{role:a,triggerRef:d}=kn(DT,void 0);H9(d);const g=ee(()=>o.value?i.id:void 0),_=ee(()=>{if(a&&a.value==="tooltip")return i.open&&i.id?i.id:void 0}),o=ee(()=>{if(a&&a.value!=="tooltip")return a.value}),S=ee(()=>o.value?`${i.open}`:void 0);let E;const I=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return _o(()=>{qt(()=>i.virtualRef,R=>{R&&(d.value=Bs(R))},{immediate:!0}),qt(d,(R,z)=>{E==null||E(),E=void 0,va(R)&&(I.forEach(N=>{var $;const F=i[N];F&&(R.addEventListener(N.slice(2).toLowerCase(),F),($=z==null?void 0:z.removeEventListener)==null||$.call(z,N.slice(2).toLowerCase(),F))}),t2(R)&&(E=qt([g,_,o,S],N=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(($,F)=>{Pi(N[F])?R.removeAttribute($):R.setAttribute($,N[F])})},{immediate:!0}))),va(z)&&t2(z)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(N=>z.removeAttribute(N))},{immediate:!0})}),Pr(()=>{if(E==null||E(),E=void 0,d.value&&va(d.value)){const R=d.value;I.forEach(z=>{const N=i[z];N&&R.removeEventListener(z.slice(2).toLowerCase(),N)}),d.value=void 0}}),t({triggerRef:d}),(R,z)=>R.virtualTriggering?yt("v-if",!0):(se(),Et(y(LL),Po({key:0},R.$attrs,{"aria-controls":y(g),"aria-describedby":y(_),"aria-expanded":y(S),"aria-haspopup":y(o)}),{default:it(()=>[vt(R.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var EK=fn(CK,[["__file","trigger.vue"]]);const bw="focus-trap.focus-after-trapped",xw="focus-trap.focus-after-released",MK="focus-trap.focusout-prevented",Yk={cancelable:!0,bubbles:!1},IK={cancelable:!0,bubbles:!1},Xk="focusAfterTrapped",Jk="focusAfterReleased",LT=Symbol("elFocusTrap"),OT=xe(),r1=xe(0),zT=xe(0);let _0=0;const BL=e=>{const t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const d=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||d?NodeFilter.FILTER_SKIP:a.tabIndex>=0||a===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t},Qk=(e,t)=>{for(const i of e)if(!AK(i,t))return i},AK=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},kK=e=>{const t=BL(e),i=Qk(t,e),a=Qk(t.reverse(),e);return[i,a]},PK=e=>e instanceof HTMLInputElement&&"select"in e,Ou=(e,t)=>{if(e&&e.focus){const i=document.activeElement;e.focus({preventScroll:!0}),zT.value=window.performance.now(),e!==i&&PK(e)&&t&&e.select()}};function e3(e,t){const i=[...e],a=e.indexOf(t);return a!==-1&&i.splice(a,1),i}const RK=()=>{let e=[];return{push:a=>{const d=e[0];d&&a!==d&&d.pause(),e=e3(e,a),e.unshift(a)},remove:a=>{var d,g;e=e3(e,a),(g=(d=e[0])==null?void 0:d.resume)==null||g.call(d)}}},DK=(e,t=!1)=>{const i=document.activeElement;for(const a of e)if(Ou(a,t),document.activeElement!==i)return},t3=RK(),LK=()=>r1.value>zT.value,y0=()=>{OT.value="pointer",r1.value=window.performance.now()},n3=()=>{OT.value="keyboard",r1.value=window.performance.now()},OK=()=>(_o(()=>{_0===0&&(document.addEventListener("mousedown",y0),document.addEventListener("touchstart",y0),document.addEventListener("keydown",n3)),_0++}),Pr(()=>{_0--,_0<=0&&(document.removeEventListener("mousedown",y0),document.removeEventListener("touchstart",y0),document.removeEventListener("keydown",n3))}),{focusReason:OT,lastUserFocusTimestamp:r1,lastAutomatedFocusTimestamp:zT}),b0=e=>new CustomEvent(MK,{...IK,detail:e}),zK=qe({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Xk,Jk,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const i=xe();let a,d;const{focusReason:g}=OK();N9($=>{e.trapped&&!_.paused&&t("release-requested",$)});const _={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},o=$=>{if(!e.loop&&!e.trapped||_.paused)return;const{code:F,altKey:W,ctrlKey:U,metaKey:re,currentTarget:K,shiftKey:q}=$,{loop:J}=e,oe=F===Cn.tab&&!W&&!U&&!re,ae=document.activeElement;if(oe&&ae){const fe=K,[ge,ce]=kK(fe);if(ge&&ce){if(!q&&ae===ce){const _e=b0({focusReason:g.value});t("focusout-prevented",_e),_e.defaultPrevented||($.preventDefault(),J&&Ou(ge,!0))}else if(q&&[ge,fe].includes(ae)){const _e=b0({focusReason:g.value});t("focusout-prevented",_e),_e.defaultPrevented||($.preventDefault(),J&&Ou(ce,!0))}}else if(ae===fe){const _e=b0({focusReason:g.value});t("focusout-prevented",_e),_e.defaultPrevented||$.preventDefault()}}};Bo(LT,{focusTrapRef:i,onKeydown:o}),qt(()=>e.focusTrapEl,$=>{$&&(i.value=$)},{immediate:!0}),qt([i],([$],[F])=>{$&&($.addEventListener("keydown",o),$.addEventListener("focusin",I),$.addEventListener("focusout",R)),F&&(F.removeEventListener("keydown",o),F.removeEventListener("focusin",I),F.removeEventListener("focusout",R))});const S=$=>{t(Xk,$)},E=$=>t(Jk,$),I=$=>{const F=y(i);if(!F)return;const W=$.target,U=$.relatedTarget,re=W&&F.contains(W);e.trapped||U&&F.contains(U)||(a=U),re&&t("focusin",$),!_.paused&&e.trapped&&(re?d=W:Ou(d,!0))},R=$=>{const F=y(i);if(!(_.paused||!F))if(e.trapped){const W=$.relatedTarget;!Pi(W)&&!F.contains(W)&&setTimeout(()=>{if(!_.paused&&e.trapped){const U=b0({focusReason:g.value});t("focusout-prevented",U),U.defaultPrevented||Ou(d,!0)}},0)}else{const W=$.target;W&&F.contains(W)||t("focusout",$)}};async function z(){await Un();const $=y(i);if($){t3.push(_);const F=$.contains(document.activeElement)?a:document.activeElement;if(a=F,!$.contains(F)){const U=new Event(bw,Yk);$.addEventListener(bw,S),$.dispatchEvent(U),U.defaultPrevented||Un(()=>{let re=e.focusStartEl;Bn(re)||(Ou(re),document.activeElement!==re&&(re="first")),re==="first"&&DK(BL($),!0),(document.activeElement===F||re==="container")&&Ou($)})}}}function N(){const $=y(i);if($){$.removeEventListener(bw,S);const F=new CustomEvent(xw,{...Yk,detail:{focusReason:g.value}});$.addEventListener(xw,E),$.dispatchEvent(F),!F.defaultPrevented&&(g.value=="keyboard"||!LK()||$.contains(document.activeElement))&&Ou(a??document.body),$.removeEventListener(xw,E),t3.remove(_)}}return _o(()=>{e.trapped&&z(),qt(()=>e.trapped,$=>{$?z():N()})}),Pr(()=>{e.trapped&&N(),i.value&&(i.value.removeEventListener("keydown",o),i.value.removeEventListener("focusin",I),i.value.removeEventListener("focusout",R),i.value=void 0)}),{onKeydown:o}}});function BK(e,t,i,a,d,g){return vt(e.$slots,"default",{handleKeydown:e.onKeydown})}var h_=fn(zK,[["render",BK],["__file","focus-trap.vue"]]);const FK=["fixed","absolute"],NK=cn({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:at(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:zc,default:"bottom"},popperOptions:{type:at(Object),default:()=>({})},strategy:{type:String,values:FK,default:"absolute"}}),FL=cn({...NK,id:String,style:{type:at([String,Array,Object])},className:{type:at([String,Array,Object])},effect:{type:at(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:at([String,Array,Object])},popperStyle:{type:at([String,Array,Object])},referenceEl:{type:at(Object)},triggerTargetEl:{type:at(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...Zi(["ariaLabel"])}),$K={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},VK=(e,t=[])=>{const{placement:i,strategy:a,popperOptions:d}=e,g={placement:i,strategy:a,...d,modifiers:[...jK(e),...t]};return HK(g,d==null?void 0:d.modifiers),g},UK=e=>{if(Wo)return Bs(e)};function jK(e){const{offset:t,gpuAcceleration:i,fallbackPlacements:a}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:a}},{name:"computeStyles",options:{gpuAcceleration:i}}]}function HK(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const GK=0,WK=e=>{const{popperInstanceRef:t,contentRef:i,triggerRef:a,role:d}=kn(DT,void 0),g=xe(),_=xe(),o=ee(()=>({name:"eventListeners",enabled:!!e.visible})),S=ee(()=>{var U;const re=y(g),K=(U=y(_))!=null?U:GK;return{name:"arrow",enabled:!DD(re),options:{element:re,padding:K}}}),E=ee(()=>({onFirstUpdate:()=>{$()},...VK(e,[y(S),y(o)])})),I=ee(()=>UK(e.referenceEl)||y(a)),{attributes:R,state:z,styles:N,update:$,forceUpdate:F,instanceRef:W}=O9(I,i,E);return qt(W,U=>t.value=U),_o(()=>{qt(()=>{var U;return(U=y(I))==null?void 0:U.getBoundingClientRect()},()=>{$()})}),{attributes:R,arrowRef:g,contentRef:i,instanceRef:W,state:z,styles:N,role:d,forceUpdate:F,update:$}},qK=(e,{attributes:t,styles:i,role:a})=>{const{nextZIndex:d}=qp(),g=Xt("popper"),_=ee(()=>y(t).popper),o=xe(Wn(e.zIndex)?e.zIndex:d()),S=ee(()=>[g.b(),g.is("pure",e.pure),g.is(e.effect),e.popperClass]),E=ee(()=>[{zIndex:y(o)},y(i).popper,e.popperStyle||{}]),I=ee(()=>a.value==="dialog"?"false":void 0),R=ee(()=>y(i).arrow||{});return{ariaModal:I,arrowStyle:R,contentAttrs:_,contentClass:S,contentStyle:E,contentZIndex:o,updateZIndex:()=>{o.value=Wn(e.zIndex)?e.zIndex:d()}}},KK=(e,t)=>{const i=xe(!1),a=xe();return{focusStartRef:a,trapped:i,onFocusAfterReleased:E=>{var I;((I=E.detail)==null?void 0:I.focusReason)!=="pointer"&&(a.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:E=>{e.visible&&!i.value&&(E.target&&(a.value=E.target),i.value=!0)},onFocusoutPrevented:E=>{e.trapping||(E.detail.focusReason==="pointer"&&E.preventDefault(),i.value=!1)},onReleaseRequested:()=>{i.value=!1,t("close")}}},ZK=qe({name:"ElPopperContent"}),YK=qe({...ZK,props:FL,emits:$K,setup(e,{expose:t,emit:i}){const a=e,{focusStartRef:d,trapped:g,onFocusAfterReleased:_,onFocusAfterTrapped:o,onFocusInTrap:S,onFocusoutPrevented:E,onReleaseRequested:I}=KK(a,i),{attributes:R,arrowRef:z,contentRef:N,styles:$,instanceRef:F,role:W,update:U}=WK(a),{ariaModal:re,arrowStyle:K,contentAttrs:q,contentClass:J,contentStyle:oe,updateZIndex:ae}=qK(a,{styles:$,attributes:R,role:W}),fe=kn(Yl,void 0),ge=xe();Bo(PL,{arrowStyle:K,arrowRef:z,arrowOffset:ge}),fe&&Bo(Yl,{...fe,addInputId:xr,removeInputId:xr});let ce;const de=(Re=!0)=>{U(),Re&&ae()},_e=()=>{de(!1),a.visible&&a.focusOnShow?g.value=!0:a.visible===!1&&(g.value=!1)};return _o(()=>{qt(()=>a.triggerTargetEl,(Re,Qe)=>{ce==null||ce(),ce=void 0;const Ee=y(Re||N.value),ye=y(Qe||N.value);va(Ee)&&(ce=qt([W,()=>a.ariaLabel,re,()=>a.id],Me=>{["role","aria-label","aria-modal","id"].forEach((Te,he)=>{Pi(Me[he])?Ee.removeAttribute(Te):Ee.setAttribute(Te,Me[he])})},{immediate:!0})),ye!==Ee&&va(ye)&&["role","aria-label","aria-modal","id"].forEach(Me=>{ye.removeAttribute(Me)})},{immediate:!0}),qt(()=>a.visible,_e,{immediate:!0})}),Pr(()=>{ce==null||ce(),ce=void 0}),t({popperContentRef:N,popperInstanceRef:F,updatePopper:de,contentStyle:oe}),(Re,Qe)=>(se(),Ie("div",Po({ref_key:"contentRef",ref:N},y(q),{style:y(oe),class:y(J),tabindex:"-1",onMouseenter:Ee=>Re.$emit("mouseenter",Ee),onMouseleave:Ee=>Re.$emit("mouseleave",Ee)}),[Ye(y(h_),{trapped:y(g),"trap-on-focus-in":!0,"focus-trap-el":y(N),"focus-start-el":y(d),onFocusAfterTrapped:y(o),onFocusAfterReleased:y(_),onFocusin:y(S),onFocusoutPrevented:y(E),onReleaseRequested:y(I)},{default:it(()=>[vt(Re.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var XK=fn(YK,[["__file","content.vue"]]);const NL=uo(yK),i1=Symbol("elTooltip"),Fi=cn({...U9,...FL,appendTo:{type:at([String,Object])},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:at(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...Zi(["ariaLabel"])}),Fv=cn({...zL,disabled:Boolean,trigger:{type:at([String,Array]),default:"hover"},triggerKeys:{type:at(Array),default:()=>[Cn.enter,Cn.numpadEnter,Cn.space]}}),{useModelToggleProps:JK,useModelToggleEmits:QK,useModelToggle:eZ}=RW("visible"),tZ=cn({...RL,...JK,...Fi,...Fv,...DL,showArrow:{type:Boolean,default:!0}}),nZ=[...QK,"before-show","before-hide","show","hide","open","close"],oZ=(e,t)=>sn(e)?e.includes(t):e===t,Jf=(e,t,i)=>a=>{oZ(y(e),t)&&i(a)},rZ=qe({name:"ElTooltipTrigger"}),iZ=qe({...rZ,props:Fv,setup(e,{expose:t}){const i=e,a=Xt("tooltip"),{controlled:d,id:g,open:_,onOpen:o,onClose:S,onToggle:E}=kn(i1,void 0),I=xe(null),R=()=>{if(y(d)||i.disabled)return!0},z=mr(i,"trigger"),N=hi(R,Jf(z,"hover",o)),$=hi(R,Jf(z,"hover",S)),F=hi(R,Jf(z,"click",q=>{q.button===0&&E(q)})),W=hi(R,Jf(z,"focus",o)),U=hi(R,Jf(z,"focus",S)),re=hi(R,Jf(z,"contextmenu",q=>{q.preventDefault(),E(q)})),K=hi(R,q=>{const{code:J}=q;i.triggerKeys.includes(J)&&(q.preventDefault(),E(q))});return t({triggerRef:I}),(q,J)=>(se(),Et(y(EK),{id:y(g),"virtual-ref":q.virtualRef,open:y(_),"virtual-triggering":q.virtualTriggering,class:ue(y(a).e("trigger")),onBlur:y(U),onClick:y(F),onContextmenu:y(re),onFocus:y(W),onMouseenter:y(N),onMouseleave:y($),onKeydown:y(K)},{default:it(()=>[vt(q.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var sZ=fn(iZ,[["__file","trigger.vue"]]);const aZ=cn({to:{type:at([String,Object]),required:!0},disabled:Boolean}),lZ=qe({__name:"teleport",props:aZ,setup(e){return(t,i)=>t.disabled?vt(t.$slots,"default",{key:0}):(se(),Et(f5,{key:1,to:t.to},[vt(t.$slots,"default")],8,["to"]))}});var cZ=fn(lZ,[["__file","teleport.vue"]]);const Yp=uo(cZ),uZ=qe({name:"ElTooltipContent",inheritAttrs:!1}),dZ=qe({...uZ,props:Fi,setup(e,{expose:t}){const i=e,{selector:a}=aL(),d=Xt("tooltip"),g=xe(null);let _;const{controlled:o,id:S,open:E,trigger:I,onClose:R,onOpen:z,onShow:N,onHide:$,onBeforeShow:F,onBeforeHide:W}=kn(i1,void 0),U=ee(()=>i.transition||`${d.namespace.value}-fade-in-linear`),re=ee(()=>i.persistent);Pr(()=>{_==null||_()});const K=ee(()=>y(re)?!0:y(E)),q=ee(()=>i.disabled?!1:y(E)),J=ee(()=>i.appendTo||a.value),oe=ee(()=>{var ye;return(ye=i.style)!=null?ye:{}}),ae=xe(!0),fe=()=>{$(),ae.value=!0},ge=()=>{if(y(o))return!0},ce=hi(ge,()=>{i.enterable&&y(I)==="hover"&&z()}),de=hi(ge,()=>{y(I)==="hover"&&R()}),_e=()=>{var ye,Me;(Me=(ye=g.value)==null?void 0:ye.updatePopper)==null||Me.call(ye),F==null||F()},Re=()=>{W==null||W()},Qe=()=>{N(),_=zS(ee(()=>{var ye;return(ye=g.value)==null?void 0:ye.popperContentRef}),()=>{if(y(o))return;y(I)!=="hover"&&R()})},Ee=()=>{i.virtualTriggering||R()};return qt(()=>y(E),ye=>{ye?ae.value=!1:_==null||_()},{flush:"post"}),qt(()=>i.content,()=>{var ye,Me;(Me=(ye=g.value)==null?void 0:ye.updatePopper)==null||Me.call(ye)}),t({contentRef:g}),(ye,Me)=>(se(),Et(y(Yp),{disabled:!ye.teleported,to:y(J)},{default:it(()=>[Ye(Ui,{name:y(U),onAfterLeave:fe,onBeforeEnter:_e,onAfterEnter:Qe,onBeforeLeave:Re},{default:it(()=>[y(K)?vo((se(),Et(y(XK),Po({key:0,id:y(S),ref_key:"contentRef",ref:g},ye.$attrs,{"aria-label":ye.ariaLabel,"aria-hidden":ae.value,"boundaries-padding":ye.boundariesPadding,"fallback-placements":ye.fallbackPlacements,"gpu-acceleration":ye.gpuAcceleration,offset:ye.offset,placement:ye.placement,"popper-options":ye.popperOptions,strategy:ye.strategy,effect:ye.effect,enterable:ye.enterable,pure:ye.pure,"popper-class":ye.popperClass,"popper-style":[ye.popperStyle,y(oe)],"reference-el":ye.referenceEl,"trigger-target-el":ye.triggerTargetEl,visible:y(q),"z-index":ye.zIndex,onMouseenter:y(ce),onMouseleave:y(de),onBlur:Ee,onClose:y(R)}),{default:it(()=>[vt(ye.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[ir,y(q)]]):yt("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var hZ=fn(dZ,[["__file","content.vue"]]);const fZ=qe({name:"ElTooltip"}),pZ=qe({...fZ,props:tZ,emits:nZ,setup(e,{expose:t,emit:i}){const a=e;V9();const d=Ki(),g=xe(),_=xe(),o=()=>{var U;const re=y(g);re&&((U=re.popperInstanceRef)==null||U.update())},S=xe(!1),E=xe(),{show:I,hide:R,hasUpdateHandler:z}=eZ({indicator:S,toggleReason:E}),{onOpen:N,onClose:$}=j9({showAfter:mr(a,"showAfter"),hideAfter:mr(a,"hideAfter"),autoClose:mr(a,"autoClose"),open:I,close:R}),F=ee(()=>Lr(a.visible)&&!z.value);Bo(i1,{controlled:F,id:d,open:Vp(S),trigger:mr(a,"trigger"),onOpen:U=>{N(U)},onClose:U=>{$(U)},onToggle:U=>{y(S)?$(U):N(U)},onShow:()=>{i("show",E.value)},onHide:()=>{i("hide",E.value)},onBeforeShow:()=>{i("before-show",E.value)},onBeforeHide:()=>{i("before-hide",E.value)},updatePopper:o}),qt(()=>a.disabled,U=>{U&&S.value&&(S.value=!1)});const W=U=>{var re,K;const q=(K=(re=_.value)==null?void 0:re.contentRef)==null?void 0:K.popperContentRef,J=(U==null?void 0:U.relatedTarget)||document.activeElement;return q&&q.contains(J)};return eR(()=>S.value&&R()),t({popperRef:g,contentRef:_,isFocusInsideContent:W,updatePopper:o,onOpen:N,onClose:$,hide:R}),(U,re)=>(se(),Et(y(NL),{ref_key:"popperRef",ref:g,role:U.role},{default:it(()=>[Ye(sZ,{disabled:U.disabled,trigger:U.trigger,"trigger-keys":U.triggerKeys,"virtual-ref":U.virtualRef,"virtual-triggering":U.virtualTriggering},{default:it(()=>[U.$slots.default?vt(U.$slots,"default",{key:0}):yt("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Ye(hZ,{ref_key:"contentRef",ref:_,"aria-label":U.ariaLabel,"boundaries-padding":U.boundariesPadding,content:U.content,disabled:U.disabled,effect:U.effect,enterable:U.enterable,"fallback-placements":U.fallbackPlacements,"hide-after":U.hideAfter,"gpu-acceleration":U.gpuAcceleration,offset:U.offset,persistent:U.persistent,"popper-class":U.popperClass,"popper-style":U.popperStyle,placement:U.placement,"popper-options":U.popperOptions,pure:U.pure,"raw-content":U.rawContent,"reference-el":U.referenceEl,"trigger-target-el":U.triggerTargetEl,"show-after":U.showAfter,strategy:U.strategy,teleported:U.teleported,transition:U.transition,"virtual-triggering":U.virtualTriggering,"z-index":U.zIndex,"append-to":U.appendTo},{default:it(()=>[vt(U.$slots,"content",{},()=>[U.rawContent?(se(),Ie("span",{key:0,innerHTML:U.content},null,8,["innerHTML"])):(se(),Ie("span",{key:1},mn(U.content),1))]),U.showArrow?(se(),Et(y(wK),{key:0,"arrow-offset":U.arrowOffset},null,8,["arrow-offset"])):yt("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var mZ=fn(pZ,[["__file","tooltip.vue"]]);const rs=uo(mZ),gZ=cn({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:at(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:at([Function,Array]),default:xr},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:Fi.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...Zi(["ariaLabel"])}),vZ={[xo]:e=>Bn(e),[Ns]:e=>Bn(e),[Wr]:e=>Bn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>So(e)},$L="ElAutocomplete",_Z=qe({name:$L,inheritAttrs:!1}),yZ=qe({..._Z,props:gZ,emits:vZ,setup(e,{expose:t,emit:i}){const a=e,d=Zb(),g=Ph(),_=bs(),o=Xt("autocomplete"),S=xe(),E=xe(),I=xe(),R=xe();let z=!1,N=!1;const $=xe([]),F=xe(-1),W=xe(""),U=xe(!1),re=xe(!1),K=xe(!1),q=Ki(),J=ee(()=>g.style),oe=ee(()=>($.value.length>0||K.value)&&U.value),ae=ee(()=>!a.hideLoading&&K.value),fe=ee(()=>S.value?Array.from(S.value.$el.querySelectorAll("input")):[]),ge=()=>{oe.value&&(W.value=`${S.value.$el.offsetWidth}px`)},ce=()=>{F.value=-1},de=async mt=>{if(re.value)return;const Gt=jt=>{K.value=!1,!re.value&&(sn(jt)?($.value=jt,F.value=a.highlightFirstItem?0:-1):Ai($L,"autocomplete suggestions must be an array"))};if(K.value=!0,sn(a.fetchSuggestions))Gt(a.fetchSuggestions);else{const jt=await a.fetchSuggestions(mt,Gt);sn(jt)&&Gt(jt)}},_e=Qs(de,a.debounce),Re=mt=>{const Gt=!!mt;if(i(Ns,mt),i(xo,mt),re.value=!1,U.value||(U.value=Gt),!a.triggerOnFocus&&!mt){re.value=!0,$.value=[];return}_e(mt)},Qe=mt=>{var Gt;_.value||(((Gt=mt.target)==null?void 0:Gt.tagName)!=="INPUT"||fe.value.includes(document.activeElement))&&(U.value=!0)},Ee=mt=>{i(Wr,mt)},ye=mt=>{N?N=!1:(U.value=!0,i("focus",mt),a.triggerOnFocus&&!z&&_e(String(a.modelValue)))},Me=mt=>{setTimeout(()=>{var Gt;if((Gt=I.value)!=null&&Gt.isFocusInsideContent()){N=!0;return}U.value&&Ne(),i("blur",mt)})},Te=()=>{U.value=!1,i(xo,""),i("clear")},he=async()=>{oe.value&&F.value>=0&&F.value<$.value.length?Ct($.value[F.value]):a.selectWhenUnmatched&&(i("select",{value:a.modelValue}),$.value=[],F.value=-1)},ke=mt=>{oe.value&&(mt.preventDefault(),mt.stopPropagation(),Ne())},Ne=()=>{U.value=!1},nt=()=>{var mt;(mt=S.value)==null||mt.focus()},De=()=>{var mt;(mt=S.value)==null||mt.blur()},Ct=async mt=>{i(Ns,mt[a.valueKey]),i(xo,mt[a.valueKey]),i("select",mt),$.value=[],F.value=-1},Rt=mt=>{if(!oe.value||K.value)return;if(mt<0){F.value=-1;return}mt>=$.value.length&&(mt=$.value.length-1);const Gt=E.value.querySelector(`.${o.be("suggestion","wrap")}`),Be=Gt.querySelectorAll(`.${o.be("suggestion","list")} li`)[mt],an=Gt.scrollTop,{offsetTop:At,scrollHeight:Ge}=Be;At+Ge>an+Gt.clientHeight&&(Gt.scrollTop+=Ge),At<an&&(Gt.scrollTop-=Ge),F.value=mt,S.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${F.value}`)},Bt=zS(R,()=>{oe.value&&Ne()});return Pr(()=>{Bt==null||Bt()}),_o(()=>{S.value.ref.setAttribute("role","textbox"),S.value.ref.setAttribute("aria-autocomplete","list"),S.value.ref.setAttribute("aria-controls","id"),S.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${F.value}`),z=S.value.ref.hasAttribute("readonly")}),t({highlightedIndex:F,activated:U,loading:K,inputRef:S,popperRef:I,suggestions:$,handleSelect:Ct,handleKeyEnter:he,focus:nt,blur:De,close:Ne,highlight:Rt,getData:de}),(mt,Gt)=>(se(),Et(y(rs),{ref_key:"popperRef",ref:I,visible:y(oe),placement:mt.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[y(o).e("popper"),mt.popperClass],teleported:mt.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${y(o).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:ge,onHide:ce},{content:it(()=>[je("div",{ref_key:"regionRef",ref:E,class:ue([y(o).b("suggestion"),y(o).is("loading",y(ae))]),style:$n({[mt.fitInputWidth?"width":"minWidth"]:W.value,outline:"none"}),role:"region"},[Ye(y(nc),{id:y(q),tag:"ul","wrap-class":y(o).be("suggestion","wrap"),"view-class":y(o).be("suggestion","list"),role:"listbox"},{default:it(()=>[y(ae)?(se(),Ie("li",{key:0},[vt(mt.$slots,"loading",{},()=>[Ye(y(Dn),{class:ue(y(o).is("loading"))},{default:it(()=>[Ye(y(ql))]),_:1},8,["class"])])])):(se(!0),Ie(Fn,{key:1},Fo($.value,(jt,Be)=>(se(),Ie("li",{id:`${y(q)}-item-${Be}`,key:Be,class:ue({highlighted:F.value===Be}),role:"option","aria-selected":F.value===Be,onClick:an=>Ct(jt)},[vt(mt.$slots,"default",{item:jt},()=>[$o(mn(jt[mt.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:it(()=>[je("div",{ref_key:"listboxRef",ref:R,class:ue([y(o).b(),mt.$attrs.class]),style:$n(y(J)),role:"combobox","aria-haspopup":"listbox","aria-expanded":y(oe),"aria-owns":y(q)},[Ye(y(_s),Po({ref_key:"inputRef",ref:S},y(d),{clearable:mt.clearable,disabled:y(_),name:mt.name,"model-value":mt.modelValue,"aria-label":mt.ariaLabel,onInput:Re,onChange:Ee,onFocus:ye,onBlur:Me,onClear:Te,onKeydown:[kr(Xn(jt=>Rt(F.value-1),["prevent"]),["up"]),kr(Xn(jt=>Rt(F.value+1),["prevent"]),["down"]),kr(he,["enter"]),kr(Ne,["tab"]),kr(ke,["esc"])],onMousedown:Qe}),Na({_:2},[mt.$slots.prepend?{name:"prepend",fn:it(()=>[vt(mt.$slots,"prepend")])}:void 0,mt.$slots.append?{name:"append",fn:it(()=>[vt(mt.$slots,"append")])}:void 0,mt.$slots.prefix?{name:"prefix",fn:it(()=>[vt(mt.$slots,"prefix")])}:void 0,mt.$slots.suffix?{name:"suffix",fn:it(()=>[vt(mt.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var bZ=fn(yZ,[["__file","autocomplete.vue"]]);const xZ=uo(bZ),wZ=cn({size:{type:[Number,String],values:ec,default:"",validator:e=>Wn(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:Cr},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:at(String),default:"cover"}}),SZ={error:e=>e instanceof Event},TZ=qe({name:"ElAvatar"}),CZ=qe({...TZ,props:wZ,emits:SZ,setup(e,{emit:t}){const i=e,a=Xt("avatar"),d=xe(!1),g=ee(()=>{const{size:E,icon:I,shape:R}=i,z=[a.b()];return Bn(E)&&z.push(a.m(E)),I&&z.push(a.m("icon")),R&&z.push(a.m(R)),z}),_=ee(()=>{const{size:E}=i;return Wn(E)?a.cssVarBlock({size:fi(E)||""}):void 0}),o=ee(()=>({objectFit:i.fit}));qt(()=>i.src,()=>d.value=!1);function S(E){d.value=!0,t("error",E)}return(E,I)=>(se(),Ie("span",{class:ue(y(g)),style:$n(y(_))},[(E.src||E.srcSet)&&!d.value?(se(),Ie("img",{key:0,src:E.src,alt:E.alt,srcset:E.srcSet,style:$n(y(o)),onError:S},null,44,["src","alt","srcset"])):E.icon?(se(),Et(y(Dn),{key:1},{default:it(()=>[(se(),Et(ko(E.icon)))]),_:1})):vt(E.$slots,"default",{key:2})],6))}});var EZ=fn(CZ,[["__file","avatar.vue"]]);const MZ=uo(EZ),IZ={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},AZ={click:e=>e instanceof MouseEvent},kZ=(e,t,i)=>{const a=qr(),d=qr(),g=xe(!1),_=()=>{a.value&&(g.value=a.value.scrollTop>=e.visibilityHeight)},o=E=>{var I;(I=a.value)==null||I.scrollTo({top:0,behavior:"smooth"}),t("click",E)},S=GR(_,300,!0);return wr(d,"scroll",S),_o(()=>{var E;d.value=document,a.value=document.documentElement,e.target&&(a.value=(E=document.querySelector(e.target))!=null?E:void 0,a.value||Ai(i,`target does not exist: ${e.target}`),d.value=a.value),_()}),{visible:g,handleClick:o}},VL="ElBacktop",PZ=qe({name:VL}),RZ=qe({...PZ,props:IZ,emits:AZ,setup(e,{emit:t}){const i=e,a=Xt("backtop"),{handleClick:d,visible:g}=kZ(i,t,VL),_=ee(()=>({right:`${i.right}px`,bottom:`${i.bottom}px`}));return(o,S)=>(se(),Et(Ui,{name:`${y(a).namespace.value}-fade-in`},{default:it(()=>[y(g)?(se(),Ie("div",{key:0,style:$n(y(_)),class:ue(y(a).b()),onClick:Xn(y(d),["stop"])},[vt(o.$slots,"default",{},()=>[Ye(y(Dn),{class:ue(y(a).e("icon"))},{default:it(()=>[Ye(y(mG))]),_:1},8,["class"])])],14,["onClick"])):yt("v-if",!0)]),_:3},8,["name"]))}});var DZ=fn(RZ,[["__file","backtop.vue"]]);const LZ=uo(DZ),OZ=cn({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:at([String,Object,Array])},offset:{type:at(Array),default:[0,0]},badgeClass:{type:String}}),zZ=qe({name:"ElBadge"}),BZ=qe({...zZ,props:OZ,setup(e,{expose:t}){const i=e,a=Xt("badge"),d=ee(()=>i.isDot?"":Wn(i.value)&&Wn(i.max)?i.max<i.value?`${i.max}+`:`${i.value}`:`${i.value}`),g=ee(()=>{var _,o,S,E,I;return[{backgroundColor:i.color,marginRight:fi(-((o=(_=i.offset)==null?void 0:_[0])!=null?o:0)),marginTop:fi((E=(S=i.offset)==null?void 0:S[1])!=null?E:0)},(I=i.badgeStyle)!=null?I:{}]});return t({content:d}),(_,o)=>(se(),Ie("div",{class:ue(y(a).b())},[vt(_.$slots,"default"),Ye(Ui,{name:`${y(a).namespace.value}-zoom-in-center`,persisted:""},{default:it(()=>[vo(je("sup",{class:ue([y(a).e("content"),y(a).em("content",_.type),y(a).is("fixed",!!_.$slots.default),y(a).is("dot",_.isDot),y(a).is("hide-zero",!_.showZero&&i.value===0),_.badgeClass]),style:$n(y(g)),textContent:mn(y(d))},null,14,["textContent"]),[[ir,!_.hidden&&(y(d)||_.isDot)]])]),_:1},8,["name"])],2))}});var FZ=fn(BZ,[["__file","badge.vue"]]);const UL=uo(FZ),jL=Symbol("breadcrumbKey"),NZ=cn({separator:{type:String,default:"/"},separatorIcon:{type:Cr}}),$Z=qe({name:"ElBreadcrumb"}),VZ=qe({...$Z,props:NZ,setup(e){const t=e,{t:i}=qo(),a=Xt("breadcrumb"),d=xe();return Bo(jL,t),_o(()=>{const g=d.value.querySelectorAll(`.${a.e("item")}`);g.length&&g[g.length-1].setAttribute("aria-current","page")}),(g,_)=>(se(),Ie("div",{ref_key:"breadcrumb",ref:d,class:ue(y(a).b()),"aria-label":y(i)("el.breadcrumb.label"),role:"navigation"},[vt(g.$slots,"default")],10,["aria-label"]))}});var UZ=fn(VZ,[["__file","breadcrumb.vue"]]);const jZ=cn({to:{type:at([String,Object]),default:""},replace:Boolean}),HZ=qe({name:"ElBreadcrumbItem"}),GZ=qe({...HZ,props:jZ,setup(e){const t=e,i=To(),a=kn(jL,void 0),d=Xt("breadcrumb"),g=i.appContext.config.globalProperties.$router,_=xe(),o=()=>{!t.to||!g||(t.replace?g.replace(t.to):g.push(t.to))};return(S,E)=>{var I,R;return se(),Ie("span",{class:ue(y(d).e("item"))},[je("span",{ref_key:"link",ref:_,class:ue([y(d).e("inner"),y(d).is("link",!!S.to)]),role:"link",onClick:o},[vt(S.$slots,"default")],2),(I=y(a))!=null&&I.separatorIcon?(se(),Et(y(Dn),{key:0,class:ue(y(d).e("separator"))},{default:it(()=>[(se(),Et(ko(y(a).separatorIcon)))]),_:1},8,["class"])):(se(),Ie("span",{key:1,class:ue(y(d).e("separator")),role:"presentation"},mn((R=y(a))==null?void 0:R.separator),3))],2)}}});var HL=fn(GZ,[["__file","breadcrumb-item.vue"]]);const WZ=uo(UZ,{BreadcrumbItem:HL}),qZ=ri(HL),GL=Symbol("buttonGroupContextKey"),KZ=(e,t)=>{Ku({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},ee(()=>e.type==="text"));const i=kn(GL,void 0),a=n1("button"),{form:d}=xs(),g=Mi(ee(()=>i==null?void 0:i.size)),_=bs(),o=xe(),S=Ri(),E=ee(()=>e.type||(i==null?void 0:i.type)||""),I=ee(()=>{var $,F,W;return(W=(F=e.autoInsertSpace)!=null?F:($=a.value)==null?void 0:$.autoInsertSpace)!=null?W:!1}),R=ee(()=>e.tag==="button"?{ariaDisabled:_.value||e.loading,disabled:_.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),z=ee(()=>{var $;const F=($=S.default)==null?void 0:$.call(S);if(I.value&&(F==null?void 0:F.length)===1){const W=F[0];if((W==null?void 0:W.type)===Up){const U=W.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(U.trim())}}return!1});return{_disabled:_,_size:g,_type:E,_ref:o,_props:R,shouldAddSpace:z,handleClick:$=>{if(_.value||e.loading){$.stopPropagation();return}e.nativeType==="reset"&&(d==null||d.resetFields()),t("click",$)}}},w2=["default","primary","success","warning","info","danger","text",""],ZZ=["button","submit","reset"],S2=cn({size:ki,disabled:Boolean,type:{type:String,values:w2,default:""},icon:{type:Cr},nativeType:{type:String,values:ZZ,default:"button"},loading:Boolean,loadingIcon:{type:Cr,default:()=>ql},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:at([String,Object]),default:"button"}}),YZ={click:e=>e instanceof MouseEvent};function os(e,t){XZ(e)&&(e="100%");var i=JZ(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function x0(e){return Math.min(1,Math.max(0,e))}function XZ(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function JZ(e){return typeof e=="string"&&e.indexOf("%")!==-1}function WL(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function w0(e){return e<=1?"".concat(Number(e)*100,"%"):e}function uh(e){return e.length===1?"0"+e:String(e)}function QZ(e,t,i){return{r:os(e,255)*255,g:os(t,255)*255,b:os(i,255)*255}}function o3(e,t,i){e=os(e,255),t=os(t,255),i=os(i,255);var a=Math.max(e,t,i),d=Math.min(e,t,i),g=0,_=0,o=(a+d)/2;if(a===d)_=0,g=0;else{var S=a-d;switch(_=o>.5?S/(2-a-d):S/(a+d),a){case e:g=(t-i)/S+(t<i?6:0);break;case t:g=(i-e)/S+2;break;case i:g=(e-t)/S+4;break}g/=6}return{h:g,s:_,l:o}}function ww(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*(6*i):i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function eY(e,t,i){var a,d,g;if(e=os(e,360),t=os(t,100),i=os(i,100),t===0)d=i,g=i,a=i;else{var _=i<.5?i*(1+t):i+t-i*t,o=2*i-_;a=ww(o,_,e+1/3),d=ww(o,_,e),g=ww(o,_,e-1/3)}return{r:a*255,g:d*255,b:g*255}}function r3(e,t,i){e=os(e,255),t=os(t,255),i=os(i,255);var a=Math.max(e,t,i),d=Math.min(e,t,i),g=0,_=a,o=a-d,S=a===0?0:o/a;if(a===d)g=0;else{switch(a){case e:g=(t-i)/o+(t<i?6:0);break;case t:g=(i-e)/o+2;break;case i:g=(e-t)/o+4;break}g/=6}return{h:g,s:S,v:_}}function tY(e,t,i){e=os(e,360)*6,t=os(t,100),i=os(i,100);var a=Math.floor(e),d=e-a,g=i*(1-t),_=i*(1-d*t),o=i*(1-(1-d)*t),S=a%6,E=[i,_,g,g,o,i][S],I=[o,i,i,_,g,g][S],R=[g,g,o,i,i,_][S];return{r:E*255,g:I*255,b:R*255}}function i3(e,t,i,a){var d=[uh(Math.round(e).toString(16)),uh(Math.round(t).toString(16)),uh(Math.round(i).toString(16))];return a&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function nY(e,t,i,a,d){var g=[uh(Math.round(e).toString(16)),uh(Math.round(t).toString(16)),uh(Math.round(i).toString(16)),uh(oY(a))];return d&&g[0].startsWith(g[0].charAt(1))&&g[1].startsWith(g[1].charAt(1))&&g[2].startsWith(g[2].charAt(1))&&g[3].startsWith(g[3].charAt(1))?g[0].charAt(0)+g[1].charAt(0)+g[2].charAt(0)+g[3].charAt(0):g.join("")}function oY(e){return Math.round(parseFloat(e)*255).toString(16)}function s3(e){return da(e)/255}function da(e){return parseInt(e,16)}function rY(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var T2={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function iY(e){var t={r:0,g:0,b:0},i=1,a=null,d=null,g=null,_=!1,o=!1;return typeof e=="string"&&(e=lY(e)),typeof e=="object"&&(xc(e.r)&&xc(e.g)&&xc(e.b)?(t=QZ(e.r,e.g,e.b),_=!0,o=String(e.r).substr(-1)==="%"?"prgb":"rgb"):xc(e.h)&&xc(e.s)&&xc(e.v)?(a=w0(e.s),d=w0(e.v),t=tY(e.h,a,d),_=!0,o="hsv"):xc(e.h)&&xc(e.s)&&xc(e.l)&&(a=w0(e.s),g=w0(e.l),t=eY(e.h,a,g),_=!0,o="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(i=e.a)),i=WL(i),{ok:_,format:e.format||o,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:i}}var sY="[-\\+]?\\d+%?",aY="[-\\+]?\\d*\\.\\d+%?",ju="(?:".concat(aY,")|(?:").concat(sY,")"),Sw="[\\s|\\(]+(".concat(ju,")[,|\\s]+(").concat(ju,")[,|\\s]+(").concat(ju,")\\s*\\)?"),Tw="[\\s|\\(]+(".concat(ju,")[,|\\s]+(").concat(ju,")[,|\\s]+(").concat(ju,")[,|\\s]+(").concat(ju,")\\s*\\)?"),cl={CSS_UNIT:new RegExp(ju),rgb:new RegExp("rgb"+Sw),rgba:new RegExp("rgba"+Tw),hsl:new RegExp("hsl"+Sw),hsla:new RegExp("hsla"+Tw),hsv:new RegExp("hsv"+Sw),hsva:new RegExp("hsva"+Tw),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function lY(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(T2[e])e=T2[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=cl.rgb.exec(e);return i?{r:i[1],g:i[2],b:i[3]}:(i=cl.rgba.exec(e),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=cl.hsl.exec(e),i?{h:i[1],s:i[2],l:i[3]}:(i=cl.hsla.exec(e),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=cl.hsv.exec(e),i?{h:i[1],s:i[2],v:i[3]}:(i=cl.hsva.exec(e),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=cl.hex8.exec(e),i?{r:da(i[1]),g:da(i[2]),b:da(i[3]),a:s3(i[4]),format:t?"name":"hex8"}:(i=cl.hex6.exec(e),i?{r:da(i[1]),g:da(i[2]),b:da(i[3]),format:t?"name":"hex"}:(i=cl.hex4.exec(e),i?{r:da(i[1]+i[1]),g:da(i[2]+i[2]),b:da(i[3]+i[3]),a:s3(i[4]+i[4]),format:t?"name":"hex8"}:(i=cl.hex3.exec(e),i?{r:da(i[1]+i[1]),g:da(i[2]+i[2]),b:da(i[3]+i[3]),format:t?"name":"hex"}:!1)))))))))}function xc(e){return!!cl.CSS_UNIT.exec(String(e))}var qL=function(){function e(t,i){t===void 0&&(t=""),i===void 0&&(i={});var a;if(t instanceof e)return t;typeof t=="number"&&(t=rY(t)),this.originalInput=t;var d=iY(t);this.originalInput=t,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(a=i.format)!==null&&a!==void 0?a:d.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),i,a,d,g=t.r/255,_=t.g/255,o=t.b/255;return g<=.03928?i=g/12.92:i=Math.pow((g+.055)/1.055,2.4),_<=.03928?a=_/12.92:a=Math.pow((_+.055)/1.055,2.4),o<=.03928?d=o/12.92:d=Math.pow((o+.055)/1.055,2.4),.2126*i+.7152*a+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=WL(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=r3(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=r3(this.r,this.g,this.b),i=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.v*100);return this.a===1?"hsv(".concat(i,", ").concat(a,"%, ").concat(d,"%)"):"hsva(".concat(i,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=o3(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=o3(this.r,this.g,this.b),i=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.l*100);return this.a===1?"hsl(".concat(i,", ").concat(a,"%, ").concat(d,"%)"):"hsla(".concat(i,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),i3(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),nY(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),a=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(i,", ").concat(a,")"):"rgba(".concat(t,", ").concat(i,", ").concat(a,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(i){return"".concat(Math.round(os(i,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(i){return Math.round(os(i,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+i3(this.r,this.g,this.b,!1),i=0,a=Object.entries(T2);i<a.length;i++){var d=a[i],g=d[0],_=d[1];if(t===_)return g}return!1},e.prototype.toString=function(t){var i=!!t;t=t??this.format;var a=!1,d=this.a<1&&this.a>=0,g=!i&&d&&(t.startsWith("hex")||t==="name");return g?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(a=this.toRgbString()),t==="prgb"&&(a=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(a=this.toHexString()),t==="hex3"&&(a=this.toHexString(!0)),t==="hex4"&&(a=this.toHex8String(!0)),t==="hex8"&&(a=this.toHex8String()),t==="name"&&(a=this.toName()),t==="hsl"&&(a=this.toHslString()),t==="hsv"&&(a=this.toHsvString()),a||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l+=t/100,i.l=x0(i.l),new e(i)},e.prototype.brighten=function(t){t===void 0&&(t=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(t/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(t/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(t/100)))),new e(i)},e.prototype.darken=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l-=t/100,i.l=x0(i.l),new e(i)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s-=t/100,i.s=x0(i.s),new e(i)},e.prototype.saturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s+=t/100,i.s=x0(i.s),new e(i)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var i=this.toHsl(),a=(i.h+t)%360;return i.h=a<0?360+a:a,new e(i)},e.prototype.mix=function(t,i){i===void 0&&(i=50);var a=this.toRgb(),d=new e(t).toRgb(),g=i/100,_={r:(d.r-a.r)*g+a.r,g:(d.g-a.g)*g+a.g,b:(d.b-a.b)*g+a.b,a:(d.a-a.a)*g+a.a};return new e(_)},e.prototype.analogous=function(t,i){t===void 0&&(t=6),i===void 0&&(i=30);var a=this.toHsl(),d=360/i,g=[this];for(a.h=(a.h-(d*t>>1)+720)%360;--t;)a.h=(a.h+d)%360,g.push(new e(a));return g},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var i=this.toHsv(),a=i.h,d=i.s,g=i.v,_=[],o=1/t;t--;)_.push(new e({h:a,s:d,v:g})),g=(g+o)%1;return _},e.prototype.splitcomplement=function(){var t=this.toHsl(),i=t.h;return[this,new e({h:(i+72)%360,s:t.s,l:t.l}),new e({h:(i+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var i=this.toRgb(),a=new e(t).toRgb(),d=i.a+a.a*(1-i.a);return new e({r:(i.r*i.a+a.r*a.a*(1-i.a))/d,g:(i.g*i.a+a.g*a.a*(1-i.a))/d,b:(i.b*i.a+a.b*a.a*(1-i.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var i=this.toHsl(),a=i.h,d=[this],g=360/t,_=1;_<t;_++)d.push(new e({h:(a+_*g)%360,s:i.s,l:i.l}));return d},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function Du(e,t=20){return e.mix("#141414",t).toString()}function cY(e){const t=bs(),i=Xt("button");return ee(()=>{let a={},d=e.color;if(d){const g=d.match(/var\((.*?)\)/);g&&(d=window.getComputedStyle(window.document.documentElement).getPropertyValue(g[1]));const _=new qL(d),o=e.dark?_.tint(20).toString():Du(_,20);if(e.plain)a=i.cssVarBlock({"bg-color":e.dark?Du(_,90):_.tint(90).toString(),"text-color":d,"border-color":e.dark?Du(_,50):_.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":d,"hover-border-color":d,"active-bg-color":o,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":o}),t.value&&(a[i.cssVarBlockName("disabled-bg-color")]=e.dark?Du(_,90):_.tint(90).toString(),a[i.cssVarBlockName("disabled-text-color")]=e.dark?Du(_,50):_.tint(50).toString(),a[i.cssVarBlockName("disabled-border-color")]=e.dark?Du(_,80):_.tint(80).toString());else{const S=e.dark?Du(_,30):_.tint(30).toString(),E=_.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(a=i.cssVarBlock({"bg-color":d,"text-color":E,"border-color":d,"hover-bg-color":S,"hover-text-color":E,"hover-border-color":S,"active-bg-color":o,"active-border-color":o}),t.value){const I=e.dark?Du(_,50):_.tint(50).toString();a[i.cssVarBlockName("disabled-bg-color")]=I,a[i.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,a[i.cssVarBlockName("disabled-border-color")]=I}}}return a})}const uY=qe({name:"ElButton"}),dY=qe({...uY,props:S2,emits:YZ,setup(e,{expose:t,emit:i}){const a=e,d=cY(a),g=Xt("button"),{_ref:_,_size:o,_type:S,_disabled:E,_props:I,shouldAddSpace:R,handleClick:z}=KZ(a,i),N=ee(()=>[g.b(),g.m(S.value),g.m(o.value),g.is("disabled",E.value),g.is("loading",a.loading),g.is("plain",a.plain),g.is("round",a.round),g.is("circle",a.circle),g.is("text",a.text),g.is("link",a.link),g.is("has-bg",a.bg)]);return t({ref:_,size:o,type:S,disabled:E,shouldAddSpace:R}),($,F)=>(se(),Et(ko($.tag),Po({ref_key:"_ref",ref:_},y(I),{class:y(N),style:y(d),onClick:y(z)}),{default:it(()=>[$.loading?(se(),Ie(Fn,{key:0},[$.$slots.loading?vt($.$slots,"loading",{key:0}):(se(),Et(y(Dn),{key:1,class:ue(y(g).is("loading"))},{default:it(()=>[(se(),Et(ko($.loadingIcon)))]),_:1},8,["class"]))],64)):$.icon||$.$slots.icon?(se(),Et(y(Dn),{key:1},{default:it(()=>[$.icon?(se(),Et(ko($.icon),{key:0})):vt($.$slots,"icon",{key:1})]),_:3})):yt("v-if",!0),$.$slots.default?(se(),Ie("span",{key:2,class:ue({[y(g).em("text","expand")]:y(R)})},[vt($.$slots,"default")],2)):yt("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var hY=fn(dY,[["__file","button.vue"]]);const fY={size:S2.size,type:S2.type},pY=qe({name:"ElButtonGroup"}),mY=qe({...pY,props:fY,setup(e){const t=e;Bo(GL,dr({size:mr(t,"size"),type:mr(t,"type")}));const i=Xt("button");return(a,d)=>(se(),Ie("div",{class:ue(y(i).b("group"))},[vt(a.$slots,"default")],2))}});var KL=fn(mY,[["__file","button-group.vue"]]);const $i=uo(hY,{ButtonGroup:KL}),ZL=ri(KL);var YL={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){var i=1e3,a=6e4,d=36e5,g="millisecond",_="second",o="minute",S="hour",E="day",I="week",R="month",z="quarter",N="year",$="date",F="Invalid Date",W=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,re={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Qe){var Ee=["th","st","nd","rd"],ye=Qe%100;return"["+Qe+(Ee[(ye-20)%10]||Ee[ye]||Ee[0])+"]"}},K=function(Qe,Ee,ye){var Me=String(Qe);return!Me||Me.length>=Ee?Qe:""+Array(Ee+1-Me.length).join(ye)+Qe},q={s:K,z:function(Qe){var Ee=-Qe.utcOffset(),ye=Math.abs(Ee),Me=Math.floor(ye/60),Te=ye%60;return(Ee<=0?"+":"-")+K(Me,2,"0")+":"+K(Te,2,"0")},m:function Qe(Ee,ye){if(Ee.date()<ye.date())return-Qe(ye,Ee);var Me=12*(ye.year()-Ee.year())+(ye.month()-Ee.month()),Te=Ee.clone().add(Me,R),he=ye-Te<0,ke=Ee.clone().add(Me+(he?-1:1),R);return+(-(Me+(ye-Te)/(he?Te-ke:ke-Te))||0)},a:function(Qe){return Qe<0?Math.ceil(Qe)||0:Math.floor(Qe)},p:function(Qe){return{M:R,y:N,w:I,d:E,D:$,h:S,m:o,s:_,ms:g,Q:z}[Qe]||String(Qe||"").toLowerCase().replace(/s$/,"")},u:function(Qe){return Qe===void 0}},J="en",oe={};oe[J]=re;var ae="$isDayjsObject",fe=function(Qe){return Qe instanceof _e||!(!Qe||!Qe[ae])},ge=function Qe(Ee,ye,Me){var Te;if(!Ee)return J;if(typeof Ee=="string"){var he=Ee.toLowerCase();oe[he]&&(Te=he),ye&&(oe[he]=ye,Te=he);var ke=Ee.split("-");if(!Te&&ke.length>1)return Qe(ke[0])}else{var Ne=Ee.name;oe[Ne]=Ee,Te=Ne}return!Me&&Te&&(J=Te),Te||!Me&&J},ce=function(Qe,Ee){if(fe(Qe))return Qe.clone();var ye=typeof Ee=="object"?Ee:{};return ye.date=Qe,ye.args=arguments,new _e(ye)},de=q;de.l=ge,de.i=fe,de.w=function(Qe,Ee){return ce(Qe,{locale:Ee.$L,utc:Ee.$u,x:Ee.$x,$offset:Ee.$offset})};var _e=function(){function Qe(ye){this.$L=ge(ye.locale,null,!0),this.parse(ye),this.$x=this.$x||ye.x||{},this[ae]=!0}var Ee=Qe.prototype;return Ee.parse=function(ye){this.$d=function(Me){var Te=Me.date,he=Me.utc;if(Te===null)return new Date(NaN);if(de.u(Te))return new Date;if(Te instanceof Date)return new Date(Te);if(typeof Te=="string"&&!/Z$/i.test(Te)){var ke=Te.match(W);if(ke){var Ne=ke[2]-1||0,nt=(ke[7]||"0").substring(0,3);return he?new Date(Date.UTC(ke[1],Ne,ke[3]||1,ke[4]||0,ke[5]||0,ke[6]||0,nt)):new Date(ke[1],Ne,ke[3]||1,ke[4]||0,ke[5]||0,ke[6]||0,nt)}}return new Date(Te)}(ye),this.init()},Ee.init=function(){var ye=this.$d;this.$y=ye.getFullYear(),this.$M=ye.getMonth(),this.$D=ye.getDate(),this.$W=ye.getDay(),this.$H=ye.getHours(),this.$m=ye.getMinutes(),this.$s=ye.getSeconds(),this.$ms=ye.getMilliseconds()},Ee.$utils=function(){return de},Ee.isValid=function(){return this.$d.toString()!==F},Ee.isSame=function(ye,Me){var Te=ce(ye);return this.startOf(Me)<=Te&&Te<=this.endOf(Me)},Ee.isAfter=function(ye,Me){return ce(ye)<this.startOf(Me)},Ee.isBefore=function(ye,Me){return this.endOf(Me)<ce(ye)},Ee.$g=function(ye,Me,Te){return de.u(ye)?this[Me]:this.set(Te,ye)},Ee.unix=function(){return Math.floor(this.valueOf()/1e3)},Ee.valueOf=function(){return this.$d.getTime()},Ee.startOf=function(ye,Me){var Te=this,he=!!de.u(Me)||Me,ke=de.p(ye),Ne=function(jt,Be){var an=de.w(Te.$u?Date.UTC(Te.$y,Be,jt):new Date(Te.$y,Be,jt),Te);return he?an:an.endOf(E)},nt=function(jt,Be){return de.w(Te.toDate()[jt].apply(Te.toDate("s"),(he?[0,0,0,0]:[23,59,59,999]).slice(Be)),Te)},De=this.$W,Ct=this.$M,Rt=this.$D,Bt="set"+(this.$u?"UTC":"");switch(ke){case N:return he?Ne(1,0):Ne(31,11);case R:return he?Ne(1,Ct):Ne(0,Ct+1);case I:var mt=this.$locale().weekStart||0,Gt=(De<mt?De+7:De)-mt;return Ne(he?Rt-Gt:Rt+(6-Gt),Ct);case E:case $:return nt(Bt+"Hours",0);case S:return nt(Bt+"Minutes",1);case o:return nt(Bt+"Seconds",2);case _:return nt(Bt+"Milliseconds",3);default:return this.clone()}},Ee.endOf=function(ye){return this.startOf(ye,!1)},Ee.$set=function(ye,Me){var Te,he=de.p(ye),ke="set"+(this.$u?"UTC":""),Ne=(Te={},Te[E]=ke+"Date",Te[$]=ke+"Date",Te[R]=ke+"Month",Te[N]=ke+"FullYear",Te[S]=ke+"Hours",Te[o]=ke+"Minutes",Te[_]=ke+"Seconds",Te[g]=ke+"Milliseconds",Te)[he],nt=he===E?this.$D+(Me-this.$W):Me;if(he===R||he===N){var De=this.clone().set($,1);De.$d[Ne](nt),De.init(),this.$d=De.set($,Math.min(this.$D,De.daysInMonth())).$d}else Ne&&this.$d[Ne](nt);return this.init(),this},Ee.set=function(ye,Me){return this.clone().$set(ye,Me)},Ee.get=function(ye){return this[de.p(ye)]()},Ee.add=function(ye,Me){var Te,he=this;ye=Number(ye);var ke=de.p(Me),Ne=function(Ct){var Rt=ce(he);return de.w(Rt.date(Rt.date()+Math.round(Ct*ye)),he)};if(ke===R)return this.set(R,this.$M+ye);if(ke===N)return this.set(N,this.$y+ye);if(ke===E)return Ne(1);if(ke===I)return Ne(7);var nt=(Te={},Te[o]=a,Te[S]=d,Te[_]=i,Te)[ke]||1,De=this.$d.getTime()+ye*nt;return de.w(De,this)},Ee.subtract=function(ye,Me){return this.add(-1*ye,Me)},Ee.format=function(ye){var Me=this,Te=this.$locale();if(!this.isValid())return Te.invalidDate||F;var he=ye||"YYYY-MM-DDTHH:mm:ssZ",ke=de.z(this),Ne=this.$H,nt=this.$m,De=this.$M,Ct=Te.weekdays,Rt=Te.months,Bt=Te.meridiem,mt=function(Be,an,At,Ge){return Be&&(Be[an]||Be(Me,he))||At[an].slice(0,Ge)},Gt=function(Be){return de.s(Ne%12||12,Be,"0")},jt=Bt||function(Be,an,At){var Ge=Be<12?"AM":"PM";return At?Ge.toLowerCase():Ge};return he.replace(U,function(Be,an){return an||function(At){switch(At){case"YY":return String(Me.$y).slice(-2);case"YYYY":return de.s(Me.$y,4,"0");case"M":return De+1;case"MM":return de.s(De+1,2,"0");case"MMM":return mt(Te.monthsShort,De,Rt,3);case"MMMM":return mt(Rt,De);case"D":return Me.$D;case"DD":return de.s(Me.$D,2,"0");case"d":return String(Me.$W);case"dd":return mt(Te.weekdaysMin,Me.$W,Ct,2);case"ddd":return mt(Te.weekdaysShort,Me.$W,Ct,3);case"dddd":return Ct[Me.$W];case"H":return String(Ne);case"HH":return de.s(Ne,2,"0");case"h":return Gt(1);case"hh":return Gt(2);case"a":return jt(Ne,nt,!0);case"A":return jt(Ne,nt,!1);case"m":return String(nt);case"mm":return de.s(nt,2,"0");case"s":return String(Me.$s);case"ss":return de.s(Me.$s,2,"0");case"SSS":return de.s(Me.$ms,3,"0");case"Z":return ke}return null}(Be)||ke.replace(":","")})},Ee.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Ee.diff=function(ye,Me,Te){var he,ke=this,Ne=de.p(Me),nt=ce(ye),De=(nt.utcOffset()-this.utcOffset())*a,Ct=this-nt,Rt=function(){return de.m(ke,nt)};switch(Ne){case N:he=Rt()/12;break;case R:he=Rt();break;case z:he=Rt()/3;break;case I:he=(Ct-De)/6048e5;break;case E:he=(Ct-De)/864e5;break;case S:he=Ct/d;break;case o:he=Ct/a;break;case _:he=Ct/i;break;default:he=Ct}return Te?he:de.a(he)},Ee.daysInMonth=function(){return this.endOf(R).$D},Ee.$locale=function(){return oe[this.$L]},Ee.locale=function(ye,Me){if(!ye)return this.$L;var Te=this.clone(),he=ge(ye,Me,!0);return he&&(Te.$L=he),Te},Ee.clone=function(){return de.w(this.$d,this)},Ee.toDate=function(){return new Date(this.valueOf())},Ee.toJSON=function(){return this.isValid()?this.toISOString():null},Ee.toISOString=function(){return this.$d.toISOString()},Ee.toString=function(){return this.$d.toUTCString()},Qe}(),Re=_e.prototype;return ce.prototype=Re,[["$ms",g],["$s",_],["$m",o],["$H",S],["$W",E],["$M",R],["$y",N],["$D",$]].forEach(function(Qe){Re[Qe[1]]=function(Ee){return this.$g(Ee,Qe[0],Qe[1])}}),ce.extend=function(Qe,Ee){return Qe.$i||(Qe(Ee,_e,ce),Qe.$i=!0),ce},ce.locale=ge,ce.isDayjs=fe,ce.unix=function(Qe){return ce(1e3*Qe)},ce.en=oe[J],ce.Ls=oe,ce.p={},ce})})(YL);var gY=YL.exports;const so=Ql(gY);var XL={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},a=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d/,g=/\d\d/,_=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,S={},E=function(W){return(W=+W)+(W>68?1900:2e3)},I=function(W){return function(U){this[W]=+U}},R=[/[+-]\d\d:?(\d\d)?|Z/,function(W){(this.zone||(this.zone={})).offset=function(U){if(!U||U==="Z")return 0;var re=U.match(/([+-]|\d\d)/g),K=60*re[1]+(+re[2]||0);return K===0?0:re[0]==="+"?-K:K}(W)}],z=function(W){var U=S[W];return U&&(U.indexOf?U:U.s.concat(U.f))},N=function(W,U){var re,K=S.meridiem;if(K){for(var q=1;q<=24;q+=1)if(W.indexOf(K(q,0,U))>-1){re=q>12;break}}else re=W===(U?"pm":"PM");return re},$={A:[o,function(W){this.afternoon=N(W,!1)}],a:[o,function(W){this.afternoon=N(W,!0)}],Q:[d,function(W){this.month=3*(W-1)+1}],S:[d,function(W){this.milliseconds=100*+W}],SS:[g,function(W){this.milliseconds=10*+W}],SSS:[/\d{3}/,function(W){this.milliseconds=+W}],s:[_,I("seconds")],ss:[_,I("seconds")],m:[_,I("minutes")],mm:[_,I("minutes")],H:[_,I("hours")],h:[_,I("hours")],HH:[_,I("hours")],hh:[_,I("hours")],D:[_,I("day")],DD:[g,I("day")],Do:[o,function(W){var U=S.ordinal,re=W.match(/\d+/);if(this.day=re[0],U)for(var K=1;K<=31;K+=1)U(K).replace(/\[|\]/g,"")===W&&(this.day=K)}],w:[_,I("week")],ww:[g,I("week")],M:[_,I("month")],MM:[g,I("month")],MMM:[o,function(W){var U=z("months"),re=(z("monthsShort")||U.map(function(K){return K.slice(0,3)})).indexOf(W)+1;if(re<1)throw new Error;this.month=re%12||re}],MMMM:[o,function(W){var U=z("months").indexOf(W)+1;if(U<1)throw new Error;this.month=U%12||U}],Y:[/[+-]?\d+/,I("year")],YY:[g,function(W){this.year=E(W)}],YYYY:[/\d{4}/,I("year")],Z:R,ZZ:R};function F(W){var U,re;U=W,re=S&&S.formats;for(var K=(W=U.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(ce,de,_e){var Re=_e&&_e.toUpperCase();return de||re[_e]||i[_e]||re[Re].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Qe,Ee,ye){return Ee||ye.slice(1)})})).match(a),q=K.length,J=0;J<q;J+=1){var oe=K[J],ae=$[oe],fe=ae&&ae[0],ge=ae&&ae[1];K[J]=ge?{regex:fe,parser:ge}:oe.replace(/^\[|\]$/g,"")}return function(ce){for(var de={},_e=0,Re=0;_e<q;_e+=1){var Qe=K[_e];if(typeof Qe=="string")Re+=Qe.length;else{var Ee=Qe.regex,ye=Qe.parser,Me=ce.slice(Re),Te=Ee.exec(Me)[0];ye.call(de,Te),ce=ce.replace(Te,"")}}return function(he){var ke=he.afternoon;if(ke!==void 0){var Ne=he.hours;ke?Ne<12&&(he.hours+=12):Ne===12&&(he.hours=0),delete he.afternoon}}(de),de}}return function(W,U,re){re.p.customParseFormat=!0,W&&W.parseTwoDigitYear&&(E=W.parseTwoDigitYear);var K=U.prototype,q=K.parse;K.parse=function(J){var oe=J.date,ae=J.utc,fe=J.args;this.$u=ae;var ge=fe[1];if(typeof ge=="string"){var ce=fe[2]===!0,de=fe[3]===!0,_e=ce||de,Re=fe[2];de&&(Re=fe[2]),S=this.$locale(),!ce&&Re&&(S=re.Ls[Re]),this.$d=function(Me,Te,he,ke){try{if(["x","X"].indexOf(Te)>-1)return new Date((Te==="X"?1e3:1)*Me);var Ne=F(Te)(Me),nt=Ne.year,De=Ne.month,Ct=Ne.day,Rt=Ne.hours,Bt=Ne.minutes,mt=Ne.seconds,Gt=Ne.milliseconds,jt=Ne.zone,Be=Ne.week,an=new Date,At=Ct||(nt||De?1:an.getDate()),Ge=nt||an.getFullYear(),Fe=0;nt&&!De||(Fe=De>0?De-1:an.getMonth());var Nt,Jt=Rt||0,Dt=Bt||0,xt=mt||0,Ot=Gt||0;return jt?new Date(Date.UTC(Ge,Fe,At,Jt,Dt,xt,Ot+60*jt.offset*1e3)):he?new Date(Date.UTC(Ge,Fe,At,Jt,Dt,xt,Ot)):(Nt=new Date(Ge,Fe,At,Jt,Dt,xt,Ot),Be&&(Nt=ke(Nt).week(Be).toDate()),Nt)}catch{return new Date("")}}(oe,ge,ae,re),this.init(),Re&&Re!==!0&&(this.$L=this.locale(Re).$L),_e&&oe!=this.format(ge)&&(this.$d=new Date("")),S={}}else if(ge instanceof Array)for(var Qe=ge.length,Ee=1;Ee<=Qe;Ee+=1){fe[1]=ge[Ee-1];var ye=re.apply(this,fe);if(ye.isValid()){this.$d=ye.$d,this.$L=ye.$L,this.init();break}Ee===Qe&&(this.$d=new Date(""))}else q.call(this,J)}}})})(XL);var vY=XL.exports;const BT=Ql(vY),a3=["hours","minutes","seconds"],C2="HH:mm:ss",rp="YYYY-MM-DD",_Y={date:rp,dates:rp,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${rp} ${C2}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:rp,datetimerange:`${rp} ${C2}`},Cw=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],Zu=e=>Array.from(Array.from({length:e}).keys()),JL=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),QL=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),l3=function(e,t){const i=Yu(e),a=Yu(t);return i&&a?e.getTime()===t.getTime():!i&&!a?e===t:!1},c3=function(e,t){const i=sn(e),a=sn(t);return i&&a?e.length!==t.length?!1:e.every((d,g)=>l3(d,t[g])):!i&&!a?l3(e,t):!1},u3=function(e,t,i){const a=ha(t)||t==="x"?so(e).locale(i):so(e,t).locale(i);return a.isValid()?a:void 0},d3=function(e,t,i){return ha(t)?e:t==="x"?+e:so(e).locale(i).format(t)},Ew=(e,t)=>{var i;const a=[],d=t==null?void 0:t();for(let g=0;g<e;g++)a.push((i=d==null?void 0:d.includes(g))!=null?i:!1);return a},eO=cn({disabledHours:{type:at(Function)},disabledMinutes:{type:at(Function)},disabledSeconds:{type:at(Function)}}),tO=cn({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),FT=cn({id:{type:at([Array,String])},name:{type:at([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:at([String,Object]),default:ud},editable:{type:Boolean,default:!0},prefixIcon:{type:at([String,Object]),default:""},size:ki,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})},modelValue:{type:at([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:at([Date,Array])},defaultTime:{type:at([Date,Array])},isRange:Boolean,...eO,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:at([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:at(String),values:zc,default:"bottom"},fallbackPlacements:{type:at(Array),default:["bottom","top","right","left"]},...Zp,...Zi(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),yY=cn({id:{type:at(Array)},name:{type:at(Array)},modelValue:{type:at([Array,String])},startPlaceholder:String,endPlaceholder:String}),bY=qe({name:"PickerRangeTrigger",inheritAttrs:!1}),xY=qe({...bY,props:yY,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(e,{expose:t,emit:i}){const a=Zb(),d=Xt("date"),g=Xt("range"),_=xe(),o=xe(),{wrapperRef:S,isFocused:E}=Oh(_),I=q=>{i("click",q)},R=q=>{i("mouseenter",q)},z=q=>{i("mouseleave",q)},N=q=>{i("mouseenter",q)},$=q=>{i("startInput",q)},F=q=>{i("endInput",q)},W=q=>{i("startChange",q)},U=q=>{i("endChange",q)};return t({focus:()=>{var q;(q=_.value)==null||q.focus()},blur:()=>{var q,J;(q=_.value)==null||q.blur(),(J=o.value)==null||J.blur()}}),(q,J)=>(se(),Ie("div",{ref_key:"wrapperRef",ref:S,class:ue([y(d).is("active",y(E)),q.$attrs.class]),style:$n(q.$attrs.style),onClick:I,onMouseenter:R,onMouseleave:z,onTouchstart:N},[vt(q.$slots,"prefix"),je("input",Po(y(a),{id:q.id&&q.id[0],ref_key:"inputRef",ref:_,name:q.name&&q.name[0],placeholder:q.startPlaceholder,value:q.modelValue&&q.modelValue[0],class:y(g).b("input"),onInput:$,onChange:W}),null,16,["id","name","placeholder","value"]),vt(q.$slots,"range-separator"),je("input",Po(y(a),{id:q.id&&q.id[1],ref_key:"endInputRef",ref:o,name:q.name&&q.name[1],placeholder:q.endPlaceholder,value:q.modelValue&&q.modelValue[1],class:y(g).b("input"),onInput:F,onChange:U}),null,16,["id","name","placeholder","value"]),vt(q.$slots,"suffix")],38))}});var wY=fn(xY,[["__file","picker-range-trigger.vue"]]);const SY=qe({name:"Picker"}),TY=qe({...SY,props:FT,emits:["update:modelValue","change","focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:i}){const a=e,d=Ph(),{lang:g}=qo(),_=Xt("date"),o=Xt("input"),S=Xt("range"),{form:E,formItem:I}=xs(),R=kn("ElPopperOptions",{}),{valueOnClear:z}=t1(a,null),N=xe(),$=xe(),F=xe(!1),W=xe(!1),U=xe(null);let re=!1;const{isFocused:K,handleFocus:q,handleBlur:J}=Oh($,{beforeFocus(){return a.readonly||he.value},afterFocus(){F.value=!0},beforeBlur(Ze){var vn;return!re&&((vn=N.value)==null?void 0:vn.isFocusInsideContent(Ze))},afterBlur(){en(),F.value=!1,re=!1,a.validateEvent&&(I==null||I.validate("blur").catch(Ze=>void 0))}}),oe=ee(()=>[_.b("editor"),_.bm("editor",a.type),o.e("wrapper"),_.is("disabled",he.value),_.is("active",F.value),S.b("editor"),Jt?S.bm("editor",Jt.value):"",d.class]),ae=ee(()=>[o.e("icon"),S.e("close-icon"),Gt.value?"":S.e("close-icon--hidden")]);qt(F,Ze=>{Ze?Un(()=>{Ze&&(U.value=a.modelValue)}):(Ot.value=null,Un(()=>{fe(a.modelValue)}))});const fe=(Ze,vn)=>{(vn||!c3(Ze,U.value))&&(i("change",Ze),a.validateEvent&&(I==null||I.validate("change").catch(Mn=>void 0)))},ge=Ze=>{if(!c3(a.modelValue,Ze)){let vn;sn(Ze)?vn=Ze.map(Mn=>d3(Mn,a.valueFormat,g.value)):Ze&&(vn=d3(Ze,a.valueFormat,g.value)),i("update:modelValue",Ze&&vn,g.value)}},ce=Ze=>{i("keydown",Ze)},de=ee(()=>$.value?Array.from($.value.$el.querySelectorAll("input")):[]),_e=(Ze,vn,Mn)=>{const yo=de.value;yo.length&&(!Mn||Mn==="min"?(yo[0].setSelectionRange(Ze,vn),yo[0].focus()):Mn==="max"&&(yo[1].setSelectionRange(Ze,vn),yo[1].focus()))},Re=(Ze="",vn=!1)=>{F.value=vn;let Mn;sn(Ze)?Mn=Ze.map(yo=>yo.toDate()):Mn=Ze&&Ze.toDate(),Ot.value=null,ge(Mn)},Qe=()=>{W.value=!0},Ee=()=>{i("visible-change",!0)},ye=()=>{W.value=!1,F.value=!1,i("visible-change",!1)},Me=()=>{F.value=!0},Te=()=>{F.value=!1},he=ee(()=>a.disabled||(E==null?void 0:E.disabled)),ke=ee(()=>{let Ze;if(Be.value?Lo.value.getDefaultValue&&(Ze=Lo.value.getDefaultValue()):sn(a.modelValue)?Ze=a.modelValue.map(vn=>u3(vn,a.valueFormat,g.value)):Ze=u3(a.modelValue,a.valueFormat,g.value),Lo.value.getRangeAvailableTime){const vn=Lo.value.getRangeAvailableTime(Ze);qi(vn,Ze)||(Ze=vn,Be.value||ge(sn(Ze)?Ze.map(Mn=>Mn.toDate()):Ze.toDate()))}return sn(Ze)&&Ze.some(vn=>!vn)&&(Ze=[]),Ze}),Ne=ee(()=>{if(!Lo.value.panelReady)return"";const Ze=un(ke.value);return sn(Ot.value)?[Ot.value[0]||Ze&&Ze[0]||"",Ot.value[1]||Ze&&Ze[1]||""]:Ot.value!==null?Ot.value:!De.value&&Be.value||!F.value&&Be.value?"":Ze?Ct.value||Rt.value||Bt.value?Ze.join(", "):Ze:""}),nt=ee(()=>a.type.includes("time")),De=ee(()=>a.type.startsWith("time")),Ct=ee(()=>a.type==="dates"),Rt=ee(()=>a.type==="months"),Bt=ee(()=>a.type==="years"),mt=ee(()=>a.prefixIcon||(nt.value?ND:hG)),Gt=xe(!1),jt=Ze=>{a.readonly||he.value||(Gt.value&&(Ze.stopPropagation(),Lo.value.handleClear?Lo.value.handleClear():ge(z.value),fe(z.value,!0),Gt.value=!1,ye()),i("clear"))},Be=ee(()=>{const{modelValue:Ze}=a;return!Ze||sn(Ze)&&!Ze.filter(Boolean).length}),an=async Ze=>{var vn;a.readonly||he.value||(((vn=Ze.target)==null?void 0:vn.tagName)!=="INPUT"||K.value)&&(F.value=!0)},At=()=>{a.readonly||he.value||!Be.value&&a.clearable&&(Gt.value=!0)},Ge=()=>{Gt.value=!1},Fe=Ze=>{var vn;a.readonly||he.value||(((vn=Ze.touches[0].target)==null?void 0:vn.tagName)!=="INPUT"||K.value)&&(F.value=!0)},Nt=ee(()=>a.type.includes("range")),Jt=Mi(),Dt=ee(()=>{var Ze,vn;return(vn=(Ze=y(N))==null?void 0:Ze.popperRef)==null?void 0:vn.contentRef}),xt=zS($,Ze=>{const vn=y(Dt),Mn=Bs($);vn&&(Ze.target===vn||Ze.composedPath().includes(vn))||Ze.target===Mn||Mn&&Ze.composedPath().includes(Mn)||(F.value=!1)});Pr(()=>{xt==null||xt()});const Ot=xe(null),en=()=>{if(Ot.value){const Ze=dn(Ne.value);Ze&&Pn(Ze)&&(ge(sn(Ze)?Ze.map(vn=>vn.toDate()):Ze.toDate()),Ot.value=null)}Ot.value===""&&(ge(z.value),fe(z.value),Ot.value=null)},dn=Ze=>Ze?Lo.value.parseUserInput(Ze):null,un=Ze=>Ze?Lo.value.formatToString(Ze):null,Pn=Ze=>Lo.value.isValidValue(Ze),gt=async Ze=>{if(a.readonly||he.value)return;const{code:vn}=Ze;if(ce(Ze),vn===Cn.esc){F.value===!0&&(F.value=!1,Ze.preventDefault(),Ze.stopPropagation());return}if(vn===Cn.down&&(Lo.value.handleFocusPicker&&(Ze.preventDefault(),Ze.stopPropagation()),F.value===!1&&(F.value=!0,await Un()),Lo.value.handleFocusPicker)){Lo.value.handleFocusPicker();return}if(vn===Cn.tab){re=!0;return}if(vn===Cn.enter||vn===Cn.numpadEnter){(Ot.value===null||Ot.value===""||Pn(dn(Ne.value)))&&(en(),F.value=!1),Ze.stopPropagation();return}if(Ot.value){Ze.stopPropagation();return}Lo.value.handleKeydownInput&&Lo.value.handleKeydownInput(Ze)},Sn=Ze=>{Ot.value=Ze,F.value||(F.value=!0)},Vn=Ze=>{const vn=Ze.target;Ot.value?Ot.value=[vn.value,Ot.value[1]]:Ot.value=[vn.value,null]},lo=Ze=>{const vn=Ze.target;Ot.value?Ot.value=[Ot.value[0],vn.value]:Ot.value=[null,vn.value]},eo=()=>{var Ze;const vn=Ot.value,Mn=dn(vn&&vn[0]),yo=y(ke);if(Mn&&Mn.isValid()){Ot.value=[un(Mn),((Ze=Ne.value)==null?void 0:Ze[1])||null];const gr=[Mn,yo&&(yo[1]||null)];Pn(gr)&&(ge(gr),Ot.value=null)}},fo=()=>{var Ze;const vn=y(Ot),Mn=dn(vn&&vn[1]),yo=y(ke);if(Mn&&Mn.isValid()){Ot.value=[((Ze=y(Ne))==null?void 0:Ze[0])||null,un(Mn)];const gr=[yo&&yo[0],Mn];Pn(gr)&&(ge(gr),Ot.value=null)}},Lo=xe({}),er=Ze=>{Lo.value[Ze[0]]=Ze[1],Lo.value.panelReady=!0},Pt=Ze=>{i("calendar-change",Ze)},_n=(Ze,vn,Mn)=>{i("panel-change",Ze,vn,Mn)},dt=()=>{var Ze;(Ze=$.value)==null||Ze.focus()},tn=()=>{var Ze;(Ze=$.value)==null||Ze.blur()};return Bo("EP_PICKER_BASE",{props:a}),t({focus:dt,blur:tn,handleOpen:Me,handleClose:Te,onPick:Re}),(Ze,vn)=>(se(),Et(y(rs),Po({ref_key:"refPopper",ref:N,visible:F.value,effect:"light",pure:"",trigger:"click"},Ze.$attrs,{role:"dialog",teleported:"",transition:`${y(_).namespace.value}-zoom-in-top`,"popper-class":[`${y(_).namespace.value}-picker__popper`,Ze.popperClass],"popper-options":y(R),"fallback-placements":Ze.fallbackPlacements,"gpu-acceleration":!1,placement:Ze.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:Qe,onShow:Ee,onHide:ye}),{default:it(()=>[y(Nt)?(se(),Et(wY,{key:1,id:Ze.id,ref_key:"inputRef",ref:$,"model-value":y(Ne),name:Ze.name,disabled:y(he),readonly:!Ze.editable||Ze.readonly,"start-placeholder":Ze.startPlaceholder,"end-placeholder":Ze.endPlaceholder,class:ue(y(oe)),style:$n(Ze.$attrs.style),"aria-label":Ze.ariaLabel,tabindex:Ze.tabindex,autocomplete:"off",role:"combobox",onClick:an,onFocus:y(q),onBlur:y(J),onStartInput:Vn,onStartChange:eo,onEndInput:lo,onEndChange:fo,onMousedown:an,onMouseenter:At,onMouseleave:Ge,onTouchstartPassive:Fe,onKeydown:gt},{prefix:it(()=>[y(mt)?(se(),Et(y(Dn),{key:0,class:ue([y(o).e("icon"),y(S).e("icon")])},{default:it(()=>[(se(),Et(ko(y(mt))))]),_:1},8,["class"])):yt("v-if",!0)]),"range-separator":it(()=>[vt(Ze.$slots,"range-separator",{},()=>[je("span",{class:ue(y(S).b("separator"))},mn(Ze.rangeSeparator),3)])]),suffix:it(()=>[Ze.clearIcon?(se(),Et(y(Dn),{key:0,class:ue(y(ae)),onMousedown:Xn(y(xr),["prevent"]),onClick:jt},{default:it(()=>[(se(),Et(ko(Ze.clearIcon)))]),_:1},8,["class","onMousedown"])):yt("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(se(),Et(y(_s),{key:0,id:Ze.id,ref_key:"inputRef",ref:$,"container-role":"combobox","model-value":y(Ne),name:Ze.name,size:y(Jt),disabled:y(he),placeholder:Ze.placeholder,class:ue([y(_).b("editor"),y(_).bm("editor",Ze.type),Ze.$attrs.class]),style:$n(Ze.$attrs.style),readonly:!Ze.editable||Ze.readonly||y(Ct)||y(Rt)||y(Bt)||Ze.type==="week","aria-label":Ze.ariaLabel,tabindex:Ze.tabindex,"validate-event":!1,onInput:Sn,onFocus:y(q),onBlur:y(J),onKeydown:gt,onChange:en,onMousedown:an,onMouseenter:At,onMouseleave:Ge,onTouchstartPassive:Fe,onClick:Xn(()=>{},["stop"])},{prefix:it(()=>[y(mt)?(se(),Et(y(Dn),{key:0,class:ue(y(o).e("icon")),onMousedown:Xn(an,["prevent"]),onTouchstartPassive:Fe},{default:it(()=>[(se(),Et(ko(y(mt))))]),_:1},8,["class","onMousedown"])):yt("v-if",!0)]),suffix:it(()=>[Gt.value&&Ze.clearIcon?(se(),Et(y(Dn),{key:0,class:ue(`${y(o).e("icon")} clear-icon`),onMousedown:Xn(y(xr),["prevent"]),onClick:jt},{default:it(()=>[(se(),Et(ko(Ze.clearIcon)))]),_:1},8,["class","onMousedown"])):yt("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:it(()=>[vt(Ze.$slots,"default",{visible:F.value,actualVisible:W.value,parsedValue:y(ke),format:Ze.format,dateFormat:Ze.dateFormat,timeFormat:Ze.timeFormat,unlinkPanels:Ze.unlinkPanels,type:Ze.type,defaultValue:Ze.defaultValue,showNow:Ze.showNow,onPick:Re,onSelectRange:_e,onSetPickerOption:er,onCalendarChange:Pt,onPanelChange:_n,onMousedown:Xn(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var nO=fn(TY,[["__file","picker.vue"]]);const CY=cn({...tO,datetimeRole:String,parsedValue:{type:at(Object)}}),oO=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:i})=>{const a=(_,o,S,E)=>{const I={hour:e,minute:t,second:i};let R=_;return["hour","minute","second"].forEach(z=>{if(I[z]){let N;const $=I[z];switch(z){case"minute":{N=$(R.hour(),o,E);break}case"second":{N=$(R.hour(),R.minute(),o,E);break}default:{N=$(o,E);break}}if(N!=null&&N.length&&!N.includes(R[z]())){const F=S?0:N.length-1;R=R[z](N[F])}}}),R},d={};return{timePickerOptions:d,getAvailableTime:a,onSetOption:([_,o])=>{d[_]=o}}},Mw=e=>{const t=(a,d)=>a||d,i=a=>a!==!0;return e.map(t).filter(i)},rO=(e,t,i)=>({getHoursList:(_,o)=>Ew(24,e&&(()=>e==null?void 0:e(_,o))),getMinutesList:(_,o,S)=>Ew(60,t&&(()=>t==null?void 0:t(_,o,S))),getSecondsList:(_,o,S,E)=>Ew(60,i&&(()=>i==null?void 0:i(_,o,S,E)))}),iO=(e,t,i)=>{const{getHoursList:a,getMinutesList:d,getSecondsList:g}=rO(e,t,i);return{getAvailableHours:(E,I)=>Mw(a(E,I)),getAvailableMinutes:(E,I,R)=>Mw(d(E,I,R)),getAvailableSeconds:(E,I,R,z)=>Mw(g(E,I,R,z))}},sO=e=>{const t=xe(e.parsedValue);return qt(()=>e.visible,i=>{i||(t.value=e.parsedValue)}),t},zu=new Map;if(Wo){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const i of zu.values())for(const{documentHandler:a}of i)a(t,e);e=void 0}})}function h3(e,t){let i=[];return sn(t.arg)?i=t.arg:va(t.arg)&&i.push(t.arg),function(a,d){const g=t.instance.popperRef,_=a.target,o=d==null?void 0:d.target,S=!t||!t.instance,E=!_||!o,I=e.contains(_)||e.contains(o),R=e===_,z=i.length&&i.some($=>$==null?void 0:$.contains(_))||i.length&&i.includes(o),N=g&&(g.contains(_)||g.contains(o));S||E||I||R||z||N||t.value(a,d)}}const kc={beforeMount(e,t){zu.has(e)||zu.set(e,[]),zu.get(e).push({documentHandler:h3(e,t),bindingFn:t.value})},updated(e,t){zu.has(e)||zu.set(e,[]);const i=zu.get(e),a=i.findIndex(g=>g.bindingFn===t.oldValue),d={documentHandler:h3(e,t),bindingFn:t.value};a>=0?i.splice(a,1,d):i.push(d)},unmounted(e){zu.delete(e)}},EY=100,MY=600,hb={beforeMount(e,t){const i=t.value,{interval:a=EY,delay:d=MY}=Nn(i)?{}:i;let g,_;const o=()=>Nn(i)?i():i.handler(),S=()=>{_&&(clearTimeout(_),_=void 0),g&&(clearInterval(g),g=void 0)};e.addEventListener("mousedown",E=>{E.button===0&&(S(),o(),document.addEventListener("mouseup",()=>S(),{once:!0}),_=setTimeout(()=>{g=setInterval(()=>{o()},a)},d))})}},E2="_trap-focus-children",dh=[],f3=e=>{if(dh.length===0)return;const t=dh[dh.length-1][E2];if(t.length>0&&e.code===Cn.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const i=e.shiftKey,a=e.target===t[0],d=e.target===t[t.length-1];a&&i&&(e.preventDefault(),t[t.length-1].focus()),d&&!i&&(e.preventDefault(),t[0].focus())}},IY={beforeMount(e){e[E2]=CA(e),dh.push(e),dh.length<=1&&document.addEventListener("keydown",f3)},updated(e){Un(()=>{e[E2]=CA(e)})},unmounted(){dh.shift(),dh.length===0&&document.removeEventListener("keydown",f3)}};var p3=!1,ah,M2,I2,z0,B0,aO,F0,A2,k2,P2,lO,R2,D2,cO,uO;function Ks(){if(!p3){p3=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),i=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(R2=/\b(iPhone|iP[ao]d)/.exec(e),D2=/\b(iP[ao]d)/.exec(e),P2=/Android/i.exec(e),cO=/FBAN\/\w+;/i.exec(e),uO=/Mobile/i.exec(e),lO=!!/Win64/.exec(e),t){ah=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,ah&&document&&document.documentMode&&(ah=document.documentMode);var a=/(?:Trident\/(\d+.\d+))/.exec(e);aO=a?parseFloat(a[1])+4:ah,M2=t[2]?parseFloat(t[2]):NaN,I2=t[3]?parseFloat(t[3]):NaN,z0=t[4]?parseFloat(t[4]):NaN,z0?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),B0=t&&t[1]?parseFloat(t[1]):NaN):B0=NaN}else ah=M2=I2=B0=z0=NaN;if(i){if(i[1]){var d=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);F0=d?parseFloat(d[1].replace("_",".")):!0}else F0=!1;A2=!!i[2],k2=!!i[3]}else F0=A2=k2=!1}}var L2={ie:function(){return Ks()||ah},ieCompatibilityMode:function(){return Ks()||aO>ah},ie64:function(){return L2.ie()&&lO},firefox:function(){return Ks()||M2},opera:function(){return Ks()||I2},webkit:function(){return Ks()||z0},safari:function(){return L2.webkit()},chrome:function(){return Ks()||B0},windows:function(){return Ks()||A2},osx:function(){return Ks()||F0},linux:function(){return Ks()||k2},iphone:function(){return Ks()||R2},mobile:function(){return Ks()||R2||D2||P2||uO},nativeApp:function(){return Ks()||cO},android:function(){return Ks()||P2},ipad:function(){return Ks()||D2}},AY=L2,kY=!!(typeof window<"u"&&window.document&&window.document.createElement),PY={canUseDOM:kY},dO=PY,hO;dO.canUseDOM&&(hO=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function RY(e,t){if(!dO.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,a=i in document;if(!a){var d=document.createElement("div");d.setAttribute(i,"return;"),a=typeof d[i]=="function"}return!a&&hO&&e==="wheel"&&(a=document.implementation.hasFeature("Events.wheel","3.0")),a}var DY=RY,m3=10,g3=40,v3=800;function fO(e){var t=0,i=0,a=0,d=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),a=t*m3,d=i*m3,"deltaY"in e&&(d=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||d)&&e.deltaMode&&(e.deltaMode==1?(a*=g3,d*=g3):(a*=v3,d*=v3)),a&&!t&&(t=a<1?-1:1),d&&!i&&(i=d<1?-1:1),{spinX:t,spinY:i,pixelX:a,pixelY:d}}fO.getEventType=function(){return AY.firefox()?"DOMMouseScroll":DY("wheel")?"wheel":"mousewheel"};var LY=fO;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const OY=function(e,t){if(e&&e.addEventListener){const i=function(a){const d=LY(a);t&&Reflect.apply(t,this,[a,d])};e.addEventListener("wheel",i,{passive:!0})}},zY={beforeMount(e,t){OY(e,t.value)}},BY=cn({role:{type:String,required:!0},spinnerDate:{type:at(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:at(String),default:""},...eO}),FY=qe({__name:"basic-time-spinner",props:BY,emits:["change","select-range","set-option"],setup(e,{emit:t}){const i=e,a=kn("EP_PICKER_BASE"),{isRange:d}=a.props,g=Xt("time"),{getHoursList:_,getMinutesList:o,getSecondsList:S}=rO(i.disabledHours,i.disabledMinutes,i.disabledSeconds);let E=!1;const I=xe(),R=xe(),z=xe(),N=xe(),$={hours:R,minutes:z,seconds:N},F=ee(()=>i.showSeconds?a3:a3.slice(0,2)),W=ee(()=>{const{spinnerDate:Ne}=i,nt=Ne.hour(),De=Ne.minute(),Ct=Ne.second();return{hours:nt,minutes:De,seconds:Ct}}),U=ee(()=>{const{hours:Ne,minutes:nt}=y(W),{role:De,spinnerDate:Ct}=i,Rt=d?void 0:Ct;return{hours:_(De,Rt),minutes:o(Ne,De,Rt),seconds:S(Ne,nt,De,Rt)}}),re=ee(()=>{const{hours:Ne,minutes:nt,seconds:De}=y(W);return{hours:Cw(Ne,23),minutes:Cw(nt,59),seconds:Cw(De,59)}}),K=Qs(Ne=>{E=!1,oe(Ne)},200),q=Ne=>{if(!!!i.amPmMode)return"";const De=i.amPmMode==="A";let Ct=Ne<12?" am":" pm";return De&&(Ct=Ct.toUpperCase()),Ct},J=Ne=>{let nt;switch(Ne){case"hours":nt=[0,2];break;case"minutes":nt=[3,5];break;case"seconds":nt=[6,8];break}const[De,Ct]=nt;t("select-range",De,Ct),I.value=Ne},oe=Ne=>{ge(Ne,y(W)[Ne])},ae=()=>{oe("hours"),oe("minutes"),oe("seconds")},fe=Ne=>Ne.querySelector(`.${g.namespace.value}-scrollbar__wrap`),ge=(Ne,nt)=>{if(i.arrowControl)return;const De=y($[Ne]);De&&De.$el&&(fe(De.$el).scrollTop=Math.max(0,nt*ce(Ne)))},ce=Ne=>{const nt=y($[Ne]),De=nt==null?void 0:nt.$el.querySelector("li");return De&&Number.parseFloat(Uu(De,"height"))||0},de=()=>{Re(1)},_e=()=>{Re(-1)},Re=Ne=>{I.value||J("hours");const nt=I.value,De=y(W)[nt],Ct=I.value==="hours"?24:60,Rt=Qe(nt,De,Ne,Ct);Ee(nt,Rt),ge(nt,Rt),Un(()=>J(nt))},Qe=(Ne,nt,De,Ct)=>{let Rt=(nt+De+Ct)%Ct;const Bt=y(U)[Ne];for(;Bt[Rt]&&Rt!==nt;)Rt=(Rt+De+Ct)%Ct;return Rt},Ee=(Ne,nt)=>{if(y(U)[Ne][nt])return;const{hours:Rt,minutes:Bt,seconds:mt}=y(W);let Gt;switch(Ne){case"hours":Gt=i.spinnerDate.hour(nt).minute(Bt).second(mt);break;case"minutes":Gt=i.spinnerDate.hour(Rt).minute(nt).second(mt);break;case"seconds":Gt=i.spinnerDate.hour(Rt).minute(Bt).second(nt);break}t("change",Gt)},ye=(Ne,{value:nt,disabled:De})=>{De||(Ee(Ne,nt),J(Ne),ge(Ne,nt))},Me=Ne=>{const nt=y($[Ne]);if(!nt)return;E=!0,K(Ne);const De=Math.min(Math.round((fe(nt.$el).scrollTop-(Te(Ne)*.5-10)/ce(Ne)+3)/ce(Ne)),Ne==="hours"?23:59);Ee(Ne,De)},Te=Ne=>y($[Ne]).$el.offsetHeight,he=()=>{const Ne=nt=>{const De=y($[nt]);De&&De.$el&&(fe(De.$el).onscroll=()=>{Me(nt)})};Ne("hours"),Ne("minutes"),Ne("seconds")};_o(()=>{Un(()=>{!i.arrowControl&&he(),ae(),i.role==="start"&&J("hours")})});const ke=(Ne,nt)=>{$[nt].value=Ne??void 0};return t("set-option",[`${i.role}_scrollDown`,Re]),t("set-option",[`${i.role}_emitSelectRange`,J]),qt(()=>i.spinnerDate,()=>{E||ae()}),(Ne,nt)=>(se(),Ie("div",{class:ue([y(g).b("spinner"),{"has-seconds":Ne.showSeconds}])},[Ne.arrowControl?yt("v-if",!0):(se(!0),Ie(Fn,{key:0},Fo(y(F),De=>(se(),Et(y(nc),{key:De,ref_for:!0,ref:Ct=>ke(Ct,De),class:ue(y(g).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":y(g).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:Ct=>J(De),onMousemove:Ct=>oe(De)},{default:it(()=>[(se(!0),Ie(Fn,null,Fo(y(U)[De],(Ct,Rt)=>(se(),Ie("li",{key:Rt,class:ue([y(g).be("spinner","item"),y(g).is("active",Rt===y(W)[De]),y(g).is("disabled",Ct)]),onClick:Bt=>ye(De,{value:Rt,disabled:Ct})},[De==="hours"?(se(),Ie(Fn,{key:0},[$o(mn(("0"+(Ne.amPmMode?Rt%12||12:Rt)).slice(-2))+mn(q(Rt)),1)],64)):(se(),Ie(Fn,{key:1},[$o(mn(("0"+Rt).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),Ne.arrowControl?(se(!0),Ie(Fn,{key:1},Fo(y(F),De=>(se(),Ie("div",{key:De,class:ue([y(g).be("spinner","wrapper"),y(g).is("arrow")]),onMouseenter:Ct=>J(De)},[vo((se(),Et(y(Dn),{class:ue(["arrow-up",y(g).be("spinner","arrow")])},{default:it(()=>[Ye(y(oT))]),_:1},8,["class"])),[[y(hb),_e]]),vo((se(),Et(y(Dn),{class:ue(["arrow-down",y(g).be("spinner","arrow")])},{default:it(()=>[Ye(y(Oc))]),_:1},8,["class"])),[[y(hb),de]]),je("ul",{class:ue(y(g).be("spinner","list"))},[(se(!0),Ie(Fn,null,Fo(y(re)[De],(Ct,Rt)=>(se(),Ie("li",{key:Rt,class:ue([y(g).be("spinner","item"),y(g).is("active",Ct===y(W)[De]),y(g).is("disabled",y(U)[De][Ct])])},[y(Wn)(Ct)?(se(),Ie(Fn,{key:0},[De==="hours"?(se(),Ie(Fn,{key:0},[$o(mn(("0"+(Ne.amPmMode?Ct%12||12:Ct)).slice(-2))+mn(q(Ct)),1)],64)):(se(),Ie(Fn,{key:1},[$o(mn(("0"+Ct).slice(-2)),1)],64))],64)):yt("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):yt("v-if",!0)],2))}});var O2=fn(FY,[["__file","basic-time-spinner.vue"]]);const NY=qe({__name:"panel-time-pick",props:CY,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,a=kn("EP_PICKER_BASE"),{arrowControl:d,disabledHours:g,disabledMinutes:_,disabledSeconds:o,defaultValue:S}=a.props,{getAvailableHours:E,getAvailableMinutes:I,getAvailableSeconds:R}=iO(g,_,o),z=Xt("time"),{t:N,lang:$}=qo(),F=xe([0,2]),W=sO(i),U=ee(()=>jr(i.actualVisible)?`${z.namespace.value}-zoom-in-top`:""),re=ee(()=>i.format.includes("ss")),K=ee(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),q=Te=>{const he=so(Te).locale($.value),ke=Qe(he);return he.isSame(ke)},J=()=>{t("pick",W.value,!1)},oe=(Te=!1,he=!1)=>{he||t("pick",i.parsedValue,Te)},ae=Te=>{if(!i.visible)return;const he=Qe(Te).millisecond(0);t("pick",he,!0)},fe=(Te,he)=>{t("select-range",Te,he),F.value=[Te,he]},ge=Te=>{const he=[0,3].concat(re.value?[6]:[]),ke=["hours","minutes"].concat(re.value?["seconds"]:[]),nt=(he.indexOf(F.value[0])+Te+he.length)%he.length;de.start_emitSelectRange(ke[nt])},ce=Te=>{const he=Te.code,{left:ke,right:Ne,up:nt,down:De}=Cn;if([ke,Ne].includes(he)){ge(he===ke?-1:1),Te.preventDefault();return}if([nt,De].includes(he)){const Ct=he===nt?-1:1;de.start_scrollDown(Ct),Te.preventDefault();return}},{timePickerOptions:de,onSetOption:_e,getAvailableTime:Re}=oO({getAvailableHours:E,getAvailableMinutes:I,getAvailableSeconds:R}),Qe=Te=>Re(Te,i.datetimeRole||"",!0),Ee=Te=>Te?so(Te,i.format).locale($.value):null,ye=Te=>Te?Te.format(i.format):null,Me=()=>so(S).locale($.value);return t("set-picker-option",["isValidValue",q]),t("set-picker-option",["formatToString",ye]),t("set-picker-option",["parseUserInput",Ee]),t("set-picker-option",["handleKeydownInput",ce]),t("set-picker-option",["getRangeAvailableTime",Qe]),t("set-picker-option",["getDefaultValue",Me]),(Te,he)=>(se(),Et(Ui,{name:y(U)},{default:it(()=>[Te.actualVisible||Te.visible?(se(),Ie("div",{key:0,class:ue(y(z).b("panel"))},[je("div",{class:ue([y(z).be("panel","content"),{"has-seconds":y(re)}])},[Ye(O2,{ref:"spinner",role:Te.datetimeRole||"start","arrow-control":y(d),"show-seconds":y(re),"am-pm-mode":y(K),"spinner-date":Te.parsedValue,"disabled-hours":y(g),"disabled-minutes":y(_),"disabled-seconds":y(o),onChange:ae,onSetOption:y(_e),onSelectRange:fe},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),je("div",{class:ue(y(z).be("panel","footer"))},[je("button",{type:"button",class:ue([y(z).be("panel","btn"),"cancel"]),onClick:J},mn(y(N)("el.datepicker.cancel")),3),je("button",{type:"button",class:ue([y(z).be("panel","btn"),"confirm"]),onClick:ke=>oe()},mn(y(N)("el.datepicker.confirm")),11,["onClick"])],2)],2)):yt("v-if",!0)]),_:1},8,["name"]))}});var fb=fn(NY,[["__file","panel-time-pick.vue"]]);const $Y=cn({...tO,parsedValue:{type:at(Array)}}),VY=qe({__name:"panel-time-range",props:$Y,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,a=(an,At)=>{const Ge=[];for(let Fe=an;Fe<=At;Fe++)Ge.push(Fe);return Ge},{t:d,lang:g}=qo(),_=Xt("time"),o=Xt("picker"),S=kn("EP_PICKER_BASE"),{arrowControl:E,disabledHours:I,disabledMinutes:R,disabledSeconds:z,defaultValue:N}=S.props,$=ee(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",E),q.value?"has-seconds":""]),F=ee(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",E),q.value?"has-seconds":""]),W=ee(()=>i.parsedValue[0]),U=ee(()=>i.parsedValue[1]),re=sO(i),K=()=>{t("pick",re.value,!1)},q=ee(()=>i.format.includes("ss")),J=ee(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),oe=(an=!1)=>{t("pick",[W.value,U.value],an)},ae=an=>{ce(an.millisecond(0),U.value)},fe=an=>{ce(W.value,an.millisecond(0))},ge=an=>{const At=an.map(Fe=>so(Fe).locale(g.value)),Ge=Ne(At);return At[0].isSame(Ge[0])&&At[1].isSame(Ge[1])},ce=(an,At)=>{t("pick",[an,At],!0)},de=ee(()=>W.value>U.value),_e=xe([0,2]),Re=(an,At)=>{t("select-range",an,At,"min"),_e.value=[an,At]},Qe=ee(()=>q.value?11:8),Ee=(an,At)=>{t("select-range",an,At,"max");const Ge=y(Qe);_e.value=[an+Ge,At+Ge]},ye=an=>{const At=q.value?[0,3,6,11,14,17]:[0,3,8,11],Ge=["hours","minutes"].concat(q.value?["seconds"]:[]),Nt=(At.indexOf(_e.value[0])+an+At.length)%At.length,Jt=At.length/2;Nt<Jt?Rt.start_emitSelectRange(Ge[Nt]):Rt.end_emitSelectRange(Ge[Nt-Jt])},Me=an=>{const At=an.code,{left:Ge,right:Fe,up:Nt,down:Jt}=Cn;if([Ge,Fe].includes(At)){ye(At===Ge?-1:1),an.preventDefault();return}if([Nt,Jt].includes(At)){const Dt=At===Nt?-1:1,xt=_e.value[0]<Qe.value?"start":"end";Rt[`${xt}_scrollDown`](Dt),an.preventDefault();return}},Te=(an,At)=>{const Ge=I?I(an):[],Fe=an==="start",Jt=(At||(Fe?U.value:W.value)).hour(),Dt=Fe?a(Jt+1,23):a(0,Jt-1);return gw(Ge,Dt)},he=(an,At,Ge)=>{const Fe=R?R(an,At):[],Nt=At==="start",Jt=Ge||(Nt?U.value:W.value),Dt=Jt.hour();if(an!==Dt)return Fe;const xt=Jt.minute(),Ot=Nt?a(xt+1,59):a(0,xt-1);return gw(Fe,Ot)},ke=(an,At,Ge,Fe)=>{const Nt=z?z(an,At,Ge):[],Jt=Ge==="start",Dt=Fe||(Jt?U.value:W.value),xt=Dt.hour(),Ot=Dt.minute();if(an!==xt||At!==Ot)return Nt;const en=Dt.second(),dn=Jt?a(en+1,59):a(0,en-1);return gw(Nt,dn)},Ne=([an,At])=>[Bt(an,"start",!0,At),Bt(At,"end",!1,an)],{getAvailableHours:nt,getAvailableMinutes:De,getAvailableSeconds:Ct}=iO(Te,he,ke),{timePickerOptions:Rt,getAvailableTime:Bt,onSetOption:mt}=oO({getAvailableHours:nt,getAvailableMinutes:De,getAvailableSeconds:Ct}),Gt=an=>an?sn(an)?an.map(At=>so(At,i.format).locale(g.value)):so(an,i.format).locale(g.value):null,jt=an=>an?sn(an)?an.map(At=>At.format(i.format)):an.format(i.format):null,Be=()=>{if(sn(N))return N.map(At=>so(At).locale(g.value));const an=so(N).locale(g.value);return[an,an.add(60,"m")]};return t("set-picker-option",["formatToString",jt]),t("set-picker-option",["parseUserInput",Gt]),t("set-picker-option",["isValidValue",ge]),t("set-picker-option",["handleKeydownInput",Me]),t("set-picker-option",["getDefaultValue",Be]),t("set-picker-option",["getRangeAvailableTime",Ne]),(an,At)=>an.actualVisible?(se(),Ie("div",{key:0,class:ue([y(_).b("range-picker"),y(o).b("panel")])},[je("div",{class:ue(y(_).be("range-picker","content"))},[je("div",{class:ue(y(_).be("range-picker","cell"))},[je("div",{class:ue(y(_).be("range-picker","header"))},mn(y(d)("el.datepicker.startTime")),3),je("div",{class:ue(y($))},[Ye(O2,{ref:"minSpinner",role:"start","show-seconds":y(q),"am-pm-mode":y(J),"arrow-control":y(E),"spinner-date":y(W),"disabled-hours":Te,"disabled-minutes":he,"disabled-seconds":ke,onChange:ae,onSetOption:y(mt),onSelectRange:Re},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),je("div",{class:ue(y(_).be("range-picker","cell"))},[je("div",{class:ue(y(_).be("range-picker","header"))},mn(y(d)("el.datepicker.endTime")),3),je("div",{class:ue(y(F))},[Ye(O2,{ref:"maxSpinner",role:"end","show-seconds":y(q),"am-pm-mode":y(J),"arrow-control":y(E),"spinner-date":y(U),"disabled-hours":Te,"disabled-minutes":he,"disabled-seconds":ke,onChange:fe,onSetOption:y(mt),onSelectRange:Ee},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),je("div",{class:ue(y(_).be("panel","footer"))},[je("button",{type:"button",class:ue([y(_).be("panel","btn"),"cancel"]),onClick:Ge=>K()},mn(y(d)("el.datepicker.cancel")),11,["onClick"]),je("button",{type:"button",class:ue([y(_).be("panel","btn"),"confirm"]),disabled:y(de),onClick:Ge=>oe()},mn(y(d)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):yt("v-if",!0)}});var UY=fn(VY,[["__file","panel-time-range.vue"]]);so.extend(BT);var jY=qe({name:"ElTimePicker",install:null,props:{...FT,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const i=xe(),[a,d]=e.isRange?["timerange",UY]:["time",fb],g=_=>t.emit("update:modelValue",_);return Bo("ElPopperOptions",e.popperOptions),t.expose({focus:()=>{var _;(_=i.value)==null||_.focus()},blur:()=>{var _;(_=i.value)==null||_.blur()},handleOpen:()=>{var _;(_=i.value)==null||_.handleOpen()},handleClose:()=>{var _;(_=i.value)==null||_.handleClose()}}),()=>{var _;const o=(_=e.format)!=null?_:C2;return Ye(nO,Po(e,{ref:i,type:a,format:o,"onUpdate:modelValue":g}),{default:S=>Ye(d,S,null)})}}});const HY=uo(jY),GY=(e,t)=>{const i=e.subtract(1,"month").endOf("month").date();return Zu(t).map((a,d)=>i-(t-d-1))},WY=e=>{const t=e.daysInMonth();return Zu(t).map((i,a)=>a+1)},qY=e=>Zu(e.length/7).map(t=>{const i=t*7;return e.slice(i,i+7)}),KY=cn({selectedDay:{type:at(Object)},range:{type:at(Array)},date:{type:at(Object),required:!0},hideHeader:{type:Boolean}}),ZY={pick:e=>So(e)};var pO={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){return function(i,a,d){var g=a.prototype,_=function(R){return R&&(R.indexOf?R:R.s)},o=function(R,z,N,$,F){var W=R.name?R:R.$locale(),U=_(W[z]),re=_(W[N]),K=U||re.map(function(J){return J.slice(0,$)});if(!F)return K;var q=W.weekStart;return K.map(function(J,oe){return K[(oe+(q||0))%7]})},S=function(){return d.Ls[d.locale()]},E=function(R,z){return R.formats[z]||function(N){return N.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function($,F,W){return F||W.slice(1)})}(R.formats[z.toUpperCase()])},I=function(){var R=this;return{months:function(z){return z?z.format("MMMM"):o(R,"months")},monthsShort:function(z){return z?z.format("MMM"):o(R,"monthsShort","months",3)},firstDayOfWeek:function(){return R.$locale().weekStart||0},weekdays:function(z){return z?z.format("dddd"):o(R,"weekdays")},weekdaysMin:function(z){return z?z.format("dd"):o(R,"weekdaysMin","weekdays",2)},weekdaysShort:function(z){return z?z.format("ddd"):o(R,"weekdaysShort","weekdays",3)},longDateFormat:function(z){return E(R.$locale(),z)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};g.localeData=function(){return I.bind(this)()},d.localeData=function(){var R=S();return{firstDayOfWeek:function(){return R.weekStart||0},weekdays:function(){return d.weekdays()},weekdaysShort:function(){return d.weekdaysShort()},weekdaysMin:function(){return d.weekdaysMin()},months:function(){return d.months()},monthsShort:function(){return d.monthsShort()},longDateFormat:function(z){return E(R,z)},meridiem:R.meridiem,ordinal:R.ordinal}},d.months=function(){return o(S(),"months")},d.monthsShort=function(){return o(S(),"monthsShort","months",3)},d.weekdays=function(R){return o(S(),"weekdays",null,null,R)},d.weekdaysShort=function(R){return o(S(),"weekdaysShort","weekdays",3,R)},d.weekdaysMin=function(R){return o(S(),"weekdaysMin","weekdays",2,R)}}})})(pO);var YY=pO.exports;const mO=Ql(YY),XY=(e,t)=>{so.extend(mO);const i=so.localeData().firstDayOfWeek(),{t:a,lang:d}=qo(),g=so().locale(d.value),_=ee(()=>!!e.range&&!!e.range.length),o=ee(()=>{let z=[];if(_.value){const[N,$]=e.range,F=Zu($.date()-N.date()+1).map(re=>({text:N.date()+re,type:"current"}));let W=F.length%7;W=W===0?0:7-W;const U=Zu(W).map((re,K)=>({text:K+1,type:"next"}));z=F.concat(U)}else{const N=e.date.startOf("month").day(),$=GY(e.date,(N-i+7)%7).map(re=>({text:re,type:"prev"})),F=WY(e.date).map(re=>({text:re,type:"current"}));z=[...$,...F];const W=7-(z.length%7||7),U=Zu(W).map((re,K)=>({text:K+1,type:"next"}));z=z.concat(U)}return qY(z)}),S=ee(()=>{const z=i;return z===0?vw.map(N=>a(`el.datepicker.weeks.${N}`)):vw.slice(z).concat(vw.slice(0,z)).map(N=>a(`el.datepicker.weeks.${N}`))}),E=(z,N)=>{switch(N){case"prev":return e.date.startOf("month").subtract(1,"month").date(z);case"next":return e.date.startOf("month").add(1,"month").date(z);case"current":return e.date.date(z)}};return{now:g,isInRange:_,rows:o,weekDays:S,getFormattedDate:E,handlePickDay:({text:z,type:N})=>{const $=E(z,N);t("pick",$)},getSlotData:({text:z,type:N})=>{const $=E(z,N);return{isSelected:$.isSame(e.selectedDay),type:`${N}-month`,day:$.format("YYYY-MM-DD"),date:$.toDate()}}}},JY=qe({name:"DateTable"}),QY=qe({...JY,props:KY,emits:ZY,setup(e,{expose:t,emit:i}){const a=e,{isInRange:d,now:g,rows:_,weekDays:o,getFormattedDate:S,handlePickDay:E,getSlotData:I}=XY(a,i),R=Xt("calendar-table"),z=Xt("calendar-day"),N=({text:$,type:F})=>{const W=[F];if(F==="current"){const U=S($,F);U.isSame(a.selectedDay,"day")&&W.push(z.is("selected")),U.isSame(g,"day")&&W.push(z.is("today"))}return W};return t({getFormattedDate:S}),($,F)=>(se(),Ie("table",{class:ue([y(R).b(),y(R).is("range",y(d))]),cellspacing:"0",cellpadding:"0"},[$.hideHeader?yt("v-if",!0):(se(),Ie("thead",{key:0},[(se(!0),Ie(Fn,null,Fo(y(o),W=>(se(),Ie("th",{key:W},mn(W),1))),128))])),je("tbody",null,[(se(!0),Ie(Fn,null,Fo(y(_),(W,U)=>(se(),Ie("tr",{key:U,class:ue({[y(R).e("row")]:!0,[y(R).em("row","hide-border")]:U===0&&$.hideHeader})},[(se(!0),Ie(Fn,null,Fo(W,(re,K)=>(se(),Ie("td",{key:K,class:ue(N(re)),onClick:q=>y(E)(re)},[je("div",{class:ue(y(z).b())},[vt($.$slots,"date-cell",{data:y(I)(re)},()=>[je("span",null,mn(re.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var _3=fn(QY,[["__file","date-table.vue"]]);const eX=(e,t)=>{const i=e.endOf("month"),a=t.startOf("month"),g=i.isSame(a,"week")?a.add(1,"week"):a;return[[e,i],[g.startOf("week"),t]]},tX=(e,t)=>{const i=e.endOf("month"),a=e.add(1,"month").startOf("month"),d=i.isSame(a,"week")?a.add(1,"week"):a,g=d.endOf("month"),_=t.startOf("month"),o=g.isSame(_,"week")?_.add(1,"week"):_;return[[e,i],[d.startOf("week"),g],[o.startOf("week"),t]]},nX=(e,t,i)=>{const{lang:a}=qo(),d=xe(),g=so().locale(a.value),_=ee({get(){return e.modelValue?S.value:d.value},set(W){if(!W)return;d.value=W;const U=W.toDate();t(Ns,U),t(xo,U)}}),o=ee(()=>{if(!e.range||!sn(e.range)||e.range.length!==2||e.range.some(K=>!Yu(K)))return[];const W=e.range.map(K=>so(K).locale(a.value)),[U,re]=W;return U.isAfter(re)?[]:U.isSame(re,"month")?N(U,re):U.add(1,"month").month()!==re.month()?[]:N(U,re)}),S=ee(()=>e.modelValue?so(e.modelValue).locale(a.value):_.value||(o.value.length?o.value[0][0]:g)),E=ee(()=>S.value.subtract(1,"month").date(1)),I=ee(()=>S.value.add(1,"month").date(1)),R=ee(()=>S.value.subtract(1,"year").date(1)),z=ee(()=>S.value.add(1,"year").date(1)),N=(W,U)=>{const re=W.startOf("week"),K=U.endOf("week"),q=re.get("month"),J=K.get("month");return q===J?[[re,K]]:(q+1)%12===J?eX(re,K):q+2===J||(q+1)%11===J?tX(re,K):[]},$=W=>{_.value=W};return{calculateValidatedDateRange:N,date:S,realSelectedDay:_,pickDay:$,selectDate:W=>{const re={"prev-month":E.value,"next-month":I.value,"prev-year":R.value,"next-year":z.value,today:g}[W];re.isSame(S.value,"day")||$(re)},validatedRange:o}},oX=e=>sn(e)&&e.length===2&&e.every(t=>Yu(t)),rX=cn({modelValue:{type:Date},range:{type:at(Array),validator:oX}}),iX={[xo]:e=>Yu(e),[Ns]:e=>Yu(e)},sX="ElCalendar",aX=qe({name:sX}),lX=qe({...aX,props:rX,emits:iX,setup(e,{expose:t,emit:i}){const a=e,d=Xt("calendar"),{calculateValidatedDateRange:g,date:_,pickDay:o,realSelectedDay:S,selectDate:E,validatedRange:I}=nX(a,i),{t:R}=qo(),z=ee(()=>{const N=`el.datepicker.month${_.value.format("M")}`;return`${_.value.year()} ${R("el.datepicker.year")} ${R(N)}`});return t({selectedDay:S,pickDay:o,selectDate:E,calculateValidatedDateRange:g}),(N,$)=>(se(),Ie("div",{class:ue(y(d).b())},[je("div",{class:ue(y(d).e("header"))},[vt(N.$slots,"header",{date:y(z)},()=>[je("div",{class:ue(y(d).e("title"))},mn(y(z)),3),y(I).length===0?(se(),Ie("div",{key:0,class:ue(y(d).e("button-group"))},[Ye(y(ZL),null,{default:it(()=>[Ye(y($i),{size:"small",onClick:F=>y(E)("prev-month")},{default:it(()=>[$o(mn(y(R)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),Ye(y($i),{size:"small",onClick:F=>y(E)("today")},{default:it(()=>[$o(mn(y(R)("el.datepicker.today")),1)]),_:1},8,["onClick"]),Ye(y($i),{size:"small",onClick:F=>y(E)("next-month")},{default:it(()=>[$o(mn(y(R)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):yt("v-if",!0)])],2),y(I).length===0?(se(),Ie("div",{key:0,class:ue(y(d).e("body"))},[Ye(_3,{date:y(_),"selected-day":y(S),onPick:y(o)},Na({_:2},[N.$slots["date-cell"]?{name:"date-cell",fn:it(F=>[vt(N.$slots,"date-cell",hl(Xu(F)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(se(),Ie("div",{key:1,class:ue(y(d).e("body"))},[(se(!0),Ie(Fn,null,Fo(y(I),(F,W)=>(se(),Et(_3,{key:W,date:F[0],"selected-day":y(S),range:F,"hide-header":W!==0,onPick:y(o)},Na({_:2},[N.$slots["date-cell"]?{name:"date-cell",fn:it(U=>[vt(N.$slots,"date-cell",hl(Xu(U)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var cX=fn(lX,[["__file","calendar.vue"]]);const uX=uo(cX),dX=cn({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:at([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),hX=qe({name:"ElCard"}),fX=qe({...hX,props:dX,setup(e){const t=Xt("card");return(i,a)=>(se(),Ie("div",{class:ue([y(t).b(),y(t).is(`${i.shadow}-shadow`)])},[i.$slots.header||i.header?(se(),Ie("div",{key:0,class:ue(y(t).e("header"))},[vt(i.$slots,"header",{},()=>[$o(mn(i.header),1)])],2)):yt("v-if",!0),je("div",{class:ue([y(t).e("body"),i.bodyClass]),style:$n(i.bodyStyle)},[vt(i.$slots,"default")],6),i.$slots.footer||i.footer?(se(),Ie("div",{key:1,class:ue(y(t).e("footer"))},[vt(i.$slots,"footer",{},()=>[$o(mn(i.footer),1)])],2)):yt("v-if",!0)],2))}});var pX=fn(fX,[["__file","card.vue"]]);const mX=uo(pX),gX=cn({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),vX={change:(e,t)=>[e,t].every(Wn)},gO=Symbol("carouselContextKey"),z2="ElCarouselItem",y3=300,_X=(e,t,i)=>{const{children:a,addChild:d,removeChild:g}=AT(To(),z2),_=Ri(),o=xe(-1),S=xe(null),E=xe(!1),I=xe(),R=xe(0),z=xe(!0),N=xe(!0),$=xe(!1),F=ee(()=>e.arrow!=="never"&&!y(re)),W=ee(()=>a.value.some(Bt=>Bt.props.label.toString().length>0)),U=ee(()=>e.type==="card"),re=ee(()=>e.direction==="vertical"),K=ee(()=>e.height!=="auto"?{height:e.height}:{height:`${R.value}px`,overflow:"hidden"}),q=gh(Bt=>{ce(Bt)},y3,{trailing:!0}),J=gh(Bt=>{he(Bt)},y3),oe=Bt=>z.value?o.value<=1?Bt<=1:Bt>1:!0;function ae(){S.value&&(clearInterval(S.value),S.value=null)}function fe(){e.interval<=0||!e.autoplay||S.value||(S.value=setInterval(()=>ge(),e.interval))}const ge=()=>{N.value||($.value=!0),N.value=!1,o.value<a.value.length-1?o.value=o.value+1:e.loop?o.value=0:$.value=!1};function ce(Bt){if(N.value||($.value=!0),N.value=!1,Bn(Bt)){const jt=a.value.filter(Be=>Be.props.name===Bt);jt.length>0&&(Bt=a.value.indexOf(jt[0]))}if(Bt=Number(Bt),Number.isNaN(Bt)||Bt!==Math.floor(Bt))return;const mt=a.value.length,Gt=o.value;Bt<0?o.value=e.loop?mt-1:0:Bt>=mt?o.value=e.loop?0:mt-1:o.value=Bt,Gt===o.value&&de(Gt),nt()}function de(Bt){a.value.forEach((mt,Gt)=>{mt.translateItem(Gt,o.value,Bt)})}function _e(Bt,mt){var Gt,jt,Be,an;const At=y(a),Ge=At.length;if(Ge===0||!Bt.states.inStage)return!1;const Fe=mt+1,Nt=mt-1,Jt=Ge-1,Dt=At[Jt].states.active,xt=At[0].states.active,Ot=(jt=(Gt=At[Fe])==null?void 0:Gt.states)==null?void 0:jt.active,en=(an=(Be=At[Nt])==null?void 0:Be.states)==null?void 0:an.active;return mt===Jt&&xt||Ot?"left":mt===0&&Dt||en?"right":!1}function Re(){E.value=!0,e.pauseOnHover&&ae()}function Qe(){E.value=!1,fe()}function Ee(){$.value=!1}function ye(Bt){y(re)||a.value.forEach((mt,Gt)=>{Bt===_e(mt,Gt)&&(mt.states.hover=!0)})}function Me(){y(re)||a.value.forEach(Bt=>{Bt.states.hover=!1})}function Te(Bt){Bt!==o.value&&(N.value||($.value=!0)),o.value=Bt}function he(Bt){e.trigger==="hover"&&Bt!==o.value&&(o.value=Bt,N.value||($.value=!0))}function ke(){ce(o.value-1)}function Ne(){ce(o.value+1)}function nt(){ae(),e.pauseOnHover||fe()}function De(Bt){e.height==="auto"&&(R.value=Bt)}function Ct(){var Bt;const mt=(Bt=_.default)==null?void 0:Bt.call(_);if(!mt)return null;const jt=qu(mt).filter(Be=>Yr(Be)&&Be.type.name===z2);return(jt==null?void 0:jt.length)===2&&e.loop&&!U.value?(z.value=!0,jt):(z.value=!1,null)}qt(()=>o.value,(Bt,mt)=>{de(mt),z.value&&(Bt=Bt%2,mt=mt%2),mt>-1&&t("change",Bt,mt)}),qt(()=>e.autoplay,Bt=>{Bt?fe():ae()}),qt(()=>e.loop,()=>{ce(o.value)}),qt(()=>e.interval,()=>{nt()});const Rt=qr();return _o(()=>{qt(()=>a.value,()=>{a.value.length>0&&ce(e.initialIndex)},{immediate:!0}),Rt.value=ei(I.value,()=>{de()}),fe()}),Pr(()=>{ae(),I.value&&Rt.value&&Rt.value.stop()}),Bo(gO,{root:I,isCardType:U,isVertical:re,items:a,loop:e.loop,cardScale:e.cardScale,addItem:d,removeItem:g,setActiveItem:ce,setContainerHeight:De}),{root:I,activeIndex:o,arrowDisplay:F,hasLabel:W,hover:E,isCardType:U,isTransitioning:$,items:a,isVertical:re,containerStyle:K,isItemsTwoLength:z,handleButtonEnter:ye,handleTransitionEnd:Ee,handleButtonLeave:Me,handleIndicatorClick:Te,handleMouseEnter:Re,handleMouseLeave:Qe,setActiveItem:ce,prev:ke,next:Ne,PlaceholderItem:Ct,isTwoLengthShow:oe,throttledArrowClick:q,throttledIndicatorHover:J}},yX="ElCarousel",bX=qe({name:yX}),xX=qe({...bX,props:gX,emits:vX,setup(e,{expose:t,emit:i}){const a=e,{root:d,activeIndex:g,arrowDisplay:_,hasLabel:o,hover:S,isCardType:E,items:I,isVertical:R,containerStyle:z,handleButtonEnter:N,handleButtonLeave:$,isTransitioning:F,handleIndicatorClick:W,handleMouseEnter:U,handleMouseLeave:re,handleTransitionEnd:K,setActiveItem:q,prev:J,next:oe,PlaceholderItem:ae,isTwoLengthShow:fe,throttledArrowClick:ge,throttledIndicatorHover:ce}=_X(a,i),de=Xt("carousel"),{t:_e}=qo(),Re=ee(()=>{const ye=[de.b(),de.m(a.direction)];return y(E)&&ye.push(de.m("card")),ye}),Qe=ee(()=>{const ye=[de.e("container")];return a.motionBlur&&y(F)&&I.value.length>1&&ye.push(y(R)?`${de.namespace.value}-transitioning-vertical`:`${de.namespace.value}-transitioning`),ye}),Ee=ee(()=>{const ye=[de.e("indicators"),de.em("indicators",a.direction)];return y(o)&&ye.push(de.em("indicators","labels")),a.indicatorPosition==="outside"&&ye.push(de.em("indicators","outside")),y(R)&&ye.push(de.em("indicators","right")),ye});return t({activeIndex:g,setActiveItem:q,prev:J,next:oe}),(ye,Me)=>(se(),Ie("div",{ref_key:"root",ref:d,class:ue(y(Re)),onMouseenter:Xn(y(U),["stop"]),onMouseleave:Xn(y(re),["stop"])},[y(_)?(se(),Et(Ui,{key:0,name:"carousel-arrow-left",persisted:""},{default:it(()=>[vo(je("button",{type:"button",class:ue([y(de).e("arrow"),y(de).em("arrow","left")]),"aria-label":y(_e)("el.carousel.leftArrow"),onMouseenter:Te=>y(N)("left"),onMouseleave:y($),onClick:Xn(Te=>y(ge)(y(g)-1),["stop"])},[Ye(y(Dn),null,{default:it(()=>[Ye(y(td))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[ir,(ye.arrow==="always"||y(S))&&(a.loop||y(g)>0)]])]),_:1})):yt("v-if",!0),y(_)?(se(),Et(Ui,{key:1,name:"carousel-arrow-right",persisted:""},{default:it(()=>[vo(je("button",{type:"button",class:ue([y(de).e("arrow"),y(de).em("arrow","right")]),"aria-label":y(_e)("el.carousel.rightArrow"),onMouseenter:Te=>y(N)("right"),onMouseleave:y($),onClick:Xn(Te=>y(ge)(y(g)+1),["stop"])},[Ye(y(Dn),null,{default:it(()=>[Ye(y(Fs))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[ir,(ye.arrow==="always"||y(S))&&(a.loop||y(g)<y(I).length-1)]])]),_:1})):yt("v-if",!0),je("div",{class:ue(y(Qe)),style:$n(y(z)),onTransitionend:y(K)},[Ye(y(ae)),vt(ye.$slots,"default")],46,["onTransitionend"]),ye.indicatorPosition!=="none"?(se(),Ie("ul",{key:2,class:ue(y(Ee))},[(se(!0),Ie(Fn,null,Fo(y(I),(Te,he)=>vo((se(),Ie("li",{key:he,class:ue([y(de).e("indicator"),y(de).em("indicator",ye.direction),y(de).is("active",he===y(g))]),onMouseenter:ke=>y(ce)(he),onClick:Xn(ke=>y(W)(he),["stop"])},[je("button",{class:ue(y(de).e("button")),"aria-label":y(_e)("el.carousel.indicator",{index:he+1})},[y(o)?(se(),Ie("span",{key:0},mn(Te.props.label),1)):yt("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[ir,y(fe)(he)]])),128))],2)):yt("v-if",!0),a.motionBlur?(se(),Ie("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[je("defs",null,[je("filter",{id:"elCarouselHorizontal"},[je("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),je("filter",{id:"elCarouselVertical"},[je("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):yt("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var wX=fn(xX,[["__file","carousel.vue"]]);const SX=cn({name:{type:String,default:""},label:{type:[String,Number],default:""}}),TX=e=>{const t=kn(gO),i=To(),a=xe(),d=xe(!1),g=xe(0),_=xe(1),o=xe(!1),S=xe(!1),E=xe(!1),I=xe(!1),{isCardType:R,isVertical:z,cardScale:N}=t;function $(K,q,J){const oe=J-1,ae=q-1,fe=q+1,ge=J/2;return q===0&&K===oe?-1:q===oe&&K===0?J:K<ae&&q-K>=ge?J+1:K>fe&&K-q>=ge?-2:K}function F(K,q){var J,oe;const ae=y(z)?((J=t.root.value)==null?void 0:J.offsetHeight)||0:((oe=t.root.value)==null?void 0:oe.offsetWidth)||0;return E.value?ae*((2-N)*(K-q)+1)/4:K<q?-(1+N)*ae/4:(3+N)*ae/4}function W(K,q,J){const oe=t.root.value;return oe?((J?oe.offsetHeight:oe.offsetWidth)||0)*(K-q):0}const U=(K,q,J)=>{var oe;const ae=y(R),fe=(oe=t.items.value.length)!=null?oe:Number.NaN,ge=K===q;!ae&&!jr(J)&&(I.value=ge||K===J),!ge&&fe>2&&t.loop&&(K=$(K,q,fe));const ce=y(z);o.value=ge,ae?(E.value=Math.round(Math.abs(K-q))<=1,g.value=F(K,q),_.value=y(o)?1:N):g.value=W(K,q,ce),S.value=!0,ge&&a.value&&t.setContainerHeight(a.value.offsetHeight)};function re(){if(t&&y(R)){const K=t.items.value.findIndex(({uid:q})=>q===i.uid);t.setActiveItem(K)}}return _o(()=>{t.addItem({props:e,states:dr({hover:d,translate:g,scale:_,active:o,ready:S,inStage:E,animating:I}),uid:i.uid,translateItem:U})}),ld(()=>{t.removeItem(i.uid)}),{carouselItemRef:a,active:o,animating:I,hover:d,inStage:E,isVertical:z,translate:g,isCardType:R,scale:_,ready:S,handleItemClick:re}},CX=qe({name:z2}),EX=qe({...CX,props:SX,setup(e){const t=e,i=Xt("carousel"),{carouselItemRef:a,active:d,animating:g,hover:_,inStage:o,isVertical:S,translate:E,isCardType:I,scale:R,ready:z,handleItemClick:N}=TX(t),$=ee(()=>[i.e("item"),i.is("active",d.value),i.is("in-stage",o.value),i.is("hover",_.value),i.is("animating",g.value),{[i.em("item","card")]:I.value,[i.em("item","card-vertical")]:I.value&&S.value}]),F=ee(()=>{const U=`${`translate${y(S)?"Y":"X"}`}(${y(E)}px)`,re=`scale(${y(R)})`;return{transform:[U,re].join(" ")}});return(W,U)=>vo((se(),Ie("div",{ref_key:"carouselItemRef",ref:a,class:ue(y($)),style:$n(y(F)),onClick:y(N)},[y(I)?vo((se(),Ie("div",{key:0,class:ue(y(i).e("mask"))},null,2)),[[ir,!y(d)]]):yt("v-if",!0),vt(W.$slots,"default")],14,["onClick"])),[[ir,y(z)]])}});var vO=fn(EX,[["__file","carousel-item.vue"]]);const MX=uo(wX,{CarouselItem:vO}),IX=ri(vO),_O={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:ki,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...Zi(["ariaControls"])},yO={[xo]:e=>Bn(e)||Wn(e)||Lr(e),change:e=>Bn(e)||Wn(e)||Lr(e)},Xp=Symbol("checkboxGroupContextKey"),AX=({model:e,isChecked:t})=>{const i=kn(Xp,void 0),a=ee(()=>{var g,_;const o=(g=i==null?void 0:i.max)==null?void 0:g.value,S=(_=i==null?void 0:i.min)==null?void 0:_.value;return!jr(o)&&e.value.length>=o&&!t.value||!jr(S)&&e.value.length<=S&&t.value});return{isDisabled:bs(ee(()=>(i==null?void 0:i.disabled.value)||a.value)),isLimitDisabled:a}},kX=(e,{model:t,isLimitExceeded:i,hasOwnLabel:a,isDisabled:d,isLabeledByFormItem:g})=>{const _=kn(Xp,void 0),{formItem:o}=xs(),{emit:S}=To();function E($){var F,W,U,re;return[!0,e.trueValue,e.trueLabel].includes($)?(W=(F=e.trueValue)!=null?F:e.trueLabel)!=null?W:!0:(re=(U=e.falseValue)!=null?U:e.falseLabel)!=null?re:!1}function I($,F){S("change",E($),F)}function R($){if(i.value)return;const F=$.target;S("change",E(F.checked),$)}async function z($){i.value||!a.value&&!d.value&&g.value&&($.composedPath().some(U=>U.tagName==="LABEL")||(t.value=E([!1,e.falseValue,e.falseLabel].includes(t.value)),await Un(),I(t.value,$)))}const N=ee(()=>(_==null?void 0:_.validateEvent)||e.validateEvent);return qt(()=>e.modelValue,()=>{N.value&&(o==null||o.validate("change").catch($=>void 0))}),{handleChange:R,onClickRoot:z}},PX=e=>{const t=xe(!1),{emit:i}=To(),a=kn(Xp,void 0),d=ee(()=>jr(a)===!1),g=xe(!1),_=ee({get(){var o,S;return d.value?(o=a==null?void 0:a.modelValue)==null?void 0:o.value:(S=e.modelValue)!=null?S:t.value},set(o){var S,E;d.value&&sn(o)?(g.value=((S=a==null?void 0:a.max)==null?void 0:S.value)!==void 0&&o.length>(a==null?void 0:a.max.value)&&o.length>_.value.length,g.value===!1&&((E=a==null?void 0:a.changeEvent)==null||E.call(a,o))):(i(xo,o),t.value=o)}});return{model:_,isGroup:d,isLimitExceeded:g}},RX=(e,t,{model:i})=>{const a=kn(Xp,void 0),d=xe(!1),g=ee(()=>Th(e.value)?e.label:e.value),_=ee(()=>{const I=i.value;return Lr(I)?I:sn(I)?So(g.value)?I.map(Ar).some(R=>qi(R,g.value)):I.map(Ar).includes(g.value):I!=null?I===e.trueValue||I===e.trueLabel:!!I}),o=Mi(ee(()=>{var I;return(I=a==null?void 0:a.size)==null?void 0:I.value}),{prop:!0}),S=Mi(ee(()=>{var I;return(I=a==null?void 0:a.size)==null?void 0:I.value})),E=ee(()=>!!t.default||!Th(g.value));return{checkboxButtonSize:o,isChecked:_,isFocused:d,checkboxSize:S,hasOwnLabel:E,actualValue:g}},bO=(e,t)=>{const{formItem:i}=xs(),{model:a,isGroup:d,isLimitExceeded:g}=PX(e),{isFocused:_,isChecked:o,checkboxButtonSize:S,checkboxSize:E,hasOwnLabel:I,actualValue:R}=RX(e,t,{model:a}),{isDisabled:z}=AX({model:a,isChecked:o}),{inputId:N,isLabeledByFormItem:$}=Cl(e,{formItemContext:i,disableIdGeneration:I,disableIdManagement:d}),{handleChange:F,onClickRoot:W}=kX(e,{model:a,isLimitExceeded:g,hasOwnLabel:I,isDisabled:z,isLabeledByFormItem:$});return(()=>{function re(){var K,q;sn(a.value)&&!a.value.includes(R.value)?a.value.push(R.value):a.value=(q=(K=e.trueValue)!=null?K:e.trueLabel)!=null?q:!0}e.checked&&re()})(),Ku({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>d.value&&Th(e.value))),Ku({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>!!e.trueLabel)),Ku({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>!!e.falseLabel)),{inputId:N,isLabeledByFormItem:$,isChecked:o,isDisabled:z,isFocused:_,checkboxButtonSize:S,checkboxSize:E,hasOwnLabel:I,model:a,actualValue:R,handleChange:F,onClickRoot:W}},DX=qe({name:"ElCheckbox"}),LX=qe({...DX,props:_O,emits:yO,setup(e){const t=e,i=Ri(),{inputId:a,isLabeledByFormItem:d,isChecked:g,isDisabled:_,isFocused:o,checkboxSize:S,hasOwnLabel:E,model:I,actualValue:R,handleChange:z,onClickRoot:N}=bO(t,i),$=Xt("checkbox"),F=ee(()=>[$.b(),$.m(S.value),$.is("disabled",_.value),$.is("bordered",t.border),$.is("checked",g.value)]),W=ee(()=>[$.e("input"),$.is("disabled",_.value),$.is("checked",g.value),$.is("indeterminate",t.indeterminate),$.is("focus",o.value)]);return(U,re)=>(se(),Et(ko(!y(E)&&y(d)?"span":"label"),{class:ue(y(F)),"aria-controls":U.indeterminate?U.ariaControls:null,onClick:y(N)},{default:it(()=>{var K,q,J,oe;return[je("span",{class:ue(y(W))},[U.trueValue||U.falseValue||U.trueLabel||U.falseLabel?vo((se(),Ie("input",{key:0,id:y(a),"onUpdate:modelValue":ae=>Hr(I)?I.value=ae:null,class:ue(y($).e("original")),type:"checkbox",indeterminate:U.indeterminate,name:U.name,tabindex:U.tabindex,disabled:y(_),"true-value":(q=(K=U.trueValue)!=null?K:U.trueLabel)!=null?q:!0,"false-value":(oe=(J=U.falseValue)!=null?J:U.falseLabel)!=null?oe:!1,onChange:y(z),onFocus:ae=>o.value=!0,onBlur:ae=>o.value=!1,onClick:Xn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[ob,y(I)]]):vo((se(),Ie("input",{key:1,id:y(a),"onUpdate:modelValue":ae=>Hr(I)?I.value=ae:null,class:ue(y($).e("original")),type:"checkbox",indeterminate:U.indeterminate,disabled:y(_),value:y(R),name:U.name,tabindex:U.tabindex,onChange:y(z),onFocus:ae=>o.value=!0,onBlur:ae=>o.value=!1,onClick:Xn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[ob,y(I)]]),je("span",{class:ue(y($).e("inner"))},null,2)],2),y(E)?(se(),Ie("span",{key:0,class:ue(y($).e("label"))},[vt(U.$slots,"default"),U.$slots.default?yt("v-if",!0):(se(),Ie(Fn,{key:0},[$o(mn(U.label),1)],64))],2)):yt("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var OX=fn(LX,[["__file","checkbox.vue"]]);const zX=qe({name:"ElCheckboxButton"}),BX=qe({...zX,props:_O,emits:yO,setup(e){const t=e,i=Ri(),{isFocused:a,isChecked:d,isDisabled:g,checkboxButtonSize:_,model:o,actualValue:S,handleChange:E}=bO(t,i),I=kn(Xp,void 0),R=Xt("checkbox"),z=ee(()=>{var $,F,W,U;const re=(F=($=I==null?void 0:I.fill)==null?void 0:$.value)!=null?F:"";return{backgroundColor:re,borderColor:re,color:(U=(W=I==null?void 0:I.textColor)==null?void 0:W.value)!=null?U:"",boxShadow:re?`-1px 0 0 0 ${re}`:void 0}}),N=ee(()=>[R.b("button"),R.bm("button",_.value),R.is("disabled",g.value),R.is("checked",d.value),R.is("focus",a.value)]);return($,F)=>{var W,U,re,K;return se(),Ie("label",{class:ue(y(N))},[$.trueValue||$.falseValue||$.trueLabel||$.falseLabel?vo((se(),Ie("input",{key:0,"onUpdate:modelValue":q=>Hr(o)?o.value=q:null,class:ue(y(R).be("button","original")),type:"checkbox",name:$.name,tabindex:$.tabindex,disabled:y(g),"true-value":(U=(W=$.trueValue)!=null?W:$.trueLabel)!=null?U:!0,"false-value":(K=(re=$.falseValue)!=null?re:$.falseLabel)!=null?K:!1,onChange:y(E),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Xn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[ob,y(o)]]):vo((se(),Ie("input",{key:1,"onUpdate:modelValue":q=>Hr(o)?o.value=q:null,class:ue(y(R).be("button","original")),type:"checkbox",name:$.name,tabindex:$.tabindex,disabled:y(g),value:y(S),onChange:y(E),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Xn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[ob,y(o)]]),$.$slots.default||$.label?(se(),Ie("span",{key:2,class:ue(y(R).be("button","inner")),style:$n(y(d)?y(z):void 0)},[vt($.$slots,"default",{},()=>[$o(mn($.label),1)])],6)):yt("v-if",!0)],2)}}});var xO=fn(BX,[["__file","checkbox-button.vue"]]);const FX=cn({modelValue:{type:at(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:ki,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...Zi(["ariaLabel"])}),NX={[xo]:e=>sn(e),change:e=>sn(e)},$X=qe({name:"ElCheckboxGroup"}),VX=qe({...$X,props:FX,emits:NX,setup(e,{emit:t}){const i=e,a=Xt("checkbox"),{formItem:d}=xs(),{inputId:g,isLabeledByFormItem:_}=Cl(i,{formItemContext:d}),o=async E=>{t(xo,E),await Un(),t("change",E)},S=ee({get(){return i.modelValue},set(E){o(E)}});return Bo(Xp,{...fl(Vi(i),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:S,changeEvent:o}),qt(()=>i.modelValue,()=>{i.validateEvent&&(d==null||d.validate("change").catch(E=>void 0))}),(E,I)=>{var R;return se(),Et(ko(E.tag),{id:y(g),class:ue(y(a).b("group")),role:"group","aria-label":y(_)?void 0:E.ariaLabel||"checkbox-group","aria-labelledby":y(_)?(R=y(d))==null?void 0:R.labelId:void 0},{default:it(()=>[vt(E.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var wO=fn(VX,[["__file","checkbox-group.vue"]]);const ja=uo(OX,{CheckboxButton:xO,CheckboxGroup:wO}),UX=ri(xO),SO=ri(wO),TO=cn({modelValue:{type:[String,Number,Boolean],default:void 0},size:ki,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),jX=cn({...TO,border:Boolean}),CO={[xo]:e=>Bn(e)||Wn(e)||Lr(e),[Wr]:e=>Bn(e)||Wn(e)||Lr(e)},EO=Symbol("radioGroupKey"),MO=(e,t)=>{const i=xe(),a=kn(EO,void 0),d=ee(()=>!!a),g=ee(()=>Th(e.value)?e.label:e.value),_=ee({get(){return d.value?a.modelValue:e.modelValue},set(R){d.value?a.changeEvent(R):t&&t(xo,R),i.value.checked=e.modelValue===g.value}}),o=Mi(ee(()=>a==null?void 0:a.size)),S=bs(ee(()=>a==null?void 0:a.disabled)),E=xe(!1),I=ee(()=>S.value||d.value&&_.value!==g.value?-1:0);return Ku({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},ee(()=>d.value&&Th(e.value))),{radioRef:i,isGroup:d,radioGroup:a,focus:E,size:o,disabled:S,tabIndex:I,modelValue:_,actualValue:g}},HX=qe({name:"ElRadio"}),GX=qe({...HX,props:jX,emits:CO,setup(e,{emit:t}){const i=e,a=Xt("radio"),{radioRef:d,radioGroup:g,focus:_,size:o,disabled:S,modelValue:E,actualValue:I}=MO(i,t);function R(){Un(()=>t("change",E.value))}return(z,N)=>{var $;return se(),Ie("label",{class:ue([y(a).b(),y(a).is("disabled",y(S)),y(a).is("focus",y(_)),y(a).is("bordered",z.border),y(a).is("checked",y(E)===y(I)),y(a).m(y(o))])},[je("span",{class:ue([y(a).e("input"),y(a).is("disabled",y(S)),y(a).is("checked",y(E)===y(I))])},[vo(je("input",{ref_key:"radioRef",ref:d,"onUpdate:modelValue":F=>Hr(E)?E.value=F:null,class:ue(y(a).e("original")),value:y(I),name:z.name||(($=y(g))==null?void 0:$.name),disabled:y(S),checked:y(E)===y(I),type:"radio",onFocus:F=>_.value=!0,onBlur:F=>_.value=!1,onChange:R,onClick:Xn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[OR,y(E)]]),je("span",{class:ue(y(a).e("inner"))},null,2)],2),je("span",{class:ue(y(a).e("label")),onKeydown:Xn(()=>{},["stop"])},[vt(z.$slots,"default",{},()=>[$o(mn(z.label),1)])],42,["onKeydown"])],2)}}});var WX=fn(GX,[["__file","radio.vue"]]);const qX=cn({...TO}),KX=qe({name:"ElRadioButton"}),ZX=qe({...KX,props:qX,setup(e){const t=e,i=Xt("radio"),{radioRef:a,focus:d,size:g,disabled:_,modelValue:o,radioGroup:S,actualValue:E}=MO(t),I=ee(()=>({backgroundColor:(S==null?void 0:S.fill)||"",borderColor:(S==null?void 0:S.fill)||"",boxShadow:S!=null&&S.fill?`-1px 0 0 0 ${S.fill}`:"",color:(S==null?void 0:S.textColor)||""}));return(R,z)=>{var N;return se(),Ie("label",{class:ue([y(i).b("button"),y(i).is("active",y(o)===y(E)),y(i).is("disabled",y(_)),y(i).is("focus",y(d)),y(i).bm("button",y(g))])},[vo(je("input",{ref_key:"radioRef",ref:a,"onUpdate:modelValue":$=>Hr(o)?o.value=$:null,class:ue(y(i).be("button","original-radio")),value:y(E),type:"radio",name:R.name||((N=y(S))==null?void 0:N.name),disabled:y(_),onFocus:$=>d.value=!0,onBlur:$=>d.value=!1,onClick:Xn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[OR,y(o)]]),je("span",{class:ue(y(i).be("button","inner")),style:$n(y(o)===y(E)?y(I):{}),onKeydown:Xn(()=>{},["stop"])},[vt(R.$slots,"default",{},()=>[$o(mn(R.label),1)])],46,["onKeydown"])],2)}}});var IO=fn(ZX,[["__file","radio-button.vue"]]);const YX=cn({id:{type:String,default:void 0},size:ki,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...Zi(["ariaLabel"])}),XX=CO,JX=qe({name:"ElRadioGroup"}),QX=qe({...JX,props:YX,emits:XX,setup(e,{emit:t}){const i=e,a=Xt("radio"),d=Ki(),g=xe(),{formItem:_}=xs(),{inputId:o,isLabeledByFormItem:S}=Cl(i,{formItemContext:_}),E=R=>{t(xo,R),Un(()=>t("change",R))};_o(()=>{const R=g.value.querySelectorAll("[type=radio]"),z=R[0];!Array.from(R).some(N=>N.checked)&&z&&(z.tabIndex=0)});const I=ee(()=>i.name||d.value);return Bo(EO,dr({...Vi(i),changeEvent:E,name:I})),qt(()=>i.modelValue,()=>{i.validateEvent&&(_==null||_.validate("change").catch(R=>void 0))}),(R,z)=>(se(),Ie("div",{id:y(o),ref_key:"radioGroupRef",ref:g,class:ue(y(a).b("group")),role:"radiogroup","aria-label":y(S)?void 0:R.ariaLabel||"radio-group","aria-labelledby":y(S)?y(_).labelId:void 0},[vt(R.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var AO=fn(QX,[["__file","radio-group.vue"]]);const kO=uo(WX,{RadioButton:IO,RadioGroup:AO}),eJ=ri(AO),tJ=ri(IO);var nJ=qe({name:"NodeContent",setup(){return{ns:Xt("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:i}=this.$parent,{data:a,label:d}=t,{renderLabelFn:g}=i;return Kn("span",{class:e.e("label")},g?g({node:t,data:a}):d)}});const NT=Symbol(),oJ=qe({name:"ElCascaderNode",components:{ElCheckbox:ja,ElRadio:kO,NodeContent:nJ,ElIcon:Dn,Check:i_,Loading:ql,ArrowRight:Fs},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const i=kn(NT),a=Xt("cascader-node"),d=ee(()=>i.isHoverMenu),g=ee(()=>i.config.multiple),_=ee(()=>i.config.checkStrictly),o=ee(()=>{var oe;return(oe=i.checkedNodes[0])==null?void 0:oe.uid}),S=ee(()=>e.node.isDisabled),E=ee(()=>e.node.isLeaf),I=ee(()=>_.value&&!E.value||!S.value),R=ee(()=>N(i.expandingNode)),z=ee(()=>_.value&&i.checkedNodes.some(N)),N=oe=>{var ae;const{level:fe,uid:ge}=e.node;return((ae=oe==null?void 0:oe.pathNodes[fe-1])==null?void 0:ae.uid)===ge},$=()=>{R.value||i.expandNode(e.node)},F=oe=>{const{node:ae}=e;oe!==ae.checked&&i.handleCheckChange(ae,oe)},W=()=>{i.lazyLoad(e.node,()=>{E.value||$()})},U=oe=>{d.value&&(re(),!E.value&&t("expand",oe))},re=()=>{const{node:oe}=e;!I.value||oe.loading||(oe.loaded?$():W())},K=()=>{d.value&&!E.value||(E.value&&!S.value&&!_.value&&!g.value?J(!0):re())},q=oe=>{_.value?(F(oe),e.node.loaded&&$()):J(oe)},J=oe=>{e.node.loaded?(F(oe),!_.value&&$()):W()};return{panel:i,isHoverMenu:d,multiple:g,checkStrictly:_,checkedNodeId:o,isDisabled:S,isLeaf:E,expandable:I,inExpandingPath:R,inCheckedPath:z,ns:a,handleHoverExpand:U,handleExpand:re,handleClick:K,handleCheck:J,handleSelectCheck:q}}});function rJ(e,t,i,a,d,g){const _=Mo("el-checkbox"),o=Mo("el-radio"),S=Mo("check"),E=Mo("el-icon"),I=Mo("node-content"),R=Mo("loading"),z=Mo("arrow-right");return se(),Ie("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:ue([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[yt(" prefix "),e.multiple?(se(),Et(_,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:Xn(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(se(),Et(o,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:Xn(()=>{},["stop"])},{default:it(()=>[yt(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),je("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(se(),Et(E,{key:2,class:ue(e.ns.e("prefix"))},{default:it(()=>[Ye(S)]),_:1},8,["class"])):yt("v-if",!0),yt(" content "),Ye(I),yt(" postfix "),e.isLeaf?yt("v-if",!0):(se(),Ie(Fn,{key:3},[e.node.loading?(se(),Et(E,{key:0,class:ue([e.ns.is("loading"),e.ns.e("postfix")])},{default:it(()=>[Ye(R)]),_:1},8,["class"])):(se(),Et(E,{key:1,class:ue(["arrow-right",e.ns.e("postfix")])},{default:it(()=>[Ye(z)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var iJ=fn(oJ,[["render",rJ],["__file","node.vue"]]);const sJ=qe({name:"ElCascaderMenu",components:{Loading:ql,ElIcon:Dn,ElScrollbar:nc,ElCascaderNode:iJ},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=To(),i=Xt("cascader-menu"),{t:a}=qo(),d=Ki();let g=null,_=null;const o=kn(NT),S=xe(null),E=ee(()=>!e.nodes.length),I=ee(()=>!o.initialLoaded),R=ee(()=>`${d.value}-${e.index}`),z=W=>{g=W.target},N=W=>{if(!(!o.isHoverMenu||!g||!S.value))if(g.contains(W.target)){$();const U=t.vnode.el,{left:re}=U.getBoundingClientRect(),{offsetWidth:K,offsetHeight:q}=U,J=W.clientX-re,oe=g.offsetTop,ae=oe+g.offsetHeight;S.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${oe} L${K} 0 V${oe} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${ae} L${K} ${q} V${ae} Z" />
        `}else _||(_=window.setTimeout(F,o.config.hoverThreshold))},$=()=>{_&&(clearTimeout(_),_=null)},F=()=>{S.value&&(S.value.innerHTML="",$())};return{ns:i,panel:o,hoverZone:S,isEmpty:E,isLoading:I,menuId:R,t:a,handleExpand:z,handleMouseMove:N,clearHoverZone:F}}});function aJ(e,t,i,a,d,g){const _=Mo("el-cascader-node"),o=Mo("loading"),S=Mo("el-icon"),E=Mo("el-scrollbar");return se(),Et(E,{key:e.menuId,tag:"ul",role:"menu",class:ue(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:it(()=>{var I;return[(se(!0),Ie(Fn,null,Fo(e.nodes,R=>(se(),Et(_,{key:R.uid,node:R,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(se(),Ie("div",{key:0,class:ue(e.ns.e("empty-text"))},[Ye(S,{size:"14",class:ue(e.ns.is("loading"))},{default:it(()=>[Ye(o)]),_:1},8,["class"]),$o(" "+mn(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(se(),Ie("div",{key:1,class:ue(e.ns.e("empty-text"))},[vt(e.$slots,"empty",{},()=>[$o(mn(e.t("el.cascader.noData")),1)])],2)):(I=e.panel)!=null&&I.isHoverMenu?(se(),Ie("svg",{key:2,ref:"hoverZone",class:ue(e.ns.e("hover-zone"))},null,2)):yt("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var lJ=fn(sJ,[["render",aJ],["__file","menu.vue"]]);let cJ=0;const uJ=e=>{const t=[e];let{parent:i}=e;for(;i;)t.unshift(i),i=i.parent;return t};let B2=class F2{constructor(t,i,a,d=!1){this.data=t,this.config=i,this.parent=a,this.root=d,this.uid=cJ++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:g,label:_,children:o}=i,S=t[o],E=uJ(this);this.level=d?0:a?a.level+1:1,this.value=t[g],this.label=t[_],this.pathNodes=E,this.pathValues=E.map(I=>I.value),this.pathLabels=E.map(I=>I.label),this.childrenData=S,this.children=(S||[]).map(I=>new F2(I,i,this)),this.loaded=!i.lazy||this.isLeaf||!ha(S)}get isDisabled(){const{data:t,parent:i,config:a}=this,{disabled:d,checkStrictly:g}=a;return(Nn(d)?d(t,this):!!t[d])||!g&&(i==null?void 0:i.isDisabled)}get isLeaf(){const{data:t,config:i,childrenData:a,loaded:d}=this,{lazy:g,leaf:_}=i,o=Nn(_)?_(t,this):t[_];return jr(o)?g&&!d?!1:!(sn(a)&&a.length):!!o}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:i,children:a}=this,d=new F2(t,this.config,this);return sn(i)?i.push(t):this.childrenData=[t],a.push(d),d}calcText(t,i){const a=t?this.pathLabels.join(i):this.label;return this.text=a,a}broadcast(t,...i){const a=`onParent${Ul(t)}`;this.children.forEach(d=>{d&&(d.broadcast(t,...i),d[a]&&d[a](...i))})}emit(t,...i){const{parent:a}=this,d=`onChild${Ul(t)}`;a&&(a[d]&&a[d](...i),a.emit(t,...i))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,i=t.filter(d=>!d.isDisabled),a=i.length?i.every(d=>d.checked):!1;this.setCheckState(a)}setCheckState(t){const i=this.children.length,a=this.children.reduce((d,g)=>{const _=g.checked?1:g.indeterminate?.5:0;return d+_},0);this.checked=this.loaded&&this.children.filter(d=>!d.isDisabled).every(d=>d.loaded&&d.checked)&&t,this.indeterminate=this.loaded&&a!==i&&a>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:i,multiple:a}=this.config;i||!a?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const N2=(e,t)=>e.reduce((i,a)=>(a.isLeaf?i.push(a):(!t&&i.push(a),i=i.concat(N2(a.children,t))),i),[]);class b3{constructor(t,i){this.config=i;const a=(t||[]).map(d=>new B2(d,this.config));this.nodes=a,this.allNodes=N2(a,!1),this.leafNodes=N2(a,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,i){const a=i?i.appendChild(t):new B2(t,this.config);i||this.nodes.push(a),this.allNodes.push(a),a.isLeaf&&this.leafNodes.push(a)}appendNodes(t,i){t.forEach(a=>this.appendNode(a,i))}getNodeByValue(t,i=!1){return!t&&t!==0?null:this.getFlattedNodes(i).find(d=>qi(d.value,t)||qi(d.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:a,level:d})=>qi(t.value,a)&&t.level===d)||null}}const PO=cn({modelValue:{type:at([Number,String,Array])},options:{type:at(Array),default:()=>[]},props:{type:at(Object),default:()=>({})}}),dJ={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:xr,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},hJ=e=>ee(()=>({...dJ,...e.props})),x3=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},fJ=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():UR(e)&&e.click()},pJ=(e,t)=>{const i=t.slice(0),a=i.map(g=>g.uid),d=e.reduce((g,_)=>{const o=a.indexOf(_.uid);return o>-1&&(g.push(_),i.splice(o,1),a.splice(o,1)),g},[]);return d.push(...i),d},mJ=qe({name:"ElCascaderPanel",components:{ElCascaderMenu:lJ},props:{...PO,border:{type:Boolean,default:!0},renderLabel:Function},emits:[xo,Wr,"close","expand-change"],setup(e,{emit:t,slots:i}){let a=!1;const d=Xt("cascader"),g=hJ(e);let _=null;const o=xe(!0),S=xe([]),E=xe(null),I=xe([]),R=xe(null),z=xe([]),N=ee(()=>g.value.expandTrigger==="hover"),$=ee(()=>e.renderLabel||i.default),F=()=>{const{options:_e}=e,Re=g.value;a=!1,_=new b3(_e,Re),I.value=[_.getNodes()],Re.lazy&&ha(e.options)?(o.value=!1,W(void 0,Qe=>{Qe&&(_=new b3(Qe,Re),I.value=[_.getNodes()]),o.value=!0,fe(!1,!0)})):fe(!1,!0)},W=(_e,Re)=>{const Qe=g.value;_e=_e||new B2({},Qe,void 0,!0),_e.loading=!0;const Ee=ye=>{const Me=_e,Te=Me.root?null:Me;ye&&(_==null||_.appendNodes(ye,Te)),Me.loading=!1,Me.loaded=!0,Me.childrenData=Me.childrenData||[],Re&&Re(ye)};Qe.lazyLoad(_e,Ee)},U=(_e,Re)=>{var Qe;const{level:Ee}=_e,ye=I.value.slice(0,Ee);let Me;_e.isLeaf?Me=_e.pathNodes[Ee-2]:(Me=_e,ye.push(_e.children)),((Qe=R.value)==null?void 0:Qe.uid)!==(Me==null?void 0:Me.uid)&&(R.value=_e,I.value=ye,!Re&&t("expand-change",(_e==null?void 0:_e.pathValues)||[]))},re=(_e,Re,Qe=!0)=>{const{checkStrictly:Ee,multiple:ye}=g.value,Me=z.value[0];a=!0,!ye&&(Me==null||Me.doCheck(!1)),_e.doCheck(Re),ae(),Qe&&!ye&&!Ee&&t("close"),!Qe&&!ye&&!Ee&&K(_e)},K=_e=>{_e&&(_e=_e.parent,K(_e),_e&&U(_e))},q=_e=>_==null?void 0:_.getFlattedNodes(_e),J=_e=>{var Re;return(Re=q(_e))==null?void 0:Re.filter(Qe=>Qe.checked!==!1)},oe=()=>{z.value.forEach(_e=>_e.doCheck(!1)),ae(),I.value=I.value.slice(0,1),R.value=null,t("expand-change",[])},ae=()=>{var _e;const{checkStrictly:Re,multiple:Qe}=g.value,Ee=z.value,ye=J(!Re),Me=pJ(Ee,ye),Te=Me.map(he=>he.valueByOption);z.value=Me,E.value=Qe?Te:(_e=Te[0])!=null?_e:null},fe=(_e=!1,Re=!1)=>{const{modelValue:Qe}=e,{lazy:Ee,multiple:ye,checkStrictly:Me}=g.value,Te=!Me;if(!(!o.value||a||!Re&&qi(Qe,E.value)))if(Ee&&!_e){const ke=xk(FH(zs(Qe))).map(Ne=>_==null?void 0:_.getNodeByValue(Ne)).filter(Ne=>!!Ne&&!Ne.loaded&&!Ne.loading);ke.length?ke.forEach(Ne=>{W(Ne,()=>fe(!1,Re))}):fe(!0,Re)}else{const he=ye?zs(Qe):[Qe],ke=xk(he.map(Ne=>_==null?void 0:_.getNodeByValue(Ne,Te)));ge(ke,Re),E.value=sb(Qe)}},ge=(_e,Re=!0)=>{const{checkStrictly:Qe}=g.value,Ee=z.value,ye=_e.filter(he=>!!he&&(Qe||he.isLeaf)),Me=_==null?void 0:_.getSameNode(R.value),Te=Re&&Me||ye[0];Te?Te.pathNodes.forEach(he=>U(he,!0)):R.value=null,Ee.forEach(he=>he.doCheck(!1)),dr(ye).forEach(he=>he.doCheck(!0)),z.value=ye,Un(ce)},ce=()=>{Wo&&S.value.forEach(_e=>{const Re=_e==null?void 0:_e.$el;if(Re){const Qe=Re.querySelector(`.${d.namespace.value}-scrollbar__wrap`),Ee=Re.querySelector(`.${d.b("node")}.${d.is("active")}`)||Re.querySelector(`.${d.b("node")}.in-active-path`);nT(Qe,Ee)}})},de=_e=>{const Re=_e.target,{code:Qe}=_e;switch(Qe){case Cn.up:case Cn.down:{_e.preventDefault();const Ee=Qe===Cn.up?-1:1;R0(jR(Re,Ee,`.${d.b("node")}[tabindex="-1"]`));break}case Cn.left:{_e.preventDefault();const Ee=S.value[x3(Re)-1],ye=Ee==null?void 0:Ee.$el.querySelector(`.${d.b("node")}[aria-expanded="true"]`);R0(ye);break}case Cn.right:{_e.preventDefault();const Ee=S.value[x3(Re)+1],ye=Ee==null?void 0:Ee.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`);R0(ye);break}case Cn.enter:case Cn.numpadEnter:fJ(Re);break}};return Bo(NT,dr({config:g,expandingNode:R,checkedNodes:z,isHoverMenu:N,initialLoaded:o,renderLabelFn:$,lazyLoad:W,expandNode:U,handleCheckChange:re})),qt([g,()=>e.options],F,{deep:!0,immediate:!0}),qt(()=>e.modelValue,()=>{a=!1,fe()},{deep:!0}),qt(()=>E.value,_e=>{qi(_e,e.modelValue)||(t(xo,_e),t(Wr,_e))}),nR(()=>S.value=[]),_o(()=>!ha(e.modelValue)&&fe()),{ns:d,menuList:S,menus:I,checkedNodes:z,handleKeyDown:de,handleCheckChange:re,getFlattedNodes:q,getCheckedNodes:J,clearCheckedNodes:oe,calculateCheckedValue:ae,scrollToExpandingNode:ce}}});function gJ(e,t,i,a,d,g){const _=Mo("el-cascader-menu");return se(),Ie("div",{class:ue([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(se(!0),Ie(Fn,null,Fo(e.menus,(o,S)=>(se(),Et(_,{key:S,ref_for:!0,ref:E=>e.menuList[S]=E,index:S,nodes:[...o]},{empty:it(()=>[vt(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var vJ=fn(mJ,[["render",gJ],["__file","index.vue"]]);const RO=uo(vJ),Ih=cn({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:ec},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),_J={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},yJ=qe({name:"ElTag"}),bJ=qe({...yJ,props:Ih,emits:_J,setup(e,{emit:t}){const i=e,a=Mi(),d=Xt("tag"),g=ee(()=>{const{type:E,hit:I,effect:R,closable:z,round:N}=i;return[d.b(),d.is("closable",z),d.m(E||"primary"),d.m(a.value),d.m(R),d.is("hit",I),d.is("round",N)]}),_=E=>{t("close",E)},o=E=>{t("click",E)},S=E=>{E.component.subTree.component.bum=null};return(E,I)=>E.disableTransitions?(se(),Ie("span",{key:0,class:ue(y(g)),style:$n({backgroundColor:E.color}),onClick:o},[je("span",{class:ue(y(d).e("content"))},[vt(E.$slots,"default")],2),E.closable?(se(),Et(y(Dn),{key:0,class:ue(y(d).e("close")),onClick:Xn(_,["stop"])},{default:it(()=>[Ye(y(yl))]),_:1},8,["class","onClick"])):yt("v-if",!0)],6)):(se(),Et(Ui,{key:1,name:`${y(d).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:S},{default:it(()=>[je("span",{class:ue(y(g)),style:$n({backgroundColor:E.color}),onClick:o},[je("span",{class:ue(y(d).e("content"))},[vt(E.$slots,"default")],2),E.closable?(se(),Et(y(Dn),{key:0,class:ue(y(d).e("close")),onClick:Xn(_,["stop"])},{default:it(()=>[Ye(y(yl))]),_:1},8,["class","onClick"])):yt("v-if",!0)],6)]),_:3},8,["name"]))}});var xJ=fn(bJ,[["__file","tag.vue"]]);const Nv=uo(xJ),wJ=cn({...PO,size:ki,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:at(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:at(Function),default:()=>!0},placement:{type:at(String),values:zc,default:"bottom-start"},fallbackPlacements:{type:at(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:Fi.teleported,tagType:{...Ih.type,default:"info"},tagEffect:{...Ih.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...Zp}),SJ={[xo]:e=>!0,[Wr]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>Lr(e),expandChange:e=>!!e,removeTag:e=>!!e},TJ="ElCascader",CJ=qe({name:TJ}),EJ=qe({...CJ,props:wJ,emits:SJ,setup(e,{expose:t,emit:i}){const a=e,d={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:dt})=>{const{modifiersData:tn,placement:Ze}=dt;["right","left","bottom","top"].includes(Ze)||(tn.arrow.x=35)},requires:["arrow"]}]},g=Ph();let _=0,o=0;const S=Xt("cascader"),E=Xt("input"),{t:I}=qo(),{form:R,formItem:z}=xs(),{valueOnClear:N}=t1(a),{isComposing:$,handleComposition:F}=e1({afterComposition(dt){var tn;const Ze=(tn=dt.target)==null?void 0:tn.value;Pt(Ze)}}),W=xe(null),U=xe(null),re=xe(null),K=xe(null),q=xe(null),J=xe(!1),oe=xe(!1),ae=xe(!1),fe=xe(!1),ge=xe(""),ce=xe(""),de=xe([]),_e=xe([]),Re=xe([]),Qe=ee(()=>g.style),Ee=ee(()=>a.disabled||(R==null?void 0:R.disabled)),ye=ee(()=>a.placeholder||I("el.cascader.placeholder")),Me=ee(()=>ce.value||de.value.length>0||$.value?"":ye.value),Te=Mi(),he=ee(()=>["small"].includes(Te.value)?"small":"default"),ke=ee(()=>!!a.props.multiple),Ne=ee(()=>!a.filterable||ke.value),nt=ee(()=>ke.value?ce.value:ge.value),De=ee(()=>{var dt;return((dt=K.value)==null?void 0:dt.checkedNodes)||[]}),Ct=ee(()=>!a.clearable||Ee.value||ae.value||!oe.value?!1:!!De.value.length),Rt=ee(()=>{const{showAllLevels:dt,separator:tn}=a,Ze=De.value;return Ze.length?ke.value?"":Ze[0].calcText(dt,tn):""}),Bt=ee(()=>(z==null?void 0:z.validateState)||""),mt=ee({get(){return sb(a.modelValue)},set(dt){const tn=dt??N.value;i(xo,tn),i(Wr,tn),a.validateEvent&&(z==null||z.validate("change").catch(Ze=>void 0))}}),Gt=ee(()=>[S.b(),S.m(Te.value),S.is("disabled",Ee.value),g.class]),jt=ee(()=>[E.e("icon"),"icon-arrow-down",S.is("reverse",J.value)]),Be=ee(()=>S.is("focus",J.value||fe.value)),an=ee(()=>{var dt,tn;return(tn=(dt=W.value)==null?void 0:dt.popperRef)==null?void 0:tn.contentRef}),At=dt=>{var tn,Ze,vn;Ee.value||(dt=dt??!J.value,dt!==J.value&&(J.value=dt,(Ze=(tn=U.value)==null?void 0:tn.input)==null||Ze.setAttribute("aria-expanded",`${dt}`),dt?(Ge(),Un((vn=K.value)==null?void 0:vn.scrollToExpandingNode)):a.filterable&&Sn(),i("visibleChange",dt)))},Ge=()=>{Un(()=>{var dt;(dt=W.value)==null||dt.updatePopper()})},Fe=()=>{ae.value=!1},Nt=dt=>{const{showAllLevels:tn,separator:Ze}=a;return{node:dt,key:dt.uid,text:dt.calcText(tn,Ze),hitState:!1,closable:!Ee.value&&!dt.isDisabled,isCollapseTag:!1}},Jt=dt=>{var tn;const Ze=dt.node;Ze.doCheck(!1),(tn=K.value)==null||tn.calculateCheckedValue(),i("removeTag",Ze.valueByOption)},Dt=()=>{if(!ke.value)return;const dt=De.value,tn=[],Ze=[];if(dt.forEach(vn=>Ze.push(Nt(vn))),_e.value=Ze,dt.length){dt.slice(0,a.maxCollapseTags).forEach(yo=>tn.push(Nt(yo)));const vn=dt.slice(a.maxCollapseTags),Mn=vn.length;Mn&&(a.collapseTags?tn.push({key:-1,text:`+ ${Mn}`,closable:!1,isCollapseTag:!0}):vn.forEach(yo=>tn.push(Nt(yo))))}de.value=tn},xt=()=>{var dt,tn;const{filterMethod:Ze,showAllLevels:vn,separator:Mn}=a,yo=(tn=(dt=K.value)==null?void 0:dt.getFlattedNodes(!a.props.checkStrictly))==null?void 0:tn.filter(gr=>gr.isDisabled?!1:(gr.calcText(vn,Mn),Ze(gr,nt.value)));ke.value&&(de.value.forEach(gr=>{gr.hitState=!1}),_e.value.forEach(gr=>{gr.hitState=!1})),ae.value=!0,Re.value=yo,Ge()},Ot=()=>{var dt;let tn;ae.value&&q.value?tn=q.value.$el.querySelector(`.${S.e("suggestion-item")}`):tn=(dt=K.value)==null?void 0:dt.$el.querySelector(`.${S.b("node")}[tabindex="-1"]`),tn&&(tn.focus(),!ae.value&&tn.click())},en=()=>{var dt,tn;const Ze=(dt=U.value)==null?void 0:dt.input,vn=re.value,Mn=(tn=q.value)==null?void 0:tn.$el;if(!(!Wo||!Ze)){if(Mn){const yo=Mn.querySelector(`.${S.e("suggestion-list")}`);yo.style.minWidth=`${Ze.offsetWidth}px`}if(vn){const{offsetHeight:yo}=vn,gr=de.value.length>0?`${Math.max(yo+6,_)}px`:`${_}px`;Ze.style.height=gr,Ge()}}},dn=dt=>{var tn;return(tn=K.value)==null?void 0:tn.getCheckedNodes(dt)},un=dt=>{Ge(),i("expandChange",dt)},Pn=dt=>{if(!$.value)switch(dt.code){case Cn.enter:case Cn.numpadEnter:At();break;case Cn.down:At(!0),Un(Ot),dt.preventDefault();break;case Cn.esc:J.value===!0&&(dt.preventDefault(),dt.stopPropagation(),At(!1));break;case Cn.tab:At(!1);break}},gt=()=>{var dt;(dt=K.value)==null||dt.clearCheckedNodes(),!J.value&&a.filterable&&Sn(),At(!1),i("clear")},Sn=()=>{const{value:dt}=Rt;ge.value=dt,ce.value=dt},Vn=dt=>{var tn,Ze;const{checked:vn}=dt;ke.value?(tn=K.value)==null||tn.handleCheckChange(dt,!vn,!1):(!vn&&((Ze=K.value)==null||Ze.handleCheckChange(dt,!0,!1)),At(!1))},lo=dt=>{const tn=dt.target,{code:Ze}=dt;switch(Ze){case Cn.up:case Cn.down:{const vn=Ze===Cn.up?-1:1;R0(jR(tn,vn,`.${S.e("suggestion-item")}[tabindex="-1"]`));break}case Cn.enter:case Cn.numpadEnter:tn.click();break}},eo=()=>{const dt=de.value,tn=dt[dt.length-1];o=ce.value?0:o+1,!(!tn||!o||a.collapseTags&&dt.length>1)&&(tn.hitState?Jt(tn):tn.hitState=!0)},fo=dt=>{const tn=dt.target,Ze=S.e("search-input");tn.className===Ze&&(fe.value=!0),i("focus",dt)},Lo=dt=>{fe.value=!1,i("blur",dt)},er=Qs(()=>{const{value:dt}=nt;if(!dt)return;const tn=a.beforeFilter(dt);bv(tn)?tn.then(xt).catch(()=>{}):tn!==!1?xt():Fe()},a.debounce),Pt=(dt,tn)=>{!J.value&&At(!0),!(tn!=null&&tn.isComposing)&&(dt?er():Fe())},_n=dt=>Number.parseFloat(h$(E.cssVarName("input-height"),dt).value)-2;return qt(ae,Ge),qt([De,Ee,()=>a.collapseTags],Dt),qt(de,()=>{Un(()=>en())}),qt(Te,async()=>{await Un();const dt=U.value.input;_=_n(dt)||_,en()}),qt(Rt,Sn,{immediate:!0}),_o(()=>{const dt=U.value.input,tn=_n(dt);_=dt.offsetHeight||tn,ei(dt,en)}),t({getCheckedNodes:dn,cascaderPanelRef:K,togglePopperVisible:At,contentRef:an,presentText:Rt}),(dt,tn)=>(se(),Et(y(rs),{ref_key:"tooltipRef",ref:W,visible:J.value,teleported:dt.teleported,"popper-class":[y(S).e("dropdown"),dt.popperClass],"popper-options":d,"fallback-placements":dt.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:dt.placement,transition:`${y(S).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:dt.persistent,onHide:Fe},{default:it(()=>[vo((se(),Ie("div",{class:ue(y(Gt)),style:$n(y(Qe)),onClick:()=>At(y(Ne)?void 0:!0),onKeydown:Pn,onMouseenter:Ze=>oe.value=!0,onMouseleave:Ze=>oe.value=!1},[Ye(y(_s),{ref_key:"input",ref:U,modelValue:ge.value,"onUpdate:modelValue":Ze=>ge.value=Ze,placeholder:y(Me),readonly:y(Ne),disabled:y(Ee),"validate-event":!1,size:y(Te),class:ue(y(Be)),tabindex:y(ke)&&dt.filterable&&!y(Ee)?-1:void 0,onCompositionstart:y(F),onCompositionupdate:y(F),onCompositionend:y(F),onFocus:fo,onBlur:Lo,onInput:Pt},{suffix:it(()=>[y(Ct)?(se(),Et(y(Dn),{key:"clear",class:ue([y(E).e("icon"),"icon-circle-close"]),onClick:Xn(gt,["stop"])},{default:it(()=>[Ye(y(ud))]),_:1},8,["class","onClick"])):(se(),Et(y(Dn),{key:"arrow-down",class:ue(y(jt)),onClick:Xn(Ze=>At(),["stop"])},{default:it(()=>[Ye(y(Oc))]),_:1},8,["class","onClick"]))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),y(ke)?(se(),Ie("div",{key:0,ref_key:"tagWrapper",ref:re,class:ue([y(S).e("tags"),y(S).is("validate",!!y(Bt))])},[(se(!0),Ie(Fn,null,Fo(de.value,Ze=>(se(),Et(y(Nv),{key:Ze.key,type:dt.tagType,size:y(he),effect:dt.tagEffect,hit:Ze.hitState,closable:Ze.closable,"disable-transitions":"",onClose:vn=>Jt(Ze)},{default:it(()=>[Ze.isCollapseTag===!1?(se(),Ie("span",{key:0},mn(Ze.text),1)):(se(),Et(y(rs),{key:1,disabled:J.value||!dt.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:it(()=>[je("span",null,mn(Ze.text),1)]),content:it(()=>[je("div",{class:ue(y(S).e("collapse-tags"))},[(se(!0),Ie(Fn,null,Fo(_e.value.slice(dt.maxCollapseTags),(vn,Mn)=>(se(),Ie("div",{key:Mn,class:ue(y(S).e("collapse-tag"))},[(se(),Et(y(Nv),{key:vn.key,class:"in-tooltip",type:dt.tagType,size:y(he),effect:dt.tagEffect,hit:vn.hitState,closable:vn.closable,"disable-transitions":"",onClose:yo=>Jt(vn)},{default:it(()=>[je("span",null,mn(vn.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),dt.filterable&&!y(Ee)?vo((se(),Ie("input",{key:0,"onUpdate:modelValue":Ze=>ce.value=Ze,type:"text",class:ue(y(S).e("search-input")),placeholder:y(Rt)?"":y(ye),onInput:Ze=>Pt(ce.value,Ze),onClick:Xn(Ze=>At(!0),["stop"]),onKeydown:kr(eo,["delete"]),onCompositionstart:y(F),onCompositionupdate:y(F),onCompositionend:y(F),onFocus:fo,onBlur:Lo},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[LS,ce.value]]):yt("v-if",!0)],2)):yt("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[y(kc),()=>At(!1),y(an)]])]),content:it(()=>[vo(Ye(y(RO),{ref_key:"cascaderPanelRef",ref:K,modelValue:y(mt),"onUpdate:modelValue":Ze=>Hr(mt)?mt.value=Ze:null,options:dt.options,props:a.props,border:!1,"render-label":dt.$slots.default,onExpandChange:un,onClose:Ze=>dt.$nextTick(()=>At(!1))},{empty:it(()=>[vt(dt.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[ir,!ae.value]]),dt.filterable?vo((se(),Et(y(nc),{key:0,ref_key:"suggestionPanel",ref:q,tag:"ul",class:ue(y(S).e("suggestion-panel")),"view-class":y(S).e("suggestion-list"),onKeydown:lo},{default:it(()=>[Re.value.length?(se(!0),Ie(Fn,{key:0},Fo(Re.value,Ze=>(se(),Ie("li",{key:Ze.uid,class:ue([y(S).e("suggestion-item"),y(S).is("checked",Ze.checked)]),tabindex:-1,onClick:vn=>Vn(Ze)},[je("span",null,mn(Ze.text),1),Ze.checked?(se(),Et(y(Dn),{key:0},{default:it(()=>[Ye(y(i_))]),_:1})):yt("v-if",!0)],10,["onClick"]))),128)):vt(dt.$slots,"empty",{key:1},()=>[je("li",{class:ue(y(S).e("empty-text"))},mn(y(I)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[ir,ae.value]]):yt("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var MJ=fn(EJ,[["__file","cascader.vue"]]);const IJ=uo(MJ),AJ=cn({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),kJ={"update:checked":e=>Lr(e),[Wr]:e=>Lr(e)},PJ=qe({name:"ElCheckTag"}),RJ=qe({...PJ,props:AJ,emits:kJ,setup(e,{emit:t}){const i=e,a=Xt("check-tag"),d=ee(()=>i.disabled),g=ee(()=>[a.b(),a.is("checked",i.checked),a.is("disabled",d.value),a.m(i.type||"primary")]),_=()=>{if(d.value)return;const o=!i.checked;t(Wr,o),t("update:checked",o)};return(o,S)=>(se(),Ie("span",{class:ue(y(g)),onClick:_},[vt(o.$slots,"default")],2))}});var DJ=fn(RJ,[["__file","check-tag.vue"]]);const LJ=uo(DJ),DO=Symbol("rowContextKey"),OJ=["start","center","end","space-around","space-between","space-evenly"],zJ=["top","middle","bottom"],BJ=cn({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:OJ,default:"start"},align:{type:String,values:zJ}}),FJ=qe({name:"ElRow"}),NJ=qe({...FJ,props:BJ,setup(e){const t=e,i=Xt("row"),a=ee(()=>t.gutter);Bo(DO,{gutter:a});const d=ee(()=>{const _={};return t.gutter&&(_.marginRight=_.marginLeft=`-${t.gutter/2}px`),_}),g=ee(()=>[i.b(),i.is(`justify-${t.justify}`,t.justify!=="start"),i.is(`align-${t.align}`,!!t.align)]);return(_,o)=>(se(),Et(ko(_.tag),{class:ue(y(g)),style:$n(y(d))},{default:it(()=>[vt(_.$slots,"default")]),_:3},8,["class","style"]))}});var $J=fn(NJ,[["__file","row.vue"]]);const VJ=uo($J),UJ=cn({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:at([Number,Object]),default:()=>oi({})},sm:{type:at([Number,Object]),default:()=>oi({})},md:{type:at([Number,Object]),default:()=>oi({})},lg:{type:at([Number,Object]),default:()=>oi({})},xl:{type:at([Number,Object]),default:()=>oi({})}}),jJ=qe({name:"ElCol"}),HJ=qe({...jJ,props:UJ,setup(e){const t=e,{gutter:i}=kn(DO,{gutter:ee(()=>0)}),a=Xt("col"),d=ee(()=>{const _={};return i.value&&(_.paddingLeft=_.paddingRight=`${i.value/2}px`),_}),g=ee(()=>{const _=[];return["span","offset","pull","push"].forEach(E=>{const I=t[E];Wn(I)&&(E==="span"?_.push(a.b(`${t[E]}`)):I>0&&_.push(a.b(`${E}-${t[E]}`)))}),["xs","sm","md","lg","xl"].forEach(E=>{Wn(t[E])?_.push(a.b(`${E}-${t[E]}`)):So(t[E])&&Object.entries(t[E]).forEach(([I,R])=>{_.push(I!=="span"?a.b(`${E}-${I}-${R}`):a.b(`${E}-${R}`))})}),i.value&&_.push(a.is("guttered")),[a.b(),_]});return(_,o)=>(se(),Et(ko(_.tag),{class:ue(y(g)),style:$n(y(d))},{default:it(()=>[vt(_.$slots,"default")]),_:3},8,["class","style"]))}});var GJ=fn(HJ,[["__file","col.vue"]]);const WJ=uo(GJ),w3=e=>Wn(e)||Bn(e)||sn(e),qJ=cn({accordion:Boolean,modelValue:{type:at([Array,String,Number]),default:()=>oi([])}}),KJ={[xo]:w3,[Wr]:w3},LO=Symbol("collapseContextKey"),ZJ=(e,t)=>{const i=xe(gs(e.modelValue)),a=g=>{i.value=g;const _=e.accordion?i.value[0]:i.value;t(xo,_),t(Wr,_)},d=g=>{if(e.accordion)a([i.value[0]===g?"":g]);else{const _=[...i.value],o=_.indexOf(g);o>-1?_.splice(o,1):_.push(g),a(_)}};return qt(()=>e.modelValue,()=>i.value=gs(e.modelValue),{deep:!0}),Bo(LO,{activeNames:i,handleItemClick:d}),{activeNames:i,setActiveNames:a}},YJ=()=>{const e=Xt("collapse");return{rootKls:ee(()=>e.b())}},XJ=qe({name:"ElCollapse"}),JJ=qe({...XJ,props:qJ,emits:KJ,setup(e,{expose:t,emit:i}){const a=e,{activeNames:d,setActiveNames:g}=ZJ(a,i),{rootKls:_}=YJ();return t({activeNames:d,setActiveNames:g}),(o,S)=>(se(),Ie("div",{class:ue(y(_))},[vt(o.$slots,"default")],2))}});var QJ=fn(JJ,[["__file","collapse.vue"]]);const eQ=qe({name:"ElCollapseTransition"}),tQ=qe({...eQ,setup(e){const t=Xt("collapse-transition"),i=d=>{d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom},a={beforeEnter(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.style.height&&(d.dataset.elExistsHeight=d.style.height),d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0},enter(d){requestAnimationFrame(()=>{d.dataset.oldOverflow=d.style.overflow,d.dataset.elExistsHeight?d.style.maxHeight=d.dataset.elExistsHeight:d.scrollHeight!==0?d.style.maxHeight=`${d.scrollHeight}px`:d.style.maxHeight=0,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom,d.style.overflow="hidden"})},afterEnter(d){d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow},enterCancelled(d){i(d)},beforeLeave(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.dataset.oldOverflow=d.style.overflow,d.style.maxHeight=`${d.scrollHeight}px`,d.style.overflow="hidden"},leave(d){d.scrollHeight!==0&&(d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0)},afterLeave(d){i(d)},leaveCancelled(d){i(d)}};return(d,g)=>(se(),Et(Ui,Po({name:y(t).b()},w5(a)),{default:it(()=>[vt(d.$slots,"default")]),_:3},16,["name"]))}});var nQ=fn(tQ,[["__file","collapse-transition.vue"]]);const s1=uo(nQ),oQ=cn({title:{type:String,default:""},name:{type:at([String,Number]),default:void 0},icon:{type:Cr,default:Fs},disabled:Boolean}),rQ=e=>{const t=kn(LO),{namespace:i}=Xt("collapse"),a=xe(!1),d=xe(!1),g=xT(),_=ee(()=>g.current++),o=ee(()=>{var z;return(z=e.name)!=null?z:`${i.value}-id-${g.prefix}-${y(_)}`}),S=ee(()=>t==null?void 0:t.activeNames.value.includes(y(o)));return{focusing:a,id:_,isActive:S,handleFocus:()=>{setTimeout(()=>{d.value?d.value=!1:a.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(y(o)),a.value=!1,d.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(y(o))}}},iQ=(e,{focusing:t,isActive:i,id:a})=>{const d=Xt("collapse"),g=ee(()=>[d.b("item"),d.is("active",y(i)),d.is("disabled",e.disabled)]),_=ee(()=>[d.be("item","header"),d.is("active",y(i)),{focusing:y(t)&&!e.disabled}]),o=ee(()=>[d.be("item","arrow"),d.is("active",y(i))]),S=ee(()=>d.be("item","wrap")),E=ee(()=>d.be("item","content")),I=ee(()=>d.b(`content-${y(a)}`)),R=ee(()=>d.b(`head-${y(a)}`));return{arrowKls:o,headKls:_,rootKls:g,itemWrapperKls:S,itemContentKls:E,scopedContentId:I,scopedHeadId:R}},sQ=qe({name:"ElCollapseItem"}),aQ=qe({...sQ,props:oQ,setup(e,{expose:t}){const i=e,{focusing:a,id:d,isActive:g,handleFocus:_,handleHeaderClick:o,handleEnterClick:S}=rQ(i),{arrowKls:E,headKls:I,rootKls:R,itemWrapperKls:z,itemContentKls:N,scopedContentId:$,scopedHeadId:F}=iQ(i,{focusing:a,isActive:g,id:d});return t({isActive:g}),(W,U)=>(se(),Ie("div",{class:ue(y(R))},[je("button",{id:y(F),class:ue(y(I)),"aria-expanded":y(g),"aria-controls":y($),"aria-describedby":y($),tabindex:W.disabled?-1:0,type:"button",onClick:y(o),onKeydown:kr(Xn(y(S),["stop","prevent"]),["space","enter"]),onFocus:y(_),onBlur:re=>a.value=!1},[vt(W.$slots,"title",{},()=>[$o(mn(W.title),1)]),vt(W.$slots,"icon",{isActive:y(g)},()=>[Ye(y(Dn),{class:ue(y(E))},{default:it(()=>[(se(),Et(ko(W.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),Ye(y(s1),null,{default:it(()=>[vo(je("div",{id:y($),role:"region",class:ue(y(z)),"aria-hidden":!y(g),"aria-labelledby":y(F)},[je("div",{class:ue(y(N))},[vt(W.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[ir,y(g)]])]),_:3})],2))}});var OO=fn(aQ,[["__file","collapse-item.vue"]]);const lQ=uo(QJ,{CollapseItem:OO}),cQ=ri(OO),uQ=cn({color:{type:at(Object),required:!0},vertical:{type:Boolean,default:!1}});let Iw=!1;function $v(e,t){if(!Wo)return;const i=function(g){var _;(_=t.drag)==null||_.call(t,g)},a=function(g){var _;document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",a),document.onselectstart=null,document.ondragstart=null,Iw=!1,(_=t.end)==null||_.call(t,g)},d=function(g){var _;Iw||(g.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",i),document.addEventListener("mouseup",a),document.addEventListener("touchmove",i),document.addEventListener("touchend",a),Iw=!0,(_=t.start)==null||_.call(t,g))};e.addEventListener("mousedown",d),e.addEventListener("touchstart",d,{passive:!1})}const dQ=e=>{const t=To(),{t:i}=qo(),a=qr(),d=qr(),g=ee(()=>e.color.get("alpha")),_=ee(()=>i("el.colorpicker.alphaLabel"));function o(R){var z;R.target!==a.value&&S(R),(z=a.value)==null||z.focus()}function S(R){if(!d.value||!a.value)return;const N=t.vnode.el.getBoundingClientRect(),{clientX:$,clientY:F}=FS(R);if(e.vertical){let W=F-N.top;W=Math.max(a.value.offsetHeight/2,W),W=Math.min(W,N.height-a.value.offsetHeight/2),e.color.set("alpha",Math.round((W-a.value.offsetHeight/2)/(N.height-a.value.offsetHeight)*100))}else{let W=$-N.left;W=Math.max(a.value.offsetWidth/2,W),W=Math.min(W,N.width-a.value.offsetWidth/2),e.color.set("alpha",Math.round((W-a.value.offsetWidth/2)/(N.width-a.value.offsetWidth)*100))}}function E(R){const{code:z,shiftKey:N}=R,$=N?10:1;switch(z){case Cn.left:case Cn.down:R.preventDefault(),R.stopPropagation(),I(-$);break;case Cn.right:case Cn.up:R.preventDefault(),R.stopPropagation(),I($);break}}function I(R){let z=g.value+R;z=z<0?0:z>100?100:z,e.color.set("alpha",z)}return{thumb:a,bar:d,alpha:g,alphaLabel:_,handleDrag:S,handleClick:o,handleKeydown:E}},hQ=(e,{bar:t,thumb:i,handleDrag:a})=>{const d=To(),g=Xt("color-alpha-slider"),_=xe(0),o=xe(0),S=xe();function E(){if(!i.value||e.vertical)return 0;const re=d.vnode.el,K=e.color.get("alpha");return re?Math.round(K*(re.offsetWidth-i.value.offsetWidth/2)/100):0}function I(){if(!i.value)return 0;const re=d.vnode.el;if(!e.vertical)return 0;const K=e.color.get("alpha");return re?Math.round(K*(re.offsetHeight-i.value.offsetHeight/2)/100):0}function R(){if(e.color&&e.color.value){const{r:re,g:K,b:q}=e.color.toRgb();return`linear-gradient(to right, rgba(${re}, ${K}, ${q}, 0) 0%, rgba(${re}, ${K}, ${q}, 1) 100%)`}return""}function z(){_.value=E(),o.value=I(),S.value=R()}_o(()=>{if(!t.value||!i.value)return;const re={drag:K=>{a(K)},end:K=>{a(K)}};$v(t.value,re),$v(i.value,re),z()}),qt(()=>e.color.get("alpha"),()=>z()),qt(()=>e.color.value,()=>z());const N=ee(()=>[g.b(),g.is("vertical",e.vertical)]),$=ee(()=>g.e("bar")),F=ee(()=>g.e("thumb")),W=ee(()=>({background:S.value})),U=ee(()=>({left:fi(_.value),top:fi(o.value)}));return{rootKls:N,barKls:$,barStyle:W,thumbKls:F,thumbStyle:U,update:z}},fQ="ElColorAlphaSlider",pQ=qe({name:fQ}),mQ=qe({...pQ,props:uQ,setup(e,{expose:t}){const i=e,{alpha:a,alphaLabel:d,bar:g,thumb:_,handleDrag:o,handleClick:S,handleKeydown:E}=dQ(i),{rootKls:I,barKls:R,barStyle:z,thumbKls:N,thumbStyle:$,update:F}=hQ(i,{bar:g,thumb:_,handleDrag:o});return t({update:F,bar:g,thumb:_}),(W,U)=>(se(),Ie("div",{class:ue(y(I))},[je("div",{ref_key:"bar",ref:g,class:ue(y(R)),style:$n(y(z)),onClick:y(S)},null,14,["onClick"]),je("div",{ref_key:"thumb",ref:_,class:ue(y(N)),style:$n(y($)),"aria-label":y(d),"aria-valuenow":y(a),"aria-orientation":W.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:y(E)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var gQ=fn(mQ,[["__file","alpha-slider.vue"]]);const vQ=qe({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=Xt("color-hue-slider"),i=To(),a=xe(),d=xe(),g=xe(0),_=xe(0),o=ee(()=>e.color.get("hue"));qt(()=>o.value,()=>{z()});function S(N){N.target!==a.value&&E(N)}function E(N){if(!d.value||!a.value)return;const F=i.vnode.el.getBoundingClientRect(),{clientX:W,clientY:U}=FS(N);let re;if(e.vertical){let K=U-F.top;K=Math.min(K,F.height-a.value.offsetHeight/2),K=Math.max(a.value.offsetHeight/2,K),re=Math.round((K-a.value.offsetHeight/2)/(F.height-a.value.offsetHeight)*360)}else{let K=W-F.left;K=Math.min(K,F.width-a.value.offsetWidth/2),K=Math.max(a.value.offsetWidth/2,K),re=Math.round((K-a.value.offsetWidth/2)/(F.width-a.value.offsetWidth)*360)}e.color.set("hue",re)}function I(){if(!a.value)return 0;const N=i.vnode.el;if(e.vertical)return 0;const $=e.color.get("hue");return N?Math.round($*(N.offsetWidth-a.value.offsetWidth/2)/360):0}function R(){if(!a.value)return 0;const N=i.vnode.el;if(!e.vertical)return 0;const $=e.color.get("hue");return N?Math.round($*(N.offsetHeight-a.value.offsetHeight/2)/360):0}function z(){g.value=I(),_.value=R()}return _o(()=>{if(!d.value||!a.value)return;const N={drag:$=>{E($)},end:$=>{E($)}};$v(d.value,N),$v(a.value,N),z()}),{bar:d,thumb:a,thumbLeft:g,thumbTop:_,hueValue:o,handleClick:S,update:z,ns:t}}});function _Q(e,t,i,a,d,g){return se(),Ie("div",{class:ue([e.ns.b(),e.ns.is("vertical",e.vertical)])},[je("div",{ref:"bar",class:ue(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),je("div",{ref:"thumb",class:ue(e.ns.e("thumb")),style:$n({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var yQ=fn(vQ,[["render",_Q],["__file","hue-slider.vue"]]);const bQ=cn({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:ki,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:Fi.teleported,predefine:{type:at(Array)},validateEvent:{type:Boolean,default:!0},...Zi(["ariaLabel"])}),xQ={[xo]:e=>Bn(e)||Pi(e),[Wr]:e=>Bn(e)||Pi(e),activeChange:e=>Bn(e)||Pi(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},zO=Symbol("colorPickerContextKey"),S3=function(e,t,i){return[e,t*i/((e=(2-t)*i)<1?e:2-e)||0,e/2]},wQ=function(e){return Bn(e)&&e.includes(".")&&Number.parseFloat(e)===1},SQ=function(e){return Bn(e)&&e.includes("%")},yp=function(e,t){wQ(e)&&(e="100%");const i=SQ(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),i&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},T3={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},N0=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),i=e%16;return`${T3[t]||t}${T3[i]||i}`},C3=function({r:e,g:t,b:i}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+i)?"":`#${N0(e)}${N0(t)}${N0(i)}`},Aw={A:10,B:11,C:12,D:13,E:14,F:15},rh=function(e){return e.length===2?(Aw[e[0].toUpperCase()]||+e[0])*16+(Aw[e[1].toUpperCase()]||+e[1]):Aw[e[1].toUpperCase()]||+e[1]},TQ=function(e,t,i){t=t/100,i=i/100;let a=t;const d=Math.max(i,.01);i*=2,t*=i<=1?i:2-i,a*=d<=1?d:2-d;const g=(i+t)/2,_=i===0?2*a/(d+a):2*t/(i+t);return{h:e,s:_*100,v:g*100}},E3=(e,t,i)=>{e=yp(e,255),t=yp(t,255),i=yp(i,255);const a=Math.max(e,t,i),d=Math.min(e,t,i);let g;const _=a,o=a-d,S=a===0?0:o/a;if(a===d)g=0;else{switch(a){case e:{g=(t-i)/o+(t<i?6:0);break}case t:{g=(i-e)/o+2;break}case i:{g=(e-t)/o+4;break}}g/=6}return{h:g*360,s:S*100,v:_*100}},Qg=function(e,t,i){e=yp(e,360)*6,t=yp(t,100),i=yp(i,100);const a=Math.floor(e),d=e-a,g=i*(1-t),_=i*(1-d*t),o=i*(1-(1-d)*t),S=a%6,E=[i,_,g,g,o,i][S],I=[o,i,i,_,g,g][S],R=[g,g,o,i,i,_][S];return{r:Math.round(E*255),g:Math.round(I*255),b:Math.round(R*255)}};class _v{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const i in t)or(t,i)&&(this[i]=t[i]);t.value?this.fromString(t.value):this.doOnChange()}set(t,i){if(arguments.length===1&&typeof t=="object"){for(const a in t)or(t,a)&&this.set(a,t[a]);return}this[`_${t}`]=i,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return Qg(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const i=(a,d,g)=>{this._hue=Math.max(0,Math.min(360,a)),this._saturation=Math.max(0,Math.min(100,d)),this._value=Math.max(0,Math.min(100,g)),this.doOnChange()};if(t.includes("hsl")){const a=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,g)=>g>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:g,v:_}=TQ(a[0],a[1],a[2]);i(d,g,_)}}else if(t.includes("hsv")){const a=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,g)=>g>2?Number.parseFloat(d):Number.parseInt(d,10));a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3&&i(a[0],a[1],a[2])}else if(t.includes("rgb")){const a=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,g)=>g>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:g,v:_}=E3(a[0],a[1],a[2]);i(d,g,_)}}else if(t.includes("#")){const a=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(a))return;let d,g,_;a.length===3?(d=rh(a[0]+a[0]),g=rh(a[1]+a[1]),_=rh(a[2]+a[2])):(a.length===6||a.length===8)&&(d=rh(a.slice(0,2)),g=rh(a.slice(2,4)),_=rh(a.slice(4,6))),a.length===8?this._alpha=rh(a.slice(6))/255*100:(a.length===3||a.length===6)&&(this._alpha=100);const{h:o,s:S,v:E}=E3(d,g,_);i(o,S,E)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:i,_value:a,_alpha:d,format:g}=this;if(this.enableAlpha)switch(g){case"hsl":{const _=S3(t,i/100,a/100);this.value=`hsla(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(i)}%, ${Math.round(a)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${C3(Qg(t,i,a))}${N0(d*255/100)}`;break}default:{const{r:_,g:o,b:S}=Qg(t,i,a);this.value=`rgba(${_}, ${o}, ${S}, ${this.get("alpha")/100})`}}else switch(g){case"hsl":{const _=S3(t,i/100,a/100);this.value=`hsl(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(i)}%, ${Math.round(a)}%)`;break}case"rgb":{const{r:_,g:o,b:S}=Qg(t,i,a);this.value=`rgb(${_}, ${o}, ${S})`;break}default:this.value=C3(Qg(t,i,a))}}}const CQ=qe({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=Xt("color-predefine"),{currentColor:i}=kn(zO),a=xe(g(e.colors,e.color));qt(()=>i.value,_=>{const o=new _v;o.fromString(_),a.value.forEach(S=>{S.selected=o.compare(S)})}),ns(()=>{a.value=g(e.colors,e.color)});function d(_){e.color.fromString(e.colors[_])}function g(_,o){return _.map(S=>{const E=new _v;return E.enableAlpha=e.enableAlpha,E.format="rgba",E.fromString(S),E.selected=E.value===o.value,E})}return{rgbaColors:a,handleSelect:d,ns:t}}});function EQ(e,t,i,a,d,g){return se(),Ie("div",{class:ue(e.ns.b())},[je("div",{class:ue(e.ns.e("colors"))},[(se(!0),Ie(Fn,null,Fo(e.rgbaColors,(_,o)=>(se(),Ie("div",{key:e.colors[o],class:ue([e.ns.e("color-selector"),e.ns.is("alpha",_._alpha<100),{selected:_.selected}]),onClick:S=>e.handleSelect(o)},[je("div",{style:$n({backgroundColor:_.value})},null,4)],10,["onClick"]))),128))],2)],2)}var MQ=fn(CQ,[["render",EQ],["__file","predefine.vue"]]);const IQ=qe({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=Xt("color-svpanel"),i=To(),a=xe(0),d=xe(0),g=xe("hsl(0, 100%, 50%)"),_=ee(()=>{const E=e.color.get("hue"),I=e.color.get("value");return{hue:E,value:I}});function o(){const E=e.color.get("saturation"),I=e.color.get("value"),R=i.vnode.el,{clientWidth:z,clientHeight:N}=R;d.value=E*z/100,a.value=(100-I)*N/100,g.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function S(E){const R=i.vnode.el.getBoundingClientRect(),{clientX:z,clientY:N}=FS(E);let $=z-R.left,F=N-R.top;$=Math.max(0,$),$=Math.min($,R.width),F=Math.max(0,F),F=Math.min(F,R.height),d.value=$,a.value=F,e.color.set({saturation:$/R.width*100,value:100-F/R.height*100})}return qt(()=>_.value,()=>{o()}),_o(()=>{$v(i.vnode.el,{drag:E=>{S(E)},end:E=>{S(E)}}),o()}),{cursorTop:a,cursorLeft:d,background:g,colorValue:_,handleDrag:S,update:o,ns:t}}});function AQ(e,t,i,a,d,g){return se(),Ie("div",{class:ue(e.ns.b()),style:$n({backgroundColor:e.background})},[je("div",{class:ue(e.ns.e("white"))},null,2),je("div",{class:ue(e.ns.e("black"))},null,2),je("div",{class:ue(e.ns.e("cursor")),style:$n({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[je("div")],6)],6)}var kQ=fn(IQ,[["render",AQ],["__file","sv-panel.vue"]]);const PQ=qe({name:"ElColorPicker"}),RQ=qe({...PQ,props:bQ,emits:xQ,setup(e,{expose:t,emit:i}){const a=e,{t:d}=qo(),g=Xt("color"),{formItem:_}=xs(),o=Mi(),S=bs(),{inputId:E,isLabeledByFormItem:I}=Cl(a,{formItemContext:_}),R=xe(),z=xe(),N=xe(),$=xe(),F=xe(),W=xe(),{isFocused:U,handleFocus:re,handleBlur:K}=Oh(F,{beforeFocus(){return S.value},beforeBlur(jt){var Be;return(Be=$.value)==null?void 0:Be.isFocusInsideContent(jt)},afterBlur(){Ee(!1),he()}});let q=!0;const J=dr(new _v({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue})),oe=xe(!1),ae=xe(!1),fe=xe(""),ge=ee(()=>!a.modelValue&&!ae.value?"transparent":Qe(J,a.showAlpha)),ce=ee(()=>!a.modelValue&&!ae.value?"":J.value),de=ee(()=>I.value?void 0:a.ariaLabel||d("el.colorpicker.defaultLabel")),_e=ee(()=>I.value?_==null?void 0:_.labelId:void 0),Re=ee(()=>[g.b("picker"),g.is("disabled",S.value),g.bm("picker",o.value),g.is("focused",U.value)]);function Qe(jt,Be){if(!(jt instanceof _v))throw new TypeError("color should be instance of _color Class");const{r:an,g:At,b:Ge}=jt.toRgb();return Be?`rgba(${an}, ${At}, ${Ge}, ${jt.get("alpha")/100})`:`rgb(${an}, ${At}, ${Ge})`}function Ee(jt){oe.value=jt}const ye=Qs(Ee,100,{leading:!0});function Me(){S.value||Ee(!0)}function Te(){ye(!1),he()}function he(){Un(()=>{a.modelValue?J.fromString(a.modelValue):(J.value="",Un(()=>{ae.value=!1}))})}function ke(){S.value||ye(!oe.value)}function Ne(){J.fromString(fe.value)}function nt(){const jt=J.value;i(xo,jt),i("change",jt),a.validateEvent&&(_==null||_.validate("change").catch(Be=>void 0)),ye(!1),Un(()=>{const Be=new _v({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue});J.compare(Be)||he()})}function De(){ye(!1),i(xo,null),i("change",null),a.modelValue!==null&&a.validateEvent&&(_==null||_.validate("change").catch(jt=>void 0)),he()}function Ct(){oe.value&&(Te(),U.value&&mt())}function Rt(jt){jt.preventDefault(),jt.stopPropagation(),Ee(!1),he()}function Bt(jt){switch(jt.code){case Cn.enter:case Cn.numpadEnter:case Cn.space:jt.preventDefault(),jt.stopPropagation(),Me(),W.value.focus();break;case Cn.esc:Rt(jt);break}}function mt(){F.value.focus()}function Gt(){F.value.blur()}return _o(()=>{a.modelValue&&(fe.value=ce.value)}),qt(()=>a.modelValue,jt=>{jt?jt&&jt!==J.value&&(q=!1,J.fromString(jt)):ae.value=!1}),qt(()=>[a.colorFormat,a.showAlpha],()=>{J.enableAlpha=a.showAlpha,J.format=a.colorFormat||J.format,J.doOnChange(),i(xo,J.value)}),qt(()=>ce.value,jt=>{fe.value=jt,q&&i("activeChange",jt),q=!0}),qt(()=>J.value,()=>{!a.modelValue&&!ae.value&&(ae.value=!0)}),qt(()=>oe.value,()=>{Un(()=>{var jt,Be,an;(jt=R.value)==null||jt.update(),(Be=z.value)==null||Be.update(),(an=N.value)==null||an.update()})}),Bo(zO,{currentColor:ce}),t({color:J,show:Me,hide:Te,focus:mt,blur:Gt}),(jt,Be)=>(se(),Et(y(rs),{ref_key:"popper",ref:$,visible:oe.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[y(g).be("picker","panel"),y(g).b("dropdown"),jt.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:jt.teleported,transition:`${y(g).namespace.value}-zoom-in-top`,persistent:"",onHide:an=>Ee(!1)},{content:it(()=>[vo((se(),Ie("div",{onKeydown:kr(Rt,["esc"])},[je("div",{class:ue(y(g).be("dropdown","main-wrapper"))},[Ye(yQ,{ref_key:"hue",ref:R,class:"hue-slider",color:y(J),vertical:""},null,8,["color"]),Ye(kQ,{ref_key:"sv",ref:z,color:y(J)},null,8,["color"])],2),jt.showAlpha?(se(),Et(gQ,{key:0,ref_key:"alpha",ref:N,color:y(J)},null,8,["color"])):yt("v-if",!0),jt.predefine?(se(),Et(MQ,{key:1,ref:"predefine","enable-alpha":jt.showAlpha,color:y(J),colors:jt.predefine},null,8,["enable-alpha","color","colors"])):yt("v-if",!0),je("div",{class:ue(y(g).be("dropdown","btns"))},[je("span",{class:ue(y(g).be("dropdown","value"))},[Ye(y(_s),{ref_key:"inputRef",ref:W,modelValue:fe.value,"onUpdate:modelValue":an=>fe.value=an,"validate-event":!1,size:"small",onKeyup:kr(Ne,["enter"]),onBlur:Ne},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),Ye(y($i),{class:ue(y(g).be("dropdown","link-btn")),text:"",size:"small",onClick:De},{default:it(()=>[$o(mn(y(d)("el.colorpicker.clear")),1)]),_:1},8,["class"]),Ye(y($i),{plain:"",size:"small",class:ue(y(g).be("dropdown","btn")),onClick:nt},{default:it(()=>[$o(mn(y(d)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[y(kc),Ct]])]),default:it(()=>[je("div",Po({id:y(E),ref_key:"triggerRef",ref:F},jt.$attrs,{class:y(Re),role:"button","aria-label":y(de),"aria-labelledby":y(_e),"aria-description":y(d)("el.colorpicker.description",{color:jt.modelValue||""}),"aria-disabled":y(S),tabindex:y(S)?-1:jt.tabindex,onKeydown:Bt,onFocus:y(re),onBlur:y(K)}),[y(S)?(se(),Ie("div",{key:0,class:ue(y(g).be("picker","mask"))},null,2)):yt("v-if",!0),je("div",{class:ue(y(g).be("picker","trigger")),onClick:ke},[je("span",{class:ue([y(g).be("picker","color"),y(g).is("alpha",jt.showAlpha)])},[je("span",{class:ue(y(g).be("picker","color-inner")),style:$n({backgroundColor:y(ge)})},[vo(Ye(y(Dn),{class:ue([y(g).be("picker","icon"),y(g).is("icon-arrow-down")])},{default:it(()=>[Ye(y(Oc))]),_:1},8,["class"]),[[ir,jt.modelValue||ae.value]]),vo(Ye(y(Dn),{class:ue([y(g).be("picker","empty"),y(g).is("icon-close")])},{default:it(()=>[Ye(y(yl))]),_:1},8,["class"]),[[ir,!jt.modelValue&&!ae.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var DQ=fn(RQ,[["__file","color-picker.vue"]]);const LQ=uo(DQ),OQ=qe({name:"ElContainer"}),zQ=qe({...OQ,props:{direction:{type:String}},setup(e){const t=e,i=Ri(),a=Xt("container"),d=ee(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:i&&i.default?i.default().some(_=>{const o=_.type.name;return o==="ElHeader"||o==="ElFooter"}):!1);return(g,_)=>(se(),Ie("section",{class:ue([y(a).b(),y(a).is("vertical",y(d))])},[vt(g.$slots,"default")],2))}});var BQ=fn(zQ,[["__file","container.vue"]]);const FQ=qe({name:"ElAside"}),NQ=qe({...FQ,props:{width:{type:String,default:null}},setup(e){const t=e,i=Xt("aside"),a=ee(()=>t.width?i.cssVarBlock({width:t.width}):{});return(d,g)=>(se(),Ie("aside",{class:ue(y(i).b()),style:$n(y(a))},[vt(d.$slots,"default")],6))}});var BO=fn(NQ,[["__file","aside.vue"]]);const $Q=qe({name:"ElFooter"}),VQ=qe({...$Q,props:{height:{type:String,default:null}},setup(e){const t=e,i=Xt("footer"),a=ee(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,g)=>(se(),Ie("footer",{class:ue(y(i).b()),style:$n(y(a))},[vt(d.$slots,"default")],6))}});var FO=fn(VQ,[["__file","footer.vue"]]);const UQ=qe({name:"ElHeader"}),jQ=qe({...UQ,props:{height:{type:String,default:null}},setup(e){const t=e,i=Xt("header"),a=ee(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,g)=>(se(),Ie("header",{class:ue(y(i).b()),style:$n(y(a))},[vt(d.$slots,"default")],6))}});var NO=fn(jQ,[["__file","header.vue"]]);const HQ=qe({name:"ElMain"}),GQ=qe({...HQ,setup(e){const t=Xt("main");return(i,a)=>(se(),Ie("main",{class:ue(y(t).b())},[vt(i.$slots,"default")],2))}});var $O=fn(GQ,[["__file","main.vue"]]);const WQ=uo(BQ,{Aside:BO,Footer:FO,Header:NO,Main:$O}),qQ=ri(BO),KQ=ri(FO),ZQ=ri(NO),YQ=ri($O);var VO={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){return function(i,a){var d=a.prototype,g=d.format;d.format=function(_){var o=this,S=this.$locale();if(!this.isValid())return g.bind(this)(_);var E=this.$utils(),I=(_||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(R){switch(R){case"Q":return Math.ceil((o.$M+1)/3);case"Do":return S.ordinal(o.$D);case"gggg":return o.weekYear();case"GGGG":return o.isoWeekYear();case"wo":return S.ordinal(o.week(),"W");case"w":case"ww":return E.s(o.week(),R==="w"?1:2,"0");case"W":case"WW":return E.s(o.isoWeek(),R==="W"?1:2,"0");case"k":case"kk":return E.s(String(o.$H===0?24:o.$H),R==="k"?1:2,"0");case"X":return Math.floor(o.$d.getTime()/1e3);case"x":return o.$d.getTime();case"z":return"["+o.offsetName()+"]";case"zzz":return"["+o.offsetName("long")+"]";default:return R}});return g.bind(this)(I)}}})})(VO);var XQ=VO.exports;const JQ=Ql(XQ);var UO={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){var i="week",a="year";return function(d,g,_){var o=g.prototype;o.week=function(S){if(S===void 0&&(S=null),S!==null)return this.add(7*(S-this.week()),"day");var E=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var I=_(this).startOf(a).add(1,a).date(E),R=_(this).endOf(i);if(I.isBefore(R))return 1}var z=_(this).startOf(a).date(E).startOf(i).subtract(1,"millisecond"),N=this.diff(z,i,!0);return N<0?_(this).startOf("week").week():Math.ceil(N)},o.weeks=function(S){return S===void 0&&(S=null),this.week(S)}}})})(UO);var QQ=UO.exports;const eee=Ql(QQ);var jO={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){return function(i,a){a.prototype.weekYear=function(){var d=this.month(),g=this.week(),_=this.year();return g===1&&d===11?_+1:d===0&&g>=52?_-1:_}}})})(jO);var tee=jO.exports;const nee=Ql(tee);var HO={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){return function(i,a,d){a.prototype.dayOfYear=function(g){var _=Math.round((d(this).startOf("day")-d(this).startOf("year"))/864e5)+1;return g==null?_:this.add(g-_,"day")}}})})(HO);var oee=HO.exports;const ree=Ql(oee);var GO={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){return function(i,a){a.prototype.isSameOrAfter=function(d,g){return this.isSame(d,g)||this.isAfter(d,g)}}})})(GO);var iee=GO.exports;const see=Ql(iee);var WO={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Jl,function(){return function(i,a){a.prototype.isSameOrBefore=function(d,g){return this.isSame(d,g)||this.isBefore(d,g)}}})})(WO);var aee=WO.exports;const lee=Ql(aee),a1=Symbol(),cee=cn({...FT,type:{type:at(String),default:"date"}}),uee=["date","dates","year","years","month","months","week","range"],$T=cn({disabledDate:{type:at(Function)},date:{type:at(Object),required:!0},minDate:{type:at(Object)},maxDate:{type:at(Object)},parsedValue:{type:at([Object,Array])},rangeState:{type:at(Object),default:()=>({endDate:null,selecting:!1})}}),qO=cn({type:{type:at(String),required:!0,values:gW},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),VT=cn({unlinkPanels:Boolean,parsedValue:{type:at(Array)}}),UT=e=>({type:String,values:uee,default:e}),dee=cn({...qO,parsedValue:{type:at([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),zp=e=>{if(!sn(e))return!1;const[t,i]=e;return so.isDayjs(t)&&so.isDayjs(i)&&t.isSameOrBefore(i)},jT=(e,{lang:t,unit:i,unlinkPanels:a})=>{let d;if(sn(e)){let[g,_]=e.map(o=>so(o).locale(t));return a||(_=g.add(1,i)),[g,_]}else e?d=so(e):d=so();return d=d.locale(t),[d,d.add(1,i)]},hee=(e,t,{columnIndexOffset:i,startDate:a,nextEndDate:d,now:g,unit:_,relativeDateGetter:o,setCellMetadata:S,setRowMetadata:E})=>{for(let I=0;I<e.row;I++){const R=t[I];for(let z=0;z<e.column;z++){let N=R[z+i];N||(N={row:I,column:z,type:"normal",inRange:!1,start:!1,end:!1});const $=I*e.column+z,F=o($);N.dayjs=F,N.date=F.toDate(),N.timestamp=F.valueOf(),N.type="normal",N.inRange=!!(a&&F.isSameOrAfter(a,_)&&d&&F.isSameOrBefore(d,_))||!!(a&&F.isSameOrBefore(a,_)&&d&&F.isSameOrAfter(d,_)),a!=null&&a.isSameOrAfter(d)?(N.start=!!d&&F.isSame(d,_),N.end=a&&F.isSame(a,_)):(N.start=!!a&&F.isSame(a,_),N.end=!!d&&F.isSame(d,_)),F.isSame(g,_)&&(N.type="today"),S==null||S(N,{rowIndex:I,columnIndex:z}),R[z+i]=N}E==null||E(R)}},pb=(e,t,i)=>{const a=so().locale(i).startOf("month").month(t).year(e),d=a.daysInMonth();return Zu(d).map(g=>a.add(g,"day").toDate())},Vv=(e,t,i,a)=>{const d=so().year(e).month(t).startOf("month"),g=pb(e,t,i).find(_=>!(a!=null&&a(_)));return g?so(g).locale(i):d.locale(i)},$2=(e,t,i)=>{const a=e.year();if(!(i!=null&&i(e.toDate())))return e.locale(t);const d=e.month();if(!pb(a,d,t).every(i))return Vv(a,d,t,i);for(let g=0;g<12;g++)if(!pb(a,g,t).every(i))return Vv(a,g,t,i);return e},fee=cn({...$T,cellClassName:{type:at(Function)},showWeekNumber:Boolean,selectionMode:UT("date")}),pee=["changerange","pick","select"],V2=(e="")=>["normal","today"].includes(e),mee=(e,t)=>{const{lang:i}=qo(),a=xe(),d=xe(),g=xe(),_=xe(),o=xe([[],[],[],[],[],[]]);let S=!1;const E=e.date.$locale().weekStart||7,I=e.date.locale("en").localeData().weekdaysShort().map(he=>he.toLowerCase()),R=ee(()=>E>3?7-E:-E),z=ee(()=>{const he=e.date.startOf("month");return he.subtract(he.day()||7,"day")}),N=ee(()=>I.concat(I).slice(E,E+7)),$=ee(()=>lD(y(q)).some(he=>he.isCurrent)),F=ee(()=>{const he=e.date.startOf("month"),ke=he.day()||7,Ne=he.daysInMonth(),nt=he.subtract(1,"month").daysInMonth();return{startOfMonthDay:ke,dateCountOfMonth:Ne,dateCountOfLastMonth:nt}}),W=ee(()=>e.selectionMode==="dates"?zs(e.parsedValue):[]),U=(he,{count:ke,rowIndex:Ne,columnIndex:nt})=>{const{startOfMonthDay:De,dateCountOfMonth:Ct,dateCountOfLastMonth:Rt}=y(F),Bt=y(R);if(Ne>=0&&Ne<=1){const mt=De+Bt<0?7+De+Bt:De+Bt;if(nt+Ne*7>=mt)return he.text=ke,!0;he.text=Rt-(mt-nt%7)+1+Ne*7,he.type="prev-month"}else return ke<=Ct?he.text=ke:(he.text=ke-Ct,he.type="next-month"),!0;return!1},re=(he,{columnIndex:ke,rowIndex:Ne},nt)=>{const{disabledDate:De,cellClassName:Ct}=e,Rt=y(W),Bt=U(he,{count:nt,rowIndex:Ne,columnIndex:ke}),mt=he.dayjs.toDate();return he.selected=Rt.find(Gt=>Gt.isSame(he.dayjs,"day")),he.isSelected=!!he.selected,he.isCurrent=oe(he),he.disabled=De==null?void 0:De(mt),he.customClass=Ct==null?void 0:Ct(mt),Bt},K=he=>{if(e.selectionMode==="week"){const[ke,Ne]=e.showWeekNumber?[1,7]:[0,6],nt=Te(he[ke+1]);he[ke].inRange=nt,he[ke].start=nt,he[Ne].inRange=nt,he[Ne].end=nt}},q=ee(()=>{const{minDate:he,maxDate:ke,rangeState:Ne,showWeekNumber:nt}=e,De=y(R),Ct=y(o),Rt="day";let Bt=1;if(nt)for(let mt=0;mt<6;mt++)Ct[mt][0]||(Ct[mt][0]={type:"week",text:y(z).add(mt*7+1,Rt).week()});return hee({row:6,column:7},Ct,{startDate:he,columnIndexOffset:nt?1:0,nextEndDate:Ne.endDate||ke||Ne.selecting&&he||null,now:so().locale(y(i)).startOf(Rt),unit:Rt,relativeDateGetter:mt=>y(z).add(mt-De,Rt),setCellMetadata:(...mt)=>{re(...mt,Bt)&&(Bt+=1)},setRowMetadata:K}),Ct});qt(()=>e.date,async()=>{var he;(he=y(a))!=null&&he.contains(document.activeElement)&&(await Un(),await J())});const J=async()=>{var he;return(he=y(d))==null?void 0:he.focus()},oe=he=>e.selectionMode==="date"&&V2(he.type)&&ae(he,e.parsedValue),ae=(he,ke)=>ke?so(ke).locale(y(i)).isSame(e.date.date(Number(he.text)),"day"):!1,fe=(he,ke)=>{const Ne=he*7+(ke-(e.showWeekNumber?1:0))-y(R);return y(z).add(Ne,"day")},ge=he=>{var ke;if(!e.rangeState.selecting)return;let Ne=he.target;if(Ne.tagName==="SPAN"&&(Ne=(ke=Ne.parentNode)==null?void 0:ke.parentNode),Ne.tagName==="DIV"&&(Ne=Ne.parentNode),Ne.tagName!=="TD")return;const nt=Ne.parentNode.rowIndex-1,De=Ne.cellIndex;y(q)[nt][De].disabled||(nt!==y(g)||De!==y(_))&&(g.value=nt,_.value=De,t("changerange",{selecting:!0,endDate:fe(nt,De)}))},ce=he=>!y($)&&(he==null?void 0:he.text)===1&&he.type==="normal"||he.isCurrent,de=he=>{S||y($)||e.selectionMode!=="date"||Me(he,!0)},_e=he=>{he.target.closest("td")&&(S=!0)},Re=he=>{he.target.closest("td")&&(S=!1)},Qe=he=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:he,maxDate:null}),t("select",!0)):(he>=e.minDate?t("pick",{minDate:e.minDate,maxDate:he}):t("pick",{minDate:he,maxDate:e.minDate}),t("select",!1))},Ee=he=>{const ke=he.week(),Ne=`${he.year()}w${ke}`;t("pick",{year:he.year(),week:ke,value:Ne,date:he.startOf("week")})},ye=(he,ke)=>{const Ne=ke?zs(e.parsedValue).filter(nt=>(nt==null?void 0:nt.valueOf())!==he.valueOf()):zs(e.parsedValue).concat([he]);t("pick",Ne)},Me=(he,ke=!1)=>{const Ne=he.target.closest("td");if(!Ne)return;const nt=Ne.parentNode.rowIndex-1,De=Ne.cellIndex,Ct=y(q)[nt][De];if(Ct.disabled||Ct.type==="week")return;const Rt=fe(nt,De);switch(e.selectionMode){case"range":{Qe(Rt);break}case"date":{t("pick",Rt,ke);break}case"week":{Ee(Rt);break}case"dates":{ye(Rt,!!Ct.selected);break}}},Te=he=>{if(e.selectionMode!=="week")return!1;let ke=e.date.startOf("day");if(he.type==="prev-month"&&(ke=ke.subtract(1,"month")),he.type==="next-month"&&(ke=ke.add(1,"month")),ke=ke.date(Number.parseInt(he.text,10)),e.parsedValue&&!sn(e.parsedValue)){const Ne=(e.parsedValue.day()-E+7)%7-1;return e.parsedValue.subtract(Ne,"day").isSame(ke,"day")}return!1};return{WEEKS:N,rows:q,tbodyRef:a,currentCellRef:d,focus:J,isCurrent:oe,isWeekActive:Te,isSelectedCell:ce,handlePickDate:Me,handleMouseUp:Re,handleMouseDown:_e,handleMouseMove:ge,handleFocus:de}},gee=(e,{isCurrent:t,isWeekActive:i})=>{const a=Xt("date-table"),{t:d}=qo(),g=ee(()=>[a.b(),{"is-week-mode":e.selectionMode==="week"}]),_=ee(()=>d("el.datepicker.dateTablePrompt")),o=ee(()=>d("el.datepicker.week"));return{tableKls:g,tableLabel:_,weekLabel:o,getCellClasses:I=>{const R=[];return V2(I.type)&&!I.disabled?(R.push("available"),I.type==="today"&&R.push("today")):R.push(I.type),t(I)&&R.push("current"),I.inRange&&(V2(I.type)||e.selectionMode==="week")&&(R.push("in-range"),I.start&&R.push("start-date"),I.end&&R.push("end-date")),I.disabled&&R.push("disabled"),I.selected&&R.push("selected"),I.customClass&&R.push(I.customClass),R.join(" ")},getRowKls:I=>[a.e("row"),{current:i(I)}],t:d}},vee=cn({cell:{type:at(Object)}});var HT=qe({name:"ElDatePickerCell",props:vee,setup(e){const t=Xt("date-table-cell"),{slots:i}=kn(a1);return()=>{const{cell:a}=e;return vt(i,"default",{...a},()=>{var d;return[Ye("div",{class:t.b()},[Ye("span",{class:t.e("text")},[(d=a==null?void 0:a.renderText)!=null?d:a==null?void 0:a.text])])]})}}});const _ee=qe({__name:"basic-date-table",props:fee,emits:pee,setup(e,{expose:t,emit:i}){const a=e,{WEEKS:d,rows:g,tbodyRef:_,currentCellRef:o,focus:S,isCurrent:E,isWeekActive:I,isSelectedCell:R,handlePickDate:z,handleMouseUp:N,handleMouseDown:$,handleMouseMove:F,handleFocus:W}=mee(a,i),{tableLabel:U,tableKls:re,weekLabel:K,getCellClasses:q,getRowKls:J,t:oe}=gee(a,{isCurrent:E,isWeekActive:I});return t({focus:S}),(ae,fe)=>(se(),Ie("table",{"aria-label":y(U),class:ue(y(re)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:y(z),onMousemove:y(F),onMousedown:Xn(y($),["prevent"]),onMouseup:y(N)},[je("tbody",{ref_key:"tbodyRef",ref:_},[je("tr",null,[ae.showWeekNumber?(se(),Ie("th",{key:0,scope:"col"},mn(y(K)),1)):yt("v-if",!0),(se(!0),Ie(Fn,null,Fo(y(d),(ge,ce)=>(se(),Ie("th",{key:ce,"aria-label":y(oe)("el.datepicker.weeksFull."+ge),scope:"col"},mn(y(oe)("el.datepicker.weeks."+ge)),9,["aria-label"]))),128))]),(se(!0),Ie(Fn,null,Fo(y(g),(ge,ce)=>(se(),Ie("tr",{key:ce,class:ue(y(J)(ge[1]))},[(se(!0),Ie(Fn,null,Fo(ge,(de,_e)=>(se(),Ie("td",{key:`${ce}.${_e}`,ref_for:!0,ref:Re=>y(R)(de)&&(o.value=Re),class:ue(y(q)(de)),"aria-current":de.isCurrent?"date":void 0,"aria-selected":de.isCurrent,tabindex:y(R)(de)?0:-1,onFocus:y(W)},[Ye(y(HT),{cell:de},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var U2=fn(_ee,[["__file","basic-date-table.vue"]]);const yee=cn({...$T,selectionMode:UT("month")}),bee=qe({__name:"basic-month-table",props:yee,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const a=e,d=Xt("month-table"),{t:g,lang:_}=qo(),o=xe(),S=xe(),E=xe(a.date.locale("en").localeData().monthsShort().map(K=>K.toLowerCase())),I=xe([[],[],[]]),R=xe(),z=xe(),N=ee(()=>{var K,q;const J=I.value,oe=so().locale(_.value).startOf("month");for(let ae=0;ae<3;ae++){const fe=J[ae];for(let ge=0;ge<4;ge++){const ce=fe[ge]||(fe[ge]={row:ae,column:ge,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});ce.type="normal";const de=ae*4+ge,_e=a.date.startOf("year").month(de),Re=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;ce.inRange=!!(a.minDate&&_e.isSameOrAfter(a.minDate,"month")&&Re&&_e.isSameOrBefore(Re,"month"))||!!(a.minDate&&_e.isSameOrBefore(a.minDate,"month")&&Re&&_e.isSameOrAfter(Re,"month")),(K=a.minDate)!=null&&K.isSameOrAfter(Re)?(ce.start=!!(Re&&_e.isSame(Re,"month")),ce.end=a.minDate&&_e.isSame(a.minDate,"month")):(ce.start=!!(a.minDate&&_e.isSame(a.minDate,"month")),ce.end=!!(Re&&_e.isSame(Re,"month"))),oe.isSame(_e)&&(ce.type="today"),ce.text=de,ce.disabled=((q=a.disabledDate)==null?void 0:q.call(a,_e.toDate()))||!1}}return J}),$=()=>{var K;(K=S.value)==null||K.focus()},F=K=>{const q={},J=a.date.year(),oe=new Date,ae=K.text;return q.disabled=a.disabledDate?pb(J,ae,_.value).every(a.disabledDate):!1,q.current=zs(a.parsedValue).findIndex(fe=>so.isDayjs(fe)&&fe.year()===J&&fe.month()===ae)>=0,q.today=oe.getFullYear()===J&&oe.getMonth()===ae,K.inRange&&(q["in-range"]=!0,K.start&&(q["start-date"]=!0),K.end&&(q["end-date"]=!0)),q},W=K=>{const q=a.date.year(),J=K.text;return zs(a.date).findIndex(oe=>oe.year()===q&&oe.month()===J)>=0},U=K=>{var q;if(!a.rangeState.selecting)return;let J=K.target;if(J.tagName==="SPAN"&&(J=(q=J.parentNode)==null?void 0:q.parentNode),J.tagName==="DIV"&&(J=J.parentNode),J.tagName!=="TD")return;const oe=J.parentNode.rowIndex,ae=J.cellIndex;N.value[oe][ae].disabled||(oe!==R.value||ae!==z.value)&&(R.value=oe,z.value=ae,i("changerange",{selecting:!0,endDate:a.date.startOf("year").month(oe*4+ae)}))},re=K=>{var q;const J=(q=K.target)==null?void 0:q.closest("td");if((J==null?void 0:J.tagName)!=="TD"||Zs(J,"disabled"))return;const oe=J.cellIndex,fe=J.parentNode.rowIndex*4+oe,ge=a.date.startOf("year").month(fe);if(a.selectionMode==="months"){if(K.type==="keydown"){i("pick",zs(a.parsedValue),!1);return}const ce=Vv(a.date.year(),fe,_.value,a.disabledDate),de=Zs(J,"current")?zs(a.parsedValue).filter(_e=>(_e==null?void 0:_e.month())!==ce.month()):zs(a.parsedValue).concat([so(ce)]);i("pick",de)}else a.selectionMode==="range"?a.rangeState.selecting?(a.minDate&&ge>=a.minDate?i("pick",{minDate:a.minDate,maxDate:ge}):i("pick",{minDate:ge,maxDate:a.minDate}),i("select",!1)):(i("pick",{minDate:ge,maxDate:null}),i("select",!0)):i("pick",fe)};return qt(()=>a.date,async()=>{var K,q;(K=o.value)!=null&&K.contains(document.activeElement)&&(await Un(),(q=S.value)==null||q.focus())}),t({focus:$}),(K,q)=>(se(),Ie("table",{role:"grid","aria-label":y(g)("el.datepicker.monthTablePrompt"),class:ue(y(d).b()),onClick:re,onMousemove:U},[je("tbody",{ref_key:"tbodyRef",ref:o},[(se(!0),Ie(Fn,null,Fo(y(N),(J,oe)=>(se(),Ie("tr",{key:oe},[(se(!0),Ie(Fn,null,Fo(J,(ae,fe)=>(se(),Ie("td",{key:fe,ref_for:!0,ref:ge=>W(ae)&&(S.value=ge),class:ue(F(ae)),"aria-selected":`${W(ae)}`,"aria-label":y(g)(`el.datepicker.month${+ae.text+1}`),tabindex:W(ae)?0:-1,onKeydown:[kr(Xn(re,["prevent","stop"]),["space"]),kr(Xn(re,["prevent","stop"]),["enter"])]},[Ye(y(HT),{cell:{...ae,renderText:y(g)("el.datepicker.months."+E.value[ae.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var j2=fn(bee,[["__file","basic-month-table.vue"]]);const xee=cn({...$T,selectionMode:UT("year")}),wee=qe({__name:"basic-year-table",props:xee,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const a=e,d=(q,J)=>{const oe=so(String(q)).locale(J).startOf("year"),fe=oe.endOf("year").dayOfYear();return Zu(fe).map(ge=>oe.add(ge,"day").toDate())},g=Xt("year-table"),{t:_,lang:o}=qo(),S=xe(),E=xe(),I=ee(()=>Math.floor(a.date.year()/10)*10),R=xe([[],[],[]]),z=xe(),N=xe(),$=ee(()=>{var q;const J=R.value,oe=so().locale(o.value).startOf("year");for(let ae=0;ae<3;ae++){const fe=J[ae];for(let ge=0;ge<4&&!(ae*4+ge>=10);ge++){let ce=fe[ge];ce||(ce={row:ae,column:ge,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),ce.type="normal";const de=ae*4+ge+I.value,_e=so().year(de),Re=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;ce.inRange=!!(a.minDate&&_e.isSameOrAfter(a.minDate,"year")&&Re&&_e.isSameOrBefore(Re,"year"))||!!(a.minDate&&_e.isSameOrBefore(a.minDate,"year")&&Re&&_e.isSameOrAfter(Re,"year")),(q=a.minDate)!=null&&q.isSameOrAfter(Re)?(ce.start=!!(Re&&_e.isSame(Re,"year")),ce.end=!!(a.minDate&&_e.isSame(a.minDate,"year"))):(ce.start=!!(a.minDate&&_e.isSame(a.minDate,"year")),ce.end=!!(Re&&_e.isSame(Re,"year"))),oe.isSame(_e)&&(ce.type="today"),ce.text=de;const Ee=_e.toDate();ce.disabled=a.disabledDate&&a.disabledDate(Ee)||!1,fe[ge]=ce}}return J}),F=()=>{var q;(q=E.value)==null||q.focus()},W=q=>{const J={},oe=so().locale(o.value),ae=q.text;return J.disabled=a.disabledDate?d(ae,o.value).every(a.disabledDate):!1,J.today=oe.year()===ae,J.current=zs(a.parsedValue).findIndex(fe=>fe.year()===ae)>=0,q.inRange&&(J["in-range"]=!0,q.start&&(J["start-date"]=!0),q.end&&(J["end-date"]=!0)),J},U=q=>{const J=q.text;return zs(a.date).findIndex(oe=>oe.year()===J)>=0},re=q=>{var J;const oe=(J=q.target)==null?void 0:J.closest("td");if(!oe||!oe.textContent||Zs(oe,"disabled"))return;const ae=oe.cellIndex,ge=oe.parentNode.rowIndex*4+ae+I.value,ce=so().year(ge);if(a.selectionMode==="range")a.rangeState.selecting?(a.minDate&&ce>=a.minDate?i("pick",{minDate:a.minDate,maxDate:ce}):i("pick",{minDate:ce,maxDate:a.minDate}),i("select",!1)):(i("pick",{minDate:ce,maxDate:null}),i("select",!0));else if(a.selectionMode==="years"){if(q.type==="keydown"){i("pick",zs(a.parsedValue),!1);return}const de=$2(ce.startOf("year"),o.value,a.disabledDate),_e=Zs(oe,"current")?zs(a.parsedValue).filter(Re=>(Re==null?void 0:Re.year())!==ge):zs(a.parsedValue).concat([de]);i("pick",_e)}else i("pick",ge)},K=q=>{var J;if(!a.rangeState.selecting)return;const oe=(J=q.target)==null?void 0:J.closest("td");if(!oe)return;const ae=oe.parentNode.rowIndex,fe=oe.cellIndex;$.value[ae][fe].disabled||(ae!==z.value||fe!==N.value)&&(z.value=ae,N.value=fe,i("changerange",{selecting:!0,endDate:so().year(I.value).add(ae*4+fe,"year")}))};return qt(()=>a.date,async()=>{var q,J;(q=S.value)!=null&&q.contains(document.activeElement)&&(await Un(),(J=E.value)==null||J.focus())}),t({focus:F}),(q,J)=>(se(),Ie("table",{role:"grid","aria-label":y(_)("el.datepicker.yearTablePrompt"),class:ue(y(g).b()),onClick:re,onMousemove:K},[je("tbody",{ref_key:"tbodyRef",ref:S},[(se(!0),Ie(Fn,null,Fo(y($),(oe,ae)=>(se(),Ie("tr",{key:ae},[(se(!0),Ie(Fn,null,Fo(oe,(fe,ge)=>(se(),Ie("td",{key:`${ae}_${ge}`,ref_for:!0,ref:ce=>U(fe)&&(E.value=ce),class:ue(["available",W(fe)]),"aria-selected":U(fe),"aria-label":String(fe.text),tabindex:U(fe)?0:-1,onKeydown:[kr(Xn(re,["prevent","stop"]),["space"]),kr(Xn(re,["prevent","stop"]),["enter"])]},[Ye(y(HT),{cell:fe},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var H2=fn(wee,[["__file","basic-year-table.vue"]]);const See=qe({__name:"panel-date-pick",props:dee,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const i=e,a=(Pt,_n,dt)=>!0,d=Xt("picker-panel"),g=Xt("date-picker"),_=Ph(),o=Ri(),{t:S,lang:E}=qo(),I=kn("EP_PICKER_BASE"),R=kn(i1),{shortcuts:z,disabledDate:N,cellClassName:$,defaultTime:F}=I.props,W=mr(I.props,"defaultValue"),U=xe(),re=xe(so().locale(E.value)),K=xe(!1);let q=!1;const J=ee(()=>so(F).locale(E.value)),oe=ee(()=>re.value.month()),ae=ee(()=>re.value.year()),fe=xe([]),ge=xe(null),ce=xe(null),de=Pt=>fe.value.length>0?a(Pt,fe.value,i.format||"HH:mm:ss"):!0,_e=Pt=>F&&!Nt.value&&!K.value&&!q?J.value.year(Pt.year()).month(Pt.month()).date(Pt.date()):mt.value?Pt.millisecond(0):Pt.startOf("day"),Re=(Pt,..._n)=>{if(!Pt)t("pick",Pt,..._n);else if(sn(Pt)){const dt=Pt.map(_e);t("pick",dt,..._n)}else t("pick",_e(Pt),..._n);ge.value=null,ce.value=null,K.value=!1,q=!1},Qe=async(Pt,_n)=>{if(ke.value==="date"){Pt=Pt;let dt=i.parsedValue?i.parsedValue.year(Pt.year()).month(Pt.month()).date(Pt.date()):Pt;de(dt)||(dt=fe.value[0][0].year(Pt.year()).month(Pt.month()).date(Pt.date())),re.value=dt,Re(dt,mt.value||_n),i.type==="datetime"&&(await Un(),eo())}else ke.value==="week"?Re(Pt.date):ke.value==="dates"&&Re(Pt,!0)},Ee=Pt=>{const _n=Pt?"add":"subtract";re.value=re.value[_n](1,"month"),er("month")},ye=Pt=>{const _n=re.value,dt=Pt?"add":"subtract";re.value=Me.value==="year"?_n[dt](10,"year"):_n[dt](1,"year"),er("year")},Me=xe("date"),Te=ee(()=>{const Pt=S("el.datepicker.year");if(Me.value==="year"){const _n=Math.floor(ae.value/10)*10;return Pt?`${_n} ${Pt} - ${_n+9} ${Pt}`:`${_n} - ${_n+9}`}return`${ae.value} ${Pt}`}),he=Pt=>{const _n=Nn(Pt.value)?Pt.value():Pt.value;if(_n){q=!0,Re(so(_n).locale(E.value));return}Pt.onClick&&Pt.onClick({attrs:_,slots:o,emit:t})},ke=ee(()=>{const{type:Pt}=i;return["week","month","months","year","years","dates"].includes(Pt)?Pt:"date"}),Ne=ee(()=>ke.value==="dates"||ke.value==="months"||ke.value==="years"),nt=ee(()=>ke.value==="date"?Me.value:ke.value),De=ee(()=>!!z.length),Ct=async(Pt,_n)=>{ke.value==="month"?(re.value=Vv(re.value.year(),Pt,E.value,N),Re(re.value,!1)):ke.value==="months"?Re(Pt,_n??!0):(re.value=Vv(re.value.year(),Pt,E.value,N),Me.value="date",["month","year","date","week"].includes(ke.value)&&(Re(re.value,!0),await Un(),eo())),er("month")},Rt=async(Pt,_n)=>{if(ke.value==="year"){const dt=re.value.startOf("year").year(Pt);re.value=$2(dt,E.value,N),Re(re.value,!1)}else if(ke.value==="years")Re(Pt,_n??!0);else{const dt=re.value.year(Pt);re.value=$2(dt,E.value,N),Me.value="month",["month","year","date","week"].includes(ke.value)&&(Re(re.value,!0),await Un(),eo())}er("year")},Bt=async Pt=>{Me.value=Pt,await Un(),eo()},mt=ee(()=>i.type==="datetime"||i.type==="datetimerange"),Gt=ee(()=>{const Pt=mt.value||ke.value==="dates",_n=ke.value==="years",dt=ke.value==="months",tn=Me.value==="date",Ze=Me.value==="year",vn=Me.value==="month";return Pt&&tn||_n&&Ze||dt&&vn}),jt=ee(()=>N?i.parsedValue?sn(i.parsedValue)?N(i.parsedValue[0].toDate()):N(i.parsedValue.toDate()):!0:!1),Be=()=>{if(Ne.value)Re(i.parsedValue);else{let Pt=i.parsedValue;if(!Pt){const _n=so(F).locale(E.value),dt=lo();Pt=_n.year(dt.year()).month(dt.month()).date(dt.date())}re.value=Pt,Re(Pt)}},an=ee(()=>N?N(so().locale(E.value).toDate()):!1),At=()=>{const _n=so().locale(E.value).toDate();K.value=!0,(!N||!N(_n))&&de(_n)&&(re.value=so().locale(E.value),Re(re.value))},Ge=ee(()=>i.timeFormat||QL(i.format)),Fe=ee(()=>i.dateFormat||JL(i.format)),Nt=ee(()=>{if(ce.value)return ce.value;if(!(!i.parsedValue&&!W.value))return(i.parsedValue||re.value).format(Ge.value)}),Jt=ee(()=>{if(ge.value)return ge.value;if(!(!i.parsedValue&&!W.value))return(i.parsedValue||re.value).format(Fe.value)}),Dt=xe(!1),xt=()=>{Dt.value=!0},Ot=()=>{Dt.value=!1},en=Pt=>({hour:Pt.hour(),minute:Pt.minute(),second:Pt.second(),year:Pt.year(),month:Pt.month(),date:Pt.date()}),dn=(Pt,_n,dt)=>{const{hour:tn,minute:Ze,second:vn}=en(Pt),Mn=i.parsedValue?i.parsedValue.hour(tn).minute(Ze).second(vn):Pt;re.value=Mn,Re(re.value,!0),dt||(Dt.value=_n)},un=Pt=>{const _n=so(Pt,Ge.value).locale(E.value);if(_n.isValid()&&de(_n)){const{year:dt,month:tn,date:Ze}=en(re.value);re.value=_n.year(dt).month(tn).date(Ze),ce.value=null,Dt.value=!1,Re(re.value,!0)}},Pn=Pt=>{const _n=so(Pt,Fe.value).locale(E.value);if(_n.isValid()){if(N&&N(_n.toDate()))return;const{hour:dt,minute:tn,second:Ze}=en(re.value);re.value=_n.hour(dt).minute(tn).second(Ze),ge.value=null,Re(re.value,!0)}},gt=Pt=>so.isDayjs(Pt)&&Pt.isValid()&&(N?!N(Pt.toDate()):!0),Sn=Pt=>sn(Pt)?Pt.map(_n=>_n.format(i.format)):Pt.format(i.format),Vn=Pt=>so(Pt,i.format).locale(E.value),lo=()=>{const Pt=so(W.value).locale(E.value);if(!W.value){const _n=J.value;return so().hour(_n.hour()).minute(_n.minute()).second(_n.second()).locale(E.value)}return Pt},eo=async()=>{var Pt;["week","month","year","date"].includes(ke.value)&&((Pt=U.value)==null||Pt.focus(),ke.value==="week"&&Lo(Cn.down))},fo=Pt=>{const{code:_n}=Pt;[Cn.up,Cn.down,Cn.left,Cn.right,Cn.home,Cn.end,Cn.pageUp,Cn.pageDown].includes(_n)&&(Lo(_n),Pt.stopPropagation(),Pt.preventDefault()),[Cn.enter,Cn.space,Cn.numpadEnter].includes(_n)&&ge.value===null&&ce.value===null&&(Pt.preventDefault(),Re(re.value,!1))},Lo=Pt=>{var _n;const{up:dt,down:tn,left:Ze,right:vn,home:Mn,end:yo,pageUp:gr,pageDown:Xr}=Cn,Ur={year:{[dt]:-4,[tn]:4,[Ze]:-1,[vn]:1,offset:(Oo,_i)=>Oo.setFullYear(Oo.getFullYear()+_i)},month:{[dt]:-4,[tn]:4,[Ze]:-1,[vn]:1,offset:(Oo,_i)=>Oo.setMonth(Oo.getMonth()+_i)},week:{[dt]:-1,[tn]:1,[Ze]:-1,[vn]:1,offset:(Oo,_i)=>Oo.setDate(Oo.getDate()+_i*7)},date:{[dt]:-7,[tn]:7,[Ze]:-1,[vn]:1,[Mn]:Oo=>-Oo.getDay(),[yo]:Oo=>-Oo.getDay()+6,[gr]:Oo=>-new Date(Oo.getFullYear(),Oo.getMonth(),0).getDate(),[Xr]:Oo=>new Date(Oo.getFullYear(),Oo.getMonth()+1,0).getDate(),offset:(Oo,_i)=>Oo.setDate(Oo.getDate()+_i)}},Rr=re.value.toDate();for(;Math.abs(re.value.diff(Rr,"year",!0))<1;){const Oo=Ur[nt.value];if(!Oo)return;if(Oo.offset(Rr,Nn(Oo[Pt])?Oo[Pt](Rr):(_n=Oo[Pt])!=null?_n:0),N&&N(Rr))break;const _i=so(Rr).locale(E.value);re.value=_i,t("pick",_i,!0);break}},er=Pt=>{t("panel-change",re.value.toDate(),Pt,Me.value)};return qt(()=>ke.value,Pt=>{if(["month","year"].includes(Pt)){Me.value=Pt;return}else if(Pt==="years"){Me.value="year";return}else if(Pt==="months"){Me.value="month";return}Me.value="date"},{immediate:!0}),qt(()=>Me.value,()=>{R==null||R.updatePopper()}),qt(()=>W.value,Pt=>{Pt&&(re.value=lo())},{immediate:!0}),qt(()=>i.parsedValue,Pt=>{if(Pt){if(Ne.value||sn(Pt))return;re.value=Pt}else re.value=lo()},{immediate:!0}),t("set-picker-option",["isValidValue",gt]),t("set-picker-option",["formatToString",Sn]),t("set-picker-option",["parseUserInput",Vn]),t("set-picker-option",["handleFocusPicker",eo]),(Pt,_n)=>(se(),Ie("div",{class:ue([y(d).b(),y(g).b(),{"has-sidebar":Pt.$slots.sidebar||y(De),"has-time":y(mt)}])},[je("div",{class:ue(y(d).e("body-wrapper"))},[vt(Pt.$slots,"sidebar",{class:ue(y(d).e("sidebar"))}),y(De)?(se(),Ie("div",{key:0,class:ue(y(d).e("sidebar"))},[(se(!0),Ie(Fn,null,Fo(y(z),(dt,tn)=>(se(),Ie("button",{key:tn,type:"button",class:ue(y(d).e("shortcut")),onClick:Ze=>he(dt)},mn(dt.text),11,["onClick"]))),128))],2)):yt("v-if",!0),je("div",{class:ue(y(d).e("body"))},[y(mt)?(se(),Ie("div",{key:0,class:ue(y(g).e("time-header"))},[je("span",{class:ue(y(g).e("editor-wrap"))},[Ye(y(_s),{placeholder:y(S)("el.datepicker.selectDate"),"model-value":y(Jt),size:"small","validate-event":!1,onInput:dt=>ge.value=dt,onChange:Pn},null,8,["placeholder","model-value","onInput"])],2),vo((se(),Ie("span",{class:ue(y(g).e("editor-wrap"))},[Ye(y(_s),{placeholder:y(S)("el.datepicker.selectTime"),"model-value":y(Nt),size:"small","validate-event":!1,onFocus:xt,onInput:dt=>ce.value=dt,onChange:un},null,8,["placeholder","model-value","onInput"]),Ye(y(fb),{visible:Dt.value,format:y(Ge),"parsed-value":re.value,onPick:dn},null,8,["visible","format","parsed-value"])],2)),[[y(kc),Ot]])],2)):yt("v-if",!0),vo(je("div",{class:ue([y(g).e("header"),(Me.value==="year"||Me.value==="month")&&y(g).e("header--bordered")])},[je("span",{class:ue(y(g).e("prev-btn"))},[je("button",{type:"button","aria-label":y(S)("el.datepicker.prevYear"),class:ue(["d-arrow-left",y(d).e("icon-btn")]),onClick:dt=>ye(!1)},[vt(Pt.$slots,"prev-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(nd))]),_:1})])],10,["aria-label","onClick"]),vo(je("button",{type:"button","aria-label":y(S)("el.datepicker.prevMonth"),class:ue([y(d).e("icon-btn"),"arrow-left"]),onClick:dt=>Ee(!1)},[vt(Pt.$slots,"prev-month",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(td))]),_:1})])],10,["aria-label","onClick"]),[[ir,Me.value==="date"]])],2),je("span",{role:"button",class:ue(y(g).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:kr(dt=>Bt("year"),["enter"]),onClick:dt=>Bt("year")},mn(y(Te)),43,["onKeydown","onClick"]),vo(je("span",{role:"button","aria-live":"polite",tabindex:"0",class:ue([y(g).e("header-label"),{active:Me.value==="month"}]),onKeydown:kr(dt=>Bt("month"),["enter"]),onClick:dt=>Bt("month")},mn(y(S)(`el.datepicker.month${y(oe)+1}`)),43,["onKeydown","onClick"]),[[ir,Me.value==="date"]]),je("span",{class:ue(y(g).e("next-btn"))},[vo(je("button",{type:"button","aria-label":y(S)("el.datepicker.nextMonth"),class:ue([y(d).e("icon-btn"),"arrow-right"]),onClick:dt=>Ee(!0)},[vt(Pt.$slots,"next-month",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(Fs))]),_:1})])],10,["aria-label","onClick"]),[[ir,Me.value==="date"]]),je("button",{type:"button","aria-label":y(S)("el.datepicker.nextYear"),class:ue([y(d).e("icon-btn"),"d-arrow-right"]),onClick:dt=>ye(!0)},[vt(Pt.$slots,"next-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(od))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[ir,Me.value!=="time"]]),je("div",{class:ue(y(d).e("content")),onKeydown:fo},[Me.value==="date"?(se(),Et(U2,{key:0,ref_key:"currentViewRef",ref:U,"selection-mode":y(ke),date:re.value,"parsed-value":Pt.parsedValue,"disabled-date":y(N),"cell-class-name":y($),onPick:Qe},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):yt("v-if",!0),Me.value==="year"?(se(),Et(H2,{key:1,ref_key:"currentViewRef",ref:U,"selection-mode":y(ke),date:re.value,"disabled-date":y(N),"parsed-value":Pt.parsedValue,onPick:Rt},null,8,["selection-mode","date","disabled-date","parsed-value"])):yt("v-if",!0),Me.value==="month"?(se(),Et(j2,{key:2,ref_key:"currentViewRef",ref:U,"selection-mode":y(ke),date:re.value,"parsed-value":Pt.parsedValue,"disabled-date":y(N),onPick:Ct},null,8,["selection-mode","date","parsed-value","disabled-date"])):yt("v-if",!0)],34)],2)],2),vo(je("div",{class:ue(y(d).e("footer"))},[vo(Ye(y($i),{text:"",size:"small",class:ue(y(d).e("link-btn")),disabled:y(an),onClick:At},{default:it(()=>[$o(mn(y(S)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[ir,!y(Ne)&&Pt.showNow]]),Ye(y($i),{plain:"",size:"small",class:ue(y(d).e("link-btn")),disabled:y(jt),onClick:Be},{default:it(()=>[$o(mn(y(S)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[ir,y(Gt)]])],2))}});var Tee=fn(See,[["__file","panel-date-pick.vue"]]);const Cee=cn({...qO,...VT,visible:Boolean}),KO=e=>{const{emit:t}=To(),i=Ph(),a=Ri();return g=>{const _=Nn(g.value)?g.value():g.value;if(_){t("pick",[so(_[0]).locale(e.value),so(_[1]).locale(e.value)]);return}g.onClick&&g.onClick({attrs:i,slots:a,emit:t})}},ZO=(e,{defaultValue:t,leftDate:i,rightDate:a,unit:d,onParsedValueChanged:g})=>{const{emit:_}=To(),{pickerNs:o}=kn(a1),S=Xt("date-range-picker"),{t:E,lang:I}=qo(),R=KO(I),z=xe(),N=xe(),$=xe({endDate:null,selecting:!1}),F=q=>{$.value=q},W=(q=!1)=>{const J=y(z),oe=y(N);zp([J,oe])&&_("pick",[J,oe],q)},U=q=>{$.value.selecting=q,q||($.value.endDate=null)},re=q=>{if(sn(q)&&q.length===2){const[J,oe]=q;z.value=J,i.value=J,N.value=oe,g(y(z),y(N))}else K()},K=()=>{const[q,J]=jT(y(t),{lang:y(I),unit:d,unlinkPanels:e.unlinkPanels});z.value=void 0,N.value=void 0,i.value=q,a.value=J};return qt(t,q=>{q&&K()},{immediate:!0}),qt(()=>e.parsedValue,re,{immediate:!0}),{minDate:z,maxDate:N,rangeState:$,lang:I,ppNs:o,drpNs:S,handleChangeRange:F,handleRangeConfirm:W,handleShortcutClick:R,onSelect:U,onReset:re,t:E}},S0="month",Eee=qe({__name:"panel-date-range",props:Cee,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const i=e,a=kn("EP_PICKER_BASE"),{disabledDate:d,cellClassName:g,defaultTime:_,clearable:o}=a.props,S=mr(a.props,"format"),E=mr(a.props,"shortcuts"),I=mr(a.props,"defaultValue"),{lang:R}=qo(),z=xe(so().locale(R.value)),N=xe(so().locale(R.value).add(1,S0)),{minDate:$,maxDate:F,rangeState:W,ppNs:U,drpNs:re,handleChangeRange:K,handleRangeConfirm:q,handleShortcutClick:J,onSelect:oe,onReset:ae,t:fe}=ZO(i,{defaultValue:I,leftDate:z,rightDate:N,unit:S0,onParsedValueChanged:_n});qt(()=>i.visible,dt=>{!dt&&W.value.selecting&&(ae(i.parsedValue),oe(!1))});const ge=xe({min:null,max:null}),ce=xe({min:null,max:null}),de=ee(()=>`${z.value.year()} ${fe("el.datepicker.year")} ${fe(`el.datepicker.month${z.value.month()+1}`)}`),_e=ee(()=>`${N.value.year()} ${fe("el.datepicker.year")} ${fe(`el.datepicker.month${N.value.month()+1}`)}`),Re=ee(()=>z.value.year()),Qe=ee(()=>z.value.month()),Ee=ee(()=>N.value.year()),ye=ee(()=>N.value.month()),Me=ee(()=>!!E.value.length),Te=ee(()=>ge.value.min!==null?ge.value.min:$.value?$.value.format(De.value):""),he=ee(()=>ge.value.max!==null?ge.value.max:F.value||$.value?(F.value||$.value).format(De.value):""),ke=ee(()=>ce.value.min!==null?ce.value.min:$.value?$.value.format(nt.value):""),Ne=ee(()=>ce.value.max!==null?ce.value.max:F.value||$.value?(F.value||$.value).format(nt.value):""),nt=ee(()=>i.timeFormat||QL(S.value)),De=ee(()=>i.dateFormat||JL(S.value)),Ct=dt=>zp(dt)&&(d?!d(dt[0].toDate())&&!d(dt[1].toDate()):!0),Rt=()=>{z.value=z.value.subtract(1,"year"),i.unlinkPanels||(N.value=z.value.add(1,"month")),Ge("year")},Bt=()=>{z.value=z.value.subtract(1,"month"),i.unlinkPanels||(N.value=z.value.add(1,"month")),Ge("month")},mt=()=>{i.unlinkPanels?N.value=N.value.add(1,"year"):(z.value=z.value.add(1,"year"),N.value=z.value.add(1,"month")),Ge("year")},Gt=()=>{i.unlinkPanels?N.value=N.value.add(1,"month"):(z.value=z.value.add(1,"month"),N.value=z.value.add(1,"month")),Ge("month")},jt=()=>{z.value=z.value.add(1,"year"),Ge("year")},Be=()=>{z.value=z.value.add(1,"month"),Ge("month")},an=()=>{N.value=N.value.subtract(1,"year"),Ge("year")},At=()=>{N.value=N.value.subtract(1,"month"),Ge("month")},Ge=dt=>{t("panel-change",[z.value.toDate(),N.value.toDate()],dt)},Fe=ee(()=>{const dt=(Qe.value+1)%12,tn=Qe.value+1>=12?1:0;return i.unlinkPanels&&new Date(Re.value+tn,dt)<new Date(Ee.value,ye.value)}),Nt=ee(()=>i.unlinkPanels&&Ee.value*12+ye.value-(Re.value*12+Qe.value+1)>=12),Jt=ee(()=>!($.value&&F.value&&!W.value.selecting&&zp([$.value,F.value]))),Dt=ee(()=>i.type==="datetime"||i.type==="datetimerange"),xt=(dt,tn)=>{if(dt)return _?so(_[tn]||_).locale(R.value).year(dt.year()).month(dt.month()).date(dt.date()):dt},Ot=(dt,tn=!0)=>{const Ze=dt.minDate,vn=dt.maxDate,Mn=xt(Ze,0),yo=xt(vn,1);F.value===yo&&$.value===Mn||(t("calendar-change",[Ze.toDate(),vn&&vn.toDate()]),F.value=yo,$.value=Mn,!(!tn||Dt.value)&&q())},en=xe(!1),dn=xe(!1),un=()=>{en.value=!1},Pn=()=>{dn.value=!1},gt=(dt,tn)=>{ge.value[tn]=dt;const Ze=so(dt,De.value).locale(R.value);if(Ze.isValid()){if(d&&d(Ze.toDate()))return;tn==="min"?(z.value=Ze,$.value=($.value||z.value).year(Ze.year()).month(Ze.month()).date(Ze.date()),!i.unlinkPanels&&(!F.value||F.value.isBefore($.value))&&(N.value=Ze.add(1,"month"),F.value=$.value.add(1,"month"))):(N.value=Ze,F.value=(F.value||N.value).year(Ze.year()).month(Ze.month()).date(Ze.date()),!i.unlinkPanels&&(!$.value||$.value.isAfter(F.value))&&(z.value=Ze.subtract(1,"month"),$.value=F.value.subtract(1,"month")))}},Sn=(dt,tn)=>{ge.value[tn]=null},Vn=(dt,tn)=>{ce.value[tn]=dt;const Ze=so(dt,nt.value).locale(R.value);Ze.isValid()&&(tn==="min"?(en.value=!0,$.value=($.value||z.value).hour(Ze.hour()).minute(Ze.minute()).second(Ze.second())):(dn.value=!0,F.value=(F.value||N.value).hour(Ze.hour()).minute(Ze.minute()).second(Ze.second()),N.value=F.value))},lo=(dt,tn)=>{ce.value[tn]=null,tn==="min"?(z.value=$.value,en.value=!1,(!F.value||F.value.isBefore($.value))&&(F.value=$.value)):(N.value=F.value,dn.value=!1,F.value&&F.value.isBefore($.value)&&($.value=F.value))},eo=(dt,tn,Ze)=>{ce.value.min||(dt&&(z.value=dt,$.value=($.value||z.value).hour(dt.hour()).minute(dt.minute()).second(dt.second())),Ze||(en.value=tn),(!F.value||F.value.isBefore($.value))&&(F.value=$.value,N.value=dt))},fo=(dt,tn,Ze)=>{ce.value.max||(dt&&(N.value=dt,F.value=(F.value||N.value).hour(dt.hour()).minute(dt.minute()).second(dt.second())),Ze||(dn.value=tn),F.value&&F.value.isBefore($.value)&&($.value=F.value))},Lo=()=>{z.value=jT(y(I),{lang:y(R),unit:"month",unlinkPanels:i.unlinkPanels})[0],N.value=z.value.add(1,"month"),F.value=void 0,$.value=void 0,t("pick",null)},er=dt=>sn(dt)?dt.map(tn=>tn.format(S.value)):dt.format(S.value),Pt=dt=>sn(dt)?dt.map(tn=>so(tn,S.value).locale(R.value)):so(dt,S.value).locale(R.value);function _n(dt,tn){if(i.unlinkPanels&&tn){const Ze=(dt==null?void 0:dt.year())||0,vn=(dt==null?void 0:dt.month())||0,Mn=tn.year(),yo=tn.month();N.value=Ze===Mn&&vn===yo?tn.add(1,S0):tn}else N.value=z.value.add(1,S0),tn&&(N.value=N.value.hour(tn.hour()).minute(tn.minute()).second(tn.second()))}return t("set-picker-option",["isValidValue",Ct]),t("set-picker-option",["parseUserInput",Pt]),t("set-picker-option",["formatToString",er]),t("set-picker-option",["handleClear",Lo]),(dt,tn)=>(se(),Ie("div",{class:ue([y(U).b(),y(re).b(),{"has-sidebar":dt.$slots.sidebar||y(Me),"has-time":y(Dt)}])},[je("div",{class:ue(y(U).e("body-wrapper"))},[vt(dt.$slots,"sidebar",{class:ue(y(U).e("sidebar"))}),y(Me)?(se(),Ie("div",{key:0,class:ue(y(U).e("sidebar"))},[(se(!0),Ie(Fn,null,Fo(y(E),(Ze,vn)=>(se(),Ie("button",{key:vn,type:"button",class:ue(y(U).e("shortcut")),onClick:Mn=>y(J)(Ze)},mn(Ze.text),11,["onClick"]))),128))],2)):yt("v-if",!0),je("div",{class:ue(y(U).e("body"))},[y(Dt)?(se(),Ie("div",{key:0,class:ue(y(re).e("time-header"))},[je("span",{class:ue(y(re).e("editors-wrap"))},[je("span",{class:ue(y(re).e("time-picker-wrap"))},[Ye(y(_s),{size:"small",disabled:y(W).selecting,placeholder:y(fe)("el.datepicker.startDate"),class:ue(y(re).e("editor")),"model-value":y(Te),"validate-event":!1,onInput:Ze=>gt(Ze,"min"),onChange:Ze=>Sn(Ze,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),vo((se(),Ie("span",{class:ue(y(re).e("time-picker-wrap"))},[Ye(y(_s),{size:"small",class:ue(y(re).e("editor")),disabled:y(W).selecting,placeholder:y(fe)("el.datepicker.startTime"),"model-value":y(ke),"validate-event":!1,onFocus:Ze=>en.value=!0,onInput:Ze=>Vn(Ze,"min"),onChange:Ze=>lo(Ze,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),Ye(y(fb),{visible:en.value,format:y(nt),"datetime-role":"start","parsed-value":z.value,onPick:eo},null,8,["visible","format","parsed-value"])],2)),[[y(kc),un]])],2),je("span",null,[Ye(y(Dn),null,{default:it(()=>[Ye(y(Fs))]),_:1})]),je("span",{class:ue([y(re).e("editors-wrap"),"is-right"])},[je("span",{class:ue(y(re).e("time-picker-wrap"))},[Ye(y(_s),{size:"small",class:ue(y(re).e("editor")),disabled:y(W).selecting,placeholder:y(fe)("el.datepicker.endDate"),"model-value":y(he),readonly:!y($),"validate-event":!1,onInput:Ze=>gt(Ze,"max"),onChange:Ze=>Sn(Ze,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),vo((se(),Ie("span",{class:ue(y(re).e("time-picker-wrap"))},[Ye(y(_s),{size:"small",class:ue(y(re).e("editor")),disabled:y(W).selecting,placeholder:y(fe)("el.datepicker.endTime"),"model-value":y(Ne),readonly:!y($),"validate-event":!1,onFocus:Ze=>y($)&&(dn.value=!0),onInput:Ze=>Vn(Ze,"max"),onChange:Ze=>lo(Ze,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),Ye(y(fb),{"datetime-role":"end",visible:dn.value,format:y(nt),"parsed-value":N.value,onPick:fo},null,8,["visible","format","parsed-value"])],2)),[[y(kc),Pn]])],2)],2)):yt("v-if",!0),je("div",{class:ue([[y(U).e("content"),y(re).e("content")],"is-left"])},[je("div",{class:ue(y(re).e("header"))},[je("button",{type:"button",class:ue([y(U).e("icon-btn"),"d-arrow-left"]),"aria-label":y(fe)("el.datepicker.prevYear"),onClick:Rt},[vt(dt.$slots,"prev-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(nd))]),_:1})])],10,["aria-label"]),je("button",{type:"button",class:ue([y(U).e("icon-btn"),"arrow-left"]),"aria-label":y(fe)("el.datepicker.prevMonth"),onClick:Bt},[vt(dt.$slots,"prev-month",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(td))]),_:1})])],10,["aria-label"]),dt.unlinkPanels?(se(),Ie("button",{key:0,type:"button",disabled:!y(Nt),class:ue([[y(U).e("icon-btn"),{"is-disabled":!y(Nt)}],"d-arrow-right"]),"aria-label":y(fe)("el.datepicker.nextYear"),onClick:jt},[vt(dt.$slots,"next-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(od))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),dt.unlinkPanels?(se(),Ie("button",{key:1,type:"button",disabled:!y(Fe),class:ue([[y(U).e("icon-btn"),{"is-disabled":!y(Fe)}],"arrow-right"]),"aria-label":y(fe)("el.datepicker.nextMonth"),onClick:Be},[vt(dt.$slots,"next-month",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(Fs))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),je("div",null,mn(y(de)),1)],2),Ye(U2,{"selection-mode":"range",date:z.value,"min-date":y($),"max-date":y(F),"range-state":y(W),"disabled-date":y(d),"cell-class-name":y(g),onChangerange:y(K),onPick:Ot,onSelect:y(oe)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),je("div",{class:ue([[y(U).e("content"),y(re).e("content")],"is-right"])},[je("div",{class:ue(y(re).e("header"))},[dt.unlinkPanels?(se(),Ie("button",{key:0,type:"button",disabled:!y(Nt),class:ue([[y(U).e("icon-btn"),{"is-disabled":!y(Nt)}],"d-arrow-left"]),"aria-label":y(fe)("el.datepicker.prevYear"),onClick:an},[vt(dt.$slots,"prev-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(nd))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),dt.unlinkPanels?(se(),Ie("button",{key:1,type:"button",disabled:!y(Fe),class:ue([[y(U).e("icon-btn"),{"is-disabled":!y(Fe)}],"arrow-left"]),"aria-label":y(fe)("el.datepicker.prevMonth"),onClick:At},[vt(dt.$slots,"prev-month",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(td))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),je("button",{type:"button","aria-label":y(fe)("el.datepicker.nextYear"),class:ue([y(U).e("icon-btn"),"d-arrow-right"]),onClick:mt},[vt(dt.$slots,"next-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(od))]),_:1})])],10,["aria-label"]),je("button",{type:"button",class:ue([y(U).e("icon-btn"),"arrow-right"]),"aria-label":y(fe)("el.datepicker.nextMonth"),onClick:Gt},[vt(dt.$slots,"next-month",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(Fs))]),_:1})])],10,["aria-label"]),je("div",null,mn(y(_e)),1)],2),Ye(U2,{"selection-mode":"range",date:N.value,"min-date":y($),"max-date":y(F),"range-state":y(W),"disabled-date":y(d),"cell-class-name":y(g),onChangerange:y(K),onPick:Ot,onSelect:y(oe)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),y(Dt)?(se(),Ie("div",{key:0,class:ue(y(U).e("footer"))},[y(o)?(se(),Et(y($i),{key:0,text:"",size:"small",class:ue(y(U).e("link-btn")),onClick:Lo},{default:it(()=>[$o(mn(y(fe)("el.datepicker.clear")),1)]),_:1},8,["class"])):yt("v-if",!0),Ye(y($i),{plain:"",size:"small",class:ue(y(U).e("link-btn")),disabled:y(Jt),onClick:Ze=>y(q)(!1)},{default:it(()=>[$o(mn(y(fe)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):yt("v-if",!0)],2))}});var Mee=fn(Eee,[["__file","panel-date-range.vue"]]);const Iee=cn({...VT}),Aee=["pick","set-picker-option","calendar-change"],kee=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const{t:a}=qo(),d=()=>{t.value=t.value.subtract(1,"year"),e.value||(i.value=i.value.subtract(1,"year"))},g=()=>{e.value||(t.value=t.value.add(1,"year")),i.value=i.value.add(1,"year")},_=()=>{t.value=t.value.add(1,"year")},o=()=>{i.value=i.value.subtract(1,"year")},S=ee(()=>`${t.value.year()} ${a("el.datepicker.year")}`),E=ee(()=>`${i.value.year()} ${a("el.datepicker.year")}`),I=ee(()=>t.value.year()),R=ee(()=>i.value.year()===t.value.year()?t.value.year()+1:i.value.year());return{leftPrevYear:d,rightNextYear:g,leftNextYear:_,rightPrevYear:o,leftLabel:S,rightLabel:E,leftYear:I,rightYear:R}},T0="year",Pee=qe({name:"DatePickerMonthRange"}),Ree=qe({...Pee,props:Iee,emits:Aee,setup(e,{emit:t}){const i=e,{lang:a}=qo(),d=kn("EP_PICKER_BASE"),{shortcuts:g,disabledDate:_}=d.props,o=mr(d.props,"format"),S=mr(d.props,"defaultValue"),E=xe(so().locale(a.value)),I=xe(so().locale(a.value).add(1,T0)),{minDate:R,maxDate:z,rangeState:N,ppNs:$,drpNs:F,handleChangeRange:W,handleRangeConfirm:U,handleShortcutClick:re,onSelect:K}=ZO(i,{defaultValue:S,leftDate:E,rightDate:I,unit:T0,onParsedValueChanged:Te}),q=ee(()=>!!g.length),{leftPrevYear:J,rightNextYear:oe,leftNextYear:ae,rightPrevYear:fe,leftLabel:ge,rightLabel:ce,leftYear:de,rightYear:_e}=kee({unlinkPanels:mr(i,"unlinkPanels"),leftDate:E,rightDate:I}),Re=ee(()=>i.unlinkPanels&&_e.value>de.value+1),Qe=(he,ke=!0)=>{const Ne=he.minDate,nt=he.maxDate;z.value===nt&&R.value===Ne||(t("calendar-change",[Ne.toDate(),nt&&nt.toDate()]),z.value=nt,R.value=Ne,ke&&U())},Ee=()=>{E.value=jT(y(S),{lang:y(a),unit:"year",unlinkPanels:i.unlinkPanels})[0],I.value=E.value.add(1,"year"),t("pick",null)},ye=he=>sn(he)?he.map(ke=>ke.format(o.value)):he.format(o.value),Me=he=>sn(he)?he.map(ke=>so(ke,o.value).locale(a.value)):so(he,o.value).locale(a.value);function Te(he,ke){if(i.unlinkPanels&&ke){const Ne=(he==null?void 0:he.year())||0,nt=ke.year();I.value=Ne===nt?ke.add(1,T0):ke}else I.value=E.value.add(1,T0)}return t("set-picker-option",["isValidValue",zp]),t("set-picker-option",["formatToString",ye]),t("set-picker-option",["parseUserInput",Me]),t("set-picker-option",["handleClear",Ee]),(he,ke)=>(se(),Ie("div",{class:ue([y($).b(),y(F).b(),{"has-sidebar":!!he.$slots.sidebar||y(q)}])},[je("div",{class:ue(y($).e("body-wrapper"))},[vt(he.$slots,"sidebar",{class:ue(y($).e("sidebar"))}),y(q)?(se(),Ie("div",{key:0,class:ue(y($).e("sidebar"))},[(se(!0),Ie(Fn,null,Fo(y(g),(Ne,nt)=>(se(),Ie("button",{key:nt,type:"button",class:ue(y($).e("shortcut")),onClick:De=>y(re)(Ne)},mn(Ne.text),11,["onClick"]))),128))],2)):yt("v-if",!0),je("div",{class:ue(y($).e("body"))},[je("div",{class:ue([[y($).e("content"),y(F).e("content")],"is-left"])},[je("div",{class:ue(y(F).e("header"))},[je("button",{type:"button",class:ue([y($).e("icon-btn"),"d-arrow-left"]),onClick:y(J)},[vt(he.$slots,"prev-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(nd))]),_:1})])],10,["onClick"]),he.unlinkPanels?(se(),Ie("button",{key:0,type:"button",disabled:!y(Re),class:ue([[y($).e("icon-btn"),{[y($).is("disabled")]:!y(Re)}],"d-arrow-right"]),onClick:y(ae)},[vt(he.$slots,"next-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(od))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),je("div",null,mn(y(ge)),1)],2),Ye(j2,{"selection-mode":"range",date:E.value,"min-date":y(R),"max-date":y(z),"range-state":y(N),"disabled-date":y(_),onChangerange:y(W),onPick:Qe,onSelect:y(K)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),je("div",{class:ue([[y($).e("content"),y(F).e("content")],"is-right"])},[je("div",{class:ue(y(F).e("header"))},[he.unlinkPanels?(se(),Ie("button",{key:0,type:"button",disabled:!y(Re),class:ue([[y($).e("icon-btn"),{"is-disabled":!y(Re)}],"d-arrow-left"]),onClick:y(fe)},[vt(he.$slots,"prev-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(nd))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),je("button",{type:"button",class:ue([y($).e("icon-btn"),"d-arrow-right"]),onClick:y(oe)},[vt(he.$slots,"next-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(od))]),_:1})])],10,["onClick"]),je("div",null,mn(y(ce)),1)],2),Ye(j2,{"selection-mode":"range",date:I.value,"min-date":y(R),"max-date":y(z),"range-state":y(N),"disabled-date":y(_),onChangerange:y(W),onPick:Qe,onSelect:y(K)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var Dee=fn(Ree,[["__file","panel-month-range.vue"]]);const Lee=cn({...VT}),Oee=["pick","set-picker-option","calendar-change"],zee=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const a=()=>{t.value=t.value.subtract(10,"year"),e.value||(i.value=i.value.subtract(10,"year"))},d=()=>{e.value||(t.value=t.value.add(10,"year")),i.value=i.value.add(10,"year")},g=()=>{t.value=t.value.add(10,"year")},_=()=>{i.value=i.value.subtract(10,"year")},o=ee(()=>{const R=Math.floor(t.value.year()/10)*10;return`${R}-${R+9}`}),S=ee(()=>{const R=Math.floor(i.value.year()/10)*10;return`${R}-${R+9}`}),E=ee(()=>Math.floor(t.value.year()/10)*10+9),I=ee(()=>Math.floor(i.value.year()/10)*10);return{leftPrevYear:a,rightNextYear:d,leftNextYear:g,rightPrevYear:_,leftLabel:o,rightLabel:S,leftYear:E,rightYear:I}},M3="year",Bee=qe({name:"DatePickerYearRange"}),Fee=qe({...Bee,props:Lee,emits:Oee,setup(e,{emit:t}){const i=e,{lang:a}=qo(),d=xe(so().locale(a.value)),g=xe(d.value.add(10,"year")),{pickerNs:_}=kn(a1),o=Xt("date-range-picker"),S=ee(()=>!!Qe.length),E=ee(()=>[_.b(),o.b(),{"has-sidebar":!!Ri().sidebar||S.value}]),I=ee(()=>({content:[_.e("content"),o.e("content"),"is-left"],arrowLeftBtn:[_.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),{[_.is("disabled")]:!J.value},"d-arrow-right"]})),R=ee(()=>({content:[_.e("content"),o.e("content"),"is-right"],arrowLeftBtn:[_.e("icon-btn"),{"is-disabled":!J.value},"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),"d-arrow-right"]})),z=KO(a),{leftPrevYear:N,rightNextYear:$,leftNextYear:F,rightPrevYear:W,leftLabel:U,rightLabel:re,leftYear:K,rightYear:q}=zee({unlinkPanels:mr(i,"unlinkPanels"),leftDate:d,rightDate:g}),J=ee(()=>i.unlinkPanels&&q.value>K.value+1),oe=xe(),ae=xe(),fe=xe({endDate:null,selecting:!1}),ge=De=>{fe.value=De},ce=(De,Ct=!0)=>{const Rt=De.minDate,Bt=De.maxDate;ae.value===Bt&&oe.value===Rt||(t("calendar-change",[Rt.toDate(),Bt&&Bt.toDate()]),ae.value=Bt,oe.value=Rt,Ct&&de())},de=(De=!1)=>{zp([oe.value,ae.value])&&t("pick",[oe.value,ae.value],De)},_e=De=>{fe.value.selecting=De,De||(fe.value.endDate=null)},Re=kn("EP_PICKER_BASE"),{shortcuts:Qe,disabledDate:Ee}=Re.props,ye=mr(Re.props,"format"),Me=mr(Re.props,"defaultValue"),Te=()=>{let De;if(sn(Me.value)){const Ct=so(Me.value[0]);let Rt=so(Me.value[1]);return i.unlinkPanels||(Rt=Ct.add(10,M3)),[Ct,Rt]}else Me.value?De=so(Me.value):De=so();return De=De.locale(a.value),[De,De.add(10,M3)]};qt(()=>Me.value,De=>{if(De){const Ct=Te();d.value=Ct[0],g.value=Ct[1]}},{immediate:!0}),qt(()=>i.parsedValue,De=>{if(De&&De.length===2)if(oe.value=De[0],ae.value=De[1],d.value=oe.value,i.unlinkPanels&&ae.value){const Ct=oe.value.year(),Rt=ae.value.year();g.value=Ct===Rt?ae.value.add(10,"year"):ae.value}else g.value=d.value.add(10,"year");else{const Ct=Te();oe.value=void 0,ae.value=void 0,d.value=Ct[0],g.value=Ct[1]}},{immediate:!0});const he=De=>sn(De)?De.map(Ct=>so(Ct,ye.value).locale(a.value)):so(De,ye.value).locale(a.value),ke=De=>sn(De)?De.map(Ct=>Ct.format(ye.value)):De.format(ye.value),Ne=De=>zp(De)&&(Ee?!Ee(De[0].toDate())&&!Ee(De[1].toDate()):!0),nt=()=>{const De=Te();d.value=De[0],g.value=De[1],ae.value=void 0,oe.value=void 0,t("pick",null)};return t("set-picker-option",["isValidValue",Ne]),t("set-picker-option",["parseUserInput",he]),t("set-picker-option",["formatToString",ke]),t("set-picker-option",["handleClear",nt]),(De,Ct)=>(se(),Ie("div",{class:ue(y(E))},[je("div",{class:ue(y(_).e("body-wrapper"))},[vt(De.$slots,"sidebar",{class:ue(y(_).e("sidebar"))}),y(S)?(se(),Ie("div",{key:0,class:ue(y(_).e("sidebar"))},[(se(!0),Ie(Fn,null,Fo(y(Qe),(Rt,Bt)=>(se(),Ie("button",{key:Bt,type:"button",class:ue(y(_).e("shortcut")),onClick:mt=>y(z)(Rt)},mn(Rt.text),11,["onClick"]))),128))],2)):yt("v-if",!0),je("div",{class:ue(y(_).e("body"))},[je("div",{class:ue(y(I).content)},[je("div",{class:ue(y(o).e("header"))},[je("button",{type:"button",class:ue(y(I).arrowLeftBtn),onClick:y(N)},[vt(De.$slots,"prev-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(nd))]),_:1})])],10,["onClick"]),De.unlinkPanels?(se(),Ie("button",{key:0,type:"button",disabled:!y(J),class:ue(y(I).arrowRightBtn),onClick:y(F)},[vt(De.$slots,"next-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(od))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),je("div",null,mn(y(U)),1)],2),Ye(H2,{"selection-mode":"range",date:d.value,"min-date":oe.value,"max-date":ae.value,"range-state":fe.value,"disabled-date":y(Ee),onChangerange:ge,onPick:ce,onSelect:_e},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),je("div",{class:ue(y(R).content)},[je("div",{class:ue(y(o).e("header"))},[De.unlinkPanels?(se(),Ie("button",{key:0,type:"button",disabled:!y(J),class:ue(y(R).arrowLeftBtn),onClick:y(W)},[vt(De.$slots,"prev-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(nd))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),je("button",{type:"button",class:ue(y(R).arrowRightBtn),onClick:y($)},[vt(De.$slots,"next-year",{},()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(od))]),_:1})])],10,["onClick"]),je("div",null,mn(y(re)),1)],2),Ye(H2,{"selection-mode":"range",date:g.value,"min-date":oe.value,"max-date":ae.value,"range-state":fe.value,"disabled-date":y(Ee),onChangerange:ge,onPick:ce,onSelect:_e},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var Nee=fn(Fee,[["__file","panel-year-range.vue"]]);const $ee=function(e){switch(e){case"daterange":case"datetimerange":return Mee;case"monthrange":return Dee;case"yearrange":return Nee;default:return Tee}};so.extend(mO);so.extend(JQ);so.extend(BT);so.extend(eee);so.extend(nee);so.extend(ree);so.extend(see);so.extend(lee);var Vee=qe({name:"ElDatePicker",install:null,props:cee,emits:["update:modelValue"],setup(e,{expose:t,emit:i,slots:a}){const d=Xt("picker-panel");Bo("ElPopperOptions",dr(mr(e,"popperOptions"))),Bo(a1,{slots:a,pickerNs:d});const g=xe();t({focus:()=>{var S;(S=g.value)==null||S.focus()},blur:()=>{var S;(S=g.value)==null||S.blur()},handleOpen:()=>{var S;(S=g.value)==null||S.handleOpen()},handleClose:()=>{var S;(S=g.value)==null||S.handleClose()}});const o=S=>{i("update:modelValue",S)};return()=>{var S;const E=(S=e.format)!=null?S:_Y[e.type]||rp,I=$ee(e.type);return Ye(nO,Po(e,{format:E,type:e.type,ref:g,"onUpdate:modelValue":o}),{default:R=>Ye(I,R,{"prev-month":a["prev-month"],"next-month":a["next-month"],"prev-year":a["prev-year"],"next-year":a["next-year"]}),"range-separator":a["range-separator"]})}}});const Uee=uo(Vee),GT=Symbol("elDescriptions");var ev=qe({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:kn(GT,{})}},render(){var e;const t=yW(this.cell),i=(((e=this.cell)==null?void 0:e.dirs)||[]).map(U=>{const{dir:re,arg:K,modifiers:q,value:J}=U;return[re,J,K,q]}),{border:a,direction:d}=this.descriptions,g=d==="vertical",_=()=>{var U,re,K;return((K=(re=(U=this.cell)==null?void 0:U.children)==null?void 0:re.label)==null?void 0:K.call(re))||t.label},o=()=>{var U,re,K;return(K=(re=(U=this.cell)==null?void 0:U.children)==null?void 0:re.default)==null?void 0:K.call(re)},S=t.span,E=t.rowspan,I=t.align?`is-${t.align}`:"",R=t.labelAlign?`is-${t.labelAlign}`:I,z=t.className,N=t.labelClassName,$=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,F={width:fi($),minWidth:fi(t.minWidth)},W=Xt("descriptions");switch(this.type){case"label":return vo(Kn(this.tag,{style:F,class:[W.e("cell"),W.e("label"),W.is("bordered-label",a),W.is("vertical-label",g),R,N],colSpan:g?S:1,rowspan:g?1:E},_()),i);case"content":return vo(Kn(this.tag,{style:F,class:[W.e("cell"),W.e("content"),W.is("bordered-content",a),W.is("vertical-content",g),I,z],colSpan:g?S:S*2-1,rowspan:g?E*2-1:E},o()),i);default:{const U=_();return vo(Kn("td",{style:F,class:[W.e("cell"),I],colSpan:S,rowspan:E},[Pi(U)?void 0:Kn("span",{class:[W.e("label"),N]},U),Kn("span",{class:[W.e("content"),z]},o())]),i)}}}});const jee=cn({row:{type:at(Array),default:()=>[]}}),Hee=qe({name:"ElDescriptionsRow"}),Gee=qe({...Hee,props:jee,setup(e){const t=kn(GT,{});return(i,a)=>y(t).direction==="vertical"?(se(),Ie(Fn,{key:0},[je("tr",null,[(se(!0),Ie(Fn,null,Fo(i.row,(d,g)=>(se(),Et(y(ev),{key:`tr1-${g}`,cell:d,tag:"th",type:"label"},null,8,["cell"]))),128))]),je("tr",null,[(se(!0),Ie(Fn,null,Fo(i.row,(d,g)=>(se(),Et(y(ev),{key:`tr2-${g}`,cell:d,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(se(),Ie("tr",{key:1},[(se(!0),Ie(Fn,null,Fo(i.row,(d,g)=>(se(),Ie(Fn,{key:`tr3-${g}`},[y(t).border?(se(),Ie(Fn,{key:0},[Ye(y(ev),{cell:d,tag:"td",type:"label"},null,8,["cell"]),Ye(y(ev),{cell:d,tag:"td",type:"content"},null,8,["cell"])],64)):(se(),Et(y(ev),{key:1,cell:d,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var Wee=fn(Gee,[["__file","descriptions-row.vue"]]);const qee=cn({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:ki,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),Kee=qe({name:"ElDescriptions"}),Zee=qe({...Kee,props:qee,setup(e){const t=e,i=Xt("descriptions"),a=Mi(),d=Ri();Bo(GT,t);const g=ee(()=>[i.b(),i.m(a.value)]),_=(S,E,I,R=!1)=>(S.props||(S.props={}),E>I&&(S.props.span=I),R&&(S.props.span=E),S),o=()=>{if(!d.default)return[];const S=qu(d.default()).filter($=>{var F;return((F=$==null?void 0:$.type)==null?void 0:F.name)==="ElDescriptionsItem"}),E=[];let I=[],R=t.column,z=0;const N=[];return S.forEach(($,F)=>{var W,U,re;const K=((W=$.props)==null?void 0:W.span)||1,q=((U=$.props)==null?void 0:U.rowspan)||1,J=E.length;if(N[J]||(N[J]=0),q>1)for(let oe=1;oe<q;oe++)N[re=J+oe]||(N[re]=0),N[J+oe]++,z++;if(N[J]>0&&(R-=N[J],N[J]=0),F<S.length-1&&(z+=K>R?R:K),F===S.length-1){const oe=t.column-z%t.column;I.push(_($,oe,R,!0)),E.push(I);return}K<R?(R-=K,I.push($)):(I.push(_($,K,R)),E.push(I),R=t.column,I=[])}),E};return(S,E)=>(se(),Ie("div",{class:ue(y(g))},[S.title||S.extra||S.$slots.title||S.$slots.extra?(se(),Ie("div",{key:0,class:ue(y(i).e("header"))},[je("div",{class:ue(y(i).e("title"))},[vt(S.$slots,"title",{},()=>[$o(mn(S.title),1)])],2),je("div",{class:ue(y(i).e("extra"))},[vt(S.$slots,"extra",{},()=>[$o(mn(S.extra),1)])],2)],2)):yt("v-if",!0),je("div",{class:ue(y(i).e("body"))},[je("table",{class:ue([y(i).e("table"),y(i).is("bordered",S.border)])},[je("tbody",null,[(se(!0),Ie(Fn,null,Fo(o(),(I,R)=>(se(),Et(Wee,{key:R,row:I},null,8,["row"]))),128))])],2)],2)],2))}});var Yee=fn(Zee,[["__file","description.vue"]]);const Xee=cn({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),YO=qe({name:"ElDescriptionsItem",props:Xee}),Jee=uo(Yee,{DescriptionsItem:YO}),Qee=ri(YO),ete=cn({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:at([String,Array,Object])},zIndex:{type:at([String,Number])}}),tte={click:e=>e instanceof MouseEvent},nte="overlay";var ote=qe({name:"ElOverlay",props:ete,emits:tte,setup(e,{slots:t,emit:i}){const a=Xt(nte),d=S=>{i("click",S)},{onClick:g,onMousedown:_,onMouseup:o}=bT(e.customMaskEvent?void 0:d);return()=>e.mask?Ye("div",{class:[a.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:g,onMousedown:_,onMouseup:o},[vt(t,"default")],Da.STYLE|Da.CLASS|Da.PROPS,["onClick","onMouseup","onMousedown"]):Kn("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[vt(t,"default")])}});const WT=ote,XO=Symbol("dialogInjectionKey"),JO=cn({center:Boolean,alignCenter:Boolean,closeIcon:{type:Cr},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),rte={close:()=>!0},ite=qe({name:"ElDialogContent"}),ste=qe({...ite,props:JO,emits:rte,setup(e,{expose:t}){const i=e,{t:a}=qo(),{Close:d}=aT,{dialogRef:g,headerRef:_,bodyId:o,ns:S,style:E}=kn(XO),{focusTrapRef:I}=kn(LT),R=ee(()=>[S.b(),S.is("fullscreen",i.fullscreen),S.is("draggable",i.draggable),S.is("align-center",i.alignCenter),{[S.m("center")]:i.center}]),z=Kb(I,g),N=ee(()=>i.draggable),$=ee(()=>i.overflow),{resetPosition:F}=WD(g,_,N,$);return t({resetPosition:F}),(W,U)=>(se(),Ie("div",{ref:y(z),class:ue(y(R)),style:$n(y(E)),tabindex:"-1"},[je("header",{ref_key:"headerRef",ref:_,class:ue([y(S).e("header"),{"show-close":W.showClose}])},[vt(W.$slots,"header",{},()=>[je("span",{role:"heading","aria-level":W.ariaLevel,class:ue(y(S).e("title"))},mn(W.title),11,["aria-level"])]),W.showClose?(se(),Ie("button",{key:0,"aria-label":y(a)("el.dialog.close"),class:ue(y(S).e("headerbtn")),type:"button",onClick:re=>W.$emit("close")},[Ye(y(Dn),{class:ue(y(S).e("close"))},{default:it(()=>[(se(),Et(ko(W.closeIcon||y(d))))]),_:1},8,["class"])],10,["aria-label","onClick"])):yt("v-if",!0)],2),je("div",{id:y(o),class:ue(y(S).e("body"))},[vt(W.$slots,"default")],10,["id"]),W.$slots.footer?(se(),Ie("footer",{key:0,class:ue(y(S).e("footer"))},[vt(W.$slots,"footer")],2)):yt("v-if",!0)],6))}});var ate=fn(ste,[["__file","dialog-content.vue"]]);const QO=cn({...JO,appendToBody:Boolean,appendTo:{type:at([String,Object]),default:"body"},beforeClose:{type:at(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),ez={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[xo]:e=>Lr(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},tz=(e,t)=>{var i;const d=To().emit,{nextZIndex:g}=qp();let _="";const o=Ki(),S=Ki(),E=xe(!1),I=xe(!1),R=xe(!1),z=xe((i=e.zIndex)!=null?i:g());let N,$;const F=n1("namespace",pv),W=ee(()=>{const Ee={},ye=`--${F.value}-dialog`;return e.fullscreen||(e.top&&(Ee[`${ye}-margin-top`]=e.top),e.width&&(Ee[`${ye}-width`]=fi(e.width))),Ee}),U=ee(()=>e.alignCenter?{display:"flex"}:{});function re(){d("opened")}function K(){d("closed"),d(xo,!1),e.destroyOnClose&&(R.value=!1)}function q(){d("close")}function J(){$==null||$(),N==null||N(),e.openDelay&&e.openDelay>0?{stop:N}=wh(()=>ge(),e.openDelay):ge()}function oe(){N==null||N(),$==null||$(),e.closeDelay&&e.closeDelay>0?{stop:$}=wh(()=>ce(),e.closeDelay):ce()}function ae(){function Ee(ye){ye||(I.value=!0,E.value=!1)}e.beforeClose?e.beforeClose(Ee):oe()}function fe(){e.closeOnClickModal&&ae()}function ge(){Wo&&(E.value=!0)}function ce(){E.value=!1}function de(){d("openAutoFocus")}function _e(){d("closeAutoFocus")}function Re(Ee){var ye;((ye=Ee.detail)==null?void 0:ye.focusReason)==="pointer"&&Ee.preventDefault()}e.lockScroll&&dT(E);function Qe(){e.closeOnPressEscape&&ae()}return qt(()=>e.modelValue,Ee=>{Ee?(I.value=!1,J(),R.value=!0,z.value=DD(e.zIndex)?g():z.value++,Un(()=>{d("open"),t.value&&(t.value.scrollTop=0)})):E.value&&oe()}),qt(()=>e.fullscreen,Ee=>{t.value&&(Ee?(_=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=_)}),_o(()=>{e.modelValue&&(E.value=!0,R.value=!0,J())}),{afterEnter:re,afterLeave:K,beforeLeave:q,handleClose:ae,onModalClick:fe,close:oe,doClose:ce,onOpenAutoFocus:de,onCloseAutoFocus:_e,onCloseRequested:Qe,onFocusoutPrevented:Re,titleId:o,bodyId:S,closed:I,style:W,overlayDialogStyle:U,rendered:R,visible:E,zIndex:z}},lte=qe({name:"ElDialog",inheritAttrs:!1}),cte=qe({...lte,props:QO,emits:ez,setup(e,{expose:t}){const i=e,a=Ri();Ku({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},ee(()=>!!a.title));const d=Xt("dialog"),g=xe(),_=xe(),o=xe(),{visible:S,titleId:E,bodyId:I,style:R,overlayDialogStyle:z,rendered:N,zIndex:$,afterEnter:F,afterLeave:W,beforeLeave:U,handleClose:re,onModalClick:K,onOpenAutoFocus:q,onCloseAutoFocus:J,onCloseRequested:oe,onFocusoutPrevented:ae}=tz(i,g);Bo(XO,{dialogRef:g,headerRef:_,bodyId:I,ns:d,rendered:N,style:R});const fe=bT(K),ge=ee(()=>i.draggable&&!i.fullscreen);return t({visible:S,dialogContentRef:o,resetPosition:()=>{var de;(de=o.value)==null||de.resetPosition()}}),(de,_e)=>(se(),Et(y(Yp),{to:de.appendTo,disabled:de.appendTo!=="body"?!1:!de.appendToBody},{default:it(()=>[Ye(Ui,{name:"dialog-fade",onAfterEnter:y(F),onAfterLeave:y(W),onBeforeLeave:y(U),persisted:""},{default:it(()=>[vo(Ye(y(WT),{"custom-mask-event":"",mask:de.modal,"overlay-class":de.modalClass,"z-index":y($)},{default:it(()=>[je("div",{role:"dialog","aria-modal":"true","aria-label":de.title||void 0,"aria-labelledby":de.title?void 0:y(E),"aria-describedby":y(I),class:ue(`${y(d).namespace.value}-overlay-dialog`),style:$n(y(z)),onClick:y(fe).onClick,onMousedown:y(fe).onMousedown,onMouseup:y(fe).onMouseup},[Ye(y(h_),{loop:"",trapped:y(S),"focus-start-el":"container",onFocusAfterTrapped:y(q),onFocusAfterReleased:y(J),onFocusoutPrevented:y(ae),onReleaseRequested:y(oe)},{default:it(()=>[y(N)?(se(),Et(ate,Po({key:0,ref_key:"dialogContentRef",ref:o},de.$attrs,{center:de.center,"align-center":de.alignCenter,"close-icon":de.closeIcon,draggable:y(ge),overflow:de.overflow,fullscreen:de.fullscreen,"show-close":de.showClose,title:de.title,"aria-level":de.headerAriaLevel,onClose:y(re)}),Na({header:it(()=>[de.$slots.title?vt(de.$slots,"title",{key:1}):vt(de.$slots,"header",{key:0,close:y(re),titleId:y(E),titleClass:y(d).e("title")})]),default:it(()=>[vt(de.$slots,"default")]),_:2},[de.$slots.footer?{name:"footer",fn:it(()=>[vt(de.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):yt("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[ir,y(S)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var ute=fn(cte,[["__file","dialog.vue"]]);const dte=uo(ute),hte=cn({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:at(String),default:"solid"}}),fte=qe({name:"ElDivider"}),pte=qe({...fte,props:hte,setup(e){const t=e,i=Xt("divider"),a=ee(()=>i.cssVar({"border-style":t.borderStyle}));return(d,g)=>(se(),Ie("div",{class:ue([y(i).b(),y(i).m(d.direction)]),style:$n(y(a)),role:"separator"},[d.$slots.default&&d.direction!=="vertical"?(se(),Ie("div",{key:0,class:ue([y(i).e("text"),y(i).is(d.contentPosition)])},[vt(d.$slots,"default")],2)):yt("v-if",!0)],6))}});var mte=fn(pte,[["__file","divider.vue"]]);const nz=uo(mte),gte=cn({...QO,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),vte=ez,_te=qe({name:"ElDrawer",inheritAttrs:!1}),yte=qe({..._te,props:gte,emits:vte,setup(e,{expose:t}){const i=e,a=Ri();Ku({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},ee(()=>!!a.title));const d=xe(),g=xe(),_=Xt("drawer"),{t:o}=qo(),{afterEnter:S,afterLeave:E,beforeLeave:I,visible:R,rendered:z,titleId:N,bodyId:$,zIndex:F,onModalClick:W,onOpenAutoFocus:U,onCloseAutoFocus:re,onFocusoutPrevented:K,onCloseRequested:q,handleClose:J}=tz(i,d),oe=ee(()=>i.direction==="rtl"||i.direction==="ltr"),ae=ee(()=>fi(i.size));return t({handleClose:J,afterEnter:S,afterLeave:E}),(fe,ge)=>(se(),Et(y(Yp),{to:fe.appendTo,disabled:fe.appendTo!=="body"?!1:!fe.appendToBody},{default:it(()=>[Ye(Ui,{name:y(_).b("fade"),onAfterEnter:y(S),onAfterLeave:y(E),onBeforeLeave:y(I),persisted:""},{default:it(()=>[vo(Ye(y(WT),{mask:fe.modal,"overlay-class":fe.modalClass,"z-index":y(F),onClick:y(W)},{default:it(()=>[Ye(y(h_),{loop:"",trapped:y(R),"focus-trap-el":d.value,"focus-start-el":g.value,onFocusAfterTrapped:y(U),onFocusAfterReleased:y(re),onFocusoutPrevented:y(K),onReleaseRequested:y(q)},{default:it(()=>[je("div",Po({ref_key:"drawerRef",ref:d,"aria-modal":"true","aria-label":fe.title||void 0,"aria-labelledby":fe.title?void 0:y(N),"aria-describedby":y($)},fe.$attrs,{class:[y(_).b(),fe.direction,y(R)&&"open"],style:y(oe)?"width: "+y(ae):"height: "+y(ae),role:"dialog",onClick:Xn(()=>{},["stop"])}),[je("span",{ref_key:"focusStartRef",ref:g,class:ue(y(_).e("sr-focus")),tabindex:"-1"},null,2),fe.withHeader?(se(),Ie("header",{key:0,class:ue(y(_).e("header"))},[fe.$slots.title?vt(fe.$slots,"title",{key:1},()=>[yt(" DEPRECATED SLOT ")]):vt(fe.$slots,"header",{key:0,close:y(J),titleId:y(N),titleClass:y(_).e("title")},()=>[fe.$slots.title?yt("v-if",!0):(se(),Ie("span",{key:0,id:y(N),role:"heading","aria-level":fe.headerAriaLevel,class:ue(y(_).e("title"))},mn(fe.title),11,["id","aria-level"]))]),fe.showClose?(se(),Ie("button",{key:2,"aria-label":y(o)("el.drawer.close"),class:ue(y(_).e("close-btn")),type:"button",onClick:y(J)},[Ye(y(Dn),{class:ue(y(_).e("close"))},{default:it(()=>[Ye(y(yl))]),_:1},8,["class"])],10,["aria-label","onClick"])):yt("v-if",!0)],2)):yt("v-if",!0),y(z)?(se(),Ie("div",{key:1,id:y($),class:ue(y(_).e("body"))},[vt(fe.$slots,"default")],10,["id"])):yt("v-if",!0),fe.$slots.footer?(se(),Ie("div",{key:2,class:ue(y(_).e("footer"))},[vt(fe.$slots,"footer")],2)):yt("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[ir,y(R)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var bte=fn(yte,[["__file","drawer.vue"]]);const xte=uo(bte),wte=qe({inheritAttrs:!1});function Ste(e,t,i,a,d,g){return vt(e.$slots,"default")}var Tte=fn(wte,[["render",Ste],["__file","collection.vue"]]);const Cte=qe({name:"ElCollectionItem",inheritAttrs:!1});function Ete(e,t,i,a,d,g){return vt(e.$slots,"default")}var Mte=fn(Cte,[["render",Ete],["__file","collection-item.vue"]]);const oz="data-el-collection-item",rz=e=>{const t=`El${e}Collection`,i=`${t}Item`,a=Symbol(t),d=Symbol(i),g={...Tte,name:t,setup(){const o=xe(null),S=new Map;Bo(a,{itemMap:S,getItems:()=>{const I=y(o);if(!I)return[];const R=Array.from(I.querySelectorAll(`[${oz}]`));return[...S.values()].sort((N,$)=>R.indexOf(N.ref)-R.indexOf($.ref))},collectionRef:o})}},_={...Mte,name:i,setup(o,{attrs:S}){const E=xe(null),I=kn(a,void 0);Bo(d,{collectionItemRef:E}),_o(()=>{const R=y(E);R&&I.itemMap.set(R,{ref:R,...S})}),Pr(()=>{const R=y(E);I.itemMap.delete(R)})}};return{COLLECTION_INJECTION_KEY:a,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:g,ElCollectionItem:_}},Ite=cn({style:{type:at([String,Array,Object])},currentTabId:{type:at(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:at(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:Ate,ElCollectionItem:kte,COLLECTION_INJECTION_KEY:qT,COLLECTION_ITEM_INJECTION_KEY:Pte}=rz("RovingFocusGroup"),KT=Symbol("elRovingFocusGroup"),iz=Symbol("elRovingFocusGroupItem"),Rte={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},Dte=(e,t)=>e,Lte=(e,t,i)=>{const a=Dte(e.code);return Rte[a]},Ote=(e,t)=>e.map((i,a)=>e[(a+t)%e.length]),ZT=e=>{const{activeElement:t}=document;for(const i of e)if(i===t||(i.focus(),t!==document.activeElement))return},I3="currentTabIdChange",A3="rovingFocusGroup.entryFocus",zte={bubbles:!1,cancelable:!0},Bte=qe({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:Ite,emits:[I3,"entryFocus"],setup(e,{emit:t}){var i;const a=xe((i=e.currentTabId||e.defaultCurrentTabId)!=null?i:null),d=xe(!1),g=xe(!1),_=xe(null),{getItems:o}=kn(qT,void 0),S=ee(()=>[{outline:"none"},e.style]),E=F=>{t(I3,F)},I=()=>{d.value=!0},R=hi(F=>{var W;(W=e.onMousedown)==null||W.call(e,F)},()=>{g.value=!0}),z=hi(F=>{var W;(W=e.onFocus)==null||W.call(e,F)},F=>{const W=!y(g),{target:U,currentTarget:re}=F;if(U===re&&W&&!y(d)){const K=new Event(A3,zte);if(re==null||re.dispatchEvent(K),!K.defaultPrevented){const q=o().filter(ge=>ge.focusable),J=q.find(ge=>ge.active),oe=q.find(ge=>ge.id===y(a)),fe=[J,oe,...q].filter(Boolean).map(ge=>ge.ref);ZT(fe)}}g.value=!1}),N=hi(F=>{var W;(W=e.onBlur)==null||W.call(e,F)},()=>{d.value=!1}),$=(...F)=>{t("entryFocus",...F)};Bo(KT,{currentTabbedId:Vp(a),loop:mr(e,"loop"),tabIndex:ee(()=>y(d)?-1:0),rovingFocusGroupRef:_,rovingFocusGroupRootStyle:S,orientation:mr(e,"orientation"),dir:mr(e,"dir"),onItemFocus:E,onItemShiftTab:I,onBlur:N,onFocus:z,onMousedown:R}),qt(()=>e.currentTabId,F=>{a.value=F??null}),wr(_,A3,$)}});function Fte(e,t,i,a,d,g){return vt(e.$slots,"default")}var Nte=fn(Bte,[["render",Fte],["__file","roving-focus-group-impl.vue"]]);const $te=qe({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:Ate,ElRovingFocusGroupImpl:Nte}});function Vte(e,t,i,a,d,g){const _=Mo("el-roving-focus-group-impl"),o=Mo("el-focus-group-collection");return se(),Et(o,null,{default:it(()=>[Ye(_,hl(Xu(e.$attrs)),{default:it(()=>[vt(e.$slots,"default")]),_:3},16)]),_:3})}var Ute=fn($te,[["render",Vte],["__file","roving-focus-group.vue"]]);const jte=qe({components:{ElRovingFocusCollectionItem:kte},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:i,loop:a,onItemFocus:d,onItemShiftTab:g}=kn(KT,void 0),{getItems:_}=kn(qT,void 0),o=Ki(),S=xe(null),E=hi(N=>{t("mousedown",N)},N=>{e.focusable?d(y(o)):N.preventDefault()}),I=hi(N=>{t("focus",N)},()=>{d(y(o))}),R=hi(N=>{t("keydown",N)},N=>{const{code:$,shiftKey:F,target:W,currentTarget:U}=N;if($===Cn.tab&&F){g();return}if(W!==U)return;const re=Lte(N);if(re){N.preventDefault();let q=_().filter(J=>J.focusable).map(J=>J.ref);switch(re){case"last":{q.reverse();break}case"prev":case"next":{re==="prev"&&q.reverse();const J=q.indexOf(U);q=a.value?Ote(q,J+1):q.slice(J+1);break}}Un(()=>{ZT(q)})}}),z=ee(()=>i.value===y(o));return Bo(iz,{rovingFocusGroupItemRef:S,tabIndex:ee(()=>y(z)?0:-1),handleMousedown:E,handleFocus:I,handleKeydown:R}),{id:o,handleKeydown:R,handleFocus:I,handleMousedown:E}}});function Hte(e,t,i,a,d,g){const _=Mo("el-roving-focus-collection-item");return se(),Et(_,{id:e.id,focusable:e.focusable,active:e.active},{default:it(()=>[vt(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var Gte=fn(jte,[["render",Hte],["__file","roving-focus-item.vue"]]);const $0=cn({trigger:Fv.trigger,effect:{...Fi.effect,default:"light"},type:{type:at(String)},placement:{type:at(String),default:"bottom"},popperOptions:{type:at(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:at([Number,String]),default:0},maxHeight:{type:at([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,default:"menu"},buttonProps:{type:at(Object)},teleported:Fi.teleported}),sz=cn({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Cr}}),Wte=cn({onKeydown:{type:at(Function)}}),qte=[Cn.down,Cn.pageDown,Cn.home],az=[Cn.up,Cn.pageUp,Cn.end],Kte=[...qte,...az],{ElCollection:Zte,ElCollectionItem:Yte,COLLECTION_INJECTION_KEY:Xte,COLLECTION_ITEM_INJECTION_KEY:Jte}=rz("Dropdown"),l1=Symbol("elDropdown"),{ButtonGroup:Qte}=$i,ene=qe({name:"ElDropdown",components:{ElButton:$i,ElButtonGroup:Qte,ElScrollbar:nc,ElDropdownCollection:Zte,ElTooltip:rs,ElRovingFocusGroup:Ute,ElOnlyChild:LL,ElIcon:Dn,ArrowDown:Oc},props:$0,emits:["visible-change","click","command"],setup(e,{emit:t}){const i=To(),a=Xt("dropdown"),{t:d}=qo(),g=xe(),_=xe(),o=xe(null),S=xe(null),E=xe(null),I=xe(null),R=xe(!1),z=[Cn.enter,Cn.numpadEnter,Cn.space,Cn.down],N=ee(()=>({maxHeight:fi(e.maxHeight)})),$=ee(()=>[a.m(J.value)]),F=ee(()=>gs(e.trigger)),W=Ki().value,U=ee(()=>e.id||W);qt([g,F],([Me,Te],[he])=>{var ke,Ne,nt;(ke=he==null?void 0:he.$el)!=null&&ke.removeEventListener&&he.$el.removeEventListener("pointerenter",ae),(Ne=Me==null?void 0:Me.$el)!=null&&Ne.removeEventListener&&Me.$el.removeEventListener("pointerenter",ae),(nt=Me==null?void 0:Me.$el)!=null&&nt.addEventListener&&Te.includes("hover")&&Me.$el.addEventListener("pointerenter",ae)},{immediate:!0}),Pr(()=>{var Me,Te;(Te=(Me=g.value)==null?void 0:Me.$el)!=null&&Te.removeEventListener&&g.value.$el.removeEventListener("pointerenter",ae)});function re(){K()}function K(){var Me;(Me=o.value)==null||Me.onClose()}function q(){var Me;(Me=o.value)==null||Me.onOpen()}const J=Mi();function oe(...Me){t("command",...Me)}function ae(){var Me,Te;(Te=(Me=g.value)==null?void 0:Me.$el)==null||Te.focus()}function fe(){}function ge(){const Me=y(S);F.value.includes("hover")&&(Me==null||Me.focus()),I.value=null}function ce(Me){I.value=Me}function de(Me){R.value||(Me.preventDefault(),Me.stopImmediatePropagation())}function _e(){t("visible-change",!0)}function Re(Me){(Me==null?void 0:Me.type)==="keydown"&&S.value.focus()}function Qe(){t("visible-change",!1)}return Bo(l1,{contentRef:S,role:ee(()=>e.role),triggerId:U,isUsingKeyboard:R,onItemEnter:fe,onItemLeave:ge}),Bo("elDropdown",{instance:i,dropdownSize:J,handleClick:re,commandHandler:oe,trigger:mr(e,"trigger"),hideOnClick:mr(e,"hideOnClick")}),{t:d,ns:a,scrollbar:E,wrapStyle:N,dropdownTriggerKls:$,dropdownSize:J,triggerId:U,triggerKeys:z,currentTabId:I,handleCurrentTabIdChange:ce,handlerMainButtonClick:Me=>{t("click",Me)},handleEntryFocus:de,handleClose:K,handleOpen:q,handleBeforeShowTooltip:_e,handleShowTooltip:Re,handleBeforeHideTooltip:Qe,onFocusAfterTrapped:Me=>{var Te,he;Me.preventDefault(),(he=(Te=S.value)==null?void 0:Te.focus)==null||he.call(Te,{preventScroll:!0})},popperRef:o,contentRef:S,triggeringElementRef:g,referenceElementRef:_}}});function tne(e,t,i,a,d,g){var _;const o=Mo("el-dropdown-collection"),S=Mo("el-roving-focus-group"),E=Mo("el-scrollbar"),I=Mo("el-only-child"),R=Mo("el-tooltip"),z=Mo("el-button"),N=Mo("arrow-down"),$=Mo("el-icon"),F=Mo("el-button-group");return se(),Ie("div",{class:ue([e.ns.b(),e.ns.is("disabled",e.disabled)])},[Ye(R,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(_=e.referenceElementRef)==null?void 0:_.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},Na({content:it(()=>[Ye(E,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:it(()=>[Ye(S,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:it(()=>[Ye(o,null,{default:it(()=>[vt(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:it(()=>[Ye(I,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:it(()=>[vt(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(se(),Et(F,{key:0},{default:it(()=>[Ye(z,Po({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:it(()=>[vt(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),Ye(z,Po({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:it(()=>[Ye($,{class:ue(e.ns.e("icon"))},{default:it(()=>[Ye(N)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):yt("v-if",!0)],2)}var nne=fn(ene,[["render",tne],["__file","dropdown.vue"]]);const one=qe({name:"DropdownItemImpl",components:{ElIcon:Dn},props:sz,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const i=Xt("dropdown"),{role:a}=kn(l1,void 0),{collectionItemRef:d}=kn(Jte,void 0),{collectionItemRef:g}=kn(Pte,void 0),{rovingFocusGroupItemRef:_,tabIndex:o,handleFocus:S,handleKeydown:E,handleMousedown:I}=kn(iz,void 0),R=Kb(d,g,_),z=ee(()=>a.value==="menu"?"menuitem":a.value==="navigation"?"link":"button"),N=hi($=>{if([Cn.enter,Cn.numpadEnter,Cn.space].includes($.code))return $.preventDefault(),$.stopImmediatePropagation(),t("clickimpl",$),!0},E);return{ns:i,itemRef:R,dataset:{[oz]:""},role:z,tabIndex:o,handleFocus:S,handleKeydown:N,handleMousedown:I}}});function rne(e,t,i,a,d,g){const _=Mo("el-icon");return se(),Ie(Fn,null,[e.divided?(se(),Ie("li",{key:0,role:"separator",class:ue(e.ns.bem("menu","item","divided"))},null,2)):yt("v-if",!0),je("li",Po({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:o=>e.$emit("clickimpl",o),onFocus:e.handleFocus,onKeydown:Xn(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:o=>e.$emit("pointermove",o),onPointerleave:o=>e.$emit("pointerleave",o)}),[e.icon?(se(),Et(_,{key:0},{default:it(()=>[(se(),Et(ko(e.icon)))]),_:1})):yt("v-if",!0),vt(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var ine=fn(one,[["render",rne],["__file","dropdown-item-impl.vue"]]);const lz=()=>{const e=kn("elDropdown",{}),t=ee(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},sne=qe({name:"ElDropdownItem",components:{ElDropdownCollectionItem:Yte,ElRovingFocusItem:Gte,ElDropdownItemImpl:ine},inheritAttrs:!1,props:sz,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:i}){const{elDropdown:a}=lz(),d=To(),g=xe(null),_=ee(()=>{var N,$;return($=(N=y(g))==null?void 0:N.textContent)!=null?$:""}),{onItemEnter:o,onItemLeave:S}=kn(l1,void 0),E=hi(N=>(t("pointermove",N),N.defaultPrevented),EA(N=>{if(e.disabled){S(N);return}const $=N.currentTarget;$===document.activeElement||$.contains(document.activeElement)||(o(N),N.defaultPrevented||$==null||$.focus())})),I=hi(N=>(t("pointerleave",N),N.defaultPrevented),EA(S)),R=hi(N=>{if(!e.disabled)return t("click",N),N.type!=="keydown"&&N.defaultPrevented},N=>{var $,F,W;if(e.disabled){N.stopImmediatePropagation();return}($=a==null?void 0:a.hideOnClick)!=null&&$.value&&((F=a.handleClick)==null||F.call(a)),(W=a.commandHandler)==null||W.call(a,e.command,d,N)}),z=ee(()=>({...e,...i}));return{handleClick:R,handlePointerMove:E,handlePointerLeave:I,textContent:_,propsAndAttrs:z}}});function ane(e,t,i,a,d,g){var _;const o=Mo("el-dropdown-item-impl"),S=Mo("el-roving-focus-item"),E=Mo("el-dropdown-collection-item");return se(),Et(E,{disabled:e.disabled,"text-value":(_=e.textValue)!=null?_:e.textContent},{default:it(()=>[Ye(S,{focusable:!e.disabled},{default:it(()=>[Ye(o,Po(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:it(()=>[vt(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var cz=fn(sne,[["render",ane],["__file","dropdown-item.vue"]]);const lne=qe({name:"ElDropdownMenu",props:Wte,setup(e){const t=Xt("dropdown"),{_elDropdownSize:i}=lz(),a=i.value,{focusTrapRef:d,onKeydown:g}=kn(LT,void 0),{contentRef:_,role:o,triggerId:S}=kn(l1,void 0),{collectionRef:E,getItems:I}=kn(Xte,void 0),{rovingFocusGroupRef:R,rovingFocusGroupRootStyle:z,tabIndex:N,onBlur:$,onFocus:F,onMousedown:W}=kn(KT,void 0),{collectionRef:U}=kn(qT,void 0),re=ee(()=>[t.b("menu"),t.bm("menu",a==null?void 0:a.value)]),K=Kb(_,E,d,R,U),q=hi(oe=>{var ae;(ae=e.onKeydown)==null||ae.call(e,oe)},oe=>{const{currentTarget:ae,code:fe,target:ge}=oe;if(ae.contains(ge),Cn.tab===fe&&oe.stopImmediatePropagation(),oe.preventDefault(),ge!==y(_)||!Kte.includes(fe))return;const de=I().filter(_e=>!_e.disabled).map(_e=>_e.ref);az.includes(fe)&&de.reverse(),ZT(de)});return{size:a,rovingFocusGroupRootStyle:z,tabIndex:N,dropdownKls:re,role:o,triggerId:S,dropdownListWrapperRef:K,handleKeydown:oe=>{q(oe),g(oe)},onBlur:$,onFocus:F,onMousedown:W}}});function cne(e,t,i,a,d,g){return se(),Ie("ul",{ref:e.dropdownListWrapperRef,class:ue(e.dropdownKls),style:$n(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:Xn(e.handleKeydown,["self"]),onMousedown:Xn(e.onMousedown,["self"])},[vt(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var uz=fn(lne,[["render",cne],["__file","dropdown-menu.vue"]]);const une=uo(nne,{DropdownItem:cz,DropdownMenu:uz}),dne=ri(cz),hne=ri(uz),fne=qe({name:"ImgEmpty"}),pne=qe({...fne,setup(e){const t=Xt("empty"),i=Ki();return(a,d)=>(se(),Ie("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[je("defs",null,[je("linearGradient",{id:`linearGradient-1-${y(i)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[je("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),je("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),je("linearGradient",{id:`linearGradient-2-${y(i)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[je("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),je("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),je("rect",{id:`path-3-${y(i)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),je("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[je("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[je("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[je("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${y(t).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),je("polygon",{id:"Rectangle-Copy-14",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),je("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[je("polygon",{id:"Rectangle-Copy-10",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),je("polygon",{id:"Rectangle-Copy-11",fill:`var(${y(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),je("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${y(i)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),je("polygon",{id:"Rectangle-Copy-13",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),je("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${y(i)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),je("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[je("use",{id:"Mask",fill:`var(${y(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${y(i)}`},null,8,["fill","xlink:href"]),je("polygon",{id:"Rectangle-Copy",fill:`var(${y(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${y(i)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),je("polygon",{id:"Rectangle-Copy-18",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var mne=fn(pne,[["__file","img-empty.vue"]]);const gne=cn({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),vne=qe({name:"ElEmpty"}),_ne=qe({...vne,props:gne,setup(e){const t=e,{t:i}=qo(),a=Xt("empty"),d=ee(()=>t.description||i("el.table.emptyText")),g=ee(()=>({width:fi(t.imageSize)}));return(_,o)=>(se(),Ie("div",{class:ue(y(a).b())},[je("div",{class:ue(y(a).e("image")),style:$n(y(g))},[_.image?(se(),Ie("img",{key:0,src:_.image,ondragstart:"return false"},null,8,["src"])):vt(_.$slots,"image",{key:1},()=>[Ye(mne)])],6),je("div",{class:ue(y(a).e("description"))},[_.$slots.description?vt(_.$slots,"description",{key:0}):(se(),Ie("p",{key:1},mn(y(d)),1))],2),_.$slots.default?(se(),Ie("div",{key:0,class:ue(y(a).e("bottom"))},[vt(_.$slots,"default")],2)):yt("v-if",!0)],2))}});var yne=fn(_ne,[["__file","empty.vue"]]);const dz=uo(yne),bne=cn({urlList:{type:at(Array),default:()=>oi([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:at(String)}}),xne={close:()=>!0,switch:e=>Wn(e),rotate:e=>Wn(e)},wne=qe({name:"ElImageViewer"}),Sne=qe({...wne,props:bne,emits:xne,setup(e,{expose:t,emit:i}){var a;const d=e,g={CONTAIN:{name:"contain",icon:Wu(PG)},ORIGINAL:{name:"original",icon:Wu(XG)}},{t:_}=qo(),o=Xt("image-viewer"),{nextZIndex:S}=qp(),E=xe(),I=xe([]),R=DN(),z=xe(!0),N=xe(d.initialIndex),$=qr(g.CONTAIN),F=xe({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),W=xe((a=d.zIndex)!=null?a:S()),U=ee(()=>{const{urlList:ke}=d;return ke.length<=1}),re=ee(()=>N.value===0),K=ee(()=>N.value===d.urlList.length-1),q=ee(()=>d.urlList[N.value]),J=ee(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!d.infinite&&re.value)]),oe=ee(()=>[o.e("btn"),o.e("next"),o.is("disabled",!d.infinite&&K.value)]),ae=ee(()=>{const{scale:ke,deg:Ne,offsetX:nt,offsetY:De,enableTransition:Ct}=F.value;let Rt=nt/ke,Bt=De/ke;const mt=Ne*Math.PI/180,Gt=Math.cos(mt),jt=Math.sin(mt);Rt=Rt*Gt+Bt*jt,Bt=Bt*Gt-nt/ke*jt;const Be={transform:`scale(${ke}) rotate(${Ne}deg) translate(${Rt}px, ${Bt}px)`,transition:Ct?"transform .3s":""};return $.value.name===g.CONTAIN.name&&(Be.maxWidth=Be.maxHeight="100%"),Be});function fe(){ce(),i("close")}function ge(){const ke=gh(nt=>{switch(nt.code){case Cn.esc:d.closeOnPressEscape&&fe();break;case Cn.space:Ee();break;case Cn.left:Me();break;case Cn.up:he("zoomIn");break;case Cn.right:Te();break;case Cn.down:he("zoomOut");break}}),Ne=gh(nt=>{const De=nt.deltaY||nt.deltaX;he(De<0?"zoomIn":"zoomOut",{zoomRate:d.zoomRate,enableTransition:!1})});R.run(()=>{wr(document,"keydown",ke),wr(document,"wheel",Ne)})}function ce(){R.stop()}function de(){z.value=!1}function _e(ke){z.value=!1,ke.target.alt=_("el.image.error")}function Re(ke){if(z.value||ke.button!==0||!E.value)return;F.value.enableTransition=!1;const{offsetX:Ne,offsetY:nt}=F.value,De=ke.pageX,Ct=ke.pageY,Rt=gh(mt=>{F.value={...F.value,offsetX:Ne+mt.pageX-De,offsetY:nt+mt.pageY-Ct}}),Bt=wr(document,"mousemove",Rt);wr(document,"mouseup",()=>{Bt()}),ke.preventDefault()}function Qe(){F.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Ee(){if(z.value)return;const ke=Mp(g),Ne=Object.values(g),nt=$.value.name,Ct=(Ne.findIndex(Rt=>Rt.name===nt)+1)%ke.length;$.value=g[ke[Ct]],Qe()}function ye(ke){const Ne=d.urlList.length;N.value=(ke+Ne)%Ne}function Me(){re.value&&!d.infinite||ye(N.value-1)}function Te(){K.value&&!d.infinite||ye(N.value+1)}function he(ke,Ne={}){if(z.value)return;const{minScale:nt,maxScale:De}=d,{zoomRate:Ct,rotateDeg:Rt,enableTransition:Bt}={zoomRate:d.zoomRate,rotateDeg:90,enableTransition:!0,...Ne};switch(ke){case"zoomOut":F.value.scale>nt&&(F.value.scale=Number.parseFloat((F.value.scale/Ct).toFixed(3)));break;case"zoomIn":F.value.scale<De&&(F.value.scale=Number.parseFloat((F.value.scale*Ct).toFixed(3)));break;case"clockwise":F.value.deg+=Rt,i("rotate",F.value.deg);break;case"anticlockwise":F.value.deg-=Rt,i("rotate",F.value.deg);break}F.value.enableTransition=Bt}return qt(q,()=>{Un(()=>{const ke=I.value[0];ke!=null&&ke.complete||(z.value=!0)})}),qt(N,ke=>{Qe(),i("switch",ke)}),_o(()=>{var ke,Ne;ge(),(Ne=(ke=E.value)==null?void 0:ke.focus)==null||Ne.call(ke)}),t({setActiveItem:ye}),(ke,Ne)=>(se(),Et(y(Yp),{to:"body",disabled:!ke.teleported},{default:it(()=>[Ye(Ui,{name:"viewer-fade",appear:""},{default:it(()=>[je("div",{ref_key:"wrapper",ref:E,tabindex:-1,class:ue(y(o).e("wrapper")),style:$n({zIndex:W.value})},[je("div",{class:ue(y(o).e("mask")),onClick:Xn(nt=>ke.hideOnClickModal&&fe(),["self"])},null,10,["onClick"]),yt(" CLOSE "),je("span",{class:ue([y(o).e("btn"),y(o).e("close")]),onClick:fe},[Ye(y(Dn),null,{default:it(()=>[Ye(y(yl))]),_:1})],2),yt(" ARROW "),y(U)?yt("v-if",!0):(se(),Ie(Fn,{key:0},[je("span",{class:ue(y(J)),onClick:Me},[Ye(y(Dn),null,{default:it(()=>[Ye(y(td))]),_:1})],2),je("span",{class:ue(y(oe)),onClick:Te},[Ye(y(Dn),null,{default:it(()=>[Ye(y(Fs))]),_:1})],2)],64)),yt(" ACTIONS "),je("div",{class:ue([y(o).e("btn"),y(o).e("actions")])},[je("div",{class:ue(y(o).e("actions__inner"))},[Ye(y(Dn),{onClick:nt=>he("zoomOut")},{default:it(()=>[Ye(y(fW))]),_:1},8,["onClick"]),Ye(y(Dn),{onClick:nt=>he("zoomIn")},{default:it(()=>[Ye(y(UD))]),_:1},8,["onClick"]),je("i",{class:ue(y(o).e("actions__divider"))},null,2),Ye(y(Dn),{onClick:Ee},{default:it(()=>[(se(),Et(ko(y($).icon)))]),_:1}),je("i",{class:ue(y(o).e("actions__divider"))},null,2),Ye(y(Dn),{onClick:nt=>he("anticlockwise")},{default:it(()=>[Ye(y(qG))]),_:1},8,["onClick"]),Ye(y(Dn),{onClick:nt=>he("clockwise")},{default:it(()=>[Ye(y(ZG))]),_:1},8,["onClick"])],2)],2),yt(" CANVAS "),je("div",{class:ue(y(o).e("canvas"))},[(se(!0),Ie(Fn,null,Fo(ke.urlList,(nt,De)=>vo((se(),Ie("img",{ref_for:!0,ref:Ct=>I.value[De]=Ct,key:nt,src:nt,style:$n(y(ae)),class:ue(y(o).e("img")),crossorigin:ke.crossorigin,onLoad:de,onError:_e,onMousedown:Re},null,46,["src","crossorigin"])),[[ir,De===N.value]])),128))],2),vt(ke.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var Tne=fn(Sne,[["__file","image-viewer.vue"]]);const hz=uo(Tne),Cne=cn({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:at([String,Object])},previewSrcList:{type:at(Array),default:()=>oi([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:at(String)}}),Ene={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Wn(e),close:()=>!0,show:()=>!0},Mne=qe({name:"ElImage",inheritAttrs:!1}),Ine=qe({...Mne,props:Cne,emits:Ene,setup(e,{emit:t}){const i=e;let a="";const{t:d}=qo(),g=Xt("image"),_=Ph(),o=ee(()=>Dv(Object.entries(_).filter(([Te])=>/^(data-|on[A-Z])/i.test(Te)||["id","style"].includes(Te)))),S=Zb({excludeListeners:!0,excludeKeys:ee(()=>Object.keys(o.value))}),E=xe(),I=xe(!1),R=xe(!0),z=xe(!1),N=xe(),$=xe(),F=Wo&&"loading"in HTMLImageElement.prototype;let W,U;const re=ee(()=>[g.e("inner"),q.value&&g.e("preview"),R.value&&g.is("loading")]),K=ee(()=>{const{fit:Te}=i;return Wo&&Te?{objectFit:Te}:{}}),q=ee(()=>{const{previewSrcList:Te}=i;return sn(Te)&&Te.length>0}),J=ee(()=>{const{previewSrcList:Te,initialIndex:he}=i;let ke=he;return he>Te.length-1&&(ke=0),ke}),oe=ee(()=>i.loading==="eager"?!1:!F&&i.loading==="lazy"||i.lazy),ae=()=>{Wo&&(R.value=!0,I.value=!1,E.value=i.src)};function fe(Te){R.value=!1,I.value=!1,t("load",Te)}function ge(Te){R.value=!1,I.value=!0,t("error",Te)}function ce(){M$(N.value,$.value)&&(ae(),Re())}const de=GR(ce,200,!0);async function _e(){var Te;if(!Wo)return;await Un();const{scrollContainer:he}=i;va(he)?$.value=he:Bn(he)&&he!==""?$.value=(Te=document.querySelector(he))!=null?Te:void 0:N.value&&($.value=tT(N.value)),$.value&&(W=wr($,"scroll",de),setTimeout(()=>ce(),100))}function Re(){!Wo||!$.value||!de||(W==null||W(),$.value=void 0)}function Qe(Te){if(Te.ctrlKey){if(Te.deltaY<0)return Te.preventDefault(),!1;if(Te.deltaY>0)return Te.preventDefault(),!1}}function Ee(){q.value&&(U=wr("wheel",Qe,{passive:!1}),a=document.body.style.overflow,document.body.style.overflow="hidden",z.value=!0,t("show"))}function ye(){U==null||U(),document.body.style.overflow=a,z.value=!1,t("close")}function Me(Te){t("switch",Te)}return qt(()=>i.src,()=>{oe.value?(R.value=!0,I.value=!1,Re(),_e()):ae()}),_o(()=>{oe.value?_e():ae()}),(Te,he)=>(se(),Ie("div",Po({ref_key:"container",ref:N},y(o),{class:[y(g).b(),Te.$attrs.class]}),[I.value?vt(Te.$slots,"error",{key:0},()=>[je("div",{class:ue(y(g).e("error"))},mn(y(d)("el.image.error")),3)]):(se(),Ie(Fn,{key:1},[E.value!==void 0?(se(),Ie("img",Po({key:0},y(S),{src:E.value,loading:Te.loading,style:y(K),class:y(re),crossorigin:Te.crossorigin,onClick:Ee,onLoad:fe,onError:ge}),null,16,["src","loading","crossorigin"])):yt("v-if",!0),R.value?(se(),Ie("div",{key:1,class:ue(y(g).e("wrapper"))},[vt(Te.$slots,"placeholder",{},()=>[je("div",{class:ue(y(g).e("placeholder"))},null,2)])],2)):yt("v-if",!0)],64)),y(q)?(se(),Ie(Fn,{key:2},[z.value?(se(),Et(y(hz),{key:0,"z-index":Te.zIndex,"initial-index":y(J),infinite:Te.infinite,"zoom-rate":Te.zoomRate,"min-scale":Te.minScale,"max-scale":Te.maxScale,"url-list":Te.previewSrcList,crossorigin:Te.crossorigin,"hide-on-click-modal":Te.hideOnClickModal,teleported:Te.previewTeleported,"close-on-press-escape":Te.closeOnPressEscape,onClose:ye,onSwitch:Me},{default:it(()=>[Te.$slots.viewer?(se(),Ie("div",{key:0},[vt(Te.$slots,"viewer")])):yt("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):yt("v-if",!0)],64)):yt("v-if",!0)],16))}});var Ane=fn(Ine,[["__file","image.vue"]]);const kne=uo(Ane),Pne=cn({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:ki,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||Wn(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...Zi(["ariaLabel"])}),Rne={[Wr]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Ns]:e=>Wn(e)||Pi(e),[xo]:e=>Wn(e)||Pi(e)},Dne=qe({name:"ElInputNumber"}),Lne=qe({...Dne,props:Pne,emits:Rne,setup(e,{expose:t,emit:i}){const a=e,{t:d}=qo(),g=Xt("input-number"),_=xe(),o=dr({currentValue:a.modelValue,userInput:null}),{formItem:S}=xs(),E=ee(()=>Wn(a.modelValue)&&a.modelValue<=a.min),I=ee(()=>Wn(a.modelValue)&&a.modelValue>=a.max),R=ee(()=>{const Ee=U(a.step);return jr(a.precision)?Math.max(U(a.modelValue),Ee):(Ee>a.precision,a.precision)}),z=ee(()=>a.controls&&a.controlsPosition==="right"),N=Mi(),$=bs(),F=ee(()=>{if(o.userInput!==null)return o.userInput;let Ee=o.currentValue;if(Pi(Ee))return"";if(Wn(Ee)){if(Number.isNaN(Ee))return"";jr(a.precision)||(Ee=Ee.toFixed(a.precision))}return Ee}),W=(Ee,ye)=>{if(jr(ye)&&(ye=R.value),ye===0)return Math.round(Ee);let Me=String(Ee);const Te=Me.indexOf(".");if(Te===-1||!Me.replace(".","").split("")[Te+ye])return Ee;const Ne=Me.length;return Me.charAt(Ne-1)==="5"&&(Me=`${Me.slice(0,Math.max(0,Ne-1))}6`),Number.parseFloat(Number(Me).toFixed(ye))},U=Ee=>{if(Pi(Ee))return 0;const ye=Ee.toString(),Me=ye.indexOf(".");let Te=0;return Me!==-1&&(Te=ye.length-Me-1),Te},re=(Ee,ye=1)=>Wn(Ee)?W(Ee+a.step*ye):o.currentValue,K=()=>{if(a.readonly||$.value||I.value)return;const Ee=Number(F.value)||0,ye=re(Ee);oe(ye),i(Ns,o.currentValue),Re()},q=()=>{if(a.readonly||$.value||E.value)return;const Ee=Number(F.value)||0,ye=re(Ee,-1);oe(ye),i(Ns,o.currentValue),Re()},J=(Ee,ye)=>{const{max:Me,min:Te,step:he,precision:ke,stepStrictly:Ne,valueOnClear:nt}=a;Me<Te&&Ai("InputNumber","min should not be greater than max.");let De=Number(Ee);if(Pi(Ee)||Number.isNaN(De))return null;if(Ee===""){if(nt===null)return null;De=Bn(nt)?{min:Te,max:Me}[nt]:nt}return Ne&&(De=W(Math.round(De/he)*he,ke),De!==Ee&&ye&&i(xo,De)),jr(ke)||(De=W(De,ke)),(De>Me||De<Te)&&(De=De>Me?Me:Te,ye&&i(xo,De)),De},oe=(Ee,ye=!0)=>{var Me;const Te=o.currentValue,he=J(Ee);if(!ye){i(xo,he);return}Te===he&&Ee||(o.userInput=null,i(xo,he),Te!==he&&i(Wr,he,Te),a.validateEvent&&((Me=S==null?void 0:S.validate)==null||Me.call(S,"change").catch(ke=>void 0)),o.currentValue=he)},ae=Ee=>{o.userInput=Ee;const ye=Ee===""?null:Number(Ee);i(Ns,ye),oe(ye,!1)},fe=Ee=>{const ye=Ee!==""?Number(Ee):"";(Wn(ye)&&!Number.isNaN(ye)||Ee==="")&&oe(ye),Re(),o.userInput=null},ge=()=>{var Ee,ye;(ye=(Ee=_.value)==null?void 0:Ee.focus)==null||ye.call(Ee)},ce=()=>{var Ee,ye;(ye=(Ee=_.value)==null?void 0:Ee.blur)==null||ye.call(Ee)},de=Ee=>{i("focus",Ee)},_e=Ee=>{var ye;o.userInput=null,i("blur",Ee),a.validateEvent&&((ye=S==null?void 0:S.validate)==null||ye.call(S,"blur").catch(Me=>void 0))},Re=()=>{o.currentValue!==a.modelValue&&(o.currentValue=a.modelValue)},Qe=Ee=>{document.activeElement===Ee.target&&Ee.preventDefault()};return qt(()=>a.modelValue,(Ee,ye)=>{const Me=J(Ee,!0);o.userInput===null&&Me!==ye&&(o.currentValue=Me)},{immediate:!0}),_o(()=>{var Ee;const{min:ye,max:Me,modelValue:Te}=a,he=(Ee=_.value)==null?void 0:Ee.input;if(he.setAttribute("role","spinbutton"),Number.isFinite(Me)?he.setAttribute("aria-valuemax",String(Me)):he.removeAttribute("aria-valuemax"),Number.isFinite(ye)?he.setAttribute("aria-valuemin",String(ye)):he.removeAttribute("aria-valuemin"),he.setAttribute("aria-valuenow",o.currentValue||o.currentValue===0?String(o.currentValue):""),he.setAttribute("aria-disabled",String($.value)),!Wn(Te)&&Te!=null){let ke=Number(Te);Number.isNaN(ke)&&(ke=null),i(xo,ke)}he.addEventListener("wheel",Qe,{passive:!1})}),Xl(()=>{var Ee,ye;const Me=(Ee=_.value)==null?void 0:Ee.input;Me==null||Me.setAttribute("aria-valuenow",`${(ye=o.currentValue)!=null?ye:""}`)}),t({focus:ge,blur:ce}),(Ee,ye)=>(se(),Ie("div",{class:ue([y(g).b(),y(g).m(y(N)),y(g).is("disabled",y($)),y(g).is("without-controls",!Ee.controls),y(g).is("controls-right",y(z))]),onDragstart:Xn(()=>{},["prevent"])},[Ee.controls?vo((se(),Ie("span",{key:0,role:"button","aria-label":y(d)("el.inputNumber.decrease"),class:ue([y(g).e("decrease"),y(g).is("disabled",y(E))]),onKeydown:kr(q,["enter"])},[vt(Ee.$slots,"decrease-icon",{},()=>[Ye(y(Dn),null,{default:it(()=>[y(z)?(se(),Et(y(Oc),{key:0})):(se(),Et(y(BG),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(hb),q]]):yt("v-if",!0),Ee.controls?vo((se(),Ie("span",{key:1,role:"button","aria-label":y(d)("el.inputNumber.increase"),class:ue([y(g).e("increase"),y(g).is("disabled",y(I))]),onKeydown:kr(K,["enter"])},[vt(Ee.$slots,"increase-icon",{},()=>[Ye(y(Dn),null,{default:it(()=>[y(z)?(se(),Et(y(oT),{key:0})):(se(),Et(y($D),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(hb),K]]):yt("v-if",!0),Ye(y(_s),{id:Ee.id,ref_key:"input",ref:_,type:"number",step:Ee.step,"model-value":y(F),placeholder:Ee.placeholder,readonly:Ee.readonly,disabled:y($),size:y(N),max:Ee.max,min:Ee.min,name:Ee.name,"aria-label":Ee.ariaLabel,"validate-event":!1,onKeydown:[kr(Xn(K,["prevent"]),["up"]),kr(Xn(q,["prevent"]),["down"])],onBlur:_e,onFocus:de,onInput:ae,onChange:fe},Na({_:2},[Ee.$slots.prefix?{name:"prefix",fn:it(()=>[vt(Ee.$slots,"prefix")])}:void 0,Ee.$slots.suffix?{name:"suffix",fn:it(()=>[vt(Ee.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var One=fn(Lne,[["__file","input-number.vue"]]);const fz=uo(One),zne=cn({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:Cr}}),Bne={click:e=>e instanceof MouseEvent},Fne=qe({name:"ElLink"}),Nne=qe({...Fne,props:zne,emits:Bne,setup(e,{emit:t}){const i=e,a=Xt("link"),d=ee(()=>[a.b(),a.m(i.type),a.is("disabled",i.disabled),a.is("underline",i.underline&&!i.disabled)]);function g(_){i.disabled||t("click",_)}return(_,o)=>(se(),Ie("a",{class:ue(y(d)),href:_.disabled||!_.href?void 0:_.href,target:_.disabled||!_.href?void 0:_.target,onClick:g},[_.icon?(se(),Et(y(Dn),{key:0},{default:it(()=>[(se(),Et(ko(_.icon)))]),_:1})):yt("v-if",!0),_.$slots.default?(se(),Ie("span",{key:1,class:ue(y(a).e("inner"))},[vt(_.$slots,"default")],2)):yt("v-if",!0),_.$slots.icon?vt(_.$slots,"icon",{key:2}):yt("v-if",!0)],10,["href","target"]))}});var $ne=fn(Nne,[["__file","link.vue"]]);const Vne=uo($ne);let Une=class{constructor(t,i){this.parent=t,this.domNode=i,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,i=>{i.addEventListener("keydown",a=>{let d=!1;switch(a.code){case Cn.down:{this.gotoSubIndex(this.subIndex+1),d=!0;break}case Cn.up:{this.gotoSubIndex(this.subIndex-1),d=!0;break}case Cn.tab:{P0(t,"mouseleave");break}case Cn.enter:case Cn.numpadEnter:case Cn.space:{d=!0,a.currentTarget.click();break}}return d&&(a.preventDefault(),a.stopPropagation()),!1})})}},jne=class{constructor(t,i){this.domNode=t,this.submenu=null,this.submenu=null,this.init(i)}init(t){this.domNode.setAttribute("tabindex","0");const i=this.domNode.querySelector(`.${t}-menu`);i&&(this.submenu=new Une(this,i)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let i=!1;switch(t.code){case Cn.down:{P0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),i=!0;break}case Cn.up:{P0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),i=!0;break}case Cn.tab:{P0(t.currentTarget,"mouseleave");break}case Cn.enter:case Cn.numpadEnter:case Cn.space:{i=!0,t.currentTarget.click();break}}i&&t.preventDefault()})}},Hne=class{constructor(t,i){this.domNode=t,this.init(i)}init(t){const i=this.domNode.childNodes;Array.from(i).forEach(a=>{a.nodeType===1&&new jne(a,t)})}};const Gne=qe({name:"ElMenuCollapseTransition",setup(){const e=Xt("menu");return{listeners:{onBeforeEnter:i=>i.style.opacity="0.2",onEnter(i,a){Oa(i,`${e.namespace.value}-opacity-transition`),i.style.opacity="1",a()},onAfterEnter(i){ys(i,`${e.namespace.value}-opacity-transition`),i.style.opacity=""},onBeforeLeave(i){i.dataset||(i.dataset={}),Zs(i,e.m("collapse"))?(ys(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),Oa(i,e.m("collapse"))):(Oa(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),ys(i,e.m("collapse"))),i.style.width=`${i.scrollWidth}px`,i.style.overflow="hidden"},onLeave(i){Oa(i,"horizontal-collapse-transition"),i.style.width=`${i.dataset.scrollWidth}px`}}}}});function Wne(e,t,i,a,d,g){return se(),Et(Ui,Po({mode:"out-in"},e.listeners),{default:it(()=>[vt(e.$slots,"default")]),_:3},16)}var qne=fn(Gne,[["render",Wne],["__file","menu-collapse-transition.vue"]]);function pz(e,t){const i=ee(()=>{let d=e.parent;const g=[t.value];for(;d.type.name!=="ElMenu";)d.props.index&&g.unshift(d.props.index),d=d.parent;return g});return{parentMenu:ee(()=>{let d=e.parent;for(;d&&!["ElMenu","ElSubMenu"].includes(d.type.name);)d=d.parent;return d}),indexPath:i}}function Kne(e){return ee(()=>{const i=e.backgroundColor;return i?new qL(i).shade(20).toString():""})}const mz=(e,t)=>{const i=Xt("menu");return ee(()=>i.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":Kne(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},Zne=cn({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:Cr},expandOpenIcon:{type:Cr},collapseCloseIcon:{type:Cr},collapseOpenIcon:{type:Cr}}),kw="ElSubMenu";var YT=qe({name:kw,props:Zne,setup(e,{slots:t,expose:i}){const a=To(),{indexPath:d,parentMenu:g}=pz(a,ee(()=>e.index)),_=Xt("menu"),o=Xt("sub-menu"),S=kn("rootMenu");S||Ai(kw,"can not inject root menu");const E=kn(`subMenu:${g.value.uid}`);E||Ai(kw,"can not inject sub menu");const I=xe({}),R=xe({});let z;const N=xe(!1),$=xe(),F=xe(null),W=ee(()=>fe.value==="horizontal"&&re.value?"bottom-start":"right-start"),U=ee(()=>fe.value==="horizontal"&&re.value||fe.value==="vertical"&&!S.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?oe.value?e.expandOpenIcon:e.expandCloseIcon:Oc:e.collapseCloseIcon&&e.collapseOpenIcon?oe.value?e.collapseOpenIcon:e.collapseCloseIcon:Fs),re=ee(()=>E.level===0),K=ee(()=>{const ke=e.teleported;return ke===void 0?re.value:ke}),q=ee(()=>S.props.collapse?`${_.namespace.value}-zoom-in-left`:`${_.namespace.value}-zoom-in-top`),J=ee(()=>fe.value==="horizontal"&&re.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),oe=ee(()=>S.openedMenus.includes(e.index)),ae=ee(()=>{let ke=!1;return Object.values(I.value).forEach(Ne=>{Ne.active&&(ke=!0)}),Object.values(R.value).forEach(Ne=>{Ne.active&&(ke=!0)}),ke}),fe=ee(()=>S.props.mode),ge=dr({index:e.index,indexPath:d,active:ae}),ce=mz(S.props,E.level+1),de=ee(()=>{var ke;return(ke=e.popperOffset)!=null?ke:S.props.popperOffset}),_e=ee(()=>{var ke;return(ke=e.popperClass)!=null?ke:S.props.popperClass}),Re=ee(()=>{var ke;return(ke=e.showTimeout)!=null?ke:S.props.showTimeout}),Qe=ee(()=>{var ke;return(ke=e.hideTimeout)!=null?ke:S.props.hideTimeout}),Ee=()=>{var ke,Ne,nt;return(nt=(Ne=(ke=F.value)==null?void 0:ke.popperRef)==null?void 0:Ne.popperInstanceRef)==null?void 0:nt.destroy()},ye=ke=>{ke||Ee()},Me=()=>{S.props.menuTrigger==="hover"&&S.props.mode==="horizontal"||S.props.collapse&&S.props.mode==="vertical"||e.disabled||S.handleSubMenuClick({index:e.index,indexPath:d.value,active:ae.value})},Te=(ke,Ne=Re.value)=>{var nt;if(ke.type!=="focus"){if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"||e.disabled){E.mouseInChild.value=!0;return}E.mouseInChild.value=!0,z==null||z(),{stop:z}=wh(()=>{S.openMenu(e.index,d.value)},Ne),K.value&&((nt=g.value.vnode.el)==null||nt.dispatchEvent(new MouseEvent("mouseenter")))}},he=(ke=!1)=>{var Ne;if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"){E.mouseInChild.value=!1;return}z==null||z(),E.mouseInChild.value=!1,{stop:z}=wh(()=>!N.value&&S.closeMenu(e.index,d.value),Qe.value),K.value&&ke&&((Ne=E.handleMouseleave)==null||Ne.call(E,!0))};qt(()=>S.props.collapse,ke=>ye(!!ke));{const ke=nt=>{R.value[nt.index]=nt},Ne=nt=>{delete R.value[nt.index]};Bo(`subMenu:${a.uid}`,{addSubMenu:ke,removeSubMenu:Ne,handleMouseleave:he,mouseInChild:N,level:E.level+1})}return i({opened:oe}),_o(()=>{S.addSubMenu(ge),E.addSubMenu(ge)}),Pr(()=>{E.removeSubMenu(ge),S.removeSubMenu(ge)}),()=>{var ke;const Ne=[(ke=t.title)==null?void 0:ke.call(t),Kn(Dn,{class:o.e("icon-arrow"),style:{transform:oe.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&S.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Bn(U.value)?Kn(a.appContext.components[U.value]):Kn(U.value)})],nt=S.isMenuPopup?Kn(rs,{ref:F,visible:oe.value,effect:"light",pure:!0,offset:de.value,showArrow:!1,persistent:!0,popperClass:_e.value,placement:W.value,teleported:K.value,fallbackPlacements:J.value,transition:q.value,gpuAcceleration:!1},{content:()=>{var De;return Kn("div",{class:[_.m(fe.value),_.m("popup-container"),_e.value],onMouseenter:Ct=>Te(Ct,100),onMouseleave:()=>he(!0),onFocus:Ct=>Te(Ct,100)},[Kn("ul",{class:[_.b(),_.m("popup"),_.m(`popup-${W.value}`)],style:ce.value},[(De=t.default)==null?void 0:De.call(t)])])},default:()=>Kn("div",{class:o.e("title"),onClick:Me},Ne)}):Kn(Fn,{},[Kn("div",{class:o.e("title"),ref:$,onClick:Me},Ne),Kn(s1,{},{default:()=>{var De;return vo(Kn("ul",{role:"menu",class:[_.b(),_.m("inline")],style:ce.value},[(De=t.default)==null?void 0:De.call(t)]),[[ir,oe.value]])}})]);return Kn("li",{class:[o.b(),o.is("active",ae.value),o.is("opened",oe.value),o.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:oe.value,onMouseenter:Te,onMouseleave:()=>he(),onFocus:Te},[nt])}}});const Yne=cn({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:at(Array),default:()=>oi([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:Cr,default:()=>$G},popperEffect:{type:at(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),Pw=e=>sn(e)&&e.every(t=>Bn(t)),Xne={close:(e,t)=>Bn(e)&&Pw(t),open:(e,t)=>Bn(e)&&Pw(t),select:(e,t,i,a)=>Bn(e)&&Pw(t)&&So(i)&&(a===void 0||a instanceof Promise)};var Jne=qe({name:"ElMenu",props:Yne,emits:Xne,setup(e,{emit:t,slots:i,expose:a}){const d=To(),g=d.appContext.config.globalProperties.$router,_=xe(),o=Xt("menu"),S=Xt("sub-menu"),E=xe(-1),I=xe(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),R=xe(e.defaultActive),z=xe({}),N=xe({}),$=ee(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),F=()=>{const Ee=R.value&&z.value[R.value];if(!Ee||e.mode==="horizontal"||e.collapse)return;Ee.indexPath.forEach(Me=>{const Te=N.value[Me];Te&&W(Me,Te.indexPath)})},W=(Ee,ye)=>{I.value.includes(Ee)||(e.uniqueOpened&&(I.value=I.value.filter(Me=>ye.includes(Me))),I.value.push(Ee),t("open",Ee,ye))},U=Ee=>{const ye=I.value.indexOf(Ee);ye!==-1&&I.value.splice(ye,1)},re=(Ee,ye)=>{U(Ee),t("close",Ee,ye)},K=({index:Ee,indexPath:ye})=>{I.value.includes(Ee)?re(Ee,ye):W(Ee,ye)},q=Ee=>{(e.mode==="horizontal"||e.collapse)&&(I.value=[]);const{index:ye,indexPath:Me}=Ee;if(!(Pi(ye)||Pi(Me)))if(e.router&&g){const Te=Ee.route||ye,he=g.push(Te).then(ke=>(ke||(R.value=ye),ke));t("select",ye,Me,{index:ye,indexPath:Me,route:Te},he)}else R.value=ye,t("select",ye,Me,{index:ye,indexPath:Me})},J=Ee=>{const ye=z.value,Me=ye[Ee]||R.value&&ye[R.value]||ye[e.defaultActive];Me?R.value=Me.index:R.value=Ee},oe=Ee=>{const ye=getComputedStyle(Ee),Me=Number.parseInt(ye.marginLeft,10),Te=Number.parseInt(ye.marginRight,10);return Ee.offsetWidth+Me+Te||0},ae=()=>{var Ee,ye;if(!_.value)return-1;const Me=Array.from((ye=(Ee=_.value)==null?void 0:Ee.childNodes)!=null?ye:[]).filter(Rt=>Rt.nodeName!=="#comment"&&(Rt.nodeName!=="#text"||Rt.nodeValue)),Te=64,he=getComputedStyle(_.value),ke=Number.parseInt(he.paddingLeft,10),Ne=Number.parseInt(he.paddingRight,10),nt=_.value.clientWidth-ke-Ne;let De=0,Ct=0;return Me.forEach((Rt,Bt)=>{De+=oe(Rt),De<=nt-Te&&(Ct=Bt+1)}),Ct===Me.length?-1:Ct},fe=Ee=>N.value[Ee].indexPath,ge=(Ee,ye=33.34)=>{let Me;return()=>{Me&&clearTimeout(Me),Me=setTimeout(()=>{Ee()},ye)}};let ce=!0;const de=()=>{if(E.value===ae())return;const Ee=()=>{E.value=-1,Un(()=>{E.value=ae()})};ce?Ee():ge(Ee)(),ce=!1};qt(()=>e.defaultActive,Ee=>{z.value[Ee]||(R.value=""),J(Ee)}),qt(()=>e.collapse,Ee=>{Ee&&(I.value=[])}),qt(z.value,F);let _e;ns(()=>{e.mode==="horizontal"&&e.ellipsis?_e=ei(_,de).stop:_e==null||_e()});const Re=xe(!1);{const Ee=he=>{N.value[he.index]=he},ye=he=>{delete N.value[he.index]};Bo("rootMenu",dr({props:e,openedMenus:I,items:z,subMenus:N,activeIndex:R,isMenuPopup:$,addMenuItem:he=>{z.value[he.index]=he},removeMenuItem:he=>{delete z.value[he.index]},addSubMenu:Ee,removeSubMenu:ye,openMenu:W,closeMenu:re,handleMenuItemClick:q,handleSubMenuClick:K})),Bo(`subMenu:${d.uid}`,{addSubMenu:Ee,removeSubMenu:ye,mouseInChild:Re,level:0})}_o(()=>{e.mode==="horizontal"&&new Hne(d.vnode.el,o.namespace.value)}),a({open:ye=>{const{indexPath:Me}=N.value[ye];Me.forEach(Te=>W(Te,Me))},close:U,handleResize:de});const Qe=mz(e,0);return()=>{var Ee,ye;let Me=(ye=(Ee=i.default)==null?void 0:Ee.call(i))!=null?ye:[];const Te=[];if(e.mode==="horizontal"&&_.value){const Ne=qu(Me),nt=E.value===-1?Ne:Ne.slice(0,E.value),De=E.value===-1?[]:Ne.slice(E.value);De!=null&&De.length&&e.ellipsis&&(Me=nt,Te.push(Kn(YT,{index:"sub-menu-more",class:S.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>Kn(Dn,{class:S.e("icon-more")},{default:()=>Kn(e.ellipsisIcon)}),default:()=>De})))}const he=e.closeOnClickOutside?[[kc,()=>{I.value.length&&(Re.value||(I.value.forEach(Ne=>t("close",Ne,fe(Ne))),I.value=[]))}]]:[],ke=vo(Kn("ul",{key:String(e.collapse),role:"menubar",ref:_,style:Qe.value,class:{[o.b()]:!0,[o.m(e.mode)]:!0,[o.m("collapse")]:e.collapse}},[...Me,...Te]),he);return e.collapseTransition&&e.mode==="vertical"?Kn(qne,()=>ke):ke}}});const Qne=cn({index:{type:at([String,null]),default:null},route:{type:at([String,Object])},disabled:Boolean}),eoe={click:e=>Bn(e.index)&&sn(e.indexPath)},Rw="ElMenuItem",toe=qe({name:Rw,components:{ElTooltip:rs},props:Qne,emits:eoe,setup(e,{emit:t}){const i=To(),a=kn("rootMenu"),d=Xt("menu"),g=Xt("menu-item");a||Ai(Rw,"can not inject root menu");const{parentMenu:_,indexPath:o}=pz(i,mr(e,"index")),S=kn(`subMenu:${_.value.uid}`);S||Ai(Rw,"can not inject sub menu");const E=ee(()=>e.index===a.activeIndex),I=dr({index:e.index,indexPath:o,active:E}),R=()=>{e.disabled||(a.handleMenuItemClick({index:e.index,indexPath:o.value,route:e.route}),t("click",I))};return _o(()=>{S.addSubMenu(I),a.addMenuItem(I)}),Pr(()=>{S.removeSubMenu(I),a.removeMenuItem(I)}),{parentMenu:_,rootMenu:a,active:E,nsMenu:d,nsMenuItem:g,handleClick:R}}});function noe(e,t,i,a,d,g){const _=Mo("el-tooltip");return se(),Ie("li",{class:ue([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",onClick:e.handleClick},[e.parentMenu.type.name==="ElMenu"&&e.rootMenu.props.collapse&&e.$slots.title?(se(),Et(_,{key:0,effect:e.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:it(()=>[vt(e.$slots,"title")]),default:it(()=>[je("div",{class:ue(e.nsMenu.be("tooltip","trigger"))},[vt(e.$slots,"default")],2)]),_:3},8,["effect"])):(se(),Ie(Fn,{key:1},[vt(e.$slots,"default"),vt(e.$slots,"title")],64))],10,["onClick"])}var gz=fn(toe,[["render",noe],["__file","menu-item.vue"]]);const ooe={title:String},roe="ElMenuItemGroup",ioe=qe({name:roe,props:ooe,setup(){return{ns:Xt("menu-item-group")}}});function soe(e,t,i,a,d,g){return se(),Ie("li",{class:ue(e.ns.b())},[je("div",{class:ue(e.ns.e("title"))},[e.$slots.title?vt(e.$slots,"title",{key:1}):(se(),Ie(Fn,{key:0},[$o(mn(e.title),1)],64))],2),je("ul",null,[vt(e.$slots,"default")])],2)}var vz=fn(ioe,[["render",soe],["__file","menu-item-group.vue"]]);const aoe=uo(Jne,{MenuItem:gz,MenuItemGroup:vz,SubMenu:YT}),loe=ri(gz),coe=ri(vz),uoe=ri(YT),doe=cn({icon:{type:Cr,default:()=>uG},title:String,content:{type:String,default:""}}),hoe={back:()=>!0},foe=qe({name:"ElPageHeader"}),poe=qe({...foe,props:doe,emits:hoe,setup(e,{emit:t}){const i=Ri(),{t:a}=qo(),d=Xt("page-header"),g=ee(()=>[d.b(),{[d.m("has-breadcrumb")]:!!i.breadcrumb,[d.m("has-extra")]:!!i.extra,[d.is("contentful")]:!!i.default}]);function _(){t("back")}return(o,S)=>(se(),Ie("div",{class:ue(y(g))},[o.$slots.breadcrumb?(se(),Ie("div",{key:0,class:ue(y(d).e("breadcrumb"))},[vt(o.$slots,"breadcrumb")],2)):yt("v-if",!0),je("div",{class:ue(y(d).e("header"))},[je("div",{class:ue(y(d).e("left"))},[je("div",{class:ue(y(d).e("back")),role:"button",tabindex:"0",onClick:_},[o.icon||o.$slots.icon?(se(),Ie("div",{key:0,"aria-label":o.title||y(a)("el.pageHeader.title"),class:ue(y(d).e("icon"))},[vt(o.$slots,"icon",{},()=>[o.icon?(se(),Et(y(Dn),{key:0},{default:it(()=>[(se(),Et(ko(o.icon)))]),_:1})):yt("v-if",!0)])],10,["aria-label"])):yt("v-if",!0),je("div",{class:ue(y(d).e("title"))},[vt(o.$slots,"title",{},()=>[$o(mn(o.title||y(a)("el.pageHeader.title")),1)])],2)],2),Ye(y(nz),{direction:"vertical"}),je("div",{class:ue(y(d).e("content"))},[vt(o.$slots,"content",{},()=>[$o(mn(o.content),1)])],2)],2),o.$slots.extra?(se(),Ie("div",{key:0,class:ue(y(d).e("extra"))},[vt(o.$slots,"extra")],2)):yt("v-if",!0)],2),o.$slots.default?(se(),Ie("div",{key:1,class:ue(y(d).e("main"))},[vt(o.$slots,"default")],2)):yt("v-if",!0)],2))}});var moe=fn(poe,[["__file","page-header.vue"]]);const goe=uo(moe),_z=Symbol("elPaginationKey"),voe=cn({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:Cr}}),_oe={click:e=>e instanceof MouseEvent},yoe=qe({name:"ElPaginationPrev"}),boe=qe({...yoe,props:voe,emits:_oe,setup(e){const t=e,{t:i}=qo(),a=ee(()=>t.disabled||t.currentPage<=1);return(d,g)=>(se(),Ie("button",{type:"button",class:"btn-prev",disabled:y(a),"aria-label":d.prevText||y(i)("el.pagination.prev"),"aria-disabled":y(a),onClick:_=>d.$emit("click",_)},[d.prevText?(se(),Ie("span",{key:0},mn(d.prevText),1)):(se(),Et(y(Dn),{key:1},{default:it(()=>[(se(),Et(ko(d.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var xoe=fn(boe,[["__file","prev.vue"]]);const woe=cn({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:Cr}}),Soe=qe({name:"ElPaginationNext"}),Toe=qe({...Soe,props:woe,emits:["click"],setup(e){const t=e,{t:i}=qo(),a=ee(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(d,g)=>(se(),Ie("button",{type:"button",class:"btn-next",disabled:y(a),"aria-label":d.nextText||y(i)("el.pagination.next"),"aria-disabled":y(a),onClick:_=>d.$emit("click",_)},[d.nextText?(se(),Ie("span",{key:0},mn(d.nextText),1)):(se(),Et(y(Dn),{key:1},{default:it(()=>[(se(),Et(ko(d.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var Coe=fn(Toe,[["__file","next.vue"]]);const yz=Symbol("ElSelectGroup"),Jp=Symbol("ElSelect");function Eoe(e,t){const i=kn(Jp),a=kn(yz,{disabled:!1}),d=ee(()=>I(gs(i.props.modelValue),e.value)),g=ee(()=>{var N;if(i.props.multiple){const $=gs((N=i.props.modelValue)!=null?N:[]);return!d.value&&$.length>=i.props.multipleLimit&&i.props.multipleLimit>0}else return!1}),_=ee(()=>e.label||(So(e.value)?"":e.value)),o=ee(()=>e.value||e.label||""),S=ee(()=>e.disabled||t.groupDisabled||g.value),E=To(),I=(N=[],$)=>{if(So(e.value)){const F=i.props.valueKey;return N&&N.some(W=>Ar(xi(W,F))===xi($,F))}else return N&&N.includes($)},R=()=>{!e.disabled&&!a.disabled&&(i.states.hoveringIndex=i.optionsArray.indexOf(E.proxy))},z=N=>{const $=new RegExp(eT(N),"i");t.visible=$.test(_.value)||e.created};return qt(()=>_.value,()=>{!e.created&&!i.props.remote&&i.setSelected()}),qt(()=>e.value,(N,$)=>{const{remote:F,valueKey:W}=i.props;if(N!==$&&(i.onOptionDestroy($,E.proxy),i.onOptionCreate(E.proxy)),!e.created&&!F){if(W&&So(N)&&So($)&&N[W]===$[W])return;i.setSelected()}}),qt(()=>a.disabled,()=>{t.groupDisabled=a.disabled},{immediate:!0}),{select:i,currentLabel:_,currentValue:o,itemSelected:d,isDisabled:S,hoverItem:R,updateOption:z}}const Moe=qe({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=Xt("select"),i=Ki(),a=ee(()=>[t.be("dropdown","item"),t.is("disabled",y(o)),t.is("selected",y(_)),t.is("hovering",y(z))]),d=dr({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:g,itemSelected:_,isDisabled:o,select:S,hoverItem:E,updateOption:I}=Eoe(e,d),{visible:R,hover:z}=Vi(d),N=To().proxy;S.onOptionCreate(N),Pr(()=>{const F=N.value,{selected:W}=S.states,re=(S.props.multiple?W:[W]).some(K=>K.value===N.value);Un(()=>{S.states.cachedOptions.get(F)===N&&!re&&S.states.cachedOptions.delete(F)}),S.onOptionDestroy(F,N)});function $(){o.value||S.handleOptionSelect(N)}return{ns:t,id:i,containerKls:a,currentLabel:g,itemSelected:_,isDisabled:o,select:S,hoverItem:E,updateOption:I,visible:R,hover:z,selectOptionClick:$,states:d}}});function Ioe(e,t,i,a,d,g){return vo((se(),Ie("li",{id:e.id,class:ue(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:Xn(e.selectOptionClick,["stop"])},[vt(e.$slots,"default",{},()=>[je("span",null,mn(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[ir,e.visible]])}var XT=fn(Moe,[["render",Ioe],["__file","option.vue"]]);const Aoe=qe({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=kn(Jp),t=Xt("select"),i=ee(()=>e.props.popperClass),a=ee(()=>e.props.multiple),d=ee(()=>e.props.fitInputWidth),g=xe("");function _(){var o;g.value=`${(o=e.selectRef)==null?void 0:o.offsetWidth}px`}return _o(()=>{_(),ei(e.selectRef,_)}),{ns:t,minWidth:g,popperClass:i,isMultiple:a,isFitInputWidth:d}}});function koe(e,t,i,a,d,g){return se(),Ie("div",{class:ue([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:$n({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(se(),Ie("div",{key:0,class:ue(e.ns.be("dropdown","header"))},[vt(e.$slots,"header")],2)):yt("v-if",!0),vt(e.$slots,"default"),e.$slots.footer?(se(),Ie("div",{key:1,class:ue(e.ns.be("dropdown","footer"))},[vt(e.$slots,"footer")],2)):yt("v-if",!0)],6)}var Poe=fn(Aoe,[["render",koe],["__file","select-dropdown.vue"]]);const Roe=11,Doe=(e,t)=>{const{t:i}=qo(),a=Ki(),d=Xt("select"),g=Xt("input"),_=dr({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),o=xe(null),S=xe(null),E=xe(null),I=xe(null),R=xe(null),z=xe(null),N=xe(null),$=xe(null),F=xe(null),W=xe(null),U=xe(null),re=xe(null),{isComposing:K,handleCompositionStart:q,handleCompositionUpdate:J,handleCompositionEnd:oe}=e1({afterComposition:pt=>fo(pt)}),{wrapperRef:ae,isFocused:fe,handleBlur:ge}=Oh(R,{beforeFocus(){return Me.value},afterFocus(){e.automaticDropdown&&!ce.value&&(ce.value=!0,_.menuVisibleOnFocus=!0)},beforeBlur(pt){var Ht,bn;return((Ht=E.value)==null?void 0:Ht.isFocusInsideContent(pt))||((bn=I.value)==null?void 0:bn.isFocusInsideContent(pt))},afterBlur(){ce.value=!1,_.menuVisibleOnFocus=!1}}),ce=xe(!1),de=xe(),{form:_e,formItem:Re}=xs(),{inputId:Qe}=Cl(e,{formItemContext:Re}),{valueOnClear:Ee,isEmptyValue:ye}=t1(e),Me=ee(()=>e.disabled||(_e==null?void 0:_e.disabled)),Te=ee(()=>sn(e.modelValue)?e.modelValue.length>0:!ye(e.modelValue)),he=ee(()=>{var pt;return(pt=_e==null?void 0:_e.statusIcon)!=null?pt:!1}),ke=ee(()=>e.clearable&&!Me.value&&_.inputHovering&&Te.value),Ne=ee(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),nt=ee(()=>d.is("reverse",Ne.value&&ce.value)),De=ee(()=>(Re==null?void 0:Re.validateState)||""),Ct=ee(()=>cT[De.value]),Rt=ee(()=>e.remote?300:0),Bt=ee(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!_.inputValue&&_.options.size===0?!1:e.filterable&&_.inputValue&&_.options.size>0&&mt.value===0?e.noMatchText||i("el.select.noMatch"):_.options.size===0?e.noDataText||i("el.select.noData"):null),mt=ee(()=>Gt.value.filter(pt=>pt.visible).length),Gt=ee(()=>{const pt=Array.from(_.options.values()),Ht=[];return _.optionValues.forEach(bn=>{const Yn=pt.findIndex(ro=>ro.value===bn);Yn>-1&&Ht.push(pt[Yn])}),Ht.length>=pt.length?Ht:pt}),jt=ee(()=>Array.from(_.cachedOptions.values())),Be=ee(()=>{const pt=Gt.value.filter(Ht=>!Ht.created).some(Ht=>Ht.currentLabel===_.inputValue);return e.filterable&&e.allowCreate&&_.inputValue!==""&&!pt}),an=()=>{e.filterable&&Nn(e.filterMethod)||e.filterable&&e.remote&&Nn(e.remoteMethod)||Gt.value.forEach(pt=>{var Ht;(Ht=pt.updateOption)==null||Ht.call(pt,_.inputValue)})},At=Mi(),Ge=ee(()=>["small"].includes(At.value)?"small":"default"),Fe=ee({get(){return ce.value&&Bt.value!==!1},set(pt){ce.value=pt}}),Nt=ee(()=>{if(e.multiple&&!jr(e.modelValue))return gs(e.modelValue).length===0&&!_.inputValue;const pt=sn(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||jr(pt)?!_.inputValue:!0}),Jt=ee(()=>{var pt;const Ht=(pt=e.placeholder)!=null?pt:i("el.select.placeholder");return e.multiple||!Te.value?Ht:_.selectedLabel}),Dt=ee(()=>r2?null:"mouseenter");qt(()=>e.modelValue,(pt,Ht)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(_.inputValue="",xt("")),en(),!qi(pt,Ht)&&e.validateEvent&&(Re==null||Re.validate("change").catch(bn=>void 0))},{flush:"post",deep:!0}),qt(()=>ce.value,pt=>{pt?xt(_.inputValue):(_.inputValue="",_.previousQuery=null,_.isBeforeHide=!0),t("visible-change",pt)}),qt(()=>_.options.entries(),()=>{var pt;if(!Wo)return;const Ht=((pt=o.value)==null?void 0:pt.querySelectorAll("input"))||[];(!e.filterable&&!e.defaultFirstOption&&!jr(e.modelValue)||!Array.from(Ht).includes(document.activeElement))&&en(),e.defaultFirstOption&&(e.filterable||e.remote)&&mt.value&&Ot()},{flush:"post"}),qt(()=>_.hoveringIndex,pt=>{Wn(pt)&&pt>-1?de.value=Gt.value[pt]||{}:de.value={},Gt.value.forEach(Ht=>{Ht.hover=de.value===Ht})}),ns(()=>{_.isBeforeHide||an()});const xt=pt=>{_.previousQuery===pt||K.value||(_.previousQuery=pt,e.filterable&&Nn(e.filterMethod)?e.filterMethod(pt):e.filterable&&e.remote&&Nn(e.remoteMethod)&&e.remoteMethod(pt),e.defaultFirstOption&&(e.filterable||e.remote)&&mt.value?Un(Ot):Un(un))},Ot=()=>{const pt=Gt.value.filter(ro=>ro.visible&&!ro.disabled&&!ro.states.groupDisabled),Ht=pt.find(ro=>ro.created),bn=pt[0],Yn=Gt.value.map(ro=>ro.value);_.hoveringIndex=vn(Yn,Ht||bn)},en=()=>{if(e.multiple)_.selectedLabel="";else{const Ht=sn(e.modelValue)?e.modelValue[0]:e.modelValue,bn=dn(Ht);_.selectedLabel=bn.currentLabel,_.selected=[bn];return}const pt=[];jr(e.modelValue)||gs(e.modelValue).forEach(Ht=>{pt.push(dn(Ht))}),_.selected=pt},dn=pt=>{let Ht;const bn=xv(pt);for(let po=_.cachedOptions.size-1;po>=0;po--){const ao=jt.value[po];if(bn?xi(ao.value,e.valueKey)===xi(pt,e.valueKey):ao.value===pt){Ht={value:pt,currentLabel:ao.currentLabel,get isDisabled(){return ao.isDisabled}};break}}if(Ht)return Ht;const Yn=bn?pt.label:pt??"";return{value:pt,currentLabel:Yn}},un=()=>{_.hoveringIndex=Gt.value.findIndex(pt=>_.selected.some(Ht=>He(Ht)===He(pt)))},Pn=()=>{_.selectionWidth=S.value.getBoundingClientRect().width},gt=()=>{_.calculatorWidth=z.value.getBoundingClientRect().width},Sn=()=>{_.collapseItemWidth=U.value.getBoundingClientRect().width},Vn=()=>{var pt,Ht;(Ht=(pt=E.value)==null?void 0:pt.updatePopper)==null||Ht.call(pt)},lo=()=>{var pt,Ht;(Ht=(pt=I.value)==null?void 0:pt.updatePopper)==null||Ht.call(pt)},eo=()=>{_.inputValue.length>0&&!ce.value&&(ce.value=!0),xt(_.inputValue)},fo=pt=>{if(_.inputValue=pt.target.value,e.remote)Lo();else return eo()},Lo=Qs(()=>{eo()},Rt.value),er=pt=>{qi(e.modelValue,pt)||t(Wr,pt)},Pt=pt=>RD(pt,Ht=>{const bn=_.cachedOptions.get(Ht);return bn&&!bn.disabled&&!bn.states.groupDisabled}),_n=pt=>{if(e.multiple&&pt.code!==Cn.delete&&pt.target.value.length<=0){const Ht=gs(e.modelValue).slice(),bn=Pt(Ht);if(bn<0)return;const Yn=Ht[bn];Ht.splice(bn,1),t(xo,Ht),er(Ht),t("remove-tag",Yn)}},dt=(pt,Ht)=>{const bn=_.selected.indexOf(Ht);if(bn>-1&&!Me.value){const Yn=gs(e.modelValue).slice();Yn.splice(bn,1),t(xo,Yn),er(Yn),t("remove-tag",Ht.value)}pt.stopPropagation(),Rr()},tn=pt=>{pt.stopPropagation();const Ht=e.multiple?[]:Ee.value;if(e.multiple)for(const bn of _.selected)bn.isDisabled&&Ht.push(bn.value);t(xo,Ht),er(Ht),_.hoveringIndex=-1,ce.value=!1,t("clear"),Rr()},Ze=pt=>{var Ht;if(e.multiple){const bn=gs((Ht=e.modelValue)!=null?Ht:[]).slice(),Yn=vn(bn,pt);Yn>-1?bn.splice(Yn,1):(e.multipleLimit<=0||bn.length<e.multipleLimit)&&bn.push(pt.value),t(xo,bn),er(bn),pt.created&&xt(""),e.filterable&&!e.reserveKeyword&&(_.inputValue="")}else t(xo,pt.value),er(pt.value),ce.value=!1;Rr(),!ce.value&&Un(()=>{Mn(pt)})},vn=(pt=[],Ht)=>jr(Ht)?-1:So(Ht.value)?pt.findIndex(bn=>qi(xi(bn,e.valueKey),He(Ht))):pt.indexOf(Ht.value),Mn=pt=>{var Ht,bn,Yn,ro,po;const ao=sn(pt)?pt[0]:pt;let Ko=null;if(ao!=null&&ao.value){const jo=Gt.value.filter(Ro=>Ro.value===ao.value);jo.length>0&&(Ko=jo[0].$el)}if(E.value&&Ko){const jo=(ro=(Yn=(bn=(Ht=E.value)==null?void 0:Ht.popperRef)==null?void 0:bn.contentRef)==null?void 0:Yn.querySelector)==null?void 0:ro.call(Yn,`.${d.be("dropdown","wrap")}`);jo&&nT(jo,Ko)}(po=re.value)==null||po.handleScroll()},yo=pt=>{_.options.set(pt.value,pt),_.cachedOptions.set(pt.value,pt)},gr=(pt,Ht)=>{_.options.get(pt)===Ht&&_.options.delete(pt)},Xr=ee(()=>{var pt,Ht;return(Ht=(pt=E.value)==null?void 0:pt.popperRef)==null?void 0:Ht.contentRef}),Ur=()=>{_.isBeforeHide=!1,Un(()=>Mn(_.selected))},Rr=()=>{var pt;(pt=R.value)==null||pt.focus()},Oo=()=>{var pt;if(ce.value){ce.value=!1,Un(()=>{var Ht;return(Ht=R.value)==null?void 0:Ht.blur()});return}(pt=R.value)==null||pt.blur()},_i=pt=>{tn(pt)},ya=pt=>{if(ce.value=!1,fe.value){const Ht=new FocusEvent("focus",pt);Un(()=>ge(Ht))}},$t=()=>{_.inputValue.length>0?_.inputValue="":ce.value=!1},Se=()=>{Me.value||(r2&&(_.inputHovering=!0),_.menuVisibleOnFocus?_.menuVisibleOnFocus=!1:ce.value=!ce.value)},Ae=()=>{if(!ce.value)Se();else{const pt=Gt.value[_.hoveringIndex];pt&&!pt.disabled&&!pt.states.groupDisabled&&Ze(pt)}},He=pt=>So(pt.value)?xi(pt.value,e.valueKey):pt.value,ft=ee(()=>Gt.value.filter(pt=>pt.visible).every(pt=>pt.disabled)),tt=ee(()=>e.multiple?e.collapseTags?_.selected.slice(0,e.maxCollapseTags):_.selected:[]),bt=ee(()=>e.multiple?e.collapseTags?_.selected.slice(e.maxCollapseTags):[]:[]),zt=pt=>{if(!ce.value){ce.value=!0;return}if(!(_.options.size===0||_.filteredOptionsCount===0||K.value)&&!ft.value){pt==="next"?(_.hoveringIndex++,_.hoveringIndex===_.options.size&&(_.hoveringIndex=0)):pt==="prev"&&(_.hoveringIndex--,_.hoveringIndex<0&&(_.hoveringIndex=_.options.size-1));const Ht=Gt.value[_.hoveringIndex];(Ht.disabled===!0||Ht.states.groupDisabled===!0||!Ht.visible)&&zt(pt),Un(()=>Mn(de.value))}},Tt=()=>{if(!S.value)return 0;const pt=window.getComputedStyle(S.value);return Number.parseFloat(pt.gap||"6px")},Ft=ee(()=>{const pt=Tt();return{maxWidth:`${U.value&&e.maxCollapseTags===1?_.selectionWidth-_.collapseItemWidth-pt:_.selectionWidth}px`}}),Kt=ee(()=>({maxWidth:`${_.selectionWidth}px`})),Zt=ee(()=>({width:`${Math.max(_.calculatorWidth,Roe)}px`}));return ei(S,Pn),ei(z,gt),ei(F,Vn),ei(ae,Vn),ei(W,lo),ei(U,Sn),_o(()=>{en()}),{inputId:Qe,contentId:a,nsSelect:d,nsInput:g,states:_,isFocused:fe,expanded:ce,optionsArray:Gt,hoverOption:de,selectSize:At,filteredOptionsCount:mt,resetCalculatorWidth:gt,updateTooltip:Vn,updateTagTooltip:lo,debouncedOnInputChange:Lo,onInput:fo,deletePrevTag:_n,deleteTag:dt,deleteSelected:tn,handleOptionSelect:Ze,scrollToOption:Mn,hasModelValue:Te,shouldShowPlaceholder:Nt,currentPlaceholder:Jt,mouseEnterEventName:Dt,needStatusIcon:he,showClose:ke,iconComponent:Ne,iconReverse:nt,validateState:De,validateIcon:Ct,showNewOption:Be,updateOptions:an,collapseTagSize:Ge,setSelected:en,selectDisabled:Me,emptyText:Bt,handleCompositionStart:q,handleCompositionUpdate:J,handleCompositionEnd:oe,onOptionCreate:yo,onOptionDestroy:gr,handleMenuEnter:Ur,focus:Rr,blur:Oo,handleClearClick:_i,handleClickOutside:ya,handleEsc:$t,toggleMenu:Se,selectOption:Ae,getValueKey:He,navigateOptions:zt,dropdownMenuVisible:Fe,showTagList:tt,collapseTagList:bt,tagStyle:Ft,collapseTagStyle:Kt,inputStyle:Zt,popperRef:Xr,inputRef:R,tooltipRef:E,tagTooltipRef:I,calculatorRef:z,prefixRef:N,suffixRef:$,selectRef:o,wrapperRef:ae,selectionRef:S,scrollbarRef:re,menuRef:F,tagMenuRef:W,collapseItemRef:U}};var Loe=qe({name:"ElOptions",setup(e,{slots:t}){const i=kn(Jp);let a=[];return()=>{var d,g;const _=(d=t.default)==null?void 0:d.call(t),o=[];function S(E){sn(E)&&E.forEach(I=>{var R,z,N,$;const F=(R=(I==null?void 0:I.type)||{})==null?void 0:R.name;F==="ElOptionGroup"?S(!Bn(I.children)&&!sn(I.children)&&Nn((z=I.children)==null?void 0:z.default)?(N=I.children)==null?void 0:N.default():I.children):F==="ElOption"?o.push(($=I.props)==null?void 0:$.value):sn(I.children)&&S(I.children)})}return _.length&&S((g=_[0])==null?void 0:g.children),qi(o,a)||(a=o,i&&(i.states.optionValues=o)),_}}});const Ooe=cn({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:ki,effect:{type:at(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Fi.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Cr,default:ud},fitInputWidth:Boolean,suffixIcon:{type:Cr,default:Oc},tagType:{...Ih.type,default:"info"},tagEffect:{...Ih.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:at(String),values:zc,default:"bottom-start"},fallbackPlacements:{type:at(Array),default:["bottom-start","top-start","right","left"]},appendTo:String,...Zp,...Zi(["ariaLabel"])}),k3="ElSelect",zoe=qe({name:k3,componentName:k3,components:{ElSelectMenu:Poe,ElOption:XT,ElOptions:Loe,ElTag:Nv,ElScrollbar:nc,ElTooltip:rs,ElIcon:Dn},directives:{ClickOutside:kc},props:Ooe,emits:[xo,Wr,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const i=ee(()=>{const{modelValue:_,multiple:o}=e,S=o?[]:void 0;return sn(_)?o?_:S:o?S:_}),a=dr({...Vi(e),modelValue:i}),d=Doe(a,t);Bo(Jp,dr({props:a,states:d.states,optionsArray:d.optionsArray,handleOptionSelect:d.handleOptionSelect,onOptionCreate:d.onOptionCreate,onOptionDestroy:d.onOptionDestroy,selectRef:d.selectRef,setSelected:d.setSelected}));const g=ee(()=>e.multiple?d.states.selected.map(_=>_.currentLabel):d.states.selectedLabel);return{...d,modelValue:i,selectedLabel:g}}});function Boe(e,t,i,a,d,g){const _=Mo("el-tag"),o=Mo("el-tooltip"),S=Mo("el-icon"),E=Mo("el-option"),I=Mo("el-options"),R=Mo("el-scrollbar"),z=Mo("el-select-menu"),N=zb("click-outside");return vo((se(),Ie("div",{ref:"selectRef",class:ue([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[av(e.mouseEnterEventName)]:$=>e.states.inputHovering=!0,onMouseleave:$=>e.states.inputHovering=!1},[Ye(o,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:$=>e.states.isBeforeHide=!1},{default:it(()=>{var $;return[je("div",{ref:"wrapperRef",class:ue([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Xn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(se(),Ie("div",{key:0,ref:"prefixRef",class:ue(e.nsSelect.e("prefix"))},[vt(e.$slots,"prefix")],2)):yt("v-if",!0),je("div",{ref:"selectionRef",class:ue([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?vt(e.$slots,"tag",{key:0},()=>[(se(!0),Ie(Fn,null,Fo(e.showTagList,F=>(se(),Ie("div",{key:e.getValueKey(F),class:ue(e.nsSelect.e("selected-item"))},[Ye(_,{closable:!e.selectDisabled&&!F.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:$n(e.tagStyle),onClose:W=>e.deleteTag(W,F)},{default:it(()=>[je("span",{class:ue(e.nsSelect.e("tags-text"))},[vt(e.$slots,"label",{label:F.currentLabel,value:F.value},()=>[$o(mn(F.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(se(),Et(o,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:it(()=>[je("div",{ref:"collapseItemRef",class:ue(e.nsSelect.e("selected-item"))},[Ye(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:$n(e.collapseTagStyle)},{default:it(()=>[je("span",{class:ue(e.nsSelect.e("tags-text"))}," + "+mn(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:it(()=>[je("div",{ref:"tagMenuRef",class:ue(e.nsSelect.e("selection"))},[(se(!0),Ie(Fn,null,Fo(e.collapseTagList,F=>(se(),Ie("div",{key:e.getValueKey(F),class:ue(e.nsSelect.e("selected-item"))},[Ye(_,{class:"in-tooltip",closable:!e.selectDisabled&&!F.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:W=>e.deleteTag(W,F)},{default:it(()=>[je("span",{class:ue(e.nsSelect.e("tags-text"))},[vt(e.$slots,"label",{label:F.currentLabel,value:F.value},()=>[$o(mn(F.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):yt("v-if",!0)]):yt("v-if",!0),e.selectDisabled?yt("v-if",!0):(se(),Ie("div",{key:1,class:ue([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[vo(je("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":F=>e.states.inputValue=F,type:"text",name:e.name,class:ue([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:$n(e.inputStyle),role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":(($=e.hoverOption)==null?void 0:$.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[kr(Xn(F=>e.navigateOptions("next"),["stop","prevent"]),["down"]),kr(Xn(F=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),kr(Xn(e.handleEsc,["stop","prevent"]),["esc"]),kr(Xn(e.selectOption,["stop","prevent"]),["enter"]),kr(Xn(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:Xn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[LS,e.states.inputValue]]),e.filterable?(se(),Ie("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ue(e.nsSelect.e("input-calculator")),textContent:mn(e.states.inputValue)},null,10,["textContent"])):yt("v-if",!0)],2)),e.shouldShowPlaceholder?(se(),Ie("div",{key:2,class:ue([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?vt(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[je("span",null,mn(e.currentPlaceholder),1)]):(se(),Ie("span",{key:1},mn(e.currentPlaceholder),1))],2)):yt("v-if",!0)],2),je("div",{ref:"suffixRef",class:ue(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(se(),Et(S,{key:0,class:ue([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:it(()=>[(se(),Et(ko(e.iconComponent)))]),_:1},8,["class"])):yt("v-if",!0),e.showClose&&e.clearIcon?(se(),Et(S,{key:1,class:ue([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:it(()=>[(se(),Et(ko(e.clearIcon)))]),_:1},8,["class","onClick"])):yt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(se(),Et(S,{key:2,class:ue([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:it(()=>[(se(),Et(ko(e.validateIcon)))]),_:1},8,["class"])):yt("v-if",!0)],2)],10,["onClick"])]}),content:it(()=>[Ye(z,{ref:"menuRef"},{default:it(()=>[e.$slots.header?(se(),Ie("div",{key:0,class:ue(e.nsSelect.be("dropdown","header")),onClick:Xn(()=>{},["stop"])},[vt(e.$slots,"header")],10,["onClick"])):yt("v-if",!0),vo(Ye(R,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:ue([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:it(()=>[e.showNewOption?(se(),Et(E,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):yt("v-if",!0),Ye(I,null,{default:it(()=>[vt(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[ir,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(se(),Ie("div",{key:1,class:ue(e.nsSelect.be("dropdown","loading"))},[vt(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(se(),Ie("div",{key:2,class:ue(e.nsSelect.be("dropdown","empty"))},[vt(e.$slots,"empty",{},()=>[je("span",null,mn(e.emptyText),1)])],2)):yt("v-if",!0),e.$slots.footer?(se(),Ie("div",{key:3,class:ue(e.nsSelect.be("dropdown","footer")),onClick:Xn(()=>{},["stop"])},[vt(e.$slots,"footer")],10,["onClick"])):yt("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[N,e.handleClickOutside,e.popperRef]])}var Foe=fn(zoe,[["render",Boe],["__file","select.vue"]]);const Noe=qe({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=Xt("select"),i=xe(null),a=To(),d=xe([]);Bo(yz,dr({...Vi(e)}));const g=ee(()=>d.value.some(E=>E.visible===!0)),_=E=>{var I,R;return((I=E.type)==null?void 0:I.name)==="ElOption"&&!!((R=E.component)!=null&&R.proxy)},o=E=>{const I=gs(E),R=[];return I.forEach(z=>{var N,$;_(z)?R.push(z.component.proxy):(N=z.children)!=null&&N.length?R.push(...o(z.children)):($=z.component)!=null&&$.subTree&&R.push(...o(z.component.subTree))}),R},S=()=>{d.value=o(a.subTree)};return _o(()=>{S()}),qR(i,S,{attributes:!0,subtree:!0,childList:!0}),{groupRef:i,visible:g,ns:t}}});function $oe(e,t,i,a,d,g){return vo((se(),Ie("ul",{ref:"groupRef",class:ue(e.ns.be("group","wrap"))},[je("li",{class:ue(e.ns.be("group","title"))},mn(e.label),3),je("li",null,[je("ul",{class:ue(e.ns.b("group"))},[vt(e.$slots,"default")],2)])],2)),[[ir,e.visible]])}var bz=fn(Noe,[["render",$oe],["__file","option-group.vue"]]);const Ah=uo(Foe,{Option:XT,OptionGroup:bz}),mb=ri(XT),Voe=ri(bz),JT=()=>kn(_z,{}),Uoe=cn({pageSize:{type:Number,required:!0},pageSizes:{type:at(Array),default:()=>oi([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:ec},appendSizeTo:String}),joe=qe({name:"ElPaginationSizes"}),Hoe=qe({...joe,props:Uoe,emits:["page-size-change"],setup(e,{emit:t}){const i=e,{t:a}=qo(),d=Xt("pagination"),g=JT(),_=xe(i.pageSize);qt(()=>i.pageSizes,(E,I)=>{if(!qi(E,I)&&sn(E)){const R=E.includes(i.pageSize)?i.pageSize:i.pageSizes[0];t("page-size-change",R)}}),qt(()=>i.pageSize,E=>{_.value=E});const o=ee(()=>i.pageSizes);function S(E){var I;E!==_.value&&(_.value=E,(I=g.handleSizeChange)==null||I.call(g,Number(E)))}return(E,I)=>(se(),Ie("span",{class:ue(y(d).e("sizes"))},[Ye(y(Ah),{"model-value":_.value,disabled:E.disabled,"popper-class":E.popperClass,size:E.size,teleported:E.teleported,"validate-event":!1,"append-to":E.appendSizeTo,onChange:S},{default:it(()=>[(se(!0),Ie(Fn,null,Fo(y(o),R=>(se(),Et(y(mb),{key:R,value:R,label:R+y(a)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var Goe=fn(Hoe,[["__file","sizes.vue"]]);const Woe=cn({size:{type:String,values:ec}}),qoe=qe({name:"ElPaginationJumper"}),Koe=qe({...qoe,props:Woe,setup(e){const{t}=qo(),i=Xt("pagination"),{pageCount:a,disabled:d,currentPage:g,changeEvent:_}=JT(),o=xe(),S=ee(()=>{var R;return(R=o.value)!=null?R:g==null?void 0:g.value});function E(R){o.value=R?+R:""}function I(R){R=Math.trunc(+R),_==null||_(R),o.value=void 0}return(R,z)=>(se(),Ie("span",{class:ue(y(i).e("jump")),disabled:y(d)},[je("span",{class:ue([y(i).e("goto")])},mn(y(t)("el.pagination.goto")),3),Ye(y(_s),{size:R.size,class:ue([y(i).e("editor"),y(i).is("in-pagination")]),min:1,max:y(a),disabled:y(d),"model-value":y(S),"validate-event":!1,"aria-label":y(t)("el.pagination.page"),type:"number","onUpdate:modelValue":E,onChange:I},null,8,["size","class","max","disabled","model-value","aria-label"]),je("span",{class:ue([y(i).e("classifier")])},mn(y(t)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var Zoe=fn(Koe,[["__file","jumper.vue"]]);const Yoe=cn({total:{type:Number,default:1e3}}),Xoe=qe({name:"ElPaginationTotal"}),Joe=qe({...Xoe,props:Yoe,setup(e){const{t}=qo(),i=Xt("pagination"),{disabled:a}=JT();return(d,g)=>(se(),Ie("span",{class:ue(y(i).e("total")),disabled:y(a)},mn(y(t)("el.pagination.total",{total:d.total})),11,["disabled"]))}});var Qoe=fn(Joe,[["__file","total.vue"]]);const ere=cn({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),tre=qe({name:"ElPaginationPager"}),nre=qe({...tre,props:ere,emits:["change"],setup(e,{emit:t}){const i=e,a=Xt("pager"),d=Xt("icon"),{t:g}=qo(),_=xe(!1),o=xe(!1),S=xe(!1),E=xe(!1),I=xe(!1),R=xe(!1),z=ee(()=>{const q=i.pagerCount,J=(q-1)/2,oe=Number(i.currentPage),ae=Number(i.pageCount);let fe=!1,ge=!1;ae>q&&(oe>q-J&&(fe=!0),oe<ae-J&&(ge=!0));const ce=[];if(fe&&!ge){const de=ae-(q-2);for(let _e=de;_e<ae;_e++)ce.push(_e)}else if(!fe&&ge)for(let de=2;de<q;de++)ce.push(de);else if(fe&&ge){const de=Math.floor(q/2)-1;for(let _e=oe-de;_e<=oe+de;_e++)ce.push(_e)}else for(let de=2;de<ae;de++)ce.push(de);return ce}),N=ee(()=>["more","btn-quickprev",d.b(),a.is("disabled",i.disabled)]),$=ee(()=>["more","btn-quicknext",d.b(),a.is("disabled",i.disabled)]),F=ee(()=>i.disabled?-1:0);ns(()=>{const q=(i.pagerCount-1)/2;_.value=!1,o.value=!1,i.pageCount>i.pagerCount&&(i.currentPage>i.pagerCount-q&&(_.value=!0),i.currentPage<i.pageCount-q&&(o.value=!0))});function W(q=!1){i.disabled||(q?S.value=!0:E.value=!0)}function U(q=!1){q?I.value=!0:R.value=!0}function re(q){const J=q.target;if(J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("number")){const oe=Number(J.textContent);oe!==i.currentPage&&t("change",oe)}else J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("more")&&K(q)}function K(q){const J=q.target;if(J.tagName.toLowerCase()==="ul"||i.disabled)return;let oe=Number(J.textContent);const ae=i.pageCount,fe=i.currentPage,ge=i.pagerCount-2;J.className.includes("more")&&(J.className.includes("quickprev")?oe=fe-ge:J.className.includes("quicknext")&&(oe=fe+ge)),Number.isNaN(+oe)||(oe<1&&(oe=1),oe>ae&&(oe=ae)),oe!==fe&&t("change",oe)}return(q,J)=>(se(),Ie("ul",{class:ue(y(a).b()),onClick:K,onKeyup:kr(re,["enter"])},[q.pageCount>0?(se(),Ie("li",{key:0,class:ue([[y(a).is("active",q.currentPage===1),y(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===1,"aria-label":y(g)("el.pagination.currentPage",{pager:1}),tabindex:y(F)}," 1 ",10,["aria-current","aria-label","tabindex"])):yt("v-if",!0),_.value?(se(),Ie("li",{key:1,class:ue(y(N)),tabindex:y(F),"aria-label":y(g)("el.pagination.prevPages",{pager:q.pagerCount-2}),onMouseenter:oe=>W(!0),onMouseleave:oe=>S.value=!1,onFocus:oe=>U(!0),onBlur:oe=>I.value=!1},[(S.value||I.value)&&!q.disabled?(se(),Et(y(nd),{key:0})):(se(),Et(y(yk),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):yt("v-if",!0),(se(!0),Ie(Fn,null,Fo(y(z),oe=>(se(),Ie("li",{key:oe,class:ue([[y(a).is("active",q.currentPage===oe),y(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===oe,"aria-label":y(g)("el.pagination.currentPage",{pager:oe}),tabindex:y(F)},mn(oe),11,["aria-current","aria-label","tabindex"]))),128)),o.value?(se(),Ie("li",{key:2,class:ue(y($)),tabindex:y(F),"aria-label":y(g)("el.pagination.nextPages",{pager:q.pagerCount-2}),onMouseenter:oe=>W(),onMouseleave:oe=>E.value=!1,onFocus:oe=>U(),onBlur:oe=>R.value=!1},[(E.value||R.value)&&!q.disabled?(se(),Et(y(od),{key:0})):(se(),Et(y(yk),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):yt("v-if",!0),q.pageCount>1?(se(),Ie("li",{key:3,class:ue([[y(a).is("active",q.currentPage===q.pageCount),y(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===q.pageCount,"aria-label":y(g)("el.pagination.currentPage",{pager:q.pageCount}),tabindex:y(F)},mn(q.pageCount),11,["aria-current","aria-label","tabindex"])):yt("v-if",!0)],42,["onKeyup"]))}});var ore=fn(nre,[["__file","pager.vue"]]);const Ps=e=>typeof e!="number",rre=cn({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>Wn(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:at(Array),default:()=>oi([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:Cr,default:()=>td},nextText:{type:String,default:""},nextIcon:{type:Cr,default:()=>Fs},teleported:{type:Boolean,default:!0},small:Boolean,size:ki,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),ire={"update:current-page":e=>Wn(e),"update:page-size":e=>Wn(e),"size-change":e=>Wn(e),change:(e,t)=>Wn(e)&&Wn(t),"current-change":e=>Wn(e),"prev-click":e=>Wn(e),"next-click":e=>Wn(e)},P3="ElPagination";var sre=qe({name:P3,props:rre,emits:ire,setup(e,{emit:t,slots:i}){const{t:a}=qo(),d=Xt("pagination"),g=To().vnode.props||{},_=TL(),o=ee(()=>{var J;return e.small?"small":(J=e.size)!=null?J:_.value});Ku({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},ee(()=>!!e.small));const S="onUpdate:currentPage"in g||"onUpdate:current-page"in g||"onCurrentChange"in g,E="onUpdate:pageSize"in g||"onUpdate:page-size"in g||"onSizeChange"in g,I=ee(()=>{if(Ps(e.total)&&Ps(e.pageCount)||!Ps(e.currentPage)&&!S)return!1;if(e.layout.includes("sizes")){if(Ps(e.pageCount)){if(!Ps(e.total)&&!Ps(e.pageSize)&&!E)return!1}else if(!E)return!1}return!0}),R=xe(Ps(e.defaultPageSize)?10:e.defaultPageSize),z=xe(Ps(e.defaultCurrentPage)?1:e.defaultCurrentPage),N=ee({get(){return Ps(e.pageSize)?R.value:e.pageSize},set(J){Ps(e.pageSize)&&(R.value=J),E&&(t("update:page-size",J),t("size-change",J))}}),$=ee(()=>{let J=0;return Ps(e.pageCount)?Ps(e.total)||(J=Math.max(1,Math.ceil(e.total/N.value))):J=e.pageCount,J}),F=ee({get(){return Ps(e.currentPage)?z.value:e.currentPage},set(J){let oe=J;J<1?oe=1:J>$.value&&(oe=$.value),Ps(e.currentPage)&&(z.value=oe),S&&(t("update:current-page",oe),t("current-change",oe))}});qt($,J=>{F.value>J&&(F.value=J)}),qt([F,N],J=>{t("change",...J)},{flush:"post"});function W(J){F.value=J}function U(J){N.value=J;const oe=$.value;F.value>oe&&(F.value=oe)}function re(){e.disabled||(F.value-=1,t("prev-click",F.value))}function K(){e.disabled||(F.value+=1,t("next-click",F.value))}function q(J,oe){J&&(J.props||(J.props={}),J.props.class=[J.props.class,oe].join(" "))}return Bo(_z,{pageCount:$,disabled:ee(()=>e.disabled),currentPage:F,changeEvent:W,handleSizeChange:U}),()=>{var J,oe;if(!I.value)return a("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&$.value<=1)return null;const ae=[],fe=[],ge=Kn("div",{class:d.e("rightwrapper")},fe),ce={prev:Kn(xoe,{disabled:e.disabled,currentPage:F.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:re}),jumper:Kn(Zoe,{size:o.value}),pager:Kn(ore,{currentPage:F.value,pageCount:$.value,pagerCount:e.pagerCount,onChange:W,disabled:e.disabled}),next:Kn(Coe,{disabled:e.disabled,currentPage:F.value,pageCount:$.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:K}),sizes:Kn(Goe,{pageSize:N.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:o.value,appendSizeTo:e.appendSizeTo}),slot:(oe=(J=i==null?void 0:i.default)==null?void 0:J.call(i))!=null?oe:null,total:Kn(Qoe,{total:Ps(e.total)?0:e.total})},de=e.layout.split(",").map(Re=>Re.trim());let _e=!1;return de.forEach(Re=>{if(Re==="->"){_e=!0;return}_e?fe.push(ce[Re]):ae.push(ce[Re])}),q(ae[0],d.is("first")),q(ae[ae.length-1],d.is("last")),_e&&fe.length>0&&(q(fe[0],d.is("first")),q(fe[fe.length-1],d.is("last")),ae.push(ge)),Kn("div",{class:[d.b(),d.is("background",e.background),d.m(o.value)]},ae)}}});const are=uo(sre),lre=cn({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:w2,default:"primary"},cancelButtonType:{type:String,values:w2,default:"text"},icon:{type:Cr,default:()=>GG},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:Fi.teleported,persistent:Fi.persistent,width:{type:[String,Number],default:150}}),cre={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},ure=qe({name:"ElPopconfirm"}),dre=qe({...ure,props:lre,emits:cre,setup(e,{emit:t}){const i=e,{t:a}=qo(),d=Xt("popconfirm"),g=xe(),_=()=>{var z,N;(N=(z=g.value)==null?void 0:z.onClose)==null||N.call(z)},o=ee(()=>({width:fi(i.width)})),S=z=>{t("confirm",z),_()},E=z=>{t("cancel",z),_()},I=ee(()=>i.confirmButtonText||a("el.popconfirm.confirmButtonText")),R=ee(()=>i.cancelButtonText||a("el.popconfirm.cancelButtonText"));return(z,N)=>(se(),Et(y(rs),Po({ref_key:"tooltipRef",ref:g,trigger:"click",effect:"light"},z.$attrs,{"popper-class":`${y(d).namespace.value}-popover`,"popper-style":y(o),teleported:z.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":z.hideAfter,persistent:z.persistent}),{content:it(()=>[je("div",{class:ue(y(d).b())},[je("div",{class:ue(y(d).e("main"))},[!z.hideIcon&&z.icon?(se(),Et(y(Dn),{key:0,class:ue(y(d).e("icon")),style:$n({color:z.iconColor})},{default:it(()=>[(se(),Et(ko(z.icon)))]),_:1},8,["class","style"])):yt("v-if",!0),$o(" "+mn(z.title),1)],2),je("div",{class:ue(y(d).e("action"))},[vt(z.$slots,"actions",{confirm:S,cancel:E},()=>[Ye(y($i),{size:"small",type:z.cancelButtonType==="text"?"":z.cancelButtonType,text:z.cancelButtonType==="text",onClick:E},{default:it(()=>[$o(mn(y(R)),1)]),_:1},8,["type","text"]),Ye(y($i),{size:"small",type:z.confirmButtonType==="text"?"":z.confirmButtonType,text:z.confirmButtonType==="text",onClick:S},{default:it(()=>[$o(mn(y(I)),1)]),_:1},8,["type","text"])])],2)],2)]),default:it(()=>[z.$slots.reference?vt(z.$slots,"reference",{key:0}):yt("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var hre=fn(dre,[["__file","popconfirm.vue"]]);const fre=uo(hre),pre=cn({trigger:Fv.trigger,placement:$0.placement,disabled:Fv.disabled,visible:Fi.visible,transition:Fi.transition,popperOptions:$0.popperOptions,tabindex:$0.tabindex,content:Fi.content,popperStyle:Fi.popperStyle,popperClass:Fi.popperClass,enterable:{...Fi.enterable,default:!0},effect:{...Fi.effect,default:"light"},teleported:Fi.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),mre={"update:visible":e=>Lr(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},gre="onUpdate:visible",vre=qe({name:"ElPopover"}),_re=qe({...vre,props:pre,emits:mre,setup(e,{expose:t,emit:i}){const a=e,d=ee(()=>a[gre]),g=Xt("popover"),_=xe(),o=ee(()=>{var W;return(W=y(_))==null?void 0:W.popperRef}),S=ee(()=>[{width:fi(a.width)},a.popperStyle]),E=ee(()=>[g.b(),a.popperClass,{[g.m("plain")]:!!a.content}]),I=ee(()=>a.transition===`${g.namespace.value}-fade-in-linear`),R=()=>{var W;(W=_.value)==null||W.hide()},z=()=>{i("before-enter")},N=()=>{i("before-leave")},$=()=>{i("after-enter")},F=()=>{i("update:visible",!1),i("after-leave")};return t({popperRef:o,hide:R}),(W,U)=>(se(),Et(y(rs),Po({ref_key:"tooltipRef",ref:_},W.$attrs,{trigger:W.trigger,placement:W.placement,disabled:W.disabled,visible:W.visible,transition:W.transition,"popper-options":W.popperOptions,tabindex:W.tabindex,content:W.content,offset:W.offset,"show-after":W.showAfter,"hide-after":W.hideAfter,"auto-close":W.autoClose,"show-arrow":W.showArrow,"aria-label":W.title,effect:W.effect,enterable:W.enterable,"popper-class":y(E),"popper-style":y(S),teleported:W.teleported,persistent:W.persistent,"gpu-acceleration":y(I),"onUpdate:visible":y(d),onBeforeShow:z,onBeforeHide:N,onShow:$,onHide:F}),{content:it(()=>[W.title?(se(),Ie("div",{key:0,class:ue(y(g).e("title")),role:"title"},mn(W.title),3)):yt("v-if",!0),vt(W.$slots,"default",{},()=>[$o(mn(W.content),1)])]),default:it(()=>[W.$slots.reference?vt(W.$slots,"reference",{key:0}):yt("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var yre=fn(_re,[["__file","popover.vue"]]);const R3=(e,t)=>{const i=t.arg||t.value,a=i==null?void 0:i.popperRef;a&&(a.triggerRef=e)};var bre={mounted(e,t){R3(e,t)},updated(e,t){R3(e,t)}};const xre="popover",xz=mW(bre,xre),wre=uo(yre,{directive:xz}),Sre=cn({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:at(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:at([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:at(Function),default:e=>`${e}%`}}),Tre=qe({name:"ElProgress"}),Cre=qe({...Tre,props:Sre,setup(e){const t=e,i={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=Xt("progress"),d=ee(()=>{const K={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},q=re(t.percentage);return q.includes("gradient")?K.background=q:K.backgroundColor=q,K}),g=ee(()=>(t.strokeWidth/t.width*100).toFixed(1)),_=ee(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(g.value)/2}`,10):0),o=ee(()=>{const K=_.value,q=t.type==="dashboard";return`
          M 50 50
          m 0 ${q?"":"-"}${K}
          a ${K} ${K} 0 1 1 0 ${q?"-":""}${K*2}
          a ${K} ${K} 0 1 1 0 ${q?"":"-"}${K*2}
          `}),S=ee(()=>2*Math.PI*_.value),E=ee(()=>t.type==="dashboard"?.75:1),I=ee(()=>`${-1*S.value*(1-E.value)/2}px`),R=ee(()=>({strokeDasharray:`${S.value*E.value}px, ${S.value}px`,strokeDashoffset:I.value})),z=ee(()=>({strokeDasharray:`${S.value*E.value*(t.percentage/100)}px, ${S.value}px`,strokeDashoffset:I.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),N=ee(()=>{let K;return t.color?K=re(t.percentage):K=i[t.status]||i.default,K}),$=ee(()=>t.status==="warning"?qb:t.type==="line"?t.status==="success"?rT:ud:t.status==="success"?i_:yl),F=ee(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),W=ee(()=>t.format(t.percentage));function U(K){const q=100/K.length;return K.map((oe,ae)=>Bn(oe)?{color:oe,percentage:(ae+1)*q}:oe).sort((oe,ae)=>oe.percentage-ae.percentage)}const re=K=>{var q;const{color:J}=t;if(Nn(J))return J(K);if(Bn(J))return J;{const oe=U(J);for(const ae of oe)if(ae.percentage>K)return ae.color;return(q=oe[oe.length-1])==null?void 0:q.color}};return(K,q)=>(se(),Ie("div",{class:ue([y(a).b(),y(a).m(K.type),y(a).is(K.status),{[y(a).m("without-text")]:!K.showText,[y(a).m("text-inside")]:K.textInside}]),role:"progressbar","aria-valuenow":K.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[K.type==="line"?(se(),Ie("div",{key:0,class:ue(y(a).b("bar"))},[je("div",{class:ue(y(a).be("bar","outer")),style:$n({height:`${K.strokeWidth}px`})},[je("div",{class:ue([y(a).be("bar","inner"),{[y(a).bem("bar","inner","indeterminate")]:K.indeterminate},{[y(a).bem("bar","inner","striped")]:K.striped},{[y(a).bem("bar","inner","striped-flow")]:K.stripedFlow}]),style:$n(y(d))},[(K.showText||K.$slots.default)&&K.textInside?(se(),Ie("div",{key:0,class:ue(y(a).be("bar","innerText"))},[vt(K.$slots,"default",{percentage:K.percentage},()=>[je("span",null,mn(y(W)),1)])],2)):yt("v-if",!0)],6)],6)],2)):(se(),Ie("div",{key:1,class:ue(y(a).b("circle")),style:$n({height:`${K.width}px`,width:`${K.width}px`})},[(se(),Ie("svg",{viewBox:"0 0 100 100"},[je("path",{class:ue(y(a).be("circle","track")),d:y(o),stroke:`var(${y(a).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":K.strokeLinecap,"stroke-width":y(g),fill:"none",style:$n(y(R))},null,14,["d","stroke","stroke-linecap","stroke-width"]),je("path",{class:ue(y(a).be("circle","path")),d:y(o),stroke:y(N),fill:"none",opacity:K.percentage?1:0,"stroke-linecap":K.strokeLinecap,"stroke-width":y(g),style:$n(y(z))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(K.showText||K.$slots.default)&&!K.textInside?(se(),Ie("div",{key:2,class:ue(y(a).e("text")),style:$n({fontSize:`${y(F)}px`})},[vt(K.$slots,"default",{percentage:K.percentage},()=>[K.status?(se(),Et(y(Dn),{key:1},{default:it(()=>[(se(),Et(ko(y($))))]),_:1})):(se(),Ie("span",{key:0},mn(y(W)),1))])],6)):yt("v-if",!0)],10,["aria-valuenow"]))}});var Ere=fn(Cre,[["__file","progress.vue"]]);const wz=uo(Ere),Mre=cn({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:at([Array,Object]),default:()=>oi(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:at([Array,Object]),default:()=>[f0,f0,f0]},voidIcon:{type:Cr,default:()=>sW},disabledVoidIcon:{type:Cr,default:()=>f0},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:at(Array),default:()=>oi(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:ki,clearable:Boolean,...Zi(["ariaLabel"])}),Ire={[Wr]:e=>Wn(e),[xo]:e=>Wn(e)},Are=qe({name:"ElRate"}),kre=qe({...Are,props:Mre,emits:Ire,setup(e,{expose:t,emit:i}){const a=e;function d(ye,Me){const Te=Ne=>So(Ne),he=Object.keys(Me).map(Ne=>+Ne).filter(Ne=>{const nt=Me[Ne];return(Te(nt)?nt.excluded:!1)?ye<Ne:ye<=Ne}).sort((Ne,nt)=>Ne-nt),ke=Me[he[0]];return Te(ke)&&ke.value||ke}const g=kn(zh,void 0),_=kn(Yl,void 0),o=Mi(),S=Xt("rate"),{inputId:E,isLabeledByFormItem:I}=Cl(a,{formItemContext:_}),R=xe(a.modelValue),z=xe(-1),N=xe(!0),$=ee(()=>[S.b(),S.m(o.value)]),F=ee(()=>a.disabled||(g==null?void 0:g.disabled)),W=ee(()=>S.cssVarBlock({"void-color":a.voidColor,"disabled-void-color":a.disabledVoidColor,"fill-color":q.value})),U=ee(()=>{let ye="";return a.showScore?ye=a.scoreTemplate.replace(/\{\s*value\s*\}/,F.value?`${a.modelValue}`:`${R.value}`):a.showText&&(ye=a.texts[Math.ceil(R.value)-1]),ye}),re=ee(()=>a.modelValue*100-Math.floor(a.modelValue)*100),K=ee(()=>sn(a.colors)?{[a.lowThreshold]:a.colors[0],[a.highThreshold]:{value:a.colors[1],excluded:!0},[a.max]:a.colors[2]}:a.colors),q=ee(()=>{const ye=d(R.value,K.value);return So(ye)?"":ye}),J=ee(()=>{let ye="";return F.value?ye=`${re.value}%`:a.allowHalf&&(ye="50%"),{color:q.value,width:ye}}),oe=ee(()=>{let ye=sn(a.icons)?[...a.icons]:{...a.icons};return ye=Wu(ye),sn(ye)?{[a.lowThreshold]:ye[0],[a.highThreshold]:{value:ye[1],excluded:!0},[a.max]:ye[2]}:ye}),ae=ee(()=>d(a.modelValue,oe.value)),fe=ee(()=>F.value?Bn(a.disabledVoidIcon)?a.disabledVoidIcon:Wu(a.disabledVoidIcon):Bn(a.voidIcon)?a.voidIcon:Wu(a.voidIcon)),ge=ee(()=>d(R.value,oe.value));function ce(ye){const Me=F.value&&re.value>0&&ye-1<a.modelValue&&ye>a.modelValue,Te=a.allowHalf&&N.value&&ye-.5<=R.value&&ye>R.value;return Me||Te}function de(ye){a.clearable&&ye===a.modelValue&&(ye=0),i(xo,ye),a.modelValue!==ye&&i("change",ye)}function _e(ye){F.value||(a.allowHalf&&N.value?de(R.value):de(ye))}function Re(ye){if(F.value)return;let Me=R.value;const Te=ye.code;return Te===Cn.up||Te===Cn.right?(a.allowHalf?Me+=.5:Me+=1,ye.stopPropagation(),ye.preventDefault()):(Te===Cn.left||Te===Cn.down)&&(a.allowHalf?Me-=.5:Me-=1,ye.stopPropagation(),ye.preventDefault()),Me=Me<0?0:Me,Me=Me>a.max?a.max:Me,i(xo,Me),i("change",Me),Me}function Qe(ye,Me){if(!F.value){if(a.allowHalf&&Me){let Te=Me.target;Zs(Te,S.e("item"))&&(Te=Te.querySelector(`.${S.e("icon")}`)),(Te.clientWidth===0||Zs(Te,S.e("decimal")))&&(Te=Te.parentNode),N.value=Me.offsetX*2<=Te.clientWidth,R.value=N.value?ye-.5:ye}else R.value=ye;z.value=ye}}function Ee(){F.value||(a.allowHalf&&(N.value=a.modelValue!==Math.floor(a.modelValue)),R.value=a.modelValue,z.value=-1)}return qt(()=>a.modelValue,ye=>{R.value=ye,N.value=a.modelValue!==Math.floor(a.modelValue)}),a.modelValue||i(xo,0),t({setCurrentValue:Qe,resetCurrentValue:Ee}),(ye,Me)=>{var Te;return se(),Ie("div",{id:y(E),class:ue([y($),y(S).is("disabled",y(F))]),role:"slider","aria-label":y(I)?void 0:ye.ariaLabel||"rating","aria-labelledby":y(I)?(Te=y(_))==null?void 0:Te.labelId:void 0,"aria-valuenow":R.value,"aria-valuetext":y(U)||void 0,"aria-valuemin":"0","aria-valuemax":ye.max,tabindex:"0",style:$n(y(W)),onKeydown:Re},[(se(!0),Ie(Fn,null,Fo(ye.max,(he,ke)=>(se(),Ie("span",{key:ke,class:ue(y(S).e("item")),onMousemove:Ne=>Qe(he,Ne),onMouseleave:Ee,onClick:Ne=>_e(he)},[Ye(y(Dn),{class:ue([y(S).e("icon"),{hover:z.value===he},y(S).is("active",he<=R.value)])},{default:it(()=>[ce(he)?yt("v-if",!0):(se(),Ie(Fn,{key:0},[vo((se(),Et(ko(y(ge)),null,null,512)),[[ir,he<=R.value]]),vo((se(),Et(ko(y(fe)),null,null,512)),[[ir,!(he<=R.value)]])],64)),ce(he)?(se(),Ie(Fn,{key:1},[(se(),Et(ko(y(fe)),{class:ue([y(S).em("decimal","box")])},null,8,["class"])),Ye(y(Dn),{style:$n(y(J)),class:ue([y(S).e("icon"),y(S).e("decimal")])},{default:it(()=>[(se(),Et(ko(y(ae))))]),_:1},8,["style","class"])],64)):yt("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),ye.showText||ye.showScore?(se(),Ie("span",{key:0,class:ue(y(S).e("text")),style:$n({color:ye.textColor})},mn(y(U)),7)):yt("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var Pre=fn(kre,[["__file","rate.vue"]]);const Rre=uo(Pre),ap={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},D3={[ap.success]:_G,[ap.warning]:qb,[ap.error]:iT,[ap.info]:sT},Dre=cn({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),Lre=qe({name:"ElResult"}),Ore=qe({...Lre,props:Dre,setup(e){const t=e,i=Xt("result"),a=ee(()=>{const d=t.icon,g=d&&ap[d]?ap[d]:"icon-info",_=D3[g]||D3["icon-info"];return{class:g,component:_}});return(d,g)=>(se(),Ie("div",{class:ue(y(i).b())},[je("div",{class:ue(y(i).e("icon"))},[vt(d.$slots,"icon",{},()=>[y(a).component?(se(),Et(ko(y(a).component),{key:0,class:ue(y(a).class)},null,8,["class"])):yt("v-if",!0)])],2),d.title||d.$slots.title?(se(),Ie("div",{key:0,class:ue(y(i).e("title"))},[vt(d.$slots,"title",{},()=>[je("p",null,mn(d.title),1)])],2)):yt("v-if",!0),d.subTitle||d.$slots["sub-title"]?(se(),Ie("div",{key:1,class:ue(y(i).e("subtitle"))},[vt(d.$slots,"sub-title",{},()=>[je("p",null,mn(d.subTitle),1)])],2)):yt("v-if",!0),d.$slots.extra?(se(),Ie("div",{key:2,class:ue(y(i).e("extra"))},[vt(d.$slots,"extra")],2)):yt("v-if",!0)],2))}});var zre=fn(Ore,[["__file","result.vue"]]);const Bre=uo(zre);var L3=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Fre(e,t){return!!(e===t||L3(e)&&L3(t))}function Nre(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!Fre(e[i],t[i]))return!1;return!0}function $re(e,t){t===void 0&&(t=Nre);var i=null;function a(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];if(i&&i.lastThis===this&&t(d,i.lastArgs))return i.lastResult;var _=e.apply(this,d);return i={lastResult:_,lastArgs:d,lastThis:this},_}return a.clear=function(){i=null},a}const Sz=()=>{const t=To().proxy.$props;return ee(()=>{const i=(a,d,g)=>({});return t.perfMode?jb(i):$re(i)})},G2=50,gb="itemRendered",vb="scroll",lp="forward",_b="backward",za="auto",c1="smart",Uv="start",jl="center",jv="end",Bp="horizontal",QT="vertical",Vre="ltr",bp="rtl",Hv="negative",eC="positive-ascending",tC="positive-descending",Ure={[Bp]:"left",[QT]:"top"},jre=20,Hre={[Bp]:"deltaX",[QT]:"deltaY"},Gre=({atEndEdge:e,atStartEdge:t,layout:i},a)=>{let d,g=0;const _=S=>S<0&&t.value||S>0&&e.value;return{hasReachedEdge:_,onWheel:S=>{Ch(d);const E=S[Hre[i.value]];_(g)&&_(g+E)||(g+=E,BS()||S.preventDefault(),d=ed(()=>{a(g),g=0}))}}},W2=Sl({type:at([Number,Function]),required:!0}),q2=Sl({type:Number}),K2=Sl({type:Number,default:2}),Wre=Sl({type:String,values:["ltr","rtl"],default:"ltr"}),Z2=Sl({type:Number,default:0}),yb=Sl({type:Number,required:!0}),Tz=Sl({type:String,values:["horizontal","vertical"],default:QT}),Cz=cn({className:{type:String,default:""},containerElement:{type:at([String,Object]),default:"div"},data:{type:at(Array),default:()=>oi([])},direction:Wre,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:at([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),Ez=cn({cache:K2,estimatedItemSize:q2,layout:Tz,initScrollOffset:Z2,total:yb,itemSize:W2,...Cz}),Y2={type:Number,default:6},Mz={type:Number,default:0},Iz={type:Number,default:2},yh=cn({columnCache:K2,columnWidth:W2,estimatedColumnWidth:q2,estimatedRowHeight:q2,initScrollLeft:Z2,initScrollTop:Z2,itemKey:{type:at(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:K2,rowHeight:W2,totalColumn:yb,totalRow:yb,hScrollbarSize:Y2,vScrollbarSize:Y2,scrollbarStartGap:Mz,scrollbarEndGap:Iz,role:String,...Cz}),Az=cn({alwaysOn:Boolean,class:String,layout:Tz,total:yb,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:Y2,startGap:Mz,endGap:Iz,visible:Boolean}),hh=(e,t)=>e<t?lp:_b,Gv=e=>e===Vre||e===bp||e===Bp,O3=e=>e===bp;let Qf=null;function bb(e=!1){if(Qf===null||e){const t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";const a=document.createElement("div"),d=a.style;return d.width="100px",d.height="100px",t.appendChild(a),document.body.appendChild(t),t.scrollLeft>0?Qf=tC:(t.scrollLeft=1,t.scrollLeft===0?Qf=Hv:Qf=eC),document.body.removeChild(t),Qf}return Qf}function qre({move:e,size:t,bar:i},a){const d={},g=`translate${i.axis}(${e}px)`;return d[i.size]=t,d.transform=g,d.msTransform=g,d.webkitTransform=g,a==="horizontal"?d.height="100%":d.width="100%",d}const X2=qe({name:"ElVirtualScrollBar",props:Az,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const i=ee(()=>e.startGap+e.endGap),a=Xt("virtual-scrollbar"),d=Xt("scrollbar"),g=xe(),_=xe();let o=null,S=null;const E=dr({isDragging:!1,traveled:0}),I=ee(()=>kL[e.layout]),R=ee(()=>e.clientSize-y(i)),z=ee(()=>({position:"absolute",width:`${Bp===e.layout?R.value:e.scrollbarSize}px`,height:`${Bp===e.layout?e.scrollbarSize:R.value}px`,[Ure[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),N=ee(()=>{const oe=e.ratio,ae=e.clientSize;if(oe>=100)return Number.POSITIVE_INFINITY;if(oe>=50)return oe*ae/100;const fe=ae/3;return Math.floor(Math.min(Math.max(oe*ae,jre),fe))}),$=ee(()=>{if(!Number.isFinite(N.value))return{display:"none"};const oe=`${N.value}px`;return qre({bar:I.value,size:oe,move:E.traveled},e.layout)}),F=ee(()=>Math.floor(e.clientSize-N.value-y(i))),W=()=>{window.addEventListener("mousemove",q),window.addEventListener("mouseup",K);const oe=y(_);oe&&(S=document.onselectstart,document.onselectstart=()=>!1,oe.addEventListener("touchmove",q,{passive:!0}),oe.addEventListener("touchend",K))},U=()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",K),document.onselectstart=S,S=null;const oe=y(_);oe&&(oe.removeEventListener("touchmove",q),oe.removeEventListener("touchend",K))},re=oe=>{oe.stopImmediatePropagation(),!(oe.ctrlKey||[1,2].includes(oe.button))&&(E.isDragging=!0,E[I.value.axis]=oe.currentTarget[I.value.offset]-(oe[I.value.client]-oe.currentTarget.getBoundingClientRect()[I.value.direction]),t("start-move"),W())},K=()=>{E.isDragging=!1,E[I.value.axis]=0,t("stop-move"),U()},q=oe=>{const{isDragging:ae}=E;if(!ae||!_.value||!g.value)return;const fe=E[I.value.axis];if(!fe)return;Ch(o);const ge=(g.value.getBoundingClientRect()[I.value.direction]-oe[I.value.client])*-1,ce=_.value[I.value.offset]-fe,de=ge-ce;o=ed(()=>{E.traveled=Math.max(e.startGap,Math.min(de,F.value)),t("scroll",de,F.value)})},J=oe=>{const ae=Math.abs(oe.target.getBoundingClientRect()[I.value.direction]-oe[I.value.client]),fe=_.value[I.value.offset]/2,ge=ae-fe;E.traveled=Math.max(0,Math.min(ge,F.value)),t("scroll",ge,F.value)};return qt(()=>e.scrollFrom,oe=>{E.isDragging||(E.traveled=Math.ceil(oe*F.value))}),Pr(()=>{U()}),()=>Kn("div",{role:"presentation",ref:g,class:[a.b(),e.class,(e.alwaysOn||E.isDragging)&&"always-on"],style:z.value,onMousedown:Xn(J,["stop","prevent"]),onTouchstartPrevent:re},Kn("div",{ref:_,class:d.e("thumb"),style:$.value,onMousedown:re},[]))}}),kz=({name:e,getOffset:t,getItemSize:i,getItemOffset:a,getEstimatedTotalSize:d,getStartIndexForOffset:g,getStopIndexForStartIndex:_,initCache:o,clearCache:S,validateProps:E})=>qe({name:e??"ElVirtualList",props:Ez,emits:[gb,vb],setup(I,{emit:R,expose:z}){E(I);const N=To(),$=Xt("vl"),F=xe(o(I,N)),W=Sz(),U=xe(),re=xe(),K=xe(),q=xe({isScrolling:!1,scrollDir:"forward",scrollOffset:Wn(I.initScrollOffset)?I.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:I.scrollbarAlwaysOn}),J=ee(()=>{const{total:De,cache:Ct}=I,{isScrolling:Rt,scrollDir:Bt,scrollOffset:mt}=y(q);if(De===0)return[0,0,0,0];const Gt=g(I,mt,y(F)),jt=_(I,Gt,mt,y(F)),Be=!Rt||Bt===_b?Math.max(1,Ct):1,an=!Rt||Bt===lp?Math.max(1,Ct):1;return[Math.max(0,Gt-Be),Math.max(0,Math.min(De-1,jt+an)),Gt,jt]}),oe=ee(()=>d(I,y(F))),ae=ee(()=>Gv(I.layout)),fe=ee(()=>[{position:"relative",[`overflow-${ae.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:I.direction,height:Wn(I.height)?`${I.height}px`:I.height,width:Wn(I.width)?`${I.width}px`:I.width},I.style]),ge=ee(()=>{const De=y(oe),Ct=y(ae);return{height:Ct?"100%":`${De}px`,pointerEvents:y(q).isScrolling?"none":void 0,width:Ct?`${De}px`:"100%"}}),ce=ee(()=>ae.value?I.width:I.height),{onWheel:de}=Gre({atStartEdge:ee(()=>q.value.scrollOffset<=0),atEndEdge:ee(()=>q.value.scrollOffset>=oe.value),layout:ee(()=>I.layout)},De=>{var Ct,Rt;(Rt=(Ct=K.value).onMouseUp)==null||Rt.call(Ct),Me(Math.min(q.value.scrollOffset+De,oe.value-ce.value))});wr(U,"wheel",de,{passive:!1});const _e=()=>{const{total:De}=I;if(De>0){const[mt,Gt,jt,Be]=y(J);R(gb,mt,Gt,jt,Be)}const{scrollDir:Ct,scrollOffset:Rt,updateRequested:Bt}=y(q);R(vb,Ct,Rt,Bt)},Re=De=>{const{clientHeight:Ct,scrollHeight:Rt,scrollTop:Bt}=De.currentTarget,mt=y(q);if(mt.scrollOffset===Bt)return;const Gt=Math.max(0,Math.min(Bt,Rt-Ct));q.value={...mt,isScrolling:!0,scrollDir:hh(mt.scrollOffset,Gt),scrollOffset:Gt,updateRequested:!1},Un(ke)},Qe=De=>{const{clientWidth:Ct,scrollLeft:Rt,scrollWidth:Bt}=De.currentTarget,mt=y(q);if(mt.scrollOffset===Rt)return;const{direction:Gt}=I;let jt=Rt;if(Gt===bp)switch(bb()){case Hv:{jt=-Rt;break}case tC:{jt=Bt-Ct-Rt;break}}jt=Math.max(0,Math.min(jt,Bt-Ct)),q.value={...mt,isScrolling:!0,scrollDir:hh(mt.scrollOffset,jt),scrollOffset:jt,updateRequested:!1},Un(ke)},Ee=De=>{y(ae)?Qe(De):Re(De),_e()},ye=(De,Ct)=>{const Rt=(oe.value-ce.value)/Ct*De;Me(Math.min(oe.value-ce.value,Rt))},Me=De=>{De=Math.max(De,0),De!==y(q).scrollOffset&&(q.value={...y(q),scrollOffset:De,scrollDir:hh(y(q).scrollOffset,De),updateRequested:!0},Un(ke))},Te=(De,Ct=za)=>{const{scrollOffset:Rt}=y(q);De=Math.max(0,Math.min(De,I.total-1)),Me(t(I,De,Ct,Rt,y(F)))},he=De=>{const{direction:Ct,itemSize:Rt,layout:Bt}=I,mt=W.value(S&&Rt,S&&Bt,S&&Ct);let Gt;if(or(mt,String(De)))Gt=mt[De];else{const jt=a(I,De,y(F)),Be=i(I,De,y(F)),an=y(ae),At=Ct===bp,Ge=an?jt:0;mt[De]=Gt={position:"absolute",left:At?void 0:`${Ge}px`,right:At?`${Ge}px`:void 0,top:an?0:`${jt}px`,height:an?"100%":`${Be}px`,width:an?`${Be}px`:"100%"}}return Gt},ke=()=>{q.value.isScrolling=!1,Un(()=>{W.value(-1,null,null)})},Ne=()=>{const De=U.value;De&&(De.scrollTop=0)};_o(()=>{if(!Wo)return;const{initScrollOffset:De}=I,Ct=y(U);Wn(De)&&Ct&&(y(ae)?Ct.scrollLeft=De:Ct.scrollTop=De),_e()}),Xl(()=>{const{direction:De,layout:Ct}=I,{scrollOffset:Rt,updateRequested:Bt}=y(q),mt=y(U);if(Bt&&mt)if(Ct===Bp)if(De===bp)switch(bb()){case Hv:{mt.scrollLeft=-Rt;break}case eC:{mt.scrollLeft=Rt;break}default:{const{clientWidth:Gt,scrollWidth:jt}=mt;mt.scrollLeft=jt-Gt-Rt;break}}else mt.scrollLeft=Rt;else mt.scrollTop=Rt}),ES(()=>{y(U).scrollTop=y(q).scrollOffset});const nt={ns:$,clientSize:ce,estimatedTotalSize:oe,windowStyle:fe,windowRef:U,innerRef:re,innerStyle:ge,itemsToRender:J,scrollbarRef:K,states:q,getItemStyle:he,onScroll:Ee,onScrollbarScroll:ye,onWheel:de,scrollTo:Me,scrollToItem:Te,resetScrollTop:Ne};return z({windowRef:U,innerRef:re,getItemStyleCache:W,scrollTo:Me,scrollToItem:Te,resetScrollTop:Ne,states:q}),nt},render(I){var R;const{$slots:z,className:N,clientSize:$,containerElement:F,data:W,getItemStyle:U,innerElement:re,itemsToRender:K,innerStyle:q,layout:J,total:oe,onScroll:ae,onScrollbarScroll:fe,states:ge,useIsScrolling:ce,windowStyle:de,ns:_e}=I,[Re,Qe]=K,Ee=ko(F),ye=ko(re),Me=[];if(oe>0)for(let Ne=Re;Ne<=Qe;Ne++)Me.push(Kn(Fn,{key:Ne},(R=z.default)==null?void 0:R.call(z,{data:W,index:Ne,isScrolling:ce?ge.isScrolling:void 0,style:U(Ne)})));const Te=[Kn(ye,{style:q,ref:"innerRef"},Bn(ye)?Me:{default:()=>Me})],he=Kn(X2,{ref:"scrollbarRef",clientSize:$,layout:J,onScroll:fe,ratio:$*100/this.estimatedTotalSize,scrollFrom:ge.scrollOffset/(this.estimatedTotalSize-$),total:oe}),ke=Kn(Ee,{class:[_e.e("window"),N],style:de,onScroll:ae,ref:"windowRef",key:0},Bn(Ee)?[Te]:{default:()=>[Te]});return Kn("div",{key:0,class:[_e.e("wrapper"),ge.scrollbarAlwaysOn?"always-on":""]},[ke,he])}}),Pz=kz({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:i,layout:a,width:d},g,_,o)=>{const S=Gv(a)?d:e,E=Math.max(0,t*i-S),I=Math.min(E,g*i),R=Math.max(0,(g+1)*i-S);switch(_===c1&&(o>=R-S&&o<=I+S?_=za:_=jl),_){case Uv:return I;case jv:return R;case jl:{const z=Math.round(R+(I-R)/2);return z<Math.ceil(S/2)?0:z>E+Math.floor(S/2)?E:z}case za:default:return o>=R&&o<=I?o:o<R?R:I}},getStartIndexForOffset:({total:e,itemSize:t},i)=>Math.max(0,Math.min(e-1,Math.floor(i/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:i,layout:a,width:d},g,_)=>{const o=g*i,S=Gv(a)?d:e,E=Math.ceil((S+_-o)/i);return Math.max(0,Math.min(t-1,g+E-1))},initCache(){},clearCache:!0,validateProps(){}}),cp=(e,t,i)=>{const{itemSize:a}=e,{items:d,lastVisitedIndex:g}=i;if(t>g){let _=0;if(g>=0){const o=d[g];_=o.offset+o.size}for(let o=g+1;o<=t;o++){const S=a(o);d[o]={offset:_,size:S},_+=S}i.lastVisitedIndex=t}return d[t]},Kre=(e,t,i)=>{const{items:a,lastVisitedIndex:d}=t;return(d>0?a[d].offset:0)>=i?Rz(e,t,0,d,i):Zre(e,t,Math.max(0,d),i)},Rz=(e,t,i,a,d)=>{for(;i<=a;){const g=i+Math.floor((a-i)/2),_=cp(e,g,t).offset;if(_===d)return g;_<d?i=g+1:_>d&&(a=g-1)}return Math.max(0,i-1)},Zre=(e,t,i,a)=>{const{total:d}=e;let g=1;for(;i<d&&cp(e,i,t).offset<a;)i+=g,g*=2;return Rz(e,t,Math.floor(i/2),Math.min(i,d-1),a)},z3=({total:e},{items:t,estimatedItemSize:i,lastVisitedIndex:a})=>{let d=0;if(a>=e&&(a=e-1),a>=0){const o=t[a];d=o.offset+o.size}const _=(e-a-1)*i;return d+_},Yre=kz({name:"ElDynamicSizeList",getItemOffset:(e,t,i)=>cp(e,t,i).offset,getItemSize:(e,t,{items:i})=>i[t].size,getEstimatedTotalSize:z3,getOffset:(e,t,i,a,d)=>{const{height:g,layout:_,width:o}=e,S=Gv(_)?o:g,E=cp(e,t,d),I=z3(e,d),R=Math.max(0,Math.min(I-S,E.offset)),z=Math.max(0,E.offset-S+E.size);switch(i===c1&&(a>=z-S&&a<=R+S?i=za:i=jl),i){case Uv:return R;case jv:return z;case jl:return Math.round(z+(R-z)/2);case za:default:return a>=z&&a<=R?a:a<z?z:R}},getStartIndexForOffset:(e,t,i)=>Kre(e,i,t),getStopIndexForStartIndex:(e,t,i,a)=>{const{height:d,total:g,layout:_,width:o}=e,S=Gv(_)?o:d,E=cp(e,t,a),I=i+S;let R=E.offset+E.size,z=t;for(;z<g-1&&R<I;)z++,R+=cp(e,z,a).size;return z},initCache({estimatedItemSize:e=G2},t){const i={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return i.clearCacheAfterIndex=(a,d=!0)=>{var g,_;i.lastVisitedIndex=Math.min(i.lastVisitedIndex,a-1),(g=t.exposed)==null||g.getItemStyleCache(-1),d&&((_=t.proxy)==null||_.$forceUpdate())},i},clearCache:!1,validateProps:({itemSize:e})=>{}}),Xre=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:i,atYStartEdge:a},d)=>{let g=null,_=0,o=0;const S=(I,R)=>{const z=I<=0&&t.value||I>=0&&e.value,N=R<=0&&a.value||R>=0&&i.value;return z&&N};return{hasReachedEdge:S,onWheel:I=>{Ch(g);let R=I.deltaX,z=I.deltaY;Math.abs(R)>Math.abs(z)?z=0:R=0,I.shiftKey&&z!==0&&(R=z,z=0),!(S(_,o)&&S(_+R,o+z))&&(_+=R,o+=z,I.preventDefault(),g=ed(()=>{d(_,o),_=0,o=0}))}}},Dz=({name:e,clearCache:t,getColumnPosition:i,getColumnStartIndexForOffset:a,getColumnStopIndexForStartIndex:d,getEstimatedTotalHeight:g,getEstimatedTotalWidth:_,getColumnOffset:o,getRowOffset:S,getRowPosition:E,getRowStartIndexForOffset:I,getRowStopIndexForStartIndex:R,initCache:z,injectToInstance:N,validateProps:$})=>qe({name:e??"ElVirtualList",props:yh,emits:[gb,vb],setup(F,{emit:W,expose:U,slots:re}){const K=Xt("vl");$(F);const q=To(),J=xe(z(F,q));N==null||N(q,J);const oe=xe(),ae=xe(),fe=xe(),ge=xe(null),ce=xe({isScrolling:!1,scrollLeft:Wn(F.initScrollLeft)?F.initScrollLeft:0,scrollTop:Wn(F.initScrollTop)?F.initScrollTop:0,updateRequested:!1,xAxisScrollDir:lp,yAxisScrollDir:lp}),de=Sz(),_e=ee(()=>Number.parseInt(`${F.height}`,10)),Re=ee(()=>Number.parseInt(`${F.width}`,10)),Qe=ee(()=>{const{totalColumn:Dt,totalRow:xt,columnCache:Ot}=F,{isScrolling:en,xAxisScrollDir:dn,scrollLeft:un}=y(ce);if(Dt===0||xt===0)return[0,0,0,0];const Pn=a(F,un,y(J)),gt=d(F,Pn,un,y(J)),Sn=!en||dn===_b?Math.max(1,Ot):1,Vn=!en||dn===lp?Math.max(1,Ot):1;return[Math.max(0,Pn-Sn),Math.max(0,Math.min(Dt-1,gt+Vn)),Pn,gt]}),Ee=ee(()=>{const{totalColumn:Dt,totalRow:xt,rowCache:Ot}=F,{isScrolling:en,yAxisScrollDir:dn,scrollTop:un}=y(ce);if(Dt===0||xt===0)return[0,0,0,0];const Pn=I(F,un,y(J)),gt=R(F,Pn,un,y(J)),Sn=!en||dn===_b?Math.max(1,Ot):1,Vn=!en||dn===lp?Math.max(1,Ot):1;return[Math.max(0,Pn-Sn),Math.max(0,Math.min(xt-1,gt+Vn)),Pn,gt]}),ye=ee(()=>g(F,y(J))),Me=ee(()=>_(F,y(J))),Te=ee(()=>{var Dt;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:F.direction,height:Wn(F.height)?`${F.height}px`:F.height,width:Wn(F.width)?`${F.width}px`:F.width},(Dt=F.style)!=null?Dt:{}]}),he=ee(()=>{const Dt=`${y(Me)}px`;return{height:`${y(ye)}px`,pointerEvents:y(ce).isScrolling?"none":void 0,width:Dt}}),ke=()=>{const{totalColumn:Dt,totalRow:xt}=F;if(Dt>0&&xt>0){const[gt,Sn,Vn,lo]=y(Qe),[eo,fo,Lo,er]=y(Ee);W(gb,{columnCacheStart:gt,columnCacheEnd:Sn,rowCacheStart:eo,rowCacheEnd:fo,columnVisibleStart:Vn,columnVisibleEnd:lo,rowVisibleStart:Lo,rowVisibleEnd:er})}const{scrollLeft:Ot,scrollTop:en,updateRequested:dn,xAxisScrollDir:un,yAxisScrollDir:Pn}=y(ce);W(vb,{xAxisScrollDir:un,scrollLeft:Ot,yAxisScrollDir:Pn,scrollTop:en,updateRequested:dn})},Ne=Dt=>{const{clientHeight:xt,clientWidth:Ot,scrollHeight:en,scrollLeft:dn,scrollTop:un,scrollWidth:Pn}=Dt.currentTarget,gt=y(ce);if(gt.scrollTop===un&&gt.scrollLeft===dn)return;let Sn=dn;if(O3(F.direction))switch(bb()){case Hv:Sn=-dn;break;case tC:Sn=Pn-Ot-dn;break}ce.value={...gt,isScrolling:!0,scrollLeft:Sn,scrollTop:Math.max(0,Math.min(un,en-xt)),updateRequested:!0,xAxisScrollDir:hh(gt.scrollLeft,Sn),yAxisScrollDir:hh(gt.scrollTop,un)},Un(()=>Gt()),jt(),ke()},nt=(Dt,xt)=>{const Ot=y(_e),en=(ye.value-Ot)/xt*Dt;Rt({scrollTop:Math.min(ye.value-Ot,en)})},De=(Dt,xt)=>{const Ot=y(Re),en=(Me.value-Ot)/xt*Dt;Rt({scrollLeft:Math.min(Me.value-Ot,en)})},{onWheel:Ct}=Xre({atXStartEdge:ee(()=>ce.value.scrollLeft<=0),atXEndEdge:ee(()=>ce.value.scrollLeft>=Me.value-y(Re)),atYStartEdge:ee(()=>ce.value.scrollTop<=0),atYEndEdge:ee(()=>ce.value.scrollTop>=ye.value-y(_e))},(Dt,xt)=>{var Ot,en,dn,un;(en=(Ot=ae.value)==null?void 0:Ot.onMouseUp)==null||en.call(Ot),(un=(dn=fe.value)==null?void 0:dn.onMouseUp)==null||un.call(dn);const Pn=y(Re),gt=y(_e);Rt({scrollLeft:Math.min(ce.value.scrollLeft+Dt,Me.value-Pn),scrollTop:Math.min(ce.value.scrollTop+xt,ye.value-gt)})});wr(oe,"wheel",Ct,{passive:!1});const Rt=({scrollLeft:Dt=ce.value.scrollLeft,scrollTop:xt=ce.value.scrollTop})=>{Dt=Math.max(Dt,0),xt=Math.max(xt,0);const Ot=y(ce);xt===Ot.scrollTop&&Dt===Ot.scrollLeft||(ce.value={...Ot,xAxisScrollDir:hh(Ot.scrollLeft,Dt),yAxisScrollDir:hh(Ot.scrollTop,xt),scrollLeft:Dt,scrollTop:xt,updateRequested:!0},Un(()=>Gt()),jt(),ke())},Bt=(Dt=0,xt=0,Ot=za)=>{const en=y(ce);xt=Math.max(0,Math.min(xt,F.totalColumn-1)),Dt=Math.max(0,Math.min(Dt,F.totalRow-1));const dn=BD(K.namespace.value),un=y(J),Pn=g(F,un),gt=_(F,un);Rt({scrollLeft:o(F,xt,Ot,en.scrollLeft,un,gt>F.width?dn:0),scrollTop:S(F,Dt,Ot,en.scrollTop,un,Pn>F.height?dn:0)})},mt=(Dt,xt)=>{const{columnWidth:Ot,direction:en,rowHeight:dn}=F,un=de.value(t&&Ot,t&&dn,t&&en),Pn=`${Dt},${xt}`;if(or(un,Pn))return un[Pn];{const[,gt]=i(F,xt,y(J)),Sn=y(J),Vn=O3(en),[lo,eo]=E(F,Dt,Sn),[fo]=i(F,xt,Sn);return un[Pn]={position:"absolute",left:Vn?void 0:`${gt}px`,right:Vn?`${gt}px`:void 0,top:`${eo}px`,height:`${lo}px`,width:`${fo}px`},un[Pn]}},Gt=()=>{ce.value.isScrolling=!1,Un(()=>{de.value(-1,null,null)})};_o(()=>{if(!Wo)return;const{initScrollLeft:Dt,initScrollTop:xt}=F,Ot=y(oe);Ot&&(Wn(Dt)&&(Ot.scrollLeft=Dt),Wn(xt)&&(Ot.scrollTop=xt)),ke()});const jt=()=>{const{direction:Dt}=F,{scrollLeft:xt,scrollTop:Ot,updateRequested:en}=y(ce),dn=y(oe);if(en&&dn){if(Dt===bp)switch(bb()){case Hv:{dn.scrollLeft=-xt;break}case eC:{dn.scrollLeft=xt;break}default:{const{clientWidth:un,scrollWidth:Pn}=dn;dn.scrollLeft=Pn-un-xt;break}}else dn.scrollLeft=Math.max(0,xt);dn.scrollTop=Math.max(0,Ot)}},{resetAfterColumnIndex:Be,resetAfterRowIndex:an,resetAfter:At}=q.proxy;U({windowRef:oe,innerRef:ge,getItemStyleCache:de,scrollTo:Rt,scrollToItem:Bt,states:ce,resetAfterColumnIndex:Be,resetAfterRowIndex:an,resetAfter:At});const Ge=()=>{const{scrollbarAlwaysOn:Dt,scrollbarStartGap:xt,scrollbarEndGap:Ot,totalColumn:en,totalRow:dn}=F,un=y(Re),Pn=y(_e),gt=y(Me),Sn=y(ye),{scrollLeft:Vn,scrollTop:lo}=y(ce),eo=Kn(X2,{ref:ae,alwaysOn:Dt,startGap:xt,endGap:Ot,class:K.e("horizontal"),clientSize:un,layout:"horizontal",onScroll:De,ratio:un*100/gt,scrollFrom:Vn/(gt-un),total:dn,visible:!0}),fo=Kn(X2,{ref:fe,alwaysOn:Dt,startGap:xt,endGap:Ot,class:K.e("vertical"),clientSize:Pn,layout:"vertical",onScroll:nt,ratio:Pn*100/Sn,scrollFrom:lo/(Sn-Pn),total:en,visible:!0});return{horizontalScrollbar:eo,verticalScrollbar:fo}},Fe=()=>{var Dt;const[xt,Ot]=y(Qe),[en,dn]=y(Ee),{data:un,totalColumn:Pn,totalRow:gt,useIsScrolling:Sn,itemKey:Vn}=F,lo=[];if(gt>0&&Pn>0)for(let eo=en;eo<=dn;eo++)for(let fo=xt;fo<=Ot;fo++){const Lo=Vn({columnIndex:fo,data:un,rowIndex:eo});lo.push(Kn(Fn,{key:Lo},(Dt=re.default)==null?void 0:Dt.call(re,{columnIndex:fo,data:un,isScrolling:Sn?y(ce).isScrolling:void 0,style:mt(eo,fo),rowIndex:eo})))}return lo},Nt=()=>{const Dt=ko(F.innerElement),xt=Fe();return[Kn(Dt,{style:y(he),ref:ge},Bn(Dt)?xt:{default:()=>xt})]};return()=>{const Dt=ko(F.containerElement),{horizontalScrollbar:xt,verticalScrollbar:Ot}=Ge(),en=Nt();return Kn("div",{key:0,class:K.e("wrapper"),role:F.role},[Kn(Dt,{class:F.className,style:y(Te),onScroll:Ne,ref:oe},Bn(Dt)?en:{default:()=>en}),xt,Ot])}}}),Jre=Dz({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:i},a,d,g,_,o)=>{i=Number(i);const S=Math.max(0,e*t-i),E=Math.min(S,a*t),I=Math.max(0,a*t-i+o+t);switch(d==="smart"&&(g>=I-i&&g<=E+i?d=za:d=jl),d){case Uv:return E;case jv:return I;case jl:{const R=Math.round(I+(E-I)/2);return R<Math.ceil(i/2)?0:R>S+Math.floor(i/2)?S:R}case za:default:return g>=I&&g<=E?g:I>E||g<I?I:E}},getRowOffset:({rowHeight:e,height:t,totalRow:i},a,d,g,_,o)=>{t=Number(t);const S=Math.max(0,i*e-t),E=Math.min(S,a*e),I=Math.max(0,a*e-t+o+e);switch(d===c1&&(g>=I-t&&g<=E+t?d=za:d=jl),d){case Uv:return E;case jv:return I;case jl:{const R=Math.round(I+(E-I)/2);return R<Math.ceil(t/2)?0:R>S+Math.floor(t/2)?S:R}case za:default:return g>=I&&g<=E?g:I>E||g<I?I:E}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:i},a,d)=>{const g=a*e,_=Math.ceil((i+d-g)/e);return Math.max(0,Math.min(t-1,a+_-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:i},a,d)=>{const g=a*e,_=Math.ceil((i+d-g)/e);return Math.max(0,Math.min(t-1,a+_-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),{max:xb,min:Lz,floor:Oz}=Math,Qre={column:"columnWidth",row:"rowHeight"},J2={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Sc=(e,t,i,a)=>{const[d,g,_]=[i[a],e[Qre[a]],i[J2[a]]];if(t>_){let o=0;if(_>=0){const S=d[_];o=S.offset+S.size}for(let S=_+1;S<=t;S++){const E=g(S);d[S]={offset:o,size:E},o+=E}i[J2[a]]=t}return d[t]},zz=(e,t,i,a,d,g)=>{for(;i<=a;){const _=i+Oz((a-i)/2),o=Sc(e,_,t,g).offset;if(o===d)return _;o<d?i=_+1:a=_-1}return xb(0,i-1)},eie=(e,t,i,a,d)=>{const g=d==="column"?e.totalColumn:e.totalRow;let _=1;for(;i<g&&Sc(e,i,t,d).offset<a;)i+=_,_*=2;return zz(e,t,Oz(i/2),Lz(i,g-1),a,d)},B3=(e,t,i,a)=>{const[d,g]=[t[a],t[J2[a]]];return(g>0?d[g].offset:0)>=i?zz(e,t,0,g,i,a):eie(e,t,xb(0,g),i,a)},Bz=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:i,row:a})=>{let d=0;if(i>=e&&(i=e-1),i>=0){const o=a[i];d=o.offset+o.size}const _=(e-i-1)*t;return d+_},Fz=({totalColumn:e},{column:t,estimatedColumnWidth:i,lastVisitedColumnIndex:a})=>{let d=0;if(a>e&&(a=e-1),a>=0){const o=t[a];d=o.offset+o.size}const _=(e-a-1)*i;return d+_},tie={column:Fz,row:Bz},F3=(e,t,i,a,d,g,_)=>{const[o,S]=[g==="row"?e.height:e.width,tie[g]],E=Sc(e,t,d,g),I=S(e,d),R=xb(0,Lz(I-o,E.offset)),z=xb(0,E.offset-o+_+E.size);switch(i===c1&&(a>=z-o&&a<=R+o?i=za:i=jl),i){case Uv:return R;case jv:return z;case jl:return Math.round(z+(R-z)/2);case za:default:return a>=z&&a<=R?a:z>R||a<z?z:R}},nie=Dz({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,i)=>{const a=Sc(e,t,i,"column");return[a.size,a.offset]},getRowPosition:(e,t,i)=>{const a=Sc(e,t,i,"row");return[a.size,a.offset]},getColumnOffset:(e,t,i,a,d,g)=>F3(e,t,i,a,d,"column",g),getRowOffset:(e,t,i,a,d,g)=>F3(e,t,i,a,d,"row",g),getColumnStartIndexForOffset:(e,t,i)=>B3(e,i,t,"column"),getColumnStopIndexForStartIndex:(e,t,i,a)=>{const d=Sc(e,t,a,"column"),g=i+e.width;let _=d.offset+d.size,o=t;for(;o<e.totalColumn-1&&_<g;)o++,_+=Sc(e,t,a,"column").size;return o},getEstimatedTotalHeight:Bz,getEstimatedTotalWidth:Fz,getRowStartIndexForOffset:(e,t,i)=>B3(e,i,t,"row"),getRowStopIndexForStartIndex:(e,t,i,a)=>{const{totalRow:d,height:g}=e,_=Sc(e,t,a,"row"),o=i+g;let S=_.size+_.offset,E=t;for(;E<d-1&&S<o;)E++,S+=Sc(e,E,a,"row").size;return E},injectToInstance:(e,t)=>{const i=({columnIndex:g,rowIndex:_},o)=>{var S,E;o=jr(o)?!0:o,Wn(g)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,g-1)),Wn(_)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,_-1)),(S=e.exposed)==null||S.getItemStyleCache.value(-1,null,null),o&&((E=e.proxy)==null||E.$forceUpdate())},a=(g,_)=>{i({columnIndex:g},_)},d=(g,_)=>{i({rowIndex:g},_)};Object.assign(e.proxy,{resetAfterColumnIndex:a,resetAfterRowIndex:d,resetAfter:i})},initCache:({estimatedColumnWidth:e=G2,estimatedRowHeight:t=G2})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),oie=qe({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:Xt("select")}}});function rie(e,t,i,a,d,g){return se(),Ie("div",{class:ue(e.ns.be("group","title")),style:$n({...e.style,lineHeight:`${e.height}px`})},mn(e.item.label),7)}var iie=fn(oie,[["render",rie],["__file","group-item.vue"]]);function sie(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const Nz={label:"label",value:"value",disabled:"disabled",options:"options"};function u1(e){const t=ee(()=>({...Nz,...e.props}));return{aliasProps:t,getLabel:_=>xi(_,t.value.label),getValue:_=>xi(_,t.value.value),getDisabled:_=>xi(_,t.value.disabled),getOptions:_=>xi(_,t.value.options)}}const aie=cn({allowCreate:Boolean,autocomplete:{type:at(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:Cr,default:ud},effect:{type:at(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:at([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:at(Array),required:!0},placeholder:{type:String},teleported:Fi.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})},remote:Boolean,size:ki,props:{type:at(Object),default:()=>Nz},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:at(String),values:zc,default:"bottom-start"},fallbackPlacements:{type:at(Array),default:["bottom-start","top-start","right","left"]},tagType:{...Ih.type,default:"info"},tagEffect:{...Ih.effect,default:"light"},appendTo:String,...Zp,...Zi(["ariaLabel"])}),lie=cn({data:Array,disabled:Boolean,hovering:Boolean,item:{type:at(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),cie={[xo]:e=>!0,[Wr]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},uie={hover:e=>Wn(e),select:(e,t)=>!0},nC=Symbol("ElSelectV2Injection"),die=qe({props:lie,emits:uie,setup(e,{emit:t}){const i=kn(nC),a=Xt("select"),{hoverItem:d,selectOptionClick:g}=sie(e,{emit:t}),{getLabel:_}=u1(i.props);return{ns:a,hoverItem:d,selectOptionClick:g,getLabel:_}}});function hie(e,t,i,a,d,g){return se(),Ie("li",{"aria-selected":e.selected,style:$n(e.style),class:ue([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:Xn(e.selectOptionClick,["stop"])},[vt(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[je("span",null,mn(e.getLabel(e.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var fie=fn(die,[["render",hie],["__file","option-item.vue"]]);const pie={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var mie=qe({name:"ElSelectDropdown",props:pie,setup(e,{slots:t,expose:i}){const a=kn(nC),d=Xt("select"),{getLabel:g,getValue:_,getDisabled:o}=u1(a.props),S=xe([]),E=xe(),I=ee(()=>e.data.length);qt(()=>I.value,()=>{var de,_e;(_e=(de=a.tooltipRef.value).updatePopper)==null||_e.call(de)});const R=ee(()=>jr(a.props.estimatedOptionHeight)),z=ee(()=>R.value?{itemSize:a.props.itemHeight}:{estimatedSize:a.props.estimatedOptionHeight,itemSize:de=>S.value[de]}),N=(de=[],_e)=>{const{props:{valueKey:Re}}=a;return So(_e)?de&&de.some(Qe=>Ar(xi(Qe,Re))===xi(_e,Re)):de.includes(_e)},$=(de,_e)=>{if(So(_e)){const{valueKey:Re}=a.props;return xi(de,Re)===xi(_e,Re)}else return de===_e},F=(de,_e)=>a.props.multiple?N(de,_(_e)):$(de,_(_e)),W=(de,_e)=>{const{disabled:Re,multiple:Qe,multipleLimit:Ee}=a.props;return Re||!_e&&(Qe?Ee>0&&de.length>=Ee:!1)},U=de=>e.hoveringIndex===de;i({listRef:E,isSized:R,isItemDisabled:W,isItemHovering:U,isItemSelected:F,scrollToItem:de=>{const _e=E.value;_e&&_e.scrollToItem(de)},resetScrollTop:()=>{const de=E.value;de&&de.resetScrollTop()}});const J=de=>{const{index:_e,data:Re,style:Qe}=de,Ee=y(R),{itemSize:ye,estimatedSize:Me}=y(z),{modelValue:Te}=a.props,{onSelect:he,onHover:ke}=a,Ne=Re[_e];if(Ne.type==="Group")return Ye(iie,{item:Ne,style:Qe,height:Ee?ye:Me},null);const nt=F(Te,Ne),De=W(Te,nt),Ct=U(_e);return Ye(fie,Po(de,{selected:nt,disabled:o(Ne)||De,created:!!Ne.created,hovering:Ct,item:Ne,onSelect:he,onHover:ke}),{default:Rt=>{var Bt;return((Bt=t.default)==null?void 0:Bt.call(t,Rt))||Ye("span",null,[g(Ne)])}})},{onKeyboardNavigate:oe,onKeyboardSelect:ae}=a,fe=()=>{oe("forward")},ge=()=>{oe("backward")},ce=de=>{const{code:_e}=de,{tab:Re,esc:Qe,down:Ee,up:ye,enter:Me,numpadEnter:Te}=Cn;switch(_e!==Re&&(de.preventDefault(),de.stopPropagation()),_e){case Re:case Qe:break;case Ee:fe();break;case ye:ge();break;case Me:case Te:ae();break}};return()=>{var de,_e,Re,Qe;const{data:Ee,width:ye}=e,{height:Me,multiple:Te,scrollbarAlwaysOn:he}=a.props,ke=y(R)?Pz:Yre;return Ye("div",{class:[d.b("dropdown"),d.is("multiple",Te)],style:{width:`${ye}px`}},[(de=t.header)==null?void 0:de.call(t),((_e=t.loading)==null?void 0:_e.call(t))||((Re=t.empty)==null?void 0:Re.call(t))||Ye(ke,Po({ref:E},y(z),{className:d.be("dropdown","list"),scrollbarAlwaysOn:he,data:Ee,height:Me,width:ye,total:Ee.length,onKeydown:ce}),{default:Ne=>Ye(J,Ne,null)}),(Qe=t.footer)==null?void 0:Qe.call(t)])}}});function gie(e,t){const{aliasProps:i,getLabel:a,getValue:d}=u1(e),g=xe(0),_=xe(),o=ee(()=>e.allowCreate&&e.filterable);function S(N){const $=F=>a(F)===N;return e.options&&e.options.some($)||t.createdOptions.some($)}function E(N){o.value&&(e.multiple&&N.created?g.value++:_.value=N)}function I(N){if(o.value)if(N&&N.length>0){if(S(N))return;const $={[i.value.value]:N,[i.value.label]:N,created:!0,[i.value.disabled]:!1};t.createdOptions.length>=g.value?t.createdOptions[g.value]=$:t.createdOptions.push($)}else if(e.multiple)t.createdOptions.length=g.value;else{const $=_.value;t.createdOptions.length=0,$&&$.created&&t.createdOptions.push($)}}function R(N){if(!o.value||!N||!N.created||N.created&&e.reserveKeyword&&t.inputValue===a(N))return;const $=t.createdOptions.findIndex(F=>d(F)===d(N));~$&&(t.createdOptions.splice($,1),g.value--)}function z(){o.value&&(t.createdOptions.length=0,g.value=0)}return{createNewOption:I,removeNewOption:R,selectNewOption:E,clearAllNewOption:z}}const vie=11,_ie=(e,t)=>{const{t:i}=qo(),a=Xt("select"),d=Xt("input"),{form:g,formItem:_}=xs(),{inputId:o}=Cl(e,{formItemContext:_}),{aliasProps:S,getLabel:E,getValue:I,getDisabled:R,getOptions:z}=u1(e),{valueOnClear:N,isEmptyValue:$}=t1(e),F=dr({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),W=xe(-1),U=xe(),re=xe(),K=xe(),q=xe(),J=xe(),oe=xe(),ae=xe(),fe=xe(),ge=xe(),ce=xe(),de=xe(),{isComposing:_e,handleCompositionStart:Re,handleCompositionEnd:Qe,handleCompositionUpdate:Ee}=e1({afterComposition:Qt=>ro(Qt)}),{wrapperRef:ye,isFocused:Me,handleBlur:Te}=Oh(J,{beforeFocus(){return nt.value},afterFocus(){e.automaticDropdown&&!Ne.value&&(Ne.value=!0,F.menuVisibleOnFocus=!0)},beforeBlur(Qt){var On,co;return((On=K.value)==null?void 0:On.isFocusInsideContent(Qt))||((co=q.value)==null?void 0:co.isFocusInsideContent(Qt))},afterBlur(){Ne.value=!1,F.menuVisibleOnFocus=!1}}),he=xe([]),ke=xe([]),Ne=xe(!1),nt=ee(()=>e.disabled||(g==null?void 0:g.disabled)),De=ee(()=>{var Qt;return(Qt=g==null?void 0:g.statusIcon)!=null?Qt:!1}),Ct=ee(()=>{const Qt=ke.value.length*e.itemHeight;return Qt>e.height?e.height:Qt}),Rt=ee(()=>e.multiple?sn(e.modelValue)&&e.modelValue.length>0:!$(e.modelValue)),Bt=ee(()=>e.clearable&&!nt.value&&F.inputHovering&&Rt.value),mt=ee(()=>e.remote&&e.filterable?"":Oc),Gt=ee(()=>mt.value&&a.is("reverse",Ne.value)),jt=ee(()=>(_==null?void 0:_.validateState)||""),Be=ee(()=>{if(jt.value)return cT[jt.value]}),an=ee(()=>e.remote?300:0),At=ee(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!F.inputValue&&he.value.length===0?!1:e.filterable&&F.inputValue&&he.value.length>0&&ke.value.length===0?e.noMatchText||i("el.select.noMatch"):he.value.length===0?e.noDataText||i("el.select.noData"):null),Ge=Qt=>{const On=co=>{if(e.filterable&&Nn(e.filterMethod)||e.filterable&&e.remote&&Nn(e.remoteMethod))return!0;const Co=new RegExp(eT(Qt),"i");return Qt?Co.test(E(co)||""):!0};return e.loading?[]:[...F.createdOptions,...e.options].reduce((co,Co)=>{const vr=z(Co);if(sn(vr)){const Kr=vr.filter(On);Kr.length>0&&co.push({label:E(Co),type:"Group"},...Kr)}else(e.remote||On(Co))&&co.push(Co);return co},[])},Fe=()=>{he.value=Ge(""),ke.value=Ge(F.inputValue)},Nt=ee(()=>{const Qt=new Map;return he.value.forEach((On,co)=>{Qt.set(Oo(I(On)),{option:On,index:co})}),Qt}),Jt=ee(()=>{const Qt=new Map;return ke.value.forEach((On,co)=>{Qt.set(Oo(I(On)),{option:On,index:co})}),Qt}),Dt=ee(()=>ke.value.every(Qt=>R(Qt))),xt=Mi(),Ot=ee(()=>xt.value==="small"?"small":"default"),en=()=>{var Qt;W.value=((Qt=U.value)==null?void 0:Qt.offsetWidth)||200},dn=()=>{if(!re.value)return 0;const Qt=window.getComputedStyle(re.value);return Number.parseFloat(Qt.gap||"6px")},un=ee(()=>{const Qt=dn();return{maxWidth:`${de.value&&e.maxCollapseTags===1?F.selectionWidth-F.collapseItemWidth-Qt:F.selectionWidth}px`}}),Pn=ee(()=>({maxWidth:`${F.selectionWidth}px`})),gt=ee(()=>({width:`${Math.max(F.calculatorWidth,vie)}px`})),Sn=ee(()=>sn(e.modelValue)?e.modelValue.length===0&&!F.inputValue:e.filterable?!F.inputValue:!0),Vn=ee(()=>{var Qt;const On=(Qt=e.placeholder)!=null?Qt:i("el.select.placeholder");return e.multiple||!Rt.value?On:F.selectedLabel}),lo=ee(()=>{var Qt,On;return(On=(Qt=K.value)==null?void 0:Qt.popperRef)==null?void 0:On.contentRef}),eo=ee(()=>{if(e.multiple){const Qt=e.modelValue.length;if(e.modelValue.length>0&&Jt.value.has(e.modelValue[Qt-1])){const{index:On}=Jt.value.get(e.modelValue[Qt-1]);return On}}else if(e.modelValue&&Jt.value.has(e.modelValue)){const{index:Qt}=Jt.value.get(e.modelValue);return Qt}return-1}),fo=ee({get(){return Ne.value&&At.value!==!1},set(Qt){Ne.value=Qt}}),Lo=ee(()=>e.multiple?e.collapseTags?F.cachedOptions.slice(0,e.maxCollapseTags):F.cachedOptions:[]),er=ee(()=>e.multiple?e.collapseTags?F.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:Pt,removeNewOption:_n,selectNewOption:dt,clearAllNewOption:tn}=gie(e,F),Ze=()=>{nt.value||(F.menuVisibleOnFocus?F.menuVisibleOnFocus=!1:Ne.value=!Ne.value)},vn=()=>{F.inputValue.length>0&&!Ne.value&&(Ne.value=!0),Pt(F.inputValue),yo(F.inputValue)},Mn=Qs(vn,an.value),yo=Qt=>{F.previousQuery===Qt||_e.value||(F.previousQuery=Qt,e.filterable&&Nn(e.filterMethod)?e.filterMethod(Qt):e.filterable&&e.remote&&Nn(e.remoteMethod)&&e.remoteMethod(Qt),e.defaultFirstOption&&(e.filterable||e.remote)&&ke.value.length?Un(gr):Un(Yn))},gr=()=>{const Qt=ke.value.filter(Co=>!Co.disabled&&Co.type!=="Group"),On=Qt.find(Co=>Co.created),co=Qt[0];F.hoveringIndex=Rr(ke.value,On||co)},Xr=Qt=>{qi(e.modelValue,Qt)||t(Wr,Qt)},Ur=Qt=>{t(xo,Qt),Xr(Qt),F.previousValue=e.multiple?String(Qt):Qt},Rr=(Qt=[],On)=>{if(!So(On))return Qt.indexOf(On);const co=e.valueKey;let Co=-1;return Qt.some((vr,Kr)=>xi(vr,co)===xi(On,co)?(Co=Kr,!0):!1),Co},Oo=Qt=>So(Qt)?xi(Qt,e.valueKey):Qt,_i=()=>{en()},ya=()=>{F.selectionWidth=re.value.getBoundingClientRect().width},$t=()=>{F.calculatorWidth=oe.value.getBoundingClientRect().width},Se=()=>{F.collapseItemWidth=de.value.getBoundingClientRect().width},Ae=()=>{var Qt,On;(On=(Qt=K.value)==null?void 0:Qt.updatePopper)==null||On.call(Qt)},He=()=>{var Qt,On;(On=(Qt=q.value)==null?void 0:Qt.updatePopper)==null||On.call(Qt)},ft=Qt=>{if(e.multiple){let On=e.modelValue.slice();const co=Rr(On,I(Qt));co>-1?(On=[...On.slice(0,co),...On.slice(co+1)],F.cachedOptions.splice(co,1),_n(Qt)):(e.multipleLimit<=0||On.length<e.multipleLimit)&&(On=[...On,I(Qt)],F.cachedOptions.push(Qt),dt(Qt)),Ur(On),Qt.created&&yo(""),e.filterable&&!e.reserveKeyword&&(F.inputValue="")}else F.selectedLabel=E(Qt),Ur(I(Qt)),Ne.value=!1,dt(Qt),Qt.created||tn();bt()},tt=(Qt,On)=>{let co=e.modelValue.slice();const Co=Rr(co,I(On));Co>-1&&!nt.value&&(co=[...e.modelValue.slice(0,Co),...e.modelValue.slice(Co+1)],F.cachedOptions.splice(Co,1),Ur(co),t("remove-tag",I(On)),_n(On)),Qt.stopPropagation(),bt()},bt=()=>{var Qt;(Qt=J.value)==null||Qt.focus()},zt=()=>{var Qt;if(Ne.value){Ne.value=!1,Un(()=>{var On;return(On=J.value)==null?void 0:On.blur()});return}(Qt=J.value)==null||Qt.blur()},Tt=()=>{F.inputValue.length>0?F.inputValue="":Ne.value=!1},Ft=Qt=>RD(Qt,On=>!F.cachedOptions.some(co=>I(co)===On&&R(co))),Kt=Qt=>{if(e.multiple&&Qt.code!==Cn.delete&&F.inputValue.length===0){Qt.preventDefault();const On=e.modelValue.slice(),co=Ft(On);if(co<0)return;const Co=On[co];On.splice(co,1);const vr=F.cachedOptions[co];F.cachedOptions.splice(co,1),_n(vr),Ur(On),t("remove-tag",Co)}},Zt=()=>{let Qt;sn(e.modelValue)?Qt=[]:Qt=N.value,e.multiple?F.cachedOptions=[]:F.selectedLabel="",Ne.value=!1,Ur(Qt),t("clear"),tn(),bt()},pt=(Qt,On=void 0)=>{const co=ke.value;if(!["forward","backward"].includes(Qt)||nt.value||co.length<=0||Dt.value||_e.value)return;if(!Ne.value)return Ze();On===void 0&&(On=F.hoveringIndex);let Co=-1;Qt==="forward"?(Co=On+1,Co>=co.length&&(Co=0)):Qt==="backward"&&(Co=On-1,(Co<0||Co>=co.length)&&(Co=co.length-1));const vr=co[Co];if(R(vr)||vr.type==="Group")return pt(Qt,Co);F.hoveringIndex=Co,Ko(Co)},Ht=()=>{if(Ne.value)~F.hoveringIndex&&ke.value[F.hoveringIndex]&&ft(ke.value[F.hoveringIndex]);else return Ze()},bn=Qt=>{F.hoveringIndex=Qt??-1},Yn=()=>{e.multiple?F.hoveringIndex=ke.value.findIndex(Qt=>e.modelValue.some(On=>Oo(On)===Oo(Qt))):F.hoveringIndex=ke.value.findIndex(Qt=>Oo(Qt)===Oo(e.modelValue))},ro=Qt=>{if(F.inputValue=Qt.target.value,e.remote)Mn();else return vn()},po=Qt=>{if(Ne.value=!1,Me.value){const On=new FocusEvent("focus",Qt);Te(On)}},ao=()=>(F.isBeforeHide=!1,Un(()=>{~eo.value&&Ko(F.hoveringIndex)})),Ko=Qt=>{ge.value.scrollToItem(Qt)},jo=(Qt,On)=>{const co=Oo(Qt);if(Nt.value.has(co)){const{option:Co}=Nt.value.get(co);return Co}if(On&&On.length){const Co=On.find(vr=>Oo(I(vr))===co);if(Co)return Co}return{[S.value.value]:Qt,[S.value.label]:Qt}},Ro=(Qt=!1)=>{if(e.multiple)if(e.modelValue.length>0){const On=F.cachedOptions.slice();F.cachedOptions.length=0,F.previousValue=e.modelValue.toString();for(const co of e.modelValue){const Co=jo(co,On);F.cachedOptions.push(Co)}}else F.cachedOptions=[],F.previousValue=void 0;else if(Rt.value){F.previousValue=e.modelValue;const On=ke.value,co=On.findIndex(Co=>Oo(I(Co))===Oo(e.modelValue));~co?F.selectedLabel=E(On[co]):(!F.selectedLabel||Qt)&&(F.selectedLabel=Oo(e.modelValue))}else F.selectedLabel="",F.previousValue=void 0;tn(),en()};return qt(Ne,Qt=>{Qt?yo(""):(F.inputValue="",F.previousQuery=null,F.isBeforeHide=!0,Pt("")),t("visible-change",Qt)}),qt(()=>e.modelValue,(Qt,On)=>{var co;(!Qt||sn(Qt)&&Qt.length===0||e.multiple&&!qi(Qt.toString(),F.previousValue)||!e.multiple&&Oo(Qt)!==Oo(F.previousValue))&&Ro(!0),!qi(Qt,On)&&e.validateEvent&&((co=_==null?void 0:_.validate)==null||co.call(_,"change").catch(vr=>void 0))},{deep:!0}),qt(()=>e.options,()=>{const Qt=J.value;(!Qt||Qt&&document.activeElement!==Qt)&&Ro()},{deep:!0,flush:"post"}),qt(()=>ke.value,()=>ge.value&&Un(ge.value.resetScrollTop)),ns(()=>{F.isBeforeHide||Fe()}),ns(()=>{const{valueKey:Qt,options:On}=e,co=new Map;for(const Co of On){const vr=I(Co);let Kr=vr;if(So(Kr)&&(Kr=xi(vr,Qt)),co.get(Kr))break;co.set(Kr,!0)}}),_o(()=>{Ro()}),ei(U,_i),ei(re,ya),ei(oe,$t),ei(ge,Ae),ei(ye,Ae),ei(ce,He),ei(de,Se),{inputId:o,collapseTagSize:Ot,currentPlaceholder:Vn,expanded:Ne,emptyText:At,popupHeight:Ct,debounce:an,allOptions:he,filteredOptions:ke,iconComponent:mt,iconReverse:Gt,tagStyle:un,collapseTagStyle:Pn,inputStyle:gt,popperSize:W,dropdownMenuVisible:fo,hasModelValue:Rt,shouldShowPlaceholder:Sn,selectDisabled:nt,selectSize:xt,needStatusIcon:De,showClearBtn:Bt,states:F,isFocused:Me,nsSelect:a,nsInput:d,calculatorRef:oe,inputRef:J,menuRef:ge,tagMenuRef:ce,tooltipRef:K,tagTooltipRef:q,selectRef:U,wrapperRef:ye,selectionRef:re,prefixRef:ae,suffixRef:fe,collapseItemRef:de,popperRef:lo,validateState:jt,validateIcon:Be,showTagList:Lo,collapseTagList:er,debouncedOnInputChange:Mn,deleteTag:tt,getLabel:E,getValue:I,getDisabled:R,getValueKey:Oo,handleClear:Zt,handleClickOutside:po,handleDel:Kt,handleEsc:Tt,focus:bt,blur:zt,handleMenuEnter:ao,handleResize:_i,resetSelectionWidth:ya,resetCalculatorWidth:$t,updateTooltip:Ae,updateTagTooltip:He,updateOptions:Fe,toggleMenu:Ze,scrollTo:Ko,onInput:ro,onKeyboardNavigate:pt,onKeyboardSelect:Ht,onSelect:ft,onHover:bn,handleCompositionStart:Re,handleCompositionEnd:Qe,handleCompositionUpdate:Ee}},yie=qe({name:"ElSelectV2",components:{ElSelectMenu:mie,ElTag:Nv,ElTooltip:rs,ElIcon:Dn},directives:{ClickOutside:kc},props:aie,emits:cie,setup(e,{emit:t}){const i=ee(()=>{const{modelValue:g,multiple:_}=e,o=_?[]:void 0;return sn(g)?_?g:o:_?o:g}),a=_ie(dr({...Vi(e),modelValue:i}),t);Bo(nC,{props:dr({...Vi(e),height:a.popupHeight,modelValue:i}),expanded:a.expanded,tooltipRef:a.tooltipRef,onSelect:a.onSelect,onHover:a.onHover,onKeyboardNavigate:a.onKeyboardNavigate,onKeyboardSelect:a.onKeyboardSelect});const d=ee(()=>e.multiple?a.states.cachedOptions.map(g=>g.label):a.states.selectedLabel);return{...a,modelValue:i,selectedLabel:d}}});function bie(e,t,i,a,d,g){const _=Mo("el-tag"),o=Mo("el-tooltip"),S=Mo("el-icon"),E=Mo("el-select-menu"),I=zb("click-outside");return vo((se(),Ie("div",{ref:"selectRef",class:ue([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:R=>e.states.inputHovering=!0,onMouseleave:R=>e.states.inputHovering=!1},[Ye(o,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:R=>e.states.isBeforeHide=!1},{default:it(()=>[je("div",{ref:"wrapperRef",class:ue([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Xn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(se(),Ie("div",{key:0,ref:"prefixRef",class:ue(e.nsSelect.e("prefix"))},[vt(e.$slots,"prefix")],2)):yt("v-if",!0),je("div",{ref:"selectionRef",class:ue([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?vt(e.$slots,"tag",{key:0},()=>[(se(!0),Ie(Fn,null,Fo(e.showTagList,R=>(se(),Ie("div",{key:e.getValueKey(e.getValue(R)),class:ue(e.nsSelect.e("selected-item"))},[Ye(_,{closable:!e.selectDisabled&&!e.getDisabled(R),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:$n(e.tagStyle),onClose:z=>e.deleteTag(z,R)},{default:it(()=>[je("span",{class:ue(e.nsSelect.e("tags-text"))},[vt(e.$slots,"label",{label:e.getLabel(R),value:e.getValue(R)},()=>[$o(mn(e.getLabel(R)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(se(),Et(o,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:it(()=>[je("div",{ref:"collapseItemRef",class:ue(e.nsSelect.e("selected-item"))},[Ye(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:$n(e.collapseTagStyle),"disable-transitions":""},{default:it(()=>[je("span",{class:ue(e.nsSelect.e("tags-text"))}," + "+mn(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:it(()=>[je("div",{ref:"tagMenuRef",class:ue(e.nsSelect.e("selection"))},[(se(!0),Ie(Fn,null,Fo(e.collapseTagList,R=>(se(),Ie("div",{key:e.getValueKey(e.getValue(R)),class:ue(e.nsSelect.e("selected-item"))},[Ye(_,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(R),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:z=>e.deleteTag(z,R)},{default:it(()=>[je("span",{class:ue(e.nsSelect.e("tags-text"))},[vt(e.$slots,"label",{label:e.getLabel(R),value:e.getValue(R)},()=>[$o(mn(e.getLabel(R)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):yt("v-if",!0)]):yt("v-if",!0),e.selectDisabled?yt("v-if",!0):(se(),Ie("div",{key:1,class:ue([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[vo(je("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":R=>e.states.inputValue=R,style:$n(e.inputStyle),autocomplete:e.autocomplete,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:ue([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[kr(Xn(R=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),kr(Xn(R=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),kr(Xn(e.onKeyboardSelect,["stop","prevent"]),["enter"]),kr(Xn(e.handleEsc,["stop","prevent"]),["esc"]),kr(Xn(e.handleDel,["stop"]),["delete"])],onClick:Xn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[LS,e.states.inputValue]]),e.filterable?(se(),Ie("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:ue(e.nsSelect.e("input-calculator")),textContent:mn(e.states.inputValue)},null,10,["textContent"])):yt("v-if",!0)],2)),e.shouldShowPlaceholder?(se(),Ie("div",{key:2,class:ue([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?vt(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[je("span",null,mn(e.currentPlaceholder),1)]):(se(),Ie("span",{key:1},mn(e.currentPlaceholder),1))],2)):yt("v-if",!0)],2),je("div",{ref:"suffixRef",class:ue(e.nsSelect.e("suffix"))},[e.iconComponent?vo((se(),Et(S,{key:0,class:ue([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:it(()=>[(se(),Et(ko(e.iconComponent)))]),_:1},8,["class"])),[[ir,!e.showClearBtn]]):yt("v-if",!0),e.showClearBtn&&e.clearIcon?(se(),Et(S,{key:1,class:ue([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:Xn(e.handleClear,["prevent","stop"])},{default:it(()=>[(se(),Et(ko(e.clearIcon)))]),_:1},8,["class","onClick"])):yt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(se(),Et(S,{key:2,class:ue([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:it(()=>[(se(),Et(ko(e.validateIcon)))]),_:1},8,["class"])):yt("v-if",!0)],2)],10,["onClick"])]),content:it(()=>[Ye(E,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},Na({default:it(R=>[vt(e.$slots,"default",hl(Xu(R)))]),_:2},[e.$slots.header?{name:"header",fn:it(()=>[je("div",{class:ue(e.nsSelect.be("dropdown","header"))},[vt(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:it(()=>[je("div",{class:ue(e.nsSelect.be("dropdown","loading"))},[vt(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:it(()=>[je("div",{class:ue(e.nsSelect.be("dropdown","empty"))},[vt(e.$slots,"empty",{},()=>[je("span",null,mn(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:it(()=>[je("div",{class:ue(e.nsSelect.be("dropdown","footer"))},[vt(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[I,e.handleClickOutside,e.popperRef]])}var xie=fn(yie,[["render",bie],["__file","select.vue"]]);const wie=uo(xie),Sie=cn({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:at([Number,Object])}}),Tie=cn({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),Cie=qe({name:"ElSkeletonItem"}),Eie=qe({...Cie,props:Tie,setup(e){const t=Xt("skeleton");return(i,a)=>(se(),Ie("div",{class:ue([y(t).e("item"),y(t).e(i.variant)])},[i.variant==="image"?(se(),Et(y(UG),{key:0})):yt("v-if",!0)],2))}});var wb=fn(Eie,[["__file","skeleton-item.vue"]]);const Mie=qe({name:"ElSkeleton"}),Iie=qe({...Mie,props:Sie,setup(e,{expose:t}){const i=e,a=Xt("skeleton"),d=B9(mr(i,"loading"),i.throttle);return t({uiLoading:d}),(g,_)=>y(d)?(se(),Ie("div",Po({key:0,class:[y(a).b(),y(a).is("animated",g.animated)]},g.$attrs),[(se(!0),Ie(Fn,null,Fo(g.count,o=>(se(),Ie(Fn,{key:o},[y(d)?vt(g.$slots,"template",{key:o},()=>[Ye(wb,{class:ue(y(a).is("first")),variant:"p"},null,8,["class"]),(se(!0),Ie(Fn,null,Fo(g.rows,S=>(se(),Et(wb,{key:S,class:ue([y(a).e("paragraph"),y(a).is("last",S===g.rows&&g.rows>1)]),variant:"p"},null,8,["class"]))),128))]):yt("v-if",!0)],64))),128))],16)):vt(g.$slots,"default",hl(Po({key:1},g.$attrs)))}});var Aie=fn(Iie,[["__file","skeleton.vue"]]);const kie=uo(Aie,{SkeletonItem:wb}),Pie=ri(wb),$z=Symbol("sliderContextKey"),Rie=cn({modelValue:{type:at([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:ki,inputSize:ki,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:at(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:at(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:zc,default:"top"},marks:{type:at(Object)},validateEvent:{type:Boolean,default:!0},...Zi(["ariaLabel"])}),Dw=e=>Wn(e)||sn(e)&&e.every(Wn),Die={[xo]:Dw,[Ns]:Dw,[Wr]:Dw},Lie=(e,t,i)=>{const a=xe();return _o(async()=>{e.range?(sn(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(!Wn(e.modelValue)||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),wr(window,"resize",i),await Un(),i()}),{sliderWrapper:a}},Oie=e=>ee(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((i,a)=>i-a).filter(i=>i<=e.max&&i>=e.min).map(i=>({point:i,position:(i-e.min)*100/(e.max-e.min),mark:e.marks[i]})):[]),zie=(e,t,i)=>{const{form:a,formItem:d}=xs(),g=qr(),_=xe(),o=xe(),S={firstButton:_,secondButton:o},E=ee(()=>e.disabled||(a==null?void 0:a.disabled)||!1),I=ee(()=>Math.min(t.firstValue,t.secondValue)),R=ee(()=>Math.max(t.firstValue,t.secondValue)),z=ee(()=>e.range?`${100*(R.value-I.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),N=ee(()=>e.range?`${100*(I.value-e.min)/(e.max-e.min)}%`:"0%"),$=ee(()=>e.vertical?{height:e.height}:{}),F=ee(()=>e.vertical?{height:z.value,bottom:N.value}:{width:z.value,left:N.value}),W=()=>{g.value&&(t.sliderSize=g.value[`client${e.vertical?"Height":"Width"}`])},U=_e=>{const Re=e.min+_e*(e.max-e.min)/100;if(!e.range)return _;let Qe;return Math.abs(I.value-Re)<Math.abs(R.value-Re)?Qe=t.firstValue<t.secondValue?"firstButton":"secondButton":Qe=t.firstValue>t.secondValue?"firstButton":"secondButton",S[Qe]},re=_e=>{const Re=U(_e);return Re.value.setPosition(_e),Re},K=_e=>{t.firstValue=_e??e.min,J(e.range?[I.value,R.value]:_e??e.min)},q=_e=>{t.secondValue=_e,e.range&&J([I.value,R.value])},J=_e=>{i(xo,_e),i(Ns,_e)},oe=async()=>{await Un(),i(Wr,e.range?[I.value,R.value]:e.modelValue)},ae=_e=>{var Re,Qe,Ee,ye,Me,Te;if(E.value||t.dragging)return;W();let he=0;if(e.vertical){const ke=(Ee=(Qe=(Re=_e.touches)==null?void 0:Re.item(0))==null?void 0:Qe.clientY)!=null?Ee:_e.clientY;he=(g.value.getBoundingClientRect().bottom-ke)/t.sliderSize*100}else{const ke=(Te=(Me=(ye=_e.touches)==null?void 0:ye.item(0))==null?void 0:Me.clientX)!=null?Te:_e.clientX,Ne=g.value.getBoundingClientRect().left;he=(ke-Ne)/t.sliderSize*100}if(!(he<0||he>100))return re(he)};return{elFormItem:d,slider:g,firstButton:_,secondButton:o,sliderDisabled:E,minValue:I,maxValue:R,runwayStyle:$,barStyle:F,resetSize:W,setPosition:re,emitChange:oe,onSliderWrapperPrevent:_e=>{var Re,Qe;((Re=S.firstButton.value)!=null&&Re.dragging||(Qe=S.secondButton.value)!=null&&Qe.dragging)&&_e.preventDefault()},onSliderClick:_e=>{ae(_e)&&oe()},onSliderDown:async _e=>{const Re=ae(_e);Re&&(await Un(),Re.value.onButtonDown(_e))},onSliderMarkerDown:_e=>{E.value||t.dragging||re(_e)},setFirstValue:K,setSecondValue:q}},Bie=(e,t,i)=>{const a=xe(),d=xe(!1),g=ee(()=>t.value instanceof Function),_=ee(()=>g.value&&t.value(e.modelValue)||e.modelValue),o=Qs(()=>{i.value&&(d.value=!0)},50),S=Qs(()=>{i.value&&(d.value=!1)},50);return{tooltip:a,tooltipVisible:d,formatValue:_,displayTooltip:o,hideTooltip:S}},Fie=(e,t,i)=>{const{disabled:a,min:d,max:g,step:_,showTooltip:o,precision:S,sliderSize:E,formatTooltip:I,emitChange:R,resetSize:z,updateDragging:N}=kn($z),{tooltip:$,tooltipVisible:F,formatValue:W,displayTooltip:U,hideTooltip:re}=Bie(e,I,o),K=xe(),q=ee(()=>`${(e.modelValue-d.value)/(g.value-d.value)*100}%`),J=ee(()=>e.vertical?{bottom:q.value}:{left:q.value}),oe=()=>{t.hovering=!0,U()},ae=()=>{t.hovering=!1,t.dragging||re()},fe=nt=>{a.value||(nt.preventDefault(),Te(nt),window.addEventListener("mousemove",he),window.addEventListener("touchmove",he),window.addEventListener("mouseup",ke),window.addEventListener("touchend",ke),window.addEventListener("contextmenu",ke),K.value.focus())},ge=nt=>{a.value||(t.newPosition=Number.parseFloat(q.value)+nt/(g.value-d.value)*100,Ne(t.newPosition),R())},ce=()=>{ge(-_.value)},de=()=>{ge(_.value)},_e=()=>{ge(-_.value*4)},Re=()=>{ge(_.value*4)},Qe=()=>{a.value||(Ne(0),R())},Ee=()=>{a.value||(Ne(100),R())},ye=nt=>{let De=!0;switch(nt.code){case Cn.left:case Cn.down:ce();break;case Cn.right:case Cn.up:de();break;case Cn.home:Qe();break;case Cn.end:Ee();break;case Cn.pageDown:_e();break;case Cn.pageUp:Re();break;default:De=!1;break}De&&nt.preventDefault()},Me=nt=>{let De,Ct;return nt.type.startsWith("touch")?(Ct=nt.touches[0].clientY,De=nt.touches[0].clientX):(Ct=nt.clientY,De=nt.clientX),{clientX:De,clientY:Ct}},Te=nt=>{t.dragging=!0,t.isClick=!0;const{clientX:De,clientY:Ct}=Me(nt);e.vertical?t.startY=Ct:t.startX=De,t.startPosition=Number.parseFloat(q.value),t.newPosition=t.startPosition},he=nt=>{if(t.dragging){t.isClick=!1,U(),z();let De;const{clientX:Ct,clientY:Rt}=Me(nt);e.vertical?(t.currentY=Rt,De=(t.startY-t.currentY)/E.value*100):(t.currentX=Ct,De=(t.currentX-t.startX)/E.value*100),t.newPosition=t.startPosition+De,Ne(t.newPosition)}},ke=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||re(),t.isClick||Ne(t.newPosition),R()},0),window.removeEventListener("mousemove",he),window.removeEventListener("touchmove",he),window.removeEventListener("mouseup",ke),window.removeEventListener("touchend",ke),window.removeEventListener("contextmenu",ke))},Ne=async nt=>{if(nt===null||Number.isNaN(+nt))return;nt<0?nt=0:nt>100&&(nt=100);const De=100/((g.value-d.value)/_.value);let Rt=Math.round(nt/De)*De*(g.value-d.value)*.01+d.value;Rt=Number.parseFloat(Rt.toFixed(S.value)),Rt!==e.modelValue&&i(xo,Rt),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await Un(),t.dragging&&U(),$.value.updatePopper()};return qt(()=>t.dragging,nt=>{N(nt)}),wr(K,"touchstart",fe,{passive:!1}),{disabled:a,button:K,tooltip:$,tooltipVisible:F,showTooltip:o,wrapperStyle:J,formatValue:W,handleMouseEnter:oe,handleMouseLeave:ae,onButtonDown:fe,onKeyDown:ye,setPosition:Ne}},Nie=(e,t,i,a)=>({stops:ee(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const _=(e.max-e.min)/e.step,o=100*e.step/(e.max-e.min),S=Array.from({length:_-1}).map((E,I)=>(I+1)*o);return e.range?S.filter(E=>E<100*(i.value-e.min)/(e.max-e.min)||E>100*(a.value-e.min)/(e.max-e.min)):S.filter(E=>E>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:_=>e.vertical?{bottom:`${_}%`}:{left:`${_}%`}}),$ie=(e,t,i,a,d,g)=>{const _=E=>{d(xo,E),d(Ns,E)},o=()=>e.range?![i.value,a.value].every((E,I)=>E===t.oldValue[I]):e.modelValue!==t.oldValue,S=()=>{var E,I;e.min>e.max&&Ai("Slider","min should not be greater than max.");const R=e.modelValue;e.range&&sn(R)?R[1]<e.min?_([e.min,e.min]):R[0]>e.max?_([e.max,e.max]):R[0]<e.min?_([e.min,R[1]]):R[1]>e.max?_([R[0],e.max]):(t.firstValue=R[0],t.secondValue=R[1],o()&&(e.validateEvent&&((E=g==null?void 0:g.validate)==null||E.call(g,"change").catch(z=>void 0)),t.oldValue=R.slice())):!e.range&&Wn(R)&&!Number.isNaN(R)&&(R<e.min?_(e.min):R>e.max?_(e.max):(t.firstValue=R,o()&&(e.validateEvent&&((I=g==null?void 0:g.validate)==null||I.call(g,"change").catch(z=>void 0)),t.oldValue=R)))};S(),qt(()=>t.dragging,E=>{E||S()}),qt(()=>e.modelValue,(E,I)=>{t.dragging||sn(E)&&sn(I)&&E.every((R,z)=>R===I[z])&&t.firstValue===E[0]&&t.secondValue===E[1]||S()},{deep:!0}),qt(()=>[e.min,e.max],()=>{S()})},Vie=cn({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:zc,default:"top"}}),Uie={[xo]:e=>Wn(e)},jie=qe({name:"ElSliderButton"}),Hie=qe({...jie,props:Vie,emits:Uie,setup(e,{expose:t,emit:i}){const a=e,d=Xt("slider"),g=dr({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:a.modelValue}),{disabled:_,button:o,tooltip:S,showTooltip:E,tooltipVisible:I,wrapperStyle:R,formatValue:z,handleMouseEnter:N,handleMouseLeave:$,onButtonDown:F,onKeyDown:W,setPosition:U}=Fie(a,g,i),{hovering:re,dragging:K}=Vi(g);return t({onButtonDown:F,onKeyDown:W,setPosition:U,hovering:re,dragging:K}),(q,J)=>(se(),Ie("div",{ref_key:"button",ref:o,class:ue([y(d).e("button-wrapper"),{hover:y(re),dragging:y(K)}]),style:$n(y(R)),tabindex:y(_)?-1:0,onMouseenter:y(N),onMouseleave:y($),onMousedown:y(F),onFocus:y(N),onBlur:y($),onKeydown:y(W)},[Ye(y(rs),{ref_key:"tooltip",ref:S,visible:y(I),placement:q.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":q.tooltipClass,disabled:!y(E),persistent:y(E)},{content:it(()=>[je("span",null,mn(y(z)),1)]),default:it(()=>[je("div",{class:ue([y(d).e("button"),{hover:y(re),dragging:y(K)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var N3=fn(Hie,[["__file","button.vue"]]);const Gie=cn({mark:{type:at([String,Object]),default:void 0}});var Wie=qe({name:"ElSliderMarker",props:Gie,setup(e){const t=Xt("slider"),i=ee(()=>Bn(e.mark)?e.mark:e.mark.label),a=ee(()=>Bn(e.mark)?void 0:e.mark.style);return()=>Kn("div",{class:t.e("marks-text"),style:a.value},i.value)}});const qie=qe({name:"ElSlider"}),Kie=qe({...qie,props:Rie,emits:Die,setup(e,{expose:t,emit:i}){const a=e,d=Xt("slider"),{t:g}=qo(),_=dr({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:o,slider:S,firstButton:E,secondButton:I,sliderDisabled:R,minValue:z,maxValue:N,runwayStyle:$,barStyle:F,resetSize:W,emitChange:U,onSliderWrapperPrevent:re,onSliderClick:K,onSliderDown:q,onSliderMarkerDown:J,setFirstValue:oe,setSecondValue:ae}=zie(a,_,i),{stops:fe,getStopStyle:ge}=Nie(a,_,z,N),{inputId:ce,isLabeledByFormItem:de}=Cl(a,{formItemContext:o}),_e=Mi(),Re=ee(()=>a.inputSize||_e.value),Qe=ee(()=>a.ariaLabel||g("el.slider.defaultLabel",{min:a.min,max:a.max})),Ee=ee(()=>a.range?a.rangeStartLabel||g("el.slider.defaultRangeStartLabel"):Qe.value),ye=ee(()=>a.formatValueText?a.formatValueText(De.value):`${De.value}`),Me=ee(()=>a.rangeEndLabel||g("el.slider.defaultRangeEndLabel")),Te=ee(()=>a.formatValueText?a.formatValueText(Ct.value):`${Ct.value}`),he=ee(()=>[d.b(),d.m(_e.value),d.is("vertical",a.vertical),{[d.m("with-input")]:a.showInput}]),ke=Oie(a);$ie(a,_,z,N,i,o);const Ne=ee(()=>{const mt=[a.min,a.max,a.step].map(Gt=>{const jt=`${Gt}`.split(".")[1];return jt?jt.length:0});return Math.max.apply(null,mt)}),{sliderWrapper:nt}=Lie(a,_,W),{firstValue:De,secondValue:Ct,sliderSize:Rt}=Vi(_),Bt=mt=>{_.dragging=mt};return wr(nt,"touchstart",re,{passive:!1}),wr(nt,"touchmove",re,{passive:!1}),Bo($z,{...Vi(a),sliderSize:Rt,disabled:R,precision:Ne,emitChange:U,resetSize:W,updateDragging:Bt}),t({onSliderClick:K}),(mt,Gt)=>{var jt,Be;return se(),Ie("div",{id:mt.range?y(ce):void 0,ref_key:"sliderWrapper",ref:nt,class:ue(y(he)),role:mt.range?"group":void 0,"aria-label":mt.range&&!y(de)?y(Qe):void 0,"aria-labelledby":mt.range&&y(de)?(jt=y(o))==null?void 0:jt.labelId:void 0},[je("div",{ref_key:"slider",ref:S,class:ue([y(d).e("runway"),{"show-input":mt.showInput&&!mt.range},y(d).is("disabled",y(R))]),style:$n(y($)),onMousedown:y(q),onTouchstartPassive:y(q)},[je("div",{class:ue(y(d).e("bar")),style:$n(y(F))},null,6),Ye(N3,{id:mt.range?void 0:y(ce),ref_key:"firstButton",ref:E,"model-value":y(De),vertical:mt.vertical,"tooltip-class":mt.tooltipClass,placement:mt.placement,role:"slider","aria-label":mt.range||!y(de)?y(Ee):void 0,"aria-labelledby":!mt.range&&y(de)?(Be=y(o))==null?void 0:Be.labelId:void 0,"aria-valuemin":mt.min,"aria-valuemax":mt.range?y(Ct):mt.max,"aria-valuenow":y(De),"aria-valuetext":y(ye),"aria-orientation":mt.vertical?"vertical":"horizontal","aria-disabled":y(R),"onUpdate:modelValue":y(oe)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),mt.range?(se(),Et(N3,{key:0,ref_key:"secondButton",ref:I,"model-value":y(Ct),vertical:mt.vertical,"tooltip-class":mt.tooltipClass,placement:mt.placement,role:"slider","aria-label":y(Me),"aria-valuemin":y(De),"aria-valuemax":mt.max,"aria-valuenow":y(Ct),"aria-valuetext":y(Te),"aria-orientation":mt.vertical?"vertical":"horizontal","aria-disabled":y(R),"onUpdate:modelValue":y(ae)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):yt("v-if",!0),mt.showStops?(se(),Ie("div",{key:1},[(se(!0),Ie(Fn,null,Fo(y(fe),(an,At)=>(se(),Ie("div",{key:At,class:ue(y(d).e("stop")),style:$n(y(ge)(an))},null,6))),128))])):yt("v-if",!0),y(ke).length>0?(se(),Ie(Fn,{key:2},[je("div",null,[(se(!0),Ie(Fn,null,Fo(y(ke),(an,At)=>(se(),Ie("div",{key:At,style:$n(y(ge)(an.position)),class:ue([y(d).e("stop"),y(d).e("marks-stop")])},null,6))),128))]),je("div",{class:ue(y(d).e("marks"))},[(se(!0),Ie(Fn,null,Fo(y(ke),(an,At)=>(se(),Et(y(Wie),{key:At,mark:an.mark,style:$n(y(ge)(an.position)),onMousedown:Xn(Ge=>y(J)(an.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):yt("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),mt.showInput&&!mt.range?(se(),Et(y(fz),{key:0,ref:"input","model-value":y(De),class:ue(y(d).e("input")),step:mt.step,disabled:y(R),controls:mt.showInputControls,min:mt.min,max:mt.max,precision:y(Ne),debounce:mt.debounce,size:y(Re),"onUpdate:modelValue":y(oe),onChange:y(U)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):yt("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var Zie=fn(Kie,[["__file","slider.vue"]]);const Yie=uo(Zie),Xie=cn({prefixCls:{type:String}}),$3=qe({name:"ElSpaceItem",props:Xie,setup(e,{slots:t}){const i=Xt("space"),a=ee(()=>`${e.prefixCls||i.b()}__item`);return()=>Kn("div",{class:a.value},vt(t,"default"))}}),V3={small:8,default:12,large:16};function Jie(e){const t=Xt("space"),i=ee(()=>[t.b(),t.m(e.direction),e.class]),a=xe(0),d=xe(0),g=ee(()=>{const o=e.wrap||e.fill?{flexWrap:"wrap"}:{},S={alignItems:e.alignment},E={rowGap:`${d.value}px`,columnGap:`${a.value}px`};return[o,S,E,e.style]}),_=ee(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return ns(()=>{const{size:o="small",wrap:S,direction:E,fill:I}=e;if(sn(o)){const[R=0,z=0]=o;a.value=R,d.value=z}else{let R;Wn(o)?R=o:R=V3[o||"small"]||V3.small,(S||I)&&E==="horizontal"?a.value=d.value=R:E==="horizontal"?(a.value=R,d.value=0):(d.value=R,a.value=0)}}),{classes:i,containerStyle:g,itemStyle:_}}const Qie=cn({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:at([String,Object,Array]),default:""},style:{type:at([String,Array,Object]),default:""},alignment:{type:at(String),default:"center"},prefixCls:{type:String},spacer:{type:at([Object,String,Number,Array]),default:null,validator:e=>Yr(e)||Wn(e)||Bn(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:ec,validator:e=>Wn(e)||sn(e)&&e.length===2&&e.every(Wn)}}),ese=qe({name:"ElSpace",props:Qie,setup(e,{slots:t}){const{classes:i,containerStyle:a,itemStyle:d}=Jie(e);function g(_,o="",S=[]){const{prefixCls:E}=e;return _.forEach((I,R)=>{h2(I)?sn(I.children)&&I.children.forEach((z,N)=>{h2(z)&&sn(z.children)?g(z.children,`${o+N}-`,S):S.push(Ye($3,{style:d.value,prefixCls:E,key:`nested-${o+N}`},{default:()=>[z]},Da.PROPS|Da.STYLE,["style","prefixCls"]))}):_W(I)&&S.push(Ye($3,{style:d.value,prefixCls:E,key:`LoopKey${o+R}`},{default:()=>[I]},Da.PROPS|Da.STYLE,["style","prefixCls"]))}),S}return()=>{var _;const{spacer:o,direction:S}=e,E=vt(t,"default",{key:0},()=>[]);if(((_=E.children)!=null?_:[]).length===0)return null;if(sn(E.children)){let I=g(E.children);if(o){const R=I.length-1;I=I.reduce((z,N,$)=>{const F=[...z,N];return $!==R&&F.push(Ye("span",{style:[d.value,S==="vertical"?"width: 100%":null],key:$},[Yr(o)?o:$o(o,Da.TEXT)],Da.STYLE)),F},[])}return Ye("div",{class:i.value,style:a.value},I,Da.STYLE|Da.CLASS)}return E.children}}}),tse=uo(ese),nse=cn({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:at([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:at([String,Object,Array])}}),ose=qe({name:"ElStatistic"}),rse=qe({...ose,props:nse,setup(e,{expose:t}){const i=e,a=Xt("statistic"),d=ee(()=>{const{value:g,formatter:_,precision:o,decimalSeparator:S,groupSeparator:E}=i;if(Nn(_))return _(g);if(!Wn(g)||Number.isNaN(g))return g;let[I,R=""]=String(g).split(".");return R=R.padEnd(o,"0").slice(0,o>0?o:0),I=I.replace(/\B(?=(\d{3})+(?!\d))/g,E),[I,R].join(R?S:"")});return t({displayValue:d}),(g,_)=>(se(),Ie("div",{class:ue(y(a).b())},[g.$slots.title||g.title?(se(),Ie("div",{key:0,class:ue(y(a).e("head"))},[vt(g.$slots,"title",{},()=>[$o(mn(g.title),1)])],2)):yt("v-if",!0),je("div",{class:ue(y(a).e("content"))},[g.$slots.prefix||g.prefix?(se(),Ie("div",{key:0,class:ue(y(a).e("prefix"))},[vt(g.$slots,"prefix",{},()=>[je("span",null,mn(g.prefix),1)])],2)):yt("v-if",!0),je("span",{class:ue(y(a).e("number")),style:$n(g.valueStyle)},mn(y(d)),7),g.$slots.suffix||g.suffix?(se(),Ie("div",{key:1,class:ue(y(a).e("suffix"))},[vt(g.$slots,"suffix",{},()=>[je("span",null,mn(g.suffix),1)])],2)):yt("v-if",!0)],2)],2))}});var ise=fn(rse,[["__file","statistic.vue"]]);const Vz=uo(ise),sse=cn({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:at([Number,Object]),default:0},valueStyle:{type:at([String,Object,Array])}}),ase={finish:()=>!0,[Wr]:e=>Wn(e)},lse=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],U3=e=>Wn(e)?new Date(e).getTime():e.valueOf(),j3=(e,t)=>{let i=e;const a=/\[([^\]]*)]/g;return lse.reduce((g,[_,o])=>{const S=new RegExp(`${_}+(?![^\\[\\]]*\\])`,"g");if(S.test(g)){const E=Math.floor(i/o);return i-=E*o,g.replace(S,I=>String(E).padStart(I.length,"0"))}return g},t).replace(a,"$1")},cse=qe({name:"ElCountdown"}),use=qe({...cse,props:sse,emits:ase,setup(e,{expose:t,emit:i}){const a=e;let d;const g=xe(0),_=ee(()=>j3(g.value,a.format)),o=I=>j3(I,a.format),S=()=>{d&&(Ch(d),d=void 0)},E=()=>{const I=U3(a.value),R=()=>{let z=I-Date.now();i("change",z),z<=0?(z=0,S(),i("finish")):d=ed(R),g.value=z};d=ed(R)};return _o(()=>{g.value=U3(a.value)-Date.now(),qt(()=>[a.value,a.format],()=>{S(),E()},{immediate:!0})}),Pr(()=>{S()}),t({displayValue:_}),(I,R)=>(se(),Et(y(Vz),{value:g.value,title:I.title,prefix:I.prefix,suffix:I.suffix,"value-style":I.valueStyle,formatter:o},Na({_:2},[Fo(I.$slots,(z,N)=>({name:N,fn:it(()=>[vt(I.$slots,N)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var dse=fn(use,[["__file","countdown.vue"]]);const hse=uo(dse),fse=cn({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),pse={[Wr]:(e,t)=>[e,t].every(Wn)},mse=qe({name:"ElSteps"}),gse=qe({...mse,props:fse,emits:pse,setup(e,{emit:t}){const i=e,a=Xt("steps"),{children:d,addChild:g,removeChild:_}=AT(To(),"ElStep");return qt(d,()=>{d.value.forEach((o,S)=>{o.setIndex(S)})}),Bo("ElSteps",{props:i,steps:d,addStep:g,removeStep:_}),qt(()=>i.active,(o,S)=>{t(Wr,o,S)}),(o,S)=>(se(),Ie("div",{class:ue([y(a).b(),y(a).m(o.simple?"simple":o.direction)])},[vt(o.$slots,"default")],2))}});var vse=fn(gse,[["__file","steps.vue"]]);const _se=cn({title:{type:String,default:""},icon:{type:Cr},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),yse=qe({name:"ElStep"}),bse=qe({...yse,props:_se,setup(e){const t=e,i=Xt("step"),a=xe(-1),d=xe({}),g=xe(""),_=kn("ElSteps"),o=To();_o(()=>{qt([()=>_.props.active,()=>_.props.processStatus,()=>_.props.finishStatus],([oe])=>{q(oe)},{immediate:!0})}),Pr(()=>{_.removeStep(J.uid)});const S=ee(()=>t.status||g.value),E=ee(()=>{const oe=_.steps.value[a.value-1];return oe?oe.currentStatus:"wait"}),I=ee(()=>_.props.alignCenter),R=ee(()=>_.props.direction==="vertical"),z=ee(()=>_.props.simple),N=ee(()=>_.steps.value.length),$=ee(()=>{var oe;return((oe=_.steps.value[N.value-1])==null?void 0:oe.uid)===(o==null?void 0:o.uid)}),F=ee(()=>z.value?"":_.props.space),W=ee(()=>[i.b(),i.is(z.value?"simple":_.props.direction),i.is("flex",$.value&&!F.value&&!I.value),i.is("center",I.value&&!R.value&&!z.value)]),U=ee(()=>{const oe={flexBasis:Wn(F.value)?`${F.value}px`:F.value?F.value:`${100/(N.value-(I.value?0:1))}%`};return R.value||$.value&&(oe.maxWidth=`${100/N.value}%`),oe}),re=oe=>{a.value=oe},K=oe=>{const ae=oe==="wait",fe={transitionDelay:`${ae?"-":""}${150*a.value}ms`},ge=oe===_.props.processStatus||ae?0:100;fe.borderWidth=ge&&!z.value?"1px":0,fe[_.props.direction==="vertical"?"height":"width"]=`${ge}%`,d.value=fe},q=oe=>{oe>a.value?g.value=_.props.finishStatus:oe===a.value&&E.value!=="error"?g.value=_.props.processStatus:g.value="wait";const ae=_.steps.value[a.value-1];ae&&ae.calcProgress(g.value)},J=dr({uid:o.uid,currentStatus:S,setIndex:re,calcProgress:K});return _.addStep(J),(oe,ae)=>(se(),Ie("div",{style:$n(y(U)),class:ue(y(W))},[yt(" icon & line "),je("div",{class:ue([y(i).e("head"),y(i).is(y(S))])},[y(z)?yt("v-if",!0):(se(),Ie("div",{key:0,class:ue(y(i).e("line"))},[je("i",{class:ue(y(i).e("line-inner")),style:$n(d.value)},null,6)],2)),je("div",{class:ue([y(i).e("icon"),y(i).is(oe.icon||oe.$slots.icon?"icon":"text")])},[vt(oe.$slots,"icon",{},()=>[oe.icon?(se(),Et(y(Dn),{key:0,class:ue(y(i).e("icon-inner"))},{default:it(()=>[(se(),Et(ko(oe.icon)))]),_:1},8,["class"])):y(S)==="success"?(se(),Et(y(Dn),{key:1,class:ue([y(i).e("icon-inner"),y(i).is("status")])},{default:it(()=>[Ye(y(i_))]),_:1},8,["class"])):y(S)==="error"?(se(),Et(y(Dn),{key:2,class:ue([y(i).e("icon-inner"),y(i).is("status")])},{default:it(()=>[Ye(y(yl))]),_:1},8,["class"])):y(z)?yt("v-if",!0):(se(),Ie("div",{key:3,class:ue(y(i).e("icon-inner"))},mn(a.value+1),3))])],2)],2),yt(" title & description "),je("div",{class:ue(y(i).e("main"))},[je("div",{class:ue([y(i).e("title"),y(i).is(y(S))])},[vt(oe.$slots,"title",{},()=>[$o(mn(oe.title),1)])],2),y(z)?(se(),Ie("div",{key:0,class:ue(y(i).e("arrow"))},null,2)):(se(),Ie("div",{key:1,class:ue([y(i).e("description"),y(i).is(y(S))])},[vt(oe.$slots,"description",{},()=>[$o(mn(oe.description),1)])],2))],2)],6))}});var Uz=fn(bse,[["__file","item.vue"]]);const xse=uo(vse,{Step:Uz}),wse=ri(Uz),Sse=cn({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:GD},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:Cr},activeActionIcon:{type:Cr},activeIcon:{type:Cr},inactiveIcon:{type:Cr},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:at(Function)},id:String,tabindex:{type:[String,Number]},...Zi(["ariaLabel"])}),Tse={[xo]:e=>Lr(e)||Bn(e)||Wn(e),[Wr]:e=>Lr(e)||Bn(e)||Wn(e),[Ns]:e=>Lr(e)||Bn(e)||Wn(e)},jz="ElSwitch",Cse=qe({name:jz}),Ese=qe({...Cse,props:Sse,emits:Tse,setup(e,{expose:t,emit:i}){const a=e,{formItem:d}=xs(),g=Mi(),_=Xt("switch"),{inputId:o}=Cl(a,{formItemContext:d}),S=bs(ee(()=>a.loading)),E=xe(a.modelValue!==!1),I=xe(),R=xe(),z=ee(()=>[_.b(),_.m(g.value),_.is("disabled",S.value),_.is("checked",U.value)]),N=ee(()=>[_.e("label"),_.em("label","left"),_.is("active",!U.value)]),$=ee(()=>[_.e("label"),_.em("label","right"),_.is("active",U.value)]),F=ee(()=>({width:fi(a.width)}));qt(()=>a.modelValue,()=>{E.value=!0});const W=ee(()=>E.value?a.modelValue:!1),U=ee(()=>W.value===a.activeValue);[a.activeValue,a.inactiveValue].includes(W.value)||(i(xo,a.inactiveValue),i(Wr,a.inactiveValue),i(Ns,a.inactiveValue)),qt(U,J=>{var oe;I.value.checked=J,a.validateEvent&&((oe=d==null?void 0:d.validate)==null||oe.call(d,"change").catch(ae=>void 0))});const re=()=>{const J=U.value?a.inactiveValue:a.activeValue;i(xo,J),i(Wr,J),i(Ns,J),Un(()=>{I.value.checked=U.value})},K=()=>{if(S.value)return;const{beforeChange:J}=a;if(!J){re();return}const oe=J();[bv(oe),Lr(oe)].includes(!0)||Ai(jz,"beforeChange must return type `Promise<boolean>` or `boolean`"),bv(oe)?oe.then(fe=>{fe&&re()}).catch(fe=>{}):oe&&re()},q=()=>{var J,oe;(oe=(J=I.value)==null?void 0:J.focus)==null||oe.call(J)};return _o(()=>{I.value.checked=U.value}),t({focus:q,checked:U}),(J,oe)=>(se(),Ie("div",{class:ue(y(z)),onClick:Xn(K,["prevent"])},[je("input",{id:y(o),ref_key:"input",ref:I,class:ue(y(_).e("input")),type:"checkbox",role:"switch","aria-checked":y(U),"aria-disabled":y(S),"aria-label":J.ariaLabel,name:J.name,"true-value":J.activeValue,"false-value":J.inactiveValue,disabled:y(S),tabindex:J.tabindex,onChange:re,onKeydown:kr(K,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!J.inlinePrompt&&(J.inactiveIcon||J.inactiveText)?(se(),Ie("span",{key:0,class:ue(y(N))},[J.inactiveIcon?(se(),Et(y(Dn),{key:0},{default:it(()=>[(se(),Et(ko(J.inactiveIcon)))]),_:1})):yt("v-if",!0),!J.inactiveIcon&&J.inactiveText?(se(),Ie("span",{key:1,"aria-hidden":y(U)},mn(J.inactiveText),9,["aria-hidden"])):yt("v-if",!0)],2)):yt("v-if",!0),je("span",{ref_key:"core",ref:R,class:ue(y(_).e("core")),style:$n(y(F))},[J.inlinePrompt?(se(),Ie("div",{key:0,class:ue(y(_).e("inner"))},[J.activeIcon||J.inactiveIcon?(se(),Et(y(Dn),{key:0,class:ue(y(_).is("icon"))},{default:it(()=>[(se(),Et(ko(y(U)?J.activeIcon:J.inactiveIcon)))]),_:1},8,["class"])):J.activeText||J.inactiveText?(se(),Ie("span",{key:1,class:ue(y(_).is("text")),"aria-hidden":!y(U)},mn(y(U)?J.activeText:J.inactiveText),11,["aria-hidden"])):yt("v-if",!0)],2)):yt("v-if",!0),je("div",{class:ue(y(_).e("action"))},[J.loading?(se(),Et(y(Dn),{key:0,class:ue(y(_).is("loading"))},{default:it(()=>[Ye(y(ql))]),_:1},8,["class"])):y(U)?vt(J.$slots,"active-action",{key:1},()=>[J.activeActionIcon?(se(),Et(y(Dn),{key:0},{default:it(()=>[(se(),Et(ko(J.activeActionIcon)))]),_:1})):yt("v-if",!0)]):y(U)?yt("v-if",!0):vt(J.$slots,"inactive-action",{key:2},()=>[J.inactiveActionIcon?(se(),Et(y(Dn),{key:0},{default:it(()=>[(se(),Et(ko(J.inactiveActionIcon)))]),_:1})):yt("v-if",!0)])],2)],6),!J.inlinePrompt&&(J.activeIcon||J.activeText)?(se(),Ie("span",{key:1,class:ue(y($))},[J.activeIcon?(se(),Et(y(Dn),{key:0},{default:it(()=>[(se(),Et(ko(J.activeIcon)))]),_:1})):yt("v-if",!0),!J.activeIcon&&J.activeText?(se(),Ie("span",{key:1,"aria-hidden":!y(U)},mn(J.activeText),9,["aria-hidden"])):yt("v-if",!0)],2)):yt("v-if",!0)],10,["onClick"]))}});var Mse=fn(Ese,[["__file","switch.vue"]]);const Ise=uo(Mse),Lw=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},Ase=function(e,t,i,a,d){if(!t&&!a&&(!d||sn(d)&&!d.length))return e;Bn(i)?i=i==="descending"?-1:1:i=i&&i<0?-1:1;const g=a?null:function(o,S){return d?(sn(d)||(d=[d]),d.map(E=>Bn(E)?xi(o,E):E(o,S,e))):(t!=="$key"&&So(o)&&"$value"in o&&(o=o.$value),[So(o)?xi(o,t):o])},_=function(o,S){if(a)return a(o.value,S.value);for(let E=0,I=o.key.length;E<I;E++){if(o.key[E]<S.key[E])return-1;if(o.key[E]>S.key[E])return 1}return 0};return e.map((o,S)=>({value:o,index:S,key:g?g(o,S):null})).sort((o,S)=>{let E=_(o,S);return E||(E=o.index-S.index),E*+i}).map(o=>o.value)},Hz=function(e,t){let i=null;return e.columns.forEach(a=>{a.id===t&&(i=a)}),i},kse=function(e,t){let i=null;for(let a=0;a<e.columns.length;a++){const d=e.columns[a];if(d.columnKey===t){i=d;break}}return i||Ai("ElTable",`No column matching with column-key: ${t}`),i},H3=function(e,t,i){const a=(t.className||"").match(new RegExp(`${i}-table_[^\\s]+`,"gm"));return a?Hz(e,a[0]):null},vs=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(Bn(t)){if(!t.includes("."))return`${e[t]}`;const i=t.split(".");let a=e;for(const d of i)a=a[d];return`${a}`}else if(Nn(t))return t.call(null,e)},fh=function(e,t){const i={};return(e||[]).forEach((a,d)=>{i[vs(a,t)]={row:a,index:d}}),i};function Pse(e,t){const i={};let a;for(a in e)i[a]=e[a];for(a in t)if(or(t,a)){const d=t[a];typeof d<"u"&&(i[a]=d)}return i}function oC(e){return e===""||e!==void 0&&(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function Gz(e){return e===""||e!==void 0&&(e=oC(e),Number.isNaN(e)&&(e=80)),e}function Rse(e){return Wn(e)?e:Bn(e)?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function Dse(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,i)=>(...a)=>t(i(...a)))}function Sb(e,t,i,a,d,g){let _=g??0,o=!1;const S=e.indexOf(t),E=S!==-1,I=d==null?void 0:d.call(null,t,g),R=N=>{N==="add"?e.push(t):e.splice(S,1),o=!0},z=N=>{let $=0;const F=(a==null?void 0:a.children)&&N[a.children];return F&&sn(F)&&($+=F.length,F.forEach(W=>{$+=z(W)})),$};return(!d||I)&&(Lr(i)?i&&!E?R("add"):!i&&E&&R("remove"):R(E?"remove":"add")),!(a!=null&&a.checkStrictly)&&(a!=null&&a.children)&&sn(t[a.children])&&t[a.children].forEach(N=>{Sb(e,N,i??!E,a,d,_+1),_+=z(N)+1}),o}function Lse(e,t,i="children",a="hasChildren"){const d=_=>!(sn(_)&&_.length);function g(_,o,S){t(_,o,S),o.forEach(E=>{if(E[a]){t(E,null,S+1);return}const I=E[i];d(I)||g(E,I,S+1)})}e.forEach(_=>{if(_[a]){t(_,null,0);return}const o=_[i];d(o)||g(_,o,0)})}const G3=(e,t)=>({content:t,...e,popperOptions:{strategy:"fixed",...e.popperOptions}});let Ra=null;function Ose(e,t,i,a){if((Ra==null?void 0:Ra.trigger)===i){LD(Ra.vm.component.props,G3(e,t));return}Ra==null||Ra();const d=a==null?void 0:a.refs.tableWrapper,g=d==null?void 0:d.dataset.prefix,_=Ye(rs,{virtualTriggering:!0,virtualRef:i,appendTo:d,placement:"top",transition:"none",offset:0,hideAfter:0,...G3(e,t)});_.appContext={...a.appContext,...a};const o=document.createElement("div");Ju(_,o),_.component.exposed.onOpen();const S=d==null?void 0:d.querySelector(`.${g}-scrollbar__wrap`);Ra=()=>{Ju(null,o),S==null||S.removeEventListener("scroll",Ra),Ra=null},Ra.trigger=i,Ra.vm=_,S==null||S.addEventListener("scroll",Ra)}function Wz(e){return e.children?zH(e.children,Wz):[e]}function W3(e,t){return e+t.colSpan}const qz=(e,t,i,a)=>{let d=0,g=e;const _=i.states.columns.value;if(a){const S=Wz(a[e]);d=_.slice(0,_.indexOf(S[0])).reduce(W3,0),g=d+S.reduce(W3,0)-1}else d=e;let o;switch(t){case"left":g<i.states.fixedLeafColumnsLength.value&&(o="left");break;case"right":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(o="right");break;default:g<i.states.fixedLeafColumnsLength.value?o="left":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(o="right")}return o?{direction:o,start:d,after:g}:{}},rC=(e,t,i,a,d,g=0)=>{const _=[],{direction:o,start:S,after:E}=qz(t,i,a,d);if(o){const I=o==="left";_.push(`${e}-fixed-column--${o}`),I&&E+g===a.states.fixedLeafColumnsLength.value-1?_.push("is-last-column"):!I&&S-g===a.states.columns.value.length-a.states.rightFixedLeafColumnsLength.value&&_.push("is-first-column")}return _};function q3(e,t){return e+(t.realWidth===null||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const iC=(e,t,i,a)=>{const{direction:d,start:g=0,after:_=0}=qz(e,t,i,a);if(!d)return;const o={},S=d==="left",E=i.states.columns.value;return S?o.left=E.slice(0,g).reduce(q3,0):o.right=E.slice(_+1).reverse().reduce(q3,0),o},Fp=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function zse(e){const t=To(),i=xe(!1),a=xe([]);return{updateExpandRows:()=>{const S=e.data.value||[],E=e.rowKey.value;if(i.value)a.value=S.slice();else if(E){const I=fh(a.value,E);a.value=S.reduce((R,z)=>{const N=vs(z,E);return I[N]&&R.push(z),R},[])}else a.value=[]},toggleRowExpansion:(S,E)=>{Sb(a.value,S,E)&&t.emit("expand-change",S,a.value.slice())},setExpandRowKeys:S=>{t.store.assertRowKey();const E=e.data.value||[],I=e.rowKey.value,R=fh(E,I);a.value=S.reduce((z,N)=>{const $=R[N];return $&&z.push($.row),z},[])},isRowExpanded:S=>{const E=e.rowKey.value;return E?!!fh(a.value,E)[vs(S,E)]:a.value.includes(S)},states:{expandRows:a,defaultExpandAll:i}}}function Bse(e){const t=To(),i=xe(null),a=xe(null),d=E=>{t.store.assertRowKey(),i.value=E,_(E)},g=()=>{i.value=null},_=E=>{const{data:I,rowKey:R}=e;let z=null;R.value&&(z=(y(I)||[]).find(N=>vs(N,R.value)===E)),a.value=z,t.emit("current-change",a.value,null)};return{setCurrentRowKey:d,restoreCurrentRowKey:g,setCurrentRowByKey:_,updateCurrentRow:E=>{const I=a.value;if(E&&E!==I){a.value=E,t.emit("current-change",a.value,I);return}!E&&I&&(a.value=null,t.emit("current-change",null,I))},updateCurrentRowData:()=>{const E=e.rowKey.value,I=e.data.value||[],R=a.value;if(!I.includes(R)&&R){if(E){const z=vs(R,E);_(z)}else a.value=null;a.value===null&&t.emit("current-change",null,R)}else i.value&&(_(i.value),g())},states:{_currentRowKey:i,currentRow:a}}}function Fse(e){const t=xe([]),i=xe({}),a=xe(16),d=xe(!1),g=xe({}),_=xe("hasChildren"),o=xe("children"),S=xe(!1),E=To(),I=ee(()=>{if(!e.rowKey.value)return{};const K=e.data.value||[];return z(K)}),R=ee(()=>{const K=e.rowKey.value,q=Object.keys(g.value),J={};return q.length&&q.forEach(oe=>{if(g.value[oe].length){const ae={children:[]};g.value[oe].forEach(fe=>{const ge=vs(fe,K);ae.children.push(ge),fe[_.value]&&!J[ge]&&(J[ge]={children:[]})}),J[oe]=ae}}),J}),z=K=>{const q=e.rowKey.value,J={};return Lse(K,(oe,ae,fe)=>{const ge=vs(oe,q);sn(ae)?J[ge]={children:ae.map(ce=>vs(ce,q)),level:fe}:d.value&&(J[ge]={children:[],lazy:!0,level:fe})},o.value,_.value),J},N=(K=!1,q=(J=>(J=E.store)==null?void 0:J.states.defaultExpandAll.value)())=>{var J;const oe=I.value,ae=R.value,fe=Object.keys(oe),ge={};if(fe.length){const ce=y(i),de=[],_e=(Qe,Ee)=>{if(K)return t.value?q||t.value.includes(Ee):!!(q||Qe!=null&&Qe.expanded);{const ye=q||t.value&&t.value.includes(Ee);return!!(Qe!=null&&Qe.expanded||ye)}};fe.forEach(Qe=>{const Ee=ce[Qe],ye={...oe[Qe]};if(ye.expanded=_e(Ee,Qe),ye.lazy){const{loaded:Me=!1,loading:Te=!1}=Ee||{};ye.loaded=!!Me,ye.loading=!!Te,de.push(Qe)}ge[Qe]=ye});const Re=Object.keys(ae);d.value&&Re.length&&de.length&&Re.forEach(Qe=>{const Ee=ce[Qe],ye=ae[Qe].children;if(de.includes(Qe)){if(ge[Qe].children.length!==0)throw new Error("[ElTable]children must be an empty array.");ge[Qe].children=ye}else{const{loaded:Me=!1,loading:Te=!1}=Ee||{};ge[Qe]={lazy:!0,loaded:!!Me,loading:!!Te,expanded:_e(Ee,Qe),children:ye,level:""}}})}i.value=ge,(J=E.store)==null||J.updateTableScrollY()};qt(()=>t.value,()=>{N(!0)}),qt(()=>I.value,()=>{N()}),qt(()=>R.value,()=>{N()});const $=K=>{t.value=K,N()},F=(K,q)=>{E.store.assertRowKey();const J=e.rowKey.value,oe=vs(K,J),ae=oe&&i.value[oe];if(oe&&ae&&"expanded"in ae){const fe=ae.expanded;q=jr(q)?!ae.expanded:q,i.value[oe].expanded=q,fe!==q&&E.emit("expand-change",K,q),E.store.updateTableScrollY()}},W=K=>{E.store.assertRowKey();const q=e.rowKey.value,J=vs(K,q),oe=i.value[J];d.value&&oe&&"loaded"in oe&&!oe.loaded?U(K,J,oe):F(K,void 0)},U=(K,q,J)=>{const{load:oe}=E.props;oe&&!i.value[q].loaded&&(i.value[q].loading=!0,oe(K,J,ae=>{if(!sn(ae))throw new TypeError("[ElTable] data must be an array");i.value[q].loading=!1,i.value[q].loaded=!0,i.value[q].expanded=!0,ae.length&&(g.value[q]=ae),E.emit("expand-change",K,!0)}))};return{loadData:U,loadOrToggle:W,toggleTreeExpansion:F,updateTreeExpandKeys:$,updateTreeData:N,updateKeyChildren:(K,q)=>{const{lazy:J,rowKey:oe}=E.props;if(J){if(!oe)throw new Error("[Table] rowKey is required in updateKeyChild");g.value[K]&&(g.value[K]=q)}},normalize:z,states:{expandRowKeys:t,treeData:i,indent:a,lazy:d,lazyTreeNodeMap:g,lazyColumnIdentifier:_,childrenColumnName:o,checkStrictly:S}}}const Nse=(e,t)=>{const i=t.sortingColumn;return!i||Bn(i.sortable)?e:Ase(e,t.sortProp,t.sortOrder,i.sortMethod,i.sortBy)},V0=e=>{const t=[];return e.forEach(i=>{i.children&&i.children.length>0?t.push.apply(t,V0(i.children)):t.push(i)}),t};function $se(){var e;const t=To(),{size:i}=Vi((e=t.proxy)==null?void 0:e.$props),a=xe(null),d=xe([]),g=xe([]),_=xe(!1),o=xe([]),S=xe([]),E=xe([]),I=xe([]),R=xe([]),z=xe([]),N=xe([]),$=xe([]),F=[],W=xe(0),U=xe(0),re=xe(0),K=xe(!1),q=xe([]),J=xe(!1),oe=xe(!1),ae=xe(null),fe=xe({}),ge=xe(null),ce=xe(null),de=xe(null),_e=xe(null),Re=xe(null);qt(d,()=>{var Pt;t.state&&(Te(!1),t.props.tableLayout==="auto"&&((Pt=t.refs.tableHeaderRef)==null||Pt.updateFixedColumnStyle()))},{deep:!0});const Qe=()=>{if(!a.value)throw new Error("[ElTable] prop row-key is required")},Ee=Pt=>{var _n;(_n=Pt.children)==null||_n.forEach(dt=>{dt.fixed=Pt.fixed,Ee(dt)})};let ye;const Me=()=>{o.value.forEach(Ze=>{Ee(Ze)}),I.value=o.value.filter(Ze=>Ze.fixed===!0||Ze.fixed==="left"),R.value=o.value.filter(Ze=>Ze.fixed==="right"),jr(ye)&&o.value[0]&&o.value[0].type==="selection"&&(ye=!!o.value[0].fixed),I.value.length>0&&o.value[0]&&o.value[0].type==="selection"&&(o.value[0].fixed?I.value.some(vn=>vn.type!=="selection")?ye=void 0:(o.value[0].fixed=ye,ye||I.value.shift()):(o.value[0].fixed=!0,I.value.unshift(o.value[0])));const Pt=o.value.filter(Ze=>!Ze.fixed);S.value=[].concat(I.value).concat(Pt).concat(R.value);const _n=V0(Pt),dt=V0(I.value),tn=V0(R.value);W.value=_n.length,U.value=dt.length,re.value=tn.length,E.value=[].concat(dt).concat(_n).concat(tn),_.value=I.value.length>0||R.value.length>0},Te=(Pt,_n=!1)=>{Pt&&Me(),_n?t.state.doLayout():t.state.debouncedUpdateLayout()},he=Pt=>q.value.some(_n=>qi(_n,Pt)),ke=()=>{K.value=!1;const Pt=q.value;q.value=[],Pt.length&&t.emit("selection-change",[])},Ne=()=>{let Pt;if(a.value){Pt=[];const _n=fh(q.value,a.value),dt=fh(d.value,a.value);for(const tn in _n)or(_n,tn)&&!dt[tn]&&Pt.push(_n[tn].row)}else Pt=q.value.filter(_n=>!d.value.includes(_n));if(Pt.length){const _n=q.value.filter(dt=>!Pt.includes(dt));q.value=_n,t.emit("selection-change",_n.slice())}},nt=()=>(q.value||[]).slice(),De=(Pt,_n,dt=!0,tn=!1)=>{var Ze,vn,Mn,yo;const gr={children:(vn=(Ze=t==null?void 0:t.store)==null?void 0:Ze.states)==null?void 0:vn.childrenColumnName.value,checkStrictly:(yo=(Mn=t==null?void 0:t.store)==null?void 0:Mn.states)==null?void 0:yo.checkStrictly.value};if(Sb(q.value,Pt,_n,gr,tn?void 0:ae.value)){const Ur=(q.value||[]).slice();dt&&t.emit("select",Ur,Pt),t.emit("selection-change",Ur)}},Ct=()=>{var Pt,_n;const dt=oe.value?!K.value:!(K.value||q.value.length);K.value=dt;let tn=!1,Ze=0;const vn=(_n=(Pt=t==null?void 0:t.store)==null?void 0:Pt.states)==null?void 0:_n.rowKey.value,{childrenColumnName:Mn}=t.store.states,yo={children:Mn.value,checkStrictly:!1};d.value.forEach((gr,Xr)=>{const Ur=Xr+Ze;Sb(q.value,gr,dt,yo,ae.value,Ur)&&(tn=!0),Ze+=mt(vs(gr,vn))}),tn&&t.emit("selection-change",q.value?q.value.slice():[]),t.emit("select-all",(q.value||[]).slice())},Rt=()=>{const Pt=fh(q.value,a.value);d.value.forEach(_n=>{const dt=vs(_n,a.value),tn=Pt[dt];tn&&(q.value[tn.index]=_n)})},Bt=()=>{var Pt;if(((Pt=d.value)==null?void 0:Pt.length)===0){K.value=!1;return}const{childrenColumnName:_n}=t.store.states,dt=a.value?fh(q.value,a.value):void 0;let tn=0,Ze=0;const vn=gr=>dt?!!dt[vs(gr,a.value)]:q.value.includes(gr),Mn=gr=>{var Xr;for(const Ur of gr){const Rr=ae.value&&ae.value.call(null,Ur,tn);if(vn(Ur))Ze++;else if(!ae.value||Rr)return!1;if(tn++,(Xr=Ur[_n.value])!=null&&Xr.length&&!Mn(Ur[_n.value]))return!1}return!0},yo=Mn(d.value||[]);K.value=Ze===0?!1:yo},mt=Pt=>{var _n;if(!t||!t.store)return 0;const{treeData:dt}=t.store.states;let tn=0;const Ze=(_n=dt.value[Pt])==null?void 0:_n.children;return Ze&&(tn+=Ze.length,Ze.forEach(vn=>{tn+=mt(vn)})),tn},Gt=(Pt,_n)=>{sn(Pt)||(Pt=[Pt]);const dt={};return Pt.forEach(tn=>{fe.value[tn.id]=_n,dt[tn.columnKey||tn.id]=_n}),dt},jt=(Pt,_n,dt)=>{ce.value&&ce.value!==Pt&&(ce.value.order=null),ce.value=Pt,de.value=_n,_e.value=dt},Be=()=>{let Pt=y(g);Object.keys(fe.value).forEach(_n=>{const dt=fe.value[_n];if(!dt||dt.length===0)return;const tn=Hz({columns:E.value},_n);tn&&tn.filterMethod&&(Pt=Pt.filter(Ze=>dt.some(vn=>tn.filterMethod.call(null,vn,Ze,tn))))}),ge.value=Pt},an=()=>{d.value=Nse(ge.value,{sortingColumn:ce.value,sortProp:de.value,sortOrder:_e.value})},At=(Pt=void 0)=>{Pt&&Pt.filter||Be(),an()},Ge=Pt=>{const{tableHeaderRef:_n}=t.refs;if(!_n)return;const dt=Object.assign({},_n.filterPanels),tn=Object.keys(dt);if(tn.length)if(Bn(Pt)&&(Pt=[Pt]),sn(Pt)){const Ze=Pt.map(vn=>kse({columns:E.value},vn));tn.forEach(vn=>{const Mn=Ze.find(yo=>yo.id===vn);Mn&&(Mn.filteredValue=[])}),t.store.commit("filterChange",{column:Ze,values:[],silent:!0,multi:!0})}else tn.forEach(Ze=>{const vn=E.value.find(Mn=>Mn.id===Ze);vn&&(vn.filteredValue=[])}),fe.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},Fe=()=>{ce.value&&(jt(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Nt,toggleRowExpansion:Jt,updateExpandRows:Dt,states:xt,isRowExpanded:Ot}=zse({data:d,rowKey:a}),{updateTreeExpandKeys:en,toggleTreeExpansion:dn,updateTreeData:un,updateKeyChildren:Pn,loadOrToggle:gt,states:Sn}=Fse({data:d,rowKey:a}),{updateCurrentRowData:Vn,updateCurrentRow:lo,setCurrentRowKey:eo,states:fo}=Bse({data:d,rowKey:a});return{assertRowKey:Qe,updateColumns:Me,scheduleLayout:Te,isSelected:he,clearSelection:ke,cleanSelection:Ne,getSelectionRows:nt,toggleRowSelection:De,_toggleAllSelection:Ct,toggleAllSelection:null,updateSelectionByRowKey:Rt,updateAllSelected:Bt,updateFilters:Gt,updateCurrentRow:lo,updateSort:jt,execFilter:Be,execSort:an,execQuery:At,clearFilter:Ge,clearSort:Fe,toggleRowExpansion:Jt,setExpandRowKeysAdapter:Pt=>{Nt(Pt),en(Pt)},setCurrentRowKey:eo,toggleRowExpansionAdapter:(Pt,_n)=>{E.value.some(({type:tn})=>tn==="expand")?Jt(Pt,_n):dn(Pt,_n)},isRowExpanded:Ot,updateExpandRows:Dt,updateCurrentRowData:Vn,loadOrToggle:gt,updateTreeData:un,updateKeyChildren:Pn,states:{tableSize:i,rowKey:a,data:d,_data:g,isComplex:_,_columns:o,originColumns:S,columns:E,fixedColumns:I,rightFixedColumns:R,leafColumns:z,fixedLeafColumns:N,rightFixedLeafColumns:$,updateOrderFns:F,leafColumnsLength:W,fixedLeafColumnsLength:U,rightFixedLeafColumnsLength:re,isAllSelected:K,selection:q,reserveSelection:J,selectOnIndeterminate:oe,selectable:ae,filters:fe,filteredData:ge,sortingColumn:ce,sortProp:de,sortOrder:_e,hoverRow:Re,...xt,...Sn,...fo}}}function Q2(e,t){return e.map(i=>{var a;return i.id===t.id?t:((a=i.children)!=null&&a.length&&(i.children=Q2(i.children,t)),i)})}function eS(e){e.forEach(t=>{var i,a;t.no=(i=t.getColumnIndex)==null?void 0:i.call(t),(a=t.children)!=null&&a.length&&eS(t.children)}),e.sort((t,i)=>t.no-i.no)}function Vse(){const e=To(),t=$se();return{ns:Xt("table"),...t,mutations:{setData(_,o){const S=y(_._data)!==o;_.data.value=o,_._data.value=o,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),y(_.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):S?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(_,o,S,E){const I=y(_._columns);let R=[];S?(S&&!S.children&&(S.children=[]),S.children.push(o),R=Q2(I,S)):(I.push(o),R=I),eS(R),_._columns.value=R,_.updateOrderFns.push(E),o.type==="selection"&&(_.selectable.value=o.selectable,_.reserveSelection.value=o.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(_,o){var S;((S=o.getColumnIndex)==null?void 0:S.call(o))!==o.no&&(eS(_._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(_,o,S,E){const I=y(_._columns)||[];if(S)S.children.splice(S.children.findIndex(z=>z.id===o.id),1),Un(()=>{var z;((z=S.children)==null?void 0:z.length)===0&&delete S.children}),_._columns.value=Q2(I,S);else{const z=I.indexOf(o);z>-1&&(I.splice(z,1),_._columns.value=I)}const R=_.updateOrderFns.indexOf(E);R>-1&&_.updateOrderFns.splice(R,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(_,o){const{prop:S,order:E,init:I}=o;if(S){const R=y(_.columns).find(z=>z.property===S);R&&(R.order=E,e.store.updateSort(R,S,E),e.store.commit("changeSortCondition",{init:I}))}},changeSortCondition(_,o){const{sortingColumn:S,sortProp:E,sortOrder:I}=_,R=y(S),z=y(E),N=y(I);N===null&&(_.sortingColumn.value=null,_.sortProp.value=null);const $={filter:!0};e.store.execQuery($),(!o||!(o.silent||o.init))&&e.emit("sort-change",{column:R,prop:z,order:N}),e.store.updateTableScrollY()},filterChange(_,o){const{column:S,values:E,silent:I}=o,R=e.store.updateFilters(S,E);e.store.execQuery(),I||e.emit("filter-change",R),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(_,o){e.store.toggleRowSelection(o),e.store.updateAllSelected()},setHoverRow(_,o){_.hoverRow.value=o},setCurrentRow(_,o){e.store.updateCurrentRow(o)}},commit:function(_,...o){const S=e.store.mutations;if(S[_])S[_].apply(e,[e.store.states].concat(o));else throw new Error(`Action not found: ${_}`)},updateTableScrollY:function(){Un(()=>e.layout.updateScrollY.apply(e.layout))}}}const yv={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function Use(e,t){if(!e)throw new Error("Table is required.");const i=Vse();return i.toggleAllSelection=Qs(i._toggleAllSelection,10),Object.keys(yv).forEach(a=>{Kz(Zz(t,a),a,i)}),jse(i,t),i}function jse(e,t){Object.keys(yv).forEach(i=>{qt(()=>Zz(t,i),a=>{Kz(a,i,e)})})}function Kz(e,t,i){let a=e,d=yv[t];typeof yv[t]=="object"&&(d=d.key,a=a||yv[t].default),i.states[d].value=a}function Zz(e,t){if(t.includes(".")){const i=t.split(".");let a=e;return i.forEach(d=>{a=a[d]}),a}else return e[t]}class Hse{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=xe(null),this.scrollX=xe(!1),this.scrollY=xe(!1),this.bodyWidth=xe(null),this.fixedWidth=xe(null),this.rightFixedWidth=xe(null),this.gutterWidth=0;for(const i in t)or(t,i)&&(Hr(this[i])?this[i].value=t[i]:this[i]=t[i]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const i=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(i!=null&&i.wrapRef)){let a=!0;const d=this.scrollY.value;return a=i.wrapRef.scrollHeight>i.wrapRef.clientHeight,this.scrollY.value=a,d!==a}return!1}setHeight(t,i="height"){if(!Wo)return;const a=this.table.vnode.el;if(t=Rse(t),this.height.value=Number(t),!a&&(t||t===0))return Un(()=>this.setHeight(t,i));Wn(t)?(a.style[i]=`${t}px`,this.updateElsHeight()):Bn(t)&&(a.style[i]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(a=>{a.isColumnGroup?t.push.apply(t,a.columns):t.push(a)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let i=t;for(;i.tagName!=="DIV";){if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1}updateColumnsWidth(){if(!Wo)return;const t=this.fit,i=this.table.vnode.el.clientWidth;let a=0;const d=this.getFlattenColumns(),g=d.filter(S=>!Wn(S.width));if(d.forEach(S=>{Wn(S.width)&&S.realWidth&&(S.realWidth=null)}),g.length>0&&t){if(d.forEach(S=>{a+=Number(S.width||S.minWidth||80)}),a<=i){this.scrollX.value=!1;const S=i-a;if(g.length===1)g[0].realWidth=Number(g[0].minWidth||80)+S;else{const E=g.reduce((z,N)=>z+Number(N.minWidth||80),0),I=S/E;let R=0;g.forEach((z,N)=>{if(N===0)return;const $=Math.floor(Number(z.minWidth||80)*I);R+=$,z.realWidth=Number(z.minWidth||80)+$}),g[0].realWidth=Number(g[0].minWidth||80)+S-R}}else this.scrollX.value=!0,g.forEach(S=>{S.realWidth=Number(S.minWidth)});this.bodyWidth.value=Math.max(a,i),this.table.state.resizeState.value.width=this.bodyWidth.value}else d.forEach(S=>{!S.width&&!S.minWidth?S.realWidth=80:S.realWidth=Number(S.width||S.minWidth),a+=S.realWidth}),this.scrollX.value=a>i,this.bodyWidth.value=a;const _=this.store.states.fixedColumns.value;if(_.length>0){let S=0;_.forEach(E=>{S+=Number(E.realWidth||E.width)}),this.fixedWidth.value=S}const o=this.store.states.rightFixedColumns.value;if(o.length>0){let S=0;o.forEach(E=>{S+=Number(E.realWidth||E.width)}),this.rightFixedWidth.value=S}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}notifyObservers(t){this.observers.forEach(a=>{var d,g;switch(t){case"columns":(d=a.state)==null||d.onColumnsChange(this);break;case"scrollable":(g=a.state)==null||g.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:Gse}=ja,Wse=qe({name:"ElTableFilterPanel",components:{ElCheckbox:ja,ElCheckboxGroup:Gse,ElScrollbar:nc,ElTooltip:rs,ElIcon:Dn,ArrowDown:Oc,ArrowUp:oT},directives:{ClickOutside:kc},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:{type:String}},setup(e){const t=To(),{t:i}=qo(),a=Xt("table-filter"),d=t==null?void 0:t.parent;d.filterPanels.value[e.column.id]||(d.filterPanels.value[e.column.id]=t);const g=xe(!1),_=xe(null),o=ee(()=>e.column&&e.column.filters),S=ee(()=>e.column.filterClassName?`${a.b()} ${e.column.filterClassName}`:a.b()),E=ee({get:()=>{var J;return(((J=e.column)==null?void 0:J.filteredValue)||[])[0]},set:J=>{I.value&&(typeof J<"u"&&J!==null?I.value.splice(0,1,J):I.value.splice(0,1))}}),I=ee({get(){return e.column?e.column.filteredValue||[]:[]},set(J){e.column&&e.upDataColumn("filteredValue",J)}}),R=ee(()=>e.column?e.column.filterMultiple:!0),z=J=>J.value===E.value,N=()=>{g.value=!1},$=J=>{J.stopPropagation(),g.value=!g.value},F=()=>{g.value=!1},W=()=>{K(I.value),N()},U=()=>{I.value=[],K(I.value),N()},re=J=>{E.value=J,K(typeof J<"u"&&J!==null?I.value:[]),N()},K=J=>{e.store.commit("filterChange",{column:e.column,values:J}),e.store.updateAllSelected()};qt(g,J=>{e.column&&e.upDataColumn("filterOpened",J)},{immediate:!0});const q=ee(()=>{var J,oe;return(oe=(J=_.value)==null?void 0:J.popperRef)==null?void 0:oe.contentRef});return{tooltipVisible:g,multiple:R,filterClassName:S,filteredValue:I,filterValue:E,filters:o,handleConfirm:W,handleReset:U,handleSelect:re,isActive:z,t:i,ns:a,showFilterPanel:$,hideFilterPanel:F,popperPaneRef:q,tooltip:_}}});function qse(e,t,i,a,d,g){const _=Mo("el-checkbox"),o=Mo("el-checkbox-group"),S=Mo("el-scrollbar"),E=Mo("arrow-up"),I=Mo("arrow-down"),R=Mo("el-icon"),z=Mo("el-tooltip"),N=zb("click-outside");return se(),Et(z,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:"","append-to":e.appendTo},{content:it(()=>[e.multiple?(se(),Ie("div",{key:0},[je("div",{class:ue(e.ns.e("content"))},[Ye(S,{"wrap-class":e.ns.e("wrap")},{default:it(()=>[Ye(o,{modelValue:e.filteredValue,"onUpdate:modelValue":$=>e.filteredValue=$,class:ue(e.ns.e("checkbox-group"))},{default:it(()=>[(se(!0),Ie(Fn,null,Fo(e.filters,$=>(se(),Et(_,{key:$.value,value:$.value},{default:it(()=>[$o(mn($.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),je("div",{class:ue(e.ns.e("bottom"))},[je("button",{class:ue({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:e.handleConfirm},mn(e.t("el.table.confirmFilter")),11,["disabled","onClick"]),je("button",{type:"button",onClick:e.handleReset},mn(e.t("el.table.resetFilter")),9,["onClick"])],2)])):(se(),Ie("ul",{key:1,class:ue(e.ns.e("list"))},[je("li",{class:ue([e.ns.e("list-item"),{[e.ns.is("active")]:e.filterValue===void 0||e.filterValue===null}]),onClick:$=>e.handleSelect(null)},mn(e.t("el.table.clearFilter")),11,["onClick"]),(se(!0),Ie(Fn,null,Fo(e.filters,$=>(se(),Ie("li",{key:$.value,class:ue([e.ns.e("list-item"),e.ns.is("active",e.isActive($))]),label:$.value,onClick:F=>e.handleSelect($.value)},mn($.text),11,["label","onClick"]))),128))],2))]),default:it(()=>[vo((se(),Ie("span",{class:ue([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:e.showFilterPanel},[Ye(R,null,{default:it(()=>[vt(e.$slots,"filter-icon",{},()=>[e.column.filterOpened?(se(),Et(E,{key:0})):(se(),Et(I,{key:1}))])]),_:3})],10,["onClick"])),[[N,e.hideFilterPanel,e.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var Kse=fn(Wse,[["render",qse],["__file","filter-panel.vue"]]);function Yz(e){const t=To();Ob(()=>{i.value.addObserver(t)}),_o(()=>{a(i.value),d(i.value)}),Xl(()=>{a(i.value),d(i.value)}),ld(()=>{i.value.removeObserver(t)});const i=ee(()=>{const g=e.layout;if(!g)throw new Error("Can not find table layout.");return g}),a=g=>{var _;const o=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col"))||[];if(!o.length)return;const S=g.getFlattenColumns(),E={};S.forEach(I=>{E[I.id]=I});for(let I=0,R=o.length;I<R;I++){const z=o[I],N=z.getAttribute("name"),$=E[N];$&&z.setAttribute("width",$.realWidth||$.width)}},d=g=>{var _,o;const S=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let I=0,R=S.length;I<R;I++)S[I].setAttribute("width",g.scrollY.value?g.gutterWidth:"0");const E=((o=e.vnode.el)==null?void 0:o.querySelectorAll("th.gutter"))||[];for(let I=0,R=E.length;I<R;I++){const z=E[I];z.style.width=g.scrollY.value?`${g.gutterWidth}px`:"0",z.style.display=g.scrollY.value?"":"none"}};return{tableLayout:i.value,onColumnsChange:a,onScrollableChange:d}}const oc=Symbol("ElTable");function Zse(e,t){const i=To(),a=kn(oc),d=F=>{F.stopPropagation()},g=(F,W)=>{!W.filters&&W.sortable?$(F,W,!1):W.filterable&&!W.sortable&&d(F),a==null||a.emit("header-click",W,F)},_=(F,W)=>{a==null||a.emit("header-contextmenu",W,F)},o=xe(null),S=xe(!1),E=xe({}),I=(F,W)=>{if(Wo&&!(W.children&&W.children.length>0)&&o.value&&e.border){S.value=!0;const U=a;t("set-drag-visible",!0);const K=(U==null?void 0:U.vnode.el).getBoundingClientRect().left,q=i.vnode.el.querySelector(`th.${W.id}`),J=q.getBoundingClientRect(),oe=J.left-K+30;Oa(q,"noclick"),E.value={startMouseLeft:F.clientX,startLeft:J.right-K,startColumnLeft:J.left-K,tableLeft:K};const ae=U==null?void 0:U.refs.resizeProxy;ae.style.left=`${E.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const fe=ce=>{const de=ce.clientX-E.value.startMouseLeft,_e=E.value.startLeft+de;ae.style.left=`${Math.max(oe,_e)}px`},ge=()=>{if(S.value){const{startColumnLeft:ce,startLeft:de}=E.value,Re=Number.parseInt(ae.style.left,10)-ce;W.width=W.realWidth=Re,U==null||U.emit("header-dragend",W.width,de-ce,W,F),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",S.value=!1,o.value=null,E.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",fe),document.removeEventListener("mouseup",ge),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{ys(q,"noclick")},0)};document.addEventListener("mousemove",fe),document.addEventListener("mouseup",ge)}},R=(F,W)=>{var U;if(W.children&&W.children.length>0)return;const re=F.target;if(!va(re))return;const K=re==null?void 0:re.closest("th");if(!(!W||!W.resizable||!K)&&!S.value&&e.border){const q=K.getBoundingClientRect(),J=document.body.style,oe=((U=K.parentNode)==null?void 0:U.lastElementChild)===K;q.width>12&&q.right-F.pageX<8&&!oe?(J.cursor="col-resize",Zs(K,"is-sortable")&&(K.style.cursor="col-resize"),o.value=W):S.value||(J.cursor="",Zs(K,"is-sortable")&&(K.style.cursor="pointer"),o.value=null)}},z=()=>{Wo&&(document.body.style.cursor="")},N=({order:F,sortOrders:W})=>{if(F==="")return W[0];const U=W.indexOf(F||null);return W[U>W.length-2?0:U+1]},$=(F,W,U)=>{var re;F.stopPropagation();const K=W.order===U?null:U||N(W),q=(re=F.target)==null?void 0:re.closest("th");if(q&&Zs(q,"noclick")){ys(q,"noclick");return}if(!W.sortable)return;const J=F.currentTarget;if(["ascending","descending"].some(ce=>Zs(J,ce)&&!W.sortOrders.includes(ce)))return;const oe=e.store.states;let ae=oe.sortProp.value,fe;const ge=oe.sortingColumn.value;(ge!==W||ge===W&&ge.order===null)&&(ge&&(ge.order=null),oe.sortingColumn.value=W,ae=W.property),K?fe=W.order=K:fe=W.order=null,oe.sortProp.value=ae,oe.sortOrder.value=fe,a==null||a.store.commit("changeSortCondition")};return{handleHeaderClick:g,handleHeaderContextMenu:_,handleMouseDown:I,handleMouseMove:R,handleMouseOut:z,handleSortClick:$,handleFilterClick:d}}function Yse(e){const t=kn(oc),i=Xt("table");return{getHeaderRowStyle:o=>{const S=t==null?void 0:t.props.headerRowStyle;return Nn(S)?S.call(null,{rowIndex:o}):S},getHeaderRowClass:o=>{const S=[],E=t==null?void 0:t.props.headerRowClassName;return Bn(E)?S.push(E):Nn(E)&&S.push(E.call(null,{rowIndex:o})),S.join(" ")},getHeaderCellStyle:(o,S,E,I)=>{var R;let z=(R=t==null?void 0:t.props.headerCellStyle)!=null?R:{};Nn(z)&&(z=z.call(null,{rowIndex:o,columnIndex:S,row:E,column:I}));const N=iC(S,I.fixed,e.store,E);return Fp(N,"left"),Fp(N,"right"),Object.assign({},z,N)},getHeaderCellClass:(o,S,E,I)=>{const R=rC(i.b(),S,I.fixed,e.store,E),z=[I.id,I.order,I.headerAlign,I.className,I.labelClassName,...R];I.children||z.push("is-leaf"),I.sortable&&z.push("is-sortable");const N=t==null?void 0:t.props.headerCellClassName;return Bn(N)?z.push(N):Nn(N)&&z.push(N.call(null,{rowIndex:o,columnIndex:S,row:E,column:I})),z.push(i.e("cell")),z.filter($=>!!$).join(" ")}}}const Xz=e=>{const t=[];return e.forEach(i=>{i.children?(t.push(i),t.push.apply(t,Xz(i.children))):t.push(i)}),t},Jz=e=>{let t=1;const i=(g,_)=>{if(_&&(g.level=_.level+1,t<g.level&&(t=g.level)),g.children){let o=0;g.children.forEach(S=>{i(S,g),o+=S.colSpan}),g.colSpan=o}else g.colSpan=1};e.forEach(g=>{g.level=1,i(g,void 0)});const a=[];for(let g=0;g<t;g++)a.push([]);return Xz(e).forEach(g=>{g.children?(g.rowSpan=1,g.children.forEach(_=>_.isSubColumn=!0)):g.rowSpan=t-g.level+1,a[g.level-1].push(g)}),a};function Xse(e){const t=kn(oc),i=ee(()=>Jz(e.store.states.originColumns.value));return{isGroup:ee(()=>{const g=i.value.length>1;return g&&t&&(t.state.isGroup.value=!0),g}),toggleAllSelection:g=>{g.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:i}}var Jse=qe({name:"ElTableHeader",components:{ElCheckbox:ja},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String}},setup(e,{emit:t}){const i=To(),a=kn(oc),d=Xt("table"),g=xe({}),{onColumnsChange:_,onScrollableChange:o}=Yz(a),S=(a==null?void 0:a.props.tableLayout)==="auto",E=new Map,I=xe(),R=()=>{setTimeout(()=>{E.size>0&&(E.forEach((ce,de)=>{const _e=I.value.querySelector(`.${de.replace(/\s/g,".")}`);if(_e){const Re=_e.getBoundingClientRect().width;ce.width=Re}}),E.clear())})};_o(async()=>{await Un(),await Un();const{prop:ce,order:de}=e.defaultSort;a==null||a.store.commit("sort",{prop:ce,order:de,init:!0}),R()});const{handleHeaderClick:z,handleHeaderContextMenu:N,handleMouseDown:$,handleMouseMove:F,handleMouseOut:W,handleSortClick:U,handleFilterClick:re}=Zse(e,t),{getHeaderRowStyle:K,getHeaderRowClass:q,getHeaderCellStyle:J,getHeaderCellClass:oe}=Yse(e),{isGroup:ae,toggleAllSelection:fe,columnRows:ge}=Xse(e);return i.state={onColumnsChange:_,onScrollableChange:o},i.filterPanels=g,{ns:d,filterPanels:g,onColumnsChange:_,onScrollableChange:o,columnRows:ge,getHeaderRowClass:q,getHeaderRowStyle:K,getHeaderCellClass:oe,getHeaderCellStyle:J,handleHeaderClick:z,handleHeaderContextMenu:N,handleMouseDown:$,handleMouseMove:F,handleMouseOut:W,handleSortClick:U,handleFilterClick:re,isGroup:ae,toggleAllSelection:fe,saveIndexSelection:E,isTableLayoutAuto:S,theadRef:I,updateFixedColumnStyle:R}},render(){const{ns:e,isGroup:t,columnRows:i,getHeaderCellStyle:a,getHeaderCellClass:d,getHeaderRowClass:g,getHeaderRowStyle:_,handleHeaderClick:o,handleHeaderContextMenu:S,handleMouseDown:E,handleMouseMove:I,handleSortClick:R,handleMouseOut:z,store:N,$parent:$,saveIndexSelection:F,isTableLayoutAuto:W}=this;let U=1;return Kn("thead",{ref:"theadRef",class:{[e.is("group")]:t}},i.map((re,K)=>Kn("tr",{class:g(K),key:K,style:_(K)},re.map((q,J)=>{q.rowSpan>U&&(U=q.rowSpan);const oe=d(K,J,re,q);return W&&q.fixed&&F.set(oe,q),Kn("th",{class:oe,colspan:q.colSpan,key:`${q.id}-thead`,rowspan:q.rowSpan,style:a(K,J,re,q),onClick:ae=>{ae.currentTarget.classList.contains("noclick")||o(ae,q)},onContextmenu:ae=>S(ae,q),onMousedown:ae=>E(ae,q),onMousemove:ae=>I(ae,q),onMouseout:z},[Kn("div",{class:["cell",q.filteredValue&&q.filteredValue.length>0?"highlight":""]},[q.renderHeader?q.renderHeader({column:q,$index:J,store:N,_self:$}):q.label,q.sortable&&Kn("span",{onClick:ae=>R(ae,q),class:"caret-wrapper"},[Kn("i",{onClick:ae=>R(ae,q,"ascending"),class:"sort-caret ascending"}),Kn("i",{onClick:ae=>R(ae,q,"descending"),class:"sort-caret descending"})]),q.filterable&&Kn(Kse,{store:N,placement:q.filterPlacement||"bottom-start",appendTo:$.appendFilterPanelTo,column:q,upDataColumn:(ae,fe)=>{q[ae]=fe}},{"filter-icon":()=>q.renderFilterIcon?q.renderFilterIcon({filterOpened:q.filterOpened}):null})])])}))))}});function Ow(e,t,i=.03){return e-t>i}function Qse(e){const t=kn(oc),i=xe(""),a=xe(Kn("div")),d=($,F,W)=>{var U;const re=t,K=Lw($);let q;const J=(U=re==null?void 0:re.vnode.el)==null?void 0:U.dataset.prefix;K&&(q=H3({columns:e.store.states.columns.value},K,J),q&&(re==null||re.emit(`cell-${W}`,F,q,K,$))),re==null||re.emit(`row-${W}`,F,q,$)},g=($,F)=>{d($,F,"dblclick")},_=($,F)=>{e.store.commit("setCurrentRow",F),d($,F,"click")},o=($,F)=>{d($,F,"contextmenu")},S=Qs($=>{e.store.commit("setHoverRow",$)},30),E=Qs(()=>{e.store.commit("setHoverRow",null)},30),I=$=>{const F=window.getComputedStyle($,null),W=Number.parseInt(F.paddingLeft,10)||0,U=Number.parseInt(F.paddingRight,10)||0,re=Number.parseInt(F.paddingTop,10)||0,K=Number.parseInt(F.paddingBottom,10)||0;return{left:W,right:U,top:re,bottom:K}},R=($,F,W)=>{let U=F.target.parentNode;for(;$>1&&(U=U==null?void 0:U.nextSibling,!(!U||U.nodeName!=="TR"));)W(U,"hover-row hover-fixed-row"),$--};return{handleDoubleClick:g,handleClick:_,handleContextMenu:o,handleMouseEnter:S,handleMouseLeave:E,handleCellMouseEnter:($,F,W)=>{var U;const re=t,K=Lw($),q=(U=re==null?void 0:re.vnode.el)==null?void 0:U.dataset.prefix;if(K){const Me=H3({columns:e.store.states.columns.value},K,q);K.rowSpan>1&&R(K.rowSpan,$,Oa);const Te=re.hoverState={cell:K,column:Me,row:F};re==null||re.emit("cell-mouse-enter",Te.row,Te.column,Te.cell,$)}if(!W)return;const J=$.target.querySelector(".cell");if(!(Zs(J,`${q}-tooltip`)&&J.childNodes.length))return;const oe=document.createRange();oe.setStart(J,0),oe.setEnd(J,J.childNodes.length);const{width:ae,height:fe}=oe.getBoundingClientRect(),{width:ge,height:ce}=J.getBoundingClientRect(),{top:de,left:_e,right:Re,bottom:Qe}=I(J),Ee=_e+Re,ye=de+Qe;(Ow(ae+Ee,ge)||Ow(fe+ye,ce)||Ow(J.scrollWidth,ge))&&Ose(W,K.innerText||K.textContent,K,re)},handleCellMouseLeave:$=>{const F=Lw($);if(!F)return;F.rowSpan>1&&R(F.rowSpan,$,ys);const W=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",W==null?void 0:W.row,W==null?void 0:W.column,W==null?void 0:W.cell,$)},tooltipContent:i,tooltipTrigger:a}}function eae(e){const t=kn(oc),i=Xt("table");return{getRowStyle:(E,I)=>{const R=t==null?void 0:t.props.rowStyle;return Nn(R)?R.call(null,{row:E,rowIndex:I}):R||null},getRowClass:(E,I)=>{const R=[i.e("row")];t!=null&&t.props.highlightCurrentRow&&E===e.store.states.currentRow.value&&R.push("current-row"),e.stripe&&I%2===1&&R.push(i.em("row","striped"));const z=t==null?void 0:t.props.rowClassName;return Bn(z)?R.push(z):Nn(z)&&R.push(z.call(null,{row:E,rowIndex:I})),R},getCellStyle:(E,I,R,z)=>{const N=t==null?void 0:t.props.cellStyle;let $=N??{};Nn(N)&&($=N.call(null,{rowIndex:E,columnIndex:I,row:R,column:z}));const F=iC(I,e==null?void 0:e.fixed,e.store);return Fp(F,"left"),Fp(F,"right"),Object.assign({},$,F)},getCellClass:(E,I,R,z,N)=>{const $=rC(i.b(),I,e==null?void 0:e.fixed,e.store,void 0,N),F=[z.id,z.align,z.className,...$],W=t==null?void 0:t.props.cellClassName;return Bn(W)?F.push(W):Nn(W)&&F.push(W.call(null,{rowIndex:E,columnIndex:I,row:R,column:z})),F.push(i.e("cell")),F.filter(U=>!!U).join(" ")},getSpan:(E,I,R,z)=>{let N=1,$=1;const F=t==null?void 0:t.props.spanMethod;if(Nn(F)){const W=F({row:E,column:I,rowIndex:R,columnIndex:z});sn(W)?(N=W[0],$=W[1]):typeof W=="object"&&(N=W.rowspan,$=W.colspan)}return{rowspan:N,colspan:$}},getColspanRealWidth:(E,I,R)=>{if(I<1)return E[R].realWidth;const z=E.map(({realWidth:N,width:$})=>N||$).slice(R,R+I);return Number(z.reduce((N,$)=>Number(N)+Number($),-1))}}}const tae=qe({name:"TableTdWrapper"}),nae=qe({...tae,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(e){return(t,i)=>(se(),Ie("td",{colspan:e.colspan,rowspan:e.rowspan},[vt(t.$slots,"default")],8,["colspan","rowspan"]))}});var oae=fn(nae,[["__file","td-wrapper.vue"]]);function rae(e){const t=kn(oc),i=Xt("table"),{handleDoubleClick:a,handleClick:d,handleContextMenu:g,handleMouseEnter:_,handleMouseLeave:o,handleCellMouseEnter:S,handleCellMouseLeave:E,tooltipContent:I,tooltipTrigger:R}=Qse(e),{getRowStyle:z,getRowClass:N,getCellStyle:$,getCellClass:F,getSpan:W,getColspanRealWidth:U}=eae(e),re=ee(()=>e.store.states.columns.value.findIndex(({type:ae})=>ae==="default")),K=(ae,fe)=>{const ge=t.props.rowKey;return ge?vs(ae,ge):fe},q=(ae,fe,ge,ce=!1)=>{const{tooltipEffect:de,tooltipOptions:_e,store:Re}=e,{indent:Qe,columns:Ee}=Re.states,ye=N(ae,fe);let Me=!0;return ge&&(ye.push(i.em("row",`level-${ge.level}`)),Me=ge.display),Kn("tr",{style:[Me?null:{},z(ae,fe)],class:ye,key:K(ae,fe),onDblclick:he=>a(he,ae),onClick:he=>d(he,ae),onContextmenu:he=>g(he,ae),onMouseenter:()=>_(fe),onMouseleave:o},Ee.value.map((he,ke)=>{const{rowspan:Ne,colspan:nt}=W(ae,he,fe,ke);if(!Ne||!nt)return null;const De=Object.assign({},he);De.realWidth=U(Ee.value,nt,ke);const Ct={store:e.store,_self:e.context||t,column:De,row:ae,$index:fe,cellIndex:ke,expanded:ce};ke===re.value&&ge&&(Ct.treeNode={indent:ge.level*Qe.value,level:ge.level},Lr(ge.expanded)&&(Ct.treeNode.expanded=ge.expanded,"loading"in ge&&(Ct.treeNode.loading=ge.loading),"noLazyChildren"in ge&&(Ct.treeNode.noLazyChildren=ge.noLazyChildren)));const Rt=`${K(ae,fe)},${ke}`,Bt=De.columnKey||De.rawColumnKey||"",mt=he.showOverflowTooltip&&LD({effect:de},_e,he.showOverflowTooltip);return Kn(oae,{style:$(fe,ke,ae,he),class:F(fe,ke,ae,he,nt-1),key:`${Bt}${Rt}`,rowspan:Ne,colspan:nt,onMouseenter:Gt=>S(Gt,ae,mt),onMouseleave:E},{default:()=>J(ke,he,Ct)})}))},J=(ae,fe,ge)=>fe.renderCell(ge);return{wrappedRowRender:(ae,fe)=>{const ge=e.store,{isRowExpanded:ce,assertRowKey:de}=ge,{treeData:_e,lazyTreeNodeMap:Re,childrenColumnName:Qe,rowKey:Ee}=ge.states,ye=ge.states.columns.value;if(ye.some(({type:Te})=>Te==="expand")){const Te=ce(ae),he=q(ae,fe,void 0,Te),ke=t.renderExpanded;return Te?ke?[[he,Kn("tr",{key:`expanded-row__${he.key}`},[Kn("td",{colspan:ye.length,class:`${i.e("cell")} ${i.e("expanded-cell")}`},[ke({row:ae,$index:fe,store:ge,expanded:Te})])])]]:(console.error("[Element Error]renderExpanded is required."),he):[[he]]}else if(Object.keys(_e.value).length){de();const Te=vs(ae,Ee.value);let he=_e.value[Te],ke=null;he&&(ke={expanded:he.expanded,level:he.level,display:!0},Lr(he.lazy)&&(Lr(he.loaded)&&he.loaded&&(ke.noLazyChildren=!(he.children&&he.children.length)),ke.loading=he.loading));const Ne=[q(ae,fe,ke)];if(he){let nt=0;const De=(Rt,Bt)=>{Rt&&Rt.length&&Bt&&Rt.forEach(mt=>{const Gt={display:Bt.display&&Bt.expanded,level:Bt.level+1,expanded:!1,noLazyChildren:!1,loading:!1},jt=vs(mt,Ee.value);if(jt==null)throw new Error("For nested data item, row-key is required.");if(he={..._e.value[jt]},he&&(Gt.expanded=he.expanded,he.level=he.level||Gt.level,he.display=!!(he.expanded&&Gt.display),Lr(he.lazy)&&(Lr(he.loaded)&&he.loaded&&(Gt.noLazyChildren=!(he.children&&he.children.length)),Gt.loading=he.loading)),nt++,Ne.push(q(mt,fe+nt,Gt)),he){const Be=Re.value[jt]||mt[Qe.value];De(Be,he)}})};he.display=!0;const Ct=Re.value[Te]||ae[Qe.value];De(Ct,he)}return Ne}else return q(ae,fe,void 0)},tooltipContent:I,tooltipTrigger:R}}const iae={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var sae=qe({name:"ElTableBody",props:iae,setup(e){const t=To(),i=kn(oc),a=Xt("table"),{wrappedRowRender:d,tooltipContent:g,tooltipTrigger:_}=rae(e),{onColumnsChange:o,onScrollableChange:S}=Yz(i),E=[];return qt(e.store.states.hoverRow,(I,R)=>{var z;const N=t==null?void 0:t.vnode.el,$=Array.from((N==null?void 0:N.children)||[]).filter(U=>U==null?void 0:U.classList.contains(`${a.e("row")}`));let F=I;const W=(z=$[F])==null?void 0:z.childNodes;if(W!=null&&W.length){let U=0;Array.from(W).reduce((K,q,J)=>{var oe,ae;return((oe=W[J])==null?void 0:oe.colSpan)>1&&(U=(ae=W[J])==null?void 0:ae.colSpan),q.nodeName!=="TD"&&U===0&&K.push(J),U>0&&U--,K},[]).forEach(K=>{var q;for(F=I;F>0;){const J=(q=$[F-1])==null?void 0:q.childNodes;if(J[K]&&J[K].nodeName==="TD"&&J[K].rowSpan>1){Oa(J[K],"hover-cell"),E.push(J[K]);break}F--}})}else E.forEach(U=>ys(U,"hover-cell")),E.length=0;!e.store.states.isComplex.value||!Wo||ed(()=>{const U=$[R],re=$[I];U&&!U.classList.contains("hover-fixed-row")&&ys(U,"hover-row"),re&&Oa(re,"hover-row")})}),ld(()=>{var I;(I=Ra)==null||I()}),{ns:a,onColumnsChange:o,onScrollableChange:S,wrappedRowRender:d,tooltipContent:g,tooltipTrigger:_}},render(){const{wrappedRowRender:e,store:t}=this,i=t.states.data.value||[];return Kn("tbody",{tabIndex:-1},[i.reduce((a,d)=>a.concat(e(d,a.length)),[])])}});function aae(){const e=kn(oc),t=e==null?void 0:e.store,i=ee(()=>t.states.fixedLeafColumnsLength.value),a=ee(()=>t.states.rightFixedColumns.value.length),d=ee(()=>t.states.columns.value.length),g=ee(()=>t.states.fixedColumns.value.length),_=ee(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:i,rightFixedLeafCount:a,columnsCount:d,leftFixedCount:g,rightFixedCount:_,columns:t.states.columns}}function lae(e){const{columns:t}=aae(),i=Xt("table");return{getCellClasses:(g,_)=>{const o=g[_],S=[i.e("cell"),o.id,o.align,o.labelClassName,...rC(i.b(),_,o.fixed,e.store)];return o.className&&S.push(o.className),o.children||S.push(i.is("leaf")),S},getCellStyles:(g,_)=>{const o=iC(_,g.fixed,e.store);return Fp(o,"left"),Fp(o,"right"),o},columns:t}}var cae=qe({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const{getCellClasses:t,getCellStyles:i,columns:a}=lae(e);return{ns:Xt("table"),getCellClasses:t,getCellStyles:i,columns:a}},render(){const{columns:e,getCellStyles:t,getCellClasses:i,summaryMethod:a,sumText:d}=this,g=this.store.states.data.value;let _=[];return a?_=a({columns:e,data:g}):e.forEach((o,S)=>{if(S===0){_[S]=d;return}const E=g.map(N=>Number(N[o.property])),I=[];let R=!0;E.forEach(N=>{if(!Number.isNaN(+N)){R=!1;const $=`${N}`.split(".")[1];I.push($?$.length:0)}});const z=Math.max.apply(null,I);R?_[S]="":_[S]=E.reduce((N,$)=>{const F=Number($);return Number.isNaN(+F)?N:Number.parseFloat((N+$).toFixed(Math.min(z,20)))},0)}),Kn(Kn("tfoot",[Kn("tr",{},[...e.map((o,S)=>Kn("td",{key:S,colspan:o.colSpan,rowspan:o.rowSpan,class:i(e,S),style:t(o,S)},[Kn("div",{class:["cell",o.labelClassName]},[_[S]])]))])]))}});function uae(e){return{setCurrentRow:R=>{e.commit("setCurrentRow",R)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(R,z,N=!0)=>{e.toggleRowSelection(R,z,!1,N),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:R=>{e.clearFilter(R)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(R,z)=>{e.toggleRowExpansionAdapter(R,z)},clearSort:()=>{e.clearSort()},sort:(R,z)=>{e.commit("sort",{prop:R,order:z})},updateKeyChildren:(R,z)=>{e.updateKeyChildren(R,z)}}}function dae(e,t,i,a){const d=xe(!1),g=xe(null),_=xe(!1),o=Te=>{_.value=Te},S=xe({width:null,height:null,headerHeight:null}),E=xe(!1),I={display:"inline-block",verticalAlign:"middle"},R=xe(),z=xe(0),N=xe(0),$=xe(0),F=xe(0),W=xe(0);ns(()=>{t.setHeight(e.height)}),ns(()=>{t.setMaxHeight(e.maxHeight)}),qt(()=>[e.currentRowKey,i.states.rowKey],([Te,he])=>{!y(he)||!y(Te)||i.setCurrentRowKey(`${Te}`)},{immediate:!0}),qt(()=>e.data,Te=>{a.store.commit("setData",Te)},{immediate:!0,deep:!0}),ns(()=>{e.expandRowKeys&&i.setExpandRowKeysAdapter(e.expandRowKeys)});const U=()=>{a.store.commit("setHoverRow",null),a.hoverState&&(a.hoverState=null)},re=(Te,he)=>{const{pixelX:ke,pixelY:Ne}=he;Math.abs(ke)>=Math.abs(Ne)&&(a.refs.bodyWrapper.scrollLeft+=he.pixelX/5)},K=ee(()=>e.height||e.maxHeight||i.states.fixedColumns.value.length>0||i.states.rightFixedColumns.value.length>0),q=ee(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),J=()=>{K.value&&t.updateElsHeight(),t.updateColumnsWidth(),requestAnimationFrame(ge)};_o(async()=>{await Un(),i.updateColumns(),ce(),requestAnimationFrame(J);const Te=a.vnode.el,he=a.refs.headerWrapper;e.flexible&&Te&&Te.parentElement&&(Te.parentElement.style.minWidth="0"),S.value={width:R.value=Te.offsetWidth,height:Te.offsetHeight,headerHeight:e.showHeader&&he?he.offsetHeight:null},i.states.columns.value.forEach(ke=>{ke.filteredValue&&ke.filteredValue.length&&a.store.commit("filterChange",{column:ke,values:ke.filteredValue,silent:!0})}),a.$ready=!0});const oe=(Te,he)=>{if(!Te)return;const ke=Array.from(Te.classList).filter(Ne=>!Ne.startsWith("is-scrolling-"));ke.push(t.scrollX.value?he:"is-scrolling-none"),Te.className=ke.join(" ")},ae=Te=>{const{tableWrapper:he}=a.refs;oe(he,Te)},fe=Te=>{const{tableWrapper:he}=a.refs;return!!(he&&he.classList.contains(Te))},ge=function(){if(!a.refs.scrollBarRef)return;if(!t.scrollX.value){const Rt="is-scrolling-none";fe(Rt)||ae(Rt);return}const Te=a.refs.scrollBarRef.wrapRef;if(!Te)return;const{scrollLeft:he,offsetWidth:ke,scrollWidth:Ne}=Te,{headerWrapper:nt,footerWrapper:De}=a.refs;nt&&(nt.scrollLeft=he),De&&(De.scrollLeft=he);const Ct=Ne-ke-1;he>=Ct?ae("is-scrolling-right"):ae(he===0?"is-scrolling-left":"is-scrolling-middle")},ce=()=>{a.refs.scrollBarRef&&(a.refs.scrollBarRef.wrapRef&&wr(a.refs.scrollBarRef.wrapRef,"scroll",ge,{passive:!0}),e.fit?ei(a.vnode.el,de):wr(window,"resize",de),ei(a.refs.bodyWrapper,()=>{var Te,he;de(),(he=(Te=a.refs)==null?void 0:Te.scrollBarRef)==null||he.update()}))},de=()=>{var Te,he,ke,Ne;const nt=a.vnode.el;if(!a.$ready||!nt)return;let De=!1;const{width:Ct,height:Rt,headerHeight:Bt}=S.value,mt=R.value=nt.offsetWidth;Ct!==mt&&(De=!0);const Gt=nt.offsetHeight;(e.height||K.value)&&Rt!==Gt&&(De=!0);const jt=e.tableLayout==="fixed"?a.refs.headerWrapper:(Te=a.refs.tableHeaderRef)==null?void 0:Te.$el;e.showHeader&&(jt==null?void 0:jt.offsetHeight)!==Bt&&(De=!0),z.value=((he=a.refs.tableWrapper)==null?void 0:he.scrollHeight)||0,$.value=(jt==null?void 0:jt.scrollHeight)||0,F.value=((ke=a.refs.footerWrapper)==null?void 0:ke.offsetHeight)||0,W.value=((Ne=a.refs.appendWrapper)==null?void 0:Ne.offsetHeight)||0,N.value=z.value-$.value-F.value-W.value,De&&(S.value={width:mt,height:Gt,headerHeight:e.showHeader&&(jt==null?void 0:jt.offsetHeight)||0},J())},_e=Mi(),Re=ee(()=>{const{bodyWidth:Te,scrollY:he,gutterWidth:ke}=t;return Te.value?`${Te.value-(he.value?ke:0)}px`:""}),Qe=ee(()=>e.maxHeight?"fixed":e.tableLayout),Ee=ee(()=>{if(e.data&&e.data.length)return null;let Te="100%";e.height&&N.value&&(Te=`${N.value}px`);const he=R.value;return{width:he?`${he}px`:"",height:Te}}),ye=ee(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${$.value+F.value}px)`}:{maxHeight:`${e.maxHeight-$.value-F.value}px`}:{});return{isHidden:d,renderExpanded:g,setDragVisible:o,isGroup:E,handleMouseLeave:U,handleHeaderFooterMousewheel:re,tableSize:_e,emptyBlockStyle:Ee,handleFixedMousewheel:(Te,he)=>{const ke=a.refs.bodyWrapper;if(Math.abs(he.spinY)>0){const Ne=ke.scrollTop;he.pixelY<0&&Ne!==0&&Te.preventDefault(),he.pixelY>0&&ke.scrollHeight-ke.clientHeight>Ne&&Te.preventDefault(),ke.scrollTop+=Math.ceil(he.pixelY/5)}else ke.scrollLeft+=Math.ceil(he.pixelX/5)},resizeProxyVisible:_,bodyWidth:Re,resizeState:S,doLayout:J,tableBodyStyles:q,tableLayout:Qe,scrollbarViewStyle:I,scrollbarStyle:ye}}function hae(e){const t=xe(),i=()=>{const d=e.vnode.el.querySelector(".hidden-columns"),g={childList:!0,subtree:!0},_=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{_.forEach(o=>o())}),t.value.observe(d,g)};_o(()=>{i()}),ld(()=>{var a;(a=t.value)==null||a.disconnect()})}var fae={data:{type:Array,default:()=>[]},size:ki,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0}};function Qz(e){const t=e.tableLayout==="auto";let i=e.columns||[];t&&i.every(d=>d.width===void 0)&&(i=[]);const a=d=>{const g={key:`${e.tableLayout}_${d.id}`,style:{},name:void 0};return t?g.style={width:`${d.width}px`}:g.name=d.id,g};return Kn("colgroup",{},i.map(d=>Kn("col",a(d))))}Qz.props=["columns","tableLayout"];const pae=()=>{const e=xe(),t=(g,_)=>{const o=e.value;o&&o.scrollTo(g,_)},i=(g,_)=>{const o=e.value;o&&Wn(_)&&["Top","Left"].includes(g)&&o[`setScroll${g}`](_)};return{scrollBarRef:e,scrollTo:t,setScrollTop:g=>i("Top",g),setScrollLeft:g=>i("Left",g)}};let mae=1;const gae=qe({name:"ElTable",directives:{Mousewheel:zY},components:{TableHeader:Jse,TableBody:sae,TableFooter:cae,ElScrollbar:nc,hColgroup:Qz},props:fae,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(e){const{t}=qo(),i=Xt("table"),a=To();Bo(oc,a);const d=Use(a,e);a.store=d;const g=new Hse({store:a.store,table:a,fit:e.fit,showHeader:e.showHeader});a.layout=g;const _=ee(()=>(d.states.data.value||[]).length===0),{setCurrentRow:o,getSelectionRows:S,toggleRowSelection:E,clearSelection:I,clearFilter:R,toggleAllSelection:z,toggleRowExpansion:N,clearSort:$,sort:F,updateKeyChildren:W}=uae(d),{isHidden:U,renderExpanded:re,setDragVisible:K,isGroup:q,handleMouseLeave:J,handleHeaderFooterMousewheel:oe,tableSize:ae,emptyBlockStyle:fe,handleFixedMousewheel:ge,resizeProxyVisible:ce,bodyWidth:de,resizeState:_e,doLayout:Re,tableBodyStyles:Qe,tableLayout:Ee,scrollbarViewStyle:ye,scrollbarStyle:Me}=dae(e,g,d,a),{scrollBarRef:Te,scrollTo:he,setScrollLeft:ke,setScrollTop:Ne}=pae(),nt=Qs(Re,50),De=`${i.namespace.value}-table_${mae++}`;a.tableId=De,a.state={isGroup:q,resizeState:_e,doLayout:Re,debouncedUpdateLayout:nt};const Ct=ee(()=>{var mt;return(mt=e.sumText)!=null?mt:t("el.table.sumText")}),Rt=ee(()=>{var mt;return(mt=e.emptyText)!=null?mt:t("el.table.emptyText")}),Bt=ee(()=>Jz(d.states.originColumns.value)[0]);return hae(a),Pr(()=>{nt.cancel()}),{ns:i,layout:g,store:d,columns:Bt,handleHeaderFooterMousewheel:oe,handleMouseLeave:J,tableId:De,tableSize:ae,isHidden:U,isEmpty:_,renderExpanded:re,resizeProxyVisible:ce,resizeState:_e,isGroup:q,bodyWidth:de,tableBodyStyles:Qe,emptyBlockStyle:fe,debouncedUpdateLayout:nt,handleFixedMousewheel:ge,setCurrentRow:o,getSelectionRows:S,toggleRowSelection:E,clearSelection:I,clearFilter:R,toggleAllSelection:z,toggleRowExpansion:N,clearSort:$,doLayout:Re,sort:F,updateKeyChildren:W,t,setDragVisible:K,context:a,computedSumText:Ct,computedEmptyText:Rt,tableLayout:Ee,scrollbarViewStyle:ye,scrollbarStyle:Me,scrollBarRef:Te,scrollTo:he,setScrollLeft:ke,setScrollTop:Ne}}});function vae(e,t,i,a,d,g){const _=Mo("hColgroup"),o=Mo("table-header"),S=Mo("table-body"),E=Mo("table-footer"),I=Mo("el-scrollbar"),R=zb("mousewheel");return se(),Ie("div",{ref:"tableWrapper",class:ue([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:$n(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:e.handleMouseLeave},[je("div",{class:ue(e.ns.e("inner-wrapper"))},[je("div",{ref:"hiddenColumns",class:"hidden-columns"},[vt(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?vo((se(),Ie("div",{key:0,ref:"headerWrapper",class:ue(e.ns.e("header-wrapper"))},[je("table",{ref:"tableHeader",class:ue(e.ns.e("header")),style:$n(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[Ye(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Ye(o,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","onSetDragVisible"])],6)],2)),[[R,e.handleHeaderFooterMousewheel]]):yt("v-if",!0),je("div",{ref:"bodyWrapper",class:ue(e.ns.e("body-wrapper"))},[Ye(I,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn,tabindex:e.scrollbarTabindex},{default:it(()=>[je("table",{ref:"tableBody",class:ue(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:$n({width:e.bodyWidth,tableLayout:e.tableLayout})},[Ye(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(se(),Et(o,{key:0,ref:"tableHeaderRef",class:ue(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):yt("v-if",!0),Ye(S,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(se(),Et(E,{key:1,class:ue(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):yt("v-if",!0)],6),e.isEmpty?(se(),Ie("div",{key:0,ref:"emptyBlock",style:$n(e.emptyBlockStyle),class:ue(e.ns.e("empty-block"))},[je("span",{class:ue(e.ns.e("empty-text"))},[vt(e.$slots,"empty",{},()=>[$o(mn(e.computedEmptyText),1)])],2)],6)):yt("v-if",!0),e.$slots.append?(se(),Ie("div",{key:1,ref:"appendWrapper",class:ue(e.ns.e("append-wrapper"))},[vt(e.$slots,"append")],2)):yt("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex"])],2),e.showSummary&&e.tableLayout==="fixed"?vo((se(),Ie("div",{key:1,ref:"footerWrapper",class:ue(e.ns.e("footer-wrapper"))},[je("table",{class:ue(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:$n(e.tableBodyStyles)},[Ye(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Ye(E,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[ir,!e.isEmpty],[R,e.handleHeaderFooterMousewheel]]):yt("v-if",!0),e.border||e.isGroup?(se(),Ie("div",{key:2,class:ue(e.ns.e("border-left-patch"))},null,2)):yt("v-if",!0)],2),vo(je("div",{ref:"resizeProxy",class:ue(e.ns.e("column-resize-proxy"))},null,2),[[ir,e.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var _ae=fn(gae,[["render",vae],["__file","table.vue"]]);const yae={selection:"table-column--selection",expand:"table__expand-column"},bae={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},xae=e=>yae[e]||"",wae={selection:{renderHeader({store:e,column:t}){function i(){return e.states.data.value&&e.states.data.value.length===0}return Kn(ja,{disabled:i(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:i,$index:a}){return Kn(ja,{disabled:t.selectable?!t.selectable.call(null,e,a):!1,size:i.states.tableSize.value,onChange:()=>{i.commit("rowSelectedChanged",e)},onClick:d=>d.stopPropagation(),modelValue:i.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let i=t+1;const a=e.index;return Wn(a)?i=t+a:Nn(a)&&(i=a(t)),Kn("div",{},[i])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:i}){const{ns:a}=t,d=[a.e("expand-icon")];return i&&d.push(a.em("expand-icon","expanded")),Kn("div",{class:d,onClick:function(_){_.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[Kn(Dn,null,{default:()=>[Kn(Fs)]})]})},sortable:!1,resizable:!1}};function Sae({row:e,column:t,$index:i}){var a;const d=t.property,g=d&&D0(e,d).value;return t&&t.formatter?t.formatter(e,t,g,i):((a=g==null?void 0:g.toString)==null?void 0:a.call(g))||""}function Tae({row:e,treeNode:t,store:i},a=!1){const{ns:d}=i;if(!t)return a?[Kn("span",{class:d.e("placeholder")})]:null;const g=[],_=function(o){o.stopPropagation(),!t.loading&&i.loadOrToggle(e)};if(t.indent&&g.push(Kn("span",{class:d.e("indent"),style:{"padding-left":`${t.indent}px`}})),Lr(t.expanded)&&!t.noLazyChildren){const o=[d.e("expand-icon"),t.expanded?d.em("expand-icon","expanded"):""];let S=Fs;t.loading&&(S=ql),g.push(Kn("div",{class:o,onClick:_},{default:()=>[Kn(Dn,{class:{[d.is("loading")]:t.loading}},{default:()=>[Kn(S)]})]}))}else g.push(Kn("span",{class:d.e("placeholder")}));return g}function K3(e,t){return e.reduce((i,a)=>(i[a]=a,i),t)}function Cae(e,t){const i=To();return{registerComplexWatchers:()=>{const g=["fixed"],_={realWidth:"width",realMinWidth:"minWidth"},o=K3(g,_);Object.keys(o).forEach(S=>{const E=_[S];or(t,E)&&qt(()=>t[E],I=>{let R=I;E==="width"&&S==="realWidth"&&(R=oC(I)),E==="minWidth"&&S==="realMinWidth"&&(R=Gz(I)),i.columnConfig.value[E]=R,i.columnConfig.value[S]=R;const z=E==="fixed";e.value.store.scheduleLayout(z)})})},registerNormalWatchers:()=>{const g=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],_={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},o=K3(g,_);Object.keys(o).forEach(S=>{const E=_[S];or(t,E)&&qt(()=>t[E],I=>{i.columnConfig.value[S]=I})})}}}function Eae(e,t,i){const a=To(),d=xe(""),g=xe(!1),_=xe(),o=xe(),S=Xt("table");ns(()=>{_.value=e.align?`is-${e.align}`:null,_.value}),ns(()=>{o.value=e.headerAlign?`is-${e.headerAlign}`:_.value,o.value});const E=ee(()=>{let q=a.vnode.vParent||a.parent;for(;q&&!q.tableId&&!q.columnId;)q=q.vnode.vParent||q.parent;return q}),I=ee(()=>{const{store:q}=a.parent;if(!q)return!1;const{treeData:J}=q.states,oe=J.value;return oe&&Object.keys(oe).length>0}),R=xe(oC(e.width)),z=xe(Gz(e.minWidth)),N=q=>(R.value&&(q.width=R.value),z.value&&(q.minWidth=z.value),!R.value&&z.value&&(q.width=void 0),q.minWidth||(q.minWidth=80),q.realWidth=Number(q.width===void 0?q.minWidth:q.width),q),$=q=>{const J=q.type,oe=wae[J]||{};Object.keys(oe).forEach(fe=>{const ge=oe[fe];fe!=="className"&&ge!==void 0&&(q[fe]=ge)});const ae=xae(J);if(ae){const fe=`${y(S.namespace)}-${ae}`;q.className=q.className?`${q.className} ${fe}`:fe}return q},F=q=>{sn(q)?q.forEach(oe=>J(oe)):J(q);function J(oe){var ae;((ae=oe==null?void 0:oe.type)==null?void 0:ae.name)==="ElTableColumn"&&(oe.vParent=a)}};return{columnId:d,realAlign:_,isSubColumn:g,realHeaderAlign:o,columnOrTableParent:E,setColumnWidth:N,setColumnForcedProps:$,setColumnRenders:q=>{e.renderHeader||q.type!=="selection"&&(q.renderHeader=oe=>(a.columnConfig.value.label,vt(t,"header",oe,()=>[q.label]))),t["filter-icon"]&&(q.renderFilterIcon=oe=>vt(t,"filter-icon",oe));let J=q.renderCell;return q.type==="expand"?(q.renderCell=oe=>Kn("div",{class:"cell"},[J(oe)]),i.value.renderExpanded=oe=>t.default?t.default(oe):t.default):(J=J||Sae,q.renderCell=oe=>{let ae=null;if(t.default){const Re=t.default(oe);ae=Re.some(Qe=>Qe.type!==Ni)?Re:J(oe)}else ae=J(oe);const{columns:fe}=i.value.store.states,ge=fe.value.findIndex(Re=>Re.type==="default"),ce=I.value&&oe.cellIndex===ge,de=Tae(oe,ce),_e={class:"cell",style:{}};return q.showOverflowTooltip&&(_e.class=`${_e.class} ${y(S.namespace)}-tooltip`,_e.style={width:`${(oe.column.realWidth||Number(oe.column.width))-1}px`}),F(ae),Kn("div",_e,[de,ae])}),q},getPropsData:(...q)=>q.reduce((J,oe)=>(sn(oe)&&oe.forEach(ae=>{J[ae]=e[ae]}),J),{}),getColumnElIndex:(q,J)=>Array.prototype.indexOf.call(q,J),updateColumnOrder:()=>{i.value.store.commit("updateColumnOrder",a.columnConfig.value)}}}var Mae={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let Iae=1;var e4=qe({name:"ElTableColumn",components:{ElCheckbox:ja},props:Mae,setup(e,{slots:t}){const i=To(),a=xe({}),d=ee(()=>{let K=i.parent;for(;K&&!K.tableId;)K=K.parent;return K}),{registerNormalWatchers:g,registerComplexWatchers:_}=Cae(d,e),{columnId:o,isSubColumn:S,realHeaderAlign:E,columnOrTableParent:I,setColumnWidth:R,setColumnForcedProps:z,setColumnRenders:N,getPropsData:$,getColumnElIndex:F,realAlign:W,updateColumnOrder:U}=Eae(e,t,d),re=I.value;o.value=`${re.tableId||re.columnId}_column_${Iae++}`,Ob(()=>{S.value=d.value!==re;const K=e.type||"default",q=e.sortable===""?!0:e.sortable,J=jr(e.showOverflowTooltip)?re.props.showOverflowTooltip:e.showOverflowTooltip,oe={...bae[K],id:o.value,type:K,property:e.prop||e.property,align:W,headerAlign:E,showOverflowTooltip:J,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:q,index:e.index,rawColumnKey:i.vnode.key};let de=$(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);de=Pse(oe,de),de=Dse(N,R,z)(de),a.value=de,g(),_()}),_o(()=>{var K;const q=I.value,J=S.value?q.vnode.el.children:(K=q.refs.hiddenColumns)==null?void 0:K.children,oe=()=>F(J||[],i.vnode.el);a.value.getColumnIndex=oe,oe()>-1&&d.value.store.commit("insertColumn",a.value,S.value?q.columnConfig.value:null,U)}),Pr(()=>{const K=a.value.getColumnIndex;(K?K():-1)>-1&&d.value.store.commit("removeColumn",a.value,S.value?re.columnConfig.value:null,U)}),i.columnId=o.value,i.columnConfig=a},render(){var e,t,i;try{const a=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),d=[];if(sn(a))for(const _ of a)((i=_.type)==null?void 0:i.name)==="ElTableColumn"||_.shapeFlag&2?d.push(_):_.type===Fn&&sn(_.children)&&_.children.forEach(o=>{(o==null?void 0:o.patchFlag)!==1024&&!Bn(o==null?void 0:o.children)&&d.push(o)});return Kn("div",d)}catch{return Kn("div",[])}}});const Aae=uo(_ae,{TableColumn:e4}),kae=ri(e4);var Wv=(e=>(e.ASC="asc",e.DESC="desc",e))(Wv||{}),qv=(e=>(e.CENTER="center",e.RIGHT="right",e))(qv||{}),t4=(e=>(e.LEFT="left",e.RIGHT="right",e))(t4||{});const tS={asc:"desc",desc:"asc"},Kv=Symbol("placeholder"),Pae=(e,t,i)=>{var a;const d={flexGrow:0,flexShrink:0,...i?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};i||(d.flexShrink=1);const g={...(a=e.style)!=null?a:{},...d,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(g.maxWidth=e.maxWidth),e.minWidth&&(g.minWidth=e.minWidth)),g};function Rae(e,t,i){const a=ee(()=>y(t).map((W,U)=>{var re,K;return{...W,key:(K=(re=W.key)!=null?re:W.dataKey)!=null?K:U}})),d=ee(()=>y(a).filter(W=>!W.hidden)),g=ee(()=>y(d).filter(W=>W.fixed==="left"||W.fixed===!0)),_=ee(()=>y(d).filter(W=>W.fixed==="right")),o=ee(()=>y(d).filter(W=>!W.fixed)),S=ee(()=>{const W=[];return y(g).forEach(U=>{W.push({...U,placeholderSign:Kv})}),y(o).forEach(U=>{W.push(U)}),y(_).forEach(U=>{W.push({...U,placeholderSign:Kv})}),W}),E=ee(()=>y(g).length||y(_).length),I=ee(()=>y(a).reduce((W,U)=>(W[U.key]=Pae(U,y(i),e.fixed),W),{})),R=ee(()=>y(d).reduce((W,U)=>W+U.width,0)),z=W=>y(a).find(U=>U.key===W),N=W=>y(I)[W],$=(W,U)=>{W.width=U};function F(W){var U;const{key:re}=W.currentTarget.dataset;if(!re)return;const{sortState:K,sortBy:q}=e;let J=Wv.ASC;So(K)?J=tS[K[re]]:J=tS[q.order],(U=e.onColumnSort)==null||U.call(e,{column:z(re),key:re,order:J})}return{columns:a,columnsStyles:I,columnsTotalWidth:R,fixedColumnsOnLeft:g,fixedColumnsOnRight:_,hasFixedColumns:E,mainColumns:S,normalColumns:o,visibleColumns:d,getColumn:z,getColumnStyle:N,updateColumnWidth:$,onColumnSorted:F}}const Dae=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,onMaybeEndReached:d})=>{const g=xe({scrollLeft:0,scrollTop:0});function _(N){var $,F,W;const{scrollTop:U}=N;($=t.value)==null||$.scrollTo(N),(F=i.value)==null||F.scrollToTop(U),(W=a.value)==null||W.scrollToTop(U)}function o(N){g.value=N,_(N)}function S(N){g.value.scrollTop=N,_(y(g))}function E(N){var $,F;g.value.scrollLeft=N,(F=($=t.value)==null?void 0:$.scrollTo)==null||F.call($,y(g))}function I(N){var $;o(N),($=e.onScroll)==null||$.call(e,N)}function R({scrollTop:N}){const{scrollTop:$}=y(g);N!==$&&S(N)}function z(N,$="auto"){var F;(F=t.value)==null||F.scrollToRow(N,$)}return qt(()=>y(g).scrollTop,(N,$)=>{N>$&&d()}),{scrollPos:g,scrollTo:o,scrollToLeft:E,scrollToTop:S,scrollToRow:z,onScroll:I,onVerticalScroll:R}},Lae=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,tableInstance:d,ns:g,isScrolling:_})=>{const o=To(),{emit:S}=o,E=qr(!1),I=xe(e.defaultExpandedRowKeys||[]),R=xe(-1),z=qr(null),N=xe({}),$=xe({}),F=qr({}),W=qr({}),U=qr({}),re=ee(()=>Wn(e.estimatedRowHeight));function K(ce){var de;(de=e.onRowsRendered)==null||de.call(e,ce),ce.rowCacheEnd>y(R)&&(R.value=ce.rowCacheEnd)}function q({hovered:ce,rowKey:de}){if(_.value)return;d.vnode.el.querySelectorAll(`[rowkey="${String(de)}"]`).forEach(Qe=>{ce?Qe.classList.add(g.is("hovered")):Qe.classList.remove(g.is("hovered"))})}function J({expanded:ce,rowData:de,rowIndex:_e,rowKey:Re}){var Qe,Ee;const ye=[...y(I)],Me=ye.indexOf(Re);ce?Me===-1&&ye.push(Re):Me>-1&&ye.splice(Me,1),I.value=ye,S("update:expandedRowKeys",ye),(Qe=e.onRowExpand)==null||Qe.call(e,{expanded:ce,rowData:de,rowIndex:_e,rowKey:Re}),(Ee=e.onExpandedRowsChange)==null||Ee.call(e,ye)}const oe=Qs(()=>{var ce,de,_e,Re;E.value=!0,N.value={...y(N),...y($)},ae(y(z),!1),$.value={},z.value=null,(ce=t.value)==null||ce.forceUpdate(),(de=i.value)==null||de.forceUpdate(),(_e=a.value)==null||_e.forceUpdate(),(Re=o.proxy)==null||Re.$forceUpdate(),E.value=!1},0);function ae(ce,de=!1){y(re)&&[t,i,a].forEach(_e=>{const Re=y(_e);Re&&Re.resetAfterRowIndex(ce,de)})}function fe(ce,de,_e){const Re=y(z);(Re===null||Re>_e)&&(z.value=_e),$.value[ce]=de}function ge({rowKey:ce,height:de,rowIndex:_e},Re){Re?Re===t4.RIGHT?U.value[ce]=de:F.value[ce]=de:W.value[ce]=de;const Qe=Math.max(...[F,U,W].map(Ee=>Ee.value[ce]||0));y(N)[ce]!==Qe&&(fe(ce,Qe,_e),oe())}return{expandedRowKeys:I,lastRenderedRowIndex:R,isDynamic:re,isResetting:E,rowHeights:N,resetAfterIndex:ae,onRowExpanded:J,onRowHovered:q,onRowsRendered:K,onRowHeightChange:ge}},Oae=(e,{expandedRowKeys:t,lastRenderedRowIndex:i,resetAfterIndex:a})=>{const d=xe({}),g=ee(()=>{const o={},{data:S,rowKey:E}=e,I=y(t);if(!I||!I.length)return S;const R=[],z=new Set;I.forEach($=>z.add($));let N=S.slice();for(N.forEach($=>o[$[E]]=0);N.length>0;){const $=N.shift();R.push($),z.has($[E])&&sn($.children)&&$.children.length>0&&(N=[...$.children,...N],$.children.forEach(F=>o[F[E]]=o[$[E]]+1))}return d.value=o,R}),_=ee(()=>{const{data:o,expandColumnKey:S}=e;return S?y(g):o});return qt(_,(o,S)=>{o!==S&&(i.value=-1,a(0,!0))}),{data:_,depthMap:d}},zae=(e,t)=>e+t,U0=e=>sn(e)?e.reduce(zae,0):e,kh=(e,t,i={})=>Nn(e)?e(t):e??i,Hu=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=fi(e[t])}),e),n4=e=>Yr(e)?t=>Kn(e,t):e,Bae=(e,{columnsTotalWidth:t,data:i,fixedColumnsOnLeft:a,fixedColumnsOnRight:d})=>{const g=ee(()=>{const{fixed:K,width:q,vScrollbarSize:J}=e,oe=q-J;return K?Math.max(Math.round(y(t)),oe):oe}),_=ee(()=>y(g)+e.vScrollbarSize),o=ee(()=>{const{height:K=0,maxHeight:q=0,footerHeight:J,hScrollbarSize:oe}=e;if(q>0){const ae=y($),fe=y(S),ce=y(N)+ae+fe+oe;return Math.min(ce,q-J)}return K-J}),S=ee(()=>{const{rowHeight:K,estimatedRowHeight:q}=e,J=y(i);return Wn(q)?J.length*q:J.length*K}),E=ee(()=>{const{maxHeight:K}=e,q=y(o);if(Wn(K)&&K>0)return q;const J=y(S)+y(N)+y($);return Math.min(q,J)}),I=K=>K.width,R=ee(()=>U0(y(a).map(I))),z=ee(()=>U0(y(d).map(I))),N=ee(()=>U0(e.headerHeight)),$=ee(()=>{var K;return(((K=e.fixedData)==null?void 0:K.length)||0)*e.rowHeight}),F=ee(()=>y(o)-y(N)-y($)),W=ee(()=>{const{style:K={},height:q,width:J}=e;return Hu({...K,height:q,width:J})}),U=ee(()=>Hu({height:e.footerHeight})),re=ee(()=>({top:fi(y(N)),bottom:fi(e.footerHeight),width:fi(e.width)}));return{bodyWidth:g,fixedTableHeight:E,mainTableHeight:o,leftTableWidth:R,rightTableWidth:z,headerWidth:_,rowsHeight:S,windowHeight:F,footerHeight:U,emptyStyle:re,rootStyle:W,headerHeight:N}},Fae=e=>{const t=xe(),i=xe(0),a=xe(0);let d;return _o(()=>{d=ei(t,([g])=>{const{width:_,height:o}=g.contentRect,{paddingLeft:S,paddingRight:E,paddingTop:I,paddingBottom:R}=getComputedStyle(g.target),z=Number.parseInt(S)||0,N=Number.parseInt(E)||0,$=Number.parseInt(I)||0,F=Number.parseInt(R)||0;i.value=_-z-N,a.value=o-$-F}).stop}),Pr(()=>{d==null||d()}),qt([i,a],([g,_])=>{var o;(o=e.onResize)==null||o.call(e,{width:g,height:_})}),{sizer:t,width:i,height:a}};function Nae(e){const t=xe(),i=xe(),a=xe(),{columns:d,columnsStyles:g,columnsTotalWidth:_,fixedColumnsOnLeft:o,fixedColumnsOnRight:S,hasFixedColumns:E,mainColumns:I,onColumnSorted:R}=Rae(e,mr(e,"columns"),mr(e,"fixed")),{scrollTo:z,scrollToLeft:N,scrollToTop:$,scrollToRow:F,onScroll:W,onVerticalScroll:U,scrollPos:re}=Dae(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,onMaybeEndReached:Ge}),K=Xt("table-v2"),q=To(),J=qr(!1),{expandedRowKeys:oe,lastRenderedRowIndex:ae,isDynamic:fe,isResetting:ge,rowHeights:ce,resetAfterIndex:de,onRowExpanded:_e,onRowHeightChange:Re,onRowHovered:Qe,onRowsRendered:Ee}=Lae(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,tableInstance:q,ns:K,isScrolling:J}),{data:ye,depthMap:Me}=Oae(e,{expandedRowKeys:oe,lastRenderedRowIndex:ae,resetAfterIndex:de}),{bodyWidth:Te,fixedTableHeight:he,mainTableHeight:ke,leftTableWidth:Ne,rightTableWidth:nt,headerWidth:De,rowsHeight:Ct,windowHeight:Rt,footerHeight:Bt,emptyStyle:mt,rootStyle:Gt,headerHeight:jt}=Bae(e,{columnsTotalWidth:_,data:ye,fixedColumnsOnLeft:o,fixedColumnsOnRight:S}),Be=xe(),an=ee(()=>{const Fe=y(ye).length===0;return sn(e.fixedData)?e.fixedData.length===0&&Fe:Fe});function At(Fe){const{estimatedRowHeight:Nt,rowHeight:Jt,rowKey:Dt}=e;return Nt?y(ce)[y(ye)[Fe][Dt]]||Nt:Jt}function Ge(){const{onEndReached:Fe}=e;if(!Fe)return;const{scrollTop:Nt}=y(re),Jt=y(Ct),Dt=y(Rt),xt=Jt-(Nt+Dt)+e.hScrollbarSize;y(ae)>=0&&Jt===Nt+y(ke)-y(jt)&&Fe(xt)}return qt(()=>e.expandedRowKeys,Fe=>oe.value=Fe,{deep:!0}),{columns:d,containerRef:Be,mainTableRef:t,leftTableRef:i,rightTableRef:a,isDynamic:fe,isResetting:ge,isScrolling:J,hasFixedColumns:E,columnsStyles:g,columnsTotalWidth:_,data:ye,expandedRowKeys:oe,depthMap:Me,fixedColumnsOnLeft:o,fixedColumnsOnRight:S,mainColumns:I,bodyWidth:Te,emptyStyle:mt,rootStyle:Gt,headerWidth:De,footerHeight:Bt,mainTableHeight:ke,fixedTableHeight:he,leftTableWidth:Ne,rightTableWidth:nt,showEmpty:an,getRowHeight:At,onColumnSorted:R,onRowHovered:Qe,onRowExpanded:_e,onRowsRendered:Ee,onRowHeightChange:Re,scrollTo:z,scrollToLeft:N,scrollToTop:$,scrollToRow:F,onScroll:W,onVerticalScroll:U}}const sC=Symbol("tableV2"),o4=String,f_={type:at(Array),required:!0},aC={type:at(Array)},r4={...aC,required:!0},$ae=String,Z3={type:at(Array),default:()=>oi([])},lh={type:Number,required:!0},i4={type:at([String,Number,Symbol]),default:"id"},Y3={type:at(Object)},ph=cn({class:String,columns:f_,columnsStyles:{type:at(Object),required:!0},depth:Number,expandColumnKey:$ae,estimatedRowHeight:{...yh.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:at(Function)},onRowHover:{type:at(Function)},onRowHeightChange:{type:at(Function)},rowData:{type:at(Object),required:!0},rowEventHandlers:{type:at(Object)},rowIndex:{type:Number,required:!0},rowKey:i4,style:{type:at(Object)}}),zw={type:Number,required:!0},lC=cn({class:String,columns:f_,fixedHeaderData:{type:at(Array)},headerData:{type:at(Array),required:!0},headerHeight:{type:at([Number,Array]),default:50},rowWidth:zw,rowHeight:{type:Number,default:50},height:zw,width:zw}),j0=cn({columns:f_,data:r4,fixedData:aC,estimatedRowHeight:ph.estimatedRowHeight,width:lh,height:lh,headerWidth:lh,headerHeight:lC.headerHeight,bodyWidth:lh,rowHeight:lh,cache:Ez.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:yh.scrollbarAlwaysOn,scrollbarStartGap:yh.scrollbarStartGap,scrollbarEndGap:yh.scrollbarEndGap,class:o4,style:Y3,containerStyle:Y3,getRowHeight:{type:at(Function),required:!0},rowKey:ph.rowKey,onRowsRendered:{type:at(Function)},onScroll:{type:at(Function)}}),Vae=cn({cache:j0.cache,estimatedRowHeight:ph.estimatedRowHeight,rowKey:i4,headerClass:{type:at([String,Function])},headerProps:{type:at([Object,Function])},headerCellProps:{type:at([Object,Function])},headerHeight:lC.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:at([String,Function])},rowProps:{type:at([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:at([Object,Function])},columns:f_,data:r4,dataGetter:{type:at(Function)},fixedData:aC,expandColumnKey:ph.expandColumnKey,expandedRowKeys:Z3,defaultExpandedRowKeys:Z3,class:o4,fixed:Boolean,style:{type:at(Object)},width:lh,height:lh,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:yh.hScrollbarSize,vScrollbarSize:yh.vScrollbarSize,scrollbarAlwaysOn:Az.alwaysOn,sortBy:{type:at(Object),default:()=>({})},sortState:{type:at(Object),default:void 0},onColumnSort:{type:at(Function)},onExpandedRowsChange:{type:at(Function)},onEndReached:{type:at(Function)},onRowExpand:ph.onRowExpand,onScroll:j0.onScroll,onRowsRendered:j0.onRowsRendered,rowEventHandlers:ph.rowEventHandlers}),cC=(e,{slots:t})=>{var i;const{cellData:a,style:d}=e,g=((i=a==null?void 0:a.toString)==null?void 0:i.call(a))||"",_=vt(t,"default",e,()=>[g]);return Ye("div",{class:e.class,title:g,style:d},[_])};cC.displayName="ElTableV2Cell";cC.inheritAttrs=!1;const uC=(e,{slots:t})=>vt(t,"default",e,()=>{var i,a;return[Ye("div",{class:e.class,title:(i=e.column)==null?void 0:i.title},[(a=e.column)==null?void 0:a.title])]});uC.displayName="ElTableV2HeaderCell";uC.inheritAttrs=!1;const Uae=cn({class:String,columns:f_,columnsStyles:{type:at(Object),required:!0},headerIndex:Number,style:{type:at(Object)}}),jae=qe({name:"ElTableV2HeaderRow",props:Uae,setup(e,{slots:t}){return()=>{const{columns:i,columnsStyles:a,headerIndex:d,style:g}=e;let _=i.map((o,S)=>t.cell({columns:i,column:o,columnIndex:S,headerIndex:d,style:a[o.key]}));return t.header&&(_=t.header({cells:_.map(o=>sn(o)&&o.length===1?o[0]:o),columns:i,headerIndex:d})),Ye("div",{class:e.class,style:g,role:"row"},[_])}}}),Hae="ElTableV2Header",Gae=qe({name:Hae,props:lC,setup(e,{slots:t,expose:i}){const a=Xt("table-v2"),d=kn("tableV2GridScrollLeft"),g=xe(),_=ee(()=>Hu({width:e.width,height:e.height})),o=ee(()=>Hu({width:e.rowWidth,height:e.height})),S=ee(()=>gs(y(e.headerHeight))),E=z=>{const N=y(g);Un(()=>{N!=null&&N.scroll&&N.scroll({left:z})})},I=()=>{const z=a.e("fixed-header-row"),{columns:N,fixedHeaderData:$,rowHeight:F}=e;return $==null?void 0:$.map((W,U)=>{var re;const K=Hu({height:F,width:"100%"});return(re=t.fixed)==null?void 0:re.call(t,{class:z,columns:N,rowData:W,rowIndex:-(U+1),style:K})})},R=()=>{const z=a.e("dynamic-header-row"),{columns:N}=e;return y(S).map(($,F)=>{var W;const U=Hu({width:"100%",height:$});return(W=t.dynamic)==null?void 0:W.call(t,{class:z,columns:N,headerIndex:F,style:U})})};return Xl(()=>{d!=null&&d.value&&E(d.value)}),i({scrollToLeft:E}),()=>{if(!(e.height<=0))return Ye("div",{ref:g,class:e.class,style:y(_),role:"rowgroup"},[Ye("div",{style:y(o),class:a.e("header")},[R(),I()])])}}}),Wae=e=>{const{isScrolling:t}=kn(sC),i=xe(!1),a=xe(),d=ee(()=>Wn(e.estimatedRowHeight)&&e.rowIndex>=0),g=(S=!1)=>{const E=y(a);if(!E)return;const{columns:I,onRowHeightChange:R,rowKey:z,rowIndex:N,style:$}=e,{height:F}=E.getBoundingClientRect();i.value=!0,Un(()=>{if(S||F!==Number.parseInt($.height)){const W=I[0],U=(W==null?void 0:W.placeholderSign)===Kv;R==null||R({rowKey:z,height:F,rowIndex:N},W&&!U&&W.fixed)}})},_=ee(()=>{const{rowData:S,rowIndex:E,rowKey:I,onRowHover:R}=e,z=e.rowEventHandlers||{},N={};return Object.entries(z).forEach(([$,F])=>{Nn(F)&&(N[$]=W=>{F({event:W,rowData:S,rowIndex:E,rowKey:I})})}),R&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:$,hovered:F})=>{const W=N[$];N[$]=U=>{R({event:U,hovered:F,rowData:S,rowIndex:E,rowKey:I}),W==null||W(U)}}),N}),o=S=>{const{onRowExpand:E,rowData:I,rowIndex:R,rowKey:z}=e;E==null||E({expanded:S,rowData:I,rowIndex:R,rowKey:z})};return _o(()=>{y(d)&&g(!0)}),{isScrolling:t,measurable:d,measured:i,rowRef:a,eventHandlers:_,onExpand:o}},qae="ElTableV2TableRow",Kae=qe({name:qae,props:ph,setup(e,{expose:t,slots:i,attrs:a}){const{eventHandlers:d,isScrolling:g,measurable:_,measured:o,rowRef:S,onExpand:E}=Wae(e);return t({onExpand:E}),()=>{const{columns:I,columnsStyles:R,expandColumnKey:z,depth:N,rowData:$,rowIndex:F,style:W}=e;let U=I.map((re,K)=>{const q=sn($.children)&&$.children.length>0&&re.key===z;return i.cell({column:re,columns:I,columnIndex:K,depth:N,style:R[re.key],rowData:$,rowIndex:F,isScrolling:y(g),expandIconProps:q?{rowData:$,rowIndex:F,onExpand:E}:void 0})});if(i.row&&(U=i.row({cells:U.map(re=>sn(re)&&re.length===1?re[0]:re),style:W,columns:I,depth:N,rowData:$,rowIndex:F,isScrolling:y(g)})),y(_)){const{height:re,...K}=W||{},q=y(o);return Ye("div",Po({ref:S,class:e.class,style:q?W:K,role:"row"},a,y(d)),[U])}return Ye("div",Po(a,{ref:S,class:e.class,style:W,role:"row"},y(d)),[U])}}}),Zae=e=>{const{sortOrder:t}=e;return Ye(Dn,{size:14,class:e.class},{default:()=>[t===Wv.ASC?Ye(oW,null,null):Ye(tW,null,null)]})},Yae=e=>{const{expanded:t,expandable:i,onExpand:a,style:d,size:g}=e,_={onClick:i?()=>a(!t):void 0,class:e.class};return Ye(Dn,Po(_,{size:g,style:d}),{default:()=>[Ye(Fs,null,null)]})},Xae="ElTableV2Grid",Jae=e=>{const t=xe(),i=xe(),a=xe(0),d=ee(()=>{const{data:W,rowHeight:U,estimatedRowHeight:re}=e;if(!re)return W.length*U}),g=ee(()=>{const{fixedData:W,rowHeight:U}=e;return((W==null?void 0:W.length)||0)*U}),_=ee(()=>U0(e.headerHeight)),o=ee(()=>{const{height:W}=e;return Math.max(0,W-y(_)-y(g))}),S=ee(()=>y(_)+y(g)>0),E=({data:W,rowIndex:U})=>W[U][e.rowKey];function I({rowCacheStart:W,rowCacheEnd:U,rowVisibleStart:re,rowVisibleEnd:K}){var q;(q=e.onRowsRendered)==null||q.call(e,{rowCacheStart:W,rowCacheEnd:U,rowVisibleStart:re,rowVisibleEnd:K})}function R(W,U){var re;(re=i.value)==null||re.resetAfterRowIndex(W,U)}function z(W,U){const re=y(t),K=y(i);So(W)?(re==null||re.scrollToLeft(W.scrollLeft),a.value=W.scrollLeft,K==null||K.scrollTo(W)):(re==null||re.scrollToLeft(W),a.value=W,K==null||K.scrollTo({scrollLeft:W,scrollTop:U}))}function N(W){var U;(U=y(i))==null||U.scrollTo({scrollTop:W})}function $(W,U){var re;(re=y(i))==null||re.scrollToItem(W,1,U)}function F(){var W,U;(W=y(i))==null||W.$forceUpdate(),(U=y(t))==null||U.$forceUpdate()}return{bodyRef:i,forceUpdate:F,fixedRowHeight:g,gridHeight:o,hasHeader:S,headerHeight:_,headerRef:t,totalHeight:d,itemKey:E,onItemRendered:I,resetAfterRowIndex:R,scrollTo:z,scrollToTop:N,scrollToRow:$,scrollLeft:a}},dC=qe({name:Xae,props:j0,setup(e,{slots:t,expose:i}){const{ns:a}=kn(sC),{bodyRef:d,fixedRowHeight:g,gridHeight:_,hasHeader:o,headerRef:S,headerHeight:E,totalHeight:I,forceUpdate:R,itemKey:z,onItemRendered:N,resetAfterRowIndex:$,scrollTo:F,scrollToTop:W,scrollToRow:U,scrollLeft:re}=Jae(e);Bo("tableV2GridScrollLeft",re),i({forceUpdate:R,totalHeight:I,scrollTo:F,scrollToTop:W,scrollToRow:U,resetAfterRowIndex:$});const K=()=>e.bodyWidth;return()=>{const{cache:q,columns:J,data:oe,fixedData:ae,useIsScrolling:fe,scrollbarAlwaysOn:ge,scrollbarEndGap:ce,scrollbarStartGap:de,style:_e,rowHeight:Re,bodyWidth:Qe,estimatedRowHeight:Ee,headerWidth:ye,height:Me,width:Te,getRowHeight:he,onScroll:ke}=e,Ne=Wn(Ee),nt=Ne?nie:Jre,De=y(E);return Ye("div",{role:"table",class:[a.e("table"),e.class],style:_e},[Ye(nt,{ref:d,data:oe,useIsScrolling:fe,itemKey:z,columnCache:0,columnWidth:Ne?K:Qe,totalColumn:1,totalRow:oe.length,rowCache:q,rowHeight:Ne?he:Re,width:Te,height:y(_),class:a.e("body"),role:"rowgroup",scrollbarStartGap:de,scrollbarEndGap:ce,scrollbarAlwaysOn:ge,onScroll:ke,onItemRendered:N,perfMode:!1},{default:Ct=>{var Rt;const Bt=oe[Ct.rowIndex];return(Rt=t.row)==null?void 0:Rt.call(t,{...Ct,columns:J,rowData:Bt})}}),y(o)&&Ye(Gae,{ref:S,class:a.e("header-wrapper"),columns:J,headerData:oe,headerHeight:e.headerHeight,fixedHeaderData:ae,rowWidth:ye,rowHeight:Re,width:Te,height:Math.min(De+y(g),Me)},{dynamic:t.header,fixed:t.row})])}}});function Qae(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Yr(e)}const ele=(e,{slots:t})=>{const{mainTableRef:i,...a}=e;return Ye(dC,Po({ref:i},a),Qae(t)?t:{default:()=>[t]})};function tle(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Yr(e)}const nle=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:i,...a}=e;return Ye(dC,Po({ref:i},a),tle(t)?t:{default:()=>[t]})};function ole(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Yr(e)}const rle=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:i,...a}=e;return Ye(dC,Po({ref:i},a),ole(t)?t:{default:()=>[t]})};function ile(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Yr(e)}const sle=(e,{slots:t})=>{const{columns:i,columnsStyles:a,depthMap:d,expandColumnKey:g,expandedRowKeys:_,estimatedRowHeight:o,hasFixedColumns:S,rowData:E,rowIndex:I,style:R,isScrolling:z,rowProps:N,rowClass:$,rowKey:F,rowEventHandlers:W,ns:U,onRowHovered:re,onRowExpanded:K}=e,q=kh($,{columns:i,rowData:E,rowIndex:I},""),J=kh(N,{columns:i,rowData:E,rowIndex:I}),oe=E[F],ae=d[oe]||0,fe=!!g,ge=I<0,ce=[U.e("row"),q,{[U.e(`row-depth-${ae}`)]:fe&&I>=0,[U.is("expanded")]:fe&&_.includes(oe),[U.is("fixed")]:!ae&&ge,[U.is("customized")]:!!t.row}],de=S?re:void 0,_e={...J,columns:i,columnsStyles:a,class:ce,depth:ae,expandColumnKey:g,estimatedRowHeight:ge?void 0:o,isScrolling:z,rowIndex:I,rowData:E,rowKey:oe,rowEventHandlers:W,style:R};return Ye(Kae,Po(_e,{onRowExpand:K,onMouseenter:Ee=>{de==null||de({hovered:!0,rowKey:oe,event:Ee,rowData:E,rowIndex:I})},onMouseleave:Ee=>{de==null||de({hovered:!1,rowKey:oe,event:Ee,rowData:E,rowIndex:I})},rowkey:oe}),ile(t)?t:{default:()=>[t]})},nS=({columns:e,column:t,columnIndex:i,depth:a,expandIconProps:d,isScrolling:g,rowData:_,rowIndex:o,style:S,expandedRowKeys:E,ns:I,cellProps:R,expandColumnKey:z,indentSize:N,iconSize:$,rowKey:F},{slots:W})=>{const U=Hu(S);if(t.placeholderSign===Kv)return Ye("div",{class:I.em("row-cell","placeholder"),style:U},null);const{cellRenderer:re,dataKey:K,dataGetter:q}=t,J=Nn(q)?q({columns:e,column:t,columnIndex:i,rowData:_,rowIndex:o}):xi(_,K??""),oe=kh(R,{cellData:J,columns:e,column:t,columnIndex:i,rowIndex:o,rowData:_}),ae={class:I.e("cell-text"),columns:e,column:t,columnIndex:i,cellData:J,isScrolling:g,rowData:_,rowIndex:o},fe=n4(re),ge=fe?fe(ae):vt(W,"default",ae,()=>[Ye(cC,ae,null)]),ce=[I.e("row-cell"),t.class,t.align===qv.CENTER&&I.is("align-center"),t.align===qv.RIGHT&&I.is("align-right")],de=o>=0&&z&&t.key===z,_e=o>=0&&E.includes(_[F]);let Re;const Qe=`margin-inline-start: ${a*N}px;`;return de&&(So(d)?Re=Ye(Yae,Po(d,{class:[I.e("expand-icon"),I.is("expanded",_e)],size:$,expanded:_e,style:Qe,expandable:!0}),null):Re=Ye("div",{style:[Qe,`width: ${$}px; height: ${$}px;`].join(" ")},null)),Ye("div",Po({class:ce,style:U},oe,{role:"cell"}),[Re,ge])};nS.inheritAttrs=!1;function ale(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Yr(e)}const lle=({columns:e,columnsStyles:t,headerIndex:i,style:a,headerClass:d,headerProps:g,ns:_},{slots:o})=>{const S={columns:e,headerIndex:i},E=[_.e("header-row"),kh(d,S,""),{[_.is("customized")]:!!o.header}],I={...kh(g,S),columnsStyles:t,class:E,columns:e,headerIndex:i,style:a};return Ye(jae,I,ale(o)?o:{default:()=>[o]})},X3=(e,{slots:t})=>{const{column:i,ns:a,style:d,onColumnSorted:g}=e,_=Hu(d);if(i.placeholderSign===Kv)return Ye("div",{class:a.em("header-row-cell","placeholder"),style:_},null);const{headerCellRenderer:o,headerClass:S,sortable:E}=i,I={...e,class:a.e("header-cell-text")},R=n4(o),z=R?R(I):vt(t,"default",I,()=>[Ye(uC,I,null)]),{sortBy:N,sortState:$,headerCellProps:F}=e;let W,U;if($){const q=$[i.key];W=!!tS[q],U=W?q:Wv.ASC}else W=i.key===N.key,U=W?N.order:Wv.ASC;const re=[a.e("header-cell"),kh(S,e,""),i.align===qv.CENTER&&a.is("align-center"),i.align===qv.RIGHT&&a.is("align-right"),E&&a.is("sortable")],K={...kh(F,e),onClick:i.sortable?g:void 0,class:re,style:_,"data-key":i.key};return Ye("div",Po(K,{role:"columnheader"}),[z,E&&Ye(Zae,{class:[a.e("sort-icon"),W&&a.is("sorting")],sortOrder:U},null)])},s4=(e,{slots:t})=>{var i;return Ye("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};s4.displayName="ElTableV2Footer";const a4=(e,{slots:t})=>{const i=vt(t,"default",{},()=>[Ye(dz,null,null)]);return Ye("div",{class:e.class,style:e.style},[i])};a4.displayName="ElTableV2Empty";const l4=(e,{slots:t})=>{var i;return Ye("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};l4.displayName="ElTableV2Overlay";function tv(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Yr(e)}const cle="ElTableV2",ule=qe({name:cle,props:Vae,setup(e,{slots:t,expose:i}){const a=Xt("table-v2"),{columnsStyles:d,fixedColumnsOnLeft:g,fixedColumnsOnRight:_,mainColumns:o,mainTableHeight:S,fixedTableHeight:E,leftTableWidth:I,rightTableWidth:R,data:z,depthMap:N,expandedRowKeys:$,hasFixedColumns:F,mainTableRef:W,leftTableRef:U,rightTableRef:re,isDynamic:K,isResetting:q,isScrolling:J,bodyWidth:oe,emptyStyle:ae,rootStyle:fe,headerWidth:ge,footerHeight:ce,showEmpty:de,scrollTo:_e,scrollToLeft:Re,scrollToTop:Qe,scrollToRow:Ee,getRowHeight:ye,onColumnSorted:Me,onRowHeightChange:Te,onRowHovered:he,onRowExpanded:ke,onRowsRendered:Ne,onScroll:nt,onVerticalScroll:De}=Nae(e);return i({scrollTo:_e,scrollToLeft:Re,scrollToTop:Qe,scrollToRow:Ee}),Bo(sC,{ns:a,isResetting:q,isScrolling:J}),()=>{const{cache:Ct,cellProps:Rt,estimatedRowHeight:Bt,expandColumnKey:mt,fixedData:Gt,headerHeight:jt,headerClass:Be,headerProps:an,headerCellProps:At,sortBy:Ge,sortState:Fe,rowHeight:Nt,rowClass:Jt,rowEventHandlers:Dt,rowKey:xt,rowProps:Ot,scrollbarAlwaysOn:en,indentSize:dn,iconSize:un,useIsScrolling:Pn,vScrollbarSize:gt,width:Sn}=e,Vn=y(z),lo={cache:Ct,class:a.e("main"),columns:y(o),data:Vn,fixedData:Gt,estimatedRowHeight:Bt,bodyWidth:y(oe)+gt,headerHeight:jt,headerWidth:y(ge),height:y(S),mainTableRef:W,rowKey:xt,rowHeight:Nt,scrollbarAlwaysOn:en,scrollbarStartGap:2,scrollbarEndGap:gt,useIsScrolling:Pn,width:Sn,getRowHeight:ye,onRowsRendered:Ne,onScroll:nt},eo=y(I),fo=y(E),Lo={cache:Ct,class:a.e("left"),columns:y(g),data:Vn,estimatedRowHeight:Bt,leftTableRef:U,rowHeight:Nt,bodyWidth:eo,headerWidth:eo,headerHeight:jt,height:fo,rowKey:xt,scrollbarAlwaysOn:en,scrollbarStartGap:2,scrollbarEndGap:gt,useIsScrolling:Pn,width:eo,getRowHeight:ye,onScroll:De},Pt=y(R)+gt,_n={cache:Ct,class:a.e("right"),columns:y(_),data:Vn,estimatedRowHeight:Bt,rightTableRef:re,rowHeight:Nt,bodyWidth:Pt,headerWidth:Pt,headerHeight:jt,height:fo,rowKey:xt,scrollbarAlwaysOn:en,scrollbarStartGap:2,scrollbarEndGap:gt,width:Pt,style:`--${y(a.namespace)}-table-scrollbar-size: ${gt}px`,useIsScrolling:Pn,getRowHeight:ye,onScroll:De},dt=y(d),tn={ns:a,depthMap:y(N),columnsStyles:dt,expandColumnKey:mt,expandedRowKeys:y($),estimatedRowHeight:Bt,hasFixedColumns:y(F),rowProps:Ot,rowClass:Jt,rowKey:xt,rowEventHandlers:Dt,onRowHovered:he,onRowExpanded:ke,onRowHeightChange:Te},Ze={cellProps:Rt,expandColumnKey:mt,indentSize:dn,iconSize:un,rowKey:xt,expandedRowKeys:y($),ns:a},vn={ns:a,headerClass:Be,headerProps:an,columnsStyles:dt},Mn={ns:a,sortBy:Ge,sortState:Fe,headerCellProps:At,onColumnSorted:Me},yo={row:Ur=>Ye(sle,Po(Ur,tn),{row:t.row,cell:Rr=>{let Oo;return t.cell?Ye(nS,Po(Rr,Ze,{style:dt[Rr.column.key]}),tv(Oo=t.cell(Rr))?Oo:{default:()=>[Oo]}):Ye(nS,Po(Rr,Ze,{style:dt[Rr.column.key]}),null)}}),header:Ur=>Ye(lle,Po(Ur,vn),{header:t.header,cell:Rr=>{let Oo;return t["header-cell"]?Ye(X3,Po(Rr,Mn,{style:dt[Rr.column.key]}),tv(Oo=t["header-cell"](Rr))?Oo:{default:()=>[Oo]}):Ye(X3,Po(Rr,Mn,{style:dt[Rr.column.key]}),null)}})},gr=[e.class,a.b(),a.e("root"),{[a.is("dynamic")]:y(K)}],Xr={class:a.e("footer"),style:y(ce)};return Ye("div",{class:gr,style:y(fe)},[Ye(ele,lo,tv(yo)?yo:{default:()=>[yo]}),Ye(nle,Lo,tv(yo)?yo:{default:()=>[yo]}),Ye(rle,_n,tv(yo)?yo:{default:()=>[yo]}),t.footer&&Ye(s4,Xr,{default:t.footer}),y(de)&&Ye(a4,{class:a.e("empty"),style:y(ae)},{default:t.empty}),t.overlay&&Ye(l4,{class:a.e("overlay")},{default:t.overlay})])}}}),dle=cn({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:at(Function)}}),hle=qe({name:"ElAutoResizer",props:dle,setup(e,{slots:t}){const i=Xt("auto-resizer"),{height:a,width:d,sizer:g}=Fae(e),_={width:"100%",height:"100%"};return()=>{var o;return Ye("div",{ref:g,class:i.b(),style:_},[(o=t.default)==null?void 0:o.call(t,{height:a.value,width:d.value})])}}}),fle=uo(ule),ple=uo(hle),d1=Symbol("tabsRootContextKey"),mle=cn({tabs:{type:at(Array),default:()=>oi([])}}),c4="ElTabBar",gle=qe({name:c4}),vle=qe({...gle,props:mle,setup(e,{expose:t}){const i=e,a=To(),d=kn(d1);d||Ai(c4,"<el-tabs><el-tab-bar /></el-tabs>");const g=Xt("tabs"),_=xe(),o=xe(),S=()=>{let N=0,$=0;const F=["top","bottom"].includes(d.props.tabPosition)?"width":"height",W=F==="width"?"x":"y",U=W==="x"?"left":"top";return i.tabs.every(re=>{var K,q;const J=(q=(K=a.parent)==null?void 0:K.refs)==null?void 0:q[`tab-${re.uid}`];if(!J)return!1;if(!re.active)return!0;N=J[`offset${Ul(U)}`],$=J[`client${Ul(F)}`];const oe=window.getComputedStyle(J);return F==="width"&&($-=Number.parseFloat(oe.paddingLeft)+Number.parseFloat(oe.paddingRight),N+=Number.parseFloat(oe.paddingLeft)),!1}),{[F]:`${$}px`,transform:`translate${Ul(W)}(${N}px)`}},E=()=>o.value=S(),I=[],R=()=>{var N;I.forEach(F=>F.stop()),I.length=0;const $=(N=a.parent)==null?void 0:N.refs;if($){for(const F in $)if(F.startsWith("tab-")){const W=$[F];W&&I.push(ei(W,E))}}};qt(()=>i.tabs,async()=>{await Un(),E(),R()},{immediate:!0});const z=ei(_,()=>E());return Pr(()=>{I.forEach(N=>N.stop()),I.length=0,z.stop()}),t({ref:_,update:E}),(N,$)=>(se(),Ie("div",{ref_key:"barRef",ref:_,class:ue([y(g).e("active-bar"),y(g).is(y(d).props.tabPosition)]),style:$n(o.value)},null,6))}});var _le=fn(vle,[["__file","tab-bar.vue"]]);const yle=cn({panes:{type:at(Array),default:()=>oi([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),ble={tabClick:(e,t,i)=>i instanceof Event,tabRemove:(e,t)=>t instanceof Event},J3="ElTabNav",xle=qe({name:J3,props:yle,emits:ble,setup(e,{expose:t,emit:i}){const a=kn(d1);a||Ai(J3,"<el-tabs><tab-nav /></el-tabs>");const d=Xt("tabs"),g=f$(),_=C$(),o=xe(),S=xe(),E=xe(),I=xe(),R=xe(!1),z=xe(0),N=xe(!1),$=xe(!0),F=ee(()=>["top","bottom"].includes(a.props.tabPosition)?"width":"height"),W=ee(()=>({transform:`translate${F.value==="width"?"X":"Y"}(-${z.value}px)`})),U=()=>{if(!o.value)return;const fe=o.value[`offset${Ul(F.value)}`],ge=z.value;if(!ge)return;const ce=ge>fe?ge-fe:0;z.value=ce},re=()=>{if(!o.value||!S.value)return;const fe=S.value[`offset${Ul(F.value)}`],ge=o.value[`offset${Ul(F.value)}`],ce=z.value;if(fe-ce<=ge)return;const de=fe-ce>ge*2?ce+ge:fe-ge;z.value=de},K=async()=>{const fe=S.value;if(!R.value||!E.value||!o.value||!fe)return;await Un();const ge=E.value.querySelector(".is-active");if(!ge)return;const ce=o.value,de=["top","bottom"].includes(a.props.tabPosition),_e=ge.getBoundingClientRect(),Re=ce.getBoundingClientRect(),Qe=de?fe.offsetWidth-Re.width:fe.offsetHeight-Re.height,Ee=z.value;let ye=Ee;de?(_e.left<Re.left&&(ye=Ee-(Re.left-_e.left)),_e.right>Re.right&&(ye=Ee+_e.right-Re.right)):(_e.top<Re.top&&(ye=Ee-(Re.top-_e.top)),_e.bottom>Re.bottom&&(ye=Ee+(_e.bottom-Re.bottom))),ye=Math.max(ye,0),z.value=Math.min(ye,Qe)},q=()=>{var fe;if(!S.value||!o.value)return;e.stretch&&((fe=I.value)==null||fe.update());const ge=S.value[`offset${Ul(F.value)}`],ce=o.value[`offset${Ul(F.value)}`],de=z.value;ce<ge?(R.value=R.value||{},R.value.prev=de,R.value.next=de+ce<ge,ge-de<ce&&(z.value=ge-ce)):(R.value=!1,de>0&&(z.value=0))},J=fe=>{let ge=0;switch(fe.code){case Cn.left:case Cn.up:ge=-1;break;case Cn.right:case Cn.down:ge=1;break;default:return}const ce=Array.from(fe.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let _e=ce.indexOf(fe.target)+ge;_e<0?_e=ce.length-1:_e>=ce.length&&(_e=0),ce[_e].focus({preventScroll:!0}),ce[_e].click(),oe()},oe=()=>{$.value&&(N.value=!0)},ae=()=>N.value=!1;return qt(g,fe=>{fe==="hidden"?$.value=!1:fe==="visible"&&setTimeout(()=>$.value=!0,50)}),qt(_,fe=>{fe?setTimeout(()=>$.value=!0,50):$.value=!1}),ei(E,q),_o(()=>setTimeout(()=>K(),0)),Xl(()=>q()),t({scrollToActiveTab:K,removeFocus:ae}),()=>{const fe=R.value?[Ye("span",{class:[d.e("nav-prev"),d.is("disabled",!R.value.prev)],onClick:U},[Ye(Dn,null,{default:()=>[Ye(td,null,null)]})]),Ye("span",{class:[d.e("nav-next"),d.is("disabled",!R.value.next)],onClick:re},[Ye(Dn,null,{default:()=>[Ye(Fs,null,null)]})])]:null,ge=e.panes.map((ce,de)=>{var _e,Re,Qe,Ee;const ye=ce.uid,Me=ce.props.disabled,Te=(Re=(_e=ce.props.name)!=null?_e:ce.index)!=null?Re:`${de}`,he=!Me&&(ce.isClosable||e.editable);ce.index=`${de}`;const ke=he?Ye(Dn,{class:"is-icon-close",onClick:De=>i("tabRemove",ce,De)},{default:()=>[Ye(yl,null,null)]}):null,Ne=((Ee=(Qe=ce.slots).label)==null?void 0:Ee.call(Qe))||ce.props.label,nt=!Me&&ce.active?0:-1;return Ye("div",{ref:`tab-${ye}`,class:[d.e("item"),d.is(a.props.tabPosition),d.is("active",ce.active),d.is("disabled",Me),d.is("closable",he),d.is("focus",N.value)],id:`tab-${Te}`,key:`tab-${ye}`,"aria-controls":`pane-${Te}`,role:"tab","aria-selected":ce.active,tabindex:nt,onFocus:()=>oe(),onBlur:()=>ae(),onClick:De=>{ae(),i("tabClick",ce,Te,De)},onKeydown:De=>{he&&(De.code===Cn.delete||De.code===Cn.backspace)&&i("tabRemove",ce,De)}},[Ne,ke])});return Ye("div",{ref:E,class:[d.e("nav-wrap"),d.is("scrollable",!!R.value),d.is(a.props.tabPosition)]},[fe,Ye("div",{class:d.e("nav-scroll"),ref:o},[Ye("div",{class:[d.e("nav"),d.is(a.props.tabPosition),d.is("stretch",e.stretch&&["top","bottom"].includes(a.props.tabPosition))],ref:S,style:W.value,role:"tablist",onKeydown:J},[e.type?null:Ye(_le,{ref:I,tabs:[...e.panes]},null),ge])])])}}}),wle=cn({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:at(Function),default:()=>!0},stretch:Boolean}),Bw=e=>Bn(e)||Wn(e),Sle={[xo]:e=>Bw(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>Bw(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>Bw(e),tabAdd:()=>!0},Tle=qe({name:"ElTabs",props:wle,emits:Sle,setup(e,{emit:t,slots:i,expose:a}){var d;const g=Xt("tabs"),_=ee(()=>["left","right"].includes(e.tabPosition)),{children:o,addChild:S,removeChild:E}=AT(To(),"ElTabPane"),I=xe(),R=xe((d=e.modelValue)!=null?d:"0"),z=async(U,re=!1)=>{var K,q,J;if(!(R.value===U||jr(U)))try{await((K=e.beforeLeave)==null?void 0:K.call(e,U,R.value))!==!1&&(R.value=U,re&&(t(xo,U),t("tabChange",U)),(J=(q=I.value)==null?void 0:q.removeFocus)==null||J.call(q))}catch{}},N=(U,re,K)=>{U.props.disabled||(z(re,!0),t("tabClick",U,K))},$=(U,re)=>{U.props.disabled||jr(U.props.name)||(re.stopPropagation(),t("edit",U.props.name,"remove"),t("tabRemove",U.props.name))},F=()=>{t("edit",void 0,"add"),t("tabAdd")};qt(()=>e.modelValue,U=>z(U)),qt(R,async()=>{var U;await Un(),(U=I.value)==null||U.scrollToActiveTab()}),Bo(d1,{props:e,currentName:R,registerPane:U=>{o.value.push(U)},sortPane:S,unregisterPane:E}),a({currentName:R});const W=({render:U})=>U();return()=>{const U=i["add-icon"],re=e.editable||e.addable?Ye("div",{class:[g.e("new-tab"),_.value&&g.e("new-tab-vertical")],tabindex:"0",onClick:F,onKeydown:J=>{[Cn.enter,Cn.numpadEnter].includes(J.code)&&F()}},[U?vt(i,"add-icon"):Ye(Dn,{class:g.is("icon-plus")},{default:()=>[Ye($D,null,null)]})]):null,K=Ye("div",{class:[g.e("header"),_.value&&g.e("header-vertical"),g.is(e.tabPosition)]},[Ye(W,{render:()=>{const J=o.value.some(oe=>oe.slots.label);return Ye(xle,{ref:I,currentName:R.value,editable:e.editable,type:e.type,panes:o.value,stretch:e.stretch,onTabClick:N,onTabRemove:$},{$stable:!J})}},null),re]),q=Ye("div",{class:g.e("content")},[vt(i,"default")]);return Ye("div",{class:[g.b(),g.m(e.tabPosition),{[g.m("card")]:e.type==="card",[g.m("border-card")]:e.type==="border-card"}]},[q,K])}}}),Cle=cn({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),u4="ElTabPane",Ele=qe({name:u4}),Mle=qe({...Ele,props:Cle,setup(e){const t=e,i=To(),a=Ri(),d=kn(d1);d||Ai(u4,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const g=Xt("tab-pane"),_=xe(),o=ee(()=>t.closable||d.props.closable),S=n2(()=>{var N;return d.currentName.value===((N=t.name)!=null?N:_.value)}),E=xe(S.value),I=ee(()=>{var N;return(N=t.name)!=null?N:_.value}),R=n2(()=>!t.lazy||E.value||S.value);qt(S,N=>{N&&(E.value=!0)});const z=dr({uid:i.uid,slots:a,props:t,paneName:I,active:S,index:_,isClosable:o});return d.registerPane(z),_o(()=>{d.sortPane(z)}),ld(()=>{d.unregisterPane(z.uid)}),(N,$)=>y(R)?vo((se(),Ie("div",{key:0,id:`pane-${y(I)}`,class:ue(y(g).b()),role:"tabpanel","aria-hidden":!y(S),"aria-labelledby":`tab-${y(I)}`},[vt(N.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[ir,y(S)]]):yt("v-if",!0)}});var d4=fn(Mle,[["__file","tab-pane.vue"]]);const Ile=uo(Tle,{TabPane:d4}),Ale=ri(d4),kle=cn({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:ec,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),Ple=qe({name:"ElText"}),Rle=qe({...Ple,props:kle,setup(e){const t=e,i=Mi(),a=Xt("text"),d=ee(()=>[a.b(),a.m(t.type),a.m(i.value),a.is("truncated",t.truncated),a.is("line-clamp",!jr(t.lineClamp))]);return(g,_)=>(se(),Et(ko(g.tag),{class:ue(y(d)),style:$n({"-webkit-line-clamp":g.lineClamp})},{default:it(()=>[vt(g.$slots,"default")]),_:3},8,["class","style"]))}});var Dle=fn(Rle,[["__file","text.vue"]]);const Lle=uo(Dle),Ole=cn({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:at(String),default:"light"},clearable:{type:Boolean,default:!0},size:ki,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:at([String,Object]),default:()=>ND},clearIcon:{type:at([String,Object]),default:()=>ud},...Zp}),Ec=e=>{const t=(e||"").split(":");if(t.length>=2){let i=Number.parseInt(t[0],10);const a=Number.parseInt(t[1],10),d=e.toUpperCase();return d.includes("AM")&&i===12?i=0:d.includes("PM")&&i!==12&&(i+=12),{hours:i,minutes:a}}return null},Fw=(e,t)=>{const i=Ec(e);if(!i)return-1;const a=Ec(t);if(!a)return-1;const d=i.minutes+i.hours*60,g=a.minutes+a.hours*60;return d===g?0:d>g?1:-1},Q3=e=>`${e}`.padStart(2,"0"),ip=e=>`${Q3(e.hours)}:${Q3(e.minutes)}`,zle=(e,t)=>{const i=Ec(e);if(!i)return"";const a=Ec(t);if(!a)return"";const d={hours:i.hours,minutes:i.minutes};return d.minutes+=a.minutes,d.hours+=a.hours,d.hours+=Math.floor(d.minutes/60),d.minutes=d.minutes%60,ip(d)},Ble=qe({name:"ElTimeSelect"}),Fle=qe({...Ble,props:Ole,emits:["change","blur","focus","clear","update:modelValue"],setup(e,{expose:t}){const i=e;so.extend(BT);const{Option:a}=Ah,d=Xt("input"),g=xe(),_=bs(),{lang:o}=qo(),S=ee(()=>i.modelValue),E=ee(()=>{const U=Ec(i.start);return U?ip(U):null}),I=ee(()=>{const U=Ec(i.end);return U?ip(U):null}),R=ee(()=>{const U=Ec(i.step);return U?ip(U):null}),z=ee(()=>{const U=Ec(i.minTime||"");return U?ip(U):null}),N=ee(()=>{const U=Ec(i.maxTime||"");return U?ip(U):null}),$=ee(()=>{const U=[];if(i.start&&i.end&&i.step){let re=E.value,K;for(;re&&I.value&&Fw(re,I.value)<=0;)K=so(re,"HH:mm").locale(o.value).format(i.format),U.push({value:K,disabled:Fw(re,z.value||"-1:-1")<=0||Fw(re,N.value||"100:100")>=0}),re=zle(re,R.value)}return U});return t({blur:()=>{var U,re;(re=(U=g.value)==null?void 0:U.blur)==null||re.call(U)},focus:()=>{var U,re;(re=(U=g.value)==null?void 0:U.focus)==null||re.call(U)}}),(U,re)=>(se(),Et(y(Ah),{ref_key:"select",ref:g,"model-value":y(S),disabled:y(_),clearable:U.clearable,"clear-icon":U.clearIcon,size:U.size,effect:U.effect,placeholder:U.placeholder,"default-first-option":"",filterable:U.editable,"empty-values":U.emptyValues,"value-on-clear":U.valueOnClear,"onUpdate:modelValue":K=>U.$emit("update:modelValue",K),onChange:K=>U.$emit("change",K),onBlur:K=>U.$emit("blur",K),onFocus:K=>U.$emit("focus",K),onClear:()=>U.$emit("clear")},{prefix:it(()=>[U.prefixIcon?(se(),Et(y(Dn),{key:0,class:ue(y(d).e("prefix-icon"))},{default:it(()=>[(se(),Et(ko(U.prefixIcon)))]),_:1},8,["class"])):yt("v-if",!0)]),default:it(()=>[(se(!0),Ie(Fn,null,Fo(y($),K=>(se(),Et(y(a),{key:K.value,label:K.value,value:K.value,disabled:K.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var Nle=fn(Fle,[["__file","time-select.vue"]]);const $le=uo(Nle),Vle=qe({name:"ElTimeline",setup(e,{slots:t}){const i=Xt("timeline");return Bo("timeline",t),()=>Kn("ul",{class:[i.b()]},[vt(t,"default")])}}),Ule=cn({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:Cr},hollow:Boolean}),jle=qe({name:"ElTimelineItem"}),Hle=qe({...jle,props:Ule,setup(e){const t=e,i=Xt("timeline-item"),a=ee(()=>[i.e("node"),i.em("node",t.size||""),i.em("node",t.type||""),i.is("hollow",t.hollow)]);return(d,g)=>(se(),Ie("li",{class:ue([y(i).b(),{[y(i).e("center")]:d.center}])},[je("div",{class:ue(y(i).e("tail"))},null,2),d.$slots.dot?yt("v-if",!0):(se(),Ie("div",{key:0,class:ue(y(a)),style:$n({backgroundColor:d.color})},[d.icon?(se(),Et(y(Dn),{key:0,class:ue(y(i).e("icon"))},{default:it(()=>[(se(),Et(ko(d.icon)))]),_:1},8,["class"])):yt("v-if",!0)],6)),d.$slots.dot?(se(),Ie("div",{key:1,class:ue(y(i).e("dot"))},[vt(d.$slots,"dot")],2)):yt("v-if",!0),je("div",{class:ue(y(i).e("wrapper"))},[!d.hideTimestamp&&d.placement==="top"?(se(),Ie("div",{key:0,class:ue([y(i).e("timestamp"),y(i).is("top")])},mn(d.timestamp),3)):yt("v-if",!0),je("div",{class:ue(y(i).e("content"))},[vt(d.$slots,"default")],2),!d.hideTimestamp&&d.placement==="bottom"?(se(),Ie("div",{key:1,class:ue([y(i).e("timestamp"),y(i).is("bottom")])},mn(d.timestamp),3)):yt("v-if",!0)],2)],2))}});var h4=fn(Hle,[["__file","timeline-item.vue"]]);const Gle=uo(Vle,{TimelineItem:h4}),Wle=ri(h4),f4=cn({nowrap:Boolean});var p4=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(p4||{});const qle=Object.values(p4),hC=cn({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:at(Object),default:null}}),Kle=cn({side:{type:at(String),values:qle,required:!0}}),Zle=["absolute","fixed"],Yle=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],fC=cn({arrowPadding:{type:at(Number),default:5},effect:{type:at(String),default:"light"},contentClass:String,placement:{type:at(String),values:Yle,default:"bottom"},reference:{type:at(Object),default:null},offset:{type:Number,default:8},strategy:{type:at(String),values:Zle,default:"absolute"},showArrow:Boolean,...Zi(["ariaLabel"])}),pC=cn({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:at(Function)},"onUpdate:open":{type:at(Function)}}),ep={type:at(Function)},mC=cn({onBlur:ep,onClick:ep,onFocus:ep,onMouseDown:ep,onMouseEnter:ep,onMouseLeave:ep}),Xle=cn({...pC,...hC,...mC,...fC,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:at(Object),default:null},teleported:Boolean,to:{type:at(String),default:"body"}}),h1=Symbol("tooltipV2"),m4=Symbol("tooltipV2Content"),Nw="tooltip_v2.open",Jle=qe({name:"ElTooltipV2Root"}),Qle=qe({...Jle,props:pC,setup(e,{expose:t}){const i=e,a=xe(i.defaultOpen),d=xe(null),g=ee({get:()=>Th(i.open)?a.value:i.open,set:W=>{var U;a.value=W,(U=i["onUpdate:open"])==null||U.call(i,W)}}),_=ee(()=>Wn(i.delayDuration)&&i.delayDuration>0),{start:o,stop:S}=wh(()=>{g.value=!0},ee(()=>i.delayDuration),{immediate:!1}),E=Xt("tooltip-v2"),I=Ki(),R=()=>{S(),g.value=!0},z=()=>{y(_)?o():R()},N=R,$=()=>{S(),g.value=!1};return qt(g,W=>{var U;W&&(document.dispatchEvent(new CustomEvent(Nw)),N()),(U=i.onOpenChange)==null||U.call(i,W)}),_o(()=>{document.addEventListener(Nw,$)}),Pr(()=>{S(),document.removeEventListener(Nw,$)}),Bo(h1,{contentId:I,triggerRef:d,ns:E,onClose:$,onDelayOpen:z,onOpen:N}),t({onOpen:N,onClose:$}),(W,U)=>vt(W.$slots,"default",{open:y(g)})}});var ece=fn(Qle,[["__file","root.vue"]]);const tce=qe({name:"ElTooltipV2Arrow"}),nce=qe({...tce,props:{...hC,...Kle},setup(e){const t=e,{ns:i}=kn(h1),{arrowRef:a}=kn(m4),d=ee(()=>{const{style:g,width:_,height:o}=t,S=i.namespace.value;return{[`--${S}-tooltip-v2-arrow-width`]:`${_}px`,[`--${S}-tooltip-v2-arrow-height`]:`${o}px`,[`--${S}-tooltip-v2-arrow-border-width`]:`${_/2}px`,[`--${S}-tooltip-v2-arrow-cover-width`]:_/2-1,...g||{}}});return(g,_)=>(se(),Ie("span",{ref_key:"arrowRef",ref:a,style:$n(y(d)),class:ue(y(i).e("arrow"))},null,6))}});var eP=fn(nce,[["__file","arrow.vue"]]);const oce=cn({style:{type:at([String,Object,Array]),default:()=>({})}}),rce=qe({name:"ElVisuallyHidden"}),ice=qe({...rce,props:oce,setup(e){const t=e,i=ee(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(a,d)=>(se(),Ie("span",Po(a.$attrs,{style:y(i)}),[vt(a.$slots,"default")],16))}});var sce=fn(ice,[["__file","visual-hidden.vue"]]);const ace=qe({name:"ElTooltipV2Content"}),lce=qe({...ace,props:{...fC,...f4},setup(e){const t=e,{triggerRef:i,contentId:a}=kn(h1),d=xe(t.placement),g=xe(t.strategy),_=xe(null),{referenceRef:o,contentRef:S,middlewareData:E,x:I,y:R,update:z}=Mq({placement:d,strategy:g,middleware:ee(()=>{const K=[bL(t.offset)];return t.showArrow&&K.push(Iq({arrowRef:_})),K})}),N=qp().nextZIndex(),$=Xt("tooltip-v2"),F=ee(()=>d.value.split("-")[0]),W=ee(()=>({position:y(g),top:`${y(R)||0}px`,left:`${y(I)||0}px`,zIndex:N})),U=ee(()=>{if(!t.showArrow)return{};const{arrow:K}=y(E);return{[`--${$.namespace.value}-tooltip-v2-arrow-x`]:`${K==null?void 0:K.x}px`||"",[`--${$.namespace.value}-tooltip-v2-arrow-y`]:`${K==null?void 0:K.y}px`||""}}),re=ee(()=>[$.e("content"),$.is("dark",t.effect==="dark"),$.is(y(g)),t.contentClass]);return qt(_,()=>z()),qt(()=>t.placement,K=>d.value=K),_o(()=>{qt(()=>t.reference||i.value,K=>{o.value=K||void 0},{immediate:!0})}),Bo(m4,{arrowRef:_}),(K,q)=>(se(),Ie("div",{ref_key:"contentRef",ref:S,style:$n(y(W)),"data-tooltip-v2-root":""},[K.nowrap?yt("v-if",!0):(se(),Ie("div",{key:0,"data-side":y(F),class:ue(y(re))},[vt(K.$slots,"default",{contentStyle:y(W),contentClass:y(re)}),Ye(y(sce),{id:y(a),role:"tooltip"},{default:it(()=>[K.ariaLabel?(se(),Ie(Fn,{key:0},[$o(mn(K.ariaLabel),1)],64)):vt(K.$slots,"default",{key:1})]),_:3},8,["id"]),vt(K.$slots,"arrow",{style:$n(y(U)),side:y(F)})],10,["data-side"]))],4))}});var tP=fn(lce,[["__file","content.vue"]]);const cce=cn({setRef:{type:at(Function),required:!0},onlyChild:Boolean});var uce=qe({props:cce,setup(e,{slots:t}){const i=xe(),a=Kb(i,d=>{d?e.setRef(d.nextElementSibling):e.setRef(null)});return()=>{var d;const[g]=((d=t.default)==null?void 0:d.call(t))||[],_=e.onlyChild?bW(g.children):g.children;return Ye(Fn,{ref:a},[_])}}});const dce=qe({name:"ElTooltipV2Trigger"}),hce=qe({...dce,props:{...f4,...mC},setup(e){const t=e,{onClose:i,onOpen:a,onDelayOpen:d,triggerRef:g,contentId:_}=kn(h1);let o=!1;const S=re=>{g.value=re},E=()=>{o=!1},I=hi(t.onMouseEnter,d),R=hi(t.onMouseLeave,i),z=hi(t.onMouseDown,()=>{i(),o=!0,document.addEventListener("mouseup",E,{once:!0})}),N=hi(t.onFocus,()=>{o||a()}),$=hi(t.onBlur,i),F=hi(t.onClick,re=>{re.detail===0&&i()}),W={blur:$,click:F,focus:N,mousedown:z,mouseenter:I,mouseleave:R},U=(re,K,q)=>{re&&Object.entries(K).forEach(([J,oe])=>{re[q](J,oe)})};return qt(g,(re,K)=>{U(re,W,"addEventListener"),U(K,W,"removeEventListener"),re&&re.setAttribute("aria-describedby",_.value)}),Pr(()=>{U(g.value,W,"removeEventListener"),document.removeEventListener("mouseup",E)}),(re,K)=>re.nowrap?(se(),Et(y(uce),{key:0,"set-ref":S,"only-child":""},{default:it(()=>[vt(re.$slots,"default")]),_:3})):(se(),Ie("button",Po({key:1,ref_key:"triggerRef",ref:g},re.$attrs),[vt(re.$slots,"default")],16))}});var fce=fn(hce,[["__file","trigger.vue"]]);const pce=qe({name:"ElTooltipV2"}),mce=qe({...pce,props:Xle,setup(e){const i=Vi(e),a=dr(fl(i,Object.keys(hC))),d=dr(fl(i,Object.keys(fC))),g=dr(fl(i,Object.keys(pC))),_=dr(fl(i,Object.keys(mC)));return(o,S)=>(se(),Et(ece,hl(Xu(g)),{default:it(({open:E})=>[Ye(fce,Po(_,{nowrap:""}),{default:it(()=>[vt(o.$slots,"trigger")]),_:3},16),Ye(y(Yp),{to:o.to,disabled:!o.teleported},{default:it(()=>[o.fullTransition?(se(),Et(Ui,hl(Po({key:0},o.transitionProps)),{default:it(()=>[o.alwaysOn||E?(se(),Et(tP,hl(Po({key:0},d)),{arrow:it(({style:I,side:R})=>[o.showArrow?(se(),Et(eP,Po({key:0},a,{style:I,side:R}),null,16,["style","side"])):yt("v-if",!0)]),default:it(()=>[vt(o.$slots,"default")]),_:3},16)):yt("v-if",!0)]),_:2},1040)):(se(),Ie(Fn,{key:1},[o.alwaysOn||E?(se(),Et(tP,hl(Po({key:0},d)),{arrow:it(({style:I,side:R})=>[o.showArrow?(se(),Et(eP,Po({key:0},a,{style:I,side:R}),null,16,["style","side"])):yt("v-if",!0)]),default:it(()=>[vt(o.$slots,"default")]),_:3},16)):yt("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var gce=fn(mce,[["__file","tooltip.vue"]]);const vce=uo(gce),g4="left-check-change",v4="right-check-change",sp=cn({data:{type:at(Array),default:()=>[]},titles:{type:at(Array),default:()=>[]},buttonTexts:{type:at(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:at(Function)},leftDefaultChecked:{type:at(Array),default:()=>[]},rightDefaultChecked:{type:at(Array),default:()=>[]},renderContent:{type:at(Function)},modelValue:{type:at(Array),default:()=>[]},format:{type:at(Object),default:()=>({})},filterable:Boolean,props:{type:at(Object),default:()=>oi({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),oS=(e,t)=>[e,t].every(sn)||sn(e)&&Pi(t),_ce={[Wr]:(e,t,i)=>[e,i].every(sn)&&["left","right"].includes(t),[xo]:e=>sn(e),[g4]:oS,[v4]:oS},rS="checked-change",yce=cn({data:sp.data,optionRender:{type:at(Function)},placeholder:String,title:String,filterable:Boolean,format:sp.format,filterMethod:sp.filterMethod,defaultChecked:sp.leftDefaultChecked,props:sp.props}),bce={[rS]:oS},p_=e=>{const t={label:"label",key:"key",disabled:"disabled"};return ee(()=>({...t,...e.props}))},xce=(e,t,i)=>{const a=p_(e),d=ee(()=>e.data.filter(I=>Nn(e.filterMethod)?e.filterMethod(t.query,I):String(I[a.value.label]||I[a.value.key]).toLowerCase().includes(t.query.toLowerCase()))),g=ee(()=>d.value.filter(I=>!I[a.value.disabled])),_=ee(()=>{const I=t.checked.length,R=e.data.length,{noChecked:z,hasChecked:N}=e.format;return z&&N?I>0?N.replace(/\${checked}/g,I.toString()).replace(/\${total}/g,R.toString()):z.replace(/\${total}/g,R.toString()):`${I}/${R}`}),o=ee(()=>{const I=t.checked.length;return I>0&&I<g.value.length}),S=()=>{const I=g.value.map(R=>R[a.value.key]);t.allChecked=I.length>0&&I.every(R=>t.checked.includes(R))},E=I=>{t.checked=I?g.value.map(R=>R[a.value.key]):[]};return qt(()=>t.checked,(I,R)=>{if(S(),t.checkChangeByUser){const z=I.concat(R).filter(N=>!I.includes(N)||!R.includes(N));i(rS,I,z)}else i(rS,I),t.checkChangeByUser=!0}),qt(g,()=>{S()}),qt(()=>e.data,()=>{const I=[],R=d.value.map(z=>z[a.value.key]);t.checked.forEach(z=>{R.includes(z)&&I.push(z)}),t.checkChangeByUser=!1,t.checked=I}),qt(()=>e.defaultChecked,(I,R)=>{if(R&&I.length===R.length&&I.every($=>R.includes($)))return;const z=[],N=g.value.map($=>$[a.value.key]);I.forEach($=>{N.includes($)&&z.push($)}),t.checkChangeByUser=!1,t.checked=z},{immediate:!0}),{filteredData:d,checkableData:g,checkedSummary:_,isIndeterminate:o,updateAllChecked:S,handleAllCheckedChange:E}},wce=(e,t)=>({onSourceCheckedChange:(d,g)=>{e.leftChecked=d,g&&t(g4,d,g)},onTargetCheckedChange:(d,g)=>{e.rightChecked=d,g&&t(v4,d,g)}}),Sce=e=>{const t=p_(e),i=ee(()=>e.data.reduce((g,_)=>(g[_[t.value.key]]=_)&&g,{})),a=ee(()=>e.data.filter(g=>!e.modelValue.includes(g[t.value.key]))),d=ee(()=>e.targetOrder==="original"?e.data.filter(g=>e.modelValue.includes(g[t.value.key])):e.modelValue.reduce((g,_)=>{const o=i.value[_];return o&&g.push(o),g},[]));return{sourceData:a,targetData:d}},Tce=(e,t,i)=>{const a=p_(e),d=(o,S,E)=>{i(xo,o),i(Wr,o,S,E)};return{addToLeft:()=>{const o=e.modelValue.slice();t.rightChecked.forEach(S=>{const E=o.indexOf(S);E>-1&&o.splice(E,1)}),d(o,"left",t.rightChecked)},addToRight:()=>{let o=e.modelValue.slice();const S=e.data.filter(E=>{const I=E[a.value.key];return t.leftChecked.includes(I)&&!e.modelValue.includes(I)}).map(E=>E[a.value.key]);o=e.targetOrder==="unshift"?S.concat(o):o.concat(S),e.targetOrder==="original"&&(o=e.data.filter(E=>o.includes(E[a.value.key])).map(E=>E[a.value.key])),d(o,"right",t.leftChecked)}}},Cce=qe({name:"ElTransferPanel"}),Ece=qe({...Cce,props:yce,emits:bce,setup(e,{expose:t,emit:i}){const a=e,d=Ri(),g=({option:K})=>K,{t:_}=qo(),o=Xt("transfer"),S=dr({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),E=p_(a),{filteredData:I,checkedSummary:R,isIndeterminate:z,handleAllCheckedChange:N}=xce(a,S,i),$=ee(()=>!ha(S.query)&&ha(I.value)),F=ee(()=>!ha(d.default()[0].children)),{checked:W,allChecked:U,query:re}=Vi(S);return t({query:re}),(K,q)=>(se(),Ie("div",{class:ue(y(o).b("panel"))},[je("p",{class:ue(y(o).be("panel","header"))},[Ye(y(ja),{modelValue:y(U),"onUpdate:modelValue":J=>Hr(U)?U.value=J:null,indeterminate:y(z),"validate-event":!1,onChange:y(N)},{default:it(()=>[$o(mn(K.title)+" ",1),je("span",null,mn(y(R)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),je("div",{class:ue([y(o).be("panel","body"),y(o).is("with-footer",y(F))])},[K.filterable?(se(),Et(y(_s),{key:0,modelValue:y(re),"onUpdate:modelValue":J=>Hr(re)?re.value=J:null,class:ue(y(o).be("panel","filter")),size:"default",placeholder:K.placeholder,"prefix-icon":y(QG),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):yt("v-if",!0),vo(Ye(y(SO),{modelValue:y(W),"onUpdate:modelValue":J=>Hr(W)?W.value=J:null,"validate-event":!1,class:ue([y(o).is("filterable",K.filterable),y(o).be("panel","list")])},{default:it(()=>[(se(!0),Ie(Fn,null,Fo(y(I),J=>(se(),Et(y(ja),{key:J[y(E).key],class:ue(y(o).be("panel","item")),value:J[y(E).key],disabled:J[y(E).disabled],"validate-event":!1},{default:it(()=>{var oe;return[Ye(g,{option:(oe=K.optionRender)==null?void 0:oe.call(K,J)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[ir,!y($)&&!y(ha)(K.data)]]),vo(je("p",{class:ue(y(o).be("panel","empty"))},mn(y($)?y(_)("el.transfer.noMatch"):y(_)("el.transfer.noData")),3),[[ir,y($)||y(ha)(K.data)]])],2),y(F)?(se(),Ie("p",{key:0,class:ue(y(o).be("panel","footer"))},[vt(K.$slots,"default")],2)):yt("v-if",!0)],2))}});var nP=fn(Ece,[["__file","transfer-panel.vue"]]);const Mce=qe({name:"ElTransfer"}),Ice=qe({...Mce,props:sp,emits:_ce,setup(e,{expose:t,emit:i}){const a=e,d=Ri(),{t:g}=qo(),_=Xt("transfer"),{formItem:o}=xs(),S=dr({leftChecked:[],rightChecked:[]}),E=p_(a),{sourceData:I,targetData:R}=Sce(a),{onSourceCheckedChange:z,onTargetCheckedChange:N}=wce(S,i),{addToLeft:$,addToRight:F}=Tce(a,S,i),W=xe(),U=xe(),re=fe=>{switch(fe){case"left":W.value.query="";break;case"right":U.value.query="";break}},K=ee(()=>a.buttonTexts.length===2),q=ee(()=>a.titles[0]||g("el.transfer.titles.0")),J=ee(()=>a.titles[1]||g("el.transfer.titles.1")),oe=ee(()=>a.filterPlaceholder||g("el.transfer.filterPlaceholder"));qt(()=>a.modelValue,()=>{var fe;a.validateEvent&&((fe=o==null?void 0:o.validate)==null||fe.call(o,"change").catch(ge=>void 0))});const ae=ee(()=>fe=>{var ge;if(a.renderContent)return a.renderContent(Kn,fe);const ce=(((ge=d.default)==null?void 0:ge.call(d,{option:fe}))||[]).filter(de=>de.type!==Ni);return ce.length?ce:Kn("span",fe[E.value.label]||fe[E.value.key])});return t({clearQuery:re,leftPanel:W,rightPanel:U}),(fe,ge)=>(se(),Ie("div",{class:ue(y(_).b())},[Ye(nP,{ref_key:"leftPanel",ref:W,data:y(I),"option-render":y(ae),placeholder:y(oe),title:y(q),filterable:fe.filterable,format:fe.format,"filter-method":fe.filterMethod,"default-checked":fe.leftDefaultChecked,props:a.props,onCheckedChange:y(z)},{default:it(()=>[vt(fe.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),je("div",{class:ue(y(_).e("buttons"))},[Ye(y($i),{type:"primary",class:ue([y(_).e("button"),y(_).is("with-texts",y(K))]),disabled:y(ha)(S.rightChecked),onClick:y($)},{default:it(()=>[Ye(y(Dn),null,{default:it(()=>[Ye(y(td))]),_:1}),y(jr)(fe.buttonTexts[0])?yt("v-if",!0):(se(),Ie("span",{key:0},mn(fe.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),Ye(y($i),{type:"primary",class:ue([y(_).e("button"),y(_).is("with-texts",y(K))]),disabled:y(ha)(S.leftChecked),onClick:y(F)},{default:it(()=>[y(jr)(fe.buttonTexts[1])?yt("v-if",!0):(se(),Ie("span",{key:0},mn(fe.buttonTexts[1]),1)),Ye(y(Dn),null,{default:it(()=>[Ye(y(Fs))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),Ye(nP,{ref_key:"rightPanel",ref:U,data:y(R),"option-render":y(ae),placeholder:y(oe),filterable:fe.filterable,format:fe.format,"filter-method":fe.filterMethod,title:y(J),"default-checked":fe.rightDefaultChecked,props:a.props,onCheckedChange:y(N)},{default:it(()=>[vt(fe.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var Ace=fn(Ice,[["__file","transfer.vue"]]);const kce=uo(Ace),xp="$treeNodeId",oP=function(e,t){!t||t[xp]||Object.defineProperty(t,xp,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},gC=function(e,t){return e?t[e]:t[xp]},iS=(e,t,i)=>{const a=e.value.currentNode;i();const d=e.value.currentNode;a!==d&&t("current-change",d?d.data:null,d)},sS=e=>{let t=!0,i=!0,a=!0;for(let d=0,g=e.length;d<g;d++){const _=e[d];(_.checked!==!0||_.indeterminate)&&(t=!1,_.disabled||(a=!1)),(_.checked!==!1||_.indeterminate)&&(i=!1)}return{all:t,none:i,allWithoutDisable:a,half:!t&&!i}},rv=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:i,half:a}=sS(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):a?(e.checked=!1,e.indeterminate=!0):i&&(e.checked=!1,e.indeterminate=!1);const d=e.parent;!d||d.level===0||e.store.checkStrictly||rv(d)},C0=function(e,t){const i=e.store.props,a=e.data||{},d=i[t];if(Nn(d))return d(a,e);if(Bn(d))return a[d];if(jr(d)){const g=a[t];return g===void 0?"":g}};let Pce=0,aS=class H0{constructor(t){this.id=Pce++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const i in t)or(t,i)&&(this[i]=t[i]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const i=t.props;if(i&&typeof i.isLeaf<"u"){const g=C0(this,"isLeaf");Lr(g)&&(this.isLeafByUser=g)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),sn(this.data)||oP(this,this.data),!this.data)return;const a=t.defaultExpandedKeys,d=t.key;d&&a&&a.includes(this.key)&&this.expand(null,t.autoExpandParent),d&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){sn(t)||oP(this,t),this.data=t,this.childNodes=[];let i;this.level===0&&sn(this.data)?i=this.data:i=C0(this,"children")||[];for(let a=0,d=i.length;a<d;a++)this.insertChild({data:i[a]})}get label(){return C0(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return C0(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return t.childNodes[i+1]}return null}get previousSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return i>0?t.childNodes[i-1]:null}return null}contains(t,i=!0){return(this.childNodes||[]).some(a=>a===t||i&&a.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,i,a){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof H0)){if(!a){const d=this.getChildren(!0);d.includes(t.data)||(jr(i)||i<0?d.push(t.data):d.splice(i,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=dr(new H0(t)),t instanceof H0&&t.initialize()}t.level=this.level+1,jr(i)||i<0?this.childNodes.push(t):this.childNodes.splice(i,0,t),this.updateLeafState()}insertBefore(t,i){let a;i&&(a=this.childNodes.indexOf(i)),this.insertChild(t,a)}insertAfter(t,i){let a;i&&(a=this.childNodes.indexOf(i),a!==-1&&(a+=1)),this.insertChild(t,a)}removeChild(t){const i=this.getChildren()||[],a=i.indexOf(t.data);a>-1&&i.splice(a,1);const d=this.childNodes.indexOf(t);d>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(d,1)),this.updateLeafState()}removeChildByData(t){let i=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===t){i=this.childNodes[a];break}i&&this.removeChild(i)}expand(t,i){const a=()=>{if(i){let d=this.parent;for(;d.level>0;)d.expanded=!0,d=d.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(d=>{d.canFocus=!0})};this.shouldLoadData()?this.loadData(d=>{sn(d)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||rv(this),a())}):a()}doCreateChildren(t,i={}){t.forEach(a=>{this.insertChild(Object.assign({data:a},i),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,i,a,d){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:_,allWithoutDisable:o}=sS(this.childNodes);!this.isLeaf&&!_&&o&&(this.checked=!1,t=!1);const S=()=>{if(i){const E=this.childNodes;for(let z=0,N=E.length;z<N;z++){const $=E[z];d=d||t!==!1;const F=$.disabled?$.checked:d;$.setChecked(F,i,!0,d)}const{half:I,all:R}=sS(E);R||(this.checked=R,this.indeterminate=I)}};if(this.shouldLoadData()){this.loadData(()=>{S(),rv(this)},{checked:t!==!1});return}else S()}const g=this.parent;!g||g.level===0||a||rv(g)}getChildren(t=!1){if(this.level===0)return this.data;const i=this.data;if(!i)return null;const a=this.store.props;let d="children";return a&&(d=a.children||"children"),i[d]===void 0&&(i[d]=null),t&&!i[d]&&(i[d]=[]),i[d]}updateChildren(){const t=this.getChildren()||[],i=this.childNodes.map(g=>g.data),a={},d=[];t.forEach((g,_)=>{const o=g[xp];!!o&&i.findIndex(E=>E[xp]===o)>=0?a[o]={index:_,data:g}:d.push({index:_,data:g})}),this.store.lazy||i.forEach(g=>{a[g[xp]]||this.removeChildByData(g)}),d.forEach(({index:g,data:_})=>{this.insertChild({data:_},g)}),this.updateLeafState()}loadData(t,i={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(i).length)){this.loading=!0;const a=g=>{this.childNodes=[],this.doCreateChildren(g,i),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,g)},d=()=>{this.loading=!1};this.store.load(this,a,d)}else t&&t.call(this)}eachNode(t){const i=[this];for(;i.length;){const a=i.shift();i.unshift(...a.childNodes),t(a)}}reInitChecked(){this.store.checkStrictly||rv(this)}};class Rce{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const i in t)or(t,i)&&(this[i]=t[i]);this.nodesMap={}}initialize(){if(this.root=new aS({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,i=>{this.root.doCreateChildren(i),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const i=this.filterNodeMethod,a=this.lazy,d=function(g){const _=g.root?g.root.childNodes:g.childNodes;if(_.forEach(o=>{o.visible=i.call(o,t,o.data,o),d(o)}),!g.visible&&_.length){let o=!0;o=!_.some(S=>S.visible),g.root?g.root.visible=o===!1:g.visible=o===!1}t&&g.visible&&!g.isLeaf&&(!a||g.loaded)&&g.expand()};d(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof aS)return t;const i=So(t)?gC(this.key,t):t;return this.nodesMap[i]||null}insertBefore(t,i){const a=this.getNode(i);a.parent.insertBefore({data:t},a)}insertAfter(t,i){const a=this.getNode(i);a.parent.insertAfter({data:t},a)}remove(t){const i=this.getNode(t);i&&i.parent&&(i===this.currentNode&&(this.currentNode=null),i.parent.removeChild(i))}append(t,i){const a=Th(i)?this.root:this.getNode(i);a&&a.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],i=this.nodesMap;t.forEach(a=>{const d=i[a];d&&d.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const i=this.key;!t||!t.data||(i?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,i=!1){const a=[],d=function(g){(g.root?g.root.childNodes:g.childNodes).forEach(o=>{(o.checked||i&&o.indeterminate)&&(!t||t&&o.isLeaf)&&a.push(o.data),d(o)})};return d(this),a}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(i=>(i||{})[this.key])}getHalfCheckedNodes(){const t=[],i=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(g=>{g.indeterminate&&t.push(g.data),i(g)})};return i(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],i=this.nodesMap;for(const a in i)or(i,a)&&t.push(i[a]);return t}updateChildren(t,i){const a=this.nodesMap[t];if(!a)return;const d=a.childNodes;for(let g=d.length-1;g>=0;g--){const _=d[g];this.remove(_.data)}for(let g=0,_=i.length;g<_;g++){const o=i[g];this.append(o,a.data)}}_setCheckedKeys(t,i=!1,a){const d=this._getAllNodes().sort((S,E)=>S.level-E.level),g=Object.create(null),_=Object.keys(a);d.forEach(S=>S.setChecked(!1,!1));const o=S=>{S.childNodes.forEach(E=>{var I;g[E.data[t]]=!0,(I=E.childNodes)!=null&&I.length&&o(E)})};for(let S=0,E=d.length;S<E;S++){const I=d[S],R=I.data[t].toString();if(!_.includes(R)){I.checked&&!g[R]&&I.setChecked(!1,!1);continue}if(I.childNodes.length&&o(I),I.isLeaf||this.checkStrictly){I.setChecked(!0,!1);continue}if(I.setChecked(!0,!0),i){I.setChecked(!1,!1);const N=function($){$.childNodes.forEach(W=>{W.isLeaf||W.setChecked(!1,!1),N(W)})};N(I)}}}setCheckedNodes(t,i=!1){const a=this.key,d={};t.forEach(g=>{d[(g||{})[a]]=!0}),this._setCheckedKeys(a,i,d)}setCheckedKeys(t,i=!1){this.defaultCheckedKeys=t;const a=this.key,d={};t.forEach(g=>{d[g]=!0}),this._setCheckedKeys(a,i,d)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(i=>{const a=this.getNode(i);a&&a.expand(null,this.autoExpandParent)})}setChecked(t,i,a){const d=this.getNode(t);d&&d.setChecked(!!i,a)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const i=this.currentNode;i&&(i.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,i=!0){const a=t[this.key],d=this.nodesMap[a];this.setCurrentNode(d),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,i=!0){if(this.currentNodeKey=t,t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(t);a&&(this.setCurrentNode(a),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const Dce=qe({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=Xt("tree"),i=kn("NodeInstance"),a=kn("RootTree");return()=>{const d=e.node,{data:g,store:_}=d;return e.renderContent?e.renderContent(Kn,{_self:i,node:d,data:g,store:_}):vt(a.ctx.slots,"default",{node:d,data:g},()=>[Kn("span",{class:t.be("node","label")},[d.label])])}}});var Lce=fn(Dce,[["__file","tree-node-content.vue"]]);function _4(e){const t=kn("TreeNodeMap",null),i={treeNodeExpand:a=>{e.node!==a&&e.node.collapse()},children:[]};return t&&t.children.push(i),Bo("TreeNodeMap",i),{broadcastExpanded:a=>{if(e.accordion)for(const d of i.children)d.treeNodeExpand(a)}}}const y4=Symbol("dragEvents");function Oce({props:e,ctx:t,el$:i,dropIndicator$:a,store:d}){const g=Xt("tree"),_=xe({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return Bo(y4,{treeNodeDragStart:({event:I,treeNode:R})=>{if(Nn(e.allowDrag)&&!e.allowDrag(R.node))return I.preventDefault(),!1;I.dataTransfer.effectAllowed="move";try{I.dataTransfer.setData("text/plain","")}catch{}_.value.draggingNode=R,t.emit("node-drag-start",R.node,I)},treeNodeDragOver:({event:I,treeNode:R})=>{const z=R,N=_.value.dropNode;N&&N.node.id!==z.node.id&&ys(N.$el,g.is("drop-inner"));const $=_.value.draggingNode;if(!$||!z)return;let F=!0,W=!0,U=!0,re=!0;Nn(e.allowDrop)&&(F=e.allowDrop($.node,z.node,"prev"),re=W=e.allowDrop($.node,z.node,"inner"),U=e.allowDrop($.node,z.node,"next")),I.dataTransfer.dropEffect=W||F||U?"move":"none",(F||W||U)&&(N==null?void 0:N.node.id)!==z.node.id&&(N&&t.emit("node-drag-leave",$.node,N.node,I),t.emit("node-drag-enter",$.node,z.node,I)),F||W||U?_.value.dropNode=z:_.value.dropNode=null,z.node.nextSibling===$.node&&(U=!1),z.node.previousSibling===$.node&&(F=!1),z.node.contains($.node,!1)&&(W=!1),($.node===z.node||$.node.contains(z.node))&&(F=!1,W=!1,U=!1);const K=z.$el.querySelector(`.${g.be("node","content")}`).getBoundingClientRect(),q=i.value.getBoundingClientRect();let J;const oe=F?W?.25:U?.45:1:-1,ae=U?W?.75:F?.55:0:1;let fe=-9999;const ge=I.clientY-K.top;ge<K.height*oe?J="before":ge>K.height*ae?J="after":W?J="inner":J="none";const ce=z.$el.querySelector(`.${g.be("node","expand-icon")}`).getBoundingClientRect(),de=a.value;J==="before"?fe=ce.top-q.top:J==="after"&&(fe=ce.bottom-q.top),de.style.top=`${fe}px`,de.style.left=`${ce.right-q.left}px`,J==="inner"?Oa(z.$el,g.is("drop-inner")):ys(z.$el,g.is("drop-inner")),_.value.showDropIndicator=J==="before"||J==="after",_.value.allowDrop=_.value.showDropIndicator||re,_.value.dropType=J,t.emit("node-drag-over",$.node,z.node,I)},treeNodeDragEnd:I=>{const{draggingNode:R,dropType:z,dropNode:N}=_.value;if(I.preventDefault(),I.dataTransfer&&(I.dataTransfer.dropEffect="move"),R&&N){const $={data:R.node.data};z!=="none"&&R.node.remove(),z==="before"?N.node.parent.insertBefore($,N.node):z==="after"?N.node.parent.insertAfter($,N.node):z==="inner"&&N.node.insertChild($),z!=="none"&&(d.value.registerNode($),d.value.key&&R.node.eachNode(F=>{var W;(W=d.value.nodesMap[F.data[d.value.key]])==null||W.setChecked(F.checked,!d.value.checkStrictly)})),ys(N.$el,g.is("drop-inner")),t.emit("node-drag-end",R.node,N.node,z,I),z!=="none"&&t.emit("node-drop",R.node,N.node,z,I)}R&&!N&&t.emit("node-drag-end",R.node,null,z,I),_.value.showDropIndicator=!1,_.value.draggingNode=null,_.value.dropNode=null,_.value.allowDrop=!0}}),{dragState:_}}const zce=qe({name:"ElTreeNode",components:{ElCollapseTransition:s1,ElCheckbox:ja,NodeContent:Lce,ElIcon:Dn,Loading:ql},props:{node:{type:aS,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const i=Xt("tree"),{broadcastExpanded:a}=_4(e),d=kn("RootTree"),g=xe(!1),_=xe(!1),o=xe(null),S=xe(null),E=xe(null),I=kn(y4),R=To();Bo("NodeInstance",R),e.node.expanded&&(g.value=!0,_.value=!0);const z=d.props.props.children||"children";qt(()=>{const ge=e.node.data[z];return ge&&[...ge]},()=>{e.node.updateChildren()}),qt(()=>e.node.indeterminate,ge=>{F(e.node.checked,ge)}),qt(()=>e.node.checked,ge=>{F(ge,e.node.indeterminate)}),qt(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),qt(()=>e.node.expanded,ge=>{Un(()=>g.value=ge),ge&&(_.value=!0)});const N=ge=>gC(d.props.nodeKey,ge.data),$=ge=>{const ce=e.props.class;if(!ce)return{};let de;if(Nn(ce)){const{data:_e}=ge;de=ce(_e,ge)}else de=ce;return Bn(de)?{[de]:!0}:de},F=(ge,ce)=>{(o.value!==ge||S.value!==ce)&&d.ctx.emit("check-change",e.node.data,ge,ce),o.value=ge,S.value=ce},W=ge=>{iS(d.store,d.ctx.emit,()=>{var ce;if((ce=d==null?void 0:d.props)==null?void 0:ce.nodeKey){const _e=N(e.node);d.store.value.setCurrentNodeKey(_e)}else d.store.value.setCurrentNode(e.node)}),d.currentNode.value=e.node,d.props.expandOnClickNode&&re(),d.props.checkOnClickNode&&!e.node.disabled&&K(null,{target:{checked:!e.node.checked}}),d.ctx.emit("node-click",e.node.data,e.node,R,ge)},U=ge=>{d.instance.vnode.props.onNodeContextmenu&&(ge.stopPropagation(),ge.preventDefault()),d.ctx.emit("node-contextmenu",ge,e.node.data,e.node,R)},re=()=>{e.node.isLeaf||(g.value?(d.ctx.emit("node-collapse",e.node.data,e.node,R),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,R)}))},K=(ge,ce)=>{e.node.setChecked(ce.target.checked,!d.props.checkStrictly),Un(()=>{const de=d.store.value;d.ctx.emit("check",e.node.data,{checkedNodes:de.getCheckedNodes(),checkedKeys:de.getCheckedKeys(),halfCheckedNodes:de.getHalfCheckedNodes(),halfCheckedKeys:de.getHalfCheckedKeys()})})};return{ns:i,node$:E,tree:d,expanded:g,childNodeRendered:_,oldChecked:o,oldIndeterminate:S,getNodeKey:N,getNodeClass:$,handleSelectChange:F,handleClick:W,handleContextMenu:U,handleExpandIconClick:re,handleCheckChange:K,handleChildNodeExpand:(ge,ce,de)=>{a(ce),d.ctx.emit("node-expand",ge,ce,de)},handleDragStart:ge=>{d.props.draggable&&I.treeNodeDragStart({event:ge,treeNode:e})},handleDragOver:ge=>{ge.preventDefault(),d.props.draggable&&I.treeNodeDragOver({event:ge,treeNode:{$el:E.value,node:e.node}})},handleDrop:ge=>{ge.preventDefault()},handleDragEnd:ge=>{d.props.draggable&&I.treeNodeDragEnd(ge)},CaretRight:FD}}});function Bce(e,t,i,a,d,g){const _=Mo("el-icon"),o=Mo("el-checkbox"),S=Mo("loading"),E=Mo("node-content"),I=Mo("el-tree-node"),R=Mo("el-collapse-transition");return vo((se(),Ie("div",{ref:"node$",class:ue([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:Xn(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:Xn(e.handleDragStart,["stop"]),onDragover:Xn(e.handleDragOver,["stop"]),onDragend:Xn(e.handleDragEnd,["stop"]),onDrop:Xn(e.handleDrop,["stop"])},[je("div",{class:ue(e.ns.be("node","content")),style:$n({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(se(),Et(_,{key:0,class:ue([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:Xn(e.handleExpandIconClick,["stop"])},{default:it(()=>[(se(),Et(ko(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):yt("v-if",!0),e.showCheckbox?(se(),Et(o,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:Xn(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):yt("v-if",!0),e.node.loading?(se(),Et(_,{key:2,class:ue([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:it(()=>[Ye(S)]),_:1},8,["class"])):yt("v-if",!0),Ye(E,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Ye(R,null,{default:it(()=>[!e.renderAfterExpand||e.childNodeRendered?vo((se(),Ie("div",{key:0,class:ue(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(se(!0),Ie(Fn,null,Fo(e.node.childNodes,z=>(se(),Et(I,{key:e.getNodeKey(z),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:z,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[ir,e.expanded]]):yt("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[ir,e.node.visible]])}var Fce=fn(zce,[["render",Bce],["__file","tree-node.vue"]]);function Nce({el$:e},t){const i=Xt("tree"),a=qr([]),d=qr([]);_o(()=>{_()}),Xl(()=>{a.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),qt(d,o=>{o.forEach(S=>{S.setAttribute("tabindex","-1")})}),wr(e,"keydown",o=>{const S=o.target;if(!S.className.includes(i.b("node")))return;const E=o.code;a.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`));const I=a.value.indexOf(S);let R;if([Cn.up,Cn.down].includes(E)){if(o.preventDefault(),E===Cn.up){R=I===-1?0:I!==0?I-1:a.value.length-1;const N=R;for(;!t.value.getNode(a.value[R].dataset.key).canFocus;){if(R--,R===N){R=-1;break}R<0&&(R=a.value.length-1)}}else{R=I===-1?0:I<a.value.length-1?I+1:0;const N=R;for(;!t.value.getNode(a.value[R].dataset.key).canFocus;){if(R++,R===N){R=-1;break}R>=a.value.length&&(R=0)}}R!==-1&&a.value[R].focus()}[Cn.left,Cn.right].includes(E)&&(o.preventDefault(),S.click());const z=S.querySelector('[type="checkbox"]');[Cn.enter,Cn.numpadEnter,Cn.space].includes(E)&&z&&(o.preventDefault(),z.click())});const _=()=>{var o;a.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`)),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const S=e.value.querySelectorAll(`.${i.is("checked")}[role=treeitem]`);if(S.length){S[0].setAttribute("tabindex","0");return}(o=a.value[0])==null||o.setAttribute("tabindex","0")}}const $ce=qe({name:"ElTree",components:{ElTreeNode:Fce},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Cr}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:i}=qo(),a=Xt("tree"),d=kn(Jp,null),g=xe(new Rce({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));g.value.initialize();const _=xe(g.value.root),o=xe(null),S=xe(null),E=xe(null),{broadcastExpanded:I}=_4(e),{dragState:R}=Oce({props:e,ctx:t,el$:S,dropIndicator$:E,store:g});Nce({el$:S},g);const z=ee(()=>{const{childNodes:Te}=_.value,he=d?d.hasFilteredOptions!==0:!1;return(!Te||Te.length===0||Te.every(({visible:ke})=>!ke))&&!he});qt(()=>e.currentNodeKey,Te=>{g.value.setCurrentNodeKey(Te)}),qt(()=>e.defaultCheckedKeys,Te=>{g.value.setDefaultCheckedKey(Te)}),qt(()=>e.defaultExpandedKeys,Te=>{g.value.setDefaultExpandedKeys(Te)}),qt(()=>e.data,Te=>{g.value.setData(Te)},{deep:!0}),qt(()=>e.checkStrictly,Te=>{g.value.checkStrictly=Te});const N=Te=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");g.value.filter(Te)},$=Te=>gC(e.nodeKey,Te.data),F=Te=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const he=g.value.getNode(Te);if(!he)return[];const ke=[he.data];let Ne=he.parent;for(;Ne&&Ne!==_.value;)ke.push(Ne.data),Ne=Ne.parent;return ke.reverse()},W=(Te,he)=>g.value.getCheckedNodes(Te,he),U=Te=>g.value.getCheckedKeys(Te),re=()=>{const Te=g.value.getCurrentNode();return Te?Te.data:null},K=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const Te=re();return Te?Te[e.nodeKey]:null},q=(Te,he)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");g.value.setCheckedNodes(Te,he)},J=(Te,he)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");g.value.setCheckedKeys(Te,he)},oe=(Te,he,ke)=>{g.value.setChecked(Te,he,ke)},ae=()=>g.value.getHalfCheckedNodes(),fe=()=>g.value.getHalfCheckedKeys(),ge=(Te,he=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");iS(g,t.emit,()=>{I(Te),g.value.setUserCurrentNode(Te,he)})},ce=(Te,he=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");iS(g,t.emit,()=>{I(),g.value.setCurrentNodeKey(Te,he)})},de=Te=>g.value.getNode(Te),_e=Te=>{g.value.remove(Te)},Re=(Te,he)=>{g.value.append(Te,he)},Qe=(Te,he)=>{g.value.insertBefore(Te,he)},Ee=(Te,he)=>{g.value.insertAfter(Te,he)},ye=(Te,he,ke)=>{I(he),t.emit("node-expand",Te,he,ke)},Me=(Te,he)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");g.value.updateChildren(Te,he)};return Bo("RootTree",{ctx:t,props:e,store:g,root:_,currentNode:o,instance:To()}),Bo(Yl,void 0),{ns:a,store:g,root:_,currentNode:o,dragState:R,el$:S,dropIndicator$:E,isEmpty:z,filter:N,getNodeKey:$,getNodePath:F,getCheckedNodes:W,getCheckedKeys:U,getCurrentNode:re,getCurrentKey:K,setCheckedNodes:q,setCheckedKeys:J,setChecked:oe,getHalfCheckedNodes:ae,getHalfCheckedKeys:fe,setCurrentNode:ge,setCurrentKey:ce,t:i,getNode:de,remove:_e,append:Re,insertBefore:Qe,insertAfter:Ee,handleNodeExpand:ye,updateKeyChildren:Me}}});function Vce(e,t,i,a,d,g){const _=Mo("el-tree-node");return se(),Ie("div",{ref:"el$",class:ue([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(se(!0),Ie(Fn,null,Fo(e.root.childNodes,o=>(se(),Et(_,{key:e.getNodeKey(o),node:o,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(se(),Ie("div",{key:0,class:ue(e.ns.e("empty-block"))},[vt(e.$slots,"empty",{},()=>{var o;return[je("span",{class:ue(e.ns.e("empty-text"))},mn((o=e.emptyText)!=null?o:e.t("el.tree.emptyText")),3)]})],2)):yt("v-if",!0),vo(je("div",{ref:"dropIndicator$",class:ue(e.ns.e("drop-indicator"))},null,2),[[ir,e.dragState.showDropIndicator]])],2)}var Uce=fn($ce,[["render",Vce],["__file","tree.vue"]]);const Tb=uo(Uce),jce=(e,{attrs:t,emit:i},{select:a,tree:d,key:g})=>{const _=Xt("tree-select");return qt(()=>e.data,()=>{e.filterable&&Un(()=>{var S,E;(E=d.value)==null||E.filter((S=a.value)==null?void 0:S.states.inputValue)})},{flush:"post"}),{...fl(Vi(e),Object.keys(Ah.props)),...t,"onUpdate:modelValue":S=>i(xo,S),valueKey:g,popperClass:ee(()=>{const S=[_.e("popper")];return e.popperClass&&S.push(e.popperClass),S.join(" ")}),filterMethod:(S="")=>{var E;e.filterMethod?e.filterMethod(S):e.remoteMethod?e.remoteMethod(S):(E=d.value)==null||E.filter(S)}}},Hce=qe({extends:mb,setup(e,t){const i=mb.setup(e,t);delete i.selectOptionClick;const a=To().proxy;return Un(()=>{i.select.states.cachedOptions.get(a.value)||i.select.onOptionCreate(a)}),qt(()=>t.attrs.visible,d=>{i.states.visible=d},{immediate:!0}),i},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function lS(e){return e||e===0}function vC(e){return sn(e)&&e.length}function tp(e){return sn(e)?e:lS(e)?[e]:[]}function G0(e,t,i,a,d){for(let g=0;g<e.length;g++){const _=e[g];if(t(_,g,e,d))return a?a(_,g,e,d):_;{const o=i(_);if(vC(o)){const S=G0(o,t,i,a,_);if(S)return S}}}}function W0(e,t,i,a){for(let d=0;d<e.length;d++){const g=e[d];t(g,d,e,a);const _=i(g);vC(_)&&W0(_,t,i,g)}}const Gce=(e,{attrs:t,slots:i,emit:a},{select:d,tree:g,key:_})=>{qt(()=>e.modelValue,()=>{e.showCheckbox&&Un(()=>{const z=g.value;z&&!qi(z.getCheckedKeys(),tp(e.modelValue))&&z.setCheckedKeys(tp(e.modelValue))})},{immediate:!0,deep:!0});const o=ee(()=>({value:_.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),S=(z,N)=>{var $;const F=o.value[z];return Nn(F)?F(N,($=g.value)==null?void 0:$.getNode(S("value",N))):N[F]},E=tp(e.modelValue).map(z=>G0(e.data||[],N=>S("value",N)===z,N=>S("children",N),(N,$,F,W)=>W&&S("value",W))).filter(z=>lS(z)),I=ee(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const z=[];return W0(e.data.concat(e.cacheData),N=>{const $=S("value",N);z.push({value:$,currentLabel:S("label",N),isDisabled:S("disabled",N)})},N=>S("children",N)),z}),R=()=>{var z;return(z=g.value)==null?void 0:z.getCheckedKeys().filter(N=>{var $;const F=($=g.value)==null?void 0:$.getNode(N);return!Pi(F)&&ha(F.childNodes)})};return{...fl(Vi(e),Object.keys(Tb.props)),...t,nodeKey:_,expandOnClickNode:ee(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:ee(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(E):E),renderContent:(z,{node:N,data:$,store:F})=>z(Hce,{value:S("value",$),label:S("label",$),disabled:S("disabled",$),visible:N.visible},e.renderContent?()=>e.renderContent(z,{node:N,data:$,store:F}):i.default?()=>i.default({node:N,data:$,store:F}):void 0),filterNodeMethod:(z,N,$)=>e.filterNodeMethod?e.filterNodeMethod(z,N,$):z?new RegExp(eT(z),"i").test(S("label",N)||""):!0,onNodeClick:(z,N,$)=>{var F,W,U,re;if((F=t.onNodeClick)==null||F.call(t,z,N,$),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||N.isLeaf)){if(!S("disabled",z)){const K=(W=d.value)==null?void 0:W.states.options.get(S("value",z));(U=d.value)==null||U.handleOptionSelect(K)}}else e.expandOnClickNode&&$.proxy.handleExpandIconClick();(re=d.value)==null||re.focus()}},onCheck:(z,N)=>{var $;if(!e.showCheckbox)return;const F=S("value",z),W={};W0([g.value.store.root],q=>W[q.key]=q,q=>q.childNodes);const U=N.checkedKeys,re=e.multiple?tp(e.modelValue).filter(q=>!(q in W)&&!U.includes(q)):[],K=re.concat(U);if(e.checkStrictly)a(xo,e.multiple?K:K.includes(F)?F:void 0);else if(e.multiple){const q=R();a(xo,re.concat(q))}else{const q=G0([z],ae=>!vC(S("children",ae))&&!S("disabled",ae),ae=>S("children",ae)),J=q?S("value",q):void 0,oe=lS(e.modelValue)&&!!G0([z],ae=>S("value",ae)===e.modelValue,ae=>S("children",ae));a(xo,J===e.modelValue||oe?void 0:J)}Un(()=>{var q;const J=tp(e.modelValue);g.value.setCheckedKeys(J),(q=t.onCheck)==null||q.call(t,z,{checkedKeys:g.value.getCheckedKeys(),checkedNodes:g.value.getCheckedNodes(),halfCheckedKeys:g.value.getHalfCheckedKeys(),halfCheckedNodes:g.value.getHalfCheckedNodes()})}),($=d.value)==null||$.focus()},onNodeExpand:(z,N,$)=>{var F;(F=t.onNodeExpand)==null||F.call(t,z,N,$),Un(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&N.checked){const W={},U=g.value.getCheckedKeys();W0([g.value.store.root],q=>W[q.key]=q,q=>q.childNodes);const re=tp(e.modelValue).filter(q=>!(q in W)&&!U.includes(q)),K=R();a(xo,re.concat(K))}})},cacheOptions:I}};var Wce=qe({props:{data:{type:Array,default:()=>[]}},setup(e){const t=kn(Jp);return qt(()=>e.data,()=>{var i;e.data.forEach(d=>{t.states.cachedOptions.has(d.value)||t.states.cachedOptions.set(d.value,d)});const a=((i=t.selectRef)==null?void 0:i.querySelectorAll("input"))||[];Wo&&!Array.from(a).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const qce=qe({name:"ElTreeSelect",inheritAttrs:!1,props:{...Ah.props,...Tb.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:i,expose:a}=t,d=xe(),g=xe(),_=ee(()=>e.nodeKey||e.valueKey||"value"),o=jce(e,t,{select:d,tree:g,key:_}),{cacheOptions:S,...E}=Gce(e,t,{select:d,tree:g,key:_}),I=dr({});return a(I),_o(()=>{Object.assign(I,{...fl(g.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...fl(d.value,["focus","blur"])})}),()=>Kn(Ah,dr({...o,ref:R=>d.value=R}),{...i,default:()=>[Kn(Wce,{data:S.value}),Kn(Tb,dr({...E,ref:R=>g.value=R}))]})}});var Kce=fn(qce,[["__file","tree-select.vue"]]);const Zce=uo(Kce),_C=Symbol(),Yce={key:-1,level:-1,data:{}};var iv=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e))(iv||{}),cS=(e=>(e.ADD="add",e.DELETE="delete",e))(cS||{});const b4={type:Number,default:26},Xce=cn({data:{type:at(Array),default:()=>oi([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:at(Object),default:()=>oi({children:"children",label:"label",disabled:"disabled",value:"id"})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:at(Array),default:()=>oi([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:at(Array),default:()=>oi([])},indent:{type:Number,default:16},itemSize:b4,icon:{type:Cr},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:at([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:at(Function)},perfMode:{type:Boolean,default:!0}}),Jce=cn({node:{type:at(Object),default:()=>oi(Yce)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:b4}),Qce=cn({node:{type:at(Object),required:!0}}),x4="node-click",w4="node-drop",S4="node-expand",T4="node-collapse",C4="current-change",E4="check",M4="check-change",I4="node-contextmenu",eue={[x4]:(e,t,i)=>e&&t&&i,[w4]:(e,t,i)=>e&&t&&i,[S4]:(e,t)=>e&&t,[T4]:(e,t)=>e&&t,[C4]:(e,t)=>e&&t,[E4]:(e,t)=>e&&t,[M4]:(e,t)=>e&&Lr(t),[I4]:(e,t,i)=>e&&t&&i},tue={click:(e,t)=>!!(e&&t),drop:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&Lr(t)};function nue(e,t){const i=xe(new Set),a=xe(new Set),{emit:d}=To();qt([()=>t.value,()=>e.defaultCheckedKeys],()=>Un(()=>{re(e.defaultCheckedKeys)}),{immediate:!0});const g=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:K,maxLevel:q}=t.value,J=i.value,oe=new Set;for(let ae=q-1;ae>=1;--ae){const fe=K.get(ae);fe&&fe.forEach(ge=>{const ce=ge.children;if(ce){let de=!0,_e=!1;for(const Re of ce){const Qe=Re.key;if(J.has(Qe))_e=!0;else if(oe.has(Qe)){de=!1,_e=!0;break}else de=!1}de?J.add(ge.key):_e?(oe.add(ge.key),J.delete(ge.key)):(J.delete(ge.key),oe.delete(ge.key))}})}a.value=oe},_=K=>i.value.has(K.key),o=K=>a.value.has(K.key),S=(K,q,J=!0)=>{const oe=i.value,ae=(fe,ge)=>{oe[ge?cS.ADD:cS.DELETE](fe.key);const ce=fe.children;!e.checkStrictly&&ce&&ce.forEach(de=>{de.disabled||ae(de,ge)})};ae(K,q),g(),J&&E(K,q)},E=(K,q)=>{const{checkedNodes:J,checkedKeys:oe}=$(),{halfCheckedNodes:ae,halfCheckedKeys:fe}=F();d(E4,K.data,{checkedKeys:oe,checkedNodes:J,halfCheckedKeys:fe,halfCheckedNodes:ae}),d(M4,K.data,q)};function I(K=!1){return $(K).checkedKeys}function R(K=!1){return $(K).checkedNodes}function z(){return F().halfCheckedKeys}function N(){return F().halfCheckedNodes}function $(K=!1){const q=[],J=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:oe}=t.value;i.value.forEach(ae=>{const fe=oe.get(ae);fe&&(!K||K&&fe.isLeaf)&&(J.push(ae),q.push(fe.data))})}return{checkedKeys:J,checkedNodes:q}}function F(){const K=[],q=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:J}=t.value;a.value.forEach(oe=>{const ae=J.get(oe);ae&&(q.push(oe),K.push(ae.data))})}return{halfCheckedNodes:K,halfCheckedKeys:q}}function W(K){i.value.clear(),a.value.clear(),Un(()=>{re(K)})}function U(K,q){if(t!=null&&t.value&&e.showCheckbox){const J=t.value.treeNodeMap.get(K);J&&S(J,q,!1)}}function re(K){if(t!=null&&t.value){const{treeNodeMap:q}=t.value;if(e.showCheckbox&&q&&K)for(const J of K){const oe=q.get(J);oe&&!_(oe)&&S(oe,!0,!1)}}}return{updateCheckedKeys:g,toggleCheckbox:S,isChecked:_,isIndeterminate:o,getCheckedKeys:I,getCheckedNodes:R,getHalfCheckedKeys:z,getHalfCheckedNodes:N,setChecked:U,setCheckedKeys:W}}function oue(e,t){const i=xe(new Set([])),a=xe(new Set([])),d=ee(()=>Nn(e.filterMethod));function g(o){var S;if(!d.value)return;const E=new Set,I=a.value,R=i.value,z=[],N=((S=t.value)==null?void 0:S.treeNodes)||[],$=e.filterMethod;R.clear();function F(W){W.forEach(U=>{z.push(U),$!=null&&$(o,U.data)?z.forEach(K=>{E.add(K.key)}):U.isLeaf&&R.add(U.key);const re=U.children;if(re&&F(re),!U.isLeaf){if(!E.has(U.key))R.add(U.key);else if(re){let K=!0;for(const q of re)if(!R.has(q.key)){K=!1;break}K?I.add(U.key):I.delete(U.key)}}z.pop()})}return F(N),E}function _(o){return a.value.has(o.key)}return{hiddenExpandIconKeySet:a,hiddenNodeKeySet:i,doFilter:g,isForceHiddenExpandIcon:_}}function rue(e,t){const i=xe(new Set(e.defaultExpandedKeys)),a=xe(),d=qr(),g=xe();qt(()=>e.currentNodeKey,At=>{a.value=At},{immediate:!0}),qt(()=>e.data,At=>{Gt(At)},{immediate:!0});const{isIndeterminate:_,isChecked:o,toggleCheckbox:S,getCheckedKeys:E,getCheckedNodes:I,getHalfCheckedKeys:R,getHalfCheckedNodes:z,setChecked:N,setCheckedKeys:$}=nue(e,d),{doFilter:F,hiddenNodeKeySet:W,isForceHiddenExpandIcon:U}=oue(e,d),re=ee(()=>{var At;return((At=e.props)==null?void 0:At.value)||iv.KEY}),K=ee(()=>{var At;return((At=e.props)==null?void 0:At.children)||iv.CHILDREN}),q=ee(()=>{var At;return((At=e.props)==null?void 0:At.disabled)||iv.DISABLED}),J=ee(()=>{var At;return((At=e.props)==null?void 0:At.label)||iv.LABEL}),oe=ee(()=>{var At;const Ge=i.value,Fe=W.value,Nt=[],Jt=((At=d.value)==null?void 0:At.treeNodes)||[],Dt=[];for(let xt=Jt.length-1;xt>=0;--xt)Dt.push(Jt[xt]);for(;Dt.length;){const xt=Dt.pop();if(!Fe.has(xt.key)&&(Nt.push(xt),xt.children&&Ge.has(xt.key)))for(let Ot=xt.children.length-1;Ot>=0;--Ot)Dt.push(xt.children[Ot])}return Nt}),ae=ee(()=>oe.value.length>0);function fe(At){const Ge=new Map,Fe=new Map;let Nt=1;function Jt(xt,Ot=1,en=void 0){var dn;const un=[];for(const Pn of xt){const gt=de(Pn),Sn={level:Ot,key:gt,data:Pn};Sn.label=Re(Pn),Sn.parent=en;const Vn=ce(Pn);Sn.disabled=_e(Pn),Sn.isLeaf=!Vn||Vn.length===0,Vn&&Vn.length&&(Sn.children=Jt(Vn,Ot+1,Sn)),un.push(Sn),Ge.set(gt,Sn),Fe.has(Ot)||Fe.set(Ot,[]),(dn=Fe.get(Ot))==null||dn.push(Sn)}return Ot>Nt&&(Nt=Ot),un}const Dt=Jt(At);return{treeNodeMap:Ge,levelTreeNodeMap:Fe,maxLevel:Nt,treeNodes:Dt}}function ge(At){const Ge=F(At);Ge&&(i.value=Ge)}function ce(At){return At[K.value]}function de(At){return At?At[re.value]:""}function _e(At){return At[q.value]}function Re(At){return At[J.value]}function Qe(At){i.value.has(At.key)?Ne(At):ke(At)}function Ee(At){const Ge=new Set,Fe=d.value.treeNodeMap;At.forEach(Nt=>{let Jt=Fe.get(Nt);for(;Jt&&!Ge.has(Jt.key);)Ge.add(Jt.key),Jt=Jt.parent}),i.value=Ge}function ye(At,Ge){t(x4,At.data,At,Ge),Te(At),e.expandOnClickNode&&Qe(At),e.showCheckbox&&e.checkOnClickNode&&!At.disabled&&S(At,!o(At),!0)}function Me(At,Ge){t(w4,At.data,At,Ge)}function Te(At){Ct(At)||(a.value=At.key,t(C4,At.data,At))}function he(At,Ge){S(At,Ge)}function ke(At){const Ge=i.value;if(d.value&&e.accordion){const{treeNodeMap:Fe}=d.value;Ge.forEach(Nt=>{const Jt=Fe.get(Nt);At&&At.level===(Jt==null?void 0:Jt.level)&&Ge.delete(Nt)})}Ge.add(At.key),t(S4,At.data,At)}function Ne(At){i.value.delete(At.key),t(T4,At.data,At)}function nt(At){return i.value.has(At.key)}function De(At){return!!At.disabled}function Ct(At){const Ge=a.value;return Ge!==void 0&&Ge===At.key}function Rt(){var At,Ge;if(a.value)return(Ge=(At=d.value)==null?void 0:At.treeNodeMap.get(a.value))==null?void 0:Ge.data}function Bt(){return a.value}function mt(At){a.value=At}function Gt(At){Un(()=>d.value=fe(At))}function jt(At){var Ge;const Fe=So(At)?de(At):At;return(Ge=d.value)==null?void 0:Ge.treeNodeMap.get(Fe)}function Be(At,Ge="auto"){const Fe=jt(At);Fe&&g.value&&g.value.scrollToItem(oe.value.indexOf(Fe),Ge)}function an(At){var Ge;(Ge=g.value)==null||Ge.scrollTo(At)}return{tree:d,flattenTree:oe,isNotEmpty:ae,listRef:g,getKey:de,getChildren:ce,toggleExpand:Qe,toggleCheckbox:S,isExpanded:nt,isChecked:o,isIndeterminate:_,isDisabled:De,isCurrent:Ct,isForceHiddenExpandIcon:U,handleNodeClick:ye,handleNodeDrop:Me,handleNodeCheck:he,getCurrentNode:Rt,getCurrentKey:Bt,setCurrentKey:mt,getCheckedKeys:E,getCheckedNodes:I,getHalfCheckedKeys:R,getHalfCheckedNodes:z,setChecked:N,setCheckedKeys:$,filter:ge,setData:Gt,getNode:jt,expandNode:ke,collapseNode:Ne,setExpandedKeys:Ee,scrollToNode:Be,scrollTo:an}}var iue=qe({name:"ElTreeNodeContent",props:Qce,setup(e){const t=kn(_C),i=Xt("tree");return()=>{const a=e.node,{data:d}=a;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:a,data:d}):Kn("span",{class:i.be("node","label")},[a==null?void 0:a.label])}}});const sue=qe({name:"ElTreeNode"}),aue=qe({...sue,props:Jce,emits:tue,setup(e,{emit:t}){const i=e,a=kn(_C),d=Xt("tree"),g=ee(()=>{var z;return(z=a==null?void 0:a.props.indent)!=null?z:16}),_=ee(()=>{var z;return(z=a==null?void 0:a.props.icon)!=null?z:FD}),o=z=>{t("click",i.node,z)},S=z=>{t("drop",i.node,z)},E=()=>{t("toggle",i.node)},I=z=>{t("check",i.node,z)},R=z=>{var N,$,F,W;(F=($=(N=a==null?void 0:a.instance)==null?void 0:N.vnode)==null?void 0:$.props)!=null&&F.onNodeContextmenu&&(z.stopPropagation(),z.preventDefault()),a==null||a.ctx.emit(I4,z,(W=i.node)==null?void 0:W.data,i.node)};return(z,N)=>{var $,F,W;return se(),Ie("div",{ref:"node$",class:ue([y(d).b("node"),y(d).is("expanded",z.expanded),y(d).is("current",z.current),y(d).is("focusable",!z.disabled),y(d).is("checked",!z.disabled&&z.checked)]),role:"treeitem",tabindex:"-1","aria-expanded":z.expanded,"aria-disabled":z.disabled,"aria-checked":z.checked,"data-key":($=z.node)==null?void 0:$.key,onClick:Xn(o,["stop"]),onContextmenu:R,onDragover:Xn(()=>{},["prevent"]),onDragenter:Xn(()=>{},["prevent"]),onDrop:Xn(S,["stop"])},[je("div",{class:ue(y(d).be("node","content")),style:$n({paddingLeft:`${(z.node.level-1)*y(g)}px`,height:z.itemSize+"px"})},[y(_)?(se(),Et(y(Dn),{key:0,class:ue([y(d).is("leaf",!!((F=z.node)!=null&&F.isLeaf)),y(d).is("hidden",z.hiddenExpandIcon),{expanded:!((W=z.node)!=null&&W.isLeaf)&&z.expanded},y(d).be("node","expand-icon")]),onClick:Xn(E,["stop"])},{default:it(()=>[(se(),Et(ko(y(_))))]),_:1},8,["class","onClick"])):yt("v-if",!0),z.showCheckbox?(se(),Et(y(ja),{key:1,"model-value":z.checked,indeterminate:z.indeterminate,disabled:z.disabled,onChange:I,onClick:Xn(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):yt("v-if",!0),Ye(y(iue),{node:z.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var lue=fn(aue,[["__file","tree-node.vue"]]);const cue=qe({name:"ElTreeV2"}),uue=qe({...cue,props:Xce,emits:eue,setup(e,{expose:t,emit:i}){const a=e,d=Ri(),g=ee(()=>a.itemSize);Bo(_C,{ctx:{emit:i,slots:d},props:a,instance:To()}),Bo(Yl,void 0);const{t:_}=qo(),o=Xt("tree"),{flattenTree:S,isNotEmpty:E,listRef:I,toggleExpand:R,isExpanded:z,isIndeterminate:N,isChecked:$,isDisabled:F,isCurrent:W,isForceHiddenExpandIcon:U,handleNodeClick:re,handleNodeDrop:K,handleNodeCheck:q,toggleCheckbox:J,getCurrentNode:oe,getCurrentKey:ae,setCurrentKey:fe,getCheckedKeys:ge,getCheckedNodes:ce,getHalfCheckedKeys:de,getHalfCheckedNodes:_e,setChecked:Re,setCheckedKeys:Qe,filter:Ee,setData:ye,getNode:Me,expandNode:Te,collapseNode:he,setExpandedKeys:ke,scrollToNode:Ne,scrollTo:nt}=rue(a,i);return t({toggleCheckbox:J,getCurrentNode:oe,getCurrentKey:ae,setCurrentKey:fe,getCheckedKeys:ge,getCheckedNodes:ce,getHalfCheckedKeys:de,getHalfCheckedNodes:_e,setChecked:Re,setCheckedKeys:Qe,filter:Ee,setData:ye,getNode:Me,expandNode:Te,collapseNode:he,setExpandedKeys:ke,scrollToNode:Ne,scrollTo:nt}),(De,Ct)=>{var Rt;return se(),Ie("div",{class:ue([y(o).b(),{[y(o).m("highlight-current")]:De.highlightCurrent}]),role:"tree"},[y(E)?(se(),Et(y(Pz),{key:0,ref_key:"listRef",ref:I,"class-name":y(o).b("virtual-list"),data:y(S),total:y(S).length,height:De.height,"item-size":y(g),"perf-mode":De.perfMode},{default:it(({data:Bt,index:mt,style:Gt})=>[(se(),Et(lue,{key:Bt[mt].key,style:$n(Gt),node:Bt[mt],expanded:y(z)(Bt[mt]),"show-checkbox":De.showCheckbox,checked:y($)(Bt[mt]),indeterminate:y(N)(Bt[mt]),"item-size":y(g),disabled:y(F)(Bt[mt]),current:y(W)(Bt[mt]),"hidden-expand-icon":y(U)(Bt[mt]),onClick:y(re),onToggle:y(R),onCheck:y(q),onDrop:y(K)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(se(),Ie("div",{key:1,class:ue(y(o).e("empty-block"))},[je("span",{class:ue(y(o).e("empty-text"))},mn((Rt=De.emptyText)!=null?Rt:y(_)("el.tree.emptyText")),3)],2))],2)}}});var due=fn(uue,[["__file","tree.vue"]]);const hue=uo(due),A4=Symbol("uploadContextKey"),fue="ElUpload";class pue extends Error{constructor(t,i,a,d){super(t),this.name="UploadAjaxError",this.status=i,this.method=a,this.url=d}}function rP(e,t,i){let a;return i.response?a=`${i.response.error||i.response}`:i.responseText?a=`${i.responseText}`:a=`fail to ${t.method} ${e} ${i.status}`,new pue(a,i.status,t.method,e)}function mue(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const gue=e=>{typeof XMLHttpRequest>"u"&&Ai(fue,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,i=e.action;t.upload&&t.upload.addEventListener("progress",g=>{const _=g;_.percent=g.total>0?g.loaded/g.total*100:0,e.onProgress(_)});const a=new FormData;if(e.data)for(const[g,_]of Object.entries(e.data))sn(_)&&_.length?a.append(g,..._):a.append(g,_);a.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(rP(i,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(rP(i,e,t));e.onSuccess(mue(t))}),t.open(e.method,i,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const d=e.headers||{};if(d instanceof Headers)d.forEach((g,_)=>t.setRequestHeader(_,g));else for(const[g,_]of Object.entries(d))Pi(_)||t.setRequestHeader(g,String(_));return t.send(a),t},k4=["text","picture","picture-card"];let vue=1;const uS=()=>Date.now()+vue++,P4=cn({action:{type:String,default:"#"},headers:{type:at(Object)},method:{type:String,default:"post"},data:{type:at([Object,Function,Promise]),default:()=>oi({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:at(Array),default:()=>oi([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:k4,default:"text"},httpRequest:{type:at(Function),default:gue},disabled:Boolean,limit:Number}),_ue=cn({...P4,beforeUpload:{type:at(Function),default:xr},beforeRemove:{type:at(Function)},onRemove:{type:at(Function),default:xr},onChange:{type:at(Function),default:xr},onPreview:{type:at(Function),default:xr},onSuccess:{type:at(Function),default:xr},onProgress:{type:at(Function),default:xr},onError:{type:at(Function),default:xr},onExceed:{type:at(Function),default:xr},crossorigin:{type:at(String)}}),yue=cn({files:{type:at(Array),default:()=>oi([])},disabled:{type:Boolean,default:!1},handlePreview:{type:at(Function),default:xr},listType:{type:String,values:k4,default:"text"},crossorigin:{type:at(String)}}),bue={remove:e=>!!e},xue=qe({name:"ElUploadList"}),wue=qe({...xue,props:yue,emits:bue,setup(e,{emit:t}){const i=e,{t:a}=qo(),d=Xt("upload"),g=Xt("icon"),_=Xt("list"),o=bs(),S=xe(!1),E=ee(()=>[d.b("list"),d.bm("list",i.listType),d.is("disabled",i.disabled)]),I=R=>{t("remove",R)};return(R,z)=>(se(),Et(LR,{tag:"ul",class:ue(y(E)),name:y(_).b()},{default:it(()=>[(se(!0),Ie(Fn,null,Fo(R.files,(N,$)=>(se(),Ie("li",{key:N.uid||N.name,class:ue([y(d).be("list","item"),y(d).is(N.status),{focusing:S.value}]),tabindex:"0",onKeydown:kr(F=>!y(o)&&I(N),["delete"]),onFocus:F=>S.value=!0,onBlur:F=>S.value=!1,onClick:F=>S.value=!1},[vt(R.$slots,"default",{file:N,index:$},()=>[R.listType==="picture"||N.status!=="uploading"&&R.listType==="picture-card"?(se(),Ie("img",{key:0,class:ue(y(d).be("list","item-thumbnail")),src:N.url,crossorigin:R.crossorigin,alt:""},null,10,["src","crossorigin"])):yt("v-if",!0),N.status==="uploading"||R.listType!=="picture-card"?(se(),Ie("div",{key:1,class:ue(y(d).be("list","item-info"))},[je("a",{class:ue(y(d).be("list","item-name")),onClick:Xn(F=>R.handlePreview(N),["prevent"])},[Ye(y(Dn),{class:ue(y(g).m("document"))},{default:it(()=>[Ye(y(AG))]),_:1},8,["class"]),je("span",{class:ue(y(d).be("list","item-file-name")),title:N.name},mn(N.name),11,["title"])],10,["onClick"]),N.status==="uploading"?(se(),Et(y(wz),{key:0,type:R.listType==="picture-card"?"circle":"line","stroke-width":R.listType==="picture-card"?6:2,percentage:Number(N.percentage),style:$n(R.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):yt("v-if",!0)],2)):yt("v-if",!0),je("label",{class:ue(y(d).be("list","item-status-label"))},[R.listType==="text"?(se(),Et(y(Dn),{key:0,class:ue([y(g).m("upload-success"),y(g).m("circle-check")])},{default:it(()=>[Ye(y(rT))]),_:1},8,["class"])):["picture-card","picture"].includes(R.listType)?(se(),Et(y(Dn),{key:1,class:ue([y(g).m("upload-success"),y(g).m("check")])},{default:it(()=>[Ye(y(i_))]),_:1},8,["class"])):yt("v-if",!0)],2),y(o)?yt("v-if",!0):(se(),Et(y(Dn),{key:2,class:ue(y(g).m("close")),onClick:F=>I(N)},{default:it(()=>[Ye(y(yl))]),_:2},1032,["class","onClick"])),yt(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),yt(" This is a bug which needs to be fixed "),yt(" TODO: Fix the incorrect navigation interaction "),y(o)?yt("v-if",!0):(se(),Ie("i",{key:3,class:ue(y(g).m("close-tip"))},mn(y(a)("el.upload.deleteTip")),3)),R.listType==="picture-card"?(se(),Ie("span",{key:4,class:ue(y(d).be("list","item-actions"))},[je("span",{class:ue(y(d).be("list","item-preview")),onClick:F=>R.handlePreview(N)},[Ye(y(Dn),{class:ue(y(g).m("zoom-in"))},{default:it(()=>[Ye(y(UD))]),_:1},8,["class"])],10,["onClick"]),y(o)?yt("v-if",!0):(se(),Ie("span",{key:0,class:ue(y(d).be("list","item-delete")),onClick:F=>I(N)},[Ye(y(Dn),{class:ue(y(g).m("delete"))},{default:it(()=>[Ye(y(MG))]),_:1},8,["class"])],10,["onClick"]))],2)):yt("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),vt(R.$slots,"append")]),_:3},8,["class","name"]))}});var iP=fn(wue,[["__file","upload-list.vue"]]);const Sue=cn({disabled:{type:Boolean,default:!1}}),Tue={file:e=>sn(e)},R4="ElUploadDrag",Cue=qe({name:R4}),Eue=qe({...Cue,props:Sue,emits:Tue,setup(e,{emit:t}){kn(A4)||Ai(R4,"usage: <el-upload><el-upload-dragger /></el-upload>");const a=Xt("upload"),d=xe(!1),g=bs(),_=S=>{if(g.value)return;d.value=!1,S.stopPropagation();const E=Array.from(S.dataTransfer.files);t("file",E)},o=()=>{g.value||(d.value=!0)};return(S,E)=>(se(),Ie("div",{class:ue([y(a).b("dragger"),y(a).is("dragover",d.value)]),onDrop:Xn(_,["prevent"]),onDragover:Xn(o,["prevent"]),onDragleave:Xn(I=>d.value=!1,["prevent"])},[vt(S.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var Mue=fn(Eue,[["__file","upload-dragger.vue"]]);const Iue=cn({...P4,beforeUpload:{type:at(Function),default:xr},onRemove:{type:at(Function),default:xr},onStart:{type:at(Function),default:xr},onSuccess:{type:at(Function),default:xr},onProgress:{type:at(Function),default:xr},onError:{type:at(Function),default:xr},onExceed:{type:at(Function),default:xr}}),Aue=qe({name:"ElUploadContent",inheritAttrs:!1}),kue=qe({...Aue,props:Iue,setup(e,{expose:t}){const i=e,a=Xt("upload"),d=bs(),g=qr({}),_=qr(),o=F=>{if(F.length===0)return;const{autoUpload:W,limit:U,fileList:re,multiple:K,onStart:q,onExceed:J}=i;if(U&&re.length+F.length>U){J(F,re);return}K||(F=F.slice(0,1));for(const oe of F){const ae=oe;ae.uid=uS(),q(ae),W&&S(ae)}},S=async F=>{if(_.value.value="",!i.beforeUpload)return I(F);let W,U={};try{const K=i.data,q=i.beforeUpload(F);U=xv(i.data)?sb(i.data):i.data,W=await q,xv(i.data)&&qi(K,U)&&(U=sb(i.data))}catch{W=!1}if(W===!1){i.onRemove(F);return}let re=F;W instanceof Blob&&(W instanceof File?re=W:re=new File([W],F.name,{type:F.type})),I(Object.assign(re,{uid:F.uid}),U)},E=async(F,W)=>Nn(F)?F(W):F,I=async(F,W)=>{const{headers:U,data:re,method:K,withCredentials:q,name:J,action:oe,onProgress:ae,onSuccess:fe,onError:ge,httpRequest:ce}=i;try{W=await E(W??re,F)}catch{i.onRemove(F);return}const{uid:de}=F,_e={headers:U||{},withCredentials:q,file:F,data:W,method:K,filename:J,action:oe,onProgress:Qe=>{ae(Qe,F)},onSuccess:Qe=>{fe(Qe,F),delete g.value[de]},onError:Qe=>{ge(Qe,F),delete g.value[de]}},Re=ce(_e);g.value[de]=Re,Re instanceof Promise&&Re.then(_e.onSuccess,_e.onError)},R=F=>{const W=F.target.files;W&&o(Array.from(W))},z=()=>{d.value||(_.value.value="",_.value.click())},N=()=>{z()};return t({abort:F=>{tG(g.value).filter(F?([U])=>String(F.uid)===U:()=>!0).forEach(([U,re])=>{re instanceof XMLHttpRequest&&re.abort(),delete g.value[U]})},upload:S}),(F,W)=>(se(),Ie("div",{class:ue([y(a).b(),y(a).m(F.listType),y(a).is("drag",F.drag),y(a).is("disabled",y(d))]),tabindex:y(d)?"-1":"0",onClick:z,onKeydown:kr(Xn(N,["self"]),["enter","space"])},[F.drag?(se(),Et(Mue,{key:0,disabled:y(d),onFile:o},{default:it(()=>[vt(F.$slots,"default")]),_:3},8,["disabled"])):vt(F.$slots,"default",{key:1}),je("input",{ref_key:"inputRef",ref:_,class:ue(y(a).e("input")),name:F.name,disabled:y(d),multiple:F.multiple,accept:F.accept,type:"file",onChange:R,onClick:Xn(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var sP=fn(kue,[["__file","upload-content.vue"]]);const aP="ElUpload",lP=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},Pue=(e,t)=>{const i=KR(e,"fileList",void 0,{passive:!0}),a=N=>i.value.find($=>$.uid===N.uid);function d(N){var $;($=t.value)==null||$.abort(N)}function g(N=["ready","uploading","success","fail"]){i.value=i.value.filter($=>!N.includes($.status))}function _(N){i.value=i.value.filter($=>$!==N)}const o=(N,$)=>{const F=a($);F&&(console.error(N),F.status="fail",_(F),e.onError(N,F,i.value),e.onChange(F,i.value))},S=(N,$)=>{const F=a($);F&&(e.onProgress(N,F,i.value),F.status="uploading",F.percentage=Math.round(N.percent))},E=(N,$)=>{const F=a($);F&&(F.status="success",F.response=N,e.onSuccess(N,F,i.value),e.onChange(F,i.value))},I=N=>{Pi(N.uid)&&(N.uid=uS());const $={name:N.name,percentage:0,status:"ready",size:N.size,raw:N,uid:N.uid};if(e.listType==="picture-card"||e.listType==="picture")try{$.url=URL.createObjectURL(N)}catch(F){F.message,e.onError(F,$,i.value)}i.value=[...i.value,$],e.onChange($,i.value)},R=async N=>{const $=N instanceof File?a(N):N;$||Ai(aP,"file to be removed not found");const F=W=>{d(W),_(W),e.onRemove(W,i.value),lP(W)};e.beforeRemove?await e.beforeRemove($,i.value)!==!1&&F($):F($)};function z(){i.value.filter(({status:N})=>N==="ready").forEach(({raw:N})=>{var $;return N&&(($=t.value)==null?void 0:$.upload(N))})}return qt(()=>e.listType,N=>{N!=="picture-card"&&N!=="picture"||(i.value=i.value.map($=>{const{raw:F,url:W}=$;if(!W&&F)try{$.url=URL.createObjectURL(F)}catch(U){e.onError(U,$,i.value)}return $}))}),qt(i,N=>{for(const $ of N)$.uid||($.uid=uS()),$.status||($.status="success")},{immediate:!0,deep:!0}),{uploadFiles:i,abort:d,clearFiles:g,handleError:o,handleProgress:S,handleStart:I,handleSuccess:E,handleRemove:R,submit:z,revokeFileObjectURL:lP}},Rue=qe({name:"ElUpload"}),Due=qe({...Rue,props:_ue,setup(e,{expose:t}){const i=e,a=bs(),d=qr(),{abort:g,submit:_,clearFiles:o,uploadFiles:S,handleStart:E,handleError:I,handleRemove:R,handleSuccess:z,handleProgress:N,revokeFileObjectURL:$}=Pue(i,d),F=ee(()=>i.listType==="picture-card"),W=ee(()=>({...i,fileList:S.value,onStart:E,onProgress:N,onSuccess:z,onError:I,onRemove:R}));return Pr(()=>{S.value.forEach($)}),Bo(A4,{accept:mr(i,"accept")}),t({abort:g,submit:_,clearFiles:o,handleStart:E,handleRemove:R}),(U,re)=>(se(),Ie("div",null,[y(F)&&U.showFileList?(se(),Et(iP,{key:0,disabled:y(a),"list-type":U.listType,files:y(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(R)},Na({append:it(()=>[Ye(sP,Po({ref_key:"uploadRef",ref:d},y(W)),{default:it(()=>[U.$slots.trigger?vt(U.$slots,"trigger",{key:0}):yt("v-if",!0),!U.$slots.trigger&&U.$slots.default?vt(U.$slots,"default",{key:1}):yt("v-if",!0)]),_:3},16)]),_:2},[U.$slots.file?{name:"default",fn:it(({file:K,index:q})=>[vt(U.$slots,"file",{file:K,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):yt("v-if",!0),!y(F)||y(F)&&!U.showFileList?(se(),Et(sP,Po({key:1,ref_key:"uploadRef",ref:d},y(W)),{default:it(()=>[U.$slots.trigger?vt(U.$slots,"trigger",{key:0}):yt("v-if",!0),!U.$slots.trigger&&U.$slots.default?vt(U.$slots,"default",{key:1}):yt("v-if",!0)]),_:3},16)):yt("v-if",!0),U.$slots.trigger?vt(U.$slots,"default",{key:2}):yt("v-if",!0),vt(U.$slots,"tip"),!y(F)&&U.showFileList?(se(),Et(iP,{key:3,disabled:y(a),"list-type":U.listType,files:y(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(R)},Na({_:2},[U.$slots.file?{name:"default",fn:it(({file:K,index:q})=>[vt(U.$slots,"file",{file:K,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):yt("v-if",!0)]))}});var Lue=fn(Due,[["__file","upload.vue"]]);const Oue=uo(Lue),zue=cn({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:at([String,Array]),default:"Element Plus"},font:{type:at(Object)},gap:{type:at(Array),default:()=>[100,100]},offset:{type:at(Array)}});function Bue(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function Fue(e){return Object.keys(e).map(t=>`${Bue(t)}: ${e[t]};`).join(" ")}function Nue(){return window.devicePixelRatio||1}const $ue=(e,t)=>{let i=!1;return e.removedNodes.length&&t&&(i=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(i=!0),i},D4=3;function $w(e,t,i=1){const a=document.createElement("canvas"),d=a.getContext("2d"),g=e*i,_=t*i;return a.setAttribute("width",`${g}px`),a.setAttribute("height",`${_}px`),d.save(),[d,a,g,_]}function Vue(){function e(t,i,a,d,g,_,o,S){const[E,I,R,z]=$w(d,g,a);if(t instanceof HTMLImageElement)E.drawImage(t,0,0,R,z);else{const{color:Ne,fontSize:nt,fontStyle:De,fontWeight:Ct,fontFamily:Rt,textAlign:Bt,textBaseline:mt}=_,Gt=Number(nt)*a;E.font=`${De} normal ${Ct} ${Gt}px/${g}px ${Rt}`,E.fillStyle=Ne,E.textAlign=Bt,E.textBaseline=mt;const jt=sn(t)?t:[t];jt==null||jt.forEach((Be,an)=>{E.fillText(Be??"",R/2,an*(Gt+D4*a))})}const N=Math.PI/180*Number(i),$=Math.max(d,g),[F,W,U]=$w($,$,a);F.translate(U/2,U/2),F.rotate(N),R>0&&z>0&&F.drawImage(I,-R/2,-z/2);function re(Ne,nt){const De=Ne*Math.cos(N)-nt*Math.sin(N),Ct=Ne*Math.sin(N)+nt*Math.cos(N);return[De,Ct]}let K=0,q=0,J=0,oe=0;const ae=R/2,fe=z/2;[[0-ae,0-fe],[0+ae,0-fe],[0+ae,0+fe],[0-ae,0+fe]].forEach(([Ne,nt])=>{const[De,Ct]=re(Ne,nt);K=Math.min(K,De),q=Math.max(q,De),J=Math.min(J,Ct),oe=Math.max(oe,Ct)});const ce=K+U/2,de=J+U/2,_e=q-K,Re=oe-J,Qe=o*a,Ee=S*a,ye=(_e+Qe)*2,Me=Re+Ee,[Te,he]=$w(ye,Me);function ke(Ne=0,nt=0){Te.drawImage(W,ce,de,_e,Re,Ne,nt,_e,Re)}return ke(),ke(_e+Qe,-Re/2-Ee/2),ke(_e+Qe,+Re/2+Ee/2),[he.toDataURL(),ye/a,Me/a]}return e}const Uue=qe({name:"ElWatermark"}),jue=qe({...Uue,props:zue,setup(e){const t=e,i={position:"relative"},a=ee(()=>{var ce,de;return(de=(ce=t.font)==null?void 0:ce.color)!=null?de:"rgba(0,0,0,.15)"}),d=ee(()=>{var ce,de;return(de=(ce=t.font)==null?void 0:ce.fontSize)!=null?de:16}),g=ee(()=>{var ce,de;return(de=(ce=t.font)==null?void 0:ce.fontWeight)!=null?de:"normal"}),_=ee(()=>{var ce,de;return(de=(ce=t.font)==null?void 0:ce.fontStyle)!=null?de:"normal"}),o=ee(()=>{var ce,de;return(de=(ce=t.font)==null?void 0:ce.fontFamily)!=null?de:"sans-serif"}),S=ee(()=>{var ce,de;return(de=(ce=t.font)==null?void 0:ce.textAlign)!=null?de:"center"}),E=ee(()=>{var ce,de;return(de=(ce=t.font)==null?void 0:ce.textBaseline)!=null?de:"hanging"}),I=ee(()=>t.gap[0]),R=ee(()=>t.gap[1]),z=ee(()=>I.value/2),N=ee(()=>R.value/2),$=ee(()=>{var ce,de;return(de=(ce=t.offset)==null?void 0:ce[0])!=null?de:z.value}),F=ee(()=>{var ce,de;return(de=(ce=t.offset)==null?void 0:ce[1])!=null?de:N.value}),W=()=>{const ce={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let de=$.value-z.value,_e=F.value-N.value;return de>0&&(ce.left=`${de}px`,ce.width=`calc(100% - ${de}px)`,de=0),_e>0&&(ce.top=`${_e}px`,ce.height=`calc(100% - ${_e}px)`,_e=0),ce.backgroundPosition=`${de}px ${_e}px`,ce},U=qr(null),re=qr(),K=xe(!1),q=()=>{re.value&&(re.value.remove(),re.value=void 0)},J=(ce,de)=>{var _e;U.value&&re.value&&(K.value=!0,re.value.setAttribute("style",Fue({...W(),backgroundImage:`url('${ce}')`,backgroundSize:`${Math.floor(de)}px`})),(_e=U.value)==null||_e.append(re.value),setTimeout(()=>{K.value=!1}))},oe=ce=>{let de=120,_e=64;const Re=t.image,Qe=t.content,Ee=t.width,ye=t.height;if(!Re&&ce.measureText){ce.font=`${Number(d.value)}px ${o.value}`;const Me=sn(Qe)?Qe:[Qe],Te=Me.map(he=>{const ke=ce.measureText(he);return[ke.width,ke.fontBoundingBoxAscent!==void 0?ke.fontBoundingBoxAscent+ke.fontBoundingBoxDescent:ke.actualBoundingBoxAscent+ke.actualBoundingBoxDescent]});de=Math.ceil(Math.max(...Te.map(he=>he[0]))),_e=Math.ceil(Math.max(...Te.map(he=>he[1])))*Me.length+(Me.length-1)*D4}return[Ee??de,ye??_e]},ae=Vue(),fe=()=>{const de=document.createElement("canvas").getContext("2d"),_e=t.image,Re=t.content,Qe=t.rotate;if(de){re.value||(re.value=document.createElement("div"));const Ee=Nue(),[ye,Me]=oe(de),Te=he=>{const[ke,Ne]=ae(he||"",Qe,Ee,ye,Me,{color:a.value,fontSize:d.value,fontStyle:_.value,fontWeight:g.value,fontFamily:o.value,textAlign:S.value,textBaseline:E.value},I.value,R.value);J(ke,Ne)};if(_e){const he=new Image;he.onload=()=>{Te(he)},he.onerror=()=>{Te(Re)},he.crossOrigin="anonymous",he.referrerPolicy="no-referrer",he.src=_e}else Te(Re)}};return _o(()=>{fe()}),qt(()=>t,()=>{fe()},{deep:!0,flush:"post"}),Pr(()=>{q()}),qR(U,ce=>{K.value||ce.forEach(de=>{$ue(de,re.value)&&(q(),fe())})},{attributes:!0,subtree:!0,childList:!0}),(ce,de)=>(se(),Ie("div",{ref_key:"containerRef",ref:U,style:$n([i])},[vt(ce.$slots,"default")],4))}});var Hue=fn(jue,[["__file","watermark.vue"]]);const Gue=uo(Hue),Wue=cn({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:at(Object)},targetAreaClickable:{type:Boolean,default:!0}}),que=(e,t,i,a,d)=>{const g=xe(null),_=()=>{let R;return Bn(e.value)?R=document.querySelector(e.value):Nn(e.value)?R=e.value():R=e.value,R},o=()=>{const R=_();if(!R||!t.value){g.value=null;return}Kue(R)||R.scrollIntoView(d.value);const{left:z,top:N,width:$,height:F}=R.getBoundingClientRect();g.value={left:z,top:N,width:$,height:F,radius:0}};_o(()=>{qt([t,e],()=>{o()},{immediate:!0}),window.addEventListener("resize",o)}),Pr(()=>{window.removeEventListener("resize",o)});const S=R=>{var z;return(z=sn(i.value.offset)?i.value.offset[R]:i.value.offset)!=null?z:6},E=ee(()=>{var R;if(!g.value)return g.value;const z=S(0),N=S(1),$=((R=i.value)==null?void 0:R.radius)||2;return{left:g.value.left-z,top:g.value.top-N,width:g.value.width+z*2,height:g.value.height+N*2,radius:$}}),I=ee(()=>{const R=_();return!a.value||!R||!window.DOMRect?R||void 0:{getBoundingClientRect(){var z,N,$,F;return window.DOMRect.fromRect({width:((z=E.value)==null?void 0:z.width)||0,height:((N=E.value)==null?void 0:N.height)||0,x:(($=E.value)==null?void 0:$.left)||0,y:((F=E.value)==null?void 0:F.top)||0})}}});return{mergedPosInfo:E,triggerTarget:I}},f1=Symbol("ElTour");function Kue(e){const t=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,{top:a,right:d,bottom:g,left:_}=e.getBoundingClientRect();return a>=0&&_>=0&&d<=t&&g<=i}const Zue=(e,t,i,a,d,g,_,o)=>{const S=xe(),E=xe(),I=xe({}),R={x:S,y:E,placement:a,strategy:d,middlewareData:I},z=ee(()=>{const U=[bL(y(g)),Cq(),Tq(),Yue()];return y(o)&&y(i)&&U.push(xL({element:y(i)})),U}),N=async()=>{if(!Wo)return;const U=y(e),re=y(t);if(!U||!re)return;const K=await wL(U,re,{placement:y(a),strategy:y(d),middleware:y(z)});Mp(R).forEach(q=>{R[q].value=K[q]})},$=ee(()=>{if(!y(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:y(_)};const{overflow:U}=y(I);return{position:y(d),zIndex:y(_),top:y(E)!=null?`${y(E)}px`:"",left:y(S)!=null?`${y(S)}px`:"",maxWidth:U!=null&&U.maxWidth?`${U==null?void 0:U.maxWidth}px`:""}}),F=ee(()=>{if(!y(o))return{};const{arrow:U}=y(I);return{left:(U==null?void 0:U.x)!=null?`${U==null?void 0:U.x}px`:"",top:(U==null?void 0:U.y)!=null?`${U==null?void 0:U.y}px`:""}});let W;return _o(()=>{const U=y(e),re=y(t);U&&re&&(W=wq(U,re,N)),ns(()=>{N()})}),Pr(()=>{W&&W()}),{update:N,contentStyle:$,arrowStyle:F}},Yue=()=>({name:"overflow",async fn(e){const t=await Sq(e);let i=0;return t.left>0&&(i=t.left),t.right>0&&(i=t.right),{data:{maxWidth:e.rects.floating.width-i}}}}),Xue=qe({name:"ElTourMask",inheritAttrs:!1}),Jue=qe({...Xue,props:Wue,setup(e){const t=e,{ns:i}=kn(f1),a=ee(()=>{var o,S;return(S=(o=t.pos)==null?void 0:o.radius)!=null?S:2}),d=ee(()=>{const o=a.value,S=`a${o},${o} 0 0 1`;return{topRight:`${S} ${o},${o}`,bottomRight:`${S} ${-o},${o}`,bottomLeft:`${S} ${-o},${-o}`,topLeft:`${S} ${o},${-o}`}}),g=ee(()=>{const o=window.innerWidth,S=window.innerHeight,E=d.value,I=`M${o},0 L0,0 L0,${S} L${o},${S} L${o},0 Z`,R=a.value;return t.pos?`${I} M${t.pos.left+R},${t.pos.top} h${t.pos.width-R*2} ${E.topRight} v${t.pos.height-R*2} ${E.bottomRight} h${-t.pos.width+R*2} ${E.bottomLeft} v${-t.pos.height+R*2} ${E.topLeft} z`:I}),_=ee(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return dT(mr(t,"visible"),{ns:i}),(o,S)=>o.visible?(se(),Ie("div",Po({key:0,class:y(i).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:o.zIndex,pointerEvents:o.pos&&o.targetAreaClickable?"none":"auto"}},o.$attrs),[(se(),Ie("svg",{style:{width:"100%",height:"100%"}},[je("path",{class:ue(y(i).e("hollow")),style:$n(y(_)),d:y(g)},null,14,["d"])]))],16)):yt("v-if",!0)}});var Que=fn(Jue,[["__file","mask.vue"]]);const ede=["absolute","fixed"],tde=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],yC=cn({placement:{type:at(String),values:tde,default:"bottom"},reference:{type:at(Object),default:null},strategy:{type:at(String),values:ede,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),nde={close:()=>!0},ode=qe({name:"ElTourContent"}),rde=qe({...ode,props:yC,emits:nde,setup(e,{emit:t}){const i=e,a=xe(i.placement),d=xe(i.strategy),g=xe(null),_=xe(null);qt(()=>i.placement,()=>{a.value=i.placement});const{contentStyle:o,arrowStyle:S}=Zue(mr(i,"reference"),g,_,a,d,mr(i,"offset"),mr(i,"zIndex"),mr(i,"showArrow")),E=ee(()=>a.value.split("-")[0]),{ns:I}=kn(f1),R=()=>{t("close")},z=N=>{N.detail.focusReason==="pointer"&&N.preventDefault()};return(N,$)=>(se(),Ie("div",{ref_key:"contentRef",ref:g,style:$n(y(o)),class:ue(y(I).e("content")),"data-side":y(E),tabindex:"-1"},[Ye(y(h_),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":g.value||void 0,onReleaseRequested:R,onFocusoutPrevented:z},{default:it(()=>[vt(N.$slots,"default")]),_:3},8,["focus-trap-el"]),N.showArrow?(se(),Ie("span",{key:0,ref_key:"arrowRef",ref:_,style:$n(y(S)),class:ue(y(I).e("arrow"))},null,6)):yt("v-if",!0)],14,["data-side"]))}});var ide=fn(rde,[["__file","content.vue"]]),sde=qe({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:i}){let a=0;return()=>{var d,g;const _=(d=t.default)==null?void 0:d.call(t),o=[];let S=0;function E(I){sn(I)&&I.forEach(R=>{var z;((z=(R==null?void 0:R.type)||{})==null?void 0:z.name)==="ElTourStep"&&(o.push(R),S+=1)})}return _.length&&E(qu((g=_[0])==null?void 0:g.children)),a!==S&&(a=S,i("update-total",S)),o.length?o[e.current]:null}}});const ade=cn({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:Cr},placement:yC.placement,contentStyle:{type:at([Object])},mask:{type:at([Boolean,Object]),default:!0},gap:{type:at(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:at([Boolean,Object]),default:()=>({block:"center"})},type:{type:at(String)},appendTo:{type:at([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),lde={[xo]:e=>Lr(e),"update:current":e=>Wn(e),close:e=>Wn(e),finish:()=>!0,change:e=>Wn(e)},cde=qe({name:"ElTour"}),ude=qe({...cde,props:ade,emits:lde,setup(e,{emit:t}){const i=e,a=Xt("tour"),d=xe(0),g=xe(),_=KR(i,"current",t,{passive:!0}),o=ee(()=>{var ge;return(ge=g.value)==null?void 0:ge.target}),S=ee(()=>[a.b(),W.value==="primary"?a.m("primary"):""]),E=ee(()=>{var ge;return((ge=g.value)==null?void 0:ge.placement)||i.placement}),I=ee(()=>{var ge,ce;return(ce=(ge=g.value)==null?void 0:ge.contentStyle)!=null?ce:i.contentStyle}),R=ee(()=>{var ge,ce;return(ce=(ge=g.value)==null?void 0:ge.mask)!=null?ce:i.mask}),z=ee(()=>!!R.value&&i.modelValue),N=ee(()=>Lr(R.value)?void 0:R.value),$=ee(()=>{var ge,ce;return!!o.value&&((ce=(ge=g.value)==null?void 0:ge.showArrow)!=null?ce:i.showArrow)}),F=ee(()=>{var ge,ce;return(ce=(ge=g.value)==null?void 0:ge.scrollIntoViewOptions)!=null?ce:i.scrollIntoViewOptions}),W=ee(()=>{var ge,ce;return(ce=(ge=g.value)==null?void 0:ge.type)!=null?ce:i.type}),{nextZIndex:U}=qp(),re=U(),K=ee(()=>{var ge;return(ge=i.zIndex)!=null?ge:re}),{mergedPosInfo:q,triggerTarget:J}=que(o,mr(i,"modelValue"),mr(i,"gap"),R,F);qt(()=>i.modelValue,ge=>{ge||(_.value=0)});const oe=()=>{i.closeOnPressEscape&&(t("update:modelValue",!1),t("close",_.value))},ae=ge=>{d.value=ge},fe=Ri();return Bo(f1,{currentStep:g,current:_,total:d,showClose:mr(i,"showClose"),closeIcon:mr(i,"closeIcon"),mergedType:W,ns:a,slots:fe,updateModelValue(ge){t("update:modelValue",ge)},onClose(){t("close",_.value)},onFinish(){t("finish")},onChange(){t("change",_.value)}}),(ge,ce)=>(se(),Ie(Fn,null,[Ye(y(Yp),{to:ge.appendTo},{default:it(()=>{var de,_e;return[je("div",Po({class:y(S)},ge.$attrs),[Ye(Que,{visible:y(z),fill:(de=y(N))==null?void 0:de.color,style:$n((_e=y(N))==null?void 0:_e.style),pos:y(q),"z-index":y(K),"target-area-clickable":ge.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),ge.modelValue?(se(),Et(ide,{key:y(_),reference:y(J),placement:y(E),"show-arrow":y($),"z-index":y(K),style:$n(y(I)),onClose:oe},{default:it(()=>[Ye(y(sde),{current:y(_),onUpdateTotal:ae},{default:it(()=>[vt(ge.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):yt("v-if",!0)],16)]}),_:3},8,["to"]),yt(" just for IDE "),yt("v-if",!0)],64))}});var dde=fn(ude,[["__file","tour.vue"]]);const hde=cn({target:{type:at([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:Cr},showArrow:{type:Boolean,default:void 0},placement:yC.placement,mask:{type:at([Boolean,Object]),default:void 0},contentStyle:{type:at([Object])},prevButtonProps:{type:at(Object)},nextButtonProps:{type:at(Object)},scrollIntoViewOptions:{type:at([Boolean,Object]),default:void 0},type:{type:at(String)}}),fde={close:()=>!0},pde=qe({name:"ElTourStep"}),mde=qe({...pde,props:hde,emits:fde,setup(e,{emit:t}){const i=e,{Close:a}=aT,{t:d}=qo(),{currentStep:g,current:_,total:o,showClose:S,closeIcon:E,mergedType:I,ns:R,slots:z,updateModelValue:N,onClose:$,onFinish:F,onChange:W}=kn(f1);qt(i,fe=>{g.value=fe},{immediate:!0});const U=ee(()=>{var fe;return(fe=i.showClose)!=null?fe:S.value}),re=ee(()=>{var fe,ge;return(ge=(fe=i.closeIcon)!=null?fe:E.value)!=null?ge:a}),K=fe=>{if(fe)return GH(fe,["children","onClick"])},q=()=>{var fe,ge;_.value-=1,(fe=i.prevButtonProps)!=null&&fe.onClick&&((ge=i.prevButtonProps)==null||ge.onClick()),W()},J=()=>{var fe;_.value>=o.value-1?oe():_.value+=1,(fe=i.nextButtonProps)!=null&&fe.onClick&&i.nextButtonProps.onClick(),W()},oe=()=>{ae(),F()},ae=()=>{N(!1),$(),t("close")};return(fe,ge)=>(se(),Ie(Fn,null,[y(U)?(se(),Ie("button",{key:0,"aria-label":"Close",class:ue(y(R).e("closebtn")),type:"button",onClick:ae},[Ye(y(Dn),{class:ue(y(R).e("close"))},{default:it(()=>[(se(),Et(ko(y(re))))]),_:1},8,["class"])],2)):yt("v-if",!0),je("header",{class:ue([y(R).e("header"),{"show-close":y(S)}])},[vt(fe.$slots,"header",{},()=>[je("span",{role:"heading",class:ue(y(R).e("title"))},mn(fe.title),3)])],2),je("div",{class:ue(y(R).e("body"))},[vt(fe.$slots,"default",{},()=>[je("span",null,mn(fe.description),1)])],2),je("footer",{class:ue(y(R).e("footer"))},[je("div",{class:ue(y(R).b("indicators"))},[y(z).indicators?(se(),Et(ko(y(z).indicators),{key:0,current:y(_),total:y(o)},null,8,["current","total"])):(se(!0),Ie(Fn,{key:1},Fo(y(o),(ce,de)=>(se(),Ie("span",{key:ce,class:ue([y(R).b("indicator"),de===y(_)?"is-active":""])},null,2))),128))],2),je("div",{class:ue(y(R).b("buttons"))},[y(_)>0?(se(),Et(y($i),Po({key:0,size:"small",type:y(I)},K(fe.prevButtonProps),{onClick:q}),{default:it(()=>{var ce,de;return[$o(mn((de=(ce=fe.prevButtonProps)==null?void 0:ce.children)!=null?de:y(d)("el.tour.previous")),1)]}),_:1},16,["type"])):yt("v-if",!0),y(_)<=y(o)-1?(se(),Et(y($i),Po({key:1,size:"small",type:y(I)==="primary"?"default":"primary"},K(fe.nextButtonProps),{onClick:J}),{default:it(()=>{var ce,de;return[$o(mn((de=(ce=fe.nextButtonProps)==null?void 0:ce.children)!=null?de:y(_)===y(o)-1?y(d)("el.tour.finish"):y(d)("el.tour.next")),1)]}),_:1},16,["type"])):yt("v-if",!0)],2)],2)],64))}});var L4=fn(mde,[["__file","step.vue"]]);const gde=uo(dde,{TourStep:L4}),vde=ri(L4),_de=cn({container:{type:at([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:at(String),default:"default"},direction:{type:at(String),default:"vertical"}}),yde={change:e=>Bn(e),click:(e,t)=>e instanceof MouseEvent&&(Bn(t)||jr(t))},O4=Symbol("anchor"),bde=qe({name:"ElAnchor"}),xde=qe({...bde,props:_de,emits:yde,setup(e,{expose:t,emit:i}){const a=e,d=xe(""),g=xe(null),_=xe(null),o=xe(),S={};let E=!1,I=0;const R=Xt("anchor"),z=ee(()=>[R.b(),a.type==="underline"?R.m("underline"):"",R.m(a.direction)]),N=fe=>{S[fe.href]=fe.el},$=fe=>{delete S[fe]},F=fe=>{d.value!==fe&&(d.value=fe,i("change",fe))};let W=null;const U=fe=>{if(!o.value)return;const ge=h0(fe);if(!ge)return;W&&W(),E=!0;const ce=vk(ge,o.value),de=i2(ge,ce),_e=ce.scrollHeight-ce.clientHeight,Re=Math.min(de-a.offset,_e);W=rG(o.value,I,Re,a.duration,()=>{setTimeout(()=>{E=!1},20)})},re=fe=>{fe&&(F(fe),U(fe))},K=(fe,ge)=>{i("click",fe,ge),re(ge)},q=wW(()=>{o.value&&(I=_k(o.value));const fe=J();E||jr(fe)||F(fe)}),J=()=>{if(!o.value)return;const fe=_k(o.value),ge=[];for(const ce of Object.keys(S)){const de=h0(ce);if(!de)continue;const _e=vk(de,o.value),Re=i2(de,_e);ge.push({top:Re-a.offset-a.bound,href:ce})}ge.sort((ce,de)=>ce.top-de.top);for(let ce=0;ce<ge.length;ce++){const de=ge[ce],_e=ge[ce+1];if(ce===0&&fe===0)return"";if(de.top<=fe&&(!_e||_e.top>fe))return de.href}},oe=()=>{const fe=h0(a.container);!fe||Wb(fe)?o.value=window:o.value=fe};wr(o,"scroll",q);const ae=ee(()=>{if(!g.value||!_.value||!d.value)return{};const fe=S[d.value];if(!fe)return{};const ge=g.value.getBoundingClientRect(),ce=_.value.getBoundingClientRect(),de=fe.getBoundingClientRect();return a.direction==="horizontal"?{left:`${de.left-ge.left}px`,width:`${de.width}px`,opacity:1}:{top:`${de.top-ge.top+(de.height-ce.height)/2}px`,opacity:1}});return _o(()=>{oe();const fe=decodeURIComponent(window.location.hash);h0(fe)?re(fe):q()}),qt(()=>a.container,()=>{oe()}),Bo(O4,{ns:R,direction:a.direction,currentAnchor:d,addLink:N,removeLink:$,handleClick:K}),t({scrollTo:re}),(fe,ge)=>(se(),Ie("div",{ref_key:"anchorRef",ref:g,class:ue(y(z))},[fe.marker?(se(),Ie("div",{key:0,ref_key:"markerRef",ref:_,class:ue(y(R).e("marker")),style:$n(y(ae))},null,6)):yt("v-if",!0),je("div",{class:ue(y(R).e("list"))},[vt(fe.$slots,"default")],2)],2))}});var wde=fn(xde,[["__file","anchor.vue"]]);const Sde=cn({title:String,href:String}),Tde=qe({name:"ElAnchorLink"}),Cde=qe({...Tde,props:Sde,setup(e){const t=e,i=xe(null),{ns:a,direction:d,currentAnchor:g,addLink:_,removeLink:o,handleClick:S}=kn(O4),E=ee(()=>[a.e("link"),a.is("active",g.value===t.href)]),I=R=>{S(R,t.href)};return qt(()=>t.href,(R,z)=>{Un(()=>{z&&o(z),R&&_({href:R,el:i.value})})}),_o(()=>{const{href:R}=t;R&&_({href:R,el:i.value})}),Pr(()=>{const{href:R}=t;R&&o(R)}),(R,z)=>(se(),Ie("div",{class:ue(y(a).e("item"))},[je("a",{ref_key:"linkRef",ref:i,class:ue(y(E)),href:R.href,onClick:I},[vt(R.$slots,"default",{},()=>[$o(mn(R.title),1)])],10,["href"]),R.$slots["sub-link"]&&y(d)==="vertical"?(se(),Ie("div",{key:0,class:ue(y(a).e("list"))},[vt(R.$slots,"sub-link")],2)):yt("v-if",!0)],2))}});var z4=fn(Cde,[["__file","anchor-link.vue"]]);const Ede=uo(wde,{AnchorLink:z4}),Mde=ri(z4),Ide=cn({direction:{type:at(String),default:"horizontal"},options:{type:at(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:ki,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...Zi(["ariaLabel"])}),Ade={[xo]:e=>Bn(e)||Wn(e)||Lr(e),[Wr]:e=>Bn(e)||Wn(e)||Lr(e)},kde=qe({name:"ElSegmented"}),Pde=qe({...kde,props:Ide,emits:Ade,setup(e,{emit:t}){const i=e,a=Xt("segmented"),d=Ki(),g=Mi(),_=bs(),{formItem:o}=xs(),{inputId:S,isLabeledByFormItem:E}=Cl(i,{formItemContext:o}),I=xe(null),R=u$(),z=dr({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),N=ge=>{const ce=$(ge);t(xo,ce),t(Wr,ce)},$=ge=>So(ge)?ge.value:ge,F=ge=>So(ge)?ge.label:ge,W=ge=>!!(_.value||So(ge)&&ge.disabled),U=ge=>i.modelValue===$(ge),re=ge=>i.options.find(ce=>$(ce)===ge),K=ge=>[a.e("item"),a.is("selected",U(ge)),a.is("disabled",W(ge))],q=()=>{if(!I.value)return;const ge=I.value.querySelector(".is-selected"),ce=I.value.querySelector(".is-selected input");if(!ge||!ce){z.width=0,z.height=0,z.translateX=0,z.translateY=0,z.focusVisible=!1;return}const de=ge.getBoundingClientRect();z.isInit=!0,i.direction==="vertical"?(z.height=de.height,z.translateY=ge.offsetTop):(z.width=de.width,z.translateX=ge.offsetLeft);try{z.focusVisible=ce.matches(":focus-visible")}catch{}},J=ee(()=>[a.b(),a.m(g.value),a.is("block",i.block)]),oe=ee(()=>({width:i.direction==="vertical"?"100%":`${z.width}px`,height:i.direction==="vertical"?`${z.height}px`:"100%",transform:i.direction==="vertical"?`translateY(${z.translateY}px)`:`translateX(${z.translateX}px)`,display:z.isInit?"block":"none"})),ae=ee(()=>[a.e("item-selected"),a.is("disabled",W(re(i.modelValue))),a.is("focus-visible",z.focusVisible)]),fe=ee(()=>i.name||d.value);return ei(I,q),qt(R,q),qt(()=>i.modelValue,()=>{var ge;q(),i.validateEvent&&((ge=o==null?void 0:o.validate)==null||ge.call(o,"change").catch(ce=>void 0))},{flush:"post"}),(ge,ce)=>ge.options.length?(se(),Ie("div",{key:0,id:y(S),ref_key:"segmentedRef",ref:I,class:ue(y(J)),role:"radiogroup","aria-label":y(E)?void 0:ge.ariaLabel||"segmented","aria-labelledby":y(E)?y(o).labelId:void 0},[je("div",{class:ue([y(a).e("group"),y(a).m(i.direction)])},[je("div",{style:$n(y(oe)),class:ue(y(ae))},null,6),(se(!0),Ie(Fn,null,Fo(ge.options,(de,_e)=>(se(),Ie("label",{key:_e,class:ue(K(de))},[je("input",{class:ue(y(a).e("item-input")),type:"radio",name:y(fe),disabled:W(de),checked:U(de),onChange:Re=>N(de)},null,42,["name","disabled","checked","onChange"]),je("div",{class:ue(y(a).e("item-label"))},[vt(ge.$slots,"default",{item:de},()=>[$o(mn(F(de)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):yt("v-if",!0)}});var Rde=fn(Pde,[["__file","segmented.vue"]]);const Dde=uo(Rde),Lde=(e,t)=>{const i=e.toLowerCase();return(t.label||t.value).toLowerCase().includes(i)},Ode=(e,t,i)=>{const{selectionEnd:a}=e;if(a===null)return;const d=e.value,g=gs(t);let _=-1,o;for(let S=a-1;S>=0;--S){const E=d[S];if(E===i||E===`
`||E==="\r"){_=S;continue}if(g.includes(E)){const I=_===-1?a:_;o={pattern:d.slice(S+1,I),start:S+1,end:I,prefix:E,prefixIndex:S,splitIndex:_,selectionEnd:a};break}}return o},zde=(e,t={debug:!1,useSelectionEnd:!1})=>{const i=e.selectionStart!==null?e.selectionStart:0,a=e.selectionEnd!==null?e.selectionEnd:0,d=t.useSelectionEnd?a:i,g=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(t.debug){const z=document.querySelector("#input-textarea-caret-position-mirror-div");z!=null&&z.parentNode&&z.parentNode.removeChild(z)}const _=document.createElement("div");_.id="input-textarea-caret-position-mirror-div",document.body.appendChild(_);const o=_.style,S=window.getComputedStyle(e),E=e.nodeName==="INPUT";o.whiteSpace=E?"nowrap":"pre-wrap",E||(o.wordWrap="break-word"),o.position="absolute",t.debug||(o.visibility="hidden"),g.forEach(z=>{if(E&&z==="lineHeight")if(S.boxSizing==="border-box"){const N=Number.parseInt(S.height),$=Number.parseInt(S.paddingTop)+Number.parseInt(S.paddingBottom)+Number.parseInt(S.borderTopWidth)+Number.parseInt(S.borderBottomWidth),F=$+Number.parseInt(S.lineHeight);N>F?o.lineHeight=`${N-$}px`:N===F?o.lineHeight=S.lineHeight:o.lineHeight="0"}else o.lineHeight=S.height;else o[z]=S[z]}),BS()?e.scrollHeight>Number.parseInt(S.height)&&(o.overflowY="scroll"):o.overflow="hidden",_.textContent=e.value.slice(0,Math.max(0,d)),E&&_.textContent&&(_.textContent=_.textContent.replace(/\s/g," "));const I=document.createElement("span");I.textContent=e.value.slice(Math.max(0,d))||".",I.style.position="relative",I.style.left=`${-e.scrollLeft}px`,I.style.top=`${-e.scrollTop}px`,_.appendChild(I);const R={top:I.offsetTop+Number.parseInt(S.borderTopWidth),left:I.offsetLeft+Number.parseInt(S.borderLeftWidth),height:Number.parseInt(S.fontSize)*1.5};return t.debug?I.style.backgroundColor="#aaa":document.body.removeChild(_),R.left>=e.clientWidth&&(R.left=e.clientWidth),R},Bde=cn({...PT,options:{type:at(Array),default:()=>[]},prefix:{type:at([String,Array]),default:"@",validator:e=>Bn(e)?e.length===1:e.every(t=>Bn(t)&&t.length===1)},split:{type:String,default:" ",validator:e=>e.length===1},filterOption:{type:at([Boolean,Function]),default:()=>Lde,validator:e=>e===!1?!0:Nn(e)},placement:{type:at(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:at(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:at(Object),default:()=>({})}}),Fde={[xo]:e=>Bn(e),search:(e,t)=>Bn(e)&&Bn(t),select:(e,t)=>Bn(e.value)&&Bn(t),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},Nde=cn({options:{type:at(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),$de={select:e=>Bn(e.value)},Vde=qe({name:"ElMentionDropdown"}),Ude=qe({...Vde,props:Nde,emits:$de,setup(e,{expose:t,emit:i}){const a=e,d=Xt("mention"),{t:g}=qo(),_=xe(-1),o=xe(),S=xe(),E=xe(),I=(K,q)=>[d.be("dropdown","item"),d.is("hovering",_.value===q),d.is("disabled",K.disabled||a.disabled)],R=K=>{K.disabled||a.disabled||i("select",K)},z=K=>{_.value=K},N=ee(()=>a.disabled||a.options.every(K=>K.disabled)),$=ee(()=>a.options[_.value]),F=()=>{$.value&&i("select",$.value)},W=K=>{const{options:q}=a;if(q.length===0||N.value)return;K==="next"?(_.value++,_.value===q.length&&(_.value=0)):K==="prev"&&(_.value--,_.value<0&&(_.value=q.length-1));const J=q[_.value];if(J.disabled){W(K);return}Un(()=>U(J))},U=K=>{var q,J,oe,ae;const{options:fe}=a,ge=fe.findIndex(de=>de.value===K.value),ce=(q=S.value)==null?void 0:q[ge];if(ce){const de=(oe=(J=E.value)==null?void 0:J.querySelector)==null?void 0:oe.call(J,`.${d.be("dropdown","wrap")}`);de&&nT(de,ce)}(ae=o.value)==null||ae.handleScroll()};return qt(()=>a.options,()=>{N.value||a.options.length===0?_.value=-1:_.value=0},{immediate:!0}),t({hoveringIndex:_,navigateOptions:W,selectHoverOption:F,hoverOption:$}),(K,q)=>(se(),Ie("div",{ref_key:"dropdownRef",ref:E,class:ue(y(d).b("dropdown"))},[K.$slots.header?(se(),Ie("div",{key:0,class:ue(y(d).be("dropdown","header"))},[vt(K.$slots,"header")],2)):yt("v-if",!0),vo(Ye(y(nc),{id:K.contentId,ref_key:"scrollbarRef",ref:o,tag:"ul","wrap-class":y(d).be("dropdown","wrap"),"view-class":y(d).be("dropdown","list"),role:"listbox","aria-label":K.ariaLabel,"aria-orientation":"vertical"},{default:it(()=>[(se(!0),Ie(Fn,null,Fo(K.options,(J,oe)=>(se(),Ie("li",{id:`${K.contentId}-${oe}`,ref_for:!0,ref_key:"optionRefs",ref:S,key:oe,class:ue(I(J,oe)),role:"option","aria-disabled":J.disabled||K.disabled||void 0,"aria-selected":_.value===oe,onMousemove:ae=>z(oe),onClick:Xn(ae=>R(J),["stop"])},[vt(K.$slots,"label",{item:J,index:oe},()=>{var ae;return[je("span",null,mn((ae=J.label)!=null?ae:J.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[ir,K.options.length>0&&!K.loading]]),K.loading?(se(),Ie("div",{key:1,class:ue(y(d).be("dropdown","loading"))},[vt(K.$slots,"loading",{},()=>[$o(mn(y(g)("el.mention.loading")),1)])],2)):yt("v-if",!0),K.$slots.footer?(se(),Ie("div",{key:2,class:ue(y(d).be("dropdown","footer"))},[vt(K.$slots,"footer")],2)):yt("v-if",!0)],2))}});var jde=fn(Ude,[["__file","mention-dropdown.vue"]]);const Hde=qe({name:"ElMention",inheritAttrs:!1}),Gde=qe({...Hde,props:Bde,emits:Fde,setup(e,{expose:t,emit:i}){const a=e,d=ee(()=>fl(a,Object.keys(PT))),g=Xt("mention"),_=bs(),o=Ki(),S=xe(),E=xe(),I=xe(),R=xe(!1),z=xe(),N=xe(),$=ee(()=>a.showArrow?a.placement:`${a.placement}-start`),F=ee(()=>a.showArrow?["bottom","top"]:["bottom-start","top-start"]),W=ee(()=>{const{filterOption:_e,options:Re}=a;return!N.value||!_e?Re:Re.filter(Qe=>_e(N.value.pattern,Qe))}),U=ee(()=>R.value&&(!!W.value.length||a.loading)),re=ee(()=>{var _e;return`${o.value}-${(_e=I.value)==null?void 0:_e.hoveringIndex}`}),K=_e=>{i("update:modelValue",_e),ge()},q=_e=>{var Re,Qe,Ee,ye;if(!(!("code"in _e)||(Re=S.value)!=null&&Re.isComposing))switch(_e.code){case Cn.left:case Cn.right:ge();break;case Cn.up:case Cn.down:if(!R.value)return;_e.preventDefault(),(Qe=I.value)==null||Qe.navigateOptions(_e.code===Cn.up?"prev":"next");break;case Cn.enter:case Cn.numpadEnter:if(!R.value)return;_e.preventDefault(),(Ee=I.value)!=null&&Ee.hoverOption?(ye=I.value)==null||ye.selectHoverOption():R.value=!1;break;case Cn.esc:if(!R.value)return;_e.preventDefault(),R.value=!1;break;case Cn.backspace:if(a.whole&&N.value){const{splitIndex:Me,selectionEnd:Te,pattern:he,prefixIndex:ke,prefix:Ne}=N.value,nt=fe();if(!nt)return;const De=nt.value,Ct=a.options.find(Bt=>Bt.value===he);if((Nn(a.checkIsWhole)?a.checkIsWhole(he,Ne):Ct)&&Me!==-1&&Me+1===Te){_e.preventDefault();const Bt=De.slice(0,ke)+De.slice(Me+1);i(xo,Bt);const mt=ke;Un(()=>{nt.selectionStart=mt,nt.selectionEnd=mt,de()})}}}},{wrapperRef:J}=Oh(S,{beforeFocus(){return _.value},afterFocus(){ge()},beforeBlur(_e){var Re;return(Re=E.value)==null?void 0:Re.isFocusInsideContent(_e)},afterBlur(){R.value=!1}}),oe=()=>{ge()},ae=_e=>{if(!N.value)return;const Re=fe();if(!Re)return;const Qe=Re.value,{split:Ee}=a,ye=Qe.slice(N.value.end),Me=ye.startsWith(Ee),Te=`${_e.value}${Me?"":Ee}`,he=Qe.slice(0,N.value.start)+Te+ye;i(xo,he),i("select",_e,N.value.prefix);const ke=N.value.start+Te.length+(Me?1:0);Un(()=>{Re.selectionStart=ke,Re.selectionEnd=ke,Re.focus(),de()})},fe=()=>{var _e,Re;return a.type==="textarea"?(_e=S.value)==null?void 0:_e.textarea:(Re=S.value)==null?void 0:Re.input},ge=()=>{setTimeout(()=>{ce(),de(),Un(()=>{var _e;return(_e=E.value)==null?void 0:_e.updatePopper()})},0)},ce=()=>{const _e=fe();if(!_e)return;const Re=zde(_e),Qe=_e.getBoundingClientRect(),Ee=S.value.$el.getBoundingClientRect();z.value={position:"absolute",width:0,height:`${Re.height}px`,left:`${Re.left+Qe.left-Ee.left}px`,top:`${Re.top+Qe.top-Ee.top}px`}},de=()=>{const _e=fe();if(document.activeElement!==_e){R.value=!1;return}const{prefix:Re,split:Qe}=a;if(N.value=Ode(_e,Re,Qe),N.value&&N.value.splitIndex===-1){R.value=!0,i("search",N.value.pattern,N.value.prefix);return}R.value=!1};return t({input:S,tooltip:E,dropdownVisible:U}),(_e,Re)=>(se(),Ie("div",{ref_key:"wrapperRef",ref:J,class:ue(y(g).b())},[Ye(y(_s),Po(Po(y(d),_e.$attrs),{ref_key:"elInputRef",ref:S,"model-value":_e.modelValue,disabled:y(_),role:y(U)?"combobox":void 0,"aria-activedescendant":y(U)?y(re)||"":void 0,"aria-controls":y(U)?y(o):void 0,"aria-expanded":y(U)||void 0,"aria-label":_e.ariaLabel,"aria-autocomplete":y(U)?"none":void 0,"aria-haspopup":y(U)?"listbox":void 0,onInput:K,onKeydown:q,onMousedown:oe}),Na({_:2},[Fo(_e.$slots,(Qe,Ee)=>({name:Ee,fn:it(ye=>[vt(_e.$slots,Ee,hl(Xu(ye)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),Ye(y(rs),{ref_key:"tooltipRef",ref:E,visible:y(U),"popper-class":[y(g).e("popper"),_e.popperClass],"popper-options":_e.popperOptions,placement:y($),"fallback-placements":y(F),effect:"light",pure:"",offset:_e.offset,"show-arrow":_e.showArrow},{default:it(()=>[je("div",{style:$n(z.value)},null,4)]),content:it(()=>{var Qe;return[Ye(jde,{ref_key:"dropdownRef",ref:I,options:y(W),disabled:y(_),loading:_e.loading,"content-id":y(o),"aria-label":_e.ariaLabel,onSelect:ae,onClick:Xn((Qe=S.value)==null?void 0:Qe.focus,["stop"])},Na({_:2},[Fo(_e.$slots,(Ee,ye)=>({name:ye,fn:it(Me=>[vt(_e.$slots,ye,hl(Xu(Me)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var Wde=fn(Gde,[["__file","mention.vue"]]);const qde=uo(Wde);var Kde=[Gq,n7,xZ,ple,MZ,LZ,UL,WZ,qZ,$i,ZL,uX,mX,MX,IX,IJ,RO,LJ,ja,UX,SO,WJ,lQ,cQ,s1,LQ,Bq,WQ,qQ,KQ,ZQ,YQ,Uee,Jee,Qee,dte,nz,xte,une,dne,hne,dz,K7,Z7,Dn,kne,hz,_s,fz,Vne,aoe,loe,coe,uoe,goe,are,fre,wre,NL,wz,kO,tJ,eJ,Rre,Bre,VJ,nc,Ah,mb,Voe,wie,kie,Pie,Yie,tse,Vz,hse,xse,wse,Ise,Aae,kae,fle,Ile,Ale,Nv,Lle,HY,$le,Gle,Wle,rs,vce,kce,Tb,Zce,hue,Oue,Gue,gde,vde,Ede,Mde,Dde,qde];const La="ElInfiniteScroll",Zde=50,Yde=200,Xde=0,Jde={delay:{type:Number,default:Yde},distance:{type:Number,default:Xde},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},bC=(e,t)=>Object.entries(Jde).reduce((i,[a,d])=>{var g,_;const{type:o,default:S}=d,E=e.getAttribute(`infinite-scroll-${a}`);let I=(_=(g=t[E])!=null?g:E)!=null?_:S;return I=I==="false"?!1:I,I=o(I),i[a]=Number.isNaN(I)?S:I,i},{}),B4=e=>{const{observer:t}=e[La];t&&(t.disconnect(),delete e[La].observer)},Qde=(e,t)=>{const{container:i,containerEl:a,instance:d,observer:g,lastScrollTop:_}=e[La],{disabled:o,distance:S}=bC(e,d),{clientHeight:E,scrollHeight:I,scrollTop:R}=a,z=R-_;if(e[La].lastScrollTop=R,g||o||z<0)return;let N=!1;if(i===e)N=I-(E+R)<=S;else{const{clientTop:$,scrollHeight:F}=e,W=i2(e,a);N=R+E>=W+$+F-S}N&&t.call(d)};function Vw(e,t){const{containerEl:i,instance:a}=e[La],{disabled:d}=bC(e,a);d||i.clientHeight===0||(i.scrollHeight<=i.clientHeight?t.call(a):B4(e))}const ehe={async mounted(e,t){const{instance:i,value:a}=t;Nn(a)||Ai(La,"'v-infinite-scroll' binding value must be a function"),await Un();const{delay:d,immediate:g}=bC(e,i),_=tT(e,!0),o=_===window?document.documentElement:_,S=gh(Qde.bind(null,e,a),d);if(_){if(e[La]={instance:i,container:_,containerEl:o,delay:d,cb:a,onScroll:S,lastScrollTop:o.scrollTop},g){const E=new MutationObserver(gh(Vw.bind(null,e,a),Zde));e[La].observer=E,E.observe(e,{childList:!0,subtree:!0}),Vw(e,a)}_.addEventListener("scroll",S)}},unmounted(e){if(!e[La])return;const{container:t,onScroll:i}=e[La];t==null||t.removeEventListener("scroll",i),B4(e)},async updated(e){if(!e[La])await Un();else{const{containerEl:t,cb:i,observer:a}=e[La];t.clientHeight&&a&&Vw(e,i)}}},dS=ehe;dS.install=e=>{e.directive("InfiniteScroll",dS)};const the=dS;function nhe(e){let t;const i=xe(!1),a=dr({...e,originalPosition:"",originalOverflow:"",visible:!1});function d(z){a.text=z}function g(){const z=a.parent,N=R.ns;if(!z.vLoadingAddClassList){let $=z.getAttribute("loading-number");$=Number.parseInt($)-1,$?z.setAttribute("loading-number",$.toString()):(ys(z,N.bm("parent","relative")),z.removeAttribute("loading-number")),ys(z,N.bm("parent","hidden"))}_(),I.unmount()}function _(){var z,N;(N=(z=R.$el)==null?void 0:z.parentNode)==null||N.removeChild(R.$el)}function o(){var z;e.beforeClose&&!e.beforeClose()||(i.value=!0,clearTimeout(t),t=setTimeout(S,400),a.visible=!1,(z=e.closed)==null||z.call(e))}function S(){if(!i.value)return;const z=a.parent;i.value=!1,z.vLoadingAddClassList=void 0,g()}const I=NR(qe({name:"ElLoading",setup(z,{expose:N}){const{ns:$,zIndex:F}=o1("loading");return N({ns:$,zIndex:F}),()=>{const W=a.spinner||a.svg,U=Kn("svg",{class:"circular",viewBox:a.svgViewBox?a.svgViewBox:"0 0 50 50",...W?{innerHTML:W}:{}},[Kn("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),re=a.text?Kn("p",{class:$.b("text")},[a.text]):void 0;return Kn(Ui,{name:$.b("fade"),onAfterLeave:S},{default:it(()=>[vo(Ye("div",{style:{backgroundColor:a.background||""},class:[$.b("mask"),a.customClass,a.fullscreen?"is-fullscreen":""]},[Kn("div",{class:$.b("spinner")},[U,re])]),[[ir,a.visible]])])})}}})),R=I.mount(document.createElement("div"));return{...Vi(a),setText:d,removeElLoadingChild:_,close:o,handleAfterLeave:S,vm:R,get $el(){return R.$el}}}let E0;const hS=function(e={}){if(!Wo)return;const t=ohe(e);if(t.fullscreen&&E0)return E0;const i=nhe({...t,closed:()=>{var d;(d=t.closed)==null||d.call(t),t.fullscreen&&(E0=void 0)}});rhe(t,t.parent,i),cP(t,t.parent,i),t.parent.vLoadingAddClassList=()=>cP(t,t.parent,i);let a=t.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",t.parent.setAttribute("loading-number",a),t.parent.appendChild(i.$el),Un(()=>i.visible.value=t.visible),t.fullscreen&&(E0=i),i},ohe=e=>{var t,i,a,d;let g;return Bn(e.target)?g=(t=document.querySelector(e.target))!=null?t:document.body:g=e.target||document.body,{parent:g===document.body||e.body?document.body:g,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:g===document.body&&((i=e.fullscreen)!=null?i:!0),lock:(a=e.lock)!=null?a:!1,customClass:e.customClass||"",visible:(d=e.visible)!=null?d:!0,beforeClose:e.beforeClose,closed:e.closed,target:g}},rhe=async(e,t,i)=>{const{nextZIndex:a}=i.vm.zIndex||i.vm._.exposed.zIndex,d={};if(e.fullscreen)i.originalPosition.value=Uu(document.body,"position"),i.originalOverflow.value=Uu(document.body,"overflow"),d.zIndex=a();else if(e.parent===document.body){i.originalPosition.value=Uu(document.body,"position"),await Un();for(const g of["top","left"]){const _=g==="top"?"scrollTop":"scrollLeft";d[g]=`${e.target.getBoundingClientRect()[g]+document.body[_]+document.documentElement[_]-Number.parseInt(Uu(document.body,`margin-${g}`),10)}px`}for(const g of["height","width"])d[g]=`${e.target.getBoundingClientRect()[g]}px`}else i.originalPosition.value=Uu(t,"position");for(const[g,_]of Object.entries(d))i.$el.style[g]=_},cP=(e,t,i)=>{const a=i.vm.ns||i.vm._.exposed.ns;["absolute","fixed","sticky"].includes(i.originalPosition.value)?ys(t,a.bm("parent","relative")):Oa(t,a.bm("parent","relative")),e.fullscreen&&e.lock?Oa(t,a.bm("parent","hidden")):ys(t,a.bm("parent","hidden"))},q0=Symbol("ElLoading"),uP=(e,t)=>{var i,a,d,g;const _=t.instance,o=z=>So(t.value)?t.value[z]:void 0,S=z=>{const N=Bn(z)&&(_==null?void 0:_[z])||z;return N&&xe(N)},E=z=>S(o(z)||e.getAttribute(`element-loading-${Pc(z)}`)),I=(i=o("fullscreen"))!=null?i:t.modifiers.fullscreen,R={text:E("text"),svg:E("svg"),svgViewBox:E("svgViewBox"),spinner:E("spinner"),background:E("background"),customClass:E("customClass"),fullscreen:I,target:(a=o("target"))!=null?a:I?void 0:e,body:(d=o("body"))!=null?d:t.modifiers.body,lock:(g=o("lock"))!=null?g:t.modifiers.lock};e[q0]={options:R,instance:hS(R)}},ihe=(e,t)=>{for(const i of Object.keys(t))Hr(t[i])&&(t[i].value=e[i])},dP={mounted(e,t){t.value&&uP(e,t)},updated(e,t){const i=e[q0];t.oldValue!==t.value&&(t.value&&!t.oldValue?uP(e,t):t.value&&t.oldValue?So(t.value)&&ihe(t.value,i.options):i==null||i.instance.close())},unmounted(e){var t;(t=e[q0])==null||t.instance.close(),e[q0]=null}},she={install(e){e.directive("loading",dP),e.config.globalProperties.$loading=hS},directive:dP,service:hS},F4=["success","info","warning","error"],fs=oi({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Wo?document.body:void 0}),ahe=cn({customClass:{type:String,default:fs.customClass},center:{type:Boolean,default:fs.center},dangerouslyUseHTMLString:{type:Boolean,default:fs.dangerouslyUseHTMLString},duration:{type:Number,default:fs.duration},icon:{type:Cr,default:fs.icon},id:{type:String,default:fs.id},message:{type:at([String,Object,Function]),default:fs.message},onClose:{type:at(Function),default:fs.onClose},showClose:{type:Boolean,default:fs.showClose},type:{type:String,values:F4,default:fs.type},plain:{type:Boolean,default:fs.plain},offset:{type:Number,default:fs.offset},zIndex:{type:Number,default:fs.zIndex},grouping:{type:Boolean,default:fs.grouping},repeatNum:{type:Number,default:fs.repeatNum}}),lhe={destroy:()=>!0},pl=OP([]),che=e=>{const t=pl.findIndex(d=>d.id===e),i=pl[t];let a;return t>0&&(a=pl[t-1]),{current:i,prev:a}},uhe=e=>{const{prev:t}=che(e);return t?t.vm.exposed.bottom.value:0},dhe=(e,t)=>pl.findIndex(a=>a.id===e)>0?16:t,hhe=qe({name:"ElMessage"}),fhe=qe({...hhe,props:ahe,emits:lhe,setup(e,{expose:t}){const i=e,{Close:a}=lT,{ns:d,zIndex:g}=o1("message"),{currentZIndex:_,nextZIndex:o}=g,S=xe(),E=xe(!1),I=xe(0);let R;const z=ee(()=>i.type?i.type==="error"?"danger":i.type:"info"),N=ee(()=>{const ae=i.type;return{[d.bm("icon",ae)]:ae&&rd[ae]}}),$=ee(()=>i.icon||rd[i.type]||""),F=ee(()=>uhe(i.id)),W=ee(()=>dhe(i.id,i.offset)+F.value),U=ee(()=>I.value+W.value),re=ee(()=>({top:`${W.value}px`,zIndex:_.value}));function K(){i.duration!==0&&({stop:R}=wh(()=>{J()},i.duration))}function q(){R==null||R()}function J(){E.value=!1}function oe({code:ae}){ae===Cn.esc&&J()}return _o(()=>{K(),o(),E.value=!0}),qt(()=>i.repeatNum,()=>{q(),K()}),wr(document,"keydown",oe),ei(S,()=>{I.value=S.value.getBoundingClientRect().height}),t({visible:E,bottom:U,close:J}),(ae,fe)=>(se(),Et(Ui,{name:y(d).b("fade"),onBeforeLeave:ae.onClose,onAfterLeave:ge=>ae.$emit("destroy"),persisted:""},{default:it(()=>[vo(je("div",{id:ae.id,ref_key:"messageRef",ref:S,class:ue([y(d).b(),{[y(d).m(ae.type)]:ae.type},y(d).is("center",ae.center),y(d).is("closable",ae.showClose),y(d).is("plain",ae.plain),ae.customClass]),style:$n(y(re)),role:"alert",onMouseenter:q,onMouseleave:K},[ae.repeatNum>1?(se(),Et(y(UL),{key:0,value:ae.repeatNum,type:y(z),class:ue(y(d).e("badge"))},null,8,["value","type","class"])):yt("v-if",!0),y($)?(se(),Et(y(Dn),{key:1,class:ue([y(d).e("icon"),y(N)])},{default:it(()=>[(se(),Et(ko(y($))))]),_:1},8,["class"])):yt("v-if",!0),vt(ae.$slots,"default",{},()=>[ae.dangerouslyUseHTMLString?(se(),Ie(Fn,{key:1},[yt(" Caution here, message could've been compromised, never use user's input as message "),je("p",{class:ue(y(d).e("content")),innerHTML:ae.message},null,10,["innerHTML"])],2112)):(se(),Ie("p",{key:0,class:ue(y(d).e("content"))},mn(ae.message),3))]),ae.showClose?(se(),Et(y(Dn),{key:2,class:ue(y(d).e("closeBtn")),onClick:Xn(J,["stop"])},{default:it(()=>[Ye(y(a))]),_:1},8,["class","onClick"])):yt("v-if",!0)],46,["id"]),[[ir,E.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var phe=fn(fhe,[["__file","message.vue"]]);let mhe=1;const N4=e=>{const t=!e||Bn(e)||Yr(e)||Nn(e)?{message:e}:e,i={...fs,...t};if(!i.appendTo)i.appendTo=document.body;else if(Bn(i.appendTo)){let a=document.querySelector(i.appendTo);va(a)||(a=document.body),i.appendTo=a}return Lr(ul.grouping)&&!i.grouping&&(i.grouping=ul.grouping),Wn(ul.duration)&&i.duration===3e3&&(i.duration=ul.duration),Wn(ul.offset)&&i.offset===16&&(i.offset=ul.offset),Lr(ul.showClose)&&!i.showClose&&(i.showClose=ul.showClose),i},ghe=e=>{const t=pl.indexOf(e);if(t===-1)return;pl.splice(t,1);const{handler:i}=e;i.close()},vhe=({appendTo:e,...t},i)=>{const a=`message_${mhe++}`,d=t.onClose,g=document.createElement("div"),_={...t,id:a,onClose:()=>{d==null||d(),ghe(I)},onDestroy:()=>{Ju(null,g)}},o=Ye(phe,_,Nn(_.message)||Yr(_.message)?{default:Nn(_.message)?_.message:()=>_.message}:null);o.appContext=i||Np._context,Ju(o,g),e.appendChild(g.firstElementChild);const S=o.component,I={id:a,vnode:o,vm:S,handler:{close:()=>{S.exposed.visible.value=!1}},props:o.component.props};return I},Np=(e={},t)=>{if(!Wo)return{close:()=>{}};const i=N4(e);if(i.grouping&&pl.length){const d=pl.find(({vnode:g})=>{var _;return((_=g.props)==null?void 0:_.message)===i.message});if(d)return d.props.repeatNum+=1,d.props.type=i.type,d.handler}if(Wn(ul.max)&&pl.length>=ul.max)return{close:()=>{}};const a=vhe(i,t);return pl.push(a),a.handler};F4.forEach(e=>{Np[e]=(t={},i)=>{const a=N4(t);return Np({...a,type:e},i)}});function _he(e){for(const t of pl)(!e||e===t.props.type)&&t.handler.close()}Np.closeAll=_he;Np._context=null;const yhe=HD(Np,"$message"),bhe=qe({name:"ElMessageBox",directives:{TrapFocus:IY},components:{ElButton:$i,ElFocusTrap:h_,ElInput:_s,ElOverlay:WT,ElIcon:Dn,...lT},inheritAttrs:!1,props:{buttonSize:{type:String,validator:GD},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:i,zIndex:a,ns:d,size:g}=o1("message-box",ee(()=>e.buttonSize)),{t:_}=i,{nextZIndex:o}=a,S=xe(!1),E=dr({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:Wu(ql),cancelButtonLoadingIcon:Wu(ql),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:o()}),I=ee(()=>{const ye=E.type;return{[d.bm("icon",ye)]:ye&&rd[ye]}}),R=Ki(),z=Ki(),N=ee(()=>E.icon||rd[E.type]||""),$=ee(()=>!!E.message),F=xe(),W=xe(),U=xe(),re=xe(),K=xe(),q=ee(()=>E.confirmButtonClass);qt(()=>E.inputValue,async ye=>{await Un(),e.boxType==="prompt"&&ye!==null&&_e()},{immediate:!0}),qt(()=>S.value,ye=>{var Me,Te;ye&&(e.boxType!=="prompt"&&(E.autofocus?U.value=(Te=(Me=K.value)==null?void 0:Me.$el)!=null?Te:F.value:U.value=F.value),E.zIndex=o()),e.boxType==="prompt"&&(ye?Un().then(()=>{var he;re.value&&re.value.$el&&(E.autofocus?U.value=(he=Re())!=null?he:F.value:U.value=F.value)}):(E.editorErrorMessage="",E.validateError=!1))});const J=ee(()=>e.draggable),oe=ee(()=>e.overflow);WD(F,W,J,oe),_o(async()=>{await Un(),e.closeOnHashChange&&window.addEventListener("hashchange",ae)}),Pr(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",ae)});function ae(){S.value&&(S.value=!1,Un(()=>{E.action&&t("action",E.action)}))}const fe=()=>{e.closeOnClickModal&&de(E.distinguishCancelAndClose?"close":"cancel")},ge=bT(fe),ce=ye=>{if(E.inputType!=="textarea")return ye.preventDefault(),de("confirm")},de=ye=>{var Me;e.boxType==="prompt"&&ye==="confirm"&&!_e()||(E.action=ye,E.beforeClose?(Me=E.beforeClose)==null||Me.call(E,ye,E,ae):ae())},_e=()=>{if(e.boxType==="prompt"){const ye=E.inputPattern;if(ye&&!ye.test(E.inputValue||""))return E.editorErrorMessage=E.inputErrorMessage||_("el.messagebox.error"),E.validateError=!0,!1;const Me=E.inputValidator;if(Nn(Me)){const Te=Me(E.inputValue);if(Te===!1)return E.editorErrorMessage=E.inputErrorMessage||_("el.messagebox.error"),E.validateError=!0,!1;if(Bn(Te))return E.editorErrorMessage=Te,E.validateError=!0,!1}}return E.editorErrorMessage="",E.validateError=!1,!0},Re=()=>{const ye=re.value.$refs;return ye.input||ye.textarea},Qe=()=>{de("close")},Ee=()=>{e.closeOnPressEscape&&Qe()};return e.lockScroll&&dT(S),{...Vi(E),ns:d,overlayEvent:ge,visible:S,hasMessage:$,typeClass:I,contentId:R,inputId:z,btnSize:g,iconComponent:N,confirmButtonClasses:q,rootRef:F,focusStartRef:U,headerRef:W,inputRef:re,confirmRef:K,doClose:ae,handleClose:Qe,onCloseRequested:Ee,handleWrapperClick:fe,handleInputEnter:ce,handleAction:de,t:_}}});function xhe(e,t,i,a,d,g){const _=Mo("el-icon"),o=Mo("close"),S=Mo("el-input"),E=Mo("el-button"),I=Mo("el-focus-trap"),R=Mo("el-overlay");return se(),Et(Ui,{name:"fade-in-linear",onAfterLeave:z=>e.$emit("vanish"),persisted:""},{default:it(()=>[vo(Ye(R,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:it(()=>[je("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:ue(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[Ye(I,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:it(()=>[je("div",{ref:"rootRef",class:ue([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:$n(e.customStyle),tabindex:"-1",onClick:Xn(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(se(),Ie("div",{key:0,ref:"headerRef",class:ue([e.ns.e("header"),{"show-close":e.showClose}])},[je("div",{class:ue(e.ns.e("title"))},[e.iconComponent&&e.center?(se(),Et(_,{key:0,class:ue([e.ns.e("status"),e.typeClass])},{default:it(()=>[(se(),Et(ko(e.iconComponent)))]),_:1},8,["class"])):yt("v-if",!0),je("span",null,mn(e.title),1)],2),e.showClose?(se(),Ie("button",{key:0,type:"button",class:ue(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:z=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:kr(Xn(z=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[Ye(_,{class:ue(e.ns.e("close"))},{default:it(()=>[Ye(o)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):yt("v-if",!0)],2)):yt("v-if",!0),je("div",{id:e.contentId,class:ue(e.ns.e("content"))},[je("div",{class:ue(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(se(),Et(_,{key:0,class:ue([e.ns.e("status"),e.typeClass])},{default:it(()=>[(se(),Et(ko(e.iconComponent)))]),_:1},8,["class"])):yt("v-if",!0),e.hasMessage?(se(),Ie("div",{key:1,class:ue(e.ns.e("message"))},[vt(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(se(),Et(ko(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(se(),Et(ko(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:it(()=>[$o(mn(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):yt("v-if",!0)],2),vo(je("div",{class:ue(e.ns.e("input"))},[Ye(S,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":z=>e.inputValue=z,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:ue({invalid:e.validateError}),onKeydown:kr(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),je("div",{class:ue(e.ns.e("errormsg")),style:$n({visibility:e.editorErrorMessage?"visible":"hidden"})},mn(e.editorErrorMessage),7)],2),[[ir,e.showInput]])],10,["id"]),je("div",{class:ue(e.ns.e("btns"))},[e.showCancelButton?(se(),Et(E,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:ue([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:z=>e.handleAction("cancel"),onKeydown:kr(Xn(z=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:it(()=>[$o(mn(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):yt("v-if",!0),vo(Ye(E,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:ue([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:z=>e.handleAction("confirm"),onKeydown:kr(Xn(z=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:it(()=>[$o(mn(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[ir,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[ir,e.visible]])]),_:3},8,["onAfterLeave"])}var whe=fn(bhe,[["render",xhe],["__file","index.vue"]]);const Zv=new Map,She=e=>{let t=document.body;return e.appendTo&&(Bn(e.appendTo)&&(t=document.querySelector(e.appendTo)),va(e.appendTo)&&(t=e.appendTo),va(t)||(t=document.body)),t},The=(e,t,i=null)=>{const a=Ye(whe,e,Nn(e.message)||Yr(e.message)?{default:Nn(e.message)?e.message:()=>e.message}:null);return a.appContext=i,Ju(a,t),She(e).appendChild(t.firstElementChild),a.component},Che=()=>document.createElement("div"),Ehe=(e,t)=>{const i=Che();e.onVanish=()=>{Ju(null,i),Zv.delete(d)},e.onAction=g=>{const _=Zv.get(d);let o;e.showInput?o={value:d.inputValue,action:g}:o=g,e.callback?e.callback(o,a.proxy):g==="cancel"||g==="close"?e.distinguishCancelAndClose&&g!=="cancel"?_.reject("close"):_.reject("cancel"):_.resolve(o)};const a=The(e,i,t),d=a.proxy;for(const g in e)or(e,g)&&!or(d.$props,g)&&(d[g]=e[g]);return d.visible=!0,d};function Qp(e,t=null){if(!Wo)return Promise.reject();let i;return Bn(e)||Yr(e)?e={message:e}:i=e.callback,new Promise((a,d)=>{const g=Ehe(e,t??Qp._context);Zv.set(g,{options:e,callback:i,resolve:a,reject:d})})}const Mhe=["alert","confirm","prompt"],Ihe={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};Mhe.forEach(e=>{Qp[e]=Ahe(e)});function Ahe(e){return(t,i,a,d)=>{let g="";return So(i)?(a=i,g=""):jr(i)?g="":g=i,Qp(Object.assign({title:g,message:t,type:"",...Ihe[e]},a,{boxType:e}),d)}}Qp.close=()=>{Zv.forEach((e,t)=>{t.doClose()}),Zv.clear()};Qp._context=null;const Bu=Qp;Bu.install=e=>{Bu._context=e._context,e.config.globalProperties.$msgbox=Bu,e.config.globalProperties.$messageBox=Bu,e.config.globalProperties.$alert=Bu.alert,e.config.globalProperties.$confirm=Bu.confirm,e.config.globalProperties.$prompt=Bu.prompt};const khe=Bu,$4=["success","info","warning","error"],Phe=cn({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:Cr},id:{type:String,default:""},message:{type:at([String,Object]),default:""},offset:{type:Number,default:0},onClick:{type:at(Function),default:()=>{}},onClose:{type:at(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...$4,""],default:""},zIndex:Number}),Rhe={destroy:()=>!0},Dhe=qe({name:"ElNotification"}),Lhe=qe({...Dhe,props:Phe,emits:Rhe,setup(e,{expose:t}){const i=e,{ns:a,zIndex:d}=o1("notification"),{nextZIndex:g,currentZIndex:_}=d,{Close:o}=aT,S=xe(!1);let E;const I=ee(()=>{const K=i.type;return K&&rd[i.type]?a.m(K):""}),R=ee(()=>i.type&&rd[i.type]||i.icon),z=ee(()=>i.position.endsWith("right")?"right":"left"),N=ee(()=>i.position.startsWith("top")?"top":"bottom"),$=ee(()=>{var K;return{[N.value]:`${i.offset}px`,zIndex:(K=i.zIndex)!=null?K:_.value}});function F(){i.duration>0&&({stop:E}=wh(()=>{S.value&&U()},i.duration))}function W(){E==null||E()}function U(){S.value=!1}function re({code:K}){K===Cn.delete||K===Cn.backspace?W():K===Cn.esc?S.value&&U():F()}return _o(()=>{F(),g(),S.value=!0}),wr(document,"keydown",re),t({visible:S,close:U}),(K,q)=>(se(),Et(Ui,{name:y(a).b("fade"),onBeforeLeave:K.onClose,onAfterLeave:J=>K.$emit("destroy"),persisted:""},{default:it(()=>[vo(je("div",{id:K.id,class:ue([y(a).b(),K.customClass,y(z)]),style:$n(y($)),role:"alert",onMouseenter:W,onMouseleave:F,onClick:K.onClick},[y(R)?(se(),Et(y(Dn),{key:0,class:ue([y(a).e("icon"),y(I)])},{default:it(()=>[(se(),Et(ko(y(R))))]),_:1},8,["class"])):yt("v-if",!0),je("div",{class:ue(y(a).e("group"))},[je("h2",{class:ue(y(a).e("title")),textContent:mn(K.title)},null,10,["textContent"]),vo(je("div",{class:ue(y(a).e("content")),style:$n(K.title?void 0:{margin:0})},[vt(K.$slots,"default",{},()=>[K.dangerouslyUseHTMLString?(se(),Ie(Fn,{key:1},[yt(" Caution here, message could've been compromised, never use user's input as message "),je("p",{innerHTML:K.message},null,8,["innerHTML"])],2112)):(se(),Ie("p",{key:0},mn(K.message),1))])],6),[[ir,K.message]]),K.showClose?(se(),Et(y(Dn),{key:0,class:ue(y(a).e("closeBtn")),onClick:Xn(U,["stop"])},{default:it(()=>[Ye(y(o))]),_:1},8,["class","onClick"])):yt("v-if",!0)],2)],46,["id","onClick"]),[[ir,S.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var Ohe=fn(Lhe,[["__file","notification.vue"]]);const Cb={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},fS=16;let zhe=1;const $p=function(e={},t=null){if(!Wo)return{close:()=>{}};(Bn(e)||Yr(e))&&(e={message:e});const i=e.position||"top-right";let a=e.offset||0;Cb[i].forEach(({vm:I})=>{var R;a+=(((R=I.el)==null?void 0:R.offsetHeight)||0)+fS}),a+=fS;const d=`notification_${zhe++}`,g=e.onClose,_={...e,offset:a,id:d,onClose:()=>{Bhe(d,i,g)}};let o=document.body;va(e.appendTo)?o=e.appendTo:Bn(e.appendTo)&&(o=document.querySelector(e.appendTo)),va(o)||(o=document.body);const S=document.createElement("div"),E=Ye(Ohe,_,Yr(_.message)?{default:()=>_.message}:null);return E.appContext=t??$p._context,E.props.onDestroy=()=>{Ju(null,S)},Ju(E,S),Cb[i].push({vm:E}),o.appendChild(S.firstElementChild),{close:()=>{E.component.exposed.visible.value=!1}}};$4.forEach(e=>{$p[e]=(t={})=>((Bn(t)||Yr(t))&&(t={message:t}),$p({...t,type:e}))});function Bhe(e,t,i){const a=Cb[t],d=a.findIndex(({vm:E})=>{var I;return((I=E.component)==null?void 0:I.props.id)===e});if(d===-1)return;const{vm:g}=a[d];if(!g)return;i==null||i(g);const _=g.el.offsetHeight,o=t.split("-")[0];a.splice(d,1);const S=a.length;if(!(S<1))for(let E=d;E<S;E++){const{el:I,component:R}=a[E].vm,z=Number.parseInt(I.style[o],10)-_-fS;R.props.offset=z}}function Fhe(){for(const e of Object.values(Cb))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}$p.closeAll=Fhe;$p._context=null;const Nhe=HD($p,"$notify");var $he=[the,she,yhe,khe,Nhe,xz],Vhe=Nq([...Kde,...$he]);NR(G6).use(Vhe).mount("#app")});export default Uhe();
