var YN=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Ipe=YN((Tl,Cl)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))s(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const _ of p.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&s(_)}).observe(document,{childList:!0,subtree:!0});function i(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function s(d){if(d.ep)return;d.ep=!0;const p=i(d);fetch(d.href,p)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function kS(e){const t=Object.create(null);for(const i of e.split(","))t[i]=1;return i=>i in t}const Fi={},cm=[],jr=()=>{},XN=()=>!1,qb=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),PS=e=>e.startsWith("onUpdate:"),da=Object.assign,RS=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},JN=Object.prototype.hasOwnProperty,Tr=(e,t)=>JN.call(e,t),fn=Array.isArray,um=e=>R_(e)==="[object Map]",Kb=e=>R_(e)==="[object Set]",_h=e=>R_(e)==="[object Date]",Qn=e=>typeof e=="function",Zn=e=>typeof e=="string",Zc=e=>typeof e=="symbol",Vo=e=>e!==null&&typeof e=="object",o_=e=>(Vo(e)||Qn(e))&&Qn(e.then)&&Qn(e.catch),L3=Object.prototype.toString,R_=e=>L3.call(e),QN=e=>R_(e).slice(8,-1),r_=e=>R_(e)==="[object Object]",LS=e=>Zn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,jv=kS(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Zb=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},e5=/-(\w)/g,Fs=Zb(e=>e.replace(e5,(t,i)=>i?i.toUpperCase():"")),t5=/\B([A-Z])/g,cd=Zb(e=>e.replace(t5,"-$1").toLowerCase()),L_=Zb(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hv=Zb(e=>e?`on${L_(e)}`:""),fh=(e,t)=>!Object.is(e,t),W0=(e,...t)=>{for(let i=0;i<e.length;i++)e[i](...t)},O3=(e,t,i,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:i})},r2=e=>{const t=parseFloat(e);return isNaN(t)?e:t},n5=e=>{const t=Zn(e)?Number(e):NaN;return isNaN(t)?e:t};let JI;const Yb=()=>JI||(JI=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function to(e){if(fn(e)){const t={};for(let i=0;i<e.length;i++){const s=e[i],d=Zn(s)?a5(s):to(s);if(d)for(const p in d)t[p]=d[p]}return t}else if(Zn(e)||Vo(e))return e}const o5=/;(?![^(]*\))/g,r5=/:([^]+)/,i5=/\/\*[^]*?\*\//g;function a5(e){const t={};return e.replace(i5,"").split(o5).forEach(i=>{if(i){const s=i.split(r5);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function he(e){let t="";if(Zn(e))t=e;else if(fn(e))for(let i=0;i<e.length;i++){const s=he(e[i]);s&&(t+=s+" ")}else if(Vo(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}function Hc(e){if(!e)return null;let{class:t,style:i}=e;return t&&!Zn(t)&&(e.class=he(t)),i&&(e.style=to(i)),e}const s5="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",l5=kS(s5);function D3(e){return!!e||e===""}function c5(e,t){if(e.length!==t.length)return!1;let i=!0;for(let s=0;i&&s<e.length;s++)i=xm(e[s],t[s]);return i}function xm(e,t){if(e===t)return!0;let i=_h(e),s=_h(t);if(i||s)return i&&s?e.getTime()===t.getTime():!1;if(i=Zc(e),s=Zc(t),i||s)return e===t;if(i=fn(e),s=fn(t),i||s)return i&&s?c5(e,t):!1;if(i=Vo(e),s=Vo(t),i||s){if(!i||!s)return!1;const d=Object.keys(e).length,p=Object.keys(t).length;if(d!==p)return!1;for(const _ in e){const o=e.hasOwnProperty(_),w=t.hasOwnProperty(_);if(o&&!w||!o&&w||!xm(e[_],t[_]))return!1}}return String(e)===String(t)}function z3(e,t){return e.findIndex(i=>xm(i,t))}const F3=e=>!!(e&&e.__v_isRef===!0),yn=e=>Zn(e)?e:e==null?"":fn(e)||Vo(e)&&(e.toString===L3||!Qn(e.toString))?F3(e)?yn(e.value):JSON.stringify(e,B3,2):String(e),B3=(e,t)=>F3(t)?B3(e,t.value):um(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[s,d],p)=>(i[fw(s,p)+" =>"]=d,i),{})}:Kb(t)?{[`Set(${t.size})`]:[...t.values()].map(i=>fw(i))}:Zc(t)?fw(t):Vo(t)&&!fn(t)&&!r_(t)?String(t):t,fw=(e,t="")=>{var i;return Zc(e)?`Symbol(${(i=e.description)!=null?i:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ps;class N3{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ps,!t&&Ps&&(this.index=(Ps.scopes||(Ps.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].pause();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].resume();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].resume()}}run(t){if(this._active){const i=Ps;try{return Ps=this,t()}finally{Ps=i}}}on(){Ps=this}off(){Ps=this.parent}stop(t){if(this._active){this._active=!1;let i,s;for(i=0,s=this.effects.length;i<s;i++)this.effects[i].stop();for(this.effects.length=0,i=0,s=this.cleanups.length;i<s;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,s=this.scopes.length;i<s;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0}}}function u5(e){return new N3(e)}function $3(){return Ps}function V3(e,t=!1){Ps&&Ps.cleanups.push(e)}let Vi;const pw=new WeakSet;class U3{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ps&&Ps.active&&Ps.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pw.has(this)&&(pw.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||H3(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,QI(this),G3(this);const t=Vi,i=qc;Vi=this,qc=!0;try{return this.fn()}finally{W3(this),Vi=t,qc=i,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)zS(t);this.deps=this.depsTail=void 0,QI(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pw.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){i2(this)&&this.run()}get dirty(){return i2(this)}}let j3=0,Gv,Wv;function H3(e,t=!1){if(e.flags|=8,t){e.next=Wv,Wv=e;return}e.next=Gv,Gv=e}function OS(){j3++}function DS(){if(--j3>0)return;if(Wv){let t=Wv;for(Wv=void 0;t;){const i=t.next;t.next=void 0,t.flags&=-9,t=i}}let e;for(;Gv;){let t=Gv;for(Gv=void 0;t;){const i=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=i}}if(e)throw e}function G3(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function W3(e){let t,i=e.depsTail,s=i;for(;s;){const d=s.prevDep;s.version===-1?(s===i&&(i=d),zS(s),d5(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=d}e.deps=t,e.depsTail=i}function i2(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(q3(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function q3(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===i_))return;e.globalVersion=i_;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!i2(e)){e.flags&=-3;return}const i=Vi,s=qc;Vi=e,qc=!0;try{G3(e);const d=e.fn(e._value);(t.version===0||fh(d,e._value))&&(e._value=d,t.version++)}catch(d){throw t.version++,d}finally{Vi=i,qc=s,W3(e),e.flags&=-3}}function zS(e,t=!1){const{dep:i,prevSub:s,nextSub:d}=e;if(s&&(s.nextSub=d,e.prevSub=void 0),d&&(d.prevSub=s,e.nextSub=void 0),i.subs===e&&(i.subs=s,!s&&i.computed)){i.computed.flags&=-5;for(let p=i.computed.deps;p;p=p.nextDep)zS(p,!0)}!t&&!--i.sc&&i.map&&i.map.delete(i.key)}function d5(e){const{prevDep:t,nextDep:i}=e;t&&(t.nextDep=i,e.prevDep=void 0),i&&(i.prevDep=t,e.nextDep=void 0)}let qc=!0;const K3=[];function Ih(){K3.push(qc),qc=!1}function Ah(){const e=K3.pop();qc=e===void 0?!0:e}function QI(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const i=Vi;Vi=void 0;try{t()}finally{Vi=i}}}let i_=0,h5=class{constructor(t,i){this.sub=t,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Xb{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Vi||!qc||Vi===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==Vi)i=this.activeLink=new h5(Vi,this),Vi.deps?(i.prevDep=Vi.depsTail,Vi.depsTail.nextDep=i,Vi.depsTail=i):Vi.deps=Vi.depsTail=i,Z3(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const s=i.nextDep;s.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=s),i.prevDep=Vi.depsTail,i.nextDep=void 0,Vi.depsTail.nextDep=i,Vi.depsTail=i,Vi.deps===i&&(Vi.deps=s)}return i}trigger(t){this.version++,i_++,this.notify(t)}notify(t){OS();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{DS()}}}function Z3(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)Z3(s)}const i=e.dep.subs;i!==e&&(e.prevSub=i,i&&(i.nextSub=e)),e.dep.subs=e}}const fb=new WeakMap,Of=Symbol(""),a2=Symbol(""),a_=Symbol("");function cs(e,t,i){if(qc&&Vi){let s=fb.get(e);s||fb.set(e,s=new Map);let d=s.get(i);d||(s.set(i,d=new Xb),d.map=s,d.key=i),d.track()}}function Qu(e,t,i,s,d,p){const _=fb.get(e);if(!_){i_++;return}const o=w=>{w&&w.trigger()};if(OS(),t==="clear")_.forEach(o);else{const w=fn(e),C=w&&LS(i);if(w&&i==="length"){const M=Number(s);_.forEach((I,F)=>{(F==="length"||F===a_||!Zc(F)&&F>=M)&&o(I)})}else switch((i!==void 0||_.has(void 0))&&o(_.get(i)),C&&o(_.get(a_)),t){case"add":w?C&&o(_.get("length")):(o(_.get(Of)),um(e)&&o(_.get(a2)));break;case"delete":w||(o(_.get(Of)),um(e)&&o(_.get(a2)));break;case"set":um(e)&&o(_.get(Of));break}}DS()}function f5(e,t){const i=fb.get(e);return i&&i.get(t)}function qp(e){const t=ei(e);return t===e?t:(cs(t,"iterate",a_),ec(e)?t:t.map(us))}function Jb(e){return cs(e=ei(e),"iterate",a_),e}const p5={__proto__:null,[Symbol.iterator](){return mw(this,Symbol.iterator,us)},concat(...e){return qp(this).concat(...e.map(t=>fn(t)?qp(t):t))},entries(){return mw(this,"entries",e=>(e[1]=us(e[1]),e))},every(e,t){return Zu(this,"every",e,t,void 0,arguments)},filter(e,t){return Zu(this,"filter",e,t,i=>i.map(us),arguments)},find(e,t){return Zu(this,"find",e,t,us,arguments)},findIndex(e,t){return Zu(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Zu(this,"findLast",e,t,us,arguments)},findLastIndex(e,t){return Zu(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Zu(this,"forEach",e,t,void 0,arguments)},includes(...e){return gw(this,"includes",e)},indexOf(...e){return gw(this,"indexOf",e)},join(e){return qp(this).join(e)},lastIndexOf(...e){return gw(this,"lastIndexOf",e)},map(e,t){return Zu(this,"map",e,t,void 0,arguments)},pop(){return Pv(this,"pop")},push(...e){return Pv(this,"push",e)},reduce(e,...t){return eA(this,"reduce",e,t)},reduceRight(e,...t){return eA(this,"reduceRight",e,t)},shift(){return Pv(this,"shift")},some(e,t){return Zu(this,"some",e,t,void 0,arguments)},splice(...e){return Pv(this,"splice",e)},toReversed(){return qp(this).toReversed()},toSorted(e){return qp(this).toSorted(e)},toSpliced(...e){return qp(this).toSpliced(...e)},unshift(...e){return Pv(this,"unshift",e)},values(){return mw(this,"values",us)}};function mw(e,t,i){const s=Jb(e),d=s[t]();return s!==e&&!ec(e)&&(d._next=d.next,d.next=()=>{const p=d._next();return p.value&&(p.value=i(p.value)),p}),d}const m5=Array.prototype;function Zu(e,t,i,s,d,p){const _=Jb(e),o=_!==e&&!ec(e),w=_[t];if(w!==m5[t]){const I=w.apply(e,p);return o?us(I):I}let C=i;_!==e&&(o?C=function(I,F){return i.call(this,us(I),F,e)}:i.length>2&&(C=function(I,F){return i.call(this,I,F,e)}));const M=w.call(_,C,s);return o&&d?d(M):M}function eA(e,t,i,s){const d=Jb(e);let p=i;return d!==e&&(ec(e)?i.length>3&&(p=function(_,o,w){return i.call(this,_,o,w,e)}):p=function(_,o,w){return i.call(this,_,us(o),w,e)}),d[t](p,...s)}function gw(e,t,i){const s=ei(e);cs(s,"iterate",a_);const d=s[t](...i);return(d===-1||d===!1)&&NS(i[0])?(i[0]=ei(i[0]),s[t](...i)):d}function Pv(e,t,i=[]){Ih(),OS();const s=ei(e)[t].apply(e,i);return DS(),Ah(),s}const g5=kS("__proto__,__v_isRef,__isVue"),Y3=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Zc));function v5(e){Zc(e)||(e=String(e));const t=ei(this);return cs(t,"has",e),t.hasOwnProperty(e)}class X3{constructor(t=!1,i=!1){this._isReadonly=t,this._isShallow=i}get(t,i,s){if(i==="__v_skip")return t.__v_skip;const d=this._isReadonly,p=this._isShallow;if(i==="__v_isReactive")return!d;if(i==="__v_isReadonly")return d;if(i==="__v_isShallow")return p;if(i==="__v_raw")return s===(d?p?M5:tR:p?eR:Q3).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const _=fn(t);if(!d){let w;if(_&&(w=p5[i]))return w;if(i==="hasOwnProperty")return v5}const o=Reflect.get(t,i,vi(t)?t:s);return(Zc(i)?Y3.has(i):g5(i))||(d||cs(t,"get",i),p)?o:vi(o)?_&&LS(i)?o:o.value:Vo(o)?d?Vm(o):Ir(o):o}}class J3 extends X3{constructor(t=!1){super(!1,t)}set(t,i,s,d){let p=t[i];if(!this._isShallow){const w=$f(p);if(!ec(s)&&!$f(s)&&(p=ei(p),s=ei(s)),!fn(t)&&vi(p)&&!vi(s))return w?!1:(p.value=s,!0)}const _=fn(t)&&LS(i)?Number(i)<t.length:Tr(t,i),o=Reflect.set(t,i,s,vi(t)?t:d);return t===ei(d)&&(_?fh(s,p)&&Qu(t,"set",i,s):Qu(t,"add",i,s)),o}deleteProperty(t,i){const s=Tr(t,i);t[i];const d=Reflect.deleteProperty(t,i);return d&&s&&Qu(t,"delete",i,void 0),d}has(t,i){const s=Reflect.has(t,i);return(!Zc(i)||!Y3.has(i))&&cs(t,"has",i),s}ownKeys(t){return cs(t,"iterate",fn(t)?"length":Of),Reflect.ownKeys(t)}}class _5 extends X3{constructor(t=!1){super(!0,t)}set(t,i){return!0}deleteProperty(t,i){return!0}}const y5=new J3,b5=new _5,x5=new J3(!0),s2=e=>e,S0=e=>Reflect.getPrototypeOf(e);function w5(e,t,i){return function(...s){const d=this.__v_raw,p=ei(d),_=um(p),o=e==="entries"||e===Symbol.iterator&&_,w=e==="keys"&&_,C=d[e](...s),M=i?s2:t?l2:us;return!t&&cs(p,"iterate",w?a2:Of),{next(){const{value:I,done:F}=C.next();return F?{value:I,done:F}:{value:o?[M(I[0]),M(I[1])]:M(I),done:F}},[Symbol.iterator](){return this}}}}function T0(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function S5(e,t){const i={get(d){const p=this.__v_raw,_=ei(p),o=ei(d);e||(fh(d,o)&&cs(_,"get",d),cs(_,"get",o));const{has:w}=S0(_),C=t?s2:e?l2:us;if(w.call(_,d))return C(p.get(d));if(w.call(_,o))return C(p.get(o));p!==_&&p.get(d)},get size(){const d=this.__v_raw;return!e&&cs(ei(d),"iterate",Of),Reflect.get(d,"size",d)},has(d){const p=this.__v_raw,_=ei(p),o=ei(d);return e||(fh(d,o)&&cs(_,"has",d),cs(_,"has",o)),d===o?p.has(d):p.has(d)||p.has(o)},forEach(d,p){const _=this,o=_.__v_raw,w=ei(o),C=t?s2:e?l2:us;return!e&&cs(w,"iterate",Of),o.forEach((M,I)=>d.call(p,C(M),C(I),_))}};return da(i,e?{add:T0("add"),set:T0("set"),delete:T0("delete"),clear:T0("clear")}:{add(d){!t&&!ec(d)&&!$f(d)&&(d=ei(d));const p=ei(this);return S0(p).has.call(p,d)||(p.add(d),Qu(p,"add",d,d)),this},set(d,p){!t&&!ec(p)&&!$f(p)&&(p=ei(p));const _=ei(this),{has:o,get:w}=S0(_);let C=o.call(_,d);C||(d=ei(d),C=o.call(_,d));const M=w.call(_,d);return _.set(d,p),C?fh(p,M)&&Qu(_,"set",d,p):Qu(_,"add",d,p),this},delete(d){const p=ei(this),{has:_,get:o}=S0(p);let w=_.call(p,d);w||(d=ei(d),w=_.call(p,d)),o&&o.call(p,d);const C=p.delete(d);return w&&Qu(p,"delete",d,void 0),C},clear(){const d=ei(this),p=d.size!==0,_=d.clear();return p&&Qu(d,"clear",void 0,void 0),_}}),["keys","values","entries",Symbol.iterator].forEach(d=>{i[d]=w5(d,e,t)}),i}function FS(e,t){const i=S5(e,t);return(s,d,p)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?s:Reflect.get(Tr(i,d)&&d in s?i:s,d,p)}const T5={get:FS(!1,!1)},C5={get:FS(!1,!0)},E5={get:FS(!0,!1)},Q3=new WeakMap,eR=new WeakMap,tR=new WeakMap,M5=new WeakMap;function I5(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function A5(e){return e.__v_skip||!Object.isExtensible(e)?0:I5(QN(e))}function Ir(e){return $f(e)?e:BS(e,!1,y5,T5,Q3)}function nR(e){return BS(e,!1,x5,C5,eR)}function Vm(e){return BS(e,!0,b5,E5,tR)}function BS(e,t,i,s,d){if(!Vo(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const p=d.get(e);if(p)return p;const _=A5(e);if(_===0)return e;const o=new Proxy(e,_===2?s:i);return d.set(e,o),o}function dm(e){return $f(e)?dm(e.__v_raw):!!(e&&e.__v_isReactive)}function $f(e){return!!(e&&e.__v_isReadonly)}function ec(e){return!!(e&&e.__v_isShallow)}function NS(e){return e?!!e.__v_raw:!1}function ei(e){const t=e&&e.__v_raw;return t?ei(t):e}function ph(e){return!Tr(e,"__v_skip")&&Object.isExtensible(e)&&O3(e,"__v_skip",!0),e}const us=e=>Vo(e)?Ir(e):e,l2=e=>Vo(e)?Vm(e):e;function vi(e){return e?e.__v_isRef===!0:!1}function we(e){return oR(e,!1)}function gi(e){return oR(e,!0)}function oR(e,t){return vi(e)?e:new k5(e,t)}class k5{constructor(t,i){this.dep=new Xb,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?t:ei(t),this._value=i?t:us(t),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(t){const i=this._rawValue,s=this.__v_isShallow||ec(t)||$f(t);t=s?t:ei(t),fh(t,i)&&(this._rawValue=t,this._value=s?t:us(t),this.dep.trigger())}}function y(e){return vi(e)?e.value:e}const P5={get:(e,t,i)=>t==="__v_raw"?e:y(Reflect.get(e,t,i)),set:(e,t,i,s)=>{const d=e[t];return vi(d)&&!vi(i)?(d.value=i,!0):Reflect.set(e,t,i,s)}};function rR(e){return dm(e)?e:new Proxy(e,P5)}class R5{constructor(t){this.__v_isRef=!0,this._value=void 0;const i=this.dep=new Xb,{get:s,set:d}=t(i.track.bind(i),i.trigger.bind(i));this._get=s,this._set=d}get value(){return this._value=this._get()}set value(t){this._set(t)}}function L5(e){return new R5(e)}function Ca(e){const t=fn(e)?new Array(e.length):{};for(const i in e)t[i]=iR(e,i);return t}class O5{constructor(t,i,s){this._object=t,this._key=i,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return f5(ei(this._object),this._key)}}class D5{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Vr(e,t,i){return vi(e)?e:Qn(e)?new D5(e):Vo(e)&&arguments.length>1?iR(e,t,i):we(e)}function iR(e,t,i){const s=e[t];return vi(s)?s:new O5(e,t,i)}class z5{constructor(t,i,s){this.fn=t,this.setter=i,this._value=void 0,this.dep=new Xb(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=i_-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Vi!==this)return H3(this,!0),!0}get value(){const t=this.dep.track();return q3(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function F5(e,t,i=!1){let s,d;return Qn(e)?s=e:(s=e.get,d=e.set),new z5(s,d,i)}const C0={},pb=new WeakMap;let Tf;function B5(e,t=!1,i=Tf){if(i){let s=pb.get(i);s||pb.set(i,s=[]),s.push(e)}}function N5(e,t,i=Fi){const{immediate:s,deep:d,once:p,scheduler:_,augmentJob:o,call:w}=i,C=G=>d?G:ec(G)||d===!1||d===0?ed(G,1):ed(G);let M,I,F,B,N=!1,D=!1;if(vi(e)?(I=()=>e.value,N=ec(e)):dm(e)?(I=()=>C(e),N=!0):fn(e)?(D=!0,N=e.some(G=>dm(G)||ec(G)),I=()=>e.map(G=>{if(vi(G))return G.value;if(dm(G))return C(G);if(Qn(G))return w?w(G,2):G()})):Qn(e)?t?I=w?()=>w(e,2):e:I=()=>{if(F){Ih();try{F()}finally{Ah()}}const G=Tf;Tf=M;try{return w?w(e,3,[B]):e(B)}finally{Tf=G}}:I=jr,t&&d){const G=I,J=d===!0?1/0:d;I=()=>ed(G(),J)}const j=$3(),U=()=>{M.stop(),j&&j.active&&RS(j.effects,M)};if(p&&t){const G=t;t=(...J)=>{G(...J),U()}}let ne=D?new Array(e.length).fill(C0):C0;const K=G=>{if(!(!(M.flags&1)||!M.dirty&&!G))if(t){const J=M.run();if(d||N||(D?J.some((oe,se)=>fh(oe,ne[se])):fh(J,ne))){F&&F();const oe=Tf;Tf=M;try{const se=[J,ne===C0?void 0:D&&ne[0]===C0?[]:ne,B];w?w(t,3,se):t(...se),ne=J}finally{Tf=oe}}}else M.run()};return o&&o(K),M=new U3(I),M.scheduler=_?()=>_(K,!1):K,B=G=>B5(G,!1,M),F=M.onStop=()=>{const G=pb.get(M);if(G){if(w)w(G,4);else for(const J of G)J();pb.delete(M)}},t?s?K(!0):ne=M.run():_?_(K.bind(null,!0),!0):M.run(),U.pause=M.pause.bind(M),U.resume=M.resume.bind(M),U.stop=U,U}function ed(e,t=1/0,i){if(t<=0||!Vo(e)||e.__v_skip||(i=i||new Set,i.has(e)))return e;if(i.add(e),t--,vi(e))ed(e.value,t,i);else if(fn(e))for(let s=0;s<e.length;s++)ed(e[s],t,i);else if(Kb(e)||um(e))e.forEach(s=>{ed(s,t,i)});else if(r_(e)){for(const s in e)ed(e[s],t,i);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&ed(e[s],t,i)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function O_(e,t,i,s){try{return s?e(...s):e()}catch(d){Qb(d,t,i)}}function Yc(e,t,i,s){if(Qn(e)){const d=O_(e,t,i,s);return d&&o_(d)&&d.catch(p=>{Qb(p,t,i)}),d}if(fn(e)){const d=[];for(let p=0;p<e.length;p++)d.push(Yc(e[p],t,i,s));return d}}function Qb(e,t,i,s=!0){const d=t?t.vnode:null,{errorHandler:p,throwUnhandledErrorInProduction:_}=t&&t.appContext.config||Fi;if(t){let o=t.parent;const w=t.proxy,C=`https://vuejs.org/error-reference/#runtime-${i}`;for(;o;){const M=o.ec;if(M){for(let I=0;I<M.length;I++)if(M[I](e,w,C)===!1)return}o=o.parent}if(p){Ih(),O_(p,null,10,[e,w,C]),Ah();return}}$5(e,i,d,s,_)}function $5(e,t,i,s=!0,d=!1){if(d)throw e;console.error(e)}const Rs=[];let xu=-1;const hm=[];let sh=null,tm=0;const aR=Promise.resolve();let mb=null;function oo(e){const t=mb||aR;return e?t.then(this?e.bind(this):e):t}function V5(e){let t=xu+1,i=Rs.length;for(;t<i;){const s=t+i>>>1,d=Rs[s],p=s_(d);p<e||p===e&&d.flags&2?t=s+1:i=s}return t}function $S(e){if(!(e.flags&1)){const t=s_(e),i=Rs[Rs.length-1];!i||!(e.flags&2)&&t>=s_(i)?Rs.push(e):Rs.splice(V5(t),0,e),e.flags|=1,sR()}}function sR(){mb||(mb=aR.then(cR))}function U5(e){fn(e)?hm.push(...e):sh&&e.id===-1?sh.splice(tm+1,0,e):e.flags&1||(hm.push(e),e.flags|=1),sR()}function tA(e,t,i=xu+1){for(;i<Rs.length;i++){const s=Rs[i];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;Rs.splice(i,1),i--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function lR(e){if(hm.length){const t=[...new Set(hm)].sort((i,s)=>s_(i)-s_(s));if(hm.length=0,sh){sh.push(...t);return}for(sh=t,tm=0;tm<sh.length;tm++){const i=sh[tm];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}sh=null,tm=0}}const s_=e=>e.id==null?e.flags&2?-1:1/0:e.id;function cR(e){try{for(xu=0;xu<Rs.length;xu++){const t=Rs[xu];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),O_(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;xu<Rs.length;xu++){const t=Rs[xu];t&&(t.flags&=-2)}xu=-1,Rs.length=0,lR(),mb=null,(Rs.length||hm.length)&&cR()}}let Ra=null,uR=null;function gb(e){const t=Ra;return Ra=e,uR=e&&e.type.__scopeId||null,t}function at(e,t=Ra,i){if(!t||e._n)return e;const s=(...d)=>{s._d&&pA(-1);const p=gb(t);let _;try{_=e(...d)}finally{gb(p),s._d&&pA(1)}return _};return s._n=!0,s._c=!0,s._d=!0,s}function zo(e,t){if(Ra===null)return e;const i=i1(Ra),s=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[p,_,o,w=Fi]=t[d];p&&(Qn(p)&&(p={mounted:p,updated:p}),p.deep&&ed(_),s.push({dir:p,instance:i,value:_,oldValue:void 0,arg:o,modifiers:w}))}return e}function yf(e,t,i,s){const d=e.dirs,p=t&&t.dirs;for(let _=0;_<d.length;_++){const o=d[_];p&&(o.oldValue=p[_].value);let w=o.dir[s];w&&(Ih(),Yc(w,i,8,[e.el,o,e,t]),Ah())}}const dR=Symbol("_vte"),hR=e=>e.__isTeleport,qv=e=>e&&(e.disabled||e.disabled===""),nA=e=>e&&(e.defer||e.defer===""),oA=e=>typeof SVGElement<"u"&&e instanceof SVGElement,rA=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,c2=(e,t)=>{const i=e&&e.to;return Zn(i)?t?t(i):null:i},fR={name:"Teleport",__isTeleport:!0,process(e,t,i,s,d,p,_,o,w,C){const{mc:M,pc:I,pbc:F,o:{insert:B,querySelector:N,createText:D,createComment:j}}=C,U=qv(t.props);let{shapeFlag:ne,children:K,dynamicChildren:G}=t;if(e==null){const J=t.el=D(""),oe=t.anchor=D("");B(J,i,s),B(oe,i,s);const se=(de,ce)=>{ne&16&&(d&&d.isCE&&(d.ce._teleportTarget=de),M(K,de,ce,d,p,_,o,w))},me=()=>{const de=t.target=c2(t.props,N),ce=pR(de,t,D,B);de&&(_!=="svg"&&oA(de)?_="svg":_!=="mathml"&&rA(de)&&(_="mathml"),U||(se(de,ce),q0(t,!1)))};U&&(se(i,oe),q0(t,!0)),nA(t.props)?ks(()=>{me(),t.el.__isMounted=!0},p):me()}else{if(nA(t.props)&&!e.el.__isMounted){ks(()=>{fR.process(e,t,i,s,d,p,_,o,w,C),delete e.el.__isMounted},p);return}t.el=e.el,t.targetStart=e.targetStart;const J=t.anchor=e.anchor,oe=t.target=e.target,se=t.targetAnchor=e.targetAnchor,me=qv(e.props),de=me?i:oe,ce=me?J:se;if(_==="svg"||oA(oe)?_="svg":(_==="mathml"||rA(oe))&&(_="mathml"),G?(F(e.dynamicChildren,G,de,d,p,_,o),qS(e,t,!0)):w||I(e,t,de,ce,d,p,_,o,!1),U)me?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):E0(t,i,J,C,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const pe=t.target=c2(t.props,N);pe&&E0(t,pe,null,C,0)}else me&&E0(t,oe,se,C,1);q0(t,U)}},remove(e,t,i,{um:s,o:{remove:d}},p){const{shapeFlag:_,children:o,anchor:w,targetStart:C,targetAnchor:M,target:I,props:F}=e;if(I&&(d(C),d(M)),p&&d(w),_&16){const B=p||!qv(F);for(let N=0;N<o.length;N++){const D=o[N];s(D,t,i,B,!!D.dynamicChildren)}}},move:E0,hydrate:j5};function E0(e,t,i,{o:{insert:s},m:d},p=2){p===0&&s(e.targetAnchor,t,i);const{el:_,anchor:o,shapeFlag:w,children:C,props:M}=e,I=p===2;if(I&&s(_,t,i),(!I||qv(M))&&w&16)for(let F=0;F<C.length;F++)d(C[F],t,i,2);I&&s(o,t,i)}function j5(e,t,i,s,d,p,{o:{nextSibling:_,parentNode:o,querySelector:w,insert:C,createText:M}},I){const F=t.target=c2(t.props,w);if(F){const B=qv(t.props),N=F._lpa||F.firstChild;if(t.shapeFlag&16)if(B)t.anchor=I(_(e),t,o(e),i,s,d,p),t.targetStart=N,t.targetAnchor=N&&_(N);else{t.anchor=_(e);let D=N;for(;D;){if(D&&D.nodeType===8){if(D.data==="teleport start anchor")t.targetStart=D;else if(D.data==="teleport anchor"){t.targetAnchor=D,F._lpa=t.targetAnchor&&_(t.targetAnchor);break}}D=_(D)}t.targetAnchor||pR(F,t,M,C),I(N&&_(N),t,F,i,s,d,p)}q0(t,B)}return t.anchor&&_(t.anchor)}const H5=fR;function q0(e,t){const i=e.ctx;if(i&&i.ut){let s,d;for(t?(s=e.el,d=e.anchor):(s=e.targetStart,d=e.targetAnchor);s&&s!==d;)s.nodeType===1&&s.setAttribute("data-v-owner",i.uid),s=s.nextSibling;i.ut()}}function pR(e,t,i,s){const d=t.targetStart=i(""),p=t.targetAnchor=i("");return d[dR]=p,e&&(s(d,e),s(p,e)),p}const lh=Symbol("_leaveCb"),M0=Symbol("_enterCb");function mR(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return No(()=>{e.isMounted=!0}),ni(()=>{e.isUnmounting=!0}),e}const Kl=[Function,Array],gR={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Kl,onEnter:Kl,onAfterEnter:Kl,onEnterCancelled:Kl,onBeforeLeave:Kl,onLeave:Kl,onAfterLeave:Kl,onLeaveCancelled:Kl,onBeforeAppear:Kl,onAppear:Kl,onAfterAppear:Kl,onAppearCancelled:Kl},vR=e=>{const t=e.subTree;return t.component?vR(t.component):t},G5={name:"BaseTransition",props:gR,setup(e,{slots:t}){const i=jo(),s=mR();return()=>{const d=t.default&&VS(t.default(),!0);if(!d||!d.length)return;const p=_R(d),_=ei(e),{mode:o}=_;if(s.isLeaving)return vw(p);const w=iA(p);if(!w)return vw(p);let C=l_(w,_,s,i,I=>C=I);w.type!==Sa&&Vf(w,C);let M=i.subTree&&iA(i.subTree);if(M&&M.type!==Sa&&!Cf(w,M)&&vR(i).type!==Sa){let I=l_(M,_,s,i);if(Vf(M,I),o==="out-in"&&w.type!==Sa)return s.isLeaving=!0,I.afterLeave=()=>{s.isLeaving=!1,i.job.flags&8||i.update(),delete I.afterLeave,M=void 0},vw(p);o==="in-out"&&w.type!==Sa?I.delayLeave=(F,B,N)=>{const D=yR(s,M);D[String(M.key)]=M,F[lh]=()=>{B(),F[lh]=void 0,delete C.delayedLeave,M=void 0},C.delayedLeave=()=>{N(),delete C.delayedLeave,M=void 0}}:M=void 0}else M&&(M=void 0);return p}}};function _R(e){let t=e[0];if(e.length>1){for(const i of e)if(i.type!==Sa){t=i;break}}return t}const W5=G5;function yR(e,t){const{leavingVNodes:i}=e;let s=i.get(t.type);return s||(s=Object.create(null),i.set(t.type,s)),s}function l_(e,t,i,s,d){const{appear:p,mode:_,persisted:o=!1,onBeforeEnter:w,onEnter:C,onAfterEnter:M,onEnterCancelled:I,onBeforeLeave:F,onLeave:B,onAfterLeave:N,onLeaveCancelled:D,onBeforeAppear:j,onAppear:U,onAfterAppear:ne,onAppearCancelled:K}=t,G=String(e.key),J=yR(i,e),oe=(de,ce)=>{de&&Yc(de,s,9,ce)},se=(de,ce)=>{const pe=ce[1];oe(de,ce),fn(de)?de.every(ge=>ge.length<=1)&&pe():de.length<=1&&pe()},me={mode:_,persisted:o,beforeEnter(de){let ce=w;if(!i.isMounted)if(p)ce=j||w;else return;de[lh]&&de[lh](!0);const pe=J[G];pe&&Cf(e,pe)&&pe.el[lh]&&pe.el[lh](),oe(ce,[de])},enter(de){let ce=C,pe=M,ge=I;if(!i.isMounted)if(p)ce=U||C,pe=ne||M,ge=K||I;else return;let Re=!1;const Je=de[M0]=Me=>{Re||(Re=!0,Me?oe(ge,[de]):oe(pe,[de]),me.delayedLeave&&me.delayedLeave(),de[M0]=void 0)};ce?se(ce,[de,Je]):Je()},leave(de,ce){const pe=String(e.key);if(de[M0]&&de[M0](!0),i.isUnmounting)return ce();oe(F,[de]);let ge=!1;const Re=de[lh]=Je=>{ge||(ge=!0,ce(),Je?oe(D,[de]):oe(N,[de]),de[lh]=void 0,J[pe]===e&&delete J[pe])};J[pe]=e,B?se(B,[de,Re]):Re()},clone(de){const ce=l_(de,t,i,s,d);return d&&d(ce),ce}};return me}function vw(e){if(e1(e))return e=id(e),e.children=null,e}function iA(e){if(!e1(e))return hR(e.type)&&e.children?_R(e.children):e;const{shapeFlag:t,children:i}=e;if(i){if(t&16)return i[0];if(t&32&&Qn(i.default))return i.default()}}function Vf(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Vf(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function VS(e,t=!1,i){let s=[],d=0;for(let p=0;p<e.length;p++){let _=e[p];const o=i==null?_.key:String(i)+String(_.key!=null?_.key:p);_.type===eo?(_.patchFlag&128&&d++,s=s.concat(VS(_.children,t,o))):(t||_.type!==Sa)&&s.push(o!=null?id(_,{key:o}):_)}if(d>1)for(let p=0;p<s.length;p++)s[p].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function Ze(e,t){return Qn(e)?da({name:e.name},t,{setup:e}):e}function bR(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function vb(e,t,i,s,d=!1){if(fn(e)){e.forEach((N,D)=>vb(N,t&&(fn(t)?t[D]:t),i,s,d));return}if(fm(s)&&!d){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&vb(e,t,i,s.component.subTree);return}const p=s.shapeFlag&4?i1(s.component):s.el,_=d?null:p,{i:o,r:w}=e,C=t&&t.r,M=o.refs===Fi?o.refs={}:o.refs,I=o.setupState,F=ei(I),B=I===Fi?()=>!1:N=>Tr(F,N);if(C!=null&&C!==w&&(Zn(C)?(M[C]=null,B(C)&&(I[C]=null)):vi(C)&&(C.value=null)),Qn(w))O_(w,o,12,[_,M]);else{const N=Zn(w),D=vi(w);if(N||D){const j=()=>{if(e.f){const U=N?B(w)?I[w]:M[w]:w.value;d?fn(U)&&RS(U,p):fn(U)?U.includes(p)||U.push(p):N?(M[w]=[p],B(w)&&(I[w]=M[w])):(w.value=[p],e.k&&(M[e.k]=w.value))}else N?(M[w]=_,B(w)&&(I[w]=_)):D&&(w.value=_,e.k&&(M[e.k]=_))};_?(j.id=-1,ks(j,i)):j()}}}Yb().requestIdleCallback;Yb().cancelIdleCallback;const fm=e=>!!e.type.__asyncLoader,e1=e=>e.type.__isKeepAlive;function US(e,t){wR(e,"a",t)}function xR(e,t){wR(e,"da",t)}function wR(e,t,i=ja){const s=e.__wdc||(e.__wdc=()=>{let d=i;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(t1(t,s,i),i){let d=i.parent;for(;d&&d.parent;)e1(d.parent.vnode)&&q5(s,t,i,d),d=d.parent}}function q5(e,t,i,s){const d=t1(t,e,s,!0);kh(()=>{RS(s[t],d)},i)}function t1(e,t,i=ja,s=!1){if(i){const d=i[e]||(i[e]=[]),p=t.__weh||(t.__weh=(..._)=>{Ih();const o=D_(i),w=Yc(t,i,e,_);return o(),Ah(),w});return s?d.unshift(p):d.push(p),p}}const ud=e=>(t,i=ja)=>{(!u_||e==="sp")&&t1(e,(...s)=>t(...s),i)},n1=ud("bm"),No=ud("m"),SR=ud("bu"),Ru=ud("u"),ni=ud("bum"),kh=ud("um"),K5=ud("sp"),Z5=ud("rtg"),Y5=ud("rtc");function X5(e,t=ja){t1("ec",e,t)}const jS="components",J5="directives";function Go(e,t){return HS(jS,e,!0,t)||e}const TR=Symbol.for("v-ndc");function Wo(e){return Zn(e)?HS(jS,e,!1)||e:e||TR}function o1(e){return HS(J5,e)}function HS(e,t,i=!0,s=!1){const d=Ra||ja;if(d){const p=d.type;if(e===jS){const o=z6(p,!1);if(o&&(o===t||o===Fs(t)||o===L_(Fs(t))))return p}const _=aA(d[e]||p[e],t)||aA(d.appContext[e],t);return!_&&s?p:_}}function aA(e,t){return e&&(e[t]||e[Fs(t)]||e[L_(Fs(t))])}function nr(e,t,i,s){let d;const p=i,_=fn(e);if(_||Zn(e)){const o=_&&dm(e);let w=!1;o&&(w=!ec(e),e=Jb(e)),d=new Array(e.length);for(let C=0,M=e.length;C<M;C++)d[C]=t(w?us(e[C]):e[C],C,void 0,p)}else if(typeof e=="number"){d=new Array(e);for(let o=0;o<e;o++)d[o]=t(o+1,o,void 0,p)}else if(Vo(e))if(e[Symbol.iterator])d=Array.from(e,(o,w)=>t(o,w,void 0,p));else{const o=Object.keys(e);d=new Array(o.length);for(let w=0,C=o.length;w<C;w++){const M=o[w];d[w]=t(e[M],M,w,p)}}else d=[];return d}function nc(e,t){for(let i=0;i<t.length;i++){const s=t[i];if(fn(s))for(let d=0;d<s.length;d++)e[s[d].name]=s[d].fn;else s&&(e[s.name]=s.key?(...d)=>{const p=s.fn(...d);return p&&(p.key=s.key),p}:s.fn)}return e}function _t(e,t,i={},s,d){if(Ra.ce||Ra.parent&&fm(Ra.parent)&&Ra.parent.ce)return t!=="default"&&(i.name=t),le(),Rt(eo,null,[Qe("slot",i,s&&s())],64);let p=e[t];p&&p._c&&(p._d=!1),le();const _=p&&CR(p(i)),o=i.key||_&&_.key,w=Rt(eo,{key:(o&&!Zc(o)?o:`_${t}`)+(!_&&s?"_fb":"")},_||(s?s():[]),_&&e._===1?64:-2);return w.scopeId&&(w.slotScopeIds=[w.scopeId+"-s"]),p&&p._c&&(p._d=!0),w}function CR(e){return e.some(t=>Ai(t)?!(t.type===Sa||t.type===eo&&!CR(t.children)):!0)?e:null}function Q5(e,t){const i={};for(const s in e)i[Hv(s)]=e[s];return i}const u2=e=>e?HR(e)?i1(e):u2(e.parent):null,Kv=da(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>u2(e.parent),$root:e=>u2(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>GS(e),$forceUpdate:e=>e.f||(e.f=()=>{$S(e.update)}),$nextTick:e=>e.n||(e.n=oo.bind(e.proxy)),$watch:e=>b6.bind(e)}),_w=(e,t)=>e!==Fi&&!e.__isScriptSetup&&Tr(e,t),e6={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:i,setupState:s,data:d,props:p,accessCache:_,type:o,appContext:w}=e;let C;if(t[0]!=="$"){const B=_[t];if(B!==void 0)switch(B){case 1:return s[t];case 2:return d[t];case 4:return i[t];case 3:return p[t]}else{if(_w(s,t))return _[t]=1,s[t];if(d!==Fi&&Tr(d,t))return _[t]=2,d[t];if((C=e.propsOptions[0])&&Tr(C,t))return _[t]=3,p[t];if(i!==Fi&&Tr(i,t))return _[t]=4,i[t];d2&&(_[t]=0)}}const M=Kv[t];let I,F;if(M)return t==="$attrs"&&cs(e.attrs,"get",""),M(e);if((I=o.__cssModules)&&(I=I[t]))return I;if(i!==Fi&&Tr(i,t))return _[t]=4,i[t];if(F=w.config.globalProperties,Tr(F,t))return F[t]},set({_:e},t,i){const{data:s,setupState:d,ctx:p}=e;return _w(d,t)?(d[t]=i,!0):s!==Fi&&Tr(s,t)?(s[t]=i,!0):Tr(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(p[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:s,appContext:d,propsOptions:p}},_){let o;return!!i[_]||e!==Fi&&Tr(e,_)||_w(t,_)||(o=p[0])&&Tr(o,_)||Tr(s,_)||Tr(Kv,_)||Tr(d.config.globalProperties,_)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:Tr(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function aa(){return ER().slots}function Ph(){return ER().attrs}function ER(){const e=jo();return e.setupContext||(e.setupContext=WR(e))}function sA(e){return fn(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let d2=!0;function t6(e){const t=GS(e),i=e.proxy,s=e.ctx;d2=!1,t.beforeCreate&&lA(t.beforeCreate,e,"bc");const{data:d,computed:p,methods:_,watch:o,provide:w,inject:C,created:M,beforeMount:I,mounted:F,beforeUpdate:B,updated:N,activated:D,deactivated:j,beforeDestroy:U,beforeUnmount:ne,destroyed:K,unmounted:G,render:J,renderTracked:oe,renderTriggered:se,errorCaptured:me,serverPrefetch:de,expose:ce,inheritAttrs:pe,components:ge,directives:Re,filters:Je}=t;if(C&&n6(C,s,null),_)for(const Ae in _){const Ce=_[Ae];Qn(Ce)&&(s[Ae]=Ce.bind(i))}if(d){const Ae=d.call(i,i);Vo(Ae)&&(e.data=Ir(Ae))}if(d2=!0,p)for(const Ae in p){const Ce=p[Ae],ve=Qn(Ce)?Ce.bind(i,i):Qn(Ce.get)?Ce.get.bind(i,i):jr,Ne=!Qn(Ce)&&Qn(Ce.set)?Ce.set.bind(i):jr,We=te({get:ve,set:Ne});Object.defineProperty(s,Ae,{enumerable:!0,configurable:!0,get:()=>We.value,set:ot=>We.value=ot})}if(o)for(const Ae in o)MR(o[Ae],s,i,Ae);if(w){const Ae=Qn(w)?w.call(i):w;Reflect.ownKeys(Ae).forEach(Ce=>{or(Ce,Ae[Ce])})}M&&lA(M,e,"c");function xe(Ae,Ce){fn(Ce)?Ce.forEach(ve=>Ae(ve.bind(i))):Ce&&Ae(Ce.bind(i))}if(xe(n1,I),xe(No,F),xe(SR,B),xe(Ru,N),xe(US,D),xe(xR,j),xe(X5,me),xe(Y5,oe),xe(Z5,se),xe(ni,ne),xe(kh,G),xe(K5,de),fn(ce))if(ce.length){const Ae=e.exposed||(e.exposed={});ce.forEach(Ce=>{Object.defineProperty(Ae,Ce,{get:()=>i[Ce],set:ve=>i[Ce]=ve})})}else e.exposed||(e.exposed={});J&&e.render===jr&&(e.render=J),pe!=null&&(e.inheritAttrs=pe),ge&&(e.components=ge),Re&&(e.directives=Re),de&&bR(e)}function n6(e,t,i=jr){fn(e)&&(e=h2(e));for(const s in e){const d=e[s];let p;Vo(d)?"default"in d?p=Un(d.from||s,d.default,!0):p=Un(d.from||s):p=Un(d),vi(p)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>p.value,set:_=>p.value=_}):t[s]=p}}function lA(e,t,i){Yc(fn(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,i)}function MR(e,t,i,s){let d=s.includes(".")?NR(i,s):()=>i[s];if(Zn(e)){const p=t[e];Qn(p)&&tn(d,p)}else if(Qn(e))tn(d,e.bind(i));else if(Vo(e))if(fn(e))e.forEach(p=>MR(p,t,i,s));else{const p=Qn(e.handler)?e.handler.bind(i):t[e.handler];Qn(p)&&tn(d,p,e)}}function GS(e){const t=e.type,{mixins:i,extends:s}=t,{mixins:d,optionsCache:p,config:{optionMergeStrategies:_}}=e.appContext,o=p.get(t);let w;return o?w=o:!d.length&&!i&&!s?w=t:(w={},d.length&&d.forEach(C=>_b(w,C,_,!0)),_b(w,t,_)),Vo(t)&&p.set(t,w),w}function _b(e,t,i,s=!1){const{mixins:d,extends:p}=t;p&&_b(e,p,i,!0),d&&d.forEach(_=>_b(e,_,i,!0));for(const _ in t)if(!(s&&_==="expose")){const o=o6[_]||i&&i[_];e[_]=o?o(e[_],t[_]):t[_]}return e}const o6={data:cA,props:uA,emits:uA,methods:Nv,computed:Nv,beforeCreate:As,created:As,beforeMount:As,mounted:As,beforeUpdate:As,updated:As,beforeDestroy:As,beforeUnmount:As,destroyed:As,unmounted:As,activated:As,deactivated:As,errorCaptured:As,serverPrefetch:As,components:Nv,directives:Nv,watch:i6,provide:cA,inject:r6};function cA(e,t){return t?e?function(){return da(Qn(e)?e.call(this,this):e,Qn(t)?t.call(this,this):t)}:t:e}function r6(e,t){return Nv(h2(e),h2(t))}function h2(e){if(fn(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function As(e,t){return e?[...new Set([].concat(e,t))]:t}function Nv(e,t){return e?da(Object.create(null),e,t):t}function uA(e,t){return e?fn(e)&&fn(t)?[...new Set([...e,...t])]:da(Object.create(null),sA(e),sA(t??{})):t}function i6(e,t){if(!e)return t;if(!t)return e;const i=da(Object.create(null),e);for(const s in t)i[s]=As(e[s],t[s]);return i}function IR(){return{app:null,config:{isNativeTag:XN,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let a6=0;function s6(e,t){return function(s,d=null){Qn(s)||(s=da({},s)),d!=null&&!Vo(d)&&(d=null);const p=IR(),_=new WeakSet,o=[];let w=!1;const C=p.app={_uid:a6++,_component:s,_props:d,_container:null,_context:p,_instance:null,version:B6,get config(){return p.config},set config(M){},use(M,...I){return _.has(M)||(M&&Qn(M.install)?(_.add(M),M.install(C,...I)):Qn(M)&&(_.add(M),M(C,...I))),C},mixin(M){return p.mixins.includes(M)||p.mixins.push(M),C},component(M,I){return I?(p.components[M]=I,C):p.components[M]},directive(M,I){return I?(p.directives[M]=I,C):p.directives[M]},mount(M,I,F){if(!w){const B=C._ceVNode||Qe(s,d);return B.appContext=p,F===!0?F="svg":F===!1&&(F=void 0),I&&t?t(B,M):e(B,M,F),w=!0,C._container=M,M.__vue_app__=C,i1(B.component)}},onUnmount(M){o.push(M)},unmount(){w&&(Yc(o,C._instance,16),e(null,C._container),delete C._container.__vue_app__)},provide(M,I){return p.provides[M]=I,C},runWithContext(M){const I=pm;pm=C;try{return M()}finally{pm=I}}};return C}}let pm=null;function or(e,t){if(ja){let i=ja.provides;const s=ja.parent&&ja.parent.provides;s===i&&(i=ja.provides=Object.create(s)),i[e]=t}}function Un(e,t,i=!1){const s=ja||Ra;if(s||pm){const d=pm?pm._context.provides:s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(d&&e in d)return d[e];if(arguments.length>1)return i&&Qn(t)?t.call(s&&s.proxy):t}}const AR={},kR=()=>Object.create(AR),PR=e=>Object.getPrototypeOf(e)===AR;function l6(e,t,i,s=!1){const d={},p=kR();e.propsDefaults=Object.create(null),RR(e,t,d,p);for(const _ in e.propsOptions[0])_ in d||(d[_]=void 0);i?e.props=s?d:nR(d):e.type.props?e.props=d:e.props=p,e.attrs=p}function c6(e,t,i,s){const{props:d,attrs:p,vnode:{patchFlag:_}}=e,o=ei(d),[w]=e.propsOptions;let C=!1;if((s||_>0)&&!(_&16)){if(_&8){const M=e.vnode.dynamicProps;for(let I=0;I<M.length;I++){let F=M[I];if(r1(e.emitsOptions,F))continue;const B=t[F];if(w)if(Tr(p,F))B!==p[F]&&(p[F]=B,C=!0);else{const N=Fs(F);d[N]=f2(w,o,N,B,e,!1)}else B!==p[F]&&(p[F]=B,C=!0)}}}else{RR(e,t,d,p)&&(C=!0);let M;for(const I in o)(!t||!Tr(t,I)&&((M=cd(I))===I||!Tr(t,M)))&&(w?i&&(i[I]!==void 0||i[M]!==void 0)&&(d[I]=f2(w,o,I,void 0,e,!0)):delete d[I]);if(p!==o)for(const I in p)(!t||!Tr(t,I))&&(delete p[I],C=!0)}C&&Qu(e.attrs,"set","")}function RR(e,t,i,s){const[d,p]=e.propsOptions;let _=!1,o;if(t)for(let w in t){if(jv(w))continue;const C=t[w];let M;d&&Tr(d,M=Fs(w))?!p||!p.includes(M)?i[M]=C:(o||(o={}))[M]=C:r1(e.emitsOptions,w)||(!(w in s)||C!==s[w])&&(s[w]=C,_=!0)}if(p){const w=ei(i),C=o||Fi;for(let M=0;M<p.length;M++){const I=p[M];i[I]=f2(d,w,I,C[I],e,!Tr(C,I))}}return _}function f2(e,t,i,s,d,p){const _=e[i];if(_!=null){const o=Tr(_,"default");if(o&&s===void 0){const w=_.default;if(_.type!==Function&&!_.skipFactory&&Qn(w)){const{propsDefaults:C}=d;if(i in C)s=C[i];else{const M=D_(d);s=C[i]=w.call(null,t),M()}}else s=w;d.ce&&d.ce._setProp(i,s)}_[0]&&(p&&!o?s=!1:_[1]&&(s===""||s===cd(i))&&(s=!0))}return s}const u6=new WeakMap;function LR(e,t,i=!1){const s=i?u6:t.propsCache,d=s.get(e);if(d)return d;const p=e.props,_={},o=[];let w=!1;if(!Qn(e)){const M=I=>{w=!0;const[F,B]=LR(I,t,!0);da(_,F),B&&o.push(...B)};!i&&t.mixins.length&&t.mixins.forEach(M),e.extends&&M(e.extends),e.mixins&&e.mixins.forEach(M)}if(!p&&!w)return Vo(e)&&s.set(e,cm),cm;if(fn(p))for(let M=0;M<p.length;M++){const I=Fs(p[M]);dA(I)&&(_[I]=Fi)}else if(p)for(const M in p){const I=Fs(M);if(dA(I)){const F=p[M],B=_[I]=fn(F)||Qn(F)?{type:F}:da({},F),N=B.type;let D=!1,j=!0;if(fn(N))for(let U=0;U<N.length;++U){const ne=N[U],K=Qn(ne)&&ne.name;if(K==="Boolean"){D=!0;break}else K==="String"&&(j=!1)}else D=Qn(N)&&N.name==="Boolean";B[0]=D,B[1]=j,(D||Tr(B,"default"))&&o.push(I)}}const C=[_,o];return Vo(e)&&s.set(e,C),C}function dA(e){return e[0]!=="$"&&!jv(e)}const OR=e=>e[0]==="_"||e==="$stable",WS=e=>fn(e)?e.map(wu):[wu(e)],d6=(e,t,i)=>{if(t._n)return t;const s=at((...d)=>WS(t(...d)),i);return s._c=!1,s},DR=(e,t,i)=>{const s=e._ctx;for(const d in e){if(OR(d))continue;const p=e[d];if(Qn(p))t[d]=d6(d,p,s);else if(p!=null){const _=WS(p);t[d]=()=>_}}},zR=(e,t)=>{const i=WS(t);e.slots.default=()=>i},FR=(e,t,i)=>{for(const s in t)(i||s!=="_")&&(e[s]=t[s])},h6=(e,t,i)=>{const s=e.slots=kR();if(e.vnode.shapeFlag&32){const d=t._;d?(FR(s,t,i),i&&O3(s,"_",d,!0)):DR(t,s)}else t&&zR(e,t)},f6=(e,t,i)=>{const{vnode:s,slots:d}=e;let p=!0,_=Fi;if(s.shapeFlag&32){const o=t._;o?i&&o===1?p=!1:FR(d,t,i):(p=!t.$stable,DR(t,d)),_=t}else t&&(zR(e,t),_={default:1});if(p)for(const o in d)!OR(o)&&_[o]==null&&delete d[o]},ks=M6;function p6(e){return m6(e)}function m6(e,t){const i=Yb();i.__VUE__=!0;const{insert:s,remove:d,patchProp:p,createElement:_,createText:o,createComment:w,setText:C,setElementText:M,parentNode:I,nextSibling:F,setScopeId:B=jr,insertStaticContent:N}=e,D=(Ke,Be,Ht,Ut=null,Nt=null,Et=null,Gt=void 0,ln=null,bn=!!Be.dynamicChildren)=>{if(Ke===Be)return;Ke&&!Cf(Ke,Be)&&(Ut=bt(Ke),ot(Ke,Nt,Et,!0),Ke=null),Be.patchFlag===-2&&(bn=!1,Be.dynamicChildren=null);const{type:_n,ref:jn,shapeFlag:yt}=Be;switch(_n){case Um:j(Ke,Be,Ht,Ut);break;case Sa:U(Ke,Be,Ht,Ut);break;case xw:Ke==null&&ne(Be,Ht,Ut,Gt);break;case eo:ge(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn);break;default:yt&1?J(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn):yt&6?Re(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn):(yt&64||yt&128)&&_n.process(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn,Le)}jn!=null&&Nt&&vb(jn,Ke&&Ke.ref,Et,Be||Ke,!Be)},j=(Ke,Be,Ht,Ut)=>{if(Ke==null)s(Be.el=o(Be.children),Ht,Ut);else{const Nt=Be.el=Ke.el;Be.children!==Ke.children&&C(Nt,Be.children)}},U=(Ke,Be,Ht,Ut)=>{Ke==null?s(Be.el=w(Be.children||""),Ht,Ut):Be.el=Ke.el},ne=(Ke,Be,Ht,Ut)=>{[Ke.el,Ke.anchor]=N(Ke.children,Be,Ht,Ut,Ke.el,Ke.anchor)},K=({el:Ke,anchor:Be},Ht,Ut)=>{let Nt;for(;Ke&&Ke!==Be;)Nt=F(Ke),s(Ke,Ht,Ut),Ke=Nt;s(Be,Ht,Ut)},G=({el:Ke,anchor:Be})=>{let Ht;for(;Ke&&Ke!==Be;)Ht=F(Ke),d(Ke),Ke=Ht;d(Be)},J=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn)=>{Be.type==="svg"?Gt="svg":Be.type==="math"&&(Gt="mathml"),Ke==null?oe(Be,Ht,Ut,Nt,Et,Gt,ln,bn):de(Ke,Be,Nt,Et,Gt,ln,bn)},oe=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln)=>{let bn,_n;const{props:jn,shapeFlag:yt,transition:kn,dirs:qn}=Ke;if(bn=Ke.el=_(Ke.type,Et,jn&&jn.is,jn),yt&8?M(bn,Ke.children):yt&16&&me(Ke.children,bn,null,Ut,Nt,yw(Ke,Et),Gt,ln),qn&&yf(Ke,null,Ut,"created"),se(bn,Ke,Ke.scopeId,Gt,Ut),jn){for(const mo in jn)mo!=="value"&&!jv(mo)&&p(bn,mo,null,jn[mo],Et,Ut);"value"in jn&&p(bn,"value",null,jn.value,Et),(_n=jn.onVnodeBeforeMount)&&yu(_n,Ut,Ke)}qn&&yf(Ke,null,Ut,"beforeMount");const Co=g6(Nt,kn);Co&&kn.beforeEnter(bn),s(bn,Be,Ht),((_n=jn&&jn.onVnodeMounted)||Co||qn)&&ks(()=>{_n&&yu(_n,Ut,Ke),Co&&kn.enter(bn),qn&&yf(Ke,null,Ut,"mounted")},Nt)},se=(Ke,Be,Ht,Ut,Nt)=>{if(Ht&&B(Ke,Ht),Ut)for(let Et=0;Et<Ut.length;Et++)B(Ke,Ut[Et]);if(Nt){let Et=Nt.subTree;if(Be===Et||VR(Et.type)&&(Et.ssContent===Be||Et.ssFallback===Be)){const Gt=Nt.vnode;se(Ke,Gt,Gt.scopeId,Gt.slotScopeIds,Nt.parent)}}},me=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn=0)=>{for(let _n=bn;_n<Ke.length;_n++){const jn=Ke[_n]=ln?ch(Ke[_n]):wu(Ke[_n]);D(null,jn,Be,Ht,Ut,Nt,Et,Gt,ln)}},de=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{const ln=Be.el=Ke.el;let{patchFlag:bn,dynamicChildren:_n,dirs:jn}=Be;bn|=Ke.patchFlag&16;const yt=Ke.props||Fi,kn=Be.props||Fi;let qn;if(Ht&&bf(Ht,!1),(qn=kn.onVnodeBeforeUpdate)&&yu(qn,Ht,Be,Ke),jn&&yf(Be,Ke,Ht,"beforeUpdate"),Ht&&bf(Ht,!0),(yt.innerHTML&&kn.innerHTML==null||yt.textContent&&kn.textContent==null)&&M(ln,""),_n?ce(Ke.dynamicChildren,_n,ln,Ht,Ut,yw(Be,Nt),Et):Gt||Ce(Ke,Be,ln,null,Ht,Ut,yw(Be,Nt),Et,!1),bn>0){if(bn&16)pe(ln,yt,kn,Ht,Nt);else if(bn&2&&yt.class!==kn.class&&p(ln,"class",null,kn.class,Nt),bn&4&&p(ln,"style",yt.style,kn.style,Nt),bn&8){const Co=Be.dynamicProps;for(let mo=0;mo<Co.length;mo++){const Io=Co[mo],Ho=yt[Io],ur=kn[Io];(ur!==Ho||Io==="value")&&p(ln,Io,Ho,ur,Nt,Ht)}}bn&1&&Ke.children!==Be.children&&M(ln,Be.children)}else!Gt&&_n==null&&pe(ln,yt,kn,Ht,Nt);((qn=kn.onVnodeUpdated)||jn)&&ks(()=>{qn&&yu(qn,Ht,Be,Ke),jn&&yf(Be,Ke,Ht,"updated")},Ut)},ce=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{for(let ln=0;ln<Be.length;ln++){const bn=Ke[ln],_n=Be[ln],jn=bn.el&&(bn.type===eo||!Cf(bn,_n)||bn.shapeFlag&70)?I(bn.el):Ht;D(bn,_n,jn,null,Ut,Nt,Et,Gt,!0)}},pe=(Ke,Be,Ht,Ut,Nt)=>{if(Be!==Ht){if(Be!==Fi)for(const Et in Be)!jv(Et)&&!(Et in Ht)&&p(Ke,Et,Be[Et],null,Nt,Ut);for(const Et in Ht){if(jv(Et))continue;const Gt=Ht[Et],ln=Be[Et];Gt!==ln&&Et!=="value"&&p(Ke,Et,ln,Gt,Nt,Ut)}"value"in Ht&&p(Ke,"value",Be.value,Ht.value,Nt)}},ge=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn)=>{const _n=Be.el=Ke?Ke.el:o(""),jn=Be.anchor=Ke?Ke.anchor:o("");let{patchFlag:yt,dynamicChildren:kn,slotScopeIds:qn}=Be;qn&&(ln=ln?ln.concat(qn):qn),Ke==null?(s(_n,Ht,Ut),s(jn,Ht,Ut),me(Be.children||[],Ht,jn,Nt,Et,Gt,ln,bn)):yt>0&&yt&64&&kn&&Ke.dynamicChildren?(ce(Ke.dynamicChildren,kn,Ht,Nt,Et,Gt,ln),(Be.key!=null||Nt&&Be===Nt.subTree)&&qS(Ke,Be,!0)):Ce(Ke,Be,Ht,jn,Nt,Et,Gt,ln,bn)},Re=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn)=>{Be.slotScopeIds=ln,Ke==null?Be.shapeFlag&512?Nt.ctx.activate(Be,Ht,Ut,Gt,bn):Je(Be,Ht,Ut,Nt,Et,Gt,bn):Me(Ke,Be,bn)},Je=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{const ln=Ke.component=R6(Ke,Ut,Nt);if(e1(Ke)&&(ln.ctx.renderer=Le),L6(ln,!1,Gt),ln.asyncDep){if(Nt&&Nt.registerDep(ln,xe,Gt),!Ke.el){const bn=ln.subTree=Qe(Sa);U(null,bn,Be,Ht)}}else xe(ln,Ke,Be,Ht,Nt,Et,Gt)},Me=(Ke,Be,Ht)=>{const Ut=Be.component=Ke.component;if(C6(Ke,Be,Ht))if(Ut.asyncDep&&!Ut.asyncResolved){Ae(Ut,Be,Ht);return}else Ut.next=Be,Ut.update();else Be.el=Ke.el,Ut.vnode=Be},xe=(Ke,Be,Ht,Ut,Nt,Et,Gt)=>{const ln=()=>{if(Ke.isMounted){let{next:yt,bu:kn,u:qn,parent:Co,vnode:mo}=Ke;{const En=BR(Ke);if(En){yt&&(yt.el=mo.el,Ae(Ke,yt,Gt)),En.asyncDep.then(()=>{Ke.isUnmounted||ln()});return}}let Io=yt,Ho;bf(Ke,!1),yt?(yt.el=mo.el,Ae(Ke,yt,Gt)):yt=mo,kn&&W0(kn),(Ho=yt.props&&yt.props.onVnodeBeforeUpdate)&&yu(Ho,Co,yt,mo),bf(Ke,!0);const ur=bw(Ke),Dt=Ke.subTree;Ke.subTree=ur,D(Dt,ur,I(Dt.el),bt(Dt),Ke,Nt,Et),yt.el=ur.el,Io===null&&E6(Ke,ur.el),qn&&ks(qn,Nt),(Ho=yt.props&&yt.props.onVnodeUpdated)&&ks(()=>yu(Ho,Co,yt,mo),Nt)}else{let yt;const{el:kn,props:qn}=Be,{bm:Co,m:mo,parent:Io,root:Ho,type:ur}=Ke,Dt=fm(Be);if(bf(Ke,!1),Co&&W0(Co),!Dt&&(yt=qn&&qn.onVnodeBeforeMount)&&yu(yt,Io,Be),bf(Ke,!0),kn&&At){const En=()=>{Ke.subTree=bw(Ke),At(kn,Ke.subTree,Ke,Nt,null)};Dt&&ur.__asyncHydrate?ur.__asyncHydrate(kn,Ke,En):En()}else{Ho.ce&&Ho.ce._injectChildStyle(ur);const En=Ke.subTree=bw(Ke);D(null,En,Ht,Ut,Ke,Nt,Et),Be.el=En.el}if(mo&&ks(mo,Nt),!Dt&&(yt=qn&&qn.onVnodeMounted)){const En=Be;ks(()=>yu(yt,Io,En),Nt)}(Be.shapeFlag&256||Io&&fm(Io.vnode)&&Io.vnode.shapeFlag&256)&&Ke.a&&ks(Ke.a,Nt),Ke.isMounted=!0,Be=Ht=Ut=null}};Ke.scope.on();const bn=Ke.effect=new U3(ln);Ke.scope.off();const _n=Ke.update=bn.run.bind(bn),jn=Ke.job=bn.runIfDirty.bind(bn);jn.i=Ke,jn.id=Ke.uid,bn.scheduler=()=>$S(jn),bf(Ke,!0),_n()},Ae=(Ke,Be,Ht)=>{Be.component=Ke;const Ut=Ke.vnode.props;Ke.vnode=Be,Ke.next=null,c6(Ke,Be.props,Ut,Ht),f6(Ke,Be.children,Ht),Ih(),tA(Ke),Ah()},Ce=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn=!1)=>{const _n=Ke&&Ke.children,jn=Ke?Ke.shapeFlag:0,yt=Be.children,{patchFlag:kn,shapeFlag:qn}=Be;if(kn>0){if(kn&128){Ne(_n,yt,Ht,Ut,Nt,Et,Gt,ln,bn);return}else if(kn&256){ve(_n,yt,Ht,Ut,Nt,Et,Gt,ln,bn);return}}qn&8?(jn&16&&zt(_n,Nt,Et),yt!==_n&&M(Ht,yt)):jn&16?qn&16?Ne(_n,yt,Ht,Ut,Nt,Et,Gt,ln,bn):zt(_n,Nt,Et,!0):(jn&8&&M(Ht,""),qn&16&&me(yt,Ht,Ut,Nt,Et,Gt,ln,bn))},ve=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn)=>{Ke=Ke||cm,Be=Be||cm;const _n=Ke.length,jn=Be.length,yt=Math.min(_n,jn);let kn;for(kn=0;kn<yt;kn++){const qn=Be[kn]=bn?ch(Be[kn]):wu(Be[kn]);D(Ke[kn],qn,Ht,null,Nt,Et,Gt,ln,bn)}_n>jn?zt(Ke,Nt,Et,!0,!1,yt):me(Be,Ht,Ut,Nt,Et,Gt,ln,bn,yt)},Ne=(Ke,Be,Ht,Ut,Nt,Et,Gt,ln,bn)=>{let _n=0;const jn=Be.length;let yt=Ke.length-1,kn=jn-1;for(;_n<=yt&&_n<=kn;){const qn=Ke[_n],Co=Be[_n]=bn?ch(Be[_n]):wu(Be[_n]);if(Cf(qn,Co))D(qn,Co,Ht,null,Nt,Et,Gt,ln,bn);else break;_n++}for(;_n<=yt&&_n<=kn;){const qn=Ke[yt],Co=Be[kn]=bn?ch(Be[kn]):wu(Be[kn]);if(Cf(qn,Co))D(qn,Co,Ht,null,Nt,Et,Gt,ln,bn);else break;yt--,kn--}if(_n>yt){if(_n<=kn){const qn=kn+1,Co=qn<jn?Be[qn].el:Ut;for(;_n<=kn;)D(null,Be[_n]=bn?ch(Be[_n]):wu(Be[_n]),Ht,Co,Nt,Et,Gt,ln,bn),_n++}}else if(_n>kn)for(;_n<=yt;)ot(Ke[_n],Nt,Et,!0),_n++;else{const qn=_n,Co=_n,mo=new Map;for(_n=Co;_n<=kn;_n++){const et=Be[_n]=bn?ch(Be[_n]):wu(Be[_n]);et.key!=null&&mo.set(et.key,_n)}let Io,Ho=0;const ur=kn-Co+1;let Dt=!1,En=0;const ft=new Array(ur);for(_n=0;_n<ur;_n++)ft[_n]=0;for(_n=qn;_n<=yt;_n++){const et=Ke[_n];if(Ho>=ur){ot(et,Nt,Et,!0);continue}let Mn;if(et.key!=null)Mn=mo.get(et.key);else for(Io=Co;Io<=kn;Io++)if(ft[Io-Co]===0&&Cf(et,Be[Io])){Mn=Io;break}Mn===void 0?ot(et,Nt,Et,!0):(ft[Mn-Co]=_n+1,Mn>=En?En=Mn:Dt=!0,D(et,Be[Mn],Ht,null,Nt,Et,Gt,ln,bn),Ho++)}const un=Dt?v6(ft):cm;for(Io=un.length-1,_n=ur-1;_n>=0;_n--){const et=Co+_n,Mn=Be[et],Bn=et+1<jn?Be[et+1].el:Ut;ft[_n]===0?D(null,Mn,Ht,Bn,Nt,Et,Gt,ln,bn):Dt&&(Io<0||_n!==un[Io]?We(Mn,Ht,Bn,2):Io--)}}},We=(Ke,Be,Ht,Ut,Nt=null)=>{const{el:Et,type:Gt,transition:ln,children:bn,shapeFlag:_n}=Ke;if(_n&6){We(Ke.component.subTree,Be,Ht,Ut);return}if(_n&128){Ke.suspense.move(Be,Ht,Ut);return}if(_n&64){Gt.move(Ke,Be,Ht,Le);return}if(Gt===eo){s(Et,Be,Ht);for(let yt=0;yt<bn.length;yt++)We(bn[yt],Be,Ht,Ut);s(Ke.anchor,Be,Ht);return}if(Gt===xw){K(Ke,Be,Ht);return}if(Ut!==2&&_n&1&&ln)if(Ut===0)ln.beforeEnter(Et),s(Et,Be,Ht),ks(()=>ln.enter(Et),Nt);else{const{leave:yt,delayLeave:kn,afterLeave:qn}=ln,Co=()=>s(Et,Be,Ht),mo=()=>{yt(Et,()=>{Co(),qn&&qn()})};kn?kn(Et,Co,mo):mo()}else s(Et,Be,Ht)},ot=(Ke,Be,Ht,Ut=!1,Nt=!1)=>{const{type:Et,props:Gt,ref:ln,children:bn,dynamicChildren:_n,shapeFlag:jn,patchFlag:yt,dirs:kn,cacheIndex:qn}=Ke;if(yt===-2&&(Nt=!1),ln!=null&&vb(ln,null,Ht,Ke,!0),qn!=null&&(Be.renderCache[qn]=void 0),jn&256){Be.ctx.deactivate(Ke);return}const Co=jn&1&&kn,mo=!fm(Ke);let Io;if(mo&&(Io=Gt&&Gt.onVnodeBeforeUnmount)&&yu(Io,Be,Ke),jn&6)Mt(Ke.component,Ht,Ut);else{if(jn&128){Ke.suspense.unmount(Ht,Ut);return}Co&&yf(Ke,null,Be,"beforeUnmount"),jn&64?Ke.type.remove(Ke,Be,Ht,Le,Ut):_n&&!_n.hasOnce&&(Et!==eo||yt>0&&yt&64)?zt(_n,Be,Ht,!1,!0):(Et===eo&&yt&384||!Nt&&jn&16)&&zt(bn,Be,Ht),Ut&&Oe(Ke)}(mo&&(Io=Gt&&Gt.onVnodeUnmounted)||Co)&&ks(()=>{Io&&yu(Io,Be,Ke),Co&&yf(Ke,null,Be,"unmounted")},Ht)},Oe=Ke=>{const{type:Be,el:Ht,anchor:Ut,transition:Nt}=Ke;if(Be===eo){Ct(Ht,Ut);return}if(Be===xw){G(Ke);return}const Et=()=>{d(Ht),Nt&&!Nt.persisted&&Nt.afterLeave&&Nt.afterLeave()};if(Ke.shapeFlag&1&&Nt&&!Nt.persisted){const{leave:Gt,delayLeave:ln}=Nt,bn=()=>Gt(Ht,Et);ln?ln(Ke.el,Et,bn):bn()}else Et()},Ct=(Ke,Be)=>{let Ht;for(;Ke!==Be;)Ht=F(Ke),d(Ke),Ke=Ht;d(Be)},Mt=(Ke,Be,Ht)=>{const{bum:Ut,scope:Nt,job:Et,subTree:Gt,um:ln,m:bn,a:_n}=Ke;hA(bn),hA(_n),Ut&&W0(Ut),Nt.stop(),Et&&(Et.flags|=8,ot(Gt,Ke,Be,Ht)),ln&&ks(ln,Be),ks(()=>{Ke.isUnmounted=!0},Be),Be&&Be.pendingBranch&&!Be.isUnmounted&&Ke.asyncDep&&!Ke.asyncResolved&&Ke.suspenseId===Be.pendingId&&(Be.deps--,Be.deps===0&&Be.resolve())},zt=(Ke,Be,Ht,Ut=!1,Nt=!1,Et=0)=>{for(let Gt=Et;Gt<Ke.length;Gt++)ot(Ke[Gt],Be,Ht,Ut,Nt)},bt=Ke=>{if(Ke.shapeFlag&6)return bt(Ke.component.subTree);if(Ke.shapeFlag&128)return Ke.suspense.next();const Be=F(Ke.anchor||Ke.el),Ht=Be&&Be[dR];return Ht?F(Ht):Be};let Kt=!1;const $t=(Ke,Be,Ht)=>{Ke==null?Be._vnode&&ot(Be._vnode,null,null,!0):D(Be._vnode||null,Ke,Be,null,null,null,Ht),Be._vnode=Ke,Kt||(Kt=!0,tA(),lR(),Kt=!1)},Le={p:D,um:ot,m:We,r:Oe,mt:Je,mc:me,pc:Ce,pbc:ce,n:bt,o:e};let dn,At;return{render:$t,hydrate:dn,createApp:s6($t,dn)}}function yw({type:e,props:t},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:i}function bf({effect:e,job:t},i){i?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function g6(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function qS(e,t,i=!1){const s=e.children,d=t.children;if(fn(s)&&fn(d))for(let p=0;p<s.length;p++){const _=s[p];let o=d[p];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=d[p]=ch(d[p]),o.el=_.el),!i&&o.patchFlag!==-2&&qS(_,o)),o.type===Um&&(o.el=_.el)}}function v6(e){const t=e.slice(),i=[0];let s,d,p,_,o;const w=e.length;for(s=0;s<w;s++){const C=e[s];if(C!==0){if(d=i[i.length-1],e[d]<C){t[s]=d,i.push(s);continue}for(p=0,_=i.length-1;p<_;)o=p+_>>1,e[i[o]]<C?p=o+1:_=o;C<e[i[p]]&&(p>0&&(t[s]=i[p-1]),i[p]=s)}}for(p=i.length,_=i[p-1];p-- >0;)i[p]=_,_=t[_];return i}function BR(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:BR(t)}function hA(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const _6=Symbol.for("v-scx"),y6=()=>Un(_6);function Ha(e,t){return KS(e,null,t)}function tn(e,t,i){return KS(e,t,i)}function KS(e,t,i=Fi){const{immediate:s,deep:d,flush:p,once:_}=i,o=da({},i),w=t&&s||!t&&p!=="post";let C;if(u_){if(p==="sync"){const B=y6();C=B.__watcherHandles||(B.__watcherHandles=[])}else if(!w){const B=()=>{};return B.stop=jr,B.resume=jr,B.pause=jr,B}}const M=ja;o.call=(B,N,D)=>Yc(B,M,N,D);let I=!1;p==="post"?o.scheduler=B=>{ks(B,M&&M.suspense)}:p!=="sync"&&(I=!0,o.scheduler=(B,N)=>{N?B():$S(B)}),o.augmentJob=B=>{t&&(B.flags|=4),I&&(B.flags|=2,M&&(B.id=M.uid,B.i=M))};const F=N5(e,t,o);return u_&&(C?C.push(F):w&&F()),F}function b6(e,t,i){const s=this.proxy,d=Zn(e)?e.includes(".")?NR(s,e):()=>s[e]:e.bind(s,s);let p;Qn(t)?p=t:(p=t.handler,i=t);const _=D_(this),o=KS(d,p.bind(s),i);return _(),o}function NR(e,t){const i=t.split(".");return()=>{let s=e;for(let d=0;d<i.length&&s;d++)s=s[i[d]];return s}}const x6=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Fs(t)}Modifiers`]||e[`${cd(t)}Modifiers`];function w6(e,t,...i){if(e.isUnmounted)return;const s=e.vnode.props||Fi;let d=i;const p=t.startsWith("update:"),_=p&&x6(s,t.slice(7));_&&(_.trim&&(d=i.map(M=>Zn(M)?M.trim():M)),_.number&&(d=i.map(r2)));let o,w=s[o=Hv(t)]||s[o=Hv(Fs(t))];!w&&p&&(w=s[o=Hv(cd(t))]),w&&Yc(w,e,6,d);const C=s[o+"Once"];if(C){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Yc(C,e,6,d)}}function $R(e,t,i=!1){const s=t.emitsCache,d=s.get(e);if(d!==void 0)return d;const p=e.emits;let _={},o=!1;if(!Qn(e)){const w=C=>{const M=$R(C,t,!0);M&&(o=!0,da(_,M))};!i&&t.mixins.length&&t.mixins.forEach(w),e.extends&&w(e.extends),e.mixins&&e.mixins.forEach(w)}return!p&&!o?(Vo(e)&&s.set(e,null),null):(fn(p)?p.forEach(w=>_[w]=null):da(_,p),Vo(e)&&s.set(e,_),_)}function r1(e,t){return!e||!qb(t)?!1:(t=t.slice(2).replace(/Once$/,""),Tr(e,t[0].toLowerCase()+t.slice(1))||Tr(e,cd(t))||Tr(e,t))}function bw(e){const{type:t,vnode:i,proxy:s,withProxy:d,propsOptions:[p],slots:_,attrs:o,emit:w,render:C,renderCache:M,props:I,data:F,setupState:B,ctx:N,inheritAttrs:D}=e,j=gb(e);let U,ne;try{if(i.shapeFlag&4){const G=d||s,J=G;U=wu(C.call(J,G,M,I,B,F,N)),ne=o}else{const G=t;U=wu(G.length>1?G(I,{attrs:o,slots:_,emit:w}):G(I,null)),ne=t.props?o:S6(o)}}catch(G){Zv.length=0,Qb(G,e,1),U=Qe(Sa)}let K=U;if(ne&&D!==!1){const G=Object.keys(ne),{shapeFlag:J}=K;G.length&&J&7&&(p&&G.some(PS)&&(ne=T6(ne,p)),K=id(K,ne,!1,!0))}return i.dirs&&(K=id(K,null,!1,!0),K.dirs=K.dirs?K.dirs.concat(i.dirs):i.dirs),i.transition&&Vf(K,i.transition),U=K,gb(j),U}const S6=e=>{let t;for(const i in e)(i==="class"||i==="style"||qb(i))&&((t||(t={}))[i]=e[i]);return t},T6=(e,t)=>{const i={};for(const s in e)(!PS(s)||!(s.slice(9)in t))&&(i[s]=e[s]);return i};function C6(e,t,i){const{props:s,children:d,component:p}=e,{props:_,children:o,patchFlag:w}=t,C=p.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&w>=0){if(w&1024)return!0;if(w&16)return s?fA(s,_,C):!!_;if(w&8){const M=t.dynamicProps;for(let I=0;I<M.length;I++){const F=M[I];if(_[F]!==s[F]&&!r1(C,F))return!0}}}else return(d||o)&&(!o||!o.$stable)?!0:s===_?!1:s?_?fA(s,_,C):!0:!!_;return!1}function fA(e,t,i){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let d=0;d<s.length;d++){const p=s[d];if(t[p]!==e[p]&&!r1(i,p))return!0}return!1}function E6({vnode:e,parent:t},i){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=i,t=t.parent;else break}}const VR=e=>e.__isSuspense;function M6(e,t){t&&t.pendingBranch?fn(e)?t.effects.push(...e):t.effects.push(e):U5(e)}const eo=Symbol.for("v-fgt"),Um=Symbol.for("v-txt"),Sa=Symbol.for("v-cmt"),xw=Symbol.for("v-stc"),Zv=[];let wl=null;function le(e=!1){Zv.push(wl=e?null:[])}function I6(){Zv.pop(),wl=Zv[Zv.length-1]||null}let c_=1;function pA(e,t=!1){c_+=e,e<0&&wl&&t&&(wl.hasOnce=!0)}function UR(e){return e.dynamicChildren=c_>0?wl||cm:null,I6(),c_>0&&wl&&wl.push(e),e}function Pe(e,t,i,s,d,p){return UR(Ve(e,t,i,s,d,p,!0))}function Rt(e,t,i,s,d){return UR(Qe(e,t,i,s,d,!0))}function Ai(e){return e?e.__v_isVNode===!0:!1}function Cf(e,t){return e.type===t.type&&e.key===t.key}const jR=({key:e})=>e??null,K0=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Zn(e)||vi(e)||Qn(e)?{i:Ra,r:e,k:t,f:!!i}:e:null);function Ve(e,t=null,i=null,s=0,d=null,p=e===eo?0:1,_=!1,o=!1){const w={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&jR(t),ref:t&&K0(t),scopeId:uR,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:p,patchFlag:s,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:Ra};return o?(ZS(w,i),p&128&&e.normalize(w)):i&&(w.shapeFlag|=Zn(i)?8:16),c_>0&&!_&&wl&&(w.patchFlag>0||p&6)&&w.patchFlag!==32&&wl.push(w),w}const Qe=A6;function A6(e,t=null,i=null,s=0,d=null,p=!1){if((!e||e===TR)&&(e=Sa),Ai(e)){const o=id(e,t,!0);return i&&ZS(o,i),c_>0&&!p&&wl&&(o.shapeFlag&6?wl[wl.indexOf(e)]=o:wl.push(o)),o.patchFlag=-2,o}if(F6(e)&&(e=e.__vccOpts),t){t=yh(t);let{class:o,style:w}=t;o&&!Zn(o)&&(t.class=he(o)),Vo(w)&&(NS(w)&&!fn(w)&&(w=da({},w)),t.style=to(w))}const _=Zn(e)?1:VR(e)?128:hR(e)?64:Vo(e)?4:Qn(e)?2:0;return Ve(e,t,i,s,d,_,p,!0)}function yh(e){return e?NS(e)||PR(e)?da({},e):e:null}function id(e,t,i=!1,s=!1){const{props:d,ref:p,patchFlag:_,children:o,transition:w}=e,C=t?Yo(d||{},t):d,M={__v_isVNode:!0,__v_skip:!0,type:e.type,props:C,key:C&&jR(C),ref:t&&t.ref?i&&p?fn(p)?p.concat(K0(t)):[p,K0(t)]:K0(t):p,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==eo?_===-1?16:_|16:_,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:w,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&id(e.ssContent),ssFallback:e.ssFallback&&id(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return w&&s&&Vf(M,w.clone(M)),M}function Qo(e=" ",t=0){return Qe(Um,null,e,t)}function St(e="",t=!1){return t?(le(),Rt(Sa,null,e)):Qe(Sa,null,e)}function wu(e){return e==null||typeof e=="boolean"?Qe(Sa):fn(e)?Qe(eo,null,e.slice()):Ai(e)?ch(e):Qe(Um,null,String(e))}function ch(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:id(e)}function ZS(e,t){let i=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(fn(t))i=16;else if(typeof t=="object")if(s&65){const d=t.default;d&&(d._c&&(d._d=!1),ZS(e,d()),d._c&&(d._d=!0));return}else{i=32;const d=t._;!d&&!PR(t)?t._ctx=Ra:d===3&&Ra&&(Ra.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Qn(t)?(t={default:t,_ctx:Ra},i=32):(t=String(t),s&64?(i=16,t=[Qo(t)]):i=8);e.children=t,e.shapeFlag|=i}function Yo(...e){const t={};for(let i=0;i<e.length;i++){const s=e[i];for(const d in s)if(d==="class")t.class!==s.class&&(t.class=he([t.class,s.class]));else if(d==="style")t.style=to([t.style,s.style]);else if(qb(d)){const p=t[d],_=s[d];_&&p!==_&&!(fn(p)&&p.includes(_))&&(t[d]=p?[].concat(p,_):_)}else d!==""&&(t[d]=s[d])}return t}function yu(e,t,i,s=null){Yc(e,t,7,[i,s])}const k6=IR();let P6=0;function R6(e,t,i){const s=e.type,d=(t?t.appContext:e.appContext)||k6,p={uid:P6++,vnode:e,type:s,parent:t,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new N3(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(d.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:LR(s,d),emitsOptions:$R(s,d),emit:null,emitted:null,propsDefaults:Fi,inheritAttrs:s.inheritAttrs,ctx:Fi,data:Fi,props:Fi,attrs:Fi,slots:Fi,refs:Fi,setupState:Fi,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return p.ctx={_:p},p.root=t?t.root:p,p.emit=w6.bind(null,p),e.ce&&e.ce(p),p}let ja=null;const jo=()=>ja||Ra;let yb,p2;{const e=Yb(),t=(i,s)=>{let d;return(d=e[i])||(d=e[i]=[]),d.push(s),p=>{d.length>1?d.forEach(_=>_(p)):d[0](p)}};yb=t("__VUE_INSTANCE_SETTERS__",i=>ja=i),p2=t("__VUE_SSR_SETTERS__",i=>u_=i)}const D_=e=>{const t=ja;return yb(e),e.scope.on(),()=>{e.scope.off(),yb(t)}},mA=()=>{ja&&ja.scope.off(),yb(null)};function HR(e){return e.vnode.shapeFlag&4}let u_=!1;function L6(e,t=!1,i=!1){t&&p2(t);const{props:s,children:d}=e.vnode,p=HR(e);l6(e,s,p,t),h6(e,d,i);const _=p?O6(e,t):void 0;return t&&p2(!1),_}function O6(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,e6);const{setup:s}=i;if(s){Ih();const d=e.setupContext=s.length>1?WR(e):null,p=D_(e),_=O_(s,e,0,[e.props,d]),o=o_(_);if(Ah(),p(),(o||e.sp)&&!fm(e)&&bR(e),o){if(_.then(mA,mA),t)return _.then(w=>{gA(e,w,t)}).catch(w=>{Qb(w,e,0)});e.asyncDep=_}else gA(e,_,t)}else GR(e,t)}function gA(e,t,i){Qn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Vo(t)&&(e.setupState=rR(t)),GR(e,i)}let vA;function GR(e,t,i){const s=e.type;if(!e.render){if(!t&&vA&&!s.render){const d=s.template||GS(e).template;if(d){const{isCustomElement:p,compilerOptions:_}=e.appContext.config,{delimiters:o,compilerOptions:w}=s,C=da(da({isCustomElement:p,delimiters:o},_),w);s.render=vA(d,C)}}e.render=s.render||jr}{const d=D_(e);Ih();try{t6(e)}finally{Ah(),d()}}}const D6={get(e,t){return cs(e,"get",""),e[t]}};function WR(e){const t=i=>{e.exposed=i||{}};return{attrs:new Proxy(e.attrs,D6),slots:e.slots,emit:e.emit,expose:t}}function i1(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(rR(ph(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in Kv)return Kv[i](e)},has(t,i){return i in t||i in Kv}})):e.proxy}function z6(e,t=!0){return Qn(e)?e.displayName||e.name:e.name||t&&e.__name}function F6(e){return Qn(e)&&"__vccOpts"in e}const te=(e,t)=>F5(e,t,u_);function lo(e,t,i){const s=arguments.length;return s===2?Vo(t)&&!fn(t)?Ai(t)?Qe(e,null,[t]):Qe(e,t):Qe(e,null,t):(s>3?i=Array.prototype.slice.call(arguments,2):s===3&&Ai(i)&&(i=[i]),Qe(e,t,i))}const B6="3.5.13",N6=jr;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let m2;const _A=typeof window<"u"&&window.trustedTypes;if(_A)try{m2=_A.createPolicy("vue",{createHTML:e=>e})}catch{}const qR=m2?e=>m2.createHTML(e):e=>e,$6="http://www.w3.org/2000/svg",V6="http://www.w3.org/1998/Math/MathML",Xu=typeof document<"u"?document:null,yA=Xu&&Xu.createElement("template"),U6={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,s)=>{const d=t==="svg"?Xu.createElementNS($6,e):t==="mathml"?Xu.createElementNS(V6,e):i?Xu.createElement(e,{is:i}):Xu.createElement(e);return e==="select"&&s&&s.multiple!=null&&d.setAttribute("multiple",s.multiple),d},createText:e=>Xu.createTextNode(e),createComment:e=>Xu.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Xu.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,s,d,p){const _=i?i.previousSibling:t.lastChild;if(d&&(d===p||d.nextSibling))for(;t.insertBefore(d.cloneNode(!0),i),!(d===p||!(d=d.nextSibling)););else{yA.innerHTML=qR(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const o=yA.content;if(s==="svg"||s==="mathml"){const w=o.firstChild;for(;w.firstChild;)o.appendChild(w.firstChild);o.removeChild(w)}t.insertBefore(o,i)}return[_?_.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}},th="transition",Rv="animation",wm=Symbol("_vtc"),KR={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ZR=da({},gR,KR),j6=e=>(e.displayName="Transition",e.props=ZR,e),Ea=j6((e,{slots:t})=>lo(W5,YR(e),t)),xf=(e,t=[])=>{fn(e)?e.forEach(i=>i(...t)):e&&e(...t)},bA=e=>e?fn(e)?e.some(t=>t.length>1):e.length>1:!1;function YR(e){const t={};for(const ge in e)ge in KR||(t[ge]=e[ge]);if(e.css===!1)return t;const{name:i="v",type:s,duration:d,enterFromClass:p=`${i}-enter-from`,enterActiveClass:_=`${i}-enter-active`,enterToClass:o=`${i}-enter-to`,appearFromClass:w=p,appearActiveClass:C=_,appearToClass:M=o,leaveFromClass:I=`${i}-leave-from`,leaveActiveClass:F=`${i}-leave-active`,leaveToClass:B=`${i}-leave-to`}=e,N=H6(d),D=N&&N[0],j=N&&N[1],{onBeforeEnter:U,onEnter:ne,onEnterCancelled:K,onLeave:G,onLeaveCancelled:J,onBeforeAppear:oe=U,onAppear:se=ne,onAppearCancelled:me=K}=t,de=(ge,Re,Je,Me)=>{ge._enterCancelled=Me,oh(ge,Re?M:o),oh(ge,Re?C:_),Je&&Je()},ce=(ge,Re)=>{ge._isLeaving=!1,oh(ge,I),oh(ge,B),oh(ge,F),Re&&Re()},pe=ge=>(Re,Je)=>{const Me=ge?se:ne,xe=()=>de(Re,ge,Je);xf(Me,[Re,xe]),xA(()=>{oh(Re,ge?w:p),bu(Re,ge?M:o),bA(Me)||wA(Re,s,D,xe)})};return da(t,{onBeforeEnter(ge){xf(U,[ge]),bu(ge,p),bu(ge,_)},onBeforeAppear(ge){xf(oe,[ge]),bu(ge,w),bu(ge,C)},onEnter:pe(!1),onAppear:pe(!0),onLeave(ge,Re){ge._isLeaving=!0;const Je=()=>ce(ge,Re);bu(ge,I),ge._enterCancelled?(bu(ge,F),g2()):(g2(),bu(ge,F)),xA(()=>{ge._isLeaving&&(oh(ge,I),bu(ge,B),bA(G)||wA(ge,s,j,Je))}),xf(G,[ge,Je])},onEnterCancelled(ge){de(ge,!1,void 0,!0),xf(K,[ge])},onAppearCancelled(ge){de(ge,!0,void 0,!0),xf(me,[ge])},onLeaveCancelled(ge){ce(ge),xf(J,[ge])}})}function H6(e){if(e==null)return null;if(Vo(e))return[ww(e.enter),ww(e.leave)];{const t=ww(e);return[t,t]}}function ww(e){return n5(e)}function bu(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e[wm]||(e[wm]=new Set)).add(t)}function oh(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.remove(s));const i=e[wm];i&&(i.delete(t),i.size||(e[wm]=void 0))}function xA(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let G6=0;function wA(e,t,i,s){const d=e._endId=++G6,p=()=>{d===e._endId&&s()};if(i!=null)return setTimeout(p,i);const{type:_,timeout:o,propCount:w}=XR(e,t);if(!_)return s();const C=_+"end";let M=0;const I=()=>{e.removeEventListener(C,F),p()},F=B=>{B.target===e&&++M>=w&&I()};setTimeout(()=>{M<w&&I()},o+1),e.addEventListener(C,F)}function XR(e,t){const i=window.getComputedStyle(e),s=N=>(i[N]||"").split(", "),d=s(`${th}Delay`),p=s(`${th}Duration`),_=SA(d,p),o=s(`${Rv}Delay`),w=s(`${Rv}Duration`),C=SA(o,w);let M=null,I=0,F=0;t===th?_>0&&(M=th,I=_,F=p.length):t===Rv?C>0&&(M=Rv,I=C,F=w.length):(I=Math.max(_,C),M=I>0?_>C?th:Rv:null,F=M?M===th?p.length:w.length:0);const B=M===th&&/\b(transform|all)(,|$)/.test(s(`${th}Property`).toString());return{type:M,timeout:I,propCount:F,hasTransform:B}}function SA(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,s)=>TA(i)+TA(e[s])))}function TA(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function g2(){return document.body.offsetHeight}function W6(e,t,i){const s=e[wm];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}const bb=Symbol("_vod"),JR=Symbol("_vsh"),Cr={beforeMount(e,{value:t},{transition:i}){e[bb]=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):Lv(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:s}){!t!=!i&&(s?t?(s.beforeEnter(e),Lv(e,!0),s.enter(e)):s.leave(e,()=>{Lv(e,!1)}):Lv(e,t))},beforeUnmount(e,{value:t}){Lv(e,t)}};function Lv(e,t){e.style.display=t?e[bb]:"none",e[JR]=!t}const q6=Symbol(""),K6=/(^|;)\s*display\s*:/;function Z6(e,t,i){const s=e.style,d=Zn(i);let p=!1;if(i&&!d){if(t)if(Zn(t))for(const _ of t.split(";")){const o=_.slice(0,_.indexOf(":")).trim();i[o]==null&&Z0(s,o,"")}else for(const _ in t)i[_]==null&&Z0(s,_,"");for(const _ in i)_==="display"&&(p=!0),Z0(s,_,i[_])}else if(d){if(t!==i){const _=s[q6];_&&(i+=";"+_),s.cssText=i,p=K6.test(i)}}else t&&e.removeAttribute("style");bb in e&&(e[bb]=p?s.display:"",e[JR]&&(s.display="none"))}const CA=/\s*!important$/;function Z0(e,t,i){if(fn(i))i.forEach(s=>Z0(e,t,s));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const s=Y6(e,t);CA.test(i)?e.setProperty(cd(s),i.replace(CA,""),"important"):e[s]=i}}const EA=["Webkit","Moz","ms"],Sw={};function Y6(e,t){const i=Sw[t];if(i)return i;let s=Fs(t);if(s!=="filter"&&s in e)return Sw[t]=s;s=L_(s);for(let d=0;d<EA.length;d++){const p=EA[d]+s;if(p in e)return Sw[t]=p}return t}const MA="http://www.w3.org/1999/xlink";function IA(e,t,i,s,d,p=l5(t)){s&&t.startsWith("xlink:")?i==null?e.removeAttributeNS(MA,t.slice(6,t.length)):e.setAttributeNS(MA,t,i):i==null||p&&!D3(i)?e.removeAttribute(t):e.setAttribute(t,p?"":Zc(i)?String(i):i)}function AA(e,t,i,s,d){if(t==="innerHTML"||t==="textContent"){i!=null&&(e[t]=t==="innerHTML"?qR(i):i);return}const p=e.tagName;if(t==="value"&&p!=="PROGRESS"&&!p.includes("-")){const o=p==="OPTION"?e.getAttribute("value")||"":e.value,w=i==null?e.type==="checkbox"?"on":"":String(i);(o!==w||!("_value"in e))&&(e.value=w),i==null&&e.removeAttribute(t),e._value=i;return}let _=!1;if(i===""||i==null){const o=typeof e[t];o==="boolean"?i=D3(i):i==null&&o==="string"?(i="",_=!0):o==="number"&&(i=0,_=!0)}try{e[t]=i}catch{}_&&e.removeAttribute(d||t)}function uh(e,t,i,s){e.addEventListener(t,i,s)}function X6(e,t,i,s){e.removeEventListener(t,i,s)}const kA=Symbol("_vei");function J6(e,t,i,s,d=null){const p=e[kA]||(e[kA]={}),_=p[t];if(s&&_)_.value=s;else{const[o,w]=Q6(t);if(s){const C=p[t]=n$(s,d);uh(e,o,C,w)}else _&&(X6(e,o,_,w),p[t]=void 0)}}const PA=/(?:Once|Passive|Capture)$/;function Q6(e){let t;if(PA.test(e)){t={};let s;for(;s=e.match(PA);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):cd(e.slice(2)),t]}let Tw=0;const e$=Promise.resolve(),t$=()=>Tw||(e$.then(()=>Tw=0),Tw=Date.now());function n$(e,t){const i=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=i.attached)return;Yc(o$(s,i.value),t,5,[s])};return i.value=e,i.attached=t$(),i}function o$(e,t){if(fn(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(s=>d=>!d._stopped&&s&&s(d))}else return t}const RA=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,r$=(e,t,i,s,d,p)=>{const _=d==="svg";t==="class"?W6(e,s,_):t==="style"?Z6(e,i,s):qb(t)?PS(t)||J6(e,t,i,s,p):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):i$(e,t,s,_))?(AA(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&IA(e,t,s,_,p,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Zn(s))?AA(e,Fs(t),s,p,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),IA(e,t,s,_))};function i$(e,t,i,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&RA(t)&&Qn(i));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const d=e.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return RA(t)&&Zn(i)?!1:t in e}const QR=new WeakMap,eL=new WeakMap,xb=Symbol("_moveCb"),LA=Symbol("_enterCb"),a$=e=>(delete e.props.mode,e),s$=a$({name:"TransitionGroup",props:da({},ZR,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=jo(),s=mR();let d,p;return Ru(()=>{if(!d.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!d$(d[0].el,i.vnode.el,_))return;d.forEach(l$),d.forEach(c$);const o=d.filter(u$);g2(),o.forEach(w=>{const C=w.el,M=C.style;bu(C,_),M.transform=M.webkitTransform=M.transitionDuration="";const I=C[xb]=F=>{F&&F.target!==C||(!F||/transform$/.test(F.propertyName))&&(C.removeEventListener("transitionend",I),C[xb]=null,oh(C,_))};C.addEventListener("transitionend",I)})}),()=>{const _=ei(e),o=YR(_);let w=_.tag||eo;if(d=[],p)for(let C=0;C<p.length;C++){const M=p[C];M.el&&M.el instanceof Element&&(d.push(M),Vf(M,l_(M,o,s,i)),QR.set(M,M.el.getBoundingClientRect()))}p=t.default?VS(t.default()):[];for(let C=0;C<p.length;C++){const M=p[C];M.key!=null&&Vf(M,l_(M,o,s,i))}return Qe(w,null,p)}}}),tL=s$;function l$(e){const t=e.el;t[xb]&&t[xb](),t[LA]&&t[LA]()}function c$(e){eL.set(e,e.el.getBoundingClientRect())}function u$(e){const t=QR.get(e),i=eL.get(e),s=t.left-i.left,d=t.top-i.top;if(s||d){const p=e.el.style;return p.transform=p.webkitTransform=`translate(${s}px,${d}px)`,p.transitionDuration="0s",e}}function d$(e,t,i){const s=e.cloneNode(),d=e[wm];d&&d.forEach(o=>{o.split(/\s+/).forEach(w=>w&&s.classList.remove(w))}),i.split(/\s+/).forEach(o=>o&&s.classList.add(o)),s.style.display="none";const p=t.nodeType===1?t:t.parentNode;p.appendChild(s);const{hasTransform:_}=XR(s);return p.removeChild(s),_}const Sm=e=>{const t=e.props["onUpdate:modelValue"]||!1;return fn(t)?i=>W0(t,i):t};function h$(e){e.target.composing=!0}function OA(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const od=Symbol("_assign"),a1={created(e,{modifiers:{lazy:t,trim:i,number:s}},d){e[od]=Sm(d);const p=s||d.props&&d.props.type==="number";uh(e,t?"change":"input",_=>{if(_.target.composing)return;let o=e.value;i&&(o=o.trim()),p&&(o=r2(o)),e[od](o)}),i&&uh(e,"change",()=>{e.value=e.value.trim()}),t||(uh(e,"compositionstart",h$),uh(e,"compositionend",OA),uh(e,"change",OA))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:i,modifiers:{lazy:s,trim:d,number:p}},_){if(e[od]=Sm(_),e.composing)return;const o=(p||e.type==="number")&&!/^0\d/.test(e.value)?r2(e.value):e.value,w=t??"";o!==w&&(document.activeElement===e&&e.type!=="range"&&(s&&t===i||d&&e.value.trim()===w)||(e.value=w))}},wb={deep:!0,created(e,t,i){e[od]=Sm(i),uh(e,"change",()=>{const s=e._modelValue,d=oL(e),p=e.checked,_=e[od];if(fn(s)){const o=z3(s,d),w=o!==-1;if(p&&!w)_(s.concat(d));else if(!p&&w){const C=[...s];C.splice(o,1),_(C)}}else if(Kb(s)){const o=new Set(s);p?o.add(d):o.delete(d),_(o)}else _(rL(e,p))})},mounted:DA,beforeUpdate(e,t,i){e[od]=Sm(i),DA(e,t,i)}};function DA(e,{value:t,oldValue:i},s){e._modelValue=t;let d;if(fn(t))d=z3(t,s.props.value)>-1;else if(Kb(t))d=t.has(s.props.value);else{if(t===i)return;d=xm(t,rL(e,!0))}e.checked!==d&&(e.checked=d)}const nL={created(e,{value:t},i){e.checked=xm(t,i.props.value),e[od]=Sm(i),uh(e,"change",()=>{e[od](oL(e))})},beforeUpdate(e,{value:t,oldValue:i},s){e[od]=Sm(s),t!==i&&(e.checked=xm(t,s.props.value))}};function oL(e){return"_value"in e?e._value:e.value}function rL(e,t){const i=t?"_trueValue":"_falseValue";return i in e?e[i]:t}const f$=["ctrl","shift","alt","meta"],p$={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>f$.some(i=>e[`${i}Key`]&&!t.includes(i))},po=(e,t)=>{const i=e._withMods||(e._withMods={}),s=t.join(".");return i[s]||(i[s]=(d,...p)=>{for(let _=0;_<t.length;_++){const o=p$[t[_]];if(o&&o(d,t))return}return e(d,...p)})},m$={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ti=(e,t)=>{const i=e._withKeys||(e._withKeys={}),s=t.join(".");return i[s]||(i[s]=d=>{if(!("key"in d))return;const p=cd(d.key);if(t.some(_=>_===p||m$[_]===p))return e(d)})},g$=da({patchProp:r$},U6);let zA;function iL(){return zA||(zA=p6(g$))}const bh=(...e)=>{iL().render(...e)},aL=(...e)=>{const t=iL().createApp(...e),{mount:i}=t;return t.mount=s=>{const d=_$(s);if(!d)return;const p=t._component;!Qn(p)&&!p.render&&!p.template&&(p.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const _=i(d,!1,v$(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},t};function v$(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function _$(e){return Zn(e)?document.querySelector(e):e}var Ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sL={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){var i,s,d;function p(o,w){if(!i)i=w;else if(!s)s=w;else{var C="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",M={};i(M),d=w(M),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}p(["exports"],function(o){function w(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var C,M={},I={};function F(){if(C)return I;C=1,Object.defineProperty(I,"__esModule",{value:!0}),I.setMatrixArrayType=function(g){I.ARRAY_TYPE=n=g},I.toRadian=function(g){return g*u},I.equals=function(g,h){return Math.abs(g-h)<=c*Math.max(1,Math.abs(g),Math.abs(h))},I.RANDOM=I.ARRAY_TYPE=I.EPSILON=void 0;var c=1e-6;I.EPSILON=c;var n=typeof Float32Array<"u"?Float32Array:Array;I.ARRAY_TYPE=n;var a=Math.random;I.RANDOM=a;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var g=0,h=arguments.length;h--;)g+=arguments[h]*arguments[h];return Math.sqrt(g)}),I}var B,N={};function D(){if(B)return N;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}B=1,Object.defineProperty(N,"__esModule",{value:!0}),N.create=function(){var h=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},N.clone=function(h){var v=new n.ARRAY_TYPE(4);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v},N.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h},N.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},N.fromValues=function(h,v,T,P){var O=new n.ARRAY_TYPE(4);return O[0]=h,O[1]=v,O[2]=T,O[3]=P,O},N.set=function(h,v,T,P,O){return h[0]=v,h[1]=T,h[2]=P,h[3]=O,h},N.transpose=function(h,v){if(h===v){var T=v[1];h[1]=v[2],h[2]=T}else h[0]=v[0],h[1]=v[2],h[2]=v[1],h[3]=v[3];return h},N.invert=function(h,v){var T=v[0],P=v[1],O=v[2],x=v[3],k=T*x-O*P;return k?(h[0]=x*(k=1/k),h[1]=-P*k,h[2]=-O*k,h[3]=T*k,h):null},N.adjoint=function(h,v){var T=v[0];return h[0]=v[3],h[1]=-v[1],h[2]=-v[2],h[3]=T,h},N.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},N.multiply=u,N.rotate=function(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=Math.sin(T),A=Math.cos(T);return h[0]=P*A+x*L,h[1]=O*A+k*L,h[2]=P*-L+x*A,h[3]=O*-L+k*A,h},N.scale=function(h,v,T){var P=v[1],O=v[2],x=v[3],k=T[0],L=T[1];return h[0]=v[0]*k,h[1]=P*k,h[2]=O*L,h[3]=x*L,h},N.fromRotation=function(h,v){var T=Math.sin(v),P=Math.cos(v);return h[0]=P,h[1]=T,h[2]=-T,h[3]=P,h},N.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h},N.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},N.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},N.LDU=function(h,v,T,P){return h[2]=P[2]/P[0],T[0]=P[0],T[1]=P[1],T[3]=P[3]-h[2]*T[1],[h,v,T]},N.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h},N.subtract=g,N.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]},N.equals=function(h,v){var T=h[0],P=h[1],O=h[2],x=h[3],k=v[0],L=v[1],A=v[2],R=v[3];return Math.abs(T-k)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(k))&&Math.abs(P-L)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(L))&&Math.abs(O-A)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(A))&&Math.abs(x-R)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(R))},N.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h},N.multiplyScalarAndAdd=function(h,v,T,P){return h[0]=v[0]+T[0]*P,h[1]=v[1]+T[1]*P,h[2]=v[2]+T[2]*P,h[3]=v[3]+T[3]*P,h},N.sub=N.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=a(void 0);if(T&&T.has(h))return T.get(h);var P={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var k=O?Object.getOwnPropertyDescriptor(h,x):null;k&&(k.get||k.set)?Object.defineProperty(P,x,k):P[x]=h[x]}return P.default=h,T&&T.set(h,P),P}(F());function a(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(a=function(P){return P?T:v})(h)}function u(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=T[0],A=T[1],R=T[2],$=T[3];return h[0]=P*L+x*A,h[1]=O*L+k*A,h[2]=P*R+x*$,h[3]=O*R+k*$,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h}return N.mul=u,N.sub=g,N}var j,U={};function ne(){if(j)return U;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}j=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var h=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},U.clone=function(h){var v=new n.ARRAY_TYPE(6);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v},U.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h},U.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},U.fromValues=function(h,v,T,P,O,x){var k=new n.ARRAY_TYPE(6);return k[0]=h,k[1]=v,k[2]=T,k[3]=P,k[4]=O,k[5]=x,k},U.set=function(h,v,T,P,O,x,k){return h[0]=v,h[1]=T,h[2]=P,h[3]=O,h[4]=x,h[5]=k,h},U.invert=function(h,v){var T=v[0],P=v[1],O=v[2],x=v[3],k=v[4],L=v[5],A=T*x-P*O;return A?(h[0]=x*(A=1/A),h[1]=-P*A,h[2]=-O*A,h[3]=T*A,h[4]=(O*L-x*k)*A,h[5]=(P*k-T*L)*A,h):null},U.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},U.multiply=u,U.rotate=function(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=v[4],A=v[5],R=Math.sin(T),$=Math.cos(T);return h[0]=P*$+x*R,h[1]=O*$+k*R,h[2]=P*-R+x*$,h[3]=O*-R+k*$,h[4]=L,h[5]=A,h},U.scale=function(h,v,T){var P=v[1],O=v[2],x=v[3],k=v[4],L=v[5],A=T[0],R=T[1];return h[0]=v[0]*A,h[1]=P*A,h[2]=O*R,h[3]=x*R,h[4]=k,h[5]=L,h},U.translate=function(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=v[4],A=v[5],R=T[0],$=T[1];return h[0]=P,h[1]=O,h[2]=x,h[3]=k,h[4]=P*R+x*$+L,h[5]=O*R+k*$+A,h},U.fromRotation=function(h,v){var T=Math.sin(v),P=Math.cos(v);return h[0]=P,h[1]=T,h[2]=-T,h[3]=P,h[4]=0,h[5]=0,h},U.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h[4]=0,h[5]=0,h},U.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=v[0],h[5]=v[1],h},U.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},U.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},U.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h},U.subtract=g,U.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h},U.multiplyScalarAndAdd=function(h,v,T,P){return h[0]=v[0]+T[0]*P,h[1]=v[1]+T[1]*P,h[2]=v[2]+T[2]*P,h[3]=v[3]+T[3]*P,h[4]=v[4]+T[4]*P,h[5]=v[5]+T[5]*P,h},U.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]},U.equals=function(h,v){var T=h[0],P=h[1],O=h[2],x=h[3],k=h[4],L=h[5],A=v[0],R=v[1],$=v[2],W=v[3],Y=v[4],re=v[5];return Math.abs(T-A)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(A))&&Math.abs(P-R)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(R))&&Math.abs(O-$)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs($))&&Math.abs(x-W)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(W))&&Math.abs(k-Y)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Y))&&Math.abs(L-re)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(re))},U.sub=U.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=a(void 0);if(T&&T.has(h))return T.get(h);var P={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var k=O?Object.getOwnPropertyDescriptor(h,x):null;k&&(k.get||k.set)?Object.defineProperty(P,x,k):P[x]=h[x]}return P.default=h,T&&T.set(h,P),P}(F());function a(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(a=function(P){return P?T:v})(h)}function u(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=v[4],A=v[5],R=T[0],$=T[1],W=T[2],Y=T[3],re=T[4],ie=T[5];return h[0]=P*R+x*$,h[1]=O*R+k*$,h[2]=P*W+x*Y,h[3]=O*W+k*Y,h[4]=P*re+x*ie+L,h[5]=O*re+k*ie+A,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h}return U.mul=u,U.sub=g,U}var K,G={};function J(){if(K)return G;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}K=1,Object.defineProperty(G,"__esModule",{value:!0}),G.create=function(){var h=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},G.fromMat4=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[4],h[4]=v[5],h[5]=v[6],h[6]=v[8],h[7]=v[9],h[8]=v[10],h},G.clone=function(h){var v=new n.ARRAY_TYPE(9);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v[6]=h[6],v[7]=h[7],v[8]=h[8],v},G.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},G.fromValues=function(h,v,T,P,O,x,k,L,A){var R=new n.ARRAY_TYPE(9);return R[0]=h,R[1]=v,R[2]=T,R[3]=P,R[4]=O,R[5]=x,R[6]=k,R[7]=L,R[8]=A,R},G.set=function(h,v,T,P,O,x,k,L,A,R){return h[0]=v,h[1]=T,h[2]=P,h[3]=O,h[4]=x,h[5]=k,h[6]=L,h[7]=A,h[8]=R,h},G.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},G.transpose=function(h,v){if(h===v){var T=v[1],P=v[2],O=v[5];h[1]=v[3],h[2]=v[6],h[3]=T,h[5]=v[7],h[6]=P,h[7]=O}else h[0]=v[0],h[1]=v[3],h[2]=v[6],h[3]=v[1],h[4]=v[4],h[5]=v[7],h[6]=v[2],h[7]=v[5],h[8]=v[8];return h},G.invert=function(h,v){var T=v[0],P=v[1],O=v[2],x=v[3],k=v[4],L=v[5],A=v[6],R=v[7],$=v[8],W=$*k-L*R,Y=-$*x+L*A,re=R*x-k*A,ie=T*W+P*Y+O*re;return ie?(h[0]=W*(ie=1/ie),h[1]=(-$*P+O*R)*ie,h[2]=(L*P-O*k)*ie,h[3]=Y*ie,h[4]=($*T-O*A)*ie,h[5]=(-L*T+O*x)*ie,h[6]=re*ie,h[7]=(-R*T+P*A)*ie,h[8]=(k*T-P*x)*ie,h):null},G.adjoint=function(h,v){var T=v[0],P=v[1],O=v[2],x=v[3],k=v[4],L=v[5],A=v[6],R=v[7],$=v[8];return h[0]=k*$-L*R,h[1]=O*R-P*$,h[2]=P*L-O*k,h[3]=L*A-x*$,h[4]=T*$-O*A,h[5]=O*x-T*L,h[6]=x*R-k*A,h[7]=P*A-T*R,h[8]=T*k-P*x,h},G.determinant=function(h){var v=h[3],T=h[4],P=h[5],O=h[6],x=h[7],k=h[8];return h[0]*(k*T-P*x)+h[1]*(-k*v+P*O)+h[2]*(x*v-T*O)},G.multiply=u,G.translate=function(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=v[4],A=v[5],R=v[6],$=v[7],W=v[8],Y=T[0],re=T[1];return h[0]=P,h[1]=O,h[2]=x,h[3]=k,h[4]=L,h[5]=A,h[6]=Y*P+re*k+R,h[7]=Y*O+re*L+$,h[8]=Y*x+re*A+W,h},G.rotate=function(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=v[4],A=v[5],R=v[6],$=v[7],W=v[8],Y=Math.sin(T),re=Math.cos(T);return h[0]=re*P+Y*k,h[1]=re*O+Y*L,h[2]=re*x+Y*A,h[3]=re*k-Y*P,h[4]=re*L-Y*O,h[5]=re*A-Y*x,h[6]=R,h[7]=$,h[8]=W,h},G.scale=function(h,v,T){var P=T[0],O=T[1];return h[0]=P*v[0],h[1]=P*v[1],h[2]=P*v[2],h[3]=O*v[3],h[4]=O*v[4],h[5]=O*v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},G.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=v[0],h[7]=v[1],h[8]=1,h},G.fromRotation=function(h,v){var T=Math.sin(v),P=Math.cos(v);return h[0]=P,h[1]=T,h[2]=0,h[3]=-T,h[4]=P,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},G.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=0,h[4]=v[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},G.fromMat2d=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=0,h[3]=v[2],h[4]=v[3],h[5]=0,h[6]=v[4],h[7]=v[5],h[8]=1,h},G.fromQuat=function(h,v){var T=v[0],P=v[1],O=v[2],x=v[3],k=T+T,L=P+P,A=O+O,R=T*k,$=P*k,W=P*L,Y=O*k,re=O*L,ie=O*A,Q=x*k,ue=x*L,_e=x*A;return h[0]=1-W-ie,h[3]=$-_e,h[6]=Y+ue,h[1]=$+_e,h[4]=1-R-ie,h[7]=re-Q,h[2]=Y-ue,h[5]=re+Q,h[8]=1-R-W,h},G.normalFromMat4=function(h,v){var T=v[0],P=v[1],O=v[2],x=v[3],k=v[4],L=v[5],A=v[6],R=v[7],$=v[8],W=v[9],Y=v[10],re=v[11],ie=v[12],Q=v[13],ue=v[14],_e=v[15],Ie=T*L-P*k,Ge=T*A-O*k,ze=T*R-x*k,$e=P*A-O*L,st=P*R-x*L,Fe=O*R-x*A,rt=$*Q-W*ie,ht=$*ue-Y*ie,pt=$*_e-re*ie,Tt=W*ue-Y*Q,Lt=W*_e-re*Q,Ft=Y*_e-re*ue,Pt=Ie*Ft-Ge*Lt+ze*Tt+$e*pt-st*ht+Fe*rt;return Pt?(h[0]=(L*Ft-A*Lt+R*Tt)*(Pt=1/Pt),h[1]=(A*pt-k*Ft-R*ht)*Pt,h[2]=(k*Lt-L*pt+R*rt)*Pt,h[3]=(O*Lt-P*Ft-x*Tt)*Pt,h[4]=(T*Ft-O*pt+x*ht)*Pt,h[5]=(P*pt-T*Lt-x*rt)*Pt,h[6]=(Q*Fe-ue*st+_e*$e)*Pt,h[7]=(ue*ze-ie*Fe-_e*Ge)*Pt,h[8]=(ie*st-Q*ze+_e*Ie)*Pt,h):null},G.projection=function(h,v,T){return h[0]=2/v,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/T,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},G.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},G.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},G.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h[6]=v[6]+T[6],h[7]=v[7]+T[7],h[8]=v[8]+T[8],h},G.subtract=g,G.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h[6]=v[6]*T,h[7]=v[7]*T,h[8]=v[8]*T,h},G.multiplyScalarAndAdd=function(h,v,T,P){return h[0]=v[0]+T[0]*P,h[1]=v[1]+T[1]*P,h[2]=v[2]+T[2]*P,h[3]=v[3]+T[3]*P,h[4]=v[4]+T[4]*P,h[5]=v[5]+T[5]*P,h[6]=v[6]+T[6]*P,h[7]=v[7]+T[7]*P,h[8]=v[8]+T[8]*P,h},G.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]&&h[6]===v[6]&&h[7]===v[7]&&h[8]===v[8]},G.equals=function(h,v){var T=h[0],P=h[1],O=h[2],x=h[3],k=h[4],L=h[5],A=h[6],R=h[7],$=h[8],W=v[0],Y=v[1],re=v[2],ie=v[3],Q=v[4],ue=v[5],_e=v[6],Ie=v[7],Ge=v[8];return Math.abs(T-W)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(W))&&Math.abs(P-Y)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(Y))&&Math.abs(O-re)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(re))&&Math.abs(x-ie)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(ie))&&Math.abs(k-Q)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Q))&&Math.abs(L-ue)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(ue))&&Math.abs(A-_e)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(_e))&&Math.abs(R-Ie)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ie))&&Math.abs($-Ge)<=n.EPSILON*Math.max(1,Math.abs($),Math.abs(Ge))},G.sub=G.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=a(void 0);if(T&&T.has(h))return T.get(h);var P={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var k=O?Object.getOwnPropertyDescriptor(h,x):null;k&&(k.get||k.set)?Object.defineProperty(P,x,k):P[x]=h[x]}return P.default=h,T&&T.set(h,P),P}(F());function a(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(a=function(P){return P?T:v})(h)}function u(h,v,T){var P=v[0],O=v[1],x=v[2],k=v[3],L=v[4],A=v[5],R=v[6],$=v[7],W=v[8],Y=T[0],re=T[1],ie=T[2],Q=T[3],ue=T[4],_e=T[5],Ie=T[6],Ge=T[7],ze=T[8];return h[0]=Y*P+re*k+ie*R,h[1]=Y*O+re*L+ie*$,h[2]=Y*x+re*A+ie*W,h[3]=Q*P+ue*k+_e*R,h[4]=Q*O+ue*L+_e*$,h[5]=Q*x+ue*A+_e*W,h[6]=Ie*P+Ge*k+ze*R,h[7]=Ie*O+Ge*L+ze*$,h[8]=Ie*x+Ge*A+ze*W,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h[6]=v[6]-T[6],h[7]=v[7]-T[7],h[8]=v[8]-T[8],h}return G.mul=u,G.sub=g,G}var oe,se={};function me(){if(oe)return se;function c(x){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},c(x)}oe=1,Object.defineProperty(se,"__esModule",{value:!0}),se.create=function(){var x=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x},se.clone=function(x){var k=new n.ARRAY_TYPE(16);return k[0]=x[0],k[1]=x[1],k[2]=x[2],k[3]=x[3],k[4]=x[4],k[5]=x[5],k[6]=x[6],k[7]=x[7],k[8]=x[8],k[9]=x[9],k[10]=x[10],k[11]=x[11],k[12]=x[12],k[13]=x[13],k[14]=x[14],k[15]=x[15],k},se.copy=function(x,k){return x[0]=k[0],x[1]=k[1],x[2]=k[2],x[3]=k[3],x[4]=k[4],x[5]=k[5],x[6]=k[6],x[7]=k[7],x[8]=k[8],x[9]=k[9],x[10]=k[10],x[11]=k[11],x[12]=k[12],x[13]=k[13],x[14]=k[14],x[15]=k[15],x},se.fromValues=function(x,k,L,A,R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge,ze){var $e=new n.ARRAY_TYPE(16);return $e[0]=x,$e[1]=k,$e[2]=L,$e[3]=A,$e[4]=R,$e[5]=$,$e[6]=W,$e[7]=Y,$e[8]=re,$e[9]=ie,$e[10]=Q,$e[11]=ue,$e[12]=_e,$e[13]=Ie,$e[14]=Ge,$e[15]=ze,$e},se.set=function(x,k,L,A,R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge,ze,$e){return x[0]=k,x[1]=L,x[2]=A,x[3]=R,x[4]=$,x[5]=W,x[6]=Y,x[7]=re,x[8]=ie,x[9]=Q,x[10]=ue,x[11]=_e,x[12]=Ie,x[13]=Ge,x[14]=ze,x[15]=$e,x},se.identity=u,se.transpose=function(x,k){if(x===k){var L=k[1],A=k[2],R=k[3],$=k[6],W=k[7],Y=k[11];x[1]=k[4],x[2]=k[8],x[3]=k[12],x[4]=L,x[6]=k[9],x[7]=k[13],x[8]=A,x[9]=$,x[11]=k[14],x[12]=R,x[13]=W,x[14]=Y}else x[0]=k[0],x[1]=k[4],x[2]=k[8],x[3]=k[12],x[4]=k[1],x[5]=k[5],x[6]=k[9],x[7]=k[13],x[8]=k[2],x[9]=k[6],x[10]=k[10],x[11]=k[14],x[12]=k[3],x[13]=k[7],x[14]=k[11],x[15]=k[15];return x},se.invert=function(x,k){var L=k[0],A=k[1],R=k[2],$=k[3],W=k[4],Y=k[5],re=k[6],ie=k[7],Q=k[8],ue=k[9],_e=k[10],Ie=k[11],Ge=k[12],ze=k[13],$e=k[14],st=k[15],Fe=L*Y-A*W,rt=L*re-R*W,ht=L*ie-$*W,pt=A*re-R*Y,Tt=A*ie-$*Y,Lt=R*ie-$*re,Ft=Q*ze-ue*Ge,Pt=Q*$e-_e*Ge,sn=Q*st-Ie*Ge,Cn=ue*$e-_e*ze,Jt=ue*st-Ie*ze,Jn=_e*st-Ie*$e,Fn=Fe*Jn-rt*Jt+ht*Cn+pt*sn-Tt*Pt+Lt*Ft;return Fn?(x[0]=(Y*Jn-re*Jt+ie*Cn)*(Fn=1/Fn),x[1]=(R*Jt-A*Jn-$*Cn)*Fn,x[2]=(ze*Lt-$e*Tt+st*pt)*Fn,x[3]=(_e*Tt-ue*Lt-Ie*pt)*Fn,x[4]=(re*sn-W*Jn-ie*Pt)*Fn,x[5]=(L*Jn-R*sn+$*Pt)*Fn,x[6]=($e*ht-Ge*Lt-st*rt)*Fn,x[7]=(Q*Lt-_e*ht+Ie*rt)*Fn,x[8]=(W*Jt-Y*sn+ie*Ft)*Fn,x[9]=(A*sn-L*Jt-$*Ft)*Fn,x[10]=(Ge*Tt-ze*ht+st*Fe)*Fn,x[11]=(ue*ht-Q*Tt-Ie*Fe)*Fn,x[12]=(Y*Pt-W*Cn-re*Ft)*Fn,x[13]=(L*Cn-A*Pt+R*Ft)*Fn,x[14]=(ze*rt-Ge*pt-$e*Fe)*Fn,x[15]=(Q*pt-ue*rt+_e*Fe)*Fn,x):null},se.adjoint=function(x,k){var L=k[0],A=k[1],R=k[2],$=k[3],W=k[4],Y=k[5],re=k[6],ie=k[7],Q=k[8],ue=k[9],_e=k[10],Ie=k[11],Ge=k[12],ze=k[13],$e=k[14],st=k[15];return x[0]=Y*(_e*st-Ie*$e)-ue*(re*st-ie*$e)+ze*(re*Ie-ie*_e),x[1]=-(A*(_e*st-Ie*$e)-ue*(R*st-$*$e)+ze*(R*Ie-$*_e)),x[2]=A*(re*st-ie*$e)-Y*(R*st-$*$e)+ze*(R*ie-$*re),x[3]=-(A*(re*Ie-ie*_e)-Y*(R*Ie-$*_e)+ue*(R*ie-$*re)),x[4]=-(W*(_e*st-Ie*$e)-Q*(re*st-ie*$e)+Ge*(re*Ie-ie*_e)),x[5]=L*(_e*st-Ie*$e)-Q*(R*st-$*$e)+Ge*(R*Ie-$*_e),x[6]=-(L*(re*st-ie*$e)-W*(R*st-$*$e)+Ge*(R*ie-$*re)),x[7]=L*(re*Ie-ie*_e)-W*(R*Ie-$*_e)+Q*(R*ie-$*re),x[8]=W*(ue*st-Ie*ze)-Q*(Y*st-ie*ze)+Ge*(Y*Ie-ie*ue),x[9]=-(L*(ue*st-Ie*ze)-Q*(A*st-$*ze)+Ge*(A*Ie-$*ue)),x[10]=L*(Y*st-ie*ze)-W*(A*st-$*ze)+Ge*(A*ie-$*Y),x[11]=-(L*(Y*Ie-ie*ue)-W*(A*Ie-$*ue)+Q*(A*ie-$*Y)),x[12]=-(W*(ue*$e-_e*ze)-Q*(Y*$e-re*ze)+Ge*(Y*_e-re*ue)),x[13]=L*(ue*$e-_e*ze)-Q*(A*$e-R*ze)+Ge*(A*_e-R*ue),x[14]=-(L*(Y*$e-re*ze)-W*(A*$e-R*ze)+Ge*(A*re-R*Y)),x[15]=L*(Y*_e-re*ue)-W*(A*_e-R*ue)+Q*(A*re-R*Y),x},se.determinant=function(x){var k=x[0],L=x[1],A=x[2],R=x[3],$=x[4],W=x[5],Y=x[6],re=x[7],ie=x[8],Q=x[9],ue=x[10],_e=x[11],Ie=x[12],Ge=x[13],ze=x[14],$e=x[15];return(k*W-L*$)*(ue*$e-_e*ze)-(k*Y-A*$)*(Q*$e-_e*Ge)+(k*re-R*$)*(Q*ze-ue*Ge)+(L*Y-A*W)*(ie*$e-_e*Ie)-(L*re-R*W)*(ie*ze-ue*Ie)+(A*re-R*Y)*(ie*Ge-Q*Ie)},se.multiply=g,se.translate=function(x,k,L){var A,R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge,ze=L[0],$e=L[1],st=L[2];return k===x?(x[12]=k[0]*ze+k[4]*$e+k[8]*st+k[12],x[13]=k[1]*ze+k[5]*$e+k[9]*st+k[13],x[14]=k[2]*ze+k[6]*$e+k[10]*st+k[14],x[15]=k[3]*ze+k[7]*$e+k[11]*st+k[15]):(R=k[1],$=k[2],W=k[3],Y=k[4],re=k[5],ie=k[6],Q=k[7],ue=k[8],_e=k[9],Ie=k[10],Ge=k[11],x[0]=A=k[0],x[1]=R,x[2]=$,x[3]=W,x[4]=Y,x[5]=re,x[6]=ie,x[7]=Q,x[8]=ue,x[9]=_e,x[10]=Ie,x[11]=Ge,x[12]=A*ze+Y*$e+ue*st+k[12],x[13]=R*ze+re*$e+_e*st+k[13],x[14]=$*ze+ie*$e+Ie*st+k[14],x[15]=W*ze+Q*$e+Ge*st+k[15]),x},se.scale=function(x,k,L){var A=L[0],R=L[1],$=L[2];return x[0]=k[0]*A,x[1]=k[1]*A,x[2]=k[2]*A,x[3]=k[3]*A,x[4]=k[4]*R,x[5]=k[5]*R,x[6]=k[6]*R,x[7]=k[7]*R,x[8]=k[8]*$,x[9]=k[9]*$,x[10]=k[10]*$,x[11]=k[11]*$,x[12]=k[12],x[13]=k[13],x[14]=k[14],x[15]=k[15],x},se.rotate=function(x,k,L,A){var R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt,Lt,Ft,Pt,sn,Cn,Jt=A[0],Jn=A[1],Fn=A[2],Pn=Math.hypot(Jt,Jn,Fn);return Pn<n.EPSILON?null:(Jt*=Pn=1/Pn,Jn*=Pn,Fn*=Pn,R=Math.sin(L),$=Math.cos(L),re=k[1],ie=k[2],Q=k[3],_e=k[5],Ie=k[6],Ge=k[7],$e=k[9],st=k[10],Fe=k[11],rt=Jt*Jt*(W=1-$)+$,Tt=Jt*Jn*W-Fn*R,Lt=Jn*Jn*W+$,Ft=Fn*Jn*W+Jt*R,Pt=Jt*Fn*W+Jn*R,sn=Jn*Fn*W-Jt*R,Cn=Fn*Fn*W+$,x[0]=(Y=k[0])*rt+(ue=k[4])*(ht=Jn*Jt*W+Fn*R)+(ze=k[8])*(pt=Fn*Jt*W-Jn*R),x[1]=re*rt+_e*ht+$e*pt,x[2]=ie*rt+Ie*ht+st*pt,x[3]=Q*rt+Ge*ht+Fe*pt,x[4]=Y*Tt+ue*Lt+ze*Ft,x[5]=re*Tt+_e*Lt+$e*Ft,x[6]=ie*Tt+Ie*Lt+st*Ft,x[7]=Q*Tt+Ge*Lt+Fe*Ft,x[8]=Y*Pt+ue*sn+ze*Cn,x[9]=re*Pt+_e*sn+$e*Cn,x[10]=ie*Pt+Ie*sn+st*Cn,x[11]=Q*Pt+Ge*sn+Fe*Cn,k!==x&&(x[12]=k[12],x[13]=k[13],x[14]=k[14],x[15]=k[15]),x)},se.rotateX=function(x,k,L){var A=Math.sin(L),R=Math.cos(L),$=k[4],W=k[5],Y=k[6],re=k[7],ie=k[8],Q=k[9],ue=k[10],_e=k[11];return k!==x&&(x[0]=k[0],x[1]=k[1],x[2]=k[2],x[3]=k[3],x[12]=k[12],x[13]=k[13],x[14]=k[14],x[15]=k[15]),x[4]=$*R+ie*A,x[5]=W*R+Q*A,x[6]=Y*R+ue*A,x[7]=re*R+_e*A,x[8]=ie*R-$*A,x[9]=Q*R-W*A,x[10]=ue*R-Y*A,x[11]=_e*R-re*A,x},se.rotateY=function(x,k,L){var A=Math.sin(L),R=Math.cos(L),$=k[0],W=k[1],Y=k[2],re=k[3],ie=k[8],Q=k[9],ue=k[10],_e=k[11];return k!==x&&(x[4]=k[4],x[5]=k[5],x[6]=k[6],x[7]=k[7],x[12]=k[12],x[13]=k[13],x[14]=k[14],x[15]=k[15]),x[0]=$*R-ie*A,x[1]=W*R-Q*A,x[2]=Y*R-ue*A,x[3]=re*R-_e*A,x[8]=$*A+ie*R,x[9]=W*A+Q*R,x[10]=Y*A+ue*R,x[11]=re*A+_e*R,x},se.rotateZ=function(x,k,L){var A=Math.sin(L),R=Math.cos(L),$=k[0],W=k[1],Y=k[2],re=k[3],ie=k[4],Q=k[5],ue=k[6],_e=k[7];return k!==x&&(x[8]=k[8],x[9]=k[9],x[10]=k[10],x[11]=k[11],x[12]=k[12],x[13]=k[13],x[14]=k[14],x[15]=k[15]),x[0]=$*R+ie*A,x[1]=W*R+Q*A,x[2]=Y*R+ue*A,x[3]=re*R+_e*A,x[4]=ie*R-$*A,x[5]=Q*R-W*A,x[6]=ue*R-Y*A,x[7]=_e*R-re*A,x},se.fromTranslation=function(x,k){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=k[0],x[13]=k[1],x[14]=k[2],x[15]=1,x},se.fromScaling=function(x,k){return x[0]=k[0],x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=k[1],x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=k[2],x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromRotation=function(x,k,L){var A,R,$,W=L[0],Y=L[1],re=L[2],ie=Math.hypot(W,Y,re);return ie<n.EPSILON?null:(W*=ie=1/ie,Y*=ie,re*=ie,A=Math.sin(k),R=Math.cos(k),x[0]=W*W*($=1-R)+R,x[1]=Y*W*$+re*A,x[2]=re*W*$-Y*A,x[3]=0,x[4]=W*Y*$-re*A,x[5]=Y*Y*$+R,x[6]=re*Y*$+W*A,x[7]=0,x[8]=W*re*$+Y*A,x[9]=Y*re*$-W*A,x[10]=re*re*$+R,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x)},se.fromXRotation=function(x,k){var L=Math.sin(k),A=Math.cos(k);return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=A,x[6]=L,x[7]=0,x[8]=0,x[9]=-L,x[10]=A,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromYRotation=function(x,k){var L=Math.sin(k),A=Math.cos(k);return x[0]=A,x[1]=0,x[2]=-L,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=L,x[9]=0,x[10]=A,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromZRotation=function(x,k){var L=Math.sin(k),A=Math.cos(k);return x[0]=A,x[1]=L,x[2]=0,x[3]=0,x[4]=-L,x[5]=A,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromRotationTranslation=h,se.fromQuat2=function(x,k){var L=new n.ARRAY_TYPE(3),A=-k[0],R=-k[1],$=-k[2],W=k[3],Y=k[4],re=k[5],ie=k[6],Q=k[7],ue=A*A+R*R+$*$+W*W;return ue>0?(L[0]=2*(Y*W+Q*A+re*$-ie*R)/ue,L[1]=2*(re*W+Q*R+ie*A-Y*$)/ue,L[2]=2*(ie*W+Q*$+Y*R-re*A)/ue):(L[0]=2*(Y*W+Q*A+re*$-ie*R),L[1]=2*(re*W+Q*R+ie*A-Y*$),L[2]=2*(ie*W+Q*$+Y*R-re*A)),h(x,k,L),x},se.getTranslation=function(x,k){return x[0]=k[12],x[1]=k[13],x[2]=k[14],x},se.getScaling=v,se.getRotation=function(x,k){var L=new n.ARRAY_TYPE(3);v(L,k);var A=1/L[0],R=1/L[1],$=1/L[2],W=k[0]*A,Y=k[1]*R,re=k[2]*$,ie=k[4]*A,Q=k[5]*R,ue=k[6]*$,_e=k[8]*A,Ie=k[9]*R,Ge=k[10]*$,ze=W+Q+Ge,$e=0;return ze>0?($e=2*Math.sqrt(ze+1),x[3]=.25*$e,x[0]=(ue-Ie)/$e,x[1]=(_e-re)/$e,x[2]=(Y-ie)/$e):W>Q&&W>Ge?($e=2*Math.sqrt(1+W-Q-Ge),x[3]=(ue-Ie)/$e,x[0]=.25*$e,x[1]=(Y+ie)/$e,x[2]=(_e+re)/$e):Q>Ge?($e=2*Math.sqrt(1+Q-W-Ge),x[3]=(_e-re)/$e,x[0]=(Y+ie)/$e,x[1]=.25*$e,x[2]=(ue+Ie)/$e):($e=2*Math.sqrt(1+Ge-W-Q),x[3]=(Y-ie)/$e,x[0]=(_e+re)/$e,x[1]=(ue+Ie)/$e,x[2]=.25*$e),x},se.fromRotationTranslationScale=function(x,k,L,A){var R=k[0],$=k[1],W=k[2],Y=k[3],re=R+R,ie=$+$,Q=W+W,ue=R*re,_e=R*ie,Ie=R*Q,Ge=$*ie,ze=$*Q,$e=W*Q,st=Y*re,Fe=Y*ie,rt=Y*Q,ht=A[0],pt=A[1],Tt=A[2];return x[0]=(1-(Ge+$e))*ht,x[1]=(_e+rt)*ht,x[2]=(Ie-Fe)*ht,x[3]=0,x[4]=(_e-rt)*pt,x[5]=(1-(ue+$e))*pt,x[6]=(ze+st)*pt,x[7]=0,x[8]=(Ie+Fe)*Tt,x[9]=(ze-st)*Tt,x[10]=(1-(ue+Ge))*Tt,x[11]=0,x[12]=L[0],x[13]=L[1],x[14]=L[2],x[15]=1,x},se.fromRotationTranslationScaleOrigin=function(x,k,L,A,R){var $=k[0],W=k[1],Y=k[2],re=k[3],ie=$+$,Q=W+W,ue=Y+Y,_e=$*ie,Ie=$*Q,Ge=$*ue,ze=W*Q,$e=W*ue,st=Y*ue,Fe=re*ie,rt=re*Q,ht=re*ue,pt=A[0],Tt=A[1],Lt=A[2],Ft=R[0],Pt=R[1],sn=R[2],Cn=(1-(ze+st))*pt,Jt=(Ie+ht)*pt,Jn=(Ge-rt)*pt,Fn=(Ie-ht)*Tt,Pn=(1-(_e+st))*Tt,Sn=($e+Fe)*Tt,wo=(Ge+rt)*Lt,Xn=($e-Fe)*Lt,io=(1-(_e+ze))*Lt;return x[0]=Cn,x[1]=Jt,x[2]=Jn,x[3]=0,x[4]=Fn,x[5]=Pn,x[6]=Sn,x[7]=0,x[8]=wo,x[9]=Xn,x[10]=io,x[11]=0,x[12]=L[0]+Ft-(Cn*Ft+Fn*Pt+wo*sn),x[13]=L[1]+Pt-(Jt*Ft+Pn*Pt+Xn*sn),x[14]=L[2]+sn-(Jn*Ft+Sn*Pt+io*sn),x[15]=1,x},se.fromQuat=function(x,k){var L=k[0],A=k[1],R=k[2],$=k[3],W=L+L,Y=A+A,re=R+R,ie=L*W,Q=A*W,ue=A*Y,_e=R*W,Ie=R*Y,Ge=R*re,ze=$*W,$e=$*Y,st=$*re;return x[0]=1-ue-Ge,x[1]=Q+st,x[2]=_e-$e,x[3]=0,x[4]=Q-st,x[5]=1-ie-Ge,x[6]=Ie+ze,x[7]=0,x[8]=_e+$e,x[9]=Ie-ze,x[10]=1-ie-ue,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.frustum=function(x,k,L,A,R,$,W){var Y=1/(L-k),re=1/(R-A),ie=1/($-W);return x[0]=2*$*Y,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=2*$*re,x[6]=0,x[7]=0,x[8]=(L+k)*Y,x[9]=(R+A)*re,x[10]=(W+$)*ie,x[11]=-1,x[12]=0,x[13]=0,x[14]=W*$*2*ie,x[15]=0,x},se.perspectiveNO=T,se.perspectiveZO=function(x,k,L,A,R){var $,W=1/Math.tan(k/2);return x[0]=W/L,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=W,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,R!=null&&R!==1/0?(x[10]=R*($=1/(A-R)),x[14]=R*A*$):(x[10]=-1,x[14]=-A),x},se.perspectiveFromFieldOfView=function(x,k,L,A){var R=Math.tan(k.upDegrees*Math.PI/180),$=Math.tan(k.downDegrees*Math.PI/180),W=Math.tan(k.leftDegrees*Math.PI/180),Y=Math.tan(k.rightDegrees*Math.PI/180),re=2/(W+Y),ie=2/(R+$);return x[0]=re,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=ie,x[6]=0,x[7]=0,x[8]=-(W-Y)*re*.5,x[9]=(R-$)*ie*.5,x[10]=A/(L-A),x[11]=-1,x[12]=0,x[13]=0,x[14]=A*L/(L-A),x[15]=0,x},se.orthoNO=P,se.orthoZO=function(x,k,L,A,R,$,W){var Y=1/(k-L),re=1/(A-R),ie=1/($-W);return x[0]=-2*Y,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*re,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=ie,x[11]=0,x[12]=(k+L)*Y,x[13]=(R+A)*re,x[14]=$*ie,x[15]=1,x},se.lookAt=function(x,k,L,A){var R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge=k[0],ze=k[1],$e=k[2],st=A[0],Fe=A[1],rt=A[2],ht=L[0],pt=L[1],Tt=L[2];return Math.abs(Ge-ht)<n.EPSILON&&Math.abs(ze-pt)<n.EPSILON&&Math.abs($e-Tt)<n.EPSILON?u(x):(Q=Ge-ht,ue=ze-pt,_e=$e-Tt,R=Fe*(_e*=Ie=1/Math.hypot(Q,ue,_e))-rt*(ue*=Ie),$=rt*(Q*=Ie)-st*_e,W=st*ue-Fe*Q,(Ie=Math.hypot(R,$,W))?(R*=Ie=1/Ie,$*=Ie,W*=Ie):(R=0,$=0,W=0),Y=ue*W-_e*$,re=_e*R-Q*W,ie=Q*$-ue*R,(Ie=Math.hypot(Y,re,ie))?(Y*=Ie=1/Ie,re*=Ie,ie*=Ie):(Y=0,re=0,ie=0),x[0]=R,x[1]=Y,x[2]=Q,x[3]=0,x[4]=$,x[5]=re,x[6]=ue,x[7]=0,x[8]=W,x[9]=ie,x[10]=_e,x[11]=0,x[12]=-(R*Ge+$*ze+W*$e),x[13]=-(Y*Ge+re*ze+ie*$e),x[14]=-(Q*Ge+ue*ze+_e*$e),x[15]=1,x)},se.targetTo=function(x,k,L,A){var R=k[0],$=k[1],W=k[2],Y=A[0],re=A[1],ie=A[2],Q=R-L[0],ue=$-L[1],_e=W-L[2],Ie=Q*Q+ue*ue+_e*_e;Ie>0&&(Q*=Ie=1/Math.sqrt(Ie),ue*=Ie,_e*=Ie);var Ge=re*_e-ie*ue,ze=ie*Q-Y*_e,$e=Y*ue-re*Q;return(Ie=Ge*Ge+ze*ze+$e*$e)>0&&(Ge*=Ie=1/Math.sqrt(Ie),ze*=Ie,$e*=Ie),x[0]=Ge,x[1]=ze,x[2]=$e,x[3]=0,x[4]=ue*$e-_e*ze,x[5]=_e*Ge-Q*$e,x[6]=Q*ze-ue*Ge,x[7]=0,x[8]=Q,x[9]=ue,x[10]=_e,x[11]=0,x[12]=R,x[13]=$,x[14]=W,x[15]=1,x},se.str=function(x){return"mat4("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+", "+x[6]+", "+x[7]+", "+x[8]+", "+x[9]+", "+x[10]+", "+x[11]+", "+x[12]+", "+x[13]+", "+x[14]+", "+x[15]+")"},se.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15])},se.add=function(x,k,L){return x[0]=k[0]+L[0],x[1]=k[1]+L[1],x[2]=k[2]+L[2],x[3]=k[3]+L[3],x[4]=k[4]+L[4],x[5]=k[5]+L[5],x[6]=k[6]+L[6],x[7]=k[7]+L[7],x[8]=k[8]+L[8],x[9]=k[9]+L[9],x[10]=k[10]+L[10],x[11]=k[11]+L[11],x[12]=k[12]+L[12],x[13]=k[13]+L[13],x[14]=k[14]+L[14],x[15]=k[15]+L[15],x},se.subtract=O,se.multiplyScalar=function(x,k,L){return x[0]=k[0]*L,x[1]=k[1]*L,x[2]=k[2]*L,x[3]=k[3]*L,x[4]=k[4]*L,x[5]=k[5]*L,x[6]=k[6]*L,x[7]=k[7]*L,x[8]=k[8]*L,x[9]=k[9]*L,x[10]=k[10]*L,x[11]=k[11]*L,x[12]=k[12]*L,x[13]=k[13]*L,x[14]=k[14]*L,x[15]=k[15]*L,x},se.multiplyScalarAndAdd=function(x,k,L,A){return x[0]=k[0]+L[0]*A,x[1]=k[1]+L[1]*A,x[2]=k[2]+L[2]*A,x[3]=k[3]+L[3]*A,x[4]=k[4]+L[4]*A,x[5]=k[5]+L[5]*A,x[6]=k[6]+L[6]*A,x[7]=k[7]+L[7]*A,x[8]=k[8]+L[8]*A,x[9]=k[9]+L[9]*A,x[10]=k[10]+L[10]*A,x[11]=k[11]+L[11]*A,x[12]=k[12]+L[12]*A,x[13]=k[13]+L[13]*A,x[14]=k[14]+L[14]*A,x[15]=k[15]+L[15]*A,x},se.exactEquals=function(x,k){return x[0]===k[0]&&x[1]===k[1]&&x[2]===k[2]&&x[3]===k[3]&&x[4]===k[4]&&x[5]===k[5]&&x[6]===k[6]&&x[7]===k[7]&&x[8]===k[8]&&x[9]===k[9]&&x[10]===k[10]&&x[11]===k[11]&&x[12]===k[12]&&x[13]===k[13]&&x[14]===k[14]&&x[15]===k[15]},se.equals=function(x,k){var L=x[0],A=x[1],R=x[2],$=x[3],W=x[4],Y=x[5],re=x[6],ie=x[7],Q=x[8],ue=x[9],_e=x[10],Ie=x[11],Ge=x[12],ze=x[13],$e=x[14],st=x[15],Fe=k[0],rt=k[1],ht=k[2],pt=k[3],Tt=k[4],Lt=k[5],Ft=k[6],Pt=k[7],sn=k[8],Cn=k[9],Jt=k[10],Jn=k[11],Fn=k[12],Pn=k[13],Sn=k[14],wo=k[15];return Math.abs(L-Fe)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(Fe))&&Math.abs(A-rt)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(rt))&&Math.abs(R-ht)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ht))&&Math.abs($-pt)<=n.EPSILON*Math.max(1,Math.abs($),Math.abs(pt))&&Math.abs(W-Tt)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Tt))&&Math.abs(Y-Lt)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Lt))&&Math.abs(re-Ft)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(Ft))&&Math.abs(ie-Pt)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Pt))&&Math.abs(Q-sn)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs(sn))&&Math.abs(ue-Cn)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(Cn))&&Math.abs(_e-Jt)<=n.EPSILON*Math.max(1,Math.abs(_e),Math.abs(Jt))&&Math.abs(Ie-Jn)<=n.EPSILON*Math.max(1,Math.abs(Ie),Math.abs(Jn))&&Math.abs(Ge-Fn)<=n.EPSILON*Math.max(1,Math.abs(Ge),Math.abs(Fn))&&Math.abs(ze-Pn)<=n.EPSILON*Math.max(1,Math.abs(ze),Math.abs(Pn))&&Math.abs($e-Sn)<=n.EPSILON*Math.max(1,Math.abs($e),Math.abs(Sn))&&Math.abs(st-wo)<=n.EPSILON*Math.max(1,Math.abs(st),Math.abs(wo))},se.sub=se.mul=se.ortho=se.perspective=void 0;var n=function(x,k){if(x&&x.__esModule)return x;if(x===null||c(x)!=="object"&&typeof x!="function")return{default:x};var L=a(void 0);if(L&&L.has(x))return L.get(x);var A={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in x)if($!=="default"&&Object.prototype.hasOwnProperty.call(x,$)){var W=R?Object.getOwnPropertyDescriptor(x,$):null;W&&(W.get||W.set)?Object.defineProperty(A,$,W):A[$]=x[$]}return A.default=x,L&&L.set(x,A),A}(F());function a(x){if(typeof WeakMap!="function")return null;var k=new WeakMap,L=new WeakMap;return(a=function(A){return A?L:k})(x)}function u(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function g(x,k,L){var A=k[0],R=k[1],$=k[2],W=k[3],Y=k[4],re=k[5],ie=k[6],Q=k[7],ue=k[8],_e=k[9],Ie=k[10],Ge=k[11],ze=k[12],$e=k[13],st=k[14],Fe=k[15],rt=L[0],ht=L[1],pt=L[2],Tt=L[3];return x[0]=rt*A+ht*Y+pt*ue+Tt*ze,x[1]=rt*R+ht*re+pt*_e+Tt*$e,x[2]=rt*$+ht*ie+pt*Ie+Tt*st,x[3]=rt*W+ht*Q+pt*Ge+Tt*Fe,x[4]=(rt=L[4])*A+(ht=L[5])*Y+(pt=L[6])*ue+(Tt=L[7])*ze,x[5]=rt*R+ht*re+pt*_e+Tt*$e,x[6]=rt*$+ht*ie+pt*Ie+Tt*st,x[7]=rt*W+ht*Q+pt*Ge+Tt*Fe,x[8]=(rt=L[8])*A+(ht=L[9])*Y+(pt=L[10])*ue+(Tt=L[11])*ze,x[9]=rt*R+ht*re+pt*_e+Tt*$e,x[10]=rt*$+ht*ie+pt*Ie+Tt*st,x[11]=rt*W+ht*Q+pt*Ge+Tt*Fe,x[12]=(rt=L[12])*A+(ht=L[13])*Y+(pt=L[14])*ue+(Tt=L[15])*ze,x[13]=rt*R+ht*re+pt*_e+Tt*$e,x[14]=rt*$+ht*ie+pt*Ie+Tt*st,x[15]=rt*W+ht*Q+pt*Ge+Tt*Fe,x}function h(x,k,L){var A=k[0],R=k[1],$=k[2],W=k[3],Y=A+A,re=R+R,ie=$+$,Q=A*Y,ue=A*re,_e=A*ie,Ie=R*re,Ge=R*ie,ze=$*ie,$e=W*Y,st=W*re,Fe=W*ie;return x[0]=1-(Ie+ze),x[1]=ue+Fe,x[2]=_e-st,x[3]=0,x[4]=ue-Fe,x[5]=1-(Q+ze),x[6]=Ge+$e,x[7]=0,x[8]=_e+st,x[9]=Ge-$e,x[10]=1-(Q+Ie),x[11]=0,x[12]=L[0],x[13]=L[1],x[14]=L[2],x[15]=1,x}function v(x,k){var L=k[4],A=k[5],R=k[6],$=k[8],W=k[9],Y=k[10];return x[0]=Math.hypot(k[0],k[1],k[2]),x[1]=Math.hypot(L,A,R),x[2]=Math.hypot($,W,Y),x}function T(x,k,L,A,R){var $,W=1/Math.tan(k/2);return x[0]=W/L,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=W,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,R!=null&&R!==1/0?(x[10]=(R+A)*($=1/(A-R)),x[14]=2*R*A*$):(x[10]=-1,x[14]=-2*A),x}function P(x,k,L,A,R,$,W){var Y=1/(k-L),re=1/(A-R),ie=1/($-W);return x[0]=-2*Y,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*re,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*ie,x[11]=0,x[12]=(k+L)*Y,x[13]=(R+A)*re,x[14]=(W+$)*ie,x[15]=1,x}function O(x,k,L){return x[0]=k[0]-L[0],x[1]=k[1]-L[1],x[2]=k[2]-L[2],x[3]=k[3]-L[3],x[4]=k[4]-L[4],x[5]=k[5]-L[5],x[6]=k[6]-L[6],x[7]=k[7]-L[7],x[8]=k[8]-L[8],x[9]=k[9]-L[9],x[10]=k[10]-L[10],x[11]=k[11]-L[11],x[12]=k[12]-L[12],x[13]=k[13]-L[13],x[14]=k[14]-L[14],x[15]=k[15]-L[15],x}return se.perspective=T,se.ortho=P,se.mul=g,se.sub=O,se}var de,ce={},pe={};function ge(){if(de)return pe;function c(R){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},c(R)}de=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.create=u,pe.clone=function(R){var $=new n.ARRAY_TYPE(3);return $[0]=R[0],$[1]=R[1],$[2]=R[2],$},pe.length=g,pe.fromValues=function(R,$,W){var Y=new n.ARRAY_TYPE(3);return Y[0]=R,Y[1]=$,Y[2]=W,Y},pe.copy=function(R,$){return R[0]=$[0],R[1]=$[1],R[2]=$[2],R},pe.set=function(R,$,W,Y){return R[0]=$,R[1]=W,R[2]=Y,R},pe.add=function(R,$,W){return R[0]=$[0]+W[0],R[1]=$[1]+W[1],R[2]=$[2]+W[2],R},pe.subtract=h,pe.multiply=v,pe.divide=T,pe.ceil=function(R,$){return R[0]=Math.ceil($[0]),R[1]=Math.ceil($[1]),R[2]=Math.ceil($[2]),R},pe.floor=function(R,$){return R[0]=Math.floor($[0]),R[1]=Math.floor($[1]),R[2]=Math.floor($[2]),R},pe.min=function(R,$,W){return R[0]=Math.min($[0],W[0]),R[1]=Math.min($[1],W[1]),R[2]=Math.min($[2],W[2]),R},pe.max=function(R,$,W){return R[0]=Math.max($[0],W[0]),R[1]=Math.max($[1],W[1]),R[2]=Math.max($[2],W[2]),R},pe.round=function(R,$){return R[0]=Math.round($[0]),R[1]=Math.round($[1]),R[2]=Math.round($[2]),R},pe.scale=function(R,$,W){return R[0]=$[0]*W,R[1]=$[1]*W,R[2]=$[2]*W,R},pe.scaleAndAdd=function(R,$,W,Y){return R[0]=$[0]+W[0]*Y,R[1]=$[1]+W[1]*Y,R[2]=$[2]+W[2]*Y,R},pe.distance=P,pe.squaredDistance=O,pe.squaredLength=x,pe.negate=function(R,$){return R[0]=-$[0],R[1]=-$[1],R[2]=-$[2],R},pe.inverse=function(R,$){return R[0]=1/$[0],R[1]=1/$[1],R[2]=1/$[2],R},pe.normalize=function(R,$){var W=$[0],Y=$[1],re=$[2],ie=W*W+Y*Y+re*re;return ie>0&&(ie=1/Math.sqrt(ie)),R[0]=$[0]*ie,R[1]=$[1]*ie,R[2]=$[2]*ie,R},pe.dot=k,pe.cross=function(R,$,W){var Y=$[0],re=$[1],ie=$[2],Q=W[0],ue=W[1],_e=W[2];return R[0]=re*_e-ie*ue,R[1]=ie*Q-Y*_e,R[2]=Y*ue-re*Q,R},pe.lerp=function(R,$,W,Y){var re=$[0],ie=$[1],Q=$[2];return R[0]=re+Y*(W[0]-re),R[1]=ie+Y*(W[1]-ie),R[2]=Q+Y*(W[2]-Q),R},pe.hermite=function(R,$,W,Y,re,ie){var Q=ie*ie,ue=Q*(2*ie-3)+1,_e=Q*(ie-2)+ie,Ie=Q*(ie-1),Ge=Q*(3-2*ie);return R[0]=$[0]*ue+W[0]*_e+Y[0]*Ie+re[0]*Ge,R[1]=$[1]*ue+W[1]*_e+Y[1]*Ie+re[1]*Ge,R[2]=$[2]*ue+W[2]*_e+Y[2]*Ie+re[2]*Ge,R},pe.bezier=function(R,$,W,Y,re,ie){var Q=1-ie,ue=Q*Q,_e=ie*ie,Ie=ue*Q,Ge=3*ie*ue,ze=3*_e*Q,$e=_e*ie;return R[0]=$[0]*Ie+W[0]*Ge+Y[0]*ze+re[0]*$e,R[1]=$[1]*Ie+W[1]*Ge+Y[1]*ze+re[1]*$e,R[2]=$[2]*Ie+W[2]*Ge+Y[2]*ze+re[2]*$e,R},pe.random=function(R,$){$=$||1;var W=2*n.RANDOM()*Math.PI,Y=2*n.RANDOM()-1,re=Math.sqrt(1-Y*Y)*$;return R[0]=Math.cos(W)*re,R[1]=Math.sin(W)*re,R[2]=Y*$,R},pe.transformMat4=function(R,$,W){var Y=$[0],re=$[1],ie=$[2],Q=W[3]*Y+W[7]*re+W[11]*ie+W[15];return R[0]=(W[0]*Y+W[4]*re+W[8]*ie+W[12])/(Q=Q||1),R[1]=(W[1]*Y+W[5]*re+W[9]*ie+W[13])/Q,R[2]=(W[2]*Y+W[6]*re+W[10]*ie+W[14])/Q,R},pe.transformMat3=function(R,$,W){var Y=$[0],re=$[1],ie=$[2];return R[0]=Y*W[0]+re*W[3]+ie*W[6],R[1]=Y*W[1]+re*W[4]+ie*W[7],R[2]=Y*W[2]+re*W[5]+ie*W[8],R},pe.transformQuat=function(R,$,W){var Y=W[0],re=W[1],ie=W[2],Q=$[0],ue=$[1],_e=$[2],Ie=re*_e-ie*ue,Ge=ie*Q-Y*_e,ze=Y*ue-re*Q,$e=re*ze-ie*Ge,st=ie*Ie-Y*ze,Fe=Y*Ge-re*Ie,rt=2*W[3];return Ge*=rt,ze*=rt,st*=2,Fe*=2,R[0]=Q+(Ie*=rt)+($e*=2),R[1]=ue+Ge+st,R[2]=_e+ze+Fe,R},pe.rotateX=function(R,$,W,Y){var re=[],ie=[];return re[0]=$[0]-W[0],re[1]=$[1]-W[1],re[2]=$[2]-W[2],ie[0]=re[0],ie[1]=re[1]*Math.cos(Y)-re[2]*Math.sin(Y),ie[2]=re[1]*Math.sin(Y)+re[2]*Math.cos(Y),R[0]=ie[0]+W[0],R[1]=ie[1]+W[1],R[2]=ie[2]+W[2],R},pe.rotateY=function(R,$,W,Y){var re=[],ie=[];return re[0]=$[0]-W[0],re[1]=$[1]-W[1],re[2]=$[2]-W[2],ie[0]=re[2]*Math.sin(Y)+re[0]*Math.cos(Y),ie[1]=re[1],ie[2]=re[2]*Math.cos(Y)-re[0]*Math.sin(Y),R[0]=ie[0]+W[0],R[1]=ie[1]+W[1],R[2]=ie[2]+W[2],R},pe.rotateZ=function(R,$,W,Y){var re=[],ie=[];return re[0]=$[0]-W[0],re[1]=$[1]-W[1],re[2]=$[2]-W[2],ie[0]=re[0]*Math.cos(Y)-re[1]*Math.sin(Y),ie[1]=re[0]*Math.sin(Y)+re[1]*Math.cos(Y),ie[2]=re[2],R[0]=ie[0]+W[0],R[1]=ie[1]+W[1],R[2]=ie[2]+W[2],R},pe.angle=function(R,$){var W=R[0],Y=R[1],re=R[2],ie=$[0],Q=$[1],ue=$[2],_e=Math.sqrt(W*W+Y*Y+re*re)*Math.sqrt(ie*ie+Q*Q+ue*ue),Ie=_e&&k(R,$)/_e;return Math.acos(Math.min(Math.max(Ie,-1),1))},pe.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},pe.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},pe.exactEquals=function(R,$){return R[0]===$[0]&&R[1]===$[1]&&R[2]===$[2]},pe.equals=function(R,$){var W=R[0],Y=R[1],re=R[2],ie=$[0],Q=$[1],ue=$[2];return Math.abs(W-ie)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ie))&&Math.abs(Y-Q)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Q))&&Math.abs(re-ue)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(ue))},pe.forEach=pe.sqrLen=pe.len=pe.sqrDist=pe.dist=pe.div=pe.mul=pe.sub=void 0;var n=function(R,$){if(R&&R.__esModule)return R;if(R===null||c(R)!=="object"&&typeof R!="function")return{default:R};var W=a(void 0);if(W&&W.has(R))return W.get(R);var Y={},re=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var Q=re?Object.getOwnPropertyDescriptor(R,ie):null;Q&&(Q.get||Q.set)?Object.defineProperty(Y,ie,Q):Y[ie]=R[ie]}return Y.default=R,W&&W.set(R,Y),Y}(F());function a(R){if(typeof WeakMap!="function")return null;var $=new WeakMap,W=new WeakMap;return(a=function(Y){return Y?W:$})(R)}function u(){var R=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function g(R){return Math.hypot(R[0],R[1],R[2])}function h(R,$,W){return R[0]=$[0]-W[0],R[1]=$[1]-W[1],R[2]=$[2]-W[2],R}function v(R,$,W){return R[0]=$[0]*W[0],R[1]=$[1]*W[1],R[2]=$[2]*W[2],R}function T(R,$,W){return R[0]=$[0]/W[0],R[1]=$[1]/W[1],R[2]=$[2]/W[2],R}function P(R,$){return Math.hypot($[0]-R[0],$[1]-R[1],$[2]-R[2])}function O(R,$){var W=$[0]-R[0],Y=$[1]-R[1],re=$[2]-R[2];return W*W+Y*Y+re*re}function x(R){var $=R[0],W=R[1],Y=R[2];return $*$+W*W+Y*Y}function k(R,$){return R[0]*$[0]+R[1]*$[1]+R[2]*$[2]}pe.sub=h,pe.mul=v,pe.div=T,pe.dist=P,pe.sqrDist=O,pe.len=g,pe.sqrLen=x;var L,A=(L=u(),function(R,$,W,Y,re,ie){var Q,ue;for($||($=3),W||(W=0),ue=Y?Math.min(Y*$+W,R.length):R.length,Q=W;Q<ue;Q+=$)L[0]=R[Q],L[1]=R[Q+1],L[2]=R[Q+2],re(L,L,ie),R[Q]=L[0],R[Q+1]=L[1],R[Q+2]=L[2];return R});return pe.forEach=A,pe}var Re,Je,Me={};function xe(){if(Re)return Me;function c(A){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(A)}Re=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.create=u,Me.clone=function(A){var R=new n.ARRAY_TYPE(4);return R[0]=A[0],R[1]=A[1],R[2]=A[2],R[3]=A[3],R},Me.fromValues=function(A,R,$,W){var Y=new n.ARRAY_TYPE(4);return Y[0]=A,Y[1]=R,Y[2]=$,Y[3]=W,Y},Me.copy=function(A,R){return A[0]=R[0],A[1]=R[1],A[2]=R[2],A[3]=R[3],A},Me.set=function(A,R,$,W,Y){return A[0]=R,A[1]=$,A[2]=W,A[3]=Y,A},Me.add=function(A,R,$){return A[0]=R[0]+$[0],A[1]=R[1]+$[1],A[2]=R[2]+$[2],A[3]=R[3]+$[3],A},Me.subtract=g,Me.multiply=h,Me.divide=v,Me.ceil=function(A,R){return A[0]=Math.ceil(R[0]),A[1]=Math.ceil(R[1]),A[2]=Math.ceil(R[2]),A[3]=Math.ceil(R[3]),A},Me.floor=function(A,R){return A[0]=Math.floor(R[0]),A[1]=Math.floor(R[1]),A[2]=Math.floor(R[2]),A[3]=Math.floor(R[3]),A},Me.min=function(A,R,$){return A[0]=Math.min(R[0],$[0]),A[1]=Math.min(R[1],$[1]),A[2]=Math.min(R[2],$[2]),A[3]=Math.min(R[3],$[3]),A},Me.max=function(A,R,$){return A[0]=Math.max(R[0],$[0]),A[1]=Math.max(R[1],$[1]),A[2]=Math.max(R[2],$[2]),A[3]=Math.max(R[3],$[3]),A},Me.round=function(A,R){return A[0]=Math.round(R[0]),A[1]=Math.round(R[1]),A[2]=Math.round(R[2]),A[3]=Math.round(R[3]),A},Me.scale=function(A,R,$){return A[0]=R[0]*$,A[1]=R[1]*$,A[2]=R[2]*$,A[3]=R[3]*$,A},Me.scaleAndAdd=function(A,R,$,W){return A[0]=R[0]+$[0]*W,A[1]=R[1]+$[1]*W,A[2]=R[2]+$[2]*W,A[3]=R[3]+$[3]*W,A},Me.distance=T,Me.squaredDistance=P,Me.length=O,Me.squaredLength=x,Me.negate=function(A,R){return A[0]=-R[0],A[1]=-R[1],A[2]=-R[2],A[3]=-R[3],A},Me.inverse=function(A,R){return A[0]=1/R[0],A[1]=1/R[1],A[2]=1/R[2],A[3]=1/R[3],A},Me.normalize=function(A,R){var $=R[0],W=R[1],Y=R[2],re=R[3],ie=$*$+W*W+Y*Y+re*re;return ie>0&&(ie=1/Math.sqrt(ie)),A[0]=$*ie,A[1]=W*ie,A[2]=Y*ie,A[3]=re*ie,A},Me.dot=function(A,R){return A[0]*R[0]+A[1]*R[1]+A[2]*R[2]+A[3]*R[3]},Me.cross=function(A,R,$,W){var Y=$[0]*W[1]-$[1]*W[0],re=$[0]*W[2]-$[2]*W[0],ie=$[0]*W[3]-$[3]*W[0],Q=$[1]*W[2]-$[2]*W[1],ue=$[1]*W[3]-$[3]*W[1],_e=$[2]*W[3]-$[3]*W[2],Ie=R[0],Ge=R[1],ze=R[2],$e=R[3];return A[0]=Ge*_e-ze*ue+$e*Q,A[1]=-Ie*_e+ze*ie-$e*re,A[2]=Ie*ue-Ge*ie+$e*Y,A[3]=-Ie*Q+Ge*re-ze*Y,A},Me.lerp=function(A,R,$,W){var Y=R[0],re=R[1],ie=R[2],Q=R[3];return A[0]=Y+W*($[0]-Y),A[1]=re+W*($[1]-re),A[2]=ie+W*($[2]-ie),A[3]=Q+W*($[3]-Q),A},Me.random=function(A,R){var $,W,Y,re,ie,Q;R=R||1;do ie=($=2*n.RANDOM()-1)*$+(W=2*n.RANDOM()-1)*W;while(ie>=1);do Q=(Y=2*n.RANDOM()-1)*Y+(re=2*n.RANDOM()-1)*re;while(Q>=1);var ue=Math.sqrt((1-ie)/Q);return A[0]=R*$,A[1]=R*W,A[2]=R*Y*ue,A[3]=R*re*ue,A},Me.transformMat4=function(A,R,$){var W=R[0],Y=R[1],re=R[2],ie=R[3];return A[0]=$[0]*W+$[4]*Y+$[8]*re+$[12]*ie,A[1]=$[1]*W+$[5]*Y+$[9]*re+$[13]*ie,A[2]=$[2]*W+$[6]*Y+$[10]*re+$[14]*ie,A[3]=$[3]*W+$[7]*Y+$[11]*re+$[15]*ie,A},Me.transformQuat=function(A,R,$){var W=R[0],Y=R[1],re=R[2],ie=$[0],Q=$[1],ue=$[2],_e=$[3],Ie=_e*W+Q*re-ue*Y,Ge=_e*Y+ue*W-ie*re,ze=_e*re+ie*Y-Q*W,$e=-ie*W-Q*Y-ue*re;return A[0]=Ie*_e+$e*-ie+Ge*-ue-ze*-Q,A[1]=Ge*_e+$e*-Q+ze*-ie-Ie*-ue,A[2]=ze*_e+$e*-ue+Ie*-Q-Ge*-ie,A[3]=R[3],A},Me.zero=function(A){return A[0]=0,A[1]=0,A[2]=0,A[3]=0,A},Me.str=function(A){return"vec4("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+")"},Me.exactEquals=function(A,R){return A[0]===R[0]&&A[1]===R[1]&&A[2]===R[2]&&A[3]===R[3]},Me.equals=function(A,R){var $=A[0],W=A[1],Y=A[2],re=A[3],ie=R[0],Q=R[1],ue=R[2],_e=R[3];return Math.abs($-ie)<=n.EPSILON*Math.max(1,Math.abs($),Math.abs(ie))&&Math.abs(W-Q)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Q))&&Math.abs(Y-ue)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ue))&&Math.abs(re-_e)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(_e))},Me.forEach=Me.sqrLen=Me.len=Me.sqrDist=Me.dist=Me.div=Me.mul=Me.sub=void 0;var n=function(A,R){if(A&&A.__esModule)return A;if(A===null||c(A)!=="object"&&typeof A!="function")return{default:A};var $=a(void 0);if($&&$.has(A))return $.get(A);var W={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in A)if(re!=="default"&&Object.prototype.hasOwnProperty.call(A,re)){var ie=Y?Object.getOwnPropertyDescriptor(A,re):null;ie&&(ie.get||ie.set)?Object.defineProperty(W,re,ie):W[re]=A[re]}return W.default=A,$&&$.set(A,W),W}(F());function a(A){if(typeof WeakMap!="function")return null;var R=new WeakMap,$=new WeakMap;return(a=function(W){return W?$:R})(A)}function u(){var A=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0,A[3]=0),A}function g(A,R,$){return A[0]=R[0]-$[0],A[1]=R[1]-$[1],A[2]=R[2]-$[2],A[3]=R[3]-$[3],A}function h(A,R,$){return A[0]=R[0]*$[0],A[1]=R[1]*$[1],A[2]=R[2]*$[2],A[3]=R[3]*$[3],A}function v(A,R,$){return A[0]=R[0]/$[0],A[1]=R[1]/$[1],A[2]=R[2]/$[2],A[3]=R[3]/$[3],A}function T(A,R){return Math.hypot(R[0]-A[0],R[1]-A[1],R[2]-A[2],R[3]-A[3])}function P(A,R){var $=R[0]-A[0],W=R[1]-A[1],Y=R[2]-A[2],re=R[3]-A[3];return $*$+W*W+Y*Y+re*re}function O(A){return Math.hypot(A[0],A[1],A[2],A[3])}function x(A){var R=A[0],$=A[1],W=A[2],Y=A[3];return R*R+$*$+W*W+Y*Y}Me.sub=g,Me.mul=h,Me.div=v,Me.dist=T,Me.sqrDist=P,Me.len=O,Me.sqrLen=x;var k,L=(k=u(),function(A,R,$,W,Y,re){var ie,Q;for(R||(R=4),$||($=0),Q=W?Math.min(W*R+$,A.length):A.length,ie=$;ie<Q;ie+=R)k[0]=A[ie],k[1]=A[ie+1],k[2]=A[ie+2],k[3]=A[ie+3],Y(k,k,re),A[ie]=k[0],A[ie+1]=k[1],A[ie+2]=k[2],A[ie+3]=k[3];return A});return Me.forEach=L,Me}function Ae(){if(Je)return ce;function c(Fe){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(rt){return typeof rt}:function(rt){return rt&&typeof Symbol=="function"&&rt.constructor===Symbol&&rt!==Symbol.prototype?"symbol":typeof rt},c(Fe)}Je=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.create=T,ce.identity=function(Fe){return Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=1,Fe},ce.setAxisAngle=P,ce.getAxisAngle=function(Fe,rt){var ht=2*Math.acos(rt[3]),pt=Math.sin(ht/2);return pt>n.EPSILON?(Fe[0]=rt[0]/pt,Fe[1]=rt[1]/pt,Fe[2]=rt[2]/pt):(Fe[0]=1,Fe[1]=0,Fe[2]=0),ht},ce.getAngle=function(Fe,rt){var ht=$(Fe,rt);return Math.acos(2*ht*ht-1)},ce.multiply=O,ce.rotateX=function(Fe,rt,ht){ht*=.5;var pt=rt[0],Tt=rt[1],Lt=rt[2],Ft=rt[3],Pt=Math.sin(ht),sn=Math.cos(ht);return Fe[0]=pt*sn+Ft*Pt,Fe[1]=Tt*sn+Lt*Pt,Fe[2]=Lt*sn-Tt*Pt,Fe[3]=Ft*sn-pt*Pt,Fe},ce.rotateY=function(Fe,rt,ht){ht*=.5;var pt=rt[0],Tt=rt[1],Lt=rt[2],Ft=rt[3],Pt=Math.sin(ht),sn=Math.cos(ht);return Fe[0]=pt*sn-Lt*Pt,Fe[1]=Tt*sn+Ft*Pt,Fe[2]=Lt*sn+pt*Pt,Fe[3]=Ft*sn-Tt*Pt,Fe},ce.rotateZ=function(Fe,rt,ht){ht*=.5;var pt=rt[0],Tt=rt[1],Lt=rt[2],Ft=rt[3],Pt=Math.sin(ht),sn=Math.cos(ht);return Fe[0]=pt*sn+Tt*Pt,Fe[1]=Tt*sn-pt*Pt,Fe[2]=Lt*sn+Ft*Pt,Fe[3]=Ft*sn-Lt*Pt,Fe},ce.calculateW=function(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2];return Fe[0]=ht,Fe[1]=pt,Fe[2]=Tt,Fe[3]=Math.sqrt(Math.abs(1-ht*ht-pt*pt-Tt*Tt)),Fe},ce.exp=x,ce.ln=k,ce.pow=function(Fe,rt,ht){return k(Fe,rt),R(Fe,Fe,ht),x(Fe,Fe),Fe},ce.slerp=L,ce.random=function(Fe){var rt=n.RANDOM(),ht=n.RANDOM(),pt=n.RANDOM(),Tt=Math.sqrt(1-rt),Lt=Math.sqrt(rt);return Fe[0]=Tt*Math.sin(2*Math.PI*ht),Fe[1]=Tt*Math.cos(2*Math.PI*ht),Fe[2]=Lt*Math.sin(2*Math.PI*pt),Fe[3]=Lt*Math.cos(2*Math.PI*pt),Fe},ce.invert=function(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2],Lt=rt[3],Ft=ht*ht+pt*pt+Tt*Tt+Lt*Lt,Pt=Ft?1/Ft:0;return Fe[0]=-ht*Pt,Fe[1]=-pt*Pt,Fe[2]=-Tt*Pt,Fe[3]=Lt*Pt,Fe},ce.conjugate=function(Fe,rt){return Fe[0]=-rt[0],Fe[1]=-rt[1],Fe[2]=-rt[2],Fe[3]=rt[3],Fe},ce.fromMat3=A,ce.fromEuler=function(Fe,rt,ht,pt){var Tt=.5*Math.PI/180;rt*=Tt,ht*=Tt,pt*=Tt;var Lt=Math.sin(rt),Ft=Math.cos(rt),Pt=Math.sin(ht),sn=Math.cos(ht),Cn=Math.sin(pt),Jt=Math.cos(pt);return Fe[0]=Lt*sn*Jt-Ft*Pt*Cn,Fe[1]=Ft*Pt*Jt+Lt*sn*Cn,Fe[2]=Ft*sn*Cn-Lt*Pt*Jt,Fe[3]=Ft*sn*Jt+Lt*Pt*Cn,Fe},ce.str=function(Fe){return"quat("+Fe[0]+", "+Fe[1]+", "+Fe[2]+", "+Fe[3]+")"},ce.setAxes=ce.sqlerp=ce.rotationTo=ce.equals=ce.exactEquals=ce.normalize=ce.sqrLen=ce.squaredLength=ce.len=ce.length=ce.lerp=ce.dot=ce.scale=ce.mul=ce.add=ce.set=ce.copy=ce.fromValues=ce.clone=void 0;var n=v(F()),a=v(J()),u=v(ge()),g=v(xe());function h(Fe){if(typeof WeakMap!="function")return null;var rt=new WeakMap,ht=new WeakMap;return(h=function(pt){return pt?ht:rt})(Fe)}function v(Fe,rt){if(Fe&&Fe.__esModule)return Fe;if(Fe===null||c(Fe)!=="object"&&typeof Fe!="function")return{default:Fe};var ht=h(rt);if(ht&&ht.has(Fe))return ht.get(Fe);var pt={},Tt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Lt in Fe)if(Lt!=="default"&&Object.prototype.hasOwnProperty.call(Fe,Lt)){var Ft=Tt?Object.getOwnPropertyDescriptor(Fe,Lt):null;Ft&&(Ft.get||Ft.set)?Object.defineProperty(pt,Lt,Ft):pt[Lt]=Fe[Lt]}return pt.default=Fe,ht&&ht.set(Fe,pt),pt}function T(){var Fe=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(Fe[0]=0,Fe[1]=0,Fe[2]=0),Fe[3]=1,Fe}function P(Fe,rt,ht){ht*=.5;var pt=Math.sin(ht);return Fe[0]=pt*rt[0],Fe[1]=pt*rt[1],Fe[2]=pt*rt[2],Fe[3]=Math.cos(ht),Fe}function O(Fe,rt,ht){var pt=rt[0],Tt=rt[1],Lt=rt[2],Ft=rt[3],Pt=ht[0],sn=ht[1],Cn=ht[2],Jt=ht[3];return Fe[0]=pt*Jt+Ft*Pt+Tt*Cn-Lt*sn,Fe[1]=Tt*Jt+Ft*sn+Lt*Pt-pt*Cn,Fe[2]=Lt*Jt+Ft*Cn+pt*sn-Tt*Pt,Fe[3]=Ft*Jt-pt*Pt-Tt*sn-Lt*Cn,Fe}function x(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2],Lt=rt[3],Ft=Math.sqrt(ht*ht+pt*pt+Tt*Tt),Pt=Math.exp(Lt),sn=Ft>0?Pt*Math.sin(Ft)/Ft:0;return Fe[0]=ht*sn,Fe[1]=pt*sn,Fe[2]=Tt*sn,Fe[3]=Pt*Math.cos(Ft),Fe}function k(Fe,rt){var ht=rt[0],pt=rt[1],Tt=rt[2],Lt=rt[3],Ft=Math.sqrt(ht*ht+pt*pt+Tt*Tt),Pt=Ft>0?Math.atan2(Ft,Lt)/Ft:0;return Fe[0]=ht*Pt,Fe[1]=pt*Pt,Fe[2]=Tt*Pt,Fe[3]=.5*Math.log(ht*ht+pt*pt+Tt*Tt+Lt*Lt),Fe}function L(Fe,rt,ht,pt){var Tt,Lt,Ft,Pt,sn,Cn=rt[0],Jt=rt[1],Jn=rt[2],Fn=rt[3],Pn=ht[0],Sn=ht[1],wo=ht[2],Xn=ht[3];return(Lt=Cn*Pn+Jt*Sn+Jn*wo+Fn*Xn)<0&&(Lt=-Lt,Pn=-Pn,Sn=-Sn,wo=-wo,Xn=-Xn),1-Lt>n.EPSILON?(Tt=Math.acos(Lt),Ft=Math.sin(Tt),Pt=Math.sin((1-pt)*Tt)/Ft,sn=Math.sin(pt*Tt)/Ft):(Pt=1-pt,sn=pt),Fe[0]=Pt*Cn+sn*Pn,Fe[1]=Pt*Jt+sn*Sn,Fe[2]=Pt*Jn+sn*wo,Fe[3]=Pt*Fn+sn*Xn,Fe}function A(Fe,rt){var ht,pt=rt[0]+rt[4]+rt[8];if(pt>0)ht=Math.sqrt(pt+1),Fe[3]=.5*ht,Fe[0]=(rt[5]-rt[7])*(ht=.5/ht),Fe[1]=(rt[6]-rt[2])*ht,Fe[2]=(rt[1]-rt[3])*ht;else{var Tt=0;rt[4]>rt[0]&&(Tt=1),rt[8]>rt[3*Tt+Tt]&&(Tt=2);var Lt=(Tt+1)%3,Ft=(Tt+2)%3;ht=Math.sqrt(rt[3*Tt+Tt]-rt[3*Lt+Lt]-rt[3*Ft+Ft]+1),Fe[Tt]=.5*ht,Fe[3]=(rt[3*Lt+Ft]-rt[3*Ft+Lt])*(ht=.5/ht),Fe[Lt]=(rt[3*Lt+Tt]+rt[3*Tt+Lt])*ht,Fe[Ft]=(rt[3*Ft+Tt]+rt[3*Tt+Ft])*ht}return Fe}ce.clone=g.clone,ce.fromValues=g.fromValues,ce.copy=g.copy,ce.set=g.set,ce.add=g.add,ce.mul=O;var R=g.scale;ce.scale=R;var $=g.dot;ce.dot=$,ce.lerp=g.lerp;var W=g.length;ce.length=W,ce.len=W;var Y=g.squaredLength;ce.squaredLength=Y,ce.sqrLen=Y;var re=g.normalize;ce.normalize=re,ce.exactEquals=g.exactEquals,ce.equals=g.equals;var ie,Q,ue,_e=(ie=u.create(),Q=u.fromValues(1,0,0),ue=u.fromValues(0,1,0),function(Fe,rt,ht){var pt=u.dot(rt,ht);return pt<-.999999?(u.cross(ie,Q,rt),u.len(ie)<1e-6&&u.cross(ie,ue,rt),u.normalize(ie,ie),P(Fe,ie,Math.PI),Fe):pt>.999999?(Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=1,Fe):(u.cross(ie,rt,ht),Fe[0]=ie[0],Fe[1]=ie[1],Fe[2]=ie[2],Fe[3]=1+pt,re(Fe,Fe))});ce.rotationTo=_e;var Ie,Ge,ze=(Ie=T(),Ge=T(),function(Fe,rt,ht,pt,Tt,Lt){return L(Ie,rt,Tt,Lt),L(Ge,ht,pt,Lt),L(Fe,Ie,Ge,2*Lt*(1-Lt)),Fe});ce.sqlerp=ze;var $e,st=($e=a.create(),function(Fe,rt,ht,pt){return $e[0]=ht[0],$e[3]=ht[1],$e[6]=ht[2],$e[1]=pt[0],$e[4]=pt[1],$e[7]=pt[2],$e[2]=-rt[0],$e[5]=-rt[1],$e[8]=-rt[2],re(Fe,A(Fe,$e))});return ce.setAxes=st,ce}var Ce,ve={};function Ne(){if(Ce)return ve;function c(L){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},c(L)}Ce=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.create=function(){var L=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0,L[4]=0,L[5]=0,L[6]=0,L[7]=0),L[3]=1,L},ve.clone=function(L){var A=new n.ARRAY_TYPE(8);return A[0]=L[0],A[1]=L[1],A[2]=L[2],A[3]=L[3],A[4]=L[4],A[5]=L[5],A[6]=L[6],A[7]=L[7],A},ve.fromValues=function(L,A,R,$,W,Y,re,ie){var Q=new n.ARRAY_TYPE(8);return Q[0]=L,Q[1]=A,Q[2]=R,Q[3]=$,Q[4]=W,Q[5]=Y,Q[6]=re,Q[7]=ie,Q},ve.fromRotationTranslationValues=function(L,A,R,$,W,Y,re){var ie=new n.ARRAY_TYPE(8);ie[0]=L,ie[1]=A,ie[2]=R,ie[3]=$;var Q=.5*W,ue=.5*Y,_e=.5*re;return ie[4]=Q*$+ue*R-_e*A,ie[5]=ue*$+_e*L-Q*R,ie[6]=_e*$+Q*A-ue*L,ie[7]=-Q*L-ue*A-_e*R,ie},ve.fromRotationTranslation=v,ve.fromTranslation=function(L,A){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=.5*A[0],L[5]=.5*A[1],L[6]=.5*A[2],L[7]=0,L},ve.fromRotation=function(L,A){return L[0]=A[0],L[1]=A[1],L[2]=A[2],L[3]=A[3],L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},ve.fromMat4=function(L,A){var R=a.create();u.getRotation(R,A);var $=new n.ARRAY_TYPE(3);return u.getTranslation($,A),v(L,R,$),L},ve.copy=T,ve.identity=function(L){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},ve.set=function(L,A,R,$,W,Y,re,ie,Q){return L[0]=A,L[1]=R,L[2]=$,L[3]=W,L[4]=Y,L[5]=re,L[6]=ie,L[7]=Q,L},ve.getDual=function(L,A){return L[0]=A[4],L[1]=A[5],L[2]=A[6],L[3]=A[7],L},ve.setDual=function(L,A){return L[4]=A[0],L[5]=A[1],L[6]=A[2],L[7]=A[3],L},ve.getTranslation=function(L,A){var R=A[4],$=A[5],W=A[6],Y=A[7],re=-A[0],ie=-A[1],Q=-A[2],ue=A[3];return L[0]=2*(R*ue+Y*re+$*Q-W*ie),L[1]=2*($*ue+Y*ie+W*re-R*Q),L[2]=2*(W*ue+Y*Q+R*ie-$*re),L},ve.translate=function(L,A,R){var $=A[0],W=A[1],Y=A[2],re=A[3],ie=.5*R[0],Q=.5*R[1],ue=.5*R[2],_e=A[4],Ie=A[5],Ge=A[6],ze=A[7];return L[0]=$,L[1]=W,L[2]=Y,L[3]=re,L[4]=re*ie+W*ue-Y*Q+_e,L[5]=re*Q+Y*ie-$*ue+Ie,L[6]=re*ue+$*Q-W*ie+Ge,L[7]=-$*ie-W*Q-Y*ue+ze,L},ve.rotateX=function(L,A,R){var $=-A[0],W=-A[1],Y=-A[2],re=A[3],ie=A[4],Q=A[5],ue=A[6],_e=A[7],Ie=ie*re+_e*$+Q*Y-ue*W,Ge=Q*re+_e*W+ue*$-ie*Y,ze=ue*re+_e*Y+ie*W-Q*$,$e=_e*re-ie*$-Q*W-ue*Y;return a.rotateX(L,A,R),L[4]=Ie*(re=L[3])+$e*($=L[0])+Ge*(Y=L[2])-ze*(W=L[1]),L[5]=Ge*re+$e*W+ze*$-Ie*Y,L[6]=ze*re+$e*Y+Ie*W-Ge*$,L[7]=$e*re-Ie*$-Ge*W-ze*Y,L},ve.rotateY=function(L,A,R){var $=-A[0],W=-A[1],Y=-A[2],re=A[3],ie=A[4],Q=A[5],ue=A[6],_e=A[7],Ie=ie*re+_e*$+Q*Y-ue*W,Ge=Q*re+_e*W+ue*$-ie*Y,ze=ue*re+_e*Y+ie*W-Q*$,$e=_e*re-ie*$-Q*W-ue*Y;return a.rotateY(L,A,R),L[4]=Ie*(re=L[3])+$e*($=L[0])+Ge*(Y=L[2])-ze*(W=L[1]),L[5]=Ge*re+$e*W+ze*$-Ie*Y,L[6]=ze*re+$e*Y+Ie*W-Ge*$,L[7]=$e*re-Ie*$-Ge*W-ze*Y,L},ve.rotateZ=function(L,A,R){var $=-A[0],W=-A[1],Y=-A[2],re=A[3],ie=A[4],Q=A[5],ue=A[6],_e=A[7],Ie=ie*re+_e*$+Q*Y-ue*W,Ge=Q*re+_e*W+ue*$-ie*Y,ze=ue*re+_e*Y+ie*W-Q*$,$e=_e*re-ie*$-Q*W-ue*Y;return a.rotateZ(L,A,R),L[4]=Ie*(re=L[3])+$e*($=L[0])+Ge*(Y=L[2])-ze*(W=L[1]),L[5]=Ge*re+$e*W+ze*$-Ie*Y,L[6]=ze*re+$e*Y+Ie*W-Ge*$,L[7]=$e*re-Ie*$-Ge*W-ze*Y,L},ve.rotateByQuatAppend=function(L,A,R){var $=R[0],W=R[1],Y=R[2],re=R[3],ie=A[0],Q=A[1],ue=A[2],_e=A[3];return L[0]=ie*re+_e*$+Q*Y-ue*W,L[1]=Q*re+_e*W+ue*$-ie*Y,L[2]=ue*re+_e*Y+ie*W-Q*$,L[3]=_e*re-ie*$-Q*W-ue*Y,L[4]=(ie=A[4])*re+(_e=A[7])*$+(Q=A[5])*Y-(ue=A[6])*W,L[5]=Q*re+_e*W+ue*$-ie*Y,L[6]=ue*re+_e*Y+ie*W-Q*$,L[7]=_e*re-ie*$-Q*W-ue*Y,L},ve.rotateByQuatPrepend=function(L,A,R){var $=A[0],W=A[1],Y=A[2],re=A[3],ie=R[0],Q=R[1],ue=R[2],_e=R[3];return L[0]=$*_e+re*ie+W*ue-Y*Q,L[1]=W*_e+re*Q+Y*ie-$*ue,L[2]=Y*_e+re*ue+$*Q-W*ie,L[3]=re*_e-$*ie-W*Q-Y*ue,L[4]=$*(_e=R[7])+re*(ie=R[4])+W*(ue=R[6])-Y*(Q=R[5]),L[5]=W*_e+re*Q+Y*ie-$*ue,L[6]=Y*_e+re*ue+$*Q-W*ie,L[7]=re*_e-$*ie-W*Q-Y*ue,L},ve.rotateAroundAxis=function(L,A,R,$){if(Math.abs($)<n.EPSILON)return T(L,A);var W=Math.hypot(R[0],R[1],R[2]);$*=.5;var Y=Math.sin($),re=Y*R[0]/W,ie=Y*R[1]/W,Q=Y*R[2]/W,ue=Math.cos($),_e=A[0],Ie=A[1],Ge=A[2],ze=A[3];L[0]=_e*ue+ze*re+Ie*Q-Ge*ie,L[1]=Ie*ue+ze*ie+Ge*re-_e*Q,L[2]=Ge*ue+ze*Q+_e*ie-Ie*re,L[3]=ze*ue-_e*re-Ie*ie-Ge*Q;var $e=A[4],st=A[5],Fe=A[6],rt=A[7];return L[4]=$e*ue+rt*re+st*Q-Fe*ie,L[5]=st*ue+rt*ie+Fe*re-$e*Q,L[6]=Fe*ue+rt*Q+$e*ie-st*re,L[7]=rt*ue-$e*re-st*ie-Fe*Q,L},ve.add=function(L,A,R){return L[0]=A[0]+R[0],L[1]=A[1]+R[1],L[2]=A[2]+R[2],L[3]=A[3]+R[3],L[4]=A[4]+R[4],L[5]=A[5]+R[5],L[6]=A[6]+R[6],L[7]=A[7]+R[7],L},ve.multiply=P,ve.scale=function(L,A,R){return L[0]=A[0]*R,L[1]=A[1]*R,L[2]=A[2]*R,L[3]=A[3]*R,L[4]=A[4]*R,L[5]=A[5]*R,L[6]=A[6]*R,L[7]=A[7]*R,L},ve.lerp=function(L,A,R,$){var W=1-$;return O(A,R)<0&&($=-$),L[0]=A[0]*W+R[0]*$,L[1]=A[1]*W+R[1]*$,L[2]=A[2]*W+R[2]*$,L[3]=A[3]*W+R[3]*$,L[4]=A[4]*W+R[4]*$,L[5]=A[5]*W+R[5]*$,L[6]=A[6]*W+R[6]*$,L[7]=A[7]*W+R[7]*$,L},ve.invert=function(L,A){var R=k(A);return L[0]=-A[0]/R,L[1]=-A[1]/R,L[2]=-A[2]/R,L[3]=A[3]/R,L[4]=-A[4]/R,L[5]=-A[5]/R,L[6]=-A[6]/R,L[7]=A[7]/R,L},ve.conjugate=function(L,A){return L[0]=-A[0],L[1]=-A[1],L[2]=-A[2],L[3]=A[3],L[4]=-A[4],L[5]=-A[5],L[6]=-A[6],L[7]=A[7],L},ve.normalize=function(L,A){var R=k(A);if(R>0){R=Math.sqrt(R);var $=A[0]/R,W=A[1]/R,Y=A[2]/R,re=A[3]/R,ie=A[4],Q=A[5],ue=A[6],_e=A[7],Ie=$*ie+W*Q+Y*ue+re*_e;L[0]=$,L[1]=W,L[2]=Y,L[3]=re,L[4]=(ie-$*Ie)/R,L[5]=(Q-W*Ie)/R,L[6]=(ue-Y*Ie)/R,L[7]=(_e-re*Ie)/R}return L},ve.str=function(L){return"quat2("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+")"},ve.exactEquals=function(L,A){return L[0]===A[0]&&L[1]===A[1]&&L[2]===A[2]&&L[3]===A[3]&&L[4]===A[4]&&L[5]===A[5]&&L[6]===A[6]&&L[7]===A[7]},ve.equals=function(L,A){var R=L[0],$=L[1],W=L[2],Y=L[3],re=L[4],ie=L[5],Q=L[6],ue=L[7],_e=A[0],Ie=A[1],Ge=A[2],ze=A[3],$e=A[4],st=A[5],Fe=A[6],rt=A[7];return Math.abs(R-_e)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(_e))&&Math.abs($-Ie)<=n.EPSILON*Math.max(1,Math.abs($),Math.abs(Ie))&&Math.abs(W-Ge)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ge))&&Math.abs(Y-ze)<=n.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ze))&&Math.abs(re-$e)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs($e))&&Math.abs(ie-st)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(st))&&Math.abs(Q-Fe)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Fe))&&Math.abs(ue-rt)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(rt))},ve.sqrLen=ve.squaredLength=ve.len=ve.length=ve.dot=ve.mul=ve.setReal=ve.getReal=void 0;var n=h(F()),a=h(Ae()),u=h(me());function g(L){if(typeof WeakMap!="function")return null;var A=new WeakMap,R=new WeakMap;return(g=function($){return $?R:A})(L)}function h(L,A){if(L&&L.__esModule)return L;if(L===null||c(L)!=="object"&&typeof L!="function")return{default:L};var R=g(A);if(R&&R.has(L))return R.get(L);var $={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Y in L)if(Y!=="default"&&Object.prototype.hasOwnProperty.call(L,Y)){var re=W?Object.getOwnPropertyDescriptor(L,Y):null;re&&(re.get||re.set)?Object.defineProperty($,Y,re):$[Y]=L[Y]}return $.default=L,R&&R.set(L,$),$}function v(L,A,R){var $=.5*R[0],W=.5*R[1],Y=.5*R[2],re=A[0],ie=A[1],Q=A[2],ue=A[3];return L[0]=re,L[1]=ie,L[2]=Q,L[3]=ue,L[4]=$*ue+W*Q-Y*ie,L[5]=W*ue+Y*re-$*Q,L[6]=Y*ue+$*ie-W*re,L[7]=-$*re-W*ie-Y*Q,L}function T(L,A){return L[0]=A[0],L[1]=A[1],L[2]=A[2],L[3]=A[3],L[4]=A[4],L[5]=A[5],L[6]=A[6],L[7]=A[7],L}function P(L,A,R){var $=A[0],W=A[1],Y=A[2],re=A[3],ie=R[4],Q=R[5],ue=R[6],_e=R[7],Ie=A[4],Ge=A[5],ze=A[6],$e=A[7],st=R[0],Fe=R[1],rt=R[2],ht=R[3];return L[0]=$*ht+re*st+W*rt-Y*Fe,L[1]=W*ht+re*Fe+Y*st-$*rt,L[2]=Y*ht+re*rt+$*Fe-W*st,L[3]=re*ht-$*st-W*Fe-Y*rt,L[4]=$*_e+re*ie+W*ue-Y*Q+Ie*ht+$e*st+Ge*rt-ze*Fe,L[5]=W*_e+re*Q+Y*ie-$*ue+Ge*ht+$e*Fe+ze*st-Ie*rt,L[6]=Y*_e+re*ue+$*Q-W*ie+ze*ht+$e*rt+Ie*Fe-Ge*st,L[7]=re*_e-$*ie-W*Q-Y*ue+$e*ht-Ie*st-Ge*Fe-ze*rt,L}ve.getReal=a.copy,ve.setReal=a.copy,ve.mul=P;var O=a.dot;ve.dot=O;var x=a.length;ve.length=x,ve.len=x;var k=a.squaredLength;return ve.squaredLength=k,ve.sqrLen=k,ve}var We,ot,Oe={};function Ct(){if(We)return Oe;function c(A){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(A)}We=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.create=u,Oe.clone=function(A){var R=new n.ARRAY_TYPE(2);return R[0]=A[0],R[1]=A[1],R},Oe.fromValues=function(A,R){var $=new n.ARRAY_TYPE(2);return $[0]=A,$[1]=R,$},Oe.copy=function(A,R){return A[0]=R[0],A[1]=R[1],A},Oe.set=function(A,R,$){return A[0]=R,A[1]=$,A},Oe.add=function(A,R,$){return A[0]=R[0]+$[0],A[1]=R[1]+$[1],A},Oe.subtract=g,Oe.multiply=h,Oe.divide=v,Oe.ceil=function(A,R){return A[0]=Math.ceil(R[0]),A[1]=Math.ceil(R[1]),A},Oe.floor=function(A,R){return A[0]=Math.floor(R[0]),A[1]=Math.floor(R[1]),A},Oe.min=function(A,R,$){return A[0]=Math.min(R[0],$[0]),A[1]=Math.min(R[1],$[1]),A},Oe.max=function(A,R,$){return A[0]=Math.max(R[0],$[0]),A[1]=Math.max(R[1],$[1]),A},Oe.round=function(A,R){return A[0]=Math.round(R[0]),A[1]=Math.round(R[1]),A},Oe.scale=function(A,R,$){return A[0]=R[0]*$,A[1]=R[1]*$,A},Oe.scaleAndAdd=function(A,R,$,W){return A[0]=R[0]+$[0]*W,A[1]=R[1]+$[1]*W,A},Oe.distance=T,Oe.squaredDistance=P,Oe.length=O,Oe.squaredLength=x,Oe.negate=function(A,R){return A[0]=-R[0],A[1]=-R[1],A},Oe.inverse=function(A,R){return A[0]=1/R[0],A[1]=1/R[1],A},Oe.normalize=function(A,R){var $=R[0],W=R[1],Y=$*$+W*W;return Y>0&&(Y=1/Math.sqrt(Y)),A[0]=R[0]*Y,A[1]=R[1]*Y,A},Oe.dot=function(A,R){return A[0]*R[0]+A[1]*R[1]},Oe.cross=function(A,R,$){var W=R[0]*$[1]-R[1]*$[0];return A[0]=A[1]=0,A[2]=W,A},Oe.lerp=function(A,R,$,W){var Y=R[0],re=R[1];return A[0]=Y+W*($[0]-Y),A[1]=re+W*($[1]-re),A},Oe.random=function(A,R){R=R||1;var $=2*n.RANDOM()*Math.PI;return A[0]=Math.cos($)*R,A[1]=Math.sin($)*R,A},Oe.transformMat2=function(A,R,$){var W=R[0],Y=R[1];return A[0]=$[0]*W+$[2]*Y,A[1]=$[1]*W+$[3]*Y,A},Oe.transformMat2d=function(A,R,$){var W=R[0],Y=R[1];return A[0]=$[0]*W+$[2]*Y+$[4],A[1]=$[1]*W+$[3]*Y+$[5],A},Oe.transformMat3=function(A,R,$){var W=R[0],Y=R[1];return A[0]=$[0]*W+$[3]*Y+$[6],A[1]=$[1]*W+$[4]*Y+$[7],A},Oe.transformMat4=function(A,R,$){var W=R[0],Y=R[1];return A[0]=$[0]*W+$[4]*Y+$[12],A[1]=$[1]*W+$[5]*Y+$[13],A},Oe.rotate=function(A,R,$,W){var Y=R[0]-$[0],re=R[1]-$[1],ie=Math.sin(W),Q=Math.cos(W);return A[0]=Y*Q-re*ie+$[0],A[1]=Y*ie+re*Q+$[1],A},Oe.angle=function(A,R){var $=A[0],W=A[1],Y=R[0],re=R[1],ie=Math.sqrt($*$+W*W)*Math.sqrt(Y*Y+re*re);return Math.acos(Math.min(Math.max(ie&&($*Y+W*re)/ie,-1),1))},Oe.zero=function(A){return A[0]=0,A[1]=0,A},Oe.str=function(A){return"vec2("+A[0]+", "+A[1]+")"},Oe.exactEquals=function(A,R){return A[0]===R[0]&&A[1]===R[1]},Oe.equals=function(A,R){var $=A[0],W=A[1],Y=R[0],re=R[1];return Math.abs($-Y)<=n.EPSILON*Math.max(1,Math.abs($),Math.abs(Y))&&Math.abs(W-re)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(re))},Oe.forEach=Oe.sqrLen=Oe.sqrDist=Oe.dist=Oe.div=Oe.mul=Oe.sub=Oe.len=void 0;var n=function(A,R){if(A&&A.__esModule)return A;if(A===null||c(A)!=="object"&&typeof A!="function")return{default:A};var $=a(void 0);if($&&$.has(A))return $.get(A);var W={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in A)if(re!=="default"&&Object.prototype.hasOwnProperty.call(A,re)){var ie=Y?Object.getOwnPropertyDescriptor(A,re):null;ie&&(ie.get||ie.set)?Object.defineProperty(W,re,ie):W[re]=A[re]}return W.default=A,$&&$.set(A,W),W}(F());function a(A){if(typeof WeakMap!="function")return null;var R=new WeakMap,$=new WeakMap;return(a=function(W){return W?$:R})(A)}function u(){var A=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(A[0]=0,A[1]=0),A}function g(A,R,$){return A[0]=R[0]-$[0],A[1]=R[1]-$[1],A}function h(A,R,$){return A[0]=R[0]*$[0],A[1]=R[1]*$[1],A}function v(A,R,$){return A[0]=R[0]/$[0],A[1]=R[1]/$[1],A}function T(A,R){return Math.hypot(R[0]-A[0],R[1]-A[1])}function P(A,R){var $=R[0]-A[0],W=R[1]-A[1];return $*$+W*W}function O(A){return Math.hypot(A[0],A[1])}function x(A){var R=A[0],$=A[1];return R*R+$*$}Oe.len=O,Oe.sub=g,Oe.mul=h,Oe.div=v,Oe.dist=T,Oe.sqrDist=P,Oe.sqrLen=x;var k,L=(k=u(),function(A,R,$,W,Y,re){var ie,Q;for(R||(R=2),$||($=0),Q=W?Math.min(W*R+$,A.length):A.length,ie=$;ie<Q;ie+=R)k[0]=A[ie],k[1]=A[ie+1],Y(k,k,re),A[ie]=k[0],A[ie+1]=k[1];return A});return Oe.forEach=L,Oe}function Mt(){if(ot)return M;function c(A){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(A)}ot=1,Object.defineProperty(M,"__esModule",{value:!0}),M.vec4=M.vec3=M.vec2=M.quat2=M.quat=M.mat4=M.mat3=M.mat2d=M.mat2=M.glMatrix=void 0;var n=L(F());M.glMatrix=n;var a=L(D());M.mat2=a;var u=L(ne());M.mat2d=u;var g=L(J());M.mat3=g;var h=L(me());M.mat4=h;var v=L(Ae());M.quat=v;var T=L(Ne());M.quat2=T;var P=L(Ct());M.vec2=P;var O=L(ge());M.vec3=O;var x=L(xe());function k(A){if(typeof WeakMap!="function")return null;var R=new WeakMap,$=new WeakMap;return(k=function(W){return W?$:R})(A)}function L(A,R){if(A&&A.__esModule)return A;if(A===null||c(A)!=="object"&&typeof A!="function")return{default:A};var $=k(R);if($&&$.has(A))return $.get(A);var W={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in A)if(re!=="default"&&Object.prototype.hasOwnProperty.call(A,re)){var ie=Y?Object.getOwnPropertyDescriptor(A,re):null;ie&&(ie.get||ie.set)?Object.defineProperty(W,re,ie):W[re]=A[re]}return W.default=A,$&&$.set(A,W),W}return M.vec4=x,M}var zt,bt,Kt,$t,Le=Mt(),dn=function(){if(bt)return zt;function c(n,a,u,g){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(g-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=a,this.p2x=u,this.p2y=g}return bt=1,zt=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,a){if(a===void 0&&(a=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,g=0;g<8;g++){var h=this.sampleCurveX(u)-n;if(Math.abs(h)<a)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=h/v}var T=0,P=1;for(u=n,g=0;g<20&&(h=this.sampleCurveX(u),!(Math.abs(h-n)<a));g++)n>h?T=u:P=u,u=.5*(P-T)+T;return u},solve:function(n,a){return this.sampleCurveY(this.solveCurveX(n,a))}},zt}(),At=w(dn);function Ke(){if($t)return Kt;function c(n,a){this.x=n,this.y=a}return $t=1,Kt=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,a){return this.clone()._rotateAround(n,a)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var a=n.x-this.x,u=n.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,a){return Math.atan2(this.x*a-this.y*n,this.x*n+this.y*a)},_matMult:function(n){var a=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=a,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var a=Math.cos(n),u=Math.sin(n),g=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=g,this},_rotateAround:function(n,a){var u=Math.cos(n),g=Math.sin(n),h=a.y+g*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-g*(this.y-a.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},Kt}var Be=w(Ke());function Ht(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let a=0;a<c.length;a++)if(!Ht(c[a],n[a]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const a in c)if(!Ht(c[a],n[a]))return!1;return!0}return c===n}const Ut=Math.PI/180,Nt=180/Math.PI;function Et(c){return c*Ut}function Gt(c){return c*Nt}const ln=[[0,0],[1,0],[1,1],[0,1]];function bn(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,a=n*c;return 4*(c<.5?a:3*(c-n)+a-.75)}function _n(c,n,a,u){const g=new At(c,n,a,u);return function(h){return g.solve(h)}}const jn=_n(.25,.1,.25,1);function yt(c,n,a){return Math.min(a,Math.max(n,c))}function kn(c,n,a){return(a=yt((a-c)/(n-c),0,1))*a*(3-2*a)}function qn(c,n,a){const u=a-n,g=((c-n)%u+u)%u+n;return g===n?a:g}function Co(c,n,a){if(!c.length)return a(null,[]);let u=c.length;const g=new Array(c.length);let h=null;c.forEach((v,T)=>{n(v,(P,O)=>{P&&(h=P),g[T]=O,--u==0&&a(h,g)})})}function mo(c,...n){for(const a of n)for(const u in a)c[u]=a[u];return c}let Io=1;function Ho(){return Io++}function ur(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Dt(c,n){c.forEach(a=>{n[a]&&(n[a]=n[a].bind(n))})}function En(c,n){return c.indexOf(n,c.length-n.length)!==-1}function ft(c,n,a){const u={};for(const g in c)u[g]=n.call(this,c[g],g,c);return u}function un(c,n,a){const u={};for(const g in c)n.call(this,c[g],g,c)&&(u[g]=c[g]);return u}function et(c){return Array.isArray(c)?c.map(et):typeof c=="object"&&c?ft(c,et):c}const Mn={};function Bn(c){Mn[c]||(typeof console<"u"&&console.warn(c),Mn[c]=!0)}function Lo(c,n,a){return(a.y-c.y)*(n.x-c.x)>(n.y-c.y)*(a.x-c.x)}function Rr(c){let n=0;for(let a,u,g=0,h=c.length,v=h-1;g<h;v=g++)a=c[g],u=c[v],n+=(u.x-a.x)*(a.y+u.y);return n}function hi([c,n,a]){const u=Et(n+90),g=Et(a);return{x:c*Math.cos(u)*Math.sin(g),y:c*Math.sin(u)*Math.sin(g),z:c*Math.cos(g),azimuthal:n,polar:a}}function Er(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Nr(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,u,g,h)=>{const v=g||h;return n[u]=!v||v.toLowerCase(),""}),n["max-age"]){const a=parseInt(n["max-age"],10);isNaN(a)?delete n["max-age"]:n["max-age"]=a}return n}let Xo=null;function Bi(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function $s(c,n,a,u){for(;n<a;){const g=n+a>>1;c[g]<u?n=g+1:a=g}return n}function Zt(c,n,a,u){for(;n<a;){const g=n+a>>1;c[g]<=u?n=g+1:a=g}return n}function Ee(c){return c>0?1/(1.001-c):1+c}function ke(c){return c>0?1-1/(1.001-c):-c}const qe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!qe.API_URL)return null;try{const c=new URL(qe.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function mt(c){return qe.API_URL_REGEX.test(c)}function it(c){return qe.API_SPRITE_REGEX.test(c)}let xt,qt,kt,Wt,Qt,nn;function gt(){return xt==null&&(xt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),xt}const Yt={now:()=>Wt!==void 0?Wt:performance.now(),setNow(c){Wt=c},restoreNow(){Wt=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:a,height:u}=c;Qt||(Qt=document.createElement("canvas"));const g=Qt.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(a>Qt.width||u>Qt.height)&&(Qt.width=a,Qt.height=u),g.clearRect(-n,-n,a+2*n,u+2*n),g.drawImage(c,0,0,a,u),g.getImageData(-n,-n,a+2*n,u+2*n)},resolveURL:c=>(qt||(qt=document.createElement("a")),qt.href=c,qt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(kt==null&&(kt=window.matchMedia("(prefers-reduced-motion: reduce)")),kt.matches)},hasCanvasFingerprintNoise(){if(nn!==void 0)return nn;if(!gt())return nn=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let a=0;for(let g=0;g<c.width;++g)n.fillStyle=`rgba(${a++},${a++},${a++}, 255)`,n.fillRect(g,0,1,1);const u=n.getImageData(0,0,c.width,c.height);a=0;for(let g=0;g<u.data.length;++g)if(g%4!=3&&a++!==u.data[g])return nn=!0,!0;return nn=!1,!1}};function In(c,n){const a=c.indexOf("?");if(a<0)return`${c}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(c.slice(a));for(const g in n)u.set(g,n[g]);return`${c.slice(0,a)}?${u.toString()}`}function ho(c,n={persistentParams:[]}){const a=c.indexOf("?");if(a<0)return c;const u=new URLSearchParams,g=new URLSearchParams(c.slice(a));for(const v of n.persistentParams){const T=g.get(v);T&&u.set(v,T)}const h=u.toString();return`${c.slice(0,a)}${h.length>0?`?${h}`:""}`}const co="mapbox-tiles";let Oo=500,Eo=50;const cr=["language","worldview","jobid"];let rr,qo;function cn(){try{return caches}catch{}}function Yn(){const c=cn();c&&rr==null&&(rr=c.open(co))}let To=1/0;const $o={supported:!1,testSupport:function(c){!al&&yr&&(ms?za(c):Ar=c)}};let Ar,yr,al=!1,ms=!1;const gs=typeof self<"u"?self:{};function za(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,yr),c.isContextLost())return;$o.supported=!0}catch{}c.deleteTexture(n),al=!0}gs.document&&(yr=gs.document.createElement("img"),yr.onload=function(){Ar&&za(Ar),Ar=null,ms=!0},yr.onerror=function(){al=!0,Ar=null},yr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const lc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(lc);class sl extends Error{constructor(n,a,u){a===401&&mt(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=a,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ll=Er()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,cc=function(c,n){if(!(/^file:/.test(a=c.url)||/^file:/.test(ll())&&!/^\w+:/.test(a))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,g){const h=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:ll(),referrerPolicy:u.referrerPolicy,signal:h.signal});let T=!1,P=!1;const O=(x=v.url).indexOf("sku=")>0&&mt(x);var x;u.type==="json"&&v.headers.set("Accept","application/json");const k=(A,R,$)=>{if(P)return;if(A&&A.message!=="SecurityError"&&Bn(A.toString()),R&&$)return L(R);const W=Date.now();fetch(v).then(Y=>{if(Y.ok){const re=O?Y.clone():null;return L(Y,re,W)}return g(new sl(Y.statusText,Y.status,u.url))}).catch(Y=>{Y.name!=="AbortError"&&g(new Error(`${Y.message} ${u.url}`))})},L=(A,R,$)=>{(u.type==="arrayBuffer"?A.arrayBuffer():u.type==="json"?A.json():A.text()).then(W=>{P||(R&&$&&function(Y,re,ie){if(Yn(),rr==null)return;const Q=Nr(re.headers.get("Cache-Control")||"");if(Q["no-store"])return;const ue={status:re.status,statusText:re.statusText,headers:new Headers};re.headers.forEach((Ge,ze)=>ue.headers.set(ze,Ge)),Q["max-age"]&&ue.headers.set("Expires",new Date(ie+1e3*Q["max-age"]).toUTCString());const _e=ue.headers.get("Expires");if(!_e||new Date(_e).getTime()-ie<42e4)return;let Ie=ho(Y.url,{persistentParams:cr});if(re.status===206){const Ge=Y.headers.get("Range");if(!Ge)return;ue.status=200,Ie=In(Ie,{range:Ge})}(function(Ge,ze){if(qo===void 0)try{new Response(new ReadableStream),qo=!0}catch{qo=!1}qo?ze(Ge.body):Ge.blob().then(ze)})(re,Ge=>{const ze=new Response(($e=re.status)!==200&&$e!==404&&[101,103,204,205,304].includes($e)?null:Ge,ue);var $e;Yn(),rr!=null&&rr.then(st=>st.put(Ie,ze)).catch(st=>Bn(st.message))})}(v,R,$),T=!0,g(null,W,A.headers.get("Cache-Control"),A.headers.get("Expires")))}).catch(W=>{P||g(new Error(W.message))})};return O?function(A,R){if(Yn(),rr==null)return R(null);rr.then($=>{let W=ho(A.url,{persistentParams:cr});const Y=A.headers.get("Range");Y&&(W=In(W,{range:Y})),$.match(W).then(re=>{const ie=function(Q){if(!Q)return!1;const ue=new Date(Q.headers.get("Expires")||0),_e=Nr(Q.headers.get("Cache-Control")||"");return ue>Date.now()&&!_e["no-cache"]}(re);$.delete(W),ie&&$.put(W,re.clone()),R(null,re,ie)}).catch(R)}).catch(R)}(v,k):k(null,null),{cancel:()=>{P=!0,T||h.abort()}}}(c,n);if(Er()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var a;return function(u,g){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const v in u.headers)h.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{g(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let v=h.response;if(u.type==="json")try{v=JSON.parse(h.response)}catch(T){return g(T)}g(null,v,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else g(new sl(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(c,n)},ru=function(c,n){return cc(mo(c,{type:"arrayBuffer"}),n)};function Ya(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const vs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Xa,fa;Xa=[],fa=0;const _s=function(c,n){if($o.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),fa>=qe.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return Xa.push(h),h}fa++;let a=!1;const u=()=>{if(!a)for(a=!0,fa--;Xa.length&&fa<qe.MAX_PARALLEL_IMAGE_REQUESTS;){const h=Xa.shift(),{requestParameters:v,callback:T,cancelled:P}=h;P||(h.cancel=_s(v,T).cancel)}},g=ru(c,(h,v,T,P)=>{u(),h?n(h):v&&(self.createImageBitmap?function(O,x){const k=new Blob([new Uint8Array(O)],{type:"image/png"});createImageBitmap(k).then(L=>{x(null,L)}).catch(L=>{x(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(O,x)=>n(O,x,T,P)):function(O,x){const k=new Image;k.onload=()=>{x(null,k),URL.revokeObjectURL(k.src),k.onload=null,requestAnimationFrame(()=>{k.src=vs})},k.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new Blob([new Uint8Array(O)],{type:"image/png"});k.src=O.byteLength?URL.createObjectURL(L):vs}(v,(O,x)=>n(O,x,T,P)))});return{cancel:()=>{g.cancel(),u()}}};var iu,Dh,zh,Vs={exports:{}},uc={exports:{}},Z={exports:{}},fe=function(){if(zh)return Vs.exports;zh=1;var c=(iu||(iu=1,uc.exports=function(a,u){var g,h,v,T,P,O,x,k;for(h=a.length-(g=3&a.length),v=u,P=3432918353,O=461845907,k=0;k<h;)x=255&a.charCodeAt(k)|(255&a.charCodeAt(++k))<<8|(255&a.charCodeAt(++k))<<16|(255&a.charCodeAt(++k))<<24,++k,v=27492+(65535&(T=5*(65535&(v=(v^=x=(65535&(x=(x=(65535&x)*P+(((x>>>16)*P&65535)<<16)&4294967295)<<15|x>>>17))*O+(((x>>>16)*O&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(x=0,g){case 3:x^=(255&a.charCodeAt(k+2))<<16;case 2:x^=(255&a.charCodeAt(k+1))<<8;case 1:v^=x=(65535&(x=(x=(65535&(x^=255&a.charCodeAt(k)))*P+(((x>>>16)*P&65535)<<16)&4294967295)<<15|x>>>17))*O+(((x>>>16)*O&65535)<<16)&4294967295}return v^=a.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),uc.exports),n=(Dh||(Dh=1,Z.exports=function(a,u){for(var g,h=a.length,v=u^h,T=0;h>=4;)g=1540483477*(65535&(g=255&a.charCodeAt(T)|(255&a.charCodeAt(++T))<<8|(255&a.charCodeAt(++T))<<16|(255&a.charCodeAt(++T))<<24))+((1540483477*(g>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),h-=4,++T;switch(h){case 3:v^=(255&a.charCodeAt(T+2))<<16;case 2:v^=(255&a.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&a.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Z.exports);return Vs.exports=c,Vs.exports.murmur3=c,Vs.exports.murmur2=n,Vs.exports}(),Ue=w(fe);class wt{constructor(n,...a){mo(this,a[0]||{}),this.type=n}}class Bt extends wt{constructor(n,a={}){super("error",mo({error:n},a))}}function Vt(c,n,a){a[c]&&a[c].indexOf(n)!==-1||(a[c]=a[c]||[],a[c].push(n))}function on(c,n,a){if(a&&a[c]){const u=a[c].indexOf(n);u!==-1&&a[c].splice(u,1)}}class Kn{on(n,a){return this._listeners=this._listeners||{},Vt(n,a,this._listeners),this}off(n,a){return on(n,a,this._listeners),on(n,a,this._oneTimeListeners),this}once(n,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Vt(n,a,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,a){const u=typeof n=="string"?new wt(n,a):n,g=u.type;if(this.listens(g)){u.target=this;const h=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const P of h)P.call(this,u);const v=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const P of v)on(g,P,this._oneTimeListeners),P.call(this,u);const T=this._eventedParent;T&&(mo(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(u))}else u instanceof Bt&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,a){return this._eventedParent=n,this._eventedParentData=a,this}}var so,zn={},yo=function(){if(so)return zn;so=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(h){return(h=Math.round(h))<0?0:h>255?255:h}function a(h){return n(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(v=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:v>1?1:v;var v}function g(h,v,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?h+(v-h)*T*6:2*T<1?v:3*T<2?h+(v-h)*(2/3-T)*6:h}try{zn.parseCSSColor=function(h){var v,T=h.replace(/ /g,"").toLowerCase();if(T in c)return c[T].slice();if(T[0]==="#")return T.length===4?(v=parseInt(T.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:T.length===7&&(v=parseInt(T.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var P=T.indexOf("("),O=T.indexOf(")");if(P!==-1&&O+1===T.length){var x=T.substr(0,P),k=T.substr(P+1,O-(P+1)).split(","),L=1;switch(x){case"rgba":if(k.length!==4)return null;L=u(k.pop());case"rgb":return k.length!==3?null:[a(k[0]),a(k[1]),a(k[2]),L];case"hsla":if(k.length!==4)return null;L=u(k.pop());case"hsl":if(k.length!==3)return null;var A=(parseFloat(k[0])%360+360)%360/360,R=u(k[1]),$=u(k[2]),W=$<=.5?$*(R+1):$+R-$*R,Y=2*$-W;return[n(255*g(Y,W,A+1/3)),n(255*g(Y,W,A)),n(255*g(Y,W,A-1/3)),L];default:return null}}return null}}catch{}return zn}();class On{constructor(n,a,u,g=1){this.r=n,this.g=a,this.b=u,this.a=g}static parse(n){if(!n)return;if(n instanceof On)return n;if(typeof n!="string")return;const a=yo.parseCSSColor(n);return a?new On(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[n,a,u,g]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(a)},${Math.round(u)},${g})`}toRenderColor(n){const{r:a,g:u,b:g,a:h}=this;return new dr(n,a,u,g,h)}}class dr{constructor(n,a,u,g,h){if(n){const v=n.image.height,T=v*v;a=h===0?0:a/h*(v-1),u=h===0?0:u/h*(v-1),g=h===0?0:g/h*(v-1);const P=Math.floor(a),O=Math.floor(u),x=Math.floor(g),k=Math.ceil(a),L=Math.ceil(u),A=Math.ceil(g),R=a-P,$=u-O,W=g-x,Y=n.image.data,re=4*(P+O*T+x*v),ie=4*(P+O*T+A*v),Q=4*(P+L*T+x*v),ue=4*(P+L*T+A*v),_e=4*(k+O*T+x*v),Ie=4*(k+O*T+A*v),Ge=4*(k+L*T+x*v),ze=4*(k+L*T+A*v);if(re<0||ze>=Y.length)throw new Error("out of range");this.r=uo(uo(uo(Y[re],Y[ie],W),uo(Y[Q],Y[ue],W),$),uo(uo(Y[_e],Y[Ie],W),uo(Y[Ge],Y[ze],W),$),R)/255*h,this.g=uo(uo(uo(Y[re+1],Y[ie+1],W),uo(Y[Q+1],Y[ue+1],W),$),uo(uo(Y[_e+1],Y[Ie+1],W),uo(Y[Ge+1],Y[ze+1],W),$),R)/255*h,this.b=uo(uo(uo(Y[re+2],Y[ie+2],W),uo(Y[Q+2],Y[ue+2],W),$),uo(uo(Y[_e+2],Y[Ie+2],W),uo(Y[Ge+2],Y[ze+2],W),$),R)/255*h,this.a=h}else this.r=a,this.g=u,this.b=g,this.a=h}toArray(){const{r:n,g:a,b:u,a:g}=this;return g===0?[0,0,0,0]:[255*n/g,255*a/g,255*u/g,g]}toArray01(){const{r:n,g:a,b:u,a:g}=this;return g===0?[0,0,0,0]:[n/g,a/g,u/g,g]}toArray01Scaled(n){const{r:a,g:u,b:g,a:h}=this;return h===0?[0,0,0]:[a/h*n,u/h*n,g/h*n]}toArray01PremultipliedAlpha(){const{r:n,g:a,b:u,a:g}=this;return[n,a,u,g]}toArray01Linear(){const{r:n,g:a,b:u,a:g}=this;return g===0?[0,0,0,0]:[Math.pow(n/g,2.2),Math.pow(a/g,2.2),Math.pow(u/g,2.2),g]}}function uo(c,n,a){return c*(1-a)+n*a}function hr(c,n,a){return c.map((u,g)=>uo(u,n[g],a))}On.black=new On(0,0,0,1),On.white=new On(1,1,1,1),On.transparent=new On(0,0,0,0),On.red=new On(1,0,0,1),On.blue=new On(0,0,1,1);var Ti=Object.freeze({__proto__:null,array:hr,color:function(c,n,a){return new On(uo(c.r,n.r,a),uo(c.g,n.g,a),uo(c.b,n.b,a),uo(c.a,n.a,a))},number:uo});function $n(c,...n){for(const a of n)for(const u in a)c[u]=a[u];return c}class ko extends Error{constructor(n,a){super(a),this.message=a,this.key=n}}class oi{constructor(n,a=[]){this.parent=n,this.bindings={};for(const[u,g]of a)this.bindings[u]=g}concat(n){return new oi(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const yi={kind:"null"},Hn={kind:"number"},fr={kind:"string"},br={kind:"boolean"},zr={kind:"color"},sa={kind:"object"},xr={kind:"value"},Ja={kind:"collator"},dc={kind:"formatted"},hc={kind:"resolvedImage"};function pa(c,n){return{kind:"array",itemType:c,N:n}}function xi(c){if(c.kind==="array"){const n=xi(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const Fh=[yi,Hn,fr,br,zr,dc,sa,pa(xr),hc];function fc(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!fc(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const a of Fh)if(!fc(a,n))return null}}return`Expected ${xi(c)} but found ${xi(n)} instead.`}function au(c,n){return n.some(a=>a.kind===c.kind)}function Us(c,n){return n.some(a=>a==="null"?c===null:a==="array"?Array.isArray(c):a==="object"?c&&!Array.isArray(c)&&typeof c=="object":a===typeof c)}class gd{constructor(n,a,u){this.sensitivity=n?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,a){return this.collator.compare(n,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ia{constructor(n,a,u,g,h){this.text=n.normalize?n.normalize():n,this.image=a,this.scale=u,this.fontStack=g,this.textColor=h}}class la{constructor(n){this.sections=n}static fromString(n){return new la([new Ia(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary.length!==0)}static factory(n){return n instanceof la?n:la.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const a of this.sections){if(a.image){n.push(["image",a.image.namePrimary]);continue}n.push(a.text);const u={};a.fontStack&&(u["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(u["font-scale"]=a.scale),a.textColor&&(u["text-color"]=["rgba"].concat(a.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class ma{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),this.available=n.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(n,a){return n?new ma({namePrimary:n,nameSecondary:a,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function ep(c,n,a,u){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof a=="number"&&a>=0&&a<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,n,a,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,n,a,u]:[c,n,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Il(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof On||c instanceof gd||c instanceof la||c instanceof ma)return!0;if(Array.isArray(c)){for(const n of c)if(!Il(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!Il(c[n]))return!1;return!0}return!1}function Ci(c){if(c===null)return yi;if(typeof c=="string")return fr;if(typeof c=="boolean")return br;if(typeof c=="number")return Hn;if(c instanceof On)return zr;if(c instanceof gd)return Ja;if(c instanceof la)return dc;if(c instanceof ma)return hc;if(Array.isArray(c)){const n=c.length;let a;for(const u of c){const g=Ci(u);if(a){if(a===g)continue;a=xr;break}a=g}return pa(a||xr,n)}return sa}function ca(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof On||c instanceof la||c instanceof ma?c.toString():JSON.stringify(c)}class Qa{constructor(n,a){this.type=n,this.value=a}static parse(n,a){if(n.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Il(n[1]))return a.error("invalid value");const u=n[1];let g=Ci(u);const h=a.expectedType;return g.kind!=="array"||g.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(g=h),new Qa(g,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof On?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof la?this.value.serialize():this.value}}class _i{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const vd={string:fr,number:Hn,boolean:br,object:sa};class es{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");let u,g=1;const h=n[0];if(h==="array"){let T,P;if(n.length>2){const O=n[1];if(typeof O!="string"||!(O in vd)||O==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);T=vd[O],g++}else T=xr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return a.error('The length argument to "array" must be a positive integer literal',2);P=n[2],g++}u=pa(T,P)}else u=vd[h];const v=[];for(;g<n.length;g++){const T=a.parse(n[g],g,xr);if(!T)return null;v.push(T)}return new es(u,v)}evaluate(n){for(let a=0;a<this.args.length;a++){const u=this.args[a].evaluate(n);if(!fc(this.type,Ci(u)))return u;if(a===this.args.length-1)throw new _i(`The expression ${JSON.stringify(this.args[a].serialize())} evaluated to ${xi(Ci(u))} but was expected to be of type ${xi(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,a=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){a.push(u.kind);const g=n.N;(typeof g=="number"||this.args.length>1)&&a.push(g)}}return a.concat(this.args.map(u=>u.serialize()))}}class su{constructor(n){this.type=dc,this.sections=n}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return a.error("First argument must be an image or text section.");const g=[];let h=!1;for(let v=1;v<=n.length-1;++v){const T=n[v];if(h&&typeof T=="object"&&!Array.isArray(T)){h=!1;let P=null;if(T["font-scale"]&&(P=a.parseObjectValue(T["font-scale"],v,"font-scale",Hn),!P))return null;let O=null;if(T["text-font"]&&(O=a.parseObjectValue(T["text-font"],v,"text-font",pa(fr)),!O))return null;let x=null;if(T["text-color"]&&(x=a.parseObjectValue(T["text-color"],v,"text-color",zr),!x))return null;const k=g[g.length-1];k.scale=P,k.font=O,k.textColor=x}else{const P=a.parse(n[v],v,xr);if(!P)return null;const O=P.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,g.push({content:P,scale:null,font:null,textColor:null})}}return new su(g)}evaluate(n){return new la(this.sections.map(a=>{const u=a.content.evaluate(n);return Ci(u)===hc?new Ia("",u,null,null,null):new Ia(ca(u),null,a.scale?a.scale.evaluate(n):null,a.font?a.font.evaluate(n).join(","):null,a.textColor?a.textColor.evaluate(n):null)}))}eachChild(n){for(const a of this.sections)n(a.content),a.scale&&n(a.scale),a.font&&n(a.font),a.textColor&&n(a.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const a of this.sections){n.push(a.content.serialize());const u={};a.scale&&(u["font-scale"]=a.scale.serialize()),a.font&&(u["text-font"]=a.font.serialize()),a.textColor&&(u["text-color"]=a.textColor.serialize()),n.push(u)}return n}}class Al{constructor(n,a){this.type=hc,this.inputPrimary=n,this.inputSecondary=a}static parse(n,a){if(n.length<2)return a.error("Expected two or more arguments.");const u=a.parse(n[1],1,fr);if(!u)return a.error("No image name provided.");if(n.length===2)return new Al(u);const g=a.parse(n[2],1,fr);return g?new Al(u,g):a.error("Secondary image variant is not a string.")}evaluate(n){const a=ma.fromString(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0);return a&&n.availableImages&&(a.available=n.availableImages.indexOf(a.namePrimary)>-1,a.nameSecondary&&a.available&&n.availableImages&&(a.available=n.availableImages.indexOf(a.nameSecondary)>-1)),a}eachChild(n){n(this.inputPrimary),this.inputSecondary&&n(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function js(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const Fu={"to-boolean":br,"to-color":zr,"to-number":Hn,"to-string":fr};class Hs{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expected at least one argument.");const u=n[0],g=[];let h=yi;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const v=n[1].length;if(a.expectedType){if(a.expectedType.kind!=="array")return a.error(`Expected ${a.expectedType.kind} but found array.`);h=pa(a.expectedType.itemType,v)}else{if(!(v>0&&Il(n[1][0])))return null;h=pa(Ci(n[1][0]),v)}for(let T=0;T<v;T++){const P=n[1][T];let O;if(js(P)==="array")O=a.parse(P,void 0,h.itemType);else{const x=js(P);if(x!==h.itemType.kind)return a.error(`Expected ${h.itemType.kind} but found ${x}.`);O=a.registry.literal.parse(["literal",P===void 0?null:P],a)}if(!O)return null;g.push(O)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return a.error("Expected one argument.");h=Fu[u];for(let v=1;v<n.length;v++){const T=a.parse(n[v],v,xr);if(!T)return null;g.push(T)}}return new Hs(h,g)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let a,u;for(const g of this.args){if(a=g.evaluate(n),u=null,a instanceof On)return a;if(typeof a=="string"){const h=n.parseColor(a);if(h)return h}else if(Array.isArray(a)&&(u=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:ep(a[0],a[1],a[2],a[3]),!u))return new On(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new _i(u||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const u of this.args){if(a=u.evaluate(n),a===null)return 0;const g=Number(a);if(!isNaN(g))return g}throw new _i(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?la.fromString(ca(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?ma.fromString(ca(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(a=>a.evaluate(n)):ca(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new su([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Al(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(a=>{n.push(a.serialize())}),n}}const tg=["Unknown","Point","LineString","Polygon"];class kl{constructor(n,a){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=a}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?tg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:g}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-n[0])+this.featureDistanceData.bearing[1]*(g*a-n[1])}return 0}parseColor(n){let a=this._parseColorCache[n];return a||(a=this._parseColorCache[n]=On.parse(n)),a}getConfig(n){return this.options?this.options.get(n):null}}class va{constructor(n,a,u,g,h){this.name=n,this.type=a,this._evaluate=u,this.args=g,this._overloadIndex=h}evaluate(n){if(!this._evaluate){const a=va.definitions[this.name];this._evaluate=Array.isArray(a)?a[2]:a.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,a){const u=n[0],g=va.definitions[u];if(!g)return a.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(g)?g[0]:g.type,v=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=[];let P=null,O=-1;for(const[x,k]of v){if(Array.isArray(x)&&x.length!==n.length-1)continue;T.push(x),O++,P=new Ks(a.registry,a.path,null,a.scope,void 0,a._scope,a.options);const L=[];let A=!1;for(let R=1;R<n.length;R++){const $=n[R],W=Array.isArray(x)?x[R-1]:x.type,Y=P.parse($,1+L.length,W);if(!Y){A=!0;break}L.push(Y)}if(!A)if(Array.isArray(x)&&x.length!==L.length)P.error(`Expected ${x.length} arguments, but found ${L.length} instead.`);else{for(let R=0;R<L.length;R++){const $=Array.isArray(x)?x[R]:x.type,W=L[R];P.concat(R+1).checkSubtype($,W.type)}if(P.errors.length===0)return new va(u,h,k,L,O)}}if(T.length===1)a.errors.push(...P.errors);else{const x=(T.length?T:v.map(([L])=>L)).map(ng).join(" | "),k=[];for(let L=1;L<n.length;L++){const A=a.parse(n[L],1+k.length);if(!A)return null;k.push(xi(A.type))}a.error(`Expected arguments of type ${x}, but found (${k.join(", ")}) instead.`)}return null}static register(n,a){va.definitions=a;for(const u in a)n[u]=va}}function ng(c){return Array.isArray(c)?`(${c.map(xi).join(", ")})`:`(${xi(c.type)}...)`}class _d{constructor(n,a,u){this.type=Ja,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=a}static parse(n,a){if(n.length!==2)return a.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return a.error("Collator options argument must be an object.");const g=u["case-sensitive"]===void 0?a.parse(!1,1,br):a.parseObjectValue(u["case-sensitive"],1,"case-sensitive",br);if(!g)return null;const h=u["diacritic-sensitive"]===void 0?a.parse(!1,1,br):a.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",br);if(!h)return null;let v=null;return u.locale&&(v=a.parseObjectValue(u.locale,1,"locale",fr),!v)?null:new _d(g,h,v)}evaluate(n){return new gd(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function yd(c,n,a=0,u=c.length-1,g=Pl){for(;u>a;){if(u-a>600){const P=u-a+1,O=n-a+1,x=Math.log(P),k=.5*Math.exp(2*x/3),L=.5*Math.sqrt(x*k*(P-k)/P)*(O-P/2<0?-1:1);yd(c,n,Math.max(a,Math.floor(n-O*k/P+L)),Math.min(u,Math.floor(n+(P-O)*k/P+L)),g)}const h=c[n];let v=a,T=u;for(Gs(c,a,n),g(c[u],h)>0&&Gs(c,a,u);v<T;){for(Gs(c,v,T),v++,T--;g(c[v],h)<0;)v++;for(;g(c[T],h)>0;)T--}g(c[a],h)===0?Gs(c,a,T):(T++,Gs(c,T,u)),T<=n&&(a=T+1),n<=T&&(u=T-1)}}function Gs(c,n,a){const u=c[n];c[n]=c[a],c[a]=u}function Pl(c,n){return c<n?-1:c>n?1:0}function Bh(c){let n=0;for(let a,u,g=0,h=c.length,v=h-1;g<h;v=g++)a=c[g],u=c[v],n+=(u.x-a.x)*(a.y+u.y);return n}function pc(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function ys(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function og(c,n,a){const u=c[0]-n[0],g=c[1]-n[1],h=c[0]-a[0],v=c[1]-a[1];return u*v-h*g==0&&u*h<=0&&g*v<=0}function lu(c,n,a=!1){let u=!1;for(let T=0,P=n.length;T<P;T++){const O=n[T];for(let x=0,k=O.length,L=k-1;x<k;L=x++){const A=O[L],R=O[x];if(og(c,A,R))return a;(h=A)[1]>(g=c)[1]!=(v=R)[1]>g[1]&&g[0]<(v[0]-h[0])*(g[1]-h[1])/(v[1]-h[1])+h[0]&&(u=!u)}}var g,h,v;return u}function tp(c,n,a,u){const g=u[0]-a[0],h=u[1]-a[1],v=(c[0]-a[0])*h-g*(c[1]-a[1]),T=(n[0]-a[0])*h-g*(n[1]-a[1]);return v>0&&T<0||v<0&&T>0}function bd(c,n,a,u){return(g=[u[0]-a[0],u[1]-a[1]])[0]*(h=[n[0]-c[0],n[1]-c[1]])[1]-g[1]*h[0]!=0&&!(!tp(c,n,a,u)||!tp(a,u,c,n));var g,h}const Fa=8192;function ir(c,n){const a=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,n.z);return[Math.round(a*g*Fa),Math.round(u*g*Fa)]}function bo(c,n){for(let a=0;a<n.length;a++)if(lu(c,n[a]))return!0;return!1}function cl(c,n,a){for(const u of a)for(let g=0,h=u.length,v=h-1;g<h;v=g++)if(bd(c,n,u[v],u[g]))return!0;return!1}function Do(c,n){for(let a=0;a<c.length;++a)if(!lu(c[a],n))return!1;for(let a=0;a<c.length-1;++a)if(cl(c[a],c[a+1],n))return!1;return!0}function ul(c,n){for(let a=0;a<n.length;a++)if(Do(c,n[a]))return!0;return!1}function Rl(c,n,a){const u=[];for(let g=0;g<c.length;g++){const h=[];for(let v=0;v<c[g].length;v++){const T=ir(c[g][v],a);pc(n,T),h.push(T)}u.push(h)}return u}function Po(c,n,a){const u=[];for(let g=0;g<c.length;g++){const h=Rl(c[g],n,a);u.push(h)}return u}function Nh(c,n,a,u){if(c[0]<a[0]||c[0]>a[2]){const g=.5*u;let h=c[0]-a[0]>g?-u:a[0]-c[0]>g?u:0;h===0&&(h=c[0]-a[2]>g?-u:a[2]-c[0]>g?u:0),c[0]+=h}pc(n,c)}function mc(c,n,a,u){const g=Math.pow(2,u.z)*Fa,h=[u.x*Fa,u.y*Fa],v=[];if(!c)return v;for(const T of c)for(const P of T){const O=[P.x+h[0],P.y+h[1]];Nh(O,n,a,g),v.push(O)}return v}function gc(c,n,a,u){const g=Math.pow(2,u.z)*Fa,h=[u.x*Fa,u.y*Fa],v=[];if(!c)return v;for(const P of c){const O=[];for(const x of P){const k=[x.x+h[0],x.y+h[1]];pc(n,k),O.push(k)}v.push(O)}if(n[2]-n[0]<=g/2){(T=n)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const P of v)for(const O of P)Nh(O,n,a,g)}var T;return v}class dl{constructor(n,a){this.type=br,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Il(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let g=0;g<u.features.length;++g){const h=u.features[g].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new dl(u,u.features[g].geometry)}else if(u.type==="Feature"){const g=u.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new dl(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new dl(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(a,u){const g=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=Rl(u.coordinates,h,v),P=mc(a.geometry(),g,h,v);if(!ys(g,h))return!1;for(const O of P)if(!lu(O,T))return!1}if(u.type==="MultiPolygon"){const T=Po(u.coordinates,h,v),P=mc(a.geometry(),g,h,v);if(!ys(g,h))return!1;for(const O of P)if(!bo(O,T))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(a,u){const g=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=Rl(u.coordinates,h,v),P=gc(a.geometry(),g,h,v);if(!ys(g,h))return!1;for(const O of P)if(!Do(O,T))return!1}if(u.type==="MultiPolygon"){const T=Po(u.coordinates,h,v),P=gc(a.geometry(),g,h,v);if(!ys(g,h))return!1;for(const O of P)if(!ul(O,T))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Ll={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},ua=1/298.257223563,xd=ua*(2-ua),vc=Math.PI/180;class _c{static fromTile(n,a,u){const g=Math.PI*(1-2*(n+.5)/Math.pow(2,a)),h=Math.atan(.5*(Math.exp(g)-Math.exp(-g)))/vc;return new _c(h,u)}static get units(){return Ll}constructor(n,a){if(n===void 0)throw new Error("No latitude given.");if(a&&!Ll[a])throw new Error(`Unknown unit ${a}. Use one of: ${Object.keys(Ll).join(", ")}`);const u=6378.137*vc*(a?Ll[a]:1),g=Math.cos(n*vc),h=1/(1-xd*(1-g*g)),v=Math.sqrt(h);this.kx=u*v*g,this.ky=u*v*h*(1-xd)}distance(n,a){const u=wi(n[0]-a[0])*this.kx,g=(n[1]-a[1])*this.ky;return Math.sqrt(u*u+g*g)}bearing(n,a){const u=wi(a[0]-n[0])*this.kx;return Math.atan2(u,(a[1]-n[1])*this.ky)/vc}destination(n,a,u){const g=u*vc;return this.offset(n,Math.sin(g)*a,Math.cos(g)*a)}offset(n,a,u){return[n[0]+a/this.kx,n[1]+u/this.ky]}lineDistance(n){let a=0;for(let u=0;u<n.length-1;u++)a+=this.distance(n[u],n[u+1]);return a}area(n){let a=0;for(let u=0;u<n.length;u++){const g=n[u];for(let h=0,v=g.length,T=v-1;h<v;T=h++)a+=wi(g[h][0]-g[T][0])*(g[h][1]+g[T][1])*(u?-1:1)}return Math.abs(a)/2*this.kx*this.ky}along(n,a){let u=0;if(a<=0)return n[0];for(let g=0;g<n.length-1;g++){const h=n[g],v=n[g+1],T=this.distance(h,v);if(u+=T,u>a)return Aa(h,v,(a-(u-T))/T)}return n[n.length-1]}pointToSegmentDistance(n,a,u){let[g,h]=a,v=wi(u[0]-g)*this.kx,T=(u[1]-h)*this.ky;if(v!==0||T!==0){const P=(wi(n[0]-g)*this.kx*v+(n[1]-h)*this.ky*T)/(v*v+T*T);P>1?(g=u[0],h=u[1]):P>0&&(g+=v/this.kx*P,h+=T/this.ky*P)}return v=wi(n[0]-g)*this.kx,T=(n[1]-h)*this.ky,Math.sqrt(v*v+T*T)}pointOnLine(n,a){let u=1/0,g=n[0][0],h=n[0][1],v=0,T=0;for(let P=0;P<n.length-1;P++){let O=n[P][0],x=n[P][1],k=wi(n[P+1][0]-O)*this.kx,L=(n[P+1][1]-x)*this.ky,A=0;k===0&&L===0||(A=(wi(a[0]-O)*this.kx*k+(a[1]-x)*this.ky*L)/(k*k+L*L),A>1?(O=n[P+1][0],x=n[P+1][1]):A>0&&(O+=k/this.kx*A,x+=L/this.ky*A)),k=wi(a[0]-O)*this.kx,L=(a[1]-x)*this.ky;const R=k*k+L*L;R<u&&(u=R,g=O,h=x,v=P,T=A)}return{point:[g,h],index:v,t:Math.max(0,Math.min(1,T))}}lineSlice(n,a,u){let g=this.pointOnLine(u,n),h=this.pointOnLine(u,a);if(g.index>h.index||g.index===h.index&&g.t>h.t){const O=g;g=h,h=O}const v=[g.point],T=g.index+1,P=h.index;!yc(u[T],v[0])&&T<=P&&v.push(u[T]);for(let O=T+1;O<=P;O++)v.push(u[O]);return yc(u[P],h.point)||v.push(h.point),v}lineSliceAlong(n,a,u){let g=0;const h=[];for(let v=0;v<u.length-1;v++){const T=u[v],P=u[v+1],O=this.distance(T,P);if(g+=O,g>n&&h.length===0&&h.push(Aa(T,P,(n-(g-O))/O)),g>=a)return h.push(Aa(T,P,(a-(g-O))/O)),h;g>n&&h.push(P)}return h}bufferPoint(n,a){const u=a/this.ky,g=a/this.kx;return[n[0]-g,n[1]-u,n[0]+g,n[1]+u]}bufferBBox(n,a){const u=a/this.ky,g=a/this.kx;return[n[0]-g,n[1]-u,n[2]+g,n[3]+u]}insideBBox(n,a){return wi(n[0]-a[0])>=0&&wi(n[0]-a[2])<=0&&n[1]>=a[1]&&n[1]<=a[3]}}function yc(c,n){return c[0]===n[0]&&c[1]===n[1]}function Aa(c,n,a){const u=wi(n[0]-c[0]);return[c[0]+u*a,c[1]+(n[1]-c[1])*a]}function wi(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class Ws{constructor(n=[],a=(u,g)=>u<g?-1:u>g?1:0){if(this.data=n,this.length=this.data.length,this.compare=a,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:a,compare:u}=this,g=a[n];for(;n>0;){const h=n-1>>1,v=a[h];if(u(g,v)>=0)break;a[n]=v,n=h}a[n]=g}_down(n){const{data:a,compare:u}=this,g=this.length>>1,h=a[n];for(;n<g;){let v=1+(n<<1);const T=v+1;if(T<this.length&&u(a[T],a[v])<0&&(v=T),u(a[v],h)>=0)break;a[n]=a[v],n=v}a[n]=h}}var Nn=8192;function Ol(c,n){return n.dist-c.dist}const bc=100,wd=50;function xc(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==c[a])return!1;return!0}function cu(c){return c[1]-c[0]+1}function qs(c,n){const a=c[1]>=c[0]&&c[1]<n;return a||console.warn("Distance Expression: Index is out of range"),a}function Sd(c,n){if(c[0]>c[1])return[null,null];const a=cu(c);if(n){if(a===2)return[c,null];const u=Math.floor(a/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(a===1)return[c,null];const u=Math.floor(a/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function ka(c,n){const a=[1/0,1/0,-1/0,-1/0];if(!qs(n,c.length))return a;for(let u=n[0];u<=n[1];++u)pc(a,c[u]);return a}function Dl(c){const n=[1/0,1/0,-1/0,-1/0];for(let a=0;a<c.length;++a)for(let u=0;u<c[a].length;++u)pc(n,c[a][u]);return n}function wc(c,n,a){if(xc(c)||xc(n))return NaN;let u=0,g=0;return c[2]<n[0]&&(u=n[0]-c[2]),c[0]>n[2]&&(u=c[0]-n[2]),c[1]>n[3]&&(g=c[1]-n[3]),c[3]<n[1]&&(g=n[1]-c[3]),a.distance([0,0],[u,g])}function np(c){return 360*c-180}function an(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Tn(c,n){const a=Math.pow(2,n.z),u=(c.y/Nn+n.y)/a;return[np((c.x/Nn+n.x)/a),an(u)]}function vo(c,n){const a=[];for(let u=0;u<c.length;++u)a.push(Tn(c[u],n));return a}function Jo(c,n,a){const u=a.pointOnLine(n,c).point;return a.distance(c,u)}function Si(c,n,a,u,g){const h=a.slice(u[0],u[1]+1);let v=1/0;for(let T=n[0];T<=n[1];++T)if((v=Math.min(v,Jo(c[T],h,g)))===0)return 0;return v}function Lr(c,n,a,u,g){const h=Math.min(g.pointToSegmentDistance(c,a,u),g.pointToSegmentDistance(n,a,u)),v=Math.min(g.pointToSegmentDistance(a,c,n),g.pointToSegmentDistance(u,c,n));return Math.min(h,v)}function Oi(c,n,a,u,g){if(!qs(n,c.length)||!qs(u,a.length))return NaN;let h=1/0;for(let v=n[0];v<n[1];++v)for(let T=u[0];T<u[1];++T){if(bd(c[v],c[v+1],a[T],a[T+1]))return 0;h=Math.min(h,Lr(c[v],c[v+1],a[T],a[T+1],g))}return h}function Hi(c,n,a,u,g){if(!qs(n,c.length)||!qs(u,a.length))return NaN;let h=1/0;for(let v=n[0];v<=n[1];++v)for(let T=u[0];T<=u[1];++T)if((h=Math.min(h,g.distance(c[v],a[T])))===0)return h;return h}function ts(c,n,a){if(lu(c,n,!0))return 0;let u=1/0;for(const g of n){const h=g.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(g[0]!==g[h-1]&&(u=Math.min(u,a.pointToSegmentDistance(c,g[h-1],g[0])))===0||(u=Math.min(u,Jo(c,g,a)))===0)return u}return u}function Zi(c,n,a,u){if(!qs(n,c.length))return NaN;for(let h=n[0];h<=n[1];++h)if(lu(c[h],a,!0))return 0;let g=1/0;for(let h=n[0];h<n[1];++h)for(const v of a)for(let T=0,P=v.length,O=P-1;T<P;O=T++){if(bd(c[h],c[h+1],v[O],v[T]))return 0;g=Math.min(g,Lr(c[h],c[h+1],v[O],v[T],u))}return g}function Gi(c,n){for(const a of c)for(let u=0;u<=a.length-1;++u)if(lu(a[u],n,!0))return!0;return!1}function bs(c,n,a,u=1/0){const g=Dl(c),h=Dl(n);if(u!==1/0&&wc(g,h,a)>=u)return u;if(ys(g,h)){if(Gi(c,n))return 0}else if(Gi(n,c))return 0;let v=u;for(const T of c)for(let P=0,O=T.length,x=O-1;P<O;x=P++)for(const k of n)for(let L=0,A=k.length,R=A-1;L<A;R=L++){if(bd(T[x],T[P],k[R],k[L]))return 0;v=Math.min(v,Lr(T[x],T[P],k[R],k[L],a))}return v}function Ba(c,n,a,u,g,h,v){if(h===null||v===null)return;const T=wc(ka(u,h),ka(g,v),a);T<n&&c.push({dist:T,range1:h,range2:v})}function oa(c,n,a,u,g=1/0){let h=Math.min(u.distance(c[0],a[0][0]),g);if(h===0)return h;const v=new Ws([{dist:0,range1:[0,c.length-1],range2:[0,0]}],Ol),T=n?wd:bc,P=Dl(a);for(;v.length;){const O=v.pop();if(O.dist>=h)continue;const x=O.range1;if(cu(x)<=T){if(!qs(x,c.length))return NaN;if(n){const k=Zi(c,x,a,u);if((h=Math.min(h,k))===0)return h}else for(let k=x[0];k<=x[1];++k){const L=ts(c[k],a,u);if((h=Math.min(h,L))===0)return h}}else{const k=Sd(x,n);if(k[0]!==null){const L=wc(ka(c,k[0]),P,u);L<h&&v.push({dist:L,range1:k[0],range2:[0,0]})}if(k[1]!==null){const L=wc(ka(c,k[1]),P,u);L<h&&v.push({dist:L,range1:k[1],range2:[0,0]})}}}return h}function Na(c,n,a,u,g,h=1/0){let v=Math.min(h,g.distance(c[0],a[0]));if(v===0)return v;const T=new Ws([{dist:0,range1:[0,c.length-1],range2:[0,a.length-1]}],Ol),P=n?wd:bc,O=u?wd:bc;for(;T.length;){const x=T.pop();if(x.dist>=v)continue;const k=x.range1,L=x.range2;if(cu(k)<=P&&cu(L)<=O){if(!qs(k,c.length)||!qs(L,a.length))return NaN;if(n&&u?v=Math.min(v,Oi(c,k,a,L,g)):n||u?n&&!u?v=Math.min(v,Si(a,L,c,k,g)):!n&&u&&(v=Math.min(v,Si(c,k,a,L,g))):v=Math.min(v,Hi(c,k,a,L,g)),v===0)return v}else{const A=Sd(k,n),R=Sd(L,u);Ba(T,v,g,c,a,A[0],R[0]),Ba(T,v,g,c,a,A[0],R[1]),Ba(T,v,g,c,a,A[1],R[0]),Ba(T,v,g,c,a,A[1],R[1])}}return v}function xs(c,n,a,u,g=1/0){let h=g;const v=ka(c,[0,c.length-1]);for(const T of a)if(!(h!==1/0&&wc(v,ka(T,[0,T.length-1]),u)>=h)&&(h=Math.min(h,Na(c,n,T,!0,u,h)),h===0))return h;return h}function zl(c,n,a,u,g=1/0){let h=g;const v=ka(c,[0,c.length-1]);for(const T of a){if(h!==1/0&&wc(v,Dl(T),u)>=h)continue;const P=oa(c,n,T,u,h);if(isNaN(P))return P;if((h=Math.min(h,P))===0)return h}return h}function hl(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class ns{constructor(n,a){this.type=Hn,this.geojson=n,this.geometries=a}static parse(n,a){if(n.length!==2)return a.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Il(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let g=0;g<u.features.length;++g)if(hl(u.features[g].geometry.type))return new ns(u,u.features[g].geometry)}else if(u.type==="Feature"){if(hl(u.geometry.type))return new ns(u,u.geometry)}else if(hl(u.type))return new ns(u,u)}return a.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const a=n.geometry(),u=n.canonicalID();if(a!=null&&u!=null){if(n.geometryType()==="Point")return function(g,h,v){const T=[];for(const O of g)for(const x of O)T.push(Tn(x,h));const P=new _c(T[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?Na(T,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",P):v.type==="MultiLineString"?xs(T,!1,v.coordinates,P):v.type==="Polygon"||v.type==="MultiPolygon"?zl(T,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,P):null}(a,u,this.geometries);if(n.geometryType()==="LineString")return function(g,h,v){const T=[];for(const O of g){const x=[];for(const k of O)x.push(Tn(k,h));T.push(x)}const P=new _c(T[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return xs(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,P);if(v.type==="MultiLineString"){let O=1/0;for(let x=0;x<v.coordinates.length;x++){const k=xs(v.coordinates[x],!0,T,P,O);if(isNaN(k))return k;if((O=Math.min(O,k))===0)return O}return O}if(v.type==="Polygon"||v.type==="MultiPolygon"){let O=1/0;for(let x=0;x<T.length;x++){const k=zl(T[x],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,P,O);if(isNaN(k))return k;if((O=Math.min(O,k))===0)return O}return O}return null}(a,u,this.geometries);if(n.geometryType()==="Polygon")return function(g,h,v){const T=[];for(const O of function(x,k){const L=x.length;if(L<=1)return[x];const A=[];let R,$;for(let W=0;W<L;W++){const Y=Bh(x[W]);Y!==0&&(x[W].area=Math.abs(Y),$===void 0&&($=Y<0),$===Y<0?(R&&A.push(R),R=[x[W]]):R.push(x[W]))}return R&&A.push(R),A}(g)){const x=[];for(let k=0;k<O.length;++k)x.push(vo(O[k],h));T.push(x)}const P=new _c(T[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return zl(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,P);if(v.type==="MultiLineString"){let O=1/0;for(let x=0;x<v.coordinates.length;x++){const k=zl(v.coordinates[x],!0,T,P,O);if(isNaN(k))return k;if((O=Math.min(O,k))===0)return O}return O}return v.type==="Polygon"||v.type==="MultiPolygon"?function(O,x,k){let L=1/0;for(const A of O)for(const R of x){const $=bs(A,R,k,L);if(isNaN($))return $;if((L=Math.min(L,$))===0)return L}return L}(v.type==="Polygon"?[v.coordinates]:v.coordinates,T,P):null}(a,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function fl(c,n){switch(c){case"string":return ca(n);case"number":return+n;case"boolean":return!!n;case"color":return On.parse(n);case"formatted":return la.fromString(ca(n));case"resolvedImage":return ma.fromString(ca(n))}return n}function pr(c,n,a,u){return u!==void 0&&(c=u*Math.round(c/u)),n!==void 0&&c<n&&(c=n),a!==void 0&&c>a&&(c=a),c}class uu{constructor(n,a,u){this.type=n,this.key=a,this.scope=u}static parse(n,a){let u=a.expectedType;if(u==null&&(u=xr),n.length<2||n.length>3)return a.error("Invalid number of arguments for 'config' expression.");const g=a.parse(n[1],1);if(!(g instanceof Qa))return a.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const h=a.parse(n[2],2);return h instanceof Qa?new uu(u,ca(g.value),ca(h.value)):a.error("Scope of 'config' expression must be a string literal.")}return new uu(u,ca(g.value))}evaluate(n){const a=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(a);if(!u)return null;const{type:g,value:h,values:v,minValue:T,maxValue:P,stepValue:O}=u,x=u.default.evaluate(n);let k=x;if(h){const L=n.scope;n.scope=(L||"").split("").slice(1).join(""),k=h.evaluate(n),n.scope=L}return g&&(k=fl(g,k)),k===void 0||T===void 0&&P===void 0&&O===void 0||(typeof k=="number"?k=pr(k,T,P,O):Array.isArray(k)&&(k=k.map(L=>typeof L=="number"?pr(L,T,P,O):L))),h!==void 0&&k!==void 0&&v&&!v.includes(k)&&(k=x,g&&(k=fl(g,k))),(g&&g!==this.type||k!==void 0&&Ci(k)!==this.type)&&(k=fl(this.type.kind,k)),k}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function li(c){if(c instanceof va&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof dl||c instanceof ns)return!1;let n=!0;return c.eachChild(a=>{n&&!li(a)&&(n=!1)}),n}function ri(c){if(c instanceof va&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(a=>{n&&!ri(a)&&(n=!1)}),n}function Fl(c){if(c instanceof uu)return new Set([c.key]);let n=new Set;return c.eachChild(a=>{n=new Set([...n,...Fl(a)])}),n}function $a(c,n){if(c instanceof va&&n.indexOf(c.name)>=0)return!1;let a=!0;return c.eachChild(u=>{a&&!$a(u,n)&&(a=!1)}),a}class $r{constructor(n,a){this.type=a.type,this.name=n,this.boundExpression=a}static parse(n,a){if(n.length!==2||typeof n[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const u=n[1];return a.scope.has(u)?new $r(u,a.scope.get(u)):a.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Pa{constructor(n,a=[],u,g=new oi,h=[],v,T){this.registry=n,this.path=a,this.key=a.map(P=>typeof P=="string"?`['${P}']`:`[${P}]`).join(""),this.scope=g,this.errors=h,this.expectedType=u,this._scope=v,this.options=T}parse(n,a,u,g,h={}){return a||u?this.concat(a,null,u,g)._parse(n,h):this._parse(n,h)}parseObjectValue(n,a,u,g,h,v={}){return this.concat(a,u,g,h)._parse(n,v)}_parse(n,a){function u(g,h,v){return v==="assert"?new es(h,[g]):v==="coerce"?new Hs(h,[g]):g}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(g){let h=g.parse(n,this);if(!h)return null;if(this.expectedType){const v=this.expectedType,T=h.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else h=u(h,v,a.typeAnnotation||"coerce");else h=u(h,v,a.typeAnnotation||"assert")}if(!(h instanceof Qa)&&h.type.kind!=="resolvedImage"&&Zs(h)){const v=new kl(this._scope,this.options);try{h=new Qa(h.type,h.evaluate(v))}catch(T){return this.error(T.message),null}}return h}return Hs.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,a,u,g){let h=typeof n=="number"?this.path.concat(n):this.path;h=typeof a=="string"?h.concat(a):h;const v=g?this.scope.concat(g):this.scope;return new Pa(this.registry,h,u||null,v,this.errors,this._scope,this.options)}error(n,...a){const u=`${this.key}${a.map(g=>`[${g}]`).join("")}`;this.errors.push(new ko(u,n))}checkSubtype(n,a){const u=fc(n,a);return u&&this.error(u),u}}var Ks=Pa;function Zs(c){if(c instanceof $r)return Zs(c.boundExpression);if(c instanceof va&&c.name==="error"||c instanceof _d||c instanceof dl||c instanceof ns||c instanceof uu)return!1;const n=c instanceof Hs||c instanceof es;let a=!0;return c.eachChild(u=>{a=n?a&&Zs(u):a&&u instanceof Qa}),!!a&&li(c)&&$a(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Bl(c,n){const a=c.length-1;let u,g,h=0,v=a,T=0;for(;h<=v;)if(T=Math.floor((h+v)/2),u=c[T],g=c[T+1],u<=n){if(T===a||n<g)return T;h=T+1}else{if(!(u>n))throw new _i("Input is not a number.");v=T-1}return 0}class Nl{constructor(n,a,u){this.type=n,this.input=a,this.labels=[],this.outputs=[];for(const[g,h]of u)this.labels.push(g),this.outputs.push(h)}static parse(n,a){if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");const u=a.parse(n[1],1,Hn);if(!u)return null;const g=[];let h=null;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);for(let v=1;v<n.length;v+=2){const T=v===1?-1/0:n[v],P=n[v+1],O=v,x=v+1;if(typeof T!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=T)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const k=a.parse(P,x,h);if(!k)return null;h=h||k.type,g.push([T,k])}return new Nl(h,u,g)}evaluate(n){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(n);const g=this.input.evaluate(n);if(g<=a[0])return u[0].evaluate(n);const h=a.length;return g>=a[h-1]?u[h-1].evaluate(n):u[Bl(a,g)].evaluate(n)}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&n.push(this.labels[a]),n.push(this.outputs[a].serialize());return n}}const Sc=.95047,$l=1.08883,$h=4/29,pl=6/29,Td=3*pl*pl,Cd=pl*pl*pl,Ed=Math.PI/180,op=180/Math.PI;function du(c){return c>Cd?Math.pow(c,1/3):c/Td+$h}function hu(c){return c>pl?c*c*c:Td*(c-$h)}function rg(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function ig(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Q_(c){const n=ig(c.r),a=ig(c.g),u=ig(c.b),g=du((.4124564*n+.3575761*a+.1804375*u)/Sc),h=du((.2126729*n+.7151522*a+.072175*u)/1);return{l:116*h-16,a:500*(g-h),b:200*(h-du((.0193339*n+.119192*a+.9503041*u)/$l)),alpha:c.a}}function ey(c){let n=(c.l+16)/116,a=isNaN(c.a)?n:n+c.a/500,u=isNaN(c.b)?n:n-c.b/200;return n=1*hu(n),a=Sc*hu(a),u=$l*hu(u),new On(rg(3.2404542*a-1.5371385*n-.4985314*u),rg(-.969266*a+1.8760108*n+.041556*u),rg(.0556434*a-.2040259*n+1.0572252*u),c.alpha)}function z1(c,n,a){const u=n-c;return c+a*(u>180||u<-180?u-360*Math.round(u/360):u)}const Vh={forward:Q_,reverse:ey,interpolate:function(c,n,a){return{l:uo(c.l,n.l,a),a:uo(c.a,n.a,a),b:uo(c.b,n.b,a),alpha:uo(c.alpha,n.alpha,a)}}},Uh={forward:function(c){const{l:n,a,b:u}=Q_(c),g=Math.atan2(u,a)*op;return{h:g<0?g+360:g,c:Math.sqrt(a*a+u*u),l:n,alpha:c.a}},reverse:function(c){const n=c.h*Ed,a=c.c;return ey({l:c.l,a:Math.cos(n)*a,b:Math.sin(n)*a,alpha:c.alpha})},interpolate:function(c,n,a){return{h:z1(c.h,n.h,a),c:uo(c.c,n.c,a),l:uo(c.l,n.l,a),alpha:uo(c.alpha,n.alpha,a)}}};var ty=Object.freeze({__proto__:null,hcl:Uh,lab:Vh});class ws{constructor(n,a,u,g,h){this.type=n,this.operator=a,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(const[v,T]of h)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(n,a,u,g){let h=0;if(n.name==="exponential")h=ag(a,n.base,u,g);else if(n.name==="linear")h=ag(a,1,u,g);else if(n.name==="cubic-bezier"){const v=n.controlPoints;h=new At(v[0],v[1],v[2],v[3]).solve(ag(a,1,u,g))}return h}static parse(n,a){let[u,g,h,...v]=n;if(!Array.isArray(g)||g.length===0)return a.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(x=>typeof x!="number"||x<0||x>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(n.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(h=a.parse(h,2,Hn),!h)return null;const T=[];let P=null;u==="interpolate-hcl"||u==="interpolate-lab"?P=zr:a.expectedType&&a.expectedType.kind!=="value"&&(P=a.expectedType);for(let O=0;O<v.length;O+=2){const x=v[O],k=v[O+1],L=O+3,A=O+4;if(typeof x!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(T.length&&T[T.length-1][0]>=x)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const R=a.parse(k,A,P);if(!R)return null;P=P||R.type,T.push([x,R])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new ws(P,u,g,h,T):a.error(`Type ${xi(P)} is not interpolatable.`)}evaluate(n){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(n);const g=this.input.evaluate(n);if(g<=a[0])return u[0].evaluate(n);const h=a.length;if(g>=a[h-1])return u[h-1].evaluate(n);const v=Bl(a,g),T=ws.interpolationFactor(this.interpolation,g,a[v],a[v+1]),P=u[v].evaluate(n),O=u[v+1].evaluate(n);return this.operator==="interpolate"?Ti[this.type.kind.toLowerCase()](P,O,T):this.operator==="interpolate-hcl"?Uh.reverse(Uh.interpolate(Uh.forward(P),Uh.forward(O),T)):Vh.reverse(Vh.interpolate(Vh.forward(P),Vh.forward(O),T))}eachChild(n){n(this.input);for(const a of this.outputs)n(a)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,n,this.input.serialize()];for(let u=0;u<this.labels.length;u++)a.push(this.labels[u],this.outputs[u].serialize());return a}}function ag(c,n,a,u){const g=u-a,h=c-a;return g===0?0:n===1?h/g:(Math.pow(n,h)-1)/(Math.pow(n,g)-1)}class rp{constructor(n,a){this.type=n,this.args=a}static parse(n,a){if(n.length<2)return a.error("Expectected at least one argument.");let u=null;const g=a.expectedType;g&&g.kind!=="value"&&(u=g);const h=[];for(const T of n.slice(1)){const P=a.parse(T,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,h.push(P)}const v=g&&h.some(T=>fc(g,T.type));return new rp(v?xr:u,h)}evaluate(n){let a,u=null,g=0;for(const h of this.args){if(g++,u=h.evaluate(n),u&&u instanceof ma&&!u.available&&(a||(a=u),u=null,g===this.args.length))return a;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class ip{constructor(n,a){this.type=a.type,this.bindings=[].concat(n),this.result=a}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const a of this.bindings)n(a[1]);n(this.result)}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let h=1;h<n.length-1;h+=2){const v=n[h];if(typeof v!="string")return a.error(`Expected string, but found ${typeof v} instead.`,h);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",h);const T=a.parse(n[h+1],h+1);if(!T)return null;u.push([v,T])}const g=a.parse(n[n.length-1],n.length-1,a.expectedType,u);return g?new ip(u,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[a,u]of this.bindings)n.push(a,u.serialize());return n.push(this.result.serialize()),n}}class sg{constructor(n,a,u){this.type=n,this.index=a,this.input=u}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,Hn),g=a.parse(n[2],2,pa(a.expectedType||xr));return u&&g?new sg(g.type.itemType,u,g):null}evaluate(n){const a=this.index.evaluate(n),u=this.input.evaluate(n);if(a<0)throw new _i(`Array index out of bounds: ${a} < 0.`);if(a>u.length-1)throw new _i(`Array index out of bounds: ${a} > ${u.length-1}.`);if(a===Math.floor(a))return u[a];const g=Math.floor(a),h=Math.ceil(a),v=u[g],T=u[h];if(typeof v!="number"||typeof T!="number")throw new _i(`Cannot interpolate between non-number values at index ${a}.`);const P=a-g;return v*(1-P)+T*P}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class lg{constructor(n,a){this.type=br,this.needle=n,this.haystack=a}static parse(n,a){if(n.length!==3)return a.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,xr),g=a.parse(n[2],2,xr);return u&&g?au(u.type,[br,fr,Hn,yi,xr])?new lg(u,g):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${xi(u.type)} instead`):null}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!Us(a,["boolean","string","number","null"]))throw new _i(`Expected first argument to be of type boolean, string, number or null, but found ${xi(Ci(a))} instead.`);if(!Us(u,["string","array"]))throw new _i(`Expected second argument to be of type array or string, but found ${xi(Ci(u))} instead.`);return u.indexOf(a)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ap{constructor(n,a,u){this.type=Hn,this.needle=n,this.haystack=a,this.fromIndex=u}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,xr),g=a.parse(n[2],2,xr);if(!u||!g)return null;if(!au(u.type,[br,fr,Hn,yi,xr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${xi(u.type)} instead`);if(n.length===4){const h=a.parse(n[3],3,Hn);return h?new ap(u,g,h):null}return new ap(u,g)}evaluate(n){const a=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!Us(a,["boolean","string","number","null"]))throw new _i(`Expected first argument to be of type boolean, string, number or null, but found ${xi(Ci(a))} instead.`);if(!Us(u,["string","array"]))throw new _i(`Expected second argument to be of type array or string, but found ${xi(Ci(u))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(n);return u.indexOf(a,g)}return u.indexOf(a)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class cg{constructor(n,a,u,g,h,v){this.inputType=n,this.type=a,this.input=u,this.cases=g,this.outputs=h,this.otherwise=v}static parse(n,a){if(n.length<5)return a.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return a.error("Expected an even number of arguments.");let u,g;a.expectedType&&a.expectedType.kind!=="value"&&(g=a.expectedType);const h={},v=[];for(let O=2;O<n.length-1;O+=2){let x=n[O];const k=n[O+1];Array.isArray(x)||(x=[x]);const L=a.concat(O);if(x.length===0)return L.error("Expected at least one branch label.");for(const R of x){if(typeof R!="number"&&typeof R!="string")return L.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return L.error("Numeric branch labels must be integer values.");if(u){if(L.checkSubtype(u,Ci(R)))return null}else u=Ci(R);if(h[String(R)]!==void 0)return L.error("Branch labels must be unique.");h[String(R)]=v.length}const A=a.parse(k,O,g);if(!A)return null;g=g||A.type,v.push(A)}const T=a.parse(n[1],1,xr);if(!T)return null;const P=a.parse(n[n.length-1],n.length-1,g);return P?T.type.kind!=="value"&&a.concat(1).checkSubtype(u,T.type)?null:new cg(u,g,T,h,v,P):null}evaluate(n){const a=this.input.evaluate(n);return(Ci(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),u=[],g={};for(const v of a){const T=g[this.cases[v]];T===void 0?(g[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[T][1].push(v)}const h=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,T]of u)n.push(T.length===1?h(T[0]):T.map(h)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}class jh{constructor(n,a,u){this.type=n,this.branches=a,this.otherwise=u}static parse(n,a){if(n.length<4)return a.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return a.error("Expected an odd number of arguments.");let u;a.expectedType&&a.expectedType.kind!=="value"&&(u=a.expectedType);const g=[];for(let v=1;v<n.length-1;v+=2){const T=a.parse(n[v],v,br);if(!T)return null;const P=a.parse(n[v+1],v+1,u);if(!P)return null;g.push([T,P]),u=u||P.type}const h=a.parse(n[n.length-1],n.length-1,u);return h?new jh(u,g,h):null}evaluate(n){for(const[a,u]of this.branches)if(a.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[a,u]of this.branches)n(a),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(a=>{n.push(a.serialize())}),n}}class sp{constructor(n,a,u,g){this.type=n,this.input=a,this.beginIndex=u,this.endIndex=g}static parse(n,a){if(n.length<=2||n.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=a.parse(n[1],1,xr),g=a.parse(n[2],2,Hn);if(!u||!g)return null;if(!au(u.type,[pa(xr),fr,xr]))return a.error(`Expected first argument to be of type array or string, but found ${xi(u.type)} instead`);if(n.length===4){const h=a.parse(n[3],3,Hn);return h?new sp(u.type,u,g,h):null}return new sp(u.type,u,g)}evaluate(n){const a=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!Us(a,["string","array"]))throw new _i(`Expected first argument to be of type array or string, but found ${xi(Ci(a))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(n);return a.slice(u,g)}return a.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function ug(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function ny(c,n,a,u){return u.compare(n,a)===0}function Md(c,n,a){const u=c!=="=="&&c!=="!=";return class lL{constructor(h,v,T){this.type=br,this.lhs=h,this.rhs=v,this.collator=T,this.hasUntypedArgument=h.type.kind==="value"||v.type.kind==="value"}static parse(h,v){if(h.length!==3&&h.length!==4)return v.error("Expected two or three arguments.");const T=h[0];let P=v.parse(h[1],1,xr);if(!P)return null;if(!ug(T,P.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${xi(P.type)}'.`);let O=v.parse(h[2],2,xr);if(!O)return null;if(!ug(T,O.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${xi(O.type)}'.`);if(P.type.kind!==O.type.kind&&P.type.kind!=="value"&&O.type.kind!=="value")return v.error(`Cannot compare types '${xi(P.type)}' and '${xi(O.type)}'.`);u&&(P.type.kind==="value"&&O.type.kind!=="value"?P=new es(O.type,[P]):P.type.kind!=="value"&&O.type.kind==="value"&&(O=new es(P.type,[O])));let x=null;if(h.length===4){if(P.type.kind!=="string"&&O.type.kind!=="string"&&P.type.kind!=="value"&&O.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(x=v.parse(h[3],3,Ja),!x)return null}return new lL(P,O,x)}evaluate(h){const v=this.lhs.evaluate(h),T=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const P=Ci(v),O=Ci(T);if(P.kind!==O.kind||P.kind!=="string"&&P.kind!=="number")throw new _i(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${P.kind}, ${O.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=Ci(v),O=Ci(T);if(P.kind!=="string"||O.kind!=="string")return n(h,v,T)}return this.collator?a(h,v,T,this.collator.evaluate(h)):n(h,v,T)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[c];return this.eachChild(v=>{h.push(v.serialize())}),h}}}const F1=Md("==",function(c,n,a){return n===a},ny),oy=Md("!=",function(c,n,a){return n!==a},function(c,n,a,u){return!ny(0,n,a,u)}),ry=Md("<",function(c,n,a){return n<a},function(c,n,a,u){return u.compare(n,a)<0}),Id=Md(">",function(c,n,a){return n>a},function(c,n,a,u){return u.compare(n,a)>0}),iy=Md("<=",function(c,n,a){return n<=a},function(c,n,a,u){return u.compare(n,a)<=0}),ay=Md(">=",function(c,n,a){return n>=a},function(c,n,a,u){return u.compare(n,a)>=0});class dg{constructor(n,a,u,g,h,v){this.type=fr,this.number=n,this.locale=a,this.currency=u,this.unit=g,this.minFractionDigits=h,this.maxFractionDigits=v}static parse(n,a){if(n.length!==3)return a.error("Expected two arguments.");const u=a.parse(n[1],1,Hn);if(!u)return null;const g=n[2];if(typeof g!="object"||Array.isArray(g))return a.error("NumberFormat options argument must be an object.");let h=null;if(g.locale&&(h=a.parseObjectValue(g.locale,2,"locale",fr),!h))return null;let v=null;if(g.currency&&(v=a.parseObjectValue(g.currency,2,"currency",fr),!v))return null;let T=null;if(g.unit&&(T=a.parseObjectValue(g.unit,2,"unit",fr),!T))return null;let P=null;if(g["min-fraction-digits"]&&(P=a.parseObjectValue(g["min-fraction-digits"],2,"min-fraction-digits",Hn),!P))return null;let O=null;return g["max-fraction-digits"]&&(O=a.parseObjectValue(g["max-fraction-digits"],2,"max-fraction-digits",Hn),!O)?null:new dg(u,h,v,T,P,O)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Hh{constructor(n){this.type=Hn,this.input=n}static parse(n,a){if(n.length!==2)return a.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=a.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${xi(u.type)} instead.`):new Hh(u):null}evaluate(n){const a=this.input.evaluate(n);if(typeof a=="string"||Array.isArray(a))return a.length;throw new _i(`Expected value to be of type string or array, but found ${xi(Ci(a))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(a=>{n.push(a.serialize())}),n}}function lp(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const Ad={"==":F1,"!=":oy,">":Id,"<":ry,">=":ay,"<=":iy,array:es,at:sg,boolean:es,case:jh,coalesce:rp,collator:_d,format:su,image:Al,in:lg,"index-of":ap,interpolate:ws,"interpolate-hcl":ws,"interpolate-lab":ws,length:Hh,let:ip,literal:Qa,match:cg,number:es,"number-format":dg,object:es,slice:sp,step:Nl,string:es,"to-boolean":Hs,"to-color":Hs,"to-number":Hs,"to-string":Hs,var:$r,within:dl,distance:ns,config:uu};function sy(c,[n,a,u,g]){n=n.evaluate(c),a=a.evaluate(c),u=u.evaluate(c);const h=g?g.evaluate(c):1,v=ep(n,a,u,h);if(v)throw new _i(v);return new On(n/255*h,a/255*h,u/255*h,h)}function hg(c,[n,a,u,g]){n=n.evaluate(c),a=a.evaluate(c),u=u.evaluate(c);const h=g?g.evaluate(c):1,v=function(O,x,k,L){return typeof O=="number"&&O>=0&&O<=360?typeof x=="number"&&x>=0&&x<=100&&typeof k=="number"&&k>=0&&k<=100?L===void 0||typeof L=="number"&&L>=0&&L<=1?null:`Invalid hsla value [${[O,x,k,L].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof L=="number"?[O,x,k,L]:[O,x,k]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof L=="number"?[O,x,k,L]:[O,x,k]).join(", ")}]: 'h' must be between 0 and 360.`}(n,a,u,h);if(v)throw new _i(v);const T=`hsla(${n}, ${a}%, ${u}%, ${h})`,P=On.parse(T);if(!P)throw new _i(`Failed to parse HSLA color: ${T}`);return P}function fg(c,n){return c in n}function pg(c,n){const a=n[c];return a===void 0?null:a}function Bu(c){return{type:c}}function ly(c){return{result:"success",value:c}}function Tc(c){return{result:"error",value:c}}function cp(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function Nu(c){return c["property-type"]==="data-driven"}function cy(c){return cp(c.expression,"measure-light")}function mg(c){return cp(c.expression,"zoom")}function gg(c){return!!c.expression&&c.expression.interpolated}function vg(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function uy(c){return c}function _g(c,n){const a=n.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",g=u||!(u||c.property!==void 0),h=c.type||(gg(n)?"exponential":"interval");if(a&&((c=$n({},c)).stops&&(c.stops=c.stops.map(O=>[O[0],On.parse(O[1])])),c.default=On.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!ty[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let v,T,P;if(h==="exponential")v=yg;else if(h==="interval")v=N1;else if(h==="categorical"){v=B1,T=Object.create(null);for(const O of c.stops)T[O[0]]=O[1];P=typeof c.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);v=$1}if(u){const O={},x=[];for(let A=0;A<c.stops.length;A++){const R=c.stops[A],$=R[0].zoom;O[$]===void 0&&(O[$]={zoom:$,type:c.type,property:c.property,default:c.default,stops:[]},x.push($)),O[$].stops.push([R[0].value,R[1]])}const k=[];for(const A of x)k.push([O[A].zoom,_g(O[A],n)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:ws.interpolationFactor.bind(void 0,L),zoomStops:k.map(A=>A[0]),evaluate:({zoom:A},R)=>yg({stops:k,base:c.base},n,A).evaluate(A,R)}}if(g){const O=h==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:ws.interpolationFactor.bind(void 0,O),zoomStops:c.stops.map(x=>x[0]),evaluate:({zoom:x})=>v(c,n,x,T,P)}}return{kind:"source",evaluate(O,x){const k=x&&x.properties?x.properties[c.property]:void 0;return k===void 0?Gh(c.default,n.default):v(c,n,k,T,P)}}}function Gh(c,n,a){return c!==void 0?c:n!==void 0?n:a!==void 0?a:void 0}function B1(c,n,a,u,g){return Gh(typeof a===g?u[a]:void 0,c.default,n.default)}function N1(c,n,a){if(js(a)!=="number")return Gh(c.default,n.default);const u=c.stops.length;if(u===1||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[u-1][0])return c.stops[u-1][1];const g=Bl(c.stops.map(h=>h[0]),a);return c.stops[g][1]}function yg(c,n,a){const u=c.base!==void 0?c.base:1;if(js(a)!=="number")return Gh(c.default,n.default);const g=c.stops.length;if(g===1||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[g-1][0])return c.stops[g-1][1];const h=Bl(c.stops.map(x=>x[0]),a),v=function(x,k,L,A){const R=A-L,$=x-L;return R===0?0:k===1?$/R:(Math.pow(k,$)-1)/(Math.pow(k,R)-1)}(a,u,c.stops[h][0],c.stops[h+1][0]),T=c.stops[h][1],P=c.stops[h+1][1];let O=Ti[n.type]||uy;if(c.colorSpace&&c.colorSpace!=="rgb"){const x=ty[c.colorSpace];O=(k,L)=>x.reverse(x.interpolate(x.forward(k),x.forward(L),v))}return typeof T.evaluate=="function"?{evaluate(...x){const k=T.evaluate.apply(void 0,x),L=P.evaluate.apply(void 0,x);if(k!==void 0&&L!==void 0)return O(k,L,v)}}:O(T,P,v)}function $1(c,n,a){return n.type==="color"?a=On.parse(a):n.type==="formatted"?a=la.fromString(a.toString()):n.type==="resolvedImage"?a=ma.fromString(a.toString()):js(a)===n.type||n.type==="enum"&&n.values[a]||(a=void 0),Gh(a,c.default,n.default)}va.register(Ad,{error:[{kind:"error"},[fr],(c,[n])=>{throw new _i(n.evaluate(c))}],typeof:[fr,[xr],(c,[n])=>xi(Ci(n.evaluate(c)))],"to-rgba":[pa(Hn,4),[zr],(c,[n])=>n.evaluate(c).toRenderColor(null).toArray()],rgb:[zr,[Hn,Hn,Hn],sy],rgba:[zr,[Hn,Hn,Hn,Hn],sy],hsl:[zr,[Hn,Hn,Hn],hg],hsla:[zr,[Hn,Hn,Hn,Hn],hg],has:{type:br,overloads:[[[fr],(c,[n])=>fg(n.evaluate(c),c.properties())],[[fr,sa],(c,[n,a])=>fg(n.evaluate(c),a.evaluate(c))]]},get:{type:xr,overloads:[[[fr],(c,[n])=>pg(n.evaluate(c),c.properties())],[[fr,sa],(c,[n,a])=>pg(n.evaluate(c),a.evaluate(c))]]},"feature-state":[xr,[fr],(c,[n])=>pg(n.evaluate(c),c.featureState||{})],properties:[sa,[],c=>c.properties()],"geometry-type":[fr,[],c=>c.geometryType()],id:[xr,[],c=>c.id()],zoom:[Hn,[],c=>c.globals.zoom],pitch:[Hn,[],c=>c.globals.pitch||0],"distance-from-center":[Hn,[],c=>c.distanceFromCenter()],"measure-light":[Hn,[fr],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[Hn,[],c=>c.globals.heatmapDensity||0],"line-progress":[Hn,[],c=>c.globals.lineProgress||0],"raster-value":[Hn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[Hn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[Hn,[],c=>c.globals.skyRadialProgress||0],accumulated:[xr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Hn,Bu(Hn),(c,n)=>{let a=0;for(const u of n)a+=u.evaluate(c);return a}],"*":[Hn,Bu(Hn),(c,n)=>{let a=1;for(const u of n)a*=u.evaluate(c);return a}],"-":{type:Hn,overloads:[[[Hn,Hn],(c,[n,a])=>n.evaluate(c)-a.evaluate(c)],[[Hn],(c,[n])=>-n.evaluate(c)]]},"/":[Hn,[Hn,Hn],(c,[n,a])=>n.evaluate(c)/a.evaluate(c)],"%":[Hn,[Hn,Hn],(c,[n,a])=>n.evaluate(c)%a.evaluate(c)],ln2:[Hn,[],()=>Math.LN2],pi:[Hn,[],()=>Math.PI],e:[Hn,[],()=>Math.E],"^":[Hn,[Hn,Hn],(c,[n,a])=>Math.pow(n.evaluate(c),a.evaluate(c))],sqrt:[Hn,[Hn],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[Hn,[Hn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[Hn,[Hn],(c,[n])=>Math.log(n.evaluate(c))],log2:[Hn,[Hn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[Hn,[Hn],(c,[n])=>Math.sin(n.evaluate(c))],cos:[Hn,[Hn],(c,[n])=>Math.cos(n.evaluate(c))],tan:[Hn,[Hn],(c,[n])=>Math.tan(n.evaluate(c))],asin:[Hn,[Hn],(c,[n])=>Math.asin(n.evaluate(c))],acos:[Hn,[Hn],(c,[n])=>Math.acos(n.evaluate(c))],atan:[Hn,[Hn],(c,[n])=>Math.atan(n.evaluate(c))],min:[Hn,Bu(Hn),(c,n)=>Math.min(...n.map(a=>a.evaluate(c)))],max:[Hn,Bu(Hn),(c,n)=>Math.max(...n.map(a=>a.evaluate(c)))],abs:[Hn,[Hn],(c,[n])=>Math.abs(n.evaluate(c))],round:[Hn,[Hn],(c,[n])=>{const a=n.evaluate(c);return a<0?-Math.round(-a):Math.round(a)}],floor:[Hn,[Hn],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[Hn,[Hn],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[br,[fr,xr],(c,[n,a])=>c.properties()[n.value]===a.value],"filter-id-==":[br,[xr],(c,[n])=>c.id()===n.value],"filter-type-==":[br,[fr],(c,[n])=>c.geometryType()===n.value],"filter-<":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],g=a.value;return typeof u==typeof g&&u<g}],"filter-id-<":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a<u}],"filter->":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],g=a.value;return typeof u==typeof g&&u>g}],"filter-id->":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a>u}],"filter-<=":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],g=a.value;return typeof u==typeof g&&u<=g}],"filter-id-<=":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a<=u}],"filter->=":[br,[fr,xr],(c,[n,a])=>{const u=c.properties()[n.value],g=a.value;return typeof u==typeof g&&u>=g}],"filter-id->=":[br,[xr],(c,[n])=>{const a=c.id(),u=n.value;return typeof a==typeof u&&a>=u}],"filter-has":[br,[xr],(c,[n])=>n.value in c.properties()],"filter-has-id":[br,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[br,[pa(fr)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[br,[pa(xr)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[br,[fr,pa(xr)],(c,[n,a])=>a.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[br,[fr,pa(xr)],(c,[n,a])=>function(u,g,h,v){for(;h<=v;){const T=h+v>>1;if(g[T]===u)return!0;g[T]>u?v=T-1:h=T+1}return!1}(c.properties()[n.value],a.value,0,a.value.length-1)],all:{type:br,overloads:[[[br,br],(c,[n,a])=>n.evaluate(c)&&a.evaluate(c)],[Bu(br),(c,n)=>{for(const a of n)if(!a.evaluate(c))return!1;return!0}]]},any:{type:br,overloads:[[[br,br],(c,[n,a])=>n.evaluate(c)||a.evaluate(c)],[Bu(br),(c,n)=>{for(const a of n)if(a.evaluate(c))return!0;return!1}]]},"!":[br,[br],(c,[n])=>!n.evaluate(c)],"is-supported-script":[br,[fr],(c,[n])=>{const a=c.globals&&c.globals.isSupportedScript;return!a||a(n.evaluate(c))}],upcase:[fr,[fr],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[fr,[fr],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[fr,Bu(xr),(c,n)=>n.map(a=>ca(a.evaluate(c))).join("")],"resolved-locale":[fr,[Ja],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[Hn,[Hn,Hn,xr],(c,n)=>{const[a,u,g]=n.map(v=>v.evaluate(c));if(a>u||a===u)return a;let h;if(typeof g=="string")h=function(v){let T=0;if(v.length===0)return T;for(let P=0;P<v.length;P++)T=(T<<5)-T+v.charCodeAt(P),T|=0;return T}(g);else{if(typeof g!="number")throw new _i(`Invalid seed input: ${g}`);h=g}return a+lp(h)()*(u-a)}]});class bg{constructor(n,a,u,g){this.expression=n,this._warningHistory={},this._evaluator=new kl(u,g),this._defaultValue=a?function(h){return h.type==="color"&&(vg(h.default)||Array.isArray(h.default))?new On(0,0,0,0):h.type==="color"?On.parse(h.default)||null:h.default===void 0?null:h.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null,this.configDependencies=Fl(n)}evaluateWithoutErrorHandling(n,a,u,g,h,v,T,P){return this._evaluator.globals=n,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=g||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(n,a,u,g,h,v,T,P){this._evaluator.globals=n,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new _i(`Expected value to be one of ${Object.keys(this._enumValues).map(x=>JSON.stringify(x)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function up(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Ad}function kd(c,n,a,u){const g=new Ks(Ad,[],n?function(v){const T={color:zr,string:fr,number:Hn,enum:fr,boolean:br,formatted:dc,resolvedImage:hc};return v.type==="array"?pa(T[v.value]||xr,v.length):T[v.type]}(n):void 0,void 0,void 0,a,u),h=g.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?ly(new bg(h,n,a,u)):Tc(g.errors)}class dp{constructor(n,a,u){this.kind=n,this._styleExpression=a,this.isLightConstant=u,this.isStateDependent=n!=="constant"&&!ri(a.expression),this.configDependencies=Fl(a.expression)}evaluateWithoutErrorHandling(n,a,u,g,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,g,h,v)}evaluate(n,a,u,g,h,v){return this._styleExpression.evaluate(n,a,u,g,h,v)}}class Wh{constructor(n,a,u,g,h){this.kind=n,this.zoomStops=u,this._styleExpression=a,this.isStateDependent=n!=="camera"&&!ri(a.expression),this.isLightConstant=h,this.configDependencies=Fl(a.expression),this.interpolationType=g}evaluateWithoutErrorHandling(n,a,u,g,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,a,u,g,h,v)}evaluate(n,a,u,g,h,v){return this._styleExpression.evaluate(n,a,u,g,h,v)}interpolationFactor(n,a,u){return this.interpolationType?ws.interpolationFactor(this.interpolationType,n,a,u):0}}function $u(c,n,a,u){if((c=kd(c,n,a,u)).result==="error")return c;const g=c.value.expression,h=li(g);if(!h&&!Nu(n))return Tc([new ko("","data expressions not supported")]);const v=$a(g,["zoom","pitch","distance-from-center"]);if(!v&&!mg(n))return Tc([new ko("","zoom expressions not supported")]);const T=$a(g,["measure-light"]);if(!T&&!cy(n))return Tc([new ko("","measure-light expression not supported")]);const P=$a(g,["line-progress"]);if(!P&&!function(k){return cp(k.expression,"line-progress")}(n))return Tc([new ko("","line-progress expression not supported")]);const O=n.expression&&n.expression.relaxZoomRestriction,x=fp(g);return x||v||O?x instanceof ko?Tc([x]):x instanceof ws&&!gg(n)?Tc([new ko("",'"interpolate" expressions cannot be used with this property')]):ly(x?new Wh(h&&P?"camera":"composite",c.value,x.labels,x instanceof ws?x.interpolation:void 0,T):new dp(h&&P?"constant":"source",c.value,T)):Tc([new ko("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class hp{constructor(n,a){this._parameters=n,this._specification=a,$n(this,_g(this._parameters,this._specification))}static deserialize(n){return new hp(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function fp(c){let n=null;if(c instanceof ip)n=fp(c.result);else if(c instanceof rp){for(const a of c.args)if(n=fp(a),n)break}else(c instanceof Nl||c instanceof ws)&&c.input instanceof va&&c.input.name==="zoom"&&(n=c);return n instanceof ko||c.eachChild(a=>{const u=fp(a);u instanceof ko?n=u:n&&u&&n!==u&&(n=new ko("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var xg,wg,dy=function(){if(wg)return xg;wg=1,xg=n;var c=3;function n(a,u,g){var h=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var v=new Int32Array(this.arrayBuffer);a=v[0],this.d=(u=v[1])+2*(g=v[2]);for(var T=0;T<this.d*this.d;T++){var P=v[c+T],O=v[c+T+1];h.push(P===O?null:v.subarray(P,O))}var x=v[c+h.length+1];this.keys=v.subarray(v[c+h.length],x),this.bboxes=v.subarray(x),this.insert=this._insertReadonly}else{this.d=u+2*g;for(var k=0;k<this.d*this.d;k++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=a,this.padding=g,this.scale=u/a,this.uid=0;var L=g/u*a;this.min=-L,this.max=a+L}return n.prototype.insert=function(a,u,g,h,v){this._forEachCell(u,g,h,v,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(h),this.bboxes.push(v)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(a,u,g,h,v,T){this.cells[v].push(T)},n.prototype.query=function(a,u,g,h,v){var T=this.min,P=this.max;if(a<=T&&u<=T&&P<=g&&P<=h&&!v)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(a,u,g,h,this._queryCell,O,{},v),O},n.prototype._queryCell=function(a,u,g,h,v,T,P,O){var x=this.cells[v];if(x!==null)for(var k=this.keys,L=this.bboxes,A=0;A<x.length;A++){var R=x[A];if(P[R]===void 0){var $=4*R;(O?O(L[$+0],L[$+1],L[$+2],L[$+3]):a<=L[$+2]&&u<=L[$+3]&&g>=L[$+0]&&h>=L[$+1])?(P[R]=!0,T.push(k[R])):P[R]=!1}}},n.prototype._forEachCell=function(a,u,g,h,v,T,P,O){for(var x=this._convertToCellCoord(a),k=this._convertToCellCoord(u),L=this._convertToCellCoord(g),A=this._convertToCellCoord(h),R=x;R<=L;R++)for(var $=k;$<=A;$++){var W=this.d*$+R;if((!O||O(this._convertFromCellCoord(R),this._convertFromCellCoord($),this._convertFromCellCoord(R+1),this._convertFromCellCoord($+1)))&&v.call(this,a,u,g,h,W,T,P,O))return}},n.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},n.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,u=c+this.cells.length+1+1,g=0,h=0;h<this.cells.length;h++)g+=this.cells[h].length;var v=new Int32Array(u+g+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var T=u,P=0;P<a.length;P++){var O=a[P];v[c+P]=T,v.set(O,T),T+=O.length}return v[c+a.length]=T,v.set(this.keys,T),v[c+a.length+1]=T+=this.keys.length,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer},xg}(),Vu=w(dy);const qh={};function no(c,n,a={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),qh[n]={klass:c,omit:a.omit||[]}}no(Object,"Object"),Vu.serialize=function(c,n){const a=c.toArrayBuffer();return n&&n.add(a),{buffer:a}},Vu.deserialize=function(c){return new Vu(c.buffer)},Object.defineProperty(Vu,"name",{value:"Grid"}),no(Vu,"Grid"),no(On,"Color"),no(Error,"Error"),no(la,"Formatted"),no(Ia,"FormattedSection"),no(sl,"AJAXError"),no(ma,"ResolvedImage"),no(hp,"StylePropertyFunction"),no(bg,"StyleExpression",{omit:["_evaluator"]}),no(Wh,"ZoomDependentExpression"),no(dp,"ZoomConstantExpression"),no(va,"CompoundExpression",{omit:["_evaluate"]});for(const c in Ad)qh[Ad[c]._classRegistryKey]||no(Ad[c],`Expression${c}`);function pp(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Sg(c){return self.ImageBitmap&&c instanceof ImageBitmap}function Uu(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(pp(c)||Sg(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c)){const a=c;return n&&n.add(a.buffer),a}if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const a=[];for(const u of c)a.push(Uu(u,n));return a}if(c instanceof Map){const a={$name:"Map"};for(const[u,g]of c.entries())a[u]=Uu(g);return a}if(c instanceof Set){const a={$name:"Set"};let u=0;for(const g of c.values())a[++u]=Uu(g);return a}if(typeof c=="object"){const a=c.constructor,u=a._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const g=a.serialize?a.serialize(c,n):{};if(!a.serialize){for(const h in c)c.hasOwnProperty(h)&&(qh[u].omit.indexOf(h)>=0||(g[h]=Uu(c[h],n)));c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(g.$name=u),g}throw new Error("can't serialize object of type "+typeof c)}function os(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||pp(c)||Sg(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(os);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const g=new Map;for(const h of Object.keys(c))h!=="$name"&&g.set(h,os(c[h]));return g}if(n==="Set"){const g=new Set;for(const h of Object.keys(c))h!=="$name"&&g.add(os(c[h]));return g}const{klass:a}=qh[n];if(!a)throw new Error(`can't deserialize unregistered class ${n}`);if(a.deserialize)return a.deserialize(c);const u=Object.create(a.prototype);for(const g of Object.keys(c))g!=="$name"&&(u[g]=os(c[g]));return u}throw new Error("can't deserialize object of type "+typeof c)}const go={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function Tg(c){for(const n of c)if(Pd(n.charCodeAt(0)))return!0;return!1}function hy(c){for(const n of c)if(!V1(n.charCodeAt(0)))return!1;return!0}function V1(c){return!(go.Arabic(c)||go["Arabic Supplement"](c)||go["Arabic Extended-A"](c)||go["Arabic Presentation Forms-A"](c)||go["Arabic Presentation Forms-B"](c))}function Pd(c){return!(c!==746&&c!==747&&(c<4352||!(go["Bopomofo Extended"](c)||go.Bopomofo(c)||go["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||go["CJK Compatibility Ideographs"](c)||go["CJK Compatibility"](c)||go["CJK Radicals Supplement"](c)||go["CJK Strokes"](c)||!(!go["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||go["CJK Unified Ideographs Extension A"](c)||go["CJK Unified Ideographs"](c)||go["Enclosed CJK Letters and Months"](c)||go["Hangul Compatibility Jamo"](c)||go["Hangul Jamo Extended-A"](c)||go["Hangul Jamo Extended-B"](c)||go["Hangul Jamo"](c)||go["Hangul Syllables"](c)||go.Hiragana(c)||go["Ideographic Description Characters"](c)||go.Kanbun(c)||go["Kangxi Radicals"](c)||go["Katakana Phonetic Extensions"](c)||go.Katakana(c)&&c!==12540||!(!go["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!go["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||go["Unified Canadian Aboriginal Syllabics"](c)||go["Unified Canadian Aboriginal Syllabics Extended"](c)||go["Vertical Forms"](c)||go["Yijing Hexagram Symbols"](c)||go["Yi Syllables"](c)||go["Yi Radicals"](c))))}function Cg(c){return!(Pd(c)||function(n){return!!(go["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||go["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||go["Letterlike Symbols"](n)||go["Number Forms"](n)||go["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||go["Control Pictures"](n)&&n!==9251||go["Optical Character Recognition"](n)||go["Enclosed Alphanumerics"](n)||go["Geometric Shapes"](n)||go["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||go["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||go["CJK Symbols and Punctuation"](n)||go.Katakana(n)||go["Private Use Area"](n)||go["CJK Compatibility Forms"](n)||go["Small Form Variants"](n)||go["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function Kh(c){return c>=1424&&c<=2303||go["Arabic Presentation Forms-A"](c)||go["Arabic Presentation Forms-B"](c)}function fy(c,n){return!(!n&&Kh(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||go.Khmer(c))}function U1(c){for(const n of c)if(Kh(n.charCodeAt(0)))return!0;return!1}const Eg="deferred",Zh="loading",Yh="loaded";let mp=null,_a="unavailable",Ss=null;const py=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(_a="error"),mp&&mp(c)};function Mg(){Ig.fire(new wt("pluginStateChange",{pluginStatus:_a,pluginURL:Ss}))}const Ig=new Kn,Ag=function(){return _a},my=function(){if(_a!==Eg||!Ss)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_a=Zh,Mg(),Ss&&ru({url:Ss},c=>{c?py(c):(_a=Yh,Mg())})},Ts={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_a===Yh||Ts.applyArabicShaping!=null,isLoading:()=>_a===Zh,setState(c){_a=c.pluginStatus,Ss=c.pluginURL},isParsed:()=>Ts.applyArabicShaping!=null&&Ts.processBidirectionalText!=null&&Ts.processStyledBidirectionalText!=null,getPluginURL:()=>Ss};class Ei{constructor(n,a){this.zoom=n,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch,this.brightness=a.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(a,u){for(const g of a)if(!fy(g.charCodeAt(0),u))return!1;return!0}(n,Ts.isLoaded())}}class gp{constructor(n,a,u,g){this.property=n,this.value=a,this.expression=function(h,v,T,P){if(vg(h))return new hp(h,v);if(up(h)||Array.isArray(h)&&h.length>0){const O=$u(h,v,T,P);if(O.result==="error")throw new Error(O.value.map(x=>`${x.key}: ${x.message}`).join(", "));return O.value}{let O=h;return typeof h=="string"&&v.type==="color"&&(O=On.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>O}}}(a===void 0?n.specification.default:a,n.specification,u,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,a,u){return this.property.possiblyEvaluate(this,n,a,u)}}class kg{constructor(n,a,u){this.property=n,this.value=new gp(n,void 0,a,u)}transitioned(n,a){return new vy(this.property,this.value,a,mo({},n.transition,this.transition),n.now)}untransitioned(){return new vy(this.property,this.value,null,{},0)}}class gy{constructor(n,a,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=a,this._options=u,this.configDependencies=new Set}getValue(n){return et(this._values[n].value.value)}setValue(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new kg(this._values[n].property,this._scope,this._options)),this._values[n].value=new gp(this._values[n].property,a===null?void 0:et(a),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,a){a&&(this._options=a);const u=this._properties.properties;if(n)for(const g in n){const h=n[g];if(En(g,"-transition")){const v=g.slice(0,-11);u[v]&&this.setTransition(v,h)}else u.hasOwnProperty(g)&&this.setValue(g,h)}}getTransition(n){return et(this._values[n].transition)}setTransition(n,a){this._values.hasOwnProperty(n)||(this._values[n]=new kg(this._values[n].property)),this._values[n].transition=et(a)||void 0}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u);const g=this.getTransition(a);g!==void 0&&(n[`${a}-transition`]=g)}return n}transitioned(n,a){const u=new _y(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].transitioned(n,a._values[g]);return u}untransitioned(){const n=new _y(this._properties);for(const a of Object.keys(this._values))n._values[a]=this._values[a].untransitioned();return n}}class vy{constructor(n,a,u,g,h){const v=g.delay||0,T=g.duration||0;h=h||0,this.property=n,this.value=a,this.begin=h+v,this.end=this.begin+T,n.specification.transition&&(g.delay||g.duration)&&(this.prior=u)}possiblyEvaluate(n,a,u){const g=n.now||0,h=this.value.possiblyEvaluate(n,a,u),v=this.prior;if(v){if(g>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(g<this.begin)return v.possiblyEvaluate(n,a,u);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,a,u),h,bn(T))}}return h}}class _y{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,a,u){const g=new Ld(this._properties);for(const h of Object.keys(this._values))g._values[h]=this._values[h].possiblyEvaluate(n,a,u);return g}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class j1{constructor(n,a,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=a,this._options=u,this.configDependencies=new Set}getValue(n){return et(this._values[n].value)}setValue(n,a){this._values[n]=new gp(this._values[n].property,a===null?void 0:et(a),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(n[a]=u)}return n}possiblyEvaluate(n,a,u){const g=new Ld(this._properties);for(const h of Object.keys(this._values))g._values[h]=this._values[h].possiblyEvaluate(n,a,u);return g}}class Rd{constructor(n,a,u){this.property=n,this.value=a,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,a,u,g){return this.property.evaluate(this.value,this.parameters,n,a,u,g)}}class Ld{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Rn{constructor(n){this.specification=n}possiblyEvaluate(n,a){return n.expression.evaluate(a)}interpolate(n,a,u){const g=Ti[this.specification.type];return g?g(n,a,u):n}}class _o{constructor(n,a){this.specification=n,this.overrides=a}possiblyEvaluate(n,a,u,g){return new Rd(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(a,null,{},u,g)}:n.expression,a)}interpolate(n,a,u){if(n.value.kind!=="constant"||a.value.kind!=="constant")return n;if(n.value.value===void 0||a.value.value===void 0)return new Rd(this,{kind:"constant",value:void 0},n.parameters);const g=Ti[this.specification.type];return g?new Rd(this,{kind:"constant",value:g(n.value.value,a.value.value,u)},n.parameters):n}evaluate(n,a,u,g,h,v){return n.kind==="constant"?n.value:n.evaluate(a,u,g,h,v)}}class Od{constructor(n){this.specification=n}possiblyEvaluate(n,a,u,g){return!!n.expression.evaluate(a,null,{},u,g)}interpolate(){return!1}}class ci{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Ei(0,{});for(const u in n){const g=n[u];g.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new gp(g,void 0),v=this.defaultTransitionablePropertyValues[u]=new kg(g);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(a)}}}no(_o,"DataDrivenProperty"),no(Rn,"DataConstantProperty"),no(Od,"ColorRampProperty");var Ot=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,90],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"rain":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Pg(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function ju(c){if(Array.isArray(c))return c.map(ju);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const a in c)n[a]=ju(c[a]);return n}return Pg(c)}function Rg(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!Rg(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function vp(c,n="",a=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Rg(c)||(c=_p(c));const g=c;let h=!0;try{h=function(x){if(!ml(x))return x;let k=ju(x);return Lg(k),k=Cc(k),k}(g)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(g,null,2)}
        `)}let v=null,T=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){T=Ot[`filter_${u}`];const x=kd(h,T,n,a);if(x.result==="error")throw new Error(x.value.map(k=>`${k.key}: ${k.message}`).join(", "));v=(k,L,A)=>x.value.evaluate(k,L,{},A)}let P=null,O=null;if(h!==g){const x=kd(g,T,n,a);if(x.result==="error")throw new Error(x.value.map(k=>`${k.key}: ${k.message}`).join(", "));P=(k,L,A,R,$)=>x.value.evaluate(k,L,{},A,void 0,void 0,R,$),O=!li(x.value.expression)}return{filter:v,dynamicFilter:P||void 0,needGeometry:yy(h),needFeature:!!O}}function Cc(c){if(!Array.isArray(c))return c;const n=function(a){if(H1.has(a[0])){for(let u=1;u<a.length;u++)if(ml(a[u]))return!0}return a}(c);return n===!0?n:n.map(a=>Cc(a))}function Lg(c){let n=!1;const a=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)n=n||ml(c[u]),a.push(c[u+1]);a.push(c[c.length-1])}else if(c[0]==="match"){n=n||ml(c[1]);for(let u=2;u<c.length-1;u+=2)a.push(c[u+1]);a.push(c[c.length-1])}else if(c[0]==="step"){n=n||ml(c[1]);for(let u=1;u<c.length-1;u+=2)a.push(c[u+1])}n&&(c.length=0,c.push("any",...a));for(let u=1;u<c.length;u++)Lg(c[u])}function ml(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let a=1;a<c.length;a++)if(ml(c[a]))return!0;return!1}const H1=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function G1(c,n){return c<n?-1:c>n?1:0}function yy(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(yy(c[n]))return!0;return!1}function _p(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?Og(c[1],c[2],"=="):n==="!="?Hu(Og(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Og(c[1],c[2],n):n==="any"?(a=c.slice(1),["any"].concat(a.map(_p))):n==="all"?["all"].concat(c.slice(1).map(_p)):n==="none"?["all"].concat(c.slice(1).map(_p).map(Hu)):n==="in"?Dg(c[1],c.slice(2)):n==="!in"?Hu(Dg(c[1],c.slice(2))):n==="has"?yp(c[1]):n!=="!has"||Hu(yp(c[1]));var a}function Og(c,n,a){switch(c){case"$type":return[`filter-type-${a}`,n];case"$id":return[`filter-id-${a}`,n];default:return[`filter-${a}`,c,n]}}function Dg(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(a=>typeof a!=typeof n[0])?["filter-in-large",c,["literal",n.sort(G1)]]:["filter-in-small",c,["literal",n]]}}function yp(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Hu(c){return["!",c]}const Xh="";function bp(c,n){return n?`${c}${Xh}${n}`:c}const by="-transition",Vl=new Set(["fill","line","background","hillshade","raster"]);class Va extends Kn{constructor(n,a,u,g,h){if(super(),this.id=n.id,this.fqid=bp(this.id,u),this.type=n.type,this.scope=u,this.lut=g,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const v=kd(this.filter,Ot[`filter_${n.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),a.layout&&(this._unevaluatedLayout=new j1(a.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),a.paint){this._transitionablePaint=new gy(a.paint,this.scope,h);for(const v in n.paint)this.setPaintProperty(v,n.paint[v]);for(const v in n.layout)this.setLayoutProperty(v,n.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ld(a.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&Vl.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,a){if(this.type==="custom"&&n==="visibility")return void(this.visibility=a);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return En(n,by)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,a){const u=this._transitionablePaint,g=u._properties.properties;if(En(n,by)){const k=n.slice(0,-11);return g[k]&&u.setTransition(k,a||void 0),!1}if(!g[n])return!1;const h=u._values[n],v=h.value.isDataDriven(),T=h.value;u.setValue(n,a),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const P=u._values[n].value,O=P.isDataDriven(),x=En(n,"pattern")||n==="line-dasharray";return O||v||x||this._handleOverridablePaintPropertyUpdate(n,T,P)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,a,u){return null}_handleOverridablePaintPropertyUpdate(n,a,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,a)}serialize(){return un({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const a=this.paint.get(n);if(a instanceof Rd&&Nu(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=vp(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,a,u,g,h,v,T,P,O){}queryIntersectsMatchingFeature(n,a,u,g){}}const xy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Jh{constructor(n,a){this._structArray=n,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ui{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,a){return n._trim(),a&&(n.isTransferred=!0,a.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const a=Object.create(this.prototype);return a.arrayBuffer=n.arrayBuffer,a.length=n.length,a.capacity=n.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Mr(c,n=1){let a=0,u=0;return{members:c.map(g=>{const h=xy[g.type].BYTES_PER_ELEMENT,v=a=wy(a,Math.max(n,h)),T=g.components||1;return u=Math.max(u,h),a+=h*T,{name:g.name,type:g.type,components:T,offset:v}}),size:wy(a,Math.max(u,n)),alignment:n}}function wy(c,n){return Math.ceil(c/n)*n}class fu extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const g=2*n;return this.int16[g+0]=a,this.int16[g+1]=u,n}}fu.prototype.bytesPerElement=4,no(fu,"StructArrayLayout2i4");class xp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,a,u)}emplace(n,a,u,g){const h=3*n;return this.int16[h+0]=a,this.int16[h+1]=u,this.int16[h+2]=g,n}}xp.prototype.bytesPerElement=6,no(xp,"StructArrayLayout3i6");class Dd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,g)}emplace(n,a,u,g,h){const v=4*n;return this.int16[v+0]=a,this.int16[v+1]=u,this.int16[v+2]=g,this.int16[v+3]=h,n}}Dd.prototype.bytesPerElement=8,no(Dd,"StructArrayLayout4i8");class zg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,g,h)}emplace(n,a,u,g,h,v){const T=5*n;return this.int16[T+0]=a,this.int16[T+1]=u,this.int16[T+2]=g,this.int16[T+3]=h,this.int16[T+4]=v,n}}zg.prototype.bytesPerElement=10,no(zg,"StructArrayLayout5i10");class Qh extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,a,u,g,h,v,T)}emplace(n,a,u,g,h,v,T,P){const O=6*n,x=12*n,k=3*n;return this.int16[O+0]=a,this.int16[O+1]=u,this.uint8[x+4]=g,this.uint8[x+5]=h,this.uint8[x+6]=v,this.uint8[x+7]=T,this.float32[k+2]=P,n}}Qh.prototype.bytesPerElement=12,no(Qh,"StructArrayLayout2i4ub1f12");class Ec extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,g)}emplace(n,a,u,g,h){const v=4*n;return this.float32[v+0]=a,this.float32[v+1]=u,this.float32[v+2]=g,this.float32[v+3]=h,n}}Ec.prototype.bytesPerElement=16,no(Ec,"StructArrayLayout4f16");class pu extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,a,u)}emplace(n,a,u,g){const h=3*n;return this.float32[h+0]=a,this.float32[h+1]=u,this.float32[h+2]=g,n}}pu.prototype.bytesPerElement=12,no(pu,"StructArrayLayout3f12");class Mc extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,g,h)}emplace(n,a,u,g,h,v){const T=6*n,P=3*n;return this.uint16[T+0]=a,this.uint16[T+1]=u,this.uint16[T+2]=g,this.uint16[T+3]=h,this.float32[P+2]=v,n}}Mc.prototype.bytesPerElement=12,no(Mc,"StructArrayLayout4ui1f12");class wp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,g)}emplace(n,a,u,g,h){const v=4*n;return this.uint16[v+0]=a,this.uint16[v+1]=u,this.uint16[v+2]=g,this.uint16[v+3]=h,n}}wp.prototype.bytesPerElement=8,no(wp,"StructArrayLayout4ui8");class ef extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,g,h,v)}emplace(n,a,u,g,h,v,T){const P=6*n;return this.int16[P+0]=a,this.int16[P+1]=u,this.int16[P+2]=g,this.int16[P+3]=h,this.int16[P+4]=v,this.int16[P+5]=T,n}}ef.prototype.bytesPerElement=12,no(ef,"StructArrayLayout6i12");class zd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T,P,O,x,k,L){const A=this.length;return this.resize(A+1),this.emplace(A,n,a,u,g,h,v,T,P,O,x,k,L)}emplace(n,a,u,g,h,v,T,P,O,x,k,L,A){const R=12*n;return this.int16[R+0]=a,this.int16[R+1]=u,this.int16[R+2]=g,this.int16[R+3]=h,this.uint16[R+4]=v,this.uint16[R+5]=T,this.uint16[R+6]=P,this.uint16[R+7]=O,this.int16[R+8]=x,this.int16[R+9]=k,this.int16[R+10]=L,this.int16[R+11]=A,n}}zd.prototype.bytesPerElement=24,no(zd,"StructArrayLayout4i4ui4i24");class Fg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,g,h,v)}emplace(n,a,u,g,h,v,T){const P=10*n,O=5*n;return this.int16[P+0]=a,this.int16[P+1]=u,this.int16[P+2]=g,this.float32[O+2]=h,this.float32[O+3]=v,this.float32[O+4]=T,n}}Fg.prototype.bytesPerElement=20,no(Fg,"StructArrayLayout3i3f20");class Bg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint32[1*n+0]=a,n}}Bg.prototype.bytesPerElement=4,no(Bg,"StructArrayLayout1ul4");class mu extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const g=2*n;return this.uint16[g+0]=a,this.uint16[g+1]=u,n}}mu.prototype.bytesPerElement=4,no(mu,"StructArrayLayout2ui4");class Ng extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T,P,O,x,k,L,A){const R=this.length;return this.resize(R+1),this.emplace(R,n,a,u,g,h,v,T,P,O,x,k,L,A)}emplace(n,a,u,g,h,v,T,P,O,x,k,L,A,R){const $=20*n,W=10*n;return this.int16[$+0]=a,this.int16[$+1]=u,this.int16[$+2]=g,this.int16[$+3]=h,this.int16[$+4]=v,this.float32[W+3]=T,this.float32[W+4]=P,this.float32[W+5]=O,this.float32[W+6]=x,this.int16[$+14]=k,this.uint32[W+8]=L,this.uint16[$+18]=A,this.uint16[$+19]=R,n}}Ng.prototype.bytesPerElement=40,no(Ng,"StructArrayLayout5i4f1i1ul2ui40");class Sp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,a,u,g,h,v,T)}emplace(n,a,u,g,h,v,T,P){const O=8*n;return this.int16[O+0]=a,this.int16[O+1]=u,this.int16[O+2]=g,this.int16[O+4]=h,this.int16[O+5]=v,this.int16[O+6]=T,this.int16[O+7]=P,n}}Sp.prototype.bytesPerElement=16,no(Sp,"StructArrayLayout3i2i2i16");class Fd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,g,h)}emplace(n,a,u,g,h,v){const T=4*n,P=8*n;return this.float32[T+0]=a,this.float32[T+1]=u,this.float32[T+2]=g,this.int16[P+6]=h,this.int16[P+7]=v,n}}Fd.prototype.bytesPerElement=16,no(Fd,"StructArrayLayout2f1f2i16");class Bd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,a,u,g,h,v)}emplace(n,a,u,g,h,v,T){const P=20*n,O=5*n;return this.uint8[P+0]=a,this.uint8[P+1]=u,this.float32[O+1]=g,this.float32[O+2]=h,this.float32[O+3]=v,this.float32[O+4]=T,n}}Bd.prototype.bytesPerElement=20,no(Bd,"StructArrayLayout2ub4f20");class bi extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,a,u)}emplace(n,a,u,g){const h=3*n;return this.uint16[h+0]=a,this.uint16[h+1]=u,this.uint16[h+2]=g,n}}bi.prototype.bytesPerElement=6,no(bi,"StructArrayLayout3ui6");class Nd extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y,re,ie,Q,ue){const _e=this.length;return this.resize(_e+1),this.emplace(_e,n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y,re,ie,Q,ue)}emplace(n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y,re,ie,Q,ue,_e){const Ie=30*n,Ge=15*n,ze=60*n;return this.int16[Ie+0]=a,this.int16[Ie+1]=u,this.int16[Ie+2]=g,this.float32[Ge+2]=h,this.float32[Ge+3]=v,this.uint16[Ie+8]=T,this.uint16[Ie+9]=P,this.uint32[Ge+5]=O,this.uint32[Ge+6]=x,this.uint32[Ge+7]=k,this.uint16[Ie+16]=L,this.uint16[Ie+17]=A,this.uint16[Ie+18]=R,this.float32[Ge+10]=$,this.float32[Ge+11]=W,this.uint8[ze+48]=Y,this.uint8[ze+49]=re,this.uint8[ze+50]=ie,this.uint32[Ge+13]=Q,this.int16[Ie+28]=ue,this.uint8[ze+58]=_e,n}}Nd.prototype.bytesPerElement=60,no(Nd,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class $g extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt)}emplace(n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y,re,ie,Q,ue,_e,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt,Lt){const Ft=20*n,Pt=40*n,sn=80*n;return this.float32[Ft+0]=a,this.float32[Ft+1]=u,this.int16[Pt+4]=g,this.int16[Pt+5]=h,this.int16[Pt+6]=v,this.int16[Pt+7]=T,this.int16[Pt+8]=P,this.int16[Pt+9]=O,this.int16[Pt+10]=x,this.int16[Pt+11]=k,this.int16[Pt+12]=L,this.uint16[Pt+13]=A,this.uint16[Pt+14]=R,this.uint16[Pt+15]=$,this.uint16[Pt+16]=W,this.uint16[Pt+17]=Y,this.uint16[Pt+18]=re,this.uint16[Pt+19]=ie,this.uint16[Pt+20]=Q,this.uint16[Pt+21]=ue,this.uint16[Pt+22]=_e,this.uint16[Pt+23]=Ie,this.uint16[Pt+24]=Ge,this.uint16[Pt+25]=ze,this.uint16[Pt+26]=$e,this.uint16[Pt+27]=st,this.uint32[Ft+14]=Fe,this.float32[Ft+15]=rt,this.float32[Ft+16]=ht,this.float32[Ft+17]=pt,this.float32[Ft+18]=Tt,this.uint8[sn+76]=Lt,n}}$g.prototype.bytesPerElement=80,no($g,"StructArrayLayout2f9i15ui1ul4f1ub80");class $d extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.float32[1*n+0]=a,n}}$d.prototype.bytesPerElement=4,no($d,"StructArrayLayout1f4");class Gu extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,a,u,g,h)}emplace(n,a,u,g,h,v){const T=5*n;return this.float32[T+0]=a,this.float32[T+1]=u,this.float32[T+2]=g,this.float32[T+3]=h,this.float32[T+4]=v,n}}Gu.prototype.bytesPerElement=20,no(Gu,"StructArrayLayout5f20");class Vg extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,a,u,g,h,v,T)}emplace(n,a,u,g,h,v,T,P){const O=7*n;return this.float32[O+0]=a,this.float32[O+1]=u,this.float32[O+2]=g,this.float32[O+3]=h,this.float32[O+4]=v,this.float32[O+5]=T,this.float32[O+6]=P,n}}Vg.prototype.bytesPerElement=28,no(Vg,"StructArrayLayout7f28");class Tp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T,P,O,x,k){const L=this.length;return this.resize(L+1),this.emplace(L,n,a,u,g,h,v,T,P,O,x,k)}emplace(n,a,u,g,h,v,T,P,O,x,k,L){const A=11*n;return this.float32[A+0]=a,this.float32[A+1]=u,this.float32[A+2]=g,this.float32[A+3]=h,this.float32[A+4]=v,this.float32[A+5]=T,this.float32[A+6]=P,this.float32[A+7]=O,this.float32[A+8]=x,this.float32[A+9]=k,this.float32[A+10]=L,n}}Tp.prototype.bytesPerElement=44,no(Tp,"StructArrayLayout11f44");class Sy extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T,P,O){const x=this.length;return this.resize(x+1),this.emplace(x,n,a,u,g,h,v,T,P,O)}emplace(n,a,u,g,h,v,T,P,O,x){const k=9*n;return this.float32[k+0]=a,this.float32[k+1]=u,this.float32[k+2]=g,this.float32[k+3]=h,this.float32[k+4]=v,this.float32[k+5]=T,this.float32[k+6]=P,this.float32[k+7]=O,this.float32[k+8]=x,n}}Sy.prototype.bytesPerElement=36,no(Sy,"StructArrayLayout9f36");class tf extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,a,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,a,u,g)}emplace(n,a,u,g,h){const v=6*n;return this.uint32[3*n+0]=a,this.uint16[v+2]=u,this.uint16[v+3]=g,this.uint16[v+4]=h,n}}tf.prototype.bytesPerElement=12,no(tf,"StructArrayLayout1ul3ui12");class Ug extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint16[1*n+0]=a,n}}Ug.prototype.bytesPerElement=2,no(Ug,"StructArrayLayout1ui2");class nf extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a){const u=this.length;return this.resize(u+1),this.emplace(u,n,a)}emplace(n,a,u){const g=2*n;return this.float32[g+0]=a,this.float32[g+1]=u,n}}nf.prototype.bytesPerElement=8,no(nf,"StructArrayLayout2f8");class of extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W){const Y=this.length;return this.resize(Y+1),this.emplace(Y,n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W)}emplace(n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y){const re=16*n;return this.float32[re+0]=a,this.float32[re+1]=u,this.float32[re+2]=g,this.float32[re+3]=h,this.float32[re+4]=v,this.float32[re+5]=T,this.float32[re+6]=P,this.float32[re+7]=O,this.float32[re+8]=x,this.float32[re+9]=k,this.float32[re+10]=L,this.float32[re+11]=A,this.float32[re+12]=R,this.float32[re+13]=$,this.float32[re+14]=W,this.float32[re+15]=Y,n}}of.prototype.bytesPerElement=64,no(of,"StructArrayLayout16f64");class Cp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,a,u,g,h,v,T){const P=this.length;return this.resize(P+1),this.emplace(P,n,a,u,g,h,v,T)}emplace(n,a,u,g,h,v,T,P){const O=10*n,x=5*n;return this.uint16[O+0]=a,this.uint16[O+1]=u,this.uint16[O+2]=g,this.uint16[O+3]=h,this.float32[x+2]=v,this.float32[x+3]=T,this.float32[x+4]=P,n}}Cp.prototype.bytesPerElement=20,no(Cp,"StructArrayLayout4ui3f20");class Ep extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.int16[1*n+0]=a,n}}Ep.prototype.bytesPerElement=2,no(Ep,"StructArrayLayout1i2");class Mp extends ui{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const a=this.length;return this.resize(a+1),this.emplace(a,n)}emplace(n,a){return this.uint8[1*n+0]=a,n}}Mp.prototype.bytesPerElement=1,no(Mp,"StructArrayLayout1ub1");class Ty extends Jh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ty.prototype.size=40;class Ip extends Ng{get(n){return new Ty(this,n)}}no(Ip,"CollisionBoxArray");class rf extends Jh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}rf.prototype.size=60;class jg extends Nd{get(n){return new rf(this,n)}}no(jg,"PlacedSymbolArray");class Cy extends Jh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Cy.prototype.size=80;class Hg extends $g{get(n){return new Cy(this,n)}}no(Hg,"SymbolInstanceArray");class Ey extends $d{getoffsetX(n){return this.float32[1*n+0]}}no(Ey,"GlyphOffsetArray");class Ap extends fu{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}no(Ap,"SymbolLineVertexArray");class My extends Jh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}My.prototype.size=12;class Iy extends tf{get(n){return new My(this,n)}}no(Iy,"FeatureIndexArray");class Ay extends mu{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}no(Ay,"FillExtrusionCentroidArray");class ky extends Jh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ky.prototype.size=6;class Gg extends xp{get(n){return new ky(this,n)}}no(Gg,"FillExtrusionWallArray");const W1=Mr([{name:"a_pos",components:2,type:"Int16"}],4),q1=Mr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ki{constructor(n=[]){this.segments=n}_prepareSegment(n,a,u,g){let h=this.segments[this.segments.length-1];return n>ki.MAX_VERTEX_ARRAY_LENGTH&&Bn(`Max vertices per segment is ${ki.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!h||h.vertexLength+n>ki.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==g)&&(h={vertexOffset:a,primitiveOffset:u,vertexLength:0,primitiveLength:0},g!==void 0&&(h.sortKey=g),this.segments.push(h)),h}prepareSegment(n,a,u,g){return this._prepareSegment(n,a.length,u.length,g)}get(){return this.segments}destroy(){for(const n of this.segments)for(const a in n.vaos)n.vaos[a].destroy()}static simpleSegment(n,a,u,g){return new ki([{vertexOffset:n,primitiveOffset:a,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])}}function Py(c,n){return 256*(c=yt(Math.floor(c),0,255))+yt(Math.floor(n),0,255)}ki.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,no(ki,"SegmentVector");const K1=Mr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Z1=Mr([{name:"a_dash",components:4,type:"Uint16"}]);class af{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,a,u,g){this.ids.push(Ry(n)),this.positions.push(a,u,g)}eachPosition(n,a){const u=Ry(n);let g=0,h=this.ids.length-1;for(;g<h;){const v=g+h>>1;this.ids[v]>=u?h=v:g=v+1}for(;this.ids[g]===u;)a(this.positions[3*g],this.positions[3*g+1],this.positions[3*g+2]),g++}static serialize(n,a){const u=new Float64Array(n.ids),g=new Uint32Array(n.positions);return Vd(u,g,0,u.length-1),a&&(a.add(u.buffer),a.add(g.buffer)),{ids:u,positions:g}}static deserialize(n){const a=new af;let u;a.ids=n.ids,a.positions=n.positions;for(const g of a.ids)g!==u&&a.uniqueIds.push(g),u=g;return a.indexed=!0,a}}function Ry(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:Ue(String(c))}function Vd(c,n,a,u){for(;a<u;){const g=c[a+u>>1];let h=a-1,v=u+1;for(;;){do h++;while(c[h]<g);do v--;while(c[v]>g);if(h>=v)break;kp(c,h,v),kp(n,3*h,3*v),kp(n,3*h+1,3*v+1),kp(n,3*h+2,3*v+2)}v-a<u-v?(Vd(c,n,a,v),a=v+1):(Vd(c,n,v+1,u),u=v)}}function kp(c,n,a){const u=c[n];c[n]=c[a],c[a]=u}no(af,"FeaturePositionMap");class Ic{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,a),this.initialized=!0),!!this.location}set(n,a,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Wu extends Ic{constructor(n){super(n),this.current=0}set(n,a,u){this.fetchUniformLocation(n,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class Qi extends Ic{constructor(n){super(n),this.current=0}set(n,a,u){this.fetchUniformLocation(n,a)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Ul extends Ic{constructor(n){super(n),this.current=[0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class Wg extends Ic{constructor(n){super(n),this.current=[0,0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Pp extends Ic{constructor(n){super(n),this.current=[0,0,0,0]}set(n,a,u){this.fetchUniformLocation(n,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class qg extends Ic{constructor(n){super(n),this.current=On.transparent.toRenderColor(null)}set(n,a,u){this.fetchUniformLocation(n,a)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const Ly=new Float32Array(16);class sf extends Ic{constructor(n){super(n),this.current=Ly}set(n,a,u){if(this.fetchUniformLocation(n,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let g=1;g<16;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const Y1=new Float32Array(9),Oy=new Float32Array(4);class Rp extends Ic{constructor(n){super(n),this.current=Oy}set(n,a,u){if(this.fetchUniformLocation(n,a)){for(let g=0;g<4;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function Kg(c){return[Py(255*c.r,255*c.g),Py(255*c.b,255*c.a)]}class lf{constructor(n,a,u,g){this.value=n,this.uniformNames=a.map(h=>`u_${h}`),this.type=u,this.context=g}setUniform(n,a,u,g,h){const v=g.constantOr(this.value);a.set(n,h,v instanceof On?v.toRenderColor(this.context.lut):v)}getBinding(n,a){return this.type==="color"?new qg(n):new Qi(n)}}class Ud{constructor(n,a){this.uniformNames=a.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,a,u,g,h){const v=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;v&&a.set(n,h,v)}getBinding(n,a){return a==="u_pattern"||a==="u_dash"?new Pp(n):new Qi(n)}}class Ac{constructor(n,a,u,g){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(n,a,u,g,h,v,T){const P=this.paintVertexArray.length,O=this.expression.evaluate(new Ei(0,{brightness:v}),a,{},h,g,T);this.paintVertexArray.resize(n),this._setPaintValue(P,n,O,this.context)}updatePaintArray(n,a,u,g,h,v,T){const P=this.expression.evaluate({zoom:0,brightness:T},u,g,void 0,h);this._setPaintValue(n,a,P,this.context)}_setPaintValue(n,a,u,g){if(this.type==="color"){const h=Kg(u.toRenderColor(g.lut));for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,h[0],h[1])}else{for(let h=n;h<a;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class gl{constructor(n,a,u,g,h,v){this.expression=n,this.uniformNames=a.map(T=>`u_${T}_t`),this.type=u,this.useIntegerZoom=g,this.context=h,this.maxValue=0,this.paintVertexAttributes=a.map(T=>({name:`a_${T}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,a,u,g,h,v,T){const P=this.expression.evaluate(new Ei(this.context.zoom,{brightness:v}),a,{},h,g,T),O=this.expression.evaluate(new Ei(this.context.zoom+1,{brightness:v}),a,{},h,g,T),x=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(x,n,P,O,this.context)}updatePaintArray(n,a,u,g,h,v,T){const P=this.expression.evaluate({zoom:this.context.zoom,brightness:T},u,g,void 0,h),O=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},u,g,void 0,h);this._setPaintValue(n,a,P,O,this.context)}_setPaintValue(n,a,u,g,h){if(this.type==="color"){const v=Kg(u.toRenderColor(h.lut)),T=Kg(u.toRenderColor(h.lut));for(let P=n;P<a;P++)this.paintVertexArray.emplace(P,v[0],v[1],T[0],T[1])}else{for(let v=n;v<a;v++)this.paintVertexArray.emplace(v,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,a,u,g,h){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,T=yt(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);a.set(n,h,T)}getBinding(n,a){return new Qi(n)}}class kc{constructor(n,a,u,g,h){this.expression=n,this.layerId=h,this.paintVertexAttributes=(u==="array"?Z1:K1).members;for(let v=0;v<a.length;++v);this.paintVertexArray=new g}populatePaintArray(n,a,u,g){const h=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(h,n,a.patterns&&a.patterns[this.layerId],u)}updatePaintArray(n,a,u,g,h,v,T){this._setPaintValues(n,a,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(n,a,u,g){if(!g||!u)return;const h=g[u];if(!h)return;const{tl:v,br:T,pixelRatio:P}=h;for(let O=n;O<a;O++)this.paintVertexArray.emplace(O,v[0],v[1],T[0],T[1],P)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Pc{constructor(n,a,u=()=>!0){this.binders={},this._buffers=[],this.context=a;const g=[];for(const h in n.paint._values){const v=n.paint.get(h);if(!u(h)||!(v instanceof Rd&&Nu(v.property.specification)))continue;const T=J1(h,n.type),P=v.value,O=v.property.specification.type,x=!!v.property.useIntegerZoom,k=h==="line-dasharray"||h.endsWith("pattern"),L=h==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(P.kind!=="constant"||L)if(P.kind==="source"||L||k){const A=Dy(h,O,"source");this.binders[h]=k?new kc(P,T,O,A,n.id):new Ac(P,T,O,A),g.push(`/a_${h}`)}else{const A=Dy(h,O,"composite");this.binders[h]=new gl(P,T,O,x,a,A),g.push(`/z_${h}`)}else this.binders[h]=k?new Ud(P.value,T):new lf(P.value,T,O,a),g.push(`/u_${h}`)}this.cacheKey=g.sort().join("")}getMaxValue(n){const a=this.binders[n];return a instanceof Ac||a instanceof gl?a.maxValue:0}populatePaintArrays(n,a,u,g,h,v,T){for(const P in this.binders){const O=this.binders[P];O.context=this.context,(O instanceof Ac||O instanceof gl||O instanceof kc)&&O.populatePaintArray(n,a,u,g,h,v,T)}}setConstantPatternPositions(n){for(const a in this.binders){const u=this.binders[a];u instanceof Ud&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,a,u,g,h,v,T,P){let O=!1;const x=Object.keys(n),k=x.length!==0,L=k?x:a.uniqueIds;this.context.lut=h.lut;for(const A in this.binders){const R=this.binders[A];if(R.context=this.context,(R instanceof Ac||R instanceof gl||R instanceof kc)&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){const $=h.paint.get(A);R.expression=$.value;for(const W of L){const Y=n[W.toString()];a.eachPosition(W,(re,ie,Q)=>{const ue=g.feature(re);R.updatePaintArray(ie,Q,ue,Y,v,T,P)})}if(!k)for(const W of u.uniqueIds){const Y=n[W.toString()];u.eachPosition(W,(re,ie,Q)=>{const ue=g.feature(re);R.updatePaintArray(ie,Q,ue,Y,v,T,P)})}O=!0}}return O}defines(){const n=[];for(const a in this.binders){const u=this.binders[a];(u instanceof lf||u instanceof Ud)&&n.push(...u.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return n}getBinderAttributes(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Ac||u instanceof gl||u instanceof kc)for(let g=0;g<u.paintVertexAttributes.length;g++)n.push(u.paintVertexAttributes[g].name)}return n}getBinderUniforms(){const n=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof lf||u instanceof Ud||u instanceof gl)for(const g of u.uniformNames)n.push(g)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const a=[];for(const u in this.binders){const g=this.binders[u];if(g instanceof lf||g instanceof Ud||g instanceof gl)for(const h of g.uniformNames)a.push({name:h,property:u,binding:g.getBinding(n,h)})}return a}setUniforms(n,a,u,g,h){for(const{name:v,property:T,binding:P}of u)this.binders[T].setUniform(n,P,h,g.get(T),v)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const a=this.binders[n];(a instanceof Ac||a instanceof gl||a instanceof kc)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(n){for(const a in this.binders){const u=this.binders[a];(u instanceof Ac||u instanceof gl||u instanceof kc)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const a=this.binders[n];(a instanceof Ac||a instanceof gl||a instanceof kc)&&a.destroy()}}}class jl{constructor(n,a,u=()=>!0){this.programConfigurations={};for(const g of n)this.programConfigurations[g.id]=new Pc(g,a,u);this.needsUpload=!1,this._featureMap=new af,this._featureMapWithoutIds=new af,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,a,u,g,h,v,T,P){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(n,a,g,h,v,T,P);a.id!==void 0?this._featureMap.add(a.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,a,u,g,h,v){for(const T of u)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,a,T,g,h,v||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const X1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function J1(c,n){return X1[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const Q1={"line-pattern":{source:Mc,composite:Mc},"fill-pattern":{source:Mc,composite:Mc},"fill-extrusion-pattern":{source:Mc,composite:Mc},"line-dasharray":{source:wp,composite:wp}},ex={color:{source:nf,composite:Ec},number:{source:$d,composite:nf}};function Dy(c,n,a){const u=Q1[c];return u&&u[a]||ex[n][a]}no(lf,"ConstantBinder"),no(Ud,"PatternConstantBinder"),no(Ac,"SourceExpressionBinder"),no(kc,"PatternCompositeBinder"),no(gl,"CompositeExpressionBinder"),no(Pc,"ProgramConfiguration",{omit:["_buffers"]}),no(jl,"ProgramConfigurationSet");const ya=Nn/Math.PI/2,zy=5,f=6,r=16383,l=64,m=[l,32,16],b=-ya,S=ya;function E(c,n,a,u=ya){return a=Et(a),[c*Math.sin(a)*u,-n*u,c*Math.cos(a)*u]}function z(c,n,a){return E(Math.cos(Et(c)),Math.sin(Et(c)),n,a)}const V=63710088e-1,q=2*Math.PI*V;class H{constructor(n,a){if(isNaN(n)||isNaN(a))throw new Error(`Invalid LngLat object: (${n}, ${a})`);if(this.lng=+n,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new H(qn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const a=Math.PI/180,u=this.lat*a,g=n.lat*a,h=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((n.lng-this.lng)*a);return V*Math.acos(Math.min(h,1))}toBounds(n=0){const a=360*n/40075017,u=a/Math.cos(Math.PI/180*this.lat);return new X({lng:this.lng-u,lat:this.lat-a},{lng:this.lng+u,lat:this.lat+a})}toEcef(n){return z(this.lat,this.lng,ya+n*ya/V)}static convert(n){if(n instanceof H)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new H(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new H(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class X{constructor(n,a){if(n)if(a)this.setSouthWest(n).setNorthEast(a);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof H?new H(n.lng,n.lat):H.convert(n),this}setSouthWest(n){return this._sw=n instanceof H?new H(n.lng,n.lat):H.convert(n),this}extend(n){const a=this._sw,u=this._ne;let g,h;if(n instanceof H)g=n,h=n;else{if(!(n instanceof X))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(X.convert(n)):this.extend(H.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(H.convert(n)):this;if(g=n._sw,h=n._ne,!g||!h)return this}return a||u?(a.lng=Math.min(g.lng,a.lng),a.lat=Math.min(g.lat,a.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new H(g.lng,g.lat),this._ne=new H(h.lng,h.lat)),this}getCenter(){return new H((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new H(this.getWest(),this.getNorth())}getSouthEast(){return new H(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:a,lat:u}=H.convert(n);let g=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&g}static convert(n){if(n)return n instanceof X?n:new X(n)}}const ee=0,ae=25.5;function be(c){return q*Math.cos(c*Math.PI/180)}function ye(c){return(180+c)/360}function Te(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Se(c,n){return c/be(n)}function De(c){return 360*c-180}function je(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function He(c,n){return c*be(je(n))}const Ye=85.051129;function tt(c){return Math.cos(Et(yt(c,-Ye,Ye)))}function Xe(c,n){const a=yt(n,ee,ae),u=Math.pow(2,a);return tt(c)*q/(512*u)}function nt(c){return 1/Math.cos(c*Math.PI/180)}function lt(c,n=0){const a=Math.exp(Math.PI*(1-(c.y+n/Nn)/(1<<c.z)*2));return 80150034*a/(a*a+1)/Nn/(1<<c.z)}class vt{constructor(n,a,u=0){this.x=+n,this.y=+a,this.z=+u}static fromLngLat(n,a=0){const u=H.convert(n);return new vt(ye(u.lng),Te(u.lat),Se(a,u.lat))}toLngLat(){return new H(De(this.x),je(this.y))}toAltitude(){return He(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/q*nt(je(this.y))}}function dt(c,n,a,u,g,h,v,T,P){const O=(n+u)/2,x=(a+g)/2,k=new Be(O,x);T(k),function(L,A,R,$,W,Y){const re=R-W,ie=$-Y;return Math.abs(($-A)*re-(R-L)*ie)/Math.hypot(re,ie)}(k.x,k.y,h.x,h.y,v.x,v.y)>=P?(dt(c,n,a,O,x,h,k,T,P),dt(c,O,x,u,g,k,v,T,P)):c.push(v)}function ct(c,n,a){let u=c[0],g=u.x,h=u.y;n(u);const v=[u];for(let T=1;T<c.length;T++){const P=c[T],{x:O,y:x}=P;n(P),dt(v,g,h,O,x,u,P,n,a),g=O,h=x,u=P}return v}function jt(c,n,a,u){if(u(n,a)){const g=n.add(a)._mult(.5);jt(c,n,g,u),jt(c,g,a,u)}else c.push(a)}function en(c,n){let a=c[0];const u=[a];for(let g=1;g<c.length;g++){const h=c[g];jt(u,a,h,n),a=h}return u}const gn=Math.pow(2,14)-1,An=-gn-1;function Dn(c,n){const a=Math.round(c.x*n),u=Math.round(c.y*n);return c.x=yt(a,An,gn),c.y=yt(u,An,gn),(a<c.x||a>c.x+1||u<c.y||u>c.y+1)&&Bn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function It(c,n,a){const u=c.loadGeometry(),g=c.extent,h=Nn/g;if(n&&a&&a.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:T,x:P,y:O,projection:x}=a,k=L=>{const A=De((n.x+L.x/g)/v),R=je((n.y+L.y/g)/v),$=x.project(A,R);L.x=($.x*T-P)*g,L.y=($.y*T-O)*g};for(let L=0;L<u.length;L++)if(c.type!==1)u[L]=ct(u[L],k,1);else{const A=[];for(const R of u[L])R.x<0||R.x>=g||R.y<0||R.y>=g||(k(R),A.push(R));u[L]=A}}for(const v of u)for(const T of v)Dn(T,h);return u}function pn(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?It(c):[]}}function Xt(c,n,a,u,g){c.emplaceBack(2*n+(u+1)/2,2*a+(g+1)/2)}function mn(c,n,a){c.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}class wn{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new fu,this.indexArray=new bi,this.segments=new ki,this.programConfigurations=new jl(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}updateFootprints(n,a){}populate(n,a,u,g){const h=this.layers[0],v=[];let T=null;h.type==="circle"&&(T=h.layout.get("circle-sort-key"));for(const{feature:O,id:x,index:k,sourceLayerIndex:L}of n){const A=this.layers[0]._featureFilter.needGeometry,R=pn(O,A);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),R,u))continue;const $=T?T.evaluate(R,{},u):void 0,W={id:x,properties:O.properties,type:O.type,sourceLayerIndex:L,index:k,geometry:A?R.geometry:It(O,u,g),patterns:{},sortKey:$};v.push(W)}T&&v.sort((O,x)=>O.sortKey-x.sortKey);let P=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new ef,P=g.projection);for(const O of v){const{geometry:x,index:k,sourceLayerIndex:L}=O,A=n[k].feature;this.addFeature(O,x,k,a.availableImages,u,P,a.brightness),a.featureIndex.insert(A,x,k,L,this.index)}}update(n,a,u,g,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,a,v?this.stateDependentLayers:this.layers,u,g,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,W1.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,q1.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,a,u,g,h,v,T){for(const P of a)for(const O of P){const x=O.x,k=O.y;if(x<0||x>=Nn||k<0||k>=Nn)continue;if(v){const R=v.projectTilePoint(x,k,h),$=v.upVector(h,x,k),W=this.globeExtVertexArray;mn(W,R,$),mn(W,R,$),mn(W,R,$),mn(W,R,$)}const L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),A=L.vertexLength;Xt(this.layoutVertexArray,x,k,-1,-1),Xt(this.layoutVertexArray,x,k,1,-1),Xt(this.layoutVertexArray,x,k,1,1),Xt(this.layoutVertexArray,x,k,-1,1),this.indexArray.emplaceBack(A,A+1,A+2),this.indexArray.emplaceBack(A,A+2,A+3),L.vertexLength+=4,L.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},g,h,T)}}function hn(c,n){for(let a=0;a<c.length;a++)if(mr(n,c[a]))return!0;for(let a=0;a<n.length;a++)if(mr(c,n[a]))return!0;return!!ro(c,n)}function Vn(c,n,a){return!!mr(c,n)||!!Wn(n,c,a)}function fo(c,n){if(c.length===1)return Ko(n,c[0]);for(let a=0;a<n.length;a++){const u=n[a];for(let g=0;g<u.length;g++)if(mr(c,u[g]))return!0}for(let a=0;a<c.length;a++)if(Ko(n,c[a]))return!0;for(let a=0;a<n.length;a++)if(ro(c,n[a]))return!0;return!1}function xo(c,n,a){if(c.length>1){if(ro(c,n))return!0;for(let u=0;u<n.length;u++)if(Wn(n[u],c,a))return!0}for(let u=0;u<c.length;u++)if(Wn(c[u],n,a))return!0;return!1}function ro(c,n){if(c.length===0||n.length===0)return!1;for(let a=0;a<c.length-1;a++){const u=c[a],g=c[a+1];for(let h=0;h<n.length-1;h++)if(So(u,g,n[h],n[h+1]))return!0}return!1}function So(c,n,a,u){return Lo(c,a,u)!==Lo(n,a,u)&&Lo(c,n,a)!==Lo(c,n,u)}function Wn(c,n,a){const u=a*a;if(n.length===1)return c.distSqr(n[0])<u;for(let g=1;g<n.length;g++)if(Ro(c,n[g-1],n[g])<u)return!0;return!1}function Ro(c,n,a){const u=n.distSqr(a);if(u===0)return c.distSqr(n);const g=((c.x-n.x)*(a.x-n.x)+(c.y-n.y)*(a.y-n.y))/u;return c.distSqr(g<0?n:g>1?a:a.sub(n)._mult(g)._add(n))}function Ko(c,n){let a,u,g,h=!1;for(let v=0;v<c.length;v++){a=c[v];for(let T=0,P=a.length-1;T<a.length;P=T++)u=a[T],g=a[P],u.y>n.y!=g.y>n.y&&n.x<(g.x-u.x)*(n.y-u.y)/(g.y-u.y)+u.x&&(h=!h)}return h}function mr(c,n){let a=!1;for(let u=0,g=c.length-1;u<c.length;g=u++){const h=c[u],v=c[g];h.y>n.y!=v.y>n.y&&n.x<(v.x-h.x)*(n.y-h.y)/(v.y-h.y)+h.x&&(a=!a)}return a}function Kr(c,n,a,u,g){for(const v of c)if(n<=v.x&&a<=v.y&&u>=v.x&&g>=v.y)return!0;const h=[new Be(n,a),new Be(n,g),new Be(u,g),new Be(u,a)];if(c.length>2){for(const v of h)if(mr(c,v))return!0}for(let v=0;v<c.length-1;v++)if(Sr(c[v],c[v+1],h))return!0;return!1}function Sr(c,n,a){const u=a[0],g=a[2];if(c.x<u.x&&n.x<u.x||c.x>g.x&&n.x>g.x||c.y<u.y&&n.y<u.y||c.y>g.y&&n.y>g.y)return!1;const h=Lo(c,n,a[0]);return h!==Lo(c,n,a[1])||h!==Lo(c,n,a[2])||h!==Lo(c,n,a[3])}function ii(c,n,a,u,g,h){let v=n.y-c.y,T=c.x-n.x;if(h=h||0){const P=v*v+T*T;if(P===0)return!0;const O=Math.sqrt(P);v/=O,T/=O}return!((a.x-c.x)*v+(a.y-c.y)*T-h<0||(u.x-c.x)*v+(u.y-c.y)*T-h<0||(g.x-c.x)*v+(g.y-c.y)*T-h<0)}function kr(c,n,a,u,g,h,v){return!(ii(c,n,u,g,h,v)||ii(n,a,u,g,h,v)||ii(a,c,u,g,h,v)||ii(u,g,c,n,a,v)||ii(g,h,c,n,a,v)||ii(h,u,c,n,a,v))}function Zr(c,n,a){const u=n.paint.get(c).value;return u.kind==="constant"?u.value:a.programConfigurations.get(n.id).getMaxValue(c)}function sr(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Gr(c,n,a,u,g){if(!n[0]&&!n[1])return c;const h=Be.convert(n)._mult(g);a==="viewport"&&h._rotate(-u);const v=[];for(let T=0;T<c.length;T++)v.push(c[T].sub(h));return v}function Ur(c,n,a,u){const g=Be.convert(c)._mult(u);return n==="viewport"&&g._rotate(-a),g}let Or,fi;no(wn,"CircleBucket",{omit:["layers"]});var Yi,Cs={exports:{}},Ys=(Yi||(Yi=1,function(c,n){(function(a){function u(h,v,T){var P=g(256*h,256*(v=Math.pow(2,T)-v-1),T),O=g(256*(h+1),256*(v+1),T);return P[0]+","+P[1]+","+O[0]+","+O[1]}function g(h,v,T){var P=2*Math.PI*6378137/256/Math.pow(2,T);return[h*P-2*Math.PI*6378137/2,v*P-2*Math.PI*6378137/2]}a.getURL=function(h,v,T,P,O,x){return x=x||{},h+"?"+["bbox="+u(T,P,O),"format="+(x.format||"image/png"),"service="+(x.service||"WMS"),"version="+(x.version||"1.1.1"),"request="+(x.request||"GetMap"),"srs="+(x.srs||"EPSG:3857"),"width="+(x.width||256),"height="+(x.height||256),"layers="+v].join("&")},a.getTileBBox=u,a.getMercCoords=g,Object.defineProperty(a,"__esModule",{value:!0})})(n)}(0,Cs.exports)),Cs.exports);class ea{constructor(n,a,u){this.z=n,this.x=a,this.y=u,this.key=Pr(0,n,n,a,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,a){const u=Ys.getTileBBox(this.x,this.y,this.z),g=function(h,v,T){let P,O="";for(let x=h;x>0;x--)P=1<<x-1,O+=(v&P?1:0)+(T&P?2:0);return O}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class wr{constructor(n,a){this.wrap=n,this.canonical=a,this.key=Pr(n,a.z,a.z,a.x,a.y)}}class _r{constructor(n,a,u,g,h){this.overscaledZ=n,this.wrap=a,this.canonical=new ea(u,+g,+h),this.key=a===0&&n===u?this.canonical.key:Pr(a,n,u,g,h)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const a=this.canonical.z-n;return n>this.canonical.z?new _r(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new _r(n,this.wrap,n,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(n,a=!0){if(this.overscaledZ===n&&a)return this.key;if(n>this.canonical.z)return Pr(this.wrap*+a,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return Pr(this.wrap*+a,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const a=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>a&&n.canonical.y===this.canonical.y>>a}children(n){if(this.overscaledZ>=n)return[new _r(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new _r(a,this.wrap,a,u,g),new _r(a,this.wrap,a,u+1,g),new _r(a,this.wrap,a,u,g+1),new _r(a,this.wrap,a,u+1,g+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new _r(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new _r(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new wr(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Pr(c,n,a,u,g){const h=1<<Math.min(a,22);let v=h*(g%h)+u%h;return c&&a<22&&(v+=h*h*((c<0?-2*c-1:2*c)%(1<<2*(22-a)))),16*(32*v+a)+(n-a)}const Jr=[c=>{let n=c.canonical.x-1,a=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,a--),new _r(c.overscaledZ,a,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,a=c.wrap;return n===1<<c.canonical.z&&(n=0,a++),new _r(c.overscaledZ,a,c.canonical.z,n,c.canonical.y)},c=>new _r(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new _r(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];no(ea,"CanonicalTileID"),no(_r,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Pi=Mr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:pi}=Pi,ra=Mr([{name:"a_pos_3",components:3,type:"Int16"}]);var Hl=Mr([{name:"a_pos",type:"Int16",components:2}]);class rs{constructor(n,a){this.pos=n,this.dir=a}intersectsPlane(n,a,u){const g=Le.vec3.dot(a,this.dir);if(Math.abs(g)<1e-6)return!1;const h=((n[0]-this.pos[0])*a[0]+(n[1]-this.pos[1])*a[1]+(n[2]-this.pos[2])*a[2])/g;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(n,a,u){if(Le.vec3.equals(this.pos,n)||a===0)return u[0]=u[1]=u[2]=0,!1;const[g,h,v]=this.dir,T=this.pos[0]-n[0],P=this.pos[1]-n[1],O=this.pos[2]-n[2],x=g*g+h*h+v*v,k=2*(T*g+P*h+O*v),L=k*k-4*x*(T*T+P*P+O*O-a*a);if(L<0){const A=Math.max(-k/2,0),R=T+g*A,$=P+h*A,W=O+v*A,Y=Math.hypot(R,$,W);return u[0]=R*a/Y,u[1]=$*a/Y,u[2]=W*a/Y,!1}{const A=(-k-Math.sqrt(L))/(2*x);if(A<0){const R=Math.hypot(T,P,O);return u[0]=T*a/R,u[1]=P*a/R,u[2]=O*a/R,!1}return u[0]=T+g*A,u[1]=P+h*A,u[2]=O+v*A,!0}}}class is{constructor(n,a,u,g,h){this.TL=n,this.TR=a,this.BR=u,this.BL=g,this.horizon=h}static fromInvProjectionMatrix(n,a,u){const g=[-1,1,1],h=[1,1,1],v=[1,-1,1],T=[-1,-1,1],P=Le.vec3.transformMat4(g,g,n),O=Le.vec3.transformMat4(h,h,n),x=Le.vec3.transformMat4(v,v,n),k=Le.vec3.transformMat4(T,T,n);return new is(P,O,x,k,a/u)}}function Xs(c,n,a){let u=1/0,g=-1/0;const h=[];for(const v of c){Le.vec3.sub(h,v,n);const T=Le.vec3.dot(h,a);u=Math.min(u,T),g=Math.max(g,T)}return[u,g]}function vl(c,n){let a=!0;for(let u=0;u<c.planes.length;u++){const g=c.planes[u];let h=0;for(let v=0;v<n.length;v++)h+=Le.vec3.dot(g,n[v])+g[3]>=0;if(h===0)return 0;h!==n.length&&(a=!1)}return a?2:1}function as(c,n){for(const a of c.projections){const u=Xs(n,c.points[0],a.axis);if(a.projection[1]<u[0]||a.projection[0]>u[1])return 0}return 1}function Rc(c,n){let a=0;const u=[0,0,0,0];for(let g=0;g<c.length;g++)u[0]=c[g][0],u[1]=c[g][1],u[2]=c[g][2],u[3]=1,Le.vec4.dot(u,n)>=0&&a++;return a}class Js{constructor(n,a){this.points=n||new Array(8).fill([0,0,0]),this.planes=a||new Array(6).fill([0,0,0,0]),this.bounds=Fr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Le.vec3.sub([],this.points[2],this.points[3]),Le.vec3.sub([],this.points[0],this.points[3]),Le.vec3.sub([],this.points[4],this.points[0]),Le.vec3.sub([],this.points[5],this.points[1]),Le.vec3.sub([],this.points[6],this.points[2]),Le.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const g=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:g,projection:Xs(this.points,this.points[0],g)}),this.projections.push({axis:h,projection:Xs(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(n,a,u,g){const h=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const x=Le.vec4.transformMat4([],O,n),k=1/x[3]/a*h;return Le.vec4.mul(x,x,[k,k,g?1/x[3]:k,k])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const x=Le.vec3.sub([],v[O[0]],v[O[1]]),k=Le.vec3.sub([],v[O[2]],v[O[1]]),L=Le.vec3.normalize([],Le.vec3.cross([],x,k)),A=-Le.vec3.dot(L,v[O[1]]);return L.concat(A)}),P=[];for(let O=0;O<v.length;O++)P.push([v[O][0],v[O][1],v[O][2]]);return new Js(P,T)}intersectsPrecise(n,a,u){for(let g=0;g<a.length;g++)if(!Rc(n,a[g]))return 0;for(let g=0;g<this.planes.length;g++)if(!Rc(n,this.planes[g]))return 0;for(const g of u)for(const h of this.frustumEdges){const v=Le.vec3.cross([],g,h),T=Le.vec3.length(v);if(T===0)continue;Le.vec3.scale(v,v,1/T);const P=Xs(this.points,this.points[0],v),O=Xs(n,this.points[0],v);if(P[0]>O[1]||O[0]>P[1])return 0}return 1}containsPoint(n){for(const a of this.planes){const u=a[3];if(Le.vec3.dot([a[0],a[1],a[2]],n)+u<0)return!1}return!0}}class Fr{static fromPoints(n){const a=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const g of n)Le.vec3.min(a,a,g),Le.vec3.max(u,u,g);return new Fr(a,u)}static fromTileIdAndHeight(n,a,u){const g=1<<n.canonical.z,h=n.canonical.x,v=n.canonical.y;return new Fr([h/g,v/g,a],[(h+1)/g,(v+1)/g,u])}static applyTransform(n,a){const u=n.getCorners();for(let g=0;g<u.length;++g)Le.vec3.transformMat4(u[g],u[g],a);return Fr.fromPoints(u)}static applyTransformFast(n,a){const u=[a[12],a[13],a[14]],g=[...u];for(let h=0;h<3;h++)for(let v=0;v<3;v++){const T=a[4*v+h],P=T*n.min[v],O=T*n.max[v];u[h]+=Math.min(P,O),g[h]+=Math.max(P,O)}return new Fr(u,g)}static projectAabbCorners(n,a){const u=n.getCorners();for(let g=0;g<u.length;++g)Le.vec3.transformMat4(u[g],u[g],a);return u}constructor(n,a){this.min=n,this.max=a,this.center=Le.vec3.scale([],Le.vec3.add([],this.min,this.max),.5)}quadrant(n){const a=[n%2==0,n<2],u=Le.vec3.clone(this.min),g=Le.vec3.clone(this.max);for(let h=0;h<a.length;h++)u[h]=a[h]?this.min[h]:this.center[h],g[h]=a[h]?this.center[h]:this.max[h];return g[2]=this.max[2],new Fr(u,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,a=this.max;return[[n[0],n[1],n[2]],[a[0],n[1],n[2]],[a[0],a[1],n[2]],[n[0],a[1],n[2]],[n[0],n[1],a[2]],[a[0],n[1],a[2]],[a[0],a[1],a[2]],[n[0],a[1],a[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?vl(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?vl(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,a){return a||this.intersects(n)?as(n,this.getCorners()):0}intersectsPreciseFlat(n,a){return a||this.intersectsFlat(n)?as(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let a=0;a<3;++a)if(this.min[a]>n.max[a]||n.min[a]>this.max[a])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n.min[a]),this.max[a]=Math.max(this.max[a],n.max[a])}encapsulatePoint(n){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],n[a]),this.max[a]=Math.max(this.max[a],n[a])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function jd(c){return c*ya/V}no(Fr,"Aabb");const Zg=[new Fr([b,b,b],[S,S,S]),new Fr([b,b,b],[0,0,S]),new Fr([0,b,b],[S,0,S]),new Fr([b,0,b],[0,S,S]),new Fr([0,0,b],[S,S,S])];function Hd(c,n,a,u=!0){const g=Le.vec3.scale([],c._camera.position,c.worldSize),h=[n,a,1,1];Le.vec4.transformMat4(h,h,c.pixelMatrixInverse),Le.vec4.scale(h,h,1/h[3]);const v=Le.vec3.sub([],h,g),T=Le.vec3.normalize([],v),P=c.globeMatrix,O=[P[12],P[13],P[14]],x=Le.vec3.sub([],O,g),k=Le.vec3.length(x),L=Le.vec3.normalize([],x),A=c.worldSize/(2*Math.PI),R=Le.vec3.dot(L,T),$=Math.asin(A/k);if($<Math.acos(R)){if(!u)return null;const st=[],Fe=[];Le.vec3.scale(st,T,k/R),Le.vec3.normalize(Fe,Le.vec3.sub(Fe,st,x)),Le.vec3.normalize(T,Le.vec3.add(T,x,Le.vec3.scale(T,Fe,Math.tan($)*k)))}const W=[];new rs(g,T).closestPointOnSphere(O,A,W);const Y=Le.vec3.normalize([],Bi(P,0)),re=Le.vec3.normalize([],Bi(P,1)),ie=Le.vec3.normalize([],Bi(P,2)),Q=Le.vec3.dot(Y,W),ue=Le.vec3.dot(re,W),_e=Le.vec3.dot(ie,W),Ie=Gt(Math.asin(-ue/A));let Ge=Gt(Math.atan2(Q,_e));Ge=c.center.lng+function(st,Fe){const rt=(Fe-st+180)%360-180;return rt<-180?rt+360:rt}(c.center.lng,Ge);const ze=ye(Ge),$e=yt(Te(Ie),0,1);return new vt(ze,$e)}class Yg{constructor(n,a,u){this.a=Le.vec3.sub([],n,u),this.b=Le.vec3.sub([],a,u),this.center=u;const g=Le.vec3.normalize([],this.a),h=Le.vec3.normalize([],this.b);this.angle=Math.acos(Le.vec3.dot(g,h))}}function cf(c,n){if(c.angle===0)return null;let a;return a=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),a<0||a>1?null:function(u,g,h,v){const T=Math.sin(h);return u*(Math.sin((1-v)*h)/T)+g*(Math.sin(v*h)/T)}(c.a[n],c.b[n],c.angle,yt(a,0,1))+c.center[n]}function gu(c){if(c.z<=1)return Zg[c.z+2*c.y+c.x];const n=tx(Fy(c));return Fr.fromPoints(n)}function qu(c,n,a){return Le.vec3.scale(c,c,1-a),Le.vec3.scaleAndAdd(c,c,n,a)}function OC(c,n,a){for(const u of c)Le.vec3.transformMat4(u,u,n),Le.vec3.scale(u,u,a)}function DC(c,n,a,u){const g=n/c.worldSize,h=c.globeMatrix;if(a.z<=1){const ze=gu(a).getCorners();return OC(ze,h,g),Fr.fromPoints(ze)}const v=Fy(a,u),T=tx(v,ya+jd(c._tileCoverLift));OC(T,h,g);const P=Number.MAX_VALUE,O=[-P,-P,-P],x=[P,P,P];if(v.contains(c.center)){for(const st of T)Le.vec3.min(x,x,st),Le.vec3.max(O,O,st);O[2]=0;const ze=c.point,$e=[ze.x*g,ze.y*g,0];return Le.vec3.min(x,x,$e),Le.vec3.max(O,O,$e),new Fr(x,O)}if(c._tileCoverLift>0){for(const ze of T)Le.vec3.min(x,x,ze),Le.vec3.max(O,O,ze);return new Fr(x,O)}const k=[h[12]*g,h[13]*g,h[14]*g],L=v.getCenter(),A=yt(c.center.lat,-Ye,Ye),R=yt(L.lat,-Ye,Ye),$=ye(c.center.lng),W=Te(A);let Y=$-ye(L.lng);const re=W-Te(R);Y>.5?Y-=1:Y<-.5&&(Y+=1);let ie=0;if(Math.abs(Y)>Math.abs(re))ie=Y>=0?1:3;else{ie=re>=0?0:2;const ze=[h[4]*g,h[5]*g,h[6]*g],$e=-Math.sin(Et(re>=0?v.getSouth():v.getNorth()))*ya;Le.vec3.scaleAndAdd(k,k,ze,$e)}const Q=T[ie],ue=T[(ie+1)%4],_e=new Yg(Q,ue,k),Ie=[cf(_e,0)||Q[0],cf(_e,1)||Q[1],cf(_e,2)||Q[2]],Ge=Gd(c.zoom);if(Ge>0){const ze=function({x:st,y:Fe,z:rt},ht,pt,Tt,Lt){const Ft=1/(1<<rt);let Pt=st*Ft,sn=Pt+Ft,Cn=Fe*Ft,Jt=Cn+Ft,Jn=0;const Fn=(Pt+sn)/2-Tt;return Fn>.5?Jn=-1:Fn<-.5&&(Jn=1),Pt=((Pt+Jn)*ht-(Tt*=ht))*pt+Tt,sn=((sn+Jn)*ht-Tt)*pt+Tt,Cn=(Cn*ht-(Lt*=ht))*pt+Lt,Jt=(Jt*ht-Lt)*pt+Lt,[[Pt,Jt,0],[sn,Jt,0],[sn,Cn,0],[Pt,Cn,0]]}(a,n,c._pixelsPerMercatorPixel,$,W);for(let st=0;st<T.length;st++)qu(T[st],ze[st],Ge);const $e=Le.vec3.add([],ze[ie],ze[(ie+1)%4]);Le.vec3.scale($e,$e,.5),qu(Ie,$e,Ge)}for(const ze of T)Le.vec3.min(x,x,ze),Le.vec3.max(O,O,ze);return x[2]=Math.min(Q[2],ue[2]),Le.vec3.min(x,x,Ie),Le.vec3.max(O,O,Ie),new Fr(x,O)}function Fy({x:c,y:n,z:a},u=!1){const g=1/(1<<a),h=new H(De(c*g),n===(1<<a)-1&&u?-90:je((n+1)*g)),v=new H(De((c+1)*g),n===0&&u?90:je(n*g));return new X(h,v)}function tx(c,n=ya){const a=Et(c.getNorth()),u=Et(c.getSouth()),g=Math.cos(a),h=Math.cos(u),v=Math.sin(a),T=Math.sin(u),P=c.getWest(),O=c.getEast();return[E(h,T,P,n),E(h,T,O,n),E(g,v,O,n),E(g,v,P,n)]}function Xg(c,n,a,u){const g=1<<a.z,h=(c/Nn+a.x)/g;return z(je((n/Nn+a.y)/g),De(h),u)}function By({min:c,max:n}){return r/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const zC=new Float64Array(16);function Ny(c){const n=By(c),a=Le.mat4.fromScaling(zC,[n,n,n]);return Le.mat4.translate(a,a,Le.vec3.negate([],c.min))}function nx(c){const n=Le.mat4.fromTranslation(zC,c.min),a=1/By(c);return Le.mat4.scale(n,n,[a,a,a])}function ox(c){const n=Nn/(2*Math.PI);return c/(2*Math.PI)/n}function FC(c,n){return Nn/(512*Math.pow(2,c))*By(gu(n))}function BC(c,n,a,u,g){const h=ox(a),v=[c,n,-a/(2*Math.PI)],T=Le.mat4.identity(new Float64Array(16));return Le.mat4.translate(T,T,v),Le.mat4.scale(T,T,[h,h,h]),Le.mat4.rotateX(T,T,Et(-g)),Le.mat4.rotateY(T,T,Et(-u)),T}function Gd(c){return kn(zy,f,c)}function NC(c,n){const a=z(n.lat,n.lng),u=function(h){const v=z(h._center.lat,h._center.lng),T=Le.vec3.fromValues(0,1,0);let P=Le.vec3.cross([],T,v);const O=Le.mat4.fromRotation([],-h.angle,v);P=Le.vec3.transformMat4(P,P,O),Le.mat4.fromRotation(O,-h._pitch,P);const x=Le.vec3.normalize([],v);return Le.vec3.scale(x,x,jd(h.cameraToCenterDistance/h.pixelsPerMeter)),Le.vec3.transformMat4(x,x,O),Le.vec3.add([],v,x)}(c),g=Le.vec3.subtract([],u,a);return Le.vec3.angle(g,a)}function rx(c,n){return NC(c,n)>Math.PI/2*1.01}const $C=Et(85),_F=Math.cos($C),yF=Math.sin($C),bF=Le.mat4.create(),VC=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function UC(c,n,a,u,g,h,v,T,P){if(h&&c.queryGeometry.isAboveHorizon)return!1;h&&(P*=c.pixelToTileUnitsFactor);const O=c.tileID.canonical,x=a.projection.upVectorScale(O,a.center.lat,a.worldSize).metersToTile;for(const k of n)for(const L of k){const A=L.add(T),R=g&&a.elevation?a.elevation.exaggeration()*g.getElevationAt(A.x,A.y,!0):0,$=a.projection.projectTilePoint(A.x,A.y,O);if(R>0){const ie=a.projection.upVector(O,A.x,A.y);$.x+=ie[0]*x*R,$.y+=ie[1]*x*R,$.z+=ie[2]*x*R}const W=h?A:xF($.x,$.y,$.z,u),Y=h?c.tilespaceRays.map(ie=>SF(ie,R)):c.queryGeometry.screenGeometry,re=Le.vec4.transformMat4([],[$.x,$.y,$.z,1],u);if(!v&&h?P*=re[3]/a.cameraToCenterDistance:v&&!h&&(P*=a.cameraToCenterDistance/re[3]),h){const ie=je((L.y/Nn+O.y)/(1<<O.z));P/=a.projection.pixelsPerMeter(ie,1)/Se(1,ie)}if(Vn(Y,W,P))return!0}return!1}function xF(c,n,a,u){const g=Le.vec4.transformMat4([],[c,n,a,1],u);return new Be(g[0]/g[3],g[1]/g[3])}const jC=Le.vec3.fromValues(0,0,0),wF=Le.vec3.fromValues(0,0,1);function SF(c,n){const a=Le.vec3.create();return jC[2]=n,c.intersectsPlane(jC,wF,a),new Be(a[0],a[1])}class HC extends wn{}let GC,WC,qC,KC;function ZC(c,{width:n,height:a},u,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==n*a*u)throw new RangeError("mismatched image size")}else g=new Uint8Array(n*a*u);return c.width=n,c.height=a,c.data=g,c}function YC(c,n,a){const{width:u,height:g}=n;u===c.width&&g===c.height||(ix(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,g)},a,null),c.width=u,c.height=g,c.data=n.data)}function ix(c,n,a,u,g,h,v,T){if(g.width===0||g.height===0)return n;if(g.width>c.width||g.height>c.height||a.x>c.width-g.width||a.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>n.width||g.height>n.height||u.x>n.width-g.width||u.y>n.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const P=c.data,O=n.data,x=h===4&&T;for(let k=0;k<g.height;k++){const L=((a.y+k)*c.width+a.x)*h,A=((u.y+k)*n.width+u.x)*h;if(x)for(let R=0;R<g.width;R++){const $=L+R*h+3,W=A+R*h;O[W+0]=255,O[W+1]=255,O[W+2]=255,O[W+3]=P[$]}else if(v)for(let R=0;R<g.width;R++){const $=L+R*h,W=A+R*h,Y=P[$+3],re=new On(P[$+0]/255*Y,P[$+1]/255*Y,P[$+2]/255*Y,Y).toRenderColor(v).toArray();O[W+0]=re[0],O[W+1]=re[1],O[W+2]=re[2],O[W+3]=re[3]}else for(let R=0;R<g.width*h;R++)O[A+R]=P[L+R]}return n}no(HC,"HeatmapBucket",{omit:["layers"]});class Wd{constructor(n,a){ZC(this,n,1,a)}resize(n){YC(this,new Wd(n),1)}clone(){return new Wd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,g,h){ix(n,a,u,g,h,1,null)}}class Ua{constructor(n,a){ZC(this,n,4,a)}resize(n){YC(this,new Ua(n),4)}replace(n,a){a?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ua({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,a,u,g,h,v,T){ix(n,a,u,g,h,4,v,T)}}class XC{constructor(n,a){this.width=n.width,this.height=n.height,this.data=a instanceof Uint8Array?new Float32Array(a.buffer):a}}function Jg(c){const n={},a=c.resolution||256,u=c.clips?c.clips.length:1,g=c.image||new Ua({width:a,height:u}),h=(v,T,P)=>{n[c.evaluationKey]=P;const O=c.expression.evaluate(n);O&&(g.data[v+T+0]=Math.floor(255*O.r/O.a),g.data[v+T+1]=Math.floor(255*O.g/O.a),g.data[v+T+2]=Math.floor(255*O.b/O.a),g.data[v+T+3]=Math.floor(255*O.a))};if(c.clips)for(let v=0,T=0;v<u;++v,T+=4*a)for(let P=0,O=0;P<a;P++,O+=4){const x=P/(a-1),{start:k,end:L}=c.clips[v];h(T,O,k*(1-x)+L*x)}else for(let v=0,T=0;v<a;v++,T+=4)h(0,T,v/(a-1));return g}no(Wd,"AlphaImage"),no(Ua,"RGBAImage");const TF=Mr([{name:"a_pos",components:2,type:"Int16"}],4),{members:CF}=TF;function Qg(c,n,a=2){const u=n&&n.length,g=u?n[0]*a:c.length;let h=JC(c,0,g,a,!0);const v=[];if(!h||h.next===h.prev)return v;let T,P,O;if(u&&(h=function(x,k,L,A){const R=[];for(let $=0,W=k.length;$<W;$++){const Y=JC(x,k[$]*A,$<W-1?k[$+1]*A:x.length,A,!1);Y===Y.next&&(Y.steiner=!0),R.push(LF(Y))}R.sort(kF);for(let $=0;$<R.length;$++)L=PF(R[$],L);return L}(c,n,h,a)),c.length>80*a){T=1/0,P=1/0;let x=-1/0,k=-1/0;for(let L=a;L<g;L+=a){const A=c[L],R=c[L+1];A<T&&(T=A),R<P&&(P=R),A>x&&(x=A),R>k&&(k=R)}O=Math.max(x-T,k-P),O=O!==0?32767/O:0}return ev(h,v,a,T,P,O,0),v}function JC(c,n,a,u,g){let h;if(g===function(v,T,P,O){let x=0;for(let k=T,L=P-O;k<P;k+=O)x+=(v[L]-v[k])*(v[k+1]+v[L+1]),L=k;return x}(c,n,a,u)>0)for(let v=n;v<a;v+=u)h=tE(v/u|0,c[v],c[v+1],h);else for(let v=a-u;v>=n;v-=u)h=tE(v/u|0,c[v],c[v+1],h);return h&&$y(h,h.next)&&(nv(h),h=h.next),h}function uf(c,n){if(!c)return c;n||(n=c);let a,u=c;do if(a=!1,u.steiner||!$y(u,u.next)&&ta(u.prev,u,u.next)!==0)u=u.next;else{if(nv(u),u=n=u.prev,u===u.next)break;a=!0}while(a||u!==n);return n}function ev(c,n,a,u,g,h,v){if(!c)return;!v&&h&&function(P,O,x,k){let L=P;do L.z===0&&(L.z=ax(L.x,L.y,O,x,k)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==P);L.prevZ.nextZ=null,L.prevZ=null,function(A){let R,$=1;do{let W,Y=A;A=null;let re=null;for(R=0;Y;){R++;let ie=Y,Q=0;for(let _e=0;_e<$&&(Q++,ie=ie.nextZ,ie);_e++);let ue=$;for(;Q>0||ue>0&&ie;)Q!==0&&(ue===0||!ie||Y.z<=ie.z)?(W=Y,Y=Y.nextZ,Q--):(W=ie,ie=ie.nextZ,ue--),re?re.nextZ=W:A=W,W.prevZ=re,re=W;Y=ie}re.nextZ=null,$*=2}while(R>1)}(L)}(c,u,g,h);let T=c;for(;c.prev!==c.next;){const P=c.prev,O=c.next;if(h?MF(c,u,g,h):EF(c))n.push(P.i,c.i,O.i),nv(c),c=O.next,T=O.next;else if((c=O)===T){v?v===1?ev(c=IF(uf(c),n),n,a,u,g,h,2):v===2&&AF(c,n,a,u,g,h):ev(uf(c),n,a,u,g,h,1);break}}}function EF(c){const n=c.prev,a=c,u=c.next;if(ta(n,a,u)>=0)return!1;const g=n.x,h=a.x,v=u.x,T=n.y,P=a.y,O=u.y,x=g<h?g<v?g:v:h<v?h:v,k=T<P?T<O?T:O:P<O?P:O,L=g>h?g>v?g:v:h>v?h:v,A=T>P?T>O?T:O:P>O?P:O;let R=u.next;for(;R!==n;){if(R.x>=x&&R.x<=L&&R.y>=k&&R.y<=A&&Lp(g,T,h,P,v,O,R.x,R.y)&&ta(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function MF(c,n,a,u){const g=c.prev,h=c,v=c.next;if(ta(g,h,v)>=0)return!1;const T=g.x,P=h.x,O=v.x,x=g.y,k=h.y,L=v.y,A=T<P?T<O?T:O:P<O?P:O,R=x<k?x<L?x:L:k<L?k:L,$=T>P?T>O?T:O:P>O?P:O,W=x>k?x>L?x:L:k>L?k:L,Y=ax(A,R,n,a,u),re=ax($,W,n,a,u);let ie=c.prevZ,Q=c.nextZ;for(;ie&&ie.z>=Y&&Q&&Q.z<=re;){if(ie.x>=A&&ie.x<=$&&ie.y>=R&&ie.y<=W&&ie!==g&&ie!==v&&Lp(T,x,P,k,O,L,ie.x,ie.y)&&ta(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,Q.x>=A&&Q.x<=$&&Q.y>=R&&Q.y<=W&&Q!==g&&Q!==v&&Lp(T,x,P,k,O,L,Q.x,Q.y)&&ta(Q.prev,Q,Q.next)>=0))return!1;Q=Q.nextZ}for(;ie&&ie.z>=Y;){if(ie.x>=A&&ie.x<=$&&ie.y>=R&&ie.y<=W&&ie!==g&&ie!==v&&Lp(T,x,P,k,O,L,ie.x,ie.y)&&ta(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;Q&&Q.z<=re;){if(Q.x>=A&&Q.x<=$&&Q.y>=R&&Q.y<=W&&Q!==g&&Q!==v&&Lp(T,x,P,k,O,L,Q.x,Q.y)&&ta(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}return!0}function IF(c,n){let a=c;do{const u=a.prev,g=a.next.next;!$y(u,g)&&QC(u,a,a.next,g)&&tv(u,g)&&tv(g,u)&&(n.push(u.i,a.i,g.i),nv(a),nv(a.next),a=c=g),a=a.next}while(a!==c);return uf(a)}function AF(c,n,a,u,g,h){let v=c;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&OF(v,T)){let P=eE(v,T);return v=uf(v,v.next),P=uf(P,P.next),ev(v,n,a,u,g,h,0),void ev(P,n,a,u,g,h,0)}T=T.next}v=v.next}while(v!==c)}function kF(c,n){return c.x-n.x}function PF(c,n){const a=function(g,h){let v=h;const T=g.x,P=g.y;let O,x=-1/0;do{if(P<=v.y&&P>=v.next.y&&v.next.y!==v.y){const $=v.x+(P-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if($<=T&&$>x&&(x=$,O=v.x<v.next.x?v:v.next,$===T))return O}v=v.next}while(v!==h);if(!O)return null;const k=O,L=O.x,A=O.y;let R=1/0;v=O;do{if(T>=v.x&&v.x>=L&&T!==v.x&&Lp(P<A?T:x,P,L,A,P<A?x:T,P,v.x,v.y)){const $=Math.abs(P-v.y)/(T-v.x);tv(v,g)&&($<R||$===R&&(v.x>O.x||v.x===O.x&&RF(O,v)))&&(O=v,R=$)}v=v.next}while(v!==k);return O}(c,n);if(!a)return n;const u=eE(a,c);return uf(u,u.next),uf(a,a.next)}function RF(c,n){return ta(c.prev,c,n.prev)<0&&ta(n.next,c,c.next)<0}function ax(c,n,a,u,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-a)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*g|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function LF(c){let n=c,a=c;do(n.x<a.x||n.x===a.x&&n.y<a.y)&&(a=n),n=n.next;while(n!==c);return a}function Lp(c,n,a,u,g,h,v,T){return(g-v)*(n-T)>=(c-v)*(h-T)&&(c-v)*(u-T)>=(a-v)*(n-T)&&(a-v)*(h-T)>=(g-v)*(u-T)}function OF(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(a,u){let g=a;do{if(g.i!==a.i&&g.next.i!==a.i&&g.i!==u.i&&g.next.i!==u.i&&QC(g,g.next,a,u))return!0;g=g.next}while(g!==a);return!1}(c,n)&&(tv(c,n)&&tv(n,c)&&function(a,u){let g=a,h=!1;const v=(a.x+u.x)/2,T=(a.y+u.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&v<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(h=!h),g=g.next;while(g!==a);return h}(c,n)&&(ta(c.prev,c,n.prev)||ta(c,n.prev,n))||$y(c,n)&&ta(c.prev,c,c.next)>0&&ta(n.prev,n,n.next)>0)}function ta(c,n,a){return(n.y-c.y)*(a.x-n.x)-(n.x-c.x)*(a.y-n.y)}function $y(c,n){return c.x===n.x&&c.y===n.y}function QC(c,n,a,u){const g=Uy(ta(c,n,a)),h=Uy(ta(c,n,u)),v=Uy(ta(a,u,c)),T=Uy(ta(a,u,n));return g!==h&&v!==T||!(g!==0||!Vy(c,a,n))||!(h!==0||!Vy(c,u,n))||!(v!==0||!Vy(a,c,u))||!(T!==0||!Vy(a,n,u))}function Vy(c,n,a){return n.x<=Math.max(c.x,a.x)&&n.x>=Math.min(c.x,a.x)&&n.y<=Math.max(c.y,a.y)&&n.y>=Math.min(c.y,a.y)}function Uy(c){return c>0?1:c<0?-1:0}function tv(c,n){return ta(c.prev,c,c.next)<0?ta(c,n,c.next)>=0&&ta(c,c.prev,n)>=0:ta(c,n,c.prev)<0||ta(c,c.next,n)<0}function eE(c,n){const a=sx(c.i,c.x,c.y),u=sx(n.i,n.x,n.y),g=c.next,h=n.prev;return c.next=n,n.prev=c,a.next=g,g.prev=a,u.next=a,a.prev=u,h.next=u,u.prev=h,u}function tE(c,n,a,u){const g=sx(c,n,a);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function nv(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function sx(c,n,a){return{i:c,x:n,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function jy(c,n){const a=c.length;if(a<=1)return[c];const u=[];let g,h;for(let v=0;v<a;v++){const T=Rr(c[v]);T!==0&&(c[v].area=Math.abs(T),h===void 0&&(h=T<0),h===T<0?(g&&u.push(g),g=[c[v]]):g.push(c[v]))}if(g&&u.push(g),n>1)for(let v=0;v<u.length;v++)u[v].length<=n||(yd(u[v],n,1,u[v].length-1,DF),u[v]=u[v].slice(0,n));return u}function DF(c,n){return n.area-c.area}function lx(c,n,a){const u=a.patternDependencies;let g=!1;for(const h of n){const v=h.paint.get(`${c}-pattern`);v.isConstant()||(g=!0);const T=v.constantOr(null);T&&(g=!0,u[T]=!0)}return g}function cx(c,n,a,u,g){const h=g.patternDependencies;for(const v of n){const T=v.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:u},a,{},g.availableImages);P=P&&P.name?P.name:P,h[P]=!0,a.patterns[v.id]=P}}return a}class ux{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fu,this.indexArray=new bi,this.indexArray2=new mu,this.programConfigurations=new jl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ki,this.segments2=new ki,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=n.projection}updateFootprints(n,a){}populate(n,a,u,g){this.hasPattern=lx("fill",this.layers,a);const h=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:T,id:P,index:O,sourceLayerIndex:x}of n){const k=this.layers[0]._featureFilter.needGeometry,L=pn(T,k);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),L,u))continue;const A=h?h.evaluate(L,{},u,a.availableImages):void 0,R={id:P,properties:T.properties,type:T.type,sourceLayerIndex:x,index:O,geometry:k?L.geometry:It(T,u,g),patterns:{},sortKey:A};v.push(R)}h&&v.sort((T,P)=>T.sortKey-P.sortKey);for(const T of v){const{geometry:P,index:O,sourceLayerIndex:x}=T;if(this.hasPattern){const k=cx("fill",this.layers,T,this.zoom,a);this.patternFeatures.push(k)}else this.addFeature(T,P,O,u,{},a.availableImages,a.brightness);a.featureIndex.insert(n[O].feature,P,O,x,this.index)}}update(n,a,u,g,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,a,v?this.stateDependentLayers:this.layers,u,g,h)}addFeatures(n,a,u,g,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,a,u,g,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,CF),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,a,u,g,h,v=[],T){for(const P of jy(a,500)){let O=0;for(const $ of P)O+=$.length;const x=this.segments.prepareSegment(O,this.layoutVertexArray,this.indexArray),k=x.vertexLength,L=[],A=[];for(const $ of P){if($.length===0)continue;$!==P[0]&&A.push(L.length/2);const W=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),Y=W.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(Y+$.length-1,Y),L.push($[0].x),L.push($[0].y);for(let re=1;re<$.length;re++)this.layoutVertexArray.emplaceBack($[re].x,$[re].y),this.indexArray2.emplaceBack(Y+re-1,Y+re),L.push($[re].x),L.push($[re].y);W.vertexLength+=$.length,W.primitiveLength+=$.length}const R=Qg(L,A);for(let $=0;$<R.length;$+=3)this.indexArray.emplaceBack(k+R[$],k+R[$+1],k+R[$+2]);x.vertexLength+=O,x.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,T)}}let nE,oE,rE,iE;no(ux,"FillBucket",{omit:["layers","patternFeatures"]});class dx{constructor(n,a,u,g){if(this.triangleCount=a.length/3,this.min=new Be(0,0),this.max=new Be(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[h,v]=[n[0].clone(),n[0].clone()];for(let k=1;k<n.length;++k){const L=n[k];h.x=Math.min(h.x,L.x),h.y=Math.min(h.y,L.y),v.x=Math.max(v.x,L.x),v.y=Math.max(v.y,L.y)}if(g){const k=Math.ceil(Math.max(v.x-h.x,v.y-h.y)/g);u=Math.max(u,k)}if(u===0)return;this.min=h,this.max=v;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const P=Math.max(T.x,T.y)/u;this.cellsX=Math.max(1,Math.ceil(T.x/P)),this.cellsY=Math.max(1,Math.ceil(T.y/P)),this.xScale=1/P,this.yScale=1/P;const O=[];for(let k=0;k<this.triangleCount;k++){const L=n[a[3*k+0]].sub(this.min),A=n[a[3*k+1]].sub(this.min),R=n[a[3*k+2]].sub(this.min),$=vu(Math.floor(Math.min(L.x,A.x,R.x)),this.xScale,this.cellsX),W=vu(Math.floor(Math.max(L.x,A.x,R.x)),this.xScale,this.cellsX),Y=vu(Math.floor(Math.min(L.y,A.y,R.y)),this.yScale,this.cellsY),re=vu(Math.floor(Math.max(L.y,A.y,R.y)),this.yScale,this.cellsY),ie=new Be(0,0),Q=new Be(0,0),ue=new Be(0,0),_e=new Be(0,0);for(let Ie=Y;Ie<=re;++Ie){ie.y=Q.y=Ie*P,ue.y=_e.y=(Ie+1)*P;for(let Ge=$;Ge<=W;++Ge)ie.x=ue.x=Ge*P,Q.x=_e.x=(Ge+1)*P,(kr(L,A,R,ie,Q,_e)||kr(L,A,R,ie,_e,ue))&&O.push({cellIdx:Ie*this.cellsX+Ge,triIdx:k})}}if(O.length===0)return;O.sort((k,L)=>k.cellIdx-L.cellIdx||k.triIdx-L.triIdx);let x=0;for(;x<O.length;){const k=O[x].cellIdx,L={start:this.payload.length,len:0};for(;x<O.length&&O[x].cellIdx===k;)++L.len,this.payload.push(O[x++].triIdx);this.cells[k]=L}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,a){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=vu(n.x-this.min.x,this.xScale,this.cellsX),g=vu(n.y-this.min.y,this.yScale,this.cellsY),h=this.cells[g*this.cellsX+u];if(h){this._lazyInitLookup();for(let v=0;v<h.len;v++){const T=this.payload[h.start+v],P=Math.floor(T/8),O=1<<T%8;if(!(this.lookup[P]&O)&&(this.lookup[P]|=O,a.push(T),a.length===this.triangleCount))return}}}query(n,a,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>a.x||n.y>this.max.y||this.min.y>a.y)return;this._lazyInitLookup();const g=vu(n.x-this.min.x,this.xScale,this.cellsX),h=vu(a.x-this.min.x,this.xScale,this.cellsX),v=vu(n.y-this.min.y,this.yScale,this.cellsY),T=vu(a.y-this.min.y,this.yScale,this.cellsY);for(let P=v;P<=T;P++)for(let O=g;O<=h;O++){const x=this.cells[P*this.cellsX+O];if(x)for(let k=0;k<x.len;k++){const L=this.payload[x.start+k],A=Math.floor(L/8),R=1<<L%8;if(!(this.lookup[A]&R)&&(this.lookup[A]|=R,u.push(L),u.length===this.triangleCount))return}}}}function vu(c,n,a){return Math.max(0,Math.min(a-1,Math.floor(c*n)))}no(dx,"TriangleGridIndex");class aE{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.footprints=[]}updateFootprints(n,a){for(const u of this.footprints)a.push({footprint:u,id:n})}populate(n,a,u,g){const h=[];for(const{feature:v,id:T,index:P,sourceLayerIndex:O}of n){const x=this.layers[0]._featureFilter.needGeometry,k=pn(v,x);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),k,u))continue;const L={id:T,properties:v.properties,type:v.type,sourceLayerIndex:O,index:P,geometry:x?k.geometry:It(v,u,g),patterns:{}};h.push(L)}for(const v of h){const{geometry:T,index:P,sourceLayerIndex:O}=v;this.addFeature(v,T,P,u,{},a.availableImages,a.brightness),a.featureIndex.insert(n[P].feature,T,P,O,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,a,u,g,h){}destroy(){}addFeature(n,a,u,g,h,v=[],T){for(const P of jy(a,2)){const O=[],x=[],k=[],L=new Be(1/0,1/0),A=new Be(-1/0,-1/0);for(const W of P)if(W.length!==0){W!==P[0]&&k.push(x.length/2);for(let Y=0;Y<W.length;Y++)x.push(W[Y].x),x.push(W[Y].y),O.push(W[Y]),L.x=Math.min(L.x,W[Y].x),L.y=Math.min(L.y,W[Y].y),A.x=Math.max(A.x,W[Y].x),A.y=Math.max(A.y,W[Y].y)}const R=Qg(x,k),$=new dx(O,R,8,256);this.footprints.push({vertices:O,indices:R,grid:$,min:L,max:A})}}}no(aE,"ClipBucket",{omit:["layers"]});const zF=Mr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),FF=Mr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),BF=Mr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),NF=Mr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),$F=Mr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),VF=Mr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:UF}=zF;var hx,sE,fx,lE,px,cE,uE,Hy={};function dE(){if(sE)return hx;sE=1;var c=Ke();function n(g,h,v,T,P){this.properties={},this.extent=v,this.type=0,this._pbf=g,this._geometry=-1,this._keys=T,this._values=P,g.readFields(a,this,h)}function a(g,h,v){g==1?h.id=v.readVarint():g==2?function(T,P){for(var O=T.readVarint()+T.pos;T.pos<O;){var x=P._keys[T.readVarint()],k=P._values[T.readVarint()];P.properties[x]=k}}(v,h):g==3?h.type=v.readVarint():g==4&&(h._geometry=v.pos)}function u(g){for(var h,v,T=0,P=0,O=g.length,x=O-1;P<O;x=P++)T+=((v=g[x]).x-(h=g[P]).x)*(h.y+v.y);return T}return hx=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var h,v=g.readVarint()+g.pos,T=1,P=0,O=0,x=0,k=[];g.pos<v;){if(P<=0){var L=g.readVarint();T=7&L,P=L>>3}if(P--,T===1||T===2)O+=g.readSVarint(),x+=g.readSVarint(),T===1&&(h&&k.push(h),h=[]),h.push(new c(O,x));else{if(T!==7)throw new Error("unknown command "+T);h&&h.push(h[0].clone())}}return h&&k.push(h),k},n.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var h=g.readVarint()+g.pos,v=1,T=0,P=0,O=0,x=1/0,k=-1/0,L=1/0,A=-1/0;g.pos<h;){if(T<=0){var R=g.readVarint();v=7&R,T=R>>3}if(T--,v===1||v===2)(P+=g.readSVarint())<x&&(x=P),P>k&&(k=P),(O+=g.readSVarint())<L&&(L=O),O>A&&(A=O);else if(v!==7)throw new Error("unknown command "+v)}return[x,L,k,A]},n.prototype.toGeoJSON=function(g,h,v){var T,P,O=this.extent*Math.pow(2,v),x=this.extent*g,k=this.extent*h,L=this.loadGeometry(),A=n.types[this.type];function R(Y){for(var re=0;re<Y.length;re++){var ie=Y[re];Y[re]=[360*(ie.x+x)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(ie.y+k)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(T=0;T<L.length;T++)$[T]=L[T][0];R(L=$);break;case 2:for(T=0;T<L.length;T++)R(L[T]);break;case 3:for(L=function(Y){var re=Y.length;if(re<=1)return[Y];for(var ie,Q,ue=[],_e=0;_e<re;_e++){var Ie=u(Y[_e]);Ie!==0&&(Q===void 0&&(Q=Ie<0),Q===Ie<0?(ie&&ue.push(ie),ie=[Y[_e]]):ie.push(Y[_e]))}return ie&&ue.push(ie),ue}(L),T=0;T<L.length;T++)for(P=0;P<L[T].length;P++)R(L[T][P])}L.length===1?L=L[0]:A="Multi"+A;var W={type:"Feature",geometry:{type:A,coordinates:L},properties:this.properties};return"id"in this&&(W.id=this.id),W},hx}function hE(){if(lE)return fx;lE=1;var c=dE();function n(u,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(a,this,g),this.length=this._features.length}function a(u,g,h){u===15?g.version=h.readVarint():u===1?g.name=h.readString():u===5?g.extent=h.readVarint():u===2?g._features.push(h.pos):u===3?g._keys.push(h.readString()):u===4&&g._values.push(function(v){for(var T=null,P=v.readVarint()+v.pos;v.pos<P;){var O=v.readVarint()>>3;T=O===1?v.readString():O===2?v.readFloat():O===3?v.readDouble():O===4?v.readVarint64():O===5?v.readVarint():O===6?v.readSVarint():O===7?v.readBoolean():null}return T}(h))}return fx=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var g=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,g,this.extent,this._keys,this._values)},fx}function fE(){return uE||(uE=1,Hy.VectorTile=function(){if(cE)return px;cE=1;var c=hE();function n(a,u,g){if(a===3){var h=new c(g,g.readVarint()+g.pos);h.length&&(u[h.name]=h)}}return px=function(a,u){this.layers=a.readFields(n,{},u)},px}(),Hy.VectorTileFeature=dE(),Hy.VectorTileLayer=hE()),Hy}var Op=fE();class df extends Be{constructor(n,a,u){super(n,a),this.z=u}}class pE extends df{constructor(n,a,u,g){super(n,a,u),this.w=g}}function Gy(c,n,a,u){const g=[],h=u===0?(v,T,P,O,x,k)=>{v.push(new Be(k,P+(k-T)/(O-T)*(x-P)))}:(v,T,P,O,x,k)=>{v.push(new Be(T+(k-P)/(x-P)*(O-T),k))};for(const v of c){const T=[];for(const P of v){if(P.length<=2)continue;const O=[];for(let L=0;L<P.length-1;L++){const A=P[L].x,R=P[L].y,$=P[L+1].x,W=P[L+1].y,Y=u===0?A:R,re=u===0?$:W;Y<n?re>n&&h(O,A,R,$,W,n):Y>a?re<a&&h(O,A,R,$,W,a):O.push(P[L]),re<n&&Y>=n&&h(O,A,R,$,W,n),re>a&&Y<=a&&h(O,A,R,$,W,a)}let x=P[P.length-1];const k=u===0?x.x:x.y;k>=n&&k<=a&&O.push(x),O.length&&(x=O[O.length-1],O[0].x===x.x&&O[0].y===x.y||O.push(O[0]),T.push(O))}T.length&&g.push(T)}return g}function mE(c,n,a,u){const g=a==="x"?"y":"x",h=(u-c[a])/(n[a]-c[a]);c[g]=c[g]+(n[g]-c[g])*h,c[a]=u,c.hasOwnProperty("z")&&(c.z=uo(c.z,n.z,h)),c.hasOwnProperty("w")&&(c.w=uo(c.w,n.w,h))}function gE(c,n,a,u){const g=a,h=u;for(const v of["x","y"]){let T=c,P=n;T[v]>=P[v]&&(T=n,P=c),T[v]<g&&P[v]>g&&mE(T,P,v,g),T[v]<h&&P[v]>h&&mE(P,T,v,h)}}const Wy=Number.MAX_SAFE_INTEGER;function vE(c,n,a,u){return c.order<n||c.order===Wy||!(c.clipMask&a)||function(g,h){return h.length!==0&&h.find(v=>v===g)===void 0}(u,c.clipScope)}function qy(c,n){return c.x-n.x||c.y-n.y}function _E(c,n){return qy(c.min,n.min)===0&&qy(c.max,n.max)===0}function mx(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function gx(c,n){if(c.length!==n.length)return!1;for(let a=0;a<c.length;a++)if(c[a].sourceId!==n[a].sourceId||!_E(c[a],n[a])||c[a].order!==n[a].order||c[a].clipMask!==n[a].clipMask||!Ht(c[a].clipScope,n[a].clipScope))return!1;return!0}function yE(c,n,a){const u=1/Nn,g=1/(1<<a.canonical.z),h=(n.x*u+a.canonical.x)*g+a.wrap,v=(n.y*u+a.canonical.y)*g;return{min:new Be((c.x*u+a.canonical.x)*g+a.wrap,(c.y*u+a.canonical.y)*g),max:new Be(h,v)}}function jF(c,n,a){const u=1<<a.canonical.z,g=((n.x-a.wrap)*u-a.canonical.x)*Nn,h=(n.y*u-a.canonical.y)*Nn;return{min:new Be(((c.x-a.wrap)*u-a.canonical.x)*Nn,(c.y*u-a.canonical.y)*Nn),max:new Be(g,h)}}function bE(c,n,a,u,g,h,v){const T=c.indices,P=c.vertices,O=[];for(let x=u;x<u+g;x+=3){const k=n[a[x+0]+h],L=n[a[x+1]+h],A=n[a[x+2]+h],R=Math.min(k.x,L.x,A.x),$=Math.max(k.x,L.x,A.x),W=Math.min(k.y,L.y,A.y),Y=Math.max(k.y,L.y,A.y);O.length=0,c.grid.query(new Be(R,W),new Be($,Y),O);for(let re=0;re<O.length;re++){const ie=O[re];if(kr(P[T[3*ie+0]],P[T[3*ie+1]],P[T[3*ie+2]],k,L,A,v))return!0}}return!1}function xE(c,n,a,u){if(!c||!a)return!1;let g=c.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(a.vertices.length<c.vertices.length)return xE(a,u,c,n);const h=n.canonical,v=u.canonical,T=Math.pow(2,v.z-h.z);g=c.vertices.map(P=>new Be((P.x+h.x*Nn)*T-v.x*Nn,(P.y+h.y*Nn)*T-v.y*Nn))}return bE(a,g,c.indices,0,c.indices.length,0,0)}function wE(c,n,a,u){const g=Math.pow(2,u.z-a.z);return new Be((c+a.x*Nn)*g-u.x*Nn,(n+a.y*Nn)*g-u.y*Nn)}function SE(c,n){const a=[];n.grid.queryPoint(c,a);const u=n.indices,g=n.vertices;for(let h=0;h<a.length;h++){const v=a[h];if(mr([g[u[3*v+0]],g[u[3*v+1]],g[u[3*v+2]]],c))return!0}return!1}const vx=[new Be(0,0),new Be(Nn,0),new Be(Nn,Nn),new Be(0,Nn)];function TE(c,n){const a=[];let u=[];if(!n||c.length<2)return[c];if(c.length===2)return Sr(c[0],c[1],vx)?[c]:[];for(let g=0;g<c.length+2;g++){const h=c[g%c.length],v=c[(g+1)%c.length],T=Sr(g===0?c[c.length-1]:c[(g-1)%c.length],h,vx),P=Sr(h,v,vx),O=T||P;O&&u.push(h),O&&P||u.length>0&&(u.length>1&&a.push(u),u=[])}return u.length>1&&a.push(u),a}const _x=Op.VectorTileFeature.types,HF=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],GF=["fill-extrusion-flood-light-ground-radius"],WF=Math.pow(2,13),qF=Math.pow(2,15)-1,CE=new Be(0,1),qd=2147483648;function ov(c,n,a,u,g,h,v,T){c.emplaceBack((n<<1)+v,(a<<1)+h,(Math.floor(u*WF)<<1)+g,Math.round(T))}function rv(c,n,a){c.emplaceBack(n.x*Nn,n.y*Nn,a?1:0)}function Ky(c,n,a,u,g,h){c.emplaceBack(n.x,n.y,(a.x<<1)+u,(a.y<<1)+g,h)}function iv(c,n,a){c.emplaceBack(n.x,n.y,n.z,a[0]*16384,a[1]*16384,a[2]*16384)}class EE{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class ME{constructor(){this.centroidXY=new Be(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Be(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Be(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Be(this.max.x-this.min.x,this.max.y-this.min.y)}}class IE{constructor(){this.acc=new Be(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,a){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=a.x,n.min.y=n.max.y=a.y)}appendEdge(n,a,u){this.accCount++,this.acc._add(a);let g=!!this.borders;a.x<n.min.x?(n.min.x=a.x,g=!0):a.x>n.max.x&&(n.max.x=a.x,g=!0),a.y<n.min.y?(n.min.y=a.y,g=!0):a.y>n.max.y&&(n.max.y=a.y,g=!0),((a.x===0||a.x===Nn)&&a.x===u.x)!=((a.y===0||a.y===Nn)&&a.y===u.y)&&this.processBorderOverlap(a,u),g&&this.checkBorderIntersection(a,u)}checkBorderIntersection(n,a){a.x<0!=n.x<0&&this.addBorderIntersection(0,uo(a.y,n.y,(0-a.x)/(n.x-a.x))),a.x>Nn!=n.x>Nn&&this.addBorderIntersection(1,uo(a.y,n.y,(Nn-a.x)/(n.x-a.x))),a.y<0!=n.y<0&&this.addBorderIntersection(2,uo(a.x,n.x,(0-a.y)/(n.y-a.y))),a.y>Nn!=n.y>Nn&&this.addBorderIntersection(3,uo(a.x,n.x,(Nn-a.y)/(n.y-a.y)))}addBorderIntersection(n,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];a<u[0]&&(u[0]=a),a>u[1]&&(u[1]=a)}processBorderOverlap(n,a){if(n.x===a.x){if(n.y===a.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,a.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,a.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new Be(0,0):new Be(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,a)=>n+ +(a[0]!==Number.MAX_VALUE),0):0}}function AE(c,n){const a=c.add(n)._unit(),u=yt(c.x*a.x+c.y*a.y,-1,1);var g,h,v;return v=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(v)))/4*qF*((g=c).x*(h=n).y-g.y*h.x<0?-1:1)}const KF=[c=>c.x<0,c=>c.x>Nn,c=>c.y<0,c=>c.y>Nn];function ZF(c,n,a,u){const g=[4];if(u===0)return g;a._mult(u);const h=c.sub(a),v=n.sub(a),T=[c,n,h,v];for(let P=0;P<4;P++)for(const O of T)if(KF[P](O)){g.push(P);break}return g}class kE{constructor(n){this.vertexArray=new zg,this.indexArray=new bi,this.programConfigurations=new jl(n.layers,{zoom:n.zoom,lut:n.lut},a=>GF.includes(a)),this._segments=new ki,this.hiddenByLandmarkVertexArray=new Mp,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ki}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,a,u,g=!1){const h=n.length;if(h>2){let v=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let P;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const O=n[0],x=n[1];P=AE(O.sub(n[h-1])._perp()._unit(),x.sub(O)._perp()._unit())}for(let O=0;O<h;O++){const x=O===h-1?0:O+1,k=n[O],L=n[x],A=n[x===h-1?0:x+1],R=L.sub(k)._perp()._unit(),$=AE(R,A.sub(L)._perp()._unit()),W=P,Y=$;if(yx(k,L,a)||g&&LE(k,a)&&LE(L,a)){P=$;continue}const re=T.vertexLength;Ky(this.vertexArray,k,L,1,1,W),Ky(this.vertexArray,k,L,1,0,W),Ky(this.vertexArray,k,L,0,1,Y),Ky(this.vertexArray,k,L,0,0,Y),T.vertexLength+=4;const ie=ZF(k,L,R,u);for(const Q of ie)this._segmentToGroundQuads[v].push({id:re,region:Q}),this._segmentToRegionTriCounts[v][Q]+=2,T.primitiveLength+=2;P=$}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),a=n.length;for(let u=0;u<a;u++)this._segmentToGroundQuads[u].sort((g,h)=>g.region-h.region);for(let u=0;u<a;u++){const g=this._segmentToGroundQuads[u],h=n[u],v=this._segmentToRegionTriCounts[u];v.reduce((P,O)=>P+O,0);let T=0;for(let P=0;P<=4;P++){const O=v[P];if(O!==0){let x=this.regionSegments[P];x||(x=this.regionSegments[P]=new ki);const k={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+T,vertexLength:h.vertexLength,primitiveLength:O};x.get().push(k)}T+=O}for(let P=0;P<g.length;P++){const O=g[P].id;this.indexArray.emplaceBack(O,O+1,O+3),this.indexArray.emplaceBack(O,O+3,O+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,a,u,g,h,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,a,u,g,h,v)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,FF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,a,u,g,h,v){this.hasData()&&this.programConfigurations.updatePaintArrays(n,a,u,g,h,v)}updateHiddenByLandmark(n){if(!this.hasData())return;const a=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&qd?1:0;for(let g=n.groundVertexArrayOffset;g<a;++g)this.hiddenByLandmarkVertexArray.emplace(g,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,$F.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const a=this.regionSegments[n];a&&a.destroy()}}}}class Zy{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new bi,this.footprintVertices=new fu,this.footprintSegments=[],this.layoutVertexArray=new Dd,this.centroidVertexArray=new Ay,this.wallVertexArray=new Gg,this.indexArray=new bi,this.programConfigurations=new jl(n.layers,{zoom:n.zoom,lut:n.lut},a=>HF.includes(a)),this.segments=new ki,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.groundEffect=new kE(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,a){}populate(n,a,u,g){this.features=[],this.hasPattern=lx("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=lt(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:v,index:T,sourceLayerIndex:P}of n){const O=this.layers[0]._featureFilter.needGeometry,x=pn(h,O);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),x,u))continue;const k={id:v,sourceLayerIndex:P,index:T,geometry:O?x.geometry:It(h,u,g),properties:h.properties,type:h.type,patterns:{}},L=this.layoutVertexArray.length,A=_x[k.type]==="Polygon";if(this.hasPattern)this.features.push(cx("fill-extrusion",this.layers,k,this.zoom,a));else if(this.wallMode)for(const R of k.geometry)for(const $ of TE(R,A))this.addFeature(k,[$],T,u,{},a.availableImages,g,a.brightness);else this.addFeature(k,k.geometry,T,u,{},a.availableImages,g,a.brightness);a.featureIndex.insert(h,k.geometry,T,P,this.index,L)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,a,u,g,h,v){for(const T of this.features){const P=_x[T.type]==="Polygon",{geometry:O}=T;if(this.wallMode)for(const x of O)for(const k of TE(x,P))this.addFeature(T,[k],T.index,a,u,g,h,v);else this.addFeature(T,O,T.index,a,u,g,h,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,a,u,g,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(n,a,T,u,g,h),this.groundEffect.update(n,a,T,u,g,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,UF),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,NF.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,VF.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,BF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,a,u,g,h,v,T,P){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,x=[new Be(0,0),new Be(Nn,Nn)],k=T.projection,L=k.name==="globe",A=this.wallMode||_x[n.type]==="Polygon",R=new IE;R.centroidDataIndex=this.centroidData.length;const $=new ME,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},g)<=0,Y=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},g);let re;if($.height=Y,$.vertexArrayOffset=this.layoutVertexArray.length,$.groundVertexArrayOffset=this.groundEffect.vertexArray.length,L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ef),this.wallMode){if(L)return void Bn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(a.length!==1)return;re=function($e){const st=$e[0].x===$e[$e.length-1].x&&$e[0].y===$e[$e.length-1].y;(function(Pn){let Sn=0;const wo=Pn.length;for(let Xn=0;Xn<wo;Xn++)Sn+=(Pn[(Xn+1)%wo].x-Pn[Xn].x)*(Pn[(Xn+1)%wo].y+Pn[Xn].y);return Sn>=0})($e)||($e=$e.reverse());const rt={geometry:[],joinNormals:[],indices:[]},ht=[],pt=[],Tt=[];let Lt=$e.length;if(Lt<(st?3:2))return rt;for(;Lt>=2&&$e[Lt-1].equals($e[Lt-2]);)Lt--;let Ft,Pt,sn,Cn,Jt,Jn=0;for(;Jn<Lt-1&&$e[Jn].equals($e[Jn+1]);)Jn++;st&&(Ft=$e[Lt-2],Jt=$e[Jn].sub(Ft)._unit()._perp());for(let Pn=Jn;Pn<Lt;Pn++){if(sn=Pn===Lt-1?st?$e[Jn+1]:void 0:$e[Pn+1],sn&&$e[Pn].equals(sn))continue;Jt&&(Cn=Jt),Ft&&(Pt=Ft),Ft=$e[Pn],Jt=sn?sn.sub(Ft)._unit()._perp():Cn,Cn=Cn||Jt;let Sn=Cn.add(Jt);Sn.x===0&&Sn.y===0||Sn._unit();const wo=Sn.x*Jt.x+Sn.y*Jt.y,Xn=wo!==0?1/wo:1/0,io=Cn.x*Jt.y-Cn.y*Jt.x>0;let Uo="miter";const er=2;Uo==="miter"&&Xn>er&&(Uo="bevel"),Uo==="bevel"&&(Xn>100&&(Uo="flipbevel"),Xn<er&&(Uo="miter"));const tr=(Zo,lr,ar,Qr)=>{const Wr=new Be(Zo.x,Zo.y),Bo=new Be(Zo.x,Zo.y);Wr.x+=lr.x*Qr,Wr.y+=lr.y*Qr,Bo.x-=lr.x*Math.max(ar,1),Bo.y-=lr.y*Math.max(ar,1),Tt.push(lr),ht.push(Wr),pt.push(Bo)};if(Uo==="miter")Sn._mult(Xn),tr(Ft,Sn,0,0);else if(Uo==="flipbevel")Sn=Jt.mult(-1),tr(Ft,Sn,0,0),tr(Ft,Sn.mult(-1),0,0);else{const Zo=-Math.sqrt(Xn*Xn-1),lr=io?Zo:0,ar=io?0:Zo;Pt&&tr(Ft,Cn,lr,ar),sn&&tr(Ft,Jt,lr,ar)}}rt.geometry=[...ht,...pt.reverse(),ht[0]],rt.joinNormals=[...Tt,...Tt.reverse(),Tt[Tt.length-1]];const Fn=rt.geometry.length-1;for(let Pn=0;Pn<Fn/2;Pn++)if(Pn+1<Fn/2){let Sn=Pn,wo=Pn+1,Xn=Fn-1-Pn,io=Fn-2-Pn;Sn=Sn===0?Fn-1:Sn-1,wo=wo===0?Fn-1:wo-1,Xn=Xn===0?Fn-1:Xn-1,io=io===0?Fn-1:io-1,rt.indices.push(Xn),rt.indices.push(wo),rt.indices.push(Sn),rt.indices.push(Xn),rt.indices.push(io),rt.indices.push(wo)}return rt}(a[0]),a=[re.geometry]}const ie=($e,st)=>$e<(st.length-1)/2||$e===st.length-1,Q=this.wallMode?[a]:jy(a,500);for(let $e=Q.length-1;$e>=0;$e--){const st=Q[$e];(st.length===0||(ue=st[0]).every(Fe=>Fe.x<=0)||ue.every(Fe=>Fe.x>=Nn)||ue.every(Fe=>Fe.y<=0)||ue.every(Fe=>Fe.y>=Nn))&&Q.splice($e,1)}var ue;let _e;if(L)_e=FE(Q,x,g);else{_e=[];for(const $e of Q)_e.push({polygon:$e,bounds:x})}const Ie=A?this.edgeRadius:0,Ge=Ie>0&&this.zoom<17,ze=($e,st)=>{if($e.length===0)return!1;const Fe=$e[$e.length-1];return st.x===Fe.x&&st.y===Fe.y};for(const{polygon:$e,bounds:st}of _e){let Fe=0,rt=0;for(const Lt of $e)A&&!Lt[0].equals(Lt[Lt.length-1])&&Lt.push(Lt[0]),rt+=A?Lt.length-1:Lt.length;const ht=this.segments.prepareSegment((A?5:4)*rt,this.layoutVertexArray,this.indexArray);$.footprintSegIdx<0&&($.footprintSegIdx=this.footprintSegments.length),$.polygonSegIdx<0&&($.polygonSegIdx=this.polygonSegments.length);const pt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Tt=new EE;if(Tt.vertexOffset=this.footprintVertices.length,Tt.indexOffset=3*this.footprintIndices.length,Tt.ringIndices=[],A){const Lt=[],Ft=[];Fe=ht.vertexLength;for(let sn=0;sn<$e.length;sn++){const Cn=$e[sn];Cn.length&&sn!==0&&Ft.push(Lt.length/2);const Jt=[];let Jn,Fn;Jn=Cn[1].sub(Cn[0])._perp()._unit(),Tt.ringIndices.push(Cn.length-1);for(let Pn=1;Pn<Cn.length;Pn++){const Sn=Cn[Pn],wo=Cn[Pn===Cn.length-1?1:Pn+1],Xn=Sn.clone();if(Ie){Fn=wo.sub(Sn)._perp()._unit();const io=Jn.add(Fn)._unit(),Uo=Ie*Math.min(4,1/(Jn.x*io.x+Jn.y*io.y));Xn.x+=Uo*io.x,Xn.y+=Uo*io.y,Xn.x=Math.round(Xn.x),Xn.y=Math.round(Xn.y),Jn=Fn}if(!W||Ie!==0&&!Ge||ze(Jt,Xn)||Jt.push(Xn),ov(this.layoutVertexArray,Xn.x,Xn.y,0,0,1,1,0),this.wallMode){const io=ie(Pn,Cn);rv(this.wallVertexArray,re.joinNormals[Pn],!io)}ht.vertexLength++,this.footprintVertices.emplaceBack(Sn.x,Sn.y),Lt.push(Sn.x,Sn.y),L&&iv(this.layoutVertexExtArray,k.projectTilePoint(Xn.x,Xn.y,g),k.upVector(g,Xn.x,Xn.y))}W&&(Ie===0||Ge)&&(Jt.length!==0&&ze(Jt,Jt[0])&&Jt.pop(),this.groundEffect.addData(Jt,st,O))}const Pt=this.wallMode?re.indices:Qg(Lt,Ft);for(let sn=0;sn<Pt.length;sn+=3)this.footprintIndices.emplaceBack(Tt.vertexOffset+Pt[sn+0],Tt.vertexOffset+Pt[sn+1],Tt.vertexOffset+Pt[sn+2]),this.indexArray.emplaceBack(Fe+Pt[sn],Fe+Pt[sn+2],Fe+Pt[sn+1]),ht.primitiveLength++;Tt.indexCount+=Pt.length,Tt.vertexCount+=this.footprintVertices.length-Tt.vertexOffset}for(let Lt=0;Lt<$e.length;Lt++){const Ft=$e[Lt];R.startRing($,Ft[0]);let Pt=Ft.length>4&&OE(Ft[Ft.length-2],Ft[0],Ft[1]),sn=Ie?YF(Ft[Ft.length-2],Ft[0],Ft[1],Ie):0;const Cn=[];let Jt,Jn,Fn;Jn=Ft[1].sub(Ft[0])._perp()._unit();let Pn=!0;for(let Sn=1,wo=0;Sn<Ft.length;Sn++){let Xn=Ft[Sn-1],io=Ft[Sn];const Uo=Ft[Sn===Ft.length-1?1:Sn+1];if(R.appendEdge($,io,Xn),yx(io,Xn,st)){Ie&&(Jn=Uo.sub(io)._perp()._unit(),Pn=!Pn);continue}const er=io.sub(Xn)._perp(),tr=er.x/(Math.abs(er.x)+Math.abs(er.y)),Zo=er.y>0?1:0,lr=Xn.dist(io);if(wo+lr>32768&&(wo=0),Ie){Fn=Uo.sub(io)._perp()._unit();let Bo=RE(Xn,io,Uo,PE(Jn,Fn),Ie);isNaN(Bo)&&(Bo=0);const Dr=io.sub(Xn)._unit();Xn=Xn.add(Dr.mult(sn))._round(),io=io.add(Dr.mult(-Bo))._round(),sn=Bo,Jn=Fn,W&&this.zoom>=17&&(ze(Cn,Xn)||Cn.push(Xn),ze(Cn,io)||Cn.push(io))}const ar=ht.vertexLength,Qr=Ft.length>4&&OE(Xn,io,Uo);let Wr=DE(wo,Pt,Pn);if(ov(this.layoutVertexArray,Xn.x,Xn.y,tr,Zo,0,0,Wr),ov(this.layoutVertexArray,Xn.x,Xn.y,tr,Zo,0,1,Wr),this.wallMode){const Bo=ie(Sn-1,Ft),Dr=re.joinNormals[Sn-1];rv(this.wallVertexArray,Dr,Bo),rv(this.wallVertexArray,Dr,Bo)}if(wo+=lr,Wr=DE(wo,Qr,!Pn),Pt=Qr,ov(this.layoutVertexArray,io.x,io.y,tr,Zo,0,0,Wr),ov(this.layoutVertexArray,io.x,io.y,tr,Zo,0,1,Wr),this.wallMode){const Bo=ie(Sn,Ft),Dr=re.joinNormals[Sn];rv(this.wallVertexArray,Dr,Bo),rv(this.wallVertexArray,Dr,Bo)}if(ht.vertexLength+=4,this.indexArray.emplaceBack(ar+0,ar+1,ar+2),this.indexArray.emplaceBack(ar+1,ar+3,ar+2),ht.primitiveLength+=2,Ie){const Bo=Fe+(Sn===1?Ft.length-2:Sn-2),Dr=Sn===1?Fe:Bo+1;if(this.indexArray.emplaceBack(ar+1,Bo,ar+3),this.indexArray.emplaceBack(Bo,Dr,ar+3),ht.primitiveLength+=2,Jt===void 0&&(Jt=ar),!yx(Uo,Ft[Sn],st)){const Br=Sn===Ft.length-1?Jt:ht.vertexLength;this.indexArray.emplaceBack(ar+2,ar+3,Br),this.indexArray.emplaceBack(ar+3,Br+1,Br),this.indexArray.emplaceBack(ar+3,Dr,Br+1),ht.primitiveLength+=3}Pn=!Pn}if(L){const Bo=this.layoutVertexExtArray,Dr=k.projectTilePoint(Xn.x,Xn.y,g),Br=k.projectTilePoint(io.x,io.y,g),mi=k.upVector(g,Xn.x,Xn.y),Di=k.upVector(g,io.x,io.y);iv(Bo,Dr,mi),iv(Bo,Dr,mi),iv(Bo,Br,Di),iv(Bo,Br,Di)}}A&&(Fe+=Ft.length-1),W&&Ie&&this.zoom>=17&&(Cn.length!==0&&ze(Cn,Cn[0])&&Cn.pop(),this.groundEffect.addData(Cn,st,O,Ie>0))}this.footprintSegments.push(Tt),pt.triangleCount=this.indexArray.length-pt.triangleArrayOffset,this.polygonSegments.push(pt),++$.footprintSegLen,++$.polygonSegLen}if($.vertexCount=this.layoutVertexArray.length-$.vertexArrayOffset,$.groundVertexCount=this.groundEffect.vertexArray.length-$.groundVertexArrayOffset,$.vertexCount!==0){if($.centroidXY=R.borders?CE:this.encodeCentroid(R,$),this.centroidData.push($),R.borders){this.featuresOnBorder.push(R);const $e=this.featuresOnBorder.length-1;for(let st=0;st<R.borders.length;st++)R.borders[st][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[st].push($e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,P),this.groundEffect.addPaintPropertiesData(n,u,h,v,g,P),this.maxHeight=Math.max(this.maxHeight,Y)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((a,u)=>this.featuresOnBorder[a].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let T=0;T<this.centroidData.length;T++){const P=this.centroidData[T],O=+(P.min.y+P.max.y>Nn),x=2*O+(+(P.min.x+P.max.x>Nn)^O);for(let k=0;k<P.polygonSegLen;k++){const L=P.polygonSegIdx+k;n.push({centroidIdx:T,subtile:x,polygonSegmentIdx:L,triangleSegmentIdx:this.polygonSegments[L].triangleSegIdx})}}const a=new bi;n.sort((T,P)=>T.triangleSegmentIdx===P.triangleSegmentIdx?T.subtile-P.subtile:T.triangleSegmentIdx-P.triangleSegmentIdx);let u=0,g=0,h=0;for(const T of n){if(T.triangleSegmentIdx!==u)break;h++}const v=n.length;for(;g!==n.length;){u=n[g].triangleSegmentIdx;let T=0,P=g,O=g;for(let x=P;x<h&&n[x].subtile===T;x++)O++;for(;P!==h;){const x=n[P];T=x.subtile;const k=this.centroidData[x.centroidIdx].min.clone(),L=this.centroidData[x.centroidIdx].max.clone(),A={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:a.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=P;R<O;R++){const $=n[R],W=this.polygonSegments[$.polygonSegmentIdx],Y=this.centroidData[$.centroidIdx].min,re=this.centroidData[$.centroidIdx].max,ie=this.indexArray.uint16;for(let Q=W.triangleArrayOffset;Q<W.triangleArrayOffset+W.triangleCount;Q++)a.emplaceBack(ie[3*Q],ie[3*Q+1],ie[3*Q+2]);A.primitiveLength+=W.triangleCount,k.x=Math.min(k.x,Y.x),k.y=Math.min(k.y,Y.y),L.x=Math.max(L.x,re.x),L.y=Math.max(L.y,re.y)}A.primitiveLength>0&&this.triangleSubSegments.push({segment:A,min:k,max:L}),P=O;for(let R=P;R<h&&n[R].subtile===n[P].subtile;R++)O++}g=h;for(let x=g;x<v&&n[x].triangleSegmentIdx===n[g].triangleSegmentIdx;x++)h++}a._trim(),this.indexArray=a}getVisibleSegments(n,a,u){const g=new ki;if(this.wallMode){for(const $ of this.triangleSubSegments)g.segments.push($.segment);return g}let h=0,v=0;const T=1<<n.canonical.z;if(a){const $=a.getMinMaxForTile(n);$&&(h=$.min,v=$.max)}v+=this.maxHeight;const P=n.toUnwrapped();let O;const x=[P.canonical.x/T+P.wrap,P.canonical.y/T],k=[(P.canonical.x+1)/T+P.wrap,(P.canonical.y+1)/T],L=($,W,Y)=>[$[0]*(1-Y[0])+W[0]*Y[0],$[1]*(1-Y[1])+W[1]*Y[1]],A=[],R=[];for(const $ of this.triangleSubSegments){A[0]=$.min.x/Nn,A[1]=$.min.y/Nn,R[0]=$.max.x/Nn,R[1]=$.max.y/Nn;const W=L(x,k,A),Y=L(x,k,R);if(new Fr([W[0],W[1],h],[Y[0],Y[1],v]).intersectsPrecise(u)===0){O&&(g.segments.push(O),O=void 0);continue}const re=$.segment;O&&O.vertexOffset!==re.vertexOffset&&(g.segments.push(O),O=void 0),O?(O.vertexLength+=re.vertexLength,O.primitiveLength+=re.primitiveLength):O={vertexOffset:re.vertexOffset,primitiveLength:re.primitiveLength,vertexLength:re.vertexLength,primitiveOffset:re.primitiveOffset,sortKey:void 0,vaos:{}}}return O&&g.segments.push(O),g}encodeCentroid(n,a){const u=n.centroid(),g=a.span(),h=Math.min(7,Math.round(g.x*this.tileToMeter/10)),v=Math.min(7,Math.round(g.y*this.tileToMeter/10));return new Be(yt(u.x,1,Nn-1)<<3|h,yt(u.y,1,Nn-1)<<3|v)}encodeBorderCentroid(n){if(!n.borders)return new Be(0,0);const a=n.borders,u=Number.MAX_VALUE;if(a[0][0]!==u||a[1][0]!==u){const g=a[0][0]!==u?0:1;return new Be(6|(a[0][0]!==u?0:65528),(a[g][0]+a[g][1])/2<<3|6)}{const g=a[2][0]!==u?2:3;return new Be((a[g][0]+a[g][1])/2<<3|6,6|(a[2][0]!==u?0:65528))}}showCentroid(n){const a=this.centroidData[n.centroidDataIndex];a.flags&=qd,a.centroidXY.x=0,a.centroidXY.y=0,this.writeCentroidToBuffer(a)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const a=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,g=n.flags&qd?CE:n.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(a);if(this.centroidVertexArray.geta_centroid_pos1(a)!==g.y||h!==g.x){for(let v=a;v<u;++v)this.centroidVertexArray.emplace(v,g.x,g.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,a,u){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const g=a.getReplacementRegionsForTile(n.toUnwrapped());if(gx(this.activeReplacements,g))return;if(this.activeReplacements=g,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const h=[];for(const v of this.activeReplacements){if(v.order<u)continue;const T=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-n.canonical.z));for(const P of this.centroidData)if(!(P.flags&qd||v.min.x>P.max.x||P.min.x>v.max.x||v.min.y>P.max.y||P.min.y>v.max.y))for(let O=0;O<P.footprintSegLen;O++){const x=this.footprintSegments[P.footprintSegIdx+O];if(h.length=0,XF(this.footprintVertices,x.vertexOffset,x.vertexCount,v.footprintTileId.canonical,n.canonical,h),bE(v.footprint,h,this.footprintIndices.uint16,x.indexOffset,x.indexCount,-x.vertexOffset,-T)){P.flags|=qd;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,a,u){let g=!1;for(let h=0;h<u.footprintSegLen;h++){const v=this.footprintSegments[u.footprintSegIdx+h];let T=0;for(const P of v.ringIndices){for(let O=T,x=P+T-1;O<P+T;x=O++){const k=this.footprintVertices.int16[2*(O+v.vertexOffset)+0],L=this.footprintVertices.int16[2*(O+v.vertexOffset)+1],A=this.footprintVertices.int16[2*(x+v.vertexOffset)+1];L>a!=A>a&&n<(this.footprintVertices.int16[2*(x+v.vertexOffset)+0]-k)*(a-L)/(A-L)+k&&(g=!g)}T=P}}return g}getHeightAtTileCoord(n,a){let u=Number.NEGATIVE_INFINITY,g=!0;const h=4*(n+Nn)*Nn+(a+Nn);if(this.partLookup.hasOwnProperty(h)){const v=this.partLookup[h];return v?{height:v.height,hidden:!!(v.flags&qd)}:void 0}for(const v of this.centroidData)n>v.max.x||v.min.x>n||a>v.max.y||v.min.y>a||this.footprintContainsPoint(n,a,v)&&v&&v.height>u&&(u=v.height,this.partLookup[h]=v,g=!!(v.flags&qd));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:g};this.partLookup[h]=void 0}}function PE(c,n){const a=c.add(n)._unit();return c.x*a.x+c.y*a.y}function YF(c,n,a,u){const g=n.sub(c)._perp()._unit(),h=a.sub(n)._perp()._unit();return RE(c,n,a,PE(g,h),u)}function RE(c,n,a,u,g){const h=Math.sqrt(1-u*u);return Math.min(c.dist(n)/3,n.dist(a)/3,g*h/u)}function yx(c,n,a){return c.x<a[0].x&&n.x<a[0].x||c.x>a[1].x&&n.x>a[1].x||c.y<a[0].y&&n.y<a[0].y||c.y>a[1].y&&n.y>a[1].y}function LE(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function OE(c,n,a){if(c.x<0||c.x>=Nn||n.x<0||n.x>=Nn||a.x<0||a.x>=Nn)return!1;const u=a.sub(n),g=u.perp(),h=c.sub(n);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&g.x*h.x+g.y*h.y<0}function DE(c,n,a){const u=n?2|c:-3&c;return a?1|u:-2&u}function zE(){const c=Math.PI/32,n=Math.tan(c),a=V;return a*Math.sqrt(1+2*n*n)-a}function FE(c,n,a){const u=1<<a.z,g=De(a.x/u),h=De((a.x+1)/u),v=je(a.y/u),T=je((a.y+1)/u);return function(P,O,x,k,L=0,A){const R=[];if(!P.length||!x||!k)return R;const $=(_e,Ie)=>{for(const Ge of _e)R.push({polygon:Ge,bounds:Ie})},W=Math.ceil(Math.log2(x)),Y=Math.ceil(Math.log2(k)),re=W-Y,ie=[];for(let _e=0;_e<Math.abs(re);_e++)ie.push(re>0?0:1);for(let _e=0;_e<Math.min(W,Y);_e++)ie.push(0),ie.push(1);let Q=P;if(Q=Gy(Q,O[0].y-L,O[1].y+L,1),Q=Gy(Q,O[0].x-L,O[1].x+L,0),!Q.length)return R;const ue=[];for(ie.length?ue.push({polygons:Q,bounds:O,depth:0}):$(Q,O);ue.length;){const _e=ue.pop(),Ie=_e.depth,Ge=ie[Ie],ze=_e.bounds[0],$e=_e.bounds[1],st=Ge===0?ze.x:ze.y,Fe=Ge===0?$e.x:$e.y,rt=A?A(Ge,st,Fe):.5*(st+Fe),ht=Gy(_e.polygons,st-L,rt+L,Ge),pt=Gy(_e.polygons,rt-L,Fe+L,Ge);if(ht.length){const Tt=[ze,new Be(Ge===0?rt:$e.x,Ge===1?rt:$e.y)];ie.length>Ie+1?ue.push({polygons:ht,bounds:Tt,depth:Ie+1}):$(ht,Tt)}if(pt.length){const Tt=[new Be(Ge===0?rt:ze.x,Ge===1?rt:ze.y),$e];ie.length>Ie+1?ue.push({polygons:pt,bounds:Tt,depth:Ie+1}):$(pt,Tt)}}return R}(c,n,Math.ceil((h-g)/11.25),Math.ceil((v-T)/11.25),1,(P,O,x)=>{if(P===0)return .5*(O+x);{const k=je((a.y+O/Nn)/u);return(Te(.5*(je((a.y+x/Nn)/u)+k))*u-a.y)*Nn}})}function XF(c,n,a,u,g,h){const v=Math.pow(2,u.z-g.z);for(let T=0;T<a;T++){let P=c.int16[2*(T+n)+0],O=c.int16[2*(T+n)+1];P=(P+g.x*Nn)*v-u.x*Nn,O=(O+g.y*Nn)*v-u.y*Nn,h.push(new Be(P,O))}}let BE,NE;function av(c,n){return c.x*n.x+c.y*n.y}function $E(c,n){if(c.length===1){let a=0;const u=n[a++];let g;for(;!g||u.equals(g);)if(g=n[a++],!g)return 1/0;for(;a<n.length;a++){const h=n[a],v=c[0],T=g.sub(u),P=h.sub(u),O=v.sub(u),x=av(T,T),k=av(T,P),L=av(P,P),A=av(O,T),R=av(O,P),$=x*L-k*k,W=(L*A-k*R)/$,Y=(x*R-k*A)/$,re=u.z*(1-W-Y)+g.z*W+h.z*Y;if(isFinite(re))return re}return 1/0}{let a=1/0;for(const u of n)a=Math.min(a,u.z);return a}}function VE(c,n,a,u,g,h,v,T){const P=v*g.getElevationAt(c,n,!0,!0),O=h[0]!==0,x=O?h[1]===0?v*(h[0]/7-450):v*function(k,L,A){const R=Math.floor(L[0]/8),$=Math.floor(L[1]/8),W=10*(L[0]-8*R),Y=10*(L[1]-8*$),re=k.getElevationAt(R,$,!0,!0),ie=k.getMeterToDEM(A),Q=Math.floor(.5*(W*ie-1)),ue=Math.floor(.5*(Y*ie-1)),_e=k.tileCoordToPixel(R,$),Ie=2*Q+1,Ge=2*ue+1,ze=function(pt,Tt,Lt,Ft,Pt){return[pt.getElevationAtPixel(Tt,Lt,!0),pt.getElevationAtPixel(Tt+Pt,Lt,!0),pt.getElevationAtPixel(Tt,Lt+Pt,!0),pt.getElevationAtPixel(Tt+Ft,Lt+Pt,!0)]}(k,_e.x-Q,_e.y-ue,Ie,Ge),$e=Math.abs(ze[0]-ze[1]),st=Math.abs(ze[2]-ze[3]),Fe=Math.abs(ze[0]-ze[2])+Math.abs(ze[1]-ze[3]),rt=Math.min(.25,.5*ie*($e+st)/Ie),ht=Math.min(.25,.5*ie*Fe/Ge);return re+Math.max(rt*W,ht*Y)}(g,h,T):P;return{base:P+(a===0?-1:a),top:O?Math.max(x+u,P+a+2):P+u}}no(Zy,"FillExtrusionBucket",{omit:["layers","features"]}),no(ME,"PartData"),no(EE,"FootprintSegment"),no(IE,"BorderCentroidData"),no(kE,"GroundEffect");const JF=Mr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),QF=Mr([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:eB}=JF,tB=Mr([{name:"a_packed",components:4,type:"Float32"}]),{members:nB}=tB,oB=Mr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:rB}=oB;class UE{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.image=new Wd({width:n,height:a}),this.positions={},this.uploaded=!1}getDash(n,a){const u=this.getKey(n,a);return this.positions[u]}trim(){const n=this.width,a=this.height=ur(this.nextRow);this.image.resize({width:n,height:a})}getKey(n,a){return n.join(",")+a}getDashRanges(n,a,u){const g=[];let h=n.length%2==1?-n[n.length-1]*u:0,v=n[0]*u,T=!0;g.push({left:h,right:v,isDash:T,zeroLength:n[0]===0});let P=n[0];for(let O=1;O<n.length;O++){T=!T;const x=n[O];h=P*u,P+=x,v=P*u,g.push({left:h,right:v,isDash:T,zeroLength:x===0})}return g}addRoundDash(n,a,u){const g=a/2;for(let h=-u;h<=u;h++){const v=this.width*(this.nextRow+u+h);let T=0,P=n[T];for(let O=0;O<this.width;O++){O/P.right>1&&(P=n[++T]);const x=Math.abs(O-P.left),k=Math.abs(O-P.right),L=Math.min(x,k);let A;const R=h/u*(g+1);if(P.isDash){const $=g-Math.abs(R);A=Math.sqrt(L*L+$*$)}else A=g-Math.sqrt(L*L+R*R);this.image.data[v+O]=Math.max(0,Math.min(255,A+128))}}}addRegularDash(n,a){for(let P=n.length-1;P>=0;--P){const O=n[P],x=n[P+1];O.zeroLength?n.splice(P,1):x&&x.isDash===O.isDash&&(x.left=O.left,n.splice(P,1))}const u=n[0],g=n[n.length-1];u.isDash===g.isDash&&(u.left=g.left-this.width,g.right=u.right+this.width);const h=this.width*this.nextRow;let v=0,T=n[v];for(let P=0;P<this.width;P++){P/T.right>1&&(T=n[++v]);const O=Math.abs(P-T.left),x=Math.abs(P-T.right),k=Math.min(O,x);this.image.data[h+P]=Math.max(0,Math.min(255,(T.isDash?k:-k)+a+128))}}addDash(n,a){const u=this.getKey(n,a);if(this.positions[u])return this.positions[u];const g=a==="round",h=g?7:0,v=2*h+1;if(this.nextRow+v>this.height)return Bn("LineAtlas out of space"),null;n.length===0&&n.push(1);let T=0;for(let x=0;x<n.length;x++)n[x]<0&&(Bn("Negative value is found in line dasharray, replacing values with 0"),n[x]=0),T+=n[x];if(T!==0){const x=this.width/T,k=this.getDashRanges(n,this.width,x);g?this.addRoundDash(k,x,h):this.addRegularDash(k,a==="square"?.5*x:0)}const P=this.nextRow+h;this.nextRow+=v;const O={tl:[P,h],br:[T,0]};return this.positions[u]=O,O}}no(UE,"LineAtlas");const iB=Op.VectorTileFeature.types,aB=Math.cos(Math.PI/180*37.5),sB=Math.cos(Math.PI/180*5);class bx{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Qh,this.layoutVertexArray2=new Ec,this.patternVertexArray=new pu,this.indexArray=new bi,this.programConfigurations=new jl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ki,this.maxLineLength=0,this.zOffsetVertexArray=new $d,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:Nn/64}updateFootprints(n,a){}populate(n,a,u,g){this.hasPattern=lx("line",this.layers,a);const h=this.layers[0].layout.get("line-sort-key");this.hasZOffset=!this.layers[0].isDraped();const v=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&v==="none"&&Bn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const T=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&T!==void 0;const P=[];for(const{feature:L,id:A,index:R,sourceLayerIndex:$}of n){const W=this.layers[0]._featureFilter.needGeometry,Y=pn(L,W);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),Y,u))continue;const re=h?h.evaluate(Y,{},u):void 0,ie={id:A,properties:L.properties,type:L.type,sourceLayerIndex:$,index:R,geometry:W?Y.geometry:It(L,u,g),patterns:{},sortKey:re};P.push(ie)}h&&P.sort((L,A)=>L.sortKey-A.sortKey);const{lineAtlas:O,featureIndex:x}=a,k=this.addConstantDashes(O);for(const L of P){const{geometry:A,index:R,sourceLayerIndex:$}=L;if(k&&this.addFeatureDashes(L,O),this.hasPattern){const W=cx("line",this.layers,L,this.zoom,a);this.patternFeatures.push(W)}else this.addFeature(L,A,R,u,O.positions,a.availableImages,a.brightness);x.insert(n[R].feature,A,R,$,this.index)}}addConstantDashes(n){let a=!1;for(const u of this.layers){const g=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(g.kind!=="constant"||h.kind!=="constant")a=!0;else{const v=h.value,T=g.value;if(!T)continue;n.addDash(T,v)}}return a}addFeatureDashes(n,a){const u=this.zoom;for(const g of this.layers){const h=g.paint.get("line-dasharray").value,v=g.layout.get("line-cap").value;if(h.kind==="constant"&&v.kind==="constant")continue;let T,P;if(h.kind==="constant"){if(T=h.value,!T)continue}else T=h.evaluate({zoom:u},n);P=v.kind==="constant"?v.value:v.evaluate({zoom:u},n),a.addDash(T,P),n.patterns[g.id]=a.getKey(T,P)}}update(n,a,u,g,h){const v=Object.keys(n).length!==0;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,a,v?this.stateDependentLayers:this.layers,u,g,h)}addFeatures(n,a,u,g,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,a,u,g,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,nB)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,rB)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,QF.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,eB),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,a,u,g,h,v,T){const P=this.layers[0].layout,O=P.get("line-join").evaluate(n,{}),x=P.get("line-cap").evaluate(n,{}),k=P.get("line-miter-limit"),L=P.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=P.get("line-z-offset").value;for(const A of a)this.addLine(A,n,g,O,x,k,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,T)}addLine(n,a,u,g,h,v,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const P=g==="none";if(this.patternJoinNone=this.hasPattern&&P,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<n.length-1;ie++)this.totalDistance+=n[ie].dist(n[ie+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=iB[a.type]==="Polygon";let x=n.length;for(;x>=2&&n[x-1].equals(n[x-2]);)x--;let k=0;for(;k<x-1&&n[k].equals(n[k+1]);)k++;if(x<(O?3:2))return;g==="bevel"&&(v=1.05);const L=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let A,R,$,W,Y,re;this.e1=this.e2=-1,O&&(A=n[x-2],Y=n[k].sub(A)._unit()._perp());for(let ie=k;ie<x;ie++){if($=ie===x-1?O?n[k+1]:void 0:n[ie+1],$&&n[ie].equals($))continue;Y&&(W=Y),A&&(R=A),A=n[ie],re=this.hasZOffset?this.evaluateElevationValue(R?R.dist(A):0):null,Y=$?$.sub(A)._unit()._perp():W,W=W||Y;const Q=R&&$;let ue=Q?g:O||P?"butt":h;const _e=W.x*Y.x+W.y*Y.y;if(P){const ht=function(pt){if(pt.patternJoinNone){const Tt=pt.segmentPoints.length/2,Lt=pt.lineSoFar-pt.segmentStart;for(let Ft=0;Ft<Tt;++Ft){const Pt=pt.segmentPoints[2*Ft+1],sn=Math.round(pt.segmentPoints[2*Ft])+.5+.25*Pt;pt.patternVertexArray.emplaceBack(sn,Lt,pt.segmentStart),pt.patternVertexArray.emplaceBack(sn,Lt,pt.segmentStart)}pt.segmentPoints.length=0}pt.e1=pt.e2=-1};if(Q&&_e<sB){this.updateDistance(R,A),this.addCurrentVertex(A,W,1,1,L,re),ht(this),this.addCurrentVertex(A,Y,-1,-1,L,re);continue}if(R){if(!$){this.updateDistance(R,A),this.addCurrentVertex(A,W,1,1,L,re),ht(this);continue}ue="miter"}}let Ie=W.add(Y);Ie.x===0&&Ie.y===0||Ie._unit();const Ge=Ie.x*Y.x+Ie.y*Y.y,ze=Ge!==0?1/Ge:1/0,$e=2*Math.sqrt(2-2*Ge),st=Ge<aB&&R&&$,Fe=W.x*Y.y-W.y*Y.x>0,rt=this.overscaling<=16?15*Nn/(512*this.overscaling):0;if(Q&&ue==="round"){if(ze<T)ue="miter";else if(ze<=2){const ht=xx(A,-10,Nn+10);ue=this.hasZOffset&&(ht||this.hasCrossSlope)?"miter":"fakeround"}}if(ue==="miter"&&ze>v&&(ue="bevel"),ue==="bevel"&&(ze>2&&(ue="flipbevel"),ze<v&&(ue="miter")),R&&!(ue==="miter"&&st)&&this.updateDistance(R,A),ue==="miter")if(st){const ht=A.dist(R);if(ht>2*rt){const Tt=A.sub(A.sub(R)._mult(rt/ht)._round());this.updateDistance(R,Tt),this.addCurrentVertex(Tt,W,0,0,L,re),R=Tt}this.updateDistance(R,A),Ie._mult(ze),this.addCurrentVertex(A,Ie,0,0,L,re);const pt=A.dist($);if(pt>2*rt){const Tt=A.add($.sub(A)._mult(rt/pt)._round());this.updateDistance(A,Tt),this.addCurrentVertex(Tt,Y,0,0,L,re),A=Tt}}else Ie._mult(ze),this.addCurrentVertex(A,Ie,0,0,L,re);else if(ue==="flipbevel"){if(ze>100)Ie=Y.mult(-1);else{const ht=ze*W.add(Y).mag()/W.sub(Y).mag();Ie._perp()._mult(ht*(Fe?-1:1))}this.addCurrentVertex(A,Ie,0,0,L,re),this.addCurrentVertex(A,Ie.mult(-1),0,0,L,re)}else if(ue==="bevel"||ue==="fakeround"){re!=null&&R&&this.addCurrentVertex(A,W,-1,-1,L,re);const ht=A.dist(R)<=2*rt&&ue!=="bevel",pt=Ie.mult(Fe?1:-1);pt._mult(ze);const Tt=Y.mult(Fe?-1:1),Lt=W.mult(Fe?-1:1),Ft=this.evaluateElevationValue(this.distance);if(re==null&&(this.addHalfVertex(A,pt.x,pt.y,!1,!Fe,0,L,Ft),ht||this.addHalfVertex(A,pt.x+2*Lt.x,pt.y+2*Lt.y,!1,Fe,0,L,Ft)),ue==="fakeround"){const Pt=Math.round(180*$e/Math.PI/20);this.addHalfVertex(A,Lt.x,Lt.y,!1,Fe,0,L,Ft);for(let sn=0;sn<Pt;sn++){let Cn=sn/Pt;if(Cn!==.5){const Jn=Cn-.5;Cn+=Cn*Jn*(Cn-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*Jn*Jn+(.848013+_e*(.215638*_e-1.06021)))}const Jt=Tt.sub(Lt)._mult(Cn)._add(Lt)._unit();this.addHalfVertex(A,Jt.x,Jt.y,!1,Fe,0,L,Ft)}this.addHalfVertex(A,Tt.x,Tt.y,!1,Fe,0,L,Ft)}ht||re!=null||this.addHalfVertex(A,pt.x+2*Tt.x,pt.y+2*Tt.y,!1,Fe,0,L,Ft),re!=null&&$&&this.addCurrentVertex(A,Y,1,1,L,re)}else ue==="butt"?this.addCurrentVertex(A,Ie,0,0,L,re):ue==="square"?(R||this.addCurrentVertex(A,Ie,-1,-1,L,re),this.addCurrentVertex(A,Ie,0,0,L,re),R&&this.addCurrentVertex(A,Ie,1,1,L,re)):ue==="round"&&(R&&(this.addCurrentVertex(A,W,0,0,L,re),this.addCurrentVertex(A,W,1,1,L,re,!0)),$&&(this.addCurrentVertex(A,Y,-1,-1,L,re,!0),this.addCurrentVertex(A,Y,0,0,L,re)))}}addVerticesTo(n,a,u,g,h,v,T,P,O,x){const k=(a.w-n.w)/this.tessellationStep|0;let L=0;const A=this.scaledDistance;if(k>1){this.lineSoFar=n.w;const $=(a.x-n.x)/k,W=(a.y-n.y)/k,Y=(a.z-n.z)/k,re=(a.w-n.w)/k;for(let ie=1;ie<k;++ie){n.x+=$,n.y+=W,n.z+=Y,this.lineSoFar+=re,L+=re;const Q=this.evaluateElevationValue(this.prevDistance+L);this.scaledDistance=(this.prevDistance+L)/this.totalDistance,this.addHalfVertex(n,u,g,x,!1,T,O,Q),this.addHalfVertex(n,h,v,x,!0,-P,O,Q)}}this.lineSoFar=a.w,this.scaledDistance=A;const R=this.evaluateElevationValue(this.distance);this.addHalfVertex(a,u,g,x,!1,T,O,R),this.addHalfVertex(a,h,v,x,!0,-P,O,R)}evaluateElevationValue(n){return this.hasZOffset?this.zOffsetValue.kind==="constant"?this.zOffsetValue.value:(this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):Bn(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0):void 0}addCurrentVertex(n,a,u,g,h,v,T=!1){const P=a.x+a.y*u,O=a.y-a.x*u,x=a.y*g-a.x,k=-a.y-a.x*g;if(v!=null){const A=Nn+10,R=v,$=new pE(n.x,n.y,R,this.lineSoFar),W=xx(n,-10,A),Y=this.lineSoFar,re=this.distance;if(this.currentVertex)if(W){const ie=this.currentVertexIsOutside,Q=this.currentVertex,ue=new pE(n.x,n.y,R,this.lineSoFar);if(gE(Q,ue,-10,A),!xx(ue,-10,A)){if(ie){this.e1=this.e2=-1,this.distance-=Q.dist($),this.lineSoFar=Q.w;const _e=this.evaluateElevationValue(Q.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Q,P,O,T,!1,u,h,_e),this.addHalfVertex(Q,x,k,T,!0,-g,h,_e),this.prevDistance=this.distance}this.distance=this.prevDistance+Q.dist(ue),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Q,ue,P,O,x,k,u,g,h,T),this.distance=re,this.scaledDistance=this.distance/this.totalDistance}}else{const ie=this.currentVertex;if(this.currentVertexIsOutside){gE(ie,$,-10,A),this.e1=this.e2=-1,this.distance-=ie.dist($),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ie.w;const Q=this.evaluateElevationValue(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,P,O,T,!1,u,h,Q),this.addHalfVertex(ie,x,k,T,!0,-g,h,Q),this.prevDistance=this.distance,this.distance=re,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ie,$,P,O,x,k,u,g,h,T)}else W||(this.addHalfVertex(n,P,O,T,!1,u,h,v),this.addHalfVertex(n,x,k,T,!0,-g,h,v));this.currentVertex=$,this.currentVertexIsOutside=W,this.lineSoFar=Y}else this.addHalfVertex(n,P,O,T,!1,u,h,v),this.addHalfVertex(n,x,k,T,!0,-g,h,v)}addHalfVertex({x:n,y:a},u,g,h,v,T,P,O){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((n<<1)+(h?1:0),(a<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const x=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),P.primitiveLength++),v?this.e2=x:this.e1=x,O!=null&&this.zOffsetVertexArray.emplaceBack(O)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,a){this.prevDistance=this.distance,this.distance+=n.dist(a),this.updateScaledDistance()}}function xx(c,n,a){return c.x<n||c.x>a||c.y<n||c.y>a}let jE,HE;function GE(c,n,a){return n*(Nn/(c.tileSize*Math.pow(2,a-c.tileID.overscaledZ)))}no(bx,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const WE=(c,n,a)=>(1-a)*c+a*n;function qE(c,n){return 1/GE(c,1,n.tileZoom)}function KE(c,n,a,u){return c.translatePosMatrix(u||n.tileID.projMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const ZE=c=>{const n=[];YE(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const a=c.paint.get("line-trim-offset");a[0]===0&&a[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",g=!!c.paint.get("line-pattern").constantOr(1);return u&&g&&n.push("LINE_JOIN_NONE"),n};function YE(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let wx;const XE=()=>wx||(wx={layout:jE||(jE=new ci({"line-cap":new _o(Ot.layout_line["line-cap"]),"line-join":new _o(Ot.layout_line["line-join"]),"line-miter-limit":new Rn(Ot.layout_line["line-miter-limit"]),"line-round-limit":new Rn(Ot.layout_line["line-round-limit"]),"line-sort-key":new _o(Ot.layout_line["line-sort-key"]),"line-z-offset":new _o(Ot.layout_line["line-z-offset"]),"line-elevation-reference":new Rn(Ot.layout_line["line-elevation-reference"]),"line-cross-slope":new Rn(Ot.layout_line["line-cross-slope"]),visibility:new Rn(Ot.layout_line.visibility)})),paint:HE||(HE=new ci({"line-opacity":new _o(Ot.paint_line["line-opacity"]),"line-color":new _o(Ot.paint_line["line-color"]),"line-translate":new Rn(Ot.paint_line["line-translate"]),"line-translate-anchor":new Rn(Ot.paint_line["line-translate-anchor"]),"line-width":new _o(Ot.paint_line["line-width"]),"line-gap-width":new _o(Ot.paint_line["line-gap-width"]),"line-offset":new _o(Ot.paint_line["line-offset"]),"line-blur":new _o(Ot.paint_line["line-blur"]),"line-dasharray":new _o(Ot.paint_line["line-dasharray"]),"line-pattern":new _o(Ot.paint_line["line-pattern"]),"line-gradient":new Od(Ot.paint_line["line-gradient"]),"line-trim-offset":new Rn(Ot.paint_line["line-trim-offset"]),"line-trim-fade-range":new Rn(Ot.paint_line["line-trim-fade-range"]),"line-trim-color":new Rn(Ot.paint_line["line-trim-color"]),"line-emissive-strength":new Rn(Ot.paint_line["line-emissive-strength"]),"line-border-width":new _o(Ot.paint_line["line-border-width"]),"line-border-color":new _o(Ot.paint_line["line-border-color"]),"line-occlusion-opacity":new Rn(Ot.paint_line["line-occlusion-opacity"])}))},wx);class lB extends _o{possiblyEvaluate(n,a){return a=new Ei(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(n,a)}evaluate(n,a,u,g){return a=mo({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(n,a,u,g)}}let sv;function JE(c,n){return n>0?n+2*c:c}const cB=Mr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),uB=Mr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),dB=Mr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Mr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const hB=Mr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),fB=Mr([{name:"a_texb",components:2,type:"Uint16"}]),pB=Mr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),mB=Mr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Mr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const QE=Mr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),gB=Mr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Mr([{name:"triangle",components:3,type:"Uint16"}]),Mr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Mr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Mr([{type:"Float32",name:"offsetX"}]),Mr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ba=24;const Lc=128;function Sx(c,n){const{expression:a}=n;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Ei(c+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:g}=a;let h=0;for(;h<u.length&&u[h]<=c;)h++;h=Math.max(0,h-1);let v=h;for(;v<u.length&&u[v]<c+1;)v++;v=Math.min(u.length-1,v);const T=u[h],P=u[v];return a.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:P,minSize:a.evaluate(new Ei(T)),maxSize:a.evaluate(new Ei(P)),interpolationType:g}}}function Yy(c,{uSize:n,uSizeT:a},{lowerSize:u,upperSize:g}){return c.kind==="source"?u/Lc:c.kind==="composite"?uo(u/Lc,g/Lc,a):n}function Dp(c,n,a=1){let u=0,g=0;if(c.kind==="constant")g=c.layoutSize*a;else if(c.kind!=="source"){const{interpolationType:h,minZoom:v,maxZoom:T}=c,P=h?yt(ws.interpolationFactor(h,n,v,T),0,1):0;c.kind==="camera"?g=uo(c.minSize,c.maxSize,P)*a:u=P*a}return{uSizeT:u,uSize:g}}var vB=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Lc,evaluateSizeForFeature:Yy,evaluateSizeForZoom:Dp,getSizeData:Sx});function _B(c,n,a){return c.sections.forEach(u=>{u.text=function(g,h,v){const T=h.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),Ts.applyArabicShaping&&(g=Ts.applyArabicShaping(g)),g}(u.text,n,a)}),c}const lv={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function yB(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function bB(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}var eM,Tx,tM,Cx={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function xB(){return eM||(eM=1,Cx.read=function(c,n,a,u,g){var h,v,T=8*g-u-1,P=(1<<T)-1,O=P>>1,x=-7,k=a?g-1:0,L=a?-1:1,A=c[n+k];for(k+=L,h=A&(1<<-x)-1,A>>=-x,x+=T;x>0;h=256*h+c[n+k],k+=L,x-=8);for(v=h&(1<<-x)-1,h>>=-x,x+=u;x>0;v=256*v+c[n+k],k+=L,x-=8);if(h===0)h=1-O;else{if(h===P)return v?NaN:1/0*(A?-1:1);v+=Math.pow(2,u),h-=O}return(A?-1:1)*v*Math.pow(2,h-u)},Cx.write=function(c,n,a,u,g,h){var v,T,P,O=8*h-g-1,x=(1<<O)-1,k=x>>1,L=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=u?0:h-1,R=u?1:-1,$=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(T=isNaN(n)?1:0,v=x):(v=Math.floor(Math.log(n)/Math.LN2),n*(P=Math.pow(2,-v))<1&&(v--,P*=2),(n+=v+k>=1?L/P:L*Math.pow(2,1-k))*P>=2&&(v++,P/=2),v+k>=x?(T=0,v=x):v+k>=1?(T=(n*P-1)*Math.pow(2,g),v+=k):(T=n*Math.pow(2,k-1)*Math.pow(2,g),v=0));g>=8;c[a+A]=255&T,A+=R,T/=256,g-=8);for(v=v<<g|T,O+=g;O>0;c[a+A]=255&v,A+=R,v/=256,O-=8);c[a+A-R]|=128*$}),Cx}function nM(){if(tM)return Tx;tM=1,Tx=n;var c=xB();function n(Q){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Q)?Q:new Uint8Array(Q||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var a=4294967296,u=1/a,g=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(Q){return Q.type===n.Bytes?Q.readVarint()+Q.pos:Q.pos+1}function v(Q,ue,_e){return _e?4294967296*ue+(Q>>>0):4294967296*(ue>>>0)+(Q>>>0)}function T(Q,ue,_e){var Ie=ue<=16383?1:ue<=2097151?2:ue<=268435455?3:Math.floor(Math.log(ue)/(7*Math.LN2));_e.realloc(Ie);for(var Ge=_e.pos-1;Ge>=Q;Ge--)_e.buf[Ge+Ie]=_e.buf[Ge]}function P(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeVarint(Q[_e])}function O(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeSVarint(Q[_e])}function x(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeFloat(Q[_e])}function k(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeDouble(Q[_e])}function L(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeBoolean(Q[_e])}function A(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeFixed32(Q[_e])}function R(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeSFixed32(Q[_e])}function $(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeFixed64(Q[_e])}function W(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeSFixed64(Q[_e])}function Y(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+16777216*Q[ue+3]}function re(Q,ue,_e){Q[_e]=ue,Q[_e+1]=ue>>>8,Q[_e+2]=ue>>>16,Q[_e+3]=ue>>>24}function ie(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+(Q[ue+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(Q,ue,_e){for(_e=_e||this.length;this.pos<_e;){var Ie=this.readVarint(),Ge=Ie>>3,ze=this.pos;this.type=7&Ie,Q(Ge,ue,this),this.pos===ze&&this.skip(Ie)}return ue},readMessage:function(Q,ue){return this.readFields(Q,ue,this.readVarint()+this.pos)},readFixed32:function(){var Q=Y(this.buf,this.pos);return this.pos+=4,Q},readSFixed32:function(){var Q=ie(this.buf,this.pos);return this.pos+=4,Q},readFixed64:function(){var Q=Y(this.buf,this.pos)+Y(this.buf,this.pos+4)*a;return this.pos+=8,Q},readSFixed64:function(){var Q=Y(this.buf,this.pos)+ie(this.buf,this.pos+4)*a;return this.pos+=8,Q},readFloat:function(){var Q=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Q},readDouble:function(){var Q=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Q},readVarint:function(Q){var ue,_e,Ie=this.buf;return ue=127&(_e=Ie[this.pos++]),_e<128?ue:(ue|=(127&(_e=Ie[this.pos++]))<<7,_e<128?ue:(ue|=(127&(_e=Ie[this.pos++]))<<14,_e<128?ue:(ue|=(127&(_e=Ie[this.pos++]))<<21,_e<128?ue:function(Ge,ze,$e){var st,Fe,rt=$e.buf;if(st=(112&(Fe=rt[$e.pos++]))>>4,Fe<128||(st|=(127&(Fe=rt[$e.pos++]))<<3,Fe<128)||(st|=(127&(Fe=rt[$e.pos++]))<<10,Fe<128)||(st|=(127&(Fe=rt[$e.pos++]))<<17,Fe<128)||(st|=(127&(Fe=rt[$e.pos++]))<<24,Fe<128)||(st|=(1&(Fe=rt[$e.pos++]))<<31,Fe<128))return v(Ge,st,ze);throw new Error("Expected varint not more than 10 bytes")}(ue|=(15&(_e=Ie[this.pos]))<<28,Q,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Q=this.readVarint();return Q%2==1?(Q+1)/-2:Q/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Q=this.readVarint()+this.pos,ue=this.pos;return this.pos=Q,Q-ue>=12&&g?function(_e,Ie,Ge){return g.decode(_e.subarray(Ie,Ge))}(this.buf,ue,Q):function(_e,Ie,Ge){for(var ze="",$e=Ie;$e<Ge;){var st,Fe,rt,ht=_e[$e],pt=null,Tt=ht>239?4:ht>223?3:ht>191?2:1;if($e+Tt>Ge)break;Tt===1?ht<128&&(pt=ht):Tt===2?(192&(st=_e[$e+1]))==128&&(pt=(31&ht)<<6|63&st)<=127&&(pt=null):Tt===3?(Fe=_e[$e+2],(192&(st=_e[$e+1]))==128&&(192&Fe)==128&&((pt=(15&ht)<<12|(63&st)<<6|63&Fe)<=2047||pt>=55296&&pt<=57343)&&(pt=null)):Tt===4&&(Fe=_e[$e+2],rt=_e[$e+3],(192&(st=_e[$e+1]))==128&&(192&Fe)==128&&(192&rt)==128&&((pt=(15&ht)<<18|(63&st)<<12|(63&Fe)<<6|63&rt)<=65535||pt>=1114112)&&(pt=null)),pt===null?(pt=65533,Tt=1):pt>65535&&(pt-=65536,ze+=String.fromCharCode(pt>>>10&1023|55296),pt=56320|1023&pt),ze+=String.fromCharCode(pt),$e+=Tt}return ze}(this.buf,ue,Q)},readBytes:function(){var Q=this.readVarint()+this.pos,ue=this.buf.subarray(this.pos,Q);return this.pos=Q,ue},readPackedVarint:function(Q,ue){if(this.type!==n.Bytes)return Q.push(this.readVarint(ue));var _e=h(this);for(Q=Q||[];this.pos<_e;)Q.push(this.readVarint(ue));return Q},readPackedSVarint:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSVarint());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSVarint());return Q},readPackedBoolean:function(Q){if(this.type!==n.Bytes)return Q.push(this.readBoolean());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readBoolean());return Q},readPackedFloat:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFloat());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFloat());return Q},readPackedDouble:function(Q){if(this.type!==n.Bytes)return Q.push(this.readDouble());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readDouble());return Q},readPackedFixed32:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFixed32());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed32());return Q},readPackedSFixed32:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSFixed32());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed32());return Q},readPackedFixed64:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFixed64());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed64());return Q},readPackedSFixed64:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSFixed64());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed64());return Q},skip:function(Q){var ue=7&Q;if(ue===n.Varint)for(;this.buf[this.pos++]>127;);else if(ue===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ue===n.Fixed32)this.pos+=4;else{if(ue!==n.Fixed64)throw new Error("Unimplemented type: "+ue);this.pos+=8}},writeTag:function(Q,ue){this.writeVarint(Q<<3|ue)},realloc:function(Q){for(var ue=this.length||16;ue<this.pos+Q;)ue*=2;if(ue!==this.length){var _e=new Uint8Array(ue);_e.set(this.buf),this.buf=_e,this.length=ue}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Q){this.realloc(4),re(this.buf,Q,this.pos),this.pos+=4},writeSFixed32:function(Q){this.realloc(4),re(this.buf,Q,this.pos),this.pos+=4},writeFixed64:function(Q){this.realloc(8),re(this.buf,-1&Q,this.pos),re(this.buf,Math.floor(Q*u),this.pos+4),this.pos+=8},writeSFixed64:function(Q){this.realloc(8),re(this.buf,-1&Q,this.pos),re(this.buf,Math.floor(Q*u),this.pos+4),this.pos+=8},writeVarint:function(Q){(Q=+Q||0)>268435455||Q<0?function(ue,_e){var Ie,Ge;if(ue>=0?(Ie=ue%4294967296|0,Ge=ue/4294967296|0):(Ge=~(-ue/4294967296),4294967295^(Ie=~(-ue%4294967296))?Ie=Ie+1|0:(Ie=0,Ge=Ge+1|0)),ue>=18446744073709552e3||ue<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");_e.realloc(10),function(ze,$e,st){st.buf[st.pos++]=127&ze|128,ze>>>=7,st.buf[st.pos++]=127&ze|128,ze>>>=7,st.buf[st.pos++]=127&ze|128,ze>>>=7,st.buf[st.pos++]=127&ze|128,st.buf[st.pos]=127&(ze>>>=7)}(Ie,0,_e),function(ze,$e){var st=(7&ze)<<4;$e.buf[$e.pos++]|=st|((ze>>>=3)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze|((ze>>>=7)?128:0),ze&&($e.buf[$e.pos++]=127&ze)))))}(Ge,_e)}(Q,this):(this.realloc(4),this.buf[this.pos++]=127&Q|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=Q>>>7&127))))},writeSVarint:function(Q){this.writeVarint(Q<0?2*-Q-1:2*Q)},writeBoolean:function(Q){this.writeVarint(!!Q)},writeString:function(Q){Q=String(Q),this.realloc(4*Q.length),this.pos++;var ue=this.pos;this.pos=function(Ie,Ge,ze){for(var $e,st,Fe=0;Fe<Ge.length;Fe++){if(($e=Ge.charCodeAt(Fe))>55295&&$e<57344){if(!st){$e>56319||Fe+1===Ge.length?(Ie[ze++]=239,Ie[ze++]=191,Ie[ze++]=189):st=$e;continue}if($e<56320){Ie[ze++]=239,Ie[ze++]=191,Ie[ze++]=189,st=$e;continue}$e=st-55296<<10|$e-56320|65536,st=null}else st&&(Ie[ze++]=239,Ie[ze++]=191,Ie[ze++]=189,st=null);$e<128?Ie[ze++]=$e:($e<2048?Ie[ze++]=$e>>6|192:($e<65536?Ie[ze++]=$e>>12|224:(Ie[ze++]=$e>>18|240,Ie[ze++]=$e>>12&63|128),Ie[ze++]=$e>>6&63|128),Ie[ze++]=63&$e|128)}return ze}(this.buf,Q,this.pos);var _e=this.pos-ue;_e>=128&&T(ue,_e,this),this.pos=ue-1,this.writeVarint(_e),this.pos+=_e},writeFloat:function(Q){this.realloc(4),c.write(this.buf,Q,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Q){this.realloc(8),c.write(this.buf,Q,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Q){var ue=Q.length;this.writeVarint(ue),this.realloc(ue);for(var _e=0;_e<ue;_e++)this.buf[this.pos++]=Q[_e]},writeRawMessage:function(Q,ue){this.pos++;var _e=this.pos;Q(ue,this);var Ie=this.pos-_e;Ie>=128&&T(_e,Ie,this),this.pos=_e-1,this.writeVarint(Ie),this.pos+=Ie},writeMessage:function(Q,ue,_e){this.writeTag(Q,n.Bytes),this.writeRawMessage(ue,_e)},writePackedVarint:function(Q,ue){ue.length&&this.writeMessage(Q,P,ue)},writePackedSVarint:function(Q,ue){ue.length&&this.writeMessage(Q,O,ue)},writePackedBoolean:function(Q,ue){ue.length&&this.writeMessage(Q,L,ue)},writePackedFloat:function(Q,ue){ue.length&&this.writeMessage(Q,x,ue)},writePackedDouble:function(Q,ue){ue.length&&this.writeMessage(Q,k,ue)},writePackedFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,A,ue)},writePackedSFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,R,ue)},writePackedFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,$,ue)},writePackedSFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,W,ue)},writeBytesField:function(Q,ue){this.writeTag(Q,n.Bytes),this.writeBytes(ue)},writeFixed32Field:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeFixed32(ue)},writeSFixed32Field:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeSFixed32(ue)},writeFixed64Field:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeFixed64(ue)},writeSFixed64Field:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeSFixed64(ue)},writeVarintField:function(Q,ue){this.writeTag(Q,n.Varint),this.writeVarint(ue)},writeSVarintField:function(Q,ue){this.writeTag(Q,n.Varint),this.writeSVarint(ue)},writeStringField:function(Q,ue){this.writeTag(Q,n.Bytes),this.writeString(ue)},writeFloatField:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeFloat(ue)},writeDoubleField:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeDouble(ue)},writeBooleanField:function(Q,ue){this.writeVarintField(Q,!!ue)}},Tx}var Xy=w(nM());const Ex=3;function wB(c,n,a){n.glyphs=[],c===1&&a.readMessage(SB,n)}function SB(c,n,a){if(c===3){const{id:u,bitmap:g,width:h,height:v,left:T,top:P,advance:O}=a.readMessage(TB,{});n.glyphs.push({id:u,bitmap:new Wd({width:h+2*Ex,height:v+2*Ex},g),metrics:{width:h,height:v,left:T,top:P,advance:O}})}else c===4?n.ascender=a.readSVarint():c===5&&(n.descender=a.readSVarint())}function TB(c,n,a){c===1?n.id=a.readVarint():c===2?n.bitmap=a.readBytes():c===3?n.width=a.readVarint():c===4?n.height=a.readVarint():c===5?n.left=a.readSVarint():c===6?n.top=a.readSVarint():c===7&&(n.advance=a.readVarint())}const oM=Ex,_l={horizontal:1,vertical:2,horizontalOnly:3};class cv{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,a){const u=new cv;return u.scale=n||1,u.fontStack=a,u}static forImage(n){const a=new cv;return a.imageName=n,a}}class zp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,a){const u=new zp;for(let g=0;g<n.sections.length;g++){const h=n.sections[g];h.image?u.addImageSection(h):u.addTextSection(h,a)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(a,u){let g="";for(let h=0;h<a.length;h++){const v=a.charCodeAt(h+1)||null,T=a.charCodeAt(h-1)||null;g+=!u&&(v&&Cg(v)&&!lv[a[h+1]]||T&&Cg(T)&&!lv[a[h-1]])||!lv[a[h]]?a[h]:lv[a[h]]}return g}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&Jy[this.text.charCodeAt(u)];u++)n++;let a=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&Jy[this.text.charCodeAt(u)];u--)a--;this.text=this.text.substring(n,a),this.sectionIndex=this.sectionIndex.slice(n,a)}substring(n,a){const u=new zp;return u.text=this.text.substring(n,a),u.sectionIndex=this.sectionIndex.slice(n,a),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,a)=>Math.max(n,this.sections[a].scale),0)}addTextSection(n,a){this.text+=n.text,this.sections.push(cv.forText(n.scale,n.fontStack||a));const u=this.sections.length-1;for(let g=0;g<n.text.length;++g)this.sectionIndex.push(u)}addImageSection(n){const a=n.image?n.image.namePrimary:"";if(a.length===0)return void Bn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(cv.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Bn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Mx(c,n,a,u,g,h,v,T,P,O,x,k,L,A,R){const $=zp.fromFeature(c,g);k===_l.vertical&&$.verticalizePunctuation(L);let W=[];const Y=function(_e,Ie,Ge,ze,$e,st){if(!_e)return[];const Fe=[],rt=function(Lt,Ft,Pt,sn,Cn,Jt){let Jn=0;for(let Fn=0;Fn<Lt.length();Fn++){const Pn=Lt.getSection(Fn);Jn+=rM(Lt.getCodePoint(Fn),Pn,sn,Cn,Ft,Jt)}return Jn/Math.max(1,Math.ceil(Jn/Pt))}(_e,Ie,Ge,ze,$e,st),ht=_e.text.indexOf("")>=0;let pt=0;for(let Lt=0;Lt<_e.length();Lt++){const Ft=_e.getSection(Lt),Pt=_e.getCodePoint(Lt);if(Jy[Pt]||(pt+=rM(Pt,Ft,ze,$e,Ie,st)),Lt<_e.length()-1){const sn=!((Tt=Pt)<11904||!(go["Bopomofo Extended"](Tt)||go.Bopomofo(Tt)||go["CJK Compatibility Forms"](Tt)||go["CJK Compatibility Ideographs"](Tt)||go["CJK Compatibility"](Tt)||go["CJK Radicals Supplement"](Tt)||go["CJK Strokes"](Tt)||go["CJK Symbols and Punctuation"](Tt)||go["CJK Unified Ideographs Extension A"](Tt)||go["CJK Unified Ideographs"](Tt)||go["Enclosed CJK Letters and Months"](Tt)||go["Halfwidth and Fullwidth Forms"](Tt)||go.Hiragana(Tt)||go["Ideographic Description Characters"](Tt)||go["Kangxi Radicals"](Tt)||go["Katakana Phonetic Extensions"](Tt)||go.Katakana(Tt)||go["Vertical Forms"](Tt)||go["Yi Radicals"](Tt)||go["Yi Syllables"](Tt)));(CB[Pt]||sn||Ft.imageName)&&Fe.push(aM(Lt+1,pt,rt,Fe,EB(Pt,_e.getCodePoint(Lt+1),sn&&ht),!1))}}var Tt;return sM(aM(_e.length(),pt,rt,Fe,0,!0))}($,O,h,n,u,A),{processBidirectionalText:re,processStyledBidirectionalText:ie}=Ts;if(re&&$.sections.length===1){const _e=re($.toString(),Y);for(const Ie of _e){const Ge=new zp;Ge.text=Ie,Ge.sections=$.sections;for(let ze=0;ze<Ie.length;ze++)Ge.sectionIndex.push(0);W.push(Ge)}}else if(ie){const _e=ie($.text,$.sectionIndex,Y);for(const Ie of _e){const Ge=new zp;Ge.text=Ie[0],Ge.sectionIndex=Ie[1],Ge.sections=$.sections,W.push(Ge)}}else W=function(_e,Ie){const Ge=[],ze=_e.text;let $e=0;for(const st of Ie)Ge.push(_e.substring($e,st)),$e=st;return $e<ze.length&&Ge.push(_e.substring($e,ze.length)),Ge}($,Y);const Q=[],ue={positionedLines:Q,text:$.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(_e,Ie,Ge,ze,$e,st,Fe,rt,ht,pt,Tt,Lt){let Ft=0,Pt=0,sn=0;const Cn=rt==="right"?1:rt==="left"?0:.5;let Jt=!1;for(const Xn of $e){const io=Xn.getSections();for(const Uo of io){if(Uo.imageName)continue;const er=Ie[Uo.fontStack];if(er&&(Jt=er.ascender!==void 0&&er.descender!==void 0,!Jt))break}if(!Jt)break}let Jn=0;for(const Xn of $e){Xn.trim();const io=Xn.getMaxScale(),Uo=(io-1)*ba,er={positionedGlyphs:[],lineOffset:0};_e.positionedLines[Jn]=er;const tr=er.positionedGlyphs;let Zo=0;if(!Xn.length()){Pt+=st,++Jn;continue}let lr=0,ar=0;for(let Wr=0;Wr<Xn.length();Wr++){const Bo=Xn.getSection(Wr),Dr=Xn.getSectionIndex(Wr),Br=Xn.getCodePoint(Wr);let mi=Bo.scale,Di=null,qi=null,zi=null,Ii=ba,Ni=0;const Xi=!(ht===_l.horizontal||!Tt&&!Pd(Br)||Tt&&(Jy[Br]||(Fn=Br,go.Arabic(Fn)||go["Arabic Supplement"](Fn)||go["Arabic Extended-A"](Fn)||go["Arabic Presentation Forms-A"](Fn)||go["Arabic Presentation Forms-B"](Fn))));if(Bo.imageName){const xa=ze[Bo.imageName];if(!xa)continue;zi=Bo.imageName,_e.iconsInText=_e.iconsInText||!0,qi=xa.paddedRect;const di=xa.displaySize;mi=mi*ba/Lt,Di={width:di[0],height:di[1],left:0,top:-oM,advance:Xi?di[1]:di[0],localGlyph:!1},Ni=Jt?-Di.height*mi:io*ba-17-di[1]*mi,Ii=Di.advance;const Es=(Xi?di[0]:di[1])*mi-ba*io;Es>0&&Es>Zo&&(Zo=Es)}else{const xa=Ge[Bo.fontStack];if(!xa)continue;xa[Br]&&(qi=xa[Br]);const di=Ie[Bo.fontStack];if(!di)continue;const Es=di.glyphs[Br];if(!Es)continue;if(Di=Es.metrics,Ii=Br!==8203?ba:0,Jt){const Bc=di.ascender!==void 0?Math.abs(di.ascender):0,Wl=di.descender!==void 0?Math.abs(di.descender):0,ql=(Bc+Wl)*mi;lr<ql&&(lr=ql,ar=(Bc-Wl)/2*mi),Ni=-Bc*mi}else Ni=(io-mi)*ba-17}Xi?(_e.verticalizable=!0,tr.push({glyph:Br,imageName:zi,x:Ft,y:Pt+Ni,vertical:Xi,scale:mi,localGlyph:Di.localGlyph,fontStack:Bo.fontStack,sectionIndex:Dr,metrics:Di,rect:qi}),Ft+=Ii*mi+pt):(tr.push({glyph:Br,imageName:zi,x:Ft,y:Pt+Ni,vertical:Xi,scale:mi,localGlyph:Di.localGlyph,fontStack:Bo.fontStack,sectionIndex:Dr,metrics:Di,rect:qi}),Ft+=Di.advance*mi+pt)}tr.length!==0&&(sn=Math.max(Ft-pt,sn),Jt?lM(tr,Cn,Zo,ar,st*io/2):lM(tr,Cn,Zo,0,st/2)),Ft=0;const Qr=st*io+Zo;er.lineOffset=Math.max(Zo,Uo),Pt+=Qr,++Jn}var Fn;const Pn=Pt,{horizontalAlign:Sn,verticalAlign:wo}=Ix(Fe);(function(Xn,io,Uo,er,tr,Zo){const lr=(io-Uo)*tr,ar=-Zo*er;for(const Qr of Xn)for(const Wr of Qr.positionedGlyphs)Wr.x+=lr,Wr.y+=ar})(_e.positionedLines,Cn,Sn,wo,sn,Pn),_e.top+=-wo*Pn,_e.bottom=_e.top+Pn,_e.left+=-Sn*sn,_e.right=_e.left+sn,_e.hasBaseline=Jt}(ue,n,a,u,W,v,T,P,k,O,L,R),!function(_e){for(const Ie of _e)if(Ie.positionedGlyphs.length!==0)return!1;return!0}(Q)&&ue}const Jy={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},CB={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function rM(c,n,a,u,g,h){if(n.imageName){const v=u[n.imageName];return v?v.displaySize[0]*n.scale*ba/h+g:0}{const v=a[n.fontStack],T=v&&v.glyphs[c];return T?T.metrics.advance*n.scale+g:0}}function iM(c,n,a,u){const g=Math.pow(c-n,2);return u?c<n?g/2:2*g:g+Math.abs(a)*a}function EB(c,n,a){let u=0;return c===10&&(u-=1e4),a&&(u+=150),c!==40&&c!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function aM(c,n,a,u,g,h){let v=null,T=iM(n,a,g,h);for(const P of u){const O=iM(n-P.x,a,g,h)+P.badness;O<=T&&(v=P,T=O)}return{index:c,x:n,priorBreak:v,badness:T}}function sM(c){return c?sM(c.priorBreak).concat(c.index):[]}function Ix(c){let n=.5,a=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:n,verticalAlign:a}}function lM(c,n,a,u,g){if(!(n||a||u||g))return;const h=c.length-1,v=c[h],T=(v.x+v.metrics.advance*v.scale)*n;for(let P=0;P<=h;P++)c[P].x-=T,c[P].y+=a+u+g}function MB(c,n,a,u){const{horizontalAlign:g,verticalAlign:h}=Ix(u),v=a[0]-c.displaySize[0]*g,T=a[1]-c.displaySize[1]*h;return{imagePrimary:c,imageSecondary:n,top:T,bottom:T+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function cM(c,n,a,u,g,h){const v=c.imagePrimary;let T;if(v.content){const W=v.content,Y=v.pixelRatio||1;T=[W[0]/Y,W[1]/Y,v.displaySize[0]-W[2]/Y,v.displaySize[1]-W[3]/Y]}const P=n.left*h,O=n.right*h;let x,k,L,A;a==="width"||a==="both"?(A=g[0]+P-u[3],k=g[0]+O+u[1]):(A=g[0]+(P+O-v.displaySize[0])/2,k=A+v.displaySize[0]);const R=n.top*h,$=n.bottom*h;return a==="height"||a==="both"?(x=g[1]+R-u[0],L=g[1]+$+u[2]):(x=g[1]+(R+$-v.displaySize[1])/2,L=x+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:x,right:k,bottom:L,left:A,collisionPadding:T}}class Ku extends Be{constructor(n,a,u,g,h){super(n,a),this.angle=g,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new Ku(this.x,this.y,this.z,this.angle,this.segment)}}function uM(c,n,a,u,g){if(n.segment===void 0)return!0;let h=n,v=n.segment+1,T=0;for(;T>-a/2;){if(v--,v<0)return!1;T-=c[v].dist(h),h=c[v]}T+=c[v].dist(c[v+1]),v++;const P=[];let O=0;for(;T<a/2;){const x=c[v],k=c[v+1];if(!k)return!1;let L=c[v-1].angleTo(x)-x.angleTo(k);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:T,angleDelta:L}),O+=L;T-P[0].distance>u;)O-=P.shift().angleDelta;if(O>g)return!1;v++,T+=x.dist(k)}return!0}function dM(c){let n=0;for(let a=0;a<c.length-1;a++)n+=c[a].dist(c[a+1]);return n}function hM(c,n,a){return c?.6*n*a:0}function fM(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function IB(c,n,a,u,g,h){const v=hM(a,g,h),T=fM(a,u)*h;let P=0;const O=dM(c)/2;for(let x=0;x<c.length-1;x++){const k=c[x],L=c[x+1],A=k.dist(L);if(P+A>O){const R=(O-P)/A,$=uo(k.x,L.x,R),W=uo(k.y,L.y,R),Y=new Ku($,W,0,L.angleTo(k),x);return!v||uM(c,Y,T,v,n)?Y:void 0}P+=A}}function AB(c,n,a,u,g,h,v,T,P){const O=hM(u,h,v),x=fM(u,g),k=x*v,L=c[0].x===0||c[0].x===P||c[0].y===0||c[0].y===P;return n-k<n/4&&(n=k+n/4),pM(c,L?n/2*T%n:(x/2+2*h)*v*T%n,n,O,a,k,L,!1,P)}function pM(c,n,a,u,g,h,v,T,P){const O=h/2,x=dM(c);let k=0,L=n-a,A=[];for(let R=0;R<c.length-1;R++){const $=c[R],W=c[R+1],Y=$.dist(W),re=W.angleTo($);for(;L+a<k+Y;){L+=a;const ie=(L-k)/Y,Q=uo($.x,W.x,ie),ue=uo($.y,W.y,ie);if(Q>=0&&Q<P&&ue>=0&&ue<P&&L-O>=0&&L+O<=x){const _e=new Ku(Q,ue,0,re,R);u&&!uM(c,_e,h,u,g)||A.push(_e)}}k+=Y}return T||A.length||v||(A=pM(c,k/2,a,u,g,h,v,!0,P)),A}function mM(c,n,a,u,g){const h=[];for(let v=0;v<c.length;v++){const T=c[v];let P;for(let O=0;O<T.length-1;O++){let x=T[O],k=T[O+1];x.x<n&&k.x<n||(x.x<n?x=new Be(n,x.y+(n-x.x)/(k.x-x.x)*(k.y-x.y))._round():k.x<n&&(k=new Be(n,x.y+(n-x.x)/(k.x-x.x)*(k.y-x.y))._round()),x.y<a&&k.y<a||(x.y<a?x=new Be(x.x+(a-x.y)/(k.y-x.y)*(k.x-x.x),a)._round():k.y<a&&(k=new Be(x.x+(a-x.y)/(k.y-x.y)*(k.x-x.x),a)._round()),x.x>=u&&k.x>=u||(x.x>=u?x=new Be(u,x.y+(u-x.x)/(k.x-x.x)*(k.y-x.y))._round():k.x>=u&&(k=new Be(u,x.y+(u-x.x)/(k.x-x.x)*(k.y-x.y))._round()),x.y>=g&&k.y>=g||(x.y>=g?x=new Be(x.x+(g-x.y)/(k.y-x.y)*(k.x-x.x),g)._round():k.y>=g&&(k=new Be(x.x+(g-x.y)/(k.y-x.y)*(k.x-x.x),g)._round()),P&&x.equals(P[P.length-1])||(P=[x],h.push(P)),P.push(k)))))}}return h}function gM(c){let n=0,a=0;for(const v of c)n+=v.w*v.h,a=Math.max(a,v.w);c.sort((v,T)=>T.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),a),h:1/0}];let g=0,h=0;for(const v of c)for(let T=u.length-1;T>=0;T--){const P=u[T];if(!(v.w>P.w||v.h>P.h)){if(v.x=P.x,v.y=P.y,h=Math.max(h,v.y+v.h),g=Math.max(g,v.x+v.w),v.w===P.w&&v.h===P.h){const O=u.pop();T<u.length&&(u[T]=O)}else v.h===P.h?(P.x+=v.w,P.w-=v.w):v.w===P.w?(P.y+=v.h,P.h-=v.h):(u.push({x:P.x+v.w,y:P.y,w:P.w-v.w,h:v.h}),P.y+=v.h,P.h-=v.h);break}}return{w:g,h,fill:n/(g*h)||0}}no(Ku,"Anchor");const uv=1;class Ax{constructor(n,{pixelRatio:a,version:u,stretchX:g,stretchY:h,content:v},T){this.paddedRect=n,this.pixelRatio=a,this.stretchX=g,this.stretchY=h,this.content=v,this.version=u,this.padding=T}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class vM{constructor(n,a,u){const g={},h={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,g,uv,v),this.addImages(a,h,2,v);const{w:T,h:P}=gM(v),O=new Ua({width:T||1,height:P||1});for(const x in n){const k=n[x],L=g[x].paddedRect;Ua.copy(k.data,O,{x:0,y:0},{x:L.x+uv,y:L.y+uv},k.data,u,k.sdf)}for(const x in a){const k=a[x],L=h[x].paddedRect;let A=h[x].padding;const R=L.x+A,$=L.y+A,W=k.data.width,Y=k.data.height;A=A>1?A-1:A,Ua.copy(k.data,O,{x:0,y:0},{x:R,y:$},k.data,u),Ua.copy(k.data,O,{x:0,y:Y-A},{x:R,y:$-A},{width:W,height:A},u),Ua.copy(k.data,O,{x:0,y:0},{x:R,y:$+Y},{width:W,height:A},u),Ua.copy(k.data,O,{x:W-A,y:0},{x:R-A,y:$},{width:A,height:Y},u),Ua.copy(k.data,O,{x:0,y:0},{x:R+W,y:$},{width:A,height:Y},u),Ua.copy(k.data,O,{x:W-A,y:Y-A},{x:R-A,y:$-A},{width:A,height:A},u),Ua.copy(k.data,O,{x:0,y:Y-A},{x:R+W,y:$-A},{width:A,height:A},u),Ua.copy(k.data,O,{x:0,y:0},{x:R+W,y:$+Y},{width:A,height:A},u),Ua.copy(k.data,O,{x:W-A,y:0},{x:R-A,y:$+Y},{width:A,height:A},u)}this.image=O,this.iconPositions=g,this.patternPositions=h}addImages(n,a,u,g){for(const h in n){const v=n[h],T={x:0,y:0,w:v.data.width+2*u,h:v.data.height+2*u};g.push(T),a[h]=new Ax(T,v,u),v.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(n,a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(g=>n.hasImage(g,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const g in n.getUpdatedImages(u))this.patchUpdatedImage(this.iconPositions[g],n.getImage(g,u),a),this.patchUpdatedImage(this.patternPositions[g],n.getImage(g,u),a)}patchUpdatedImage(n,a,u){if(!n||!a||n.version===a.version)return;n.version=a.version;const[g,h]=n.tl;u.update(a.data,{position:{x:g,y:h}})}}no(Ax,"ImagePosition"),no(vM,"ImageAtlas");const dv=1e20;function _M(c,n,a,u,g,h,v,T,P){for(let O=n;O<n+u;O++)yM(c,a*h+O,h,g,v,T,P);for(let O=a;O<a+g;O++)yM(c,O*h+n,1,u,v,T,P)}function yM(c,n,a,u,g,h,v){h[0]=0,v[0]=-dv,v[1]=dv,g[0]=c[n];for(let T=1,P=0,O=0;T<u;T++){g[T]=c[n+T*a];const x=T*T;do{const k=h[P];O=(g[T]-g[k]+x-k*k)/(T-k)/2}while(O<=v[P]&&--P>-1);P++,h[P]=T,v[P]=O,v[P+1]=dv}for(let T=0,P=0;T<u;T++){for(;v[P+1]<T;)P++;const O=h[P],x=T-O;c[n+T*a]=g[O]+x*x}}const Oc=2,kx={none:0,ideographs:1,all:2};class Fp{constructor(n,a,u){this.requestManager=n,this.localGlyphMode=a,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,a){this.urls[a]=n}getGlyphs(n,a,u){const g=[],h=this.urls[a]||qe.GLYPHS_URL;for(const v in n)for(const T of n[v])g.push({stack:v,id:T});Co(g,({stack:v,id:T},P)=>{let O=this.entries[v];O||(O=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=O.glyphs[T];if(x!==void 0)return void P(null,{stack:v,id:T,glyph:x});if(x=this._tinySDF(O,v,T),x)return O.glyphs[T]=x,void P(null,{stack:v,id:T,glyph:x});const k=Math.floor(T/256);if(256*k>65535)return Bn("glyphs > 65535 not supported"),void P(null,{stack:v,id:T,glyph:x});if(O.ranges[k])return void P(null,{stack:v,id:T,glyph:x});let L=O.requests[k];L||(L=O.requests[k]=[],Fp.loadGlyphRange(v,k,h,this.requestManager,(A,R)=>{if(R){O.ascender=R.ascender,O.descender=R.descender;for(const $ in R.glyphs)this._doesCharSupportLocalGlyph(+$)||(O.glyphs[+$]=R.glyphs[+$]);O.ranges[k]=!0}for(const $ of L)$(A,R);delete O.requests[k]})),L.push((A,R)=>{A?P(A):R&&P(null,{stack:v,id:T,glyph:R.glyphs[T]||null})})},(v,T)=>{if(v)u(v);else if(T){const P={};for(const{stack:O,id:x,glyph:k}of T)P[O]===void 0&&(P[O]={}),P[O].glyphs===void 0&&(P[O].glyphs={}),P[O].glyphs[x]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},P[O].ascender=this.entries[O].ascender,P[O].descender=this.entries[O].descender;u(null,P)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==kx.none&&(this.localGlyphMode===kx.all?!!this.localFontFamily:!!this.localFontFamily&&(go["CJK Unified Ideographs"](n)||go["Hangul Syllables"](n)||go.Hiragana(n)||go.Katakana(n)||go["CJK Symbols and Punctuation"](n)||go["CJK Unified Ideographs Extension A"](n)||go["CJK Unified Ideographs Extension B"](n)||go.Osage(n)))}_tinySDF(n,a,u){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(u))return;let h=n.tinySDF;if(!h){let $="400";/bold/i.test(a)?$="900":/medium/i.test(a)?$="500":/light/i.test(a)&&($="200"),h=n.tinySDF=new Fp.TinySDF({fontFamily:g,fontWeight:$,fontSize:24*Oc,buffer:3*Oc,radius:8*Oc}),h.fontWeight=$}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const v=String.fromCodePoint(u),{data:T,width:P,height:O,glyphWidth:x,glyphHeight:k,glyphLeft:L,glyphTop:A,glyphAdvance:R}=h.draw(v);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new Wd({width:P,height:O},T),metrics:{width:x/Oc,height:k/Oc,left:L/Oc,top:A/Oc-27,advance:R/Oc,localGlyph:!0}}}}Fp.loadGlyphRange=function(c,n,a,u,g){const h=256*n,v=h+255,T=u.transformRequest(u.normalizeGlyphsURL(a).replace("{fontstack}",c).replace("{range}",`${h}-${v}`),lc.Glyphs);ru(T,(P,O)=>{if(P)g(P);else if(O){const x={},k=function(L){return new Xy(L).readFields(wB,{})}(O);for(const L of k.glyphs)x[L.id]=L;g(null,{glyphs:x,ascender:k.ascender,descender:k.descender})}})},Fp.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:a=8,cutoff:u=.25,fontFamily:g="sans-serif",fontWeight:h="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=a;const T=this.size=c+4*n,P=this._createCanvas(T),O=this.ctx=P.getContext("2d",{willReadFrequently:!0});O.font=`${v} ${h} ${c}px ${g}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:g,actualBoundingBoxRight:h}=this.ctx.measureText(c),v=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-g))),P=Math.min(this.size-this.buffer,v+Math.ceil(u)),O=T+2*this.buffer,x=P+2*this.buffer,k=Math.max(O*x,0),L=new Uint8ClampedArray(k),A={data:L,width:O,height:x,glyphWidth:T,glyphHeight:P,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(T===0||P===0)return A;const{ctx:R,buffer:$,gridInner:W,gridOuter:Y}=this;R.clearRect($,$,T,P),R.fillText(c,$,$+v);const re=R.getImageData($,$,T,P);Y.fill(dv,0,k),W.fill(0,0,k);for(let ie=0;ie<P;ie++)for(let Q=0;Q<T;Q++){const ue=re.data[4*(ie*T+Q)+3]/255;if(ue===0)continue;const _e=(ie+$)*O+Q+$;if(ue===1)Y[_e]=0,W[_e]=dv;else{const Ie=.5-ue;Y[_e]=Ie>0?Ie*Ie:0,W[_e]=Ie<0?Ie*Ie:0}}_M(Y,0,0,O,x,O,this.f,this.v,this.z),_M(W,$,$,T,P,O,this.f,this.v,this.z);for(let ie=0;ie<k;ie++){const Q=Math.sqrt(Y[ie])-Math.sqrt(W[ie]);L[ie]=Math.round(255-255*(Q/this.radius+this.cutoff))}return A}};const Kd=uv;function bM(c,n,a,u,g=1){const h=[],v=c.imagePrimary,T=v.pixelRatio,P=v.paddedRect.w-2*Kd,O=v.paddedRect.h-2*Kd,x=(c.right-c.left)*g,k=(c.bottom-c.top)*g,L=v.stretchX||[[0,P]],A=v.stretchY||[[0,O]],R=(Fe,rt)=>Fe+rt[1]-rt[0],$=L.reduce(R,0),W=A.reduce(R,0),Y=P-$,re=O-W;let ie=0,Q=$,ue=0,_e=W,Ie=0,Ge=Y,ze=0,$e=re;if(v.content&&u){const Fe=v.content;ie=Qy(L,0,Fe[0]),ue=Qy(A,0,Fe[1]),Q=Qy(L,Fe[0],Fe[2]),_e=Qy(A,Fe[1],Fe[3]),Ie=Fe[0]-ie,ze=Fe[1]-ue,Ge=Fe[2]-Fe[0]-Q,$e=Fe[3]-Fe[1]-_e}const st=(Fe,rt,ht,pt)=>{const Tt=e0(Fe.stretch-ie,Q,x,c.left*g),Lt=t0(Fe.fixed-Ie,Ge,Fe.stretch,$),Ft=e0(rt.stretch-ue,_e,k,c.top*g),Pt=t0(rt.fixed-ze,$e,rt.stretch,W),sn=e0(ht.stretch-ie,Q,x,c.left*g),Cn=t0(ht.fixed-Ie,Ge,ht.stretch,$),Jt=e0(pt.stretch-ue,_e,k,c.top*g),Jn=t0(pt.fixed-ze,$e,pt.stretch,W),Fn=new Be(Tt,Ft),Pn=new Be(sn,Ft),Sn=new Be(sn,Jt),wo=new Be(Tt,Jt),Xn=new Be(Lt/T,Pt/T),io=new Be(Cn/T,Jn/T),Uo=n*Math.PI/180;if(Uo){const Qr=Math.sin(Uo),Wr=Math.cos(Uo),Bo=[Wr,-Qr,Qr,Wr];Fn._matMult(Bo),Pn._matMult(Bo),wo._matMult(Bo),Sn._matMult(Bo)}const er=Fe.stretch+Fe.fixed,tr=ht.stretch+ht.fixed,Zo=rt.stretch+rt.fixed,lr=pt.stretch+pt.fixed,ar=c.imageSecondary;return{tl:Fn,tr:Pn,bl:wo,br:Sn,texPrimary:{x:v.paddedRect.x+Kd+er,y:v.paddedRect.y+Kd+Zo,w:tr-er,h:lr-Zo},texSecondary:ar?{x:ar.paddedRect.x+Kd+er,y:ar.paddedRect.y+Kd+Zo,w:tr-er,h:lr-Zo}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Xn,pixelOffsetBR:io,minFontScaleX:Ge/T/x,minFontScaleY:$e/T/k,isSDF:a}};if(u&&(v.stretchX||v.stretchY)){const Fe=xM(L,Y,$),rt=xM(A,re,W);for(let ht=0;ht<Fe.length-1;ht++){const pt=Fe[ht],Tt=Fe[ht+1];for(let Lt=0;Lt<rt.length-1;Lt++)h.push(st(pt,rt[Lt],Tt,rt[Lt+1]))}}else h.push(st({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:O+1}));return h}function Qy(c,n,a){let u=0;for(const g of c)u+=Math.max(n,Math.min(a,g[1]))-Math.max(n,Math.min(a,g[0]));return u}function xM(c,n,a){const u=[{fixed:-Kd,stretch:0}];for(const[g,h]of c){const v=u[u.length-1];u.push({fixed:g-v.stretch,stretch:v.stretch}),u.push({fixed:g-v.stretch,stretch:v.stretch+(h-g)})}return u.push({fixed:n+Kd,stretch:a}),u}function e0(c,n,a,u){return c/n*a+u}function t0(c,n,a,u){return c-n*a/u}function kB(c,n,a,u){const g=n+c.positionedLines[u].lineOffset;return u===0?a+g/2:a+(g+(n+c.positionedLines[u-1].lineOffset))/2}function PB(c,n=1,a=!1){let u=1/0,g=1/0,h=-1/0,v=-1/0;const T=c[0];for(let A=0;A<T.length;A++){const R=T[A];(!A||R.x<u)&&(u=R.x),(!A||R.y<g)&&(g=R.y),(!A||R.x>h)&&(h=R.x),(!A||R.y>v)&&(v=R.y)}const P=Math.min(h-u,v-g);let O=P/2;const x=new Ws([],RB);if(P===0)return new Be(u,g);for(let A=u;A<h;A+=P)for(let R=g;R<v;R+=P)x.push(new Bp(A+O,R+O,O,c));let k=function(A){let R=0,$=0,W=0;const Y=A[0];for(let re=0,ie=Y.length,Q=ie-1;re<ie;Q=re++){const ue=Y[re],_e=Y[Q],Ie=ue.x*_e.y-_e.x*ue.y;$+=(ue.x+_e.x)*Ie,W+=(ue.y+_e.y)*Ie,R+=3*Ie}return new Bp($/R,W/R,0,A)}(c),L=x.length;for(;x.length;){const A=x.pop();(A.d>k.d||!k.d)&&(k=A,a&&console.log("found best %d after %d probes",Math.round(1e4*A.d)/1e4,L)),A.max-k.d<=n||(O=A.h/2,x.push(new Bp(A.p.x-O,A.p.y-O,O,c)),x.push(new Bp(A.p.x+O,A.p.y-O,O,c)),x.push(new Bp(A.p.x-O,A.p.y+O,O,c)),x.push(new Bp(A.p.x+O,A.p.y+O,O,c)),L+=4)}return a&&(console.log(`num probes: ${L}`),console.log(`best distance: ${k.d}`)),k.p}function RB(c,n){return n.max-c.max}class Bp{constructor(n,a,u,g){this.p=new Be(n,a),this.h=u,this.d=function(h,v){let T=!1,P=1/0;for(let O=0;O<v.length;O++){const x=v[O];for(let k=0,L=x.length,A=L-1;k<L;A=k++){const R=x[k],$=x[A];R.y>h.y!=$.y>h.y&&h.x<($.x-R.x)*(h.y-R.y)/($.y-R.y)+R.x&&(T=!T),P=Math.min(P,Ro(h,R,$))}}return(T?1:-1)*Math.sqrt(P)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const Px=Number.POSITIVE_INFINITY,LB=Math.sqrt(2);function wM(c,[n,a]){let u=0,g=0;if(a===Px){n<0&&(n=0);const h=n/LB;switch(c){case"top-right":case"top-left":g=h-7;break;case"bottom-right":case"bottom-left":g=7-h;break;case"bottom":g=7-n;break;case"top":g=n-7}switch(c){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),a=Math.abs(a),c){case"top-right":case"top-left":case"top":g=a-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-a}switch(c){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,g]}function Rx(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function OB(c,n,a,u,g,h,v,T,P,O,x,k,L,A,R){let $=h.textMaxSize.evaluate(n,{},k);$===void 0?$=v*h.textScaleFactor:$*=h.textScaleFactor;const W=c.layers[0].layout,Y=W.get("icon-offset").evaluate(n,{},k),re=TM(a.horizontal)||a.vertical,ie=L.name==="globe",Q=ba,ue=v*h.textScaleFactor/Q,_e=c.tilePixelRatio*$/Q,Ie=(pt=c.overscaling,c.zoom>18&&pt>2&&(pt>>=1),Math.max(Nn/(512*pt),1)*W.get("symbol-spacing")),Ge=W.get("text-padding")*c.tilePixelRatio,ze=W.get("icon-padding")*c.tilePixelRatio,$e=Et(W.get("text-max-angle")),st=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Fe=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",rt=W.get("symbol-placement"),ht=Ie/2;var pt;const Tt=W.get("icon-text-fit").evaluate(n,{},k),Lt=W.get("icon-text-fit-padding").evaluate(n,{},k),Ft=Tt!=="none";let Pt;c.hasAnyIconTextFit===!1&&Ft&&(c.hasAnyIconTextFit=!0),u&&Ft&&(c.allowVerticalPlacement&&a.vertical&&(Pt=cM(u,a.vertical,Tt,Lt,Y,ue)),re&&(u=cM(u,re,Tt,Lt,Y,ue)));const sn=(Cn,Jt,Jn)=>{if(Jt.x<0||Jt.x>=Nn||Jt.y<0||Jt.y>=Nn)return;let Fn=null;if(ie){const{x:Pn,y:Sn,z:wo}=L.projectTilePoint(Jt.x,Jt.y,Jn);Fn={anchor:new Ku(Pn,Sn,wo,0,void 0),up:L.upVector(Jn,Jt.x,Jt.y)}}(function(Pn,Sn,wo,Xn,io,Uo,er,tr,Zo,lr,ar,Qr,Wr,Bo,Dr,Br,mi,Di,qi,zi,Ii,Ni,Xi,xa,di,Es,Bc){const Wl=Pn.addToLineVertexArray(Sn,Xn);let ql,mf,Qd,gf,kv,HI,GI,WI=0,qI=0,KI=0,ZI=0,sw=-1,lw=-1;const _u={};let YI=Ue("");const vf=wo?wo.anchor:Sn,cw=Zo.layout.get("icon-text-fit").evaluate(Ii,{},di)!=="none";let uw=0,dw=0;if(Zo._unevaluatedLayout.getValue("text-radial-offset")===void 0?[uw,dw]=Zo.layout.get("text-offset").evaluate(Ii,{},di).map(Qs=>Qs*ba):(uw=Zo.layout.get("text-radial-offset").evaluate(Ii,{},di)*ba,dw=Px),Pn.allowVerticalPlacement&&io.vertical){const Qs=io.vertical;if(Dr)HI=Lx(Qs),tr&&(GI=Lx(tr));else{const el=Zo.layout.get("text-rotate").evaluate(Ii,{},di)+90;Qd=n0(lr,vf,Sn,ar,Qr,Wr,Qs,Bo,el,Br),tr&&(gf=n0(lr,vf,Sn,ar,Qr,Wr,tr,Di,el))}}if(Uo){const Qs=Zo.layout.get("icon-rotate").evaluate(Ii,{},di),el=bM(Uo,Qs,Xi,cw,Ni.iconScaleFactor),Wp=tr?bM(tr,Qs,Xi,cw,Ni.iconScaleFactor):void 0;mf=n0(lr,vf,Sn,ar,Qr,Wr,Uo,Di,Qs),WI=4*el.length;const XI=Pn.iconSizeData;let _f=null;XI.kind==="source"?(_f=[Lc*Zo.layout.get("icon-size").evaluate(Ii,{},di)*Ni.iconScaleFactor],_f[0]>Zd&&Bn(`${Pn.layerIds[0]}: Value for "icon-size" is >= ${hv}. Reduce your "icon-size".`)):XI.kind==="composite"&&(_f=[Lc*Ni.compositeIconSizes[0].evaluate(Ii,{},di)*Ni.iconScaleFactor,Lc*Ni.compositeIconSizes[1].evaluate(Ii,{},di)*Ni.iconScaleFactor],(_f[0]>Zd||_f[1]>Zd)&&Bn(`${Pn.layerIds[0]}: Value for "icon-size" is >= ${hv}. Reduce your "icon-size".`)),Pn.addSymbols(Pn.icon,el,_f,zi,qi,Ii,!1,wo,Sn,Wl.lineStartIndex,Wl.lineLength,-1,xa,di,Es,Bc),sw=Pn.icon.placedSymbolArray.length-1,Wp&&(qI=4*Wp.length,Pn.addSymbols(Pn.icon,Wp,_f,zi,qi,Ii,_l.vertical,wo,Sn,Wl.lineStartIndex,Wl.lineLength,-1,xa,di,Es,Bc),lw=Pn.icon.placedSymbolArray.length-1)}for(const Qs in io.horizontal){const el=io.horizontal[Qs];ql||(YI=Ue(el.text),Dr?kv=Lx(el):ql=n0(lr,vf,Sn,ar,Qr,Wr,el,Bo,Zo.layout.get("text-rotate").evaluate(Ii,{},di),Br));const Wp=el.positionedLines.length===1;if(KI+=SM(Pn,wo,Sn,el,er,Zo,Dr,Ii,Br,Wl,io.vertical?_l.horizontal:_l.horizontalOnly,Wp?Object.keys(io.horizontal):[Qs],_u,sw,Ni,xa,di,Es),Wp)break}io.vertical&&(ZI+=SM(Pn,wo,Sn,io.vertical,er,Zo,Dr,Ii,Br,Wl,_l.vertical,["vertical"],_u,lw,Ni,xa,di,Es));let eh=-1;const hw=(Qs,el)=>Qs?Math.max(Qs,el):el;eh=hw(kv,eh),eh=hw(HI,eh),eh=hw(GI,eh);const ZN=eh>-1?1:0;Pn.glyphOffsetArray.length>=65535&&Bn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ii.sortKey!==void 0&&Pn.addToSortKeyRanges(Pn.symbolInstances.length,Ii.sortKey),Pn.symbolInstances.emplaceBack(Sn.x,Sn.y,vf.x,vf.y,vf.z,_u.right>=0?_u.right:-1,_u.center>=0?_u.center:-1,_u.left>=0?_u.left:-1,_u.vertical>=0?_u.vertical:-1,sw,lw,YI,ql!==void 0?ql:Pn.collisionBoxArray.length,ql!==void 0?ql+1:Pn.collisionBoxArray.length,Qd!==void 0?Qd:Pn.collisionBoxArray.length,Qd!==void 0?Qd+1:Pn.collisionBoxArray.length,mf!==void 0?mf:Pn.collisionBoxArray.length,mf!==void 0?mf+1:Pn.collisionBoxArray.length,gf||Pn.collisionBoxArray.length,gf?gf+1:Pn.collisionBoxArray.length,ar,KI,ZI,WI,qI,ZN,0,uw,dw,eh,0,cw?1:0)})(c,Jt,Fn,Cn,a,u,g,Pt,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,Ge,st,P,0,ze,Fe,Y,n,h,O,x,k,A,R)};if(rt==="line")for(const Cn of mM(n.geometry,0,0,Nn,Nn)){const Jt=AB(Cn,Ie,$e,a.vertical||re,u,Q,_e,c.overscaling,Nn);for(const Jn of Jt)re&&DB(c,re.text,ht,Jn)||sn(Cn,Jn,k)}else if(rt==="line-center"){for(const Cn of n.geometry)if(Cn.length>1){const Jt=IB(Cn,$e,a.vertical||re,u,Q,_e);Jt&&sn(Cn,Jt,k)}}else if(n.type==="Polygon")for(const Cn of jy(n.geometry,0)){const Jt=PB(Cn,16);sn(Cn[0],new Ku(Jt.x,Jt.y,0,0,void 0),k)}else if(n.type==="LineString")for(const Cn of n.geometry)sn(Cn,new Ku(Cn[0].x,Cn[0].y,0,0,void 0),k);else if(n.type==="Point")for(const Cn of n.geometry)for(const Jt of Cn)sn([Jt],new Ku(Jt.x,Jt.y,0,0,void 0),k)}const hv=255,Zd=hv*Lc;function SM(c,n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W,Y){const re=function(ue,_e,Ie,Ge,ze,$e,st,Fe){const rt=[];if(_e.positionedLines.length===0)return rt;const ht=Ge.layout.get("text-rotate").evaluate($e,{})*Math.PI/180,pt=function(sn){const Cn=sn[0],Jt=sn[1],Jn=Cn*Jt;return Jn>0?[Cn,-Jt]:Jn<0?[-Cn,Jt]:Cn===0?[Jt,Cn]:[Jt,-Cn]}(Ie);let Tt=Math.abs(_e.top-_e.bottom);for(const sn of _e.positionedLines)Tt-=sn.lineOffset;const Lt=_e.positionedLines.length,Ft=Tt/Lt;let Pt=_e.top-Ie[1];for(let sn=0;sn<Lt;++sn){const Cn=_e.positionedLines[sn];Pt=kB(_e,Ft,Pt,sn);for(const Jt of Cn.positionedGlyphs){if(!Jt.rect)continue;const Jn=Jt.rect||{};let Fn=oM+1,Pn=!0,Sn=1,wo=0;if(Jt.imageName){const zi=st[Jt.imageName];if(!zi)continue;if(zi.sdf){Bn("SDF images are not supported in formatted text and will be ignored.");continue}Pn=!1,Sn=zi.pixelRatio,Fn=uv/Sn}const Xn=(ze||Fe)&&Jt.vertical,io=Jt.metrics.advance*Jt.scale/2,Uo=Jt.metrics,er=Jt.rect;if(er===null)continue;Fe&&_e.verticalizable&&(wo=Jt.imageName?io-Jt.metrics.width*Jt.scale/2:0);const tr=ze?[Jt.x+io,Jt.y]:[0,0];let Zo=[0,0],lr=[0,0],ar=!1;ze||(Xn?(lr=[Jt.x+io+pt[0],Jt.y+pt[1]-wo],ar=!0):Zo=[Jt.x+io+Ie[0],Jt.y+Ie[1]-wo]);const Qr=er.w*Jt.scale/(Sn*(Jt.localGlyph?Oc:1)),Wr=er.h*Jt.scale/(Sn*(Jt.localGlyph?Oc:1));let Bo,Dr,Br,mi;if(Xn){const zi=Jt.y-Pt,Ii=new Be(-io,io-zi),Ni=-Math.PI/2,Xi=new Be(...lr);Bo=new Be(-io+Zo[0],Zo[1]),Bo._rotateAround(Ni,Ii)._add(Xi),Bo.x+=-zi+io,Bo.y-=(Uo.left-Fn)*Jt.scale;const xa=Jt.imageName?Uo.advance*Jt.scale:ba*Jt.scale,di=String.fromCodePoint(Jt.glyph);yB(di)?Bo.x+=(1-Fn)*Jt.scale:bB(di)?Bo.x+=xa-Uo.height*Jt.scale+(-Fn-1)*Jt.scale:Bo.x+=Jt.imageName||Uo.width+2*Fn===er.w&&Uo.height+2*Fn===er.h?(xa-Wr)/2:(xa-(Uo.height+2*Fn)*Jt.scale)/2,Dr=new Be(Bo.x,Bo.y-Qr),Br=new Be(Bo.x+Wr,Bo.y),mi=new Be(Bo.x+Wr,Bo.y-Qr)}else{const zi=(Uo.left-Fn)*Jt.scale-io+Zo[0],Ii=(-Uo.top-Fn)*Jt.scale+Zo[1],Ni=zi+Qr,Xi=Ii+Wr;Bo=new Be(zi,Ii),Dr=new Be(Ni,Ii),Br=new Be(zi,Xi),mi=new Be(Ni,Xi)}if(ht){let zi;zi=ze?new Be(0,0):ar?new Be(pt[0],pt[1]):new Be(Ie[0],Ie[1]),Bo._rotateAround(ht,zi),Dr._rotateAround(ht,zi),Br._rotateAround(ht,zi),mi._rotateAround(ht,zi)}const Di=new Be(0,0),qi=new Be(0,0);rt.push({tl:Bo,tr:Dr,bl:Br,br:mi,texPrimary:Jn,texSecondary:void 0,writingMode:_e.writingMode,glyphOffset:tr,sectionIndex:Jt.sectionIndex,isSDF:Pn,pixelOffsetTL:Di,pixelOffsetBR:qi,minFontScaleX:0,minFontScaleY:0})}}return rt}(0,u,P,h,v,T,g,c.allowVerticalPlacement),ie=c.textSizeData;let Q=null;ie.kind==="source"?(Q=[Lc*h.layout.get("text-size").evaluate(T,{},W)*R.textScaleFactor],Q[0]>Zd&&Bn(`${c.layerIds[0]}: Value for "text-size" is >= ${hv}. Reduce your "text-size".`)):ie.kind==="composite"&&(Q=[Lc*R.compositeTextSizes[0].evaluate(T,{},W)*R.textScaleFactor,Lc*R.compositeTextSizes[1].evaluate(T,{},W)*R.textScaleFactor],(Q[0]>Zd||Q[1]>Zd)&&Bn(`${c.layerIds[0]}: Value for "text-size" is >= ${hv}. Reduce your "text-size".`)),c.addSymbols(c.text,re,Q,P,v,T,x,n,a,O.lineStartIndex,O.lineLength,A,$,W,Y,!1);for(const ue of k)L[ue]=c.text.placedSymbolArray.length-1;return 4*re.length}function TM(c){for(const n in c)return c[n];return null}function n0(c,n,a,u,g,h,v,T,P,O){let x=v.top,k=v.bottom,L=v.left,A=v.right;const R=v.collisionPadding;if(R&&(L-=R[0],x-=R[1],A+=R[2],k+=R[3]),P){const $=new Be(L,x),W=new Be(A,x),Y=new Be(L,k),re=new Be(A,k),ie=Et(P);let Q=new Be(0,0);O&&(Q=new Be(O[0],O[1])),$._rotateAround(ie,Q),W._rotateAround(ie,Q),Y._rotateAround(ie,Q),re._rotateAround(ie,Q),L=Math.min($.x,W.x,Y.x,re.x),A=Math.max($.x,W.x,Y.x,re.x),x=Math.min($.y,W.y,Y.y,re.y),k=Math.max($.y,W.y,Y.y,re.y)}return c.emplaceBack(n.x,n.y,n.z,a.x,a.y,L,x,A,k,T,u,g,h),c.length-1}function Lx(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function DB(c,n,a,u){const g=c.compareText;if(n in g){const h=g[n];for(let v=h.length-1;v>=0;v--)if(u.dist(h[v])<a)return!0}else g[n]=[];return g[n].push(u),!1}function CM(c,n){const a=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,g=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),h=Math.sin(a)*g/Math.sin(Math.max(Math.PI/2-c._pitch-a,.01));let v=Math.sin(c._pitch)*h+g;const T=g*(1/c._horizonShift);return c.elevation&&c.elevation.exaggeration()!==0||(v*=1+Math.max(c.zoom-17,0)),Math.min(1.01*v,T)}function fv(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const a=Math.pow(2,-c.z),u=c.x*a,g=(c.x+1)*a,h=c.y*a,v=(c.y+1)*a,T=De(u),P=De(g),O=je(h),x=je(v),k=n.project(T,O),L=n.project(P,O),A=n.project(P,x),R=n.project(T,x);let $=Math.min(k.x,L.x,A.x,R.x),W=Math.min(k.y,L.y,A.y,R.y),Y=Math.max(k.x,L.x,A.x,R.x),re=Math.max(k.y,L.y,A.y,R.y);const ie=a/16;function Q(_e,Ie,Ge,ze,$e,st){const Fe=(Ge+$e)/2,rt=(ze+st)/2,ht=n.project(De(Fe),je(rt)),pt=Math.max(0,$-ht.x,W-ht.y,ht.x-Y,ht.y-re);$=Math.min($,ht.x),Y=Math.max(Y,ht.x),W=Math.min(W,ht.y),re=Math.max(re,ht.y),pt>ie&&(Q(_e,ht,Ge,ze,Fe,rt),Q(ht,Ie,Fe,rt,$e,st))}Q(k,L,u,h,g,h),Q(L,A,g,h,g,v),Q(A,R,g,v,u,v),Q(R,k,u,v,u,h),$-=ie,W-=ie,Y+=ie,re+=ie;const ue=1/Math.max(Y-$,re-W);return{scale:ue,x:$*ue,y:W*ue,x2:Y*ue,y2:re*ue,projection:n}}function EM(c,{x:n,y:a},u=0){return new Be(((n-u)*c.scale-c.x)*Nn,(a*c.scale-c.y)*Nn)}const zB=Le.mat4.identity(new Float32Array(16));class Yd{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,a){return{x:0,y:0,z:0}}unproject(n,a){return new H(0,0)}projectTilePoint(n,a,u){return{x:n,y:a,z:0}}locationPoint(n,a,u=!0){return n._coordinatePoint(n.locationCoordinate(a),u)}pixelsPerMeter(n,a){return Se(1,n)*a}pixelSpaceConversion(n,a,u){return 1}farthestPixelDistance(n){return CM(n,n.pixelsPerMeter)}pointCoordinate(n,a,u,g){const h=n.horizonLineFromTop(!1),v=new Be(a,Math.max(h,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,g))}pointCoordinate3D(n,a,u){const g=new Be(a,u);if(n.elevation)return n.elevation.pointCoordinate(g);{const h=this.pointCoordinate(n,g.x,g.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(n,a){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,a.x,a.y);const u=n.horizonLineFromTop();return a.y<u}createInversionMatrix(n,a){return zB}createTileMatrix(n,a,u){let g,h,v;const T=u.canonical,P=Le.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=fv(T,this);g=1,h=O.x+u.wrap*O.scale,v=O.y,Le.mat4.scale(P,P,[g/O.scale,g/O.scale,n.pixelsPerMeter/a])}else g=a/n.zoomScale(T.z),h=(T.x+Math.pow(2,T.z)*u.wrap)*g,v=T.y*g;return Le.mat4.translate(P,P,[h,v,0]),Le.mat4.scale(P,P,[g/Nn,g/Nn,1]),P}upVector(n,a,u){return[0,0,1]}upVectorScale(n,a,u){return{metersToTile:1}}}class FB extends Yd{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[a,u]=this.parallels=n.parallels||[29.5,45.5],g=Math.sin(Et(a));this.n=(g+Math.sin(Et(u)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(n,a){const{n:u,c:g,r0:h}=this,v=Et(n-this.center[0]),T=Et(a),P=Math.sqrt(g-2*u*Math.sin(T))/u;return{x:P*Math.sin(v*u),y:P*Math.cos(v*u)-h,z:0}}unproject(n,a){const{n:u,c:g,r0:h}=this,v=h+a;let T=Math.atan2(n,Math.abs(v))*Math.sign(v);v*u<0&&(T-=Math.PI*Math.sign(n)*Math.sign(v));const P=Et(this.center[0])*u;T=qn(T,-Math.PI-P,Math.PI-P);const O=yt(Gt(T/u)+this.center[0],-180,180),x=Math.asin(yt((g-(n*n+v*v)*u*u)/(2*u),-1,1)),k=yt(Gt(x),-Ye,Ye);return new H(O,k)}}const pv=1.340264,mv=-.081106,gv=893e-6,vv=.003796,o0=Math.sqrt(3)/2;class BB extends Yd{project(n,a){a=a/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(o0*Math.sin(a)),g=u*u,h=g*g*g;return{x:.5*(n*Math.cos(u)/(o0*(pv+3*mv*g+h*(7*gv+9*vv*g)))/Math.PI+.5),y:1-.5*(u*(pv+mv*g+h*(gv+vv*g))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,g=u*u,h=g*g*g;for(let x,k,L,A=0;A<12&&(k=u*(pv+mv*g+h*(gv+vv*g))-a,L=pv+3*mv*g+h*(7*gv+9*vv*g),x=k/L,u=yt(u-x,-Math.PI/3,Math.PI/3),g=u*u,h=g*g*g,!(Math.abs(x)<1e-12));++A);const v=o0*n*(pv+3*mv*g+h*(7*gv+9*vv*g))/Math.cos(u),T=Math.asin(Math.sin(u)/o0),P=yt(180*v/Math.PI,-180,180),O=yt(180*T/Math.PI,-Ye,Ye);return new H(P,O)}}class NB extends Yd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){return{x:.5+n/360,y:.5-a/360,z:0}}unproject(n,a){const u=360*(n-.5),g=yt(360*(.5-a),-Ye,Ye);return new H(u,g)}}const Np=Math.PI/2;function r0(c){return Math.tan((Np+c)/2)}class $B extends Yd{constructor(n){super(n),this.center=n.center||[0,30];const[a,u]=this.parallels=n.parallels||[30,30];let g=Et(a),h=Et(u);this.southernCenter=g+h<0,this.southernCenter&&(g=-g,h=-h);const v=Math.cos(g),T=r0(g);this.n=g===h?Math.sin(g):Math.log(v/Math.cos(h))/Math.log(r0(h)/T),this.f=v*Math.pow(r0(g),this.n)/this.n}project(n,a){a=Et(a),this.southernCenter&&(a=-a),n=Et(n-this.center[0]);const u=1e-6,{n:g,f:h}=this;h>0?a<-Np+u&&(a=-Np+u):a>Np-u&&(a=Np-u);const v=h/Math.pow(r0(a),g);let T=v*Math.sin(g*n),P=h-v*Math.cos(g*n);return T=.5*(T/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:T,y:this.southernCenter?P:1-P,z:0}}unproject(n,a){n=(2*n-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:u,f:g}=this,h=g-a,v=Math.sign(h),T=Math.sign(u)*Math.sqrt(n*n+h*h);let P=Math.atan2(n,Math.abs(h))*v;h*u<0&&(P-=Math.PI*Math.sign(n)*v);const O=yt(Gt(P/u)+this.center[0],-180,180),x=yt(Gt(2*Math.atan(Math.pow(g/T,1/u))-Np),-Ye,Ye);return new H(O,this.southernCenter?-x:x)}}class MM extends Yd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,a){return{x:ye(n),y:Te(a),z:0}}unproject(n,a){const u=De(n),g=je(a);return new H(u,g)}}const IM=Et(Ye);class VB extends Yd{project(n,a){const u=(a=Et(a))*a,g=u*u;return{x:.5*((n=Et(n))*(.8707-.131979*u+g*(g*(.003971*u-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+u*(.015085+g*(.028874*u-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(n,a){n=(2*n-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,g=25,h=0,v=u*u;do{v=u*u;const O=v*v;h=(u*(1.007226+v*(.015085+O*(.028874*v-.044475-.005916*O)))-a)/(1.007226+v*(.045255+O*(.259866*v-.311325-.005916*11*O))),u=yt(u-h,-IM,IM)}while(Math.abs(h)>1e-6&&--g>0);v=u*u;const T=yt(Gt(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),P=Gt(u);return new H(T,P)}}const AM=Et(Ye);class UB extends Yd{project(n,a){a=Et(a),n=Et(n);const u=Math.cos(a),g=2/Math.PI,h=Math.acos(u*Math.cos(n/2)),v=Math.sin(h)/h,T=.5*(n*g+2*u*Math.sin(n/2)/v)||0,P=.5*(a+Math.sin(a)/v)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(n,a){let u=n=(2*n-.5)*Math.PI,g=a=(2*(1-a)-1)*Math.PI,h=25;const v=1e-6;let T=0,P=0;do{const O=Math.cos(g),x=Math.sin(g),k=2*x*O,L=x*x,A=O*O,R=Math.cos(u/2),$=Math.sin(u/2),W=2*R*$,Y=$*$,re=1-A*R*R,ie=re?1/re:0,Q=re?Math.acos(O*R)*Math.sqrt(1/re):0,ue=.5*(2*Q*O*$+2*u/Math.PI)-n,_e=.5*(Q*x+g)-a,Ie=.5*ie*(A*Y+Q*O*R*L)+1/Math.PI,Ge=ie*(W*k/4-Q*x*$),ze=.125*ie*(k*$-Q*x*A*W),$e=.5*ie*(L*R+Q*Y*O)+.5,st=Ge*ze-$e*Ie;T=(_e*Ge-ue*$e)/st,P=(ue*ze-_e*Ie)/st,u=yt(u-T,-Math.PI,Math.PI),g=yt(g-P,-AM,AM)}while((Math.abs(T)>v||Math.abs(P)>v)&&--h>0);return new H(Gt(u),Gt(g))}}class kM extends Yd{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Et(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,a){const{scale:u,cosPhi:g}=this;return{x:Et(n)*g*u+.5,y:-Math.sin(Et(a))/g*u+.5,z:0}}unproject(n,a){const{scale:u,cosPhi:g}=this,h=-(a-.5)/u,v=yt(Gt((n-.5)/u)/g,-180,180),T=Math.asin(yt(h*g,-1,1)),P=yt(Gt(T),-Ye,Ye);return new H(v,P)}}class jB extends MM{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,a,u){const g=Xg(n,a,u),h=Ny(gu(u));return Le.vec3.transformMat4(g,g,h),{x:g[0],y:g[1],z:g[2]}}locationPoint(n,a){const u=z(a.lat,a.lng),g=Le.vec3.normalize([],u),h=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(a),n._centerAltitude):n._centerAltitude,v=Se(1,0)*Nn*h;Le.vec3.scaleAndAdd(u,u,g,v);const T=Le.mat4.identity(new Float64Array(16));return Le.mat4.multiply(T,n.pixelMatrix,n.globeMatrix),Le.vec3.transformMat4(u,u,T),new Be(u[0],u[1])}pixelsPerMeter(n,a){return Se(1,0)*a}pixelSpaceConversion(n,a,u){const g=Se(1,n)*a,h=uo(Se(1,45)*a,g,u);return this.pixelsPerMeter(n,a)/h}createTileMatrix(n,a,u){const g=nx(gu(u.canonical));return Le.mat4.multiply(new Float64Array(16),n.globeMatrix,g)}createInversionMatrix(n,a){const{center:u}=n,g=Ny(gu(a));return Le.mat4.rotateY(g,g,Et(u.lng)),Le.mat4.rotateX(g,g,Et(u.lat)),Le.mat4.scale(g,g,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(n,a,u,g){return Hd(n,a,u,!0)||new vt(0,0)}pointCoordinate3D(n,a,u){const g=this.pointCoordinate(n,a,u,0);return[g.x,g.y,g.z]}isPointAboveHorizon(n,a){return!Hd(n,a.x,a.y,!1)}farthestPixelDistance(n){const a=function(g,h){const v=g.cameraToCenterDistance,T=g._centerAltitude*h,P=g._camera,O=g._camera.forward(),x=Le.vec3.add([],Le.vec3.scale([],O,-v),[0,0,T]),k=g.worldSize/(2*Math.PI),L=[0,0,-k],A=g.width/g.height,R=Math.tan(g.fovAboveCenter),$=Le.vec3.scale([],P.up(),R),W=Le.vec3.scale([],P.right(),R*A),Y=Le.vec3.normalize([],Le.vec3.add([],Le.vec3.add([],O,$),W)),re=[];let ie;if(new rs(x,Y).closestPointOnSphere(L,k,re)){const Q=Le.vec3.add([],re,L),ue=Le.vec3.sub([],Q,x);ie=Math.cos(g.fovAboveCenter)*Le.vec3.length(ue)}else{const Q=Le.vec3.sub([],x,L),ue=Le.vec3.sub([],L,x);Le.vec3.normalize(ue,ue);const _e=Le.vec3.length(Q)-k;ie=Math.sqrt(_e*(_e+2*k));const Ie=Math.acos(ie/(k+_e))-Math.acos(Le.vec3.dot(O,ue));ie*=Math.cos(Ie)}return 1.01*ie}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=Gd(n.zoom);if(u>0){const g=CM(n,Se(1,n.center.lat)*n.worldSize),h=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return uo(a,g+h*(1-Math.cos(v)),Math.pow(u,10))}return a}upVector(n,a,u){return Xg(a,u,n,1)}upVectorScale(n){return{metersToTile:jd(By(gu(n)))}}}function PM(c){const n=c.parallels,a=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new MM(c);case"equirectangular":return new NB(c);case"naturalEarth":return new VB(c);case"equalEarth":return new BB(c);case"winkelTripel":return new UB(c);case"albers":return a?new kM(c):new FB(c);case"lambertConformalConic":return a?new kM(c):new $B(c);case"globe":return new jB(c)}throw new Error(`Invalid projection name: ${c.name}`)}const HB=Op.VectorTileFeature.types,GB=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function i0(c,n,a,u,g,h,v,T,P,O,x,k,L){const A=T?Math.min(Zd,Math.round(T[0])):0,R=T?Math.min(Zd,Math.round(T[1])):0;c.emplaceBack(n,a,Math.round(32*u),Math.round(32*g),h,v,(A<<1)+(P?1:0),R,16*O,16*x,256*k,256*L)}function a0(c,n,a){c.emplaceBack(n,a)}function s0(c,n,a,u,g,h,v){c.emplaceBack(n,a,u,g,h,v)}function l0(c,n,a,u,g){c.emplaceBack(n,a,u,g),c.emplaceBack(n,a,u,g),c.emplaceBack(n,a,u,g),c.emplaceBack(n,a,u,g)}function WB(c){for(const n of c.sections)if(U1(n.text))return!0;return!1}class Ox{constructor(n){this.layoutVertexArray=new zd,this.indexArray=new bi,this.programConfigurations=n,this.segments=new ki,this.dynamicLayoutVertexArray=new Ec,this.opacityVertexArray=new Bg,this.placedSymbolArray=new jg,this.iconTransitioningVertexArray=new mu,this.globeExtVertexArray=new Fg,this.zOffsetVertexArray=new $d}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,a,u,g,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,cB.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,dB.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,GB,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,fB.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,uB.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,hB.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}no(Ox,"SymbolBuffers");class Dx{constructor(n,a,u){this.layoutVertexArray=new n,this.layoutAttributes=a,this.indexArray=new u,this.segments=new ki,this.collisionVertexArray=new Bd,this.collisionVertexArrayExt=new Ec}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,pB.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,mB.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}no(Dx,"CollisionBuffers");class c0{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Le.mat4.identity([]),this.placementViewportMatrix=Le.mat4.identity([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Sx(this.zoom,a["text-size"]),this.iconSizeData=Sx(this.zoom,a["icon-size"]);const u=this.layers[0].layout,g=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(v=>_l[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Ox(new jl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new Ox(new jl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new Ey,this.lineVertexArray=new Ap,this.symbolInstances=new Hg}calculateGlyphDependencies(n,a,u,g,h){for(const v of n){const T=v.codePointAt(0);if(T===void 0)break;if(a[T]=!0,g&&h&&T<=65535){const P=lv[v];P&&(a[P.charCodeAt(0)]=!0)}}}updateFootprints(n,a){}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!gx(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,a,u,g){const h=this.layers[0],v=h.layout,T=this.projection.name==="globe",P=v.get("text-font"),O=v.get("text-field"),x=v.get("icon-image"),k=(O.value.kind!=="constant"||O.value.value instanceof la&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),L=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,A=v.get("symbol-sort-key");if(this.features=[],!k&&!L)return;const R=a.iconDependencies,$=a.glyphDependencies,W=a.availableImages,Y=new Ei(this.zoom);for(const{feature:re,id:ie,index:Q,sourceLayerIndex:ue}of n){const _e=h._featureFilter.needGeometry,Ie=pn(re,_e);if(!h._featureFilter.filter(Y,Ie,u))continue;if(_e||(Ie.geometry=It(re,u,g)),T&&re.type!==1&&u.z<=5){const st=Ie.geometry,Fe=.98078528056,rt=(ht,pt)=>{const Tt=Xg(ht.x,ht.y,u,1),Lt=Xg(pt.x,pt.y,u,1);return Le.vec3.dot(Tt,Lt)<Fe};for(let ht=0;ht<st.length;ht++)st[ht]=en(st[ht],rt)}let Ge,ze;if(k){const st=h.getValueAndResolveTokens("text-field",Ie,u,W),Fe=la.factory(st);WB(Fe)&&(this.hasRTLText=!0),(!this.hasRTLText||Ag()==="unavailable"||this.hasRTLText&&Ts.isParsed())&&(Ge=_B(Fe,h,Ie))}if(L){const st=h.getValueAndResolveTokens("icon-image",Ie,u,W);ze=st instanceof ma?st:ma.fromString(st)}if(!Ge&&!ze)continue;const $e=this.sortFeaturesByKey?A.evaluate(Ie,{},u):void 0;if(this.features.push({id:ie,text:Ge,icon:ze,index:Q,sourceLayerIndex:ue,geometry:Ie.geometry,properties:re.properties,type:HB[re.type],sortKey:$e}),ze&&(R[ze.namePrimary]=!0,ze.nameSecondary&&(R[ze.nameSecondary]=!0)),Ge){const st=P.evaluate(Ie,{},u).join(","),Fe=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_l.vertical)>=0;for(const rt of Ge.sections)if(rt.image)R[rt.image.namePrimary]=!0;else{const ht=Tg(Ge.toString()),pt=rt.fontStack||st,Tt=$[pt]=$[pt]||{};this.calculateGlyphDependencies(rt.text,Tt,Fe,this.allowVerticalPlacement,ht)}}}v.get("symbol-placement")==="line"&&(this.features=function(re){const ie={},Q={},ue=[];let _e=0;function Ie(st){ue.push(re[st]),_e++}function Ge(st,Fe,rt){const ht=Q[st];return delete Q[st],Q[Fe]=ht,ue[ht].geometry[0].pop(),ue[ht].geometry[0]=ue[ht].geometry[0].concat(rt[0]),ht}function ze(st,Fe,rt){const ht=ie[Fe];return delete ie[Fe],ie[st]=ht,ue[ht].geometry[0].shift(),ue[ht].geometry[0]=rt[0].concat(ue[ht].geometry[0]),ht}function $e(st,Fe,rt){const ht=rt?Fe[0][Fe[0].length-1]:Fe[0][0];return`${st}:${ht.x}:${ht.y}`}for(let st=0;st<re.length;st++){const Fe=re[st],rt=Fe.geometry,ht=Fe.text?Fe.text.toString():null;if(!ht){Ie(st);continue}const pt=$e(ht,rt),Tt=$e(ht,rt,!0);if(pt in Q&&Tt in ie&&Q[pt]!==ie[Tt]){const Lt=ze(pt,Tt,rt),Ft=Ge(pt,Tt,ue[Lt].geometry);delete ie[pt],delete Q[Tt],Q[$e(ht,ue[Ft].geometry,!0)]=Ft,ue[Lt].geometry=null}else pt in Q?Ge(pt,Tt,rt):Tt in ie?ze(pt,Tt,rt):(Ie(st),ie[pt]=_e-1,Q[Tt]=_e-1)}return ue.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((re,ie)=>re.sortKey-ie.sortKey)}update(n,a,u,g,h){const v=Object.keys(n).length!==0;if(v&&!this.stateDependentLayers.length)return;const T=v?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(n,a,T,u,g,h),this.icon.programConfigurations.updatePaintArrays(n,a,T,u,g,h)}updateZOffset(){const n=(h,v,T)=>{u+=v,u>h.length&&h.resize(u);for(let P=-v;P<0;P++)h.emplace(P+u,T)},a=(h,v,T)=>{g+=v,g>h.length&&h.resize(g);for(let P=-v;P<0;P++)h.emplace(P+g,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,g=0;for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:P,numIconVertices:O}=v,x=v.zOffset,k=O>0;if((T>0||P>0)&&(n(this.text.zOffsetVertexArray,T,x),n(this.text.zOffsetVertexArray,P,x)),k){const{placedIconSymbolIndex:L,verticalPlacedIconSymbolIndex:A}=v;L>=0&&a(this.icon.zOffsetVertexArray,O,x),A>=0&&a(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,x)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=PM(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,a){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:g,y:h}of a)this.lineVertexArray.emplaceBack(g,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,a,u,g,h,v,T,P,O,x,k,L,A,R,$,W){const Y=n.indexArray,re=n.layoutVertexArray,ie=n.globeExtVertexArray,Q=n.segments.prepareSegment(4*a.length,re,Y,this.canOverlap?v.sortKey:void 0),ue=this.glyphOffsetArray.length,_e=Q.vertexLength,Ie=this.allowVerticalPlacement&&T===_l.vertical?Math.PI/2:0,Ge=v.text&&v.text.sections;for(let $e=0;$e<a.length;$e++){const{tl:st,tr:Fe,bl:rt,br:ht,texPrimary:pt,texSecondary:Tt,pixelOffsetTL:Lt,pixelOffsetBR:Ft,minFontScaleX:Pt,minFontScaleY:sn,glyphOffset:Cn,isSDF:Jt,sectionIndex:Jn}=a[$e],Fn=Q.vertexLength,Pn=Cn[1];if(i0(re,O.x,O.y,st.x,Pn+st.y,pt.x,pt.y,u,Jt,Lt.x,Lt.y,Pt,sn),i0(re,O.x,O.y,Fe.x,Pn+Fe.y,pt.x+pt.w,pt.y,u,Jt,Ft.x,Lt.y,Pt,sn),i0(re,O.x,O.y,rt.x,Pn+rt.y,pt.x,pt.y+pt.h,u,Jt,Lt.x,Ft.y,Pt,sn),i0(re,O.x,O.y,ht.x,Pn+ht.y,pt.x+pt.w,pt.y+pt.h,u,Jt,Ft.x,Ft.y,Pt,sn),P){const{x:Sn,y:wo,z:Xn}=P.anchor,[io,Uo,er]=P.up;s0(ie,Sn,wo,Xn,io,Uo,er),s0(ie,Sn,wo,Xn,io,Uo,er),s0(ie,Sn,wo,Xn,io,Uo,er),s0(ie,Sn,wo,Xn,io,Uo,er),l0(n.dynamicLayoutVertexArray,Sn,wo,Xn,Ie)}else l0(n.dynamicLayoutVertexArray,O.x,O.y,O.z,Ie);if(W){const Sn=Tt||pt;a0(n.iconTransitioningVertexArray,Sn.x,Sn.y),a0(n.iconTransitioningVertexArray,Sn.x+Sn.w,Sn.y),a0(n.iconTransitioningVertexArray,Sn.x,Sn.y+Sn.h),a0(n.iconTransitioningVertexArray,Sn.x+Sn.w,Sn.y+Sn.h)}Y.emplaceBack(Fn,Fn+1,Fn+2),Y.emplaceBack(Fn+1,Fn+2,Fn+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Cn[0]),$e!==a.length-1&&Jn===a[$e+1].sectionIndex||n.programConfigurations.populatePaintArrays(re.length,v,v.index,{},A,R,$,Ge&&Ge[Jn])}const ze=P?P.anchor:O;n.placedSymbolArray.emplaceBack(ze.x,ze.y,ze.z,O.x,O.y,ue,this.glyphOffsetArray.length-ue,_e,x,k,O.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],T,0,!1,0,L,0)}_commitLayoutVertex(n,a,u,g,h,v,T){n.emplaceBack(a,u,g,h,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(n,a,u,g,h,v,T){const P=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),O=P.vertexLength,x=T.tileAnchorX,k=T.tileAnchorY;for(let A=0;A<4;A++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,a,n.padding,T.zOffset),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,k,new Be(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,k,new Be(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,k,new Be(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,k,new Be(n.x1,n.y2)),P.vertexLength+=4;const L=u.indexArray;L.emplaceBack(O,O+1),L.emplaceBack(O+1,O+2),L.emplaceBack(O+2,O+3),L.emplaceBack(O+3,O),P.primitiveLength+=4}_addTextDebugCollisionBoxes(n,a,u,g,h,v){for(let T=g;T<h;T++){const P=u.get(T),O=this.getSymbolInstanceTextSize(n,v,a,T);this._addCollisionDebugVertices(P,O,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,a,u,g,h,v){for(let T=g;T<h;T++){const P=u.get(T),O=this.getSymbolInstanceIconSize(n,a,v.placedIconSymbolIndex);this._addCollisionDebugVertices(P,O,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dx(Sp,QE.members,mu),this.iconCollisionBox=new Dx(Sp,QE.members,mu);const g=Dp(this.iconSizeData,n),h=Dp(this.textSizeData,n,u);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(h,n,a,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(h,n,a,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(g,n,a,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(g,n,a,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(n,a,u,g){const h=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:g),v=Yy(this.textSizeData,n,h)/ba;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,a,u){const g=this.icon.placedSymbolArray.get(u),h=Yy(this.iconSizeData,n,g);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(n,a,u,g){n.emplaceBack(a,-u,-u,g),n.emplaceBack(a,u,-u,g),n.emplaceBack(a,u,u,g),n.emplaceBack(a,-u,u,g)}_updateTextDebugCollisionBoxes(n,a,u,g,h,v,T){for(let P=g;P<h;P++){const O=u.get(P),x=this.getSymbolInstanceTextSize(n,v,a,P);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,x,O.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(n,a,u,g,h,v,T){for(let P=g;P<h;P++){const O=u.get(P),x=this.getSymbolInstanceIconSize(n,a,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,x,O.padding,v.zOffset)}}updateCollisionDebugBuffers(n,a,u,g){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=Dp(this.iconSizeData,n,g),v=Dp(this.textSizeData,n,u);for(let T=0;T<this.symbolInstances.length;T++){const P=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(v,n,a,P.textBoxStartIndex,P.textBoxEndIndex,P,u),this._updateTextDebugCollisionBoxes(v,n,a,P.verticalTextBoxStartIndex,P.verticalTextBoxEndIndex,P,u),this._updateIconDebugCollisionBoxes(h,n,a,P.iconBoxStartIndex,P.iconBoxEndIndex,P,g),this._updateIconDebugCollisionBoxes(h,n,a,P.verticalIconBoxStartIndex,P.verticalIconBoxEndIndex,P,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,a,u,g,h,v,T,P,O){const x={};if(a<u){const{x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(a);x.textBox={x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.textFeatureIndex=ue}if(g<h){const{x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(g);x.verticalTextBox={x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.verticalTextFeatureIndex=ue}if(v<T){const{x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(v);x.iconBox={x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.iconFeatureIndex=ue}if(P<O){const{x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(P);x.verticalIconBox={x1:k,y1:L,x2:A,y2:R,padding:$,projectedAnchorX:W,projectedAnchorY:Y,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.verticalIconFeatureIndex=ue}return x}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,a){const u=n.placedSymbolArray.get(a),g=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<g;h+=4)n.indexArray.emplaceBack(h,h+1,h+2),n.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(n),u=Math.cos(n),g=[],h=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const P=this.symbolInstances.get(T);g.push(0|Math.round(a*P.tileAnchorX+u*P.tileAnchorY)),h.push(P.featureIndex)}return v.sort((T,P)=>g[T]-g[P]||h[P]-h[T]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,a)=>this.symbolInstances.get(a).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,a){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const u=this.symbolInstances.get(a);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:O}=u;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),h>=0&&h!==g&&this.addIndicesForPlacedSymbol(this.text,h),v>=0&&v!==h&&v!==g&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let RM,LM,zx;no(c0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),c0.addDynamicAttributes=l0;class OM{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:yi,this.defaultValue=n}evaluate(n){if(n.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(n.formattedSection))return a.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}no(OM,"FormatSectionOverride",{omit:["defaultValue"]});const Fx=()=>zx||(zx={layout:RM||(RM=new ci({"symbol-placement":new Rn(Ot.layout_symbol["symbol-placement"]),"symbol-spacing":new Rn(Ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Rn(Ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _o(Ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Rn(Ot.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Rn(Ot.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Rn(Ot.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Rn(Ot.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Rn(Ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new Rn(Ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Rn(Ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new _o(Ot.layout_symbol["icon-size"]),"icon-size-scale-range":new Rn(Ot.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new _o(Ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _o(Ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new _o(Ot.layout_symbol["icon-image"]),"icon-rotate":new _o(Ot.layout_symbol["icon-rotate"]),"icon-padding":new Rn(Ot.layout_symbol["icon-padding"]),"icon-keep-upright":new Rn(Ot.layout_symbol["icon-keep-upright"]),"icon-offset":new _o(Ot.layout_symbol["icon-offset"]),"icon-anchor":new _o(Ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Rn(Ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Rn(Ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Rn(Ot.layout_symbol["text-rotation-alignment"]),"text-field":new _o(Ot.layout_symbol["text-field"]),"text-font":new _o(Ot.layout_symbol["text-font"]),"text-size":new _o(Ot.layout_symbol["text-size"]),"text-size-scale-range":new Rn(Ot.layout_symbol["text-size-scale-range"]),"text-max-width":new _o(Ot.layout_symbol["text-max-width"]),"text-line-height":new _o(Ot.layout_symbol["text-line-height"]),"text-letter-spacing":new _o(Ot.layout_symbol["text-letter-spacing"]),"text-justify":new _o(Ot.layout_symbol["text-justify"]),"text-radial-offset":new _o(Ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Rn(Ot.layout_symbol["text-variable-anchor"]),"text-anchor":new _o(Ot.layout_symbol["text-anchor"]),"text-max-angle":new Rn(Ot.layout_symbol["text-max-angle"]),"text-writing-mode":new Rn(Ot.layout_symbol["text-writing-mode"]),"text-rotate":new _o(Ot.layout_symbol["text-rotate"]),"text-padding":new Rn(Ot.layout_symbol["text-padding"]),"text-keep-upright":new Rn(Ot.layout_symbol["text-keep-upright"]),"text-transform":new _o(Ot.layout_symbol["text-transform"]),"text-offset":new _o(Ot.layout_symbol["text-offset"]),"text-allow-overlap":new Rn(Ot.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Rn(Ot.layout_symbol["text-ignore-placement"]),"text-optional":new Rn(Ot.layout_symbol["text-optional"]),visibility:new Rn(Ot.layout_symbol.visibility)})),paint:LM||(LM=new ci({"icon-opacity":new _o(Ot.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new _o(Ot.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new _o(Ot.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new _o(Ot.paint_symbol["text-emissive-strength"]),"icon-color":new _o(Ot.paint_symbol["icon-color"]),"icon-halo-color":new _o(Ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new _o(Ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _o(Ot.paint_symbol["icon-halo-blur"]),"icon-translate":new Rn(Ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new Rn(Ot.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new _o(Ot.paint_symbol["icon-image-cross-fade"]),"text-opacity":new _o(Ot.paint_symbol["text-opacity"]),"text-occlusion-opacity":new _o(Ot.paint_symbol["text-occlusion-opacity"]),"text-color":new _o(Ot.paint_symbol["text-color"],{runtimeType:zr,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new _o(Ot.paint_symbol["text-halo-color"]),"text-halo-width":new _o(Ot.paint_symbol["text-halo-width"]),"text-halo-blur":new _o(Ot.paint_symbol["text-halo-blur"]),"text-translate":new Rn(Ot.paint_symbol["text-translate"]),"text-translate-anchor":new Rn(Ot.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Rn(Ot.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Rn(Ot.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Rn(Ot.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Rn(Ot.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new _o(Ot.paint_symbol["symbol-z-offset"])}))},zx);class u0 extends Va{constructor(n,a,u,g){super(n,Fx(),a,u,g),this._colorAdjustmentMatrix=Le.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,a){super.recalculate(n,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const g=[];for(const h of u)g.indexOf(h)<0&&g.push(h);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,a,u,g){return this._saturation===n&&this._contrast===a&&this._brightnessMin===u&&this._brightnessMax===g||(this._colorAdjustmentMatrix=function(h,v,T,P){h=ke(h),v=Ee(v);const O=Le.mat4.create(),x=h/3,k=1-2*x,L=[k,x,x,0,x,k,x,0,x,x,k,0,0,0,0,1],A=.5-.5*v,R=P-T;return Le.mat4.multiply(O,[R,0,0,0,0,R,0,0,0,0,R,0,T,T,T,1],[v,0,0,0,0,v,0,0,0,0,v,0,A,A,A,1]),Le.mat4.multiply(O,O,L),O}(n,a,u,g),this._saturation=n,this._contrast=a,this._brightnessMin=u,this._brightnessMax=g),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,a,u,g){const h=this.layout.get(n).evaluate(a,{},u,g),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||up(v.value)||!h?h:function(T,P){return P.replace(/{([^{}]+)}/g,(O,x)=>x in T?String(T[x]):"")}(a.properties,h)}createBucket(n){return new c0(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of Fx().paint.overridableProperties){if(!u0.hasPaintOverride(this.layout,n))continue;const a=this.paint.get(n),u=new OM(a),g=new bg(u,a.property.specification,this.scope,this.options);let h=null;h=a.value.kind==="constant"||a.value.kind==="source"?new dp("source",g):new Wh("composite",g,a.value.zoomStops,a.value._interpolationType),this.paint._values[n]=new Rd(a.property,h,a.parameters)}}_handleOverridablePaintPropertyUpdate(n,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&u0.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,a){const u=n.get("text-field"),g=Fx().paint.properties[a];let h=!1;const v=T=>{for(const P of T)if(g.overrides&&g.overrides.hasOverride(P))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof la)v(u.value.value.sections);else if(u.value.kind==="source"){const T=O=>{h||(O instanceof Qa&&Ci(O.value)===dc?v(O.value.sections):O instanceof su?v(O.sections):O.eachChild(T))},P=u.value;P._styleExpression&&T(P._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,a,u){return{config:new Pc(this,{zoom:a,lut:u}),overrideFog:!1}}}let DM,zM,FM,BM;var Bx=Mr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Nx(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function $x(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Vx{constructor(n,a,u,g){this.context=n,this.format=u,this.useMipmap=g&&g.useMipmap,this.texture=n.gl.createTexture(),this.update(a,{premultiply:g&&g.premultiply})}update(n,a){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,g=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:h}=this,{gl:v}=h,{x:T,y:P}=a&&a.position?a.position:{x:0,y:0},O=Math.max(T+u,this.size?this.size[0]:0),x=Math.max(P+g,this.size?this.size[1]:0);!this.size||this.size[0]===O&&this.size[1]===x||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!a||a.premultiply!==!1));const k=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&O>0&&x>0){const L=this.useMipmap?Math.floor(Math.log2(Math.max(O,x)))+1:1;v.texStorage2D(v.TEXTURE_2D,L,this.format,O,x),this.size=[O,x]}if(this.size)if(k)v.texSubImage2D(v.TEXTURE_2D,0,T,P,Nx(this.format),$x(this.format),n);else{const L=n.data;L&&v.texSubImage2D(v.TEXTURE_2D,0,T,P,u,g,Nx(this.format),$x(this.format),L)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,a,u=!1){const{context:g}=this,{gl:h}=g;h.bindTexture(h.TEXTURE_2D,this.texture),n!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),a!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,a),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,a),this.wrapS=a)}bindExtraParam(n,a,u,g){const{context:h}=this,{gl:v}=h;v.bindTexture(v.TEXTURE_2D,this.texture),a!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,a),this.magFilter=a),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),this.wrapS=u),g!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,g),this.wrapT=g)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class d0{constructor(n,a){this.context=n,this.texture=a}bind(n,a){const{context:u}=this,{gl:g}=u;g.bindTexture(g.TEXTURE_2D,this.texture),n!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,n),this.minFilter=n),a!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,a),this.wrapS=a)}}function h0(c,n,a,u,g,h,v,T){const P=[c,n,1,a,u,1,g,h,1],O=[v,T,1],x=Le.mat3.adjoint([],P),[k,L,A]=Le.vec3.transformMat3(O,O,x);return Le.mat3.multiply(P,P,[k,0,0,0,L,0,0,0,A])}function NM(c,n,a,u,g,h,v,T){const P=function(O,x,k,L,A,R,$,W){const Y=h0(0,0,1,0,1,1,0,1),re=h0(O,x,k,L,A,R,$,W),ie=Le.mat3.adjoint([],Y);return Le.mat3.multiply(re,re,ie)}(c,n,a,u,g,h,v,T);return[P[2]/P[8]/Nn,P[5]/P[8]/Nn]}function f0(c){return[c[0],Math.min(Math.max(c[1],-Ye),Ye)]}class $M extends Kn{constructor(n,a,u,g){super(),this.id=n,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(g),this.options=a,this._dirty=!1}load(n,a){if(this._loaded=a||!1,this.fire(new wt("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=_s(this.map._requestManager.transformRequest(this.url,lc.Image),(u,g)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Bt(u)):g&&(this.image=g instanceof HTMLImageElement?Yt.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new d0(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new wt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof d0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let a=n[0][1],u=n[0][1];for(const h of n)h[1]>u&&(u=h[1]),h[1]<a&&(a=h[1]);const g=(u+a)/2;if(g>Ye?this.onNorthPole=!0:g<-Ye&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=n.map(vt.fromLngLat);this.tileID=function(v){let T=1/0,P=1/0,O=-1/0,x=-1/0;for(const $ of v)T=Math.min(T,$.x),P=Math.min(P,$.y),O=Math.max(O,$.x),x=Math.max(x,$.y);const k=Math.max(O-T,x-P),L=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),A=Math.pow(2,L);let R=Math.floor((T+O)/2*A);return R>1&&(R-=1),new ea(L,R,Math.floor((P+x)/2*A))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new wt("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const Y in this.tiles){const re=this.tiles[Y];re.state!=="loaded"&&(re.state="loaded",re.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const a=fv(new ea(0,0,0),this.map.transform.projection),u=[a.projection.project(this.coordinates[0][0],this.coordinates[0][1]),a.projection.project(this.coordinates[1][0],this.coordinates[1][1]),a.projection.project(this.coordinates[2][0],this.coordinates[2][1]),a.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Y){const re=Y[1].x-Y[0].x,ie=Y[1].y-Y[0].y,Q=Y[2].x-Y[1].x,ue=Y[2].y-Y[1].y,_e=Y[3].x-Y[2].x,Ie=Y[3].y-Y[2].y,Ge=Y[0].x-Y[3].x,ze=Y[0].y-Y[3].y,$e=re*ue-Q*ie,st=Q*Ie-_e*ue,Fe=_e*ze-Ge*Ie,rt=Ge*ie-re*ze;return $e>0&&st>0&&Fe>0&&rt>0||$e<0&&st<0&&Fe<0&&rt<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const g=fv(this.tileID,this.map.transform.projection),[h,v,T,P]=this.coordinates.map(Y=>{const re=g.projection.project(Y[0],Y[1]);return EM(g,re)._round()});this.perspectiveTransform=NM(h.x,h.y,v.x,v.y,T.x,T.y,P.x,P.y);const O=this._boundsArray=new Dd;O.emplaceBack(h.x,h.y,0,0),O.emplaceBack(v.x,v.y,Nn,0),O.emplaceBack(P.x,P.y,0,Nn),O.emplaceBack(T.x,T.y,Nn,Nn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(O,Bx.members),this.boundsSegments=ki.simpleSegment(0,0,4,2);const x=[],k=[f0((L=this.coordinates)[0]),f0(L[1]),f0(L[2]),f0(L[3])];var L;const[A,R,$,W]=function(Y){let re=Y[0][0],ie=re,Q=Y[0][1],ue=Q;for(let _e=1;_e<Y.length;_e++)Y[_e][0]<re?re=Y[_e][0]:Y[_e][0]>ie&&(ie=Y[_e][0]),Y[_e][1]<Q?Q=Y[_e][1]:Y[_e][1]>ue&&(ue=Y[_e][1]);return[re,Q,ie-re,ue-Q]}(k);{const Y=new Dd,[re,ie,Q,ue]=function(Lt){let Ft=Lt[0].x,Pt=Ft,sn=Lt[0].y,Cn=sn;for(let Jt=1;Jt<Lt.length;Jt++)Lt[Jt].x<Ft?Ft=Lt[Jt].x:Lt[Jt].x>Pt&&(Pt=Lt[Jt].x),Lt[Jt].y<sn?sn=Lt[Jt].y:Lt[Jt].y>Cn&&(Cn=Lt[Jt].y);return[Ft,sn,Pt-Ft,Cn-sn]}(u),_e=Lt=>[(Lt.x-re)/Q,(Lt.y-ie)/ue],[Ie,Ge,ze,$e]=u.map(_e),st=function(Lt,Ft,Pt,sn,Cn,Jt,Jn,Fn){const Pn=h0(0,0,1,0,1,1,0,1),Sn=h0(Lt,Ft,Pt,sn,Cn,Jt,Jn,Fn),wo=Le.mat3.adjoint([],Sn);return Le.mat3.multiply(Pn,Pn,wo)}(Ie[0],Ie[1],Ge[0],Ge[1],ze[0],ze[1],$e[0],$e[1]);this.elevatedGlobePerspectiveTransform=NM(Ie[0],Ie[1],Ge[0],Ge[1],ze[0],ze[1],$e[0],$e[1]);const Fe=(Lt,Ft)=>{x.push(Lt.lng);const Pt=Math.round((Lt.lng-A)/$*Nn),sn=Math.round((Lt.lat-R)/W*Nn),Cn=_e(Ft),Jt=Le.vec3.transformMat3([],[Cn[0],Cn[1],1],st),Jn=Math.round(Jt[0]/Jt[2]*Nn),Fn=Math.round(Jt[1]/Jt[2]*Nn);Y.emplaceBack(Pt,sn,Jn,Fn)},rt=u[3].x-u[0].x,ht=u[3].y-u[0].y,pt=u[2].x-u[1].x,Tt=u[2].y-u[1].y;for(let Lt=0;Lt<65;Lt++){const Ft=Lt/64,Pt=[u[0].x+Ft*rt,u[0].y+Ft*ht],sn=[u[1].x+Ft*pt,u[1].y+Ft*Tt],Cn=sn[0]-Pt[0],Jt=sn[1]-Pt[1];for(let Jn=0;Jn<65;Jn++){const Fn=Jn/64,Pn={x:Pt[0]+Cn*Fn,y:Pt[1]+Jt*Fn};Fe(a.projection.unproject(Pn.x,Pn.y),Pn)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(Y,Bx.members)}{this.maxLongitudeTriangleSize=0;let Y=[],re=new bi;const ie=(Q,ue,_e)=>{re.emplaceBack(Q,ue,_e);const Ie=x[Q],Ge=x[ue],ze=x[_e],$e=Math.min(Math.min(Ie,Ge),ze),st=Math.max(Math.max(Ie,Ge),ze)-$e;st>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=st),Y.push($e+st/2)};for(let Q=0;Q<64;Q++)for(let ue=0;ue<64;ue++){const _e=65*Q+ue,Ie=_e+1,Ge=_e+65,ze=Ge+1;ie(_e,Ge,Ie),ie(Ie,Ge,ze)}[Y,re]=function(Q,ue){const _e=Array.from({length:Q.length},(ze,$e)=>$e);_e.sort((ze,$e)=>Q[ze]-Q[$e]);const Ie=[],Ge=new bi;for(let ze=0;ze<_e.length;ze++){const $e=_e[ze];Ie.push(Q[$e]);const st=3*$e,Fe=st+1;Ge.emplaceBack(ue.uint16[st],ue.uint16[Fe],ue.uint16[Fe+1])}return[Ie,Ge]}(Y,re),this.elevatedGlobeTrianglesCenterLongitudes=Y,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(re)}this.elevatedGlobeSegments=ki.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,$/Nn,0,W/Nn,0,0,R,A,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const a=this.map.painter.context,u=a.gl;!this._dirty||this.texture instanceof d0||(this.texture?this.texture.update(this.image):(this.texture=new Vx(a,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(a)}loadTile(n,a){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},a(null)):(n.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const a=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!a)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let g=(h=n+180)+360*Math.round((u[0]-h)/360);var h;const v=new ki,T=(k,L)=>{v.segments.push({vertexOffset:0,primitiveOffset:k,vertexLength:a.segments[0].vertexLength,primitiveLength:L,sortKey:void 0,vaos:{}})},P=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-g)<=P){const k=Zt(u,0,u.length,g+P);return k===u.length||T(k,$s(u,k+1,u.length,g+360-P)-k),v}g<u[0]&&(g+=360);const O=$s(u,0,u.length,g-P);if(O===u.length)return T(0,u.length),v;T(0,O-0);const x=Zt(u,O+1,u.length,g+P);return x!==u.length&&T(x,u.length-x),v}}const qB=(Math.pow(256,2)-1)/16907520;class VM extends Va{constructor(n,a,u,g){super(n,{layout:FM||(FM=new ci({visibility:new Rn(Ot.layout_raster.visibility)})),paint:BM||(BM=new ci({"raster-opacity":new Rn(Ot.paint_raster["raster-opacity"]),"raster-color":new Od(Ot.paint_raster["raster-color"]),"raster-color-mix":new Rn(Ot.paint_raster["raster-color-mix"]),"raster-color-range":new Rn(Ot.paint_raster["raster-color-range"]),"raster-hue-rotate":new Rn(Ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Rn(Ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Rn(Ot.paint_raster["raster-brightness-max"]),"raster-saturation":new Rn(Ot.paint_raster["raster-saturation"]),"raster-contrast":new Rn(Ot.paint_raster["raster-contrast"]),"raster-resampling":new Rn(Ot.paint_raster["raster-resampling"]),"raster-fade-duration":new Rn(Ot.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Rn(Ot.paint_raster["raster-emissive-strength"]),"raster-array-band":new Rn(Ot.paint_raster["raster-array-band"]),"raster-elevation":new Rn(Ot.paint_raster["raster-elevation"])}))},a,u,g),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof $M&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const a=this._transitionablePaint._values["raster-color"].value.expression,[u,g]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(g)||u===this._curRampRange[0]&&g===this._curRampRange[1]||(this.colorRamp=Jg({expression:a,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:g}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,g])}}let UM,jM,HM,GM,WM;class qM extends Va{constructor(n,a,u,g){super(n,{layout:UM||(UM=new ci({visibility:new Rn(Ot["layout_raster-particle"].visibility)})),paint:jM||(jM=new ci({"raster-particle-array-band":new Rn(Ot["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Rn(Ot["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Od(Ot["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Rn(Ot["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Rn(Ot["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Rn(Ot["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Rn(Ot["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Rn(Ot["paint_raster-particle"]["raster-particle-elevation"])}))},a,u,g),this._updateColorRamp(),this.lastInvalidatedAt=Yt.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,a=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Jg({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:a}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Yt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class KB extends Va{constructor(n,a){super(n,{},a,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function Ux(c,n,a){const u=[0,0,1],g=Le.quat.identity([]);return Le.quat.rotateY(g,g,a?-Et(c)+Math.PI:Et(c)),Le.quat.rotateX(g,g,-Et(n)),Le.vec3.transformQuat(u,u,g),Le.vec3.normalize(u,u)}function KM(c,n){const a=p0(c.projection,c.zoom,c.width,c.height),u=function(h,v,T,P,O){const x=new H(T.lng-180*Xd,T.lat),k=new H(T.lng+180*Xd,T.lat),L=h.project(x.lng,x.lat),A=h.project(k.lng,k.lat),R=-Math.atan2(A.y-L.y,A.x-L.x),$=vt.fromLngLat(T);$.y=yt($.y,-1+Xd,1-Xd);const W=$.toLngLat(),Y=h.project(W.lng,W.lat),re=vt.fromLngLat(W);re.x+=Xd;const ie=re.toLngLat(),Q=h.project(ie.lng,ie.lat),ue=YM(Q.x-Y.x,Q.y-Y.y,R),_e=vt.fromLngLat(W);_e.y+=Xd;const Ie=_e.toLngLat(),Ge=h.project(Ie.lng,Ie.lat),ze=YM(Ge.x-Y.x,Ge.y-Y.y,R),$e=Math.abs(ue.x)/Math.abs(ze.y),st=Le.mat4.identity([]);Le.mat4.rotateZ(st,st,-R*(1-(O?0:P)));const Fe=Le.mat4.identity([]);return Le.mat4.scale(Fe,Fe,[1,1-(1-$e)*P,1]),Fe[4]=-ze.x/ze.y*P,Le.mat4.rotateZ(Fe,Fe,R),Le.mat4.multiply(Fe,st,Fe),Fe}(c.projection,0,c.center,a,n),g=ZM(c);return Le.mat4.scale(u,u,[g,g,1]),u}function ZM(c){const n=c.projection,a=p0(c.projection,c.zoom,c.width,c.height),u=jx(n,c.center),g=jx(n,H.convert(n.center));return Math.pow(2,u*a+(1-a)*g)}function p0(c,n,a,u,g=1/0){const h=c.range;if(!h)return 0;const v=Math.min(g,Math.max(a,u)),T=Math.log(v/1024)/Math.LN2;return kn(h[0]+T,h[1]+T,n)}const Xd=1/4e4;function jx(c,n){const a=yt(n.lat,-Ye,Ye),u=new H(n.lng-180*Xd,a),g=new H(n.lng+180*Xd,a),h=c.project(u.lng,a),v=c.project(g.lng,a),T=vt.fromLngLat(u),P=vt.fromLngLat(g),O=v.x-h.x,x=v.y-h.y,k=P.x-T.x,L=P.y-T.y,A=Math.sqrt((k*k+L*L)/(O*O+x*x));return Math.log(A)/Math.LN2}function YM(c,n,a){const u=Math.cos(a),g=Math.sin(a);return{x:c*u-n*g,y:c*g+n*u}}function XM(c,n,a){Le.mat4.identity(c),Le.mat4.rotateZ(c,c,Et(n[2])),Le.mat4.rotateX(c,c,Et(n[0])),Le.mat4.rotateY(c,c,Et(n[1])),Le.mat4.scale(c,c,a),Le.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function m0(c,n,a,u,g,h,v,T){const P=[a[0]-n[0],a[1]-n[1],0],O=[u[0]-n[0],u[1]-n[1],0];if(Le.vec3.length(P)<1e-12||Le.vec3.length(O)<1e-12)return Le.quat.identity(c);const x=Le.vec3.cross([],P,O);Le.vec3.normalize(x,x),Le.vec3.subtract(O,u,n),P[2]=(h-g)*T,O[2]=(v-g)*T;const k=P;return Le.vec3.cross(k,P,O),Le.vec3.normalize(k,k),Le.quat.rotationTo(c,x,k)}function Hx(c,n,a=!1){const u=Gd(n.zoom),g=function(h,v,T){const P=v.worldSize,O=[h[12],h[13],h[14]],x=je(O[1]/P),k=De(O[0]/P),L=Le.mat4.identity([]),A=Se(1,x)*P,R=Se(1,0)*P*Xe(x,v.zoom),$=1/ox(P);let W=R*$;if(T){const Q=p0(v.projection,v.zoom,v.width,v.height,1024);W=$*v.projection.pixelSpaceConversion(v.center.lat,P,Q)}const Y=z(x,k);Le.vec3.add(Y,Y,Le.vec3.scale([],Le.vec3.normalize([],Y),A*W*O[2]));const re=function(Q){const ue=[Q[0],Q[1],Q[2]];let _e=[0,1,0];const Ie=Le.vec3.cross([],_e,ue);return Le.vec3.cross(_e,ue,Ie),Le.vec3.squaredLength(_e)===0&&(_e=[0,1,0],Le.vec3.cross(Ie,ue,_e)),Le.vec3.normalize(Ie,Ie),Le.vec3.normalize(_e,_e),Le.vec3.normalize(ue,ue),[Ie[0],Ie[1],Ie[2],0,_e[0],_e[1],_e[2],0,ue[0],ue[1],ue[2],0,Q[0],Q[1],Q[2],1]}(Y);Le.mat4.scale(L,L,[W,W,W*A]),Le.mat4.translate(L,L,[-O[0],-O[1],-O[2]]);const ie=Le.mat4.multiply([],v.globeMatrix,re);return Le.mat4.multiply(ie,ie,L),Le.mat4.multiply(ie,ie,h),ie}(c,n,a);if(u>0){const h=function(v,T){const P=T.worldSize,O=Se(1,0)*P*Xe(T.center.lat,T.zoom)/ox(P),x=Se(1,T.center.lat)*P,k=Le.mat4.identity([]);return Le.mat4.rotateY(k,k,Et(T.center.lng)),Le.mat4.rotateX(k,k,Et(T.center.lat)),Le.mat4.translate(k,k,[0,0,ya]),Le.mat4.scale(k,k,[O,O,O*x]),Le.mat4.translate(k,k,[T.point.x-.5*P,T.point.y-.5*P,0]),Le.mat4.multiply(k,k,v),Le.mat4.multiply(k,T.globeMatrix,k)}(c,n);return function(v,T,P){const O=(R,$,W)=>{const Y=Le.vec3.length(R),re=Le.vec3.length($),ie=qu(R,$,W);return Le.vec3.scale(ie,ie,1/Le.vec3.length(ie)*uo(Y,re,W))},x=O([v[0],v[1],v[2]],[T[0],T[1],T[2]],P),k=O([v[4],v[5],v[6]],[T[4],T[5],T[6]],P),L=O([v[8],v[9],v[10]],[T[8],T[9],T[10]],P),A=qu([v[12],v[13],v[14]],[T[12],T[13],T[14]],P);return[x[0],x[1],x[2],0,k[0],k[1],k[2],0,L[0],L[1],L[2],0,A[0],A[1],A[2],1]}(g,h,u)}return g}function JM(c,n,a,u){const g=Fr.projectAabbCorners(u,a);let h=Number.MAX_VALUE,v=-1;for(let O=0;O<g.length;++O){const x=g[O];x[0]=(.5*x[0]+.5)*n.width,x[1]=(.5-.5*x[1])*n.height,x[2]<h&&(v=O,h=x[2])}const T=O=>new Be(g[O][0],g[O][1]);let P;switch(v){case 0:case 6:P=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:P=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:P=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:P=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(hn(c,P))return h}const ZB=Mr([{name:"a_pos_3f",components:3,type:"Float32"}]),YB=Mr([{name:"a_color_3f",components:3,type:"Float32"}]),XB=Mr([{name:"a_color_4f",components:4,type:"Float32"}]),JB=Mr([{name:"a_uv_2f",components:2,type:"Float32"}]),QB=Mr([{name:"a_normal_3f",components:3,type:"Float32"}]),eN=Mr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),tN=Mr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),QM={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class g0{constructor(n,a,u,g){this.message=(n?`${n}: `:"")+u,g&&(this.identifier=g),a!=null&&a.__line__&&(this.line=a.__line__)}}function eI(c,n){const a=c.indexOf("://")===-1;try{return new URL(c,a&&n?"http://example.com":void 0),!0}catch{return!1}}class tI{constructor(n,a){this.feature=n,this.instancedDataOffset=a,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class nI{constructor(){this.instancedDataArray=new of,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Gx{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(a=>a.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,a){}populate(n,a,u,g){this.tileToMeter=lt(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:T,index:P,sourceLayerIndex:O}of n){const x=T??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),k=pn(v,h);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),k,u))continue;const L={id:x,sourceLayerIndex:O,index:P,geometry:h?k.geometry:It(v,u,g),properties:v.properties,type:v.type,patterns:{}},A=this.addFeature(L,L.geometry,k);A&&a.featureIndex.insert(v,L.geometry,P,O,this.index,this.instancesPerModel[A].instancedDataArray.length,Nn/32)}this.lookup=null}update(n,a,u,g){for(const h in this.instancesPerModel){const v=this.instancesPerModel[h];for(const T in n)v.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(v.features[v.idToFeaturesIndex[T]],n[T],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];for(const g of u.features){const h=this.layers[0],v=g.feature,T=this.canonical,P=h.paint.get("model-rotation").evaluate(v,{},T),O=h.paint.get("model-scale").evaluate(v,{},T),x=h.paint.get("model-translation").evaluate(v,{},T);Le.vec3.exactEquals(g.rotation,P)&&Le.vec3.exactEquals(g.scale,O)&&Le.vec3.exactEquals(g.translation,x)||(this.evaluate(g,g.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,a,u,g){if(a.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=a.updateTime;const h=a.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(gx(this.activeReplacements,h))return!1;this.activeReplacements=h;let v=!1;for(const T in this.instancesPerModel){const P=this.instancesPerModel[T],O=P.instancedDataArray;for(const x of P.features){const k=x.instancedDataOffset,L=x.instancedDataCount;for(let A=0;A<L;A++){const R=16*(A+k);let $=O.float32[R+0];const W=$>Nn;$=W?$-Nn:$;const Y=Math.floor($),re=O.float32[R+1];let ie=!1;for(const Q of this.activeReplacements)if(!vE(Q,u,QM.Model,g)&&!(Q.min.x>Y||Y>Q.max.x||Q.min.y>re||re>Q.max.y)&&(ie=SE(wE(Y,re,n.canonical,Q.footprintTileId.canonical),Q.footprint),ie))break;O.float32[R]=ie?$+Nn:$,v=v||ie!==W}}}return v}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,eN.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const a of this.modelUris)n.removeModel(a,"")}addFeature(n,a,u){const g=this.layers[0],h=g.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return Bn(`modelId is not evaluated for layer ${g.id} and it is not going to get rendered.`),h;eI(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new nI);const v=this.instancesPerModel[h],T=v.instancedDataArray,P=new tI(u,T.length);for(const O of a)for(const x of O){if(x.x<0||x.x>=Nn||x.y<0||x.y>=Nn)continue;const k=(this.lookupDim-1)/Nn,L=this.lookupDim*(x.y*k|0)+x.x*k|0;if(this.lookup){if(this.lookup[L]!==0)continue;this.lookup[L]=1}this.instanceCount++;const A=T.length;T.resize(A+1),v.instancesEvaluatedElevation.push(0),T.float32[16*A]=x.x,T.float32[16*A+1]=x.y}return P.instancedDataCount=v.instancedDataArray.length-P.instancedDataOffset,P.instancedDataCount>0&&(n.id&&(v.idToFeaturesIndex[n.id]=v.features.length),v.features.push(P),this.evaluate(P,{},v,!1)),h}getModelUris(){return this.modelUris}evaluate(n,a,u,g){const h=this.layers[0],v=n.feature,T=this.canonical,P=n.rotation=h.paint.get("model-rotation").evaluate(v,a,T),O=n.scale=h.paint.get("model-scale").evaluate(v,a,T),x=n.translation=h.paint.get("model-translation").evaluate(v,a,T),k=h.paint.get("model-color").evaluate(v,a,T);k.a=h.paint.get("model-color-mix-intensity").evaluate(v,a,T);const L=[];this.maxVerticalOffset<x[2]&&(this.maxVerticalOffset=x[2]),this.maxScale=Math.max(Math.max(this.maxScale,O[0]),Math.max(O[1],O[2])),XM(L,P,O);const A=Math.round(100*k.a)+k.b/1.05;for(let R=0;R<n.instancedDataCount;++R){const $=n.instancedDataOffset+R,W=16*$,Y=u.instancedDataArray.float32;let re=0;g&&(re=Y[W+6]-u.instancesEvaluatedElevation[$]);const ie=0|Y[W+1];Y[W]=(0|Y[W])+k.r/1.05,Y[W+1]=ie+k.g/1.05,Y[W+2]=A,Y[W+3]=1/(T.z>10?this.tileToMeter:lt(T,ie)),Y[W+4]=x[0],Y[W+5]=x[1],Y[W+6]=x[2]+re,Y[W+7]=L[0],Y[W+8]=L[1],Y[W+9]=L[2],Y[W+10]=L[4],Y[W+11]=L[5],Y[W+12]=L[6],Y[W+13]=L[8],Y[W+14]=L[9],Y[W+15]=L[10],u.instancesEvaluatedElevation[$]=x[2]}}}let oI,rI;no(Gx,"ModelBucket",{omit:["layers"]}),no(nI,"PerModelAttributes"),no(tI,"ModelFeature");const hf=64,$p={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function iI(c,n,a,u,g,h,v,T,P,O=!1){const x=a.zoom,k=a.project(u),L=Xe(u.lat,x),A=1/L;Le.mat4.identity(c),Le.mat4.translate(c,c,[k.x+v[0]*A,k.y+v[1]*A,v[2]]);let R=1,$=1;const W=a.worldSize;if(O){if(a.projection.name==="mercator"){let Q=0;a.elevation&&(Q=a.elevation.getAtPointOrZero(new vt(k.x/W,k.y/W),0));const ue=Le.vec4.transformMat4([],[k.x,k.y,Q,1],a.projMatrix)[3]/a.cameraToCenterDistance;R=ue,$=ue*Xe(a.center.lat,x)}else if(a.projection.name==="globe"){const Q=Hx(c,a),ue=Le.mat4.multiply([],a.projMatrix,Q),_e=[0,0,0,1];Le.vec4.transformMat4(_e,_e,ue);const Ie=_e[3]/a.cameraToCenterDistance,Ge=Gd(x),ze=a.projection.pixelsPerMeter(u.lat,W)*Xe(u.lat,x),$e=a.projection.pixelsPerMeter(a.center.lat,W)*Xe(a.center.lat,x);R=Ie/uo(ze,tt(a.center.lat),Ge),$=Ie*L/ze,R*=$e,$*=$e}}else R=A;Le.mat4.scale(c,c,[R,R,$]);const Y=[...c],re=n.orientation,ie=[];if(XM(ie,[re[0]+g[0],re[1]+g[1],re[2]+g[2]],h),Le.mat4.multiply(c,Y,ie),T&&a.elevation){let Q=0;const ue=[];if(P&&a.elevation){Q=function(Ge,ze,$e,st,Fe){const rt=ze.elevation;if(!rt)return 0;const ht=Fr.projectAabbCorners($e,st),pt=Se(1,Fe.lat)*ze.worldSize,Tt=function(wo,Xn){const io=[0,0,1],Uo=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const er of Uo){const tr=wo[er.corners[0]],Zo=wo[er.corners[1]],lr=wo[er.corners[2]],ar=[Zo[0]-tr[0],Zo[1]-tr[1],Xn*(Zo[2]-tr[2])],Qr=Le.vec3.cross(ar,ar,[lr[0]-tr[0],lr[1]-tr[1],Xn*(lr[2]-tr[2])]);Le.vec3.normalize(Qr,Qr),er.dotProductWithUp=Le.vec3.dot(Qr,io)}return Uo.sort((er,tr)=>er.dotProductWithUp-tr.dotProductWithUp),Uo[0].corners}(ht,pt),Lt=ht[Tt[0]],Ft=ht[Tt[1]],Pt=ht[Tt[2]],sn=ht[Tt[3]],Cn=rt.getAtPointOrZero(new vt(Lt[0]/ze.worldSize,Lt[1]/ze.worldSize),0),Jt=rt.getAtPointOrZero(new vt(Ft[0]/ze.worldSize,Ft[1]/ze.worldSize),0),Jn=rt.getAtPointOrZero(new vt(Pt[0]/ze.worldSize,Pt[1]/ze.worldSize),0),Fn=rt.getAtPointOrZero(new vt(sn[0]/ze.worldSize,sn[1]/ze.worldSize),0),Pn=(Cn+Fn)/2,Sn=(Jt+Jn)/2;return Pn>Sn?Jt<Jn?m0(Ge,Ft,sn,Lt,Jt,Fn,Cn,pt):m0(Ge,Pt,Lt,sn,Jn,Cn,Fn,pt):Cn<Fn?m0(Ge,Lt,Ft,Pt,Cn,Jt,Jn,pt):m0(Ge,sn,Pt,Ft,Fn,Jn,Jt,pt),Math.max(Pn,Sn)}(ue,a,n.aabb,c,u);const _e=Le.mat4.fromQuat([],ue),Ie=Le.mat4.multiply([],_e,ie);Le.mat4.multiply(c,Y,Ie)}else Q=a.elevation.getAtPointOrZero(new vt(k.x/W,k.y/W),0);Q!==0&&(c[14]+=Q)}}function _v(c,n,a=!1){c.uploaded||(c.gfxTexture=new Vx(n,c.image,a?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function nN(c,n,a){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,ZB.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,QB.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,JB.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?YB:XB).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,tN.members,!0)),c.segments=ki.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&_v(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&_v(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&_v(u.normalTexture,n),u.occlusionTexture&&_v(u.occlusionTexture,n,a),u.emissionTexture&&_v(u.emissionTexture,n)}function Wx(c,n,a){if(c.meshes)for(const u of c.meshes)nN(u,n,a);if(c.children)for(const u of c.children)Wx(u,n,a)}function v0(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)v0(n)}function qx(c){if(c.meshes)for(const a of c.meshes)a.vertexBuffer&&(a.vertexBuffer.destroy(),a.indexBuffer.destroy(),a.normalBuffer&&a.normalBuffer.destroy(),a.texcoordBuffer&&a.texcoordBuffer.destroy(),a.colorBuffer&&a.colorBuffer.destroy(),a.pbrBuffer&&a.pbrBuffer.destroy(),a.segments.destroy(),a.material&&((n=a.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const a of c.children)qx(a)}class Vp{constructor(n,a,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=a,this._offset=u}static create(n,a,u){const g=u||n.findDEMTileFor(a);if(!g||!g.dem)return;const h=g.dem,v=g.tileID,T=1<<a.canonical.z-v.canonical.z;return new Vp(g,h.dim/Nn/T,[(a.canonical.x/T-v.canonical.x)*h.dim,(a.canonical.y/T-v.canonical.y)*h.dim])}tileCoordToPixel(n,a){const u=a*this._scale+this._offset[1],g=Math.floor(n*this._scale+this._offset[0]),h=Math.floor(u);return new Be(g,h)}getElevationAt(n,a,u,g){const h=n*this._scale+this._offset[0],v=a*this._scale+this._offset[1],T=Math.floor(h),P=Math.floor(v),O=this._dem;return g=!!g,u?uo(uo(O.get(T,P,g),O.get(T,P+1,g),v-P),uo(O.get(T+1,P,g),O.get(T+1,P+1,g),v-P),h-T):O.get(T,P,g)}getElevationAtPixel(n,a,u){return this._dem.get(n,a,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*Se(1,n)*this._dem.stride}}const Kx=new Float32Array(262144),ff=new Uint8Array(262144);function aI(c){let n=0;if(c.meshes)for(const a of c.meshes)n=Math.max(n,a.aabb.max[2]);if(c.children)for(const a of c.children)n=Math.max(n,aI(a));return n}function sI(c,n,a){if(c.meshes)for(const u of c.meshes){if(u.aabb.min[0]===1/0)continue;const g=Fr.applyTransform(u.aabb,c.matrix);a.insert(n,g.min[0],g.min[1],g.max[0],g.max[1])}if(c.children)for(const u of c.children)sI(u,n,a)}const lI=["","wall","door","roof","window","lamp","logo"];class cI{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:aI(n)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const a=new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=Fr.applyTransformFast(u.aabb,this.node.matrix),a.encapsulate(u.transformedAabb)),n++;this.aabb=a}return this.aabb}}class _0{constructor(n,a,u,g,h,v,T){this.id=u,this.layers=n,this.layerIds=this.layers.map(P=>P.fqid),this.stateDependentLayerIds=this.layers.filter(P=>P.isStateDependent()).map(P=>P.id),this.modelTraits|=$p.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,g&&(this.modelTraits|=$p.HasMapboxMeshFeatures),h&&(this.modelTraits|=$p.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const P of a)this.nodesInfo.push(new cI(P)),sI(P,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0)}updateFootprints(n,a){for(const u of this.getNodesInfo()){const g=u.node;g.footprint&&a.push({footprint:g.footprint,id:n})}}update(n){const a=Object.keys(n).length!==0;if(a&&!this.stateDependentLayers.length)return;const u=a?this.stateDependentLayers:this.layers;for(const g of u)this.evaluate(g,n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const a=this.getNodesInfo();for(const u of a){const g=u.node;this.uploaded?this.updatePbrBuffer(g):Wx(g,n,!0)}for(const u of a)v0(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let a=!1;if(!n.meshes)return a;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),a=!0);return a}needsReEvaluation(n,a,u){const g=n.transform.projectionOptions,h=n.style.getBrightness(),v=this.brightness!==h;return!!(!this.uploaded||this.dirty||g.name!==this.projection.name||yv(u.paint.get("model-color").value,v)||yv(u.paint.get("model-color-mix-intensity").value,v)||yv(u.paint.get("model-roughness").value,v)||yv(u.paint.get("model-emissive-strength").value,v)||yv(u.paint.get("model-height-based-emissive-strength-multiplier").value,v))&&(this.projection=g,this.brightness=h,!0)}evaluateScale(n,a){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),g=this.id.canonical;for(const h of u){const v=h.feature;h.evaluatedScale=a.paint.get("model-scale").evaluate(v,{},g)}}evaluate(n,a){const u=this.getNodesInfo();for(const g of u){if(!g.node.meshes)continue;const h=g.feature,v=a&&a[h.id],T=g.node.meshes&&g.node.meshes[0].featureData,P=g.evaluatedColor[2],O=g.evaluatedRMEA[2],x=this.id.canonical;if(g.hasTranslucentParts=!1,T){for(let k=0;k<lI.length;k++){const L=lI[k];L.length&&(h.properties.part=L);const A=n.paint.get("model-color").evaluate(h,v,x).toRenderColor(null),R=n.paint.get("model-color-mix-intensity").evaluate(h,v,x);g.evaluatedColor[k]=[A.r,A.g,A.b,R],g.evaluatedRMEA[k][0]=n.paint.get("model-roughness").evaluate(h,v,x),g.evaluatedRMEA[k][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x),g.evaluatedRMEA[k][3]=A.a,g.emissionHeightBasedParams[k]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,v,x),!g.hasTranslucentParts&&A.a<1&&(g.hasTranslucentParts=!0)}delete h.properties.part,rN(g,P!==g.evaluatedColor[2]||O!==g.evaluatedRMEA[2],this.modelTraits)}else g.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x);g.evaluatedScale=n.paint.get("model-scale").evaluate(h,v,x),this.updatePbrBuffer(g.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,a,u,g){const h=n.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||a!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const v=Vp.create(n,u,h);if(!v)return;this.modelTraits&$p.HasMapboxMeshFeatures&&this.updateDEM(n,v,u,g);for(const T of this.getNodesInfo()){const P=T.node;if(!P.footprint||!P.footprint.vertices||!P.footprint.vertices.length)continue;const O=P.footprint.vertices;let x=v.getElevationAt(O[0].x,O[0].y,!0,!0);for(let k=1;k<O.length;k++)x=Math.min(x,v.getElevationAt(O[k].x,O[k].y,!0,!0));P.elevation=x}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=a}}updateDEM(n,a,u,g){let h=a._dem._modifiedForSources[g];if(h===void 0&&(a._dem._modifiedForSources[g]=[],h=a._dem._modifiedForSources[g]),h.includes(u.canonical))return;const v=a._dem.dim;h.push(u.canonical);let T=!1;for(const P of this.getNodesInfo()){const O=P.node;if(!O.footprint||!O.footprint.grid)continue;const x=O.footprint.grid,k=a.tileCoordToPixel(x.min.x,x.min.y),L=a.tileCoordToPixel(x.max.x,x.max.y),A=Math.min(Math.min(v-L.y,k.x),Math.min(k.y,v-L.x));if(A<0)continue;const R=yt(A,2,5);let $=Math.max(0,k.x-R),W=Math.max(0,k.y-R),Y=Math.min(L.x+R,v-1),re=Math.min(L.y+R,v-1);for(let _e=W;_e<=re;++_e)for(let Ie=$;Ie<=Y;++Ie)ff[_e*v+Ie]=255;let ie=0,Q=0;for(let _e=0;_e<x.cellsY;++_e)for(let Ie=0;Ie<x.cellsX;++Ie){if(!x.cells[_e*x.cellsX+Ie])continue;const Ge=a.tileCoordToPixel(x.min.x+Ie/x.xScale,x.min.y+_e/x.yScale),ze=a.tileCoordToPixel(x.min.x+(Ie+1)/x.xScale,x.min.y+(_e+1)/x.yScale);for(let $e=Ge.y;$e<=Math.min(ze.y+1,v-1);++$e)for(let st=Ge.x;st<=Math.min(ze.x+1,v-1);++st)ff[$e*v+st]===255&&(ff[$e*v+st]=0,ie+=a.getElevationAtPixel(st,$e),Q++)}const ue=ie/Q;$=Math.max(1,k.x-R),W=Math.max(1,k.y-R),Y=Math.min(L.x+R,v-2),re=Math.min(L.y+R,v-2),T=!0;for(let _e=W;_e<=re;++_e)for(let Ie=$;Ie<=Y;++Ie)ff[_e*v+Ie]===0&&(Kx[_e*v+Ie]=a._dem.set(Ie,_e,ue));for(let _e=1;_e<R;++_e){$=Math.max(1,k.x-_e),W=Math.max(1,k.y-_e),Y=Math.min(L.x+_e,v-2),re=Math.min(L.y+_e,v-2);for(let Ie=W;Ie<=re;++Ie)for(let Ge=$;Ge<=Y;++Ge){const ze=Ie*v+Ge;if(ff[ze]===255){let $e=0,st=0,Fe=-1,rt=-1;for(let ht=-1;ht<=1;++ht)for(let pt=-1;pt<=1;++pt){const Tt=(Ie+ht)*v+Ge+pt;if(ff[Tt]>=_e)continue;const Lt=Kx[Tt],Ft=Math.abs(Lt);Ft>st&&($e=Lt,st=Ft,Fe=pt,rt=ht)}if(st>.1){const ht=1-(_e+.5*Math.abs(Fe*rt))/R;let pt=a._dem.get(Ge,Ie)+$e*ht;const Tt=a._dem.get(Ge+Fe,Ie+rt),Lt=a._dem.get(Ge-Fe,Ie-rt,!0);(pt-Tt)*(pt-Lt)>0&&(pt=(Tt+Lt)/2),Kx[ze]=a._dem.set(Ge,Ie,pt),ff[ze]=_e}}}}}T&&(a._demTile.needsDEMTextureUpload=!0,a._dem._timestamp=Yt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const a of n)v0(a.node),qx(a.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(n.toUnwrapped()),g=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const v=g[h].node;g[h].hiddenByReplacement=!!v.footprint&&!u.find(T=>T.footprint===v.footprint)}}getHeightAtTileCoord(n,a){const u=this.getNodesInfo(),g=[],h=[0,0,0],v=Le.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const P=u[T],O=P.node.meshes[0],x=O.transformedAabb;if(n<x.min[0]||a<x.min[1]||n>x.max[0]||a>x.max[1])continue;if(P.node.hidden===!0)return{height:1/0,maxHeight:P.feature.properties.height,hidden:!1,verticalScale:P.evaluatedScale[2]};Le.mat4.invert(v,P.node.matrix),h[0]=n,h[1]=a,Le.vec3.transformMat4(h,h,v);const k=(h[0]-O.aabb.min[0])/(O.aabb.max[0]-O.aabb.min[0])*hf|0,L=Math.min(63,(h[1]-O.aabb.min[1])/(O.aabb.max[1]-O.aabb.min[1])*hf|0)*hf+Math.min(63,k),A=O.heightmap[L];if(!(A<0&&P.node.footprint))return P.hiddenByReplacement?void 0:{height:A,maxHeight:P.feature.properties.height,hidden:!1,verticalScale:P.evaluatedScale[2]};if(P.node.footprint.grid.query(new Be(n,a),new Be(n,a),g),g.length>0)return{height:void 0,maxHeight:P.feature.properties.height,hidden:P.hiddenByReplacement,verticalScale:P.evaluatedScale[2]}}}}function yv(c,n){return!c.isLightConstant&&n}function oN(c,n,a,u,g,h,v,T){let P=(61440&n|(61440&n)>>4)>>8,O=(3840&n|(3840&n)>>4)>>4,x=240&n|(240&n)>>4;a[3]>0&&(P=uo(P,255*a[0],a[3]),O=uo(O,255*a[1],a[3]),x=uo(x,255*a[2],a[3]));const k=P<<8|O,L=x<<8|Math.floor(255*u[3]),A=function(_e){const Ie=yt(_e,0,2);return Math.min(Math.round(.5*Ie*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],R=yt(g[0],0,1),$=yt(g[1],0,1),W=yt(g[2],0,1),Y=yt(g[3],0,1);let re,ie,Q,ue;if(R!==$&&v!==h&&$!==R){const _e=v-h;ie=1/(_e*($-R)),Q=-(h+_e*R)/(_e*($-R));const Ie=yt(g[4],-1,1);ue=Math.pow(10,Ie),re=255*W<<8|255*Y}else re=65535,ie=0,Q=1,ue=1;if(c.emplaceBack(k,L,A,re,ie,Q,ue),T){const _e=T.length;T.clear();for(let Ie=0;Ie<_e;Ie++)T.emplaceBack(k,L,A,re,ie,Q,ue)}}function rN(c,n,a){const u=c.node;let g=0;const h=a&$p.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===g||!v.featureData)continue;v.featureArray=new Cp,v.featureArray.reserve(v.featureData.length);let T=n;for(const P of v.featureData){const O=h?65535&P:P>>16&65535,x=h?P>>16&65535:65535&P,k=(15&x)<8?15&x:0,L=c.evaluatedRMEA[k],A=c.evaluatedColor[k],R=c.emissionHeightBasedParams[k];let $;if(T&&k===2&&u.lights&&($=new Cp,$.resize(10*u.lights.length)),oN(v.featureArray,O,A,L,R,v.aabb.min[2],v.aabb.max[2],$),$&&T){T=!1;const W=u.meshes[u.lightMeshIndex];W.featureArray=$,W.featureArray._trim()}}v.featureArray._trim(),g++}}no(_0,"Tiled3dModelBucket",{omit:["layers"]}),no(cI,"Tiled3dModelFeature");const iN=["id","tile","layer","source","sourceLayer","state"];class bv{constructor(n,a,u,g,h){this.type="Feature",this._vectorTileFeature=n,this._z=a,this._x=u,this._y=g,this.properties=n.properties,this.id=h}clone(){const n=new bv(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state={...this.state}),this.layer&&(n.layer={...this.layer}),this.namespace&&(n.namespace=this.namespace),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const a of iN)this[a]!==void 0&&(n[a]=this[a]);return n}}function uI(c,n,a,u){const g=1<<c.z;n.lat=je((u/Nn+c.y)/g),n.lng=De((a/Nn+c.x)/g)}const aN={circle:class extends Va{constructor(c,n,a,u){super(c,{layout:Or||(Or=new ci({"circle-sort-key":new _o(Ot.layout_circle["circle-sort-key"]),visibility:new Rn(Ot.layout_circle.visibility)})),paint:fi||(fi=new ci({"circle-radius":new _o(Ot.paint_circle["circle-radius"]),"circle-color":new _o(Ot.paint_circle["circle-color"]),"circle-blur":new _o(Ot.paint_circle["circle-blur"]),"circle-opacity":new _o(Ot.paint_circle["circle-opacity"]),"circle-translate":new Rn(Ot.paint_circle["circle-translate"]),"circle-translate-anchor":new Rn(Ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Rn(Ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Rn(Ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _o(Ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _o(Ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _o(Ot.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Rn(Ot.paint_circle["circle-emissive-strength"])}))},n,a,u)}createBucket(c){return new wn(c)}queryRadius(c){const n=c;return Zr("circle-radius",this,n)+Zr("circle-stroke-width",this,n)+sr(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,a,u,g,h,v,T){const P=Ur(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(n,a)+this.paint.get("circle-stroke-width").evaluate(n,a);return UC(c,u,h,v,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,O)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,a){const u=VC(this);return{config:new Pc(this,{zoom:n,lut:a}),defines:u,overrideFog:!1}}},heatmap:class extends Va{createBucket(c){return new HC(c)}constructor(c,n,a,u){super(c,{layout:GC||(GC=new ci({visibility:new Rn(Ot.layout_heatmap.visibility)})),paint:WC||(WC=new ci({"heatmap-radius":new _o(Ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _o(Ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Rn(Ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Od(Ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Rn(Ot.paint_heatmap["heatmap-opacity"])}))},n,a,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Jg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Zr("heatmap-radius",this,c)}queryIntersectsFeature(c,n,a,u,g,h,v,T){const P=this.paint.get("heatmap-radius").evaluate(n,a);return UC(c,u,h,v,T,!0,!0,new Be(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,a){return c==="heatmap"?{config:new Pc(this,{zoom:n,lut:a}),overrideFog:!1}:{}}},hillshade:class extends Va{constructor(c,n,a,u){super(c,{layout:qC||(qC=new ci({visibility:new Rn(Ot.layout_hillshade.visibility)})),paint:KC||(KC=new ci({"hillshade-illumination-direction":new Rn(Ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Rn(Ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Rn(Ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Rn(Ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Rn(Ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Rn(Ot.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Rn(Ot.paint_hillshade["hillshade-emissive-strength"])}))},n,a,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,a){return{overrideFog:!1}}},fill:class extends Va{constructor(c,n,a,u){super(c,{layout:nE||(nE=new ci({"fill-sort-key":new _o(Ot.layout_fill["fill-sort-key"]),visibility:new Rn(Ot.layout_fill.visibility),"fill-elevation-reference":new Rn(Ot.layout_fill["fill-elevation-reference"])})),paint:oE||(oE=new ci({"fill-antialias":new Rn(Ot.paint_fill["fill-antialias"]),"fill-opacity":new _o(Ot.paint_fill["fill-opacity"]),"fill-color":new _o(Ot.paint_fill["fill-color"]),"fill-outline-color":new _o(Ot.paint_fill["fill-outline-color"]),"fill-translate":new Rn(Ot.paint_fill["fill-translate"]),"fill-translate-anchor":new Rn(Ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new _o(Ot.paint_fill["fill-pattern"]),"fill-emissive-strength":new Rn(Ot.paint_fill["fill-emissive-strength"]),"fill-z-offset":new _o(Ot.paint_fill["fill-z-offset"])}))},n,a,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),a=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getDefaultProgramParams(c,n,a){return{config:new Pc(this,{zoom:n,lut:a}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new ux(c)}queryRadius(){return sr(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,a,u,g,h){return!c.queryGeometry.isAboveHorizon&&fo(Gr(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Va{constructor(c,n,a,u){super(c,{layout:BE||(BE=new ci({visibility:new Rn(Ot["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Rn(Ot["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:NE||(NE=new ci({"fill-extrusion-opacity":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new _o(Ot["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Rn(Ot["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},n,a,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Zy(c)}queryRadius(){return sr(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,a,u,g,h,v,T,P){const O=Ur(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),x=this.paint.get("fill-extrusion-height").evaluate(n,a),k=this.paint.get("fill-extrusion-base").evaluate(n,a),L=[0,0],A=T&&h.elevation,R=h.elevation?h.elevation.exaggeration():1,$=c.tile.getBucket(this);if(A&&$ instanceof Zy){const Q=$.centroidVertexArray,ue=P+1;ue<Q.length&&(L[0]=Q.geta_centroid_pos0(ue),L[1]=Q.geta_centroid_pos1(ue))}if(L[0]===0&&L[1]===1)return!1;h.projection.name==="globe"&&(u=FE([u],[new Be(0,0),new Be(Nn,Nn)],c.tileID.canonical).map(Q=>Q.polygon).flat());const W=A?T:null,[Y,re]=function(Q,ue,_e,Ie,Ge,ze,$e,st,Fe,rt,ht){return Q.projection.name==="globe"?function(pt,Tt,Lt,Ft,Pt,sn,Cn,Jt,Jn,Fn,Pn){const Sn=[],wo=[],Xn=pt.projection.upVectorScale(Pn,pt.center.lat,pt.worldSize).metersToTile,io=[0,0,0,1],Uo=[0,0,0,1],er=(Zo,lr,ar,Qr)=>{Zo[0]=lr,Zo[1]=ar,Zo[2]=Qr,Zo[3]=1},tr=zE();Lt>0&&(Lt+=tr),Ft+=tr;for(const Zo of Tt){const lr=[],ar=[];for(const Qr of Zo){const Wr=Qr.x+Pt.x,Bo=Qr.y+Pt.y,Dr=pt.projection.projectTilePoint(Wr,Bo,Pn),Br=pt.projection.upVector(Pn,Qr.x,Qr.y);let mi=Lt,Di=Ft;if(Cn){const qi=VE(Wr,Bo,Lt,Ft,Cn,Jt,Jn,Fn);mi+=qi.base,Di+=qi.top}Lt!==0?er(io,Dr.x+Br[0]*Xn*mi,Dr.y+Br[1]*Xn*mi,Dr.z+Br[2]*Xn*mi):er(io,Dr.x,Dr.y,Dr.z),er(Uo,Dr.x+Br[0]*Xn*Di,Dr.y+Br[1]*Xn*Di,Dr.z+Br[2]*Xn*Di),Le.vec3.transformMat4(io,io,sn),Le.vec3.transformMat4(Uo,Uo,sn),lr.push(new df(io[0],io[1],io[2])),ar.push(new df(Uo[0],Uo[1],Uo[2]))}Sn.push(lr),wo.push(ar)}return[Sn,wo]}(Q,ue,_e,Ie,Ge,ze,$e,st,Fe,rt,ht):$e?function(pt,Tt,Lt,Ft,Pt,sn,Cn,Jt,Jn){const Fn=[],Pn=[],Sn=[0,0,0,1];for(const wo of pt){const Xn=[],io=[];for(const Uo of wo){const er=Uo.x+Ft.x,tr=Uo.y+Ft.y,Zo=VE(er,tr,Tt,Lt,sn,Cn,Jt,Jn);Sn[0]=er,Sn[1]=tr,Sn[2]=Zo.base,Sn[3]=1,Le.vec4.transformMat4(Sn,Sn,Pt),Sn[3]=Math.max(Sn[3],1e-5);const lr=new df(Sn[0]/Sn[3],Sn[1]/Sn[3],Sn[2]/Sn[3]);Sn[0]=er,Sn[1]=tr,Sn[2]=Zo.top,Sn[3]=1,Le.vec4.transformMat4(Sn,Sn,Pt),Sn[3]=Math.max(Sn[3],1e-5);const ar=new df(Sn[0]/Sn[3],Sn[1]/Sn[3],Sn[2]/Sn[3]);Xn.push(lr),io.push(ar)}Fn.push(Xn),Pn.push(io)}return[Fn,Pn]}(ue,_e,Ie,Ge,ze,$e,st,Fe,rt):function(pt,Tt,Lt,Ft,Pt){const sn=[],Cn=[],Jt=Pt[8]*Tt,Jn=Pt[9]*Tt,Fn=Pt[10]*Tt,Pn=Pt[11]*Tt,Sn=Pt[8]*Lt,wo=Pt[9]*Lt,Xn=Pt[10]*Lt,io=Pt[11]*Lt;for(const Uo of pt){const er=[],tr=[];for(const Zo of Uo){const lr=Zo.x+Ft.x,ar=Zo.y+Ft.y,Qr=Pt[0]*lr+Pt[4]*ar+Pt[12],Wr=Pt[1]*lr+Pt[5]*ar+Pt[13],Bo=Pt[2]*lr+Pt[6]*ar+Pt[14],Dr=Pt[3]*lr+Pt[7]*ar+Pt[15],Br=Qr+Jt,mi=Wr+Jn,Di=Bo+Fn,qi=Math.max(Dr+Pn,1e-5),zi=Qr+Sn,Ii=Wr+wo,Ni=Bo+Xn,Xi=Math.max(Dr+io,1e-5);er.push(new df(Br/qi,mi/qi,Di/qi)),tr.push(new df(zi/Xi,Ii/Xi,Ni/Xi))}sn.push(er),Cn.push(tr)}return[sn,Cn]}(ue,_e,Ie,Ge,ze)}(h,u,k,x,O,v,W,L,R,h.center.lat,c.tileID.canonical),ie=c.queryGeometry;return function(Q,ue,_e){let Ie=1/0;fo(_e,ue)&&(Ie=$E(_e,ue[0]));for(let Ge=0;Ge<ue.length;Ge++){const ze=ue[Ge],$e=Q[Ge];for(let st=0;st<ze.length-1;st++){const Fe=ze[st],rt=[Fe,ze[st+1],$e[st+1],$e[st],Fe];hn(_e,rt)&&(Ie=Math.min(Ie,$E(_e,rt)))}}return Ie!==1/0&&Ie}(Y,re,ie.isPointQuery()?ie.screenBounds:ie.screenGeometry)}},line:class extends Va{constructor(c,n,a,u){const g=XE();super(c,g,n,a,u),g.layout&&(this.layout=new Ld(g.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Nl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(sv)return sv;const a=XE();return sv=new lB(a.paint.properties["line-width"].specification),sv.useIntegerZoom=!0,sv})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new bx(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,a){const u=ZE(this);return{config:new Pc(this,{zoom:n,lut:a}),defines:u,overrideFog:!1}}queryRadius(c){const n=c,a=JE(Zr("line-width",this,n),Zr("line-gap-width",this,n)),u=Zr("line-offset",this,n);return a/2+Math.abs(u)+sr(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,a,u,g,h){if(c.queryGeometry.isAboveHorizon)return!1;const v=Gr(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),T=c.pixelToTileUnitsFactor/2*JE(this.paint.get("line-width").evaluate(n,a),this.paint.get("line-gap-width").evaluate(n,a)),P=this.paint.get("line-offset").evaluate(n,a);return P&&(u=function(O,x){const k=[],L=new Be(0,0);for(let A=0;A<O.length;A++){const R=O[A],$=[];for(let W=0;W<R.length;W++){const Y=R[W],re=R[W+1],ie=W===0?L:Y.sub(R[W-1])._unit()._perp(),Q=W===R.length-1?L:re.sub(Y)._unit()._perp(),ue=ie._add(Q)._unit();ue._mult(1/(ue.x*Q.x+ue.y*Q.y)),$.push(ue._mult(x)._add(Y))}k.push($)}return k}(u,P*c.pixelToTileUnitsFactor)),function(O,x,k){for(let L=0;L<x.length;L++){const A=x[L];if(O.length>=3){for(let R=0;R<A.length;R++)if(mr(O,A[R]))return!0}if(xo(O,A,k))return!0}return!1}(v,u,T)}isTileClipped(){return!0}isDraped(c){const n=this.layout.get("line-z-offset"),a=n.isConstant()&&!n.constantOr(0),u=this.layout.get("line-elevation-reference");return!(u==="sea"||u==="ground")&&(a||u!=="none")}},symbol:u0,background:class extends Va{constructor(c,n,a,u){super(c,{layout:DM||(DM=new ci({visibility:new Rn(Ot.layout_background.visibility)})),paint:zM||(zM=new ci({"background-pitch-alignment":new Rn(Ot.paint_background["background-pitch-alignment"]),"background-color":new Rn(Ot.paint_background["background-color"]),"background-pattern":new Rn(Ot.paint_background["background-pattern"]),"background-opacity":new Rn(Ot.paint_background["background-opacity"]),"background-emissive-strength":new Rn(Ot.paint_background["background-emissive-strength"])}))},n,a,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,a){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:VM,"raster-particle":qM,sky:class extends Va{constructor(c,n,a,u){super(c,{layout:HM||(HM=new ci({visibility:new Rn(Ot.layout_sky.visibility)})),paint:GM||(GM=new ci({"sky-type":new Rn(Ot.paint_sky["sky-type"]),"sky-atmosphere-sun":new Rn(Ot.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Rn(Ot.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Rn(Ot.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Rn(Ot.paint_sky["sky-gradient-radius"]),"sky-gradient":new Od(Ot.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Rn(Ot.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Rn(Ot.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Rn(Ot.paint_sky["sky-opacity"])}))},n,a,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Jg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),g=!u,h=c.style.light,v=h.properties.get("position");return g&&h.properties.get("anchor")==="viewport"&&Bn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?Ux(v.azimuthal,90-v.polar,n):Ux(u[0],90-u[1],n)}const a=this.paint.get("sky-gradient-center");return Ux(a[0],90-a[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Va{constructor(c,n,a,u){super(c,{paint:WM||(WM=new ci({}))},n,null)}},model:class extends Va{constructor(c,n,a,u){super(c,{layout:oI||(oI=new ci({visibility:new Rn(Ot.layout_model.visibility),"model-id":new _o(Ot.layout_model["model-id"])})),paint:rI||(rI=new ci({"model-opacity":new Rn(Ot.paint_model["model-opacity"]),"model-rotation":new _o(Ot.paint_model["model-rotation"]),"model-scale":new _o(Ot.paint_model["model-scale"]),"model-translation":new _o(Ot.paint_model["model-translation"]),"model-color":new _o(Ot.paint_model["model-color"]),"model-color-mix-intensity":new _o(Ot.paint_model["model-color-mix-intensity"]),"model-type":new Rn(Ot.paint_model["model-type"]),"model-cast-shadows":new Rn(Ot.paint_model["model-cast-shadows"]),"model-receive-shadows":new Rn(Ot.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Rn(Ot.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new _o(Ot.paint_model["model-emissive-strength"]),"model-roughness":new _o(Ot.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new _o(Ot.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Rn(Ot.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Rn(Ot.paint_model["model-front-cutoff"])}))},n,a,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Gx(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof _0?Nn-1:0}queryIntersectsFeature(c,n,a,u,g,h){if(!this.modelManager)return!1;const v=this.modelManager,T=c.tile.getBucket(this);if(!(T&&T instanceof Gx))return!1;const P=T;for(const O in P.instancesPerModel){const x=P.instancesPerModel[O],k=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(x.idToFeaturesIndex.hasOwnProperty(k)){const L=x.features[x.idToFeaturesIndex[k]],A=v.getModel(O,this.scope);if(!A)return!1;let R=Le.mat4.create();const $=new H(0,0),W=P.canonical;let Y=Number.MAX_VALUE;for(let re=0;re<L.instancedDataCount;++re){const ie=16*(L.instancedDataOffset+re),Q=x.instancedDataArray.float32,ue=[Q[ie+4],Q[ie+5],Q[ie+6]];uI(W,$,Q[ie],0|Q[ie+1]),iI(R,A,h,$,L.rotation,L.scale,ue,!1,!1,!1),h.projection.name==="globe"&&(R=Hx(R,h));const _e=Le.mat4.multiply([],h.projMatrix,R),Ie=c.queryGeometry,Ge=JM(Ie.isPointQuery()?Ie.screenBounds:Ie.screenGeometry,h,_e,A.aabb);Ge!=null&&(Y=Math.min(Ge,Y))}return Y!==Number.MAX_VALUE&&Y}}return!1}_handleOverridablePaintPropertyUpdate(c,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Wh}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(c,n,a,u){const g=c.tile,h=g.getBucket(this);let v=null,T=Number.MAX_VALUE;if(!(h&&h instanceof _0))return{queryFeature:v,intersectionZ:T};const P=h.getNodesInfo()[n];if(P.hiddenByReplacement||!P.node.meshes||!a.filter(new Ei(g.tileID.overscaledZ),P.feature,g.tileID.canonical))return{queryFeature:v,intersectionZ:T};const O=P.node,x=u.calculatePosMatrix(g.tileID.toUnwrapped(),u.worldSize),k=P.evaluatedScale;let L=0;u.elevation&&O.elevation&&(L=O.elevation*u.elevation.exaggeration()),Le.mat4.translate(x,x,[(O.anchor?O.anchor[0]:0)*(k[0]-1),(O.anchor?O.anchor[1]:0)*(k[1]-1),L]),Le.mat4.scale(x,x,k);const A=c.queryGeometry,R=A.isPointQuery()?A.screenBounds:A.screenGeometry,$=function(Q){const ue=Le.mat4.multiply([],x,Q.matrix);Le.mat4.multiply(ue,u.expandedFarZProjMatrix,ue);for(let _e=0;_e<Q.meshes.length;++_e){const Ie=Q.meshes[_e];if(_e===Q.lightMeshIndex)continue;const Ge=JM(R,u,ue,Ie.aabb);Ge!=null&&(T=Math.min(Ge,T))}if(Q.children)for(const _e of Q.children)$(_e)};if($(O),T===Number.MAX_VALUE)return{queryFeature:v,intersectionZ:T};const W=new H(0,0);uI(g.tileID.canonical,W,P.node.anchor[0],P.node.anchor[1]);const{z:Y,x:re,y:ie}=g.tileID.canonical;return v=new bv({},Y,re,ie,P.feature.id),v.properties=P.feature.properties,v.geometry={type:"Point",coordinates:[W.lng,W.lat]},v.layer={...this.serialize(),id:this.fqid},v.state={},v.tile=g.tileID.canonical,{queryFeature:v,intersectionZ:T}}},clip:class extends Va{constructor(c,n,a,u){super(c,{layout:rE||(rE=new ci({"clip-layer-types":new Rn(Ot.layout_clip["clip-layer-types"]),"clip-layer-scope":new Rn(Ot.layout_clip["clip-layer-scope"])})),paint:iE||(iE=new ci({}))},n,a,u)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new aE(c)}isTileClipped(){return!0}is3D(){return!0}}};class sN{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class lN{constructor(){this.tasks={},this.taskQueue=[],Dt(["process"],this),this.invoker=new sN(this.process),this.nextId=0}add(n,a){const u=this.nextId++,g=function({type:h,isSymbolTile:v,zoom:T}){return T=T||0,h==="message"?0:h!=="maybePrepare"||v?h!=="parseTile"||v?h==="parseTile"&&v?300-T:h==="maybePrepare"&&v?400-T:500:200-T:100-T}(a);if(g===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:a,priority:g,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const a=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let n=null,a=1/0;for(let g=0;g<this.taskQueue.length;g++){const h=this.tasks[this.taskQueue[g]];h.priority<a&&(a=h.priority,n=g)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class dI{constructor(n,a,u){this.target=n,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Dt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new lN}send(n,a,u,g,h=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[T]=u);const P=new Set;return this.target.postMessage({id:T,type:n,hasCallback:!!u,targetMapId:g,mustQueue:h,sourceMapId:this.mapId,data:Uu(a,P)},P),{cancel:()=>{u&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(n){const a=n.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const g=this.cancelCallbacks[u];delete this.cancelCallbacks[u],g&&g.cancel()}else if(a.mustQueue||Er()){const g=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,a),g&&g.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,a)}processTask(n,a){if(delete this.cancelCallbacks[n],a.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(a.error?u(os(a.error)):u(null,os(a.data)))}else{const u=new Set,g=a.hasCallback?(v,T)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:v?Uu(v):null,data:Uu(T,u)},u)}:()=>{},h=os(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,h,g);else if(this.parent.getWorkerSource){const v=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,v[0],h.source,h.scope)[v[1]](h,g)}else g(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Up{constructor(n,a){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=Ho();const u=this.workerPool.acquire(this.id);for(let g=0;g<u.length;g++){const h=new Up.Actor(u[g],a,this.id);h.name=`Worker ${g}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,a,u){Co(this.actors,(g,h)=>{g.send(n,a,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}Up.Actor=dI;class hI{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,a){const u=this.toIdx(n,a);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,a){return this.leaves[this.toIdx(n,a)]}toIdx(n,a){return a*this.size+n}}function fI(c,n,a,u){let g=0,h=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(a[v]<c[v]||a[v]>n[v])return null}else{const T=1/u[v];let P=(c[v]-a[v])*T,O=(n[v]-a[v])*T;if(P>O){const x=P;P=O,O=x}if(P>g&&(g=P),O<h&&(h=O),g>h)return null}return g}function pI(c,n,a,u,g,h,v,T,P,O,x){const k=u-c,L=g-n,A=h-a,R=v-c,$=T-n,W=P-a,Y=x[1]*W-x[2]*$,re=x[2]*R-x[0]*W,ie=x[0]*$-x[1]*R,Q=k*Y+L*re+A*ie;if(Math.abs(Q)<1e-15)return null;const ue=1/Q,_e=O[0]-c,Ie=O[1]-n,Ge=O[2]-a,ze=(_e*Y+Ie*re+Ge*ie)*ue;if(ze<0||ze>1)return null;const $e=Ie*A-Ge*L,st=Ge*k-_e*A,Fe=_e*L-Ie*k,rt=(x[0]*$e+x[1]*st+x[2]*Fe)*ue;return rt<0||ze+rt>1?null:(R*$e+$*st+W*Fe)*ue}function mI(c,n,a){return(c-n)/(a-n)}function gI(c,n,a,u,g,h,v,T,P){const O=1<<a,x=h-u,k=v-g,L=(c+1)/O*x+u,A=(n+0)/O*k+g,R=(n+1)/O*k+g;T[0]=(c+0)/O*x+u,T[1]=A,P[0]=L,P[1]=R}class vI{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(h){const v=Math.ceil(Math.log2(h.dim/8)),T=[];let P=Math.ceil(Math.pow(2,v));const O=1/P,x=(A,R,$,W,Y)=>{const re=W?1:0,ie=(A+1)*$-re,Q=R*$,ue=(R+1)*$-re;Y[0]=A*$,Y[1]=Q,Y[2]=ie,Y[3]=ue};let k=new hI(P);const L=[];for(let A=0;A<P*P;A++){x(A%P,Math.floor(A/P),O,!1,L);const R=Jd(L[0],L[1],h),$=Jd(L[2],L[1],h),W=Jd(L[2],L[3],h),Y=Jd(L[0],L[3],h);k.minimums.push(Math.min(R,$,W,Y)),k.maximums.push(Math.max(R,$,W,Y)),k.leaves.push(1)}for(T.push(k),P/=2;P>=1;P/=2){const A=T[T.length-1];k=new hI(P);for(let R=0;R<P*P;R++){x(R%P,Math.floor(R/P),2,!0,L);const $=A.getElevation(L[0],L[1]),W=A.getElevation(L[2],L[1]),Y=A.getElevation(L[2],L[3]),re=A.getElevation(L[0],L[3]),ie=A.isLeaf(L[0],L[1]),Q=A.isLeaf(L[2],L[1]),ue=A.isLeaf(L[2],L[3]),_e=A.isLeaf(L[0],L[3]),Ie=Math.min($.min,W.min,Y.min,re.min),Ge=Math.max($.max,W.max,Y.max,re.max),ze=ie&&Q&&ue&&_e;k.maximums.push(Ge),k.minimums.push(Ie),k.leaves.push(Ge-Ie<=5&&ze?1:0)}T.push(k)}return T}(this.dem),u=a.length-1,g=a[u];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(a,0,0,u,0)}raycastRoot(n,a,u,g,h,v,T=1){return fI([n,a,-100],[u,g,this.maximums[0]*T],h,v)}raycast(n,a,u,g,h,v,T=1){if(!this.nodeCount)return null;const P=this.raycastRoot(n,a,u,g,h,v,T);if(P==null)return null;const O=[],x=[],k=[],L=[],A=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;A.length>0;){const{idx:R,t:$,nodex:W,nodey:Y,depth:re}=A.pop();if(this.leaves[R]){gI(W,Y,re,n,a,u,g,k,L);const Q=1<<re,ue=(W+0)/Q,_e=(W+1)/Q,Ie=(Y+0)/Q,Ge=(Y+1)/Q,ze=Jd(ue,Ie,this.dem)*T,$e=Jd(_e,Ie,this.dem)*T,st=Jd(_e,Ge,this.dem)*T,Fe=Jd(ue,Ge,this.dem)*T,rt=pI(k[0],k[1],ze,L[0],k[1],$e,L[0],L[1],st,h,v),ht=pI(L[0],L[1],st,k[0],L[1],Fe,k[0],k[1],ze,h,v),pt=Math.min(rt!==null?rt:Number.MAX_VALUE,ht!==null?ht:Number.MAX_VALUE);if(pt!==Number.MAX_VALUE)return pt;{const Tt=Le.vec3.scaleAndAdd([],h,v,$);if(_I(ze,$e,Fe,st,mI(Tt[0],k[0],L[0]),mI(Tt[1],k[1],L[1]))>=Tt[2])return $}continue}let ie=0;for(let Q=0;Q<this._siblingOffset.length;Q++){gI((W<<1)+this._siblingOffset[Q][0],(Y<<1)+this._siblingOffset[Q][1],re+1,n,a,u,g,k,L),k[2]=-100,L[2]=this.maximums[this.childOffsets[R]+Q]*T;const ue=fI(k,L,h,v);if(ue!=null){const _e=ue;O[Q]=_e;let Ie=!1;for(let Ge=0;Ge<ie&&!Ie;Ge++)_e>=O[x[Ge]]&&(x.splice(Ge,0,Q),Ie=!0);Ie||(x[ie]=Q),ie++}}for(let Q=0;Q<ie;Q++){const ue=x[Q];A.push({idx:this.childOffsets[R]+ue,t:O[ue],nodex:(W<<1)+this._siblingOffset[ue][0],nodey:(Y<<1)+this._siblingOffset[ue][1],depth:re+1})}}return null}_addNode(n,a,u){return this.minimums.push(n),this.maximums.push(a),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,a,u,g,h){if(n[g].isLeaf(a,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const v=g-1,T=n[v];let P=0,O=0;for(let x=0;x<this._siblingOffset.length;x++){const k=2*a+this._siblingOffset[x][0],L=2*u+this._siblingOffset[x][1],A=T.getElevation(k,L),R=T.isLeaf(k,L),$=this._addNode(A.min,A.max,R);R&&(P|=1<<x),O||(O=$)}for(let x=0;x<this._siblingOffset.length;x++)P&1<<x||this._construct(n,2*a+this._siblingOffset[x][0],2*u+this._siblingOffset[x][1],v,O+x)}}function _I(c,n,a,u,g,h){return uo(uo(c,a,h),uo(n,u,h),g)}function Jd(c,n,a){const u=a.dim,g=yt(c*u-.5,0,u-1),h=yt(n*u-.5,0,u-1),v=Math.floor(g),T=Math.floor(h),P=Math.min(v+1,u-1),O=Math.min(T+1,u-1);return _I(a.get(v,T),a.get(P,T),a.get(v,O),a.get(P,O),g-v,h-T)}const cN={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function uN(c,n,a){return(256*c*256+256*n+a)/10-1e4}function dN(c,n,a){return 256*c+n+a/256-32768}class y0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,a,u,g=!1){if(this.uid=n,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void Bn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const h=this.dim=a.height-2,v=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.floatView=new Float32Array(a.data.buffer),this.borderReady=g,this._modifiedForSources={},!g){for(let P=0;P<h;P++)v[this._idx(-1,P)]=v[this._idx(0,P)],v[this._idx(h,P)]=v[this._idx(h-1,P)],v[this._idx(P,-1)]=v[this._idx(P,0)],v[this._idx(P,h)]=v[this._idx(P,h-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(h,-1)]=v[this._idx(h-1,0)],v[this._idx(-1,h)]=v[this._idx(0,h-1)],v[this._idx(h,h)]=v[this._idx(h-1,h-1)]}const T=u==="terrarium"?dN:uN;for(let P=0;P<v.length;++P){const O=4*P;this.floatView[P]=T(this.pixels[O],this.pixels[O+1],this.pixels[O+2])}this._timestamp=Yt.now()}_buildQuadTree(){this._tree=new vI(this)}get(n,a,u=!1){u&&(n=yt(n,-1,this.dim),a=yt(a,-1,this.dim));const g=this._idx(n,a);return this.floatView[g]}set(n,a,u){const g=this._idx(n,a),h=this.floatView[g];return this.floatView[g]=u,u-h}static getUnpackVector(n){return cN[n]}_idx(n,a){if(n<-1||n>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(n+1)}static pack(n,a){const u=[0,0,0,0],g=y0.getUnpackVector(a);let h=Math.floor((n+g[3])/g[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new XC({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,a,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let g=a*this.dim,h=a*this.dim+this.dim,v=u*this.dim,T=u*this.dim+this.dim;switch(a){case-1:g=h-1;break;case 1:h=g+1}switch(u){case-1:v=T-1;break;case 1:T=v+1}const P=-a*this.dim,O=-u*this.dim;for(let x=v;x<T;x++)for(let k=g;k<h;k++){const L=4*this._idx(k,x),A=4*this._idx(k+P,x+O);this.pixels[L+0]=n.pixels[A+0],this.pixels[L+1]=n.pixels[A+1],this.pixels[L+2]=n.pixels[A+2],this.pixels[L+3]=n.pixels[A+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function hN(c,n,a){c===1?n.headerLength=a.readFixed32():c===2?n.x=a.readVarint():c===3?n.y=a.readVarint():c===4?n.z=a.readVarint():c===5&&n.layers.push(function(u,g){return u.readFields(vN,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},g)}(a,a.readVarint()+a.pos))}function fN(c,n,a){c===1?(n.delta_filter=function(u,g){return u.readFields(pN,{blockSize:0},g)}(a,a.readVarint()+a.pos),n.filter="delta_filter"):c===2?(a.readVarint(),n.filter="zigzag_filter"):c===3?(a.readVarint(),n.filter="bitshuffle_filter"):c===4&&(a.readVarint(),n.filter="byteshuffle_filter")}function pN(c,n,a){c===1&&(n.blockSize=a.readVarint())}function mN(c,n,a){c===1?(a.readVarint(),n.codec="gzip_data"):c===2?(a.readVarint(),n.codec="jpeg_image"):c===3?(a.readVarint(),n.codec="webp_image"):c===4&&(a.readVarint(),n.codec="png_image")}function gN(c,n,a){let u=0,g=0;c===1?n.firstByte=a.readFixed64():c===2?n.lastByte=a.readFixed64():c===3?n.filters.push(function(h,v){return h.readFields(fN,{},v)}(a,a.readVarint()+a.pos)):c===4?n.codec=function(h,v){return h.readFields(mN,{},v)}(a,a.readVarint()+a.pos):c===5?g=a.readFloat():c===6?u=a.readFloat():c===7?n.bands.push(a.readString()):c===8?n.offset=a.readDouble():c===9&&(n.scale=a.readDouble()),n.offset===0&&(n.offset=g),n.scale===0&&(n.scale=u)}function vN(c,n,a){c===1?n.version=a.readVarint():c===2?n.name=a.readString():c===3?n.units=a.readString():c===4?n.tileSize=a.readVarint():c===5?n.buffer=a.readVarint():c===6?n.pixelFormat=a.readVarint():c===7&&n.dataIndex.push(function(u,g){return u.readFields(gN,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},g)}(a,a.readVarint()+a.pos))}function _N(c,n,a){if(c===2)(function(u,g,h){u.readFields(yN,h,g)})(a,a.readVarint()+a.pos,n);else if(c===3)throw new Error("Not implemented")}function yN(c,n,a){if(c===1){let u=0;const g=a.readVarint()+a.pos;for(;a.pos<g;)n[u++]=a.readVarint()}}no(y0,"DEMData"),no(vI,"DemMinMaxQuadTree",{omit:["dem"]});class bN{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const a=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,a),a}put(n,a){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,a)}}function xN(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let a=n[3];for(let u=2;u>=1;u--){const g=u===1?1:0,h=u===2?1:0;for(let v=0;v<n[0];v++){const T=n[1]*v;for(let P=g;P<n[1];P++){const O=n[2]*(P+T);for(let x=h;x<n[2];x++){const k=n[3]*(x+O);for(let L=0;L<n[3];L++){const A=k+L;c[A]+=c[A-a]}}}}a*=n[u]}return c}function wN(c){for(let n=0,a=c.length;n<a;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function SN(c,n){switch(n){case"uint32":return c;case"uint16":for(let a=0;a<c.length;a+=2){const u=c[a],g=c[a+1];c[a]=(240&u)>>4|(61440&u)>>8|(240&g)<<4|61440&g,c[a+1]=15&u|(3840&u)>>4|(15&g)<<8|(3840&g)<<4}return c;case"uint8":for(let a=0;a<c.length;a+=4){const u=c[a],g=c[a+1],h=c[a+2],v=c[a+3];c[a+0]=(192&u)>>6|(192&g)>>4|(192&h)>>2|192&v,c[a+1]=(48&u)>>4|(48&g)>>2|48&h|(48&v)<<2,c[a+2]=(12&u)>>2|12&g|(12&h)<<2|(12&v)<<4,c[a+3]=3&u|(3&g)<<2|(3&h)<<4|(3&v)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}var yl=Uint8Array,xv=Uint16Array,TN=Int32Array,yI=new yl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bI=new yl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),CN=new yl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xI=function(c,n){for(var a=new xv(31),u=0;u<31;++u)a[u]=n+=1<<c[u-1];var g=new TN(a[30]);for(u=1;u<30;++u)for(var h=a[u];h<a[u+1];++h)g[h]=h-a[u]<<5|u;return{b:a,r:g}},wI=xI(yI,2),SI=wI.b,EN=wI.r;SI[28]=258,EN[258]=28;for(var MN=xI(bI,0).b,TI=new xv(32768),Wi=0;Wi<32768;++Wi){var jp=(43690&Wi)>>1|(21845&Wi)<<1;TI[Wi]=((65280&(jp=(61680&(jp=(52428&jp)>>2|(13107&jp)<<2))>>4|(3855&jp)<<4))>>8|(255&jp)<<8)>>1}var wv=function(c,n,a){for(var u=c.length,g=0,h=new xv(n);g<u;++g)c[g]&&++h[c[g]-1];var v,T=new xv(n);for(g=1;g<n;++g)T[g]=T[g-1]+h[g-1]<<1;v=new xv(1<<n);var P=15-n;for(g=0;g<u;++g)if(c[g])for(var O=g<<4|c[g],x=n-c[g],k=T[c[g]-1]++<<x,L=k|(1<<x)-1;k<=L;++k)v[TI[k]>>P]=O;return v},Sv=new yl(288);for(Wi=0;Wi<144;++Wi)Sv[Wi]=8;for(Wi=144;Wi<256;++Wi)Sv[Wi]=9;for(Wi=256;Wi<280;++Wi)Sv[Wi]=7;for(Wi=280;Wi<288;++Wi)Sv[Wi]=8;var CI=new yl(32);for(Wi=0;Wi<32;++Wi)CI[Wi]=5;var IN=wv(Sv,9),AN=wv(CI,5),Zx=function(c){for(var n=c[0],a=1;a<c.length;++a)c[a]>n&&(n=c[a]);return n},Dc=function(c,n,a){var u=n/8|0;return(c[u]|c[u+1]<<8)>>(7&n)&a},Yx=function(c,n){var a=n/8|0;return(c[a]|c[a+1]<<8|c[a+2]<<16)>>(7&n)},kN=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],zc=function(c,n,a){var u=new Error(n||kN[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,zc),!a)throw u;return u},PN=new yl(0),RN=typeof TextDecoder<"u"&&new TextDecoder;try{RN.decode(PN,{stream:!0})}catch{}const LN={gzip_data:"gzip"};class Gl extends Error{constructor(n){super(n),this.name="MRTError"}}const ON={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},EI={uint32:1,uint16:2,uint8:4},DN={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Xx;class Jx{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const a=this.layers[n];if(!a)throw new Gl(`Layer '${n}' not found`);return a}getHeaderLength(n){const a=new Uint8Array(n),u=new DataView(n);if(a[0]!==13)throw new Gl("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const a=new Uint8Array(n),u=this.getHeaderLength(n);if(a.length<u)throw new Gl(`Expected header with length >= ${u} but got buffer of length ${a.length}`);const g=function(h,v){return h.readFields(hN,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Xx(a.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new Gl(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const h of g.layers)this.layers[h.name]=new zN(h,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const a=[],u=this.getLayer(n.layerName);for(let g of n.blockIndices){const h=u.dataIndex[g],v=h.firstByte-n.firstByte,T=h.lastByte-n.firstByte;if(u._blocksInProgress.has(g))continue;const P={layerName:u.name,firstByte:v,lastByte:T,pixelFormat:u.pixelFormat,blockIndex:g,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(O=>O.filter)};u._blocksInProgress.add(g),a.push(P)}return new MI(a,()=>{a.forEach(g=>u._blocksInProgress.delete(g.blockIndex))},(g,h)=>{if(a.forEach(v=>u._blocksInProgress.delete(v.blockIndex)),g)throw g;h.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class zN{constructor({version:n,name:a,units:u,tileSize:g,pixelFormat:h,buffer:v,dataIndex:T},P){if(this.version=n,this.version!==1)throw new Gl(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=a,this.units=u,this.tileSize=g,this.buffer=v,this.pixelFormat=ON[h],this.dataIndex=T,this.bandShape=[g+2*v,g+2*v,EI[this.pixelFormat]],this._decodedBlocks=new bN(P?P.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return EI[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const a=n.blockIndex.toString();this._decodedBlocks.get(a)||this._decodedBlocks.put(a,n.data)}getBlockForBand(n){let a=0;switch(typeof n){case"string":for(const[u,g]of this.dataIndex.entries()){for(const[h,v]of g.bands.entries())if(v===n)return{bandIndex:a+h,blockIndex:u,blockBandIndex:h};a+=g.bands.length}break;case"number":for(const[u,g]of this.dataIndex.entries()){if(n>=a&&n<a+g.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-a};a+=g.bands.length}break;default:throw new Gl(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new Gl(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let a=1/0,u=-1/0;const g=[],h=new Set;for(const v of n){const{blockIndex:T}=this.getBlockForBand(v);if(T<0)throw new Gl(`Invalid band: ${JSON.stringify(v)}`);const P=this.dataIndex[T];g.includes(T)||g.push(T),h.add(T),a=Math.min(a,P.firstByte),u=Math.max(u,P.lastByte)}if(h.size>this.cacheSize)throw new Gl(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:a,lastByte:u,blockIndices:g}}hasBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0}hasDataForBand(n){const{blockIndex:a}=this.getBlockForBand(n);return a>=0&&!!this._decodedBlocks.get(a.toString())}getBandView(n){const{blockIndex:a,blockBandIndex:u}=this.getBlockForBand(n),g=this._decodedBlocks.get(a.toString());if(!g)throw new Gl(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[a],v=this.bandShape.reduce((O,x)=>O*x,1),T=u*v,P=g.subarray(T,T+v);return{data:P,bytes:new Uint8Array(P.buffer).subarray(P.byteOffset,P.byteOffset+P.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}Jx.setPbf=function(c){Xx=c};class MI{constructor(n,a,u){this.tasks=n,this._onCancel=a,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,a){this._finalized||(this._onComplete(n,a),this._finalized=!0)}}Jx.performDecoding=function(c,n){const a=new Uint8Array(c);return Promise.all(n.tasks.map(u=>{const{layerName:g,firstByte:h,lastByte:v,pixelFormat:T,blockShape:P,blockIndex:O,filters:x,codec:k}=u,L=a.subarray(h,v+1),A=new Uint32Array(P[0]*P[1]*P[2]);let R;if(k!=="gzip_data")throw new Gl(`Unhandled codec: ${k}`);return R=function($,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((Q=function(Ie){Ie[0]==31&&Ie[1]==139&&Ie[2]==8||zc(6,"invalid gzip data");var Ge=Ie[3],ze=10;4&Ge&&(ze+=2+(Ie[10]|Ie[11]<<8));for(var $e=(Ge>>3&1)+(Ge>>4&1);$e>0;$e-=!Ie[ze++]);return ze+(2&Ge)}(ie=$))+8>ie.length&&zc(6,"invalid gzip data"),function(Ie,Ge,ze,$e){var st=Ie.length;if(!st||Ge.f&&!Ge.l)return ze||new yl(0);var Fe=!ze,rt=Fe||Ge.i!=2,ht=Ge.i;Fe&&(ze=new yl(3*st));var pt,Tt,Lt=function(Qd){var gf=ze.length;if(Qd>gf){var kv=new yl(Math.max(2*gf,Qd));kv.set(ze),ze=kv}},Ft=Ge.f||0,Pt=Ge.p||0,sn=Ge.b||0,Cn=Ge.l,Jt=Ge.d,Jn=Ge.m,Fn=Ge.n,Pn=8*st;do{if(!Cn){Ft=Dc(Ie,Pt,1);var Sn=Dc(Ie,Pt+1,3);if(Pt+=3,!Sn){var wo=Ie[(Bo=4+((Pt+7)/8|0))-4]|Ie[Bo-3]<<8,Xn=Bo+wo;if(Xn>st){ht&&zc(0);break}rt&&Lt(sn+wo),ze.set(Ie.subarray(Bo,Xn),sn),Ge.b=sn+=wo,Ge.p=Pt=8*Xn,Ge.f=Ft;continue}if(Sn==1)Cn=IN,Jt=AN,Jn=9,Fn=5;else if(Sn==2){var io=Dc(Ie,Pt,31)+257,Uo=Dc(Ie,Pt+10,15)+4,er=io+Dc(Ie,Pt+5,31)+1;Pt+=14;for(var tr=new yl(er),Zo=new yl(19),lr=0;lr<Uo;++lr)Zo[CN[lr]]=Dc(Ie,Pt+3*lr,7);Pt+=3*Uo;var ar=Zx(Zo),Qr=(1<<ar)-1,Wr=wv(Zo,ar);for(lr=0;lr<er;){var Bo,Dr=Wr[Dc(Ie,Pt,Qr)];if(Pt+=15&Dr,(Bo=Dr>>4)<16)tr[lr++]=Bo;else{var Br=0,mi=0;for(Bo==16?(mi=3+Dc(Ie,Pt,3),Pt+=2,Br=tr[lr-1]):Bo==17?(mi=3+Dc(Ie,Pt,7),Pt+=3):Bo==18&&(mi=11+Dc(Ie,Pt,127),Pt+=7);mi--;)tr[lr++]=Br}}var Di=tr.subarray(0,io),qi=tr.subarray(io);Jn=Zx(Di),Fn=Zx(qi),Cn=wv(Di,Jn),Jt=wv(qi,Fn)}else zc(1);if(Pt>Pn){ht&&zc(0);break}}rt&&Lt(sn+131072);for(var zi=(1<<Jn)-1,Ii=(1<<Fn)-1,Ni=Pt;;Ni=Pt){var Xi=(Br=Cn[Yx(Ie,Pt)&zi])>>4;if((Pt+=15&Br)>Pn){ht&&zc(0);break}if(Br||zc(2),Xi<256)ze[sn++]=Xi;else{if(Xi==256){Ni=Pt,Cn=null;break}var xa=Xi-254;Xi>264&&(xa=Dc(Ie,Pt,(1<<(Bc=yI[lr=Xi-257]))-1)+SI[lr],Pt+=Bc);var di=Jt[Yx(Ie,Pt)&Ii],Es=di>>4;if(di||zc(3),Pt+=15&di,qi=MN[Es],Es>3){var Bc=bI[Es];qi+=Yx(Ie,Pt)&(1<<Bc)-1,Pt+=Bc}if(Pt>Pn){ht&&zc(0);break}rt&&Lt(sn+131072);var Wl=sn+xa;if(sn<qi){var ql=0-qi,mf=Math.min(qi,Wl);for(ql+sn<0&&zc(3);sn<mf;++sn)ze[sn]=(void 0)[ql+sn]}for(;sn<Wl;++sn)ze[sn]=ze[sn-qi]}}Ge.l=Cn,Ge.p=Ni,Ge.b=sn,Ge.f=Ft,Cn&&(Ft=1,Ge.m=Jn,Ge.d=Jt,Ge.n=Fn)}while(!Ft);return sn!=ze.length&&Fe?(pt=ze,((Tt=sn)==null||Tt>pt.length)&&(Tt=pt.length),new yl(pt.subarray(0,Tt))):ze.subarray(0,sn)}(ie.subarray(Q,-8),{i:2},new yl(((Y=ie)[(re=Y.length)-4]|Y[re-3]<<8|Y[re-2]<<16|Y[re-1]<<24)>>>0))));var Y,re,ie,Q;const ue=LN[W];if(!ue)throw new Error(`Unhandled codec: ${W}`);const _e=new globalThis.DecompressionStream(ue);return new Response(new Blob([$]).stream().pipeThrough(_e)).arrayBuffer().then(Ie=>new Uint8Array(Ie))}(L,k).then($=>(function(W,Y){W.readFields(_N,Y)}(new Xx($),A),new DN[T](A.buffer))),R.then($=>{for(let W=x.length-1;W>=0;W--)switch(x[W]){case"delta_filter":xN($,P);break;case"zigzag_filter":wN($);break;case"bitshuffle_filter":SN($,T);break;default:throw new Gl(`Unhandled filter "${x[W]}"`)}return{layerName:g,blockIndex:O,data:$}}).catch($=>{throw $})}))},no(MI,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var Tv={workerUrl:"",workerClass:null,workerParams:void 0};const Qx="mapboxgl_preloaded_worker_pool";class Cv{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Cv.workerCount;)this.workers.push(Tv.workerClass!=null?new Tv.workerClass:new self.Worker(Tv.workerUrl,Tv.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qx]}numActive(){return Object.keys(this.active).length}}let Ev;function b0(){return Ev||(Ev=new Cv),Ev}Cv.workerCount=2;let Mv,ew,Fc,Hp,tw,Gp=null;function II(){return Er()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:ew||qe.DRACO_URL}function AI(){if(Er()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Hp)return Hp;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Hp=WebAssembly.validate(c)?qe.MESHOPT_SIMD_URL:qe.MESHOPT_URL,Hp}const x0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},FN={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Iv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function kI(c,n,a){const u=a.json.bufferViews.length,g=a.buffers.length;n.bufferView=u,a.json.bufferViews[u]={buffer:g,byteLength:c.byteLength},a.buffers[g]=c}const nw="KHR_draco_mesh_compression";function BN(c,n){const a=c.extensions&&c.extensions[nw];if(!a)return;const u=new Fc.Decoder,g=OI(n,a.bufferView),h=new Fc.Mesh;if(!u.DecodeArrayToMesh(g,g.byteLength,h))throw new Error("Failed to decode Draco mesh");const v=n.json.accessors[c.indices],T=x0[v.componentType],P=v.count*T.BYTES_PER_ELEMENT,O=Fc._malloc(P);T===Uint16Array?u.GetTrianglesUInt16Array(h,P,O):u.GetTrianglesUInt32Array(h,P,O),kI(Fc.memory.buffer.slice(O,O+P),v,n),Fc._free(O);for(const x of Object.keys(a.attributes)){const k=u.GetAttributeByUniqueId(h,a.attributes[x]),L=n.json.accessors[c.attributes[x]],A=FN[L.componentType],R=L.count*Iv[L.type]*x0[L.componentType].BYTES_PER_ELEMENT,$=Fc._malloc(R);u.GetAttributeDataArrayForAllPoints(h,k,Fc[A],R,$),kI(Fc.memory.buffer.slice($,$+R),L,n),Fc._free($)}u.destroy(),h.destroy(),delete c.extensions[nw]}const w0="EXT_meshopt_compression";function NN(c,n){if(!c.extensions||!c.extensions[w0])return;const a=c.extensions[w0],u=new Uint8Array(n.buffers[a.buffer],a.byteOffset||0,a.byteLength||0),g=new Uint8Array(a.count*a.byteStride);tw.decodeGltfBuffer(g,a.count,a.byteStride,u,a.mode,a.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=g.buffer,delete c.extensions[w0]}const PI=1179937895,RI=new TextDecoder("utf8");function LI(c,n){return new URL(c,n).href}function $N(c,n,a,u){return fetch(LI(c.uri,u)).then(g=>g.arrayBuffer()).then(g=>{n.buffers[a]=g})}function OI(c,n){const a=c.json.bufferViews[n];return new Uint8Array(c.buffers[a.buffer],a.byteOffset||0,a.byteLength)}function VN(c,n,a,u){if(c.uri){const g=LI(c.uri,u);return fetch(g).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{n.images[a]=h})}if(c.bufferView!==void 0){const g=OI(n,c.bufferView),h=new Blob([g],{type:c.mimeType});return createImageBitmap(h).then(v=>{n.images[a]=v})}}function DI(c,n=0,a){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===PI){const x=new Uint32Array(c,n);let k=2;const L=(x[k++]>>2)-3,A=x[k++]>>2;if(k++,u.json=JSON.parse(RI.decode(x.subarray(k,k+A))),k+=A,k<L){const R=x[k++];k++;const $=n+(k<<2);u.buffers[0]=c.slice($,$+R)}}else u.json=JSON.parse(RI.decode(new Uint8Array(c,n)));const{buffers:g,images:h,meshes:v,extensionsUsed:T,bufferViews:P}=u.json;let O=Promise.resolve();if(g){const x=[];for(let k=0;k<g.length;k++){const L=g[k];L.uri?x.push($N(L,u,k,a)):u.buffers[k]||(u.buffers[k]=null)}O=Promise.all(x)}return O.then(()=>{const x=[],k=T&&T.includes(nw),L=T&&T.includes(w0);if(k&&x.push(function(){if(!Fc)return Mv??(Mv=function(A){let R,$=null;function W(){R=new Uint8Array($.buffer)}function Y(){throw new Error("Unexpected Draco error.")}const re={a:{a:Y,d:function(ie,Q,ue){return R.copyWithin(ie,Q,Q+ue)},c:function(ie){const Q=R.length,ue=Math.max(ie>>>0,Math.ceil(1.2*Q)),_e=Math.ceil((ue-Q)/65536);try{return $.grow(_e),W(),!0}catch{return!1}},b:Y}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(A,re):A.then(ie=>ie.arrayBuffer()).then(ie=>WebAssembly.instantiate(ie,re))).then(ie=>{const{Rb:Q,Qb:ue,P:_e,T:Ie,X:Ge,Ja:ze,La:$e,Qa:st,Va:Fe,Wa:rt,eb:ht,jb:pt,f:Tt,e:Lt,yb:Ft,zb:Pt,Ab:sn,Bb:Cn,Db:Jt,Gb:Jn}=ie.instance.exports;$=Lt;const Fn=(()=>{let Pn=0,Sn=0,wo=0,Xn=0;return io=>{wo&&(Q(Xn),Q(Pn),Sn+=wo,wo=Pn=0),Pn||(Sn+=128,Pn=ue(Sn));const Uo=io.length+7&-8;let er=Pn;Uo>=Sn&&(wo=Uo,er=Xn=ue(Uo));for(let tr=0;tr<io.length;tr++)R[er+tr]=io[tr];return er}})();return W(),Tt(),{memory:Lt,_free:Q,_malloc:ue,Mesh:class{constructor(){this.ptr=_e()}destroy(){Ie(this.ptr)}},Decoder:class{constructor(){this.ptr=ze()}destroy(){pt(this.ptr)}DecodeArrayToMesh(Pn,Sn,wo){const Xn=Fn(Pn),io=$e(this.ptr,Xn,Sn,wo.ptr);return!!Ge(io)}GetAttributeByUniqueId(Pn,Sn){return{ptr:st(this.ptr,Pn.ptr,Sn)}}GetTrianglesUInt16Array(Pn,Sn,wo){Fe(this.ptr,Pn.ptr,Sn,wo)}GetTrianglesUInt32Array(Pn,Sn,wo){rt(this.ptr,Pn.ptr,Sn,wo)}GetAttributeDataArrayForAllPoints(Pn,Sn,wo,Xn,io){ht(this.ptr,Pn.ptr,Sn.ptr,wo,Xn,io)}},DT_INT8:Ft(),DT_UINT8:Pt(),DT_INT16:sn(),DT_UINT16:Cn(),DT_UINT32:Jt(),DT_FLOAT32:Jn()}})}(fetch(II())),Mv.then(A=>{Fc=A,Mv=void 0}))}()),L&&x.push(function(){if(tw)return;const A=function(R){let $;const W=WebAssembly.instantiateStreaming(R,{}).then(ie=>{$=ie.instance,$.exports.__wasm_call_ctors()}),Y={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},re={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(ie,Q,ue,_e,Ie,Ge){(function(ze,$e,st,Fe,rt,ht,pt){const Tt=ze.exports.sbrk,Lt=Fe+3&-4,Ft=Tt(Lt*rt),Pt=Tt(ht.length),sn=new Uint8Array(ze.exports.memory.buffer);sn.set(ht,Pt);const Cn=$e(Ft,Fe,rt,Pt,ht.length);if(Cn===0&&pt&&pt(Ft,Lt,rt),st.set(sn.subarray(Ft,Ft+Fe*rt)),Tt(Ft-Tt(0)),Cn!==0)throw new Error(`Malformed buffer data: ${Cn}`)})($,$.exports[re[Ie]],ie,Q,ue,_e,$.exports[Y[Ge]])}}}(fetch(AI()));return A.ready.then(()=>{tw=A})}()),h)for(let A=0;A<h.length;A++)x.push(VN(h[A],u,A,a));return(x.length?Promise.all(x):Promise.resolve()).then(()=>{if(k&&v)for(const{primitives:A}of v)for(const R of A)BN(R,u);if(L&&v&&P)for(const A of P)NN(A,u);return u})})}function pf(c,n){const a=c.json.bufferViews[n.bufferView],u=x0[n.componentType];return new u(c.buffers[a.buffer],(n.byteOffset||0)+(a.byteOffset||0),n.count*(a.byteStride&&a.byteStride!==Iv[n.type]*u.BYTES_PER_ELEMENT?a.byteStride/u.BYTES_PER_ELEMENT:Iv[n.type]))}function ow(c,n,a,u){const g=x0[n.componentType],h=function(x){switch(x){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(g),v=c.json.bufferViews[n.bufferView],T=v.byteStride?v.byteStride/g.BYTES_PER_ELEMENT:Iv[n.type],P=a.float32,O=P.length/a.capacity;for(let x=0,k=0;x<n.count*T;x+=T,k+=O)for(let L=0;L<O;L++)P[k+L]=u[x+L]*h;a._trim()}function UN(c,n,a){const u=c.indices,g=c.attributes,h={};h.indexArray=new bi;const v=n.json.accessors[u],T=v.count/3;h.indexArray.reserve(T);const P=pf(n,v);for(let L=0;L<T;L++)h.indexArray.emplaceBack(P[3*L],P[3*L+1],P[3*L+2]);h.indexArray._trim(),h.vertexArray=new pu;const O=n.json.accessors[g.POSITION];h.vertexArray.reserve(O.count);const x=pf(n,O);for(let L=0;L<O.count;L++)h.vertexArray.emplaceBack(x[3*L],x[3*L+1],x[3*L+2]);if(h.vertexArray._trim(),h.aabb=new Fr(O.min,O.max),h.centroid=function(L,A){const R=[0,0,0],$=L.length;if($>0){for(let W=0;W<$;W++){const Y=3*L[W];R[0]+=A[Y],R[1]+=A[Y+1],R[2]+=A[Y+2]}R[0]/=$,R[1]/=$,R[2]/=$}return R}(P,x),g.COLOR_0!==void 0){const L=n.json.accessors[g.COLOR_0],A=Iv[L.type],R=pf(n,L);h.colorArray=A===3?new pu:new Ec,h.colorArray.resize(L.count),ow(n,L,h.colorArray,R)}if(g.NORMAL!==void 0){h.normalArray=new pu;const L=n.json.accessors[g.NORMAL];h.normalArray.resize(L.count);const A=pf(n,L);ow(n,L,h.normalArray,A)}if(g.TEXCOORD_0!==void 0&&a.length>0){h.texcoordArray=new nf;const L=n.json.accessors[g.TEXCOORD_0];h.texcoordArray.resize(L.count);const A=pf(n,L);ow(n,L,h.texcoordArray,A)}if(g._FEATURE_ID_RGBA4444!==void 0){const L=n.json.accessors[g._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=pf(n,L))}g._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(pf(n,n.json.accessors[g._FEATURE_RGBA4444]).buffer));const k=c.material;return h.material=function(L,A){const{emissiveFactor:R=[0,0,0],alphaMode:$="OPAQUE",alphaCutoff:W=.5,normalTexture:Y,occlusionTexture:re,emissiveTexture:ie,doubleSided:Q}=L,{baseColorFactor:ue=[1,1,1,1],metallicFactor:_e=1,roughnessFactor:Ie=1,baseColorTexture:Ge,metallicRoughnessTexture:ze}=L.pbrMetallicRoughness||{},$e=re?A[re.index]:void 0;if(re&&re.extensions&&re.extensions.KHR_texture_transform&&$e){const st=re.extensions.KHR_texture_transform;$e.offsetScale=[st.offset[0],st.offset[1],st.scale[0],st.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new On(...ue),metallicFactor:_e,roughnessFactor:Ie,baseColorTexture:Ge?A[Ge.index]:void 0,metallicRoughnessTexture:ze?A[ze.index]:void 0},doubleSided:Q,emissiveFactor:R,alphaMode:$,alphaCutoff:W,normalTexture:Y?A[Y.index]:void 0,occlusionTexture:$e,emissionTexture:ie?A[ie.index]:void 0,defined:L.defined===void 0}}(k!==void 0?n.json.materials[k]:{defined:!1},a),h}function zI(c,n,a){const{matrix:u,rotation:g,translation:h,scale:v,mesh:T,extras:P,children:O}=c,x={};if(x.matrix=u||Le.mat4.fromRotationTranslationScale([],g||[0,0,0,1],h||[0,0,0],v||[1,1,1]),T!==void 0){x.meshes=a[T];const k=x.anchor=[0,0];for(const L of x.meshes){const{min:A,max:R}=L.aabb;k[0]+=A[0]+R[0],k[1]+=A[1]+R[1]}k[0]=Math.floor(k[0]/x.meshes.length/2),k[1]=Math.floor(k[1]/x.meshes.length/2)}if(P&&(P.id&&(x.id=P.id),P.lights&&(x.lights=function(k){if(!k.length)return[];const L=function(Y){const re=atob(Y),ie=new Uint8Array(re.length);for(let Q=0;Q<re.length;Q++)ie[Q]=re.codePointAt(Q);return ie}(k),A=[],R=L.length/24,$=new Uint16Array(L.buffer),W=new Float32Array(L.buffer);for(let Y=0;Y<R;Y++){const re=$[2*Y*6]/30,ie=$[2*Y*6+1]/30,Q=$[2*Y*6+10]/100,ue=W[6*Y+1],_e=W[6*Y+2],Ie=W[6*Y+3],Ge=W[6*Y+4],ze=Ie-ue,$e=Ge-_e,st=Math.hypot(ze,$e);A.push({pos:[ue+.5*ze,_e+.5*$e,ie],normal:[$e/st,-ze/st,0],width:st,height:re,depth:Q,points:[ue,_e,Ie,Ge]})}return A}(P.lights))),O){const k=[];for(const L of O)k.push(zI(n.json.nodes[L],n,a));x.children=k}return x}function jN(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new dx(c.vertices,c.indices,8,256),[a,u]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:a,max:u}}function HN(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const a=n[0];if(!a||!Array.isArray(a)||a.length===0)return null;const u=[];for(const v of a){if(!Array.isArray(v)||v.length!==2)continue;const T=v[0],P=v[1];typeof T=="number"&&typeof P=="number"&&u.push(new Be(T,P))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let g=0;for(let v=0;v<u.length;v++){const T=u[v],P=u[(v+1)%u.length],O=u[(v+2)%u.length];g+=(T.x-P.x)*(O.y-P.y)-(O.x-P.x)*(T.y-P.y)}g>0&&u.reverse();const h=Qg(u.flatMap(v=>[v.x,v.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function GN(c,n){const a=[],u=[];let g=0;const h=[];for(const v of c){g=a.length;const T=v.vertexArray.float32,P=v.indexArray.uint16;for(let O=0;O<v.vertexArray.length;O++)h[0]=T[3*O+0],h[1]=T[3*O+1],h[2]=T[3*O+2],Le.vec3.transformMat4(h,h,n),a.push(new Be(h[0],h[1]));for(let O=0;O<3*v.indexArray.length;O++)u.push(P[O]+g)}if(u.length%3!=0)return null;for(let v=0;v<u.length;v+=3){const T=a[u[v+0]],P=a[u[v+1]],O=a[u[v+2]];(T.x-P.x)*(O.y-P.y)-(O.x-P.x)*(T.y-P.y)>0&&([u[v+1],u[v+2]]=[u[v+2],u[v+1]])}return{vertices:a,indices:u}}function FI(c){const n=function(P,O){const x=[],k=WebGL2RenderingContext;if(P.json.textures)for(const L of P.json.textures){const A={magFilter:k.LINEAR,minFilter:k.NEAREST,wrapS:k.REPEAT,wrapT:k.REPEAT};L.sampler!==void 0&&Object.assign(A,P.json.samplers[L.sampler]),x.push({image:O[L.source],sampler:A,uploaded:!1})}return x}(c,c.images),a=function(P,O){const x=[];for(const k of P.json.meshes){const L=[];for(const A of k.primitives)L.push(UN(A,P,O));x.push(L)}return x}(c,n),{scenes:u,scene:g,nodes:h}=c.json,v=u?u[g||0].nodes:h,T=[];for(const P of v)T.push(zI(h[P],c,a));return function(P,O,x){const k={},L=new Set;for(let A=0;A<P.length;A++){const R=x[O[A]];if(!R.extras)continue;const $=R.extras["mapbox:footprint:version"],W=R.extras["mapbox:footprint:id"];($||W)&&L.add(A),$==="1.0.0"&&W&&(k[W]=A)}for(let A=0;A<P.length;A++){if(L.has(A))continue;const R=P[A],$=x[O[A]];if(!$.extras)continue;let W=null;R.id in k&&(W=GN(P[k[R.id]].meshes,R.matrix)),W||(W=HN($)),W&&(R.footprint=jN(W))}if(L.size>0){const A=Array.from(L.values()).sort((R,$)=>R-$);for(let R=A.length-1;R>=0;R--)P.splice(A[R],1)}}(T,v,c.json.nodes),T}function WN(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,a=c.aabb.min[0]-1,u=c.aabb.min[1]-1,g=hf/(c.aabb.max[0]-a+2),h=hf/(c.aabb.max[1]-u+2);for(let v=0;v<n.length;v+=3){const T=n[v+2],P=(n[v+0]-a)*g|0,O=(n[v+1]-u)*h|0;T>c.heightmap[O*hf+P]&&(c.heightmap[O*hf+P]=T)}}function qN(c,n){const a={};a.indexArray=new bi,a.indexArray.reserve(4*c.length),a.vertexArray=new pu,a.vertexArray.reserve(10*c.length),a.colorArray=new Ec,a.vertexArray.reserve(10*c.length);let u=0;for(const v of c){const T=Math.min(10,Math.max(4,1.3*v.height))*n,P=[-v.normal[1],v.normal[0],0],O=Math.min(.29,.1*v.width/v.depth),x=v.width-2*v.depth*n*(O+.01),k=Le.vec3.scaleAndAdd([],v.pos,P,x/2),L=Le.vec3.scaleAndAdd([],v.pos,P,-x/2),A=[k[0],k[1],k[2]+v.height],R=[L[0],L[1],L[2]+v.height],$=Le.vec3.scaleAndAdd([],v.normal,P,O);Le.vec3.scale($,$,T);const W=Le.vec3.scaleAndAdd([],v.normal,P,-O);Le.vec3.scale(W,W,T),Le.vec3.add($,k,$),Le.vec3.add(W,L,W),k[2]+=.1,L[2]+=.1,a.vertexArray.emplaceBack($[0],$[1],$[2]),a.vertexArray.emplaceBack(W[0],W[1],W[2]),a.vertexArray.emplaceBack(k[0],k[1],k[2]),a.vertexArray.emplaceBack(L[0],L[1],L[2]),a.vertexArray.emplaceBack(A[0],A[1],A[2]),a.vertexArray.emplaceBack(R[0],R[1],R[2]),a.vertexArray.emplaceBack(k[0],k[1],k[2]),a.vertexArray.emplaceBack(L[0],L[1],L[2]),a.vertexArray.emplaceBack($[0],$[1],$[2]),a.vertexArray.emplaceBack(W[0],W[1],W[2]);const Y=x/T/2;a.colorArray.emplaceBack(-Y-O,-1,Y,.8),a.colorArray.emplaceBack(Y+O,-1,Y,.8),a.colorArray.emplaceBack(-Y,0,Y,1.3),a.colorArray.emplaceBack(Y,0,Y,1.3),a.colorArray.emplaceBack(Y+O,-.8,Y,.7),a.colorArray.emplaceBack(Y+O,-.8,Y,.7),a.colorArray.emplaceBack(0,0,Y,1.3),a.colorArray.emplaceBack(0,0,Y,1.3),a.colorArray.emplaceBack(Y+O,-1.2,Y,.8),a.colorArray.emplaceBack(Y+O,-1.2,Y,.8),a.indexArray.emplaceBack(6+u,4+u,8+u),a.indexArray.emplaceBack(7+u,9+u,5+u),a.indexArray.emplaceBack(0+u,1+u,2+u),a.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const g={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=On.white,g.pbrMetallicRoughness=h,a.material=g,a.aabb=new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),a}class BI{constructor(n){this._stringToNumber={},this._numberToString=[];for(let a=0;a<n.length;a++){const u=n[a];this._stringToNumber[u]=a,this._numberToString[a]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}class NI{constructor(n,a){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Vu(Nn,16,0),this.featureIndexArray=new Iy,this.promoteId=a,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,a,u,g,h,v=0,T=0){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,h,v);const O=this.grid;for(let x=0;x<a.length;x++){const k=a[x],L=[1/0,1/0,-1/0,-1/0];for(let A=0;A<k.length;A++){const R=k[A];L[0]=Math.min(L[0],R.x),L[1]=Math.min(L[1],R.y),L[2]=Math.max(L[2],R.x),L[3]=Math.max(L[3],R.y)}T!==0&&(L[0]-=T,L[1]-=T,L[2]+=T,L[3]+=T),L[0]<Nn&&L[1]<Nn&&L[2]>=0&&L[3]>=0&&O.insert(P,L[0],L[1],L[2],L[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Op.VectorTile(new Xy(this.rawTileData)).layers,this.sourceLayerCoder=new BI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,a,u){this.loadVTLayers(),this.serializedLayersCache.clear();const g=vp(n.filter),h=n.tileResult,v=n.transform,T=h.bufferedTilespaceBounds,P=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(L,A,R,$)=>Kr(h.bufferedTilespaceGeometry,L,A,R,$));P.sort(KN);let O=null;v.elevation&&P.length>0&&(O=Vp.create(v.elevation,this.tileID));const x={};let k;for(let L=0;L<P.length;L++){const A=P[L];if(A===k)continue;k=A;const R=this.featureIndexArray.get(A);let $=null;if(this.is3DTile){const W=this.bucketLayerIDs[0][0],Y=a[W];if(Y.type!=="model")continue;const{queryFeature:re,intersectionZ:ie}=Y.queryIntersectsMatchingFeature(h,R.featureIndex,g,v);re&&this.appendToResult(x,W,R.featureIndex,re,ie)}else this.loadMatchingFeature(x,R,g,n.layers,n.availableImages,a,u,(W,Y,re,ie=0)=>($||($=It(W,this.tileID.canonical,n.tileTransform)),Y.queryIntersectsFeature(h,W,re,$,this.z,n.transform,n.pixelPosMatrix,O,ie)))}return x}loadMatchingFeature(n,a,u,g,h,v,T,P){const{featureIndex:O,bucketIndex:x,sourceLayerIndex:k,layoutVertexArrayOffset:L}=a,A=this.bucketLayerIDs[x];if(g.length&&!function(Y,re){for(let ie=0;ie<Y.length;ie++)if(re.indexOf(Y[ie])>=0)return!0;return!1}(g,A))return;const R=this.sourceLayerCoder.decode(k),$=this.vtLayers[R].feature(O);if(u.needGeometry){const Y=pn($,!0);if(!u.filter(new Ei(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!u.filter(new Ei(this.tileID.overscaledZ),$))return;const W=this.getId($,R);for(let Y=0;Y<A.length;Y++){const re=A[Y];if(g.length&&g.indexOf(re)<0)continue;const ie=v[re];if(!ie)continue;let Q={};W!==void 0&&T&&(Q=T.getState(ie.sourceLayer||"_geojsonTileLayer",W));const ue=!P||P($,ie,Q,L);if(!ue)continue;const _e=new bv($,this.z,this.x,this.y,W);let Ie=this.serializedLayersCache.get(re);Ie||(Ie=ie.serialize(),Ie.id=re,this.serializedLayersCache.set(re,Ie)),_e.layer=mo({},Ie),_e.tile=this.tileID.canonical,_e.layer.paint=$I(Ie.paint,ie.paint,$,Q,h),_e.layer.layout=$I(Ie.layout,ie.layout,$,Q,h),this.appendToResult(n,re,O,_e,ue)}}appendToResult(n,a,u,g,h){let v=n[a];v===void 0&&(v=n[a]=[]),v.push({featureIndex:u,feature:g,intersectionZ:h})}lookupSymbolFeatures(n,a,u,g,h,v,T){const P={};this.loadVTLayers();const O=vp(g);for(const x of n)this.loadMatchingFeature(P,{bucketIndex:a,sourceLayerIndex:u,featureIndex:x,layoutVertexArrayOffset:0},O,h,v,T);return P}loadFeature(n){const{featureIndex:a,sourceLayerIndex:u}=n;this.loadVTLayers();const g=this.sourceLayerCoder.decode(u),h=this.vtFeatures[g];if(h[a])return h[a];const v=this.vtLayers[g].feature(a);return h[a]=v,v}hasLayer(n){for(const a of this.bucketLayerIDs)for(const u of a)if(n===u)return!0;return!1}getId(n,a){let u=n.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[a];g!=null&&(u=n.properties[g]),typeof u=="boolean"&&(u=Number(u))}return u}}function $I(c,n,a,u,g){return ft(c,(h,v)=>{const T=n instanceof Ld?n.get(v):null;return T&&T.evaluate?T.evaluate(a,u,g):T})}function KN(c,n){return n-c}no(NI,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const VI=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class rw{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,u]=new Uint8Array(n,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=u>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const h=VI[15&u];if(!h)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[T]=new Uint32Array(n,4,1);return new rw(T,v,h,n)}constructor(n,a=64,u=Float64Array,g){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const h=VI.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,T=n*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-T%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+P,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+P),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+P,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=n)}add(n,a){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=a,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return iw(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,a,u,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:v,nodeSize:T}=this,P=[0,h.length-1,0],O=[];for(;P.length;){const x=P.pop()||0,k=P.pop()||0,L=P.pop()||0;if(k-L<=T){for(let W=L;W<=k;W++){const Y=v[2*W],re=v[2*W+1];Y>=n&&Y<=u&&re>=a&&re<=g&&O.push(h[W])}continue}const A=L+k>>1,R=v[2*A],$=v[2*A+1];R>=n&&R<=u&&$>=a&&$<=g&&O.push(h[A]),(x===0?n<=R:a<=$)&&(P.push(L),P.push(A-1),P.push(1-x)),(x===0?u>=R:g>=$)&&(P.push(A+1),P.push(k),P.push(1-x))}return O}within(n,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:h,nodeSize:v}=this,T=[0,g.length-1,0],P=[],O=u*u;for(;T.length;){const x=T.pop()||0,k=T.pop()||0,L=T.pop()||0;if(k-L<=v){for(let W=L;W<=k;W++)jI(h[2*W],h[2*W+1],n,a)<=O&&P.push(g[W]);continue}const A=L+k>>1,R=h[2*A],$=h[2*A+1];jI(R,$,n,a)<=O&&P.push(g[A]),(x===0?n-u<=R:a-u<=$)&&(T.push(L),T.push(A-1),T.push(1-x)),(x===0?n+u>=R:a+u>=$)&&(T.push(A+1),T.push(k),T.push(1-x))}return P}}function iw(c,n,a,u,g,h){if(g-u<=a)return;const v=u+g>>1;UI(c,n,v,u,g,h),iw(c,n,a,u,v-1,1-h),iw(c,n,a,v+1,g,1-h)}function UI(c,n,a,u,g,h){for(;g>u;){if(g-u>600){const O=g-u+1,x=a-u+1,k=Math.log(O),L=.5*Math.exp(2*k/3),A=.5*Math.sqrt(k*L*(O-L)/O)*(x-O/2<0?-1:1);UI(c,n,a,Math.max(u,Math.floor(a-x*L/O+A)),Math.min(g,Math.floor(a+(O-x)*L/O+A)),h)}const v=n[2*a+h];let T=u,P=g;for(Av(c,n,u,a),n[2*g+h]>v&&Av(c,n,u,g);T<P;){for(Av(c,n,T,P),T++,P--;n[2*T+h]<v;)T++;for(;n[2*P+h]>v;)P--}n[2*u+h]===v?Av(c,n,u,P):(P++,Av(c,n,P,g)),P<=a&&(u=P+1),a<=P&&(g=P-1)}}function Av(c,n,a,u){aw(c,a,u),aw(n,2*a,2*u),aw(n,2*a+1,2*u+1)}function aw(c,n,a){const u=c[n];c[n]=c[a],c[a]=u}function jI(c,n,a,u){const g=c-a,h=n-u;return g*g+h*h}o.$=gy,o.A=class extends g0{},o.B=js,o.C=$n,o.D=Pg,o.E=Kn,o.F=gg,o.G=Nu,o.H=mg,o.I=Ax,o.J=up,o.K=ju,o.L=$u,o.M=kd,o.N=ri,o.O=$a,o.P=Be,o.Q=li,o.R=lc,o.S=va,o.T=Vx,o.U=yo,o.V=g0,o.W=Rg,o.X=vg,o.Y=cy,o.Z=function(c){const n=c.value;let a=[];if(!n)return a;const u=js(n);return u!=="string"?(a=a.concat([new g0(c.key,n,`string expected, "${u}" found`)]),a):(eI(n,!0)||(a=a.concat([new g0(c.key,n,`invalid url "${n}"`)])),a)},o._=Ot,o.a=function(c){return qe.API_CDN_URL_REGEX.test(c)},o.a$=fu,o.a0=ci,o.a1=Rn,o.a2=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return hi(c.expression.evaluate(n))}interpolate(c,n,a){return{x:uo(c.x,n.x,a),y:uo(c.y,n.y,a),z:uo(c.z,n.z,a),azimuthal:uo(c.azimuthal,n.azimuthal,a),polar:uo(c.polar,n.polar,a)}}},o.a3=Ei,o.a4=Wh,o.a5=vt,o.a6=Le,o.a7=kn,o.a8=Ld,o.a9=Gd,o.aA=_r,o.aB=VM,o.aC=qM,o.aD=$M,o.aE=function(c,n){const a=document.createElement("video");a.muted=!0,a.onloadstart=function(){n(null,a)};for(let u=0;u<c.length;u++){const g=document.createElement("source");Ya(c[u])||(a.crossOrigin="Anonymous"),g.src=c[u],a.appendChild(g)}return{cancel:()=>{}}},o.aF=d0,o.aG=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>DI(n,0,c))},o.aH=FI,o.aI=class{constructor(c,n,a,u){this.id=c,this.position=n!=null?new H(n[0],n[1]):new H(0,0),this.orientation=a??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new Fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(Le.mat4.multiply(c.matrix,n,c.matrix),c.meshes)for(const a of c.meshes){const u=Fr.applyTransformFast(a.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const a of c.children)this._applyTransformations(a,c.matrix)}computeBoundsAndApplyParent(){const c=Le.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,a,u,g,h,v=!1){iI(this.matrix,this,c.transform,this.position,n,a,u,g,h,v)}upload(c){if(!this.uploaded){for(const n of this.nodes)Wx(n,c);for(const n of this.nodes)v0(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)qx(c)}},o.aJ=Dt,o.aK=function(c){return c.indexOf(Xh)>=0},o.aL=fv,o.aM=De,o.aN=je,o.aO=Dd,o.aP=bi,o.aQ=Ho,o.aR=Ip,o.aS=c0,o.aT=function(){Ts.isLoading()||Ts.isLoaded()||Ag()!=="deferred"||my()},o.aU=vp,o.aV=pn,o.aW=bv,o.aX=Nr,o.aY=bx,o.aZ=ux,o.a_=It,o.aa=uo,o.ab=Nn,o.ac=hr,o.ad=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([a,u]){const g=hi([1,a,u]);return{x:g.x,y:g.y,z:g.z}}(c.expression.evaluate(n))}interpolate(c,n,a){return{x:uo(c.x,n.x,a),y:uo(c.y,n.y,a),z:uo(c.z,n.z,a)}}},o.ae=function(c,n,a=0,u=!0){const g=new Be(a,a),h=c.sub(g),v=n.add(g),T=[h,new Be(v.x,h.y),v,new Be(h.x,v.y)];return u&&T.push(h.clone()),T},o.af=function(c,n){const a=[];for(let u=0;u<c.length;u++){const g=qn(u-1,-1,c.length-1),h=qn(u+1,-1,c.length-1),v=c[u],T=c[h],P=c[g].sub(v).unit(),O=T.sub(v).unit(),x=O.angleWithSep(P.x,P.y),k=P.add(O).unit().mult(-1*n/Math.sin(x/2));a.push(v.add(k))}return a},o.ag=EM,o.ah=Kr,o.ai=function(c,n,a=0){return Le.vec3.fromValues(((n.x-a)*c.scale-c.x)*Nn,(n.y*c.scale-c.y)*Nn,He(n.z,n.y))},o.aj=rs,o.ak=GE,o.al=function(c){let n=1/0,a=1/0,u=-1/0,g=-1/0;for(const h of c)n=Math.min(n,h.x),a=Math.min(a,h.y),u=Math.max(u,h.x),g=Math.max(g,h.y);return{min:new Be(n,a),max:new Be(u,g)}},o.am=ye,o.an=mr,o.ao=ct,o.ap=yt,o.aq=ya,o.ar=function(c,n){const a={};for(let u=0;u<n.length;u++){const g=n[u];g in c&&(a[g]=c[g])}return a},o.as=X,o.at=Te,o.au=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,a,u){const g=this.entries[c]=this.entries[c]||{callbacks:[]};if(g.result){const[h,v]=g.result;return this.scheduler?this.scheduler.add(()=>{u(h,v)},n):u(h,v),()=>{}}return g.callbacks.push(u),g.cancel||(g.cancel=a((h,v)=>{g.result=[h,v];for(const T of g.callbacks)this.scheduler?this.scheduler.add(()=>{T(h,v)},n):T(h,v);setTimeout(()=>delete this.entries[c],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(h=>h!==u),g.callbacks.length||(g.cancel(),delete this.entries[c]))}}},o.av=bp,o.aw=function(c,n,a){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},g=>{const h=ru(c.request,(v,T,P,O)=>{v?g(v):T&&g(null,{vectorTile:a?void 0:new Op.VectorTile(new Xy(T)),rawData:T,cacheControl:P,expires:O})});return()=>{h.cancel(),g()}},n)},o.ax=function(c){To++,To>Eo&&(c.getActor().send("enforceCacheSizeLimit",Oo),To=0)},o.ay=gt,o.az=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},o.b=function(c){return qe.API_FONTS_REGEX.test(c)},o.b$=is,o.b0=Ug,o.b1=Hl,o.b2=ki,o.b3=Qg,o.b4=Bx,o.b5=function(c,n){const a=Gd(n.zoom);if(a===0)return gu(c);const u=Fy(c),g=tx(u),h=ye(u.getWest())*n.worldSize,v=ye(u.getEast())*n.worldSize,T=Te(u.getNorth())*n.worldSize,P=Te(u.getSouth())*n.worldSize,O=[h,T,0],x=[v,T,0],k=[h,P,0],L=[v,P,0],A=Le.mat4.invert([],n.globeMatrix);return Le.vec3.transformMat4(O,O,A),Le.vec3.transformMat4(x,x,A),Le.vec3.transformMat4(k,k,A),Le.vec3.transformMat4(L,L,A),g[0]=qu(g[0],k,a),g[1]=qu(g[1],L,a),g[2]=qu(g[2],x,a),g[3]=qu(g[3],O,a),Fr.fromPoints(g)},o.b6=Ny,o.b7=Xg,o.b8=qu,o.b9=xp,o.bA=On,o.bB=qn,o.bC=Et,o.bD=Bi,o.bE=Se,o.bF=function(c,n,a){c[4*n+0]=a[0],c[4*n+1]=a[1],c[4*n+2]=a[2],c[4*n+3]=a[3]},o.bG=sf,o.bH=Ul,o.bI=Wg,o.bJ=Qi,o.bK=Wu,o.bL=H,o.bM=PM,o.bN=wr,o.bO=Js,o.bP=ZM,o.bQ=ea,o.bR=DC,o.bS=function(c,n,a,u,g,h,v,T,P){if(P.name==="globe")return DC(c,n,new ea(a,u,g),!1);const O=fv({z:a,x:u,y:g},P);return new Fr([(h+O.x/O.scale)*n,n*(O.y/O.scale),v],[(h+O.x2/O.scale)*n,n*(O.y2/O.scale),T])},o.bT=function(c,n,a){let u=0;for(let g=0;g<2;++g)c[g]>0&&(u+=(c[g]-0)*(c[g]-0)),n[g]<0&&(u+=(0-n[g])*(0-n[g]));return u},o.bU=Ye,o.bV=f,o.bW=function(c){const n=Le.mat4.identity(new Float64Array(16));Le.mat4.multiply(n,c.pixelMatrix,c.globeMatrix);const a=[0,b,0],u=[0,S,0];return Le.vec3.transformMat4(a,a,n),Le.vec3.transformMat4(u,u,n),[a[0]>0&&a[0]<=c.width&&a[1]>0&&a[1]<=c.height&&!rx(c,new H(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!rx(c,new H(c.center.lat,-90))]},o.bX=function(c,n){const{scale:a}=c.tileTransform,u=a*Nn/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return Le.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},o.bY=p0,o.bZ=KM,o.b_=function(c){const n=KM(c,!0);return Le.mat2.invert([],[n[0],n[1],n[4],n[5]])},o.ba=ra,o.bb=Jx,o.bc=Xy,o.bd=ru,o.be=function(c){const n=[];for(const a in c)n.push(c[a]);return n},o.bf=function(c,n){const a=[];for(const u in c)u in n||a.push(u);return a},o.bg=Co,o.bh=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bi=Ht,o.bj=function(c,n){const{x:a,y:u}=c.point,g=BC(a,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Le.mat4.multiply(g,g,nx(gu(n)))},o.bk=Dp,o.bl=_l,o.bm=Yy,o.bn=function(c,n,a,u,g){const h=5*n+2;c.float32[h+0]=a,c.float32[h+1]=u,c.float32[h+2]=g},o.bo=l0,o.bp=mM,o.bq=hn,o.br=ba,o.bs=vE,o.bt=QM,o.bu=wE,o.bv=SE,o.bw=Rx,o.bx=wM,o.by=Ix,o.bz=rw,o.c=it,o.c$=Jr,o.c0=function(c){const{x:n,y:a}=c.point,{lng:u,lat:g}=c._center;return BC(n,a,c.worldSize,u,g)},o.c1=Gt,o.c2=Pr,o.c3=zy,o.c4=function(c){const n=Math.round((c+45+360)%360/90)%4;return ln[n]},o.c5=45,o.c6=be,o.c7=Pp,o.c8=function(c,n,a){const u=Math.sqrt(c*c+n*n+a*a),g=u>0?Math.acos(a/u)*Nt:0;let h=c!==0||n!==0?Math.atan2(-n,-c)*Nt+90:0;return h<0&&(h+=360),[u,h,g]},o.c9=lt,o.cA=function(c){const n=Ye-5;c=yt(c,-n,n)/n*90;const a=Math.pow(Math.abs(Math.sin(Et(c))),3);return Math.round(a*(m.length-1))},o.cB=function(c,n,a,u){const g=n.getNorth(),h=n.getSouth(),v=n.getWest(),T=n.getEast(),P=1<<c.z,O=T-v,x=g-h,k=O/l,L=-x/m[a],A=[0,k,0,L,0,0,g,v,0];if(c.z>0){const R=180/u;Le.mat3.multiply(A,A,[R/O+1,0,0,0,R/x+1,0,-.5*R/k,.5*R/L,1])}return A[2]=P,A[5]=c.x,A[8]=c.y,A},o.cC=gu,o.cD=function(c,n,a){const u=Le.mat4.identity(new Float64Array(16)),g=(n/(1<<c)-.5)*Math.PI*2;return Le.mat4.rotateY(u,a.globeMatrix,g),Float32Array.from(u)},o.cE=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const a=n.getSource().maxzoom,u=1<<a,g=Math.floor(c.x),h=Math.floor((c.x-g)*u),v=Math.floor(c.y*u),T=this.findDEMTileFor(new _r(a,g,a,h,v));return!(!T||!T.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,a=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||c.y<0||c.y>1)return n;const g=u.getSource().maxzoom,h=1<<g,v=Math.floor(c.x),T=c.x-v,P=new _r(g,v,g,Math.floor(T*h),Math.floor(c.y*h)),O=this.findDEMTileFor(P);if(!O||!O.dem)return n;const x=O.dem,k=1<<O.tileID.canonical.z,L=(T*k-O.tileID.canonical.x)*x.dim,A=(c.y*k-O.tileID.canonical.y)*x.dim,R=Math.floor(L),$=Math.floor(A);return(a?this.exaggeration():1)*uo(uo(x.get(R,$),x.get(R,$+1),A-$),uo(x.get(R+1,$),x.get(R+1,$+1),A-$),L-R)}getAtTileOffset(c,n,a){const u=1<<c.canonical.z;return this.getAtPointOrZero(new vt(c.wrap+(c.canonical.x+n/Nn)/u,(c.canonical.y+a/Nn)/u))}getAtTileOffsetFunc(c,n,a,u){return g=>{const h=this.getAtTileOffset(c,g.x,g.y),v=u.upVector(c.canonical,g.x,g.y),T=u.upVectorScale(c.canonical,n,a).metersToTile;return Le.vec3.scale(v,v,h*T),v}}getForTilePoints(c,n,a,u){if(this.isUsingMockSource())return!1;const g=Vp.create(this,c,u);return!!g&&(n.forEach(h=>{h[2]=this.exaggeration()*g.getElevationAt(h[0],h[1],a)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const a=n.dem.tree,u=n.tileID,g=1<<c.canonical.z-u.canonical.z;let h=c.canonical.x/g-u.canonical.x,v=c.canonical.y/g-u.canonical.y,T=0;for(let P=0;P<c.canonical.z-u.canonical.z&&!a.leaves[T];P++){h*=2,v*=2;const O=2*Math.floor(v)+Math.floor(h);T=a.childOffsets[T]+O,h%=1,v%=1}return{min:this.exaggeration()*a.minimums[T],max:this.exaggeration()*a.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,a){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,a=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const g of c){const h=this.getMinMaxForTile(g.tileID);h&&(a=Math.min(a,h.min),u=Math.max(u,h.max),n=!0)}return n?{min:a,max:u}:null}},o.cF=XC,o.cG=jd,o.cH=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},o.cI=FC,o.cJ=ke,o.cK=Ee,o.cL=256,o.cM=function(c,n){const a=[0,0,0],u=Ny(gu(n.canonical));return Le.vec3.transformMat4(a,a,u),Le.vec3.transformMat4(a,a,c),a},o.cN=c=>({u_camera_to_center_distance:new Qi(c),u_extrude_scale:new Rp(c),u_device_pixel_ratio:new Qi(c),u_matrix:new sf(c),u_inv_rot_matrix:new sf(c),u_merc_center:new Ul(c),u_tile_id:new Wg(c),u_zoom_transition:new Qi(c),u_up_dir:new Wg(c),u_emissive_strength:new Qi(c)}),o.cO=c=>({u_matrix:new sf(c),u_pixels_to_tile_units:new Rp(c),u_device_pixel_ratio:new Qi(c),u_units_to_pixels:new Ul(c),u_dash_image:new Wu(c),u_gradient_image:new Wu(c),u_image_height:new Qi(c),u_texsize:new Ul(c),u_tile_units_to_pixels:new Qi(c),u_alpha_discard_threshold:new Qi(c),u_trim_offset:new Ul(c),u_trim_fade_range:new Ul(c),u_trim_color:new Pp(c),u_emissive_strength:new Qi(c),u_zbias_factor:new Qi(c),u_tile_to_meter:new Qi(c)}),o.cP=c=>({u_matrix:new sf(c),u_texsize:new Ul(c),u_pixels_to_tile_units:new Rp(c),u_device_pixel_ratio:new Qi(c),u_image:new Wu(c),u_units_to_pixels:new Ul(c),u_tile_units_to_pixels:new Qi(c),u_alpha_discard_threshold:new Qi(c),u_trim_offset:new Ul(c),u_emissive_strength:new Qi(c),u_zbias_factor:new Qi(c),u_tile_to_meter:new Qi(c)}),o.cQ=Fd,o.cR=gB,o.cS=vB,o.cT=VC,o.cU=(c,n,a,u,g,h)=>{const v=c.transform,T=v.projection.name==="globe";let P;if(h.paint.get("circle-pitch-alignment")==="map")if(T){const x=FC(v.zoom,n.canonical)*v._pixelsPerMercatorPixel;P=Float32Array.from([x,0,0,x])}else P=v.calculatePixelsToTileUnitsMatrix(a);else P=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const O={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(v.projection),u_matrix:c.translatePosMatrix(n.projMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Yt.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:bF,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(T){O.u_inv_rot_matrix=u,O.u_merc_center=g,O.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],O.u_zoom_transition=Gd(v.zoom);const x=g[0]*Nn,k=g[1]*Nn;O.u_up_dir=v.projection.upVector(new ea(0,0,0),x,k)}return O},o.cV=ZE,o.cW=(c,n,a,u,g,h)=>{const v=c.transform,T=v.pitch<15?WE(.07,.7,yt((14-v.zoom)/5,0,1)):.07;return{u_matrix:KE(c,n,a,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:v.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:g,u_image:0,u_tile_units_to_pixels:qE(n,v),u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:h,u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:T,u_tile_to_meter:lt(n.tileID.canonical,0)}},o.cX=(c,n,a,u,g,h,v)=>{const T=c.transform,P=T.calculatePixelsToTileUnitsMatrix(n),O=T.pitch<15?WE(.07,.7,yt((14-T.zoom)/5,0,1)):.07;return{u_matrix:KE(c,n,a,u),u_pixels_to_tile_units:P,u_device_pixel_ratio:h,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:YE(a)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:qE(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:v,u_trim_fade_range:a.paint.get("line-trim-fade-range"),u_trim_color:a.paint.get("line-trim-color").toRenderColor(a.lut).toArray01(),u_emissive_strength:a.paint.get("line-emissive-strength"),u_zbias_factor:O,u_tile_to_meter:lt(n.tileID.canonical,0)}},o.cY=ur,o.cZ=Jg,o.c_=zE,o.ca=Fr,o.cb=hi,o.cc=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},o.cd=function(c){return c({pluginStatus:_a,pluginURL:Ss}),Ig.on("pluginStateChange",c),c},o.ce=Up,o.cf=b0,o.cg=Fp,o.ch=kx,o.ci=ll,o.cj=py,o.ck=ho,o.cl=Ue,o.cm=et,o.cn=function(c){const n=c.indexOf(Xh);return n>=0?c.slice(0,n):c},o.co=function(c){const n=c.indexOf(Xh);return n>=0?c.slice(n+1):""},o.cp=function(c){const n=[],a=c.id;return a===void 0&&n.push({message:`layers.${a}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${a}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),n},o.cq=function(c,n,a,u){return c.type==="custom"?new KB(c,n):new aN[c.type](c,n,a,u)},o.cr=un,o.cs=Ig,o.ct=cc,o.cu=qg,o.cv=class extends Ic{constructor(c){super(c),this.current=Y1}set(c,n,a){if(this.fetchUniformLocation(c,n)){for(let u=0;u<9;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},o.cw=bn,o.cx=function(c,n,a){const u=Gd(a.zoom),g=c.style.map._antialias,h=n.options.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return u===0&&!g&&!h},o.cy=function(c){const n=c.pixelsPerMeter,a=n/Se(1,c.center.lat),u=Le.mat4.identity(new Float64Array(16));return Le.mat4.translate(u,u,[c.point.x,c.point.y,0]),Le.mat4.scale(u,u,[a,a,n]),Float32Array.from(u)},o.cz=Fy,o.d=function(c){return qe.API_TILEJSON_REGEX.test(c)},o.d$=w,o.d0=Zy,o.d1=qd,o.d2=450,o.d3=7,o.d4=qB,o.d5=Mr,o.d6=Ep,o.d7=256,o.d8=nx,o.d9=pu,o.dA=NC,o.dB=function(c){const n=[0,0,0],a=Le.mat4.identity(new Float64Array(16));return Le.mat4.multiply(a,c.pixelMatrix,c.globeMatrix),Le.vec3.transformMat4(n,n,a),new Be(n[0],n[1])},o.dC=function(c,n,a=!1){if(_a===Eg||_a===Zh||_a===Yh)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ss=Yt.resolveURL(c),_a=Eg,mp=n,Mg(),a||my()},o.dD=Ag,o.dE=function(){b0().acquire(Qx)},o.dF=function(){const c=Ev;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(Qx),Ev=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.dG=Cv,o.dH=function(c){const n=cn();if(!n)return;const a=n.delete(co);c&&a.catch(c).then(()=>c())},o.dI=Tv,o.dJ=II,o.dK=function(c){ew=Yt.resolveURL(c),Gp||(Gp=new Up(b0(),new Kn)),Gp.broadcast("setDracoUrl",ew)},o.dL=AI,o.dM=function(c){Hp=Yt.resolveURL(c),Gp||(Gp=new Up(b0(),new Kn)),Gp.broadcast("setMeshoptUrl",Hp)},o.dN=no,o.dO=Wd,o.dP=Oc,o.dQ=BI,o.dR=NI,o.dS=UE,o.dT=ft,o.dU=vM,o.dV=function(c,n,a,u,g,h,v,T,P,O,x=1,k){c.createArrays(),c.tilePixelRatio=Nn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const L=c.layers[0].layout,A=c.layers[0]._unevaluatedLayout._values,R={};if(R.scaleFactor=x,R.textSizeScaleRange=L.get("text-size-scale-range"),R.iconSizeScaleRange=L.get("icon-size-scale-range"),R.textScaleFactor=yt(R.scaleFactor,R.textSizeScaleRange[0],R.textSizeScaleRange[1]),R.iconScaleFactor=yt(R.scaleFactor,R.iconSizeScaleRange[0],R.iconSizeScaleRange[1]),c.textSizeData.kind==="composite"){const{minZoom:re,maxZoom:ie}=c.textSizeData;R.compositeTextSizes=[A["text-size"].possiblyEvaluate(new Ei(re),T),A["text-size"].possiblyEvaluate(new Ei(ie),T)]}if(c.iconSizeData.kind==="composite"){const{minZoom:re,maxZoom:ie}=c.iconSizeData;R.compositeIconSizes=[A["icon-size"].possiblyEvaluate(new Ei(re),T),A["icon-size"].possiblyEvaluate(new Ei(ie),T)]}R.layoutTextSize=A["text-size"].possiblyEvaluate(new Ei(P+1),T),R.layoutIconSize=A["icon-size"].possiblyEvaluate(new Ei(P+1),T),R.textMaxSize=A["text-size"].possiblyEvaluate(new Ei(18),T);const $=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",W=L.get("text-size");let Y=!1;for(const re of c.features)if(re.icon&&re.icon.nameSecondary){Y=!0;break}for(const re of c.features){const ie=L.get("text-font").evaluate(re,{},T).join(","),Q=W.evaluate(re,{},T)*R.textScaleFactor,ue=R.layoutTextSize.evaluate(re,{},T)*R.textScaleFactor,_e=(R.layoutIconSize.evaluate(re,{},T),{horizontal:{},vertical:void 0}),Ie=re.text;let Ge,ze=[0,0];if(Ie){const Fe=Ie.toString(),rt=L.get("text-letter-spacing").evaluate(re,{},T)*ba,ht=L.get("text-line-height").evaluate(re,{},T)*ba,pt=hy(Fe)?rt:0,Tt=L.get("text-anchor").evaluate(re,{},T),Lt=L.get("text-variable-anchor");if(!Lt){const Jt=L.get("text-radial-offset").evaluate(re,{},T);ze=Jt?wM(Tt,[Jt*ba,Px]):L.get("text-offset").evaluate(re,{},T).map(Jn=>Jn*ba)}let Ft=$?"center":L.get("text-justify").evaluate(re,{},T);const Pt=L.get("symbol-placement")==="point",sn=Pt?L.get("text-max-width").evaluate(re,{},T)*ba:1/0,Cn=Jt=>{c.allowVerticalPlacement&&Tg(Fe)&&(_e.vertical=Mx(Ie,n,a,g,ie,sn,ht,Tt,Jt,pt,ze,_l.vertical,!0,ue,Q))};if(!$&&Lt){const Jt=Ft==="auto"?Lt.map(Fn=>Rx(Fn)):[Ft];let Jn=!1;for(let Fn=0;Fn<Jt.length;Fn++){const Pn=Jt[Fn];if(!_e.horizontal[Pn])if(Jn)_e.horizontal[Pn]=_e.horizontal[0];else{const Sn=Mx(Ie,n,a,g,ie,sn,ht,"center",Pn,pt,ze,_l.horizontal,!1,ue,Q);Sn&&(_e.horizontal[Pn]=Sn,Jn=Sn.positionedLines.length===1)}}Cn("left")}else{if(Ft==="auto"&&(Ft=Rx(Tt)),Pt||L.get("text-writing-mode").indexOf("horizontal")>=0||!Tg(Fe)){const Jt=Mx(Ie,n,a,g,ie,sn,ht,Tt,Ft,pt,ze,_l.horizontal,!1,ue,Q);Jt&&(_e.horizontal[Ft]=Jt)}Cn(Pt?"left":Ft)}}let $e=!1;if(re.icon&&re.icon.namePrimary){const Fe=u[re.icon.namePrimary];Fe&&(Ge=MB(g[re.icon.namePrimary],re.icon.nameSecondary?g[re.icon.nameSecondary]:void 0,L.get("icon-offset").evaluate(re,{},T),L.get("icon-anchor").evaluate(re,{},T)),$e=Fe.sdf,c.sdfIcons===void 0?c.sdfIcons=Fe.sdf:c.sdfIcons!==Fe.sdf&&Bn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fe.pixelRatio!==c.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const st=TM(_e.horizontal)||_e.vertical;c.iconsInText||(c.iconsInText=!!st&&st.iconsInText),(st||Ge)&&OB(c,re,_e,Ge,u,R,ue,0,ze,$e,v,T,O,k,Y)}h&&c.generateCollisionDebugBuffers(P,c.collisionBoxArray,R.textScaleFactor)},o.dW=Op,o.dX=y0,o.dY=Ke,o.dZ=fE,o.d_=nM,o.da=Gu,o.db=Vg,o.dc=function(c,n,a,u,g){return yt((c-n)/(a-n)*(g-u)+u,u,g)},o.dd=lp,o.de=Xe,o.df=class{constructor(c,n,a,u){this.context=c,this.format=u,this.size=a,this.texture=c.gl.createTexture();const[g,h,v]=this.size,{gl:T}=c;T.bindTexture(T.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,g,h,v,0,Nx(this.format),$x(this.format),n.data)}bind(c,n){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},o.dg=Hx,o.dh=[1,1,1],o.di=Vp,o.dj=$p,o.dk=mu,o.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Be(1/0,1/0),max:new Be(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const a=yE(new Be(0,0),new Be(Nn,Nn),c),u=[];if(n&&!mx(a,this._globalClipBounds))return u;for(const g of this._activeRegions){if(g.hiddenByOverlap||!mx(a,g))continue;const h=jF(g.min,g.max,c);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[g.priority],footprint:g.footprint,footprintTileId:g.tileId,order:g.order,clipMask:g.clipMask,clipScope:g.clipScope})}return u}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const a=[];for(const u of n.cache.getVisibleCoordinates()){const g=n.cache.getTile(u).buckets[n.layer];g&&g.updateFootprints(u.toUnwrapped(),a)}return a},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const a=c.getOrder(),u=c.getClipMask(),g=c.getClipScope();for(const h of n){if(!h.footprint)continue;const v=yE(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:a,clipMask:u,clipScope:g})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,a)=>n.priority-a.priority||qy(n.min,a.min)||qy(n.max,a.max)||n.order-a.order||n.clipMask-a.clipMask||function(u,g){const h=(v,T)=>v+T;return u.length-g.length||u.reduce(h,"").localeCompare(g.reduce(h,""))}(n.clipScope,a.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const a=this._activeRegions[n],u=this._prevRegions[n];c=a.priority!==u.priority||!_E(a,u)||a.order!==u.order||a.clipMask!==u.clipMask||!Ht(a.clipScope,u.clipScope),++n}}if(c){++this._updateTime;for(const a of this._activeRegions)a.order!==Wy&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,a.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,a.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,a.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,a.max.y));const n=a=>{const u=this._activeRegions;if(a>=u.length)return a;const g=u[a].priority;for(;a<u.length&&u[a].priority===g;)++a;return a};if(this._sourceIds.length>1){let a=0,u=n(a);for(;a!==u;){let g=a;const h=a;for(;g!==u;){const v=this._activeRegions[g];v.hiddenByOverlap=!1;for(let T=0;T<h;T++){const P=this._activeRegions[T];if(!P.hiddenByOverlap&&v.order===Wy&&mx(v,P)&&(v.hiddenByOverlap=xE(v.footprint,v.tileId,P.footprint,P.tileId),v.hiddenByOverlap))break}++g}a=u,u=n(a)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},o.dm=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const a=new fu,u=new bi,g=[],h=c+1+2,v=n[0]+1,T=n[0]+1+(1+n.length),P=(O,x,k)=>{let L=O===h-1?O-2:O===0?O:O-1;return L+=k?24575:0,[L,x]};for(let O=0;O<h;++O)a.emplaceBack(...P(O,0,!0));for(let O=0;O<v;++O)for(let x=0;x<h;++x)a.emplaceBack(...P(x,O,(x===0||x===h-1)&&!0));for(let O=0;O<n.length;++O){const x=n[O];for(let k=0;k<h;++k)a.emplaceBack(...P(k,x,!0))}for(let O=0;O<n.length;++O){const x=u.length,k=n[O]+1+2,L=new bi;for(let $=0;$<k-1;$++){const W=$===k-2,Y=W?h*(T-n.length+O-$):h;for(let re=0;re<h-1;re++){const ie=$*h+re;$===0||W||re===0||re===h-2?(L.emplaceBack(ie+1,ie,ie+Y),L.emplaceBack(ie+Y,ie+Y+1,ie+1)):(u.emplaceBack(ie+1,ie,ie+Y),u.emplaceBack(ie+Y,ie+Y+1,ie+1))}}const A=ki.simpleSegment(0,x,a.length,u.length-x);for(let $=0;$<L.uint16.length;$+=3)u.emplaceBack(L.uint16[$],L.uint16[$+1],L.uint16[$+2]);const R=ki.simpleSegment(0,x,a.length,u.length-x);g.push({withoutSkirts:A,withSkirts:R})}return{vertices:a,indices:u,segments:g}}_createGrid(c){const n=this._fillGridMeshWithLods(l,m);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,Hl.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new bi;for(let v=0;v<=l;v++)n.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const a=new Gu,u=new Gu,g=new Gu,h=new Gu;this._poleSegments=[];for(let v=0,T=0;v<zy;v++){const P=360/(1<<v);a.emplaceBack(0,-ya,0,.5,0),u.emplaceBack(0,-ya,0,.5,1),g.emplaceBack(0,-ya,0,.5,.5),h.emplaceBack(0,-ya,0,.5,.5);for(let O=0;O<=l;O++){let x=O/l,k=0;const L=uo(0,P,x),[A,R,$]=E(_F,yF,L,ya);a.emplaceBack(A,R,$,x,k),u.emplaceBack(A,R,$,x,1-k);const W=Et(L);x=.5+.5*Math.sin(W),k=.5+.5*Math.cos(W),g.emplaceBack(A,R,$,x,k),h.emplaceBack(A,R,$,x,1-k)}this._poleSegments.push(ki.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(a,pi,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,pi,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(g,pi,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(h,pi,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},o.dn=Wy,o.dp=_n,o.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.dr=jn,o.ds=nt,o.dt=z,o.du=function([c,n,a]){const u=Math.hypot(c,n,a),g=Math.atan2(c,a),h=.5*Math.PI-Math.acos(-n/u);return new H(Gt(g),Gt(h))},o.dv=jx,o.dw=V,o.dx=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(a){if(Xo==null){const u=a.navigator?a.navigator.userAgent:null;Xo=!!a.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Xo}(c)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.dy=function(c,n){Oo=c,Eo=n},o.dz=rx,o.e=qe,o.e0=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==PI){const a=new Uint32Array(c,0,7),[,,u,g,h,v]=a;n=a.byteLength+g+h+v+h,(u!==c.byteLength||n>=c.byteLength)&&Bn("Invalid b3dm header information.")}return DI(c,n)},o.e1=function(c,n){const a=FI(c);for(const u of a){for(const g of u.meshes)WN(g);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(qN(u.lights,n)))}return a},o.e2=_0,o.e3=dI,o.e4=Ts,o.e5=function(c){Yn(),rr!=null&&rr.then(n=>{n.keys().then(a=>{for(let u=0;u<a.length-c;u++)n.delete(a[u])})})},o.f=function(c){return c.indexOf("mapbox:")===0},o.g=function(c,n){return cc(mo(c,{method:"GET"}),n)},o.h=mt,o.i=function(c){return qe.API_STYLE_REGEX.test(c)&&!it(c)},o.j=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,a)=>String.fromCharCode(+("0x"+a))))},o.l=mo,o.m=$o,o.n=function(c,n){return cc(mo(c,{type:"json"}),n)},o.o=_s,o.p=function(c,n){return cc(mo(c,{method:"POST"}),n)},o.q=Yt,o.r=Ua,o.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=Bt,o.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},o.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},o.w=Bn,o.x=wt,o.y=2,o.z=gM}),p(["./shared"],function(o){function w(Zt){const Ee=Zt?Zt.url.toString():void 0;return Ee?performance.getEntriesByName(Ee):[]}function C(Zt){if(typeof Zt=="number"||typeof Zt=="boolean"||typeof Zt=="string"||Zt==null)return JSON.stringify(Zt);if(Array.isArray(Zt)){let ke="[";for(const qe of Zt)ke+=`${C(qe)},`;return`${ke}]`}let Ee="{";for(const ke of Object.keys(Zt).sort())Ee+=`${ke}:${C(Zt[ke])},`;return`${Ee}}`}function M(Zt){let Ee="";for(const ke of o.bh)Ee+=`/${C(Zt[ke])}`;return Ee}class I{constructor(Ee){this.keyCache={},this._layers={},this._layerConfigs={},Ee&&this.replace(Ee)}replace(Ee,ke){this._layerConfigs={},this._layers={},this.update(Ee,[],ke)}update(Ee,ke,qe){this._options=qe;for(const it of Ee)this._layerConfigs[it.id]=it,(this._layers[it.id]=o.cq(it,this.scope,null,this._options)).compileFilter(qe),this.keyCache[it.id]&&delete this.keyCache[it.id];for(const it of ke)delete this.keyCache[it],delete this._layerConfigs[it],delete this._layers[it];this.familiesBySource={};const mt=function(it,xt){const qt={};for(let Wt=0;Wt<it.length;Wt++){const Qt=xt&&xt[it[Wt].id]||M(it[Wt]);xt&&(xt[it[Wt].id]=Qt);let nn=qt[Qt];nn||(nn=qt[Qt]=[]),nn.push(it[Wt])}const kt=[];for(const Wt in qt)kt.push(qt[Wt]);return kt}(o.be(this._layerConfigs),this.keyCache);for(const it of mt){const xt=it.map(gt=>this._layers[gt.id]),qt=xt[0];if(qt.visibility==="none")continue;const kt=qt.source||"";let Wt=this.familiesBySource[kt];Wt||(Wt=this.familiesBySource[kt]={});const Qt=qt.sourceLayer||"_geojsonTileLayer";let nn=Wt[Qt];nn||(nn=Wt[Qt]=[]),nn.push(xt)}}}const F=1*o.dP;class B{constructor(Ee){const ke={},qe=[];for(const qt in Ee){const kt=Ee[qt],Wt=ke[qt]={};for(const Qt in kt.glyphs){const nn=kt.glyphs[+Qt];if(!nn||nn.bitmap.width===0||nn.bitmap.height===0)continue;const gt=nn.metrics.localGlyph?F:1,Yt={x:0,y:0,w:nn.bitmap.width+2*gt,h:nn.bitmap.height+2*gt};qe.push(Yt),Wt[Qt]=Yt}}const{w:mt,h:it}=o.z(qe),xt=new o.dO({width:mt||1,height:it||1});for(const qt in Ee){const kt=Ee[qt];for(const Wt in kt.glyphs){const Qt=kt.glyphs[+Wt];if(!Qt||Qt.bitmap.width===0||Qt.bitmap.height===0)continue;const nn=ke[qt][Wt],gt=Qt.metrics.localGlyph?F:1;o.dO.copy(Qt.bitmap,xt,{x:0,y:0},{x:nn.x+gt,y:nn.y+gt},Qt.bitmap)}}this.image=xt,this.positions=ke}}o.dN(B,"GlyphAtlas");class N{constructor(Ee){this.tileID=new o.aA(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),this.tileZoom=Ee.tileZoom,this.uid=Ee.uid,this.zoom=Ee.zoom,this.lut=Ee.lut,this.canonical=Ee.tileID.canonical,this.pixelRatio=Ee.pixelRatio,this.tileSize=Ee.tileSize,this.source=Ee.source,this.scope=Ee.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ee.showCollisionBoxes,this.collectResourceTiming=!!Ee.request&&Ee.request.collectResourceTiming,this.promoteId=Ee.promoteId,this.isSymbolTile=Ee.isSymbolTile,this.tileTransform=o.aL(Ee.tileID.canonical,Ee.projection),this.projection=Ee.projection,this.worldview=Ee.worldview,this.localizableLayerIds=Ee.localizableLayerIds,this.brightness=Ee.brightness,this.extraShadowCaster=!!Ee.extraShadowCaster,this.tessellationStep=Ee.tessellationStep,this.scaleFactor=Ee.scaleFactor}parse(Ee,ke,qe,mt,it){this.status="parsing",this.data=Ee,this.collisionBoxArray=new o.aR;const xt=new o.dQ(Object.keys(Ee.layers).sort()),qt=new o.dR(this.tileID,this.promoteId);qt.bucketLayerIDs=[];const kt={},Wt=new o.dS(256,256),Qt={featureIndex:qt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Wt,availableImages:qe,brightness:this.brightness},nn=ke.familiesBySource[this.source];for(const Eo in nn){const cr=Ee.layers[Eo];if(!cr)continue;let rr=!1,qo=!1,cn=!1;for(const $o of nn[Eo])$o[0].type==="symbol"?rr=!0:qo=!0,$o[0].is3D()&&$o[0].type!=="model"&&(cn=!0);if(this.extraShadowCaster&&!cn||this.isSymbolTile===!0&&!rr||this.isSymbolTile===!1&&!qo)continue;cr.version===1&&o.w(`Vector tile source "${this.source}" layer "${Eo}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Yn=xt.encode(Eo),To=[];for(let $o=0,Ar=0;$o<cr.length;$o++){const yr=cr.feature($o),al=qt.getId(yr,Eo);if(this.localizableLayerIds&&this.localizableLayerIds.has(Eo)){const ms=yr.properties?yr.properties.worldview:null;if(this.worldview&&typeof ms=="string")if(ms==="all")yr.properties.$localized=!0;else{if(!ms.split(",").includes(this.worldview))continue;yr.properties.$localized=!0,yr.properties.worldview=this.worldview}}To.push({feature:yr,id:al,index:Ar,sourceLayerIndex:Yn}),Ar++}for(const $o of nn[Eo]){const Ar=$o[0];(!this.extraShadowCaster||Ar.is3D()&&Ar.type!=="model")&&(this.isSymbolTile!==void 0&&Ar.type==="symbol"!==this.isSymbolTile||Ar.minzoom&&this.zoom<Math.floor(Ar.minzoom)||Ar.maxzoom&&this.zoom>=Ar.maxzoom||Ar.visibility!=="none"&&(D($o,this.zoom,Qt.brightness,qe),(kt[Ar.id]=Ar.createBucket({index:qt.bucketLayerIDs.length,layers:$o,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Yn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(To,Qt,this.tileID.canonical,this.tileTransform),qt.bucketLayerIDs.push($o.map(yr=>o.av(yr.id,yr.scope)))))}}let gt,Yt,In,ho;Wt.trim();const co={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Oo=()=>{if(gt)return this.status="done",it(gt);if(this.extraShadowCaster)this.status="done",it(null,{buckets:o.be(kt).filter(Eo=>!Eo.isEmpty()),featureIndex:qt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Qt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Yt&&In&&ho){const Eo=new B(Yt),cr=new o.dU(In,ho,this.lut);for(const rr in kt){const qo=kt[rr];qo instanceof o.aS?(D(qo.layers,this.zoom,Qt.brightness,qe),o.dV(qo,Yt,Eo.positions,In,cr.iconPositions,this.showCollisionBoxes,qe,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.brightness)):qo.hasPattern&&(qo instanceof o.aY||qo instanceof o.aZ||qo instanceof o.d0)&&(D(qo.layers,this.zoom,Qt.brightness,qe),qo.addFeatures(Qt,this.tileID.canonical,cr.patternPositions,qe,this.tileTransform,this.brightness))}this.status="done",it(null,{buckets:o.be(kt).filter(rr=>!rr.isEmpty()),featureIndex:qt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Eo.image,lineAtlas:Wt,imageAtlas:cr,brightness:Qt.brightness})}};if(!this.extraShadowCaster){const Eo=o.dT(Qt.glyphDependencies,qo=>Object.keys(qo).map(Number));Object.keys(Eo).length?mt.send("getGlyphs",{uid:this.uid,stacks:Eo,scope:this.scope},(qo,cn)=>{gt||(gt=qo,Yt=cn,Oo())},void 0,!1,co):Yt={};const cr=Object.keys(Qt.iconDependencies);cr.length?mt.send("getImages",{icons:cr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(qo,cn)=>{gt||(gt=qo,In=cn,Oo())},void 0,!1,co):In={};const rr=Object.keys(Qt.patternDependencies);rr.length?mt.send("getImages",{icons:rr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(qo,cn)=>{gt||(gt=qo,ho=cn,Oo())},void 0,!1,co):ho={}}Oo()}}function D(Zt,Ee,ke,qe){const mt=new o.a3(Ee,{brightness:ke});for(const it of Zt)it.recalculate(mt,qe)}class j extends o.E{constructor(Ee,ke,qe,mt,it,xt){super(),this.actor=Ee,this.layerIndex=ke,this.availableImages=qe,this.loadVectorData=it||o.aw,this.loading={},this.loaded={},this.deduped=new o.au(Ee.scheduler),this.isSpriteLoaded=mt,this.scheduler=Ee.scheduler,this.brightness=xt}loadTile(Ee,ke){const qe=Ee.uid,mt=Ee&&Ee.request,it=mt&&mt.collectResourceTiming,xt=this.loading[qe]=new N(Ee);xt.abort=this.loadVectorData(Ee,(qt,kt)=>{const Wt=!this.loading[qe];if(delete this.loading[qe],Wt||qt||!kt)return xt.status="done",Wt||(this.loaded[qe]=xt),ke(qt);const Qt=kt.rawData,nn={};kt.expires&&(nn.expires=kt.expires),kt.cacheControl&&(nn.cacheControl=kt.cacheControl),xt.vectorTile=kt.vectorTile||new o.dW.VectorTile(new o.bc(Qt));const gt=()=>{xt.parse(xt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Yt,In)=>{if(Yt||!In)return ke(Yt);const ho={};if(it){const co=w(mt);co.length>0&&(ho.resourceTiming=JSON.parse(JSON.stringify(co)))}ke(null,o.l({rawTileData:Qt.slice(0)},In,nn,ho))})};this.isSpriteLoaded?gt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(gt,{type:"parseTile",isSymbolTile:Ee.isSymbolTile,zoom:Ee.tileZoom}):gt()}),this.loaded=this.loaded||{},this.loaded[qe]=xt})}reloadTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;if(qe&&qe[mt]){const it=qe[mt];it.scaleFactor=Ee.scaleFactor,it.showCollisionBoxes=Ee.showCollisionBoxes,it.projection=Ee.projection,it.brightness=Ee.brightness,it.tileTransform=o.aL(Ee.tileID.canonical,Ee.projection),it.extraShadowCaster=Ee.extraShadowCaster,it.lut=Ee.lut;const xt=(qt,kt)=>{const Wt=it.reloadCallback;Wt&&(delete it.reloadCallback,it.parse(it.vectorTile,this.layerIndex,this.availableImages,this.actor,Wt)),ke(qt,kt)};it.status==="parsing"?it.reloadCallback=xt:it.status==="done"&&(it.vectorTile?it.parse(it.vectorTile,this.layerIndex,this.availableImages,this.actor,xt):xt())}else ke(null,void 0)}abortTile(Ee,ke){const qe=Ee.uid,mt=this.loading[qe];mt&&(mt.abort&&mt.abort(),delete this.loading[qe]),ke()}removeTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;qe&&qe[mt]&&delete qe[mt],ke()}}class U{loadTile(Ee,ke){const{uid:qe,encoding:mt,rawImageData:it,padding:xt}=Ee,qt=ImageBitmap&&it instanceof ImageBitmap?this.getImageData(it,xt):it;ke(null,new o.dX(qe,qt,mt,xt<1))}getImageData(Ee,ke){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ee.width,Ee.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Ee.width,this.offscreenCanvas.height=Ee.height,this.offscreenCanvasContext.drawImage(Ee,0,0,Ee.width,Ee.height);const qe=this.offscreenCanvasContext.getImageData(-ke,-ke,Ee.width+2*ke,Ee.height+2*ke);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),qe}}o.bb.setPbf(o.bc);class ne{decodeRasterArray({task:Ee,buffer:ke},qe){o.bb.performDecoding(ke,Ee).then(mt=>{qe(null,mt)},mt=>{qe(mt)})}}const K=o.dW.VectorTileFeature.prototype.toGeoJSON;class G{constructor(Ee){this._feature=Ee,this.extent=o.ab,this.type=Ee.type,this.properties=Ee.tags,"id"in Ee&&!isNaN(Ee.id)&&(this.id=parseInt(Ee.id,10))}loadGeometry(){if(this._feature.type===1){const Ee=[];for(const ke of this._feature.geometry)Ee.push([new o.P(ke[0],ke[1])]);return Ee}{const Ee=[];for(const ke of this._feature.geometry){const qe=[];for(const mt of ke)qe.push(new o.P(mt[0],mt[1]));Ee.push(qe)}return Ee}}toGeoJSON(Ee,ke,qe){return K.call(this,Ee,ke,qe)}}class J{constructor(Ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.ab,this.length=Ee.length,this._features=Ee}feature(Ee){return new G(this._features[Ee])}}const oe=64/4096,se=128;class me{constructor(){this.features=new Map}clear(){this.features.clear()}load(Ee=[],ke){for(const qe of Ee){const mt=qe.id;if(mt==null)continue;let it=this.features.get(mt);it&&this.updateCache(it,ke),qe.geometry?(it=ce(qe),this.updateCache(it,ke),this.features.set(mt,it)):this.features.delete(mt),this.updateCache(it,ke)}}updateCache(Ee,ke){for(const{canonical:qe,uid:mt}of Object.values(ke)){const{z:it,x:xt,y:qt}=qe;de(Ee,Math.pow(2,it),xt,qt)&&delete ke[mt]}}getTile(Ee,ke,qe){const mt=Math.pow(2,Ee),it=[];for(const xt of this.features.values())de(xt,mt,ke,qe)&&it.push(Je(xt,mt,ke,qe));return{features:it}}getFeatures(){return[...this.features.values()]}}function de({minX:Zt,minY:Ee,maxX:ke,maxY:qe},mt,it,xt){return Zt<(it+1+oe)/mt&&Ee<(xt+1+oe)/mt&&ke>(it-oe)/mt&&qe>(xt-oe)/mt}function ce(Zt){const{id:Ee,geometry:ke,properties:qe}=Zt;if(!ke)return;if(ke.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:mt,coordinates:it}=ke,xt={id:Ee,type:1,geometry:[],tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},qt=xt.geometry;if(mt==="Point")pe(it,qt,xt);else if(mt==="MultiPoint")for(const kt of it)pe(kt,qt,xt);else if(mt==="LineString")xt.type=2,ge(it,qt,xt);else if(mt==="MultiLineString")xt.type=2,Re(it,qt,xt);else if(mt==="Polygon")xt.type=3,Re(it,qt,xt,!0);else{if(mt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");xt.type=3;for(const kt of it)Re(kt,qt,xt,!0)}return xt}function pe([Zt,Ee],ke,qe){const mt=o.am(Zt);let it=o.at(Ee);it=it<0?0:it>1?1:it,ke.push(mt,it),qe.minX=Math.min(qe.minX,mt),qe.minY=Math.min(qe.minY,it),qe.maxX=Math.max(qe.maxX,mt),qe.maxY=Math.max(qe.maxY,it)}function ge(Zt,Ee,ke,qe=!1,mt=!1){const it=[];for(const xt of Zt)pe(xt,it,ke);Ee.push(it),qe&&function(xt,qt){let kt=0;for(let Wt=0,Qt=xt.length,nn=Qt-2;Wt<Qt;nn=Wt,Wt+=2)kt+=(xt[Wt]-xt[nn])*(xt[Wt+1]+xt[nn+1]);if(kt>0===qt)for(let Wt=0,Qt=xt.length;Wt<Qt/2;Wt+=2){const nn=xt[Wt],gt=xt[Wt+1];xt[Wt]=xt[Qt-2-Wt],xt[Wt+1]=xt[Qt-1-Wt],xt[Qt-2-Wt]=nn,xt[Qt-1-Wt]=gt}}(it,mt)}function Re(Zt,Ee,ke,qe=!1){for(let mt=0;mt<Zt.length;mt++)ge(Zt[mt],Ee,ke,qe,mt===0)}function Je(Zt,Ee,ke,qe){const{id:mt,type:it,geometry:xt,tags:qt}=Zt,kt=[];if(it===1)(function(Wt,Qt,nn,gt,Yt){for(let In=0;In<Wt.length;In+=2){const ho=Math.round(o.ab*(Wt[In+0]*Qt-nn)),co=Math.round(o.ab*(Wt[In+1]*Qt-gt));Yt.push([ho,co])}})(xt,Ee,ke,qe,kt);else for(const Wt of xt)Me(Wt,Ee,ke,qe,kt);return{id:mt,type:it,geometry:kt,tags:qt}}function Me(Zt,Ee,ke,qe,mt){const it=-se,xt=o.ab+se;let qt;for(let kt=0;kt<Zt.length-2;kt+=2){let Wt=Math.round(o.ab*(Zt[kt+0]*Ee-ke)),Qt=Math.round(o.ab*(Zt[kt+1]*Ee-qe)),nn=Math.round(o.ab*(Zt[kt+2]*Ee-ke)),gt=Math.round(o.ab*(Zt[kt+3]*Ee-qe));const Yt=nn-Wt,In=gt-Qt;Wt<it&&nn<it||(Wt<it?(Qt+=Math.round(In*((it-Wt)/Yt)),Wt=it):nn<it&&(gt=Qt+Math.round(In*((it-Wt)/Yt)),nn=it),Qt<it&&gt<it||(Qt<it?(Wt+=Math.round(Yt*((it-Qt)/In)),Qt=it):gt<it&&(nn=Wt+Math.round(Yt*((it-Qt)/In)),gt=it),Wt>=xt&&nn>=xt||(Wt>=xt?(Qt+=Math.round(In*((xt-Wt)/Yt)),Wt=xt):nn>=xt&&(gt=Qt+Math.round(In*((xt-Wt)/Yt)),nn=xt),Qt>=xt&&gt>=xt||(Qt>=xt?(Wt+=Math.round(Yt*((xt-Qt)/In)),Qt=xt):gt>=xt&&(nn=Wt+Math.round(Yt*((xt-Qt)/In)),gt=xt),qt&&Wt===qt[qt.length-1][0]&&Qt===qt[qt.length-1][1]||(qt=[[Wt,Qt]],mt.push(qt)),qt.push([nn,gt])))))}}var xe,Ae,Ce,ve={exports:{}},Ne=function(){if(Ce)return ve.exports;Ce=1;var Zt=o.d_(),Ee=function(){if(Ae)return xe;Ae=1;var Qt=o.dY(),nn=o.dZ().VectorTileFeature;function gt(In,ho){this.options=ho||{},this.features=In,this.length=In.length}function Yt(In,ho){this.id=typeof In.id=="number"?In.id:void 0,this.type=In.type,this.rawGeometry=In.type===1?[In.geometry]:In.geometry,this.properties=In.tags,this.extent=ho||4096}return xe=gt,gt.prototype.feature=function(In){return new Yt(this.features[In],this.options.extent)},Yt.prototype.loadGeometry=function(){var In=this.rawGeometry;this.geometry=[];for(var ho=0;ho<In.length;ho++){for(var co=In[ho],Oo=[],Eo=0;Eo<co.length;Eo++)Oo.push(new Qt(co[Eo][0],co[Eo][1]));this.geometry.push(Oo)}return this.geometry},Yt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var In=this.geometry,ho=1/0,co=-1/0,Oo=1/0,Eo=-1/0,cr=0;cr<In.length;cr++)for(var rr=In[cr],qo=0;qo<rr.length;qo++){var cn=rr[qo];ho=Math.min(ho,cn.x),co=Math.max(co,cn.x),Oo=Math.min(Oo,cn.y),Eo=Math.max(Eo,cn.y)}return[ho,Oo,co,Eo]},Yt.prototype.toGeoJSON=nn.prototype.toGeoJSON,xe}();function ke(Qt){var nn=new Zt;return function(gt,Yt){for(var In in gt.layers)Yt.writeMessage(3,qe,gt.layers[In])}(Qt,nn),nn.finish()}function qe(Qt,nn){var gt;nn.writeVarintField(15,Qt.version||1),nn.writeStringField(1,Qt.name||""),nn.writeVarintField(5,Qt.extent||4096);var Yt={keys:[],values:[],keycache:{},valuecache:{}};for(gt=0;gt<Qt.length;gt++)Yt.feature=Qt.feature(gt),nn.writeMessage(2,mt,Yt);var In=Yt.keys;for(gt=0;gt<In.length;gt++)nn.writeStringField(3,In[gt]);var ho=Yt.values;for(gt=0;gt<ho.length;gt++)nn.writeMessage(4,Wt,ho[gt])}function mt(Qt,nn){var gt=Qt.feature;gt.id!==void 0&&nn.writeVarintField(1,gt.id),nn.writeMessage(2,it,Qt),nn.writeVarintField(3,gt.type),nn.writeMessage(4,kt,gt)}function it(Qt,nn){var gt=Qt.feature,Yt=Qt.keys,In=Qt.values,ho=Qt.keycache,co=Qt.valuecache;for(var Oo in gt.properties){var Eo=gt.properties[Oo],cr=ho[Oo];if(Eo!==null){cr===void 0&&(Yt.push(Oo),ho[Oo]=cr=Yt.length-1),nn.writeVarint(cr);var rr=typeof Eo;rr!=="string"&&rr!=="boolean"&&rr!=="number"&&(Eo=JSON.stringify(Eo));var qo=rr+":"+Eo,cn=co[qo];cn===void 0&&(In.push(Eo),co[qo]=cn=In.length-1),nn.writeVarint(cn)}}}function xt(Qt,nn){return(nn<<3)+(7&Qt)}function qt(Qt){return Qt<<1^Qt>>31}function kt(Qt,nn){for(var gt=Qt.loadGeometry(),Yt=Qt.type,In=0,ho=0,co=gt.length,Oo=0;Oo<co;Oo++){var Eo=gt[Oo],cr=1;Yt===1&&(cr=Eo.length),nn.writeVarint(xt(1,cr));for(var rr=Yt===3?Eo.length-1:Eo.length,qo=0;qo<rr;qo++){qo===1&&Yt!==1&&nn.writeVarint(xt(2,rr-1));var cn=Eo[qo].x-In,Yn=Eo[qo].y-ho;nn.writeVarint(qt(cn)),nn.writeVarint(qt(Yn)),In+=cn,ho+=Yn}Yt===3&&nn.writeVarint(xt(7,1))}}function Wt(Qt,nn){var gt=typeof Qt;gt==="string"?nn.writeStringField(1,Qt):gt==="boolean"?nn.writeBooleanField(7,Qt):gt==="number"&&(Qt%1!=0?nn.writeDoubleField(3,Qt):Qt<0?nn.writeSVarintField(6,Qt):nn.writeVarintField(5,Qt))}return ve.exports=ke,ve.exports.fromVectorTileJs=ke,ve.exports.fromGeojsonVt=function(Qt,nn){nn=nn||{};var gt={};for(var Yt in Qt)gt[Yt]=new Ee(Qt[Yt].features,nn),gt[Yt].name=Yt,gt[Yt].version=nn.version,gt[Yt].extent=nn.extent;return ke({layers:gt})},ve.exports.GeoJSONWrapper=Ee,ve.exports}(),We=o.d$(Ne);const ot={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Zt=>Zt},Oe=Math.fround||(Ct=new Float32Array(1),Zt=>(Ct[0]=+Zt,Ct[0]));var Ct;const Mt=3,zt=5,bt=6;class Kt{constructor(Ee){this.options=Object.assign(Object.create(ot),Ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Ee){const{log:ke,minZoom:qe,maxZoom:mt}=this.options;ke&&console.time("total time");const it=`prepare ${Ee.length} points`;ke&&console.time(it),this.points=Ee;const xt=[];for(let kt=0;kt<Ee.length;kt++){const Wt=Ee[kt];if(!Wt.geometry)continue;const[Qt,nn]=Wt.geometry.coordinates,gt=Oe(dn(Qt)),Yt=Oe(At(nn));xt.push(gt,Yt,1/0,kt,-1,1),this.options.reduce&&xt.push(0)}let qt=this.trees[mt+1]=this._createTree(xt);ke&&console.timeEnd(it);for(let kt=mt;kt>=qe;kt--){const Wt=+Date.now();qt=this.trees[kt]=this._createTree(this._cluster(qt,kt)),ke&&console.log("z%d: %d clusters in %dms",kt,qt.numItems,+Date.now()-Wt)}return ke&&console.timeEnd("total time"),this}getClusters(Ee,ke){let qe=((Ee[0]+180)%360+360)%360-180;const mt=Math.max(-90,Math.min(90,Ee[1]));let it=Ee[2]===180?180:((Ee[2]+180)%360+360)%360-180;const xt=Math.max(-90,Math.min(90,Ee[3]));if(Ee[2]-Ee[0]>=360)qe=-180,it=180;else if(qe>it){const nn=this.getClusters([qe,mt,180,xt],ke),gt=this.getClusters([-180,mt,it,xt],ke);return nn.concat(gt)}const qt=this.trees[this._limitZoom(ke)],kt=qt.range(dn(qe),At(xt),dn(it),At(mt)),Wt=qt.data,Qt=[];for(const nn of kt){const gt=this.stride*nn;Qt.push(Wt[gt+zt]>1?$t(Wt,gt,this.clusterProps):this.points[Wt[gt+Mt]])}return Qt}getChildren(Ee){const ke=this._getOriginId(Ee),qe=this._getOriginZoom(Ee),mt="No cluster with the specified id.",it=this.trees[qe];if(!it)throw new Error(mt);const xt=it.data;if(ke*this.stride>=xt.length)throw new Error(mt);const qt=this.options.radius/(this.options.extent*Math.pow(2,qe-1)),kt=it.within(xt[ke*this.stride],xt[ke*this.stride+1],qt),Wt=[];for(const Qt of kt){const nn=Qt*this.stride;xt[nn+4]===Ee&&Wt.push(xt[nn+zt]>1?$t(xt,nn,this.clusterProps):this.points[xt[nn+Mt]])}if(Wt.length===0)throw new Error(mt);return Wt}getLeaves(Ee,ke,qe){const mt=[];return this._appendLeaves(mt,Ee,ke=ke||10,qe=qe||0,0),mt}getTile(Ee,ke,qe){const mt=this.trees[this._limitZoom(Ee)],it=Math.pow(2,Ee),{extent:xt,radius:qt}=this.options,kt=qt/xt,Wt=(qe-kt)/it,Qt=(qe+1+kt)/it,nn={features:[]};return this._addTileFeatures(mt.range((ke-kt)/it,Wt,(ke+1+kt)/it,Qt),mt.data,ke,qe,it,nn),ke===0&&this._addTileFeatures(mt.range(1-kt/it,Wt,1,Qt),mt.data,it,qe,it,nn),ke===it-1&&this._addTileFeatures(mt.range(0,Wt,kt/it,Qt),mt.data,-1,qe,it,nn),nn.features.length?nn:null}getClusterExpansionZoom(Ee){let ke=this._getOriginZoom(Ee)-1;for(;ke<=this.options.maxZoom;){const qe=this.getChildren(Ee);if(ke++,qe.length!==1)break;Ee=qe[0].properties.cluster_id}return ke}_appendLeaves(Ee,ke,qe,mt,it){const xt=this.getChildren(ke);for(const qt of xt){const kt=qt.properties;if(kt&&kt.cluster?it+kt.point_count<=mt?it+=kt.point_count:it=this._appendLeaves(Ee,kt.cluster_id,qe,mt,it):it<mt?it++:Ee.push(qt),Ee.length===qe)break}return it}_createTree(Ee){const ke=new o.bz(Ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let qe=0;qe<Ee.length;qe+=this.stride)ke.add(Ee[qe],Ee[qe+1]);return ke.finish(),ke.data=Ee,ke}_addTileFeatures(Ee,ke,qe,mt,it,xt){for(const qt of Ee){const kt=qt*this.stride,Wt=ke[kt+zt]>1;let Qt,nn,gt;if(Wt)Qt=Le(ke,kt,this.clusterProps),nn=ke[kt],gt=ke[kt+1];else{const ho=this.points[ke[kt+Mt]];Qt=ho.properties;const[co,Oo]=ho.geometry.coordinates;nn=dn(co),gt=At(Oo)}const Yt={type:1,geometry:[[Math.round(this.options.extent*(nn*it-qe)),Math.round(this.options.extent*(gt*it-mt))]],tags:Qt};let In;In=Wt||this.options.generateId?ke[kt+Mt]:this.points[ke[kt+Mt]].id,In!==void 0&&(Yt.id=In),xt.features.push(Yt)}}_limitZoom(Ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+Ee),this.options.maxZoom+1))}_cluster(Ee,ke){const{radius:qe,extent:mt,reduce:it,minPoints:xt}=this.options,qt=qe/(mt*Math.pow(2,ke)),kt=Ee.data,Wt=[],Qt=this.stride;for(let nn=0;nn<kt.length;nn+=Qt){if(kt[nn+2]<=ke)continue;kt[nn+2]=ke;const gt=kt[nn],Yt=kt[nn+1],In=Ee.within(kt[nn],kt[nn+1],qt),ho=kt[nn+zt];let co=ho;for(const Oo of In){const Eo=Oo*Qt;kt[Eo+2]>ke&&(co+=kt[Eo+zt])}if(co>ho&&co>=xt){let Oo,Eo=gt*ho,cr=Yt*ho,rr=-1;const qo=(nn/Qt<<5)+(ke+1)+this.points.length;for(const cn of In){const Yn=cn*Qt;if(kt[Yn+2]<=ke)continue;kt[Yn+2]=ke;const To=kt[Yn+zt];Eo+=kt[Yn]*To,cr+=kt[Yn+1]*To,kt[Yn+4]=qo,it&&(Oo||(Oo=this._map(kt,nn,!0),rr=this.clusterProps.length,this.clusterProps.push(Oo)),it(Oo,this._map(kt,Yn)))}kt[nn+4]=qo,Wt.push(Eo/co,cr/co,1/0,qo,-1,co),it&&Wt.push(rr)}else{for(let Oo=0;Oo<Qt;Oo++)Wt.push(kt[nn+Oo]);if(co>1)for(const Oo of In){const Eo=Oo*Qt;if(!(kt[Eo+2]<=ke)){kt[Eo+2]=ke;for(let cr=0;cr<Qt;cr++)Wt.push(kt[Eo+cr])}}}}return Wt}_getOriginId(Ee){return Ee-this.points.length>>5}_getOriginZoom(Ee){return(Ee-this.points.length)%32}_map(Ee,ke,qe){if(Ee[ke+zt]>1){const xt=this.clusterProps[Ee[ke+bt]];return qe?Object.assign({},xt):xt}const mt=this.points[Ee[ke+Mt]].properties,it=this.options.map(mt);return qe&&it===mt?Object.assign({},it):it}}function $t(Zt,Ee,ke){return{type:"Feature",id:Zt[Ee+Mt],properties:Le(Zt,Ee,ke),geometry:{type:"Point",coordinates:[(qe=Zt[Ee],360*(qe-.5)),Ke(Zt[Ee+1])]}};var qe}function Le(Zt,Ee,ke){const qe=Zt[Ee+zt],mt=qe>=1e4?`${Math.round(qe/1e3)}k`:qe>=1e3?Math.round(qe/100)/10+"k":qe,it=Zt[Ee+bt],xt=it===-1?{}:Object.assign({},ke[it]);return Object.assign(xt,{cluster:!0,cluster_id:Zt[Ee+Mt],point_count:qe,point_count_abbreviated:mt})}function dn(Zt){return Zt/360+.5}function At(Zt){const Ee=Math.sin(Zt*Math.PI/180),ke=.5-.25*Math.log((1+Ee)/(1-Ee))/Math.PI;return ke<0?0:ke>1?1:ke}function Ke(Zt){const Ee=(180-360*Zt)*Math.PI/180;return 360*Math.atan(Math.exp(Ee))/Math.PI-90}function Be(Zt,Ee,ke,qe){let mt=qe;const it=Ee+(ke-Ee>>1);let xt,qt=ke-Ee;const kt=Zt[Ee],Wt=Zt[Ee+1],Qt=Zt[ke],nn=Zt[ke+1];for(let gt=Ee+3;gt<ke;gt+=3){const Yt=Ht(Zt[gt],Zt[gt+1],kt,Wt,Qt,nn);if(Yt>mt)xt=gt,mt=Yt;else if(Yt===mt){const In=Math.abs(gt-it);In<qt&&(xt=gt,qt=In)}}mt>qe&&(xt-Ee>3&&Be(Zt,Ee,xt,qe),Zt[xt+2]=mt,ke-xt>3&&Be(Zt,xt,ke,qe))}function Ht(Zt,Ee,ke,qe,mt,it){let xt=mt-ke,qt=it-qe;if(xt!==0||qt!==0){const kt=((Zt-ke)*xt+(Ee-qe)*qt)/(xt*xt+qt*qt);kt>1?(ke=mt,qe=it):kt>0&&(ke+=xt*kt,qe+=qt*kt)}return xt=Zt-ke,qt=Ee-qe,xt*xt+qt*qt}function Ut(Zt,Ee,ke,qe){const mt={id:Zt??null,type:Ee,geometry:ke,tags:qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")Nt(mt,ke);else if(Ee==="Polygon")Nt(mt,ke[0]);else if(Ee==="MultiLineString")for(const it of ke)Nt(mt,it);else if(Ee==="MultiPolygon")for(const it of ke)Nt(mt,it[0]);return mt}function Nt(Zt,Ee){for(let ke=0;ke<Ee.length;ke+=3)Zt.minX=Math.min(Zt.minX,Ee[ke]),Zt.minY=Math.min(Zt.minY,Ee[ke+1]),Zt.maxX=Math.max(Zt.maxX,Ee[ke]),Zt.maxY=Math.max(Zt.maxY,Ee[ke+1])}function Et(Zt,Ee,ke,qe){if(!Ee.geometry)return;const mt=Ee.geometry.coordinates;if(mt&&mt.length===0)return;const it=Ee.geometry.type,xt=Math.pow(ke.tolerance/((1<<ke.maxZoom)*ke.extent),2);let qt=[],kt=Ee.id;if(ke.promoteId?kt=Ee.properties[ke.promoteId]:ke.generateId&&(kt=qe||0),it==="Point")Gt(mt,qt);else if(it==="MultiPoint")for(const Wt of mt)Gt(Wt,qt);else if(it==="LineString")ln(mt,qt,xt,!1);else if(it==="MultiLineString"){if(ke.lineMetrics){for(const Wt of mt)qt=[],ln(Wt,qt,xt,!1),Zt.push(Ut(kt,"LineString",qt,Ee.properties));return}bn(mt,qt,xt,!1)}else if(it==="Polygon")bn(mt,qt,xt,!0);else{if(it!=="MultiPolygon"){if(it==="GeometryCollection"){for(const Wt of Ee.geometry.geometries)Et(Zt,{id:kt,geometry:Wt,properties:Ee.properties},ke,qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Wt of mt){const Qt=[];bn(Wt,Qt,xt,!0),qt.push(Qt)}}Zt.push(Ut(kt,it,qt,Ee.properties))}function Gt(Zt,Ee){Ee.push(_n(Zt[0]),jn(Zt[1]),0)}function ln(Zt,Ee,ke,qe){let mt,it,xt=0;for(let kt=0;kt<Zt.length;kt++){const Wt=_n(Zt[kt][0]),Qt=jn(Zt[kt][1]);Ee.push(Wt,Qt,0),kt>0&&(xt+=qe?(mt*Qt-Wt*it)/2:Math.sqrt(Math.pow(Wt-mt,2)+Math.pow(Qt-it,2))),mt=Wt,it=Qt}const qt=Ee.length-3;Ee[2]=1,Be(Ee,0,qt,ke),Ee[qt+2]=1,Ee.size=Math.abs(xt),Ee.start=0,Ee.end=Ee.size}function bn(Zt,Ee,ke,qe){for(let mt=0;mt<Zt.length;mt++){const it=[];ln(Zt[mt],it,ke,qe),Ee.push(it)}}function _n(Zt){return Zt/360+.5}function jn(Zt){const Ee=Math.sin(Zt*Math.PI/180),ke=.5-.25*Math.log((1+Ee)/(1-Ee))/Math.PI;return ke<0?0:ke>1?1:ke}function yt(Zt,Ee,ke,qe,mt,it,xt,qt){if(qe/=Ee,it>=(ke/=Ee)&&xt<qe)return Zt;if(xt<ke||it>=qe)return null;const kt=[];for(const Wt of Zt){const Qt=Wt.geometry;let nn=Wt.type;const gt=mt===0?Wt.minX:Wt.minY,Yt=mt===0?Wt.maxX:Wt.maxY;if(gt>=ke&&Yt<qe){kt.push(Wt);continue}if(Yt<ke||gt>=qe)continue;let In=[];if(nn==="Point"||nn==="MultiPoint")kn(Qt,In,ke,qe,mt);else if(nn==="LineString")qn(Qt,In,ke,qe,mt,!1,qt.lineMetrics);else if(nn==="MultiLineString")mo(Qt,In,ke,qe,mt,!1);else if(nn==="Polygon")mo(Qt,In,ke,qe,mt,!0);else if(nn==="MultiPolygon")for(const ho of Qt){const co=[];mo(ho,co,ke,qe,mt,!0),co.length&&In.push(co)}if(In.length){if(qt.lineMetrics&&nn==="LineString"){for(const ho of In)kt.push(Ut(Wt.id,nn,ho,Wt.tags));continue}nn!=="LineString"&&nn!=="MultiLineString"||(In.length===1?(nn="LineString",In=In[0]):nn="MultiLineString"),nn!=="Point"&&nn!=="MultiPoint"||(nn=In.length===3?"Point":"MultiPoint"),kt.push(Ut(Wt.id,nn,In,Wt.tags))}}return kt.length?kt:null}function kn(Zt,Ee,ke,qe,mt){for(let it=0;it<Zt.length;it+=3){const xt=Zt[it+mt];xt>=ke&&xt<=qe&&Io(Ee,Zt[it],Zt[it+1],Zt[it+2])}}function qn(Zt,Ee,ke,qe,mt,it,xt){let qt=Co(Zt);const kt=mt===0?Ho:ur;let Wt,Qt,nn=Zt.start;for(let co=0;co<Zt.length-3;co+=3){const Oo=Zt[co],Eo=Zt[co+1],cr=Zt[co+2],rr=Zt[co+3],qo=Zt[co+4],cn=mt===0?Oo:Eo,Yn=mt===0?rr:qo;let To=!1;xt&&(Wt=Math.sqrt(Math.pow(Oo-rr,2)+Math.pow(Eo-qo,2))),cn<ke?Yn>ke&&(Qt=kt(qt,Oo,Eo,rr,qo,ke),xt&&(qt.start=nn+Wt*Qt)):cn>qe?Yn<qe&&(Qt=kt(qt,Oo,Eo,rr,qo,qe),xt&&(qt.start=nn+Wt*Qt)):Io(qt,Oo,Eo,cr),Yn<ke&&cn>=ke&&(Qt=kt(qt,Oo,Eo,rr,qo,ke),To=!0),Yn>qe&&cn<=qe&&(Qt=kt(qt,Oo,Eo,rr,qo,qe),To=!0),!it&&To&&(xt&&(qt.end=nn+Wt*Qt),Ee.push(qt),qt=Co(Zt)),xt&&(nn+=Wt)}let gt=Zt.length-3;const Yt=Zt[gt],In=Zt[gt+1],ho=mt===0?Yt:In;ho>=ke&&ho<=qe&&Io(qt,Yt,In,Zt[gt+2]),gt=qt.length-3,it&&gt>=3&&(qt[gt]!==qt[0]||qt[gt+1]!==qt[1])&&Io(qt,qt[0],qt[1],qt[2]),qt.length&&Ee.push(qt)}function Co(Zt){const Ee=[];return Ee.size=Zt.size,Ee.start=Zt.start,Ee.end=Zt.end,Ee}function mo(Zt,Ee,ke,qe,mt,it){for(const xt of Zt)qn(xt,Ee,ke,qe,mt,it,!1)}function Io(Zt,Ee,ke,qe){Zt.push(Ee,ke,qe)}function Ho(Zt,Ee,ke,qe,mt,it){const xt=(it-Ee)/(qe-Ee);return Io(Zt,it,ke+(mt-ke)*xt,1),xt}function ur(Zt,Ee,ke,qe,mt,it){const xt=(it-ke)/(mt-ke);return Io(Zt,Ee+(qe-Ee)*xt,it,1),xt}function Dt(Zt,Ee){const ke=[];for(let qe=0;qe<Zt.length;qe++){const mt=Zt[qe],it=mt.type;let xt;if(it==="Point"||it==="MultiPoint"||it==="LineString")xt=En(mt.geometry,Ee);else if(it==="MultiLineString"||it==="Polygon"){xt=[];for(const qt of mt.geometry)xt.push(En(qt,Ee))}else if(it==="MultiPolygon"){xt=[];for(const qt of mt.geometry){const kt=[];for(const Wt of qt)kt.push(En(Wt,Ee));xt.push(kt)}}ke.push(Ut(mt.id,it,xt,mt.tags))}return ke}function En(Zt,Ee){const ke=[];ke.size=Zt.size,Zt.start!==void 0&&(ke.start=Zt.start,ke.end=Zt.end);for(let qe=0;qe<Zt.length;qe+=3)ke.push(Zt[qe]+Ee,Zt[qe+1],Zt[qe+2]);return ke}function ft(Zt,Ee){if(Zt.transformed)return Zt;const ke=1<<Zt.z,qe=Zt.x,mt=Zt.y;for(const it of Zt.features){const xt=it.geometry,qt=it.type;if(it.geometry=[],qt===1)for(let kt=0;kt<xt.length;kt+=2)it.geometry.push(un(xt[kt],xt[kt+1],Ee,ke,qe,mt));else for(let kt=0;kt<xt.length;kt++){const Wt=[];for(let Qt=0;Qt<xt[kt].length;Qt+=2)Wt.push(un(xt[kt][Qt],xt[kt][Qt+1],Ee,ke,qe,mt));it.geometry.push(Wt)}}return Zt.transformed=!0,Zt}function un(Zt,Ee,ke,qe,mt,it){return[Math.round(ke*(Zt*qe-mt)),Math.round(ke*(Ee*qe-it))]}function et(Zt,Ee,ke,qe,mt){const it=Ee===mt.maxZoom?0:mt.tolerance/((1<<Ee)*mt.extent),xt={features:[],numPoints:0,numSimplified:0,numFeatures:Zt.length,source:null,x:ke,y:qe,z:Ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const qt of Zt)Mn(xt,qt,it,mt);return xt}function Mn(Zt,Ee,ke,qe){const mt=Ee.geometry,it=Ee.type,xt=[];if(Zt.minX=Math.min(Zt.minX,Ee.minX),Zt.minY=Math.min(Zt.minY,Ee.minY),Zt.maxX=Math.max(Zt.maxX,Ee.maxX),Zt.maxY=Math.max(Zt.maxY,Ee.maxY),it==="Point"||it==="MultiPoint")for(let qt=0;qt<mt.length;qt+=3)xt.push(mt[qt],mt[qt+1]),Zt.numPoints++,Zt.numSimplified++;else if(it==="LineString")Bn(xt,mt,Zt,ke,!1,!1);else if(it==="MultiLineString"||it==="Polygon")for(let qt=0;qt<mt.length;qt++)Bn(xt,mt[qt],Zt,ke,it==="Polygon",qt===0);else if(it==="MultiPolygon")for(let qt=0;qt<mt.length;qt++){const kt=mt[qt];for(let Wt=0;Wt<kt.length;Wt++)Bn(xt,kt[Wt],Zt,ke,!0,Wt===0)}if(xt.length){let qt=Ee.tags||null;if(it==="LineString"&&qe.lineMetrics){qt={};for(const Wt in Ee.tags)qt[Wt]=Ee.tags[Wt];qt.mapbox_clip_start=mt.start/mt.size,qt.mapbox_clip_end=mt.end/mt.size}const kt={geometry:xt,type:it==="Polygon"||it==="MultiPolygon"?3:it==="LineString"||it==="MultiLineString"?2:1,tags:qt};Ee.id!==null&&(kt.id=Ee.id),Zt.features.push(kt)}}function Bn(Zt,Ee,ke,qe,mt,it){const xt=qe*qe;if(qe>0&&Ee.size<(mt?xt:qe))return void(ke.numPoints+=Ee.length/3);const qt=[];for(let kt=0;kt<Ee.length;kt+=3)(qe===0||Ee[kt+2]>xt)&&(ke.numSimplified++,qt.push(Ee[kt],Ee[kt+1])),ke.numPoints++;mt&&function(kt,Wt){let Qt=0;for(let nn=0,gt=kt.length,Yt=gt-2;nn<gt;Yt=nn,nn+=2)Qt+=(kt[nn]-kt[Yt])*(kt[nn+1]+kt[Yt+1]);if(Qt>0===Wt)for(let nn=0,gt=kt.length;nn<gt/2;nn+=2){const Yt=kt[nn],In=kt[nn+1];kt[nn]=kt[gt-2-nn],kt[nn+1]=kt[gt-1-nn],kt[gt-2-nn]=Yt,kt[gt-1-nn]=In}}(qt,it),Zt.push(qt)}const Lo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Rr{constructor(Ee,ke){const qe=(ke=this.options=function(it,xt){for(const qt in xt)it[qt]=xt[qt];return it}(Object.create(Lo),ke)).debug;if(qe&&console.time("preprocess data"),ke.maxZoom<0||ke.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ke.promoteId&&ke.generateId)throw new Error("promoteId and generateId cannot be used together.");let mt=function(it,xt){const qt=[];if(it.type==="FeatureCollection")for(let kt=0;kt<it.features.length;kt++)Et(qt,it.features[kt],xt,kt);else Et(qt,it.type==="Feature"?it:{geometry:it},xt);return qt}(Ee,ke);this.tiles={},this.tileCoords=[],qe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ke.indexMaxZoom,ke.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),mt=function(it,xt){const qt=xt.buffer/xt.extent;let kt=it;const Wt=yt(it,1,-1-qt,qt,0,-1,2,xt),Qt=yt(it,1,1-qt,2+qt,0,-1,2,xt);return(Wt||Qt)&&(kt=yt(it,1,-qt,1+qt,0,-1,2,xt)||[],Wt&&(kt=Dt(Wt,1).concat(kt)),Qt&&(kt=kt.concat(Dt(Qt,-1)))),kt}(mt,ke),mt.length&&this.splitTile(mt,0,0,0),qe&&(mt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Ee,ke,qe,mt,it,xt,qt){const kt=[Ee,ke,qe,mt],Wt=this.options,Qt=Wt.debug;for(;kt.length;){mt=kt.pop(),qe=kt.pop(),ke=kt.pop(),Ee=kt.pop();const nn=1<<ke,gt=hi(ke,qe,mt);let Yt=this.tiles[gt];if(!Yt&&(Qt>1&&console.time("creation"),Yt=this.tiles[gt]=et(Ee,ke,qe,mt,Wt),this.tileCoords.push({z:ke,x:qe,y:mt}),Qt)){Qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ke,qe,mt,Yt.numFeatures,Yt.numPoints,Yt.numSimplified),console.timeEnd("creation"));const To=`z${ke}`;this.stats[To]=(this.stats[To]||0)+1,this.total++}if(Yt.source=Ee,it==null){if(ke===Wt.indexMaxZoom||Yt.numPoints<=Wt.indexMaxPoints)continue}else{if(ke===Wt.maxZoom||ke===it)continue;if(it!=null){const To=it-ke;if(qe!==xt>>To||mt!==qt>>To)continue}}if(Yt.source=null,Ee.length===0)continue;Qt>1&&console.time("clipping");const In=.5*Wt.buffer/Wt.extent,ho=.5-In,co=.5+In,Oo=1+In;let Eo=null,cr=null,rr=null,qo=null,cn=yt(Ee,nn,qe-In,qe+co,0,Yt.minX,Yt.maxX,Wt),Yn=yt(Ee,nn,qe+ho,qe+Oo,0,Yt.minX,Yt.maxX,Wt);Ee=null,cn&&(Eo=yt(cn,nn,mt-In,mt+co,1,Yt.minY,Yt.maxY,Wt),cr=yt(cn,nn,mt+ho,mt+Oo,1,Yt.minY,Yt.maxY,Wt),cn=null),Yn&&(rr=yt(Yn,nn,mt-In,mt+co,1,Yt.minY,Yt.maxY,Wt),qo=yt(Yn,nn,mt+ho,mt+Oo,1,Yt.minY,Yt.maxY,Wt),Yn=null),Qt>1&&console.timeEnd("clipping"),kt.push(Eo||[],ke+1,2*qe,2*mt),kt.push(cr||[],ke+1,2*qe,2*mt+1),kt.push(rr||[],ke+1,2*qe+1,2*mt),kt.push(qo||[],ke+1,2*qe+1,2*mt+1)}}getTile(Ee,ke,qe){Ee=+Ee,ke=+ke,qe=+qe;const mt=this.options,{extent:it,debug:xt}=mt;if(Ee<0||Ee>24)return null;const qt=1<<Ee,kt=hi(Ee,ke=ke+qt&qt-1,qe);if(this.tiles[kt])return ft(this.tiles[kt],it);xt>1&&console.log("drilling down to z%d-%d-%d",Ee,ke,qe);let Wt,Qt=Ee,nn=ke,gt=qe;for(;!Wt&&Qt>0;)Qt--,nn>>=1,gt>>=1,Wt=this.tiles[hi(Qt,nn,gt)];return Wt&&Wt.source?(xt>1&&(console.log("found parent tile z%d-%d-%d",Qt,nn,gt),console.time("drilling down")),this.splitTile(Wt.source,Qt,nn,gt,Ee,ke,qe),xt>1&&console.timeEnd("drilling down"),this.tiles[kt]?ft(this.tiles[kt],it):null):null}}function hi(Zt,Ee,ke){return 32*((1<<Zt)*ke+Ee)+Zt}function Er(Zt,Ee){const ke=Zt.tileID.canonical;if(!this._geoJSONIndex)return void Ee(null,null);const qe=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!qe)return void Ee(null,null);const mt=new J(qe.features);let it=We(mt);it.byteOffset===0&&it.byteLength===it.buffer.byteLength||(it=new Uint8Array(it)),Ee(null,{vectorTile:mt,rawData:it.buffer})}class Nr extends j{constructor(Ee,ke,qe,mt,it,xt){super(Ee,ke,qe,mt,Er,xt),it&&(this.loadGeoJSON=it),this._dynamicIndex=new me}loadData(Ee,ke){const qe=Ee&&Ee.request,mt=qe&&qe.collectResourceTiming;this.loadGeoJSON(Ee,(it,xt)=>{if(it||!xt)return ke(it);if(typeof xt!="object")return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`));{try{if(Ee.filter){const kt=o.M(Ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(kt.result==="error")throw new Error(kt.value.map(Wt=>`${Wt.key}: ${Wt.message}`).join(", "));xt.features=xt.features.filter(Wt=>kt.value.evaluate({zoom:0},Wt))}Ee.dynamic?(xt.type==="Feature"&&(xt={type:"FeatureCollection",features:[xt]}),Ee.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(xt.features,this.loaded),Ee.cluster&&(xt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Ee.cluster?new Kt(function({superclusterOptions:kt,clusterProperties:Wt}){if(!Wt||!kt)return kt;const Qt={},nn={},gt={accumulated:null,zoom:0},Yt={properties:null},In=Object.keys(Wt);for(const ho of In){const[co,Oo]=Wt[ho],Eo=o.M(Oo),cr=o.M(typeof co=="string"?[co,["accumulated"],["get",ho]]:co);Qt[ho]=Eo.value,nn[ho]=cr.value}return kt.map=ho=>{Yt.properties=ho;const co={};for(const Oo of In)co[Oo]=Qt[Oo].evaluate(gt,Yt);return co},kt.reduce=(ho,co)=>{Yt.properties=co;for(const Oo of In)gt.accumulated=ho[Oo],ho[Oo]=nn[Oo].evaluate(gt,Yt)},kt}(Ee)).load(xt.features):Ee.dynamic?this._dynamicIndex:function(kt,Wt){return new Rr(kt,Wt)}(xt,Ee.geojsonVtOptions)}catch(kt){return ke(kt)}const qt={};if(mt){const kt=w(qe);kt&&(qt.resourceTiming={},qt.resourceTiming[Ee.source]=JSON.parse(JSON.stringify(kt)))}ke(null,qt)}})}reloadTile(Ee,ke){const qe=this.loaded;return qe&&qe[Ee.uid]?Ee.partial?ke(null,void 0):super.reloadTile(Ee,ke):this.loadTile(Ee,ke)}loadGeoJSON(Ee,ke){if(Ee.request)o.n(Ee.request,ke);else{if(typeof Ee.data!="string")return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`));try{return ke(null,JSON.parse(Ee.data))}catch{return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Ee,ke){try{ke(null,this._geoJSONIndex.getClusterExpansionZoom(Ee.clusterId))}catch(qe){ke(qe)}}getClusterChildren(Ee,ke){try{ke(null,this._geoJSONIndex.getChildren(Ee.clusterId))}catch(qe){ke(qe)}}getClusterLeaves(Ee,ke){try{ke(null,this._geoJSONIndex.getLeaves(Ee.clusterId,Ee.limit,Ee.offset))}catch(qe){ke(qe)}}}class Xo{constructor(Ee,ke){this.tileID=new o.aA(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),this.tileZoom=Ee.tileZoom,this.uid=Ee.uid,this.zoom=Ee.zoom,this.canonical=Ee.tileID.canonical,this.pixelRatio=Ee.pixelRatio,this.tileSize=Ee.tileSize,this.source=Ee.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Ee.projection,this.brightness=ke}parse(Ee,ke,qe,mt){this.status="parsing";const it=new o.aA(qe.tileID.overscaledZ,qe.tileID.wrap,qe.tileID.canonical.z,qe.tileID.canonical.x,qe.tileID.canonical.y),xt=[],qt=ke.familiesBySource[qe.source],kt=new o.dR(it,qe.promoteId);return kt.bucketLayerIDs=[],kt.is3DTile=!0,o.e0(Ee).then(Wt=>{if(!Wt)return mt(new Error("Could not parse tile"));const Qt=o.e1(Wt,1/o.c9(qe.tileID.canonical)),nn=Wt.json.extensionsUsed&&Wt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Wt.json.asset.extras&&Wt.json.asset.extras.MAPBOX_mesh_features,gt=Wt.json.extensionsUsed&&Wt.json.extensionsUsed.includes("EXT_meshopt_compression"),Yt=new o.a3(this.zoom,{brightness:this.brightness});for(const In in qt)for(const ho of qt[In]){const co=ho[0];kt.bucketLayerIDs.push(ho.map(Eo=>o.av(Eo.id,Eo.scope))),co.recalculate(Yt,[]);const Oo=new o.e2(ho,Qt,it,nn,gt,this.brightness,kt);nn||(Oo.needsUpload=!0),xt.push(Oo),Oo.evaluate(co)}this.status="done",mt(null,{buckets:xt,featureIndex:kt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Wt=>mt(new Error(Wt.message)))}}class Bi{constructor(Ee,ke,qe,mt,it,xt){this.actor=Ee,this.layerIndex=ke,this.availableImages=qe,this.brightness=xt,this.loading={},this.loaded={}}loadTile(Ee,ke){const qe=Ee.uid,mt=this.loading[qe]=new Xo(Ee,this.brightness);o.bd(Ee.request,(it,xt)=>{const qt=!this.loading[qe];return delete this.loading[qe],qt||it?(mt.status="done",qt||(this.loaded[qe]=mt),ke(it)):xt&&xt.byteLength!==0?void mt.parse(xt,this.layerIndex,Ee,(kt,Wt)=>{mt.status="done",this.loaded=this.loaded||{},this.loaded[qe]=mt,kt||!Wt?ke(kt):ke(null,Wt)}):(mt.status="done",this.loaded[qe]=mt,ke())})}reloadTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;if(qe&&qe[mt]){const it=qe[mt];it.projection=Ee.projection,it.brightness=Ee.brightness;const xt=(qt,kt)=>{it.reloadCallback&&(delete it.reloadCallback,this.loadTile(Ee,ke)),ke(qt,kt)};it.status==="parsing"?it.reloadCallback=xt:it.status==="done"&&this.loadTile(Ee,ke)}}abortTile(Ee,ke){const qe=Ee.uid;this.loading[qe]&&delete this.loading[qe],ke()}removeTile(Ee,ke){const qe=this.loaded,mt=Ee.uid;qe&&qe[mt]&&delete qe[mt],ke()}}class $s{constructor(Ee){this.self=Ee,this.actor=new o.e3(Ee,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.bM({name:"mercator"}),this.workerSourceTypes={vector:j,geojson:Nr,"batched-model":Bi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ke,qe)=>{if(this.workerSourceTypes[ke])throw new Error(`Worker source with name "${ke}" already registered.`);this.workerSourceTypes[ke]=qe},this.self.registerRTLTextPlugin=ke=>{if(o.e4.isParsed())throw new Error("RTL text plugin already registered.");o.e4.applyArabicShaping=ke.applyArabicShaping,o.e4.processBidirectionalText=ke.processBidirectionalText,o.e4.processStyledBidirectionalText=ke.processStyledBidirectionalText}}clearCaches(Ee,ke,qe){delete this.layerIndexes[Ee],delete this.availableImages[Ee],delete this.workerSources[Ee],delete this.demWorkerSources[Ee],delete this.rasterArrayWorkerSource,qe()}checkIfReady(Ee,ke,qe){qe()}setReferrer(Ee,ke){this.referrer=ke}spriteLoaded(Ee,{scope:ke,isLoaded:qe}){if(this.isSpriteLoaded[Ee]||(this.isSpriteLoaded[Ee]={}),this.isSpriteLoaded[Ee][ke]=qe,this.workerSources[Ee]&&this.workerSources[Ee][ke])for(const mt in this.workerSources[Ee][ke]){const it=this.workerSources[Ee][ke][mt];for(const xt in it){const qt=it[xt];qt instanceof j&&(qt.isSpriteLoaded=qe,qt.fire(new o.x("isSpriteLoaded")))}}}setImages(Ee,{scope:ke,images:qe},mt){if(this.availableImages[Ee]||(this.availableImages[Ee]={}),this.availableImages[Ee][ke]=qe,this.workerSources[Ee]&&this.workerSources[Ee][ke]){for(const it in this.workerSources[Ee][ke]){const xt=this.workerSources[Ee][ke][it];for(const qt in xt)xt[qt].availableImages=qe}mt()}else mt()}setProjection(Ee,ke){this.projections[Ee]=o.bM(ke)}setBrightness(Ee,ke,qe){this.brightness=ke,qe()}setLayers(Ee,ke,qe){this.getLayerIndex(Ee,ke.scope).replace(ke.layers,ke.options),qe()}updateLayers(Ee,ke,qe){this.getLayerIndex(Ee,ke.scope).update(ke.layers,ke.removedIds,ke.options),qe()}loadTile(Ee,ke,qe){ke.projection=this.projections[Ee]||this.defaultProjection,this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).loadTile(ke,qe)}loadDEMTile(Ee,ke,qe){this.getDEMWorkerSource(Ee,ke.source,ke.scope).loadTile(ke,qe)}decodeRasterArray(Ee,ke,qe){this.getRasterArrayWorkerSource().decodeRasterArray(ke,qe)}reloadTile(Ee,ke,qe){ke.projection=this.projections[Ee]||this.defaultProjection,this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).reloadTile(ke,qe)}abortTile(Ee,ke,qe){this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).abortTile(ke,qe)}removeTile(Ee,ke,qe){this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).removeTile(ke,qe)}removeSource(Ee,ke,qe){if(!(this.workerSources[Ee]&&this.workerSources[Ee][ke.scope]&&this.workerSources[Ee][ke.scope][ke.type]&&this.workerSources[Ee][ke.scope][ke.type][ke.source]))return;const mt=this.workerSources[Ee][ke.scope][ke.type][ke.source];delete this.workerSources[Ee][ke.scope][ke.type][ke.source],mt.removeSource!==void 0?mt.removeSource(ke,qe):qe()}loadWorkerSource(Ee,ke,qe){try{this.self.importScripts(ke.url),qe()}catch(mt){qe(mt.toString())}}syncRTLPluginState(Ee,ke,qe){try{o.e4.setState(ke);const mt=o.e4.getPluginURL();if(o.e4.isLoaded()&&!o.e4.isParsed()&&mt!=null){this.self.importScripts(mt);const it=o.e4.isParsed();qe(it?void 0:new Error(`RTL Text Plugin failed to import scripts from ${mt}`),it)}}catch(mt){qe(mt.toString())}}setDracoUrl(Ee,ke){this.dracoUrl=ke}getAvailableImages(Ee,ke){this.availableImages[Ee]||(this.availableImages[Ee]={});let qe=this.availableImages[Ee][ke];return qe||(qe=[]),qe}getLayerIndex(Ee,ke){this.layerIndexes[Ee]||(this.layerIndexes[Ee]={});let qe=this.layerIndexes[Ee][ke];return qe||(qe=this.layerIndexes[Ee][ke]=new I,qe.scope=ke),qe}getWorkerSource(Ee,ke,qe,mt){return this.workerSources[Ee]||(this.workerSources[Ee]={}),this.workerSources[Ee][mt]||(this.workerSources[Ee][mt]={}),this.workerSources[Ee][mt][ke]||(this.workerSources[Ee][mt][ke]={}),this.isSpriteLoaded[Ee]||(this.isSpriteLoaded[Ee]={}),this.workerSources[Ee][mt][ke][qe]||(this.workerSources[Ee][mt][ke][qe]=new this.workerSourceTypes[ke]({send:(it,xt,qt,kt,Wt,Qt)=>{this.actor.send(it,xt,qt,Ee,Wt,Qt)},scheduler:this.actor.scheduler},this.getLayerIndex(Ee,mt),this.getAvailableImages(Ee,mt),this.isSpriteLoaded[Ee][mt],void 0,this.brightness)),this.workerSources[Ee][mt][ke][qe]}getDEMWorkerSource(Ee,ke,qe){return this.demWorkerSources[Ee]||(this.demWorkerSources[Ee]={}),this.demWorkerSources[Ee][qe]||(this.demWorkerSources[Ee][qe]={}),this.demWorkerSources[Ee][qe][ke]||(this.demWorkerSources[Ee][qe][ke]=new U),this.demWorkerSources[Ee][qe][ke]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new ne),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Ee,ke){o.e5(ke)}getWorkerPerformanceMetrics(Ee,ke,qe){qe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new $s(self)),$s}),p(["./shared"],function(o){var w="3.8.0";const C={create:"create",load:"load",fullLoad:"fullLoad"},M={mark(f){performance.mark(f)},measure(f,r,l){performance.measure(f,r,l)}};function I(f){const r=f.name.split("?")[0];return o.a(r)&&r.includes("mapbox-gl.js")?"javascript":o.a(r)&&r.includes("mapbox-gl.css")?"css":o.b(r)?"fontRange":o.c(r)?"sprite":o.i(r)?"style":o.d(r)?"tilejson":"other"}var F,B={},N=function(){if(F)return B;function f(m){return!r(m)}function r(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,E,z=new Blob([""],{type:"text/javascript"}),V=URL.createObjectURL(z);try{E=new Worker(V),S=!0}catch{S=!1}return E&&E.terminate(),URL.revokeObjectURL(V),S}()?function(){var S=document.createElement("canvas");S.width=S.height=1;var E=S.getContext("2d");if(!E)return!1;var z=E.getImageData(0,0,1,1);return z&&z.width===S.width}()?(l[b=m&&m.failIfMajorPerformanceCaveat]===void 0&&(l[b]=function(S){var E,z=function(V){var q=document.createElement("canvas"),H=Object.create(f.webGLContextAttributes);return H.failIfMajorPerformanceCaveat=V,q.getContext("webgl2",H)}(S);if(!z)return!1;try{E=z.createShader(z.VERTEX_SHADER)}catch{return!1}return!(!E||z.isContextLost())&&(z.shaderSource(E,"void main() {}"),z.compileShader(E),z.getShaderParameter(E,z.COMPILE_STATUS)===!0)}(b)),l[b]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var b}F=1,B.supported=f,B.notSupportedReason=r;var l={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},B}();function D(f,r,l){const m=document.createElement(f);return r!=null&&(m.className=r),l&&l.appendChild(m),m}function j(f,r,l){const m=document.createElementNS("http://www.w3.org/2000/svg",f);for(const b of Object.keys(r))m.setAttributeNS(null,b,String(r[b]));return l&&l.appendChild(m),m}const U=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ne=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let K;function G(){U&&ne&&(K=U[ne],U[ne]="none")}function J(){U&&ne&&(U[ne]=K)}function oe(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",oe,!0)}function se(){window.addEventListener("click",oe,!0),window.setTimeout(()=>{window.removeEventListener("click",oe,!0)},0)}function me(f,r){const l=f.getBoundingClientRect();return pe(f,l,r)}function de(f,r){const l=f.getBoundingClientRect(),m=[];for(let b=0;b<r.length;b++)m.push(pe(f,l,r[b]));return m}function ce(f){return window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function pe(f,r,l){const m=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new o.P((l.clientX-r.left)*m,(l.clientY-r.top)*m)}const ge="01",Re="NO_ACCESS_TOKEN";class Je{constructor(r,l,m){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let m=0;m<10;m++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ge,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!o.f(r))return r;const m=xe(r);return m.params.push(`sdk=js-${w}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!o.f(r))return r;const m=xe(r);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeModelURL(r,l){if(!o.f(r))return r;const m=xe(r);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeSourceURL(r,l,m,b){if(!o.f(r))return r;const S=xe(r);return S.path=`/v4/${S.authority}.json`,S.params.push("secure"),m&&S.params.push(`language=${m}`),b&&S.params.push(`worldview=${b}`),this._makeAPIURL(S,this._customAccessToken||l)}normalizeSpriteURL(r,l,m,b){const S=xe(r);return o.f(r)?(S.path=`/styles/v1${S.path}/sprite${l}${m}`,this._makeAPIURL(S,this._customAccessToken||b)):(S.path+=`${l}${m}`,Ae(S))}normalizeTileURL(r,l,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!o.f(r))return r;const b=xe(r);b.path=b.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||m&&b.authority!=="raster"&&m===512?"@2x":""}${o.m.supported?".webp":"$1"}`),b.authority==="raster"?b.path=`/${o.e.RASTER_URL_PREFIX}${b.path}`:b.authority==="rasterarrays"?b.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${b.path}`:b.authority==="3dtiles"?b.path=`/${o.e.TILES3D_URL_PREFIX}${b.path}`:(b.path=b.path.replace(/^.+\/v4\//,"/"),b.path=`/${o.e.TILE_URL_VERSION}${b.path}`);const S=this._customAccessToken||function(E){for(const z of E){const V=z.match(/^access_token=(.*)$/);if(V)return V[1]}return null}(b.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&S&&this._skuToken&&b.params.push(`sku=${this._skuToken}`),this._makeAPIURL(b,S)}canonicalizeTileURL(r,l){const m=xe(r);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return r;let b="mapbox://";m.path.match(/^\/raster\/v1\//)?b+=`raster/${m.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?b+=`rasterarrays/${m.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:b+=`tiles/${m.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let S=m.params;return l&&(S=S.filter(E=>!E.match(/^access_token=/))),S.length&&(b+=`?${S.join("&")}`),b}canonicalizeTileset(r,l){const m=!!l&&o.f(l),b=[];for(const S of r.tiles||[])o.h(S)?b.push(this.canonicalizeTileURL(S,m)):b.push(S);return b}_makeAPIURL(r,l){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",b=xe(o.e.API_URL);if(r.protocol=b.protocol,r.authority=b.authority,r.protocol==="http"){const S=r.params.indexOf("secure");S>=0&&r.params.splice(S,1)}if(b.path!=="/"&&(r.path=`${b.path}${r.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return Ae(r);if(l=l||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return r.params=r.params.filter(S=>S.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Ae(r)}}const Me=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xe(f){const r=f.match(Me);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Ae(f){const r=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${r}`}const Ce="mapbox.eventData";function ve(f){if(!f)return null;const r=f.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(o.j(r[1]))}catch{return null}}class Ne{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=ve(o.e.ACCESS_TOKEN);let m="";return m=l&&l.u?o.k(l.u):o.e.ACCESS_TOKEN||"",r?`${Ce}.${r}:${m}`:`${Ce}:${m}`}fetchEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid");if(r)try{const b=localStorage.getItem(l);b&&(this.eventData=JSON.parse(b));const S=localStorage.getItem(m);S&&(this.anonId=S)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid"),b=this.anonId;if(r&&b)try{localStorage.setItem(m,b),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,m,b){if(!o.e.EVENTS_URL)return;const S=xe(o.e.EVENTS_URL);S.params.push(`access_token=${b||o.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(r).toISOString()},z=l?o.l(E,l):E,V={url:Ae(S),headers:{"Content-Type":"text/plain"},body:JSON.stringify([z])};this.pendingRequest=o.p(V,q=>{this.pendingRequest=null,m(q),this.saveEventData(),this.processRequests(b)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const We=new class extends Ne{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,r){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(l=>o.f(l)||o.h(l))&&this.queueRequest(Date.now(),r)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=ve(o.e.ACCESS_TOKEN),l=r?r.u:o.e.ACCESS_TOKEN;let m=l!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),m=!0);const b=this.queue.shift();if(this.eventData.lastSuccess){const S=new Date(this.eventData.lastSuccess),E=new Date(b),z=(b-this.eventData.lastSuccess)/864e5;m=m||z>=1||z<-1||S.getDate()!==E.getDate()}else m=!0;m?this.postEvent(b,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:ge,"enabled.telemetry":!1,userId:this.anonId},S=>{S||(this.eventData.lastSuccess=b,this.eventData.tokenU=l)},f):this.processRequests()}},ot=We.postTurnstileEvent.bind(We),Oe=new class extends Ne{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,r,l,m){this.skuToken=r,this.errorCb=m,o.e.EVENTS_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(Re)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:ge,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},f))}remove(){this.errorCb=null}},Ct=Oe.postMapLoadEvent.bind(Oe),Mt=new class extends Ne{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let r=this.mapInstanceIdMap.get(f);return r||(r=o.u(),this.mapInstanceIdMap.set(f,r)),r}getEventId(f){const r=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,r+1),r}postStyleLoadEvent(f,r){const{map:l,style:m,importedStyles:b}=r;if(!o.e.EVENTS_URL||!f&&!o.e.ACCESS_TOKEN)return;const S=this.getMapInstanceId(l),E={mapInstanceId:S,eventId:this.getEventId(S),style:m};b.length&&(E.importedStyles=b),this.queueRequest({timestamp:Date.now(),payload:E},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},f)}},zt=Mt.postStyleLoadEvent.bind(Mt),bt=new class extends Ne{constructor(){super("gljs.performance")}postPerformanceEvent(f,r){o.e.EVENTS_URL&&(f||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),m=function(b){const S=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),z=function(ae){const be={};if(ae){for(const ye in ae)if(ye!=="other")for(const Te of ae[ye]){const Se=`${ye}ResolveRangeMin`,De=`${ye}ResolveRangeMax`,je=`${ye}RequestCount`,He=`${ye}RequestCachedCount`;be[Se]=Math.min(be[Se]||1/0,Te.startTime),be[De]=Math.max(be[De]||-1/0,Te.responseEnd);const Ye=tt=>{be[tt]===void 0&&(be[tt]=0),++be[tt]};Te.transferSize!==void 0&&Te.transferSize===0&&Ye(He),Ye(je)}}return be}(function(ae,be){const ye={};if(ae)for(const Te of ae){const Se=be(Te);ye[Se]===void 0&&(ye[Se]=[]),ye[Se].push(Te)}return ye}(S,I)),V=window.devicePixelRatio,q=navigator.connection||navigator.mozConnection||navigator.webkitConnection,H=q?q.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},ee=(ae,be,ye)=>{ye!=null&&ae.push({name:be,value:ye.toString()})};for(const ae in z)ee(X.counters,ae,z[ae]);if(b.interactionRange[0]!==1/0&&b.interactionRange[1]!==-1/0&&(ee(X.counters,"interactionRangeMin",b.interactionRange[0]),ee(X.counters,"interactionRangeMax",b.interactionRange[1])),E)for(const ae of Object.keys(C)){const be=C[ae],ye=E.find(Te=>Te.name===be);ye&&ee(X.counters,be,ye.startTime)}return ee(X.counters,"visibilityHidden",b.visibilityHidden),ee(X.attributes,"style",function(ae){if(ae)for(const be of ae){const ye=be.name.split("?")[0];if(o.i(ye)){const Te=ye.split("/").slice(-2);if(Te.length===2)return`mapbox://styles/${Te[0]}/${Te[1]}`}}}(S)),ee(X.attributes,"terrainEnabled",b.terrainEnabled?"true":"false"),ee(X.attributes,"fogEnabled",b.fogEnabled?"true":"false"),ee(X.attributes,"projection",b.projection),ee(X.attributes,"zoom",b.zoom),ee(X.metadata,"devicePixelRatio",V),ee(X.metadata,"connectionEffectiveType",H),ee(X.metadata,"navigatorUserAgent",navigator.userAgent),ee(X.metadata,"screenWidth",window.screen.width),ee(X.metadata,"screenHeight",window.screen.height),ee(X.metadata,"windowWidth",window.innerWidth),ee(X.metadata,"windowHeight",window.innerHeight),ee(X.metadata,"mapWidth",b.width/V),ee(X.metadata,"mapHeight",b.height/V),ee(X.metadata,"webglRenderer",b.renderer),ee(X.metadata,"webglVendor",b.vendor),ee(X.metadata,"sdkVersion",w),ee(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(l);for(const b of m.metadata);for(const b of m.counters);for(const b of m.attributes);this.postEvent(r,m,()=>{},f)}},Kt=bt.postPerformanceEvent.bind(bt),$t=new class extends Ne{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,r,l,m){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const b=xe(o.e.API_URL+o.e.SESSION_PATH);b.params.push(`sku=${r||""}`),b.params.push(`access_token=${m||o.e.ACCESS_TOKEN||""}`);const S={url:Ae(b),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(S,E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(m)})}getSessionAPI(f,r,l,m){this.skuToken=r,this.errorCb=m,o.e.SESSION_PATH&&o.e.API_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(Re)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,m=>{m?this.errorCb(m):r&&(this.success[r]=!0)},f)}remove(){this.errorCb=null}},Le=$t.getSessionAPI.bind($t),dn=new Set;function At(f,r){r?dn.add(f):dn.delete(f)}class Ke{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Be(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ht extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new o.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:m,callback:b}of this.requestors)this._notify(m,l,b);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,m){this._validate(r,m)&&(this.images[l][r]=m)}_validate(r,l){let m=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(l.content,l)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,l){if(!r)return!0;let m=0;for(const b of r){if(b[0]<m||b[1]<b[0]||l<b[1])return!1;m=b[1]}return!0}_validateContent(r,l){return!(r&&(r.length!==4||r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,l,m){m.version=this.images[l][r].version+1,this.images[l][r]=m,this.updatedImages[l][r]=!0}removeImage(r,l){const m=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,m){let b=!0;const S=!!this.loaded[l];if(!S)for(const E of r)this.images[l][E]||(b=!1);S||b?this._notify(r,l,m):this.requestors.push({ids:r,scope:l,callback:m})}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,m){const b={};for(const S of r){this.images[l][S]||this.fire(new o.x("styleimagemissing",{id:S}));const E=this.images[l][S];E?b[S]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:o.w(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,b)}getPixelSize(r){const{width:l,height:m}=this.atlasImage[r];return{width:l,height:m}}getPattern(r,l,m){const b=this.patterns[l][r],S=this.getImage(r,l);if(!S)return null;if(b&&b.position.version===S.version)return b.position;if(b)b.position.version=S.version;else{const E={w:S.data.width+2*o.y,h:S.data.height+2*o.y,x:0,y:0},z=new o.I(E,S,o.y);this.patterns[l][r]={bin:E,position:z}}return this._updatePatternAtlas(l,m),this.patterns[l][r].position}bind(r,l){const m=r.gl;let b=this.atlasTexture[l];b?this.dirty&&(b.update(this.atlasImage[l]),this.dirty=!1):(b=new o.T(r,this.atlasImage[l],m.RGBA8),this.atlasTexture[l]=b),b.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const m=[];for(const z in this.patterns[r])m.push(this.patterns[r][z].bin);const{w:b,h:S}=o.z(m),E=this.atlasImage[r];E.resize({width:b||1,height:S||1});for(const z in this.patterns[r]){const{bin:V,position:q}=this.patterns[r][z];let H=q.padding;const X=V.x+H,ee=V.y+H,ae=this.images[r][z].data,be=ae.width,ye=ae.height;H=H>1?H-1:H,o.r.copy(ae,E,{x:0,y:0},{x:X,y:ee},{width:be,height:ye},l),o.r.copy(ae,E,{x:0,y:ye-H},{x:X,y:ee-H},{width:be,height:H},l),o.r.copy(ae,E,{x:0,y:0},{x:X,y:ee+ye},{width:be,height:H},l),o.r.copy(ae,E,{x:be-H,y:0},{x:X-H,y:ee},{width:H,height:ye},l),o.r.copy(ae,E,{x:0,y:0},{x:X+be,y:ee},{width:H,height:ye},l),o.r.copy(ae,E,{x:be-H,y:ye-H},{x:X-H,y:ee-H},{width:H,height:H},l),o.r.copy(ae,E,{x:0,y:ye-H},{x:X+be,y:ee-H},{width:H,height:H},l),o.r.copy(ae,E,{x:0,y:0},{x:X+be,y:ee+ye},{width:H,height:H},l),o.r.copy(ae,E,{x:be-H,y:0},{x:X-H,y:ee+ye},{width:H,height:H},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const m of r){if(this.callbackDispatchedThisFrame[l][m])continue;this.callbackDispatchedThisFrame[l][m]=!0;const b=this.images[l][m];Be(b)&&this.updateImage(m,l,b)}}}function Ut(f){const r=f.key,l=f.value,m=f.valueSpec||{},b=f.objectElementValidators||{},S=f.style,E=f.styleSpec;let z=[];const V=o.B(l);if(V!=="object")return[new o.V(r,l,`object expected, ${V} found`)];for(const q in l){const H=q.split(".")[0];let X;b[H]?X=b[H]:m[H]?X=Bn:b["*"]?X=b["*"]:m["*"]&&(X=Bn),X?z=z.concat(X({key:(r&&`${r}.`)+q,value:l[q],valueSpec:m[H]||m["*"],style:S,styleSpec:E,object:l,objectKey:q},l)):z.push(new o.A(r,l[q],`unknown property "${q}"`))}for(const q in m)b[q]||m[q].required&&m[q].default===void 0&&l[q]===void 0&&z.push(new o.V(r,l,`missing required property "${q}"`));return z}function Nt(f){const r=f.value,l=f.valueSpec,m=f.style,b=f.styleSpec,S=f.key,E=f.arrayElementValidator||Bn;if(o.B(r)!=="array")return[new o.V(S,r,`array expected, ${o.B(r)} found`)];if(l.length&&r.length!==l.length)return[new o.V(S,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new o.V(S,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let z={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};b.$version<7&&(z.function=l.function),o.B(l.value)==="object"&&(z=l.value);let V=[];for(let q=0;q<r.length;q++)V=V.concat(E({array:r,arrayIndex:q,value:r[q],valueSpec:z,style:m,styleSpec:b,key:`${S}[${q}]`},!0));return V}function Et(f){const r=f.key,l=f.value,m=f.valueSpec;let b=o.B(l);if(b==="number"&&l!=l&&(b="NaN"),b!=="number")return[new o.V(r,l,`number expected, ${b} found`)];if("minimum"in m){let S=m.minimum;if(o.B(m.minimum)==="array"&&(S=m.minimum[f.arrayIndex]),l<S)return[new o.V(r,l,`${l} is less than the minimum value ${S}`)]}if("maximum"in m){let S=m.maximum;if(o.B(m.maximum)==="array"&&(S=m.maximum[f.arrayIndex]),l>S)return[new o.V(r,l,`${l} is greater than the maximum value ${S}`)]}return[]}function Gt(f){const r=f.valueSpec,l=o.D(f.value.type);let m,b,S,E={};const z=l!=="categorical"&&f.value.property===void 0,V=!z,q=o.B(f.value.stops)==="array"&&o.B(f.value.stops[0])==="array"&&o.B(f.value.stops[0][0])==="object",H=Ut({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ae){if(l==="identity")return[new o.V(ae.key,ae.value,'identity function may not have a "stops" property')];let be=[];const ye=ae.value;return be=be.concat(Nt({key:ae.key,value:ye,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),o.B(ye)==="array"&&ye.length===0&&be.push(new o.V(ae.key,ye,"array must have at least one stop")),be},default:function(ae){return Bn({key:ae.key,value:ae.value,valueSpec:r,style:ae.style,styleSpec:ae.styleSpec})}}});return l==="identity"&&z&&H.push(new o.V(f.key,f.value,'missing required property "property"')),l==="identity"||f.value.stops||H.push(new o.V(f.key,f.value,'missing required property "stops"')),l==="exponential"&&f.valueSpec.expression&&!o.F(f.valueSpec)&&H.push(new o.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(V&&!o.G(f.valueSpec)?H.push(new o.V(f.key,f.value,"property functions not supported")):z&&!o.H(f.valueSpec)&&H.push(new o.V(f.key,f.value,"zoom functions not supported"))),l!=="categorical"&&!q||f.value.property!==void 0||H.push(new o.V(f.key,f.value,'"property" property is required')),H;function X(ae){let be=[];const ye=ae.value,Te=ae.key;if(o.B(ye)!=="array")return[new o.V(Te,ye,`array expected, ${o.B(ye)} found`)];if(ye.length!==2)return[new o.V(Te,ye,`array length 2 expected, length ${ye.length} found`)];if(q){if(o.B(ye[0])!=="object")return[new o.V(Te,ye,`object expected, ${o.B(ye[0])} found`)];if(ye[0].zoom===void 0)return[new o.V(Te,ye,"object stop key must have zoom")];if(ye[0].value===void 0)return[new o.V(Te,ye,"object stop key must have value")];const Se=o.D(ye[0].zoom);if(typeof Se!="number")return[new o.V(Te,ye[0].zoom,"stop zoom values must be numbers")];if(S&&S>Se)return[new o.V(Te,ye[0].zoom,"stop zoom values must appear in ascending order")];Se!==S&&(S=Se,b=void 0,E={}),be=be.concat(Ut({key:`${Te}[0]`,value:ye[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:Et,value:ee}}))}else be=be.concat(ee({key:`${Te}[0]`,value:ye[0]},ye));return o.J(o.K(ye[1]))?be.concat([new o.V(`${Te}[1]`,ye[1],"expressions are not allowed in function stops.")]):be.concat(Bn({key:`${Te}[1]`,value:ye[1],valueSpec:r,style:ae.style,styleSpec:ae.styleSpec}))}function ee(ae,be){const ye=o.B(ae.value),Te=o.D(ae.value),Se=ae.value!==null?ae.value:be;if(m){if(ye!==m)return[new o.V(ae.key,Se,`${ye} stop domain type must match previous stop domain type ${m}`)]}else m=ye;if(ye!=="number"&&ye!=="string"&&ye!=="boolean"&&typeof Te!="number"&&typeof Te!="string"&&typeof Te!="boolean")return[new o.V(ae.key,Se,"stop domain value must be a number, string, or boolean")];if(ye!=="number"&&l!=="categorical"){let De=`number expected, ${ye} found`;return o.G(r)&&l===void 0&&(De+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(ae.key,Se,De)]}return l!=="categorical"||ye!=="number"||typeof Te=="number"&&isFinite(Te)&&Math.floor(Te)===Te?l!=="categorical"&&ye==="number"&&typeof Te=="number"&&typeof b=="number"&&b!==void 0&&Te<b?[new o.V(ae.key,Se,"stop domain values must appear in ascending order")]:(b=Te,l==="categorical"&&Te in E?[new o.V(ae.key,Se,"stop domain values must be unique")]:(E[Te]=!0,[])):[new o.V(ae.key,Se,`integer expected, found ${String(Te)}`)]}}function ln(f){const r=(f.expressionContext==="property"?o.L:o.M)(o.K(f.value),f.valueSpec);if(r.result==="error")return r.value.map(m=>new o.V(`${f.key}${m.key}`,f.value,m.message));const l=r.value.expression||r.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!l.outputDefined())return[new o.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!o.N(l))return[new o.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return bn(l,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!o.O(l,["zoom","feature-state"]))return[new o.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!o.Q(l))return[new o.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function bn(f,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const b of r.valueSpec.expression.parameters)l.delete(b);if(l.size===0)return[];const m=[];return f instanceof o.S&&l.has(f.name)?[new o.V(r.key,r.value,`["${f.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(f.eachChild(b=>{m.push(...bn(b,r))}),m)}function _n(f){const r=f.key,l=f.value,m=f.valueSpec,b=[];return Array.isArray(m.values)?m.values.indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${m.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(m.values).indexOf(o.D(l))===-1&&b.push(new o.V(r,l,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(l)} found`)),b}function jn(f){return o.W(o.K(f.value))?ln(o.C({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):yt(f)}function yt(f){const r=f.value,l=f.key;if(o.B(r)!=="array")return[new o.V(l,r,`array expected, ${o.B(r)} found`)];const m=f.styleSpec;let b,S=[];if(r.length<1)return[new o.V(l,r,"filter array must have at least 1 element")];switch(S=S.concat(_n({key:`${l}[0]`,value:r[0],valueSpec:m.filter_operator})),o.D(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&o.D(r[1])==="$type"&&S.push(new o.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&S.push(new o.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(b=o.B(r[1]),b!=="string"&&S.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`)));for(let E=2;E<r.length;E++)b=o.B(r[E]),o.D(r[1])==="$type"?S=S.concat(_n({key:`${l}[${E}]`,value:r[E],valueSpec:m.geometry_type})):b!=="string"&&b!=="number"&&b!=="boolean"&&S.push(new o.V(`${l}[${E}]`,r[E],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let E=1;E<r.length;E++)S=S.concat(yt({key:`${l}[${E}]`,value:r[E],styleSpec:f.styleSpec}));break;case"has":case"!has":b=o.B(r[1]),r.length!==2?S.push(new o.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):b!=="string"&&S.push(new o.V(`${l}[1]`,r[1],`string expected, ${b} found`))}return S}function kn(f,r){const l=f.key,m=f.style,b=f.layer,S=f.styleSpec,E=f.value,z=f.objectKey,V=S[`${r}_${f.layerType}`];if(!V)return[];const q=z.match(/^(.*)-transition$/);if(r==="paint"&&q&&V[q[1]]&&V[q[1]].transition)return Bn({key:l,value:E,valueSpec:S.transition,style:m,styleSpec:S});const H=f.valueSpec||V[z];if(!H)return[new o.A(l,E,`unknown property "${z}"`)];let X;if(o.B(E)==="string"&&o.G(H)&&!H.tokens&&(X=/^{([^}]+)}$/.exec(E))){const ae=`\`{ "type": "identity", "property": ${X?JSON.stringify(X[1]):'"_"'} }\``;return[new o.V(l,E,`"${z}" does not support interpolation syntax
Use an identity property function instead: ${ae}.`)]}const ee=[];if(f.layerType==="symbol")z!=="text-field"||!m||m.glyphs||m.imports||ee.push(new o.V(l,E,'use of "text-field" requires a style "glyphs" property')),z==="text-font"&&o.X(o.K(E))&&o.D(E.type)==="identity"&&ee.push(new o.V(l,E,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&r==="paint"&&b&&b.layout&&b.layout.hasOwnProperty("model-id")&&o.G(H)&&(o.Y(H)||o.H(H))){const ae=o.L(o.K(E),H),be=ae.value.expression||ae.value._styleExpression.expression;be&&!o.O(be,["measure-light"])&&(z==="model-emissive-strength"&&o.Q(be)&&o.N(be)||ee.push(new o.V(l,E,`${z} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ee.concat(Bn({key:f.key,value:E,valueSpec:H,style:m,styleSpec:S,expressionContext:"property",propertyType:r,propertyKey:z}))}function qn(f){return kn(f,"paint")}function Co(f){return kn(f,"layout")}function mo(f){let r=[];const l=f.value,m=f.key,b=f.style,S=f.styleSpec;l.type||l.ref||r.push(new o.V(m,l,'either "type" or "ref" is required'));let E=o.D(l.type);const z=o.D(l.ref);if(l.id){const V=o.D(l.id);for(let q=0;q<f.arrayIndex;q++){const H=b.layers[q];o.D(H.id)===V&&r.push(new o.V(m,l.id,`duplicate layer id "${l.id}", previously used at line ${H.id.__line__}`))}}if("ref"in l){let V;["type","source","source-layer","filter","layout"].forEach(q=>{q in l&&r.push(new o.V(m,l[q],`"${q}" is prohibited for ref layers`))}),b.layers.forEach(q=>{o.D(q.id)===z&&(V=q)}),V?V.ref?r.push(new o.V(m,l.ref,"ref cannot reference another ref layer")):E=o.D(V.type):typeof z=="string"&&r.push(new o.V(m,l.ref,`ref layer "${z}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(l.source){const V=b.sources&&b.sources[l.source],q=V&&o.D(V.type);V?q==="vector"&&E==="raster"?r.push(new o.V(m,l.source,`layer "${l.id}" requires a raster source`)):q==="raster"&&E!=="raster"?r.push(new o.V(m,l.source,`layer "${l.id}" requires a vector source`)):q!=="vector"||l["source-layer"]?q==="raster-dem"&&E!=="hillshade"?r.push(new o.V(m,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):q!=="raster-array"||["raster","raster-particle"].includes(E)?E!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||q==="geojson"&&V.lineMetrics?E==="raster-particle"&&q!=="raster-array"&&r.push(new o.V(m,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new o.V(m,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new o.V(m,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new o.V(m,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new o.V(m,l.source,`source "${l.source}" not found`))}else r.push(new o.V(m,l,'missing required property "source"'));return r=r.concat(Ut({key:m,value:l,valueSpec:S.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Bn({key:`${m}.type`,value:l.type,valueSpec:S.layer.type,style:f.style,styleSpec:f.styleSpec,object:l,objectKey:"type"}),filter:V=>jn(o.C({layerType:E},V)),layout:V=>Ut({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":q=>Co(o.C({layerType:E},q))}}),paint:V=>Ut({layer:l,key:V.key,value:V.value,valueSpec:{},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{"*":q=>qn(o.C({layerType:E,layer:l},q))}})}})),r}function Io(f){const r=f.value,l=f.key,m=o.B(r);return m!=="string"?[new o.V(l,r,`string expected, ${m} found`)]:[]}const Ho={promoteId:function({key:f,value:r}){if(o.B(r)==="string")return Io({key:f,value:r});{const l=[];for(const m in r)l.push(...Io({key:`${f}.${m}`,value:r[m]}));return l}}};function ur(f){const r=f.value,l=f.key,m=f.styleSpec,b=f.style;if(!r.type)return[new o.V(l,r,'"type" is required')];const S=o.D(r.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(S)&&(r.url||r.tiles||E.push(new o.A(l,r,'Either "url" or "tiles" is required.'))),S){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(Ut({key:l,value:r,valueSpec:m[`source_${S.replace("-","_")}`],style:f.style,styleSpec:m,objectElementValidators:Ho})),E;case"geojson":if(E=Ut({key:l,value:r,valueSpec:m.source_geojson,style:b,styleSpec:m,objectElementValidators:Ho}),r.cluster)for(const z in r.clusterProperties){const[V,q]=r.clusterProperties[z],H=typeof V=="string"?[V,["accumulated"],["get",z]]:V;E.push(...ln({key:`${l}.${z}.map`,value:q,expressionContext:"cluster-map"})),E.push(...ln({key:`${l}.${z}.reduce`,value:H,expressionContext:"cluster-reduce"}))}return E;case"video":return Ut({key:l,value:r,valueSpec:m.source_video,style:b,styleSpec:m});case"image":return Ut({key:l,value:r,valueSpec:m.source_image,style:b,styleSpec:m});case"canvas":return[new o.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _n({key:`${l}.type`,value:r.type,valueSpec:{values:Dt(m)}})}}function Dt(f){return f.source.reduce((r,l)=>{const m=f[l];return m.type.type==="enum"&&(r=r.concat(Object.keys(m.type.values))),r},[])}function En(f){const r=f.value,l=f.styleSpec,m=l.light,b=f.style;let S=[];const E=o.B(r);if(r===void 0)return S;if(E!=="object")return S=S.concat([new o.V("light",r,`object expected, ${E} found`)]),S;for(const z in r){const V=z.match(/^(.*)-transition$/);S=S.concat(V&&m[V[1]]&&m[V[1]].transition?Bn({key:z,value:r[z],valueSpec:l.transition,style:b,styleSpec:l}):m[z]?Bn({key:z,value:r[z],valueSpec:m[z],style:b,styleSpec:l}):[new o.V(z,r[z],`unknown property "${z}"`)])}return S}function ft(f){const r=f.value;let l=[];if(!r)return l;const m=o.B(r);if(m!=="object")return l=l.concat([new o.V("light-3d",r,`object expected, ${m} found`)]),l;const b=f.styleSpec,S=b["light-3d"],E=f.key,z=f.style,V=f.style.lights;for(const X of["type","id"])if(!(X in r))return l=l.concat([new o.V("light-3d",r,`missing property ${X} on light`)]),l;if(r.type&&V)for(let X=0;X<f.arrayIndex;X++){const ee=o.D(r.type),ae=V[X];o.D(ae.type)===ee&&l.push(new o.V(E,r.id,`duplicate light type "${r.type}", previously defined at line ${ae.id.__line__}`))}const q=`properties_light_${r.type}`;if(!(q in b))return l=l.concat([new o.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const H=b[q];for(const X in r)if(X==="properties"){const ee=r[X],ae=o.B(ee);if(ae!=="object")return l=l.concat([new o.V("properties",ee,`object expected, ${ae} found`)]),l;for(const be in ee)l=l.concat(H[be]?Bn({key:be,value:ee[be],valueSpec:H[be],style:z,styleSpec:b}):[new o.A(f.key,ee[be],`unknown property "${be}"`)])}else{const ee=X.match(/^(.*)-transition$/);l=l.concat(ee&&S[ee[1]]&&S[ee[1]].transition?Bn({key:X,value:r[X],valueSpec:b.transition,style:z,styleSpec:b}):S[X]?Bn({key:X,value:r[X],valueSpec:S[X],style:z,styleSpec:b}):[new o.A(X,r[X],`unknown property "${X}"`)])}return l}function un(f){const r=f.value,l=f.key,m=f.style,b=f.styleSpec,S=b.terrain;let E=[];const z=o.B(r);if(r===void 0||z==="null")return E;if(z!=="object")return E=E.concat([new o.V("terrain",r,`object expected, ${z} found`)]),E;for(const V in r){const q=V.match(/^(.*)-transition$/);E=E.concat(q&&S[q[1]]&&S[q[1]].transition?Bn({key:V,value:r[V],valueSpec:b.transition,style:m,styleSpec:b}):S[V]?Bn({key:V,value:r[V],valueSpec:S[V],style:m,styleSpec:b}):[new o.A(V,r[V],`unknown property "${V}"`)])}if(r.source){const V=m.sources&&m.sources[r.source],q=V&&o.D(V.type);V?q!=="raster-dem"&&E.push(new o.V(l,r.source,`terrain cannot be used with a source of type ${String(q)}, it only be used with a "raster-dem" source type`)):E.push(new o.V(l,r.source,`source "${r.source}" not found`))}else E.push(new o.V(l,r,'terrain is missing required property "source"'));return E}function et(f){const r=f.value,l=f.style,m=f.styleSpec,b=m.fog;let S=[];const E=o.B(r);if(r===void 0)return S;if(E!=="object")return S=S.concat([new o.V("fog",r,`object expected, ${E} found`)]),S;for(const z in r){const V=z.match(/^(.*)-transition$/);S=S.concat(V&&b[V[1]]&&b[V[1]].transition?Bn({key:z,value:r[z],valueSpec:m.transition,style:l,styleSpec:m}):b[z]?Bn({key:z,value:r[z],valueSpec:b[z],style:l,styleSpec:m}):[new o.A(z,r[z],`unknown property "${z}"`)])}return S}const Mn={"*":()=>[],array:Nt,boolean:function(f){const r=f.value,l=f.key,m=o.B(r);return m!=="boolean"?[new o.V(l,r,`boolean expected, ${m} found`)]:[]},number:Et,color:function(f){const r=f.key,l=f.value,m=o.B(l);return m!=="string"?[new o.V(r,l,`color expected, ${m} found`)]:o.U.parseCSSColor(l)===null?[new o.V(r,l,`color expected, "${l}" found`)]:[]},enum:_n,filter:jn,function:Gt,layer:mo,object:Ut,source:ur,model:o.Z,light:En,"light-3d":ft,terrain:un,fog:et,string:Io,formatted:function(f){return Io(f).length===0?[]:ln(f)},resolvedImage:function(f){return Io(f).length===0?[]:ln(f)},projection:function(f){const r=f.value,l=f.styleSpec,m=l.projection,b=f.style;let S=[];const E=o.B(r);if(E==="object")for(const z in r)S=S.concat(Bn({key:z,value:r[z],valueSpec:m[z],style:b,styleSpec:l}));else E!=="string"&&(S=S.concat([new o.V("projection",r,`object or string expected, ${E} found`)]));return S},import:function(f){const{value:r,styleSpec:l}=f,{data:m,...b}=r;Object.defineProperty(b,"__line__",{value:r.__line__,enumerable:!1});let S=Ut(o.C({},f,{value:b,valueSpec:l.import}));return o.D(b.id)===""&&S.push(new o.V(`${f.key}.id`,b,"import id can't be an empty string")),m&&(S=S.concat(Rr(m,l,{key:`${f.key}.data`}))),S}};function Bn(f,r=!1){const l=f.value,m=f.valueSpec,b=f.styleSpec;if(m.expression&&o.X(o.D(l)))return Gt(f);if(m.expression&&o.J(o.K(l)))return ln(f);if(m.type&&Mn[m.type]){const S=Mn[m.type](f);return r===!0&&S.length>0&&o.B(f.value)==="array"?ln(f):S}return Ut(o.C({},f,{valueSpec:m.type?b[m.type]:m}))}function Lo(f){const r=f.value,l=f.key,m=Io(f);return m.length||(r.indexOf("{fontstack}")===-1&&m.push(new o.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&m.push(new o.V(l,r,'"glyphs" url must include a "{range}" token'))),m}function Rr(f,r=o._,l={}){return Bn({key:l.key||"",value:f,valueSpec:r.$root,styleSpec:r,style:f,objectElementValidators:{glyphs:Lo,"*":()=>[]}})}function hi(f,r=o._){return it(Rr(f,r))}const Er=f=>it(ur(f)),Nr=f=>it(En(f)),Xo=f=>it(ft(f)),Bi=f=>it(un(f)),$s=f=>it(et(f)),Zt=f=>it(mo(f)),Ee=f=>it(jn(f)),ke=f=>it(qn(f)),qe=f=>it(Co(f)),mt=f=>it(o.Z(f));function it(f){return f.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function xt(f,r){let l=!1;if(r&&r.length)for(const m of r)m instanceof o.A?o.w(m.message):(f.fire(new o.t(new Error(m.message))),l=!0);return l}let qt;class kt extends o.E{constructor(r,l="flat"){super(),this._transitionable=new o.$(qt||(qt=new o.a0({anchor:new o.a1(o._.light.anchor),position:new o.a2(o._.light.position),color:new o.a1(o._.light.color),intensity:new o.a1(o._.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,m={}){this._validate(Nr,r,m)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&xt(this,r.call(hi,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}let Wt=class extends o.E{constructor(f,r,l,m){super(),this.scope=l,this._transitionable=new o.$(new o.a0({source:new o.a1(o._.terrain.source),exaggeration:new o.a1(o._.terrain.exaggeration)}),l,m),this._transitionable.setTransitionOrValue(f,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(f,r){this._transitionable.setTransitionOrValue(f,r)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new o.a3(f)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const f=this._transitionable._values.exaggeration;if(!f)return null;const r=f.value.expression;if(!r)return null;let l=-1,m=-1,b=1;for(const S of r.zoomStops)b=r.evaluate(new o.a3(S)),b>.01?(l=S,m=-1):m=S;return b<.01&&l>0&&m>l?[l,m]:null}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof o.a4}};const Qt=45,nn=65,gt=.05;function Yt(f,r,l,m){const b=o.a7(Qt,nn,l),[S,E]=In(f,m);let z=1-Math.min(1,Math.exp((r-S)/(E-S)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*b*f.alpha}function In(f,r){const l=.5/Math.tan(.5*r);return[f.range[0]+l,f.range[1]+l]}function ho(f,r,l,m,b){const S=o.a6.vec3.transformMat4([],[r,l,m],b.mercatorFogMatrix);return Yt(f,o.a6.vec3.length(S),b.pitch,b._fov)}function co(f,r,l,m,b,S,E){const z=[[l,m,0],[b,m,0],[b,S,0],[l,S,0]];let V=Number.MAX_VALUE,q=-Number.MAX_VALUE;for(const H of z){const X=o.a6.vec3.transformMat4([],H,r),ee=o.a6.vec3.length(X);V=Math.min(V,ee),q=Math.max(q,ee)}return[Yt(f,V,E.pitch,E._fov),Yt(f,q,E.pitch,E._fov)]}class Oo extends o.E{constructor(r,l,m,b){super();const S=new o.a0({range:new o.a1(o._.fog.range),color:new o.a1(o._.fog.color),"high-color":new o.a1(o._.fog["high-color"]),"space-color":new o.a1(o._.fog["space-color"]),"horizon-blend":new o.a1(o._.fog["horizon-blend"]),"star-intensity":new o.a1(o._.fog["star-intensity"]),"vertical-range":new o.a1(o._.fog["vertical-range"])});this._transitionable=new o.$(S,m,new Map(b)),this.set(r,b),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new o.a8(S),this.scope=m}get state(){const r=this._transform,l=r.projection.name==="globe",m=o.a9(r.zoom),b=this.properties.get("range"),S=[.5,3];return{range:l?[o.aa(S[0],b[0],m),o.aa(S[1],b[1],m)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,m={}){if(this._validate($s,r,m))return;const b=o.l({},r);for(const S of Object.keys(o._.fog))b[S]===void 0&&(b[S]=o._.fog[S].default);this._options=b,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.a7(Qt,nn,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(m,b,S){const E=o.a5.fromLngLat(b),z=S.elevation?S.elevation.getAtPointOrZero(E):0;return ho(m,E.x,E.y,z,S)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return co(this.state,l,0,0,o.ab,o.ab,this._transform)}getOpacityForBounds(r,l,m,b,S){return this._transform.projection.supportsFog?co(this.state,r,l,m,b,S,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?In(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const m of l){const b=r.points[m];let S;if(b[2]>=0)S=b;else{const E=r.points[m-4];S=o.ac(E,b,E[2]/(E[2]-b[2]))}if(ho(this.state,S[0],S[1],0,this._transform)>=gt)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,m){return(!m||m.validate!==!1)&&xt(this,r.call(hi,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}class Eo extends o.E{constructor(r,l,m,b){super(),this.scope=m,this._options=r,this.properties=new o.a8(l),this._transitionable=new o.$(l,m,new Map(b)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let cr,rr;class qo{constructor(r,l,m,b){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(r,l){let m,b;if(r instanceof o.P||typeof r[0]=="number"){const S=o.P.convert(r);m=[S],b=l.isPointAboveHorizon(S)}else{const S=o.P.convert(r[0]),E=o.P.convert(r[1]);m=[S,E],b=o.ae(S,E).every(z=>l.isPointAboveHorizon(z))}return new qo(m,l.getCameraPoint(),b,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<m.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?b[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(b[3]=this.cameraPoint)),o.af(b,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],b=o.ae(l,m,r),S=this.cameraPoint.clone();switch(3*((S.y>l.y)+(S.y>m.y))+((S.x>l.x)+(S.x>m.x))){case 0:b[0]=S,b[4]=S.clone();break;case 1:b.splice(1,0,S);break;case 2:b[1]=S;break;case 3:b.splice(4,0,S);break;case 5:b.splice(2,0,S);break;case 6:b[3]=S;break;case 7:b.splice(3,0,S);break;case 8:b[2]=S}return b}containsTile(r,l,m,b=0){const S=r.queryPadding/l._pixelsPerMercatorPixel+1,E=m?this._bufferedCameraMercator(S,l):this._bufferedScreenMercator(S,l);let z=r.tileID.wrap+(E.unwrapped?b:0);const V=E.polygon.map(Te=>o.ag(r.tileTransform,Te,z));if(!o.ah(V,0,0,o.ab,o.ab))return;z=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const q=this.screenGeometryMercator.polygon.map(Te=>o.ai(r.tileTransform,Te,z)),H=q.map(Te=>new o.P(Te[0],Te[1])),X=l.getFreeCameraOptions().position||new o.a5(0,0,0),ee=o.ai(r.tileTransform,X,z),ae=q.map(Te=>{const Se=o.a6.vec3.sub(Te,Te,ee);return o.a6.vec3.normalize(Se,Se),new o.aj(ee,Se)}),be=o.ak(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:ae,bufferedTilespaceGeometry:V,bufferedTilespaceBounds:(ye=o.al(V),ye.min.x=o.ap(ye.min.x,0,o.ab),ye.min.y=o.ap(ye.min.y,0,o.ab),ye.max.x=o.ap(ye.max.x,0,o.ab),ye.max.y=o.ap(ye.max.y,0,o.ab),ye),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:be};var ye}_bufferedScreenMercator(r,l){const m=To(r);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(S=>l.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[m]=b,b}}_bufferedCameraMercator(r,l){const m=To(r);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let b;return b=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(S=>l.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[m]=b,b}}_projectAndResample(r,l){const m=function(S,E){const z=o.a6.mat4.multiply([],E.pixelMatrix,E.globeMatrix),V=[0,-o.aq,0,1],q=[0,o.aq,0,1],H=[0,0,0,1];o.a6.vec4.transformMat4(V,V,z),o.a6.vec4.transformMat4(q,q,z),o.a6.vec4.transformMat4(H,H,z);const X=new o.P(V[0]/V[3],V[1]/V[3]),ee=new o.P(q[0]/q[3],q[1]/q[3]),ae=o.an(S,X)&&V[3]<H[3],be=o.an(S,ee)&&q[3]<H[3];if(!ae&&!be)return null;const ye=function(Xe,nt,lt){for(let vt=1;vt<Xe.length;vt++){const dt=Yn(nt.pointCoordinate3D(Xe[vt-1]).x),ct=Yn(nt.pointCoordinate3D(Xe[vt]).x);if(lt<0){if(dt<ct)return{idx:vt,t:-dt/(ct-1-dt)}}else if(ct<dt)return{idx:vt,t:(1-dt)/(ct+1-dt)}}return null}(S,E,ae?-1:1);if(!ye)return null;const{idx:Te,t:Se}=ye;let De=Te>1?cn(S.slice(0,Te),E):[],je=Te<S.length?cn(S.slice(Te),E):[];De=De.map(Xe=>new o.P(Yn(Xe.x),Xe.y)),je=je.map(Xe=>new o.P(Yn(Xe.x),Xe.y));const He=[...De];He.length===0&&He.push(je[je.length-1]);const Ye=o.aa(He[He.length-1].y,(je.length===0?De[0]:je[0]).y,Se);let tt;return tt=ae?[new o.P(0,Ye),new o.P(0,0),new o.P(1,0),new o.P(1,Ye)]:[new o.P(1,Ye),new o.P(1,1),new o.P(0,1),new o.P(0,Ye)],He.push(...tt),je.length===0?He.push(De[0]):He.push(...je),{polygon:He.map(Xe=>new o.a5(Xe.x,Xe.y)),unwrapped:!1}}(r,l);if(m)return m;const b=function(S,E){let z=!1,V=-1/0,q=0;for(let X=0;X<S.length-1;X++)S[X].x>V&&(V=S[X].x,q=X);for(let X=0;X<S.length-1;X++){const ee=(q+X)%(S.length-1),ae=S[ee],be=S[ee+1];Math.abs(ae.x-be.x)>.5&&(ae.x<be.x?(ae.x+=1,ee===0&&(S[S.length-1].x+=1)):(be.x+=1,ee+1===S.length-1&&(S[0].x+=1)),z=!0)}const H=o.am(E.center.lng);return z&&H<Math.abs(H-1)&&S.forEach(X=>{X.x-=1}),{polygon:S,unwrapped:z}}(cn(r,l).map(S=>new o.P(Yn(S.x),S.y)),l);return{polygon:b.polygon.map(S=>new o.a5(S.x,S.y)),unwrapped:b.unwrapped}}}function cn(f,r){return o.ao(f,l=>{const m=r.pointCoordinate3D(l);l.x=m.x,l.y=m.y},1/256)}function Yn(f){return f<0?1+f%1:f%1}function To(f){return 100*f|0}function $o(f,r,l,m,b){const S=function(z,V){if(z)return b(z);if(V){if(f.url&&V.tiles&&f.tiles&&delete f.tiles,V.variants){if(!Array.isArray(V.variants))return b(new Error("variants must be an array"));for(const H of V.variants){if(H==null||typeof H!="object"||H.constructor!==Object)return b(new Error("variant must be an object"));if(!Array.isArray(H.capabilities))return b(new Error("capabilities must be an array"));if(H.capabilities.length===1&&H.capabilities[0]==="meshopt"){V=o.l(V,H);break}}}const q=o.ar(o.l({},V,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);q.tiles=r.canonicalizeTileset(q,f.url),b(null,q)}},E=function(z,V,q){if(!z)return null;if(!V&&!q)return z;q=q||z.worldview_default;const H=Object.values(z.language||{});if(H.length===0)return null;const X=Object.values(z.worldview||{});if(X.length===0)return null;const ee=H.every(be=>be===V),ae=X.every(be=>be===q);return ee&&ae?z:V in(z.language_options||{})||q in(z.worldview_options||{})?null:z.language_options&&z.worldview_options?z:null}(f.data,l,m);return E?o.q.frame(()=>S(null,E)):f.url?o.n(r.transformRequest(r.normalizeSourceURL(f.url,null,l,m),o.R.Source),S):o.q.frame(()=>{const{data:z,...V}=f;S(null,V)})}class Ar{constructor(r,l,m){this.bounds=o.as.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),m=Math.floor(o.am(this.bounds.getWest())*l),b=Math.floor(o.at(this.bounds.getNorth())*l),S=Math.ceil(o.am(this.bounds.getEast())*l),E=Math.ceil(o.at(this.bounds.getSouth())*l);return r.x>=m&&r.x<S&&r.y>=b&&r.y<E}}class yr extends o.E{constructor(r,l,m,b){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.l(this,o.ar(l,["url","scheme","tileSize","promoteId"])),this._options=o.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new o.au}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=$o(this._options,this.map._requestManager,l,m,(b,S)=>{if(this._tileJSONRequest=null,this._loaded=!0,b)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new o.t(b));else if(S){if(o.l(this,S),this.hasWorldviews=!!S.worldview_options,S.worldview_default&&(this.worldviewDefault=S.worldview_default),S.vector_layers){this.vectorLayers=S.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of S.vector_layers)this.vectorLayerIds.push(E.id),S.worldview&&S.worldview[E.source]&&this.localizableLayerIds.add(E.id)}S.bounds&&(this.tileBounds=new Ar(S.bounds,this.minzoom,this.maxzoom)),ot(S.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}r&&r(b)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}loadTile(r,l){const m=r.tileID.canonical.url(this.tiles,this.scheme),b=this.map._requestManager.normalizeTileURL(m),S=this.map._requestManager.transformRequest(b,o.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,z=E?{image:E.image.clone()}:null,V={request:S,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:z,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&o.f(m)&&(V.worldview=this.map.getWorldview()||this.worldviewDefault,V.localizableLayerIds=this.localizableLayerIds),V.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",V,q.bind(this));else if(r.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",V,q.bind(this),void 0,!0);else{const H=o.aw.call({deduped:this._deduped},V,(X,ee)=>{X||!ee?q.call(this,X):(V.data={cacheControl:ee.cacheControl,expires:ee.expires,rawData:ee.rawData.slice(0)},r.actor&&r.actor.send("loadTile",V,q.bind(this),void 0,!0))},!0);r.request={cancel:H}}function q(H,X){return delete r.request,r.aborted?l(null):H&&H.status!==404?l(H):(X&&X.resourceTiming&&(r.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&r.setExpiryData(X),r.loadVectorData(X,this.map.painter),o.ax(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class al extends o.E{constructor(r,l,m,b){super(),this.id=r,this.dispatcher=m,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.l({type:"raster"},l),o.l(this,o.ar(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._tileJSONRequest=$o(this._options,this.map._requestManager,null,null,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new o.t(l)):m&&(o.l(this,m),m.raster_layers&&(this.rasterLayers=m.raster_layers,this.rasterLayerIds=this.rasterLayers.map(b=>b.id)),m.bounds&&(this.tileBounds=new Ar(m.bounds,this.minzoom,this.maxzoom)),ot(m.tiles),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const m=o.q.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);r.request=o.o(this.map._requestManager.transformRequest(b,o.R.Tile),(S,E,z,V)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):S?(r.state="errored",l(S)):E?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:z,expires:V}),r.setTexture(E,this.map.painter),r.state="loaded",o.ax(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof o.T?(r.destroy(!0),r.texture&&r.texture instanceof o.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ms extends al{constructor(r,l,m,b){super(r,l,m,b),this.type="raster-array",this.maxzoom=22,this._options=o.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);l&&l.enabled&&m&&l._clearRenderCacheForTile(m.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const m=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),b=this.map._requestManager.transformRequest(m,o.R.Tile);r.requestParams=b,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(S,E,z,V)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(S)return S.code===20?void 0:(r.state="errored",l(S));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:z,expires:V}),r.state="empty",l(null)})}unloadTile(r,l){const m=r.texture;m&&m instanceof o.T?(r.destroy(!0),this.map.painter.saveTileTexture(m)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,m){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,m,(b,S)=>{if(b)return r.state="errored",this.fire(new o.t(b)),void this.triggerRepaint(r);S&&(r.setTexture(S,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:S})=>S===r),m=l&&l.fields,b=m&&m.bands&&m.bands;return b?b[0]:0}getTextureDescriptor(r,l,m){if(!r)return;const b=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!b)return;let S=null;l instanceof o.aB?S=l.paint.get("raster-array-band"):l instanceof o.aC&&(S=l.paint.get("raster-particle-array-band"));const E=S||this.getInitialBand(b);if(E!=null)if(r.textureDescriptor){if(!r.updateNeeded(b,E)||m)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,b,E)}}const gs={vector:yr,raster:al,"raster-dem":class extends al{constructor(f,r,l,m){super(f,r,l,m),this.type="raster-dem",this.maxzoom=22,this._options=o.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(b,S){b&&(f.state="errored",r(b)),S&&(f.dem=S,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=o.o(this.map._requestManager.transformRequest(l,o.R.Tile),(function(b,S,E,z){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(b)f.state="errored",r(b);else if(S){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:E,expires:z});const V=ImageBitmap&&S instanceof ImageBitmap&&o.ay(),q=1-(S.width-o.az(S.width))/2;q<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const H=V?S:o.q.getImageData(S,q),X={uid:f.uid,coord:f.tileID,source:this.id,scope:this.scope,rawImageData:H,encoding:this.encoding,padding:q};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",X,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const r=f.canonical,l=Math.pow(2,r.z),m=(r.x-1+l)%l,b=r.x===0?f.wrap-1:f.wrap,S=(r.x+1+l)%l,E=r.x+1===l?f.wrap+1:f.wrap,z={};return z[new o.aA(f.overscaledZ,b,r.z,m,r.y).key]={backfilled:!1},z[new o.aA(f.overscaledZ,E,r.z,S,r.y).key]={backfilled:!1},r.y>0&&(z[new o.aA(f.overscaledZ,b,r.z,m,r.y-1).key]={backfilled:!1},z[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},z[new o.aA(f.overscaledZ,E,r.z,S,r.y-1).key]={backfilled:!1}),r.y+1<l&&(z[new o.aA(f.overscaledZ,b,r.z,m,r.y+1).key]={backfilled:!1},z[new o.aA(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},z[new o.aA(f.overscaledZ,E,r.z,S,r.y+1).key]={backfilled:!1}),z}},"raster-array":ms,geojson:class extends o.E{constructor(f,r,l,m){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(m),this._data=r.data,this._options=o.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const b=o.ab/this.tileSize;this.workerOptions=o.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*b,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*b,extent:o.ab,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.ab,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*b,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new o.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new o.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of f.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterLeaves(f,r,l,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:r,offset:l},m),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.x("dataloading",{dataType:"source"})),this._loaded=!1;const r=o.l({append:f},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(o.q.resolveURL(l),o.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(m,b)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new o.t(m));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(S.resourceTiming=b.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new o.x("data",S)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,r){const l=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,b=m?{image:m.image.clone()}:null,S=this._partialReload,E={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:b,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:S};f.request=this.actor.send(l,E,(z,V)=>S&&!V?(f.state="loaded",r(null)):(delete f.request,f.destroy(),f.aborted?r(null):z?r(z):(f.loadVectorData(V,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,r){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aD{constructor(f,r,l,m){super(f,r,l,m),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.R.Source).url);o.aE(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new o.t(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new o.t(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(f,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aD,model:class extends o.E{constructor(f,r,l,m){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const f=[];for(const r in this._options.models){const l=this._options.models[r],m=o.aG(this.map._requestManager.transformRequest(l.uri,o.R.Model).url).then(b=>{if(!b)return;const S=o.aH(b),E=new o.aI(r,l.position,l.orientation,S);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(b=>{this.fire(new o.t(new Error(`Could not load model ${r} from ${l.uri}: ${b.message}`)))});f.push(m)}return Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new o.t(new Error(`Could not load models: ${r.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,r){}serialize(){return{type:"model"}}},"batched-model":class extends o.E{constructor(f,r,l,m){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(f){this.map=f,this.load()}load(f){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=$o(this._options,this.map._requestManager,r,l,(m,b)=>{this._tileJSONRequest=null,this._loaded=!0,m?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new o.t(m))):b&&(o.l(this,b),b.bounds&&(this.tileBounds=new Ar(b.bounds,this.minzoom,this.maxzoom)),ot(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),f&&f(m)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(l,o.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=r;else{if(f.buckets){const S=Object.values(f.buckets);for(const E of S)E.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",m,b.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",m,b.bind(this),void 0,!0);function b(S,E){return f.aborted?r(null):S&&S.status!==404?r(S):(this.map._refreshExpiredTiles&&E&&f.setExpiryData(E),f.loadModelData(E,this.map.painter),f.state="loaded",void r(null))}}serialize(){return o.l({},this._options)}},canvas:class extends o.aD{constructor(f,r,l,m){super(f,r,l,m),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(S=>typeof S!="number"))||this.fire(new o.t(new o.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.t(new o.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.t(new o.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.t(new o.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof o.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends o.E{constructor(f,r,l,m){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ar(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.l(this,o.ar(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:l,z:m}=f.canonical;return this._implementation.hasTile({x:r,y:l,z:m})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:l,y:m,z:b}=f.tileID.canonical,S=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:l,y:m,z:b},{signal:S.signal})).then((function(E){return delete f.request,f.aborted?(f.state="unloaded",r(null)):E===void 0?(f.state="errored",r(null)):E===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(z){return z instanceof ImageData||z instanceof HTMLCanvasElement||z instanceof ImageBitmap||z instanceof HTMLImageElement}(E)?(this.loadTileData(f,E),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.code!==20&&(f.state="errored",r(E))}),f.request.cancel=()=>S.abort()}loadTileData(f,r){f.setTexture(r,this.map.painter)}unloadTile(f,r){if(f.texture&&f.texture instanceof o.T?(f.destroy(!0),f.texture&&f.texture instanceof o.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:l,y:m,z:b}=f.tileID.canonical;this._implementation.unloadTile({x:l,y:m,z:b})}r&&r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=o.av(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}}},za=function(f,r,l,m){const b=new gs[r.type](f,r,l,m);if(b.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${b.id}`);return o.aJ(["load","abort","unload","serialize","prepare"],b),b};function lc(f,r){const l=o.a6.mat4.identity([]);return o.a6.mat4.scale(l,l,[.5*f.width,.5*-f.height,1]),o.a6.mat4.translate(l,l,[1,-1,0]),o.a6.mat4.multiply(l,l,f.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(l)}function sl(f,r,l,m,b,S,E,z,V=!1){const q=f.tilesIn(l,z,V);q.sort(cc);const H=[];for(const ee of q)H.push({wrappedTileID:ee.tile.tileID.wrapped().key,queryResults:ee.tile.queryRenderedFeatures(r,f._state,ee,m,b,S,E,lc(f.transform,ee.tile.tileID),V)});const X=function(ee){const ae={},be={};for(const ye of ee){const Te=ye.queryResults,Se=ye.wrappedTileID,De=be[Se]=be[Se]||{};for(const je in Te){const He=Te[je],Ye=De[je]=De[je]||{},tt=ae[je]=ae[je]||[];for(const Xe of He)Ye[Xe.featureIndex]||(Ye[Xe.featureIndex]=!0,tt.push(Xe))}}return ae}(H);for(const ee in X)X[ee].forEach(ae=>{const be=ae.feature,ye=be.layer;ye&&ye.type!=="background"&&ye.type!=="sky"&&ye.type!=="slot"&&(o.aK(ee)||(be.source=ye.source,ye["source-layer"]&&(be.sourceLayer=ye["source-layer"])),be.state=be.id!==void 0?f.getFeatureState(ye["source-layer"],be.id):{})});return X}function ll(f,r){const l=f.getRenderableIds().map(S=>f.getTileByID(S)),m=[],b={};for(let S=0;S<l.length;S++){const E=l[S],z=E.tileID.canonical.key;b[z]||(b[z]=!0,E.querySourceFeatures(m,r))}return m}function cc(f,r){const l=f.tileID,m=r.tileID;return l.overscaledZ-m.overscaledZ||l.canonical.y-m.canonical.y||l.wrap-m.wrap||l.canonical.x-m.canonical.x}function ru(f,r){const l={};if(!r)return l;for(const m of f){const b=m.layerIds.map(S=>r.getLayer(S)).filter(Boolean);if(b.length!==0){m.layers=b,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(S=>b.filter(E=>E.id===S)[0]));for(const S of b)l[S.fqid]=m}}return l}const Ya=32,vs=33,Xa=new Uint16Array(8184);for(let f=0;f<2046;f++){let r=f+2,l=0,m=0,b=0,S=0,E=0,z=0;for(1&r?b=S=E=Ya:l=m=z=Ya;(r>>=1)>1;){const q=l+b>>1,H=m+S>>1;1&r?(b=l,S=m,l=E,m=z):(l=b,m=S,b=E,S=z),E=q,z=H}const V=4*f;Xa[V+0]=l,Xa[V+1]=m,Xa[V+2]=b,Xa[V+3]=S}const fa=new Uint16Array(2178),_s=new Uint8Array(1089),iu=new Uint16Array(1089);function Dh(f){return f===0?-.03125:f===32?.03125:0}const zh={type:2,extent:o.ab,loadGeometry:()=>[[new o.P(0,0),new o.P(o.ab+1,0),new o.P(o.ab+1,o.ab+1),new o.P(0,o.ab+1),new o.P(0,0)]]};class Vs{constructor(r,l,m,b,S){this.tileID=r,this.uid=o.aQ(),this.uses=0,this.tileSize=l,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=S,b&&b.style&&(this._lastUpdatedBrightness=b.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",b&&b.transform&&(this.projection=b.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<o.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aL(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,m){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=ru(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const S=this.buckets[b];if(S instanceof o.aS){if(this.hasSymbolBuckets=!0,!m)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const S=this.buckets[b];if(S instanceof o.aS&&S.hasRTLText){this.hasRTLText=!0,o.aT();break}}this.queryPadding=0;for(const b in this.buckets){const S=this.buckets[b],E=l.style.getOwnLayer(b);if(!E)continue;const z=E.queryRadius(S);this.queryPadding=Math.max(this.queryPadding,z)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new o.aR}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,m){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets={...this.buckets,...ru(r.buckets,l.style)},r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const b in this.buckets){const S=this.buckets[b];S.uploadPending()&&S.upload(r)}const l=r.gl,m=this.imageAtlas;if(m&&!m.uploaded){const b=!!Object.keys(m.patternPositions).length;this.imageAtlasTexture=new o.T(r,m.image,l.RGBA8,{useMipmap:b}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,m),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const b=l.style.getBrightness();(this._lastUpdatedBrightness||b)&&(this._lastUpdatedBrightness&&b&&Math.abs(this._lastUpdatedBrightness-b)<.001||(this._lastUpdatedBrightness=b,this.updateBuckets(l)))}queryRenderedFeatures(r,l,m,b,S,E,z,V,q){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:V,transform:z,filter:b,layers:S,availableImages:E,tileTransform:this.tileTransform},r,l):{}}querySourceFeatures(r,l){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const b=m.loadVTLayers(),S=l?l.sourceLayer:"",E=b._geojsonTileLayer||b[S];if(!E)return;const z=o.aU(l&&l.filter),{z:V,x:q,y:H}=this.tileID.canonical,X={z:V,x:q,y:H};for(let ee=0;ee<E.length;ee++){const ae=E.feature(ee);if(z.needGeometry){const Te=o.aV(ae,!0);if(!z.filter(new o.a3(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!z.filter(new o.a3(this.tileID.overscaledZ),ae))continue;const be=m.getId(ae,S),ye=new o.aW(ae,V,q,H,be);ye.tile=X,r.push(ye)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const m=o.aX(r.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const m=Date.now();let b=!1;if(this.expirationTime>m)b=!1;else if(l)if(this.expirationTime<l)b=!0;else{const S=this.expirationTime-l;S?this.expirationTime=m+Math.max(S,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),m=r.style.listImages(),b=r.style.getBrightness();for(const S in this.buckets){if(!r.style.hasLayer(S))continue;const E=this.buckets[S],z=E.layers[0],V=z.sourceLayer||"_geojsonTileLayer",q=l[V],H=r.style.getSourceCache(z.source,z.scope);let X={};H&&(X=H._state.getState(V,void 0)),E.update(X,q,m,this.imageAtlas&&this.imageAtlas.patternPositions||{},b),(E instanceof o.aY||E instanceof o.aZ)&&r._terrain&&r._terrain.enabled&&H&&E.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(H.id,this.tileID);const ee=r&&r.style&&r.style.getOwnLayer(S);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=o.q.now()+r}setTexture(r,l){const m=l.context,b=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r):(this.texture=new o.T(m,r,b.RGBA8,{useMipmap:!0}),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE))}setDependencies(r,l){const m={};for(const b of l)m[b]=!0;this.dependencies[r]=m}hasDependency(r,l){for(const m of r){const b=this.dependencies[m];if(b){for(const S of l)if(b[S])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const m=o.a_(zh,this.tileID.canonical,this.tileTransform)[0],b=new o.a$,S=new o.b0;for(let E=0;E<m.length;E++){const{x:z,y:V}=m[E];b.emplaceBack(z,V),S.emplaceBack(E)}S.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(S),this._tileDebugBuffer=r.createVertexBuffer(b,o.b1.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,b.length,S.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const m=o.a_(zh,this.tileID.canonical,this.tileTransform)[0];let b,S;if(this.isRaster){const E=function(z,V){const q=o.aL(z,V),H=Math.pow(2,z.z);for(let Te=0;Te<vs;Te++)for(let Se=0;Se<vs;Se++){const De=o.aM((z.x+(Se+Dh(Se))/Ya)/H),je=o.aN((z.y+(Te+Dh(Te))/Ya)/H),He=V.project(De,je),Ye=Te*vs+Se;fa[2*Ye+0]=Math.round((He.x*q.scale-q.x)*o.ab),fa[2*Ye+1]=Math.round((He.y*q.scale-q.y)*o.ab)}_s.fill(0),iu.fill(0);for(let Te=2045;Te>=0;Te--){const Se=4*Te,De=Xa[Se+0],je=Xa[Se+1],He=Xa[Se+2],Ye=Xa[Se+3],tt=De+He>>1,Xe=je+Ye>>1,nt=tt+Xe-je,lt=Xe+De-tt,vt=je*vs+De,dt=Ye*vs+He,ct=Xe*vs+tt,jt=Math.hypot((fa[2*vt+0]+fa[2*dt+0])/2-fa[2*ct+0],(fa[2*vt+1]+fa[2*dt+1])/2-fa[2*ct+1])>=16;_s[ct]=_s[ct]||(jt?1:0),Te<1022&&(_s[ct]=_s[ct]||_s[(je+lt>>1)*vs+(De+nt>>1)]||_s[(Ye+lt>>1)*vs+(He+nt>>1)])}const X=new o.aO,ee=new o.aP;let ae=0;function be(Te,Se){const De=Se*vs+Te;return iu[De]===0&&(X.emplaceBack(fa[2*De+0],fa[2*De+1],Te*o.ab/Ya,Se*o.ab/Ya),iu[De]=++ae),iu[De]-1}function ye(Te,Se,De,je,He,Ye){const tt=Te+De>>1,Xe=Se+je>>1;if(Math.abs(Te-He)+Math.abs(Se-Ye)>1&&_s[Xe*vs+tt])ye(He,Ye,Te,Se,tt,Xe),ye(De,je,He,Ye,tt,Xe);else{const nt=be(Te,Se),lt=be(De,je),vt=be(He,Ye);ee.emplaceBack(nt,lt,vt)}}return ye(0,0,Ya,Ya,Ya,0),ye(Ya,Ya,0,0,0,Ya),{vertices:X,indices:ee}}(this.tileID.canonical,l);b=E.vertices,S=E.indices}else{b=new o.aO,S=new o.aP;for(const{x:z,y:V}of m)b.emplaceBack(z,V,0,0);const E=o.b3(b.int16,void 0,4);for(let z=0;z<E.length;z+=3)S.emplaceBack(E[z],E[z+1],E[z+2])}this._tileBoundsBuffer=r.createVertexBuffer(b,o.b4.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(S),this._tileBoundsSegments=o.b2.simpleSegment(0,0,b.length,S.length)}_makeGlobeTileDebugBuffers(r,l){const m=l.projection;if(!m||m.name!=="globe"||l.freezeTileCoverage)return;const b=this.tileID.canonical,S=o.b5(b,l),E=o.b6(S),z=o.a9(l.zoom);let V;z>0&&(V=o.a6.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,b,l,E,V,z),this._makeGlobeTileDebugTextBuffer(r,b,l,E,V,z)}_globePoint(r,l,m,b,S,E,z){let V=o.b7(r,l,m);if(E){const q=1<<m.z,H=o.am(b.center.lng),X=o.at(b.center.lat),ee=(m.x+.5)/q-H;let ae=0;ee>.5?ae=-1:ee<-.5&&(ae=1);let be=(r/o.ab+m.x)/q+ae,ye=(l/o.ab+m.y)/q;be=(be-H)*b._pixelsPerMercatorPixel+H,ye=(ye-X)*b._pixelsPerMercatorPixel+X;const Te=[be*b.worldSize,ye*b.worldSize,0];o.a6.vec3.transformMat4(Te,Te,E),V=o.b8(V,Te,z)}return o.a6.vec3.transformMat4(V,V,S)}_makeGlobeTileDebugBorderBuffer(r,l,m,b,S,E){const z=new o.a$,V=new o.b0,q=new o.b9,H=(ee,ae,be,ye,Te)=>{const Se=(be-ee)/(Te-1),De=(ye-ae)/(Te-1),je=z.length;for(let He=0;He<Te;He++){const Ye=ee+He*Se,tt=ae+He*De;z.emplaceBack(Ye,tt);const Xe=this._globePoint(Ye,tt,l,m,b,S,E);q.emplaceBack(Xe[0],Xe[1],Xe[2]),V.emplaceBack(je+He)}},X=o.ab;H(0,0,X,0,16),H(X,0,X,X,16),H(X,X,0,X,16),H(0,X,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(V),this._tileDebugBuffer=r.createVertexBuffer(z,o.b1.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(q,o.ba.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,z.length,V.length)}_makeGlobeTileDebugTextBuffer(r,l,m,b,S,E){const z=o.ab/4,V=new o.a$,q=new o.aP,H=new o.b9,X=25;q.reserve(32),V.reserve(X),H.reserve(X);const ee=(ae,be)=>X*ae+be;for(let ae=0;ae<X;ae++){const be=ae*z;for(let ye=0;ye<X;ye++){const Te=ye*z;V.emplaceBack(Te,be);const Se=this._globePoint(Te,be,l,m,b,S,E);H.emplaceBack(Se[0],Se[1],Se[2])}}for(let ae=0;ae<4;ae++)for(let be=0;be<4;be++){const ye=ee(ae,be),Te=ee(ae,be+1),Se=ee(ae+1,be),De=ee(ae+1,be+1);q.emplaceBack(ye,Te,Se),q.emplaceBack(Se,Te,De)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(q),this._tileDebugTextBuffer=r.createVertexBuffer(V,o.b1.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(H,o.ba.members),this._tileDebugTextSegments=o.b2.simpleSegment(0,0,X,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.bb.setPbf(o.bc);class uc extends Vs{constructor(r,l,m,b,S){super(r,l,m,b,S),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const m=l.context,b=m.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r,{premultiply:!1}):this.texture=new o.T(m,r,b.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const m=this._mrt=new o.bb(30),b=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=o.bd(b,(S,E,z,V)=>{if(S)l(S);else try{const q=m.getHeaderLength(E);if(q>r)return void(this.request=this.fetchHeader(q,l));m.parseHeader(E),this._isHeaderLoaded=!0;let H=0;for(const X of Object.values(m.layers))H=Math.max(H,X.dataIndex[X.dataIndex.length-1].last_byte);E.byteLength>=H&&(this.entireBuffer=E),l(null,this.entireBuffer||E,z,V)}catch(q){l(q)}}),this.request}fetchBand(r,l,m){const b=this._mrt;if(!this._isHeaderLoaded||!b)return void m(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void m(new Error("Can't fetch tile band without an actor"));let E;const z=(X,ee)=>{E.complete(X,ee),X?m(X):(this.updateTextureDescriptor(r,l),m(null,this.textureDescriptor&&this.textureDescriptor.img))},V=(X,ee)=>{if(X)return m(X);const ae=S.send("decodeRasterArray",{buffer:ee,task:E},z,void 0,!0);this._workQueue.push(()=>{ae&&ae.cancel(),E.cancel()})},q=b.getLayer(r);if(!q)return void m(new Error(`Unknown sourceLayer "${r}"`));if(q.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void m(null,this.textureDescriptor?this.textureDescriptor.img:null);const H=q.getDataRange([l]);if(E=b.createDecodingTask(H),!E||E.tasks.length)if(this.flushQueues(),this.entireBuffer)V(null,this.entireBuffer.slice(H.firstByte,H.lastByte+1));else{const X=Object.assign({},this.requestParams,{headers:{Range:`bytes=${H.firstByte}-${H.lastByte}`}}),ee=o.bd(X,V);this._fetchQueue.push(()=>{ee.cancel(),E.cancel()})}else m(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const m=this._mrt.getLayer(r);if(!m||!m.hasBand(l)||!m.hasDataForBand(l))return;const{bytes:b,tileSize:S,buffer:E,offset:z,scale:V}=m.getBandView(l),q=S+2*E,H={data:b,width:q,height:q},X=this.texture;X&&X instanceof o.T&&X.update(H,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:H,buffer:E,offset:z,tileSize:S,format:m.pixelFormat,mix:[V,256*V,65536*V,16777216*V]}}}class Z{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,m){const b=r.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const S={value:l,timeout:void 0};if(m!==void 0&&(S.timeout=setTimeout(()=>{this.remove(r,S)},m)),this.data[b].push(S),this.order.push(b),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const m=r.wrapped().key,b=l===void 0?0:this.data[m].indexOf(l),S=this.data[m][b];return this.data[m].splice(b,1),S.timeout&&clearTimeout(S.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(S.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const m in this.data)for(const b of this.data[m])r(b.value)||l.push(b);for(const m of l)this.remove(m.value.tileID,m)}}class fe{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,m){const b=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][b]=this.stateChanges[r][b]||{},o.l(this.stateChanges[r][b],m),this.deletedStates[r]===null){this.deletedStates[r]={};for(const S in this.state[r])S!==b&&(this.deletedStates[r][S]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][b]===null){this.deletedStates[r][b]={};for(const S in this.state[r][b])m[S]||(this.deletedStates[r][b][S]=null)}else for(const S in m)this.deletedStates[r]&&this.deletedStates[r][b]&&this.deletedStates[r][b][S]===null&&delete this.deletedStates[r][b][S]}removeFeatureState(r,l,m){if(this.deletedStates[r]===null)return;const b=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},m&&l!==void 0)this.deletedStates[r][b]!==null&&(this.deletedStates[r][b]=this.deletedStates[r][b]||{},this.deletedStates[r][b][m]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][b])for(m in this.deletedStates[r][b]={},this.stateChanges[r][b])this.deletedStates[r][b][m]=null;else this.deletedStates[r][b]=null;else this.deletedStates[r]=null}getState(r,l){const m=this.state[r]||{},b=this.stateChanges[r]||{},S=this.deletedStates[r];if(S===null)return{};if(l!==void 0){const z=String(l),V=o.l({},m[z],b[z]);if(S){const q=S[l];if(q===null)return{};for(const H in q)delete V[H]}return V}const E=o.l({},m,b);if(S)for(const z in S)delete E[z];return E}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const m={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const S={};for(const E in this.stateChanges[b])this.state[b][E]||(this.state[b][E]={}),o.l(this.state[b][E],this.stateChanges[b][E]),S[E]=this.state[b][E];m[b]=S}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const S={};if(this.deletedStates[b]===null)for(const E in this.state[b])S[E]={},this.state[b][E]={};else for(const E in this.deletedStates[b]){if(this.deletedStates[b][E]===null)this.state[b][E]={};else if(this.state[b][E])for(const z of Object.keys(this.deletedStates[b][E]))delete this.state[b][E][z];S[E]=this.state[b][E]}m[b]=m[b]||{},o.l(m[b],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const b in r)r[b].refreshFeatureState(l)}}class Ue extends o.E{constructor(r,l,m){super(),this.id=r,this._onlySymbols=m,l.on("data",b=>{b.dataType==="source"&&b.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&b.dataType==="source"&&b.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new Z(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new fe,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const m=this._tiles[l];m.upload(r),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return o.be(this._tiles).map(r=>r.tileID).sort(wt).map(r=>r.key)}getRenderableIds(r,l){const m=[];for(const b in this._tiles)this._isIdRenderable(+b,r,l)&&m.push(this._tiles[b]);return r?m.sort((b,S)=>{const E=b.tileID,z=S.tileID,V=new o.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),q=new o.P(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-z.overscaledZ||q.y-V.y||q.x-V.x}).map(b=>b.tileID.key):m.map(b=>b.tileID).sort(wt).map(b=>b.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,m){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(m||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const m=this._tiles[r];m&&(m.state!=="loading"&&(m.state=l),this._loadTile(m,this._tileLoaded.bind(this,m,r,l)))}_tileLoaded(r,l,m,b){if(b)if(r.state="errored",b.status!==404)this._source.fire(new o.t(b,{tile:r}));else{if(this._source.fire(new o.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const S=this.map.painter.terrain;this.update(this.transform,S.getScaledDemTileSize(),!0),S.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=o.q.now(),m==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new o.x("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let b=0;b<l.length;b++){const S=l[b];if(r.neighboringTiles&&r.neighboringTiles[S]){const E=this.getTileByID(S);m(r,E),m(E,r)}}function m(b,S){if(!b.dem||b.dem.borderReady)return;b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0;let E=S.tileID.canonical.x-b.tileID.canonical.x;const z=S.tileID.canonical.y-b.tileID.canonical.y,V=Math.pow(2,b.tileID.canonical.z),q=S.tileID.key;E===0&&z===0||Math.abs(z)>1||(Math.abs(E)>1&&(Math.abs(E+V)===1?E+=V:Math.abs(E-V)===1&&(E-=V)),S.dem&&b.dem&&(b.dem.backfillBorder(S.dem,E,z),b.neighboringTiles&&b.neighboringTiles[q]&&(b.neighboringTiles[q].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,m,b){for(const S in this._tiles){let E=this._tiles[S];if(b[S]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>m)continue;let z=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const q=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[q.key],E&&E.hasData()&&(z=q)}let V=z;for(;V.overscaledZ>l;)if(V=V.scaledTo(V.overscaledZ-1),r[V.key]){b[z.key]=z;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const m=this._loadedParentTiles[r.key];return m&&m.tileID.overscaledZ>=l?m:null}for(let m=r.overscaledZ-1;m>=l;m--){const b=r.scaledTo(m),S=this._getLoadedTile(b);if(S)return S}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const m=Math.ceil(r.width/l)+1,b=Math.ceil(r.height/l)+1,S=Math.floor(m*b*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,S):S,z=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(z)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const m={};for(const b in this._tiles){const S=this._tiles[b];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+l),m[S.tileID.key]=S}this._tiles=m;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(+b,this._tiles[b])}}update(r,l,m,b){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let E,z=this._source.maxzoom;const V=this.map&&this.map.painter?this.map.painter._terrain:null;if(V&&V.sourceCache===this&&V.attenuationRange()){const X=V.attenuationRange()[0],ee=Math.floor(X)-Math.log2(V.getDemUpscale());z>ee&&(z=ee)}if(this.used||this.usedForTerrain){if(this._source.tileID)E=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(X=>new o.aA(X.canonical.z,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y));else if(this.tileCoverLift!==0){const X=r.clone();X.tileCoverLift=this.tileCoverLift,E=X.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&r.projection.name==="globe"&&(E.push(new o.aA(1,0,1,0,0)),E.push(new o.aA(1,0,1,1,0)),E.push(new o.aA(1,0,1,0,1)),E.push(new o.aA(1,0,1,1,1)))}else if(E=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const X=this._source.hasTile.bind(this._source);E=E.filter(ee=>X(ee))}}else E=[];if(E.length>0&&this.castsShadows&&b&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Bt(this._source.type)){const X=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),ee=Math.min(X,this._source.maxzoom);if(S){const ae=r.extendTileCover(E,ee);for(const be of ae)E.push(be)}else{const ae=r.extendTileCover(E,ee,b);for(const be of ae)this._shadowCasterTiles[be.key]=!0,E.push(be)}}const q=this._updateRetainedTiles(E);if(Bt(this._source.type)&&E.length!==0){const X={},ee={},ae=Object.keys(q);for(const ye of ae){const Te=q[ye],Se=this._tiles[ye];if(!Se||Se.fadeEndTime&&Se.fadeEndTime<=o.q.now())continue;const De=this.findLoadedParent(Te,Math.max(Te.overscaledZ-Ue.maxOverzooming,this._source.minzoom));De&&(this._addTile(De.tileID),X[De.tileID.key]=De.tileID),ee[ye]=Te}const be=E[E.length-1].overscaledZ;for(const ye in this._tiles){const Te=this._tiles[ye];if(q[ye]||!Te.hasData())continue;let Se=Te.tileID;for(;Se.overscaledZ>be;){Se=Se.scaledTo(Se.overscaledZ-1);const De=this._tiles[Se.key];if(De&&De.hasData()&&ee[Se.key]){q[ye]=Te.tileID;break}}}for(const ye in X)q[ye]||(this._coveredTiles[ye]=!0,q[ye]=X[ye])}for(const X in q)this._tiles[X].clearFadeHold();const H=o.bf(this._tiles,q);for(const X of H){const ee=this._tiles[X];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(+X)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const m={},b=r.reduce((q,H)=>Math.min(q,H.overscaledZ),1/0),S=r[0].overscaledZ,E=Math.max(S-Ue.maxOverzooming,this._source.minzoom),z=Math.max(S+Ue.maxUnderzooming,this._source.minzoom),V={};for(const q of r){const H=this._addTile(q);l[q.key]=q,H.hasData()||b<this._source.maxzoom&&(V[q.key]=q)}this._retainLoadedChildren(V,b,z,l);for(const q of r){let H=this._tiles[q.key];if(H.hasData())continue;if(q.canonical.z>=this._source.maxzoom){const ee=q.children(this._source.maxzoom)[0],ae=this.getTile(ee);if(ae&&ae.hasData()){l[ee.key]=ee;continue}}else{const ee=q.children(this._source.maxzoom);if(l[ee[0].key]&&l[ee[1].key]&&l[ee[2].key]&&l[ee[3].key])continue}let X=H.wasRequested();for(let ee=q.overscaledZ-1;ee>=E;--ee){const ae=q.scaledTo(ee);if(m[ae.key]||(m[ae.key]=!0,H=this.getTile(ae),!H&&X&&(H=this._addTile(ae)),H&&(l[ae.key]=ae,X=H.wasRequested(),H.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let m,b=this._tiles[r].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){m=this._loadedParentTiles[b.key];break}l.push(b.key);const S=b.scaledTo(b.overscaledZ-1);if(m=this._getLoadedTile(S),m)break;b=S}for(const S of l)this._loadedParentTiles[S]=m}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const m=!!l;if(!m){const b=this.map?this.map.painter:null,S=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new uc(r,S,this.transform.tileZoom,b,this._isRaster):new Vs(r,S,this.transform.tileZoom,b,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,m||this._source.fire(new o.x("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const m=l.getExpiryTimeout();m&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},m))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,m){const b=[],S=this.transform;if(!S)return b;const E=S.projection.name==="globe",z=o.am(S.center.lng);for(const V in this._tiles){const q=this._tiles[V];if(m&&q.clearQueryDebugViz(),q.holdingForFade())continue;let H;if(E){const X=q.tileID.canonical;if(X.z===0){const ee=[Math.abs(o.ap(z,...Vt(X,-1))-z),Math.abs(o.ap(z,...Vt(X,1))-z)];H=[0,2*ee.indexOf(Math.min(...ee))-1]}else{const ee=[Math.abs(o.ap(z,...Vt(X,-1))-z),Math.abs(o.ap(z,...Vt(X,0))-z),Math.abs(o.ap(z,...Vt(X,1))-z)];H=[ee.indexOf(Math.min(...ee))-1]}}else H=[0];for(const X of H){const ee=r.containsTile(q,S,l,X);ee&&b.push(ee)}}return b}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const m=this.getRenderableIds(r,l).map(S=>this._tiles[S].tileID),b=this.transform.projection.name==="globe";for(const S of m)S.projMatrix=this.transform.calculateProjMatrix(S.toUnwrapped()),S.expandedProjMatrix=b?this.transform.calculateProjMatrix(S.toUnwrapped(),!1,!0):S.projMatrix;return m}sortCoordinatesByDistance(r){const l=r.slice(),m=this.transform._camera.position,b=this.transform._camera.forward(),S={};for(const E of l){const z=1/(1<<E.canonical.z);S[E.key]=((E.canonical.x+.5)*z+E.wrap-m[0])*b[0]+((E.canonical.y+.5)*z-m[1])*b[1]-m[2]*b[2]}return l.sort((E,z)=>S[E.key]-S[z.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(Bt(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.q.now())return!0}return!1}setFeatureState(r,l,m){this._state.updateState(r=r||"_geojsonTileLayer",l,m)}removeFeatureState(r,l,m){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,m)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,m){const b=this._tiles[r];b&&b.setDependencies(l,m)}reloadTilesForDependencies(r,l){for(const m in this._tiles)this._tiles[m].hasDependency(r,l)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const V=()=>{this._sourceLoaded&&(this._source.off("data",V),this._preloadTiles(r,l))};return void this._source.on("data",V)}const m=new Map,b=Array.isArray(r)?r:[r],S=this.map.painter.terrain,E=this.usedForTerrain&&S?S.getScaledDemTileSize():this._source.tileSize;for(const V of b){const q=V.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const H of q)m.set(H.key,H);this.usedForTerrain&&V.updateElevation(!1)}const z=Array.from(m.values());o.bg(z,(V,q)=>{const H=new Vs(V,this._source.tileSize*V.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(H,X=>{this._source.type==="raster-dem"&&H.dem&&this._backfillDEM(H),q(X,H)})},l)}}function wt(f,r){const l=Math.abs(2*f.wrap)-+(f.wrap<0),m=Math.abs(2*r.wrap)-+(r.wrap<0);return f.overscaledZ-r.overscaledZ||m-l||r.canonical.y-f.canonical.y||r.canonical.x-f.canonical.x}function Bt(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function Vt(f,r){const l=1<<f.z;return[f.x/l+r,(f.x+1)/l+r]}Ue.maxOverzooming=10,Ue.maxUnderzooming=3;class on{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const m in this.style._mergedLayers){const b=this.style._mergedLayers[m];if(b.type==="fill-extrusion")this.layers.push({layer:b,visible:r,visibilityChanged:l});else if(b.type==="model"){const S=this.style.getLayerSource(b);S&&S.type==="batched-model"&&this.layers.push({layer:b,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const m=l.layer;let b=!1;m.type==="fill-extrusion"?b=!m.isHidden(r)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="model"&&(b=!m.isHidden(r)&&m.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!b&&l.visible,l.visible=b}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const b of this.layers){const S=b.layer,E=this.style.getLayerSourceCache(S);let z=1;S.type==="fill-extrusion"&&(z=b.visible?S.paint.get("fill-extrusion-vertical-scale"):0);let V=E?E.getTile(l):null;if(!V&&E&&l.canonical.z>E.getSource().minzoom){let q=l.scaledTo(Math.min(E.getSource().maxzoom,l.overscaledZ-1));for(;q.overscaledZ>=E.getSource().minzoom&&(V=E.getTile(q),!V&&q.overscaledZ!==0);)q=q.scaledTo(q.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:V?V.getBucket(S):null,tileID:V?V.tileID:l,verticalScale:z})}r.hasAnyZOffset=!1;let m=!1;for(let b=0;b<r.symbolInstances.length;b++){const S=r.symbolInstances.get(b),E=S.zOffset,z=this._getHeightAtTileOffset(l,S.tileAnchorX,S.tileAnchorY);S.zOffset=z!==Number.NEGATIVE_INFINITY?z:E,m||E===S.zOffset||(m=!0),r.hasAnyZOffset||S.zOffset===0||(r.hasAnyZOffset=!0)}m&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,m,b){let S=l,E=m;if(r.canonical.z!==b.canonical.z){const z=b.canonical,V=1/(1<<r.canonical.z-z.z);S=(l+r.canonical.x*o.ab)*V-z.x*o.ab|0,E=(m+r.canonical.y*o.ab)*V-z.y*o.ab|0}return{tileX:S,tileY:E}}_getHeightAtTileOffset(r,l,m){let b,S;for(let E=0;E<this.layers.length;++E){if(this.layers[E].layer.type!=="fill-extrusion")continue;const{bucket:z,tileID:V,verticalScale:q}=this.currentBuildingBuckets[E];if(!z)continue;const{tileX:H,tileY:X}=this._mapCoordToOverlappingTile(r,l,m,V),ee=z.getHeightAtTileCoord(H,X);ee&&ee.height!==void 0&&(ee.hidden?b=ee.height:S=Math.max(ee.height*q,S||0))}if(S!==void 0)return S;for(let E=0;E<this.layers.length;++E){const z=this.layers[E];if(z.layer.type!=="model"||!z.visible)continue;const{bucket:V,tileID:q}=this.currentBuildingBuckets[E];if(!V)continue;const{tileX:H,tileY:X}=this._mapCoordToOverlappingTile(r,l,m,q),ee=V.getHeightAtTileCoord(H,X);if(ee&&!ee.hidden)return ee.height===void 0&&b!==void 0?Math.min(ee.maxHeight,b)*ee.verticalScale:ee.height?ee.height*ee.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Kn(f,r){const l={};for(const m in f)m!=="ref"&&(l[m]=f[m]);return o.bh.forEach(m=>{m in r&&(l[m]=r[m])}),l}function so(f){f=f.slice();const r=Object.create(null);for(let l=0;l<f.length;l++)r[f[l].id]=f[l];for(let l=0;l<f.length;l++)"ref"in f[l]&&(f[l]=Kn(f[l],r[f[l].ref]));return f}const zn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function yo(f,r,l){l.push({command:zn.addSource,args:[f,r[f]]})}function On(f,r,l){r.push({command:zn.removeSource,args:[f]}),l[f]=!0}function dr(f,r,l,m){On(f,l,m),yo(f,r,l)}function uo(f,r,l){let m;for(m in f[l])if(f[l].hasOwnProperty(m)&&m!=="data"&&!o.bi(f[l][m],r[l][m]))return!1;for(m in r[l])if(r[l].hasOwnProperty(m)&&m!=="data"&&!o.bi(f[l][m],r[l][m]))return!1;return!0}function hr(f,r,l,m,b,S){let E;for(E in r=r||{},f=f||{})f.hasOwnProperty(E)&&(o.bi(f[E],r[E])||l.push({command:S,args:[m,E,r[E],b]}));for(E in r)r.hasOwnProperty(E)&&!f.hasOwnProperty(E)&&(o.bi(f[E],r[E])||l.push({command:S,args:[m,E,r[E],b]}))}function Ti(f){return f.id}function $n(f,r){return f[r.id]=r,f}class ko{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ap(r,0,1);let l=1,m=this._distances[l];const b=r*this.paddedLength+this.padding;for(;m<b&&l<this._distances.length;)m=this._distances[++l];const S=l-1,E=this._distances[S],z=m-E,V=z>0?(b-E)/z:0;return this.points[S].mult(1-V).add(this.points[l].mult(V))}}class oi{constructor(r,l,m){const b=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(l/m);for(let E=0;E<this.xCellCount*this.yCellCount;E++)b.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,m,b,S){this._forEachCell(l,m,b,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(S)}insertCircle(r,l,m,b){this._forEachCell(l-b,m-b,l+b,m+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(m),this.circles.push(b)}_insertBoxCell(r,l,m,b,S,E){this.boxCells[S].push(E)}_insertCircleCell(r,l,m,b,S,E){this.circleCells[S].push(E)}_query(r,l,m,b,S,E){if(m<0||r>this.width||b<0||l>this.height)return!S&&[];const z=[];if(r<=0&&l<=0&&this.width<=m&&this.height<=b){if(S)return!0;for(let V=0;V<this.boxKeys.length;V++)z.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const q=this.circles[3*V],H=this.circles[3*V+1],X=this.circles[3*V+2];z.push({key:this.circleKeys[V],x1:q-X,y1:H-X,x2:q+X,y2:H+X})}return E?z.filter(E):z}return this._forEachCell(r,l,m,b,this._queryCell,z,{hitTest:S,seenUids:{box:{},circle:{}}},E),S?z.length>0:z}_queryCircle(r,l,m,b,S){const E=r-m,z=r+m,V=l-m,q=l+m;if(z<0||E>this.width||q<0||V>this.height)return!b&&[];const H=[];return this._forEachCell(E,V,z,q,this._queryCellCircle,H,{hitTest:b,circle:{x:r,y:l,radius:m},seenUids:{box:{},circle:{}}},S),b?H.length>0:H}query(r,l,m,b,S){return this._query(r,l,m,b,!1,S)}hitTest(r,l,m,b,S){return this._query(r,l,m,b,!0,S)}hitTestCircle(r,l,m,b){return this._queryCircle(r,l,m,!0,b)}_queryCell(r,l,m,b,S,E,z,V){const q=z.seenUids,H=this.boxCells[S];if(H!==null){const ee=this.bboxes;for(const ae of H)if(!q.box[ae]){q.box[ae]=!0;const be=4*ae;if(r<=ee[be+2]&&l<=ee[be+3]&&m>=ee[be+0]&&b>=ee[be+1]&&(!V||V(this.boxKeys[ae]))){if(z.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[ae],x1:ee[be],y1:ee[be+1],x2:ee[be+2],y2:ee[be+3]})}}}const X=this.circleCells[S];if(X!==null){const ee=this.circles;for(const ae of X)if(!q.circle[ae]){q.circle[ae]=!0;const be=3*ae;if(this._circleAndRectCollide(ee[be],ee[be+1],ee[be+2],r,l,m,b)&&(!V||V(this.circleKeys[ae]))){if(z.hitTest)return E.push(!0),!0;{const ye=ee[be],Te=ee[be+1],Se=ee[be+2];E.push({key:this.circleKeys[ae],x1:ye-Se,y1:Te-Se,x2:ye+Se,y2:Te+Se})}}}}}_queryCellCircle(r,l,m,b,S,E,z,V){const q=z.circle,H=z.seenUids,X=this.boxCells[S];if(X!==null){const ae=this.bboxes;for(const be of X)if(!H.box[be]){H.box[be]=!0;const ye=4*be;if(this._circleAndRectCollide(q.x,q.y,q.radius,ae[ye+0],ae[ye+1],ae[ye+2],ae[ye+3])&&(!V||V(this.boxKeys[be])))return E.push(!0),!0}}const ee=this.circleCells[S];if(ee!==null){const ae=this.circles;for(const be of ee)if(!H.circle[be]){H.circle[be]=!0;const ye=3*be;if(this._circlesCollide(ae[ye],ae[ye+1],ae[ye+2],q.x,q.y,q.radius)&&(!V||V(this.circleKeys[be])))return E.push(!0),!0}}}_forEachCell(r,l,m,b,S,E,z,V){const q=this._convertToXCellCoord(r),H=this._convertToYCellCoord(l),X=this._convertToXCellCoord(m),ee=this._convertToYCellCoord(b);for(let ae=q;ae<=X;ae++)for(let be=H;be<=ee;be++)if(S.call(this,r,l,m,b,this.xCellCount*be+ae,E,z,V))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,m,b,S,E){const z=b-r,V=S-l,q=m+E;return q*q>z*z+V*V}_circleAndRectCollide(r,l,m,b,S,E,z){const V=(E-b)/2,q=Math.abs(r-(b+V));if(q>V+m)return!1;const H=(z-S)/2,X=Math.abs(l-(S+H));if(X>H+m)return!1;if(q<=V||X<=H)return!0;const ee=q-V,ae=X-H;return ee*ee+ae*ae<=m*m}}const yi={unknown:0,flipRequired:1,flipNotRequired:2},Hn=Math.tan(85*Math.PI/180);function fr(f,r,l,m,b,S,E){const z=o.a6.mat4.create();if(l)if(S.name==="globe"){const V=o.bj(b,r);o.a6.mat4.multiply(z,z,V)}else{const V=o.a6.mat2.invert([],E);z[0]=V[0],z[1]=V[1],z[4]=V[2],z[5]=V[3],m||o.a6.mat4.rotateZ(z,z,b.angle)}else o.a6.mat4.multiply(z,b.labelPlaneMatrix,f);return z}function br(f,r,l,m,b,S,E){const z=fr(f,r,l,m,b,S,E);return S.name==="globe"&&l||(z[2]=z[6]=z[10]=z[14]=0),z}function zr(f,r,l,m,b,S,E){if(l){if(S.name==="globe"){const z=fr(f,r,l,m,b,S,E);return o.a6.mat4.invert(z,z),o.a6.mat4.multiply(z,f,z),z}{const z=o.a6.mat4.clone(f),V=o.a6.mat4.identity([]);return V[0]=E[0],V[1]=E[1],V[4]=E[2],V[5]=E[3],o.a6.mat4.multiply(z,z,V),m||o.a6.mat4.rotateZ(z,z,-b.angle),z}}return b.glCoordMatrix}function sa(f,r,l,m){const b=[f,r,l,1];l?o.a6.vec4.transformMat4(b,b,m):gd(b,b,m);const S=b[3];return b[0]/=S,b[1]/=S,b[2]/=S,b}function xr(f,r){return Math.min(.5+f/r*.5,1.5)}function Ja(f,r){const l=f[0]/f[3],m=f[1]/f[3];return l>=-r[0]&&l<=r[0]&&m>=-r[1]&&m<=r[1]}function dc(f,r,l,m,b,S,E,z,V,q){const H=l.transform,X=m?f.textSizeData:f.iconSizeData,ee=o.bk(X,l.transform.zoom),ae=H.projection.name==="globe",be=[256/l.width*2+1,256/l.height*2+1],ye=m?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ye.clear();let Te=null;ae&&(Te=m?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const Se=f.lineVertexArray,De=m?f.text.placedSymbolArray:f.icon.placedSymbolArray,je=l.transform.width/l.transform.height;let He,Ye=!1;for(let tt=0;tt<De.length;tt++){const Xe=De.get(tt),{numGlyphs:nt,writingMode:lt}=Xe;if(lt!==o.bl.vertical||Ye||He===o.bl.horizontal||(Ye=!0),He=lt,(Xe.hidden||lt===o.bl.vertical)&&!Ye){Us(nt,ye);continue}Ye=!1;const vt=new o.P(Xe.tileAnchorX,Xe.tileAnchorY);let{x:dt,y:ct,z:jt}=H.projection.projectTilePoint(vt.x,vt.y,q.canonical);if(V){const[hn,Vn,fo]=V(vt);dt+=hn,ct+=Vn,jt+=fo}const en=[dt,ct,jt,1];if(o.a6.vec4.transformMat4(en,en,r),!Ja(en,be)){Us(nt,ye);continue}const gn=en[3],An=xr(l.transform.getCameraToCenterDistance(H.projection),gn),Dn=o.bm(X,ee,Xe),It=E?Dn/An:Dn*An,pn=sa(dt,ct,jt,b);if(pn[3]<=0){Us(nt,ye);continue}let Xt={};const mn=E?null:V,wn=xi(Xe,It,!1,z,r,b,S,f.glyphOffsetArray,Se,ye,Te,pn,vt,Xt,je,mn,H.projection,q,E);Ye=wn.useVertical,mn&&wn.needsFlipping&&(Xt={}),(wn.notEnoughRoom||Ye||wn.needsFlipping&&xi(Xe,It,!0,z,r,b,S,f.glyphOffsetArray,Se,ye,Te,pn,vt,Xt,je,mn,H.projection,q,E).notEnoughRoom)&&Us(nt,ye)}m?(f.text.dynamicLayoutVertexBuffer.updateData(ye),Te&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(Te)):(f.icon.dynamicLayoutVertexBuffer.updateData(ye),Te&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(Te))}function hc(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye){const{lineStartIndex:Te,glyphStartIndex:Se,segment:De}=z,je=Se+z.numGlyphs,He=Te+z.lineLength,Ye=r.getoffsetX(Se),tt=r.getoffsetX(je-1),Xe=au(f*Ye,l,m,b,S,E,De,Te,He,V,q,H,X,ee,!0,ae,be,ye);if(!Xe)return null;const nt=au(f*tt,l,m,b,S,E,De,Te,He,V,q,H,X,ee,!0,ae,be,ye);return nt?{first:Xe,last:nt}:null}function pa(f,r,l,m){return f===o.bl.horizontal&&Math.abs(m)>Math.abs(l)?{useVertical:!0}:f===o.bl.vertical?m>0?{needsFlipping:!0}:null:r!==yi.unknown&&function(b,S){return b===0||Math.abs(S/b)>Hn}(l,m)?r===yi.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function xi(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te,Se,De){const je=r/24,He=f.lineOffsetX*je,Ye=f.lineOffsetY*je,{lineStartIndex:tt,glyphStartIndex:Xe,numGlyphs:nt,segment:lt,writingMode:vt,flipState:dt}=f,ct=tt+f.lineLength,jt=en=>{if(H){const[It,pn,Xt]=en.up,mn=q.length;o.bn(H,mn+0,It,pn,Xt),o.bn(H,mn+1,It,pn,Xt),o.bn(H,mn+2,It,pn,Xt),o.bn(H,mn+3,It,pn,Xt)}const[gn,An,Dn]=en.point;o.bo(q,gn,An,Dn,en.angle)};if(nt>1){const en=hc(je,z,He,Ye,l,X,ee,f,V,S,ae,ye,!1,Te,Se,De);if(!en)return{notEnoughRoom:!0};if(m&&!l){let[gn,An,Dn]=en.first.point,[It,pn,Xt]=en.last.point;[gn,An]=sa(gn,An,Dn,E),[It,pn]=sa(It,pn,Xt,E);const mn=pa(vt,dt,(It-gn)*be,pn-An);if(f.flipState=mn&&mn.needsFlipping?yi.flipRequired:yi.flipNotRequired,mn)return mn}jt(en.first);for(let gn=Xe+1;gn<Xe+nt-1;gn++){const An=au(je*z.getoffsetX(gn),He,Ye,l,X,ee,lt,tt,ct,V,S,ae,ye,!1,!1,Te,Se,De);if(!An)return q.length-=4*(gn-Xe),{notEnoughRoom:!0};jt(An)}jt(en.last)}else{if(m&&!l){const gn=sa(ee.x,ee.y,0,b),An=tt+lt+1,Dn=new o.P(V.getx(An),V.gety(An)),It=sa(Dn.x,Dn.y,0,b),pn=It[3]>0?It:fc(ee,Dn,gn,1,b,void 0,Te,Se.canonical),Xt=pa(vt,dt,(pn[0]-gn[0])*be,pn[1]-gn[1]);if(f.flipState=Xt&&Xt.needsFlipping?yi.flipRequired:yi.flipNotRequired,Xt)return Xt}const en=au(je*z.getoffsetX(Xe),He,Ye,l,X,ee,lt,tt,ct,V,S,ae,ye,!1,!1,Te,Se,De);if(!en)return{notEnoughRoom:!0};jt(en)}return{}}function Fh(f,r,l,m,b){const{x:S,y:E,z}=m.projectTilePoint(f.x,f.y,r);if(!b)return sa(S,E,z,l);const[V,q,H]=b(f);return sa(S+V,E+q,z+H,l)}function fc(f,r,l,m,b,S,E,z){const V=Fh(f.sub(r)._unit()._add(f),z,b,E,S);return o.a6.vec3.sub(V,l,V),o.a6.vec3.normalize(V,V),o.a6.vec3.scaleAndAdd(V,l,V,m)}function au(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te,Se){const De=m?f-r:f+r;let je=De>0?1:-1,He=0;m&&(je*=-1,He=Math.PI),je<0&&(He+=Math.PI);let Ye=z+E+(je>0?0:1)|0,tt=b,Xe=b,nt=0,lt=0;const vt=Math.abs(De),dt=[],ct=[];let jt=S,en=jt;const gn=()=>fc(en,jt,Xe,vt-nt+1,H,ee,ye,Te.canonical);for(;nt+lt<=vt;){if(Ye+=je,Ye<z||Ye>=V)return null;if(Xe=tt,en=jt,dt.push(Xe),ae&&ct.push(en),jt=new o.P(q.getx(Ye),q.gety(Ye)),tt=X[Ye],!tt){const Vn=Fh(jt,Te.canonical,H,ye,ee);tt=Vn[3]>0?X[Ye]=Vn:gn()}nt+=lt,lt=o.a6.vec3.distance(Xe,tt)}be&&ee&&(X[Ye]&&(tt=gn(),lt=o.a6.vec3.distance(Xe,tt)),X[Ye]=tt);const An=(vt-nt)/lt,Dn=jt.sub(en)._mult(An)._add(en),It=o.a6.vec3.sub([],tt,Xe),pn=o.a6.vec3.scaleAndAdd([],Xe,It,An);let Xt=[0,0,1],mn=It[0],wn=It[1];if(Se&&(Xt=ye.upVector(Te.canonical,Dn.x,Dn.y),Xt[0]!==0||Xt[1]!==0||Xt[2]!==1)){const Vn=[Xt[2],0,-Xt[0]],fo=o.a6.vec3.cross([],Xt,Vn);o.a6.vec3.normalize(Vn,Vn),o.a6.vec3.normalize(fo,fo),mn=o.a6.vec3.dot(It,Vn),wn=o.a6.vec3.dot(It,fo)}if(l){const Vn=o.a6.vec3.cross([],Xt,It);o.a6.vec3.normalize(Vn,Vn),o.a6.vec3.scaleAndAdd(pn,pn,Vn,l*je)}const hn=He+Math.atan2(wn,mn);return dt.push(pn),ae&&ct.push(Dn),{point:pn,angle:hn,path:dt,tilePath:ct,up:Xt}}function Us(f,r){const l=r.length,m=l+4*f;r.resize(m),r.float32.fill(-1/0,4*l,4*m)}function gd(f,r,l){const m=r[0],b=r[1];return f[0]=l[0]*m+l[4]*b+l[12],f[1]=l[1]*m+l[5]*b+l[13],f[3]=l[3]*m+l[7]*b+l[15],f}const Ia=100;class la{constructor(r,l,m=new oi(r.width+200,r.height+200,25),b=new oi(r.width+200,r.height+200,25)){this.transform=r,this.grid=m,this.ignoredGrid=b,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Ia,this.screenBottomBoundary=r.height+Ia,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,m,b,S,E,z,V){let q=m.projectedAnchorX,H=m.projectedAnchorY,X=m.projectedAnchorZ;const ee=m.elevation,ae=m.tileID,be=r.getProjection();if(ee&&ae){const[tt,Xe,nt]=be.upVector(ae.canonical,m.tileAnchorX,m.tileAnchorY),lt=be.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;q+=tt*ee*lt,H+=Xe*ee*lt,X+=nt*ee*lt}const ye=this.projectAndGetPerspectiveRatio(z,q,H,X,m.tileID,be.name==="globe"||!!ee||this.transform.pitch>0,be),Te=E*ye.perspectiveRatio,Se=(m.x1*l+b.x-m.padding)*Te+ye.point.x,De=(m.y1*l+b.y-m.padding)*Te+ye.point.y,je=(m.x2*l+b.x+m.padding)*Te+ye.point.x,He=(m.y2*l+b.y+m.padding)*Te+ye.point.y,Ye=ye.perspectiveRatio<=.55||ye.occluded;return!this.isInsideGrid(Se,De,je,He)||!S&&this.grid.hitTest(Se,De,je,He,V)||Ye?{box:[],offscreen:!1,occluded:ye.occluded}:{box:[Se,De,je,He],offscreen:this.isOffscreen(Se,De,je,He),occluded:!1}}placeCollisionCircles(r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye){const Te=[],Se=this.transform.elevation,De=r.getProjection(),je=Se?Se.getAtTileOffsetFunc(ye,this.transform.center.lat,this.transform.worldSize,De):null,He=new o.P(m.tileAnchorX,m.tileAnchorY);let{x:Ye,y:tt,z:Xe}=De.projectTilePoint(He.x,He.y,ye.canonical);if(je){const[Dn,It,pn]=je(He);Ye+=Dn,tt+=It,Xe+=pn}const nt=De.name==="globe",lt=this.projectAndGetPerspectiveRatio(z,Ye,tt,Xe,ye,nt||!!Se||this.transform.pitch>0,De),{perspectiveRatio:vt}=lt,dt=(X?E/vt:E*vt)/o.br,ct=sa(Ye,tt,Xe,V),jt=lt.signedDistanceFromCamera>0?hc(dt,S,m.lineOffsetX*dt,m.lineOffsetY*dt,!1,ct,He,m,b,V,{},Se&&!X?je:null,X&&!!Se,De,ye,X):null;let en=!1,gn=!1,An=!0;if(jt&&!lt.occluded){const Dn=.5*ae*vt+be,It=new o.P(-100,-100),pn=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Xt=new ko,{first:mn,last:wn}=jt,hn=mn.path.length;let Vn=[];for(let ro=hn-1;ro>=1;ro--)Vn.push(mn.path[ro]);for(let ro=1;ro<wn.path.length;ro++)Vn.push(wn.path[ro]);const fo=2.5*Dn;q&&(Vn=Vn.map(([ro,So,Wn],Ro)=>(je&&!nt&&(Wn=je(Ro<hn-1?mn.tilePath[hn-1-Ro]:wn.tilePath[Ro-hn+2])[2]),sa(ro,So,Wn,q))),Vn.some(ro=>ro[3]<=0)&&(Vn=[]));let xo=[];if(Vn.length>0){let ro=1/0,So=-1/0,Wn=1/0,Ro=-1/0;for(const Ko of Vn)ro=Math.min(ro,Ko[0]),Wn=Math.min(Wn,Ko[1]),So=Math.max(So,Ko[0]),Ro=Math.max(Ro,Ko[1]);So>=It.x&&ro<=pn.x&&Ro>=It.y&&Wn<=pn.y&&(xo=[Vn.map(Ko=>new o.P(Ko[0],Ko[1]))],(ro<It.x||So>pn.x||Wn<It.y||Ro>pn.y)&&(xo=o.bp(xo,It.x,It.y,pn.x,pn.y)))}for(const ro of xo){Xt.reset(ro,.25*Dn);let So=0;So=Xt.length<=.5*Dn?1:Math.ceil(Xt.paddedLength/fo)+1;for(let Wn=0;Wn<So;Wn++){const Ro=Wn/Math.max(So-1,1),Ko=Xt.lerp(Ro),mr=Ko.x+Ia,Kr=Ko.y+Ia;Te.push(mr,Kr,Dn,0);const Sr=mr-Dn,ii=Kr-Dn,kr=mr+Dn,Zr=Kr+Dn;if(An=An&&this.isOffscreen(Sr,ii,kr,Zr),gn=gn||this.isInsideGrid(Sr,ii,kr,Zr),!l&&this.grid.hitTestCircle(mr,Kr,Dn,ee)&&(en=!0,!H))return{circles:[],offscreen:!1,collisionDetected:en,occluded:!1}}}}return{circles:!H&&en||!gn?[]:Te,offscreen:An,collisionDetected:en,occluded:lt.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let m=1/0,b=1/0,S=-1/0,E=-1/0;for(const H of r){const X=new o.P(H.x+Ia,H.y+Ia);m=Math.min(m,X.x),b=Math.min(b,X.y),S=Math.max(S,X.x),E=Math.max(E,X.y),l.push(X)}const z=this.grid.query(m,b,S,E).concat(this.ignoredGrid.query(m,b,S,E)),V={},q={};for(const H of z){const X=H.key;if(V[X.bucketInstanceId]===void 0&&(V[X.bucketInstanceId]={}),V[X.bucketInstanceId][X.featureIndex])continue;const ee=[new o.P(H.x1,H.y1),new o.P(H.x2,H.y1),new o.P(H.x2,H.y2),new o.P(H.x1,H.y2)];o.bq(l,ee)&&(V[X.bucketInstanceId][X.featureIndex]=!0,q[X.bucketInstanceId]===void 0&&(q[X.bucketInstanceId]=[]),q[X.bucketInstanceId].push(X.featureIndex))}return q}insertCollisionBox(r,l,m,b,S){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:b,collisionGroupID:S},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,m,b,S){const E=l?this.ignoredGrid:this.grid,z={bucketInstanceId:m,featureIndex:b,collisionGroupID:S};for(let V=0;V<r.length;V+=4)E.insertCircle(z,r[V],r[V+1],r[V+2])}projectAndGetPerspectiveRatio(r,l,m,b,S,E,z){const V=[l,m,b,1];let q=!1;b||this.transform.pitch>0?(o.a6.vec4.transformMat4(V,V,r),this.fogState&&S&&z.name!=="globe"&&(q=function(ee,ae,be,ye,Te,Se){const De=Se.calculateFogTileMatrix(Te),je=[ae,be,ye];return o.a6.vec3.transformMat4(je,je,De),Yt(ee,o.a6.vec3.length(je),Se.pitch,Se._fov)}(this.fogState,l,m,b,S.toUnwrapped(),this.transform)>.9)):gd(V,V,r);const H=V[3];return{point:new o.P((V[0]/H+1)/2*this.transform.width+Ia,(-V[1]/H+1)/2*this.transform.height+Ia),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/H*.5,1.5),signedDistanceFromCamera:H,occluded:E&&V[2]>H||q}}isOffscreen(r,l,m,b){return m<Ia||r>=this.screenRightBoundary||b<Ia||l>this.screenBottomBoundary}isInsideGrid(r,l,m,b){return m>=0&&r<this.gridRightBoundary&&b>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=o.a6.mat4.identity([]);return o.a6.mat4.translate(r,r,[-100,-100,0]),r}}function ma(f,r,l){const m=r.createTileMatrix(f,f.worldSize,l.toUnwrapped());return o.a6.mat4.multiply(new Float32Array(16),f.projMatrix,m)}function ep(f,r,l){if(r.projection.name===l.projection.name)return f.projMatrix;const m=l.clone();return m.setProjection(r.projection),ma(m,r.getProjection(),f)}function Il(f,r,l){return r.name===l.projection.name?f.projMatrix:ma(l,r,f)}class Ci{constructor(r,l,m,b){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):b&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class ca{constructor(r,l,m,b,S,E=!1){this.text=new Ci(r?r.text:null,l,m,S),this.icon=new Ci(r?r.icon:null,l,b,S),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qa{constructor(r,l,m,b=!1){this.text=r,this.icon=l,this.skipFade=m,this.clipped=b}}class _i{constructor(){this.invProjMatrix=o.a6.mat4.create(),this.viewportMatrix=o.a6.mat4.create(),this.circles=[]}}class vd{constructor(r,l,m,b,S){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=m,this.bucketIndex=b,this.tileID=S}}class es{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:m=>m.collisionGroupID===l}}return this.collisionGroups[r]}}function su(f,r,l,m,b){const{horizontalAlign:S,verticalAlign:E}=o.by(f),z=-(S-.5)*r,V=-(E-.5)*l,q=o.bx(f,m);return new o.P(z+q[0]*b,V+q[1]*b)}function Al(f,r,l,m,b){const S=new o.P(f,r);return l&&S._rotate(m?b:-b),S}class js{constructor(r,l,m,b,S,E){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new la(this.transform,S),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new es(m),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,m,b,S=1){const E=m.getBucket(l),z=m.latestFeatureIndex;if(!E||!z||l.fqid!==E.layerIds[0])return;const V=E.layers[0].layout,q=E.layers[0].paint,H=m.collisionBoxArray,X=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),ee=m.tileSize/o.ab,ae=m.tileID.toUnwrapped();this.transform.setProjection(E.projection);const be=(ye=m.tileID,Te=E.getProjection(),Se=this.transform,Te.name===this.projection?Se.calculateProjMatrix(ye.toUnwrapped()):ma(Se,Te,ye));var ye,Te,Se;const De=V.get("text-pitch-alignment")==="map",je=V.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const He=l.dynamicFilter(),Ye=l.dynamicFilterNeedsFeature(),tt=this.transform.calculatePixelsToTileUnitsMatrix(m),Xe=br(be,m.tileID.canonical,De,je,this.transform,E.getProjection(),tt);let nt=null;if(De){const gn=zr(be,m.tileID.canonical,De,je,this.transform,E.getProjection(),tt);nt=o.a6.mat4.multiply([],this.transform.labelPlaneMatrix,gn)}let lt=null;He&&m.latestFeatureIndex&&(lt={unwrappedTileID:ae,dynamicFilter:He,dynamicFilterNeedsFeature:Ye}),this.retainedQueryData[E.bucketInstanceId]=new vd(E.bucketInstanceId,z,E.sourceLayerIndex,E.index,m.tileID);const vt=E.layers[0].layout.get("text-size-scale-range"),dt=o.ap(S,vt[0],vt[1]),ct=E.layers[0].layout.get("icon-size-scale-range"),jt=o.ap(S,ct[0],ct[1]),en={bucket:E,layout:V,paint:q,posMatrix:be,textLabelPlaneMatrix:Xe,labelToScreenMatrix:nt,clippingData:lt,scale:X,textPixelRatio:ee,holdingForFade:m.holdingForFade(),collisionBoxArray:H,partiallyEvaluatedTextSize:o.bk(E.textSizeData,this.transform.zoom,dt),partiallyEvaluatedIconSize:o.bk(E.iconSizeData,this.transform.zoom,jt),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(b)for(const gn of E.sortKeyRanges){const{sortKey:An,symbolInstanceStart:Dn,symbolInstanceEnd:It}=gn;r.push({sortKey:An,symbolInstanceStart:Dn,symbolInstanceEnd:It,parameters:en})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:en})}attemptAnchorPlacement(r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te,Se,De){const{textOffset0:je,textOffset1:He,crossTileID:Ye}=ee,tt=[je,He],Xe=su(r,m,b,tt,S),nt=this.collisionIndex.placeCollisionBox(be,S,l,Al(Xe.x,Xe.y,E,z,this.transform.angle),X,V,q,H.predicate);if(Te){const lt=be.getSymbolInstanceIconSize(De,this.transform.zoom,ee.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(be,lt,Te,Al(Xe.x,Xe.y,E,z,this.transform.angle),X,V,q,H.predicate).box.length===0)return}if(nt.box.length>0){let lt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ye]&&this.prevPlacement.placements[Ye]&&this.prevPlacement.placements[Ye].text&&(lt=this.prevPlacement.variableOffsets[Ye].anchor),this.variableOffsets[Ye]={textOffset:tt,width:m,height:b,anchor:r,textScale:S,prevAnchor:lt},this.markUsedJustification(be,r,ee,ye),be.allowVerticalPlacement&&(this.markUsedOrientation(be,ye,ee),this.placedOrientations[Ye]=ye),{shift:Xe,placedGlyphBoxes:nt}}}placeLayerBucketPart(r,l,m,b,S=1){const{bucket:E,layout:z,paint:V,posMatrix:q,textLabelPlaneMatrix:H,labelToScreenMatrix:X,clippingData:ee,textPixelRatio:ae,holdingForFade:be,collisionBoxArray:ye,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:Se,collisionGroup:De,latestFeatureIndex:je}=r.parameters,He=z.get("text-optional"),Ye=z.get("icon-optional"),tt=z.get("text-allow-overlap"),Xe=z.get("icon-allow-overlap"),nt=z.get("text-rotation-alignment")==="map",lt=z.get("text-pitch-alignment")==="map",vt=z.get("symbol-z-elevate"),dt=V.get("symbol-z-offset"),ct=z.get("symbol-elevation-reference")==="sea",jt=z.get("text-size-scale-range"),en=z.get("icon-size-scale-range"),gn=o.ap(S,jt[0],jt[1]),An=o.ap(S,en[0],en[1]);this.transform.setProjection(E.projection);let Dn=tt&&(Xe||!E.hasIconData()||Ye),It=Xe&&(tt||!E.hasTextData()||He);const pn=!dt.isConstant();!E.collisionArrays&&ye&&E.deserializeCollisionBoxes(ye),m&&b&&E.updateCollisionDebugBuffers(this.transform.zoom,ye,gn,An);const Xt=(mn,wn,hn)=>{const{crossTileID:Vn,numVerticalGlyphVertices:fo}=mn;let xo=null;if(ee&&ee.dynamicFilterNeedsFeature||pn){const wr=this.retainedQueryData[E.bucketInstanceId];xo=je.loadFeature({featureIndex:mn.featureIndex,bucketIndex:wr.bucketIndex,sourceLayerIndex:wr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(ee&&!(0,ee.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},xo,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new o.P(mn.tileAnchorX,mn.tileAnchorY),this.transform.calculateDistanceTileData(ee.unwrappedTileID)))return this.placements[Vn]=new Qa(!1,!1,!1,!0),void l.add(Vn);const ro=dt.evaluate(xo,{});if(l.has(Vn))return;if(be)return void(this.placements[Vn]=new Qa(!1,!1,!1));let So=!1,Wn=!1,Ro=!0,Ko=!1,mr=!1,Kr=null,Sr={box:null,offscreen:null,occluded:null},ii={box:null,offscreen:null,occluded:null},kr=null,Zr=null,sr=null,Gr=0,Ur=0,Or=0;hn.textFeatureIndex?Gr=hn.textFeatureIndex:mn.useRuntimeCollisionCircles&&(Gr=mn.featureIndex),hn.verticalTextFeatureIndex&&(Ur=hn.verticalTextFeatureIndex);const fi=wr=>{wr.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const _r=this.transform.elevation;wr.elevation=ct?ro:ro+(_r?_r.getAtTileOffset(wr.tileID,wr.tileAnchorX,wr.tileAnchorY):0),wr.elevation+=mn.zOffset},Yi=hn.textBox;if(Yi){fi(Yi);const wr=Pr=>{let Jr=o.bl.horizontal;if(E.allowVerticalPlacement&&!Pr&&this.prevPlacement){const Pi=this.prevPlacement.placedOrientations[Vn];Pi&&(this.placedOrientations[Vn]=Pi,Jr=Pi,this.markUsedOrientation(E,Jr,mn))}return Jr},_r=(Pr,Jr)=>{if(E.allowVerticalPlacement&&fo>0&&hn.verticalTextBox){for(const Pi of E.writingModes)if(Pi===o.bl.vertical?(Sr=Jr(),ii=Sr):Sr=Pr(),Sr&&Sr.box&&Sr.box.length)break}else Sr=Pr()};if(z.get("text-variable-anchor")){let Pr=z.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Vn]){const pi=this.prevPlacement.variableOffsets[Vn];Pr.indexOf(pi.anchor)>0&&(Pr=Pr.filter(ra=>ra!==pi.anchor),Pr.unshift(pi.anchor))}const Jr=(pi,ra,Hl)=>{const rs=E.getSymbolInstanceTextSize(Te,mn,this.transform.zoom,wn),is=(pi.x2-pi.x1)*rs+2*pi.padding,Xs=(pi.y2-pi.y1)*rs+2*pi.padding,vl=mn.hasIconTextFit&&!Xe?ra:null;vl&&fi(vl);let as={box:[],offscreen:!1,occluded:!1};const Rc=tt?2*Pr.length:Pr.length;for(let Js=0;Js<Rc;++Js){const Fr=this.attemptAnchorPlacement(Pr[Js%Pr.length],pi,is,Xs,rs,nt,lt,ae,q,De,Js>=Pr.length,mn,wn,E,Hl,vl,Te,Se);if(Fr&&(as=Fr.placedGlyphBoxes,as&&as.box&&as.box.length)){So=!0,Kr=Fr.shift;break}}return as};_r(()=>Jr(Yi,hn.iconBox,o.bl.horizontal),()=>{const pi=hn.verticalTextBox;return pi&&fi(pi),E.allowVerticalPlacement&&!(Sr&&Sr.box&&Sr.box.length)&&fo>0&&pi?Jr(pi,hn.verticalIconBox,o.bl.vertical):{box:null,offscreen:null,occluded:null}}),Sr&&(So=Sr.box,Ro=Sr.offscreen,Ko=Sr.occluded);const Pi=wr(!(!Sr||!Sr.box));if(!So&&this.prevPlacement){const pi=this.prevPlacement.variableOffsets[Vn];pi&&(this.variableOffsets[Vn]=pi,this.markUsedJustification(E,pi.anchor,mn,Pi))}}else{const Pr=(Jr,Pi)=>{const pi=E.getSymbolInstanceTextSize(Te,mn,this.transform.zoom,wn,S),ra=this.collisionIndex.placeCollisionBox(E,pi,Jr,new o.P(0,0),tt,ae,q,De.predicate);return ra&&ra.box&&ra.box.length&&(this.markUsedOrientation(E,Pi,mn),this.placedOrientations[Vn]=Pi),ra};_r(()=>Pr(Yi,o.bl.horizontal),()=>{const Jr=hn.verticalTextBox;return E.allowVerticalPlacement&&fo>0&&Jr?(fi(Jr),Pr(Jr,o.bl.vertical)):{box:null,offscreen:null,occluded:null}}),wr(!!(Sr&&Sr.box&&Sr.box.length))}}if(kr=Sr,So=kr&&kr.box&&kr.box.length>0,Ro=kr&&kr.offscreen,Ko=kr&&kr.occluded,mn.useRuntimeCollisionCircles){const wr=E.text.placedSymbolArray.get(mn.centerJustifiedTextSymbolIndex>=0?mn.centerJustifiedTextSymbolIndex:mn.verticalPlacedTextSymbolIndex),_r=o.bm(E.textSizeData,Te,wr),Pr=z.get("text-padding");Zr=this.collisionIndex.placeCollisionCircles(E,tt,wr,E.lineVertexArray,E.glyphOffsetArray,_r,q,H,X,m,lt,De.predicate,mn.collisionCircleDiameter*_r/o.br,Pr,this.retainedQueryData[E.bucketInstanceId].tileID),So=tt||Zr.circles.length>0&&!Zr.collisionDetected,Ro=Ro&&Zr.offscreen,Ko=Zr.occluded}if(hn.iconFeatureIndex&&(Or=hn.iconFeatureIndex),hn.iconBox){const wr=_r=>{fi(_r);const Pr=mn.hasIconTextFit&&Kr?Al(Kr.x,Kr.y,nt,lt,this.transform.angle):new o.P(0,0),Jr=E.getSymbolInstanceIconSize(Se,this.transform.zoom,mn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Jr,_r,Pr,Xe,ae,q,De.predicate)};ii&&ii.box&&ii.box.length&&hn.verticalIconBox?(sr=wr(hn.verticalIconBox),Wn=sr.box.length>0):(sr=wr(hn.iconBox),Wn=sr.box.length>0),Ro=Ro&&sr.offscreen,mr=sr.occluded}const Cs=He||mn.numHorizontalGlyphVertices===0&&fo===0,Ys=Ye||mn.numIconVertices===0;if(Cs||Ys?Ys?Cs||(Wn=Wn&&So):So=Wn&&So:Wn=So=Wn&&So,So&&kr&&kr.box&&this.collisionIndex.insertCollisionBox(kr.box,z.get("text-ignore-placement"),E.bucketInstanceId,ii&&ii.box&&Ur?Ur:Gr,De.ID),Wn&&sr&&this.collisionIndex.insertCollisionBox(sr.box,z.get("icon-ignore-placement"),E.bucketInstanceId,Or,De.ID),Zr&&(So&&this.collisionIndex.insertCollisionCircles(Zr.circles,z.get("text-ignore-placement"),E.bucketInstanceId,Gr,De.ID),m)){const wr=E.bucketInstanceId;let _r=this.collisionCircleArrays[wr];_r===void 0&&(_r=this.collisionCircleArrays[wr]=new _i);for(let Pr=0;Pr<Zr.circles.length;Pr+=4)_r.circles.push(Zr.circles[Pr+0]),_r.circles.push(Zr.circles[Pr+1]),_r.circles.push(Zr.circles[Pr+2]),_r.circles.push(Zr.collisionDetected?1:0)}const ea=E.projection.name!=="globe";Dn=Dn&&(ea||!Ko),It=It&&(ea||!mr),this.placements[Vn]=new Qa(So||Dn,Wn||It,Ro||E.justReloaded),l.add(Vn)};if(vt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.updateZOffset()),E.sortFeaturesByY){const mn=E.getSortedSymbolIndexes(this.transform.angle);for(let wn=mn.length-1;wn>=0;--wn){const hn=mn[wn];Xt(E.symbolInstances.get(hn),hn,E.collisionArrays[hn])}E.hasAnyZOffset&&o.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const mn=E.getSortedIndexesByZOffset();for(let wn=0;wn<mn.length;++wn){const hn=mn[wn];Xt(E.symbolInstances.get(hn),hn,E.collisionArrays[hn])}}else for(let mn=r.symbolInstanceStart;mn<r.symbolInstanceEnd;mn++)Xt(E.symbolInstances.get(mn),mn,E.collisionArrays[mn]);if(m&&E.bucketInstanceId in this.collisionCircleArrays){const mn=this.collisionCircleArrays[E.bucketInstanceId];o.a6.mat4.invert(mn.invProjMatrix,q),mn.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(r,l,m,b){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:V,crossTileID:q}=m,H=o.bw(l),X=b===o.bl.vertical?V:H==="left"?S:H==="center"?E:H==="right"?z:-1;S>=0&&(r.text.placedSymbolArray.get(S).crossTileID=X>=0&&S!==X?0:q),E>=0&&(r.text.placedSymbolArray.get(E).crossTileID=X>=0&&E!==X?0:q),z>=0&&(r.text.placedSymbolArray.get(z).crossTileID=X>=0&&z!==X?0:q),V>=0&&(r.text.placedSymbolArray.get(V).crossTileID=X>=0&&V!==X?0:q)}markUsedOrientation(r,l,m){const b=l===o.bl.horizontal||l===o.bl.horizontalOnly?l:0,S=l===o.bl.vertical?l:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:V,verticalPlacedTextSymbolIndex:q}=m,H=r.text.placedSymbolArray;E>=0&&(H.get(E).placedOrientation=b),z>=0&&(H.get(z).placedOrientation=b),V>=0&&(H.get(V).placedOrientation=b),q>=0&&(H.get(q).placedOrientation=S)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let m=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const b=l?l.symbolFadeChange(r):1,S=l?l.opacities:{},E=l?l.variableOffsets:{},z=l?l.placedOrientations:{};for(const V in this.placements){const q=this.placements[V],H=S[V];H?(this.opacities[V]=new ca(H,b,q.text,q.icon,null,q.clipped),m=m||q.text!==H.text.placed||q.icon!==H.icon.placed):(this.opacities[V]=new ca(null,b,q.text,q.icon,q.skipFade,q.clipped),m=m||q.text||q.icon)}for(const V in S){const q=S[V];if(!this.opacities[V]){const H=new ca(q,b,!1,!1);H.isHidden()||(this.opacities[V]=H,m=m||q.text.placed||q.icon.placed)}}for(const V in E)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=E[V]);for(const V in z)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=z[V]);m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,m,b){const S=new Set;for(const E of l){const z=E.getBucket(r);z&&E.latestFeatureIndex&&r.fqid===z.layerIds[0]&&(this.updateBucketOpacities(z,S,E,E.collisionBoxArray,m,b,E.tileID,r.scope),z.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(z,E.tileID),z.updateZOffset()))}}updateBucketOpacities(r,l,m,b,S,E,z,V){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const q=r.layers[0].layout,H=r.layers[0].paint,X=!!r.layers[0].dynamicFilter(),ee=new ca(null,0,!1,!1,!0),ae=q.get("text-allow-overlap"),be=q.get("icon-allow-overlap"),ye=q.get("text-variable-anchor"),Te=q.get("text-rotation-alignment")==="map",Se=q.get("text-pitch-alignment")==="map",De=H.get("symbol-z-offset"),je=q.get("symbol-elevation-reference")==="sea",He=!De.isConstant(),Ye=new ca(null,0,ae&&(be||!r.hasIconData()||q.get("icon-optional")),be&&(ae||!r.hasTextData()||q.get("text-optional")),!0);!r.collisionArrays&&b&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(b);const tt=(nt,lt,vt)=>{for(let dt=0;dt<lt/4;dt++)nt.opacityVertexArray.emplaceBack(vt)};let Xe=0;E&&r.updateReplacement(z,E);for(let nt=0;nt<r.symbolInstances.length;nt++){const lt=r.symbolInstances.get(nt),{numHorizontalGlyphVertices:vt,numVerticalGlyphVertices:dt,crossTileID:ct,numIconVertices:jt,tileAnchorX:en,tileAnchorY:gn}=lt;let An=null;const Dn=this.retainedQueryData[r.bucketInstanceId];He&&lt&&Dn&&(An=m.latestFeatureIndex.loadFeature({featureIndex:lt.featureIndex,bucketIndex:Dn.bucketIndex,sourceLayerIndex:Dn.sourceLayerIndex,layoutVertexArrayOffset:0}));const It=De.evaluate(An,{}),pn=l.has(ct);let Xt=this.opacities[ct];pn?Xt=ee:Xt||(Xt=Ye,this.opacities[ct]=Xt),l.add(ct);const mn=vt>0||dt>0,wn=jt>0,hn=this.placedOrientations[ct],Vn=hn===o.bl.vertical,fo=hn===o.bl.horizontal||hn===o.bl.horizontalOnly;!mn&&!wn||Xt.isHidden()||Xe++;let xo=!1;if((mn||wn)&&E)for(const ro of r.activeReplacements){if(o.bs(ro,S,o.bt.Symbol,V)||ro.min.x>en||en>ro.max.x||ro.min.y>gn||gn>ro.max.y)continue;const So=o.bu(en,gn,z.canonical,ro.footprintTileId.canonical);if(xo=o.bv(So,ro.footprint),xo)break}if(mn){const ro=xo?Pl:Gs(Xt.text);tt(r.text,vt,Vn?Pl:ro),tt(r.text,dt,fo?Pl:ro);const So=Xt.text.isHidden(),{leftJustifiedTextSymbolIndex:Wn,centerJustifiedTextSymbolIndex:Ro,rightJustifiedTextSymbolIndex:Ko,verticalPlacedTextSymbolIndex:mr}=lt,Kr=r.text.placedSymbolArray,Sr=So||Vn?1:0;Wn>=0&&(Kr.get(Wn).hidden=Sr),Ro>=0&&(Kr.get(Ro).hidden=Sr),Ko>=0&&(Kr.get(Ko).hidden=Sr),mr>=0&&(Kr.get(mr).hidden=So||fo?1:0);const ii=this.variableOffsets[ct];ii&&this.markUsedJustification(r,ii.anchor,lt,hn);const kr=this.placedOrientations[ct];kr&&(this.markUsedJustification(r,"left",lt,kr),this.markUsedOrientation(r,kr,lt))}if(wn){const ro=xo?Pl:Gs(Xt.icon),{placedIconSymbolIndex:So,verticalPlacedIconSymbolIndex:Wn}=lt,Ro=r.icon.placedSymbolArray,Ko=Xt.icon.isHidden()?1:0;So>=0&&(tt(r.icon,jt,Vn?Pl:ro),Ro.get(So).hidden=Ko),Wn>=0&&(tt(r.icon,lt.numVerticalIconVertices,fo?Pl:ro),Ro.get(Wn).hidden=Ko)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const ro=r.collisionArrays[nt];if(ro){let So=new o.P(0,0),Wn=!0;if(ro.textBox||ro.verticalTextBox){if(ye){const Ko=this.variableOffsets[ct];Ko?(So=su(Ko.anchor,Ko.width,Ko.height,Ko.textOffset,Ko.textScale),Te&&So._rotate(Se?this.transform.angle:-this.transform.angle)):Wn=!1}X&&(Wn=!Xt.clipped),ro.textBox&&Fu(r.textCollisionBox.collisionVertexArray,Xt.text.placed,!Wn||Vn,It,je,So.x,So.y),ro.verticalTextBox&&Fu(r.textCollisionBox.collisionVertexArray,Xt.text.placed,!Wn||fo,It,je,So.x,So.y)}const Ro=Wn&&!!(!fo&&ro.verticalIconBox);ro.iconBox&&Fu(r.iconCollisionBox.collisionVertexArray,Xt.icon.placed,Ro,It,je,lt.hasIconTextFit?So.x:0,lt.hasIconTextFit?So.y:0),ro.verticalIconBox&&Fu(r.iconCollisionBox.collisionVertexArray,Xt.icon.placed,!Ro,It,je,lt.hasIconTextFit?So.x:0,lt.hasIconTextFit?So.y:0)}}}if(r.fullyClipped=Xe===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const nt=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=nt.invProjMatrix,r.placementViewportMatrix=nt.viewportMatrix,r.collisionCircleArray=nt.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const m=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function Fu(f,r,l,m,b,S,E){f.emplaceBack(r?1:0,l?1:0,S||0,E||0,m,b?1:0),f.emplaceBack(r?1:0,l?1:0,S||0,E||0,m,b?1:0),f.emplaceBack(r?1:0,l?1:0,S||0,E||0,m,b?1:0),f.emplaceBack(r?1:0,l?1:0,S||0,E||0,m,b?1:0)}const Hs=Math.pow(2,25),tg=Math.pow(2,24),kl=Math.pow(2,17),va=Math.pow(2,16),ng=Math.pow(2,9),_d=Math.pow(2,8),yd=Math.pow(2,1);function Gs(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,l=Math.floor(127*f.opacity);return l*Hs+r*tg+l*kl+r*va+l*ng+r*_d+l*yd+r}const Pl=0;class Bh{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,m,b,S,E){const z=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(z,b,r[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort((V,q)=>V.sortKey-q.sortKey));this._currentPartIndex<z.length;){const V=z[this._currentPartIndex];if(l.placeLayerBucketPart(V,this._seenCrossTileIDs,m,V.symbolInstanceStart===0,E),this._currentPartIndex++,S())return!0}return!1}}class pc{constructor(r,l,m,b,S,E,z,V,q){this.placement=new js(r,S,E,z,V,q),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(r,l,m,b,S){const E=o.q.now(),z=()=>{const V=o.q.now()-E;return!this._forceFullPlacement&&V>2};for(;this._currentPlacementIndex>=0;){const V=l[r[this._currentPlacementIndex]],q=this.placement.collisionIndex.transform.zoom;if(V.type==="symbol"&&(!V.minzoom||V.minzoom<=q)&&(!V.maxzoom||V.maxzoom>q)){const H=V,X=H.layout.get("symbol-z-elevate"),ee=H.layout.get("symbol-sort-key").constantOr(1)!==void 0,ae=H.layout.get("symbol-z-order"),be=ae==="viewport-y"||ae==="auto"&&!(ae!=="viewport-y"&&ee),ye=H.layout.get("text-allow-overlap")||H.layout.get("icon-allow-overlap")||H.layout.get("text-ignore-placement")||H.layout.get("icon-ignore-placement"),Te=be&&ye,Se=this._inProgressLayer=this._inProgressLayer||new Bh(H),De=o.av(V.source,V.scope);if(Se.continuePlacement(X||Te?b[De]:m[De],this.placement,this._showCollisionBoxes,V,z,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const ys=512/o.ab/2;class og{constructor(r,l,m){this.tileID=r,this.bucketInstanceId=m,this.index=new o.bz(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=r.canonical.x*o.ab,S=r.canonical.y*o.ab;for(let E=0;E<l.length;E++){const{key:z,crossTileID:V,tileAnchorX:q,tileAnchorY:H}=l.get(E),X=Math.floor((b+q)*ys),ee=Math.floor((S+H)*ys);this.index.add(X,ee),this.keys.push(z),this.crossTileIDs.push(V)}this.index.finish()}findMatches(r,l,m){const b=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),S=ys/Math.pow(2,l.canonical.z-this.tileID.canonical.z),E=l.canonical.x*o.ab,z=l.canonical.y*o.ab;for(let V=0;V<r.length;V++){const q=r.get(V);if(q.crossTileID)continue;const{key:H,tileAnchorX:X,tileAnchorY:ee}=q,ae=Math.floor((E+X)*S),be=Math.floor((z+ee)*S),ye=this.index.range(ae-b,be-b,ae+b,be+b);for(const Te of ye){const Se=this.crossTileIDs[Te];if(this.keys[Te]===H&&!m.has(Se)){m.add(Se),q.crossTileID=Se;break}}}}}class lu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class tp{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const m in this.indexes){const b=this.indexes[m],S={};for(const E in b){const z=b[E];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+l),S[z.tileID.key]=z}this.indexes[m]=S}this.lng=r}addBucket(r,l,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let S=0;S<l.symbolInstances.length;S++)l.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const b=this.usedCrossTileIDs[r.overscaledZ];for(const S in this.indexes){const E=this.indexes[S];if(Number(S)>r.overscaledZ)for(const z in E){const V=E[z];V.tileID.isChildOf(r)&&V.findMatches(l.symbolInstances,r,b)}else{const z=E[r.scaledTo(Number(S)).key];z&&z.findMatches(l.symbolInstances,r,b)}}for(let S=0;S<l.symbolInstances.length;S++){const E=l.symbolInstances.get(S);E.crossTileID||(E.crossTileID=m.generate(),b.add(E.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new og(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const m of l.crossTileIDs)this.usedCrossTileIDs[r].delete(m)}removeStaleBuckets(r){let l=!1;for(const m in this.indexes){const b=this.indexes[m];for(const S in b)r[b[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,b[S]),delete b[S],l=!0)}return l}}class bd{constructor(){this.layerIndexes={},this.crossTileIDs=new lu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,m,b){let S=this.layerIndexes[r.fqid];S===void 0&&(S=this.layerIndexes[r.fqid]=new tp);let E=!1;const z={};b.name!=="globe"&&S.handleWrapJump(m);for(const V of l){const q=V.getBucket(r);q&&r.fqid===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(V.tileID,q,this.crossTileIDs)&&(E=!0),z[q.bucketInstanceId]=!0)}return S.removeStaleBuckets(z)&&(E=!0),E}pruneUnusedLayers(r){const l={};r.forEach(m=>{l[m]=!0});for(const m in this.layerIndexes)l[m]||delete this.layerIndexes[m]}}const Fa=771;class ir{constructor(r,l,m,b){this.blendFunction=r,this.blendColor=l,this.mask=m,this.blendEquation=b}}ir.Replace=[1,0,1,0],ir.disabled=new ir(ir.Replace,o.bA.transparent,[!1,!1,!1,!1]),ir.unblended=new ir(ir.Replace,o.bA.transparent,[!0,!0,!0,!0]),ir.alphaBlended=new ir([1,Fa,1,Fa],o.bA.transparent,[!0,!0,!0,!0]),ir.alphaBlendedNonPremultiplied=new ir([770,Fa,770,Fa],o.bA.transparent,[!0,!0,!0,!0]),ir.multiply=new ir([774,0,774,0],o.bA.transparent,[!0,!0,!0,!0]);class bo{constructor(r,l,m){this.func=r,this.mask=l,this.range=m}}bo.ReadOnly=!1,bo.ReadWrite=!0,bo.disabled=new bo(519,bo.ReadOnly,[0,1]);const cl=7680;class Do{constructor(r,l,m,b,S,E){this.test=r,this.ref=l,this.mask=m,this.fail=b,this.depthFail=S,this.pass=E}}Do.disabled=new Do({func:519,mask:0},0,0,cl,cl,cl);const ul=1029,Rl=2305;class Po{constructor(r,l,m){this.enable=r,this.mode=l,this.frontFace=m}}function Nh(f,r){const l=o.bD(f,3);o.a6.mat4.fromQuat(f,r),o.bF(f,3,l)}function mc(f,r){const l=o.a6.quat.identity([]);return o.a6.quat.rotateZ(l,l,-r),o.a6.quat.rotateX(l,l,-f),l}function gc(f,r){const l=[f[0],f[1],0],m=[r[0],r[1],0];if(o.a6.vec3.length(l)>=1e-15){const E=o.a6.vec3.normalize([],l);o.a6.vec3.scale(m,E,o.a6.vec3.dot(m,E)),r[0]=m[0],r[1]=m[1]}const b=o.a6.vec3.cross([],r,f);if(o.a6.vec3.len(b)<1e-15)return null;const S=Math.atan2(-b[1],b[0]);return mc(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),S)}Po.disabled=new Po(!1,ul,Rl),Po.backCCW=new Po(!0,ul,Rl),Po.backCW=new Po(!0,ul,2304),Po.frontCW=new Po(!0,1028,2304),Po.frontCCW=new Po(!0,1028,Rl);class dl{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof o.a5?r:new o.a5(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=o.bB(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const m=this.position,b=this._elevation?this._elevation.getAtPointOrZero(o.a5.fromLngLat(r)):0,S=o.a5.fromLngLat(r,b),E=[S.x-m.x,S.y-m.y,S.z-m.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=gc(E,l)}setPitchBearing(r,l){this.orientation=mc(o.bC(r),o.bC(-l))}}class Ll{constructor(r,l){this._transform=o.a6.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new o.a5(r[0],r[1],r[2])}get position(){const r=o.bD(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&o.bF(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.a6.quat.identity([]),r&&Nh(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=mc(r,l),Nh(this._transform,this._orientation)}forward(){const r=o.bD(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.bD(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.bD(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const m=new Float64Array(16);return o.a6.mat4.invert(m,this.getWorldToCamera(r,l)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,m){const b=this.position;o.a6.vec3.scale(b,b,-r);const S=new Float64Array(16);return o.a6.mat4.fromScaling(S,[m,m,m]),o.a6.mat4.translate(S,S,b),S[10]*=l,S}getWorldToCamera(r,l){const m=new Float64Array(16),b=new Float64Array(4),S=this.position;return o.a6.quat.conjugate(b,this._orientation),o.a6.vec3.scale(S,S,-r),o.a6.mat4.fromQuat(m,b),o.a6.mat4.translate(m,m,S),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=l,m[9]*=l,m[10]*=l,m[11]*=l,m}getCameraToClipPerspective(r,l,m,b){const S=new Float64Array(16);return o.a6.mat4.perspective(S,r,l,m,b),S}getCameraToClipOrthographic(r,l,m,b,S,E){const z=new Float64Array(16);return o.a6.mat4.ortho(z,r,l,m,b,S,E),z}getDistanceToElevation(r,l=!1){const m=r===0?0:o.bE(r,l?o.aN(this.position[1]):this.position[1]),b=this.forward();return(m-this.position[2])/b[2]}clone(){return new Ll([...this.position],[...this.orientation])}}const ua={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class xd{constructor(r=0,l=0,m=0,b=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(m)||m<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=m,this.right=b}interpolate(r,l,m){return l.top!=null&&r.top!=null&&(this.top=o.aa(r.top,l.top,m)),l.bottom!=null&&r.bottom!=null&&(this.bottom=o.aa(r.bottom,l.bottom,m)),l.left!=null&&r.left!=null&&(this.left=o.aa(r.left,l.left,m)),l.right!=null&&r.right!=null&&(this.right=o.aa(r.right,l.right,m)),this}getCenter(r,l){const m=o.ap((this.left+r-this.right)/2,0,r),b=o.ap((this.top+l-this.bottom)/2,0,l);return new o.P(m,b)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new xd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const vc=(f,r,l)=>(1-l)*f+l*r,_c=f=>f*f*f*f*f;class yc{constructor(r,l,m,b,S,E,z){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=m??0,this._maxPitch=b??60,this.setProjection(E),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new o.bL(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new xd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Ll,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new yc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(r||m)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return o.ar(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=o.bM(this.projectionOptions);const m=this.getProjection(),b=!o.bi(l,m);return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.bM({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.bE(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bB(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=o.a6.mat2.create(),o.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=o.ap(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.bC(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let b=0,S=0;for(let E=0;E<l.length;E++){const z=new o.P(l[E][0]*this.width,m+l[E][1]*(this.height-m)),V=r.pointCoordinate(z);if(!V)continue;const q=1/Math.hypot(V[0]-this._camera.position[0],V[1]-this._camera.position[1]);b+=V[3]*q,S+=q}return S===0?NaN:b/S}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*l,b=this._mercatorZfromZoom(r),S=this._mercatorZfromZoom(this._maxZoom),E=Math.max(b-m,S);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let m;m=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const b=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,m));return o.ap(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!o.a6.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const m=[r.position.x,r.position.y,r.position.z];o.a6.vec3.exactEquals(m,this._camera.position)||(this._setCameraPosition(m),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new dl;return l.position=new o.a5(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!o.a6.quat.length(r))return!1;o.a6.quat.normalize(r,r);const l=o.a6.vec3.transformQuat([],[0,0,-1],r),m=o.a6.vec3.transformQuat([],[0,-1,0],r);if(m[2]<0)return!1;const b=gc(l,m);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;r[2]=o.ap(r[2],b/m,b/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,m){this._unmodified=!1,this._edgeInsets.interpolate(r,l,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new o.bN(0,r)];if(this.renderWorldCopies){const m=this.pointCoordinate(new o.P(0,0)),b=this.pointCoordinate(new o.P(this.width,0)),S=this.pointCoordinate(new o.P(this.width,this.height)),E=this.pointCoordinate(new o.P(0,this.height)),z=Math.floor(Math.min(m.x,b.x,S.x,E.x)),V=Math.floor(Math.max(m.x,b.x,S.x,E.x)),q=1;for(let H=z-q;H<=V+q;H++)H!==0&&l.push(new o.bN(H,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,m){let b=[];const S=m!==void 0,E=!S;if(E&&this.zoom<l||S&&m[0]===0&&m[1]===0)return b;const z=new Set,V=(H,X,ee,ae,be)=>{const ye=o.c2(X,H,ee,ae,be);z.has(ye)||(b.push(new o.aA(H,X,ee,ae,be)),z.add(ye))};for(let H=0;H<r.length;H++){const X=r[H];if(E&&X.canonical.z!==l)continue;const ee=X.canonical,ae=X.overscaledZ,be=X.wrap,ye=1<<ee.z,Te=ee.x+1<ye,Se=ee.x>0,De=ee.y+1<ye,je=ee.y>0,He=X.wrap-(Se?0:1),Ye=X.wrap+(Te?0:1),tt=Se?ee.x-1:ye-1,Xe=Te?ee.x+1:0;if(S)m[0]<0?(V(ae,Ye,ee.z,Xe,ee.y),m[1]<0&&De&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,Ye,ee.z,Xe,ee.y+1)),m[1]>0&&je&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,Ye,ee.z,Xe,ee.y-1))):m[0]>0?(V(ae,He,ee.z,tt,ee.y),m[1]<0&&De&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,He,ee.z,tt,ee.y+1)),m[1]>0&&je&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,He,ee.z,tt,ee.y-1))):m[1]<0&&De?V(ae,be,ee.z,ee.x,ee.y+1):je&&V(ae,be,ee.z,ee.x,ee.y-1);else{const nt=X.visibleQuadrants;1&nt&&(V(ae,He,ee.z,tt,ee.y),je&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,He,ee.z,tt,ee.y-1))),2&nt&&(V(ae,Ye,ee.z,Xe,ee.y),je&&(V(ae,be,ee.z,ee.x,ee.y-1),V(ae,Ye,ee.z,Xe,ee.y-1))),4&nt&&(V(ae,He,ee.z,tt,ee.y),De&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,He,ee.z,tt,ee.y+1))),8&nt&&(V(ae,Ye,ee.z,Xe,ee.y),De&&(V(ae,be,ee.z,ee.x,ee.y+1),V(ae,Ye,ee.z,Xe,ee.y+1)))}}const q=[];for(const H of b)b.some(X=>H.isChildOf(X))||q.push(H);if(b=q.filter(H=>!r.some(X=>!!(H.overscaledZ<l&&X.isChildOf(H))||H.equals(X)||H.isChildOf(X))),E){const H=1<<l,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ee=[H*X.x,H*X.y],ae=4,be=ae*ae;b=b.filter(ye=>{const Te=ye.canonical.x+.5-ee[0],Se=ye.canonical.y+.5-ee[1];return Te*Te+Se*Se<be})}return b}coveringTiles(r){let l=this.coveringZoomLevel(r);const m=l,b=this.elevation&&this.elevation.exaggeration(),S=b&&!r.isTerrainDEM,E=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const z=this.locationCoordinate(this.center),V=this.center.lat,q=1<<l,H=[q*z.x,q*z.y,0],X=this.projection.name==="globe",ee=!X,ae=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,ee),be=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ye=q*o.bE(1,this.center.lat),Te=this._camera.position[2]/o.bE(1,this.center.lat),Se=[q*be.x,q*be.y,Te*(ee?1:ye)],De=X||b,je=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),He=this.isLODDisabled(!0)?l:0;let Ye;if(this._elevation&&r.isTerrainDEM)Ye=1e4*this._elevation.exaggeration();else if(this._elevation){const It=this._elevation.getMinMaxForVisibleTiles();Ye=It?It.max:this._centerAltitude}else Ye=this._centerAltitude;const tt=r.isTerrainDEM?-Ye:this._elevation?this._elevation.getMinElevationBelowMSL():0,Xe=this.projection.isReprojectedInTileSpace?o.bP(this):1,nt=It=>{const Xt=new o.a5(It.x+25e-6,It.y,It.z),mn=new o.a5(It.x,It.y+25e-6,It.z),wn=It.toLngLat(),hn=Xt.toLngLat(),Vn=mn.toLngLat(),fo=this.locationCoordinate(wn),xo=this.locationCoordinate(hn),ro=this.locationCoordinate(Vn),So=Math.hypot(xo.x-fo.x,xo.y-fo.y),Wn=Math.hypot(ro.x-fo.x,ro.y-fo.y);return Math.sqrt(So*Wn)*Xe/25e-6},lt=It=>{const pn=Ye,Xt=tt;return{aabb:o.bS(this,q,0,0,0,It,Xt,pn,this.projection),zoom:0,x:0,y:0,minZ:Xt,maxZ:pn,wrap:It,fullyVisible:!1}},vt=[];let dt=[];const ct=l,jt=r.reparseOverscaled?m:l,en=(Te-this._centerAltitude)*ye,gn=It=>{if(!this._elevation||!It.tileID||!E)return;const pn=this._elevation.getMinMaxForTile(It.tileID),Xt=It.aabb;pn?(Xt.min[2]=pn.min,Xt.max[2]=pn.max,Xt.center[2]=(Xt.min[2]+Xt.max[2])/2):(It.shouldSplit=Dn(It),It.shouldSplit||(Xt.min[2]=Xt.max[2]=Xt.center[2]=this._centerAltitude))},An=(It,pn)=>{if(.707*pn<It)return 1;const Xt=pn/It;return Xt/(1.4144271570014144+(Math.pow(1.1,Xt-1.4144271570014144+1)-1)/(1.1-1)-1)},Dn=It=>{if(It.zoom<He)return!0;if(It.zoom===ct)return!1;if(It.shouldSplit!=null)return It.shouldSplit;const pn=It.aabb.distanceX(Se),Xt=It.aabb.distanceY(Se);let mn=en,wn=1;if(X){mn=It.aabb.distanceZ(Se);const Wn=Math.pow(2,It.zoom),Ro=o.aN((It.y+1)/Wn),Ko=o.aN(It.y/Wn),mr=Math.min(Math.max(V,Ro),Ko),Kr=o.c6(mr)/o.c6(V);if(wn=mr===V?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Kr/this._mercatorScaleRatio),this.zoom<=o.c3&&It.zoom===ct-1&&Kr>=.9)return!0}else if(S&&(mn=It.aabb.distanceZ(Se)*ye),this.projection.isReprojectedInTileSpace&&m<=5){const Wn=Math.pow(2,It.zoom),Ro=nt(new o.a5((It.x+.5)/Wn,(It.y+.5)/Wn));wn=Ro>.85?1:Ro}if(!E){const Wn=Math.sqrt(pn*pn+Xt*Xt+mn*mn);let Ro=(1<<ct-It.zoom)*je*wn;return Ro*=An(Math.max(mn,en),Wn),Wn<Ro}let hn=Number.MAX_VALUE,Vn=0;const fo=It.aabb.getCorners(),xo=[];for(const Wn of fo){o.a6.vec3.sub(xo,Wn,Se),X||(S?xo[2]*=ye:xo[2]=en);const Ro=o.a6.vec3.dot(xo,this._camera.forward());Ro<hn&&(hn=Ro,Vn=Math.abs(xo[2]))}let ro=(1<<ct-It.zoom)*je*wn;if(ro*=An(Math.max(Vn,en),hn),hn<ro)return!0;const So=It.aabb.closestPoint(H);return So[0]===H[0]&&So[1]===H[1]};if(this.renderWorldCopies)for(let It=1;It<=3;It++)vt.push(lt(-It)),vt.push(lt(It));for(vt.push(lt(0));vt.length>0;){const It=vt.pop(),pn=It.x,Xt=It.y;let mn=It.fullyVisible;const wn=()=>this.projection.name==="globe"&&(It.y===0||It.y===(1<<It.zoom)-1);if(!mn){let hn=De?It.aabb.intersects(ae):It.aabb.intersectsFlat(ae);if(hn===0&&wn()){const Vn=new o.bQ(It.zoom,pn,Xt);hn=o.bR(this,q,Vn,!0).intersects(ae)}if(hn===0)continue;mn=hn===2}if(It.zoom!==ct&&Dn(It))for(let hn=0;hn<4;hn++){const Vn=(pn<<1)+hn%2,fo=(Xt<<1)+(hn>>1),xo={aabb:E?It.aabb.quadrant(hn):o.bS(this,q,It.zoom+1,Vn,fo,It.wrap,It.minZ,It.maxZ,this.projection),zoom:It.zoom+1,x:Vn,y:fo,wrap:It.wrap,fullyVisible:mn,tileID:void 0,shouldSplit:void 0,minZ:It.minZ,maxZ:It.maxZ};S&&!X&&(xo.tileID=new o.aA(It.zoom+1===ct?jt:It.zoom+1,It.wrap,It.zoom+1,Vn,fo),gn(xo)),vt.push(xo)}else{const hn=It.zoom===ct?jt:It.zoom;if(r.minzoom&&r.minzoom>hn)continue;let Vn=0;if(!mn){let So=De?It.aabb.intersectsPrecise(ae):It.aabb.intersectsPreciseFlat(ae);if(So===0&&wn()){const Wn=new o.bQ(It.zoom,pn,Xt);So=o.bR(this,q,Wn,!0).intersectsPrecise(ae)}if(So===0)continue;if(r.calculateQuadrantVisibility)if(ae.containsPoint(It.aabb.center))Vn=15;else for(let Wn=0;Wn<4;Wn++)It.aabb.quadrant(Wn).intersects(ae)!==0&&(Vn|=1<<Wn)}const fo=H[0]-(.5+pn+(It.wrap<<It.zoom))*(1<<l-It.zoom),xo=H[1]-.5-Xt,ro=It.tileID?It.tileID:new o.aA(hn,It.wrap,It.zoom,pn,Xt);r.calculateQuadrantVisibility&&(ro.visibleQuadrants=Vn),dt.push({tileID:ro,distanceSq:fo*fo+xo*xo})}}if(this.fogCullDistSq){const It=this.fogCullDistSq,pn=this.horizonLineFromTop();dt=dt.filter(Xt=>{const mn=[0,0,0,1],wn=[o.ab,o.ab,0,1],hn=this.calculateFogTileMatrix(Xt.tileID.toUnwrapped());o.a6.vec4.transformMat4(mn,mn,hn),o.a6.vec4.transformMat4(wn,wn,hn);const Vn=o.a6.vec4.min([],mn,wn),fo=o.a6.vec4.max([],mn,wn),xo=o.bT(Vn,fo);if(xo===0)return!0;let ro=!1;const So=this._elevation;if(So&&xo>It&&pn!==0){const Wn=this.calculateProjMatrix(Xt.tileID.toUnwrapped());let Ro;r.isTerrainDEM||(Ro=So.getMinMaxForTile(Xt.tileID)),Ro||(Ro={min:tt,max:Ye});const Ko=o.c4(this.rotation),mr=[Ko[0]*o.ab,Ko[1]*o.ab,Ro.max];o.a6.vec3.transformMat4(mr,mr,Wn),ro=(1-mr[1])*this.height*.5<pn}return xo<It||ro})}return dt.sort((It,pn)=>It.distanceSq-pn.distanceSq).map(It=>It.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=o.ap(r.lat,-o.bU,o.bU),m=this.projection.project(r.lng,l);return new o.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.bE(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let m,b;const S=this.centerPoint;if(this.projection.name==="globe"){const z=this.worldSize;m=(l.x-S.x)/z,b=(l.y-S.y)/z}else{const z=this.pointCoordinate(l),V=this.pointCoordinate(S);m=z.x-V.x,b=z.y-V.y}const E=this.locationCoordinate(r);this.setLocation(new o.a5(E.x-m,E.y-b))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const m=l?o.bE(l,r.lat):void 0,b=this.projection.project(r.lng,r.lat);return new o.a5(b.x,b.y,m)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const m=l??this._centerAltitude,b=[r.x,r.y,0,1],S=[r.x,r.y,1,1];o.a6.vec4.transformMat4(b,b,this.pixelMatrixInverse),o.a6.vec4.transformMat4(S,S,this.pixelMatrixInverse);const E=S[3];o.a6.vec4.scale(b,b,1/b[3]),o.a6.vec4.scale(S,S,1/E);const z=b[2],V=S[2];return{p0:b,p1:S,t:z===V?0:(m-z)/(V-z)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],m=[r.x,r.y,1,1];return o.a6.vec4.transformMat4(l,l,this.pixelMatrixInverse),o.a6.vec4.transformMat4(m,m,this.pixelMatrixInverse),o.a6.vec4.scale(l,l,1/l[3]),o.a6.vec4.scale(m,m,1/m[3]),l[2]=o.bE(l[2],this._center.lat)*this.worldSize,m[2]=o.bE(m[2],this._center.lat)*this.worldSize,o.a6.vec4.scale(l,l,1/this.worldSize),o.a6.vec4.scale(m,m,1/this.worldSize),new o.aj([l[0],l[1],l[2]],o.a6.vec3.normalize([],o.a6.vec3.sub([],m,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:m,t:b}=r,S=o.bE(l[2],this._center.lat),E=o.bE(m[2],this._center.lat);return new o.a5(o.aa(l[0],m[0],b)/this.worldSize,o.aa(l[1],m[1],b)/this.worldSize,o.aa(S,E,b))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new o.a5(l[0],l[1],l[2]);let m=0,b=this.horizonLineFromTop();if(r.y>b)return this.pointCoordinate(r);const S=.02*b,E=r.clone();for(let z=0;z<10&&b-m>S;z++){E.y=o.aa(m,b,.66);const V=this.projection.pointCoordinate3D(this,E.x,E.y);V?(b=E.y,l=V):m=E.y}return l?new o.a5(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=o.bV)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const m=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,b=[r.x*this.worldSize,r.y*this.worldSize,m+r.toAltitude(),1];return o.a6.vec4.transformMat4(b,b,this.pixelMatrix),b[3]>0?new o.P(b[0]/b[3],b[1]/b[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,S=this.pointLocation3D(new o.P(l,r)),E=this.pointLocation3D(new o.P(b,r)),z=this.pointLocation3D(new o.P(b,m)),V=this.pointLocation3D(new o.P(l,m));let q=Math.min(S.lng,E.lng,z.lng,V.lng),H=Math.max(S.lng,E.lng,z.lng,V.lng),X=Math.min(S.lat,E.lat,z.lat,V.lat),ee=Math.max(S.lat,E.lat,z.lat,V.lat);const ae=Math.pow(2,-this.zoom)/16*270,be=this.projection.name==="globe"?1:4,ye=(Te,Se,De,je,He)=>{const Ye=(Te+De)/2,tt=(Se+je)/2,Xe=new o.P(Ye,tt),{lng:nt,lat:lt}=this.pointLocation3D(Xe),vt=Math.max(0,q-nt,X-lt,nt-H,lt-ee);q=Math.min(q,nt),H=Math.max(H,nt),X=Math.min(X,lt),ee=Math.max(ee,lt),(He<be||vt>ae)&&(ye(Te,Se,Ye,tt,He+1),ye(Ye,tt,De,je,He+1))};if(ye(l,r,b,r,1),ye(b,r,b,m,1),ye(b,m,l,m,1),ye(l,m,l,r,1),this.projection.name==="globe"){const[Te,Se]=o.bW(this);Te?(ee=90,H=180,q=-180):Se&&(X=-90,H=180,q=-180)}return new o.as(new o.bL(q,X),new o.bL(H,ee))}_getBoundsRectangular(r,l){const{top:m,left:b}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,z=new o.P(b,m),V=new o.P(E,m),q=new o.P(E,S),H=new o.P(b,S);let X=this.pointCoordinate(z,r),ee=this.pointCoordinate(V,r);const ae=this.pointCoordinate(q,l),be=this.pointCoordinate(H,l),ye=(Te,Se)=>(Se.y-Te.y)/(Se.x-Te.x);return X.y>1&&ee.y>=0?X=new o.a5((1-be.y)/ye(be,X)+be.x,1):X.y<0&&ee.y<=1&&(X=new o.a5(-be.y/ye(be,X)+be.x,0)),ee.y>1&&X.y>=0?ee=new o.a5((1-ae.y)/ye(ae,ee)+ae.x,1):ee.y<0&&X.y<=1&&(ee=new o.a5(-ae.y/ye(ae,ee)+ae.x,0)),new o.as().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(be)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((m,b)=>{if(b.dem){const S=b.dem.tree;m.min=Math.min(m.min,S.minimums[0]),m.max=Math.max(m.max,S.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.bU,this.maxLat=o.bU,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.am(this.minLng)*this.tileSize,this.worldMaxX=o.am(this.maxLng)*this.tileSize,this.worldMinY=o.at(this.maxLat)*this.tileSize,this.worldMaxY=o.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,m=this._distanceTileDataCache;if(m[l])return m[l];const b=r.canonical,S=1/this.height,E=this.cameraWorldSize,z=E/this.zoomScale(b.z),V=(b.x+Math.pow(2,b.z)*r.wrap)*z,q=b.y*z,H=this.point;H.x*=E/this.worldSize,H.y*=E/this.worldSize;const X=this.angle,ee=Math.sin(-X),ae=-Math.cos(-X);return m[l]={bearing:[ee,ae],center:[(H.x-V)*S,(H.y-q)*S],scale:z/o.ab*S},m[l]}calculateFogTileMatrix(r){const l=r.key,m=this._fogTileMatrixCache;if(m[l])return m[l];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.a6.mat4.multiply(b,this.worldToFogMatrix,b),m[l]=new Float32Array(b),m[l]}calculateProjMatrix(r,l=!1,m=!1){const b=r.key;let S;if(S=m?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,S[b])return S[b];const E=this.calculatePosMatrix(r,this.worldSize);let z;return z=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,o.a6.mat4.multiply(E,z,E),S[b]=new Float32Array(E),S[b]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,m=this._pixelsToTileUnitsCache;if(m[l])return m[l];const b=o.bX(r,this);return m[l]=b,m[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=o.a6.mat4.fromScaling([],[r,r,r]);return o.a6.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=o.bE(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(l),b=this._camera.forward(),S=o.bE(1,this._center.lat);m[2]/=S,b[2]/=S,o.a6.vec3.normalize(b,b);const E=r.raycast(m,b,r.exaggeration());if(E){const z=o.a6.vec3.scaleAndAdd([],m,b,E),V=new o.a5(z[0],z[1],o.bE(z[2],o.aN(z[1]))),q=(V.z+o.a6.vec3.length([V.x-m[0],V.y-m[1],V.z-m[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(q),this._centerAltitude=V.toAltitude(),this._center=this.coordinateLocation(V),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,m=o.bE(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(m),S=l.getAtPointOrZero(new o.a5(...b)),E=this.pixelsPerMeter/this.worldSize*S,z=this._minimumHeightOverTerrain(),V=b[2]-E;if(V<=z)if(V<0||r){const q=this.locationCoordinate(this._center,this._centerAltitude),H=[b[0],b[1],q.z-b[2]],X=o.a6.vec3.length(H);H[2]-=(z-V)/this._pixelsPerMercatorPixel;const ee=o.a6.vec3.length(H);if(ee===0)return;o.a6.vec3.scale(H,H,X/ee*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],q.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const ee=this.center;return ee.lat=o.ap(ee.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(ee.lng=o.ap(ee.lng,this.minLng,this.maxLng)),this.center=ee,void(this._constraining=!1)}const l=this._unmodified,{x:m,y:b}=this.point;let S=0,E=m,z=b;const V=this.width/2,q=this.height/2,H=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(b-q<H&&(z=H+q),b+q>X&&(z=X-q),X-H<this.height&&(S=Math.max(S,this.height/(X-H)),z=(X+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ee=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,be=this.worldSize/2-(ee+ae)/2;E=(m+be+this.worldSize)%this.worldSize-be,E-V<ee&&(E=ee+V),E+V>ae&&(E=ae-V),ae-ee<this.width&&(S=Math.max(S,this.width/(ae-ee)),E=(ae+ee)/2)}E===m&&z===b||(this.center=this.unproject(new o.P(E,z))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.bE(1,this.center.lat)/o.bE(1,o.c5));const b=o.bY(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?m:1,E=this._camera.getWorldToCamera(this.worldSize,S);let z;const V=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(V[8]=2*-r.x/this.width,V[9]=2*r.y/this.height,this.isOrthographic){let lt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),vt=lt*this.aspect,dt=-vt,ct=-lt;vt-=r.x,dt-=r.x,lt+=r.y,ct+=r.y,z=this._camera.getCameraToClipOrthographic(dt,vt,ct,lt,this._nearZ,this._farZ),((jt,en,gn,An)=>{for(let Dn=0;Dn<16;Dn++)jt[Dn]=vc(en[Dn],gn[Dn],An)})(z,z,V,_c(this.pitch>=15?1:this.pitch/15))}else z=V;const q=o.a6.mat4.mul([],V,E);let H=o.a6.mat4.mul([],z,E);if(this.projection.isReprojectedInTileSpace){const lt=this.locationCoordinate(this.center),vt=o.a6.mat4.identity([]);o.a6.mat4.translate(vt,vt,[lt.x*this.worldSize,lt.y*this.worldSize,0]),o.a6.mat4.multiply(vt,vt,o.bZ(this)),o.a6.mat4.translate(vt,vt,[-lt.x*this.worldSize,-lt.y*this.worldSize,0]),o.a6.mat4.multiply(H,H,vt),o.a6.mat4.multiply(q,q,vt),this.inverseAdjustmentMatrix=o.b_(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.a6.mat4.scale([],H,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=H,this.invProjMatrix=o.a6.mat4.invert(new Float64Array(16),this.projMatrix),l){const lt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);lt[8]=2*-r.x/this.width,lt[9]=2*r.y/this.height,this.expandedFarZProjMatrix=o.a6.mat4.mul([],lt,E)}else this.expandedFarZProjMatrix=this.projMatrix;const X=o.a6.mat4.invert([],z);this.frustumCorners=o.b$.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const ee=new Float32Array(16);o.a6.mat4.identity(ee),o.a6.mat4.scale(ee,ee,[1,-1,1]),o.a6.mat4.rotateX(ee,ee,this._pitch),o.a6.mat4.rotateZ(ee,ee,this.angle);const ae=o.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.a6.mat4.clone(ae);const be=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-r.x/this.width,ae[9]=2*(r.y+be)/this.height,this.skyboxMatrix=o.a6.mat4.multiply(ee,ae,ee);const ye=this.point,Te=ye.x,Se=ye.y,De=this.width%2/2,je=this.height%2/2,He=Math.cos(this.angle),Ye=Math.sin(this.angle),tt=Te-Math.round(Te)+He*De+Ye*je,Xe=Se-Math.round(Se)+He*je+Ye*De,nt=new Float64Array(H);if(o.a6.mat4.translate(nt,nt,[tt>.5?tt-1:tt,Xe>.5?Xe-1:Xe,0]),this.alignedProjMatrix=nt,H=o.a6.mat4.create(),o.a6.mat4.scale(H,H,[this.width/2,-this.height/2,1]),o.a6.mat4.translate(H,H,[1,-1,0]),this.labelPlaneMatrix=H,H=o.a6.mat4.create(),o.a6.mat4.scale(H,H,[1,-1,1]),o.a6.mat4.translate(H,H,[-1,-1,0]),o.a6.mat4.scale(H,H,[2/this.width,2/this.height,1]),this.glCoordMatrix=H,this.pixelMatrix=o.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,q),this._calcFogMatrices(),this._distanceTileDataCache={},H=o.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!H)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=H,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.c0(this);const lt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.a6.vec3.transformMat4(lt,lt,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=H;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,m=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,S=[r,r,l];o.a6.vec3.scale(S,S,b),o.a6.vec3.scale(m,m,-1),o.a6.vec3.multiply(m,m,S);const E=o.a6.mat4.create();o.a6.mat4.translate(E,E,m),o.a6.mat4.scale(E,E,S),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,b)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),b=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-m[0]*S,b.y/this.worldSize-m[1]*S,r/this.worldSize*this._centerAltitude-m[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],b=r[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(S=Math.min((l-m)/b,1)),this._camera.position=o.a6.vec3.scaleAndAdd([],this._camera.position,r,S),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:m,bearing:b}=this._camera.getPitchBearing(),S=o.bE(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.bC(this._maxPitch)),z=Math.max((r[2]-S)/Math.cos(m),E),V=this._zoomFromMercatorZ(z);o.a6.vec3.scaleAndAdd(r,r,l,z),this._pitch=o.ap(m,o.bC(this.minPitch),o.bC(this.maxPitch)),this.angle=o.bB(b,-Math.PI,Math.PI),this._setZoom(o.ap(V,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.a5(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,m=o.bV,b=0,S=1/0;for(;m-l>1e-6&&m>l;){const E=l+.5*(m-l),z=this.tileSize*Math.pow(2,E),V=this.getCameraToCenterDistance(this.projection,E,z),q=this.scaleZoom(V/(r*this.tileSize)),H=Math.abs(E-q);H<S&&(S=H,b=E),E<q?l=E:m=E}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const m=Math.min(r.x,l.x),b=Math.max(r.x,l.x),S=Math.min(r.y,l.y),E=Math.max(r.y,l.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const z=[new o.P(m,S),new o.P(b,E),new o.P(m,E),new o.P(b,S)],V=this.renderWorldCopies?-3:0,q=this.renderWorldCopies?4:1;for(const H of z){const X=this.pointRayIntersection(H);if(X.t<0)return!0;const ee=this.rayIntersectionCoordinate(X);if(ee.x<V||ee.y<0||ee.x>q||ee.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.c1(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(r,l){const m=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,r)),b=this._zoomFromMercatorZ(m)+l;return m-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,m,b],S){const E=[l,m,b,1];o.a6.vec4.transformMat4(E,E,S);const z=E[3]=Math.max(E[3],1e-6);return E[0]/=z,E[1]/=z,E[2]/=z,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,m=this.worldSize){const b=o.bY(r,l,this.width,this.height,1024),S=r.pixelSpaceConversion(this.center.lat,m,b);let E=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(E=vc(1,E,_c(this.pitch>=15?1:this.pitch/15))),E}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.a6.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const Aa=(f,r)=>{if(r>0&&f.terrain&&o.w("Cutoff is currently disabled on terrain"),r<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=f.transform,m=Math.max(Math.abs(l._zoom-(f.minCutoffZoom-1)),1),b=l.isLODDisabled(!1)?o.a7(60,45,l.pitch):o.a7(30,15,l.pitch),S=l._farZ-l._nearZ,E=r*l.height,z=((1-(V=b))*l.cameraToCenterDistance+V*(l._farZ+E))*m;var V;return{shouldRenderCutoff:b<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(z-l._nearZ)/S,(z-E-l._nearZ)/S]}}},wi={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Ws{constructor(r,l){this.aabb=r,this.lastCascade=l}}class Nn{add(r,l){const m=this.receivers[r.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],l.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],l.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],l.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],l.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],l.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],l.max[2])):this.receivers[r.key]=new Ws(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,m){const b=o.ca.fromPoints(r.points);let S=0;for(const E in this.receivers){const z=this.receivers[E];if(!z||!b.intersectsAabb(z.aabb))continue;z.aabb.min=b.closestPoint(z.aabb.min),z.aabb.max=b.closestPoint(z.aabb.max);const V=z.aabb.getCorners();for(let q=0;q<m.length;q++){let H=!0;for(const X of V){const ee=[X[0]*l,X[1]*l,X[2]];if(o.a6.vec3.transformMat4(ee,ee,m[q].matrix),ee[0]<-1||ee[0]>1||ee[1]<-1||ee[1]>1){H=!1;break}}if(z.lastCascade=q,S=Math.max(S,q),H)break}}return S+1}}class Ol{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Nn,this._depthMode=new bo(r.context.gl.LEQUAL,bo.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(wi,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(wi,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(wi,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const b=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||b<=0||(this._shadowLayerCount=m.style.order.reduce((be,ye)=>{const Te=m.style._mergedLayers[ye];return be+(Te.hasShadowPass()&&!Te.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const S=m.context,E=wi.shadowMapResolution,z=wi.shadowMapResolution;if(this._cascades.length===0||wi.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let be=0;be<wi.cascadeCount;++be){const ye=m._shadowMapDebug,Te=S.gl,Se=S.createFramebuffer(E,z,ye,"texture"),De=new o.T(S,{width:E,height:z,data:null},Te.DEPTH_COMPONENT16);if(Se.depthAttachment.set(De.texture),ye){const je=new o.T(S,{width:E,height:z,data:null},Te.RGBA8);Se.colorAttachment.set(je.texture)}this._cascades.push({framebuffer:Se,texture:De,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.bO,scale:0})}}this.shadowDirection=wd(l);let V=0;if(r.elevation){const be=r.elevation,ye=[1e4,-1e4];be.visibleDemTiles.filter(Te=>Te.dem).forEach(Te=>{const Se=Te.dem.tree;ye[0]=Math.min(ye[0],Se.minimums[0]),ye[1]=Math.max(ye[1],Se.maximums[0])}),ye[0]!==1e4&&(V=(ye[1]-ye[0])*be.exaggeration())}const q=1.5*r.cameraToCenterDistance,H=3*q,X=new Float64Array(16);for(let be=0;be<this._cascades.length;++be){const ye=this._cascades[be];let Te=r.height/50,Se=1;wi.cascadeCount===1?Se=H:be===0?Se=q:(Te=q,Se=H);const[De,je]=cu(r,this.shadowDirection,Te,Se,wi.shadowMapResolution,V);ye.scale=r.scale,ye.matrix=De,ye.boundingSphereRadius=je,o.a6.mat4.invert(X,ye.matrix),ye.frustum=o.bO.fromInvProjectionMatrix(X,1,0,!0),ye.far=Se}const ee=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ee].far,this._cascades[ee].far],this._uniformValues.u_shadow_intensity=b,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/wi.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=wi.shadowMapResolution,this._uniformValues.u_shadowmap_0=ua.ShadowMap0,this._uniformValues.u_shadowmap_1=ua.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ae=m.transform.elevation;for(const be of this._groundShadowTiles){let ye={min:0,max:0};if(ae){const Te=ae.getMinMaxForTile(be);Te&&(ye=Te)}this.addShadowReceiver(be.toUnwrapped(),ye.min,ye.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const m=this.painter,b=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),b.viewport.set([0,0,wi.shadowMapResolution,wi.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){m.currentShadowCascade=S,b.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),b.clear({color:o.bA.white,depth:1});for(const E of r.order){const z=r._mergedLayers[E];if(!z.hasShadowPass()||z.isHidden(m.transform.zoom))continue;const V=r.getLayerSourceCache(z),q=V?l[V.id]:void 0;(z.type==="model"||q&&q.length)&&m.renderLayer(m,V,z,q)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,m=r.context,b=l.directionalLight,S=l.ambientLight;if(!b||!S)return;const E=[],z=Aa(r,r.longestCutoffRange);z.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");const V=xc(l,b,S),q=new bo(m.gl.LEQUAL,bo.ReadOnly,r.depthRangeFor3D);for(const H of this._groundShadowTiles){const X=H.toUnwrapped(),ee=r.isTileAffectedByFog(H),ae=r.getOrCreateProgram("groundShadow",{defines:E,overrideFog:ee});this.setupShadows(X,ae),r.uploadCommonUniforms(m,ae,X,null,z);const be={u_matrix:r.transform.calculateProjMatrix(X),u_ground_shadow_factor:V};ae.draw(r,m.gl.TRIANGLES,q,Do.disabled,ir.multiply,Po.disabled,be,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ir.unblended:ir.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,m=l.calculatePosMatrix(r,l.worldSize);return o.a6.mat4.multiply(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(r){return o.a6.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,m,b=0){if(!this.enabled)return;const S=this.painter.transform,E=this.painter.context,z=E.gl,V=this._uniformValues,q=new Float64Array(16),H=S.calculatePosMatrix(r,S.worldSize);for(let X=0;X<this._cascades.length;X++)o.a6.mat4.multiply(q,this._cascades[X].matrix,H),V[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(q),E.activeTexture.set(z.TEXTURE0+ua.ShadowMap0+X),this._cascades[X].texture.bind(z.NEAREST,z.CLAMP_TO_EDGE);if(this.useNormalOffset=!!m,this.useNormalOffset){const X=o.c9(r.canonical),ee=2/S.tileSize*o.ab/wi.shadowMapResolution,ae=ee*this._cascades[0].boundingSphereRadius,be=ee*this._cascades[this._cascades.length-1].boundingSphereRadius,ye=(m==="vector-tile"?1:3)/Math.pow(2,b-r.canonical.z-(1-S.zoom+Math.floor(S.zoom)));V.u_shadow_normal_offset=[X,ae*ye,be*ye],V.u_shadow_bias=[6e-5,.0012,.012]}else V.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(E,V)}setupShadowsFromMatrix(r,l,m=!1){if(!this.enabled)return;const b=this.painter.context,S=b.gl,E=this._uniformValues,z=new Float64Array(16);for(let V=0;V<wi.cascadeCount;V++)o.a6.mat4.multiply(z,this._cascades[V].matrix,r),E[V===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(z),b.activeTexture.set(S.TEXTURE0+ua.ShadowMap0+V),this._cascades[V].texture.bind(S.NEAREST,S.CLAMP_TO_EDGE);if(this.useNormalOffset=m,m){const V=wi.normalOffset;E.u_shadow_normal_offset=[1,V,V],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(b,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,m,b){if(b[2]>=0)return{};const S=function(V,q,H){const X=H/(1<<V.canonical.z);return new o.ca([V.canonical.x*X+V.wrap*H,V.canonical.y*X+V.wrap*H,0],[(V.canonical.x+1)*X+V.wrap*H,(V.canonical.y+1)*X+V.wrap*H,q])}(r,l,m).getCorners(),E=l/-b[2];b[0]<0?(o.a6.vec3.add(S[0],S[0],[b[0]*E,0,0]),o.a6.vec3.add(S[3],S[3],[b[0]*E,0,0])):b[0]>0&&(o.a6.vec3.add(S[1],S[1],[b[0]*E,0,0]),o.a6.vec3.add(S[2],S[2],[b[0]*E,0,0])),b[1]<0?(o.a6.vec3.add(S[0],S[0],[0,b[1]*E,0]),o.a6.vec3.add(S[1],S[1],[0,b[1]*E,0])):b[1]>0&&(o.a6.vec3.add(S[2],S[2],[0,b[1]*E,0]),o.a6.vec3.add(S[3],S[3],[0,b[1]*E,0]));const z={};return z.vertices=S,z.planes=[bc(S[1],S[0],S[4]),bc(S[2],S[1],S[5]),bc(S[3],S[2],S[6]),bc(S[0],S[3],S[7])],z}addShadowReceiver(r,l,m){this._receivers.add(r,o.ca.fromTileIdAndHeight(r,l,m))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function bc(f,r,l){const m=o.a6.vec3.sub([],l,r),b=o.a6.vec3.sub([],f,r),S=o.a6.vec3.cross([],m,b),E=o.a6.vec3.length(S);return E===0?[0,0,1,0]:(o.a6.vec3.scale(S,S,1/E),[S[0],S[1],S[2],-o.a6.vec3.dot(S,r)])}function wd(f){const r=f.properties.get("direction"),l=o.c8(r.x,r.y,r.z);l[2]=o.ap(l[2],0,75);const m=o.cb([l[0],l[1],l[2]]);return o.a6.vec3.fromValues(m.x,m.y,m.z)}function xc(f,r,l){const m=r.properties.get("color"),b=r.properties.get("intensity"),S=r.properties.get("direction"),E=[S.x,S.y,S.z],z=l.properties.get("color"),V=l.properties.get("intensity"),q=Math.max(o.a6.vec3.dot([0,0,1],E),0),H=[0,0,0];o.a6.vec3.scale(H,z.toRenderColor(f.getLut(r.scope)).toArray01Linear().slice(0,3),V);const X=[0,0,0];return o.a6.vec3.scale(X,m.toRenderColor(f.getLut(l.scope)).toArray01Linear().slice(0,3),q*b),o.cc([H[0]>0?H[0]/(H[0]+X[0]):0,H[1]>0?H[1]/(H[1]+X[1]):0,H[2]>0?H[2]/(H[2]+X[2]):0])}function cu(f,r,l,m,b,S){const E=f.zoom,z=f.scale,V=f.worldSize,q=1/V,H=f.aspect,X=Math.sqrt(1+H*H)*Math.tan(.5*f.fovX),ee=X*X,ae=m-l,be=m+l;let ye,Te;ee>ae/be?(ye=m,Te=m*X):(ye=.5*be*(1+ee),Te=.5*Math.sqrt(ae*ae+2*(m*m+l*l)*ee+be*be*ee*ee));const Se=f.projection.pixelsPerMeter(f.center.lat,V),De=f._camera.getCameraToWorldMercator(),je=[0,0,-ye*q];o.a6.vec3.transformMat4(je,je,De);let He=Te*q;const Ye=f._edgeInsets;if(!(Ye.left===0&&Ye.top===0&&Ye.right===0&&Ye.bottom===0||Ye.left===Ye.right&&Ye.top===Ye.bottom)){const mn=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?Se:1),wn=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,l,m);wn[8]=2*-f.centerOffset.x/f.width,wn[9]=2*f.centerOffset.y/f.height;const hn=new Float64Array(16);o.a6.mat4.mul(hn,wn,mn);const Vn=new Float64Array(16);o.a6.mat4.invert(Vn,hn);const fo=o.bO.fromInvProjectionMatrix(Vn,V,E,!0);for(const xo of fo.points){const ro=((tt=xo)[0]/=z,tt[1]/=z,tt[2]=o.bE(tt[2],f._center.lat),tt);He=Math.max(He,o.a6.vec3.len(o.a6.vec3.subtract([],je,ro)))}}var tt;He*=b/(b-1);const Xe=Math.acos(r[2]),nt=Math.atan2(-r[0],-r[1]),lt=new Ll;lt.position=je,lt.setPitchBearing(Xe,nt);const vt=lt.getWorldToCamera(V,Se),dt=He*V,ct=Math.min(f._mercatorZfromZoom(17)*V*-2,-2*dt),jt=lt.getCameraToClipOrthographic(-dt,dt,-dt,dt,ct,(dt+S*Se)/r[2]),en=new Float64Array(16);o.a6.mat4.multiply(en,jt,vt);const gn=o.a6.vec3.fromValues(Math.floor(1e6*je[0])/1e6*V,Math.floor(1e6*je[1])/1e6*V,0),An=.5*b,Dn=[0,0,0];o.a6.vec3.transformMat4(Dn,gn,en),o.a6.vec3.scale(Dn,Dn,An);const It=[Math.floor(Dn[0]),Math.floor(Dn[1]),Math.floor(Dn[2])],pn=[0,0,0];o.a6.vec3.sub(pn,Dn,It),o.a6.vec3.scale(pn,pn,-1/An);const Xt=new Float64Array(16);return o.a6.mat4.identity(Xt),o.a6.mat4.translate(Xt,Xt,pn),o.a6.mat4.multiply(en,Xt,en),[en,dt]}class qs extends o.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.numModelsLoading={}}loadModel(r,l){return o.aG(this.requestManager.transformRequest(l,o.R.Model).url).then(m=>{if(!m)return;const b=o.aH(m),S=new o.aI(r,void 0,void 0,b);return S.computeBoundsAndApplyParent(),S}).catch(m=>{if(m&&m.status===404)return null;this.fire(new o.t(new Error(`Could not load model ${r} from ${l}: ${m.message}`)))})}load(r,l){this.models[l]||(this.models[l]={});const m=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+m.length;const b=[];for(const S of m)b.push(this.loadModel(S,r[S]));Promise.allSettled(b).then(S=>{for(let E=0;E<S.length;E++){const{status:z,value:V}=S[E];z==="fulfilled"&&V&&(this.models[l][m[E]]={model:V,numReferences:1})}this.numModelsLoading[l]-=m.length,this.fire(new o.x("data",{dataType:"style"}))}).catch(S=>{this.fire(new o.t(new Error(`Could not load models: ${S.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,m){this.models[m]||(this.models[m]={}),this.hasModel(r,m)&&this.models[m][r].numReferences++,this.load({[r]:this.requestManager.normalizeModelURL(l)},m)}addModels(r,l){this.models[l]||(this.models[l]={});const m={};for(const b in r)this.models[l][b]={},m[b]=this.requestManager.normalizeModelURL(r[b]);this.load(m,l)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={});const m={};for(const b of r)this.hasModel(b,l)?this.models[l][b].numReferences++:m[b]=this.requestManager.normalizeModelURL(b);this.load(m,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const m=this.models[l][r].model;delete this.models[l][r],m.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const m in this.models[l])this.models[l][m].model&&this.models[l][m].model.upload(r.context)}}const Sd=new o.a0({data:new o.a1(o._.colorTheme.data)}),ka=(f,r)=>xt(f,r&&r.filter(l=>l.identifier!=="source.canvas")),Dl=o.ar(zn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),wc=o.ar(zn,["setCenter","setZoom","setBearing","setPitch"]),np={version:8,layers:[],sources:{}},an={duration:300,delay:0};class Tn extends o.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=o.l({},an),this._buildingIndex=new on(this),this.crossTileSymbolIndex=new bd,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._mergedLayerSelectors=new Map,this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new Ke,this.dispatcher=l.dispatcher?l.dispatcher:new o.ce(o.cf(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Ht,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new o.cg(r._requestManager,l.localFontFamily?o.ch.all:l.localIdeographFontFamily?o.ch.ideographs:o.ch.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new qs(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",o.ci());const m=this;this._rtlTextPluginCallback=Tn.registerForPluginStateChange(b=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(S,E)=>{if(o.cj(S),E&&E.every(z=>z))for(const z in m._sourceCaches){const V=m._sourceCaches[z],q=V.getSource().type;q!=="vector"&&q!=="geojson"||V.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const S=this.getOwnSource(b.sourceId);if(S&&S.vectorLayerIds)for(const E in this._layers){const z=this._layers[E];z.source===S.id&&this._validateLayer(z)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(o.f(r))return r;const l=o.ck(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${o.cl(JSON.stringify(r))}`}_diffStyle(r,l,m){this.globalId=this._getGlobalId(r);const b=(S,E)=>{try{E(null,this.setState(S,m))}catch(z){E(z,!1)}};if(typeof r=="string"){const S=this.map._requestManager.normalizeStyleURL(r),E=this.map._requestManager.transformRequest(S,o.R.Style);o.n(E,(z,V)=>{z?this.fire(new o.t(z)):V&&b(V,l)})}else typeof r=="object"&&b(r,l)}loadURL(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"}));const m=typeof l.validate=="boolean"?l.validate:!o.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const b=this.importsCache.get(r);if(b)return this._load(b,m);const S=this.map._requestManager.transformRequest(r,o.R.Style);this._request=o.n(S,(E,z)=>{if(this._request=null,E)this.fire(new o.t(E));else if(z)return this.importsCache.set(r,z),this._load(z,m)})}loadJSON(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=o.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new o.x("dataloading",{dataType:"style"})),this._load(np,!1)}_loadImports(r,l,m){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const b=[];for(const S of r){const E=this._createFragmentStyle(S),z=new Promise(H=>{E.once("style.import.load",H),E.once("error",H)}).then(()=>this.mergeAll());if(b.push(z),this.resolvedImports.has(S.url)){E.loadEmpty();continue}const V=S.data||this.importsCache.get(S.url);V?(E.loadJSON(V,{validate:l}),this._isInternalStyle(V)&&(E.globalId=null)):S.url?E.loadURL(S.url,{validate:l}):E.loadEmpty();const q={style:E,id:S.id,config:S.config};if(m){const H=this.fragments.findIndex(({id:X})=>X===m);this.fragments=this.fragments.slice(0,H).concat(q).concat(this.fragments.slice(H))}else this.fragments.push(q)}return Promise.allSettled(b)}getImportGlobalIds(r=this,l=new Set){for(const m of r.fragments)m.style.globalId&&l.add(m.style.globalId),this.getImportGlobalIds(m.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?o.av(r.id,this.scope):r.id;let m;const b=this._initialConfig&&this._initialConfig[l];(r.config||b)&&(m=o.l({},r.config,b));const S=new Tn(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,configDependentLayers:this._configDependentLayers});return S.setEventedParent(this.map,{style:S}),S}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const m=r.schema;if(this._isInternalStyle(r)){const E=o.l({},np,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(E,l)}if(this.updateConfig(this._config,m),l&&ka(this,hi(r)))return;this._loaded=!0,this.stylesheet=o.cm(r);const b=()=>{for(const q in r.sources)this.addSource(q,r.sources[q],{validate:!1,isInitialLoad:!0});r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const E=so(this.stylesheet.layers);if(this._order=E.map(q=>q.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const q=this.stylesheet.lights[0];this.light=new kt(q.properties,q.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new kt(this.stylesheet.light)),this._layers={};for(const q of E){const H=o.cq(q,this.scope,this._styleColorTheme.lut,this.options);H.configDependencies.size!==0&&this._configDependentLayers.add(H.fqid),H.setEventedParent(this,{layer:{id:H.id}}),this._layers[H.id]=H;const X=this.getOwnLayerSourceCache(H),ee=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&H.canCastShadows()&&ee&&(X.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const z=this.stylesheet.terrain;z&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(z,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.x("data",{dataType:"style"}));const V=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.x(V?"style.load":"style.import.load")))},S=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=S,S){const E=this._evaluateColorThemeData(S);this._loadColorTheme(E).then(()=>{b()}).catch(z=>{o.w(`Couldn't load color theme from the stylesheet: ${z}`),b()})}else this._styleColorTheme.lut=null,b()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,m,b,S,E,z,V;const q={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(H=>{if(H.stylesheet){if(H.light!=null&&(r=H.light),H.stylesheet.lights)for(const X of H.stylesheet.lights)X.type==="ambient"&&H.ambientLight!=null&&(l=H.ambientLight),X.type==="directional"&&H.directionalLight!=null&&(m=H.directionalLight);b=this._prioritizeTerrain(b,H.terrain,H.stylesheet.terrain),H.stylesheet.fog&&H.fog!=null&&(S=H.fog),H.stylesheet.camera!=null&&(V=H.stylesheet.camera),H.stylesheet.projection!=null&&(E=H.stylesheet.projection),H.stylesheet.transition!=null&&(z=H.stylesheet.transition),q[H.scope]=H._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=m,this.fog=S,this._styleColorThemeForScope=q,b===null?delete this.terrain:this.terrain=b,this.camera=V||{"camera-projection":"perspective"},this.projection=E||{name:"mercator"},this.transition=o.l({},an,z),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=m=>{for(const b of m.fragments)l(b.style);r(m)};l(this)}_prioritizeTerrain(r,l,m){const b=r&&r.drapeRenderMode===0;return m===null?l&&l.drapeRenderMode===0?l:b?r:null:l!=null&&(!r||b||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},m={};this.forEachFragmentStyle(b=>{for(const S in b._sourceCaches){const E=o.av(S,b.scope);r[E]=b._sourceCaches[S]}for(const S in b._otherSourceCaches){const E=o.av(S,b.scope);l[E]=b._otherSourceCaches[S]}for(const S in b._symbolSourceCaches){const E=o.av(S,b.scope);m[E]=b._symbolSourceCaches[S]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=m}mergeLayers(){const r={},l=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._mergedLayerSelectors.clear(),this.forEachFragmentStyle(S=>{for(const z of S._order){const V=S._layers[z];if(V.type==="slot"){const q=o.cn(z);if(r[q])continue;r[q]=[]}V.slot&&r[V.slot]?r[V.slot].push(V):l.push(V)}const{featuresets:E}=S.stylesheet||{};if(E)for(const z in E){const{selectors:V}=E[z];for(const q of V){const H=S._layers[q.layer],X=this._mergedLayerSelectors.get(H.fqid)||[];let ee;if(q.properties)for(const ae in q.properties){const be=o.M(q.properties[ae]);be.result==="success"&&(ee=ee||{},ee[ae]=be.value)}X.push({featuresetId:z,featureNamespace:q.featureNamespace,properties:ee}),this._mergedLayerSelectors.set(H.fqid,X)}}}),this._mergedOrder=[];const b=(S=[])=>{for(const E of S)if(E.type==="slot"){const z=o.cn(E.id);r[z]&&b(r[z]),this._mergedSlots.push(z)}else{const z=o.av(E.id,E.scope);this._mergedOrder.push(z),m[z]=E,E.is3D()&&(this._has3DLayers=!0),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};b(l),this._mergedOrder.sort((S,E)=>{const z=m[S],V=m[E];return z.hasInitialOcclusionOpacityProperties?V.is3D()?1:0:z.is3D()&&V.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=o.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,m,b){const S=o.l({},m);for(const z of Object.keys(o._.colorTheme))S[z]===void 0&&(S[z]=o._.colorTheme[z].default);const E=new o.$(Sd,l,new Map(b));return E.setTransitionOrValue(S,b),E.untransitioned().possiblyEvaluate(new o.a3(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,b)=>{const S="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let E=r;E.startsWith(S)||(E=S+E);const z="mapbox-reserved-lut",V=new Image;V.src=E,V.onerror=()=>{this._styleColorTheme.lutLoading=!1,b(new Error("Failed to load image data"))},V.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void m();this._styleColorTheme.lutLoading=!1;const{width:q,height:H,data:X}=o.q.getImageData(V);if(H>32)return void b(new Error("The height of the image must be less than or equal to 32 pixels."));if(q!==H*H)return void b(new Error("The width of the image must be equal to the height squared."));this.getImage(z)&&this.removeImage(z),this.addImage(z,{data:new o.r({width:q,height:H},X),pixelRatio:1,sdf:!1,version:0});const ee=this.imageManager.getImage(z,this.scope);ee?(this._styleColorTheme.lut={image:ee.data,data:r},m()):b(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,m,b){let S,E,z;const V=o.q.devicePixelRatio>1?"@2x":"";let q=o.n(m.transformRequest(m.normalizeSpriteURL(l,V,".json"),o.R.SpriteJSON),(ee,ae)=>{q=null,z||(z=ee,S=ae,X())}),H=o.o(m.transformRequest(m.normalizeSpriteURL(l,V,".png"),o.R.SpriteImage),(ee,ae)=>{H=null,z||(z=ee,E=ae,X())});function X(){if(z)b(z);else if(S&&E){const ee=o.q.getImageData(E),ae={};for(const be in S){const{width:ye,height:Te,x:Se,y:De,sdf:je,pixelRatio:He,stretchX:Ye,stretchY:tt,content:Xe}=S[be],nt=new o.r({width:ye,height:Te});o.r.copy(ee,nt,{x:Se,y:De},{x:0,y:0},{width:ye,height:Te},null),ae[be]={data:nt,pixelRatio:He,sdf:je,stretchX:Ye,stretchY:tt,content:Xe}}b(null,ae)}}return{cancel(){q&&(q.cancel(),q=null),H&&(H.cancel(),H=null)}}}(r,this.map._requestManager,(l,m)=>{if(this._spriteRequest=null,l)this.fire(new o.t(l));else if(m)for(const b in m)this.imageManager.addImage(b,this.scope,m[b]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.x("data",{dataType:"style"}))})}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const m=r.sourceLayer;m&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.t(new Error(`Source layer "${m}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const m=this.fragments[l];return m&&m.style&&(r.data=m.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const m=this._sourceCaches[l].getSource();r[m.id]||(r[m.id]=m.serialize())}return r}_serializeLayers(r){const l=[];for(const m of r){const b=this._layers[m];b&&b.type!=="custom"&&l.push(b.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new o.t(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new o.t(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const m=this.map.painter;if(m)for(let b=r.minzoom||0;b<(r.maxzoom||25.5);b++){const S=r.getProgramIds();if(S)for(const E of S){const z=r.getDefaultProgramParams(E,l.zoom,this._styleColorTheme.lut);z&&(m.style=this,this.fog&&(m._fogVisible=!0,z.overrideFog=!0,m.getOrCreateProgram(E,z)),m._fogVisible=!1,z.overrideFog=!1,m.getOrCreateProgram(E,z),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(z.overrideRtt=!0,m.getOrCreateProgram(E,z)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const m=this._changes.isDirty();let b=!1;if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const z in E){const{updatedIds:V,removedIds:q}=E[z];(V||q)&&(this._updateWorkerLayers(z,V,q),b=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._changes.reset()}const S={};for(const E in this._mergedSourceCaches){const z=this._mergedSourceCaches[E];S[E]=z.used,z.used=!1,z.tileCoverLift=0}for(const E of this._mergedOrder){const z=this._mergedLayers[E];if(z.recalculate(r,this._availableImages),!z.isHidden(r.zoom)){const V=this.getLayerSourceCache(z);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,z.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(z,r)}):this.precompilePrograms(z,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&b&&this.mergeLayers();for(const E in S){const z=this._mergedSourceCaches[E];S[E]!==z.used&&z.getSource().fire(new o.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:z.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new o.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,m){const b=this.getFragmentStyle(r);b&&this.dispatcher.broadcast("updateLayers",{layers:l?b._serializeLayers(l):[],scope:r,removedIds:m||[],options:b.options})}setState(r,l){if(this._checkLoaded(),ka(this,hi(r)))return!1;(r=o.cm(r)).layers=so(r.layers);const m=function(E,z){if(!E)return[{command:zn.setStyle,args:[z]}];let V=[];try{if(!o.bi(E.version,z.version))return[{command:zn.setStyle,args:[z]}];if(o.bi(E.center,z.center)||V.push({command:zn.setCenter,args:[z.center]}),o.bi(E.zoom,z.zoom)||V.push({command:zn.setZoom,args:[z.zoom]}),o.bi(E.bearing,z.bearing)||V.push({command:zn.setBearing,args:[z.bearing]}),o.bi(E.pitch,z.pitch)||V.push({command:zn.setPitch,args:[z.pitch]}),o.bi(E.sprite,z.sprite)||V.push({command:zn.setSprite,args:[z.sprite]}),o.bi(E.glyphs,z.glyphs)||V.push({command:zn.setGlyphs,args:[z.glyphs]}),o.bi(E.imports,z.imports)||function(ae=[],be=[],ye){be=be||[];const Te=(ae=ae||[]).map(Ti),Se=be.map(Ti),De=ae.reduce($n,{}),je=be.reduce($n,{}),He=Te.slice();let Ye,tt,Xe,nt;for(Ye=0,tt=0;Ye<Te.length;Ye++)Xe=Te[Ye],je.hasOwnProperty(Xe)?tt++:(ye.push({command:zn.removeImport,args:[Xe]}),He.splice(He.indexOf(Xe,tt),1));for(Ye=0,tt=0;Ye<Se.length;Ye++)Xe=Se[Se.length-1-Ye],He[He.length-1-Ye]!==Xe&&(De.hasOwnProperty(Xe)?(ye.push({command:zn.removeImport,args:[Xe]}),He.splice(He.lastIndexOf(Xe,He.length-tt),1)):tt++,nt=He[He.length-Ye],ye.push({command:zn.addImport,args:[je[Xe],nt]}),He.splice(He.length-Ye,0,Xe));for(const lt of be){const vt=De[lt.id];vt&&!o.bi(vt,lt)&&ye.push({command:zn.updateImport,args:[lt.id,lt]})}}(E.imports,z.imports,V),o.bi(E.transition,z.transition)||V.push({command:zn.setTransition,args:[z.transition]}),o.bi(E.light,z.light)||V.push({command:zn.setLight,args:[z.light]}),o.bi(E.fog,z.fog)||V.push({command:zn.setFog,args:[z.fog]}),o.bi(E.projection,z.projection)||V.push({command:zn.setProjection,args:[z.projection]}),o.bi(E.lights,z.lights)||V.push({command:zn.setLights,args:[z.lights]}),o.bi(E.camera,z.camera)||V.push({command:zn.setCamera,args:[z.camera]}),!o.bi(E["color-theme"],z["color-theme"]))return[{command:zn.setStyle,args:[z]}];const q={},H=[];(function(ae,be,ye,Te){let Se;for(Se in be=be||{},ae=ae||{})ae.hasOwnProperty(Se)&&(be.hasOwnProperty(Se)||On(Se,ye,Te));for(Se in be){if(!be.hasOwnProperty(Se))continue;const De=be[Se];ae.hasOwnProperty(Se)?o.bi(ae[Se],De)||(ae[Se].type==="geojson"&&De.type==="geojson"&&uo(ae,be,Se)?ye.push({command:zn.setGeoJSONSourceData,args:[Se,De.data]}):dr(Se,be,ye,Te)):yo(Se,be,ye)}})(E.sources,z.sources,H,q);const X=[];E.layers&&E.layers.forEach(ae=>{ae.source&&q[ae.source]?V.push({command:zn.removeLayer,args:[ae.id]}):X.push(ae)});let ee=E.terrain;ee&&q[ee.source]&&(V.push({command:zn.setTerrain,args:[void 0]}),ee=void 0),V=V.concat(H),o.bi(ee,z.terrain)||V.push({command:zn.setTerrain,args:[z.terrain]}),function(ae,be,ye){be=be||[];const Te=(ae=ae||[]).map(Ti),Se=be.map(Ti),De=ae.reduce($n,{}),je=be.reduce($n,{}),He=Te.slice(),Ye=Object.create(null);let tt,Xe,nt,lt,vt,dt,ct;for(tt=0,Xe=0;tt<Te.length;tt++)nt=Te[tt],je.hasOwnProperty(nt)?Xe++:(ye.push({command:zn.removeLayer,args:[nt]}),He.splice(He.indexOf(nt,Xe),1));for(tt=0,Xe=0;tt<Se.length;tt++)nt=Se[Se.length-1-tt],He[He.length-1-tt]!==nt&&(De.hasOwnProperty(nt)?(ye.push({command:zn.removeLayer,args:[nt]}),He.splice(He.lastIndexOf(nt,He.length-Xe),1)):Xe++,dt=He[He.length-tt],ye.push({command:zn.addLayer,args:[je[nt],dt]}),He.splice(He.length-tt,0,nt),Ye[nt]=!0);for(tt=0;tt<Se.length;tt++)if(nt=Se[tt],lt=De[nt],vt=je[nt],!Ye[nt]&&!o.bi(lt,vt))if(o.bi(lt.source,vt.source)&&o.bi(lt["source-layer"],vt["source-layer"])&&o.bi(lt.type,vt.type)){for(ct in hr(lt.layout,vt.layout,ye,nt,null,zn.setLayoutProperty),hr(lt.paint,vt.paint,ye,nt,null,zn.setPaintProperty),o.bi(lt.slot,vt.slot)||ye.push({command:zn.setSlot,args:[nt,vt.slot]}),o.bi(lt.filter,vt.filter)||ye.push({command:zn.setFilter,args:[nt,vt.filter]}),o.bi(lt.minzoom,vt.minzoom)&&o.bi(lt.maxzoom,vt.maxzoom)||ye.push({command:zn.setLayerZoomRange,args:[nt,vt.minzoom,vt.maxzoom]}),lt)lt.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?hr(lt[ct],vt[ct],ye,nt,ct.slice(6),zn.setPaintProperty):o.bi(lt[ct],vt[ct])||ye.push({command:zn.setLayerProperty,args:[nt,ct,vt[ct]]}));for(ct in vt)vt.hasOwnProperty(ct)&&!lt.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&ct!=="slot"&&(ct.indexOf("paint.")===0?hr(lt[ct],vt[ct],ye,nt,ct.slice(6),zn.setPaintProperty):o.bi(lt[ct],vt[ct])||ye.push({command:zn.setLayerProperty,args:[nt,ct,vt[ct]]}))}else ye.push({command:zn.removeLayer,args:[nt]}),dt=He[He.lastIndexOf(nt)+1],ye.push({command:zn.addLayer,args:[vt,dt]})}(X,z.layers,V)}catch(q){console.warn("Unable to compute style diff:",q),V=[{command:zn.setStyle,args:[z]}]}return V}(this.serialize(),r).filter(E=>!(E.command in wc));if(m.length===0)return!1;const b=m.filter(E=>!(E.command in Dl));if(b.length>0)throw new Error(`Unimplemented: ${b.map(E=>E.command).join(", ")}.`);const S=[];return m.forEach(E=>{S.push(this[E.command].apply(this,E.args))}),l&&Promise.all(S).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new o.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l){this.imageManager.updateImage(r,this.scope,l)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new o.t(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new o.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,m={}){return this._checkLoaded(),this._validate(mt,`models.${r}`,l,null,m)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new o.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,m={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Er,`sources.${r}`,l,null,m))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const b=za(r,l,this.dispatcher,this);b.scope=this.scope,b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(b.id),source:b.serialize(),sourceId:b.id}));const S=E=>{const z=(E?"symbol:":"other:")+b.id,V=o.av(z,this.scope),q=this._sourceCaches[z]=new Ue(V,b,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[b.id]=q,q.onAdd(this.map)};S(!1),l.type!=="vector"&&l.type!=="geojson"||S(!0),b.onAdd&&b.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const m=this.getOwnSourceCaches(r);for(const b of m){const S=o.cn(b.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(b.id),b.fire(new o.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const m=this.getOwnSourceCache(l);m&&r.push(m.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const m=r[l]._tiles;for(const b in m){const S=m[b];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const b of r){if(this._validate(Xo,"lights",b))return;switch(b.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(b),S.updateTransitions(l)}else this.ambientLight=new Eo(b,cr||(cr=new o.a0({color:new o.a1(o._.properties_light_ambient.color),intensity:new o.a1(o._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(b),S.updateTransitions(l)}else this.directionalLight=new Eo(b,rr||(rr=new o.a0({direction:new o.ad(o._.properties_light_directional.direction),color:new o.a1(o._.properties_light_directional.color),intensity:new o.a1(o._.properties_light_directional.intensity),"cast-shadows":new o.a1(o._.properties_light_directional["cast-shadows"]),"shadow-intensity":new o.a1(o._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=new o.a3(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(m),this.directionalLight&&this.directionalLight.recalculate(m),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const m=ee=>.2126*(ee[0]<=.03928?ee[0]/12.92:Math.pow((ee[0]+.055)/1.055,2.4))+.7152*(ee[1]<=.03928?ee[1]/12.92:Math.pow((ee[1]+.055)/1.055,2.4))+.0722*(ee[2]<=.03928?ee[2]/12.92:Math.pow((ee[2]+.055)/1.055,2.4)),b=r.properties.get("color").toRenderColor(null).toArray01(),S=r.properties.get("intensity"),E=r.properties.get("direction"),z=1-o.c8(E.x,E.y,E.z)[2]/90,V=m(b)*S*z,q=l.properties.get("color").toRenderColor(null).toArray01(),H=l.properties.get("intensity"),X=m(q)*H;return Number(((V+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(o.aK(r)){const l=o.co(r),m=this.fragments.find(({id:S})=>S===l);if(!m)throw new Error(`Style import '${r}' not found`);const b=o.cn(r);return m.style.getFragmentStyle(b)}{const l=this.fragments.find(({id:m})=>m===r);if(!l)throw new Error(`Style import '${r}' not found`);return l.style}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const m=[];for(const b in l.stylesheet.featuresets)m.push({featuresetId:b,importId:l.scope?l.scope:void 0});return m}getFeaturesetLayers(r,l){const m=this.getFragmentStyle(l),b=m.stylesheet.featuresets;if(!b||!b[r])return this.fire(new o.t(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const S=[];for(const E of b[r].selectors){const z=m.getOwnLayer(E.layer);z&&S.push(z)}return S}getConfigProperty(r,l){const m=this.getFragmentStyle(r);if(!m)return null;const b=o.av(l,m.scope),S=m.options.get(b),E=S?S.value||S.default:null;return E?E.serialize():null}setConfigProperty(r,l,m){const b=this.getFragmentStyle(r);if(!b)return;const S=b.stylesheet.schema;if(!S||!S[l])return;const E=o.M(m);if(E.result!=="success")return void ka(this,E.value);const z=E.value.expression,V=o.av(l,b.scope),q=b.options.get(V);if(!q)return;let H;const{minValue:X,maxValue:ee,stepValue:ae,type:be,values:ye}=S[l],Te=o.M(S[l].default);Te.result==="success"&&(H=Te.value.expression),H?(this.options.set(V,{...q,value:z,default:H,minValue:X,maxValue:ee,stepValue:ae,type:be,values:ye}),this.updateConfigDependencies(l)):this.fire(new o.t(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const m=l.stylesheet.schema;if(!m)return null;const b={};for(const S in m){const E=o.av(S,l.scope),z=l.options.get(E),V=z?z.value||z.default:null;b[S]=V?V.serialize():null}return b}setConfig(r,l){const m=this.getFragmentStyle(r);m&&(m.updateConfig(l,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const m=this.getFragmentStyle(r);m&&(m.stylesheet.schema=l,m.updateConfig(m._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const m in l){let b,S;const E=o.M(l[m].default);if(E.result==="success"&&(b=E.value.expression),r&&r[m]!==void 0){const ee=o.M(r[m]);ee.result==="success"&&(S=ee.value.expression)}const{minValue:z,maxValue:V,stepValue:q,type:H,values:X}=l[m];if(b){const ee=o.av(m,this.scope);this.options.set(ee,{default:b,value:S,minValue:z,maxValue:V,stepValue:q,type:H,values:X})}else this.fire(new o.t(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new o.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const m=this.getLayer(l);if(m){if(r&&!m.configDependencies.has(r))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const m=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut&&m!==""||l._styleColorTheme.lut&&m!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(r,l,m={}){this._checkLoaded();const b=r.id;if(this._layers[b])return void this.fire(new o.t(new Error(`Layer with id "${b}" already exists on this map`)));let S;if(r.type==="custom"){if(ka(this,o.cp(r)))return;S=o.cq(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(b,r.source),r=o.cm(r),r=o.l(r,{source:b})),this._validate(Zt,`layers.${b}`,r,{arrayIndex:-1},m))return;S=o.cq(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:b}})}S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid);let E=this._order.length;if(l){const H=this._order.indexOf(l);if(H===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));S.slot===this._layers[l].slot?E=H:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,b),this._layerOrderChanged=!0,this._layers[b]=S;const z=this.getOwnLayerSourceCache(S),V=!!this.directionalLight&&this.directionalLight.shadowsEnabled();z&&S.canCastShadows()&&V&&(z.castsShadows=!0);const q=this._changes.getRemovedLayer(S);if(q&&S.source&&z&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const H=o.av(S.source,S.scope);q.type!==S.type?this._changes.updateSourceCache(H,"clear"):(this._changes.updateSourceCache(H,"reload"),z.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const m=this._checkLayer(r);if(!m||r===l)return;const b=this._order.indexOf(r);this._order.splice(b,1);let S=this._order.length;if(l){const E=this._order.indexOf(l);if(E===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));m.slot===this._layers[l].slot?S=E:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const m=this._order.indexOf(r);this._order.splice(m,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const b=this.getOwnLayerSourceCache(l);if(b&&b.castsShadows){let S=!1;for(const E in this._layers)if(this._layers[E].source===l.source&&this._layers[E].canCastShadows()){S=!0;break}b.castsShadows=S}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,m){this._checkLoaded();const b=this._checkLayer(r);b&&(b.minzoom===l&&b.maxzoom===m||(l!=null&&(b.minzoom=l),m!=null&&(b.maxzoom=m),this._updateLayer(b)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const m=this._checkLayer(r);m&&m.slot!==l&&(m.slot=l,this._updateLayer(m))}setFilter(r,l,m={}){this._checkLoaded();const b=this._checkLayer(r);if(b&&!o.bi(b.filter,l))return l==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(Ee,`layers.${b.id}.filter`,l,{layerType:b.type},m)||(b.filter=o.cm(l),this._updateLayer(b)))}getFilter(r){const l=this._checkLayer(r);if(l)return o.cm(l.filter)}setLayoutProperty(r,l,m,b={}){this._checkLoaded();const S=this._checkLayer(r);if(S&&!o.bi(S.getLayoutProperty(l),m)){if(m!=null&&(!b||b.validate!==!1)&&ka(S,qe.call(hi,{key:`layers.${r}.layout.${l}`,layerType:S.type,objectKey:l,value:m,styleSpec:o._,style:{glyphs:!0,sprite:!0}})))return;S.setLayoutProperty(l,m),S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),this._updateLayer(S)}}getLayoutProperty(r,l){const m=this._checkLayer(r);if(m)return m.getLayoutProperty(l)}setPaintProperty(r,l,m,b={}){this._checkLoaded();const S=this._checkLayer(r);if(!S||o.bi(S.getPaintProperty(l),m)||m!=null&&(!b||b.validate!==!1)&&ka(S,ke.call(hi,{key:`layers.${r}.paint.${l}`,layerType:S.type,objectKey:l,value:m,styleSpec:o._})))return;const E=S.setPaintProperty(l,m);S.configDependencies.size!==0&&this._configDependentLayers.add(S.fqid),E&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(r,l){const m=this._checkLayer(r);if(m)return m.getPaintProperty(l)}setFeatureState(r,l){this._checkLoaded();const m=r.featureset;if(m){if("featuresetId"in m){const q=this.getFragmentStyle(m.importId),H=q.getFeaturesetLayers(m.featuresetId);for(const{source:X,sourceLayer:ee}of H)q.setFeatureState({id:r.id,source:X,sourceLayer:ee},l)}else if("layerId"in m){const q=this.getLayer(m.layerId);this.setFeatureState({id:r.id,source:q.source,sourceLayer:q.sourceLayer},l)}return}const b=r.source,S=r.sourceLayer,E=this._checkSource(b);if(!E)return;const z=E.type;if(z==="geojson"&&S)return void this.fire(new o.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(z==="vector"&&!S)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided.")));const V=this.getOwnSourceCaches(b);for(const q of V)q.setFeatureState(S,r.id,l)}removeFeatureState(r,l){this._checkLoaded();const m=r.featureset;if(m){if("featuresetId"in m){const q=this.getFragmentStyle(m.importId),H=q.getFeaturesetLayers(m.featuresetId);for(const{source:X,sourceLayer:ee}of H)q.removeFeatureState({id:r.id,source:X,sourceLayer:ee},l)}else if("layerId"in m){const q=this.getLayer(m.layerId);this.removeFeatureState({id:r.id,source:q.source,sourceLayer:q.sourceLayer},l)}return}const b=r.source,S=this._checkSource(b);if(!S)return;const E=S.type,z=E==="vector"?r.sourceLayer:void 0;if(E==="vector"&&!z)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.t(new Error("A feature id is required to remove its specific state property.")));const V=this.getOwnSourceCaches(b);for(const q of V)q.removeFeatureState(z,r.id,l)}getFeatureState(r){this._checkLoaded();const l=r.featureset;if(l){let E;if("featuresetId"in l){const z=this.getFragmentStyle(l.importId),V=z.getFeaturesetLayers(l.featuresetId);for(const{source:q,sourceLayer:H}of V){const X=z.getFeatureState({id:r.id,source:q,sourceLayer:H});if(X&&!E)E=X;else if(!o.bi(E,X))return void this.fire(new o.t(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r){const z=this.getLayer(l.layerId);E=this.getFeatureState({id:r.id,source:z.source,sourceLayer:z.sourceLayer})}return E}const m=r.source,b=r.sourceLayer,S=this._checkSource(m);if(S){if(S.type!=="vector"||b)return r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(m)[0].getFeatureState(b,r.id);this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=o.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return o.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return o.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),m=o.av(r.source,r.scope),b=this._changes.getUpdatedSourceCaches();r.source&&!b[m]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=z=>this._mergedLayers[z].is3D(),m=this.order,b={},S=[];for(let z=m.length-1;z>=0;z--){const V=m[z];if(l(V)){b[V]=z;for(const q of r){const H=q[V];if(H)for(const X of H)S.push(X)}}}S.sort((z,V)=>V.intersectionZ-z.intersectionZ);const E=[];for(let z=m.length-1;z>=0;z--){const V=m[z];if(l(V))for(let q=S.length-1;q>=0;q--){const H=S[q].feature;if(H.layer&&b[H.layer.id]<z)break;E.push(H),S.pop()}else for(const q of r){const H=q[V];if(H)for(const X of H)E.push(X.feature)}}return E}queryRenderedFeatures(r,l,m){l&&!Array.isArray(l)&&l.filter&&this._validate(Ee,"queryRenderedFeatures.filter",l.filter,null,l);let b,S=!1;const E=new Set;if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.t(new Error("parameters.layers must be an Array."))),[];b=[];for(const H of l.layers){const X=this._mergedLayers[H];if(!X)return this.fire(new o.t(new Error(`The layer '${H}' does not exist in the map's style and cannot be queried for features.`))),[];X.is3D()&&(S=!0),E.add(X.source),b.push(H)}}else S=this.has3DLayers();const z=this._queryRenderedFeatures(r,m,{layerIds:b,filter:l.filter,has3DLayers:S,includedSources:E}),V=this._flattenAndSortRenderedFeatures(z),q=[];for(const H of V)o.co(H.layer.id)===this.scope&&q.push(H);return q}queryRenderedFeaturesForInteractions(r,l,m){let b=[];for(const{featureset:V,filter:q,radius:H}of l){let X=!1;const ee=[],ae=new Set;if("featuresetId"in V){const ye=this.getFeaturesetLayers(V.featuresetId,V.importId);if(ye.length===0)continue;for(const Te of ye)Te.is3D()&&(X=!0),ae.add(Te.source),ee.push(Te.fqid)}else if("layerId"in V){const ye=this._mergedLayers[V.layerId];if(!ye)return this.fire(new o.t(new Error(`The layer '${V.layerId}' does not exist in the map's style and cannot be queried for features.`))),[];ye.is3D()&&(X=!0),ae.add(ye.source),ee.push(V.layerId)}let be=r;if(H)if(r instanceof o.P||typeof r[0]=="number"){const ye=o.P.convert(r);be=[[ye.x-H,ye.y-H],[ye.x+H,ye.y+H]]}else{const ye=o.P.convert(r[0]),Te=o.P.convert(r[1]);be=[[ye.x-H,ye.y-H],[Te.x+H,Te.y+H]]}b=b.concat(this._queryRenderedFeatures(be,m,{layerIds:ee,filter:q,has3DLayers:X,includedSources:ae}))}const S=this._flattenAndSortRenderedFeatures(b),E=(V,q,H)=>{const X=V.clone();if(delete X.layer,X.featureset=q,H&&H.featureNamespace&&(X.namespace=H.featureNamespace),H&&H.properties){const ee={},ae=this.map.transform.zoom;for(const be of Object.keys(H.properties)){const ye=H.properties[be].evaluate({zoom:ae},V._vectorTileFeature,V.state,V.tile,this._availableImages);ye!=null&&(ee[be]=ye)}X.properties=ee}return X},z=[];for(const V of S){const q=V.layer.id,H=o.cn(q),X=o.co(q);for(const{featureset:ee}of l){if("layerId"in ee&&ee.layerId!==q)continue;if("layerId"in ee&&ee.layerId===q){const be=E(V,ee);z.push(be);continue}if("featuresetId"in ee&&(ee.importId!==X||!this.getFeaturesetLayers(ee.featuresetId,ee.importId).map(be=>be.id).includes(H)))continue;const ae=this._mergedLayerSelectors.get(q)||[];for(const be of ae){const ye=E(V,ee,be);z.push(ye)}}}return z}_queryRenderedFeatures(r,l,m){const{layerIds:b,filter:S,has3DLayers:E,includedSources:z}=m,V=[],q=qo.createFromScreenPoints(r,l);for(const H in this._mergedSourceCaches){if(!this._mergedSourceCaches[H].getSource())continue;const X=this._mergedSourceCaches[H].getSource().id;b&&!z.has(X)||V.push(sl(this._mergedSourceCaches[H],this._mergedLayers,q,S,b||[],this._availableImages,l,E,!!this.map._showQueryGeometry))}return this.placement&&V.push(function(H,X,ee,ae,be,ye,Te,Se){const De={},je=Te.queryRenderedSymbols(ee),He=[];for(const Ye of Object.keys(je).map(Number))He.push(Se[Ye]);He.sort(cc);for(const Ye of He){const tt=Ye.featureIndex.lookupSymbolFeatures(je[Ye.bucketInstanceId],Ye.bucketIndex,Ye.sourceLayerIndex,ae,be,ye,H);for(const Xe in tt){const nt=De[Xe]=De[Xe]||[],lt=tt[Xe];lt.sort((vt,dt)=>{const ct=Ye.featureSortOrder;if(ct){const jt=ct.indexOf(vt.featureIndex);return ct.indexOf(dt.featureIndex)-jt}return dt.featureIndex-vt.featureIndex});for(const vt of lt)nt.push(vt)}}for(const Ye in De)De[Ye].forEach(tt=>{const Xe=tt.feature,nt=H[Ye],lt=X(nt);if(!lt)return;const vt=lt.getFeatureState(Xe.layer["source-layer"],Xe.id);Xe.state=vt,o.aK(nt.id)||(Xe.source=Xe.layer.source,Xe.layer["source-layer"]&&(Xe.sourceLayer=Xe.layer["source-layer"]))});return De}(this._mergedLayers,this.getLayerSourceCache.bind(this),q.screenGeometry,S,b||[],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData)),V}querySourceFeatures(r,l){const m=l&&l.filter;m&&this._validate(Ee,"querySourceFeatures.filter",m,null,l);let b=[];const S=this.getOwnSourceCaches(r);for(const E of S)b=b.concat(ll(E,l));return b}addSourceType(r,l,m){return Tn.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(Tn.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,m={}){this._checkLoaded();const b=this.light.getLight();let S=!1;for(const z in r)if(!o.bi(r[z],b[z])){S=!0;break}if(!S)return;const E=this._getTransitionParameters();this.light.setLight(r,l,m),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=r;const b=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const z="terrain-dem-src";this.addSource(z,m.source),m=o.cm(m),m=o.l(m,{source:z})}const S=o.l({},m),E={};if(this.terrain&&b){S.source=this.terrain.get().source;const z=this.terrain?this.getFragmentStyle(this.terrain.scope):null;z&&(E.style=z.serialize())}if(this._validate(Bi,"terrain",S,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!b||this.terrain&&l!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,l),this.fire(new o.x("data",{dataType:"style"}))}else{const S=this.terrain,E=S.get();for(const z of Object.keys(o._.terrain))!m.hasOwnProperty(z)&&o._.terrain[z].default&&(m[z]=o._.terrain[z].default);for(const z in r)if(!o.bi(r[z],E[z])){S.set(r,this.options),this.stylesheet.terrain=r;const V=this._getTransitionParameters({duration:0});S.updateTransitions(V),this.fire(new o.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new Oo(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!o.bi(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createFog(r);this._markersNeedUpdate=!0}setColorTheme(r){this._checkLoaded();const l=()=>{for(const b in this._layers)this._layers[b].lut=this._styleColorTheme.lut;for(const b in this._sourceCaches)this._sourceCaches[b].clearTiles()};if(this._styleColorTheme.colorTheme=r,!r)return this._styleColorTheme.lut=null,void l();const m=this._evaluateColorThemeData(r);this._loadColorTheme(m).then(()=>{this.fire(new o.x("colorthemeset")),l()}).catch(b=>{o.w(`Couldn't set color theme: ${b}`)})}_getTransitionParameters(r){return{now:o.q.now(),transition:o.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?r.push(m):l.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const m=this.terrain=new Wt(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const b=this._getTransitionParameters({duration:0});m.updateTransitions(b)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,m,b,S={}){if(S&&S.validate===!1)return!1;const E=o.l({},this.serialize());return ka(this,r.call(hi,o.l({key:l,style:E,value:m,styleSpec:o._},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const m of l)m.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const m of l)m.resume(),m.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}updateSources(r){let l;this.directionalLight&&(l=wd(this.directionalLight));for(const m in this._mergedSourceCaches)this._mergedSourceCaches[m].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,m,b,S,E,z=!1){let V=!1,q=!1;const H={},X={};for(const ee of this._mergedOrder){const ae=this._mergedLayers[ee];if(ae.type!=="symbol")continue;const be=o.av(ae.source,ae.scope);let ye=H[be];if(!ye){const Se=this.getLayerSourceCache(ae);if(!Se)continue;const De=Se.getRenderableIds(!0).map(je=>Se.getTileByID(je));X[be]=De.slice(),ye=H[be]=De.sort((je,He)=>He.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(He.tileID)?-1:1))}const Te=this.crossTileSymbolIndex.addLayer(ae,ye,l.center.lng,l.projection);V=V||Te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),z=z||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new o.x("neworder")),(z||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.q.now(),l.zoom))&&(this.pauseablePlacement=new pc(l,this._mergedOrder,z,m,b,S,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,H,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.q.now()),q=!0),V&&this.pauseablePlacement.placement.setStale()),q||V){this._buildingIndex.onNewFrame(l.zoom);for(let ee=0;ee<this._mergedOrder.length;ee++){const ae=this._mergedLayers[this._mergedOrder[ee]];if(ae.type!=="symbol")continue;const be=this.isLayerClipped(ae);this.placement.updateLayerOpacities(ae,H[o.av(ae.source,ae.scope)],ee,be?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:S})=>S===r.id)!==-1)return void this.fire(new o.t(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return m.push(r),this._loadImports([r],!0);const b=m.findIndex(({id:S})=>S===l);return b===-1&&this.fire(new o.t(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,b).concat(r).concat(m.slice(b)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],b=this.getImportIndex(r);return b===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==m[b].url&&this.setImportUrl(r,l.url),o.bi(l.config,m[b].config)||this.setImportConfig(r,l.config),o.bi(l.data,m[b].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let m=this.stylesheet.imports||[];const b=this.getImportIndex(r);if(b===-1)return this;const S=this.getImportIndex(l);if(S===-1)return this;const E=m[b],z=this.fragments[b];return m=m.filter(({id:V})=>V!==r),this.fragments=this.fragments.filter(({id:V})=>V!==r),this.stylesheet.imports=m.slice(0,S).concat(E).concat(m.slice(S)),this.fragments=this.fragments.slice(0,S).concat(z).concat(this.fragments.slice(S)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const m=this.stylesheet.imports||[],b=this.getImportIndex(r);if(b===-1)return this;m[b].url=l;const S=this.fragments[b];return S.style=this._createFragmentStyle(m[b]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const m=this.getImportIndex(r),b=this.stylesheet.imports||[];return m===-1?this:l?(this.fragments[m].style.setState(l),this._reloadImports(),this):(delete b[m].data,this.setImportUrl(r,b[m].url))}setImportConfig(r,l){this._checkLoaded();const m=this.getImportIndex(r),b=this.stylesheet.imports||[];if(m===-1)return this;l?b[m].config=l:delete b[m].config;const S=this.fragments[m],E=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=l,S.style.updateConfig(l,E),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],m=this.getImportIndex(r);m!==-1&&(l.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(m=>m.id===r);return l===-1&&this.fire(new o.t(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[l];m&&r.push(m.getSource())}return r}getSource(r,l){const m=this.getSourceCache(r,l);return m&&m.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const m=o.av(r,l);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(r){const l=o.av(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const m=r[l];m==="reload"?this.reloadSource(l):m==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const m of l){const b=this.getLayer(m);b&&b.updateTransitions(r)}}getImages(r,l,m){this.imageManager.getImages(l.icons,l.scope,m),this._updateTilesForChangedImages();const b=S=>{S&&S.setDependencies(l.tileID.key,l.type,l.icons)};b(this._otherSourceCaches[l.source]),b(this._symbolSourceCaches[l.source])}getGlyphs(r,l,m){this.glyphManager.getGlyphs(l.stacks,l.scope,m)}getResource(r,l,m){return o.ct(l,m)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new o.t(new Error(`There is no source with ID '${r}'`))),!1):l.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const m=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(m||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Tn.getSourceType=function(f){return gs[f]},Tn.setSourceType=function(f,r){gs[f]=r},Tn.registerForPluginStateChange=o.cd;var vo=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Jo=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Si=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Lr="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Oi=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Hi=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ts=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Zi=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Gi=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,bs=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Ba=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const oa=[];fl(vo,oa),fl(Si,oa),fl(Jo,oa);const Na={"_prelude_fog.vertex.glsl":Hi,"_prelude_terrain.vertex.glsl":Oi,"_prelude_shadow.vertex.glsl":bs,"_prelude_fog.fragment.glsl":ts,"_prelude_shadow.fragment.glsl":Ba,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Zi,"_prelude_raster_particle.glsl":Gi},xs={};pr("",Oi),pr(ts,Hi),pr(Ba,bs),pr(Zi,""),pr(Gi,"");const zl=pr(Jo,Si),hl=vo;var ns={background:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:pr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:pr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:pr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:pr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:pr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:pr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:pr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:pr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:pr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:pr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:pr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:pr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:pr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:pr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:pr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:pr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Lr),skyboxGradient:pr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Lr),skyboxCapture:pr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:pr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:pr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:pr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:pr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:pr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:pr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),occlusion:pr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function fl(f,r){const l=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of l)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=m.split(" ");for(const S of b)r.includes(S)||r.push(S)}}function pr(f,r){const l=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let b=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);b&&(b=b.map(q=>{const H=q.split(" ");return H[H.length-1]}),b=[...new Set(b)]);const S={},E=[],z=[];if(f=f.replace(l,(q,H)=>(z.push(H),"")),(r=r.replace(l,(q,H)=>(E.push(H),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let V=[...oa];fl(f,V),fl(r,V);for(const q of[...E,...z])Na[q]||console.error(`Undefined include: ${q}`),xs[q]||(xs[q]=[],fl(Na[q],xs[q])),V=[...V,...xs[q]];return{fragmentSource:f=f.replace(m,(q,H,X,ee,ae)=>(S[ae]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
in ${X} ${ee} ${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:H==="initialize"?`
#ifdef HAS_UNIFORM_u_${ae}
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${ee} ${ae};
#endif
`:H==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(m,(q,H,X,ee,ae)=>{const be=ee==="float"?"vec2":ee,ye=ae.match(/color/)?"color":be;return H==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
in ${X} ${ee} a_${ae};
#endif
`:S[ae]?H==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${be} a_${ae};
out ${X} ${ee} ${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:H==="initialize"?ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${ye}(a_${ae}, u_${ae}_t);
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${ee} a_${ae};
    out ${X} ${ee} ${ae};
#endif
`:H==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${ae} = a_${ae};
#endif
`:void 0:H==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${be} a_${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:H==="define-instanced"?ye==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ae}0;
in vec4 a_${ae}1;
in vec4 a_${ae}2;
in vec4 a_${ae}3;
#else
uniform ${X} ${ee} u_${ae};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${be} a_${ae};
#else
uniform ${X} ${ee} u_${ae};
#endif
`:H==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${X} ${ee} ${ae} = a_${ae};
#endif
`:ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${ee} ${ae} = a_${ae};
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${ee} ${ae} = unpack_mix_${ye}(a_${ae}, u_${ae}_t);
#else
    ${X} ${ee} ${ae} = u_${ae};
#endif
`}),staticAttributes:b,usedDefines:V,vertexIncludes:E,fragmentIncludes:z}}class uu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,m,b,S,E,z,V){this.context=r;let q=this.boundPaintVertexBuffers.length!==b.length;for(let X=0;!q&&X<b.length;X++)this.boundPaintVertexBuffers[X]!==b[X]&&(q=!0);let H=this.boundDynamicVertexBuffers.length!==z.length;for(let X=0;!H&&X<z.length;X++)this.boundDynamicVertexBuffers[X]!==z[X]&&(H=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==m||q||H||this.boundIndexBuffer!==S||this.boundVertexOffset!==E)this.freshBind(l,m,b,S,E,z,V);else{r.bindVertexArrayOES.set(this.vao);for(const X of z)X&&(X.bind(),V&&X.instanceCount&&X.setVertexAttribDivisor(r.gl,l,V));S&&S.dynamicDraw&&S.bind()}}freshBind(r,l,m,b,S,E,z){const V=r.numAttributes,q=this.context,H=q.gl;this.vao&&this.destroy(),this.vao=q.gl.createVertexArray(),q.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=b,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=E,l.enableAttributes(H,r),l.bind(),l.setVertexAttribPointers(H,r,S);for(const X of m)X.enableAttributes(H,r),X.bind(),X.setVertexAttribPointers(H,r,S);for(const X of E)X&&(X.enableAttributes(H,r),X.bind(),X.setVertexAttribPointers(H,r,S),z&&X.instanceCount&&X.setVertexAttribDivisor(H,r,z));b&&b.bind(),q.currentNumAttributes=V}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function li(f,r){const l=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new o.a5(0,m/l).toLngLat().lat,new o.a5(0,(m+1)/l).toLngLat().lat]}function ri(f,r,l,m,b,S,E){const z=f.context,V=z.gl,q=l.hillshadeFBO;if(!q)return;f.prepareDrawTile();const H=f.isTileAffectedByFog(r),X=f.getOrCreateProgram("hillshade",{overrideFog:H});z.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,q.colorAttachment.get());const ee=((Te,Se,De,je)=>{const He=De.paint.get("hillshade-shadow-color"),Ye=De.paint.get("hillshade-highlight-color"),tt=De.paint.get("hillshade-accent-color"),Xe=De.paint.get("hillshade-emissive-strength");let nt=o.bC(De.paint.get("hillshade-illumination-direction"));if(De.paint.get("hillshade-illumination-anchor")==="viewport")nt-=Te.transform.angle;else if(Te.style&&Te.style.enable3dLights()&&Te.style.directionalLight){const vt=Te.style.directionalLight.properties.get("direction"),dt=o.c8(vt.x,vt.y,vt.z);nt=o.bC(dt[1])}const lt=!Te.options.moving;return{u_matrix:je||Te.transform.calculateProjMatrix(Se.tileID.toUnwrapped(),lt),u_image:0,u_latrange:li(0,Se.tileID),u_light:[De.paint.get("hillshade-exaggeration"),nt],u_shadow:He.toRenderColor(De.lut),u_highlight:Ye.toRenderColor(De.lut),u_emissive_strength:Xe,u_accent:tt.toRenderColor(De.lut)}})(f,l,m,f.terrain?r.projMatrix:null);f.uploadCommonUniforms(z,X,r.toUnwrapped());const{tileBoundsBuffer:ae,tileBoundsIndexBuffer:be,tileBoundsSegments:ye}=f.getTileBoundsBuffers(l);X.draw(f,V.TRIANGLES,b,S,E,Po.disabled,ee,m.id,ae,be,ye)}function Fl(f,r,l){if(!r.needsDEMTextureUpload)return;const m=f.context,b=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(l.stride);const S=l.getPixels();r.demTexture?r.demTexture.update(S,{premultiply:!1}):r.demTexture=new o.T(m,S,b.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function $a(f,r,l){const m=f.context,b=m.gl;if(!r.dem)return;const S=r.dem;if(m.activeTexture.set(b.TEXTURE1),Fl(f,r,S),!r.demTexture)return;r.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);const E=S.dim;m.activeTexture.set(b.TEXTURE0);let z=r.hillshadeFBO;if(!z){const ee=new o.T(m,{width:E,height:E,data:null},b.RGBA8);ee.bind(b.LINEAR,b.CLAMP_TO_EDGE),z=r.hillshadeFBO=m.createFramebuffer(E,E,!0,"renderbuffer"),z.colorAttachment.set(ee.texture)}m.bindFramebuffer.set(z.framebuffer),m.viewport.set([0,0,E,E]);const{tileBoundsBuffer:V,tileBoundsIndexBuffer:q,tileBoundsSegments:H}=f.getMercatorTileBoundsBuffers(),X=[];f.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(f,b.TRIANGLES,bo.disabled,Do.disabled,ir.unblended,Po.disabled,((ee,ae)=>{const be=ae.stride,ye=o.a6.mat4.create();return o.a6.mat4.ortho(ye,0,o.ab,-o.ab,0,0,1),o.a6.mat4.translate(ye,ye,[0,-o.ab,0]),{u_matrix:ye,u_image:1,u_dimension:[be,be],u_zoom:ee.overscaledZ}})(r.tileID,S),l.id,V,q,H),r.needsHillshadePrepare=!1}class $r{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Pa extends $r{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Ks extends $r{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Zs extends $r{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Bl extends $r{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Nl extends $r{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Sc extends $r{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class $l extends $r{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class $h extends $r{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class pl extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class Td extends $r{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Cd extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class Ed extends $r{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class op extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class du extends $r{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class hu extends $r{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class rg extends $r{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class ig extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class Q_ extends $r{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class ey extends $r{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let z1=class extends $r{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class Vh extends $r{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Uh extends $r{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ty extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class ws extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ag extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class rp extends $r{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class ip extends $r{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class sg extends $r{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class lg extends $r{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class ap extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class cg extends $r{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class jh extends $r{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class sp extends jh{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ug extends jh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ny extends jh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Md extends ug{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const F1=(f,r,l)=>({u_matrix:f,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),oy=(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:l,u_zoom_transition:b,u_merc_center:S,u_image0:0,u_frustum_tl:E,u_frustum_tr:z,u_frustum_br:V,u_frustum_bl:q,u_globe_pos:H,u_globe_radius:X,u_viewport:ee,u_grid_matrix:ye?Float32Array.from(ye):new Float32Array(9),u_skirt_height:ae,u_far_z_cutoff:be});function ry(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const Id=new class{constructor(){this.operations={}}newMorphing(f,r,l,m,b){if(f in this.operations){const S=this.operations[f];S.to.tileID.key!==l.tileID.key&&(S.queued=l)}else this.operations[f]={startTime:m,phase:0,duration:b,from:r,to:l,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const l=this.operations[r];for(l.phase=(f-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},iy={0:null,1:"TERRAIN_VERTEX_MORPHING"};function ay(f,r,l){if(r===0)return 0;const m=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-f)*Math.max(r,1)*m}function dg(f,r){const l=1<<f.z;return!r&&(f.x===0||f.x===l-1)||f.y===0||f.y===l-1}const Hh=f=>({u_matrix:f});function lp(f,r,l,m,b){if(b>0){const S=o.q.now(),E=(S-f.timeAdded)/b,z=r?(S-r.timeAdded)/b:-1,V=l.getSource(),q=m.coveringZoomLevel({tileSize:V.tileSize,roundZoom:V.roundZoom}),H=!r||Math.abs(r.tileID.overscaledZ-q)>Math.abs(f.tileID.overscaledZ-q),X=H&&f.refreshedUponExpiration?1:o.ap(H?E:1-z,0,1);return f.refreshedUponExpiration&&E>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class Ad extends Ue{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},m=new o.ce(o.cf(),null),b=za("mock-dem",l,m,r.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class sy extends Ue{constructor(r){const l=za("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new o.ce(o.cf(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,m){if(r.freezeTileCoverage)return;this.transform=r;const b=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,E)=>{if(S[E.key]="",!this._tiles[E.key]){const z=new Vs(E,this._source.tileSize*E.overscaleFactor(),r.tileZoom);z.state="loaded",this._tiles[E.key]=z}return S},{});for(const S in this._tiles)S in b||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const m=Object.values(l);this.renderCachePool.push(...m),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class hg extends o.aA{constructor(r,l,m){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=m}}class fg extends o.cE{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,b,S]=function(V){const q=new o.a$,H=new o.aP,X=131;q.reserve(17161),H.reserve(33800);const ee=o.ab/128,ae=o.ab+ee/2,be=ae+ee;for(let Te=-ee;Te<be;Te+=ee)for(let Se=-ee;Se<be;Se+=ee){const De=Se<0||Se>ae||Te<0||Te>ae?24575:0,je=o.ap(Math.round(Se),0,o.ab),He=o.ap(Math.round(Te),0,o.ab);q.emplaceBack(je+De,He)}const ye=(Te,Se)=>{const De=Se*X+Te;H.emplaceBack(De+1,De,De+X),H.emplaceBack(De+X,De+X+1,De+1)};for(let Te=1;Te<129;Te++)for(let Se=1;Se<129;Se++)ye(Se,Te);return[0,129].forEach(Te=>{for(let Se=0;Se<130;Se++)ye(Se,Te),ye(Te,Se)}),[q,H,32768]}(),E=r.context;this.gridBuffer=E.createVertexBuffer(m,o.b1.members),this.gridIndexBuffer=E.createIndexBuffer(b),this.gridSegments=o.b2.simpleSegment(0,0,m.length,b.length),this.gridNoSkirtSegments=o.b2.simpleSegment(0,0,m.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new sy(l.map),this.orthoMatrix=o.a6.mat4.create(),o.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.ab,0,o.ab,0,1);const z=E.gl;this._overlapStencilMode=new Do({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ad(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,m){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const b=r.terrain.properties,S=r.terrain.drapeRenderMode===0,E=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.q.now();const z=r.terrain&&r.terrain.scope,V=b.get("source"),q=S?this._mockSourceCache:r.getSourceCache(V,z);if(!q)return void o.w(`Couldn't find terrain source "${V}".`);if(this.sourceCache=q,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(l):b.get("exaggeration"),!l.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const H=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(l,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,H(),this._initializing=!0),H(),l.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,m=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=m;const b=l!=null?m-l:Number.MAX_VALUE;if(Math.abs(b)<2)return this._exaggeration;const S=r.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(S);let z=S-this._previousZoom;const V=this._previousUpdateTimestamp;let q=S;this._evaluationZoom!=null&&(q=this._evaluationZoom,Math.abs(S-q)>.5&&(z=.5*(S-q+z)),z*b<0&&(q+=z)),this._evaluationZoom=q;const H=E.getExaggeration(q),X=H===E.getExaggeration(Math.max(0,q-.1));if(X&&Math.abs(H-this._exaggeration)<.01)return H;let ee=Math.min(.1,.00375*(this._updateTimestamp-V));return(X||H<.1||Math.abs(z)<1e-4)&&(ee=Math.min(.2,4*ee)),o.aa(this._exaggeration,H,ee)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(o.a5.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=l.getIds().map(V=>{const q=l.getTileByID(V).tileID;return q.projMatrix=m.calculateProjMatrix(q.toUnwrapped()),q});(function(V,q){const H=q.transform.pointCoordinate(q.transform.getCameraPoint()),X=new o.P(H.x,H.y);V.sort((ee,ae)=>{if(ae.overscaledZ-ee.overscaledZ)return ae.overscaledZ-ee.overscaledZ;const be=new o.P(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),ye=new o.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),Te=X.mult(1<<ee.canonical.z);return Te.x-=.5,Te.y-=.5,Te.distSqr(be)-Te.distSqr(ye)})})(b,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},b.forEach(V=>{this.proxyToSource[V.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const V in E){const q=E[V];if(!q.used||(q!==this.sourceCache&&this.resetTileLookupCache(q.id),this._setupProxiedCoordsForOrtho(q,r[V],S),q.usedForTerrain))continue;const H=r[V];q.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[l.id]=b.map(V=>new hg(V,V.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const z={};this._visibleDemTiles=[];for(const V of this.proxyCoords){const q=this.terrainTileForTile[V.key];if(!q)continue;const H=q.tileID.key;H in z||(this._visibleDemTiles.push(q),z[H]=H)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const m=this._findTileCoveringTileID(l,this.sourceCache);m&&(this.terrainTileForTile[l.key]=m)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const m in this.terrainTileForTile){const b=this.terrainTileForTile[m],S=b.dem;!S||b.demTexture&&!b.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),Fl(this.painter,b,S))}}_prepareDemTileUniforms(r,l,m,b){if(!l||l.demTexture==null)return!1;const S=r.tileID.canonical,E=Math.pow(2,l.tileID.canonical.z-S.z),z=b||"";return m[`u_dem_tl${z}`]=[S.x*E%1,S.y*E%1],m[`u_dem_scale${z}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((m,b)=>{if(!b.dem)return m;const S=b.dem.tree.minimums[0];return S>0&&r++,m+S},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const m=this._getLoadedAreaMinimum(),b=new o.cF({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(b,{premultiply:!1}):S=this._emptyDEMTexture=new o.T(r,b,l.R32F,{premultiply:!1}),S}setupElevationDraw(r,l,m){const b=this.painter.context,S=b.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let z=null,V=null,q=1;if(m&&m.morphing&&this._useVertexMorphing){const ae=m.morphing.srcDemTile,be=m.morphing.dstDemTile;q=m.morphing.phase,ae&&be&&(this._prepareDemTileUniforms(r,ae,E,"_prev")&&(V=ae),this._prepareDemTileUniforms(r,be,E)&&(z=be))}const H=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST;let X=null;var ee;if(this.enabled?V&&z?(X=z.demTexture,b.activeTexture.set(S.TEXTURE4),V.demTexture.bind(H(V),S.CLAMP_TO_EDGE),E.u_dem_lerp=q):(z=this.terrainTileForTile[r.tileID.key],X=this._prepareDemTileUniforms(r,z,E)?z.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,b.activeTexture.set(S.TEXTURE2),X&&(E.u_dem_size=(ee=X).size[0]===1?1:ee.size[0]-2,X.bind(H(z),S.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,l,E),m&&m.useMeterToDem&&z){const ae=(1<<z.tileID.canonical.z)*o.bE(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=ae}if(m&&m.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),l.setTerrainUniformValues(b,E),this.painter.transform.projection.name==="globe"){const ae=this.globeUniformValues(this.painter.transform,r.tileID.canonical,m&&m.useDenormalizedUpVectorScale);l.setGlobeUniformValues(b,ae)}}globeUniformValues(r,l,m){const b=r.projection;return{u_tile_tl_up:b.upVector(l,0,0),u_tile_tr_up:b.upVector(l,o.ab,0),u_tile_br_up:b.upVector(l,o.ab,o.ab),u_tile_bl_up:b.upVector(l,0,o.ab),u_tile_up_scale:m?o.cG(1):b.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,m=this.painter.context;r.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,S,E,z,V){if(b.transform.projection.name==="globe")(function(q,H,X,ee,ae){const be=q.context,ye=be.gl;let Te,Se;const De=q.transform,je=o.cx(q,be,De),He=(jt,en)=>{if(Se===en)return;const gn=[iy[en],"PROJECTION_GLOBE_VIEW"];je&&gn.push("CUSTOM_ANTIALIASING");const An=q.isTileAffectedByFog(jt);Te=q.getOrCreateProgram("globeRaster",{defines:gn,overrideFog:An}),Se=en},Ye=q.colorModeForRenderPass(),tt=new bo(ye.LEQUAL,bo.ReadWrite,q.depthRangeFor3D);Id.update(ae);const Xe=o.cy(De),nt=[o.am(De.center.lng),o.at(De.center.lat)],lt=q.globeSharedBuffers,vt=[De.width*o.q.devicePixelRatio,De.height*o.q.devicePixelRatio],dt=Float32Array.from(De.globeMatrix),ct={useDenormalizedUpVectorScale:!0};{const jt=q.transform,en=ay(jt.zoom,H.exaggeration(),H.sourceCache._source.tileSize);Se=-1;const gn=ye.TRIANGLES;for(const An of ee){const Dn=X.getTile(An),It=Do.disabled,pn=H.prevTerrainTileForTile[An.key],Xt=H.terrainTileForTile[An.key];ry(pn,Xt)&&Id.newMorphing(An.key,pn,Xt,ae,250),be.activeTexture.set(ye.TEXTURE0),Dn.texture&&Dn.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const mn=Id.getMorphValuesForProxy(An.key),wn=mn?1:0;mn&&o.C(ct,{morphing:{srcDemTile:mn.from,dstDemTile:mn.to,phase:o.cw(mn.phase)}});const hn=o.cz(An.canonical),Vn=o.cA(hn.getCenter().lat),fo=o.cB(An.canonical,hn,Vn,jt.worldSize/jt._pixelsPerMercatorPixel),xo=o.b6(o.cC(An.canonical)),ro=oy(jt.expandedFarZProjMatrix,dt,Xe,xo,o.a9(jt.zoom),nt,jt.frustumCorners.TL,jt.frustumCorners.TR,jt.frustumCorners.BR,jt.frustumCorners.BL,jt.globeCenterInViewSpace,jt.globeRadius,vt,en,jt._farZ,fo);if(He(An,wn),Te&&(H.setupElevationDraw(Dn,Te,ct),q.uploadCommonUniforms(be,Te,An.toUnwrapped()),lt)){const[So,Wn,Ro]=lt.getGridBuffers(Vn,en!==0);Te.draw(q,gn,tt,It,Ye,Po.backCCW,ro,"globe_raster",So,Wn,Ro)}}}if(lt&&(q.renderDefaultNorthPole||q.renderDefaultSouthPole)){const jt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];je&&jt.push("CUSTOM_ANTIALIASING"),Te=q.getOrCreateProgram("globeRaster",{defines:jt});for(const en of ee){const{x:gn,y:An,z:Dn}=en.canonical,It=An===0,pn=An===(1<<Dn)-1,[Xt,mn,wn,hn]=lt.getPoleBuffers(Dn,!1);if(hn&&(It||pn)){const Vn=X.getTile(en);be.activeTexture.set(ye.TEXTURE0),Vn.texture&&Vn.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);let fo=o.cD(Dn,gn,De);const xo=o.b6(o.cC(en.canonical)),ro=(So,Wn)=>So.draw(q,ye.TRIANGLES,tt,Do.disabled,Ye,Po.disabled,oy(De.expandedFarZProjMatrix,fo,fo,xo,0,nt,De.frustumCorners.TL,De.frustumCorners.TR,De.frustumCorners.BR,De.frustumCorners.BL,De.globeCenterInViewSpace,De.globeRadius,vt,0,De._farZ),"globe_pole_raster",Wn,wn,hn);H.setupElevationDraw(Vn,Te,ct),q.uploadCommonUniforms(be,Te,en.toUnwrapped()),It&&q.renderDefaultNorthPole&&ro(Te,Xt),pn&&q.renderDefaultSouthPole&&(fo=o.a6.mat4.scale(o.a6.mat4.create(),fo,[1,-1,1]),ro(Te,mn))}}}})(b,S,E,z,V);else{const q=b.context,H=q.gl;let X,ee;const ae=b.shadowRenderer,be=Aa(b,b.longestCutoffRange),ye=Ye=>{if(ee===Ye)return;const tt=[];tt.push(iy[Ye]),be.shouldRenderCutoff&&tt.push("RENDER_CUTOFF"),ae&&(tt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&tt.push("NORMAL_OFFSET")),X=b.getOrCreateProgram("terrainRaster",{defines:tt}),ee=Ye},Te=b.colorModeForRenderPass(),Se=new bo(H.LEQUAL,bo.ReadWrite,b.depthRangeFor3D);Id.update(V);const De=b.transform,je=ay(De.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let He=[0,0,0];if(ae){const Ye=b.style.directionalLight,tt=b.style.ambientLight;Ye&&tt&&(He=xc(b.style,Ye,tt))}{ee=-1;const Ye=H.TRIANGLES,[tt,Xe]=[S.gridIndexBuffer,S.gridSegments];for(const nt of z){const lt=E.getTile(nt),vt=Do.disabled,dt=S.prevTerrainTileForTile[nt.key],ct=S.terrainTileForTile[nt.key];ry(dt,ct)&&Id.newMorphing(nt.key,dt,ct,V,250),q.activeTexture.set(H.TEXTURE0),lt.texture&&lt.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const jt=Id.getMorphValuesForProxy(nt.key),en=jt?1:0;let gn;jt&&(gn={morphing:{srcDemTile:jt.from,dstDemTile:jt.to,phase:o.cw(jt.phase)}});const An=F1(nt.projMatrix,dg(nt.canonical,De.renderWorldCopies)?je/10:je,He);if(ye(en),!X)continue;S.setupElevationDraw(lt,X,gn);const Dn=nt.toUnwrapped();ae&&ae.setupShadows(Dn,X),b.uploadCommonUniforms(q,X,Dn,null,be),X.draw(b,Ye,Se,vt,Te,Po.backCCW,An,"terrain_raster",S.gridBuffer,tt,Xe)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,m=this.painter.context,b=this.proxySourceCache,S=this.proxiedCoords[b.id],E=this._drapedRenderBatches.shift(),z=l.style.order,V=[];let q=0;for(const H of S){const X=b.getTileByID(H.proxyTileKey),ee=b.proxyCachedFBO[H.key]?b.proxyCachedFBO[H.key][r]:void 0,ae=ee!==void 0?b.renderCache[ee]:this.pool[q++],be=ee!==void 0;if(X.texture=ae.tex,be&&!ae.dirty){V.push(X.tileID);continue}let ye;m.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(m.clear({color:o.bA.transparent,stencil:0}),ae.dirty=!1);for(let Te=E.start;Te<=E.end;++Te){const Se=l.style._mergedLayers[z[Te]];if(Se.isHidden(l.transform.zoom))continue;const De=l.style.getLayerSourceCache(Se),je=De?this.proxyToSource[H.key][De.id]:[H];if(!je)continue;const He=je;m.viewport.set([0,0,ae.fb.width,ae.fb.height]),ye!==(De?De.id:null)&&(this._setupStencil(ae,je,Se,De),ye=De?De.id:null),l.renderLayer(l,De,Se,He)}if(this._drapedRenderBatches.length===0)for(const Te of this._pendingGroundEffectLayers){const Se=l.style._mergedLayers[z[Te]];if(Se.isHidden(l.transform.zoom))continue;const De=l.style.getLayerSourceCache(Se),je=De?this.proxyToSource[H.key][De.id]:[H];if(!je)continue;const He=je;m.viewport.set([0,0,ae.fb.width,ae.fb.height]),ye!==(De?De.id:null)&&(this._setupStencil(ae,je,Se,De),ye=De?De.id:null),l.renderLayer(l,De,Se,He)}this.renderedToTile?(ae.dirty=!0,V.push(X.tileID)):be||--q,q===5&&(q=0,this.renderToBackBuffer(V))}return this.renderToBackBuffer(V),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),E.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let m=-1,b=l;for(let S=0;S<l;++S)this._style.isLayerDraped(r._mergedLayers[r.order[S]])?m=Math.max(m,S):b=Math.min(b,S);return b>m}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,m){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const E=S.tileID,z=1<<E.overscaledZ,{x:V,y:q}=E.canonical,H=V/z,X=(V+1)/z,ee=q/z,ae=(q+1)/z;return{minx:H,miny:ee,maxx:X,maxy:ae,t:S.dem.tree.raycastRoot(H,ee,X,ae,r,l,m),tile:S}});b.sort((S,E)=>(S.t!==null?S.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const S of b){if(S.t==null)return null;const E=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,r,l,m);if(E!=null)return E}return null}_createFBO(){const r=this.painter.context,l=r.gl,m=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const b=new o.T(r,{width:m[0],height:m[1],data:null},l.RGBA8);b.bind(l.LINEAR,l.CLAMP_TO_EDGE);const S=r.createFramebuffer(m[0],m[1],!0,null);return S.colorAttachment.set(b.texture),S.depthAttachment=new Md(r,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:S,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],m=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!m&&l.shouldRedrape():!m&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const m of this._style.getSources())if(m instanceof yr){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const b=this._style._mergedLayers[this._style.order[m]],S=this._style.getLayerSourceCache(b);if(S&&!l[S.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof o.a4){l[S.id]=!0;for(const E of this.proxyCoords){const z=this.proxyToSource[E.key][S.id];if(z)for(const V of z)this._clearRenderCacheForTile(S.id,V)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof al){r=!0;break}if(!r)return;const l={};for(let m=0;m<this._style.order.length;++m){const b=this._style._mergedLayers[this._style.order[m]],S=this._style.getLayerSourceCache(b);if(!S||l[S.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const E=b.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const V=this.proxyToSource[z.key][S.id];if(V)for(const q of V){const H=lp(S.getTile(q),S.findLoadedParent(q,0),S,this.painter.transform,E);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(S.id,q)}}}}_setupDrapedRenderBatches(){const r=this._style.order,l=r.length;if(l===0)return;const m=[];this._pendingGroundEffectLayers=[];let b,S=0,E=this._style._mergedLayers[r[S]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++S<l;)E=this._style._mergedLayers[r[S]];for(;S<l;++S){const z=this._style._mergedLayers[r[S]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?b===void 0&&(b=S):(z.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),b!==void 0&&(m.push({start:b,end:S-1}),b=void 0)))}if(b!==void 0&&m.push({start:b,end:S-1}),m.length!==0){const z=m[m.length-1];this._pendingGroundEffectLayers.every(V=>V>z.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const E=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let z=0;z<E.length;++z){const V=Object.values(E[z]);l.renderCachePool.push(...V)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,b=this._tilesDirty;for(let E=m.length-1;E>=0;E--){const z=m[E];if(l.getTileByID(z.key),l.proxyCachedFBO[z.key]!==void 0){const V=r[z.key],q=this.proxyToSource[z.key];let H=0;for(const X in q){const ee=q[X],ae=V[X];if(!ae||ae.length!==ee.length||ee.some((be,ye)=>be!==ae[ye]||b[X]&&b[X].hasOwnProperty(be.key))){H=-1;break}++H}for(const X in l.proxyCachedFBO[z.key])l.renderCache[l.proxyCachedFBO[z.key][X]].dirty=H<0||H!==Object.values(V).length}}const S=[...this._drapedRenderBatches];S.sort((E,z)=>z.end-z.start-(E.end-E.start));for(const E of S)for(const z of m){if(l.proxyCachedFBO[z.key])continue;let V=l.renderCachePool.pop();V===void 0&&l.renderCache.length<50&&(V=l.renderCache.length,l.renderCache.push(this._createFBO())),V!==void 0&&(l.proxyCachedFBO[z.key]={},l.proxyCachedFBO[z.key][E.start]=V,l.renderCache[V].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,m,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,E=S.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let z;if(m.isTileClipped())z=l.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Do.disabled}_renderTileClippingMasks(r,l){const m=this.painter,b=this.painter.context,S=b.gl;m._tileClippingMaskIDs={},b.setColorMode(ir.disabled),b.setDepthMode(bo.disabled);const E=m.getOrCreateProgram("clippingMask");for(const z of r){const V=m._tileClippingMaskIDs[z.key]=--l;E.draw(m,S.TRIANGLES,bo.disabled,new Do({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),ir.disabled,Po.disabled,Hh(z.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const m=[r.x,r.y,1,1];o.a6.vec4.transformMat4(m,m,l.pixelMatrixInverse),o.a6.vec4.scale(m,m,1/m[3]),m[0]/=l.worldSize,m[1]/=l.worldSize;const b=l._camera.position,S=o.bE(1,l.center.lat),E=[b[0],b[1],b[2]/S,0],z=o.a6.vec3.subtract([],m.slice(0,3),E);o.a6.vec3.normalize(z,z);const V=this.raycast(E,z,this._exaggeration);return V!==null&&V?(o.a6.vec3.scaleAndAdd(E,E,z,V),E[3]=E[2],E[2]*=S,E):null}_setupProxiedCoordsForOrtho(r,l,m){if(r.getSource()instanceof o.aD)return this._setupProxiedCoordsForImageSource(r,l,m);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const b=this.proxiedCoords[r.id]=[],S=this.proxyCoords;for(let V=0;V<S.length;V++){const q=S[V],H=this._findTileCoveringTileID(q,r);if(H){const X=this._createProxiedId(q,H,m[q.key]&&m[q.key][r.id]);b.push(X),this.proxyToSource[q.key][r.id]=[X]}}let E=!1;const z=new Set;for(let V=0;V<l.length;V++){const q=r.getTile(l[V]);if(!q||!q.hasData())continue;const H=this._findTileCoveringTileID(q.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==q.tileID.canonical.z){const X=this.proxyToSource[H.tileID.key][r.id],ee=this._createProxiedId(H.tileID,q,m[H.tileID.key]&&m[H.tileID.key][r.id]);X?X.splice(X.length-1,0,ee):this.proxyToSource[H.tileID.key][r.id]=[ee];const ae=this.proxyToSource[H.tileID.key][r.id];z.has(ae)||z.add(ae),b.push(ee),E=!0}}if(this._sourceTilesOverlap[r.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const V of z)V.sort((q,H)=>H.overscaledZ-q.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,m){if(!r.getSource().loaded())return;const b=this.proxiedCoords[r.id]=[],S=this.proxyCoords,E=r.getSource(),z=E.tileID;if(!z)return;const V=new o.P(z.x,z.y)._div(1<<z.z),q=E.coordinates.map(o.a5.fromLngLat).reduce((X,ee)=>(X.min.x=Math.min(X.min.x,ee.x-V.x),X.min.y=Math.min(X.min.y,ee.y-V.y),X.max.x=Math.max(X.max.x,ee.x-V.x),X.max.y=Math.max(X.max.y,ee.y-V.y),X),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(X,ee)=>{const ae=X.wrap+X.canonical.x/(1<<X.canonical.z),be=X.canonical.y/(1<<X.canonical.z),ye=o.ab/(1<<X.canonical.z),Te=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),Se=ee.canonical.y/(1<<ee.canonical.z);return ae+ye<Te+q.min.x||ae>Te+q.max.x||be+ye<Se+q.min.y||be>Se+q.max.y};for(let X=0;X<S.length;X++){const ee=S[X];for(let ae=0;ae<l.length;ae++){const be=r.getTile(l[ae]);if(!be||!be.hasData()||H(ee,be.tileID))continue;const ye=this._createProxiedId(ee,be,m[ee.key]&&m[ee.key][r.id]),Te=this.proxyToSource[ee.key][r.id];Te?Te.push(ye):this.proxyToSource[ee.key][r.id]=[ye],b.push(ye)}}}_createProxiedId(r,l,m){let b=this.orthoMatrix;if(m){const S=m.find(E=>E.key===l.tileID.key);if(S)return S}if(l.tileID.key!==r.key){const S=r.canonical.z-l.tileID.canonical.z;let E,z,V;b=o.a6.mat4.create();const q=l.tileID.wrap-r.wrap<<r.overscaledZ;S>0?(E=o.ab>>S,z=E*((l.tileID.canonical.x<<S)-r.canonical.x+q),V=E*((l.tileID.canonical.y<<S)-r.canonical.y)):(E=o.ab<<-S,z=o.ab*(l.tileID.canonical.x-(r.canonical.x+q<<-S)),V=o.ab*(l.tileID.canonical.y-(r.canonical.y<<-S))),o.a6.mat4.ortho(b,0,E,0,E,0,1),o.a6.mat4.translate(b,b,[z,V,0])}return new hg(l.tileID,r.key,b)}_findTileCoveringTileID(r,l){let m=l.getTile(r);if(m&&m.hasData())return m;const b=this._findCoveringTileCache[l.id],S=b[r.key];if(m=S?l.getTileByID(S):null,m&&m.hasData()||S===null)return m;let E=m?m.tileID:r,z=E.overscaledZ;const V=l.getSource().minzoom,q=[];if(!S){const X=l.getSource().maxzoom;if(r.canonical.z>=X){const ee=r.canonical.z-X;l.getSource().reparseOverscaled?(z=Math.max(r.canonical.z+2,l.transform.tileZoom),E=new o.aA(z,r.wrap,X,r.canonical.x>>ee,r.canonical.y>>ee)):ee!==0&&(z=X,E=new o.aA(z,r.wrap,X,r.canonical.x>>ee,r.canonical.y>>ee))}E.key!==r.key&&(q.push(E.key),m=l.getTile(E))}const H=X=>{q.forEach(ee=>{b[ee]=X}),q.length=0};for(z-=1;z>=V&&(!m||!m.hasData());z--){m&&H(m.tileID.key);const X=E.calculateScaledKey(z);if(m=l.getTileByID(X),m&&m.hasData())break;const ee=b[X];if(ee===null)break;ee===void 0?q.push(X):m=l.getTileByID(ee)}return H(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let m=this._tilesDirty[r];m||(m=this._tilesDirty[r]={}),m[l.key]=!0}}function pg(f,r,l){const m=function(z,V,q){const H=o.a6.vec3.dot(V,z),X=o.a6.vec3.dot(q,[.2126,.7152,.0722]),ee=(be,ye,Te)=>(1-Te)*be+Te*ye,ae=ee(1-.3*Math.min(X,1),1,Math.min(H+1,1));return ee(.92,1,Math.asin(o.ap(V[2],-1,1))/Math.PI+.5)*ae}(f,[0,0,1],r),b=[0,0,0];o.a6.vec3.scale(b,l.slice(0,3),m);const S=[0,0,0];o.a6.vec3.scale(S,r.slice(0,3),f[2]);const E=[0,0,0];return o.a6.vec3.add(E,b,S),o.cc(E)}const Bu=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],ly=["stars","rain_particle","snow_particle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Tc{static cacheKey(r,l,m,b){let S=`${l}${b?b.cacheKey:""}`;for(const E of m)r.usedDefines.includes(E)&&(S+=`/${E}`);return S}constructor(r,l,m,b,S,E){const z=r.gl;this.program=z.createProgram(),this.configuration=b,this.name=l,this.fixedDefines=[...E];const V=b?b.getBinderAttributes():[],q=(m.staticAttributes||[]).concat(V);let H=b?b.defines():[];H=H.concat(E.map(Te=>`#define ${Te}`));const X=`#version 300 es
`;let ee=X+H.concat("precision mediump float;",hl,zl.fragmentSource).join(`
`);for(const Te of m.fragmentIncludes)ee+=`
${Na[Te]}`;ee+=`
${m.fragmentSource}`;let ae=X+H.concat("precision highp float;",hl,zl.vertexSource).join(`
`);for(const Te of m.vertexIncludes)ae+=`
${Na[Te]}`;ae+=`
${m.vertexSource}`;const be=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(be,ee),z.compileShader(be),z.attachShader(this.program,be);const ye=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(ye,ae),z.compileShader(ye),z.attachShader(this.program,ye),this.attributes={},this.numAttributes=q.length;for(let Te=0;Te<this.numAttributes;Te++)if(q[Te]){const Se=q[Te].startsWith("a_")?q[Te]:`a_${q[Te]}`;z.bindAttribLocation(this.program,Te,Se),this.attributes[Se]=Te}z.linkProgram(this.program),z.deleteShader(ye),z.deleteShader(be),this.fixedUniforms=S(r),this.binderUniforms=b?b.getUniforms(r):[],(E.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(Te=>({u_dem:new o.bK(Te),u_dem_prev:new o.bK(Te),u_dem_tl:new o.bH(Te),u_dem_scale:new o.bJ(Te),u_dem_tl_prev:new o.bH(Te),u_dem_scale_prev:new o.bJ(Te),u_dem_size:new o.bJ(Te),u_dem_lerp:new o.bJ(Te),u_exaggeration:new o.bJ(Te),u_depth:new o.bK(Te),u_depth_size_inv:new o.bH(Te),u_depth_range_unpack:new o.bH(Te),u_occluder_half_size:new o.bJ(Te),u_occlusion_depth_offset:new o.bJ(Te),u_meter_to_dem:new o.bJ(Te),u_label_plane_matrix_inv:new o.bG(Te)}))(r)),E.includes("GLOBE")&&(this.globeUniforms=(Te=>({u_tile_tl_up:new o.bI(Te),u_tile_tr_up:new o.bI(Te),u_tile_br_up:new o.bI(Te),u_tile_bl_up:new o.bI(Te),u_tile_up_scale:new o.bJ(Te)}))(r)),E.includes("FOG")&&(this.fogUniforms=(Te=>({u_fog_matrix:new o.bG(Te),u_fog_range:new o.bH(Te),u_fog_color:new o.c7(Te),u_fog_horizon_blend:new o.bJ(Te),u_fog_vertical_limit:new o.bH(Te),u_fog_temporal_offset:new o.bJ(Te),u_frustum_tl:new o.bI(Te),u_frustum_tr:new o.bI(Te),u_frustum_br:new o.bI(Te),u_frustum_bl:new o.bI(Te),u_globe_pos:new o.bI(Te),u_globe_radius:new o.bJ(Te),u_globe_transition:new o.bJ(Te),u_is_globe:new o.bK(Te),u_viewport:new o.bH(Te)}))(r)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Te=>({u_cutoff_params:new o.c7(Te)}))(r)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Te=>({u_lighting_ambient_color:new o.bI(Te),u_lighting_directional_dir:new o.bI(Te),u_lighting_directional_color:new o.bI(Te),u_ground_radiance:new o.bI(Te)}))(r)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Te=>({u_light_matrix_0:new o.bG(Te),u_light_matrix_1:new o.bG(Te),u_fade_range:new o.bH(Te),u_shadow_normal_offset:new o.bI(Te),u_shadow_intensity:new o.bJ(Te),u_shadow_texel_size:new o.bJ(Te),u_shadow_map_resolution:new o.bJ(Te),u_shadow_direction:new o.bI(Te),u_shadow_bias:new o.bI(Te),u_shadowmap_0:new o.bK(Te),u_shadowmap_1:new o.bK(Te)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)m[b]&&m[b].set(this.program,b,l[b])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)m[b]&&m[b].set(this.program,b,l[b])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)m[b].set(this.program,b,l[b])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)m[b].set(this.program,b,l[b])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const b in l)m[b].set(this.program,b,l[b])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;r.program.set(this.program);for(const b in l)m[b].set(this.program,b,l[b])}_drawDebugWireframe(r,l,m,b,S,E,z,V,q,H){const X=r.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const ee=r.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||r._terrain&&r._terrain.renderingToTexture||!Bu.includes(this.name))||!(!X.layers3D||!ly.includes(this.name))))return;const ae=ee.gl,be=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,S,ee);if(!be)return;const ye=[...this.fixedDefines];ye.push("DEBUG_WIREFRAME");const Te=r.getOrCreateProgram(this.name,{config:this.configuration,defines:ye});ee.program.set(Te.program);const Se=(He,Ye,tt)=>{if(Ye[He]&&tt[He])for(const Xe in Ye[He])tt[He][Xe]&&tt[He][Xe].set(tt.program,Xe,Ye[He][Xe].current)};q&&q.setUniforms(Te.program,ee,Te.binderUniforms,z,{zoom:V}),Se("fixedUniforms",this,Te),Se("terrainUniforms",this,Te),Se("globeUniforms",this,Te),Se("fogUniforms",this,Te),Se("lightsUniforms",this,Te),Se("shadowUniforms",this,Te),be.bind(),ee.setColorMode(new ir([ae.ONE,ae.ONE_MINUS_SRC_ALPHA,ae.ZERO,ae.ONE],o.bA.transparent,[!0,!0,!0,!1])),ee.setDepthMode(new bo(l.func===ae.LESS?ae.LEQUAL:l.func,bo.ReadOnly,l.range)),ee.setStencilMode(Do.disabled);const De=3*E.primitiveLength*2,je=3*E.primitiveOffset*2*2;H&&H>1?ae.drawElementsInstanced(ae.LINES,De,ae.UNSIGNED_SHORT,je,H):ae.drawElements(ae.LINES,De,ae.UNSIGNED_SHORT,je),S.bind(),ee.program.set(this.program),ee.setDepthMode(l),ee.setStencilMode(m),ee.setColorMode(b)}checkUniforms(r,l,m){if(this.fixedDefines.includes(l)){for(const b of Object.keys(m))if(!m[b].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${b} not set but required by ${l} being defined`)}}draw(r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te){const Se=r.context,De=Se.gl;if(this.failedToCreate)return;Se.program.set(this.program),Se.setDepthMode(m),Se.setStencilMode(b),Se.setColorMode(S),Se.setCullFace(E);for(const Ye of Object.keys(this.fixedUniforms))this.fixedUniforms[Ye].set(this.program,Ye,z[Ye]);be&&be.setUniforms(this.program,Se,this.binderUniforms,ee,{zoom:ae});const je={[De.POINTS]:1,[De.LINES]:2,[De.TRIANGLES]:3,[De.LINE_STRIP]:1}[l];this.checkUniforms(V,"RENDER_SHADOWS",this.shadowUniforms);const He=Te&&Te>0?1:void 0;for(const Ye of X.get()){const tt=Ye.vaos||(Ye.vaos={});(tt[V]||(tt[V]=new uu)).bind(Se,this,q,be?be.getPaintVertexBuffers():[],H,Ye.vertexOffset,ye||[],He),Te&&Te>1?De.drawElementsInstanced(l,Ye.primitiveLength*je,De.UNSIGNED_SHORT,Ye.primitiveOffset*je*2,Te):H?De.drawElements(l,Ye.primitiveLength*je,De.UNSIGNED_SHORT,Ye.primitiveOffset*je*2):De.drawArrays(l,Ye.vertexOffset,Ye.vertexLength),l===De.TRIANGLES&&H&&this._drawDebugWireframe(r,m,b,S,H,Ye,ee,ae,be,Te)}}}function cp(f,r){const l=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,f.transform.tileZoom)/l,b=m*(r.tileID.canonical.x+r.tileID.wrap*l),S=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ak(r,1,f.transform.tileZoom),u_pixel_coord_upper:[b>>16,S>>16],u_pixel_coord_lower:[65535&b,65535&S]}}const Nu={terrain:0,flat:1},cy=o.a6.mat4.create(),mg=(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te,Se)=>{const De=r.style.light,je=De.properties.get("position"),He=[je.x,je.y,je.z],Ye=o.a6.mat3.create();De.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(Ye,-r.transform.angle),o.a6.vec3.transformMat3(He,He,Ye));const tt=De.properties.get("color"),Xe=r.transform,nt={u_matrix:f,u_lightpos:He,u_lightintensity:De.properties.get("intensity"),u_lightcolor:[tt.r,tt.g,tt.b],u_vertical_gradient:+l,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:cy,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Nu[q],u_base_type:Nu[H],u_ao:b,u_edge_radius:S,u_width_scale:E,u_flood_light_color:be,u_vertical_scale:ye,u_flood_light_intensity:Te,u_ground_shadow_factor:Se};return Xe.projection.name==="globe"&&(nt.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],nt.u_zoom_transition=X,nt.u_inv_rot_matrix=ae,nt.u_merc_center=ee,nt.u_up_dir=Xe.projection.upVector(new o.bQ(0,0,0),ee[0]*o.ab,ee[1]*o.ab),nt.u_height_lift=V),nt},gg=(f,r,l,m,b,S)=>({u_matrix:f,u_edge_radius:r,u_width_scale:l,u_vertical_scale:m,u_height_type:Nu[b],u_base_type:Nu[S]}),vg=(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te)=>{const Se=mg(f,r,l,m,b,S,E,z,q,H,X,ee,ae,be,ye,Te,1,[0,0,0]),De={u_height_factor:-Math.pow(2,z.overscaledZ)/V.tileSize/8};return o.l(Se,cp(r,V),De)},uy=(f,r)=>({u_matrix:f,u_emissive_strength:r}),_g=(f,r,l,m)=>o.l(uy(f,r),cp(l,m)),Gh=(f,r,l)=>({u_matrix:f,u_world:l,u_emissive_strength:r}),B1=(f,r,l,m,b)=>o.l(_g(f,r,l,m),{u_world:b}),N1=(f,r,l,m)=>{const b=o.ab/l.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(m),u_extrude_scale:[r.pixelsToGLUnits[0]/b,r.pixelsToGLUnits[1]/b]}},yg=(f,r,l=1)=>({u_matrix:f,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),$1=o.a6.mat4.create(),bg=(f,r,l,m,b,S,E)=>{const z=f.transform,V=z.projection.name==="globe",q=V?o.cI(z.zoom,r.canonical)*z._pixelsPerMercatorPixel:o.ak(l,1,S),H={u_matrix:r.projMatrix,u_extrude_scale:q,u_intensity:E,u_inv_rot_matrix:$1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(V){H.u_inv_rot_matrix=m,H.u_merc_center=b,H.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],H.u_zoom_transition=o.a9(z.zoom);const X=b[0]*o.ab,ee=b[1]*o.ab;H.u_up_dir=z.projection.upVector(new o.bQ(0,0,0),X,ee)}return H};function up(f,[r,l,m,b],[S,E]){if(S===E)return[0,0,0,0];const z=255*(f-1)/(f*(E-S));return[r*z,l*z,m*z,b*z]}function kd(f,r,[l,m]){return l===m?0:.5/f+(r-l)*(f-1)/(f*(m-l))}const dp=(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te,Se,De,je,He)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:b,u_tl_parent:S,u_scale_parent:q,u_fade_t:H.mix,u_opacity:H.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:o.cJ(X.paint.get("raster-saturation")),u_contrast_factor:o.cK(X.paint.get("raster-contrast")),u_spin_weights:Wh(X.paint.get("raster-hue-rotate")),u_perspective_transform:ee,u_raster_elevation:ae,u_zoom_transition:E,u_merc_center:z,u_cutoff_params:V,u_colorization_mix:up(o.cL,ye,Se),u_colorization_offset:kd(o.cL,Te,Se),u_color_ramp:be,u_texture_offset:[je/(De+2*je),De/(De+2*je)],u_texture_res:[De+2*je,De+2*je],u_emissive_strength:He});function Wh(f){f*=Math.PI/180;const r=Math.sin(f),l=Math.cos(f);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const $u=.05,hp=(f,r,l,m,b,S,E,z,V,q,H,X)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:b,u_tl_parent:S,u_scale_parent:q,u_fade_t:H.mix,u_opacity:H.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:E,u_merc_center:z,u_cutoff_params:V}),fp=(f,r,l,m,b,S,E,z,V,q)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:m,u_color_ramp:S,u_velocity_res:b,u_max_speed:E,u_uv_offset:z,u_data_scale:[255*V[0],255*V[1]],u_data_offset:q,u_particle_pos_scale:1.1,u_particle_pos_offset:[$u,$u]}),xg=(f,r,l,m,b,S,E,z,V,q)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:m,u_max_speed:b,u_speed_factor:S,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:z,u_data_scale:[255*V[0],255*V[1]],u_data_offset:q,u_particle_pos_scale:1.1,u_particle_pos_offset:[$u,$u]}),wg=o.a6.mat4.create(),dy=(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te,Se,De,je,He,Ye)=>{const tt=b.transform,Xe={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:tt.getCameraToCenterDistance(De),u_rotate_symbol:+l,u_aspect_ratio:tt.width/tt.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:E,u_coord_matrix:z,u_is_text:+q,u_elevation_from_sea:V?1:0,u_pitch_with_map:+m,u_texsize:H,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:wg,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:wg,u_up_vector:[0,-1,0],u_color_adj_mat:je,u_icon_transition:He||0,u_gamma_scale:m?b.transform.getCameraToCenterDistance(De)*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:o.q.devicePixelRatio,u_is_halo:+ee,u_scale_factor:Ye||1};return De.name==="globe"&&(Xe.u_tile_id=[ae.canonical.x,ae.canonical.y,1<<ae.canonical.z],Xe.u_zoom_transition=be,Xe.u_inv_rot_matrix=Te,Xe.u_merc_center=ye,Xe.u_camera_forward=tt._camera.forward(),Xe.u_ecef_origin=o.cM(tt.globeMatrix,ae.toUnwrapped()),Xe.u_tile_matrix=Float32Array.from(tt.globeMatrix),Xe.u_up_vector=Se),Xe},Vu=(f,r,l,m)=>({u_matrix:f,u_emissive_strength:r,u_opacity:l,u_color:m}),qh=(f,r,l,m,b,S,E,z,V)=>o.l(function(q,H,X,ee,ae,be){const{width:ye,height:Te}=ee.imageManager.getPixelSize(H),Se=Math.pow(2,be.tileID.overscaledZ),De=be.tileSize*Math.pow(2,ee.transform.tileZoom)/Se,je=De*(be.tileID.canonical.x+be.tileID.wrap*Se),He=De*be.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[ye,Te],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:ae?[ee.transform.width,-1*ee.transform.height]:[1/o.ak(be,1,ee.transform.tileZoom),1/o.ak(be,1,ee.transform.tileZoom)],u_pixel_coord_upper:[je>>16,He>>16],u_pixel_coord_lower:[65535&je,65535&He]}}(0,S,E,m,z,V),{u_matrix:f,u_emissive_strength:r,u_opacity:l}),no=new Float32Array(o.a6.mat4.identity([])),pp=(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae=[0,0,0],be)=>{const ye=b.style.light,Te=ye.properties.get("position"),Se=[-Te.x,-Te.y,Te.z],De=o.a6.mat3.create();ye.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(De,-b.transform.angle),o.a6.vec3.transformMat3(Se,Se,De));const je=H.alphaMode==="MASK",He=ye.properties.get("color").toRenderColor(null),Ye=ee.paint.get("model-ambient-occlusion-intensity"),tt=ee.paint.get("model-color").constantOr(o.bA.white).toRenderColor(null),Xe=ee.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:m||no,u_lightpos:Se,u_lightintensity:ye.properties.get("intensity"),u_lightcolor:[He.r,He.g,He.b],u_camera_pos:ae,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+je,u_alphaCutoff:H.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[z[0],z[1],z[2],1],u_metallicFactor:V,u_roughnessFactor:q,u_baseColorTexture:ua.BaseColor,u_metallicRoughnessTexture:ua.MetallicRoughness,u_normalTexture:ua.Normal,u_occlusionTexture:ua.Occlusion,u_emissionTexture:ua.Emission,u_lutTexture:ua.LUT,u_color_mix:[tt.r,tt.g,tt.b,Xe],u_aoIntensity:Ye,u_emissive_strength:X,u_occlusionTextureTransform:be||[0,0,0,0]}},Sg=(f,r=no,l=no)=>({u_matrix:f,u_instance:r,u_node_matrix:l}),Uu={fillExtrusion:f=>({u_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_vertical_gradient:new o.bJ(f),u_opacity:new o.bJ(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_ao:new o.bH(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_up_dir:new o.bI(f),u_height_lift:new o.bJ(f),u_flood_light_color:new o.bI(f),u_vertical_scale:new o.bJ(f),u_flood_light_intensity:new o.bJ(f),u_ground_shadow_factor:new o.bI(f)}),fillExtrusionDepth:f=>({u_matrix:new o.bG(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_vertical_scale:new o.bJ(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f)}),fillExtrusionPattern:f=>({u_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_vertical_gradient:new o.bJ(f),u_height_factor:new o.bJ(f),u_edge_radius:new o.bJ(f),u_width_scale:new o.bJ(f),u_ao:new o.bH(f),u_height_type:new o.bK(f),u_base_type:new o.bK(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_up_dir:new o.bI(f),u_height_lift:new o.bJ(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f),u_opacity:new o.bJ(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new o.bG(f),u_opacity:new o.bJ(f),u_ao_pass:new o.bJ(f),u_meter_to_tile:new o.bJ(f),u_ao:new o.bH(f),u_flood_light_intensity:new o.bJ(f),u_flood_light_color:new o.bI(f),u_attenuation:new o.bJ(f),u_edge_radius:new o.bJ(f),u_fb:new o.bK(f),u_fb_size:new o.bJ(f),u_dynamic_offset:new o.bJ(f)}),fill:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f)}),fillPattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f)}),fillOutline:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_world:new o.bH(f)}),fillOutlinePattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_world:new o.bH(f),u_image:new o.bK(f),u_texsize:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_tile_units_to_pixels:new o.bJ(f)}),circle:o.cN,collisionBox:f=>({u_matrix:new o.bG(f),u_camera_to_center_distance:new o.bJ(f),u_extrude_scale:new o.bH(f)}),collisionCircle:f=>({u_matrix:new o.bG(f),u_inv_matrix:new o.bG(f),u_camera_to_center_distance:new o.bJ(f),u_viewport_size:new o.bH(f)}),debug:f=>({u_color:new o.cu(f),u_matrix:new o.bG(f),u_overlay:new o.bK(f),u_overlay_scale:new o.bJ(f)}),clippingMask:f=>({u_matrix:new o.bG(f)}),heatmap:f=>({u_extrude_scale:new o.bJ(f),u_intensity:new o.bJ(f),u_matrix:new o.bG(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_up_dir:new o.bI(f)}),heatmapTexture:f=>({u_image:new o.bK(f),u_color_ramp:new o.bK(f),u_opacity:new o.bJ(f)}),hillshade:f=>({u_matrix:new o.bG(f),u_image:new o.bK(f),u_latrange:new o.bH(f),u_light:new o.bH(f),u_shadow:new o.cu(f),u_highlight:new o.cu(f),u_emissive_strength:new o.bJ(f),u_accent:new o.cu(f)}),hillshadePrepare:f=>({u_matrix:new o.bG(f),u_image:new o.bK(f),u_dimension:new o.bH(f),u_zoom:new o.bJ(f)}),line:o.cO,linePattern:o.cP,raster:f=>({u_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bH(f),u_scale_parent:new o.bJ(f),u_fade_t:new o.bJ(f),u_opacity:new o.bJ(f),u_image0:new o.bK(f),u_image1:new o.bK(f),u_brightness_low:new o.bJ(f),u_brightness_high:new o.bJ(f),u_saturation_factor:new o.bJ(f),u_contrast_factor:new o.bJ(f),u_spin_weights:new o.bI(f),u_perspective_transform:new o.bH(f),u_raster_elevation:new o.bJ(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_cutoff_params:new o.c7(f),u_colorization_mix:new o.c7(f),u_colorization_offset:new o.bJ(f),u_color_ramp:new o.bK(f),u_texture_offset:new o.bH(f),u_texture_res:new o.bH(f),u_emissive_strength:new o.bJ(f)}),rasterParticle:f=>({u_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_grid_matrix:new o.cv(f),u_tl_parent:new o.bH(f),u_scale_parent:new o.bJ(f),u_fade_t:new o.bJ(f),u_opacity:new o.bJ(f),u_image0:new o.bK(f),u_image1:new o.bK(f),u_raster_elevation:new o.bJ(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_cutoff_params:new o.c7(f)}),rasterParticleTexture:f=>({u_texture:new o.bK(f),u_opacity:new o.bJ(f)}),rasterParticleDraw:f=>({u_particle_texture:new o.bK(f),u_particle_texture_side_len:new o.bJ(f),u_tile_offset:new o.bH(f),u_velocity:new o.bK(f),u_color_ramp:new o.bK(f),u_velocity_res:new o.bH(f),u_max_speed:new o.bJ(f),u_uv_offset:new o.bH(f),u_data_scale:new o.bH(f),u_data_offset:new o.bJ(f),u_particle_pos_scale:new o.bJ(f),u_particle_pos_offset:new o.bH(f)}),rasterParticleUpdate:f=>({u_particle_texture:new o.bK(f),u_particle_texture_side_len:new o.bJ(f),u_velocity:new o.bK(f),u_velocity_res:new o.bH(f),u_max_speed:new o.bJ(f),u_speed_factor:new o.bJ(f),u_reset_rate:new o.bJ(f),u_rand_seed:new o.bJ(f),u_uv_offset:new o.bH(f),u_data_scale:new o.bH(f),u_data_offset:new o.bJ(f),u_particle_pos_scale:new o.bJ(f),u_particle_pos_offset:new o.bH(f)}),symbol:f=>({u_is_size_zoom_constant:new o.bK(f),u_is_size_feature_constant:new o.bK(f),u_size_t:new o.bJ(f),u_size:new o.bJ(f),u_camera_to_center_distance:new o.bJ(f),u_rotate_symbol:new o.bK(f),u_aspect_ratio:new o.bJ(f),u_fade_change:new o.bJ(f),u_matrix:new o.bG(f),u_label_plane_matrix:new o.bG(f),u_coord_matrix:new o.bG(f),u_is_text:new o.bK(f),u_elevation_from_sea:new o.bK(f),u_pitch_with_map:new o.bK(f),u_texsize:new o.bH(f),u_texsize_icon:new o.bH(f),u_texture:new o.bK(f),u_texture_icon:new o.bK(f),u_gamma_scale:new o.bJ(f),u_device_pixel_ratio:new o.bJ(f),u_tile_id:new o.bI(f),u_zoom_transition:new o.bJ(f),u_inv_rot_matrix:new o.bG(f),u_merc_center:new o.bH(f),u_camera_forward:new o.bI(f),u_tile_matrix:new o.bG(f),u_up_vector:new o.bI(f),u_ecef_origin:new o.bI(f),u_is_halo:new o.bK(f),u_icon_transition:new o.bJ(f),u_color_adj_mat:new o.bG(f),u_scale_factor:new o.bJ(f)}),background:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_opacity:new o.bJ(f),u_color:new o.cu(f)}),backgroundPattern:f=>({u_matrix:new o.bG(f),u_emissive_strength:new o.bJ(f),u_opacity:new o.bJ(f),u_image:new o.bK(f),u_pattern_tl:new o.bH(f),u_pattern_br:new o.bH(f),u_texsize:new o.bH(f),u_pattern_size:new o.bH(f),u_pixel_coord_upper:new o.bH(f),u_pixel_coord_lower:new o.bH(f),u_pattern_units_to_pixels:new o.bH(f)}),terrainRaster:f=>({u_matrix:new o.bG(f),u_image0:new o.bK(f),u_skirt_height:new o.bJ(f),u_ground_shadow_factor:new o.bI(f)}),skybox:f=>({u_matrix:new o.bG(f),u_sun_direction:new o.bI(f),u_cubemap:new o.bK(f),u_opacity:new o.bJ(f),u_temporal_offset:new o.bJ(f)}),skyboxGradient:f=>({u_matrix:new o.bG(f),u_color_ramp:new o.bK(f),u_center_direction:new o.bI(f),u_radius:new o.bJ(f),u_opacity:new o.bJ(f),u_temporal_offset:new o.bJ(f)}),skyboxCapture:f=>({u_matrix_3f:new o.cv(f),u_sun_direction:new o.bI(f),u_sun_intensity:new o.bJ(f),u_color_tint_r:new o.c7(f),u_color_tint_m:new o.c7(f),u_luminance:new o.bJ(f)}),globeRaster:f=>({u_proj_matrix:new o.bG(f),u_globe_matrix:new o.bG(f),u_normalize_matrix:new o.bG(f),u_merc_matrix:new o.bG(f),u_zoom_transition:new o.bJ(f),u_merc_center:new o.bH(f),u_image0:new o.bK(f),u_grid_matrix:new o.cv(f),u_skirt_height:new o.bJ(f),u_far_z_cutoff:new o.bJ(f),u_frustum_tl:new o.bI(f),u_frustum_tr:new o.bI(f),u_frustum_br:new o.bI(f),u_frustum_bl:new o.bI(f),u_globe_pos:new o.bI(f),u_globe_radius:new o.bJ(f),u_viewport:new o.bH(f)}),globeAtmosphere:f=>({u_frustum_tl:new o.bI(f),u_frustum_tr:new o.bI(f),u_frustum_br:new o.bI(f),u_frustum_bl:new o.bI(f),u_horizon:new o.bJ(f),u_transition:new o.bJ(f),u_fadeout_range:new o.bJ(f),u_color:new o.c7(f),u_high_color:new o.c7(f),u_space_color:new o.c7(f),u_temporal_offset:new o.bJ(f),u_horizon_angle:new o.bJ(f)}),model:f=>({u_matrix:new o.bG(f),u_lighting_matrix:new o.bG(f),u_normal_matrix:new o.bG(f),u_node_matrix:new o.bG(f),u_lightpos:new o.bI(f),u_lightintensity:new o.bJ(f),u_lightcolor:new o.bI(f),u_camera_pos:new o.bI(f),u_opacity:new o.bJ(f),u_baseColorFactor:new o.c7(f),u_emissiveFactor:new o.c7(f),u_metallicFactor:new o.bJ(f),u_roughnessFactor:new o.bJ(f),u_baseTextureIsAlpha:new o.bK(f),u_alphaMask:new o.bK(f),u_alphaCutoff:new o.bJ(f),u_baseColorTexture:new o.bK(f),u_metallicRoughnessTexture:new o.bK(f),u_normalTexture:new o.bK(f),u_occlusionTexture:new o.bK(f),u_emissionTexture:new o.bK(f),u_lutTexture:new o.bK(f),u_color_mix:new o.c7(f),u_aoIntensity:new o.bJ(f),u_emissive_strength:new o.bJ(f),u_occlusionTextureTransform:new o.c7(f)}),modelDepth:f=>({u_matrix:new o.bG(f),u_instance:new o.bG(f),u_node_matrix:new o.bG(f)}),groundShadow:f=>({u_matrix:new o.bG(f),u_ground_shadow_factor:new o.bI(f)}),stars:f=>({u_matrix:new o.bG(f),u_up:new o.bI(f),u_right:new o.bI(f),u_intensity_multiplier:new o.bJ(f)}),snowParticle:f=>({u_modelview:new o.bG(f),u_projection:new o.bG(f),u_time:new o.bJ(f),u_cam_pos:new o.bI(f),u_velocityConeAperture:new o.bJ(f),u_velocity:new o.bJ(f),u_horizontalOscillationRadius:new o.bJ(f),u_horizontalOscillationRate:new o.bJ(f),u_boxSize:new o.bJ(f),u_billboardSize:new o.bJ(f),u_simpleShapeParameters:new o.bH(f),u_screenSize:new o.bH(f),u_thinningCenterPos:new o.bH(f),u_thinningShape:new o.bI(f),u_thinningAffectedRatio:new o.bJ(f),u_thinningParticleOffset:new o.bJ(f),u_particleColor:new o.c7(f),u_direction:new o.bI(f)}),rainParticle:f=>({u_modelview:new o.bG(f),u_projection:new o.bG(f),u_time:new o.bJ(f),u_cam_pos:new o.bI(f),u_texScreen:new o.bK(f),u_velocityConeAperture:new o.bJ(f),u_velocity:new o.bJ(f),u_boxSize:new o.bJ(f),u_rainDropletSize:new o.bH(f),u_distortionStrength:new o.bJ(f),u_rainDirection:new o.bI(f),u_color:new o.c7(f),u_screenSize:new o.bH(f),u_thinningCenterPos:new o.bH(f),u_thinningShape:new o.bI(f),u_thinningAffectedRatio:new o.bJ(f),u_thinningParticleOffset:new o.bJ(f),u_shapeDirectionalPower:new o.bJ(f),u_mode:new o.bJ(f)}),occlusion:f=>({u_matrix:new o.bG(f),u_anchorPos:new o.bI(f),u_screenSizePx:new o.bH(f),u_occluderSizePx:new o.bH(f),u_color:new o.c7(f)})};class os{constructor(r,l,m,b){this.id=os.uniqueIdxCounter,os.uniqueIdxCounter++,this.context=r;const S=r.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||b||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=os.uniqueIdxCounter,os.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}os.uniqueIdxCounter=0;const go={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Tg{constructor(r,l,m,b,S,E){this.length=l.length,this.attributes=m,this.itemSize=l.bytesPerElement,this.dynamicDraw=b,this.instanceCount=E,this.context=r;const z=r.gl;this.buffer=z.createBuffer(),r.bindVertexBuffer.set(this.buffer),z.bufferData(z.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?z.DYNAMIC_DRAW:z.STATIC_DRAW),this.dynamicDraw||S||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let m=0;m<this.attributes.length;m++){const b=l.attributes[this.attributes[m].name];b!==void 0&&r.enableVertexAttribArray(b)}}setVertexAttribPointers(r,l,m){for(let b=0;b<this.attributes.length;b++){const S=this.attributes[b],E=l.attributes[S.name];E!==void 0&&r.vertexAttribPointer(E,S.components,r[go[S.type]],!1,this.itemSize,S.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(r,l,m){for(let b=0;b<this.attributes.length;b++){const S=l.attributes[this.attributes[b].name];S!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(S,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class hy{constructor(r,l,m,b,S){this.context=r,this.width=l,this.height=m;const E=this.framebuffer=r.gl.createFramebuffer();b&&(this.colorAttachment=new sp(r,E)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new ug(r,E):new ny(r,E))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class V1{constructor(r,l){this.gl=r,this.clearColor=new Pa(this),this.clearDepth=new Ks(this),this.clearStencil=new Zs(this),this.colorMask=new Bl(this),this.depthMask=new Nl(this),this.stencilMask=new Sc(this),this.stencilFunc=new $l(this),this.stencilOp=new $h(this),this.stencilTest=new pl(this),this.depthRange=new Td(this),this.depthTest=new Cd(this),this.depthFunc=new Ed(this),this.blend=new op(this),this.blendFunc=new du(this),this.blendColor=new hu(this),this.blendEquation=new rg(this),this.cullFace=new ig(this),this.cullFaceSide=new Q_(this),this.frontFace=new ey(this),this.program=new z1(this),this.activeTexture=new Vh(this),this.viewport=new Uh(this),this.bindFramebuffer=new ty(this),this.bindRenderbuffer=new ws(this),this.bindTexture=new ag(this),this.bindVertexBuffer=new rp(this),this.bindElementBuffer=new ip(this),this.bindVertexArrayOES=new sg(this),this.pixelStoreUnpack=new lg(this),this.pixelStoreUnpackPremultiplyAlpha=new ap(this),this.pixelStoreUnpackFlipY=new cg(this),this.options=l?{...l}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,m){return new os(this,r,l,m)}createVertexBuffer(r,l,m,b,S){return new Tg(this,r,l,m,b,S)}createRenderbuffer(r,l,m){const b=this.gl,S=b.createRenderbuffer();return this.bindRenderbuffer.set(S),b.renderbufferStorage(b.RENDERBUFFER,r,l,m),this.bindRenderbuffer.set(null),S}createFramebuffer(r,l,m,b){return new hy(this,r,l,m,b)}clear({color:r,depth:l,stencil:m,colorMask:b}){const S=this.gl;let E=0;r&&(E|=S.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(b||[!0,!0,!0,!0])),l!==void 0&&(E|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),m!==void 0&&(E|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),S.clear(E)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.bi(r.blendFunction,ir.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Pd;function Cg(f,r,l,m,b,S,E){const z=f.context,V=z.gl,q=f.transform,H=f.getOrCreateProgram("collisionBox"),X=[];let ee=0,ae=0;for(let He=0;He<m.length;He++){const Ye=m[He],tt=r.getTile(Ye),Xe=tt.getBucket(l);if(!Xe)continue;const nt=ep(Ye,Xe,q);let lt=nt;b[0]===0&&b[1]===0||(lt=f.translatePosMatrix(nt,tt,b,S));const vt=E?Xe.textCollisionBox:Xe.iconCollisionBox,dt=Xe.collisionCircleArray;if(dt.length>0){const ct=o.a6.mat4.create(),jt=lt;o.a6.mat4.mul(ct,Xe.placementInvProjMatrix,q.glCoordMatrix),o.a6.mat4.mul(ct,ct,Xe.placementViewportMatrix),X.push({circleArray:dt,circleOffset:ae,transform:jt,invTransform:ct,projection:Xe.getProjection()}),ee+=dt.length/4,ae=ee}vt&&(f.terrain&&f.terrain.setupElevationDraw(tt,H),H.draw(f,V.LINES,bo.disabled,Do.disabled,f.colorModeForRenderPass(),Po.disabled,N1(lt,q,tt,Xe.getProjection()),l.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,null,q.zoom,null,[vt.collisionVertexBuffer,vt.collisionVertexBufferExt]))}if(!E||!X.length)return;const be=f.getOrCreateProgram("collisionCircle"),ye=new o.cQ;ye.resize(4*ee),ye._trim();let Te=0;for(const He of X)for(let Ye=0;Ye<He.circleArray.length/4;Ye++){const tt=4*Ye,Xe=He.circleArray[tt+0],nt=He.circleArray[tt+1],lt=He.circleArray[tt+2],vt=He.circleArray[tt+3];ye.emplace(Te++,Xe,nt,lt,vt,0),ye.emplace(Te++,Xe,nt,lt,vt,1),ye.emplace(Te++,Xe,nt,lt,vt,2),ye.emplace(Te++,Xe,nt,lt,vt,3)}(!Pd||Pd.length<2*ee)&&(Pd=function(He){const Ye=2*He,tt=new o.aP;tt.resize(Ye),tt._trim();for(let Xe=0;Xe<Ye;Xe++){const nt=6*Xe;tt.uint16[nt+0]=4*Xe+0,tt.uint16[nt+1]=4*Xe+1,tt.uint16[nt+2]=4*Xe+2,tt.uint16[nt+3]=4*Xe+2,tt.uint16[nt+4]=4*Xe+3,tt.uint16[nt+5]=4*Xe+0}return tt}(ee));const Se=z.createIndexBuffer(Pd,!0),De=z.createVertexBuffer(ye,o.cR.members,!0);for(const He of X){const Ye={u_matrix:He.transform,u_inv_matrix:He.invTransform,u_camera_to_center_distance:(je=q).getCameraToCenterDistance(He.projection),u_viewport_size:[je.width,je.height]};be.draw(f,V.TRIANGLES,bo.disabled,Do.disabled,f.colorModeForRenderPass(),Po.disabled,Ye,l.id,De,Se,o.b2.simpleSegment(0,2*He.circleOffset,He.circleArray.length,He.circleArray.length/2),null,q.zoom)}var je;De.destroy(),Se.destroy()}const Kh=o.a6.mat4.create();function fy(f){const r=f._camera.getWorldToCamera(f.worldSize,1),l=o.a6.mat4.multiply([],r,f.globeMatrix);o.a6.mat4.invert(l,l);const m=[0,0,0],b=[0,1,0,0];return o.a6.vec4.transformMat4(b,b,l),m[0]=b[0],m[1]=b[1],m[2]=b[2],o.a6.vec3.normalize(m,m),m}function U1({width:f,height:r,anchor:l,textOffset:m,textScale:b},S){const{horizontalAlign:E,verticalAlign:z}=o.by(l),V=-(E-.5)*f,q=-(z-.5)*r,H=o.bx(l,m);return new o.P((V/b+H[0])*S,(q/b+H[1])*S)}function Eg(f,r,l,m,b,S,E,z,V,q,H){const X=f.text.placedSymbolArray,ee=f.text.dynamicLayoutVertexArray,ae=f.icon.dynamicLayoutVertexArray,be={},ye=f.getProjection(),Te=Il(z,ye,S),Se=S.elevation,De=ye.upVectorScale(z.canonical,S.center.lat,S.worldSize).metersToTile;ee.clear();for(let je=0;je<X.length;je++){const He=X.get(je),{tileAnchorX:Ye,tileAnchorY:tt,numGlyphs:Xe}=He,nt=He.hidden||!He.crossTileID||f.allowVerticalPlacement&&!He.placedOrientation?null:m[He.crossTileID];if(nt){let lt=0,vt=0,dt=0;if(Se){const Xt=Se?Se.getAtTileOffset(z,Ye,tt):0,[mn,wn,hn]=ye.upVector(z.canonical,Ye,tt);lt=Xt*mn*De,vt=Xt*wn*De,dt=Xt*hn*De}let[ct,jt,en,gn]=sa(He.projectedAnchorX+lt,He.projectedAnchorY+vt,He.projectedAnchorZ+dt,l?Te:E);const An=xr(S.getCameraToCenterDistance(ye),gn);let Dn=b.evaluateSizeForFeature(f.textSizeData,q,He)*An/o.br;l&&(Dn*=f.tilePixelRatio/V);const It=U1(nt,Dn);l?({x:ct,y:jt,z:en}=ye.projectTilePoint(Ye+It.x,tt+It.y,z.canonical),[ct,jt,en]=sa(ct+lt,jt+vt,en+dt,E)):(r&&It._rotate(-S.angle),ct+=It.x,jt+=It.y,en=0);const pn=f.allowVerticalPlacement&&He.placedOrientation===o.bl.vertical?Math.PI/2:0;for(let Xt=0;Xt<Xe;Xt++)o.bo(ee,ct,jt,en,pn);H&&He.associatedIconIndex>=0&&(be[He.associatedIconIndex]={x:ct,y:jt,z:en,angle:pn})}else Us(Xe,ee)}if(H){ae.clear();const je=f.icon.placedSymbolArray;for(let He=0;He<je.length;He++){const Ye=je.get(He),{numGlyphs:tt}=Ye,Xe=be[He];if(Ye.hidden||!Xe)Us(tt,ae);else{const{x:nt,y:lt,z:vt,angle:dt}=Xe;for(let ct=0;ct<tt;ct++)o.bo(ae,nt,lt,vt,dt)}}f.icon.dynamicLayoutVertexBuffer.updateData(ae)}f.text.dynamicLayoutVertexBuffer.updateData(ee)}function Zh(f,r,l,m,b,S,E={}){const z=l.paint.get("icon-translate"),V=l.paint.get("text-translate"),q=l.paint.get("icon-translate-anchor"),H=l.paint.get("text-translate-anchor"),X=l.layout.get("icon-rotation-alignment"),ee=l.layout.get("text-rotation-alignment"),ae=l.layout.get("icon-pitch-alignment"),be=l.layout.get("text-pitch-alignment"),ye=l.layout.get("icon-keep-upright"),Te=l.layout.get("text-keep-upright"),Se=l.paint.get("icon-color-saturation"),De=l.paint.get("icon-color-contrast"),je=l.paint.get("icon-color-brightness-min"),He=l.paint.get("icon-color-brightness-max"),Ye=l.layout.get("symbol-elevation-reference")==="sea",tt=f.context,Xe=tt.gl,nt=f.transform,lt=X==="map",vt=ee==="map",dt=ae==="map",ct=be==="map",jt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let en=!1;const gn=f.depthModeForSublayer(0,bo.ReadOnly),An=[o.am(nt.center.lng),o.at(nt.center.lat)],Dn=l.layout.get("text-variable-anchor"),It=nt.projection.name==="globe",pn=[],Xt=[0,-1,0];for(const mn of m){const wn=r.getTile(mn),hn=wn.getBucket(l);if(!hn||hn.projection.name==="mercator"&&It||hn.fullyClipped)continue;const Vn=hn.projection.name==="globe",fo=Vn?o.a9(nt.zoom):0,xo=Il(mn,hn.getProjection(),nt),ro=nt.calculatePixelsToTileUnitsMatrix(wn),So=Dn&&hn.hasTextData(),Wn=hn.hasIconTextFit()&&So&&hn.hasIconData(),Ro=hn.getProjection().createInversionMatrix(nt,mn.canonical),Ko=Ur=>{nt.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||f.terrain)&&(Ur.push("DEPTH_D24"),Ur.push("DEPTH_OCCLUSION"))},mr=()=>{const Ur=lt&&l.layout.get("symbol-placement")!=="point",Or=[];Ko(Or);const fi=Ur||Wn,Yi=l.paint.get("icon-image-cross-fade").constantOr(0);f.terrainRenderModeElevated()&&dt&&Or.push("PITCH_WITH_MAP_TERRAIN"),Vn&&(Or.push("PROJECTION_GLOBE_VIEW"),fi&&Or.push("PROJECTED_POS_ON_VIEWPORT")),Yi>0&&Or.push("ICON_TRANSITION"),hn.icon.zOffsetVertexBuffer&&Or.push("Z_OFFSET"),Se===0&&De===0&&je===0&&He===1||Or.push("COLOR_ADJUSTMENT"),hn.sdfIcons&&Or.push("RENDER_SDF");const Cs=hn.icon.programConfigurations.get(l.id),Ys=f.getOrCreateProgram("symbol",{config:Cs,defines:Or}),ea=wn.imageAtlasTexture?wn.imageAtlasTexture.size:[0,0],wr=hn.iconSizeData,_r=o.bk(wr,nt.zoom),Pr=dt||nt.pitch!==0,Jr=fr(xo,wn.tileID.canonical,dt,lt,nt,hn.getProjection(),ro),Pi=zr(xo,wn.tileID.canonical,dt,lt,nt,hn.getProjection(),ro),pi=f.translatePosMatrix(Pi,wn,z,q,!0),ra=f.translatePosMatrix(xo,wn,z,q),Hl=fi?Kh:Jr,rs=lt&&!dt&&!Ur;let is=Xt;!It&&!nt.mercatorFromTransition||lt||(is=fy(nt));const Xs=Vn?is:Xt,vl=l.getColorAdjustmentMatrix(Se,De,je,He),as=dy(wr.kind,_r,rs,dt,f,ra,Hl,pi,Ye,!1,ea,[0,0],!0,mn,fo,An,Ro,Xs,hn.getProjection(),vl,Yi),Rc=wn.imageAtlasTexture?wn.imageAtlasTexture:null,Js=l.layout.get("icon-size").constantOr(0)!==1||hn.iconsNeedLinear,Fr=hn.sdfIcons||f.options.rotating||f.options.zooming||Js||Pr?Xe.LINEAR:Xe.NEAREST,jd=hn.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,Zg=f.terrain&&dt&&Ur?o.a6.mat4.invert(o.a6.mat4.create(),Jr):Kh;if(Ur&&hn.icon){const Hd=nt.elevation,Yg=Hd?Hd.getAtTileOffsetFunc(mn,nt.center.lat,nt.worldSize,hn.getProjection()):null,cf=br(xo,wn.tileID.canonical,dt,lt,nt,hn.getProjection(),ro);dc(hn,xo,f,!1,cf,Pi,dt,ye,Yg,mn)}return{program:Ys,buffers:hn.icon,uniformValues:as,atlasTexture:Rc,atlasTextureIcon:null,atlasInterpolation:Fr,atlasInterpolationIcon:null,isSDF:hn.sdfIcons,hasHalo:jd,tile:wn,labelPlaneMatrixInv:Zg}},Kr=()=>{const Ur=vt&&l.layout.get("symbol-placement")!=="point",Or=[],fi=Ur||Dn||Wn;f.terrainRenderModeElevated()&&ct&&Or.push("PITCH_WITH_MAP_TERRAIN"),Vn&&(Or.push("PROJECTION_GLOBE_VIEW"),fi&&Or.push("PROJECTED_POS_ON_VIEWPORT")),hn.text.zOffsetVertexBuffer&&Or.push("Z_OFFSET"),hn.iconsInText&&Or.push("RENDER_TEXT_AND_SYMBOL"),Or.push("RENDER_SDF"),Ko(Or);const Yi=hn.text.programConfigurations.get(l.id),Cs=f.getOrCreateProgram("symbol",{config:Yi,defines:Or});let Ys,ea=[0,0],wr=null;const _r=hn.textSizeData;hn.iconsInText&&(ea=wn.imageAtlasTexture?wn.imageAtlasTexture.size:[0,0],wr=wn.imageAtlasTexture?wn.imageAtlasTexture:null,Ys=ct||nt.pitch!==0||f.options.rotating||f.options.zooming||_r.kind==="composite"||_r.kind==="camera"?Xe.LINEAR:Xe.NEAREST);const Pr=wn.glyphAtlasTexture?wn.glyphAtlasTexture.size:[0,0],Jr=l.layout.get("text-size-scale-range"),Pi=o.ap(f.scaleFactor,Jr[0],Jr[1]),pi=o.bk(_r,nt.zoom,Pi),ra=fr(xo,wn.tileID.canonical,ct,vt,nt,hn.getProjection(),ro),Hl=zr(xo,wn.tileID.canonical,ct,vt,nt,hn.getProjection(),ro),rs=f.translatePosMatrix(Hl,wn,V,H,!0),is=f.translatePosMatrix(xo,wn,V,H),Xs=fi?Kh:ra,vl=vt&&!ct&&!Ur;let as=Xt;!It&&!nt.mercatorFromTransition||vt||(as=fy(nt));const Rc=dy(_r.kind,pi,vl,ct,f,is,Xs,rs,Ye,!0,Pr,ea,!0,mn,fo,An,Ro,Vn?as:Xt,hn.getProjection(),null,null,Pi),Js=wn.glyphAtlasTexture?wn.glyphAtlasTexture:null,Fr=Xe.LINEAR,jd=l.paint.get("text-halo-width").constantOr(1)!==0,Zg=f.terrain&&ct&&Ur?o.a6.mat4.invert(o.a6.mat4.create(),ra):Kh;if(Ur&&hn.text){const Hd=nt.elevation,Yg=Hd?Hd.getAtTileOffsetFunc(mn,nt.center.lat,nt.worldSize,hn.getProjection()):null,cf=br(xo,wn.tileID.canonical,ct,vt,nt,hn.getProjection(),ro);dc(hn,xo,f,!0,cf,Hl,ct,Te,Yg,mn)}return{program:Cs,buffers:hn.text,uniformValues:Rc,atlasTexture:Js,atlasTextureIcon:wr,atlasInterpolation:Fr,atlasInterpolationIcon:Ys,isSDF:!0,hasHalo:jd,tile:wn,labelPlaneMatrixInv:Zg}},Sr=hn.icon.segments.get().length,ii=hn.text.segments.get().length,kr=Sr&&!E.onlyText?mr():null,Zr=ii&&!E.onlyIcons?Kr():null,sr=l.paint.get("icon-opacity").constantOr(1),Gr=l.paint.get("text-opacity").constantOr(1);if(jt&&hn.canOverlap){en=!0;const Ur=sr&&!E.onlyText?hn.icon.segments.get():[],Or=Gr&&!E.onlyIcons?hn.text.segments.get():[];for(const fi of Ur)pn.push({segments:new o.b2([fi]),sortKey:fi.sortKey,state:kr});for(const fi of Or)pn.push({segments:new o.b2([fi]),sortKey:fi.sortKey,state:Zr})}else E.onlyText||pn.push({segments:sr?hn.icon.segments:new o.b2([]),sortKey:0,state:kr}),E.onlyIcons||pn.push({segments:Gr?hn.text.segments:new o.b2([]),sortKey:0,state:Zr})}en&&pn.sort((mn,wn)=>mn.sortKey-wn.sortKey);for(const mn of pn){const wn=mn.state;if(wn)if(f.terrain?f.terrain.setupElevationDraw(wn.tile,wn.program,{useDepthForOcclusion:nt.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:wn.labelPlaneMatrixInv}):f.setupDepthForOcclusion(nt.depthOcclusionForSymbolsAndCircles,wn.program),tt.activeTexture.set(Xe.TEXTURE0),wn.atlasTexture&&wn.atlasTexture.bind(wn.atlasInterpolation,Xe.CLAMP_TO_EDGE,!0),wn.atlasTextureIcon&&(tt.activeTexture.set(Xe.TEXTURE1),wn.atlasTextureIcon&&wn.atlasTextureIcon.bind(wn.atlasInterpolationIcon,Xe.CLAMP_TO_EDGE,!0)),f.uploadCommonLightUniforms(f.context,wn.program),wn.hasHalo){const hn=wn.uniformValues;hn.u_is_halo=1,Yh(wn.buffers,mn.segments,l,f,wn.program,gn,b,S,hn,2),hn.u_is_halo=0}else{if(wn.isSDF){const hn=wn.uniformValues;wn.hasHalo&&(hn.u_is_halo=1,Yh(wn.buffers,mn.segments,l,f,wn.program,gn,b,S,hn,1)),hn.u_is_halo=0}Yh(wn.buffers,mn.segments,l,f,wn.program,gn,b,S,wn.uniformValues,1)}}}function Yh(f,r,l,m,b,S,E,z,V,q){const H=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];b.draw(m,m.context.gl.TRIANGLES,S,E,z,Po.disabled,V,l.id,f.layoutVertexBuffer,f.indexBuffer,r,l.paint,m.transform.zoom,f.programConfigurations.get(l.id),H,q)}function mp(f,r,l,m,b,S,E){const z=f.context.gl,V=l.paint.get("fill-pattern"),q=l.is3D(),H=q?f.stencilModeFor3D():Do.disabled,X=V&&V.constantOr(1);let ee,ae,be,ye,Te;E?(ae=X&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=z.LINES):(ae=X?"fillPattern":"fill",ee=z.TRIANGLES);for(const Se of m){const De=r.getTile(Se);if(X&&!De.patternsLoaded())continue;const je=De.getBucket(l);if(!je)continue;f.prepareDrawTile();const He=je.programConfigurations.get(l.id),Ye=f.isTileAffectedByFog(Se),tt=f.getOrCreateProgram(ae,{config:He,overrideFog:Ye});X&&(f.context.activeTexture.set(z.TEXTURE0),De.imageAtlasTexture&&De.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),He.updatePaintBuffers());const Xe=V.constantOr(null);if(Xe&&De.imageAtlas){const vt=De.imageAtlas.patternPositions[Xe.toString()];vt&&He.setConstantPatternPositions(vt)}const nt=f.translatePosMatrix(Se.projMatrix,De,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),lt=l.paint.get("fill-emissive-strength");if(E){ye=je.indexBuffer2,Te=je.segments2;const vt=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];be=ae==="fillOutlinePattern"&&X?B1(nt,lt,f,De,vt):Gh(nt,lt,vt)}else ye=je.indexBuffer,Te=je.segments,be=X?_g(nt,lt,f,De):uy(nt,lt);f.uploadCommonUniforms(f.context,tt,Se.toUnwrapped()),tt.draw(f,ee,b,q?H:f.stencilModeForClipping(Se),S,Po.disabled,be,l.id,je.layoutVertexBuffer,ye,Te,l.paint,f.transform.zoom,He,void 0)}}function _a(f,r,l,m,b,S,E,z){l.resetLayerRenderingStats(f);const V=f.context,q=V.gl,H=f.transform,X=l.paint.get("fill-extrusion-pattern"),ee=X.constantOr(1),ae=l.paint.get("fill-extrusion-opacity"),be=f.style.enable3dLights(),ye=l.paint.get(be&&!ee?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),ye],Se=l.layout.get("fill-extrusion-edge-radius"),De=Se>0&&!l.paint.get("fill-extrusion-rounded-roof"),je=De?0:Se,He=H.projection.name==="globe"?o.c_():0,Ye=H.projection.name==="globe",tt=Ye?o.a9(H.zoom):0,Xe=[o.am(H.center.lng),o.at(H.center.lat)],nt=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),lt=l.paint.get("fill-extrusion-flood-light-intensity"),vt=l.paint.get("fill-extrusion-vertical-scale"),dt=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,ct=l.paint.get("fill-extrusion-height-alignment"),jt=l.paint.get("fill-extrusion-base-alignment"),en=Aa(f,l.paint.get("fill-extrusion-cutoff-fade-range")),gn=[];let An;Ye&&gn.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&gn.push("FAUX_AO"),De&&gn.push("ZERO_ROOF_RADIUS"),z&&gn.push("HAS_CENTROID"),lt>0&&gn.push("FLOOD_LIGHT"),en.shouldRenderCutoff&&gn.push("RENDER_CUTOFF"),dt&&gn.push("RENDER_WALL_MODE");const Dn=f.renderPass==="shadow",It=f.shadowRenderer,pn=Dn&&!!It;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Xt=[0,0,0];if(It){const hn=f.style.directionalLight,Vn=f.style.ambientLight;hn&&Vn&&(Xt=xc(f.style,hn,Vn)),Dn||(gn.push("RENDER_SHADOWS","DEPTH_TEXTURE"),It.useNormalOffset&&gn.push("NORMAL_OFFSET")),An=gn.concat(["SHADOWS_SINGLE_CASCADE"])}const mn=pn?"fillExtrusionDepth":ee?"fillExtrusionPattern":"fillExtrusion",wn=l.getLayerRenderingStats();for(const hn of m){const Vn=r.getTile(hn),fo=Vn.getBucket(l);if(!fo||fo.projection.name!==H.projection.name)continue;let xo=!1;It&&(xo=It.getMaxCascadeForTile(hn.toUnwrapped())===0);const ro=f.isTileAffectedByFog(hn),So=fo.programConfigurations.get(l.id),Wn=f.getOrCreateProgram(mn,{config:So,defines:xo?An:gn,overrideFog:ro});if(f.terrain&&f.terrain.setupElevationDraw(Vn,Wn,{useMeterToDem:!0}),!fo.centroidVertexBuffer){const kr=Wn.attributes.a_centroid_pos;kr!==void 0&&q.vertexAttrib2f(kr,0,0)}!Dn&&It&&It.setupShadows(Vn.tileID.toUnwrapped(),Wn,"vector-tile",Vn.tileID.overscaledZ),ee&&(f.context.activeTexture.set(q.TEXTURE0),Vn.imageAtlasTexture&&Vn.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),So.updatePaintBuffers());const Ro=X.constantOr(null);if(Ro&&Vn.imageAtlas){const kr=Vn.imageAtlas.patternPositions[Ro.toString()];kr&&So.setConstantPatternPositions(kr)}const Ko=l.paint.get("fill-extrusion-vertical-gradient"),mr=1/fo.tileToMeter;let Kr;if(Dn&&It){if(my(Vn.tileID,fo,f))continue;const kr=It.calculateShadowPassMatrixFromTile(Vn.tileID.toUnwrapped());Kr=gg(kr,je,mr,vt,ct,jt)}else{const kr=f.translatePosMatrix(hn.expandedProjMatrix,Vn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Zr=H.projection.createInversionMatrix(H,hn.canonical);Kr=ee?vg(kr,f,Ko,ae,Te,je,mr,hn,Vn,He,ct,jt,tt,Xe,Zr,nt,vt):mg(kr,f,Ko,ae,Te,je,mr,hn,He,ct,jt,tt,Xe,Zr,nt,vt,lt,Xt)}f.uploadCommonUniforms(V,Wn,hn.toUnwrapped(),null,en);let Sr=fo.segments;if(H.projection.name==="mercator"&&!Dn&&(Sr=fo.getVisibleSegments(Vn.tileID,f.terrain,f.transform.getFrustum(0)),!Sr.get().length))continue;if(wn)if(Dn)for(const kr of Sr.get())wn.numRenderedVerticesInShadowPass+=kr.primitiveLength;else for(const kr of Sr.get())wn.numRenderedVerticesInTransparentPass+=kr.primitiveLength;const ii=[];(f.terrain||z)&&ii.push(fo.centroidVertexBuffer),Ye&&ii.push(fo.layoutVertexExtBuffer),dt&&ii.push(fo.wallVertexBuffer),Wn.draw(f,V.gl.TRIANGLES,b,S,E,Po.backCCW,Kr,l.id,fo.layoutVertexBuffer,fo.indexBuffer,Sr,l.paint,f.transform.zoom,So,ii)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function Ss(f,r,l,m,b,S,E,z,V,q,H,X,ee,ae,be,ye,Te,Se,De){const je=f.context,He=je.gl,Ye=f.transform,tt=f.transform.zoom,Xe=[],nt=Aa(f,l.paint.get("fill-extrusion-cutoff-fade-range"));q==="clear"?(Xe.push("CLEAR_SUBPASS"),De&&(Xe.push("CLEAR_FROM_TEXTURE"),je.activeTexture.set(He.TEXTURE0),De.bind(He.LINEAR,He.CLAMP_TO_EDGE))):q==="sdf"&&Xe.push("SDF_SUBPASS"),Te&&Xe.push("HAS_CENTROID"),nt.shouldRenderCutoff&&Xe.push("RENDER_CUTOFF");const lt=l.layout.get("fill-extrusion-edge-radius"),vt=(dt,ct,jt,en,gn)=>{const An=ct.programConfigurations.get(l.id),Dn=f.isTileAffectedByFog(dt),It=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:An,defines:Xe,overrideFog:Dn}),pn=((mn,wn,hn,Vn,fo,xo,ro,So,Wn,Ro,Ko)=>({u_matrix:wn,u_opacity:hn,u_ao_pass:Vn?1:0,u_meter_to_tile:fo,u_ao:xo,u_flood_light_intensity:ro,u_flood_light_color:So,u_attenuation:Wn,u_edge_radius:Ro,u_fb:0,u_fb_size:Ko,u_dynamic_offset:1}))(0,en,H,V,gn,[X,ee*gn],ae,be,ye,tt>=17?0:lt*gn,De?De.size[0]:0),Xt=[];Te&&Xt.push(ct.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms(je,It,dt.toUnwrapped(),null,nt),It.draw(f,je.gl.TRIANGLES,b,S,E,z,pn,l.id,ct.vertexBuffer,ct.indexBuffer,jt,l.paint,tt,An,Xt)};for(const dt of m){const ct=r.getTile(dt),jt=ct.getBucket(l);if(!jt||jt.projection.name!==Ye.projection.name||!jt.groundEffect||jt.groundEffect&&!jt.groundEffect.hasData())continue;const en=jt.groundEffect,gn=1/jt.tileToMeter;{const An=f.translatePosMatrix(dt.projMatrix,ct,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Dn=en.getDefaultSegment();vt(dt,en,Dn,An,gn)}if(Se)for(let An=0;An<4;An++){const Dn=o.c$[An](dt),It=r.getTile(Dn);if(!It)continue;const pn=It.getBucket(l);if(!pn||pn.projection.name!==Ye.projection.name||!pn.groundEffect||pn.groundEffect&&!pn.groundEffect.hasData())continue;const Xt=pn.groundEffect;let mn,wn;An===0?(mn=[-o.ab,0,0],wn=1):An===1?(mn=[o.ab,0,0],wn=0):An===2?(mn=[0,-o.ab,0],wn=3):(mn=[0,o.ab,0],wn=2);const hn=Xt.regionSegments[wn];if(!hn)continue;const Vn=new Float32Array(16);o.a6.mat4.translate(Vn,dt.projMatrix,mn),vt(dt,Xt,hn,f.translatePosMatrix(Vn,ct,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),gn)}}}function py(f,r,l,m,b,S,E){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const z=S?S.findDEMTileFor(l):null;if(!(z&&z.dem||E))return;const V=Se=>new o.P(Math.ceil((Se+o.d2)*o.d3),0),q=Se=>{const De=r.getSource().minzoom,je=Ye=>{const tt=r.getTileByID(Ye);if(tt&&tt.hasData())return tt.getBucket(b)},He=[0,-1,1];for(const Ye of He){if(Se.overscaledZ+Ye<De)continue;const tt=je(Se.calculateScaledKey(Se.overscaledZ+Ye));if(tt)return tt}},H=[0,0,0],X=(Se,De)=>(H[0]=Math.min(Se.min.y,De.min.y),H[1]=Math.max(Se.max.y,De.max.y),H[2]=o.ab-De.min.x>Se.max.x?De.min.x-o.ab:Se.max.x,H),ee=(Se,De)=>(H[0]=Math.min(Se.min.x,De.min.x),H[1]=Math.max(Se.max.x,De.max.x),H[2]=o.ab-De.min.y>Se.max.y?De.min.y-o.ab:Se.max.y,H),ae=[(Se,De)=>X(Se,De),(Se,De)=>X(De,Se),(Se,De)=>ee(Se,De),(Se,De)=>ee(De,Se)],be=(Se,De,je,He,Ye,tt,Xe)=>{if(!S)return 0;const nt=[[tt?je:Se,tt?Se:je,0],[tt?je:De,tt?De:je,0]],lt=Xe<0?o.ab+Xe:Xe,vt=[tt?lt:(Se+De)/2,tt?(Se+De)/2:lt,0];return je===0&&Xe<0||je!==0&&Xe>0?S.getForTilePoints(Ye,[vt],!0,He):nt.push(vt),S.getForTilePoints(l,nt,!0,z),Math.max(nt[0][2],nt[1][2],vt[2])/S.exaggeration()};for(let Se=0;Se<4;Se++){const De=m.borderFeatureIndices[Se];if(De.length===0)continue;const je=o.c$[Se](l),He=q(je);if(!(He&&He instanceof o.d0)||m.borderDoneWithNeighborZ[Se]===He.canonical.z)continue;He.centroidVertexArray.length===0&&He.createCentroidsBuffer();const Ye=S?S.findDEMTileFor(je):null;if(!(Ye&&Ye.dem||E))continue;const tt=(Se<2?1:5)-Se,Xe=He.borderDoneWithNeighborZ[tt]!==m.canonical.z,nt=He.borderFeatureIndices[tt];let lt=0;if(m.canonical.z!==He.canonical.z){for(const vt of De)m.showCentroid(m.featuresOnBorder[vt]);if(Xe)for(const vt of nt)He.showCentroid(He.featuresOnBorder[vt]);m.borderDoneWithNeighborZ[Se]=He.canonical.z,He.borderDoneWithNeighborZ[tt]=m.canonical.z}for(const vt of De){const dt=m.featuresOnBorder[vt],ct=m.centroidData[dt.centroidDataIndex],jt=dt.borders[Se];let en;for(;lt<nt.length;){en=He.featuresOnBorder[nt[lt]];const gn=en.borders[tt];if(gn[1]>jt[0]+3||gn[0]>jt[0]-3)break;He.showCentroid(en),lt++}if(en&&lt<nt.length){const gn=lt;let An=0;for(;!(en.borders[tt][0]>jt[1]-3)&&(An++,++lt!==nt.length);)en=He.featuresOnBorder[nt[lt]];en=He.featuresOnBorder[nt[gn]];let Dn=!1;if(An>=1){const Xt=en.borders[tt];Math.abs(jt[0]-Xt[0])<3&&Math.abs(jt[1]-Xt[1])<3&&(An=1,Dn=!0,lt=gn+1)}else if(An===0){m.showCentroid(dt);continue}const It=He.centroidData[en.centroidDataIndex];E&&Dn&&(((ye=ct).flags|(Te=It).flags)&o.d1?(ye.flags|=o.d1,Te.flags|=o.d1):(ye.flags&=~o.d1,Te.flags&=~o.d1));const pn=dt.intersectsCount()>1||en.intersectsCount()>1;if(An>1)lt=gn,ct.centroidXY=It.centroidXY=new o.P(0,0);else if(Ye&&Ye.dem&&!pn){const Xt=ae[Se](ct,It),mn=Se%2?o.ab-1:0,wn=be(Xt[0],Math.min(o.ab-1,Xt[1]),mn,Ye,je,Se<2,Xt[2]);ct.centroidXY=It.centroidXY=V(wn)}else pn?ct.centroidXY=It.centroidXY=new o.P(0,0):(ct.centroidXY=m.encodeBorderCentroid(dt),It.centroidXY=He.encodeBorderCentroid(en));m.writeCentroidToBuffer(ct),He.writeCentroidToBuffer(It)}else m.showCentroid(dt)}m.borderDoneWithNeighborZ[Se]=He.canonical.z,He.borderDoneWithNeighborZ[tt]=m.canonical.z}var ye,Te;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(f)}const Mg=[1,0,0],Ig=[0,1,0],Ag=[0,0,1];function my(f,r,l){const m=l.transform,b=l.shadowRenderer;if(!b)return!0;const S=f.toUnwrapped(),E=m.tileSize*b._cascades[l.currentShadowCascade].scale;let z=r.maxHeight;if(m.elevation){const ye=m.elevation.getMinMaxForTile(f);ye&&(z+=ye.max)}const V=[...b.shadowDirection];V[2]=-V[2];const q=b.computeSimplifiedTileShadowVolume(S,z,E,V);if(!q)return!1;const H=[Mg,Ig,Ag,V,[V[0],0,V[2]],[0,V[1],V[2]]],X=m.projection.name==="globe",ee=m.scaleZoom(E),ae=o.bO.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,ee,!X),be=b.getCurrentCascadeFrustum();return ae.intersectsPrecise(q.vertices,q.planes,H)===0||be.intersectsPrecise(q.vertices,q.planes,H)===0}function Ts(f){return[f[0]*o.d4,f[1]*o.d4,f[2]*o.d4,0]}function Ei(f,r,l,m,b,S,E,z,V){const q=m.getSource(),H=l.globeSharedBuffers;if(!H)return;let X,ee,ae;if(r&&(X=m.getTile(r)),q instanceof o.aD?(ee=q.texture,ae=o.cD(0,0,l.transform)):X&&r&&(ee=X.texture,ae=o.cD(r.canonical.z,r.canonical.x,l.transform)),!ee||!ae)return;f||(ae=o.a6.mat4.scale(o.a6.mat4.create(),ae,[1,-1,1]));const be=l.context,ye=be.gl,Te=b.paint.get("raster-resampling")==="nearest"?ye.NEAREST:ye.LINEAR,Se=l.colorModeForDrapableLayerRenderPass(S),De=E.defines;De.push("GLOBE_POLES");const je=new bo(ye.LEQUAL,bo.ReadWrite,l.depthRangeFor3D),He=Float32Array.from(l.transform.expandedFarZProjMatrix),Ye=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),be.activeTexture.set(ye.TEXTURE0),ee.bind(Te,ye.CLAMP_TO_EDGE),be.activeTexture.set(ye.TEXTURE1),ee.bind(Te,ye.CLAMP_TO_EDGE),ee.useMipmap&&be.extTextureFilterAnisotropic&&l.transform.pitch>20&&ye.texParameterf(ye.TEXTURE_2D,be.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,be.extTextureFilterAnisotropicMax);const[tt,Xe,nt,lt]=r?H.getPoleBuffers(r.canonical.z,!1):H.getPoleBuffers(0,!0),vt=b.paint.get("raster-elevation");let dt;f?(dt=tt,l.renderDefaultNorthPole=vt!==0):(dt=Xe,l.renderDefaultSouthPole=vt!==0);const ct=Ts(E.mix),jt=((gn,An,Dn,It,pn,Xt,mn,wn,hn,Vn,fo,xo,ro)=>dp(gn,An,Dn,new Float32Array(16),new Float32Array(9),[0,0],It,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Xt,[0,0],wn,2,Vn,fo,xo,1,0,ro))(He,Ye,ae,o.a9(l.transform.zoom),0,b,0,vt,0,ct,E.offset,E.range,S),en=l.getOrCreateProgram("raster",{defines:De});l.uploadCommonUniforms(be,en,null),en.draw(l,ye.TRIANGLES,je,V,Se,z,jt,b.id,dt,nt,lt)}function gp(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),m=l-r,b=.2*f.height,S=r+b;return[r,l,(S-b-r)/m,(S-r)/m]}function kg(f,r,l,m){if(f)return r instanceof ms&&f instanceof uc?r.getTextureDescriptor(f,l,!0):{texture:f.texture,mix:Ts(m.mix),offset:m.offset,buffer:0,tileSize:1}}var gy=o.d5([{name:"a_index",type:"Int16",components:1}]);class vy{constructor(r,l,m,b){const S={width:m[0],height:m[1],data:null},E=r.gl;this.targetColorTexture=new o.T(r,S,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(r,S,E.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,b),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,b=l.width*l.height;this.particleTexture0=new o.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1});const S=new o.d6;S.reserve(b);for(let E=0;E<b;E++)S.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(S,gy.members,!0),this.particleSegment=o.b2.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=o.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function _y(f,r,l){if(!f)return null;const m=r.getTextureDescriptor(f,l,!0);if(!m)return null;let{texture:b,mix:S,offset:E,tileSize:z,buffer:V,format:q}=m;if(!b||!q)return null;let H=!1;return q==="uint32"&&(H=!0,S[3]=0,S=up(o.d7,S,[0,l.paint.get("raster-particle-max-speed")]),E=kd(o.d7,E,[0,l.paint.get("raster-particle-max-speed")])),{texture:b,textureOffset:[V/(z+2*V),z/(z+2*V)],tileSize:z,scalarData:H,scale:S,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[q]]}}function j1(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),m=l-r,b=.2*f.height,S=r+b;return[r,l,(S-b-r)/m,(S-r)/m]}const Rd=new o.bA(1,0,0,1),Ld=new o.bA(0,1,0,1),Rn=new o.bA(0,0,1,1),_o=new o.bA(1,0,1,1),Od=new o.bA(0,1,1,1);function ci(f,r,l,m,b,S,E){const z=f.context,V=f.transform,q=z.gl,H=V.projection.name==="globe",X=H?["PROJECTION_GLOBE_VIEW"]:[];let ee=o.a6.mat4.clone(l.projMatrix);if(H&&o.a9(V.zoom)>0){const ct=o.b5(l.canonical,V),jt=o.d8(ct);ee=o.a6.mat4.multiply(new Float32Array(16),V.globeMatrix,jt),o.a6.mat4.multiply(ee,V.projMatrix,ee)}const ae=o.a6.mat4.create();ae[12]+=2*b/(o.q.devicePixelRatio*V.width),ae[13]+=2*S/(o.q.devicePixelRatio*V.height),o.a6.mat4.multiply(ee,ae,ee);const be=f.getOrCreateProgram("debug",{defines:X}),ye=r.getTileByID(l.key);f.terrain&&f.terrain.setupElevationDraw(ye,be);const Te=bo.disabled,Se=Do.disabled,De=f.colorModeForRenderPass(),je="$debug";z.activeTexture.set(q.TEXTURE0),f.emptyTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),H?ye._makeGlobeTileDebugBuffers(f.context,V):ye._makeDebugTileBoundsBuffers(f.context,V.projection);const He=ye._tileDebugBuffer||f.debugBuffer,Ye=ye._tileDebugIndexBuffer||f.debugIndexBuffer,tt=ye._tileDebugSegments||f.debugSegments;if(be.draw(f,q.LINE_STRIP,Te,Se,De,Po.disabled,yg(ee,m),je,He,Ye,tt,null,null,null,[ye._globeTileDebugBorderBuffer]),E){const ct=ye.latestRawTileData,jt=Math.floor((ct&&ct.byteLength||0)/1024);let en=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(en+=` => ${l.overscaledZ}`),en+=` ${ye.state}`,en+=` ${jt}kb`,function(gn,An){gn.initDebugOverlayCanvas();const Dn=gn.debugOverlayCanvas,It=gn.context.gl,pn=gn.debugOverlayCanvas.getContext("2d");pn.clearRect(0,0,Dn.width,Dn.height),pn.shadowColor="white",pn.shadowBlur=2,pn.lineWidth=1.5,pn.strokeStyle="white",pn.textBaseline="top",pn.font="bold 36px Open Sans, sans-serif",pn.fillText(An,5,5),pn.strokeText(An,5,5),gn.debugOverlayTexture.update(Dn),gn.debugOverlayTexture.bind(It.LINEAR,It.CLAMP_TO_EDGE)}(f,en)}const Xe=r.getTile(l).tileSize,nt=512/Math.min(Xe,512)*(l.overscaledZ/V.zoom)*.5,lt=ye._tileDebugTextBuffer||f.debugBuffer,vt=ye._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,dt=ye._tileDebugTextSegments||f.debugSegments;be.draw(f,q.TRIANGLES,Te,Se,ir.alphaBlended,Po.disabled,yg(ee,o.bA.transparent,nt),je,lt,vt,dt,null,null,null,[ye._globeTileDebugTextBuffer])}function Ot(f,r,l,m){ju(f,0,r+l/2,f.transform.width,l,m)}function Pg(f,r,l,m){ju(f,r-l/2,0,l,f.transform.height,m)}function ju(f,r,l,m,b,S){const E=f.context,z=E.gl;z.enable(z.SCISSOR_TEST),z.scissor(r*o.q.devicePixelRatio,l*o.q.devicePixelRatio,m*o.q.devicePixelRatio,b*o.q.devicePixelRatio),E.clear({color:S}),z.disable(z.SCISSOR_TEST)}const Rg=o.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:vp}=Rg;function Cc(f,r,l,m){f.emplaceBack(r,l,m)}class Lg{constructor(r){this.vertexArray=new o.d9,this.indices=new o.aP,Cc(this.vertexArray,-1,-1,1),Cc(this.vertexArray,1,-1,1),Cc(this.vertexArray,-1,1,1),Cc(this.vertexArray,1,1,1),Cc(this.vertexArray,-1,-1,-1),Cc(this.vertexArray,1,-1,-1),Cc(this.vertexArray,-1,1,-1),Cc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,vp),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.b2.simpleSegment(0,0,36,12)}}function ml(f,r,l,m,b,S){const E=f.context.gl,z=r.paint.get("sky-atmosphere-color"),V=r.paint.get("sky-atmosphere-halo-color"),q=r.paint.get("sky-atmosphere-sun-intensity"),H=((X,ee,ae,be,ye)=>({u_matrix_3f:X,u_sun_direction:ee,u_sun_intensity:ae,u_color_tint_r:[be.r,be.g,be.b,be.a],u_color_tint_m:[ye.r,ye.g,ye.b,ye.a],u_luminance:5e-5}))(o.a6.mat3.fromMat4(o.a6.mat3.create(),m),b,q,z,V);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+S,r.skyboxTexture,0),l.draw(f,E.TRIANGLES,bo.disabled,Do.disabled,ir.unblended,Po.frontCW,H,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const H1=o.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class G1{constructor(r){const l=new o.da;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const m=new o.aP;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,H1.members),this.indexBuffer=r.createIndexBuffer(m),this.segments=o.b2.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const yy=o.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class _p{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Og{constructor(r){this.colorModeAlphaBlendedWriteRGB=new ir([1,Fa,1,Fa],o.bA.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ir([1,0,1,0],o.bA.transparent,[!1,!1,!1,!0]),this.params=new _p,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new G1(l);const m=this.params.sizeRange,b=this.params.intensityRange,S=function(H){const X=o.dd(30),ee=[];for(let ae=0;ae<H;++ae){const be=2*Math.PI*X(),ye=Math.acos(1-2*X())-.5*Math.PI;ee.push(o.a6.vec3.fromValues(Math.cos(ye)*Math.cos(be),Math.cos(ye)*Math.sin(be),Math.sin(ye)))}return ee}(this.params.starsCount),E=o.dd(300),z=new o.db,V=new o.aP;let q=0;for(let H=0;H<S.length;++H){const X=o.a6.vec3.scale([],S[H],200),ee=Math.max(0,1+.01*m*(1*E()-.5)),ae=Math.max(0,1+.01*b*(1*E()-.5));z.emplaceBack(X[0],X[1],X[2],-1,-1,ee,ae),z.emplaceBack(X[0],X[1],X[2],1,-1,ee,ae),z.emplaceBack(X[0],X[1],X[2],1,1,ee,ae),z.emplaceBack(X[0],X[1],X[2],-1,1,ee,ae),V.emplaceBack(q+0,q+1,q+2),V.emplaceBack(q+0,q+2,q+3),q+=4}this.starsVx=l.createVertexBuffer(z,yy.members),this.starsIdx=l.createIndexBuffer(V),this.starsSegments=o.b2.simpleSegment(0,0,z.length,V.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const m=r.context,b=m.gl,S=r.transform,E=new bo(b.LEQUAL,bo.ReadOnly,[0,1]),z=o.a9(S.zoom),V=r.style.getLut(l.scope),q=l.properties.get("color").toRenderColor(V).toArray01(),H=l.properties.get("high-color").toRenderColor(V).toArray01(),X=l.properties.get("space-color").toRenderColor(V).toArray01PremultipliedAlpha(),ee=5e-4,ae=o.dc(l.properties.get("horizon-blend"),0,1,ee,.25),be=o.cx(r,m,S)&&ae===ee?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,ye=r.frameCounter/1e3%1,Te=o.a6.vec3.length(S.globeCenterInViewSpace),Se=Math.sqrt(Math.pow(Te,2)-Math.pow(be,2)),De=Math.acos(Se/Te),je=He=>{const Ye=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];He&&Ye.push("ALPHA_PASS");const tt=r.getOrCreateProgram("globeAtmosphere",{defines:Ye}),Xe=((lt,vt,dt,ct,jt,en,gn,An,Dn,It,pn,Xt)=>({u_frustum_tl:lt,u_frustum_tr:vt,u_frustum_br:dt,u_frustum_bl:ct,u_horizon:jt,u_transition:en,u_fadeout_range:gn,u_color:An,u_high_color:Dn,u_space_color:It,u_temporal_offset:pn,u_horizon_angle:Xt}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,z,ae,q,H,X,ye,De);r.uploadCommonUniforms(m,tt);const nt=this.atmosphereBuffer;nt&&tt.draw(r,b.TRIANGLES,E,Do.disabled,He?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Po.backCW,Xe,He?"atmosphere_glow_alpha":"atmosphere_glow",nt.vertexBuffer,nt.indexBuffer,nt.segments)};je(!1),je(!0)}drawStars(r,l){const m=o.ap(l.properties.get("star-intensity"),0,1);if(m===0)return;const b=r.context,S=b.gl,E=r.transform,z=r.getOrCreateProgram("stars"),V=o.a6.quat.identity([]);o.a6.quat.rotateX(V,V,-E._pitch),o.a6.quat.rotateZ(V,V,-E.angle),o.a6.quat.rotateX(V,V,o.bC(E._center.lat)),o.a6.quat.rotateY(V,V,-o.bC(E._center.lng));const q=o.a6.mat4.fromQuat(new Float32Array(16),V),H=o.a6.mat4.multiply([],E.starsProjMatrix,q),X=o.a6.mat3.fromMat4([],q),ee=o.a6.mat3.invert([],X),ae=[0,1,0];o.a6.vec3.transformMat3(ae,ae,ee),o.a6.vec3.scale(ae,ae,this.params.sizeMultiplier);const be=[1,0,0];o.a6.vec3.transformMat3(be,be,ee),o.a6.vec3.scale(be,be,this.params.sizeMultiplier);const ye=(Te=ae,Se=be,De=m,{u_matrix:Float32Array.from(H),u_up:Te,u_right:Se,u_intensity_multiplier:De});var Te,Se,De;r.uploadCommonUniforms(b,z),this.starsVx&&this.starsIdx&&z.draw(r,S.TRIANGLES,bo.disabled,Do.disabled,this.colorModeAlphaBlendedWriteRGB,Po.disabled,ye,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Dg(f,r){const l=[...f],m=r.cameraWorldSizeForFog/r.worldSize,b=o.a6.mat4.identity([]);return o.a6.mat4.scale(b,b,[m,m,1]),o.a6.mat4.multiply(l,b,l),o.a6.mat4.multiply(l,r.worldToFogMatrix,l),l}function yp(f,r,l,m,b){const S=l.material,E=m.context,{baseColorTexture:z,metallicRoughnessTexture:V}=S.pbrMetallicRoughness,{normalTexture:q,occlusionTexture:H,emissionTexture:X}=S;function ee(be,ye,Te){if(be&&(f.push(ye),E.activeTexture.set(E.gl.TEXTURE0+Te),be.gfxTexture)){const{minFilter:Se,magFilter:De,wrapS:je,wrapT:He}=be.sampler;be.gfxTexture.bindExtraParam(Se,De,je,He)}}ee(z,"HAS_TEXTURE_u_baseColorTexture",ua.BaseColor),ee(V,"HAS_TEXTURE_u_metallicRoughnessTexture",ua.MetallicRoughness),ee(q,"HAS_TEXTURE_u_normalTexture",ua.Normal),ee(H,"HAS_TEXTURE_u_occlusionTexture",ua.Occlusion),ee(X,"HAS_TEXTURE_u_emissionTexture",ua.Emission),b&&(b.texture||(b.texture=new o.df(m.context,b.image,[b.image.height,b.image.height,b.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+ua.LUT),b.texture&&b.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(f.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),S.alphaMode!=="OPAQUE"&&S.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||f.push("DIFFUSE_SHADED"),f.push("USE_STANDARD_DERIVATIVES");const ae=m.shadowRenderer;ae&&(f.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&f.push("NORMAL_OFFSET"))}function Hu(f,r,l,m,b,S){const E=l.paint.get("model-opacity"),z=r.context,V=new bo(r.context.gl.LEQUAL,bo.ReadWrite,r.depthRangeFor3D),q=r.transform,H=f.mesh,X=H.material,ee=X.pbrMetallicRoughness,ae=r.style.fog;let be;be=r.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:o.a6.mat4.multiply([],m.zScaleMatrix,f.nodeModelMatrix),o.a6.mat4.multiply(be,m.negCameraPosMatrix,be);const ye=o.a6.mat4.invert([],be);o.a6.mat4.transpose(ye,ye);const Te=l.paint.get("model-emissive-strength").constantOr(0),Se=pp(new Float32Array(f.worldViewProjection),new Float32Array(be),new Float32Array(ye),null,r,E,ee.baseColorFactor.toRenderColor(null),X.emissiveFactor,ee.metallicFactor,ee.roughnessFactor,X,Te,l),De={defines:[]},je=[],He=r.shadowRenderer;He&&(He.useNormalOffset=!1),yp(De.defines,je,H,r,l.lut);let Ye=null;if(ae){const nt=Dg(f.nodeModelMatrix,r.transform);if(Ye=new Float32Array(nt),q.projection.name!=="globe"){const lt=H.aabb.min,vt=H.aabb.max,[dt,ct]=ae.getOpacityForBounds(nt,lt[0],lt[1],vt[0],vt[1]);De.overrideFog=dt>=gt||ct>=gt}}const tt=Aa(r,l.paint.get("model-cutoff-fade-range"));tt.shouldRenderCutoff&&De.defines.push("RENDER_CUTOFF");const Xe=r.getOrCreateProgram("model",De);r.uploadCommonUniforms(z,Xe,null,Ye,tt),r.renderPass!=="shadow"&&He&&He.setupShadowsFromMatrix(f.nodeModelMatrix,Xe),Xe.draw(r,z.gl.TRIANGLES,V,b,S,H.material.doubleSided?Po.disabled:Po.backCCW,Se,l.id,H.vertexBuffer,H.indexBuffer,H.segments,l.paint,r.transform.zoom,void 0,je)}function Xh(f,r,l,m,b,S,E){let z;z=f.projection.name==="globe"?o.dg(l,f):[...l],o.a6.mat4.multiply(z,z,r.matrix);const V=o.a6.mat4.multiply([],m,z);if(r.meshes)for(const q of r.meshes){if(q.material.alphaMode!=="BLEND"){E.push({mesh:q,depth:0,modelIndex:b,worldViewProjection:V,nodeModelMatrix:z});continue}const H=o.a6.vec3.transformMat4([],q.centroid,V);H[2]>0&&S.push({mesh:q,depth:H[2],modelIndex:b,worldViewProjection:V,nodeModelMatrix:z})}if(r.children)for(const q of r.children)Xh(f,q,l,m,b,S,E)}function bp(f,r,l,m){const b=l.shadowRenderer;if(!b)return;const S=b.getShadowPassDepthMode(),E=b.getShadowPassColorMode(),z=b.calculateShadowPassMatrixFromMatrix(r),V=Sg(z);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,S,Do.disabled,E,Po.backCCW,V,m.id,f.vertexBuffer,f.indexBuffer,f.segments,m.paint,l.transform.zoom,void 0,void 0)}function by(f,r,l){const m=r.updateZoomBasedPaintProperties(),b=function(S,E,z){let V,q,H,X=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&X>0){const ee=S.terrain,ae=ee.findDEMTileFor(z);ae&&ae.dem?V=o.di.create(ee,z,ae):X=0}if(X===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),X===E.validForExaggeration&&(X===0||V&&V._demTile&&V._demTile.tileID===E.validForDEMTile.id&&V._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const ee in E.instancesPerModel){const ae=E.instancesPerModel[ee];for(let be=0;be<ae.instancedDataArray.length;++be){const ye=(V?X*V.getElevationAt(0|ae.instancedDataArray.float32[16*be],0|ae.instancedDataArray.float32[16*be+1],!0,!0):0)+ae.instancesEvaluatedElevation[be];ae.instancedDataArray.float32[16*be+6]=ye,q=q?Math.min(E.terrainElevationMin,ye):ye,H=H?Math.max(E.terrainElevationMax,ye):ye}}return E.terrainElevationMin=q||0,E.terrainElevationMax=H||0,E.validForExaggeration=X,E.validForDEMTile=V&&V._demTile?{id:V._demTile.tileID,timestamp:V._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,r,l);(m||b)&&(r.uploaded=!1,r.upload(f.context))}const Vl={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.ca([0,0,0],[o.ab,o.ab,0])};function Va(f,r){const l=1<<f.canonical.z,m=r.getFreeCameraOptions().position,b=r.elevation,S=f.canonical.x/l,E=(f.canonical.x+1)/l,z=f.canonical.y/l,V=(f.canonical.y+1)/l;let q=r._centerAltitude;if(b){const ae=b.getMinMaxForTile(f);ae&&ae.max>q&&(q=ae.max)}const H=o.ap(m.x,S,E)-m.x,X=o.ap(m.y,z,V)-m.y,ee=o.bE(q,r.center.lat)-m.z;return r._zoomFromMercatorZ(Math.sqrt(H*H+X*X+ee*ee))}function xy(f,r,l,m,b,S,E){const z=f.context,V=f.renderPass==="shadow",q=f.shadowRenderer,H=V&&q?q.getShadowPassDepthMode():new bo(z.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D),X=f.isTileAffectedByFog(S);if(l.meshes)for(const ee of l.meshes){const ae=["MODEL_POSITION_ON_GPU"],be=[];let ye,Te,Se;m.instancedDataArray.length>20&&ae.push("INSTANCED_ARRAYS");const De=Aa(f,r.paint.get("model-cutoff-fade-range"));if(De.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),V&&q)ye=f.getOrCreateProgram("modelDepth",{defines:ae}),Te=Sg(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(l.matrix)),Se=q.getShadowPassColorMode();else{yp(ae,be,ee,f,r.lut),ye=f.getOrCreateProgram("model",{defines:ae,overrideFog:X});const He=ee.material,Ye=He.pbrMetallicRoughness,tt=r.paint.get("model-opacity"),Xe=r.paint.get("model-emissive-strength").constantOr(0);Te=pp(S.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,f,tt,Ye.baseColorFactor.toRenderColor(null),He.emissiveFactor,Ye.metallicFactor,Ye.roughnessFactor,He,Xe,r,b),q&&(E.shadowUniformsInitialized?ye.setShadowUniformValues(z,q.getShadowUniformValues()):(q.setupShadows(S.toUnwrapped(),ye,"model-tile",S.overscaledZ),E.shadowUniformsInitialized=!0)),Se=De.shouldRenderCutoff||tt<1||He.alphaMode!=="OPAQUE"?ir.alphaBlended:ir.unblended}f.uploadCommonUniforms(z,ye,S.toUnwrapped(),null,De);const je=ee.material.doubleSided?Po.disabled:Po.backCCW;if(m.instancedDataArray.length>20)be.push(m.instancedDataBuffer),ye.draw(f,z.gl.TRIANGLES,H,Do.disabled,Se,je,Te,r.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,r.paint,f.transform.zoom,void 0,be,m.instancedDataArray.length);else{const He=V?"u_instance":"u_normal_matrix";for(let Ye=0;Ye<m.instancedDataArray.length;++Ye)Te[He]=new Float32Array(m.instancedDataArray.arrayBuffer,64*Ye,16),ye.draw(f,z.gl.TRIANGLES,H,Do.disabled,Se,je,Te,r.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,r.paint,f.transform.zoom,void 0,be)}}if(l.children)for(const ee of l.children)xy(f,r,ee,m,b,S,E)}const Jh=[1,-1,1];function ui(f,r,l,m){if(!l.modelManager)return!0;const b=l.modelManager;if(!l.shadowRenderer)return!0;const S=l.shadowRenderer,E=r.aabb;let z=!0,V=f.maxHeight;if(V===0){let H=0;for(const X in f.instancesPerModel){const ee=b.getModel(X,m);ee?H=Math.max(H,Math.max(Math.max(ee.aabb.max[0],ee.aabb.max[1]),ee.aabb.max[2])):z=!1}V=f.maxScale*H*1.41+f.maxVerticalOffset,z&&(f.maxHeight=V)}E.max[2]=V,E.min[2]+=f.terrainElevationMin,E.max[2]+=f.terrainElevationMax,o.a6.vec3.transformMat4(E.min,E.min,r.tileMatrix),o.a6.vec3.transformMat4(E.max,E.max,r.tileMatrix);const q=E.intersects(S.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=q===2),q===0}function Mr(f,r){const l=f.uniformValues.u_cutoff_params[0],m=f.uniformValues.u_cutoff_params[1],b=f.uniformValues.u_cutoff_params[2],S=f.uniformValues.u_cutoff_params[3];return m===l||S===b?1:o.ap(((r-l)/(m-l)-b)/(S-b),0,1)}function wy(f,r,l,m){if(r.pitch<20)return 1;const b=r.getWorldToCameraMatrix();o.a6.mat4.multiply(b,b,f);const S=o.a6.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),z=E,V=E;S[1]=l.max[1],E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),z=E[1]<z[1]?E:z,V=E[1]>V[1]?E:V,S[0]=l.max[0],E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),z=E[1]<z[1]?E:z,V=E[1]>V[1]?E:V,S[1]=l.min[1],E=o.a6.vec4.transformMat4(o.a6.vec4.create(),S,b),z=E[1]<z[1]?E:z,V=E[1]>V[1]?E:V;const q=o.ap(m[0],0,1),H=100*r.pixelsPerMeter*o.ap(m[1],0,1),X=o.ap(m[2],0,1),ee=o.a6.vec4.lerp(o.a6.vec4.create(),z,V,q),ae=Math.tan(.5*r.fovX),be=-ee[2]*ae;if(H===0)return ee[1]<-Math.abs(be)?X:1;const ye=(-Math.abs(be)-ee[1])/H,Te=(De,je,He)=>(1-He)*De+He*je,Se=o.ap(Te(1,X,ye),X,1);return Te(1,Se,o.ap((r.pitch-20)/20,0,1))}class fu{}class xp{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,m){{const X=this._storage.get(l.id);if(X)return X.lastUsedFrameIdx=r,X.buf}const b=m.gl,S=b.getBufferParameter(b.ELEMENT_ARRAY_BUFFER,b.BUFFER_SIZE),E=new ArrayBuffer(S),z=new Int16Array(E);b.getBufferSubData(b.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const V=new o.dk;for(let X=0;X<S/2;X+=3){const ee=z[X],ae=z[X+1],be=z[X+2];V.emplaceBack(ee,ae),V.emplaceBack(ae,be),V.emplaceBack(be,ee)}const q=m.bindVertexArrayOES.current,H=new fu;return H.buf=new os(m,V),H.lastUsedFrameIdx=r,this._storage.set(l.id,H),m.bindVertexArrayOES.set(q),H.buf}update(r){for(const[l,m]of this._storage)r-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class Dd{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}class zg{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Qh={symbol:function(f,r,l,m,b){if(f.renderPass!=="translucent")return;const S=Do.disabled,E=f.colorModeForRenderPass(),z=l.layout.get("text-variable-anchor"),V=l.layout.get("text-size-scale-range"),q=o.ap(f.scaleFactor,V[0],V[1]);z&&function(ee,ae,be,ye,Te,Se,De,je){const He=ae.transform,Ye=Te==="map",tt=Se==="map";for(const Xe of ee){const nt=ye.getTile(Xe),lt=nt.getBucket(be);if(!lt||!lt.text||!lt.text.segments.get().length)continue;const vt=o.bk(lt.textSizeData,He.zoom,je),dt=Il(Xe,lt.getProjection(),He),ct=He.calculatePixelsToTileUnitsMatrix(nt),jt=fr(dt,nt.tileID.canonical,tt,Ye,He,lt.getProjection(),ct),en=lt.hasIconTextFit()&&lt.hasIconData();if(vt){const gn=Math.pow(2,He.zoom-nt.tileID.overscaledZ);Eg(lt,Ye,tt,De,o.cS,He,jt,Xe,gn,vt,en)}}}(m,f,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),b,q);const H=l.paint.get("icon-opacity").constantOr(1)!==0,X=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(H||X)?Zh(f,r,l,m,S,E):(H&&Zh(f,r,l,m,S,E,{onlyIcons:!0}),X&&Zh(f,r,l,m,S,E,{onlyText:!0})),r.map.showCollisionBoxes&&(Cg(f,r,l,m,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Cg(f,r,l,m,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,l,m){if(f.renderPass!=="translucent")return;const b=l.paint.get("circle-opacity"),S=l.paint.get("circle-stroke-width"),E=l.paint.get("circle-stroke-opacity"),z=l.layout.get("circle-sort-key").constantOr(1)!==void 0,V=l.paint.get("circle-emissive-strength");if(b.constantOr(1)===0&&(S.constantOr(1)===0||E.constantOr(1)===0))return;const q=f.context,H=q.gl,X=f.transform,ee=f.depthModeForSublayer(0,bo.ReadOnly),ae=Do.disabled,be=f.colorModeForDrapableLayerRenderPass(V),ye=X.projection.name==="globe",Te=[o.am(X.center.lng),o.at(X.center.lat)],Se=[];for(let je=0;je<m.length;je++){const He=m[je],Ye=r.getTile(He),tt=Ye.getBucket(l);if(!tt||tt.projection.name!==X.projection.name)continue;const Xe=tt.programConfigurations.get(l.id),nt=o.cT(l),lt=f.isTileAffectedByFog(He);ye&&nt.push("PROJECTION_GLOBE_VIEW"),nt.push("DEPTH_D24"),f.terrain&&X.depthOcclusionForSymbolsAndCircles&&nt.push("DEPTH_OCCLUSION");const vt=f.getOrCreateProgram("circle",{config:Xe,defines:nt,overrideFog:lt}),dt=tt.layoutVertexBuffer,ct=tt.globeExtVertexBuffer,jt=tt.indexBuffer,en=X.projection.createInversionMatrix(X,He.canonical),gn={programConfiguration:Xe,program:vt,layoutVertexBuffer:dt,globeExtVertexBuffer:ct,indexBuffer:jt,uniformValues:o.cU(f,He,Ye,en,Te,l),tile:Ye};if(z){const An=tt.segments.get();for(const Dn of An)Se.push({segments:new o.b2([Dn]),sortKey:Dn.sortKey,state:gn})}else Se.push({segments:tt.segments,sortKey:0,state:gn})}z&&Se.sort((je,He)=>je.sortKey-He.sortKey);const De={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const je of Se){const{programConfiguration:He,program:Ye,layoutVertexBuffer:tt,globeExtVertexBuffer:Xe,indexBuffer:nt,uniformValues:lt,tile:vt}=je.state,dt=je.segments;f.terrain&&f.terrain.setupElevationDraw(vt,Ye,De),f.uploadCommonUniforms(q,Ye,vt.tileID.toUnwrapped()),Ye.draw(f,H.TRIANGLES,ee,ae,be,Po.disabled,lt,l.id,tt,nt,dt,l.paint,X.zoom,He,[Xe])}},heatmap:function(f,r,l,m){if(l.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const b=f.context,S=b.gl,E=Do.disabled,z=new ir([S.ONE,S.ONE,S.ONE,S.ONE],o.bA.transparent,[!0,!0,!0,!0]);(function(ae,be,ye,Te){const Se=ae.gl,De=be.width*Te,je=be.height*Te;ae.activeTexture.set(Se.TEXTURE1),ae.viewport.set([0,0,De,je]);let He=ye.heatmapFbo;if(!He||He&&(He.width!==De||He.height!==je)){He&&He.destroy();const Ye=Se.createTexture();Se.bindTexture(Se.TEXTURE_2D,Ye),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_S,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_T,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MIN_FILTER,Se.LINEAR),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MAG_FILTER,Se.LINEAR),He=ye.heatmapFbo=ae.createFramebuffer(De,je,!0,null),function(tt,Xe,nt,lt,vt,dt){const ct=tt.gl;ct.texImage2D(ct.TEXTURE_2D,0,tt.extRenderToTextureHalfFloat?ct.RGBA16F:ct.RGBA,vt,dt,0,ct.RGBA,tt.extRenderToTextureHalfFloat?ct.HALF_FLOAT:ct.UNSIGNED_BYTE,null),lt.colorAttachment.set(nt)}(ae,0,Ye,He,De,je)}else Se.bindTexture(Se.TEXTURE_2D,He.colorAttachment.get()),ae.bindFramebuffer.set(He.framebuffer)})(b,f,l,f.transform.projection.name==="globe"?.5:.25),b.clear({color:o.bA.transparent});const V=f.transform,q=V.projection.name==="globe",H=q?["PROJECTION_GLOBE_VIEW"]:[],X=q?Po.frontCCW:Po.disabled,ee=[o.am(V.center.lng),o.at(V.center.lat)];for(let ae=0;ae<m.length;ae++){const be=m[ae];if(r.hasRenderableParent(be))continue;const ye=r.getTile(be),Te=ye.getBucket(l);if(!Te||Te.projection.name!==V.projection.name)continue;const Se=f.isTileAffectedByFog(be),De=Te.programConfigurations.get(l.id),je=f.getOrCreateProgram("heatmap",{config:De,defines:H,overrideFog:Se}),{zoom:He}=f.transform;f.terrain&&f.terrain.setupElevationDraw(ye,je),f.uploadCommonUniforms(b,je,be.toUnwrapped());const Ye=V.projection.createInversionMatrix(V,be.canonical);je.draw(f,S.TRIANGLES,bo.disabled,E,z,X,bg(f,be,ye,Ye,ee,He,l.paint.get("heatmap-intensity")),l.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,l.paint,f.transform.zoom,De,q?[Te.globeExtVertexBuffer]:null)}b.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(b,S){const E=b.context,z=E.gl,V=S.heatmapFbo;if(!V)return;E.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,V.colorAttachment.get()),E.activeTexture.set(z.TEXTURE1);let q=S.colorRampTexture;q||(q=S.colorRampTexture=new o.T(E,S.colorRamp,z.RGBA8)),q.bind(z.LINEAR,z.CLAMP_TO_EDGE),b.getOrCreateProgram("heatmapTexture").draw(b,z.TRIANGLES,bo.disabled,Do.disabled,b.colorModeForRenderPass(),Po.disabled,((H,X,ee,ae)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,S),S.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,S.paint,b.transform.zoom)}(f,l))},line:function(f,r,l,m){if(f.renderPass!=="translucent")return;const b=l.paint.get("line-opacity"),S=l.paint.get("line-width");if(b.constantOr(1)===0||S.constantOr(1)===0)return;const E=l.paint.get("line-emissive-strength"),z=l.paint.get("line-occlusion-opacity"),V=l.layout.get("line-elevation-reference")==="sea",q=f.context,H=q.gl,X=!l.isDraped();if(X&&f.transform.projection.name==="globe")return;const ee=l.layout.get("line-cross-slope"),ae=ee!==void 0,be=ee<1,ye=X?new bo(f.depthOcclusion?H.GREATER:H.LEQUAL,bo.ReadOnly,f.depthRangeFor3D):f.depthModeForSublayer(0,bo.ReadOnly),Te=f.colorModeForDrapableLayerRenderPass(E),Se=f.terrain&&f.terrain.renderingToTexture,De=Se?1:o.q.devicePixelRatio,je=l.paint.get("line-dasharray"),He=je.constantOr(1),Ye=l.layout.get("line-cap"),tt=je.constantOr(null),Xe=Ye.constantOr(null),nt=l.paint.get("line-pattern"),lt=nt.constantOr(1),vt=nt.constantOr(null),dt=l.paint.get("line-opacity").constantOr(1);let ct=!lt&&dt!==1||f.depthOcclusion&&z>0&&z<1;const jt=l.paint.get("line-gradient"),en=lt?"linePattern":"line",gn=o.cV(l);let An;if(Se&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ct=!1),z!==0&&f.depthOcclusion){const It=l.paint._values["line-opacity"];It&&It.value&&It.value.kind==="constant"?An=It.value:o.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}if(X&&(f.forceTerrainMode=!0),!X&&z!==0&&f.terrain&&!Se)return void o.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`);const Dn=ct&&X?f.stencilModeFor3D():Do.disabled;X&&(gn.push("ELEVATED"),ae&&gn.push(be?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),V&&gn.push("ELEVATION_REFERENCE_SEA"));for(const It of m){const pn=r.getTile(It);if(lt&&!pn.patternsLoaded())continue;const Xt=pn.getBucket(l);if(!Xt)continue;f.prepareDrawTile();const mn=Xt.programConfigurations.get(l.id),wn=f.isTileAffectedByFog(It),hn=f.getOrCreateProgram(en,{config:mn,defines:gn,overrideFog:wn,overrideRtt:!X&&void 0});if(vt&&pn.imageAtlas){const Wn=pn.imageAtlas.patternPositions[vt.toString()];Wn&&mn.setConstantPatternPositions(Wn)}if(!lt&&tt&&Xe&&pn.lineAtlas){const Wn=pn.lineAtlas.getDash(tt,Xe);Wn&&mn.setConstantPatternPositions(Wn)}let[Vn,fo]=l.paint.get("line-trim-offset");(Xe==="round"||Xe==="square")&&Vn!==fo&&(Vn===0&&(Vn-=1),fo===1&&(fo+=1));const xo=Se?It.projMatrix:null,ro=lt?o.cW(f,pn,l,xo,De,[Vn,fo]):o.cX(f,pn,l,xo,Xt.lineClipsArray.length,De,[Vn,fo]);if(jt){const Wn=Xt.gradients[l.id];let Ro=Wn.texture;if(l.gradientVersion!==Wn.version){let Ko=256;if(l.stepInterpolant){const mr=r.getSource().maxzoom,Kr=It.canonical.z===mr?Math.ceil(1<<f.transform.maxZoom-It.canonical.z):1;Ko=o.ap(o.cY(Xt.maxLineLength/o.ab*1024*Kr),256,q.maxTextureSize)}Wn.gradient=o.cZ({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Ko,image:Wn.gradient||void 0,clips:Xt.lineClipsArray}),Wn.texture?Wn.texture.update(Wn.gradient):Wn.texture=new o.T(q,Wn.gradient,H.RGBA8),Wn.version=l.gradientVersion,Ro=Wn.texture}q.activeTexture.set(H.TEXTURE1),Ro.bind(l.stepInterpolant?H.NEAREST:H.LINEAR,H.CLAMP_TO_EDGE)}He&&(q.activeTexture.set(H.TEXTURE0),pn.lineAtlasTexture&&pn.lineAtlasTexture.bind(H.LINEAR,H.REPEAT),mn.updatePaintBuffers()),lt&&(q.activeTexture.set(H.TEXTURE0),pn.imageAtlasTexture&&pn.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),mn.updatePaintBuffers()),X&&!V&&f.terrain.setupElevationDraw(pn,hn),f.uploadCommonUniforms(q,hn,It.toUnwrapped());const So=Wn=>{An!=null&&(An.value=dt*z),hn.draw(f,H.TRIANGLES,ye,Wn,Te,Po.disabled,ro,l.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,l.paint,f.transform.zoom,mn,[Xt.layoutVertexBuffer2,Xt.patternVertexBuffer,Xt.zOffsetVertexBuffer]),An!=null&&(An.value=dt)};if(ct&&!X){const Wn=f.stencilModeForClipping(It).ref;Wn===0&&Se&&q.clear({stencil:0});const Ro={func:H.EQUAL,mask:255};ro.u_alpha_discard_threshold=.8,So(new Do(Ro,Wn,255,H.KEEP,H.KEEP,H.INVERT)),ro.u_alpha_discard_threshold=0,So(new Do(Ro,Wn,255,H.KEEP,H.KEEP,H.KEEP))}else ct&&X&&(ro.u_alpha_discard_threshold=.001),So(X?Dn:f.stencilModeForClipping(It))}X&&(f.forceTerrainMode=!1),ct&&(f.resetStencilClippingMasks(),Se&&q.clear({stencil:0})),z===0||f.depthOcclusion||Se||f.layersWithOcclusionOpacity.push(f.currentLayer)},fill:function(f,r,l,m){const b=l.paint.get("fill-color"),S=l.paint.get("fill-opacity"),E=l.is3D(),z=new bo(f.context.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D);if(S.constantOr(1)===0)return;const V=l.paint.get("fill-emissive-strength"),q=f.colorModeForDrapableLayerRenderPass(V),H=l.paint.get("fill-pattern"),X=f.opaquePassEnabledForLayer()&&!H.constantOr(1)&&b.constantOr(o.bA.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===X){const ee=E?z:f.depthModeForSublayer(1,f.renderPass==="opaque"?bo.ReadWrite:bo.ReadOnly);mp(f,r,l,m,ee,q,!1)}if(!E&&f.renderPass==="translucent"&&l.paint.get("fill-antialias")){const ee=E?z:f.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,bo.ReadOnly);mp(f,r,l,m,ee,q,!0)}},"fill-extrusion":function(f,r,l,m){const b=l.paint.get("fill-extrusion-opacity"),S=f.context,E=S.gl,z=f.terrain,V=z&&z.renderingToTexture;if(b===0)return;const q=f.conflationActive&&f.style.isLayerClipped(l,r.getSource()),H=f.style.order.indexOf(l.fqid);if(q&&function(X,ee,ae,be,ye){for(const Te of be){const Se=ee.getTile(Te).getBucket(ae);Se&&(Se.updateReplacement(Te,X.replacementSource,ye),Se.uploadCentroid(X.context))}}(f,r,l,m,H),z||q)for(const X of m){const ee=r.getTile(X).getBucket(l);ee&&py(f.context,r,X,ee,l,z,q)}if(f.renderPass==="shadow"&&f.shadowRenderer){const X=f.shadowRenderer;if(z&&b<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.a4)return;const ee=X.getShadowPassDepthMode(),ae=X.getShadowPassColorMode();_a(f,r,l,m,ee,Do.disabled,ae,q)}else if(f.renderPass==="translucent"){const X=!l.paint.get("fill-extrusion-pattern").constantOr(1),ee=l.paint.get("fill-extrusion-color").constantOr(o.bA.white);if(!V&&ee.a!==0){const ae=new bo(f.context.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D);b===1&&X?_a(f,r,l,m,ae,Do.disabled,ir.unblended,q):(_a(f,r,l,m,ae,Do.disabled,ir.disabled,q),_a(f,r,l,m,ae,f.stencilModeFor3D(),f.colorModeForRenderPass(),q),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&X&&(!z&&f.transform.projection.name!=="globe"||V)){const ae=l.paint.get("fill-extrusion-opacity"),be=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),ye=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Te=l.paint.get("fill-extrusion-flood-light-intensity"),Se=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),De=be>0&&ye>0,je=Te>0,He=(tt,Xe,nt)=>(1-nt)*tt+nt*Xe,Ye=tt=>{const Xe=f.depthModeForSublayer(1,bo.ReadOnly,E.LEQUAL,!0),nt=l.paint.get(tt?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),lt=He(.1,3,nt),vt=f._showOverdrawInspector;if(!vt){const dt=new Do({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),ct=new ir([E.ONE,E.ONE,E.ONE,E.ONE],o.bA.transparent,[!1,!1,!1,!0],E.MIN);Ss(f,r,l,m,Xe,dt,ct,Po.disabled,tt,"sdf",ae,be,ye,Te,Se,lt,q,!1)}{const dt=vt?Do.disabled:new Do({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),ct=vt?f.colorModeForRenderPass():new ir([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],o.bA.transparent,[!0,!0,!0,!0]);Ss(f,r,l,m,Xe,dt,ct,Po.disabled,tt,"color",ae,be,ye,Te,Se,lt,q,!1)}};if(V){const tt=(Xe,nt,lt)=>{const vt=f.depthModeForSublayer(1,bo.ReadOnly,E.LEQUAL,!1),dt=l.paint.get(Xe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ct=He(.1,3,dt);{const jt=new ir([E.ONE,E.ONE,E.ONE,E.ONE],o.bA.transparent,[!1,!1,!1,!0]);Ss(f,r,l,m,vt,Do.disabled,jt,Po.disabled,Xe,"clear",ae,be,ye,Te,Se,ct,q,nt)}{const jt=new Do({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),en=new ir([E.ONE,E.ONE,E.ONE,E.ONE],o.bA.transparent,[!1,!1,!1,!0],E.MIN);Ss(f,r,l,m,vt,jt,en,Po.disabled,Xe,"sdf",ae,be,ye,Te,Se,ct,q,nt)}{const jt=Xe?E.ZERO:E.ONE_MINUS_DST_ALPHA,en=new Do({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),gn=new ir([jt,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],o.bA.transparent,[!0,!0,!0,!0]);Ss(f,r,l,m,vt,en,gn,Po.disabled,Xe,"color",ae,be,ye,Te,Se,ct,q,nt)}{const jt=new ir([E.ONE,E.ONE,E.ONE,Xe?E.ZERO:E.ONE],o.bA.transparent,[!1,!1,!1,!0],Xe?E.FUNC_ADD:E.MAX);Ss(f,r,l,m,vt,Do.disabled,jt,Po.disabled,Xe,"clear",ae,be,ye,Te,Se,ct,q,nt,lt)}};if(De||je){let Xe;if(f.prepareDrawTile(),z){const nt=z.drapeBufferSize[0],lt=z.drapeBufferSize[1];Xe=z.framebufferCopyTexture,Xe&&(!Xe||Xe.size[0]===nt&&Xe.size[1]===lt)||(Xe&&Xe.destroy(),Xe=z.framebufferCopyTexture=new o.T(S,new o.r({width:nt,height:lt}),E.RGBA8)),Xe.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,nt,lt)}De&&tt(!0,!1,Xe),je&&tt(!1,!0,Xe)}}else De&&Ye(!0),je&&Ye(!1),(De||je)&&f.resetStencilClippingMasks()}}},hillshade:function(f,r,l,m){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const b=f.context,S=f.terrain&&f.terrain.renderingToTexture,[E,z]=f.renderPass!=="translucent"||S?[{},m]:f.stencilConfigForOverlap(m);for(const V of z){const q=r.getTile(V);if(q.needsHillshadePrepare&&f.renderPass==="offscreen")$a(f,q,l);else if(f.renderPass==="translucent"){const H=f.depthModeForSublayer(0,bo.ReadOnly),X=l.paint.get("hillshade-emissive-strength"),ee=f.colorModeForDrapableLayerRenderPass(X),ae=S&&f.terrain?f.terrain.stencilModeForRTTOverlap(V):E[V.overscaledZ];ri(f,V,q,l,H,ae,ee)}}b.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,l,m,b,S){if(f.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const E=f.transform.projection.name==="globe",z=l.paint.get("raster-elevation")!==0,V=z&&E;if(f.renderElevatedRasterBackface&&!V)return;const q=f.context,H=q.gl,X=r.getSource(),ee=function(tt,Xe,nt,lt){const vt=Xe.paint.get("raster-color"),dt=tt.type==="raster-array",ct=[],jt=Xe.paint.get("raster-resampling"),en=Xe.paint.get("raster-color-mix");let gn=Xe.paint.get("raster-color-range");const An=[en[0],en[1],en[2],0],Dn=en[3];let It=jt==="nearest"?lt.NEAREST:lt.LINEAR;if(dt&&(ct.push("RASTER_ARRAY"),vt||ct.push("RASTER_COLOR"),jt==="linear"&&ct.push("RASTER_ARRAY_LINEAR"),It=lt.NEAREST,!gn&&tt.rasterLayers)){const pn=tt.rasterLayers.find(({id:Xt})=>Xt===Xe.sourceLayer);pn&&pn.fields&&pn.fields.range&&(gn=pn.fields.range)}if(gn=gn||[0,1],vt){ct.push("RASTER_COLOR"),nt.activeTexture.set(lt.TEXTURE2),Xe.updateColorRamp(gn);let pn=Xe.colorRampTexture;pn||(pn=Xe.colorRampTexture=new o.T(nt,Xe.colorRamp,lt.RGBA8)),pn.bind(lt.LINEAR,lt.CLAMP_TO_EDGE)}return{mix:An,range:gn,offset:Dn,defines:ct,resampling:It}}(X,l,q,H);if(X instanceof o.aD&&!m.length&&!E)return;const ae=l.paint.get("raster-emissive-strength"),be=f.colorModeForDrapableLayerRenderPass(ae),ye=f.terrain&&f.terrain.renderingToTexture,Te=!f.options.moving,Se=l.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;if(X instanceof o.aD&&!m.length&&(X.onNorthPole||X.onSouthPole)){const tt=z?f.stencilModeFor3D():Do.disabled;return void Ei(!!X.onNorthPole,null,f,r,l,ae,ee,Po.disabled,tt)}if(!m.length)return;const[De,je]=X instanceof o.aD||ye?[{},m]:f.stencilConfigForOverlap(m),He=je[je.length-1].overscaledZ;V&&ee.defines.push("PROJECTION_GLOBE_VIEW"),z&&ee.defines.push("RENDER_CUTOFF");const Ye=(tt,Xe,nt)=>{for(const lt of tt){const vt=lt.toUnwrapped(),dt=r.getTile(lt);if(ye&&(!dt||!dt.hasData()))continue;q.activeTexture.set(H.TEXTURE0);const ct=kg(dt,X,l,ee);if(!ct||!ct.texture)continue;const{texture:jt,mix:en,offset:gn,tileSize:An,buffer:Dn}=ct;let It,pn;ye?(It=bo.disabled,pn=lt.projMatrix):z?(It=new bo(H.LEQUAL,bo.ReadWrite,f.depthRangeFor3D),pn=E?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix(vt,Te)):(It=f.depthModeForSublayer(lt.overscaledZ-He,l.paint.get("raster-opacity")===1?bo.ReadWrite:bo.ReadOnly,H.LESS),pn=f.transform.calculateProjMatrix(vt,Te));const Xt=f.terrain&&ye?f.terrain.stencilModeForRTTOverlap(lt):De[lt.overscaledZ],mn=S?0:l.paint.get("raster-fade-duration");dt.registerFadeDuration(mn);const wn=r.findLoadedParent(lt,0),hn=lp(dt,wn,r,f.transform,mn);let Vn,fo;f.terrain&&f.terrain.prepareDrawTile(),q.activeTexture.set(H.TEXTURE0),jt.bind(Se,H.CLAMP_TO_EDGE),q.activeTexture.set(H.TEXTURE1),wn?(wn.texture&&wn.texture.bind(Se,H.CLAMP_TO_EDGE),Vn=Math.pow(2,wn.tileID.overscaledZ-dt.tileID.overscaledZ),fo=[dt.tileID.canonical.x*Vn%1,dt.tileID.canonical.y*Vn%1]):jt.bind(Se,H.CLAMP_TO_EDGE),jt.useMipmap&&q.extTextureFilterAnisotropic&&f.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,q.extTextureFilterAnisotropicMax);const xo=f.transform;let ro;const So=z?gp(xo):[0,0,0,0];let Wn,Ro,Ko,mr,Kr,Sr=0;if(V&&X instanceof o.aD&&X.coordinates.length>3)Wn=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0)))),Ro=Float32Array.from(xo.globeMatrix),Ko=Float32Array.from(o.cy(xo)),mr=[o.am(xo.center.lng),o.at(xo.center.lat)],ro=X.elevatedGlobePerspectiveTransform,Kr=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(V){const sr=o.cz(lt.canonical);Sr=o.cA(sr.getCenter().lat),Wn=Float32Array.from(o.b6(o.cC(lt.canonical))),Ro=Float32Array.from(xo.globeMatrix),Ko=Float32Array.from(o.cy(xo)),mr=[o.am(xo.center.lng),o.at(xo.center.lat)],ro=[0,0],Kr=Float32Array.from(o.cB(lt.canonical,sr,Sr,xo.worldSize/xo._pixelsPerMercatorPixel))}else ro=X instanceof o.aD?X.perspectiveTransform:[0,0],Wn=new Float32Array(16),Ro=new Float32Array(9),Ko=new Float32Array(16),mr=[0,0],Kr=new Float32Array(9);const ii=dp(pn,Wn,Ro,Ko,Kr,fo||[0,0],o.a9(f.transform.zoom),mr,So,Vn||1,hn,l,ro,z?l.paint.get("raster-elevation"):0,2,en,gn,ee.range,An,Dn,ae),kr=f.isTileAffectedByFog(lt),Zr=f.getOrCreateProgram("raster",{defines:ee.defines,overrideFog:kr});if(f.uploadCommonUniforms(q,Zr,vt),X instanceof o.aD){const sr=X.elevatedGlobeVertexBuffer,Gr=X.elevatedGlobeIndexBuffer;if(ye||!E)X.boundsBuffer&&X.boundsSegments&&Zr.draw(f,H.TRIANGLES,It,Do.disabled,be,Po.disabled,ii,l.id,X.boundsBuffer,f.quadTriangleIndexBuffer,X.boundsSegments);else if(sr&&Gr){const Ur=xo.zoom<=o.c3?X.elevatedGlobeSegments:X.getSegmentsForLongitude(xo.center.lng);Ur&&Zr.draw(f,H.TRIANGLES,It,Do.disabled,be,Xe,ii,l.id,sr,Gr,Ur)}}else if(V){It=new bo(H.LEQUAL,bo.ReadOnly,f.depthRangeFor3D);const sr=f.globeSharedBuffers;if(sr){const[Gr,Ur,Or]=sr.getGridBuffers(Sr,!1);Zr.draw(f,H.TRIANGLES,It,nt||Xt,f.colorModeForRenderPass(),Xe,ii,l.id,Gr,Ur,Or)}}else{const{tileBoundsBuffer:sr,tileBoundsIndexBuffer:Gr,tileBoundsSegments:Ur}=f.getTileBoundsBuffers(dt);Zr.draw(f,H.TRIANGLES,It,Xt,be,Po.disabled,ii,l.id,sr,Gr,Ur)}}if(!(X instanceof o.aD)&&V)for(const lt of tt){const vt=lt.canonical.y===(1<<lt.canonical.z)-1;lt.canonical.y===0&&Ei(!0,lt,f,r,l,ae,ee,Xe,nt||Do.disabled),vt&&Ei(!1,lt,f,r,l,ae,ee,Xe===Po.frontCW?Po.backCW:Po.frontCW,nt||Do.disabled)}};V?Ye(je,f.renderElevatedRasterBackface?Po.backCW:Po.frontCW,f.stencilModeFor3D()):Ye(je,Po.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,r,l,m,b,S){f.renderPass==="offscreen"&&function(E,z,V,q){if(!q.length)return;const H=E.context,X=H.gl,ee=z.getSource();if(!(ee instanceof ms))return;const ae=Math.ceil(Math.sqrt(V.paint.get("raster-particle-count")));let be=V.particlePositionRGBAImage;if(!be||be.width!==ae){const je=function(He){const Ye=He*He,tt=new Uint8Array(4*Ye),Xe=function(lt){return lt|=0,lt=Math.imul(2747636419^lt,2654435769),lt=Math.imul(lt^lt>>>16,2654435769),((lt=Math.imul(lt^lt>>>16,2654435769))>>>0)/4294967296},nt=1/1.1;for(let lt=0;lt<Ye;lt++){const vt=nt*(Xe(2*lt+0)+$u),dt=nt*(Xe(2*lt+1)+$u),ct=255*vt%1,jt=255*dt%1,en=ct,gn=dt-jt/255,An=jt;tt[4*lt+0]=255*(vt-ct/255),tt[4*lt+1]=255*en,tt[4*lt+2]=255*gn,tt[4*lt+3]=255*An}return tt}(ae);be=V.particlePositionRGBAImage=new o.r({width:ae,height:ae},je)}let ye=V.particleFramebuffer;ye?ye.width!==ae&&(ye.destroy(),ye=V.particleFramebuffer=H.createFramebuffer(ae,ae,!0,null)):ye=V.particleFramebuffer=H.createFramebuffer(ae,ae,!0,null);const Te=[];for(const je of q){const He=z.getTile(je);if(!(He instanceof uc))continue;const Ye=_y(He,ee,V);if(!Ye)continue;const tt=[He.tileSize,He.tileSize];let Xe=V.tileFramebuffer;Xe||(Xe=V.tileFramebuffer=H.createFramebuffer(tt[0],tt[1],!0,null));let nt=He.rasterParticleState;nt||(nt=He.rasterParticleState=new vy(H,je,tt,be));const lt=nt.update(V.lastInvalidatedAt);nt.particleTextureDimension!==ae&&nt.updateParticleTexture(je,be);const vt=nt.targetColorTexture;nt.targetColorTexture=nt.backgroundColorTexture,nt.backgroundColorTexture=vt;const dt=nt.particleTexture0;nt.particleTexture0=nt.particleTexture1,nt.particleTexture1=dt,Te.push([je,Ye,nt,lt])}if(Te.length===0)return;const Se=o.q.now(),De=V.previousDrawTimestamp?.001*(Se-V.previousDrawTimestamp):.0167;if(V.previousDrawTimestamp=Se,V.hasColorMap()){H.activeTexture.set(X.TEXTURE0+2);let je=V.colorRampTexture;je||(je=V.colorRampTexture=new o.T(H,V.colorRamp,X.RGBA8)),je.bind(X.LINEAR,X.CLAMP_TO_EDGE)}H.bindFramebuffer.set(V.tileFramebuffer.framebuffer),function(je,He,Ye){const tt=je.context,Xe=tt.gl,nt=He.tileFramebuffer;tt.activeTexture.set(Xe.TEXTURE0);const lt={u_texture:0,u_opacity:1.05*(dt=He.paint.get("raster-particle-fade-opacity-factor"))/(dt+.05)},vt=je.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var dt;for(const ct of Ye){const[,,jt,en]=ct;nt.colorAttachment.set(jt.targetColorTexture.texture),tt.viewport.set([0,0,nt.width,nt.height]),tt.clear({color:o.bA.transparent}),en&&(jt.backgroundColorTexture.bind(Xe.NEAREST,Xe.CLAMP_TO_EDGE),vt.draw(je,Xe.TRIANGLES,bo.disabled,Do.disabled,ir.alphaBlended,Po.disabled,lt,He.id,je.viewportBuffer,je.quadTriangleIndexBuffer,je.viewportSegments))}}(E,V,Te),function(je,He,Ye,tt){const Xe=je.context,nt=Xe.gl,lt=Ye.tileFramebuffer,vt=je.transform.projection.name==="globe",dt=Ye.paint.get("raster-particle-max-speed");for(const ct of tt){const[jt,en,gn]=ct;Xe.activeTexture.set(nt.TEXTURE0+0),en.texture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE),lt.colorAttachment.set(gn.targetColorTexture.texture);const An=je.getOrCreateProgram("rasterParticleDraw",{defines:en.defines,overrideFog:!1});Xe.activeTexture.set(nt.TEXTURE0+1);const Dn=en.scalarData?[]:[0,1,2,3].map(Xt=>o.c$[Xt](jt));Dn.push(jt);const It=jt.canonical.x,pn=jt.canonical.y;for(const Xt of Dn){const mn=He.getTile(vt?Xt.wrapped():Xt);if(!mn)continue;const wn=mn.rasterParticleState;if(!wn)continue;const hn=Xt.canonical.x+(1<<Xt.canonical.z)*(Xt.wrap-jt.wrap),Vn=Xt.canonical.y;wn.particleTexture0.bind(nt.NEAREST,nt.CLAMP_TO_EDGE);const fo=fp(1,wn.particleTexture0.size[0],[hn-It,Vn-pn],0,en.texture.size,2,dt,en.textureOffset,en.scale,en.offset);An.draw(je,nt.POINTS,bo.disabled,Do.disabled,ir.alphaBlended,Po.disabled,fo,Ye.id,wn.particleIndexBuffer,void 0,wn.particleSegment)}}}(E,z,V,Te),H.bindFramebuffer.set(V.particleFramebuffer.framebuffer),function(je,He,Ye,tt){const Xe=je.context,nt=Xe.gl,lt=He.paint.get("raster-particle-max-speed"),vt=tt*He.paint.get("raster-particle-speed-factor")*.15,dt=function(jt){return Math.pow(jt,6)}(.01+1*He.paint.get("raster-particle-reset-rate-factor")),ct=He.particleFramebuffer;Xe.viewport.set([0,0,ct.width,ct.height]);for(const jt of Ye){const[,en,gn]=jt;Xe.activeTexture.set(nt.TEXTURE0+0),en.texture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE),Xe.activeTexture.set(nt.TEXTURE0+1);const An=gn.particleTexture0;An.bind(nt.NEAREST,nt.CLAMP_TO_EDGE);const Dn=xg(1,An.size[0],0,en.texture.size,lt,vt,dt,en.textureOffset,en.scale,en.offset);ct.colorAttachment.set(gn.particleTexture1.texture),Xe.clear({color:o.bA.transparent}),je.getOrCreateProgram("rasterParticleUpdate",{defines:en.defines}).draw(je,nt.TRIANGLES,bo.disabled,Do.disabled,ir.unblended,Po.disabled,Dn,He.id,je.viewportBuffer,je.quadTriangleIndexBuffer,je.viewportSegments)}}(E,V,Te,De)}(f,r,l,m),f.renderPass==="translucent"&&(function(E,z,V,q,H){const X=E.context,ee=X.gl,ae=z.getSource().tileSize,be=5*(1-o.a7(o.bV,o.bV+1,E.transform.zoom))*ae+V.paint.get("raster-particle-elevation"),ye=!E.options.moving,Te=E.transform.projection.name==="globe";if(!q.length)return;const[Se,De]=E.stencilConfigForOverlap(q),je=[];Te&&je.push("PROJECTION_GLOBE_VIEW");const He=E.stencilModeFor3D();for(const Ye of De){const tt=Ye.toUnwrapped(),Xe=z.getTile(Ye);if(!Xe.rasterParticleState)continue;const nt=Xe.rasterParticleState,lt=100;Xe.registerFadeDuration(lt);const vt=z.findLoadedParent(Ye,0),dt=lp(Xe,vt,z,E.transform,lt);let ct,jt;E.terrain&&E.terrain.prepareDrawTile(),X.activeTexture.set(ee.TEXTURE0),nt.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),X.activeTexture.set(ee.TEXTURE1),vt&&vt.rasterParticleState?(vt.rasterParticleState.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),ct=Math.pow(2,vt.tileID.overscaledZ-Xe.tileID.overscaledZ),jt=[Xe.tileID.canonical.x*ct%1,Xe.tileID.canonical.y*ct%1]):nt.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const en=Te?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(tt,ye),gn=E.transform,An=j1(gn),Dn=o.cz(Ye.canonical),It=o.cA(Dn.getCenter().lat);let pn,Xt,mn,wn,hn;Te?(pn=Float32Array.from(o.b6(o.cC(Ye.canonical))),Xt=Float32Array.from(gn.globeMatrix),mn=Float32Array.from(o.cy(gn)),wn=[o.am(gn.center.lng),o.at(gn.center.lat)],hn=Float32Array.from(o.cB(Ye.canonical,Dn,It,gn.worldSize/gn._pixelsPerMercatorPixel))):(pn=new Float32Array(16),Xt=new Float32Array(9),mn=new Float32Array(16),wn=[0,0],hn=new Float32Array(9));const Vn=hp(en,pn,Xt,mn,hn,jt||[0,0],o.a9(E.transform.zoom),wn,An,ct||1,dt,be),fo=E.isTileAffectedByFog(Ye),xo=E.getOrCreateProgram("rasterParticle",{defines:je,overrideFog:fo});if(E.uploadCommonUniforms(X,xo,tt),Te){const ro=new bo(ee.LEQUAL,bo.ReadOnly,E.depthRangeFor3D),So=0,Wn=E.globeSharedBuffers;if(Wn){const[Ro,Ko,mr]=Wn.getGridBuffers(It,So!==0);xo.draw(E,ee.TRIANGLES,ro,He,ir.alphaBlended,E.renderElevatedRasterBackface?Po.frontCCW:Po.backCCW,Vn,V.id,Ro,Ko,mr)}}else{const ro=E.depthModeForSublayer(0,bo.ReadOnly),So=Se[Ye.overscaledZ],{tileBoundsBuffer:Wn,tileBoundsIndexBuffer:Ro,tileBoundsSegments:Ko}=E.getTileBoundsBuffers(Xe);xo.draw(E,ee.TRIANGLES,ro,So,ir.alphaBlended,Po.disabled,Vn,V.id,Wn,Ro,Ko)}}E.resetStencilClippingMasks()}(f,r,l,m),f.style.map.triggerRepaint())},background:function(f,r,l,m){const b=l.paint.get("background-color"),S=l.paint.get("background-opacity"),E=l.paint.get("background-emissive-strength"),z=l.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const V=f.context,q=V.gl,H=f.transform,X=H.tileSize,ee=l.paint.get("background-pattern");let ae;if(ee!==void 0&&(ee===null||(ae=f.imageManager.getPattern(ee.toString(),l.scope,f.style.getLut(l.scope)),!ae)))return;const be=!ee&&b.a===1&&S===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==be)return;const ye=Do.disabled,Te=f.depthModeForSublayer(0,be==="opaque"?bo.ReadWrite:bo.ReadOnly),Se=f.colorModeForDrapableLayerRenderPass(E),De=ee?"backgroundPattern":"background";let je,He=m;if(He||(je=f.getBackgroundTiles(),He=Object.values(je).map(Ye=>Ye.tileID)),ee&&(V.activeTexture.set(q.TEXTURE0),f.imageManager.bind(f.context,l.scope)),z){const Ye=f.getOrCreateProgram(De,{overrideFog:!1,overrideRtt:!0}),tt=new Float32Array(o.a6.mat4.identity([])),Xe=new o.aA(0,0,0,0,0),nt=ee?qh(tt,E,S,f,0,l.scope,ae,z,{tileID:Xe,tileSize:X}):Vu(tt,E,S,b.toRenderColor(l.lut));Ye.draw(f,q.TRIANGLES,Te,ye,Se,Po.disabled,nt,l.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const Ye of He){const tt=f.isTileAffectedByFog(Ye),Xe=f.getOrCreateProgram(De,{overrideFog:tt}),nt=Ye.toUnwrapped(),lt=m?Ye.projMatrix:f.transform.calculateProjMatrix(nt);f.prepareDrawTile();const vt=r?r.getTile(Ye):je?je[Ye.key]:new Vs(Ye,X,H.zoom,f),dt=ee?qh(lt,E,S,f,0,l.scope,ae,z,{tileID:Ye,tileSize:X}):Vu(lt,E,S,b.toRenderColor(l.lut));f.uploadCommonUniforms(V,Xe,nt);const{tileBoundsBuffer:ct,tileBoundsIndexBuffer:jt,tileBoundsSegments:en}=f.getTileBoundsBuffers(vt);Xe.draw(f,q.TRIANGLES,Te,ye,Se,Po.disabled,dt,l.id,ct,jt,en)}},sky:function(f,r,l){const m=f._atmosphere?o.a9(f.transform.zoom):1,b=l.paint.get("sky-opacity")*m;if(b===0)return;const S=f.context,E=l.paint.get("sky-type"),z=new bo(S.gl.LEQUAL,bo.ReadOnly,[0,1]),V=f.frameCounter/1e3%1;E==="atmosphere"?f.renderPass==="offscreen"?l.needsSkyboxCapture(f)&&(function(q,H,X,ee){const ae=q.context,be=ae.gl;let ye=H.skyboxFbo;if(!ye){ye=H.skyboxFbo=ae.createFramebuffer(32,32,!0,null),H.skyboxGeometry=new Lg(ae),H.skyboxTexture=ae.gl.createTexture(),be.bindTexture(be.TEXTURE_CUBE_MAP,H.skyboxTexture),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_MIN_FILTER,be.LINEAR),be.texParameteri(be.TEXTURE_CUBE_MAP,be.TEXTURE_MAG_FILTER,be.LINEAR);for(let je=0;je<6;++je)be.texImage2D(be.TEXTURE_CUBE_MAP_POSITIVE_X+je,0,be.RGBA,32,32,0,be.RGBA,be.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(ye.framebuffer),ae.viewport.set([0,0,32,32]);const Te=H.getCenter(q,!0),Se=q.getOrCreateProgram("skyboxCapture"),De=new Float64Array(16);o.a6.mat4.identity(De),o.a6.mat4.rotateY(De,De,.5*-Math.PI),ml(q,H,Se,De,Te,0),o.a6.mat4.identity(De),o.a6.mat4.rotateY(De,De,.5*Math.PI),ml(q,H,Se,De,Te,1),o.a6.mat4.identity(De),o.a6.mat4.rotateX(De,De,.5*-Math.PI),ml(q,H,Se,De,Te,2),o.a6.mat4.identity(De),o.a6.mat4.rotateX(De,De,.5*Math.PI),ml(q,H,Se,De,Te,3),o.a6.mat4.identity(De),ml(q,H,Se,De,Te,4),o.a6.mat4.identity(De),o.a6.mat4.rotateY(De,De,Math.PI),ml(q,H,Se,De,Te,5),ae.viewport.set([0,0,q.width,q.height])}(f,l),l.markSkyboxValid(f)):f.renderPass==="sky"&&function(q,H,X,ee,ae){const be=q.context,ye=be.gl,Te=q.transform,Se=q.getOrCreateProgram("skybox");be.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_CUBE_MAP,H.skyboxTexture);const De=((je,He,Ye,tt,Xe)=>({u_matrix:je,u_sun_direction:He,u_cubemap:0,u_opacity:tt,u_temporal_offset:Xe}))(Te.skyboxMatrix,H.getCenter(q,!1),0,ee,ae);q.uploadCommonUniforms(be,Se),Se.draw(q,ye.TRIANGLES,X,Do.disabled,q.colorModeForRenderPass(),Po.backCW,De,"skybox",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(f,l,z,b,V):E==="gradient"&&f.renderPass==="sky"&&function(q,H,X,ee,ae){const be=q.context,ye=be.gl,Te=q.transform,Se=q.getOrCreateProgram("skyboxGradient");H.skyboxGeometry||(H.skyboxGeometry=new Lg(be)),be.activeTexture.set(ye.TEXTURE0);let De=H.colorRampTexture;De||(De=H.colorRampTexture=new o.T(be,H.colorRamp,ye.RGBA8)),De.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const je=((He,Ye,tt,Xe,nt)=>({u_matrix:He,u_color_ramp:0,u_center_direction:Ye,u_radius:o.bC(tt),u_opacity:Xe,u_temporal_offset:nt}))(Te.skyboxMatrix,H.getCenter(q,!1),H.paint.get("sky-gradient-radius"),ee,ae);q.uploadCommonUniforms(be,Se),Se.draw(q,ye.TRIANGLES,X,Do.disabled,q.colorModeForRenderPass(),Po.backCW,je,"skyboxGradient",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(f,l,z,b,V)},debug:function(f,r,l,m,b,S){for(let E=0;E<l.length;E++)if(b){const q=new o.bA(m.r*.8,m.g*.8,m.b*.8,1);ci(f,r,l[E],m,-1,-1,S),ci(f,r,l[E],m,-1,1,S),ci(f,r,l[E],m,1,1,S),ci(f,r,l[E],m,1,-1,S),ci(f,r,l[E],q,0,0,S)}else ci(f,r,l[E],m,0,0,S)},custom:function(f,r,l,m){const b=f.context,S=l.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&l.isDraped(r)){if(f.renderPass==="offscreen"){const E=S.prerender;if(E){if(f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const z=f.transform.pointMerc;E.call(S,b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[z.x,z.y],f.transform.pixelsPerMeterRatio)}else E.call(S,b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const z=S.renderToTile;if(z){const V=m[0].canonical,q=new o.a5(V.x+m[0].wrap*(1<<V.z),V.y,V.z);b.setDepthMode(bo.disabled),b.setStencilMode(Do.disabled),b.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),z.call(S,b.gl,q),b.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),b.setColorMode(f.colorModeForRenderPass()),b.setStencilMode(Do.disabled);const E=S.renderingMode==="3d"?new bo(f.context.gl.LEQUAL,bo.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,bo.ReadOnly);if(b.setDepthMode(E),f.transform.projection.name==="globe"){const z=f.transform.pointMerc;S.render(b.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),o.a9(f.transform.zoom),[z.x,z.y],f.transform.pixelsPerMeterRatio)}else S.render(b.gl,f.transform.customLayerMatrix());b.setDirty(),f.setBaseState(),b.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,r,l,m){if(f.renderPass==="opaque")return;const b=l.paint.get("model-opacity");if(b===0)return;const S=l.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!S||f.terrain&&b<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof o.a4))return;const E=f.shadowRenderer,z=l.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,z||(E.enabled=!1));const V=()=>{E&&(E.useNormalOffset=!0,z||(E.enabled=!0))},q=r.getSource();if(f.renderPass==="light-beam"&&q.type!=="batched-model")return;if(q.type==="vector"||q.type==="geojson")return function(Se,De,je,He,Ye){const tt=Se.transform;if(tt.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${tt.projection.name} projection is not yet implemented`);const Xe=tt.getFreeCameraOptions().position;if(!Se.modelManager)return;const nt=Se.modelManager;je.modelManager=nt;const lt=Se.shadowRenderer;if(!je._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const vt=je._unevaluatedLayout._values["model-id"],dt={...je.layout.get("model-id").parameters},ct=Se.style.order.indexOf(je.fqid);for(const jt of He){const en=De.getTile(jt).getBucket(je);if(!en||en.projection.name!==tt.projection.name)continue;const gn=en.getModelUris();gn&&!en.modelsRequested&&(nt.addModelsFromBucket(gn,Ye),en.modelsRequested=!0);const An=Va(jt,tt);dt.zoom=An;const Dn=vt.possiblyEvaluate(dt);if(by(Se,en,jt),Vl.shadowUniformsInitialized=!1,Vl.useSingleShadowCascade=!!lt&&lt.getMaxCascadeForTile(jt.toUnwrapped())===0,Se.renderPass==="shadow"&&lt){if(Se.currentShadowCascade===1&&en.isInsideFirstShadowMapFrustum)continue;const Xt=tt.calculatePosMatrix(jt.toUnwrapped(),tt.worldSize);if(Vl.tileMatrix.set(Xt),Vl.shadowTileMatrix=Float32Array.from(lt.calculateShadowPassMatrixFromMatrix(Xt)),Vl.aabb.min.fill(0),Vl.aabb.max[0]=Vl.aabb.max[1]=o.ab,Vl.aabb.max[2]=0,ui(en,Vl,Se,je.scope))continue}const It=1<<jt.canonical.z,pn=[((Xe.x-jt.wrap)*It-jt.canonical.x)*o.ab,(Xe.y*It-jt.canonical.y)*o.ab,Xe.z*It*o.ab];Se.conflationActive&&Object.keys(en.instancesPerModel).length>0&&Se.style.isLayerClipped(je,De.getSource())&&en.updateReplacement(jt,Se.replacementSource,ct,Ye)&&(en.uploaded=!1,en.upload(Se.context));for(let Xt in en.instancesPerModel){const mn=en.instancesPerModel[Xt];mn.features.length>0&&(Xt=Dn.evaluate(mn.features[0].feature,{}));const wn=nt.getModel(Xt,Ye);if(wn&&wn.uploaded)for(const hn of wn.nodes)xy(Se,je,hn,mn,pn,jt,Vl)}}}(f,r,l,m,q.type==="vector"?l.scope:""),void V();if(!q.loaded())return;if(q.type==="batched-model")return function(Se,De,je,He){je.resetLayerRenderingStats(Se);const Ye=Se.context,tt=Se.transform,Xe=Se.style.fog,nt=Se.shadowRenderer;if(tt.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${tt.projection.name} projection is not yet implemented`);const lt=Se.transform.getFreeCameraOptions().position,vt=o.a6.vec3.scale([],[lt.x,lt.y,lt.z],Se.transform.worldSize),dt=o.a6.vec3.negate([],vt),ct=o.a6.mat4.identity([]),jt=o.de(tt.center.lat,tt.zoom),en=o.a6.mat4.fromScaling([],[1,1,1/jt]);o.a6.mat4.translate(ct,ct,dt);const gn=je.paint.get("model-opacity"),An=new bo(Ye.gl.LEQUAL,bo.ReadWrite,Se.depthRangeFor3D),Dn=new bo(Ye.gl.LEQUAL,bo.ReadOnly,Se.depthRangeFor3D),It=new o.ca([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),pn=Se.renderPass==="shadow",Xt=pn&&nt?nt.getCurrentCascadeFrustum():tt.getFrustum(tt.scaleZoom(tt.worldSize)),mn=je.paint.get("model-front-cutoff"),wn=mn[2]<1,hn=Aa(Se,je.paint.get("model-cutoff-fade-range")),Vn=je.getLayerRenderingStats();(function(fo,xo,ro,So){const Wn=fo.terrain?fo.terrain.exaggeration():0,Ro=fo.transform.zoom;for(const Ko of So){const mr=xo.getTile(Ko).getBucket(ro);mr&&(fo.conflationActive&&mr.updateReplacement(Ko,fo.replacementSource),mr.evaluateScale(fo,ro),fo.terrain&&Wn>0&&mr.elevationUpdate(fo.terrain,Wn,Ko,ro.source),mr.needsReEvaluation(fo,Ro,ro)&&mr.evaluate(ro))}})(Se,De,je,He),function(){let fo,xo,ro;wn?(fo=He.length-1,xo=-1,ro=-1):(fo=0,xo=He.length,ro=1);const So=new Float64Array(16),Wn=o.a6.vec3.create(),Ro=new o.P(0,0);for(let Ko=fo;Ko!==xo;Ko+=ro){const mr=He[Ko],Kr=De.getTile(mr).getBucket(je);if(!Kr||!Kr.uploaded)continue;let Sr=!1;nt&&(Sr=nt.getMaxCascadeForTile(mr.toUnwrapped())===0);const ii=tt.calculatePosMatrix(mr.toUnwrapped(),tt.worldSize),kr=Kr.modelTraits;!pn&&wn&&(o.a6.mat4.invert(So,ii),o.a6.vec3.transformMat4(Wn,vt,So),Ro.x=Wn[0],Ro.y=Wn[1]);const Zr=[];for(const sr of Kr.getNodesInfo()){if(sr.hiddenByReplacement||!sr.node.meshes)continue;const Gr=sr.node;let Ur=0;Se.terrain&&Gr.elevation&&(Ur=Gr.elevation*Se.terrain.exaggeration());const Or=(()=>{const Pi=sr.aabb;return It.min=[...Pi.min],It.max=[...Pi.max],It.min[2]+=Ur,It.max[2]+=Ur,o.a6.vec3.transformMat4(It.min,It.min,ii),o.a6.vec3.transformMat4(It.max,It.max,ii),It})(),fi=sr.evaluatedScale;if(fi[0]<=1&&fi[1]<=1&&fi[2]<=1&&Or.intersects(Xt)===0)continue;if(!pn&&wn){const Pi=.16666666666666666;sr.cameraCollisionOpacity=vt[0]>Or.min[0]&&vt[0]<Or.max[0]&&vt[1]>Or.min[1]&&vt[1]<Or.max[1]&&vt[2]*jt<Or.max[2]&&Gr.footprint&&o.bv(Ro,Gr.footprint)?Math.max(sr.cameraCollisionOpacity-Pi,0):Math.min(1,sr.cameraCollisionOpacity+Pi)}const Yi=[...ii],Cs=Gr.anchor?Gr.anchor[0]:0,Ys=Gr.anchor?Gr.anchor[1]:0;o.a6.mat4.translate(Yi,Yi,[Cs*(fi[0]-1),Ys*(fi[1]-1),Ur]),o.a6.vec3.exactEquals(fi,o.dh)||o.a6.mat4.scale(Yi,Yi,fi);const ea=o.a6.mat4.multiply([],Yi,Gr.matrix),wr=o.a6.mat4.multiply([],tt.expandedFarZProjMatrix,ea),_r=o.a6.mat4.multiply([],tt.expandedFarZProjMatrix,Yi),Pr=o.a6.vec4.transformMat4([],[Cs,Ys,Ur,1],wr)[2];Gr.hidden=!1;let Jr=gn;pn||(wn&&(Jr*=sr.cameraCollisionOpacity,Jr*=wy(Yi,tt,sr.aabb,mn)),Jr*=Mr(hn,Pr)),Jr!==0?Zr.push({nodeInfo:sr,depth:Pr,opacity:Jr,wvpForNode:wr,wvpForTile:_r,nodeModelMatrix:ea,tileModelMatrix:Yi}):Gr.hidden=!0}pn||Zr.sort((sr,Gr)=>!wn||sr.opacity===1&&Gr.opacity===1?sr.depth<Gr.depth?-1:1:sr.opacity===1?-1:Gr.opacity===1?1:sr.depth>Gr.depth?-1:1);for(const sr of Zr){const Gr=sr.nodeInfo,Ur=Gr.node;let Or=o.a6.mat4.multiply([],en,sr.tileModelMatrix);o.a6.mat4.multiply(Or,ct,Or);const fi=o.a6.mat4.invert([],Or);o.a6.mat4.transpose(fi,fi),o.a6.mat4.scale(fi,fi,Jh),Or=o.a6.mat4.multiply(Or,Or,Ur.matrix);const Yi=Se.renderPass==="light-beam",Cs=kr&o.dj.HasMapboxMeshFeatures,Ys=Cs?0:Gr.evaluatedRMEA[0][2];for(let ea=0;ea<Ur.meshes.length;++ea){const wr=Ur.meshes[ea],_r=ea===Ur.lightMeshIndex;let Pr=sr.wvpForNode;if(_r){if(!Yi&&!Se.terrain&&Se.shadowRenderer){Se.currentLayer<Se.firstLightBeamLayer&&(Se.firstLightBeamLayer=Se.currentLayer);continue}Pr=sr.wvpForTile}else if(Yi)continue;const Jr={defines:[]},Pi=[];if(!pn&&nt&&(nt.useNormalOffset=!!wr.normalBuffer),yp(Jr.defines,Pi,wr,Se,je.lut),Cs||Jr.defines.push("DIFFUSE_SHADED"),Sr&&Jr.defines.push("SHADOWS_SINGLE_CASCADE"),Vn&&(pn?Vn.numRenderedVerticesInShadowPass+=wr.vertexArray.length:Vn.numRenderedVerticesInTransparentPass+=wr.vertexArray.length),pn){bp(wr,sr.nodeModelMatrix,Se,je);continue}let pi=null;if(Xe){const vl=Dg(sr.nodeModelMatrix,Se.transform);if(pi=new Float32Array(vl),tt.projection.name!=="globe"){const as=wr.aabb.min,Rc=wr.aabb.max,[Js,Fr]=Xe.getOpacityForBounds(vl,as[0],as[1],Rc[0],Rc[1]);Jr.overrideFog=Js>=gt||Fr>=gt}}const ra=wr.material;let Hl;ra.occlusionTexture&&ra.occlusionTexture.offsetScale&&(Hl=ra.occlusionTexture.offsetScale,Jr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const rs=Se.getOrCreateProgram("model",Jr);!pn&&nt&&nt.setupShadowsFromMatrix(sr.tileModelMatrix,rs,nt.useNormalOffset),Se.uploadCommonUniforms(Ye,rs,null,pi);const is=ra.pbrMetallicRoughness;is.metallicFactor=.9,is.roughnessFactor=.5;const Xs=pp(new Float32Array(Pr),new Float32Array(Or),new Float32Array(fi),new Float32Array(Ur.matrix),Se,sr.opacity,is.baseColorFactor.toRenderColor(null),ra.emissiveFactor,is.metallicFactor,is.roughnessFactor,ra,Ys,je,[0,0,0],Hl);!_r&&(Gr.hasTranslucentParts||sr.opacity<1)&&rs.draw(Se,Ye.gl.TRIANGLES,An,Do.disabled,ir.disabled,Po.backCCW,Xs,je.id,wr.vertexBuffer,wr.indexBuffer,wr.segments,je.paint,Se.transform.zoom,void 0,Pi),rs.draw(Se,Ye.gl.TRIANGLES,_r?Dn:An,Do.disabled,_r||sr.opacity<1||Gr.hasTranslucentParts?ir.alphaBlended:ir.unblended,Po.backCCW,Xs,je.id,wr.vertexBuffer,wr.indexBuffer,wr.segments,je.paint,Se.transform.zoom,void 0,Pi)}}}}()}(f,r,l,m),void V();if(q.type!=="model")return;const H=q.getModels(),X=[],ee=f.transform.getFreeCameraOptions().position,ae=o.a6.vec3.scale([],[ee.x,ee.y,ee.z],f.transform.worldSize);o.a6.vec3.negate(ae,ae);const be=[],ye=[];let Te=0;for(const Se of H){const De=l.paint.get("model-rotation").constantOr(null),je=l.paint.get("model-scale").constantOr(null),He=l.paint.get("model-translation").constantOr(null);Se.computeModelMatrix(f,De,je,He,!0,!0,!1);const Ye=o.a6.mat4.identity([]),tt=o.de(Se.position.lat,f.transform.zoom),Xe=o.a6.mat4.fromScaling([],[1,1,1/tt]);o.a6.mat4.translate(Ye,Ye,ae),X.push({zScaleMatrix:Xe,negCameraPosMatrix:Ye});for(const nt of Se.nodes)Xh(f.transform,nt,Se.matrix,f.transform.expandedFarZProjMatrix,Te,be,ye);Te++}if(be.sort((Se,De)=>De.depth-Se.depth),f.renderPass!=="shadow"){if(b===1)for(const Se of ye)Hu(Se,f,l,X[Se.modelIndex],Do.disabled,f.colorModeForRenderPass());else{for(const Se of ye)Hu(Se,f,l,X[Se.modelIndex],Do.disabled,ir.disabled);for(const Se of ye)Hu(Se,f,l,X[Se.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const Se of be)Hu(Se,f,l,X[Se.modelIndex],Do.disabled,f.colorModeForRenderPass());V()}else{for(const Se of ye)bp(Se.mesh,Se.nodeModelMatrix,f,l);for(const Se of be)bp(Se.mesh,Se.nodeModelMatrix,f,l);V()}}},Ec={model:function(f,r,l){const m=r.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,m.type==="vector"?f.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const b=m.getModels();for(const S of b)S.upload(l.context)},raster:function(f,r,l){const m=r.getSource();if(!(m instanceof ms&&m.loaded()))return;const b=f.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!b)return;const S=f.paint.get("raster-array-band")||m.getInitialBand(b);if(S==null)return;const E=r.getIds().map(z=>r.getTileByID(z));for(const z of E)z.updateNeeded(b,S)&&m.prepareTile(z,b,S)},"raster-particle":function(f,r,l){const m=r.getSource();if(!(m instanceof ms&&m.loaded()))return;const b=f.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!b)return;const S=f.paint.get("raster-particle-array-band")||m.getInitialBand(b);if(S==null)return;const E=r.getIds().map(z=>r.getTileByID(z));for(const z of E)z.updateNeeded(b,S)&&m.prepareTile(z,b,S)}};class pu{constructor(r,l,m,b,S){this.context=new V1(r,l),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._timeStamp=o.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const V of E)this._debugParams.enabledLayers[V]=!0;S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),S.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),S.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),S.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),S.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const V of E)S.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],V);this.occlusionParams=new Dd(S),this.setup(),this.numSublayers=Ue.maxUnderzooming+Ue.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Ol(this),this._wireframeDebugCache=new xp,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const z=new o.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,z,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=b}updateTerrain(r,l){const m=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new fg(this,r));const b=this._terrain;this.transform.elevation=m?b:null,b.update(r,this.transform,l),this.transform.elevation&&!b.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,b]=l.getFovAdjustedRange(this.transform._fov);if(m>b)return void(this.transform.fogCullDistSq=null);const S=m+.78*(b-m);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new fg(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*o.q.devicePixelRatio,this.height=l*o.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const r=this.context,l=new o.a$;l.emplaceBack(0,0),l.emplaceBack(o.ab,0),l.emplaceBack(0,o.ab),l.emplaceBack(o.ab,o.ab),this.tileExtentBuffer=r.createVertexBuffer(l,o.b1.members),this.tileExtentSegments=o.b2.simpleSegment(0,0,4,2);const m=new o.a$;m.emplaceBack(0,0),m.emplaceBack(o.ab,0),m.emplaceBack(0,o.ab),m.emplaceBack(o.ab,o.ab),this.debugBuffer=r.createVertexBuffer(m,o.b1.members),this.debugSegments=o.b2.simpleSegment(0,0,4,5);const b=new o.a$;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(b,o.b1.members),this.viewportSegments=o.b2.simpleSegment(0,0,4,2);const S=new o.aO;S.emplaceBack(0,0,0,0),S.emplaceBack(o.ab,0,o.ab,0),S.emplaceBack(0,o.ab,0,o.ab),S.emplaceBack(o.ab,o.ab,o.ab,o.ab),this.mercatorBoundsBuffer=r.createVertexBuffer(S,o.b4.members),this.mercatorBoundsSegments=o.b2.simpleSegment(0,0,4,2);const E=new o.aP;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(E);const z=new o.b0;for(const q of[0,1,3,2,0])z.emplaceBack(q);this.debugIndexBuffer=r.createIndexBuffer(z),this.emptyTexture=new o.T(r,new o.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=o.a6.mat4.create();const V=this.context.gl;this.stencilClearMode=new Do({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,bo.disabled,this.stencilClearMode,ir.disabled,Po.disabled,Hh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,m){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const V of m)if(this._tileClippingMaskIDs[V.key]===void 0){z=!0;break}if(!z)return}this.currentStencilSource=l.id;const b=this.context,S=b.gl;this.nextStencilID+m.length>256&&this.clearStencil(),b.setColorMode(ir.disabled),b.setDepthMode(bo.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of m){const V=l.getTile(z),q=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:X,tileBoundsSegments:ee}=this.getTileBoundsBuffers(V);E.draw(this,S.TRIANGLES,bo.disabled,new Do({func:S.ALWAYS,mask:0},q,255,S.KEEP,S.KEEP,S.REPLACE),ir.disabled,Po.disabled,Hh(z.projMatrix),"$clipping",H,X,ee)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Do({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Do({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,m=r.sort((E,z)=>z.overscaledZ-E.overscaledZ),b=m[m.length-1].overscaledZ,S=m[0].overscaledZ-b+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const E={};for(let z=0;z<S;z++)E[z+b]=new Do({func:l.GEQUAL,mask:255},z+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=S,[E,m]}return[{[b]:Do.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new ir([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new o.bA(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ir.unblended:ir.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new ir([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new o.bA(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,m,b=!1){if(this.depthOcclusion)return new bo(this.context.gl.GREATER,bo.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!b)return bo.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new bo(m||this.context.gl.LEQUAL,l,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),m=Math.ceil(this.height),b=this.context.bindFramebuffer.get(),S=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&m!==0&&(this.depthFBO=new hy(this.context,l,m,!1,"texture"),this.depthTexture=new o.T(this.context,{width:l,height:m,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(b),r.bindTexture(r.TEXTURE_2D,S),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,m,0,0,l,m,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const m=o.q.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const b=this.style._mergedLayers,S=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(dt=>{const ct=b[dt];return!(ct.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[ct.type]});let E=!1,z=!1;for(const dt of S){const ct=b[dt];ct.type==="circle"&&(E=!0),ct.type==="symbol"&&(ct.hasInitialOcclusionOpacityProperties?z=!0:E=!0)}const V=S.map(dt=>b[dt]),q=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.q.now()),this.imageManager.beginFrame();let H=0,X=!1;for(const dt in q){const ct=q[dt];ct.used&&(ct.prepare(this.context),ct.getSource().usedInConflation&&++H)}let ee=!1;for(const dt of V)dt.isHidden(this.transform.zoom)||(dt.type==="clip"&&(ee=!0),this.prepareLayer(dt));const ae={},be={},ye={},Te={},Se={};for(const dt in q){const ct=q[dt];ae[dt]=ct.getVisibleCoordinates(),be[dt]=ae[dt].slice().reverse(),ye[dt]=ct.getVisibleCoordinates(!0).reverse(),Te[dt]=ct.getShadowCasterCoordinates(),Se[dt]=ct.sortCoordinatesByDistance(ae[dt])}const De=dt=>{const ct=this.style.getLayerSourceCache(dt);return ct&&ct.used?ct.getSource():null};if(H||ee||this._clippingActiveLastFrame){const dt=[],ct=[];let jt=0;for(const en of V)this.isSourceForClippingOrConflation(en,De(en))&&(dt.push(en),ct.push(jt)),jt++;if(dt&&(ee||dt.length>1)||this._clippingActiveLastFrame){ee=!1;const en=[];for(let gn=0;gn<dt.length;gn++){const An=dt[gn],Dn=ct[gn],It=this.style.getLayerSourceCache(An);if(!It||!It.used||!It.getSource().usedInConflation&&An.type!=="clip")continue;let pn=o.dn,Xt=o.bt.None;const mn=[];let wn=!0;if(An.type==="clip"){pn=Dn;for(const hn of An.layout.get("clip-layer-types"))Xt|=hn==="model"?o.bt.Model:hn==="symbol"?o.bt.Symbol:o.bt.FillExtrusion;for(const hn of An.layout.get("clip-layer-scope"))mn.push(hn);An.isHidden(this.transform.zoom)?wn=!1:ee=!0}wn&&en.push({layer:An.fqid,cache:It,order:pn,clipMask:Xt,clipScope:mn})}this.replacementSource.setSources(en),X=!0}}this._clippingActiveLastFrame=ee,X||this.replacementSource.clear(),this.conflationActive=X,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let dt=0;dt<V.length;dt++){const ct=V[dt],jt=ct.cutoffRange();if(this.longestCutoffRange=Math.max(jt,this.longestCutoffRange),jt>0){const en=De(ct);en&&(this.minCutoffZoom=Math.max(en.minzoom,this.minCutoffZoom)),ct.minzoom&&(this.minCutoffZoom=Math.max(ct.minzoom,this.minCutoffZoom))}ct.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=dt),this._lastOcclusionLayer=dt)}const je=this.style&&this.style.fog;je?(this._fogVisible=je.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=je.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ye),this.opaquePassCutoff=0);const He=this._shadowRenderer;if(He){He.updateShadowParameters(this.transform,this.style.directionalLight);for(const dt in q)for(const ct of ae[dt]){let jt={min:0,max:0};this.terrain&&(jt=this.terrain.getMinMaxForTile(ct)||jt),He.addShadowReceiver(ct.toUnwrapped(),jt.min,jt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Og(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!dn.has(this.context.gl))return;this.renderPass="offscreen";for(const dt of V){const ct=r.getLayerSourceCache(dt);if(!dt.hasOffscreenPass()||dt.isHidden(this.transform.zoom))continue;const jt=ct?be[ct.id]:void 0;(dt.type==="custom"||dt.type==="raster"||dt.type==="raster-particle"||dt.isSky()||jt&&jt.length)&&this.renderLayer(this,ct,dt,jt)}this.depthRangeFor3D=[0,1-(V.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ye=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),tt=(()=>{if(l.showOverdrawInspector)return o.bA.black;const dt=this.style.fog;if(dt&&this.transform.projection.supportsFog){const ct=this.style.getLut(dt.scope);if(!Ye){const jt=dt.properties.get("color").toRenderColor(ct).toArray01();return new o.bA(...jt)}if(Ye){const jt=dt.properties.get("space-color").toRenderColor(ct).toArray01();return new o.bA(...jt)}}return o.bA.transparent})();if(this.context.clear({color:tt,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ye&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const dt=V[this.currentLayer],ct=r.getLayerSourceCache(dt);if(dt.isSky())continue;const jt=ct?(dt.is3D()?Se:be)[ct.id]:void 0;this._renderTileClippingMasks(dt,ct,jt),this.renderLayer(this,ct,dt,jt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ye&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const dt=V[this.currentLayer],ct=r.getLayerSourceCache(dt);dt.isSky()&&this.renderLayer(this,ct,dt,ct?be[ct.id]:void 0)}function Xe(dt,ct){let jt;return ct&&(jt=(dt.type==="symbol"?ye:dt.is3D()?Se:be)[ct.id]),jt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<S.length;){const dt=V[this.currentLayer];if(dt.type==="raster"||dt.type==="raster-particle"){const ct=r.getLayerSourceCache(dt);this.renderLayer(this,ct,dt,Xe(dt,ct))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let nt=0;He&&(nt=He.getShadowCastingLayerCount());let lt=!1,vt=-1;for(let dt=0;dt<S.length;++dt){const ct=V[dt];ct.isHidden(this.transform.zoom)||ct.is3D()&&(vt=dt)}for(z&&vt===-1&&(E=!0);this.currentLayer<S.length;){const dt=V[this.currentLayer],ct=r.getLayerSourceCache(dt);if(dt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(dt)){if(dt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(E&&!lt&&this.terrain&&!this.transform.isOrthographic&&(lt=!0,this.blitDepth()),z&&vt!==-1&&this.currentLayer===vt+1&&!this.transform.isOrthographic&&this.blitDepth(),dt.is3D()||this.terrain||this._renderTileClippingMasks(dt,ct,ct?ae[ct.id]:void 0),this.renderLayer(this,ct,dt,Xe(dt,ct)),!this.terrain&&He&&nt>0&&dt.hasShadowPass()&&--nt==0&&(He.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const jt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=jt;this.currentLayer++){const en=V[this.currentLayer];if(!en.hasLightBeamPass())continue;const gn=r.getLayerSourceCache(en);this.renderLayer(this,gn,en,gn?be[gn.id]:void 0)}this.currentLayer=jt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const jt=this.currentLayer;this.depthOcclusion=!0;for(const en of this.layersWithOcclusionOpacity){this.currentLayer=en;const gn=V[this.currentLayer],An=r.getLayerSourceCache(gn),Dn=An?be[An.id]:void 0;gn.is3D()||this.terrain||this._renderTileClippingMasks(gn,An,An?ae[An.id]:void 0),this.renderLayer(this,An,gn,Dn)}this.depthOcclusion=!1,this.currentLayer=jt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let dt=null;V.forEach(ct=>{const jt=r.getLayerSourceCache(ct);jt&&!ct.isHidden(this.transform.zoom)&&jt.getVisibleCoordinates().length&&(!dt||dt.getSource().maxzoom<jt.getSource().maxzoom)&&(dt=jt)}),dt&&this.options.showTileBoundaries&&Qh.debug(this,dt,dt.getVisibleCoordinates(),o.bA.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Qh.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.bA(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(dt){const ct=dt.transform.padding;Ot(dt,dt.transform.height-(ct.top||0),3,Rd),Ot(dt,ct.bottom||0,3,Ld),Pg(dt,ct.left||0,3,Rn),Pg(dt,dt.transform.width-(ct.right||0),3,_o);const jt=dt.transform.centerPoint;(function(en,gn,An,Dn){ju(en,gn-1,An-10,2,20,Dn),ju(en,gn-10,An-1,20,2,Dn)})(dt,jt.x,dt.transform.height-jt.y,Od)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),X||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,m=!l||!l.includes(r.type);if(Ec[r.type]&&(m||this.terrain&&r.type==="custom")){const b=this.style.getLayerSourceCache(r);Ec[r.type](r,b,this)}this.gpuTimingEnd()}renderLayer(r,l,m,b){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||b&&b.length)&&(this.id=m.id,this.gpuTimingStart(m),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(m.type)&&(!r.terrain||m.type!=="custom")||m.type==="clip"||Qh[m.type](r,l,m,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,m=this.context.gl;let b=this.gpuTimers[r.id];b||(b=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:m.createQuery()}),b.calls++,m.beginQuery(l.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,m=l.createQuery();this.deferredRenderGpuTimeQueries.push(m),l.beginQuery(r.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const m in r){const b=r[m],S=this.context.extTimerQuery,E=S.getQueryParameter(b.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(b.query),l[m]=E}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let m=0;for(const b of r)m+=l.getQueryParameter(b,l.QUERY_RESULT)/1e6,l.deleteQuery(b);return m}translatePosMatrix(r,l,m,b,S){if(!m[0]&&!m[1])return r;const E=S?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(E){const q=Math.sin(E),H=Math.cos(E);m=[m[0]*H-m[1]*q,m[0]*q+m[1]*H]}const z=[S?m[0]:o.ak(l,m[0],this.transform.zoom),S?m[1]:o.ak(l,m[1],this.transform.zoom),0],V=new Float32Array(16);return o.a6.mat4.translate(V,r,z),V}saveTileTexture(r){const l=r.size[0],m=this._tileTextures[l];m?m.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,m){const b=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,S=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):b||S.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||S.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&S.push("GLOBE"),!this._fogVisible||b||l!==void 0&&!l||S.push("FOG","FOG_DITHERING"),b&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(r,l){this.cache=this.cache||{};const m=l&&l.defines||[],b=l&&l.config,S=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(m),E=Tc.cacheKey(ns[r],r,S,b);return this.cache[E]||(this.cache[E]=new Tc(this.context,r,ns[r],b,Uu[r],S)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const m=this.style.directionalLight,b=this.style.ambientLight;if(m&&b){const S=((E,z,V)=>{const q=E.properties.get("direction"),H=E.properties.get("color").toRenderColor(V.getLut(E.scope)).toArray01(),X=E.properties.get("intensity"),ee=z.properties.get("color").toRenderColor(V.getLut(z.scope)).toArray01(),ae=z.properties.get("intensity"),be=[q.x,q.y,q.z],ye=o.cH(ee,ae),Te=o.cH(H,X);return{u_lighting_ambient_color:ye,u_lighting_directional_dir:be,u_lighting_directional_color:Te,u_ground_radiance:pg(be,Te,ye)}})(m,b,this.style);l.setLightsUniformValues(r,S)}}}uploadCommonUniforms(r,l,m,b,S){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const z=E.getOpacity(this.transform.pitch),V=((q,H,X,ee,ae,be,ye,Te,Se,De,je,He)=>{const Ye=q.transform,tt=H.properties.get("color").toRenderColor(q.style.getLut(H.scope)).toArray01();tt[3]=ee;const Xe=q.frameCounter/1e3%1,[nt,lt]=H.properties.get("vertical-range");return{u_fog_matrix:X?Ye.calculateFogTileMatrix(X):He||q.identityMat,u_fog_range:H.getFovAdjustedRange(Ye._fov),u_fog_color:tt,u_fog_horizon_blend:H.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(nt,lt),lt],u_fog_temporal_offset:Xe,u_frustum_tl:ae,u_frustum_tr:be,u_frustum_br:ye,u_frustum_bl:Te,u_globe_pos:Se,u_globe_radius:De,u_viewport:je,u_globe_transition:o.a9(Ye.zoom),u_is_globe:+(Ye.projection.name==="globe")}})(this,E,m,z,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.q.devicePixelRatio,this.transform.height*o.q.devicePixelRatio],b);l.setFogUniformValues(r,V)}S&&l.setCutoffUniformValues(r,S.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const b of m)l[b.key]=r[b.key]||new Vs(b,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=gt||l[1]>=gt}setupDepthForOcclusion(r,l,m){const b=this.context,S=b.gl,E=!!m;var z;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),b.activeTexture.set(S.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((z=this.depthRangeFor3D)[1]-z[0]),-1-2*z[0]/(z[1]-z[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),b.activeTexture.set(S.TEXTURE0),E||l.setTerrainUniformValues(b,m)}}function Mc(f,r){let l=!1,m=null;const b=()=>{m=null,l&&(f(),m=setTimeout(b,r),l=!1)};return()=>(l=!0,m||b(),m)}class wp{constructor(r){this._hashName=r&&encodeURIComponent(r),o.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Mc(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=ef(r);if(this._hashName){const m=this._hashName;let b=!1;const S=location.hash.slice(1).split("&").map(E=>{const z=E.split("=")[0];return z===m?(b=!0,`${z}=${l}`):E}).filter(E=>E);return b||S.push(`${m}=${l}`),`#${S.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(l=m)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(m=>isNaN(m))){const m=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:m,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function ef(f,r){const l=f.getCenter(),m=Math.round(100*f.getZoom())/100,b=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,b),E=Math.round(l.lng*S)/S,z=Math.round(l.lat*S)/S,V=f.getBearing(),q=f.getPitch();let H=r?`/${E}/${z}/${m}`:`${m}/${z}/${E}`;return(V||q)&&(H+="/"+Math.round(10*V)/10),q&&(H+=`/${Math.round(q)}`),H}const zd={linearity:.3,easing:o.dp(0,0,.3,1)},Fg=o.l({deceleration:2500,maxSpeed:1400},zd),Bg=o.l({deceleration:20,maxSpeed:1400},zd),mu=o.l({deceleration:1e3,maxSpeed:360},zd),Ng=o.l({deceleration:1e3,maxSpeed:90},zd);class Sp{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=o.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)l.zoom+=S.zoomDelta||0,l.bearing+=S.bearingDelta||0,l.pitch+=S.pitchDelta||0,S.panDelta&&l.pan._add(S.panDelta),S.around&&(l.around=S.around),S.pinchAround&&(l.pinchAround=S.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(l.pan.mag()){const S=Bd(l.pan.mag(),m,o.l({},Fg,r||{}));b.offset=l.pan.mult(S.amount/l.pan.mag()),b.center=this._map.transform.center,Fd(b,S)}if(l.zoom){const S=Bd(l.zoom,m,Bg);b.zoom=this._map.transform.zoom+S.amount,Fd(b,S)}if(l.bearing){const S=Bd(l.bearing,m,mu);b.bearing=this._map.transform.bearing+o.ap(S.amount,-179,179),Fd(b,S)}if(l.pitch){const S=Bd(l.pitch,m,Ng);b.pitch=this._map.transform.pitch+S.amount,Fd(b,S)}if(b.zoom||b.bearing){const S=l.pinchAround===void 0?l.around:l.pinchAround;b.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function Fd(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function Bd(f,r,l){const{maxSpeed:m,linearity:b,deceleration:S}=l,E=o.ap(f*b/(r/1e3),-m,m),z=Math.abs(E)/(S*b);return{easing:l.easing,duration:1e3*z,amount:E*(z/2)}}class bi extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m,b={}){const S=me(l.getCanvasContainer(),m),E=l.unproject(S);super(r,o.l({point:S,lngLat:E,originalEvent:m},b)),this._defaultPrevented=!1,this.target=l}}class Nd extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,m){const b=r==="touchend"?m.changedTouches:m.touches,S=de(l.getCanvasContainer(),b),E=S.map(V=>l.unproject(V)),z=S.reduce((V,q,H,X)=>V.add(q.div(X.length)),new o.P(0,0));super(r,{points:S,point:z,lngLats:E,lngLat:l.unproject(z),originalEvent:m}),this._defaultPrevented=!1}}class $g extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class $d{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new $g(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new bi(r.type,this._map,r))}mouseup(r){this._map.fire(new bi(r.type,this._map,r))}preclick(r){const l=o.l({},r);l.type="preclick",this._map.fire(new bi(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new bi(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new bi(r.type,this._map,r))}mouseover(r){this._map.fire(new bi(r.type,this._map,r))}mouseout(r){this._map.fire(new bi(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Nd(r.type,this._map,r))}touchmove(r){this._map.fire(new Nd(r.type,this._map,r))}touchend(r){this._map.fire(new Nd(r.type,this._map,r))}touchcancel(r){this._map.fire(new Nd(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gu{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new bi(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new bi(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vg{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(G(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const m=l,b=this._startPos,S=this._lastPos;if(!b||!S||S.equals(m)||!this._box&&m.dist(b)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=D("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const E=Math.min(b.x,m.x),z=Math.max(b.x,m.x),V=Math.min(b.y,m.y),q=Math.max(b.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${V}px)`,this._box.style.width=z-E+"px",this._box.style.height=q-V+"px")})}mouseupWindow(r,l){if(!this._active)return;const m=this._startPos,b=l;if(m&&r.button===0){if(this.reset(),se(),m.x!==b.x||m.y!==b.y)return this._map.fire(new o.x("boxzoomend",{originalEvent:r})),{cameraAnimation:S=>S.fitScreenCoordinates(m,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),J(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new o.x(r,{originalEvent:l}))}}function Tp(f,r){const l={};for(let m=0;m<f.length;m++)l[f[m].identifier]=r[m];return l}class Sy{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(b){const S=new o.P(0,0);for(const E of b)S._add(E);return S.div(b.length)}(l),this.touches=Tp(m,l)))}touchmove(r,l,m){if(this.aborted||!this.centroid)return;const b=Tp(m,l);for(const S in this.touches){const E=b[S];(!E||E.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(r,l,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class tf{constructor(r){this.singleTap=new Sy(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,m){this.singleTap.touchstart(r,l,m)}touchmove(r,l,m){this.singleTap.touchmove(r,l,m)}touchend(r,l,m){const b=this.singleTap.touchend(r,l,m);if(b){const S=r.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(b)<30;if(S&&E||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Ug{constructor(){this._zoomIn=new tf({numTouches:1,numTaps:2}),this._zoomOut=new tf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,m){this._zoomIn.touchstart(r,l,m),this._zoomOut.touchstart(r,l,m)}touchmove(r,l,m){this._zoomIn.touchmove(r,l,m),this._zoomOut.touchmove(r,l,m)}touchend(r,l,m){const b=this._zoomIn.touchend(r,l,m),S=this._zoomOut.touchend(r,l,m);return b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(b)},{originalEvent:r})}):S?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(S)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const nf={0:1,2:2};class of{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const m=ce(r);this._correctButton(r,m)&&(this._lastPoint=l,this._eventButton=m)}mousemoveWindow(r,l){const m=this._lastPoint;if(m){if(r.preventDefault(),this._eventButton!=null&&function(b,S){const E=nf[S];return b.buttons===void 0||(b.buttons&E)!==E}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(m,l)}}mouseupWindow(r){this._lastPoint&&ce(r)===this._eventButton&&(this._moved&&se(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cp extends of{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class Ep extends of{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=.8*(l.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class Mp extends of{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const m=-.5*(l.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class Ty{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),o.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(r,l,m){return this._calculateTransform(r,l,m)}touchmove(r,l,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!o.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,m)}}touchend(r,l,m){this._calculateTransform(r,l,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,m){m.length>0&&(this._active=!0);const b=Tp(m,l),S=new o.P(0,0),E=new o.P(0,0);let z=0;for(const q in b){const H=b[q],X=this._touches[q];X&&(S._add(H),E._add(H.sub(X)),z++,b[q]=H)}if(this._touches=b,z<this._minTouches||!E.mag())return;const V=E.div(z);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(z),panDelta:V}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Ip{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,m){return{}}touchstart(r,l,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,m){const b=this._firstTwoTouches;if(!b)return;r.preventDefault();const[S,E]=b,z=rf(m,l,S),V=rf(m,l,E);if(!z||!V)return;const q=this._aroundCenter?null:z.add(V).div(2);return this._move([z,V],q,r)}touchend(r,l,m){if(!this._firstTwoTouches)return;const[b,S]=this._firstTwoTouches,E=rf(m,l,b),z=rf(m,l,S);E&&z||(this._active&&se(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function rf(f,r,l){for(let m=0;m<f.length;m++)if(f[m].identifier===l)return r[m]}function jg(f,r){return Math.log(f/r)/Math.LN2}class Cy extends Ip{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(jg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:jg(this._distance,m),pinchAround:l}}}function Hg(f,r){return 180*f.angleWith(r)/Math.PI}class Ey extends Ip{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const m=this._vector;if(this._vector=r[0].sub(r[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Hg(this._vector,m),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const b=Hg(r,m);return Math.abs(b)<l}}function Ap(f){return Math.abs(f.y)>Math.abs(f.x)}class My extends Ip{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Ap(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,m){const b=this._lastPoints;if(!b)return;const S=r[0].sub(b[0]),E=r[1].sub(b[1]);return this._map._cooperativeGestures&&!o.dq()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(S,E,m.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(S.y+E.y)/2*-.5})}gestureBeginsVertically(r,l,m){if(this._valid!==void 0)return this._valid;const b=r.mag()>=2,S=l.mag()>=2;if(!b&&!S)return;if(!b||!S)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const E=r.y>0==l.y>0;return Ap(r)&&Ap(l)&&E}}const Iy={panStep:100,bearingStep:15,pitchStep:10};class Ay{constructor(){const r=Iy;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,m=0,b=0,S=0,E=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),S=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),S=1);break;case 38:r.shiftKey?b=1:(r.preventDefault(),E=-1);break;case 40:r.shiftKey?b=-1:(r.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(m=0,b=0),{cameraAnimation:z=>{const V=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:ky,zoom:l?Math.round(V)+l*(r.shiftKey?2:1):V,bearing:z.getBearing()+m*this._bearingStep,pitch:z.getPitch()+b*this._pitchStep,offset:[-S*this._panStep,-E*this._panStep],center:z.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ky(f){return f*(2-f)}const Gg=4.000244140625,W1=1/450;class q1{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=W1,o.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=o.q.now(),b=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,l!==0&&l%Gg==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(b*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=me(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const q=this._type==="wheel"&&Math.abs(this._delta)>Gg?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*q)));this._delta<0&&H!==0&&(H=1/H);const X=l(),ee=Math.pow(2,X),ae=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):ee;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(ae*H))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:l(),b=this._startZoom,S=this._easing;let E,z=!1;if(this._type==="wheel"&&b&&S){const q=Math.min((o.q.now()-this._lastWheelEventTime)/200,1),H=S(q);E=o.aa(b,m,H),q<1?this._frameId||(this._frameId=!0):z=!0}else E=m,z=!0;this._active=!0,z&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let V=E-l();return V*this._lastDelta<0&&(V=0),{noInertia:!0,needsRenderFrame:!z,zoomDelta:V,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=o.dr;if(this._prevEase){const m=this._prevEase,b=(o.q.now()-m.start)/m.duration,S=m.easing(b+.01)-m.easing(b),E=.27/Math.sqrt(S*S+1e-4)*.01,z=Math.sqrt(.0729-E*E);l=o.dp(E,z,.25,1)}return this._prevEase={start:o.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ki{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Py{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class K1{constructor(){this._tap=new tf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=l[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,l,m))}touchmove(r,l,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const b=l[0],S=b.y-this._swipePoint.y;return this._swipePoint=b,r.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(r,l,m)}touchend(r,l,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,l,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Z1{constructor(r,l,m){this._el=r,this._mousePan=l,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class af{constructor(r,l,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ry{constructor(r,l,m,b){this._el=r,this._touchZoom=l,this._touchRotate=m,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Vd=f=>f.zoom||f.drag||f.pitch||f.rotate;class kp extends o.x{}class Ic{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const m=o.a6.vec3.sub([],l,r);this.radius=o.a6.vec3.length(m[2]<0?o.a6.vec3.div([],m,this.constants):[m[0],m[1],0])}projectRay(r){o.a6.vec3.div(r,r,this.constants),o.a6.vec3.normalize(r,r),o.a6.vec3.mul(r,r,this.constants);const l=o.a6.vec3.scale([],r,this.radius);if(l[2]>0){const m=o.a6.vec3.scale([],[0,0,1],o.a6.vec3.dot(l,[0,0,1])),b=o.a6.vec3.scale([],o.a6.vec3.normalize([],[l[0],l[1],0]),this.radius),S=o.a6.vec3.add([],l,o.a6.vec3.scale([],o.a6.vec3.sub([],o.a6.vec3.add([],b,m),l),2));l[0]=S[0],l[1]=S[1]}return l}}function Wu(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Qi{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sp(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ic,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),o.aJ(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,S,E]of this._listeners){const z=b===document?this.handleWindowEvent:this.handleEvent;b.addEventListener(S,z,E)}}destroy(){for(const[r,l,m]of this._listeners){const b=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,b,m)}}_addDefaultHandlers(r){const l=this._map,m=l.getCanvasContainer();this._add("mapEvent",new $d(l,r));const b=l.boxZoom=new Vg(l,r);this._add("boxZoom",b);const S=new Ug,E=new Py;l.doubleClickZoom=new ki(E,S),this._add("tapZoom",S),this._add("clickZoom",E);const z=new K1;this._add("tapDragZoom",z);const V=l.touchPitch=new My(l);this._add("touchPitch",V);const q=new Ep(r),H=new Mp(r);l.dragRotate=new af(r,q,H),this._add("mouseRotate",q,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const X=new Cp(r),ee=new Ty(l,r);l.dragPan=new Z1(m,X,ee),this._add("mousePan",X),this._add("touchPan",ee,["touchZoom","touchRotate"]);const ae=new Ey,be=new Cy;l.touchZoomRotate=new Ry(m,be,ae,z),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Gu(l));const ye=l.scrollZoom=new q1(l,this);this._add("scrollZoom",ye,["mousePan"]);const Te=l.keyboard=new Ay;this._add("keyboard",Te);for(const Se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[Se]&&l[Se].enable(r[Se])}_add(r,l,m){this._handlers.push({handlerName:r,handler:l,allowed:m}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Vd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,m){for(const b in r)if(b!==m&&(!l||l.indexOf(b)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const m of r)this._el.contains(m.target)&&l.push(m);return l}handleEvent(r,l){this._updatingCamera=!0;const m=r.type==="renderFrame",b=m?void 0:r,S={needsRenderFrame:!1},E={},z={},V=r.touches?this._getMapTouches(r.touches):void 0,q=V?de(this._el,V):m?void 0:me(this._el,r);for(const{handlerName:ee,handler:ae,allowed:be}of this._handlers){if(!ae.isEnabled())continue;let ye;this._blockedByActive(z,be,ee)?ae.reset():ae[l||r.type]&&(ye=ae[l||r.type](r,q,V),this.mergeHandlerResult(S,E,ye,ee,b),ye&&ye.needsRenderFrame&&this._triggerRenderFrame()),(ye||ae.isActive())&&(z[ee]=ae)}const H={};for(const ee in this._previousActiveHandlers)z[ee]||(H[ee]=b);this._previousActiveHandlers=z,(Object.keys(H).length||Wu(S))&&(this._changes.push([S,E,H]),this._triggerRenderFrame()),(Object.keys(z).length||Wu(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=S;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(r,l,m,b,S){if(!m)return;o.l(r,m);const E={handlerName:b,originalEvent:m.originalEvent||S};m.zoomDelta!==void 0&&(l.zoom=E),m.panDelta!==void 0&&(l.drag=E),m.pitchDelta!==void 0&&(l.pitch=E),m.bearingDelta!==void 0&&(l.rotate=E)}_applyChanges(){const r={},l={},m={};for(const[b,S,E]of this._changes)b.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(b.panDelta)),b.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(r.around=b.around),b.aroundCoord!==void 0&&(r.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(r.pinchAround=b.pinchAround),b.noInertia&&(r.noInertia=b.noInertia),o.l(l,S),o.l(m,E);this._updateMapTransform(r,l,m),this._changes=[]}_updateMapTransform(r,l,m){const b=this._map,S=b.transform,E=De=>[De.x,De.y,De.z];if((De=>{const je=this._eventsInProgress.drag;return je&&!this._handlersById[je.handlerName].isActive()})()&&!Wu(r)){const De=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),De!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&b._stop(!0),!Wu(r))return void this._fireEvents(l,m,!0);let{panDelta:z,zoomDelta:V,bearingDelta:q,pitchDelta:H,around:X,aroundCoord:ee,pinchAround:ae}=r;S._isCameraConstrained&&(V>0&&(V=0),S._isCameraConstrained=!1),ae!==void 0&&(X=ae),(V||(De=>l[De]&&!this._eventsInProgress[De])("drag"))&&X&&(this._dragOrigin=E(S.pointCoordinate3D(X)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",b._stop(!0),X=X||b.transform.centerPoint,q&&(S.bearing+=q),H&&(S.pitch+=H),S._updateCameraState();const be=[0,0,0];if(z)if(S.projection.name==="mercator"){const De=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X).dir),je=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(X.sub(z)).dir);be[0]=je[0]-De[0],be[1]=je[1]-De[1]}else{const De=S.pointCoordinate(X);if(S.projection.name==="globe"){z=z.rotate(-S.angle);const je=S._pixelsPerMercatorPixel/S.worldSize;be[0]=-z.x*o.ds(o.aN(De.y))*je,be[1]=-z.y*o.ds(S.center.lat)*je}else{const je=S.pointCoordinate(X.sub(z));De&&je&&(be[0]=je.x-De.x,be[1]=je.y-De.y)}}const ye=S.zoom,Te=[0,0,0];if(V){const De=E(ee||S.pointCoordinate3D(X)),je={dir:o.a6.vec3.normalize([],o.a6.vec3.sub([],De,S._camera.position))};if(je.dir[2]<0){const He=S.zoomDeltaToMovement(De,V);o.a6.vec3.scale(Te,je.dir,He)}}const Se=o.a6.vec3.add(be,be,Te);S._translateCameraConstrained(Se),V&&Math.abs(S.zoom-ye)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,m,!0)}_fireEvents(r,l,m){const b=Vd(this._eventsInProgress),S=Vd(r),E={};for(const H in r){const{originalEvent:X}=r[H];this._eventsInProgress[H]||(E[`${H}start`]=X),this._eventsInProgress[H]=r[H]}!b&&S&&this._fireEvent("movestart",S.originalEvent);for(const H in E)this._fireEvent(H,E[H]);S&&this._fireEvent("move",S.originalEvent);for(const H in r){const{originalEvent:X}=r[H];this._fireEvent(H,X)}const z={};let V;for(const H in this._eventsInProgress){const{handlerName:X,originalEvent:ee}=this._eventsInProgress[H];this._handlersById[X].isActive()||(delete this._eventsInProgress[H],V=l[X]||ee,z[`${H}end`]=V)}for(const H in z)this._fireEvent(H,z[H]);const q=Vd(this._eventsInProgress);if(m&&(b||S)&&!q){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;H?(X(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:V})):(this._map.fire(new o.x("moveend",{originalEvent:V})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new o.x(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new kp("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ul="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Wg extends o.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,o.aJ(["_renderFrameCallback"],this)}getCenter(){return new o.bL(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,m){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.l({offset:r},l),m)}panTo(r,l,m){return this.easeTo(o.l({center:r},l),m)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,m){return this.easeTo(o.l({zoom:r},l),m)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,m){return this.easeTo(o.l({bearing:r},l),m)}resetNorth(r,l){return this.rotateTo(0,o.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(o.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=o.as.convert(r);const m=l&&l.bearing||0,b=l&&l.pitch||0,S=r.getNorthWest(),E=r.getSouthEast();return this._cameraForBounds(this.transform,S,E,m,b,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?o.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:o.l({},l,r)}_extendCameraOptions(r){return(r=o.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const m=l.max[0]-l.min[0],b=l.max[1]-l.min[1];return m/b>r.aspect?m/(2*Math.tan(.5*r.fovX)*r.aspect):b/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,m,b,S,E){const z=r.clone(),V=this._extendCameraOptions(E);z.bearing=b,z.pitch=S;const q=o.bL.convert(l),H=o.bL.convert(m),X=.5*(q.lat+H.lat),ee=.5*(q.lng+H.lng),ae=o.dt(X,ee),be=o.a6.vec3.normalize([],ae),ye=o.a6.vec3.normalize([],o.a6.vec3.cross([],be,[0,1,0])),Te=o.a6.vec3.cross([],ye,be),Se=[ye[0],ye[1],ye[2],0,Te[0],Te[1],Te[2],0,be[0],be[1],be[2],0,0,0,0,1],De=[ae,o.dt(q.lat,q.lng),o.dt(H.lat,q.lng),o.dt(H.lat,H.lng),o.dt(q.lat,H.lng),o.dt(X,q.lng),o.dt(X,H.lng),o.dt(q.lat,ee),o.dt(H.lat,ee)];let je=o.ca.fromPoints(De.map(Xt=>[o.a6.vec3.dot(ye,Xt),o.a6.vec3.dot(Te,Xt),o.a6.vec3.dot(be,Xt)]));const He=o.a6.vec3.transformMat4([],je.center,Se);o.a6.vec3.squaredLength(He)===0&&o.a6.vec3.set(He,0,0,1),o.a6.vec3.normalize(He,He),o.a6.vec3.scale(He,He,o.aq),z.center=o.du(He);const Ye=z.getWorldToCameraMatrix(),tt=o.a6.mat4.invert(new Float64Array(16),Ye);je=o.ca.applyTransform(je,o.a6.mat4.multiply([],Ye,Se));const Xe=this._extendAABB(je,z,V,b);if(!Xe)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");je=Xe,o.a6.vec3.transformMat4(He,He,Ye);const nt=.5*(je.max[2]-je.min[2]),lt=this._minimumAABBFrustumDistance(z,je),vt=o.a6.vec3.scale([],[0,0,1],nt),dt=o.a6.vec3.add(vt,He,vt),ct=lt+(z.pitch===0?0:o.a6.vec3.distance(He,dt)),jt=z.globeCenterInViewSpace,en=o.a6.vec3.sub([],He,[jt[0],jt[1],jt[2]]);o.a6.vec3.normalize(en,en),o.a6.vec3.scale(en,en,ct);const gn=o.a6.vec3.add([],He,en);o.a6.vec3.transformMat4(gn,gn,tt);const An=o.dw/o.aq,Dn=o.a6.vec3.length(gn),It=o.bE(Math.max(Dn*An-o.dw,Number.EPSILON),0),pn=Math.min(z.zoomFromMercatorZAdjusted(It),V.maxZoom);return pn>.5*(o.c3+o.bV)?(z.setProjection({name:"mercator"}),z.zoom=pn,this._cameraForBounds(z,l,m,b,S,E)):{center:z.center,zoom:pn,bearing:b,pitch:S}}_extendAABB(r,l,m,b){const S=.5*((m.padding.left||0)+(m.padding.right||0)),E=.5*((m.padding.top||0)+(m.padding.bottom||0)),z=E,V=S,q=S,H=E,X=l.width-(V+q),ee=l.height-(z+H),ae=o.a6.vec3.sub([],r.max,r.min),be=Math.min(X/ae[0],ee/ae[1]),ye=Math.min(l.scaleZoom(l.scale*be),m.maxZoom);if(isNaN(ye))return null;const Te=l.scale/l.zoomScale(ye),Se=new o.ca([r.min[0]-V*Te,r.min[1]-H*Te,r.min[2]],[r.max[0]+q*Te,r.max[1]+z*Te,r.max[2]]),De=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new o.P(m.offset.x,m.offset.y):o.P.convert(m.offset)).rotate(-o.bC(b));return Se.center[0]-=De.x*Te,Se.center[1]+=De.y*Te,Se}queryTerrainElevation(r,l){const m=this.transform.elevation;return m?(l=o.l({},{exaggerated:!0},l),m.getAtPoint(o.a5.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,m,b,S,E){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,m,b,S,E);const z=r.clone(),V=this._extendCameraOptions(E);z.bearing=b,z.pitch=S;const q=o.bL.convert(l),H=o.bL.convert(m),X=new o.bL(q.lng,H.lat),ee=new o.bL(H.lng,q.lat),ae=z.project(q),be=z.project(H),ye=this.queryTerrainElevation(q),Te=this.queryTerrainElevation(H),Se=this.queryTerrainElevation(X),De=this.queryTerrainElevation(ee),je=[[ae.x,ae.y,Math.min(ye||0,Te||0,Se||0,De||0)],[be.x,be.y,Math.max(ye||0,Te||0,Se||0,De||0)]];let He=o.ca.fromPoints(je);const Ye=z.getWorldToCameraMatrix(),tt=o.a6.mat4.invert(new Float64Array(16),Ye);He=o.ca.applyTransform(He,Ye);const Xe=this._extendAABB(He,z,V,b);if(!Xe)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");He=Xe;const nt=.5*o.a6.vec3.sub([],He.max,He.min)[2],lt=this._minimumAABBFrustumDistance(z,He),vt=[0,0,1,0];o.a6.vec4.transformMat4(vt,vt,Ye),o.a6.vec4.normalize(vt,vt);const dt=o.a6.vec3.scale([],vt,lt+nt),ct=o.a6.vec3.add([],He.center,dt);o.a6.vec3.transformMat4(He.center,He.center,tt),o.a6.vec3.transformMat4(ct,ct,tt);const jt=z.unproject(new o.P(He.center[0],He.center[1])),en=o.dv(z.projection,jt),gn=Math.pow(2,en),An=Math.min(z._zoomFromMercatorZ(ct[2]*z.pixelsPerMeter*gn/z.worldSize),V.maxZoom);return z.mercatorFromTransition&&An<.5*(o.c3+o.bV)?(z.setProjection({name:"globe"}),z.zoom=An,this._cameraForBounds(z,l,m,b,S,E)):{center:jt,zoom:An,bearing:b,pitch:S}}fitBounds(r,l,m){const b=this.cameraForBounds(r,l);return this._fitInternal(b,l,m)}fitScreenCoordinates(r,l,m,b,S){const E=o.P.convert(r),z=o.P.convert(l),V=new o.P(Math.min(E.x,z.x),Math.min(E.y,z.y)),q=new o.P(Math.max(E.x,z.x),Math.max(E.y,z.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,z))return this;const H=this.transform.pointLocation3D(V),X=this.transform.pointLocation3D(q),ee=this.transform.pointLocation3D(new o.P(V.x,q.y)),ae=this.transform.pointLocation3D(new o.P(q.x,V.y)),be=[Math.min(H.lng,X.lng,ee.lng,ae.lng),Math.min(H.lat,X.lat,ee.lat,ae.lat)],ye=[Math.max(H.lng,X.lng,ee.lng,ae.lng),Math.max(H.lat,X.lat,ee.lat,ae.lat)],Te=b&&b.pitch?b.pitch:this.getPitch(),Se=this._cameraForBounds(this.transform,be,ye,m,Te,b);return this._fitInternal(Se,b,S)}_fitInternal(r,l,m){return r?(l=o.l(r,l)).linear?this.easeTo(l,m):this.flyTo(l,m):this}jumpTo(r,l){this.stop();const m=r.preloadOnly?this.transform.clone():this.transform;let b=!1,S=!1,E=!1;"zoom"in r&&m.zoom!==+r.zoom&&(b=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=o.bL.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(S=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(E=!0,m.pitch=+r.pitch);const z=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!m.isPaddingEqual(z))if(r.retainPadding===!1){const V=m.clone();V.padding=z,m.setLocationAtPoint(m.center,V.centerPoint)}else m.padding=z;return r.preloadOnly?(this._preloadTiles(m),this):(this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),b&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),S&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),E&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(Ul),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const m=this.transform;if(!m.projection.supportsFreeCamera)return o.w(Ul),this;this.stop();const b=m.zoom,S=m.pitch,E=m.bearing;m.setFreeCameraOptions(r);const z=b!==m.zoom,V=S!==m.pitch,q=E!==m.bearing;return this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),z&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),q&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),V&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=o.l({offset:[0,0],duration:500,easing:o.dr},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const m=this.transform,b=this.getZoom(),S=this.getBearing(),E=this.getPitch(),z=this.getPadding(),V="zoom"in r?+r.zoom:b,q="bearing"in r?this._normalizeBearing(r.bearing,S):S,H="pitch"in r?+r.pitch:E,X=this._extendPadding(r.padding),ee=o.P.convert(r.offset);let ae,be,ye;if(m.projection.name==="globe"){const vt=o.a5.fromLngLat(m.center),dt=ee.rotate(-m.angle);vt.x+=dt.x/m.worldSize,vt.y+=dt.y/m.worldSize;const ct=vt.toLngLat(),jt=o.bL.convert(r.center||ct);this._normalizeCenter(jt),ae=m.centerPoint.add(dt),be=new o.P(vt.x,vt.y).mult(m.worldSize),ye=new o.P(o.am(jt.lng),o.at(jt.lat)).mult(m.worldSize).sub(be)}else{ae=m.centerPoint.add(ee);const vt=m.pointLocation(ae),dt=o.bL.convert(r.center||vt);this._normalizeCenter(dt),be=m.project(vt),ye=m.project(dt).sub(be)}const Te=m.zoomScale(V-b);let Se,De;r.around&&(Se=o.bL.convert(r.around),De=m.locationPoint(Se));const je=this._zooming||V!==b,He=this._rotating||S!==q,Ye=this._pitching||H!==E,tt=!m.isPaddingEqual(X),Xe=r.retainPadding===!1?m.clone():m,nt=vt=>dt=>{if(je&&(vt.zoom=o.aa(b,V,dt)),He&&(vt.bearing=o.aa(S,q,dt)),Ye&&(vt.pitch=o.aa(E,H,dt)),tt&&(Xe.interpolatePadding(z,X,dt),ae=Xe.centerPoint.add(ee)),Se)vt.setLocationAtPoint(Se,De);else{const ct=vt.zoomScale(vt.zoom-b),jt=V>b?Math.min(2,Te):Math.max(.5,Te),en=Math.pow(jt,1-dt),gn=vt.unproject(be.add(ye.mult(dt*en)).mult(ct));vt.setLocationAtPoint(vt.renderWorldCopies?gn.wrap():gn,ae)}return r.preloadOnly||this._fireMoveEvents(l),vt};if(r.preloadOnly){const vt=this._emulate(nt,r.duration,m);return this._preloadTiles(vt),this}const lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=je,this._rotating=He,this._pitching=Ye,this._padding=tt,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,lt),this._ease(nt(m),vt=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(l,vt)},r),this}_prepareEase(r,l,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||m.moving||this.fire(new o.x("movestart",r)),this._zooming&&!m.zooming&&this.fire(new o.x("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new o.x("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new o.x("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.x("move",r)),this._zooming&&this.fire(new o.x("zoom",r)),this._rotating&&this.fire(new o.x("rotate",r)),this._pitching&&this.fire(new o.x("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,b=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new o.x("zoomend",r)),b&&this.fire(new o.x("rotateend",r)),S&&this.fire(new o.x("pitchend",r)),this.fire(new o.x("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const Xt=o.ar(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Xt,l)}this.stop(),r=o.l({offset:[0,0],speed:1.2,curve:1.42,easing:o.dr},r);const m=this.transform,b=this.getZoom(),S=this.getBearing(),E=this.getPitch(),z=this.getPadding(),V="zoom"in r?o.ap(+r.zoom,m.minZoom,m.maxZoom):b,q="bearing"in r?this._normalizeBearing(r.bearing,S):S,H="pitch"in r?+r.pitch:E,X=this._extendPadding(r.padding),ee=m.zoomScale(V-b),ae=o.P.convert(r.offset);let be=m.centerPoint.add(ae);const ye=m.pointLocation(be),Te=o.bL.convert(r.center||ye);this._normalizeCenter(Te);const Se=m.project(ye),De=m.project(Te).sub(Se);let je=r.curve;const He=Math.max(m.width,m.height),Ye=He/ee,tt=De.mag();if("minZoom"in r){const Xt=o.ap(Math.min(r.minZoom,b,V),m.minZoom,m.maxZoom),mn=He/m.zoomScale(Xt-b);je=Math.sqrt(mn/tt*2)}const Xe=je*je;function nt(Xt){const mn=(Ye*Ye-He*He+(Xt?-1:1)*Xe*Xe*tt*tt)/(2*(Xt?Ye:He)*Xe*tt);return Math.log(Math.sqrt(mn*mn+1)-mn)}function lt(Xt){return(Math.exp(Xt)-Math.exp(-Xt))/2}function vt(Xt){return(Math.exp(Xt)+Math.exp(-Xt))/2}const dt=nt(0);let ct=function(Xt){return vt(dt)/vt(dt+je*Xt)},jt=function(Xt){return He*((vt(dt)*(lt(mn=dt+je*Xt)/vt(mn))-lt(dt))/Xe)/tt;var mn},en=(nt(1)-dt)/je;if(Math.abs(tt)<1e-6||!isFinite(en)){if(Math.abs(He-Ye)<1e-6)return this.easeTo(r,l);const Xt=Ye<He?-1:1;en=Math.abs(Math.log(Ye/He))/je,jt=function(){return 0},ct=function(mn){return Math.exp(Xt*je*mn)}}r.duration="duration"in r?+r.duration:1e3*en/("screenSpeed"in r?+r.screenSpeed/je:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const gn=S!==q,An=H!==E,Dn=!m.isPaddingEqual(X),It=r.retainPadding===!1?m.clone():m,pn=Xt=>mn=>{const wn=mn*en,hn=1/ct(wn);Xt.zoom=mn===1?V:b+Xt.scaleZoom(hn),gn&&(Xt.bearing=o.aa(S,q,mn)),An&&(Xt.pitch=o.aa(E,H,mn)),Dn&&(It.interpolatePadding(z,X,mn),be=It.centerPoint.add(ae));const Vn=mn===1?Te:Xt.unproject(Se.add(De.mult(jt(wn))).mult(hn));return Xt.setLocationAtPoint(Xt.renderWorldCopies?Vn.wrap():Vn,be),Xt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),Xt};if(r.preloadOnly){const Xt=this._emulate(pn,r.duration,m);return this._preloadTiles(Xt),this}return this._zooming=!0,this._rotating=gn,this._pitching=An,this._padding=Dn,this._prepareEase(l,!1),this._ease(pn(m),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,l)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,l,m){m.animate===!1||m.duration===0?(r(1),l()):(this._easeStart=o.q.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=o.bB(r,-180,180);const m=Math.abs(r-l);return Math.abs(r-360-l)<m&&(r-=360),Math.abs(r+360-l)<m&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const m=r.lng-l.center.lng;r.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&o.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,m){const b=Math.ceil(15*l/1e3),S=[],E=r(m.clone());for(let z=0;z<=b;z++){const V=E(z/b);S.push(V.clone())}return S}_preloadTiles(r,l){}}class Pp{constructor(r={}){this.options=r,o.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,m=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const b=D("span","mapboxgl-ctrl-icon",this._compactButton);return b.setAttribute("aria-hidden","true"),b.setAttribute("title",m),this._innerContainer=D("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(r){const m=l.reduce((b,S,E)=>(S.value&&(b+=`${S.key}=${S.value}${E<l.length-1?"&":""}`),b),"?");r.href=`${o.e.FEEDBACK_URL}/${m}#${ef(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const l=this._map.style._mergedSourceCaches;for(const b in l){const S=l[b];if(S.used){const E=S.getSource();E.attribution&&r.indexOf(E.attribution)<0&&r.push(E.attribution)}}r.sort((b,S)=>b.length-S.length),r=r.filter((b,S)=>{for(let E=S+1;E<r.length;E++)if(r[E].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class qg{constructor(){o.aJ(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=D("div","mapboxgl-ctrl");const l=D("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const m=r[l].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Ly{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,m=l?this._queue.concat(l):this._queue;for(const b of m)if(b.id===r)return void(b.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const m of l)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class sf{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=o.cw((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,m){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+m}}const Y1={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Oy=["mouseenter","mouseover","mouseleave","mouseout"];class Rp extends o.x{constructor(r,l,m,b){const{point:S,lngLat:E,originalEvent:z,target:V}=r;super(r.type,{point:S,lngLat:E,originalEvent:z,target:V}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=m,this.feature=b}}class Kg{constructor(r){this.map=r,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const{type:m,filter:b}=l;if(b){const E=o.M(b,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(E.result==="error")throw new Error(E.value.map(z=>`${z.key}: ${z.message}`).join(", "));this.filters.set(r,E.value)}const S=this.interactionsByType.get(m)||new Map;S.size===0&&(Oy.includes(m)?this.map.on(m,l.featureset,this.handleType):this.map.on(m,this.handleType),this.interactionsByType.set(m,S)),S.set(r,l),this.typeById.set(r,m)}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const m=this.interactionsByType.get(l);m&&(m.delete(r),m.size===0&&this.map.off(l,this.handleType))}handleType(r){const l=this.interactionsByType.get(r.type),m=Array.from(l).reverse(),b=[];for(const[,z]of m)z.featureset&&b.push({featureset:z.featureset,filter:z.filter,radius:z.radius});let S=this.map.style.queryRenderedFeaturesForInteractions(r.point,b,this.map.transform);!S.length&&Oy.includes(r.type)&&(S=[null]);let E=!1;for(const z of S){for(const[V,q]of m){const{handler:H,featureset:X}=q;if(X&&(z==null||o.bi(z.featureset,X))&&H(new Rp(r,V,q,z))!==!1){E=!0;break}}if(E)break}if(!E)for(const[z,V]of m){const{handler:q,featureset:H}=V;if(!H&&q(new Rp(r,z,V,null))!==!1)break}}}function lf(f,r){if(Array.isArray(f)&&Array.isArray(r)){const l=new Set(f),m=new Set(r);return l.size===m.size&&f.every(b=>m.has(b))}return o.bi(f,r)}const Ud={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1},Ac={showCompass:!0,showZoom:!0,visualizePitch:!1};class gl{constructor(r,l,m=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new Ep({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new Mp({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),G()}move(r,l){const m=this.map,b=this.mouseRotate.mousemoveWindow(r,l),S=b&&b.bearingDelta;if(S&&m.setBearing(m.getBearing()+S),this.mousePitch){const E=this.mousePitch.mousemoveWindow(r,l),z=E&&E.pitchDelta;z&&m.setPitch(m.getPitch()+z)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){J(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),me(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,me(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=de(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=de(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function kc(f,r,l){if(f=new o.bL(f.lng,f.lat),r){const m=new o.bL(f.lng-360,f.lat),b=new o.bL(f.lng+360,f.lat),S=360*Math.ceil(Math.abs(f.lng-l.center.lng)/360),E=l.locationPoint(f).distSqr(r),z=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(m).distSqr(r)<E&&(z||Math.abs(m.lng-l.center.lng)<S)?f=m:l.locationPoint(b).distSqr(r)<E&&(z||Math.abs(b.lng-l.center.lng)<S)&&(f=b)}for(;Math.abs(f.lng-l.center.lng)>180;){const m=l.locationPoint(f);if(m.x>=0&&m.y>=0&&m.x<=l.width&&m.y<=l.height)break;f.lng>l.center.lng?f.lng-=360:f.lng+=360}return f}const Pc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class jl extends o.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=o.l({element:r},l)),o.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=D("div");const S=41,E=27,z=j("svg",{display:"block",height:S*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${S}`},this._element),V=j("radialGradient",{id:"shadowGradient"},j("defs",{},z));j("stop",{offset:"10%","stop-opacity":.4},V),j("stop",{offset:"100%","stop-opacity":.05},V),j("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},z),j("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},z),j("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},z),j("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},z),this._offset=o.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const m=this._element.classList;for(const S in Pc)m.remove(`mapboxgl-marker-anchor-${S}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`);const b=r&&r.className?r.className.trim().split(/\s+/):[];m.add(...b),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.bL.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,m=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,m=this._element;this._popup&&(l===m||m.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const m=r.unproject(l),b=r.getFreeCameraOptions();if(!b.position)return!1;const S=b.position.toLngLat();return S.distanceTo(m)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const m=r.unproject(l);let b;r._showingGlobe()&&o.dz(r.transform,this._lngLat)?b=0:(b=1-r._queryFogOpacity(m),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Pc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,m=this.getPitchAlignment();if(!l||!r||m!=="map")return"";if(!l._showingGlobe()){const V=l.getPitch();return V?`rotateX(${V}deg)`:""}const b=o.c1(o.dA(l.transform,this._lngLat)),S=r.sub(o.dB(l.transform)),E=Math.abs(S.x)+Math.abs(S.y);if(E===0)return"";const z=b/E;return`rotateX(${-S.y*z}deg) rotateY(${S.x*z}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let m=0;const b=this.getRotationAlignment();if(b==="map")if(l._showingGlobe()){const S=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat+.001)),E=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);m=o.c1(Math.atan2(E.y,E.x))-90}else m=-l.getBearing();else if(b==="horizon"){const S=o.a7(4,6,l.getZoom()),E=o.dB(l.transform);E.y+=S*l.transform.height;const z=r.sub(E),V=o.c1(Math.atan2(z.y,z.x));m=(V>90?V-270:V+90)*(1-S)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=kc(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const m=this._pointerdownPos,b=this._positionDelta;if(m&&b){if(!this._isDragging){const S=this._clickTolerance||l._clickTolerance;if(r.point.dist(m)<S)return;this._isDragging=!0}this._pos=r.point.sub(b),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.x("dragstart"))),this.fire(new o.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.x("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,m=this._pos;l&&m&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(m),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const X1={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},J1={maxWidth:100,unit:"metric"},Q1={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ex={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Dy=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ya(f=new o.P(0,0),r="bottom"){if(typeof f=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new o.P(0,f);case"top-left":return new o.P(l,l);case"top-right":return new o.P(-l,l);case"bottom":return new o.P(0,-f);case"bottom-left":return new o.P(l,-l);case"bottom-right":return new o.P(-l,-l);case"left":return new o.P(f,0);case"right":return new o.P(-f,0)}return new o.P(0,0)}return f instanceof o.P||Array.isArray(f)?o.P.convert(f):o.P.convert(f[r]||[0,0])}return{version:w,supported:N.supported,setRTLTextPlugin:o.dC,getRTLTextPluginStatus:o.dD,Map:class extends Wg{constructor(f){M.mark(C.create);const r=f;if((f=o.l({},Ud,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&o.dx(window)&&(f.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new yc(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Ly,this._domRenderTaskQueue=new Ly,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.aQ(),this._locale=o.l({},Y1,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new sf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=f.scaleFactor,this._requestManager=new Je(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?{...f.contextCreateOptions}:{},typeof f.container=="string"){const l=document.getElementById(f.container);if(!l)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=l}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),o.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new zg),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Qi(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||o.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),f.hash&&(this._hash=new wp(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const l=f.bounds;l&&(this.resize(),this.fitBounds(l,o.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new Pp({customAttribution:f.customAttribution})),this._logoControl=new qg,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.x(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.x(`${l.dataType}dataloading`,l))}),this._interactions=new Kg(this)}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new o.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=f.onAdd(this);this._controls.push(f);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new o.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.x("movestart",f)).fire(new o.x("move",f)),this.fire(new o.x("resize",f)),r&&this.fire(new o.x("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(o.as.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(f){return this._scaleFactor=f,this.painter.scaleFactor=f,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let l;r==="globe"&&f.zoom>=o.bV?(f.setMercatorFromTransition(),l=!0):r==="mercator"&&f.zoom<o.bV&&(f.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;return r=f.name==="globe"&&this.transform.zoom>=o.bV?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f){return this.transform.locationPoint3D(o.bL.convert(f))}unproject(f){return this.transform.pointLocation3D(o.P.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,l){const m=b=>{let S=[];if(Array.isArray(r)){const E=r.filter(z=>this.getLayer(z));S=E.length?this.queryRenderedFeatures(b,{layers:E}):[]}else S=this.queryRenderedFeatures(b,{featureset:r});return S};if(f==="mouseenter"||f==="mouseover"){let b=!1;return{listener:l,targets:r,delegates:{mousemove:E=>{const z=m(E.point);z.length?b||(b=!0,l.call(this,new bi(f,this,E.originalEvent,{features:z}))):b=!1},mouseout:()=>{b=!1}}}}if(f==="mouseleave"||f==="mouseout"){let b=!1;return{listener:l,targets:r,delegates:{mousemove:z=>{m(z.point).length?b=!0:b&&(b=!1,l.call(this,new bi(f,this,z.originalEvent)))},mouseout:z=>{b&&(b=!1,l.call(this,new bi(f,this,z.originalEvent)))}}}}{const b=S=>{const E=m(S.point);E.length&&(S.features=E,l.call(this,S),delete S.features)};return{listener:l,targets:r,delegates:{[f]:b}}}}on(f,r,l){if(typeof r=="function"||l===void 0)return super.on(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(f,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(m);for(const b in m.delegates)this.on(b,m.delegates[b]);return this}once(f,r,l){if(typeof r=="function"||l===void 0)return super.once(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._createDelegatedListener(f,r,l);for(const b in m.delegates)this.once(b,m.delegates[b]);return this}off(f,r,l){if(typeof r=="function"||l===void 0)return super.off(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const m=this._delegatedListeners?this._delegatedListeners[f]:void 0;return m&&(b=>{for(let S=0;S<b.length;S++){const E=b[S];if(E.listener===l&&lf(E.targets,r)){for(const z in E.delegates)this.off(z,E.delegates[z]);return b.splice(S,1),this}}})(m),this}queryRenderedFeatures(f,r){if(!this.style)return[];if(r!==void 0||f===void 0||f instanceof o.P||Array.isArray(f)||(r=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],"featureset"in(r=r||{}))return this._isFeaturesetDescriptorValid(r.featureset)?this.style.queryRenderedFeaturesForInteractions(f,[r],this.transform):[];if(r.layers&&Array.isArray(r.layers)){for(const l of r.layers)if(!this._isValidId(l))return[]}return this.style.queryRenderedFeatures(f,r,this.transform)}querySourceFeatures(f,r){return!f||typeof f=="string"&&!this._isValidId(f)?[]:this.style.querySourceFeatures(f,r)}isPointOnSurface(f){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&o.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(f))}addInteraction(f,r){return this._interactions.add(f,r),this}removeInteraction(f){return this._interactions.remove(f),this}setStyle(f,r){return r=o.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&f&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(f,(l,m)=>{l?(o.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(f,r)):m&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const l=o.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new Tn(this,l).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Tn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new o.t(new Error("IDs can't be empty."))),!1):!o.aK(f)||(this.fire(new o.t(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}_isFeaturesetDescriptorValid(f){return"featuresetId"in f?this._isValidId(f.featuresetId):"layerId"in f&&this._isValidId(f.layerId)}_areTargetsValid(f){if(Array.isArray(f)){for(const r of f)if(!this._isValidId(r))return!1;return!0}return this._isFeaturesetDescriptorValid(f)}addSource(f,r){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,l)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,r,{pixelRatio:l=1,sdf:m=!1,stretchX:b,stretchY:S,content:E}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:z,height:V,data:q}=o.q.getImageData(r);this.style.addImage(f,{data:new o.r({width:z,height:V},q),pixelRatio:l,stretchX:b,stretchY:S,content:E,sdf:m,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:V}=r,q=r;this.style.addImage(f,{data:new o.r({width:z,height:V},new Uint8Array(q.data)),pixelRatio:l,stretchX:b,stretchY:S,content:E,sdf:m,version:0,userImage:q}),q.onAdd&&q.onAdd(this,f)}}updateImage(f,r){this._lazyInitEmptyStyle();const l=this.style.getImage(f);if(!l)return void this.fire(new o.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?o.q.getImageData(r):r,{width:b,height:S,data:E}=m;if(b===void 0||S===void 0)return void this.fire(new o.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==l.data.width||S!==l.data.height)return void this.fire(new o.t(new Error(`The width and height of the updated image (${b}, ${S})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const z=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);l.data.replace(E,z),this.style.updateImage(f,l)}hasImage(f){return f?!!this.style&&!!this.style.getImage(f):(this.fire(new o.t(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){o.o(this._requestManager.transformRequest(f,o.R.Image),(l,m)=>{r(l,m instanceof HTMLImageElement?o.q.getImageData(m):m)})}listImages(){return this.style.listImages()}addModel(f,r){this._lazyInitEmptyStyle(),this.style.addModel(f,r)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new o.t(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,r){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)):this}getSlot(f){const r=this.getLayer(f);return r&&r.slot||null}setSlot(f,r){return this.style.setSlot(f,r),this.style.mergeLayers(),this._update(!0)}addImport(f,r){return this.style.addImport(f,r),this}updateImport(f,r){return typeof r!="string"&&r.id!==f?(this.removeImport(f),this.addImport(r)):(this.style.updateImport(f,r),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,r){return this.style.moveImport(f,r),this._update(!0)}moveLayer(f,r){return this._isValidId(f)?(this.style.moveLayer(f,r),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const r=this.style.getOwnLayer(f);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,r,l){return this._isValidId(f)?(this.style.setLayerZoomRange(f,r,l),this._update(!0)):this}setFilter(f,r,l={}){return this._isValidId(f)?(this.style.setFilter(f,r,l),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,r,l,m={}){return this._isValidId(f)?(this.style.setPaintProperty(f,r,l,m),this._update(!0)):this}getPaintProperty(f,r){return this._isValidId(f)?this.style.getPaintProperty(f,r):null}setLayoutProperty(f,r,l,m={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,r,l,m),this._update(!0)):this}getLayoutProperty(f,r){return this._isValidId(f)?this.style.getLayoutProperty(f,r):null}getSchema(f){return this.style.getSchema(f)}setSchema(f,r){return this.style.setSchema(f,r),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,r){return this.style.setConfig(f,r),this._update(!0)}getConfigProperty(f,r){return this.style.getConfigProperty(f,r)}setConfigProperty(f,r,l){return this.style.setConfigProperty(f,r,l),this._update(!0)}getFeaturesetDescriptors(f){return this.style.getFeaturesetDescriptors(f)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const r=f[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.bL.convert(f),this.transform):0}setFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.setFeatureState(f,r),this._update())}removeFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.removeFeatureState(f,r),this._update())}getFeatureState(f){return f.source&&!this._isValidId(f.source)?null:this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,m,b,S=this._container;for(;S&&(!m||!b);){const E=window.getComputedStyle(S).transform;E&&E!=="none"&&(l=E.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(m=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(b=l[3])),S=S.parentElement}this._containerWidth=m?Math.abs(f/m):f,this._containerHeight=b?Math.abs(r/b):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=D("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=D("div","mapboxgl-canvas-container",f);this._canvas=D("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=D("div","mapboxgl-control-container",f),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(b=>{m[b]=D("div",`mapboxgl-ctrl-${b}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const l=o.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(f),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=o.l({},N.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",f);r?(At(r,!0),this.painter=new pu(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.m.testSupport(r)):this.fire(new o.t(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.x("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new o.x("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;this.fire(new o.x("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,m=o.q.now(),b=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=b.createQuery(),b.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const q=this.transform.zoom,H=this.transform.pitch,X=o.q.now(),ee=new o.a3(q,{now:X,fadeDuration:S,pitch:H,transition:this.style.transition});this.style.update(ee)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(m),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(m);const z=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),z&&(this._placementDirty=z.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,M.mark(C.load),this.fire(new o.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const q=o.q.now()-m;b.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const H=b.getQueryParameter(r,b.QUERY_RESULT)/1e6;b.deleteQuery(r),this.fire(new o.x("gpu-timing-frame",{cpuTime:q,gpuTime:H}))},50)}if(this.listens("gpu-timing-layer")){const q=this.painter.collectGpuTimers();setTimeout(()=>{const H=this.painter.queryGpuTimers(q);this.fire(new o.x("gpu-timing-layer",{layerTimes:H}))},50)}if(this.listens("gpu-timing-deferred-render")){const q=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const H=this.painter.queryGpuTimeDeferredRender(q);this.fire(new o.x("gpu-timing-deferred-render",{gpuTime:H}))},50)}const V=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(V||this._repaint)this.triggerRepaint();else{const q=this.idle();if(q&&(E=this._updateAverageElevation(m,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),q&&(this.fire(new o.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const H=this._calculateSpeedIndex();this.fire(new o.x("speedindexcompleted",{speedIndex:H})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||V||(this._fullyLoaded=!0,M.mark(C.fullLoad),this._performanceMetricsCollection&&Kt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const l=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const b=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=f;const E=Math.abs(b-S);if(E>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(S),l(S);this._averageElevation.easeTo(S,f,300)}else if(E>1e-4)return this._averageElevation.jumpTo(S),l(S)}return!!this._averageElevation.isEasing(f)&&l(this._averageElevation.getValue(f))}_authenticate(){Le(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===Re||f.status===401)){const r=this.painter.context.gl;At(r,!1),this._logoControl instanceof qg&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ct(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&zt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,m=l.createFramebuffer();function b(S){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,S,0);const E=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,E),E}return l.bindFramebuffer(l.FRAMEBUFFER,m),this._canvasPixelComparison(b(f),r.canvasCopies.map(b),r.timeStamps)}_canvasPixelComparison(f,r,l){let m=l[1]-l[0];const b=f.length/4;for(let S=0;S<r.length;S++){const E=r[S];let z=0;for(let V=0;V<E.length;V+=4)E[V]===f[V]&&E[V+1]===f[V+1]&&E[V+2]===f[V+2]&&E[V+3]===f[V+3]&&(z+=1);m+=(l[S+2]-l[S+1])*(1-z/b)}return m}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),dn.delete(this.painter.context.gl),$t.remove(),Oe.remove(),this._removed=!0,this.fire(new o.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=o.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(f){const r=this.style?this.style.getSourceCaches():[];return o.bg(r,(l,m)=>l._preloadTiles(f,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,r){o.dy(f,r)}get version(){return w}},NavigationControl:class{constructor(f={}){this.options=o.l({},Ac,f),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),D("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),D("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=D("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),l=r===f.getMaxZoom(),m=r===f.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gl(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const l=D("button",f,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(f,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",l),f.firstElementChild&&f.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends o.E{constructor(f={}){super();const r=navigator.geolocation;this.options=o.l({geolocation:r},X1,f),o.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Mc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,f(l)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),l=f.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new o.x("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("geolocate",f)),this._finish()}}_updateCamera(f){const r=new o.bL(f.coords.longitude,f.coords.latitude),l=f.coords.accuracy,m=this._map.getBearing(),b=o.l({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),b,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new o.bL(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=o.bE(1,f._center.lat)*f.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=D("button","mapboxgl-ctrl-geolocate",this._container),D("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D("div","mapboxgl-user-location"),this._dotElement.appendChild(D("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(D("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new jl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=D("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.x("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Pp,ScaleControl:class{constructor(f={}){this.options=o.l({},J1,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,m=r._containerWidth/2-f/2,b=r.unproject([m,l]),S=r.unproject([m+f,l]),E=b.distanceTo(S);if(this.options.unit==="imperial"){const z=3.2808*E;z>5280?this._setScale(f,z/5280,"mile"):this._setScale(f,z,"foot")}else this.options.unit==="nautical"?this._setScale(f,E/1852,"nautical-mile"):E>=1e3?this._setScale(f,E/1e3,"kilometer"):this._setScale(f,E,"meter")}_setScale(f,r,l){this._map._requestDomTask(()=>{const m=function(S){const E=Math.pow(10,`${Math.floor(S)}`.length-1);let z=S/E;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(V){const q=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*q)/q}(z),E*z}(r),b=m/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(m):`${m}&nbsp;${Q1[l]}`,this._container.style.width=f*b+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:o.w("Full screen control 'container' must be a DOM element.")),o.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=D("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(f){super(),this.options=o.l(Object.create(ex),f),o.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new o.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new o.x("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=o.bL.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const r=document.createDocumentFragment(),l=document.createElement("body");let m;for(l.innerHTML=f;m=l.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=D("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const l=this._closeButton=D("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,m=this._pos;if(!r||!l||!m)return"bottom";const b=l.offsetWidth,S=l.offsetHeight,E=m.x<b/2,z=m.x>r.transform.width-b/2;if(m.y+f<S)return E?"top-left":z?"top-right":"top";if(m.y>r.transform.height-S){if(E)return"bottom-left";if(z)return"bottom-right"}return E?"left":z?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let m=this._container;if(m||(m=this._container=D("div","mapboxgl-popup",r.getContainer()),this._tip=D("div","mapboxgl-popup-tip",m),m.appendChild(l)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=kc(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const b=this._pos=this._trackPointer&&f instanceof o.P?f:r.project(this._lngLat),S=ya(this.options.offset),E=this._anchor=this._getAnchor(S.y),z=ya(this.options.offset,E),V=b.add(z).round();r._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Pc[E]} translate(${V.x}px,${V.y}px)`)})}if(!this._marker&&r._showingGlobe()){const b=o.dz(r.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Dy);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:jl,Style:Tn,LngLat:o.bL,LngLatBounds:o.as,Point:o.P,MercatorCoordinate:o.a5,FreeCameraOptions:dl,Evented:o.E,config:o.e,prewarm:o.dE,clearPrewarmedResources:o.dF,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(f){o.e.ACCESS_TOKEN=f},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(f){o.e.API_URL=f},get workerCount(){return o.dG.workerCount},set workerCount(f){o.dG.workerCount=f},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){o.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){o.dH(f)},get workerUrl(){return o.dI.workerUrl},set workerUrl(f){o.dI.workerUrl=f},get workerClass(){return o.dI.workerClass},set workerClass(f){o.dI.workerClass=f},get workerParams(){return o.dI.workerParams},set workerParams(f){o.dI.workerParams=f},get dracoUrl(){return o.dJ()},set dracoUrl(f){o.dK(f)},get meshoptUrl(){return o.dL()},set meshoptUrl(f){o.dM(f)},setNow:o.q.setNow,restoreNow:o.q.restoreNow}});var _=d;return _})})(sL);var y$=sL.exports;const Cw=eu(y$);var cL={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){var i=function(Z,fe){var Ue={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},wt={on:function(Vt,on,Kn){if(Ue[Vt]===void 0)throw new Error("Invalid event type: "+Vt);Ue[Vt].push({selector:on,fn:Kn})},render:function(Vt){fe.store.featureChanged(Vt)}},Bt=function(Vt,on){for(var Kn=Ue[Vt],so=Kn.length;so--;){var zn=Kn[so];if(zn.selector(on)){zn.fn.call(wt,on)||fe.store.render(),fe.ui.updateMapClasses();break}}};return Z.start.call(wt),{render:Z.render,stop:function(){Z.stop&&Z.stop()},trash:function(){Z.trash&&(Z.trash(),fe.store.render())},combineFeatures:function(){Z.combineFeatures&&Z.combineFeatures()},uncombineFeatures:function(){Z.uncombineFeatures&&Z.uncombineFeatures()},drag:function(Vt){Bt("drag",Vt)},click:function(Vt){Bt("click",Vt)},mousemove:function(Vt){Bt("mousemove",Vt)},mousedown:function(Vt){Bt("mousedown",Vt)},mouseup:function(Vt){Bt("mouseup",Vt)},mouseout:function(Vt){Bt("mouseout",Vt)},keydown:function(Vt){Bt("keydown",Vt)},keyup:function(Vt){Bt("keyup",Vt)},touchstart:function(Vt){Bt("touchstart",Vt)},touchmove:function(Vt){Bt("touchmove",Vt)},touchend:function(Vt){Bt("touchend",Vt)},tap:function(Vt){Bt("tap",Vt)}}};function s(Z){return Z&&Z.__esModule&&Object.prototype.hasOwnProperty.call(Z,"default")?Z.default:Z}function d(Z){if(Z.__esModule)return Z;var fe=Z.default;if(typeof fe=="function"){var Ue=function wt(){if(this instanceof wt){var Bt=[null];Bt.push.apply(Bt,arguments);var Vt=Function.bind.apply(fe,Bt);return new Vt}return fe.apply(this,arguments)};Ue.prototype=fe.prototype}else Ue={};return Object.defineProperty(Ue,"__esModule",{value:!0}),Object.keys(Z).forEach(function(wt){var Bt=Object.getOwnPropertyDescriptor(Z,wt);Object.defineProperty(Ue,wt,Bt.get?Bt:{enumerable:!0,get:function(){return Z[wt]}})}),Ue}var p={},_={RADIUS:6378137},o=_;function w(Z){var fe=0;if(Z&&Z.length>0){fe+=Math.abs(C(Z[0]));for(var Ue=1;Ue<Z.length;Ue++)fe-=Math.abs(C(Z[Ue]))}return fe}function C(Z){var fe,Ue,wt,Bt,Vt,on,Kn=0,so=Z.length;if(so>2){for(on=0;on<so;on++)on===so-2?(wt=so-2,Bt=so-1,Vt=0):on===so-1?(wt=so-1,Bt=0,Vt=1):(wt=on,Bt=on+1,Vt=on+2),fe=Z[wt],Ue=Z[Bt],Kn+=(M(Z[Vt][0])-M(fe[0]))*Math.sin(M(Ue[1]));Kn=Kn*o.RADIUS*o.RADIUS/2}return Kn}function M(Z){return Z*Math.PI/180}p.geometry=function Z(fe){var Ue,wt=0;switch(fe.type){case"Polygon":return w(fe.coordinates);case"MultiPolygon":for(Ue=0;Ue<fe.coordinates.length;Ue++)wt+=w(fe.coordinates[Ue]);return wt;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Ue=0;Ue<fe.geometries.length;Ue++)wt+=Z(fe.geometries[Ue]);return wt}},p.ring=C;var I={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},F={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},B={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},N={POLYGON:"polygon",LINE:"line_string",POINT:"point"},D={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},j={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},U={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},ne={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},K={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},G={ACTIVE:"true",INACTIVE:"false"},J=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],oe=-85,se=Object.freeze({__proto__:null,classes:I,sources:F,cursors:B,types:N,geojsonTypes:D,modes:j,events:U,updateActions:ne,meta:K,activeStates:G,interactions:J,LAT_MIN:-90,LAT_RENDERED_MIN:oe,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),me={Point:0,LineString:1,MultiLineString:1,Polygon:2};function de(Z,fe){var Ue=me[Z.geometry.type]-me[fe.geometry.type];return Ue===0&&Z.geometry.type===D.POLYGON?Z.area-fe.area:Ue}function ce(Z){return Z.map(function(fe){return fe.geometry.type===D.POLYGON&&(fe.area=p.geometry({type:D.FEATURE,property:{},geometry:fe.geometry})),fe}).sort(de).map(function(fe){return delete fe.area,fe})}function pe(Z,fe){return fe===void 0&&(fe=0),[[Z.point.x-fe,Z.point.y-fe],[Z.point.x+fe,Z.point.y+fe]]}function ge(Z){if(this._items={},this._nums={},this._length=Z?Z.length:0,Z)for(var fe=0,Ue=Z.length;fe<Ue;fe++)this.add(Z[fe]),Z[fe]!==void 0&&(typeof Z[fe]=="string"?this._items[Z[fe]]=fe:this._nums[Z[fe]]=fe)}ge.prototype.add=function(Z){return this.has(Z)||(this._length++,typeof Z=="string"?this._items[Z]=this._length:this._nums[Z]=this._length),this},ge.prototype.delete=function(Z){return this.has(Z)===!1||(this._length--,delete this._items[Z],delete this._nums[Z]),this},ge.prototype.has=function(Z){return(typeof Z=="string"||typeof Z=="number")&&(this._items[Z]!==void 0||this._nums[Z]!==void 0)},ge.prototype.values=function(){var Z=this,fe=[];return Object.keys(this._items).forEach(function(Ue){fe.push({k:Ue,v:Z._items[Ue]})}),Object.keys(this._nums).forEach(function(Ue){fe.push({k:JSON.parse(Ue),v:Z._nums[Ue]})}),fe.sort(function(Ue,wt){return Ue.v-wt.v}).map(function(Ue){return Ue.k})},ge.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Re=[K.FEATURE,K.MIDPOINT,K.VERTEX],Je={click:function(Z,fe,Ue){return Me(Z,fe,Ue,Ue.options.clickBuffer)},touch:function(Z,fe,Ue){return Me(Z,fe,Ue,Ue.options.touchBuffer)}};function Me(Z,fe,Ue,wt){if(Ue.map===null)return[];var Bt=Z?pe(Z,wt):fe,Vt={};Ue.options.styles&&(Vt.layers=Ue.options.styles.map(function(zn){return zn.id}).filter(function(zn){return Ue.map.getLayer(zn)!=null}));var on=Ue.map.queryRenderedFeatures(Bt,Vt).filter(function(zn){return Re.indexOf(zn.properties.meta)!==-1}),Kn=new ge,so=[];return on.forEach(function(zn){var yo=zn.properties.id;Kn.has(yo)||(Kn.add(yo),so.push(zn))}),ce(so)}function xe(Z,fe){var Ue=Je.click(Z,null,fe),wt={mouse:B.NONE};return Ue[0]&&(wt.mouse=Ue[0].properties.active===G.ACTIVE?B.MOVE:B.POINTER,wt.feature=Ue[0].properties.meta),fe.events.currentModeName().indexOf("draw")!==-1&&(wt.mouse=B.ADD),fe.ui.queueMapClasses(wt),fe.ui.updateMapClasses(),Ue[0]}function Ae(Z,fe){var Ue=Z.x-fe.x,wt=Z.y-fe.y;return Math.sqrt(Ue*Ue+wt*wt)}function Ce(Z,fe,Ue){Ue===void 0&&(Ue={});var wt=Ue.fineTolerance!=null?Ue.fineTolerance:4,Bt=Ue.grossTolerance!=null?Ue.grossTolerance:12,Vt=Ue.interval!=null?Ue.interval:500;Z.point=Z.point||fe.point,Z.time=Z.time||fe.time;var on=Ae(Z.point,fe.point);return on<wt||on<Bt&&fe.time-Z.time<Vt}function ve(Z,fe,Ue){Ue===void 0&&(Ue={});var wt=Ue.tolerance!=null?Ue.tolerance:25,Bt=Ue.interval!=null?Ue.interval:250;return Z.point=Z.point||fe.point,Z.time=Z.time||fe.time,Ae(Z.point,fe.point)<wt&&fe.time-Z.time<Bt}var Ne={exports:{}},We=Ne.exports=function(Z,fe){if(fe||(fe=16),Z===void 0&&(Z=128),Z<=0)return"0";for(var Ue=Math.log(Math.pow(2,Z))/Math.log(fe),wt=2;Ue===1/0;wt*=2)Ue=Math.log(Math.pow(2,Z/wt))/Math.log(fe)*wt;var Bt=Ue-Math.floor(Ue),Vt="";for(wt=0;wt<Math.floor(Ue);wt++)Vt=Math.floor(Math.random()*fe).toString(fe)+Vt;if(Bt){var on=Math.pow(fe,Bt);Vt=Math.floor(Math.random()*on).toString(fe)+Vt}var Kn=parseInt(Vt,fe);return Kn!==1/0&&Kn>=Math.pow(2,Z)?We(Z,fe):Vt};We.rack=function(Z,fe,Ue){var wt=function(Vt){var on=0;do{if(on++>10){if(!Ue)throw new Error("too many ID collisions, use more bits");Z+=Ue}var Kn=We(Z,fe)}while(Object.hasOwnProperty.call(Bt,Kn));return Bt[Kn]=Vt,Kn},Bt=wt.hats={};return wt.get=function(Vt){return wt.hats[Vt]},wt.set=function(Vt,on){return wt.hats[Vt]=on,wt},wt.bits=Z||128,wt.base=fe||16,wt};var ot=s(Ne.exports),Oe=function(Z,fe){this.ctx=Z,this.properties=fe.properties||{},this.coordinates=fe.geometry.coordinates,this.id=fe.id||ot(),this.type=fe.geometry.type};Oe.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Oe.prototype.incomingCoords=function(Z){this.setCoordinates(Z)},Oe.prototype.setCoordinates=function(Z){this.coordinates=Z,this.changed()},Oe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Oe.prototype.setProperty=function(Z,fe){this.properties[Z]=fe},Oe.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:D.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Oe.prototype.internal=function(Z){var fe={id:this.id,meta:K.FEATURE,"meta:type":this.type,active:G.INACTIVE,mode:Z};if(this.ctx.options.userProperties)for(var Ue in this.properties)fe["user_"+Ue]=this.properties[Ue];return{type:D.FEATURE,properties:fe,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Ct=function(Z,fe){Oe.call(this,Z,fe)};(Ct.prototype=Object.create(Oe.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Ct.prototype.updateCoordinate=function(Z,fe,Ue){this.coordinates=arguments.length===3?[fe,Ue]:[Z,fe],this.changed()},Ct.prototype.getCoordinate=function(){return this.getCoordinates()};var Mt=function(Z,fe){Oe.call(this,Z,fe)};(Mt.prototype=Object.create(Oe.prototype)).isValid=function(){return this.coordinates.length>1},Mt.prototype.addCoordinate=function(Z,fe,Ue){this.changed();var wt=parseInt(Z,10);this.coordinates.splice(wt,0,[fe,Ue])},Mt.prototype.getCoordinate=function(Z){var fe=parseInt(Z,10);return JSON.parse(JSON.stringify(this.coordinates[fe]))},Mt.prototype.removeCoordinate=function(Z){this.changed(),this.coordinates.splice(parseInt(Z,10),1)},Mt.prototype.updateCoordinate=function(Z,fe,Ue){var wt=parseInt(Z,10);this.coordinates[wt]=[fe,Ue],this.changed()};var zt=function(Z,fe){Oe.call(this,Z,fe),this.coordinates=this.coordinates.map(function(Ue){return Ue.slice(0,-1)})};(zt.prototype=Object.create(Oe.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(Z){return Z.length>2})},zt.prototype.incomingCoords=function(Z){this.coordinates=Z.map(function(fe){return fe.slice(0,-1)}),this.changed()},zt.prototype.setCoordinates=function(Z){this.coordinates=Z,this.changed()},zt.prototype.addCoordinate=function(Z,fe,Ue){this.changed();var wt=Z.split(".").map(function(Bt){return parseInt(Bt,10)});this.coordinates[wt[0]].splice(wt[1],0,[fe,Ue])},zt.prototype.removeCoordinate=function(Z){this.changed();var fe=Z.split(".").map(function(wt){return parseInt(wt,10)}),Ue=this.coordinates[fe[0]];Ue&&(Ue.splice(fe[1],1),Ue.length<3&&this.coordinates.splice(fe[0],1))},zt.prototype.getCoordinate=function(Z){var fe=Z.split(".").map(function(wt){return parseInt(wt,10)}),Ue=this.coordinates[fe[0]];return JSON.parse(JSON.stringify(Ue[fe[1]]))},zt.prototype.getCoordinates=function(){return this.coordinates.map(function(Z){return Z.concat([Z[0]])})},zt.prototype.updateCoordinate=function(Z,fe,Ue){this.changed();var wt=Z.split("."),Bt=parseInt(wt[0],10),Vt=parseInt(wt[1],10);this.coordinates[Bt]===void 0&&(this.coordinates[Bt]=[]),this.coordinates[Bt][Vt]=[fe,Ue]};var bt={MultiPoint:Ct,MultiLineString:Mt,MultiPolygon:zt},Kt=function(Z,fe,Ue,wt,Bt){var Vt=Ue.split("."),on=parseInt(Vt[0],10),Kn=Vt[1]?Vt.slice(1).join("."):null;return Z[on][fe](Kn,wt,Bt)},$t=function(Z,fe){if(Oe.call(this,Z,fe),delete this.coordinates,this.model=bt[fe.geometry.type],this.model===void 0)throw new TypeError(fe.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(fe.geometry.coordinates)};function Le(Z){this.map=Z.map,this.drawConfig=JSON.parse(JSON.stringify(Z.options||{})),this._ctx=Z}($t.prototype=Object.create(Oe.prototype))._coordinatesToFeatures=function(Z){var fe=this,Ue=this.model.bind(this);return Z.map(function(wt){return new Ue(fe.ctx,{id:ot(),type:D.FEATURE,properties:{},geometry:{coordinates:wt,type:fe.type.replace("Multi","")}})})},$t.prototype.isValid=function(){return this.features.every(function(Z){return Z.isValid()})},$t.prototype.setCoordinates=function(Z){this.features=this._coordinatesToFeatures(Z),this.changed()},$t.prototype.getCoordinate=function(Z){return Kt(this.features,"getCoordinate",Z)},$t.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(Z){return Z.type===D.POLYGON?Z.getCoordinates():Z.coordinates})))},$t.prototype.updateCoordinate=function(Z,fe,Ue){Kt(this.features,"updateCoordinate",Z,fe,Ue),this.changed()},$t.prototype.addCoordinate=function(Z,fe,Ue){Kt(this.features,"addCoordinate",Z,fe,Ue),this.changed()},$t.prototype.removeCoordinate=function(Z){Kt(this.features,"removeCoordinate",Z),this.changed()},$t.prototype.getFeatures=function(){return this.features},Le.prototype.setSelected=function(Z){return this._ctx.store.setSelected(Z)},Le.prototype.setSelectedCoordinates=function(Z){var fe=this;this._ctx.store.setSelectedCoordinates(Z),Z.reduce(function(Ue,wt){return Ue[wt.feature_id]===void 0&&(Ue[wt.feature_id]=!0,fe._ctx.store.get(wt.feature_id).changed()),Ue},{})},Le.prototype.getSelected=function(){return this._ctx.store.getSelected()},Le.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Le.prototype.isSelected=function(Z){return this._ctx.store.isSelected(Z)},Le.prototype.getFeature=function(Z){return this._ctx.store.get(Z)},Le.prototype.select=function(Z){return this._ctx.store.select(Z)},Le.prototype.deselect=function(Z){return this._ctx.store.deselect(Z)},Le.prototype.deleteFeature=function(Z,fe){return fe===void 0&&(fe={}),this._ctx.store.delete(Z,fe)},Le.prototype.addFeature=function(Z){return this._ctx.store.add(Z)},Le.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Le.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Le.prototype.setActionableState=function(Z){Z===void 0&&(Z={});var fe={trash:Z.trash||!1,combineFeatures:Z.combineFeatures||!1,uncombineFeatures:Z.uncombineFeatures||!1};return this._ctx.events.actionable(fe)},Le.prototype.changeMode=function(Z,fe,Ue){return fe===void 0&&(fe={}),Ue===void 0&&(Ue={}),this._ctx.events.changeMode(Z,fe,Ue)},Le.prototype.updateUIClasses=function(Z){return this._ctx.ui.queueMapClasses(Z)},Le.prototype.activateUIButton=function(Z){return this._ctx.ui.setActiveButton(Z)},Le.prototype.featuresAt=function(Z,fe,Ue){if(Ue===void 0&&(Ue="click"),Ue!=="click"&&Ue!=="touch")throw new Error("invalid buffer type");return Je[Ue](Z,fe,this._ctx)},Le.prototype.newFeature=function(Z){var fe=Z.geometry.type;return fe===D.POINT?new Ct(this._ctx,Z):fe===D.LINE_STRING?new Mt(this._ctx,Z):fe===D.POLYGON?new zt(this._ctx,Z):new $t(this._ctx,Z)},Le.prototype.isInstanceOf=function(Z,fe){if(Z===D.POINT)return fe instanceof Ct;if(Z===D.LINE_STRING)return fe instanceof Mt;if(Z===D.POLYGON)return fe instanceof zt;if(Z==="MultiFeature")return fe instanceof $t;throw new Error("Unknown feature class: "+Z)},Le.prototype.doRender=function(Z){return this._ctx.store.featureChanged(Z)},Le.prototype.onSetup=function(){},Le.prototype.onDrag=function(){},Le.prototype.onClick=function(){},Le.prototype.onMouseMove=function(){},Le.prototype.onMouseDown=function(){},Le.prototype.onMouseUp=function(){},Le.prototype.onMouseOut=function(){},Le.prototype.onKeyUp=function(){},Le.prototype.onKeyDown=function(){},Le.prototype.onTouchStart=function(){},Le.prototype.onTouchMove=function(){},Le.prototype.onTouchEnd=function(){},Le.prototype.onTap=function(){},Le.prototype.onStop=function(){},Le.prototype.onTrash=function(){},Le.prototype.onCombineFeature=function(){},Le.prototype.onUncombineFeature=function(){},Le.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var dn={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},At=Object.keys(dn);function Ke(Z){var fe=Object.keys(Z);return function(Ue,wt){wt===void 0&&(wt={});var Bt={},Vt=fe.reduce(function(on,Kn){return on[Kn]=Z[Kn],on},new Le(Ue));return{start:function(){var on=this;Bt=Vt.onSetup(wt),At.forEach(function(Kn){var so,zn=dn[Kn],yo=function(){return!1};Z[zn]&&(yo=function(){return!0}),on.on(Kn,yo,(so=zn,function(On){return Vt[so](Bt,On)}))})},stop:function(){Vt.onStop(Bt)},trash:function(){Vt.onTrash(Bt)},combineFeatures:function(){Vt.onCombineFeatures(Bt)},uncombineFeatures:function(){Vt.onUncombineFeatures(Bt)},render:function(on,Kn){Vt.toDisplayFeatures(Bt,on,Kn)}}}}function Be(Z){return[].concat(Z).filter(function(fe){return fe!==void 0})}function Ht(){var Z=this;if(!(Z.ctx.map&&Z.ctx.map.getSource(F.HOT)!==void 0))return so();var fe=Z.ctx.events.currentModeName();Z.ctx.ui.queueMapClasses({mode:fe});var Ue=[],wt=[];Z.isDirty?wt=Z.getAllIds():(Ue=Z.getChangedIds().filter(function(zn){return Z.get(zn)!==void 0}),wt=Z.sources.hot.filter(function(zn){return zn.properties.id&&Ue.indexOf(zn.properties.id)===-1&&Z.get(zn.properties.id)!==void 0}).map(function(zn){return zn.properties.id})),Z.sources.hot=[];var Bt=Z.sources.cold.length;Z.sources.cold=Z.isDirty?[]:Z.sources.cold.filter(function(zn){var yo=zn.properties.id||zn.properties.parent;return Ue.indexOf(yo)===-1});var Vt=Bt!==Z.sources.cold.length||wt.length>0;function on(zn,yo){var On=Z.get(zn).internal(fe);Z.ctx.events.currentModeRender(On,function(dr){Z.sources[yo].push(dr)})}if(Ue.forEach(function(zn){return on(zn,"hot")}),wt.forEach(function(zn){return on(zn,"cold")}),Vt&&Z.ctx.map.getSource(F.COLD).setData({type:D.FEATURE_COLLECTION,features:Z.sources.cold}),Z.ctx.map.getSource(F.HOT).setData({type:D.FEATURE_COLLECTION,features:Z.sources.hot}),Z._emitSelectionChange&&(Z.ctx.map.fire(U.SELECTION_CHANGE,{features:Z.getSelected().map(function(zn){return zn.toGeoJSON()}),points:Z.getSelectedCoordinates().map(function(zn){return{type:D.FEATURE,properties:{},geometry:{type:D.POINT,coordinates:zn.coordinates}}})}),Z._emitSelectionChange=!1),Z._deletedFeaturesToEmit.length){var Kn=Z._deletedFeaturesToEmit.map(function(zn){return zn.toGeoJSON()});Z._deletedFeaturesToEmit=[],Z.ctx.map.fire(U.DELETE,{features:Kn})}function so(){Z.isDirty=!1,Z.clearChangedIds()}so(),Z.ctx.map.fire(U.RENDER,{})}function Ut(Z){var fe,Ue=this;this._features={},this._featureIds=new ge,this._selectedFeatureIds=new ge,this._selectedCoordinates=[],this._changedFeatureIds=new ge,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=Z,this.sources={hot:[],cold:[]},this.render=function(){fe||(fe=requestAnimationFrame(function(){fe=null,Ht.call(Ue)}))},this.isDirty=!1}function Nt(Z,fe){var Ue=Z._selectedCoordinates.filter(function(wt){return Z._selectedFeatureIds.has(wt.feature_id)});Z._selectedCoordinates.length===Ue.length||fe.silent||(Z._emitSelectionChange=!0),Z._selectedCoordinates=Ue}Ut.prototype.createRenderBatch=function(){var Z=this,fe=this.render,Ue=0;return this.render=function(){Ue++},function(){Z.render=fe,Ue>0&&Z.render()}},Ut.prototype.setDirty=function(){return this.isDirty=!0,this},Ut.prototype.featureChanged=function(Z){return this._changedFeatureIds.add(Z),this},Ut.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Ut.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Ut.prototype.getAllIds=function(){return this._featureIds.values()},Ut.prototype.add=function(Z){return this.featureChanged(Z.id),this._features[Z.id]=Z,this._featureIds.add(Z.id),this},Ut.prototype.delete=function(Z,fe){var Ue=this;return fe===void 0&&(fe={}),Be(Z).forEach(function(wt){Ue._featureIds.has(wt)&&(Ue._featureIds.delete(wt),Ue._selectedFeatureIds.delete(wt),fe.silent||Ue._deletedFeaturesToEmit.indexOf(Ue._features[wt])===-1&&Ue._deletedFeaturesToEmit.push(Ue._features[wt]),delete Ue._features[wt],Ue.isDirty=!0)}),Nt(this,fe),this},Ut.prototype.get=function(Z){return this._features[Z]},Ut.prototype.getAll=function(){var Z=this;return Object.keys(this._features).map(function(fe){return Z._features[fe]})},Ut.prototype.select=function(Z,fe){var Ue=this;return fe===void 0&&(fe={}),Be(Z).forEach(function(wt){Ue._selectedFeatureIds.has(wt)||(Ue._selectedFeatureIds.add(wt),Ue._changedFeatureIds.add(wt),fe.silent||(Ue._emitSelectionChange=!0))}),this},Ut.prototype.deselect=function(Z,fe){var Ue=this;return fe===void 0&&(fe={}),Be(Z).forEach(function(wt){Ue._selectedFeatureIds.has(wt)&&(Ue._selectedFeatureIds.delete(wt),Ue._changedFeatureIds.add(wt),fe.silent||(Ue._emitSelectionChange=!0))}),Nt(this,fe),this},Ut.prototype.clearSelected=function(Z){return Z===void 0&&(Z={}),this.deselect(this._selectedFeatureIds.values(),{silent:Z.silent}),this},Ut.prototype.setSelected=function(Z,fe){var Ue=this;return fe===void 0&&(fe={}),Z=Be(Z),this.deselect(this._selectedFeatureIds.values().filter(function(wt){return Z.indexOf(wt)===-1}),{silent:fe.silent}),this.select(Z.filter(function(wt){return!Ue._selectedFeatureIds.has(wt)}),{silent:fe.silent}),this},Ut.prototype.setSelectedCoordinates=function(Z){return this._selectedCoordinates=Z,this._emitSelectionChange=!0,this},Ut.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Ut.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Ut.prototype.getSelected=function(){var Z=this;return this._selectedFeatureIds.values().map(function(fe){return Z.get(fe)})},Ut.prototype.getSelectedCoordinates=function(){var Z=this;return this._selectedCoordinates.map(function(fe){return{coordinates:Z.get(fe.feature_id).getCoordinate(fe.coord_path)}})},Ut.prototype.isSelected=function(Z){return this._selectedFeatureIds.has(Z)},Ut.prototype.setFeatureProperty=function(Z,fe,Ue){this.get(Z).setProperty(fe,Ue),this.featureChanged(Z)},Ut.prototype.storeMapConfig=function(){var Z=this;J.forEach(function(fe){Z.ctx.map[fe]&&(Z._mapInitialConfig[fe]=Z.ctx.map[fe].isEnabled())})},Ut.prototype.restoreMapConfig=function(){var Z=this;Object.keys(this._mapInitialConfig).forEach(function(fe){Z._mapInitialConfig[fe]?Z.ctx.map[fe].enable():Z.ctx.map[fe].disable()})},Ut.prototype.getInitialConfigValue=function(Z){return this._mapInitialConfig[Z]===void 0||this._mapInitialConfig[Z]};var Et=function(){for(var Z=arguments,fe={},Ue=0;Ue<arguments.length;Ue++){var wt=Z[Ue];for(var Bt in wt)Gt.call(wt,Bt)&&(fe[Bt]=wt[Bt])}return fe},Gt=Object.prototype.hasOwnProperty,ln=s(Et),bn=["mode","feature","mouse"];function _n(Z){var fe=null,Ue=null,wt={onRemove:function(){return Z.map.off("load",wt.connect),clearInterval(Ue),wt.removeLayers(),Z.store.restoreMapConfig(),Z.ui.removeButtons(),Z.events.removeEventListeners(),Z.ui.clearMapClasses(),Z.boxZoomInitial&&Z.map.boxZoom.enable(),Z.map=null,Z.container=null,Z.store=null,fe&&fe.parentNode&&fe.parentNode.removeChild(fe),fe=null,this},connect:function(){Z.map.off("load",wt.connect),clearInterval(Ue),wt.addLayers(),Z.store.storeMapConfig(),Z.events.addEventListeners()},onAdd:function(Bt){var Vt=Bt.fire;return Bt.fire=function(on,Kn){var so=arguments;return Vt.length===1&&arguments.length!==1&&(so=[ln({},{type:on},Kn)]),Vt.apply(Bt,so)},Z.map=Bt,Z.events=function(on){var Kn=Object.keys(on.options.modes).reduce(function($n,ko){return $n[ko]=Ke(on.options.modes[ko]),$n},{}),so={},zn={},yo={},On=null,dr=null;yo.drag=function($n,ko){ko({point:$n.point,time:new Date().getTime()})?(on.ui.queueMapClasses({mouse:B.DRAG}),dr.drag($n)):$n.originalEvent.stopPropagation()},yo.mousedrag=function($n){yo.drag($n,function(ko){return!Ce(so,ko)})},yo.touchdrag=function($n){yo.drag($n,function(ko){return!ve(zn,ko)})},yo.mousemove=function($n){if(($n.originalEvent.buttons!==void 0?$n.originalEvent.buttons:$n.originalEvent.which)===1)return yo.mousedrag($n);var ko=xe($n,on);$n.featureTarget=ko,dr.mousemove($n)},yo.mousedown=function($n){so={time:new Date().getTime(),point:$n.point};var ko=xe($n,on);$n.featureTarget=ko,dr.mousedown($n)},yo.mouseup=function($n){var ko=xe($n,on);$n.featureTarget=ko,Ce(so,{point:$n.point,time:new Date().getTime()})?dr.click($n):dr.mouseup($n)},yo.mouseout=function($n){dr.mouseout($n)},yo.touchstart=function($n){if(on.options.touchEnabled){zn={time:new Date().getTime(),point:$n.point};var ko=Je.touch($n,null,on)[0];$n.featureTarget=ko,dr.touchstart($n)}},yo.touchmove=function($n){if(on.options.touchEnabled)return dr.touchmove($n),yo.touchdrag($n)},yo.touchend=function($n){if($n.originalEvent.preventDefault(),on.options.touchEnabled){var ko=Je.touch($n,null,on)[0];$n.featureTarget=ko,ve(zn,{time:new Date().getTime(),point:$n.point})?dr.tap($n):dr.touchend($n)}};var uo=function($n){return!($n===8||$n===46||$n>=48&&$n<=57)};function hr($n,ko,oi){oi===void 0&&(oi={}),dr.stop();var yi=Kn[$n];if(yi===void 0)throw new Error($n+" is not valid");On=$n;var Hn=yi(on,ko);dr=i(Hn,on),oi.silent||on.map.fire(U.MODE_CHANGE,{mode:$n}),on.store.setDirty(),on.store.render()}yo.keydown=function($n){($n.srcElement||$n.target).classList.contains("mapboxgl-canvas")&&($n.keyCode!==8&&$n.keyCode!==46||!on.options.controls.trash?uo($n.keyCode)?dr.keydown($n):$n.keyCode===49&&on.options.controls.point?hr(j.DRAW_POINT):$n.keyCode===50&&on.options.controls.line_string?hr(j.DRAW_LINE_STRING):$n.keyCode===51&&on.options.controls.polygon&&hr(j.DRAW_POLYGON):($n.preventDefault(),dr.trash()))},yo.keyup=function($n){uo($n.keyCode)&&dr.keyup($n)},yo.zoomend=function(){on.store.changeZoom()},yo.data=function($n){if($n.dataType==="style"){var ko=on.setup,oi=on.map,yi=on.options,Hn=on.store;yi.styles.some(function(fr){return oi.getLayer(fr.id)})||(ko.addLayers(),Hn.setDirty(),Hn.render())}};var Ti={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){On=on.options.defaultMode,dr=i(Kn[On](on),on)},changeMode:hr,actionable:function($n){var ko=!1;Object.keys($n).forEach(function(oi){if(Ti[oi]===void 0)throw new Error("Invalid action type");Ti[oi]!==$n[oi]&&(ko=!0),Ti[oi]=$n[oi]}),ko&&on.map.fire(U.ACTIONABLE,{actions:Ti})},currentModeName:function(){return On},currentModeRender:function($n,ko){return dr.render($n,ko)},fire:function($n,ko){yo[$n]&&yo[$n](ko)},addEventListeners:function(){on.map.on("mousemove",yo.mousemove),on.map.on("mousedown",yo.mousedown),on.map.on("mouseup",yo.mouseup),on.map.on("data",yo.data),on.map.on("touchmove",yo.touchmove),on.map.on("touchstart",yo.touchstart),on.map.on("touchend",yo.touchend),on.container.addEventListener("mouseout",yo.mouseout),on.options.keybindings&&(on.container.addEventListener("keydown",yo.keydown),on.container.addEventListener("keyup",yo.keyup))},removeEventListeners:function(){on.map.off("mousemove",yo.mousemove),on.map.off("mousedown",yo.mousedown),on.map.off("mouseup",yo.mouseup),on.map.off("data",yo.data),on.map.off("touchmove",yo.touchmove),on.map.off("touchstart",yo.touchstart),on.map.off("touchend",yo.touchend),on.container.removeEventListener("mouseout",yo.mouseout),on.options.keybindings&&(on.container.removeEventListener("keydown",yo.keydown),on.container.removeEventListener("keyup",yo.keyup))},trash:function($n){dr.trash($n)},combineFeatures:function(){dr.combineFeatures()},uncombineFeatures:function(){dr.uncombineFeatures()},getMode:function(){return On}}}(Z),Z.ui=function(on){var Kn={},so=null,zn={mode:null,feature:null,mouse:null},yo={mode:null,feature:null,mouse:null};function On($n){yo=ln(yo,$n)}function dr(){var $n,ko;if(on.container){var oi=[],yi=[];bn.forEach(function(Hn){yo[Hn]!==zn[Hn]&&(oi.push(Hn+"-"+zn[Hn]),yo[Hn]!==null&&yi.push(Hn+"-"+yo[Hn]))}),oi.length>0&&($n=on.container.classList).remove.apply($n,oi),yi.length>0&&(ko=on.container.classList).add.apply(ko,yi),zn=ln(zn,yo)}}function uo($n,ko){ko===void 0&&(ko={});var oi=document.createElement("button");return oi.className=I.CONTROL_BUTTON+" "+ko.className,oi.setAttribute("title",ko.title),ko.container.appendChild(oi),oi.addEventListener("click",function(yi){if(yi.preventDefault(),yi.stopPropagation(),yi.target===so)return hr(),void ko.onDeactivate();Ti($n),ko.onActivate()},!0),oi}function hr(){so&&(so.classList.remove(I.ACTIVE_BUTTON),so=null)}function Ti($n){hr();var ko=Kn[$n];ko&&ko&&$n!=="trash"&&(ko.classList.add(I.ACTIVE_BUTTON),so=ko)}return{setActiveButton:Ti,queueMapClasses:On,updateMapClasses:dr,clearMapClasses:function(){On({mode:null,feature:null,mouse:null}),dr()},addButtons:function(){var $n=on.options.controls,ko=document.createElement("div");return ko.className=I.CONTROL_GROUP+" "+I.CONTROL_BASE,$n&&($n[N.LINE]&&(Kn[N.LINE]=uo(N.LINE,{container:ko,className:I.CONTROL_BUTTON_LINE,title:"LineString tool "+(on.options.keybindings?"(l)":""),onActivate:function(){return on.events.changeMode(j.DRAW_LINE_STRING)},onDeactivate:function(){return on.events.trash()}})),$n[N.POLYGON]&&(Kn[N.POLYGON]=uo(N.POLYGON,{container:ko,className:I.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(on.options.keybindings?"(p)":""),onActivate:function(){return on.events.changeMode(j.DRAW_POLYGON)},onDeactivate:function(){return on.events.trash()}})),$n[N.POINT]&&(Kn[N.POINT]=uo(N.POINT,{container:ko,className:I.CONTROL_BUTTON_POINT,title:"Marker tool "+(on.options.keybindings?"(m)":""),onActivate:function(){return on.events.changeMode(j.DRAW_POINT)},onDeactivate:function(){return on.events.trash()}})),$n.trash&&(Kn.trash=uo("trash",{container:ko,className:I.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){on.events.trash()}})),$n.combine_features&&(Kn.combine_features=uo("combineFeatures",{container:ko,className:I.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){on.events.combineFeatures()}})),$n.uncombine_features&&(Kn.uncombine_features=uo("uncombineFeatures",{container:ko,className:I.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){on.events.uncombineFeatures()}}))),ko},removeButtons:function(){Object.keys(Kn).forEach(function($n){var ko=Kn[$n];ko.parentNode&&ko.parentNode.removeChild(ko),delete Kn[$n]})}}}(Z),Z.container=Bt.getContainer(),Z.store=new Ut(Z),fe=Z.ui.addButtons(),Z.options.boxSelect&&(Z.boxZoomInitial=Bt.boxZoom.isEnabled(),Bt.boxZoom.disable(),Bt.dragPan.disable(),Bt.dragPan.enable()),Bt.loaded()?wt.connect():(Bt.on("load",wt.connect),Ue=setInterval(function(){Bt.loaded()&&wt.connect()},16)),Z.events.start(),fe},addLayers:function(){Z.map.addSource(F.COLD,{data:{type:D.FEATURE_COLLECTION,features:[]},type:"geojson"}),Z.map.addSource(F.HOT,{data:{type:D.FEATURE_COLLECTION,features:[]},type:"geojson"}),Z.options.styles.forEach(function(Bt){Z.map.addLayer(Bt)}),Z.store.setDirty(!0),Z.store.render()},removeLayers:function(){Z.options.styles.forEach(function(Bt){Z.map.getLayer(Bt.id)&&Z.map.removeLayer(Bt.id)}),Z.map.getSource(F.COLD)&&Z.map.removeSource(F.COLD),Z.map.getSource(F.HOT)&&Z.map.removeSource(F.HOT)}};return Z.setup=wt,wt}var jn=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function yt(Z){return function(fe){var Ue=fe.featureTarget;return!!Ue&&!!Ue.properties&&Ue.properties.meta===Z}}function kn(Z){return!!Z.originalEvent&&!!Z.originalEvent.shiftKey&&Z.originalEvent.button===0}function qn(Z){return!!Z.featureTarget&&!!Z.featureTarget.properties&&Z.featureTarget.properties.active===G.ACTIVE&&Z.featureTarget.properties.meta===K.FEATURE}function Co(Z){return!!Z.featureTarget&&!!Z.featureTarget.properties&&Z.featureTarget.properties.active===G.INACTIVE&&Z.featureTarget.properties.meta===K.FEATURE}function mo(Z){return Z.featureTarget===void 0}function Io(Z){return!!Z.featureTarget&&!!Z.featureTarget.properties&&Z.featureTarget.properties.meta===K.FEATURE}function Ho(Z){var fe=Z.featureTarget;return!!fe&&!!fe.properties&&fe.properties.meta===K.VERTEX}function ur(Z){return!!Z.originalEvent&&Z.originalEvent.shiftKey===!0}function Dt(Z){return Z.keyCode===27}function En(Z){return Z.keyCode===13}var ft=Object.freeze({__proto__:null,isOfMetaType:yt,isShiftMousedown:kn,isActiveFeature:qn,isInactiveFeature:Co,noTarget:mo,isFeature:Io,isVertex:Ho,isShiftDown:ur,isEscapeKey:Dt,isEnterKey:En,isTrue:function(){return!0}}),un=et;function et(Z,fe){this.x=Z,this.y=fe}et.prototype={clone:function(){return new et(this.x,this.y)},add:function(Z){return this.clone()._add(Z)},sub:function(Z){return this.clone()._sub(Z)},multByPoint:function(Z){return this.clone()._multByPoint(Z)},divByPoint:function(Z){return this.clone()._divByPoint(Z)},mult:function(Z){return this.clone()._mult(Z)},div:function(Z){return this.clone()._div(Z)},rotate:function(Z){return this.clone()._rotate(Z)},rotateAround:function(Z,fe){return this.clone()._rotateAround(Z,fe)},matMult:function(Z){return this.clone()._matMult(Z)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(Z){return this.x===Z.x&&this.y===Z.y},dist:function(Z){return Math.sqrt(this.distSqr(Z))},distSqr:function(Z){var fe=Z.x-this.x,Ue=Z.y-this.y;return fe*fe+Ue*Ue},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(Z){return Math.atan2(this.y-Z.y,this.x-Z.x)},angleWith:function(Z){return this.angleWithSep(Z.x,Z.y)},angleWithSep:function(Z,fe){return Math.atan2(this.x*fe-this.y*Z,this.x*Z+this.y*fe)},_matMult:function(Z){var fe=Z[0]*this.x+Z[1]*this.y,Ue=Z[2]*this.x+Z[3]*this.y;return this.x=fe,this.y=Ue,this},_add:function(Z){return this.x+=Z.x,this.y+=Z.y,this},_sub:function(Z){return this.x-=Z.x,this.y-=Z.y,this},_mult:function(Z){return this.x*=Z,this.y*=Z,this},_div:function(Z){return this.x/=Z,this.y/=Z,this},_multByPoint:function(Z){return this.x*=Z.x,this.y*=Z.y,this},_divByPoint:function(Z){return this.x/=Z.x,this.y/=Z.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var Z=this.y;return this.y=this.x,this.x=-Z,this},_rotate:function(Z){var fe=Math.cos(Z),Ue=Math.sin(Z),wt=fe*this.x-Ue*this.y,Bt=Ue*this.x+fe*this.y;return this.x=wt,this.y=Bt,this},_rotateAround:function(Z,fe){var Ue=Math.cos(Z),wt=Math.sin(Z),Bt=fe.x+Ue*(this.x-fe.x)-wt*(this.y-fe.y),Vt=fe.y+wt*(this.x-fe.x)+Ue*(this.y-fe.y);return this.x=Bt,this.y=Vt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},et.convert=function(Z){return Z instanceof et?Z:Array.isArray(Z)?new et(Z[0],Z[1]):Z};var Mn=s(un);function Bn(Z,fe){var Ue=fe.getBoundingClientRect();return new Mn(Z.clientX-Ue.left-(fe.clientLeft||0),Z.clientY-Ue.top-(fe.clientTop||0))}function Lo(Z,fe,Ue,wt){return{type:D.FEATURE,properties:{meta:K.VERTEX,parent:Z,coord_path:Ue,active:wt?G.ACTIVE:G.INACTIVE},geometry:{type:D.POINT,coordinates:fe}}}function Rr(Z,fe,Ue){var wt=fe.geometry.coordinates,Bt=Ue.geometry.coordinates;if(wt[1]>85||wt[1]<oe||Bt[1]>85||Bt[1]<oe)return null;var Vt={lng:(wt[0]+Bt[0])/2,lat:(wt[1]+Bt[1])/2};return{type:D.FEATURE,properties:{meta:K.MIDPOINT,parent:Z,lng:Vt.lng,lat:Vt.lat,coord_path:Ue.properties.coord_path},geometry:{type:D.POINT,coordinates:[Vt.lng,Vt.lat]}}}function hi(Z,fe,Ue){fe===void 0&&(fe={}),Ue===void 0&&(Ue=null);var wt,Bt=Z.geometry,Vt=Bt.type,on=Bt.coordinates,Kn=Z.properties&&Z.properties.id,so=[];function zn(On,dr){var uo="",hr=null;On.forEach(function(Ti,$n){var ko=dr!=null?dr+"."+$n:String($n),oi=Lo(Kn,Ti,ko,yo(ko));if(fe.midpoints&&hr){var yi=Rr(Kn,hr,oi);yi&&so.push(yi)}hr=oi;var Hn=JSON.stringify(Ti);uo!==Hn&&so.push(oi),$n===0&&(uo=Hn)})}function yo(On){return!!fe.selectedPaths&&fe.selectedPaths.indexOf(On)!==-1}return Vt===D.POINT?so.push(Lo(Kn,on,Ue,yo(Ue))):Vt===D.POLYGON?on.forEach(function(On,dr){zn(On,Ue!==null?Ue+"."+dr:String(dr))}):Vt===D.LINE_STRING?zn(on,Ue):Vt.indexOf(D.MULTI_PREFIX)===0&&(wt=Vt.replace(D.MULTI_PREFIX,""),on.forEach(function(On,dr){var uo={type:D.FEATURE,properties:Z.properties,geometry:{type:wt,coordinates:On}};so=so.concat(hi(uo,fe,dr))})),so}var Er={enable:function(Z){setTimeout(function(){Z.map&&Z.map.doubleClickZoom&&Z._ctx&&Z._ctx.store&&Z._ctx.store.getInitialConfigValue&&Z._ctx.store.getInitialConfigValue("doubleClickZoom")&&Z.map.doubleClickZoom.enable()},0)},disable:function(Z){setTimeout(function(){Z.map&&Z.map.doubleClickZoom&&Z.map.doubleClickZoom.disable()},0)}},Nr={exports:{}},Xo=function(Z){if(!Z||!Z.type)return null;var fe=Bi[Z.type];if(!fe)return null;if(fe==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:Z}]};if(fe==="feature")return{type:"FeatureCollection",features:[Z]};if(fe==="featurecollection")return Z},Bi={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},$s=s(Xo),Zt=Object.freeze({__proto__:null,default:function Z(fe){switch(fe&&fe.type||null){case"FeatureCollection":return fe.features=fe.features.reduce(function(Ue,wt){return Ue.concat(Z(wt))},[]),fe;case"Feature":return fe.geometry?Z(fe.geometry).map(function(Ue){var wt={type:"Feature",properties:JSON.parse(JSON.stringify(fe.properties)),geometry:Ue};return fe.id!==void 0&&(wt.id=fe.id),wt}):[fe];case"MultiPoint":return fe.coordinates.map(function(Ue){return{type:"Point",coordinates:Ue}});case"MultiPolygon":return fe.coordinates.map(function(Ue){return{type:"Polygon",coordinates:Ue}});case"MultiLineString":return fe.coordinates.map(function(Ue){return{type:"LineString",coordinates:Ue}});case"GeometryCollection":return fe.geometries.map(Z).reduce(function(Ue,wt){return Ue.concat(wt)},[]);case"Point":case"Polygon":case"LineString":return[fe]}}}),Ee=Xo,ke=d(Zt),qe=function(Z){return function fe(Ue){return Array.isArray(Ue)&&Ue.length&&typeof Ue[0]=="number"?[Ue]:Ue.reduce(function(wt,Bt){return Array.isArray(Bt)&&Array.isArray(Bt[0])?wt.concat(fe(Bt)):(wt.push(Bt),wt)},[])}(Z)};ke instanceof Function||(ke=ke.default);var mt={exports:{}},it=mt.exports=function(Z){return new xt(Z)};function xt(Z){this.value=Z}function qt(Z,fe,Ue){var wt=[],Bt=[],Vt=!0;return function on(Kn){var so=Ue?kt(Kn):Kn,zn={},yo=!0,On={node:so,node_:Kn,path:[].concat(wt),parent:Bt[Bt.length-1],parents:Bt,key:wt.slice(-1)[0],isRoot:wt.length===0,level:wt.length,circular:null,update:function(hr,Ti){On.isRoot||(On.parent.node[On.key]=hr),On.node=hr,Ti&&(yo=!1)},delete:function(hr){delete On.parent.node[On.key],hr&&(yo=!1)},remove:function(hr){nn(On.parent.node)?On.parent.node.splice(On.key,1):delete On.parent.node[On.key],hr&&(yo=!1)},keys:null,before:function(hr){zn.before=hr},after:function(hr){zn.after=hr},pre:function(hr){zn.pre=hr},post:function(hr){zn.post=hr},stop:function(){Vt=!1},block:function(){yo=!1}};if(!Vt)return On;function dr(){if(typeof On.node=="object"&&On.node!==null){On.keys&&On.node_===On.node||(On.keys=Wt(On.node)),On.isLeaf=On.keys.length==0;for(var hr=0;hr<Bt.length;hr++)if(Bt[hr].node_===Kn){On.circular=Bt[hr];break}}else On.isLeaf=!0,On.keys=null;On.notLeaf=!On.isLeaf,On.notRoot=!On.isRoot}dr();var uo=fe.call(On,On.node);return uo!==void 0&&On.update&&On.update(uo),zn.before&&zn.before.call(On,On.node),yo&&(typeof On.node!="object"||On.node===null||On.circular||(Bt.push(On),dr(),gt(On.keys,function(hr,Ti){wt.push(hr),zn.pre&&zn.pre.call(On,On.node[hr],hr);var $n=on(On.node[hr]);Ue&&Yt.call(On.node,hr)&&(On.node[hr]=$n.node),$n.isLast=Ti==On.keys.length-1,$n.isFirst=Ti==0,zn.post&&zn.post.call(On,$n),wt.pop()}),Bt.pop()),zn.after&&zn.after.call(On,On.node)),On}(Z).node}function kt(Z){if(typeof Z=="object"&&Z!==null){var fe;if(nn(Z))fe=[];else if(Qt(Z)==="[object Date]")fe=new Date(Z.getTime?Z.getTime():Z);else if(function(Bt){return Qt(Bt)==="[object RegExp]"}(Z))fe=new RegExp(Z);else if(function(Bt){return Qt(Bt)==="[object Error]"}(Z))fe={message:Z.message};else if(function(Bt){return Qt(Bt)==="[object Boolean]"}(Z))fe=new Boolean(Z);else if(function(Bt){return Qt(Bt)==="[object Number]"}(Z))fe=new Number(Z);else if(function(Bt){return Qt(Bt)==="[object String]"}(Z))fe=new String(Z);else if(Object.create&&Object.getPrototypeOf)fe=Object.create(Object.getPrototypeOf(Z));else if(Z.constructor===Object)fe={};else{var Ue=Z.constructor&&Z.constructor.prototype||Z.__proto__||{},wt=function(){};wt.prototype=Ue,fe=new wt}return gt(Wt(Z),function(Bt){fe[Bt]=Z[Bt]}),fe}return Z}xt.prototype.get=function(Z){for(var fe=this.value,Ue=0;Ue<Z.length;Ue++){var wt=Z[Ue];if(!fe||!Yt.call(fe,wt)){fe=void 0;break}fe=fe[wt]}return fe},xt.prototype.has=function(Z){for(var fe=this.value,Ue=0;Ue<Z.length;Ue++){var wt=Z[Ue];if(!fe||!Yt.call(fe,wt))return!1;fe=fe[wt]}return!0},xt.prototype.set=function(Z,fe){for(var Ue=this.value,wt=0;wt<Z.length-1;wt++){var Bt=Z[wt];Yt.call(Ue,Bt)||(Ue[Bt]={}),Ue=Ue[Bt]}return Ue[Z[wt]]=fe,fe},xt.prototype.map=function(Z){return qt(this.value,Z,!0)},xt.prototype.forEach=function(Z){return this.value=qt(this.value,Z,!1),this.value},xt.prototype.reduce=function(Z,fe){var Ue=arguments.length===1,wt=Ue?this.value:fe;return this.forEach(function(Bt){this.isRoot&&Ue||(wt=Z.call(this,wt,Bt))}),wt},xt.prototype.paths=function(){var Z=[];return this.forEach(function(fe){Z.push(this.path)}),Z},xt.prototype.nodes=function(){var Z=[];return this.forEach(function(fe){Z.push(this.node)}),Z},xt.prototype.clone=function(){var Z=[],fe=[];return function Ue(wt){for(var Bt=0;Bt<Z.length;Bt++)if(Z[Bt]===wt)return fe[Bt];if(typeof wt=="object"&&wt!==null){var Vt=kt(wt);return Z.push(wt),fe.push(Vt),gt(Wt(wt),function(on){Vt[on]=Ue(wt[on])}),Z.pop(),fe.pop(),Vt}return wt}(this.value)};var Wt=Object.keys||function(Z){var fe=[];for(var Ue in Z)fe.push(Ue);return fe};function Qt(Z){return Object.prototype.toString.call(Z)}var nn=Array.isArray||function(Z){return Object.prototype.toString.call(Z)==="[object Array]"},gt=function(Z,fe){if(Z.forEach)return Z.forEach(fe);for(var Ue=0;Ue<Z.length;Ue++)fe(Z[Ue],Ue,Z)};gt(Wt(xt.prototype),function(Z){it[Z]=function(fe){var Ue=[].slice.call(arguments,1),wt=new xt(fe);return wt[Z].apply(wt,Ue)}});var Yt=Object.hasOwnProperty||function(Z,fe){return fe in Z},In=mt.exports,ho=co;function co(Z){if(!(this instanceof co))return new co(Z);this._bbox=Z||[1/0,1/0,-1/0,-1/0],this._valid=!!Z}co.prototype.include=function(Z){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],Z[0]),this._bbox[1]=Math.min(this._bbox[1],Z[1]),this._bbox[2]=Math.max(this._bbox[2],Z[0]),this._bbox[3]=Math.max(this._bbox[3],Z[1]),this},co.prototype.equals=function(Z){var fe;return fe=Z instanceof co?Z.bbox():Z,this._bbox[0]==fe[0]&&this._bbox[1]==fe[1]&&this._bbox[2]==fe[2]&&this._bbox[3]==fe[3]},co.prototype.center=function(Z){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},co.prototype.union=function(Z){var fe;return this._valid=!0,fe=Z instanceof co?Z.bbox():Z,this._bbox[0]=Math.min(this._bbox[0],fe[0]),this._bbox[1]=Math.min(this._bbox[1],fe[1]),this._bbox[2]=Math.max(this._bbox[2],fe[2]),this._bbox[3]=Math.max(this._bbox[3],fe[3]),this},co.prototype.bbox=function(){return this._valid?this._bbox:null},co.prototype.contains=function(Z){if(!Z)return this._fastContains();if(!this._valid)return null;var fe=Z[0],Ue=Z[1];return this._bbox[0]<=fe&&this._bbox[1]<=Ue&&this._bbox[2]>=fe&&this._bbox[3]>=Ue},co.prototype.intersect=function(Z){return this._valid?(fe=Z instanceof co?Z.bbox():Z,!(this._bbox[0]>fe[2]||this._bbox[2]<fe[0]||this._bbox[3]<fe[1]||this._bbox[1]>fe[3])):null;var fe},co.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var Z="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",Z)},co.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Oo=function(Z){if(!Z)return[];var fe=ke(Ee(Z)),Ue=[];return fe.features.forEach(function(wt){wt.geometry&&(Ue=Ue.concat(qe(wt.geometry.coordinates)))}),Ue},Eo=In,cr=ho,rr={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},qo=Object.keys(rr);function cn(Z){for(var fe=cr(),Ue=Oo(Z),wt=0;wt<Ue.length;wt++)fe.include(Ue[wt]);return fe}Nr.exports=function(Z){return cn(Z).bbox()},Nr.exports.polygon=function(Z){return cn(Z).polygon()},Nr.exports.bboxify=function(Z){return Eo(Z).map(function(fe){fe&&qo.some(function(Ue){return!!fe[Ue]&&rr[Ue].indexOf(fe.type)!==-1})&&(fe.bbox=cn(fe).bbox(),this.update(fe))})};var Yn=s(Nr.exports),To=-90;function $o(Z,fe){var Ue=To,wt=90,Bt=To,Vt=90,on=270,Kn=-270;Z.forEach(function(zn){var yo=Yn(zn),On=yo[1],dr=yo[3],uo=yo[0],hr=yo[2];On>Ue&&(Ue=On),dr<wt&&(wt=dr),dr>Bt&&(Bt=dr),On<Vt&&(Vt=On),uo<on&&(on=uo),hr>Kn&&(Kn=hr)});var so=fe;return Ue+so.lat>85&&(so.lat=85-Ue),Bt+so.lat>90&&(so.lat=90-Bt),wt+so.lat<-85&&(so.lat=-85-wt),Vt+so.lat<To&&(so.lat=To-Vt),on+so.lng<=-270&&(so.lng+=360*Math.ceil(Math.abs(so.lng)/360)),Kn+so.lng>=270&&(so.lng-=360*Math.ceil(Math.abs(so.lng)/360)),so}function Ar(Z,fe){var Ue=$o(Z.map(function(wt){return wt.toGeoJSON()}),fe);Z.forEach(function(wt){var Bt,Vt=wt.getCoordinates(),on=function(so){var zn={lng:so[0]+Ue.lng,lat:so[1]+Ue.lat};return[zn.lng,zn.lat]},Kn=function(so){return so.map(function(zn){return on(zn)})};wt.type===D.POINT?Bt=on(Vt):wt.type===D.LINE_STRING||wt.type===D.MULTI_POINT?Bt=Vt.map(on):wt.type===D.POLYGON||wt.type===D.MULTI_LINE_STRING?Bt=Vt.map(Kn):wt.type===D.MULTI_POLYGON&&(Bt=Vt.map(function(so){return so.map(function(zn){return Kn(zn)})})),wt.incomingCoords(Bt)})}var yr={onSetup:function(Z){var fe=this,Ue={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:Z.featureIds||[]};return this.setSelected(Ue.initiallySelectedFeatureIds.filter(function(wt){return fe.getFeature(wt)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Ue},fireUpdate:function(){this.map.fire(U.UPDATE,{action:ne.MOVE,features:this.getSelected().map(function(Z){return Z.toGeoJSON()})})},fireActionable:function(){var Z=this,fe=this.getSelected(),Ue=fe.filter(function(Kn){return Z.isInstanceOf("MultiFeature",Kn)}),wt=!1;if(fe.length>1){wt=!0;var Bt=fe[0].type.replace("Multi","");fe.forEach(function(Kn){Kn.type.replace("Multi","")!==Bt&&(wt=!1)})}var Vt=Ue.length>0,on=fe.length>0;this.setActionableState({combineFeatures:wt,uncombineFeatures:Vt,trash:on})},getUniqueIds:function(Z){return Z.length?Z.map(function(fe){return fe.properties.id}).filter(function(fe){return fe!==void 0}).reduce(function(fe,Ue){return fe.add(Ue),fe},new ge).values():[]},stopExtendedInteractions:function(Z){Z.boxSelectElement&&(Z.boxSelectElement.parentNode&&Z.boxSelectElement.parentNode.removeChild(Z.boxSelectElement),Z.boxSelectElement=null),this.map.dragPan.enable(),Z.boxSelecting=!1,Z.canBoxSelect=!1,Z.dragMoving=!1,Z.canDragMove=!1},onStop:function(){Er.enable(this)},onMouseMove:function(Z,fe){return Io(fe)&&Z.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(Z),!0},onMouseOut:function(Z){return!Z.dragMoving||this.fireUpdate()}};yr.onTap=yr.onClick=function(Z,fe){return mo(fe)?this.clickAnywhere(Z,fe):yt(K.VERTEX)(fe)?this.clickOnVertex(Z,fe):Io(fe)?this.clickOnFeature(Z,fe):void 0},yr.clickAnywhere=function(Z){var fe=this,Ue=this.getSelectedIds();Ue.length&&(this.clearSelectedFeatures(),Ue.forEach(function(wt){return fe.doRender(wt)})),Er.enable(this),this.stopExtendedInteractions(Z)},yr.clickOnVertex=function(Z,fe){this.changeMode(j.DIRECT_SELECT,{featureId:fe.featureTarget.properties.parent,coordPath:fe.featureTarget.properties.coord_path,startPos:fe.lngLat}),this.updateUIClasses({mouse:B.MOVE})},yr.startOnActiveFeature=function(Z,fe){this.stopExtendedInteractions(Z),this.map.dragPan.disable(),this.doRender(fe.featureTarget.properties.id),Z.canDragMove=!0,Z.dragMoveLocation=fe.lngLat},yr.clickOnFeature=function(Z,fe){var Ue=this;Er.disable(this),this.stopExtendedInteractions(Z);var wt=ur(fe),Bt=this.getSelectedIds(),Vt=fe.featureTarget.properties.id,on=this.isSelected(Vt);if(!wt&&on&&this.getFeature(Vt).type!==D.POINT)return this.changeMode(j.DIRECT_SELECT,{featureId:Vt});on&&wt?(this.deselect(Vt),this.updateUIClasses({mouse:B.POINTER}),Bt.length===1&&Er.enable(this)):!on&&wt?(this.select(Vt),this.updateUIClasses({mouse:B.MOVE})):on||wt||(Bt.forEach(function(Kn){return Ue.doRender(Kn)}),this.setSelected(Vt),this.updateUIClasses({mouse:B.MOVE})),this.doRender(Vt)},yr.onMouseDown=function(Z,fe){return qn(fe)?this.startOnActiveFeature(Z,fe):this.drawConfig.boxSelect&&kn(fe)?this.startBoxSelect(Z,fe):void 0},yr.startBoxSelect=function(Z,fe){this.stopExtendedInteractions(Z),this.map.dragPan.disable(),Z.boxSelectStartLocation=Bn(fe.originalEvent,this.map.getContainer()),Z.canBoxSelect=!0},yr.onTouchStart=function(Z,fe){if(qn(fe))return this.startOnActiveFeature(Z,fe)},yr.onDrag=function(Z,fe){return Z.canDragMove?this.dragMove(Z,fe):this.drawConfig.boxSelect&&Z.canBoxSelect?this.whileBoxSelect(Z,fe):void 0},yr.whileBoxSelect=function(Z,fe){Z.boxSelecting=!0,this.updateUIClasses({mouse:B.ADD}),Z.boxSelectElement||(Z.boxSelectElement=document.createElement("div"),Z.boxSelectElement.classList.add(I.BOX_SELECT),this.map.getContainer().appendChild(Z.boxSelectElement));var Ue=Bn(fe.originalEvent,this.map.getContainer()),wt=Math.min(Z.boxSelectStartLocation.x,Ue.x),Bt=Math.max(Z.boxSelectStartLocation.x,Ue.x),Vt=Math.min(Z.boxSelectStartLocation.y,Ue.y),on=Math.max(Z.boxSelectStartLocation.y,Ue.y),Kn="translate("+wt+"px, "+Vt+"px)";Z.boxSelectElement.style.transform=Kn,Z.boxSelectElement.style.WebkitTransform=Kn,Z.boxSelectElement.style.width=Bt-wt+"px",Z.boxSelectElement.style.height=on-Vt+"px"},yr.dragMove=function(Z,fe){Z.dragMoving=!0,fe.originalEvent.stopPropagation();var Ue={lng:fe.lngLat.lng-Z.dragMoveLocation.lng,lat:fe.lngLat.lat-Z.dragMoveLocation.lat};Ar(this.getSelected(),Ue),Z.dragMoveLocation=fe.lngLat},yr.onTouchEnd=yr.onMouseUp=function(Z,fe){var Ue=this;if(Z.dragMoving)this.fireUpdate();else if(Z.boxSelecting){var wt=[Z.boxSelectStartLocation,Bn(fe.originalEvent,this.map.getContainer())],Bt=this.featuresAt(null,wt,"click"),Vt=this.getUniqueIds(Bt).filter(function(on){return!Ue.isSelected(on)});Vt.length&&(this.select(Vt),Vt.forEach(function(on){return Ue.doRender(on)}),this.updateUIClasses({mouse:B.MOVE}))}this.stopExtendedInteractions(Z)},yr.toDisplayFeatures=function(Z,fe,Ue){fe.properties.active=this.isSelected(fe.properties.id)?G.ACTIVE:G.INACTIVE,Ue(fe),this.fireActionable(),fe.properties.active===G.ACTIVE&&fe.geometry.type!==D.POINT&&hi(fe).forEach(Ue)},yr.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},yr.onCombineFeatures=function(){var Z=this.getSelected();if(!(Z.length===0||Z.length<2)){for(var fe=[],Ue=[],wt=Z[0].type.replace("Multi",""),Bt=0;Bt<Z.length;Bt++){var Vt=Z[Bt];if(Vt.type.replace("Multi","")!==wt)return;Vt.type.includes("Multi")?Vt.getCoordinates().forEach(function(Kn){fe.push(Kn)}):fe.push(Vt.getCoordinates()),Ue.push(Vt.toGeoJSON())}if(Ue.length>1){var on=this.newFeature({type:D.FEATURE,properties:Ue[0].properties,geometry:{type:"Multi"+wt,coordinates:fe}});this.addFeature(on),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([on.id]),this.map.fire(U.COMBINE_FEATURES,{createdFeatures:[on.toGeoJSON()],deletedFeatures:Ue})}this.fireActionable()}},yr.onUncombineFeatures=function(){var Z=this,fe=this.getSelected();if(fe.length!==0){for(var Ue=[],wt=[],Bt=function(on){var Kn=fe[on];Z.isInstanceOf("MultiFeature",Kn)&&(Kn.getFeatures().forEach(function(so){Z.addFeature(so),so.properties=Kn.properties,Ue.push(so.toGeoJSON()),Z.select([so.id])}),Z.deleteFeature(Kn.id,{silent:!0}),wt.push(Kn.toGeoJSON()))},Vt=0;Vt<fe.length;Vt++)Bt(Vt);Ue.length>1&&this.map.fire(U.UNCOMBINE_FEATURES,{createdFeatures:Ue,deletedFeatures:wt}),this.fireActionable()}};var al=yt(K.VERTEX),ms=yt(K.MIDPOINT),gs={fireUpdate:function(){this.map.fire(U.UPDATE,{action:ne.CHANGE_COORDINATES,features:this.getSelected().map(function(Z){return Z.toGeoJSON()})})},fireActionable:function(Z){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:Z.selectedCoordPaths.length>0})},startDragging:function(Z,fe){this.map.dragPan.disable(),Z.canDragMove=!0,Z.dragMoveLocation=fe.lngLat},stopDragging:function(Z){this.map.dragPan.enable(),Z.dragMoving=!1,Z.canDragMove=!1,Z.dragMoveLocation=null},onVertex:function(Z,fe){this.startDragging(Z,fe);var Ue=fe.featureTarget.properties,wt=Z.selectedCoordPaths.indexOf(Ue.coord_path);ur(fe)||wt!==-1?ur(fe)&&wt===-1&&Z.selectedCoordPaths.push(Ue.coord_path):Z.selectedCoordPaths=[Ue.coord_path];var Bt=this.pathsToCoordinates(Z.featureId,Z.selectedCoordPaths);this.setSelectedCoordinates(Bt)},onMidpoint:function(Z,fe){this.startDragging(Z,fe);var Ue=fe.featureTarget.properties;Z.feature.addCoordinate(Ue.coord_path,Ue.lng,Ue.lat),this.fireUpdate(),Z.selectedCoordPaths=[Ue.coord_path]},pathsToCoordinates:function(Z,fe){return fe.map(function(Ue){return{feature_id:Z,coord_path:Ue}})},onFeature:function(Z,fe){Z.selectedCoordPaths.length===0?this.startDragging(Z,fe):this.stopDragging(Z)},dragFeature:function(Z,fe,Ue){Ar(this.getSelected(),Ue),Z.dragMoveLocation=fe.lngLat},dragVertex:function(Z,fe,Ue){for(var wt=Z.selectedCoordPaths.map(function(Kn){return Z.feature.getCoordinate(Kn)}),Bt=$o(wt.map(function(Kn){return{type:D.FEATURE,properties:{},geometry:{type:D.POINT,coordinates:Kn}}}),Ue),Vt=0;Vt<wt.length;Vt++){var on=wt[Vt];Z.feature.updateCoordinate(Z.selectedCoordPaths[Vt],on[0]+Bt.lng,on[1]+Bt.lat)}},clickNoTarget:function(){this.changeMode(j.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(j.SIMPLE_SELECT)},clickActiveFeature:function(Z){Z.selectedCoordPaths=[],this.clearSelectedCoordinates(),Z.feature.changed()},onSetup:function(Z){var fe=Z.featureId,Ue=this.getFeature(fe);if(!Ue)throw new Error("You must provide a featureId to enter direct_select mode");if(Ue.type===D.POINT)throw new TypeError("direct_select mode doesn't handle point features");var wt={featureId:fe,feature:Ue,dragMoveLocation:Z.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:Z.coordPath?[Z.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(fe,wt.selectedCoordPaths)),this.setSelected(fe),Er.disable(this),this.setActionableState({trash:!0}),wt},onStop:function(){Er.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(Z,fe,Ue){Z.featureId===fe.properties.id?(fe.properties.active=G.ACTIVE,Ue(fe),hi(fe,{map:this.map,midpoints:!0,selectedPaths:Z.selectedCoordPaths}).forEach(Ue)):(fe.properties.active=G.INACTIVE,Ue(fe)),this.fireActionable(Z)},onTrash:function(Z){Z.selectedCoordPaths.sort(function(fe,Ue){return Ue.localeCompare(fe,"en",{numeric:!0})}).forEach(function(fe){return Z.feature.removeCoordinate(fe)}),this.fireUpdate(),Z.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(Z),Z.feature.isValid()===!1&&(this.deleteFeature([Z.featureId]),this.changeMode(j.SIMPLE_SELECT,{}))},onMouseMove:function(Z,fe){var Ue=qn(fe),wt=al(fe),Bt=ms(fe),Vt=Z.selectedCoordPaths.length===0;return Ue&&Vt||wt&&!Vt?this.updateUIClasses({mouse:B.MOVE}):this.updateUIClasses({mouse:B.NONE}),(wt||Ue||Bt)&&Z.dragMoving&&this.fireUpdate(),this.stopDragging(Z),!0},onMouseOut:function(Z){return Z.dragMoving&&this.fireUpdate(),!0}};gs.onTouchStart=gs.onMouseDown=function(Z,fe){return al(fe)?this.onVertex(Z,fe):qn(fe)?this.onFeature(Z,fe):ms(fe)?this.onMidpoint(Z,fe):void 0},gs.onDrag=function(Z,fe){if(Z.canDragMove===!0){Z.dragMoving=!0,fe.originalEvent.stopPropagation();var Ue={lng:fe.lngLat.lng-Z.dragMoveLocation.lng,lat:fe.lngLat.lat-Z.dragMoveLocation.lat};Z.selectedCoordPaths.length>0?this.dragVertex(Z,fe,Ue):this.dragFeature(Z,fe,Ue),Z.dragMoveLocation=fe.lngLat}},gs.onClick=function(Z,fe){return mo(fe)?this.clickNoTarget(Z,fe):qn(fe)?this.clickActiveFeature(Z,fe):Co(fe)?this.clickInactive(Z,fe):void this.stopDragging(Z)},gs.onTap=function(Z,fe){return mo(fe)?this.clickNoTarget(Z,fe):qn(fe)?this.clickActiveFeature(Z,fe):Co(fe)?this.clickInactive(Z,fe):void 0},gs.onTouchEnd=gs.onMouseUp=function(Z){Z.dragMoving&&this.fireUpdate(),this.stopDragging(Z)};var za={};function lc(Z,fe){return!!Z.lngLat&&Z.lngLat.lng===fe[0]&&Z.lngLat.lat===fe[1]}za.onSetup=function(){var Z=this.newFeature({type:D.FEATURE,properties:{},geometry:{type:D.POINT,coordinates:[]}});return this.addFeature(Z),this.clearSelectedFeatures(),this.updateUIClasses({mouse:B.ADD}),this.activateUIButton(N.POINT),this.setActionableState({trash:!0}),{point:Z}},za.stopDrawingAndRemove=function(Z){this.deleteFeature([Z.point.id],{silent:!0}),this.changeMode(j.SIMPLE_SELECT)},za.onTap=za.onClick=function(Z,fe){this.updateUIClasses({mouse:B.MOVE}),Z.point.updateCoordinate("",fe.lngLat.lng,fe.lngLat.lat),this.map.fire(U.CREATE,{features:[Z.point.toGeoJSON()]}),this.changeMode(j.SIMPLE_SELECT,{featureIds:[Z.point.id]})},za.onStop=function(Z){this.activateUIButton(),Z.point.getCoordinate().length||this.deleteFeature([Z.point.id],{silent:!0})},za.toDisplayFeatures=function(Z,fe,Ue){var wt=fe.properties.id===Z.point.id;if(fe.properties.active=wt?G.ACTIVE:G.INACTIVE,!wt)return Ue(fe)},za.onTrash=za.stopDrawingAndRemove,za.onKeyUp=function(Z,fe){if(Dt(fe)||En(fe))return this.stopDrawingAndRemove(Z,fe)};var sl={onSetup:function(){var Z=this.newFeature({type:D.FEATURE,properties:{},geometry:{type:D.POLYGON,coordinates:[[]]}});return this.addFeature(Z),this.clearSelectedFeatures(),Er.disable(this),this.updateUIClasses({mouse:B.ADD}),this.activateUIButton(N.POLYGON),this.setActionableState({trash:!0}),{polygon:Z,currentVertexPosition:0}},clickAnywhere:function(Z,fe){if(Z.currentVertexPosition>0&&lc(fe,Z.polygon.coordinates[0][Z.currentVertexPosition-1]))return this.changeMode(j.SIMPLE_SELECT,{featureIds:[Z.polygon.id]});this.updateUIClasses({mouse:B.ADD}),Z.polygon.updateCoordinate("0."+Z.currentVertexPosition,fe.lngLat.lng,fe.lngLat.lat),Z.currentVertexPosition++,Z.polygon.updateCoordinate("0."+Z.currentVertexPosition,fe.lngLat.lng,fe.lngLat.lat)},clickOnVertex:function(Z){return this.changeMode(j.SIMPLE_SELECT,{featureIds:[Z.polygon.id]})},onMouseMove:function(Z,fe){Z.polygon.updateCoordinate("0."+Z.currentVertexPosition,fe.lngLat.lng,fe.lngLat.lat),Ho(fe)&&this.updateUIClasses({mouse:B.POINTER})}};sl.onTap=sl.onClick=function(Z,fe){return Ho(fe)?this.clickOnVertex(Z,fe):this.clickAnywhere(Z,fe)},sl.onKeyUp=function(Z,fe){Dt(fe)?(this.deleteFeature([Z.polygon.id],{silent:!0}),this.changeMode(j.SIMPLE_SELECT)):En(fe)&&this.changeMode(j.SIMPLE_SELECT,{featureIds:[Z.polygon.id]})},sl.onStop=function(Z){this.updateUIClasses({mouse:B.NONE}),Er.enable(this),this.activateUIButton(),this.getFeature(Z.polygon.id)!==void 0&&(Z.polygon.removeCoordinate("0."+Z.currentVertexPosition),Z.polygon.isValid()?this.map.fire(U.CREATE,{features:[Z.polygon.toGeoJSON()]}):(this.deleteFeature([Z.polygon.id],{silent:!0}),this.changeMode(j.SIMPLE_SELECT,{},{silent:!0})))},sl.toDisplayFeatures=function(Z,fe,Ue){var wt=fe.properties.id===Z.polygon.id;if(fe.properties.active=wt?G.ACTIVE:G.INACTIVE,!wt)return Ue(fe);if(fe.geometry.coordinates.length!==0){var Bt=fe.geometry.coordinates[0].length;if(!(Bt<3)){if(fe.properties.meta=K.FEATURE,Ue(Lo(Z.polygon.id,fe.geometry.coordinates[0][0],"0.0",!1)),Bt>3){var Vt=fe.geometry.coordinates[0].length-3;Ue(Lo(Z.polygon.id,fe.geometry.coordinates[0][Vt],"0."+Vt,!1))}if(Bt<=4){var on=[[fe.geometry.coordinates[0][0][0],fe.geometry.coordinates[0][0][1]],[fe.geometry.coordinates[0][1][0],fe.geometry.coordinates[0][1][1]]];if(Ue({type:D.FEATURE,properties:fe.properties,geometry:{coordinates:on,type:D.LINE_STRING}}),Bt===3)return}return Ue(fe)}}},sl.onTrash=function(Z){this.deleteFeature([Z.polygon.id],{silent:!0}),this.changeMode(j.SIMPLE_SELECT)};var ll={onSetup:function(Z){var fe,Ue,wt=(Z=Z||{}).featureId,Bt="forward";if(wt){if(!(fe=this.getFeature(wt)))throw new Error("Could not find a feature with the provided featureId");var Vt=Z.from;if(Vt&&Vt.type==="Feature"&&Vt.geometry&&Vt.geometry.type==="Point"&&(Vt=Vt.geometry),Vt&&Vt.type==="Point"&&Vt.coordinates&&Vt.coordinates.length===2&&(Vt=Vt.coordinates),!Vt||!Array.isArray(Vt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var on=fe.coordinates.length-1;if(fe.coordinates[on][0]===Vt[0]&&fe.coordinates[on][1]===Vt[1])Ue=on+1,fe.addCoordinate.apply(fe,[Ue].concat(fe.coordinates[on]));else{if(fe.coordinates[0][0]!==Vt[0]||fe.coordinates[0][1]!==Vt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Bt="backwards",Ue=0,fe.addCoordinate.apply(fe,[Ue].concat(fe.coordinates[0]))}}else fe=this.newFeature({type:D.FEATURE,properties:{},geometry:{type:D.LINE_STRING,coordinates:[]}}),Ue=0,this.addFeature(fe);return this.clearSelectedFeatures(),Er.disable(this),this.updateUIClasses({mouse:B.ADD}),this.activateUIButton(N.LINE),this.setActionableState({trash:!0}),{line:fe,currentVertexPosition:Ue,direction:Bt}},clickAnywhere:function(Z,fe){if(Z.currentVertexPosition>0&&lc(fe,Z.line.coordinates[Z.currentVertexPosition-1])||Z.direction==="backwards"&&lc(fe,Z.line.coordinates[Z.currentVertexPosition+1]))return this.changeMode(j.SIMPLE_SELECT,{featureIds:[Z.line.id]});this.updateUIClasses({mouse:B.ADD}),Z.line.updateCoordinate(Z.currentVertexPosition,fe.lngLat.lng,fe.lngLat.lat),Z.direction==="forward"?(Z.currentVertexPosition++,Z.line.updateCoordinate(Z.currentVertexPosition,fe.lngLat.lng,fe.lngLat.lat)):Z.line.addCoordinate(0,fe.lngLat.lng,fe.lngLat.lat)},clickOnVertex:function(Z){return this.changeMode(j.SIMPLE_SELECT,{featureIds:[Z.line.id]})},onMouseMove:function(Z,fe){Z.line.updateCoordinate(Z.currentVertexPosition,fe.lngLat.lng,fe.lngLat.lat),Ho(fe)&&this.updateUIClasses({mouse:B.POINTER})}};ll.onTap=ll.onClick=function(Z,fe){if(Ho(fe))return this.clickOnVertex(Z,fe);this.clickAnywhere(Z,fe)},ll.onKeyUp=function(Z,fe){En(fe)?this.changeMode(j.SIMPLE_SELECT,{featureIds:[Z.line.id]}):Dt(fe)&&(this.deleteFeature([Z.line.id],{silent:!0}),this.changeMode(j.SIMPLE_SELECT))},ll.onStop=function(Z){Er.enable(this),this.activateUIButton(),this.getFeature(Z.line.id)!==void 0&&(Z.line.removeCoordinate(""+Z.currentVertexPosition),Z.line.isValid()?this.map.fire(U.CREATE,{features:[Z.line.toGeoJSON()]}):(this.deleteFeature([Z.line.id],{silent:!0}),this.changeMode(j.SIMPLE_SELECT,{},{silent:!0})))},ll.onTrash=function(Z){this.deleteFeature([Z.line.id],{silent:!0}),this.changeMode(j.SIMPLE_SELECT)},ll.toDisplayFeatures=function(Z,fe,Ue){var wt=fe.properties.id===Z.line.id;if(fe.properties.active=wt?G.ACTIVE:G.INACTIVE,!wt)return Ue(fe);fe.geometry.coordinates.length<2||(fe.properties.meta=K.FEATURE,Ue(Lo(Z.line.id,fe.geometry.coordinates[Z.direction==="forward"?fe.geometry.coordinates.length-2:1],""+(Z.direction==="forward"?fe.geometry.coordinates.length-2:1),!1)),Ue(fe))};var cc={simple_select:yr,direct_select:gs,draw_point:za,draw_polygon:sl,draw_line_string:ll},ru={defaultMode:j.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:jn,modes:cc,controls:{},userProperties:!1},Ya={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},vs={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Xa(Z,fe){return Z.map(function(Ue){return Ue.source?Ue:ln(Ue,{id:Ue.id+"."+fe,source:fe==="hot"?F.HOT:F.COLD})})}var fa={exports:{}};(function(Z,fe){var Ue="__lodash_hash_undefined__",wt=9007199254740991,Bt="[object Arguments]",Vt="[object Array]",on="[object Boolean]",Kn="[object Date]",so="[object Error]",zn="[object Function]",yo="[object Map]",On="[object Number]",dr="[object Object]",uo="[object Promise]",hr="[object RegExp]",Ti="[object Set]",$n="[object String]",ko="[object Symbol]",oi="[object WeakMap]",yi="[object ArrayBuffer]",Hn="[object DataView]",fr=/^\[object .+?Constructor\]$/,br=/^(?:0|[1-9]\d*)$/,zr={};zr["[object Float32Array]"]=zr["[object Float64Array]"]=zr["[object Int8Array]"]=zr["[object Int16Array]"]=zr["[object Int32Array]"]=zr["[object Uint8Array]"]=zr["[object Uint8ClampedArray]"]=zr["[object Uint16Array]"]=zr["[object Uint32Array]"]=!0,zr[Bt]=zr[Vt]=zr[yi]=zr[on]=zr[Hn]=zr[Kn]=zr[so]=zr[zn]=zr[yo]=zr[On]=zr[dr]=zr[hr]=zr[Ti]=zr[$n]=zr[oi]=!1;var sa=typeof Ls=="object"&&Ls&&Ls.Object===Object&&Ls,xr=typeof self=="object"&&self&&self.Object===Object&&self,Ja=sa||xr||Function("return this")(),dc=fe&&!fe.nodeType&&fe,hc=dc&&Z&&!Z.nodeType&&Z,pa=hc&&hc.exports===dc,xi=pa&&sa.process,Fh=function(){try{return xi&&xi.binding&&xi.binding("util")}catch{}}(),fc=Fh&&Fh.isTypedArray;function au(an,Tn){for(var vo=-1,Jo=an==null?0:an.length;++vo<Jo;)if(Tn(an[vo],vo,an))return!0;return!1}function Us(an){var Tn=-1,vo=Array(an.size);return an.forEach(function(Jo,Si){vo[++Tn]=[Si,Jo]}),vo}function gd(an){var Tn=-1,vo=Array(an.size);return an.forEach(function(Jo){vo[++Tn]=Jo}),vo}var Ia,la,ma,ep=Array.prototype,Il=Function.prototype,Ci=Object.prototype,ca=Ja["__core-js_shared__"],Qa=Il.toString,_i=Ci.hasOwnProperty,vd=(Ia=/[^.]+$/.exec(ca&&ca.keys&&ca.keys.IE_PROTO||""))?"Symbol(src)_1."+Ia:"",es=Ci.toString,su=RegExp("^"+Qa.call(_i).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Al=pa?Ja.Buffer:void 0,js=Ja.Symbol,Fu=Ja.Uint8Array,Hs=Ci.propertyIsEnumerable,tg=ep.splice,kl=js?js.toStringTag:void 0,va=Object.getOwnPropertySymbols,ng=Al?Al.isBuffer:void 0,_d=(la=Object.keys,ma=Object,function(an){return la(ma(an))}),yd=Aa(Ja,"DataView"),Gs=Aa(Ja,"Map"),Pl=Aa(Ja,"Promise"),Bh=Aa(Ja,"Set"),pc=Aa(Ja,"WeakMap"),ys=Aa(Object,"create"),og=Ol(yd),lu=Ol(Gs),tp=Ol(Pl),bd=Ol(Bh),Fa=Ol(pc),ir=js?js.prototype:void 0,bo=ir?ir.valueOf:void 0;function cl(an){var Tn=-1,vo=an==null?0:an.length;for(this.clear();++Tn<vo;){var Jo=an[Tn];this.set(Jo[0],Jo[1])}}function Do(an){var Tn=-1,vo=an==null?0:an.length;for(this.clear();++Tn<vo;){var Jo=an[Tn];this.set(Jo[0],Jo[1])}}function ul(an){var Tn=-1,vo=an==null?0:an.length;for(this.clear();++Tn<vo;){var Jo=an[Tn];this.set(Jo[0],Jo[1])}}function Rl(an){var Tn=-1,vo=an==null?0:an.length;for(this.__data__=new ul;++Tn<vo;)this.add(an[Tn])}function Po(an){var Tn=this.__data__=new Do(an);this.size=Tn.size}function Nh(an,Tn){var vo=xc(an),Jo=!vo&&wd(an),Si=!vo&&!Jo&&cu(an),Lr=!vo&&!Jo&&!Si&&wc(an),Oi=vo||Jo||Si||Lr,Hi=Oi?function(Gi,bs){for(var Ba=-1,oa=Array(Gi);++Ba<Gi;)oa[Ba]=bs(Ba);return oa}(an.length,String):[],ts=Hi.length;for(var Zi in an)!_i.call(an,Zi)||Oi&&(Zi=="length"||Si&&(Zi=="offset"||Zi=="parent")||Lr&&(Zi=="buffer"||Zi=="byteLength"||Zi=="byteOffset")||Nn(Zi,ts))||Hi.push(Zi);return Hi}function mc(an,Tn){for(var vo=an.length;vo--;)if(bc(an[vo][0],Tn))return vo;return-1}function gc(an){return an==null?an===void 0?"[object Undefined]":"[object Null]":kl&&kl in Object(an)?function(Tn){var vo=_i.call(Tn,kl),Jo=Tn[kl];try{Tn[kl]=void 0;var Si=!0}catch{}var Lr=es.call(Tn);return Si&&(vo?Tn[kl]=Jo:delete Tn[kl]),Lr}(an):function(Tn){return es.call(Tn)}(an)}function dl(an){return Dl(an)&&gc(an)==Bt}function Ll(an,Tn,vo,Jo,Si){return an===Tn||(an==null||Tn==null||!Dl(an)&&!Dl(Tn)?an!=an&&Tn!=Tn:function(Lr,Oi,Hi,ts,Zi,Gi){var bs=xc(Lr),Ba=xc(Oi),oa=bs?Vt:Ws(Lr),Na=Ba?Vt:Ws(Oi),xs=(oa=oa==Bt?dr:oa)==dr,zl=(Na=Na==Bt?dr:Na)==dr,hl=oa==Na;if(hl&&cu(Lr)){if(!cu(Oi))return!1;bs=!0,xs=!1}if(hl&&!xs)return Gi||(Gi=new Po),bs||wc(Lr)?vc(Lr,Oi,Hi,ts,Zi,Gi):function(li,ri,Fl,$a,$r,Pa,Ks){switch(Fl){case Hn:if(li.byteLength!=ri.byteLength||li.byteOffset!=ri.byteOffset)return!1;li=li.buffer,ri=ri.buffer;case yi:return!(li.byteLength!=ri.byteLength||!Pa(new Fu(li),new Fu(ri)));case on:case Kn:case On:return bc(+li,+ri);case so:return li.name==ri.name&&li.message==ri.message;case hr:case $n:return li==ri+"";case yo:var Zs=Us;case Ti:var Bl=1&$a;if(Zs||(Zs=gd),li.size!=ri.size&&!Bl)return!1;var Nl=Ks.get(li);if(Nl)return Nl==ri;$a|=2,Ks.set(li,ri);var Sc=vc(Zs(li),Zs(ri),$a,$r,Pa,Ks);return Ks.delete(li),Sc;case ko:if(bo)return bo.call(li)==bo.call(ri)}return!1}(Lr,Oi,oa,Hi,ts,Zi,Gi);if(!(1&Hi)){var ns=xs&&_i.call(Lr,"__wrapped__"),fl=zl&&_i.call(Oi,"__wrapped__");if(ns||fl){var pr=ns?Lr.value():Lr,uu=fl?Oi.value():Oi;return Gi||(Gi=new Po),Zi(pr,uu,Hi,ts,Gi)}}return hl?(Gi||(Gi=new Po),function(li,ri,Fl,$a,$r,Pa){var Ks=1&Fl,Zs=_c(li),Bl=Zs.length,Nl=_c(ri).length;if(Bl!=Nl&&!Ks)return!1;for(var Sc=Bl;Sc--;){var $l=Zs[Sc];if(!(Ks?$l in ri:_i.call(ri,$l)))return!1}var $h=Pa.get(li);if($h&&Pa.get(ri))return $h==ri;var pl=!0;Pa.set(li,ri),Pa.set(ri,li);for(var Td=Ks;++Sc<Bl;){var Cd=li[$l=Zs[Sc]],Ed=ri[$l];if($a)var op=Ks?$a(Ed,Cd,$l,ri,li,Pa):$a(Cd,Ed,$l,li,ri,Pa);if(!(op===void 0?Cd===Ed||$r(Cd,Ed,Fl,$a,Pa):op)){pl=!1;break}Td||(Td=$l=="constructor")}if(pl&&!Td){var du=li.constructor,hu=ri.constructor;du==hu||!("constructor"in li)||!("constructor"in ri)||typeof du=="function"&&du instanceof du&&typeof hu=="function"&&hu instanceof hu||(pl=!1)}return Pa.delete(li),Pa.delete(ri),pl}(Lr,Oi,Hi,ts,Zi,Gi)):!1}(an,Tn,vo,Jo,Ll,Si))}function ua(an){return!(!ka(an)||function(Tn){return!!vd&&vd in Tn}(an))&&(qs(an)?su:fr).test(Ol(an))}function xd(an){if(vo=(Tn=an)&&Tn.constructor,Jo=typeof vo=="function"&&vo.prototype||Ci,Tn!==Jo)return _d(an);var Tn,vo,Jo,Si=[];for(var Lr in Object(an))_i.call(an,Lr)&&Lr!="constructor"&&Si.push(Lr);return Si}function vc(an,Tn,vo,Jo,Si,Lr){var Oi=1&vo,Hi=an.length,ts=Tn.length;if(Hi!=ts&&!(Oi&&ts>Hi))return!1;var Zi=Lr.get(an);if(Zi&&Lr.get(Tn))return Zi==Tn;var Gi=-1,bs=!0,Ba=2&vo?new Rl:void 0;for(Lr.set(an,Tn),Lr.set(Tn,an);++Gi<Hi;){var oa=an[Gi],Na=Tn[Gi];if(Jo)var xs=Oi?Jo(Na,oa,Gi,Tn,an,Lr):Jo(oa,Na,Gi,an,Tn,Lr);if(xs!==void 0){if(xs)continue;bs=!1;break}if(Ba){if(!au(Tn,function(zl,hl){if(ns=hl,!Ba.has(ns)&&(oa===zl||Si(oa,zl,vo,Jo,Lr)))return Ba.push(hl);var ns})){bs=!1;break}}else if(oa!==Na&&!Si(oa,Na,vo,Jo,Lr)){bs=!1;break}}return Lr.delete(an),Lr.delete(Tn),bs}function _c(an){return function(Tn,vo,Jo){var Si=vo(Tn);return xc(Tn)?Si:function(Lr,Oi){for(var Hi=-1,ts=Oi.length,Zi=Lr.length;++Hi<ts;)Lr[Zi+Hi]=Oi[Hi];return Lr}(Si,Jo(Tn))}(an,np,wi)}function yc(an,Tn){var vo,Jo,Si=an.__data__;return((Jo=typeof(vo=Tn))=="string"||Jo=="number"||Jo=="symbol"||Jo=="boolean"?vo!=="__proto__":vo===null)?Si[typeof Tn=="string"?"string":"hash"]:Si.map}function Aa(an,Tn){var vo=function(Jo,Si){return Jo==null?void 0:Jo[Si]}(an,Tn);return ua(vo)?vo:void 0}cl.prototype.clear=function(){this.__data__=ys?ys(null):{},this.size=0},cl.prototype.delete=function(an){var Tn=this.has(an)&&delete this.__data__[an];return this.size-=Tn?1:0,Tn},cl.prototype.get=function(an){var Tn=this.__data__;if(ys){var vo=Tn[an];return vo===Ue?void 0:vo}return _i.call(Tn,an)?Tn[an]:void 0},cl.prototype.has=function(an){var Tn=this.__data__;return ys?Tn[an]!==void 0:_i.call(Tn,an)},cl.prototype.set=function(an,Tn){var vo=this.__data__;return this.size+=this.has(an)?0:1,vo[an]=ys&&Tn===void 0?Ue:Tn,this},Do.prototype.clear=function(){this.__data__=[],this.size=0},Do.prototype.delete=function(an){var Tn=this.__data__,vo=mc(Tn,an);return!(vo<0)&&(vo==Tn.length-1?Tn.pop():tg.call(Tn,vo,1),--this.size,!0)},Do.prototype.get=function(an){var Tn=this.__data__,vo=mc(Tn,an);return vo<0?void 0:Tn[vo][1]},Do.prototype.has=function(an){return mc(this.__data__,an)>-1},Do.prototype.set=function(an,Tn){var vo=this.__data__,Jo=mc(vo,an);return Jo<0?(++this.size,vo.push([an,Tn])):vo[Jo][1]=Tn,this},ul.prototype.clear=function(){this.size=0,this.__data__={hash:new cl,map:new(Gs||Do),string:new cl}},ul.prototype.delete=function(an){var Tn=yc(this,an).delete(an);return this.size-=Tn?1:0,Tn},ul.prototype.get=function(an){return yc(this,an).get(an)},ul.prototype.has=function(an){return yc(this,an).has(an)},ul.prototype.set=function(an,Tn){var vo=yc(this,an),Jo=vo.size;return vo.set(an,Tn),this.size+=vo.size==Jo?0:1,this},Rl.prototype.add=Rl.prototype.push=function(an){return this.__data__.set(an,Ue),this},Rl.prototype.has=function(an){return this.__data__.has(an)},Po.prototype.clear=function(){this.__data__=new Do,this.size=0},Po.prototype.delete=function(an){var Tn=this.__data__,vo=Tn.delete(an);return this.size=Tn.size,vo},Po.prototype.get=function(an){return this.__data__.get(an)},Po.prototype.has=function(an){return this.__data__.has(an)},Po.prototype.set=function(an,Tn){var vo=this.__data__;if(vo instanceof Do){var Jo=vo.__data__;if(!Gs||Jo.length<199)return Jo.push([an,Tn]),this.size=++vo.size,this;vo=this.__data__=new ul(Jo)}return vo.set(an,Tn),this.size=vo.size,this};var wi=va?function(an){return an==null?[]:(an=Object(an),function(Tn,vo){for(var Jo=-1,Si=Tn==null?0:Tn.length,Lr=0,Oi=[];++Jo<Si;){var Hi=Tn[Jo];vo(Hi,Jo,Tn)&&(Oi[Lr++]=Hi)}return Oi}(va(an),function(Tn){return Hs.call(an,Tn)}))}:function(){return[]},Ws=gc;function Nn(an,Tn){return!!(Tn=Tn??wt)&&(typeof an=="number"||br.test(an))&&an>-1&&an%1==0&&an<Tn}function Ol(an){if(an!=null){try{return Qa.call(an)}catch{}try{return an+""}catch{}}return""}function bc(an,Tn){return an===Tn||an!=an&&Tn!=Tn}(yd&&Ws(new yd(new ArrayBuffer(1)))!=Hn||Gs&&Ws(new Gs)!=yo||Pl&&Ws(Pl.resolve())!=uo||Bh&&Ws(new Bh)!=Ti||pc&&Ws(new pc)!=oi)&&(Ws=function(an){var Tn=gc(an),vo=Tn==dr?an.constructor:void 0,Jo=vo?Ol(vo):"";if(Jo)switch(Jo){case og:return Hn;case lu:return yo;case tp:return uo;case bd:return Ti;case Fa:return oi}return Tn});var wd=dl(function(){return arguments}())?dl:function(an){return Dl(an)&&_i.call(an,"callee")&&!Hs.call(an,"callee")},xc=Array.isArray,cu=ng||function(){return!1};function qs(an){if(!ka(an))return!1;var Tn=gc(an);return Tn==zn||Tn=="[object GeneratorFunction]"||Tn=="[object AsyncFunction]"||Tn=="[object Proxy]"}function Sd(an){return typeof an=="number"&&an>-1&&an%1==0&&an<=wt}function ka(an){var Tn=typeof an;return an!=null&&(Tn=="object"||Tn=="function")}function Dl(an){return an!=null&&typeof an=="object"}var wc=fc?function(an){return function(Tn){return an(Tn)}}(fc):function(an){return Dl(an)&&Sd(an.length)&&!!zr[gc(an)]};function np(an){return(Tn=an)!=null&&Sd(Tn.length)&&!qs(Tn)?Nh(an):xd(an);var Tn}Z.exports=function(an,Tn){return Ll(an,Tn)}})(fa,fa.exports);var _s=s(fa.exports);function iu(Z,fe){return Z.length===fe.length&&JSON.stringify(Z.map(function(Ue){return Ue}).sort())===JSON.stringify(fe.map(function(Ue){return Ue}).sort())}var Dh={Polygon:zt,LineString:Mt,Point:Ct,MultiPolygon:$t,MultiLineString:$t,MultiPoint:$t},zh=Object.freeze({__proto__:null,CommonSelectors:ft,constrainFeatureMovement:$o,createMidPoint:Rr,createSupplementaryPoints:hi,createVertex:Lo,doubleClickZoom:Er,euclideanDistance:Ae,featuresAt:Je,getFeatureAtAndSetCursors:xe,isClick:Ce,isEventAtCoordinates:lc,isTap:ve,mapEventToBoundingBox:pe,ModeHandler:i,moveFeatures:Ar,sortFeatures:ce,stringSetsAreEqual:iu,StringSet:ge,theme:jn,toDenseArray:Be}),Vs=function(Z,fe){var Ue={options:Z=function(Bt){Bt===void 0&&(Bt={});var Vt=ln(Bt);return Bt.controls||(Vt.controls={}),Bt.displayControlsDefault===!1?Vt.controls=ln(vs,Bt.controls):Vt.controls=ln(Ya,Bt.controls),(Vt=ln(ru,Vt)).styles=Xa(Vt.styles,"cold").concat(Xa(Vt.styles,"hot")),Vt}(Z)};fe=function(Bt,Vt){return Vt.modes=j,Vt.getFeatureIdsAt=function(on){return Je.click({point:on},null,Bt).map(function(Kn){return Kn.properties.id})},Vt.getSelectedIds=function(){return Bt.store.getSelectedIds()},Vt.getSelected=function(){return{type:D.FEATURE_COLLECTION,features:Bt.store.getSelectedIds().map(function(on){return Bt.store.get(on)}).map(function(on){return on.toGeoJSON()})}},Vt.getSelectedPoints=function(){return{type:D.FEATURE_COLLECTION,features:Bt.store.getSelectedCoordinates().map(function(on){return{type:D.FEATURE,properties:{},geometry:{type:D.POINT,coordinates:on.coordinates}}})}},Vt.set=function(on){if(on.type===void 0||on.type!==D.FEATURE_COLLECTION||!Array.isArray(on.features))throw new Error("Invalid FeatureCollection");var Kn=Bt.store.createRenderBatch(),so=Bt.store.getAllIds().slice(),zn=Vt.add(on),yo=new ge(zn);return(so=so.filter(function(On){return!yo.has(On)})).length&&Vt.delete(so),Kn(),zn},Vt.add=function(on){var Kn=JSON.parse(JSON.stringify($s(on))).features.map(function(so){if(so.id=so.id||ot(),so.geometry===null)throw new Error("Invalid geometry: null");if(Bt.store.get(so.id)===void 0||Bt.store.get(so.id).type!==so.geometry.type){var zn=Dh[so.geometry.type];if(zn===void 0)throw new Error("Invalid geometry type: "+so.geometry.type+".");var yo=new zn(Bt,so);Bt.store.add(yo)}else{var On=Bt.store.get(so.id);On.properties=so.properties,_s(On.properties,so.properties)||Bt.store.featureChanged(On.id),_s(On.getCoordinates(),so.geometry.coordinates)||On.incomingCoords(so.geometry.coordinates)}return so.id});return Bt.store.render(),Kn},Vt.get=function(on){var Kn=Bt.store.get(on);if(Kn)return Kn.toGeoJSON()},Vt.getAll=function(){return{type:D.FEATURE_COLLECTION,features:Bt.store.getAll().map(function(on){return on.toGeoJSON()})}},Vt.delete=function(on){return Bt.store.delete(on,{silent:!0}),Vt.getMode()!==j.DIRECT_SELECT||Bt.store.getSelectedIds().length?Bt.store.render():Bt.events.changeMode(j.SIMPLE_SELECT,void 0,{silent:!0}),Vt},Vt.deleteAll=function(){return Bt.store.delete(Bt.store.getAllIds(),{silent:!0}),Vt.getMode()===j.DIRECT_SELECT?Bt.events.changeMode(j.SIMPLE_SELECT,void 0,{silent:!0}):Bt.store.render(),Vt},Vt.changeMode=function(on,Kn){return Kn===void 0&&(Kn={}),on===j.SIMPLE_SELECT&&Vt.getMode()===j.SIMPLE_SELECT?(iu(Kn.featureIds||[],Bt.store.getSelectedIds())||(Bt.store.setSelected(Kn.featureIds,{silent:!0}),Bt.store.render()),Vt):(on===j.DIRECT_SELECT&&Vt.getMode()===j.DIRECT_SELECT&&Kn.featureId===Bt.store.getSelectedIds()[0]||Bt.events.changeMode(on,Kn,{silent:!0}),Vt)},Vt.getMode=function(){return Bt.events.getMode()},Vt.trash=function(){return Bt.events.trash({silent:!0}),Vt},Vt.combineFeatures=function(){return Bt.events.combineFeatures({silent:!0}),Vt},Vt.uncombineFeatures=function(){return Bt.events.uncombineFeatures({silent:!0}),Vt},Vt.setFeatureProperty=function(on,Kn,so){return Bt.store.setFeatureProperty(on,Kn,so),Vt},Vt}(Ue,fe),Ue.api=fe;var wt=_n(Ue);return fe.onAdd=wt.onAdd,fe.onRemove=wt.onRemove,fe.types=N,fe.options=Z,fe};function uc(Z){Vs(Z,this)}return uc.modes=cc,uc.constants=se,uc.lib=zh,uc})})(cL);var b$=cL.exports;const x$=eu(b$);var FA=63710088e-1;function w$(e,t,i={}){const s={type:"Feature"};return(i.id===0||i.id)&&(s.id=i.id),i.bbox&&(s.bbox=i.bbox),s.properties={},s.geometry=e,s}function BA(e,t,i={}){for(const d of e){if(d.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(d[d.length-1].length!==d[0].length)throw new Error("First and last Position are not equivalent.");for(let p=0;p<d[d.length-1].length;p++)if(d[d.length-1][p]!==d[0][p])throw new Error("First and last Position are not equivalent.")}return w$({type:"Polygon",coordinates:e},t,i)}function uL(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function S$(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function v2(e){return e.type==="Feature"?e.geometry:e}function dL(e,t,i){if(e!==null)for(var s,d,p,_,o,w,C,M=0,I=0,F,B=e.type,N=B==="FeatureCollection",D=B==="Feature",j=N?e.features.length:1,U=0;U<j;U++){C=N?e.features[U].geometry:D?e.geometry:e,F=C?C.type==="GeometryCollection":!1,o=F?C.geometries.length:1;for(var ne=0;ne<o;ne++){var K=0,G=0;if(_=F?C.geometries[ne]:C,_!==null){w=_.coordinates;var J=_.type;switch(M=0,J){case null:break;case"Point":if(t(w,I,U,K,G)===!1)return!1;I++,K++;break;case"LineString":case"MultiPoint":for(s=0;s<w.length;s++){if(t(w[s],I,U,K,G)===!1)return!1;I++,J==="MultiPoint"&&K++}J==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(s=0;s<w.length;s++){for(d=0;d<w[s].length-M;d++){if(t(w[s][d],I,U,K,G)===!1)return!1;I++}J==="MultiLineString"&&K++,J==="Polygon"&&G++}J==="Polygon"&&K++;break;case"MultiPolygon":for(s=0;s<w.length;s++){for(G=0,d=0;d<w[s].length;d++){for(p=0;p<w[s][d].length-M;p++){if(t(w[s][d][p],I,U,K,G)===!1)return!1;I++}G++}K++}break;case"GeometryCollection":for(s=0;s<_.geometries.length;s++)if(dL(_.geometries[s],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function T$(e,t){var i,s,d,p,_,o,w,C,M,I,F=0,B=e.type==="FeatureCollection",N=e.type==="Feature",D=B?e.features.length:1;for(i=0;i<D;i++){for(o=B?e.features[i].geometry:N?e.geometry:e,C=B?e.features[i].properties:N?e.properties:{},M=B?e.features[i].bbox:N?e.bbox:void 0,I=B?e.features[i].id:N?e.id:void 0,w=o?o.type==="GeometryCollection":!1,_=w?o.geometries.length:1,d=0;d<_;d++){if(p=w?o.geometries[d]:o,p===null){if(t(null,F,C,M,I)===!1)return!1;continue}switch(p.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(p,F,C,M,I)===!1)return!1;break}case"GeometryCollection":{for(s=0;s<p.geometries.length;s++)if(t(p.geometries[s],F,C,M,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}F++}}function C$(e,t,i){var s=i;return T$(e,function(d,p,_,o,w){p===0&&i===void 0?s=d:s=t(s,d,p,_,o,w)}),s}function NA(e){return C$(e,(t,i)=>t+E$(i),0)}function E$(e){let t=0,i;switch(e.type){case"Polygon":return $A(e.coordinates);case"MultiPolygon":for(i=0;i<e.coordinates.length;i++)t+=$A(e.coordinates[i]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function $A(e){let t=0;if(e&&e.length>0){t+=Math.abs(VA(e[0]));for(let i=1;i<e.length;i++)t-=Math.abs(VA(e[i]))}return t}var M$=FA*FA/2,Ew=Math.PI/180;function VA(e){const t=e.length-1;if(t<=2)return 0;let i=0,s=0;for(;s<t;){const d=e[s],p=e[s+1===t?0:s+1],_=e[s+2>=t?(s+2)%t:s+2],o=d[0]*Ew,w=p[1]*Ew,C=_[0]*Ew;i+=(C-o)*Math.sin(w),s++}return i*M$}function Sb(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const i=[1/0,1/0,-1/0,-1/0];return dL(e,s=>{i[0]>s[0]&&(i[0]=s[0]),i[1]>s[1]&&(i[1]=s[1]),i[2]<s[0]&&(i[2]=s[0]),i[3]<s[1]&&(i[3]=s[1])}),i}const rd=11102230246251565e-32,ss=134217729,I$=(3+8*rd)*rd;function Mw(e,t,i,s,d){let p,_,o,w,C=t[0],M=s[0],I=0,F=0;M>C==M>-C?(p=C,C=t[++I]):(p=M,M=s[++F]);let B=0;if(I<e&&F<i)for(M>C==M>-C?(_=C+p,o=p-(_-C),C=t[++I]):(_=M+p,o=p-(_-M),M=s[++F]),p=_,o!==0&&(d[B++]=o);I<e&&F<i;)M>C==M>-C?(_=p+C,w=_-p,o=p-(_-w)+(C-w),C=t[++I]):(_=p+M,w=_-p,o=p-(_-w)+(M-w),M=s[++F]),p=_,o!==0&&(d[B++]=o);for(;I<e;)_=p+C,w=_-p,o=p-(_-w)+(C-w),C=t[++I],p=_,o!==0&&(d[B++]=o);for(;F<i;)_=p+M,w=_-p,o=p-(_-w)+(M-w),M=s[++F],p=_,o!==0&&(d[B++]=o);return(p!==0||B===0)&&(d[B++]=p),B}function A$(e,t){let i=t[0];for(let s=1;s<e;s++)i+=t[s];return i}function z_(e){return new Float64Array(e)}const k$=(3+16*rd)*rd,P$=(2+12*rd)*rd,R$=(9+64*rd)*rd*rd,Kp=z_(4),UA=z_(8),jA=z_(12),HA=z_(16),Ms=z_(4);function L$(e,t,i,s,d,p,_){let o,w,C,M,I,F,B,N,D,j,U,ne,K,G,J,oe,se,me;const de=e-d,ce=i-d,pe=t-p,ge=s-p;G=de*ge,F=ss*de,B=F-(F-de),N=de-B,F=ss*ge,D=F-(F-ge),j=ge-D,J=N*j-(G-B*D-N*D-B*j),oe=pe*ce,F=ss*pe,B=F-(F-pe),N=pe-B,F=ss*ce,D=F-(F-ce),j=ce-D,se=N*j-(oe-B*D-N*D-B*j),U=J-se,I=J-U,Kp[0]=J-(U+I)+(I-se),ne=G+U,I=ne-G,K=G-(ne-I)+(U-I),U=K-oe,I=K-U,Kp[1]=K-(U+I)+(I-oe),me=ne+U,I=me-ne,Kp[2]=ne-(me-I)+(U-I),Kp[3]=me;let Re=A$(4,Kp),Je=P$*_;if(Re>=Je||-Re>=Je||(I=e-de,o=e-(de+I)+(I-d),I=i-ce,C=i-(ce+I)+(I-d),I=t-pe,w=t-(pe+I)+(I-p),I=s-ge,M=s-(ge+I)+(I-p),o===0&&w===0&&C===0&&M===0)||(Je=R$*_+I$*Math.abs(Re),Re+=de*M+ge*o-(pe*C+ce*w),Re>=Je||-Re>=Je))return Re;G=o*ge,F=ss*o,B=F-(F-o),N=o-B,F=ss*ge,D=F-(F-ge),j=ge-D,J=N*j-(G-B*D-N*D-B*j),oe=w*ce,F=ss*w,B=F-(F-w),N=w-B,F=ss*ce,D=F-(F-ce),j=ce-D,se=N*j-(oe-B*D-N*D-B*j),U=J-se,I=J-U,Ms[0]=J-(U+I)+(I-se),ne=G+U,I=ne-G,K=G-(ne-I)+(U-I),U=K-oe,I=K-U,Ms[1]=K-(U+I)+(I-oe),me=ne+U,I=me-ne,Ms[2]=ne-(me-I)+(U-I),Ms[3]=me;const Me=Mw(4,Kp,4,Ms,UA);G=de*M,F=ss*de,B=F-(F-de),N=de-B,F=ss*M,D=F-(F-M),j=M-D,J=N*j-(G-B*D-N*D-B*j),oe=pe*C,F=ss*pe,B=F-(F-pe),N=pe-B,F=ss*C,D=F-(F-C),j=C-D,se=N*j-(oe-B*D-N*D-B*j),U=J-se,I=J-U,Ms[0]=J-(U+I)+(I-se),ne=G+U,I=ne-G,K=G-(ne-I)+(U-I),U=K-oe,I=K-U,Ms[1]=K-(U+I)+(I-oe),me=ne+U,I=me-ne,Ms[2]=ne-(me-I)+(U-I),Ms[3]=me;const xe=Mw(Me,UA,4,Ms,jA);G=o*M,F=ss*o,B=F-(F-o),N=o-B,F=ss*M,D=F-(F-M),j=M-D,J=N*j-(G-B*D-N*D-B*j),oe=w*C,F=ss*w,B=F-(F-w),N=w-B,F=ss*C,D=F-(F-C),j=C-D,se=N*j-(oe-B*D-N*D-B*j),U=J-se,I=J-U,Ms[0]=J-(U+I)+(I-se),ne=G+U,I=ne-G,K=G-(ne-I)+(U-I),U=K-oe,I=K-U,Ms[1]=K-(U+I)+(I-oe),me=ne+U,I=me-ne,Ms[2]=ne-(me-I)+(U-I),Ms[3]=me;const Ae=Mw(xe,jA,4,Ms,HA);return HA[Ae-1]}function O$(e,t,i,s,d,p){const _=(t-p)*(i-d),o=(e-d)*(s-p),w=_-o,C=Math.abs(_+o);return Math.abs(w)>=k$*C?w:-L$(e,t,i,s,d,p,C)}function D$(e,t){var i,s,d=0,p,_,o,w,C,M,I,F=e[0],B=e[1],N=t.length;for(i=0;i<N;i++){s=0;var D=t[i],j=D.length-1;if(M=D[0],M[0]!==D[j][0]&&M[1]!==D[j][1])throw new Error("First and last coordinates in a ring must be the same");for(_=M[0]-F,o=M[1]-B,s;s<j;s++){if(I=D[s+1],w=I[0]-F,C=I[1]-B,o===0&&C===0){if(w<=0&&_>=0||_<=0&&w>=0)return 0}else if(C>=0&&o<0||C<0&&o>=0){if(p=O$(_,w,o,C,0,0),p===0)return 0;(p>0&&C>0&&o<=0||p<0&&C<=0&&o>0)&&d++}M=I,o=C,_=w}}return d%2!==0}function Df(e,t,i={}){if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");const s=uL(e),d=v2(t),p=d.type,_=t.bbox;let o=d.coordinates;if(_&&z$(s,_)===!1)return!1;p==="Polygon"&&(o=[o]);let w=!1;for(var C=0;C<o.length;++C){const M=D$(s,o[C]);if(M===0)return!i.ignoreBoundary;M&&(w=!0)}return w}function z$(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function Tb(e,t,i={}){const s=uL(e),d=S$(t);for(let p=0;p<d.length-1;p++){let _=!1;if(i.ignoreEndVertices&&(p===0&&(_="start"),p===d.length-2&&(_="end"),p===0&&p+1===d.length-1&&(_="both")),F$(d[p],d[p+1],s,_,typeof i.epsilon>"u"?null:i.epsilon))return!0}return!1}function F$(e,t,i,s,d){const p=i[0],_=i[1],o=e[0],w=e[1],C=t[0],M=t[1],I=i[0]-o,F=i[1]-w,B=C-o,N=M-w,D=I*N-F*B;if(d!==null){if(Math.abs(D)>d)return!1}else if(D!==0)return!1;if(s){if(s==="start")return Math.abs(B)>=Math.abs(N)?B>0?o<p&&p<=C:C<=p&&p<o:N>0?w<_&&_<=M:M<=_&&_<w;if(s==="end")return Math.abs(B)>=Math.abs(N)?B>0?o<=p&&p<C:C<p&&p<=o:N>0?w<=_&&_<M:M<_&&_<=w;if(s==="both")return Math.abs(B)>=Math.abs(N)?B>0?o<p&&p<C:C<p&&p<o:N>0?w<_&&_<M:M<_&&_<w}else return Math.abs(B)>=Math.abs(N)?B>0?o<=p&&p<=C:C<=p&&p<=o:N>0?w<=_&&_<=M:M<=_&&_<=w;return!1}function B$(e,t){var i=v2(e),s=v2(t),d=i.type,p=s.type;switch(d){case"Point":switch(p){case"MultiPoint":return N$(i,s);case"LineString":return Tb(i,s,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return Df(i,s,{ignoreBoundary:!0});default:throw new Error("feature2 "+p+" geometry not supported")}case"MultiPoint":switch(p){case"MultiPoint":return $$(i,s);case"LineString":return V$(i,s);case"Polygon":case"MultiPolygon":return U$(i,s);default:throw new Error("feature2 "+p+" geometry not supported")}case"LineString":switch(p){case"LineString":return j$(i,s);case"Polygon":case"MultiPolygon":return H$(i,s);default:throw new Error("feature2 "+p+" geometry not supported")}case"Polygon":switch(p){case"Polygon":case"MultiPolygon":return G$(i,s);default:throw new Error("feature2 "+p+" geometry not supported")}default:throw new Error("feature1 "+d+" geometry not supported")}}function N$(e,t){var i,s=!1;for(i=0;i<t.coordinates.length;i++)if(fL(t.coordinates[i],e.coordinates)){s=!0;break}return s}function $$(e,t){for(var i=0;i<e.coordinates.length;i++){for(var s=!1,d=0;d<t.coordinates.length;d++)fL(e.coordinates[i],t.coordinates[d])&&(s=!0);if(!s)return!1}return!0}function V$(e,t){for(var i=!1,s=0;s<e.coordinates.length;s++){if(!Tb(e.coordinates[s],t))return!1;i||(i=Tb(e.coordinates[s],t,{ignoreEndVertices:!0}))}return i}function U$(e,t){for(var i=!0,s=!1,d=0;d<e.coordinates.length;d++){if(s=Df(e.coordinates[d],t),!s){i=!1;break}s=Df(e.coordinates[d],t,{ignoreBoundary:!0})}return i&&s}function j$(e,t){for(var i=0;i<e.coordinates.length;i++)if(!Tb(e.coordinates[i],t))return!1;return!0}function H$(e,t){var i=Sb(t),s=Sb(e);if(!hL(i,s))return!1;for(var d=!1,p=0;p<e.coordinates.length;p++){if(!Df(e.coordinates[p],t))return!1;if(d||(d=Df(e.coordinates[p],t,{ignoreBoundary:!0})),!d&&p<e.coordinates.length-1){var _=W$(e.coordinates[p],e.coordinates[p+1]);d=Df(_,t,{ignoreBoundary:!0})}}return d}function G$(e,t){var i=Sb(e),s=Sb(t);if(!hL(s,i))return!1;for(var d=0;d<e.coordinates[0].length;d++)if(!Df(e.coordinates[0][d],t))return!1;return!0}function hL(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function fL(e,t){return e[0]===t[0]&&e[1]===t[1]}function W$(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}const Uc=Ir({meanHeight:0,stdDeviation:0,totalBuildingArea:0,buildingDensity:0,buildingCountDensity:0}),pL=(e,t)=>{const i=e.__vccOpts||e;for(const[s,d]of t)i[s]=d;return i},q$={class:"control-panel"},K$={key:0,class:"timeline-container"},Z$={__name:"myMap",setup(e){Cw.accessToken="pk.eyJ1IjoibHZ1c2xmY29vIiwiYSI6ImNsbzJ0Zjd2ejBiN3AydmxlN25pa3E5c3cifQ.qNGUVfyvKHJZqfKlaH_5XQ";const t=we(null),i=we(!0),s=we(null),d=we(!1),p=we([]),_=we(null),o=we(0),w=we(0),C=we({}),M=we(!1);No(()=>{t.value=new Cw.Map({container:"mapContainer",style:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://khms0.google.com/kh/v=988?x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles"}]},center:[121.544,31.221],zoom:14,pitch:60,bearing:130});const D=new x$({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}});t.value.addControl(D),t.value.on("load",()=>{console.log("Map loaded.")}),s.value=new Cw.Popup({closeButton:!0,closeOnClick:!0}),t.value.on("draw.modechange",j=>{d.value=j.mode==="draw_polygon"}),t.value.on("draw.create",j=>{const U=j.features[0],K=t.value.querySourceFeatures("geojson-source").filter(ge=>{const Re=BA(ge.geometry.coordinates);return B$(Re,U)}),G=K.map(ge=>ge.properties.Height||0),J=G.length>0?G.reduce((ge,Re)=>ge+Re,0)/G.length:0,oe=G.length>0?G.reduce((ge,Re)=>ge+Math.pow(Re-J,2),0)/G.length:0,se=Math.sqrt(oe),me=K.reduce((ge,Re)=>{const Je=BA(Re.geometry.coordinates);return ge+NA(Je)},0),de=NA(U),ce=me/de,pe=K.length/de*1e6;console.log(":",J),console.log(":",se),console.log(":",me,""),console.log(":",de,""),console.log(":",ce,"/"),console.log(":",pe.toFixed(2),"/"),Uc.meanHeight=J,Uc.stdDeviation=se,Uc.totalBuildingArea=me,Uc.polygonArea=de,Uc.buildingDensity=ce,Uc.buildingCountDensity=pe}),t.value.on("draw.update",j=>{console.log("Updated:",j.features)}),t.value.on("draw.delete",j=>{console.log("Deleted:",j.features)})});const I=async D=>{const j=D.target.files;if(j.length===1){M.value=!1;const ne=JSON.parse(await j[0].text());B(ne);return}p.value=[];const U=new Set;for(const ne of j)if(ne)try{if(!ne.name.endsWith(".json")){console.error(` ${ne.name}  JSON `);continue}const K=await ne.text(),G=/(\d{4})/,J=ne.name.match(G),oe=J?J[1]:"unknown",se=JSON.parse(K);p.value.push({year:oe,data:se}),oe!=="unknown"&&(U.add(oe),o.value=Math.min(o.value||oe,parseInt(oe)),w.value=Math.max(w.value||oe,parseInt(oe)))}catch(K){console.error(` ${ne.name}:`,K)}C.value=Array.from(U).reduce((ne,K)=>(ne[K]=K,ne),{}),_.value=o.value,M.value=!0,F()},F=()=>{if(typeof _.value=="number"){const D=p.value.find(j=>j.year===_.value.toString());D&&B(D.data)}},B=D=>{t.value.getLayer("3d-buildings")&&t.value.removeLayer("3d-buildings"),t.value.getSource("geojson-source")&&t.value.removeSource("geojson-source"),t.value.addSource("geojson-source",{type:"geojson",data:D}),t.value.addLayer({id:"3d-buildings",source:"geojson-source",type:"fill-extrusion",paint:{"fill-extrusion-color":["interpolate",["linear"],["*",["get","Height"],5],0,"rgb(255, 235, 238)",30,"rgb(255, 193, 193)",60,"rgb(244, 67, 54)",100,"rgb(183, 28, 28)"],"fill-extrusion-height":["*",1,["get","Height"]],"fill-extrusion-opacity":.9}}),t.value.on("click","3d-buildings",j=>{if(d.value)return;const U=j.features;if(U.length>0){const ne=U[0].properties,K=j.lngLat;ne.Height,s.value.setLngLat(K).setHTML(`<div><strong></strong><pre>${JSON.stringify(ne,null,2)}</pre></div>`).addTo(t.value)}}),t.value.on("mouseenter","3d-buildings",()=>{t.value.getCanvas().style.cursor="pointer"}),t.value.on("mouseleave","3d-buildings",()=>{t.value.getCanvas().style.cursor=""})},N=()=>{i.value=!i.value;const D=i.value?"visible":"none";t.value.setLayoutProperty("3d-buildings","visibility",D)};return(D,j)=>{const U=Go("el-slider");return le(),Pe("div",null,[j[1]||(j[1]=Ve("div",{id:"mapContainer",class:"map-container"},null,-1)),Ve("div",q$,[Ve("input",{type:"file",accept:".json,.geojson",onChange:I,class:"file-input",multiple:""},null,32),Ve("button",{class:"toggle-button",onClick:N},yn(i.value?"":""),1)]),M.value?(le(),Pe("div",K$,[Qe(U,{modelValue:_.value,"onUpdate:modelValue":j[0]||(j[0]=ne=>_.value=ne),min:o.value,max:w.value,step:5,marks:C.value,onChange:F},null,8,["modelValue","min","max","marks"])])):St("",!0)])}}},Y$=pL(Z$,[["__scopeId","data-v-ae5fc986"]]),X$={class:"container"},J$={class:"map-container"},Q$={class:"sidebar"},eV={__name:"App",setup(e){return(t,i)=>(le(),Pe("div",X$,[Ve("div",J$,[Qe(Y$)]),Ve("div",Q$,[i[5]||(i[5]=Ve("h2",null,"",-1)),Ve("ul",null,[Ve("li",null,[i[0]||(i[0]=Ve("strong",null,"",-1)),Qo(yn(y(Uc).meanHeight.toFixed(2))+"  ",1)]),Ve("li",null,[i[1]||(i[1]=Ve("strong",null,"",-1)),Qo(yn(y(Uc).stdDeviation.toFixed(2))+"  ",1)]),Ve("li",null,[i[2]||(i[2]=Ve("strong",null,"",-1)),Qo(yn(y(Uc).totalBuildingArea.toFixed(2))+"  ",1)]),Ve("li",null,[i[3]||(i[3]=Ve("strong",null,"",-1)),Qo(yn(y(Uc).buildingDensity.toFixed(2)),1)]),Ve("li",null,[i[4]||(i[4]=Ve("strong",null,"",-1)),Qo(yn(y(Uc).buildingCountDensity.toFixed(2))+" / ",1)])])])]))}},tV=pL(eV,[["__scopeId","data-v-4950f03d"]]),nV="2.9.0",GA=Symbol("INSTALLED_KEY"),mL=Symbol(),Yv="el",oV="is-",wf=(e,t,i,s,d)=>{let p=`${e}-${t}`;return i&&(p+=`-${i}`),s&&(p+=`__${s}`),d&&(p+=`--${d}`),p},gL=Symbol("namespaceContextKey"),YS=e=>{const t=e||(jo()?Un(gL,we(Yv)):we(Yv));return te(()=>y(t)||Yv)},rn=(e,t)=>{const i=YS(t);return{namespace:i,b:(D="")=>wf(i.value,e,D,"",""),e:D=>D?wf(i.value,e,"",D,""):"",m:D=>D?wf(i.value,e,"","",D):"",be:(D,j)=>D&&j?wf(i.value,e,D,j,""):"",em:(D,j)=>D&&j?wf(i.value,e,"",D,j):"",bm:(D,j)=>D&&j?wf(i.value,e,D,"",j):"",bem:(D,j,U)=>D&&j&&U?wf(i.value,e,D,j,U):"",is:(D,...j)=>{const U=j.length>=1?j[0]:!0;return D&&U?`${oV}${D}`:""},cssVar:D=>{const j={};for(const U in D)D[U]&&(j[`--${i.value}-${U}`]=D[U]);return j},cssVarName:D=>`--${i.value}-${D}`,cssVarBlock:D=>{const j={};for(const U in D)D[U]&&(j[`--${i.value}-${e}-${U}`]=D[U]);return j},cssVarBlockName:D=>`--${i.value}-${e}-${D}`}};var vL=typeof global=="object"&&global&&global.Object===Object&&global,rV=typeof self=="object"&&self&&self.Object===Object&&self,tu=vL||rV||Function("return this")(),oc=tu.Symbol,_L=Object.prototype,iV=_L.hasOwnProperty,aV=_L.toString,Ov=oc?oc.toStringTag:void 0;function sV(e){var t=iV.call(e,Ov),i=e[Ov];try{e[Ov]=void 0;var s=!0}catch{}var d=aV.call(e);return s&&(t?e[Ov]=i:delete e[Ov]),d}var lV=Object.prototype,cV=lV.toString;function uV(e){return cV.call(e)}var dV="[object Null]",hV="[object Undefined]",WA=oc?oc.toStringTag:void 0;function Yf(e){return e==null?e===void 0?hV:dV:WA&&WA in Object(e)?sV(e):uV(e)}function Mu(e){return e!=null&&typeof e=="object"}var fV="[object Symbol]";function s1(e){return typeof e=="symbol"||Mu(e)&&Yf(e)==fV}function XS(e,t){for(var i=-1,s=e==null?0:e.length,d=Array(s);++i<s;)d[i]=t(e[i],i,e);return d}var Bs=Array.isArray,pV=1/0,qA=oc?oc.prototype:void 0,KA=qA?qA.toString:void 0;function yL(e){if(typeof e=="string")return e;if(Bs(e))return XS(e,yL)+"";if(s1(e))return KA?KA.call(e):"";var t=e+"";return t=="0"&&1/e==-pV?"-0":t}var mV=/\s/;function gV(e){for(var t=e.length;t--&&mV.test(e.charAt(t)););return t}var vV=/^\s+/;function _V(e){return e&&e.slice(0,gV(e)+1).replace(vV,"")}function Ns(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ZA=NaN,yV=/^[-+]0x[0-9a-f]+$/i,bV=/^0b[01]+$/i,xV=/^0o[0-7]+$/i,wV=parseInt;function YA(e){if(typeof e=="number")return e;if(s1(e))return ZA;if(Ns(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ns(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=_V(e);var i=bV.test(e);return i||xV.test(e)?wV(e.slice(2),i?2:8):yV.test(e)?ZA:+e}function JS(e){return e}var SV="[object AsyncFunction]",TV="[object Function]",CV="[object GeneratorFunction]",EV="[object Proxy]";function QS(e){if(!Ns(e))return!1;var t=Yf(e);return t==TV||t==CV||t==SV||t==EV}var Iw=tu["__core-js_shared__"],XA=function(){var e=/[^.]+$/.exec(Iw&&Iw.keys&&Iw.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function MV(e){return!!XA&&XA in e}var IV=Function.prototype,AV=IV.toString;function Xf(e){if(e!=null){try{return AV.call(e)}catch{}try{return e+""}catch{}}return""}var kV=/[\\^$.*+?()[\]{}|]/g,PV=/^\[object .+?Constructor\]$/,RV=Function.prototype,LV=Object.prototype,OV=RV.toString,DV=LV.hasOwnProperty,zV=RegExp("^"+OV.call(DV).replace(kV,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function FV(e){if(!Ns(e)||MV(e))return!1;var t=QS(e)?zV:PV;return t.test(Xf(e))}function BV(e,t){return e==null?void 0:e[t]}function Jf(e,t){var i=BV(e,t);return FV(i)?i:void 0}var _2=Jf(tu,"WeakMap"),JA=Object.create,NV=function(){function e(){}return function(t){if(!Ns(t))return{};if(JA)return JA(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function $V(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function VV(){}function bL(e,t){var i=-1,s=e.length;for(t||(t=Array(s));++i<s;)t[i]=e[i];return t}var UV=800,jV=16,HV=Date.now;function GV(e){var t=0,i=0;return function(){var s=HV(),d=jV-(s-i);if(i=s,d>0){if(++t>=UV)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function WV(e){return function(){return e}}var Cb=function(){try{var e=Jf(Object,"defineProperty");return e({},"",{}),e}catch{}}(),qV=Cb?function(e,t){return Cb(e,"toString",{configurable:!0,enumerable:!1,value:WV(t),writable:!0})}:JS,xL=GV(qV);function KV(e,t){for(var i=-1,s=e==null?0:e.length;++i<s&&t(e[i],i,e)!==!1;);return e}function wL(e,t,i,s){for(var d=e.length,p=i+(s?1:-1);s?p--:++p<d;)if(t(e[p],p,e))return p;return-1}function ZV(e){return e!==e}function YV(e,t,i){for(var s=i-1,d=e.length;++s<d;)if(e[s]===t)return s;return-1}function XV(e,t,i){return t===t?YV(e,t,i):wL(e,ZV,i)}function JV(e,t){var i=e==null?0:e.length;return!!i&&XV(e,t,0)>-1}var QV=9007199254740991,e8=/^(?:0|[1-9]\d*)$/;function l1(e,t){var i=typeof e;return t=t??QV,!!t&&(i=="number"||i!="symbol"&&e8.test(e))&&e>-1&&e%1==0&&e<t}function eT(e,t,i){t=="__proto__"&&Cb?Cb(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function F_(e,t){return e===t||e!==e&&t!==t}var t8=Object.prototype,n8=t8.hasOwnProperty;function tT(e,t,i){var s=e[t];(!(n8.call(e,t)&&F_(s,i))||i===void 0&&!(t in e))&&eT(e,t,i)}function jm(e,t,i,s){var d=!i;i||(i={});for(var p=-1,_=t.length;++p<_;){var o=t[p],w=void 0;w===void 0&&(w=e[o]),d?eT(i,o,w):tT(i,o,w)}return i}var QA=Math.max;function SL(e,t,i){return t=QA(t===void 0?e.length-1:t,0),function(){for(var s=arguments,d=-1,p=QA(s.length-t,0),_=Array(p);++d<p;)_[d]=s[t+d];d=-1;for(var o=Array(t+1);++d<t;)o[d]=s[d];return o[t]=i(_),$V(e,this,o)}}function TL(e,t){return xL(SL(e,t,JS),e+"")}var o8=9007199254740991;function nT(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=o8}function Hm(e){return e!=null&&nT(e.length)&&!QS(e)}function r8(e,t,i){if(!Ns(i))return!1;var s=typeof t;return(s=="number"?Hm(i)&&l1(t,i.length):s=="string"&&t in i)?F_(i[t],e):!1}function i8(e){return TL(function(t,i){var s=-1,d=i.length,p=d>1?i[d-1]:void 0,_=d>2?i[2]:void 0;for(p=e.length>3&&typeof p=="function"?(d--,p):void 0,_&&r8(i[0],i[1],_)&&(p=d<3?void 0:p,d=1),t=Object(t);++s<d;){var o=i[s];o&&e(t,o,s,p)}return t})}var a8=Object.prototype;function oT(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||a8;return e===i}function s8(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}var l8="[object Arguments]";function ek(e){return Mu(e)&&Yf(e)==l8}var CL=Object.prototype,c8=CL.hasOwnProperty,u8=CL.propertyIsEnumerable,d_=ek(function(){return arguments}())?ek:function(e){return Mu(e)&&c8.call(e,"callee")&&!u8.call(e,"callee")};function d8(){return!1}var EL=typeof Tl=="object"&&Tl&&!Tl.nodeType&&Tl,tk=EL&&typeof Cl=="object"&&Cl&&!Cl.nodeType&&Cl,h8=tk&&tk.exports===EL,nk=h8?tu.Buffer:void 0,f8=nk?nk.isBuffer:void 0,h_=f8||d8,p8="[object Arguments]",m8="[object Array]",g8="[object Boolean]",v8="[object Date]",_8="[object Error]",y8="[object Function]",b8="[object Map]",x8="[object Number]",w8="[object Object]",S8="[object RegExp]",T8="[object Set]",C8="[object String]",E8="[object WeakMap]",M8="[object ArrayBuffer]",I8="[object DataView]",A8="[object Float32Array]",k8="[object Float64Array]",P8="[object Int8Array]",R8="[object Int16Array]",L8="[object Int32Array]",O8="[object Uint8Array]",D8="[object Uint8ClampedArray]",z8="[object Uint16Array]",F8="[object Uint32Array]",Ki={};Ki[A8]=Ki[k8]=Ki[P8]=Ki[R8]=Ki[L8]=Ki[O8]=Ki[D8]=Ki[z8]=Ki[F8]=!0;Ki[p8]=Ki[m8]=Ki[M8]=Ki[g8]=Ki[I8]=Ki[v8]=Ki[_8]=Ki[y8]=Ki[b8]=Ki[x8]=Ki[w8]=Ki[S8]=Ki[T8]=Ki[C8]=Ki[E8]=!1;function B8(e){return Mu(e)&&nT(e.length)&&!!Ki[Yf(e)]}function rT(e){return function(t){return e(t)}}var ML=typeof Tl=="object"&&Tl&&!Tl.nodeType&&Tl,Xv=ML&&typeof Cl=="object"&&Cl&&!Cl.nodeType&&Cl,N8=Xv&&Xv.exports===ML,Aw=N8&&vL.process,Tm=function(){try{var e=Xv&&Xv.require&&Xv.require("util").types;return e||Aw&&Aw.binding&&Aw.binding("util")}catch{}}(),ok=Tm&&Tm.isTypedArray,iT=ok?rT(ok):B8,$8=Object.prototype,V8=$8.hasOwnProperty;function IL(e,t){var i=Bs(e),s=!i&&d_(e),d=!i&&!s&&h_(e),p=!i&&!s&&!d&&iT(e),_=i||s||d||p,o=_?s8(e.length,String):[],w=o.length;for(var C in e)(t||V8.call(e,C))&&!(_&&(C=="length"||d&&(C=="offset"||C=="parent")||p&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||l1(C,w)))&&o.push(C);return o}function AL(e,t){return function(i){return e(t(i))}}var U8=AL(Object.keys,Object),j8=Object.prototype,H8=j8.hasOwnProperty;function G8(e){if(!oT(e))return U8(e);var t=[];for(var i in Object(e))H8.call(e,i)&&i!="constructor"&&t.push(i);return t}function B_(e){return Hm(e)?IL(e):G8(e)}function W8(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var q8=Object.prototype,K8=q8.hasOwnProperty;function Z8(e){if(!Ns(e))return W8(e);var t=oT(e),i=[];for(var s in e)s=="constructor"&&(t||!K8.call(e,s))||i.push(s);return i}function N_(e){return Hm(e)?IL(e,!0):Z8(e)}var Y8=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X8=/^\w*$/;function aT(e,t){if(Bs(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||s1(e)?!0:X8.test(e)||!Y8.test(e)||t!=null&&e in Object(t)}var f_=Jf(Object,"create");function J8(){this.__data__=f_?f_(null):{},this.size=0}function Q8(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var eU="__lodash_hash_undefined__",tU=Object.prototype,nU=tU.hasOwnProperty;function oU(e){var t=this.__data__;if(f_){var i=t[e];return i===eU?void 0:i}return nU.call(t,e)?t[e]:void 0}var rU=Object.prototype,iU=rU.hasOwnProperty;function aU(e){var t=this.__data__;return f_?t[e]!==void 0:iU.call(t,e)}var sU="__lodash_hash_undefined__";function lU(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=f_&&t===void 0?sU:t,this}function Uf(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}Uf.prototype.clear=J8;Uf.prototype.delete=Q8;Uf.prototype.get=oU;Uf.prototype.has=aU;Uf.prototype.set=lU;function cU(){this.__data__=[],this.size=0}function c1(e,t){for(var i=e.length;i--;)if(F_(e[i][0],t))return i;return-1}var uU=Array.prototype,dU=uU.splice;function hU(e){var t=this.__data__,i=c1(t,e);if(i<0)return!1;var s=t.length-1;return i==s?t.pop():dU.call(t,i,1),--this.size,!0}function fU(e){var t=this.__data__,i=c1(t,e);return i<0?void 0:t[i][1]}function pU(e){return c1(this.__data__,e)>-1}function mU(e,t){var i=this.__data__,s=c1(i,e);return s<0?(++this.size,i.push([e,t])):i[s][1]=t,this}function dd(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}dd.prototype.clear=cU;dd.prototype.delete=hU;dd.prototype.get=fU;dd.prototype.has=pU;dd.prototype.set=mU;var p_=Jf(tu,"Map");function gU(){this.size=0,this.__data__={hash:new Uf,map:new(p_||dd),string:new Uf}}function vU(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function u1(e,t){var i=e.__data__;return vU(t)?i[typeof t=="string"?"string":"hash"]:i.map}function _U(e){var t=u1(this,e).delete(e);return this.size-=t?1:0,t}function yU(e){return u1(this,e).get(e)}function bU(e){return u1(this,e).has(e)}function xU(e,t){var i=u1(this,e),s=i.size;return i.set(e,t),this.size+=i.size==s?0:1,this}function hd(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}hd.prototype.clear=gU;hd.prototype.delete=_U;hd.prototype.get=yU;hd.prototype.has=bU;hd.prototype.set=xU;var wU="Expected a function";function d1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(wU);var i=function(){var s=arguments,d=t?t.apply(this,s):s[0],p=i.cache;if(p.has(d))return p.get(d);var _=e.apply(this,s);return i.cache=p.set(d,_)||p,_};return i.cache=new(d1.Cache||hd),i}d1.Cache=hd;var SU=500;function TU(e){var t=d1(e,function(s){return i.size===SU&&i.clear(),s}),i=t.cache;return t}var CU=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,EU=/\\(\\)?/g,MU=TU(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(CU,function(i,s,d,p){t.push(d?p.replace(EU,"$1"):s||i)}),t});function IU(e){return e==null?"":yL(e)}function Gm(e,t){return Bs(e)?e:aT(e,t)?[e]:MU(IU(e))}var AU=1/0;function Wm(e){if(typeof e=="string"||s1(e))return e;var t=e+"";return t=="0"&&1/e==-AU?"-0":t}function h1(e,t){t=Gm(t,e);for(var i=0,s=t.length;e!=null&&i<s;)e=e[Wm(t[i++])];return i&&i==s?e:void 0}function Ji(e,t,i){var s=e==null?void 0:h1(e,t);return s===void 0?i:s}function sT(e,t){for(var i=-1,s=t.length,d=e.length;++i<s;)e[d+i]=t[i];return e}var rk=oc?oc.isConcatSpreadable:void 0;function kU(e){return Bs(e)||d_(e)||!!(rk&&e&&e[rk])}function $_(e,t,i,s,d){var p=-1,_=e.length;for(i||(i=kU),d||(d=[]);++p<_;){var o=e[p];t>0&&i(o)?t>1?$_(o,t-1,i,s,d):sT(d,o):s||(d[d.length]=o)}return d}function kL(e){var t=e==null?0:e.length;return t?$_(e,1):[]}function PL(e){return xL(SL(e,void 0,kL),e+"")}var lT=AL(Object.getPrototypeOf,Object),PU="[object Object]",RU=Function.prototype,LU=Object.prototype,RL=RU.toString,OU=LU.hasOwnProperty,DU=RL.call(Object);function LL(e){if(!Mu(e)||Yf(e)!=PU)return!1;var t=lT(e);if(t===null)return!0;var i=OU.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&RL.call(i)==DU}function zU(e,t,i){var s=-1,d=e.length;t<0&&(t=-t>d?0:d+t),i=i>d?d:i,i<0&&(i+=d),d=t>i?0:i-t>>>0,t>>>=0;for(var p=Array(d);++s<d;)p[s]=e[s+t];return p}function ds(){if(!arguments.length)return[];var e=arguments[0];return Bs(e)?e:[e]}function FU(){this.__data__=new dd,this.size=0}function BU(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function NU(e){return this.__data__.get(e)}function $U(e){return this.__data__.has(e)}var VU=200;function UU(e,t){var i=this.__data__;if(i instanceof dd){var s=i.__data__;if(!p_||s.length<VU-1)return s.push([e,t]),this.size=++i.size,this;i=this.__data__=new hd(s)}return i.set(e,t),this.size=i.size,this}function Kc(e){var t=this.__data__=new dd(e);this.size=t.size}Kc.prototype.clear=FU;Kc.prototype.delete=BU;Kc.prototype.get=NU;Kc.prototype.has=$U;Kc.prototype.set=UU;function jU(e,t){return e&&jm(t,B_(t),e)}function HU(e,t){return e&&jm(t,N_(t),e)}var OL=typeof Tl=="object"&&Tl&&!Tl.nodeType&&Tl,ik=OL&&typeof Cl=="object"&&Cl&&!Cl.nodeType&&Cl,GU=ik&&ik.exports===OL,ak=GU?tu.Buffer:void 0,sk=ak?ak.allocUnsafe:void 0;function DL(e,t){if(t)return e.slice();var i=e.length,s=sk?sk(i):new e.constructor(i);return e.copy(s),s}function WU(e,t){for(var i=-1,s=e==null?0:e.length,d=0,p=[];++i<s;){var _=e[i];t(_,i,e)&&(p[d++]=_)}return p}function zL(){return[]}var qU=Object.prototype,KU=qU.propertyIsEnumerable,lk=Object.getOwnPropertySymbols,cT=lk?function(e){return e==null?[]:(e=Object(e),WU(lk(e),function(t){return KU.call(e,t)}))}:zL;function ZU(e,t){return jm(e,cT(e),t)}var YU=Object.getOwnPropertySymbols,FL=YU?function(e){for(var t=[];e;)sT(t,cT(e)),e=lT(e);return t}:zL;function XU(e,t){return jm(e,FL(e),t)}function BL(e,t,i){var s=t(e);return Bs(e)?s:sT(s,i(e))}function y2(e){return BL(e,B_,cT)}function NL(e){return BL(e,N_,FL)}var b2=Jf(tu,"DataView"),x2=Jf(tu,"Promise"),mm=Jf(tu,"Set"),ck="[object Map]",JU="[object Object]",uk="[object Promise]",dk="[object Set]",hk="[object WeakMap]",fk="[object DataView]",QU=Xf(b2),ej=Xf(p_),tj=Xf(x2),nj=Xf(mm),oj=Xf(_2),jc=Yf;(b2&&jc(new b2(new ArrayBuffer(1)))!=fk||p_&&jc(new p_)!=ck||x2&&jc(x2.resolve())!=uk||mm&&jc(new mm)!=dk||_2&&jc(new _2)!=hk)&&(jc=function(e){var t=Yf(e),i=t==JU?e.constructor:void 0,s=i?Xf(i):"";if(s)switch(s){case QU:return fk;case ej:return ck;case tj:return uk;case nj:return dk;case oj:return hk}return t});var rj=Object.prototype,ij=rj.hasOwnProperty;function aj(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&ij.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var Eb=tu.Uint8Array;function uT(e){var t=new e.constructor(e.byteLength);return new Eb(t).set(new Eb(e)),t}function sj(e,t){var i=t?uT(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var lj=/\w*$/;function cj(e){var t=new e.constructor(e.source,lj.exec(e));return t.lastIndex=e.lastIndex,t}var pk=oc?oc.prototype:void 0,mk=pk?pk.valueOf:void 0;function uj(e){return mk?Object(mk.call(e)):{}}function $L(e,t){var i=t?uT(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var dj="[object Boolean]",hj="[object Date]",fj="[object Map]",pj="[object Number]",mj="[object RegExp]",gj="[object Set]",vj="[object String]",_j="[object Symbol]",yj="[object ArrayBuffer]",bj="[object DataView]",xj="[object Float32Array]",wj="[object Float64Array]",Sj="[object Int8Array]",Tj="[object Int16Array]",Cj="[object Int32Array]",Ej="[object Uint8Array]",Mj="[object Uint8ClampedArray]",Ij="[object Uint16Array]",Aj="[object Uint32Array]";function kj(e,t,i){var s=e.constructor;switch(t){case yj:return uT(e);case dj:case hj:return new s(+e);case bj:return sj(e,i);case xj:case wj:case Sj:case Tj:case Cj:case Ej:case Mj:case Ij:case Aj:return $L(e,i);case fj:return new s;case pj:case vj:return new s(e);case mj:return cj(e);case gj:return new s;case _j:return uj(e)}}function VL(e){return typeof e.constructor=="function"&&!oT(e)?NV(lT(e)):{}}var Pj="[object Map]";function Rj(e){return Mu(e)&&jc(e)==Pj}var gk=Tm&&Tm.isMap,Lj=gk?rT(gk):Rj,Oj="[object Set]";function Dj(e){return Mu(e)&&jc(e)==Oj}var vk=Tm&&Tm.isSet,zj=vk?rT(vk):Dj,Fj=1,Bj=2,Nj=4,UL="[object Arguments]",$j="[object Array]",Vj="[object Boolean]",Uj="[object Date]",jj="[object Error]",jL="[object Function]",Hj="[object GeneratorFunction]",Gj="[object Map]",Wj="[object Number]",HL="[object Object]",qj="[object RegExp]",Kj="[object Set]",Zj="[object String]",Yj="[object Symbol]",Xj="[object WeakMap]",Jj="[object ArrayBuffer]",Qj="[object DataView]",eH="[object Float32Array]",tH="[object Float64Array]",nH="[object Int8Array]",oH="[object Int16Array]",rH="[object Int32Array]",iH="[object Uint8Array]",aH="[object Uint8ClampedArray]",sH="[object Uint16Array]",lH="[object Uint32Array]",$i={};$i[UL]=$i[$j]=$i[Jj]=$i[Qj]=$i[Vj]=$i[Uj]=$i[eH]=$i[tH]=$i[nH]=$i[oH]=$i[rH]=$i[Gj]=$i[Wj]=$i[HL]=$i[qj]=$i[Kj]=$i[Zj]=$i[Yj]=$i[iH]=$i[aH]=$i[sH]=$i[lH]=!0;$i[jj]=$i[jL]=$i[Xj]=!1;function gm(e,t,i,s,d,p){var _,o=t&Fj,w=t&Bj,C=t&Nj;if(i&&(_=d?i(e,s,d,p):i(e)),_!==void 0)return _;if(!Ns(e))return e;var M=Bs(e);if(M){if(_=aj(e),!o)return bL(e,_)}else{var I=jc(e),F=I==jL||I==Hj;if(h_(e))return DL(e,o);if(I==HL||I==UL||F&&!d){if(_=w||F?{}:VL(e),!o)return w?XU(e,HU(_,e)):ZU(e,jU(_,e))}else{if(!$i[I])return d?e:{};_=kj(e,I,o)}}p||(p=new Kc);var B=p.get(e);if(B)return B;p.set(e,_),zj(e)?e.forEach(function(j){_.add(gm(j,t,i,j,e,p))}):Lj(e)&&e.forEach(function(j,U){_.set(U,gm(j,t,i,U,e,p))});var N=C?w?NL:y2:w?N_:B_,D=M?void 0:N(e);return KV(D||e,function(j,U){D&&(U=j,j=e[U]),tT(_,U,gm(j,t,i,U,e,p))}),_}var cH=4;function _k(e){return gm(e,cH)}var uH=1,dH=4;function Mb(e){return gm(e,uH|dH)}var hH="__lodash_hash_undefined__";function fH(e){return this.__data__.set(e,hH),this}function pH(e){return this.__data__.has(e)}function m_(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new hd;++t<i;)this.add(e[t])}m_.prototype.add=m_.prototype.push=fH;m_.prototype.has=pH;function mH(e,t){for(var i=-1,s=e==null?0:e.length;++i<s;)if(t(e[i],i,e))return!0;return!1}function GL(e,t){return e.has(t)}var gH=1,vH=2;function WL(e,t,i,s,d,p){var _=i&gH,o=e.length,w=t.length;if(o!=w&&!(_&&w>o))return!1;var C=p.get(e),M=p.get(t);if(C&&M)return C==t&&M==e;var I=-1,F=!0,B=i&vH?new m_:void 0;for(p.set(e,t),p.set(t,e);++I<o;){var N=e[I],D=t[I];if(s)var j=_?s(D,N,I,t,e,p):s(N,D,I,e,t,p);if(j!==void 0){if(j)continue;F=!1;break}if(B){if(!mH(t,function(U,ne){if(!GL(B,ne)&&(N===U||d(N,U,i,s,p)))return B.push(ne)})){F=!1;break}}else if(!(N===D||d(N,D,i,s,p))){F=!1;break}}return p.delete(e),p.delete(t),F}function _H(e){var t=-1,i=Array(e.size);return e.forEach(function(s,d){i[++t]=[d,s]}),i}function dT(e){var t=-1,i=Array(e.size);return e.forEach(function(s){i[++t]=s}),i}var yH=1,bH=2,xH="[object Boolean]",wH="[object Date]",SH="[object Error]",TH="[object Map]",CH="[object Number]",EH="[object RegExp]",MH="[object Set]",IH="[object String]",AH="[object Symbol]",kH="[object ArrayBuffer]",PH="[object DataView]",yk=oc?oc.prototype:void 0,kw=yk?yk.valueOf:void 0;function RH(e,t,i,s,d,p,_){switch(i){case PH:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case kH:return!(e.byteLength!=t.byteLength||!p(new Eb(e),new Eb(t)));case xH:case wH:case CH:return F_(+e,+t);case SH:return e.name==t.name&&e.message==t.message;case EH:case IH:return e==t+"";case TH:var o=_H;case MH:var w=s&yH;if(o||(o=dT),e.size!=t.size&&!w)return!1;var C=_.get(e);if(C)return C==t;s|=bH,_.set(e,t);var M=WL(o(e),o(t),s,d,p,_);return _.delete(e),M;case AH:if(kw)return kw.call(e)==kw.call(t)}return!1}var LH=1,OH=Object.prototype,DH=OH.hasOwnProperty;function zH(e,t,i,s,d,p){var _=i&LH,o=y2(e),w=o.length,C=y2(t),M=C.length;if(w!=M&&!_)return!1;for(var I=w;I--;){var F=o[I];if(!(_?F in t:DH.call(t,F)))return!1}var B=p.get(e),N=p.get(t);if(B&&N)return B==t&&N==e;var D=!0;p.set(e,t),p.set(t,e);for(var j=_;++I<w;){F=o[I];var U=e[F],ne=t[F];if(s)var K=_?s(ne,U,F,t,e,p):s(U,ne,F,e,t,p);if(!(K===void 0?U===ne||d(U,ne,i,s,p):K)){D=!1;break}j||(j=F=="constructor")}if(D&&!j){var G=e.constructor,J=t.constructor;G!=J&&"constructor"in e&&"constructor"in t&&!(typeof G=="function"&&G instanceof G&&typeof J=="function"&&J instanceof J)&&(D=!1)}return p.delete(e),p.delete(t),D}var FH=1,bk="[object Arguments]",xk="[object Array]",I0="[object Object]",BH=Object.prototype,wk=BH.hasOwnProperty;function NH(e,t,i,s,d,p){var _=Bs(e),o=Bs(t),w=_?xk:jc(e),C=o?xk:jc(t);w=w==bk?I0:w,C=C==bk?I0:C;var M=w==I0,I=C==I0,F=w==C;if(F&&h_(e)){if(!h_(t))return!1;_=!0,M=!1}if(F&&!M)return p||(p=new Kc),_||iT(e)?WL(e,t,i,s,d,p):RH(e,t,w,i,s,d,p);if(!(i&FH)){var B=M&&wk.call(e,"__wrapped__"),N=I&&wk.call(t,"__wrapped__");if(B||N){var D=B?e.value():e,j=N?t.value():t;return p||(p=new Kc),d(D,j,i,s,p)}}return F?(p||(p=new Kc),zH(e,t,i,s,d,p)):!1}function f1(e,t,i,s,d){return e===t?!0:e==null||t==null||!Mu(e)&&!Mu(t)?e!==e&&t!==t:NH(e,t,i,s,f1,d)}var $H=1,VH=2;function UH(e,t,i,s){var d=i.length,p=d;if(e==null)return!p;for(e=Object(e);d--;){var _=i[d];if(_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++d<p;){_=i[d];var o=_[0],w=e[o],C=_[1];if(_[2]){if(w===void 0&&!(o in e))return!1}else{var M=new Kc,I;if(!(I===void 0?f1(C,w,$H|VH,s,M):I))return!1}}return!0}function qL(e){return e===e&&!Ns(e)}function jH(e){for(var t=B_(e),i=t.length;i--;){var s=t[i],d=e[s];t[i]=[s,d,qL(d)]}return t}function KL(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==void 0||e in Object(i))}}function HH(e){var t=jH(e);return t.length==1&&t[0][2]?KL(t[0][0],t[0][1]):function(i){return i===e||UH(i,e,t)}}function GH(e,t){return e!=null&&t in Object(e)}function WH(e,t,i){t=Gm(t,e);for(var s=-1,d=t.length,p=!1;++s<d;){var _=Wm(t[s]);if(!(p=e!=null&&i(e,_)))break;e=e[_]}return p||++s!=d?p:(d=e==null?0:e.length,!!d&&nT(d)&&l1(_,d)&&(Bs(e)||d_(e)))}function ZL(e,t){return e!=null&&WH(e,t,GH)}var qH=1,KH=2;function ZH(e,t){return aT(e)&&qL(t)?KL(Wm(e),t):function(i){var s=Ji(i,e);return s===void 0&&s===t?ZL(i,e):f1(t,s,qH|KH)}}function YH(e){return function(t){return t==null?void 0:t[e]}}function XH(e){return function(t){return h1(t,e)}}function JH(e){return aT(e)?YH(Wm(e)):XH(e)}function YL(e){return typeof e=="function"?e:e==null?JS:typeof e=="object"?Bs(e)?ZH(e[0],e[1]):HH(e):JH(e)}function QH(e){return function(t,i,s){for(var d=-1,p=Object(t),_=s(t),o=_.length;o--;){var w=_[++d];if(i(p[w],w,p)===!1)break}return t}}var XL=QH();function eG(e,t){return e&&XL(e,t,B_)}function tG(e,t){return function(i,s){if(i==null)return i;if(!Hm(i))return e(i,s);for(var d=i.length,p=-1,_=Object(i);++p<d&&s(_[p],p,_)!==!1;);return i}}var nG=tG(eG),Pw=function(){return tu.Date.now()},oG="Expected a function",rG=Math.max,iG=Math.min;function il(e,t,i){var s,d,p,_,o,w,C=0,M=!1,I=!1,F=!0;if(typeof e!="function")throw new TypeError(oG);t=YA(t)||0,Ns(i)&&(M=!!i.leading,I="maxWait"in i,p=I?rG(YA(i.maxWait)||0,t):p,F="trailing"in i?!!i.trailing:F);function B(oe){var se=s,me=d;return s=d=void 0,C=oe,_=e.apply(me,se),_}function N(oe){return C=oe,o=setTimeout(U,t),M?B(oe):_}function D(oe){var se=oe-w,me=oe-C,de=t-se;return I?iG(de,p-me):de}function j(oe){var se=oe-w,me=oe-C;return w===void 0||se>=t||se<0||I&&me>=p}function U(){var oe=Pw();if(j(oe))return ne(oe);o=setTimeout(U,D(oe))}function ne(oe){return o=void 0,F&&s?B(oe):(s=d=void 0,_)}function K(){o!==void 0&&clearTimeout(o),C=0,s=w=d=o=void 0}function G(){return o===void 0?_:ne(Pw())}function J(){var oe=Pw(),se=j(oe);if(s=arguments,d=this,w=oe,se){if(o===void 0)return N(w);if(I)return clearTimeout(o),o=setTimeout(U,t),B(w)}return o===void 0&&(o=setTimeout(U,t)),_}return J.cancel=K,J.flush=G,J}function w2(e,t,i){(i!==void 0&&!F_(e[t],i)||i===void 0&&!(t in e))&&eT(e,t,i)}function JL(e){return Mu(e)&&Hm(e)}function S2(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function aG(e){return jm(e,N_(e))}function sG(e,t,i,s,d,p,_){var o=S2(e,i),w=S2(t,i),C=_.get(w);if(C){w2(e,i,C);return}var M=p?p(o,w,i+"",e,t,_):void 0,I=M===void 0;if(I){var F=Bs(w),B=!F&&h_(w),N=!F&&!B&&iT(w);M=w,F||B||N?Bs(o)?M=o:JL(o)?M=bL(o):B?(I=!1,M=DL(w,!0)):N?(I=!1,M=$L(w,!0)):M=[]:LL(w)||d_(w)?(M=o,d_(o)?M=aG(o):(!Ns(o)||QS(o))&&(M=VL(w))):I=!1}I&&(_.set(w,M),d(M,w,s,p,_),_.delete(w)),w2(e,i,M)}function QL(e,t,i,s,d){e!==t&&XL(t,function(p,_){if(d||(d=new Kc),Ns(p))sG(e,t,_,i,QL,s,d);else{var o=s?s(S2(e,_),p,_+"",e,t,d):void 0;o===void 0&&(o=p),w2(e,_,o)}},N_)}function lG(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function eO(e,t,i){var s=e==null?0:e.length;if(!s)return-1;var d=s-1;return wL(e,YL(t),d,!0)}function cG(e,t){var i=-1,s=Hm(e)?Array(e.length):[];return nG(e,function(d,p,_){s[++i]=t(d,p,_)}),s}function uG(e,t){var i=Bs(e)?XS:cG;return i(e,YL(t))}function dG(e,t){return $_(uG(e,t),1)}var hG=1/0;function fG(e){var t=e==null?0:e.length;return t?$_(e,hG):[]}function g_(e){for(var t=-1,i=e==null?0:e.length,s={};++t<i;){var d=e[t];s[d[0]]=d[1]}return s}function pG(e,t){return t.length<2?e:h1(e,zU(t,0,-1))}function La(e,t){return f1(e,t)}function ga(e){return e==null}function tO(e){return e===void 0}var nO=i8(function(e,t,i){QL(e,t,i)});function mG(e,t){return t=Gm(t,e),e=pG(e,t),e==null||delete e[Wm(lG(t))]}function gG(e){return LL(e)?void 0:e}var vG=1,_G=2,yG=4,bG=PL(function(e,t){var i={};if(e==null)return i;var s=!1;t=XS(t,function(p){return p=Gm(p,e),s||(s=p.length>1),p}),jm(e,NL(e),i),s&&(i=gm(i,vG|_G|yG,gG));for(var d=t.length;d--;)mG(i,t[d]);return i});function oO(e,t,i,s){if(!Ns(e))return e;t=Gm(t,e);for(var d=-1,p=t.length,_=p-1,o=e;o!=null&&++d<p;){var w=Wm(t[d]),C=i;if(w==="__proto__"||w==="constructor"||w==="prototype")return e;if(d!=_){var M=o[w];C=void 0,C===void 0&&(C=Ns(M)?M:l1(t[d+1])?[]:{})}tT(o,w,C),o=o[w]}return e}function xG(e,t,i){for(var s=-1,d=t.length,p={};++s<d;){var _=t[s],o=h1(e,_);i(o,_)&&oO(p,Gm(_,e),o)}return p}function wG(e,t){return xG(e,t,function(i,s){return ZL(e,s)})}var Gc=PL(function(e,t){return e==null?{}:wG(e,t)});function SG(e,t,i){return e==null?e:oO(e,t,i)}var TG="Expected a function";function zf(e,t,i){var s=!0,d=!0;if(typeof e!="function")throw new TypeError(TG);return Ns(i)&&(s="leading"in i?!!i.leading:s,d="trailing"in i?!!i.trailing:d),il(e,t,{leading:s,maxWait:t,trailing:d})}var CG=1/0,EG=mm&&1/dT(new mm([,-0]))[1]==CG?function(e){return new mm(e)}:VV,MG=200;function IG(e,t,i){var s=-1,d=JV,p=e.length,_=!0,o=[],w=o;if(p>=MG){var C=EG(e);if(C)return dT(C);_=!1,d=GL,w=new m_}else w=o;e:for(;++s<p;){var M=e[s],I=M;if(M=M!==0?M:0,_&&I===I){for(var F=w.length;F--;)if(w[F]===I)continue e;o.push(M)}else d(w,I,i)||(w!==o&&w.push(I),o.push(M))}return o}var Rw=TL(function(e){return IG($_(e,1,JL,!0))});const Hr=e=>e===void 0,ai=e=>typeof e=="boolean",ao=e=>typeof e=="number",xl=e=>!e&&e!==0||fn(e)&&e.length===0||Vo(e)&&!Object.keys(e).length,El=e=>typeof Element>"u"?!1:e instanceof Element,jf=e=>ga(e),AG=e=>Zn(e)?!Number.isNaN(Number(e)):!1,p1=e=>e===window;var kG=Object.defineProperty,PG=Object.defineProperties,RG=Object.getOwnPropertyDescriptors,Sk=Object.getOwnPropertySymbols,LG=Object.prototype.hasOwnProperty,OG=Object.prototype.propertyIsEnumerable,Tk=(e,t,i)=>t in e?kG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,DG=(e,t)=>{for(var i in t||(t={}))LG.call(t,i)&&Tk(e,i,t[i]);if(Sk)for(var i of Sk(t))OG.call(t,i)&&Tk(e,i,t[i]);return e},zG=(e,t)=>PG(e,RG(t));function T2(e,t){var i;const s=gi();return Ha(()=>{s.value=e()},zG(DG({},t),{flush:(i=void 0)!=null?i:"sync"})),Vm(s)}var Ck;const gr=typeof window<"u",FG=e=>typeof e<"u",C2=e=>typeof e=="function",BG=e=>typeof e=="string",Cm=()=>{},E2=gr&&((Ck=window==null?void 0:window.navigator)==null?void 0:Ck.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function xh(e){return typeof e=="function"?e():y(e)}function rO(e,t){function i(...s){return new Promise((d,p)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(d).catch(p)})}return i}function NG(e,t={}){let i,s,d=Cm;const p=o=>{clearTimeout(o),d(),d=Cm};return o=>{const w=xh(e),C=xh(t.maxWait);return i&&p(i),w<=0||C!==void 0&&C<=0?(s&&(p(s),s=null),Promise.resolve(o())):new Promise((M,I)=>{d=t.rejectOnCancel?I:M,C&&!s&&(s=setTimeout(()=>{i&&p(i),s=null,M(o())},C)),i=setTimeout(()=>{s&&p(s),s=null,M(o())},w)})}}function $G(e,t=!0,i=!0,s=!1){let d=0,p,_=!0,o=Cm,w;const C=()=>{p&&(clearTimeout(p),p=void 0,o(),o=Cm)};return I=>{const F=xh(e),B=Date.now()-d,N=()=>w=I();return C(),F<=0?(d=Date.now(),N()):(B>F&&(i||!_)?(d=Date.now(),N()):t&&(w=new Promise((D,j)=>{o=s?j:D,p=setTimeout(()=>{d=Date.now(),_=!0,D(N()),C()},Math.max(0,F-B))})),!i&&!p&&(p=setTimeout(()=>_=!0,F)),_=!1,w)}}function VG(e){return e}function UG(e,t){let i,s,d;const p=we(!0),_=()=>{p.value=!0,d()};tn(e,_,{flush:"sync"});const o=C2(t)?t:t.get,w=C2(t)?void 0:t.set,C=L5((M,I)=>(s=M,d=I,{get(){return p.value&&(i=o(),p.value=!1),s(),i},set(F){w==null||w(F)}}));return Object.isExtensible(C)&&(C.trigger=_),C}function V_(e){return $3()?(V3(e),!0):!1}function jG(e,t=200,i={}){return rO(NG(t,i),e)}function HG(e,t=200,i={}){const s=we(e.value),d=jG(()=>{s.value=e.value},t,i);return tn(e,()=>d()),s}function iO(e,t=200,i=!1,s=!0,d=!1){return rO($G(t,i,s,d),e)}function hT(e,t=!0){jo()?No(e):t?e():oo(e)}function Hf(e,t,i={}){const{immediate:s=!0}=i,d=we(!1);let p=null;function _(){p&&(clearTimeout(p),p=null)}function o(){d.value=!1,_()}function w(...C){_(),d.value=!0,p=setTimeout(()=>{d.value=!1,p=null,e(...C)},xh(t))}return s&&(d.value=!0,gr&&w()),V_(o),{isPending:Vm(d),start:w,stop:o}}function Ds(e){var t;const i=xh(e);return(t=i==null?void 0:i.$el)!=null?t:i}const Rh=gr?window:void 0,GG=gr?window.document:void 0;function qr(...e){let t,i,s,d;if(BG(e[0])||Array.isArray(e[0])?([i,s,d]=e,t=Rh):[t,i,s,d]=e,!t)return Cm;Array.isArray(i)||(i=[i]),Array.isArray(s)||(s=[s]);const p=[],_=()=>{p.forEach(M=>M()),p.length=0},o=(M,I,F,B)=>(M.addEventListener(I,F,B),()=>M.removeEventListener(I,F,B)),w=tn(()=>[Ds(t),xh(d)],([M,I])=>{_(),M&&p.push(...i.flatMap(F=>s.map(B=>o(M,F,B,I))))},{immediate:!0,flush:"post"}),C=()=>{w(),_()};return V_(C),C}let Ek=!1;function fT(e,t,i={}){const{window:s=Rh,ignore:d=[],capture:p=!0,detectIframe:_=!1}=i;if(!s)return;E2&&!Ek&&(Ek=!0,Array.from(s.document.body.children).forEach(F=>F.addEventListener("click",Cm)));let o=!0;const w=F=>d.some(B=>{if(typeof B=="string")return Array.from(s.document.querySelectorAll(B)).some(N=>N===F.target||F.composedPath().includes(N));{const N=Ds(B);return N&&(F.target===N||F.composedPath().includes(N))}}),M=[qr(s,"click",F=>{const B=Ds(e);if(!(!B||B===F.target||F.composedPath().includes(B))){if(F.detail===0&&(o=!w(F)),!o){o=!0;return}t(F)}},{passive:!0,capture:p}),qr(s,"pointerdown",F=>{const B=Ds(e);B&&(o=!F.composedPath().includes(B)&&!w(F))},{passive:!0}),_&&qr(s,"blur",F=>{var B;const N=Ds(e);((B=s.document.activeElement)==null?void 0:B.tagName)==="IFRAME"&&!(N!=null&&N.contains(s.document.activeElement))&&t(F)})].filter(Boolean);return()=>M.forEach(F=>F())}function WG(e={}){var t;const{window:i=Rh}=e,s=(t=e.document)!=null?t:i==null?void 0:i.document,d=UG(()=>null,()=>s==null?void 0:s.activeElement);return i&&(qr(i,"blur",p=>{p.relatedTarget===null&&d.trigger()},!0),qr(i,"focus",d.trigger,!0)),d}function aO(e,t=!1){const i=we(),s=()=>i.value=!!e();return s(),hT(s,t),i}function qG(e){return JSON.parse(JSON.stringify(e))}const Mk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ik="__vueuse_ssr_handlers__";Mk[Ik]=Mk[Ik]||{};function KG(e,t,{window:i=Rh,initialValue:s=""}={}){const d=we(s),p=te(()=>{var _;return Ds(t)||((_=i==null?void 0:i.document)==null?void 0:_.documentElement)});return tn([p,()=>xh(e)],([_,o])=>{var w;if(_&&i){const C=(w=i.getComputedStyle(_).getPropertyValue(o))==null?void 0:w.trim();d.value=C||s}},{immediate:!0}),tn(d,_=>{var o;(o=p.value)!=null&&o.style&&p.value.style.setProperty(xh(e),_)}),d}function ZG({document:e=GG}={}){if(!e)return we("visible");const t=we(e.visibilityState);return qr(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var Ak=Object.getOwnPropertySymbols,YG=Object.prototype.hasOwnProperty,XG=Object.prototype.propertyIsEnumerable,JG=(e,t)=>{var i={};for(var s in e)YG.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&Ak)for(var s of Ak(e))t.indexOf(s)<0&&XG.call(e,s)&&(i[s]=e[s]);return i};function Mi(e,t,i={}){const s=i,{window:d=Rh}=s,p=JG(s,["window"]);let _;const o=aO(()=>d&&"ResizeObserver"in d),w=()=>{_&&(_.disconnect(),_=void 0)},C=tn(()=>Ds(e),I=>{w(),o.value&&d&&I&&(_=new ResizeObserver(t),_.observe(I,p))},{immediate:!0,flush:"post"}),M=()=>{w(),C()};return V_(M),{isSupported:o,stop:M}}function kk(e,t={}){const{reset:i=!0,windowResize:s=!0,windowScroll:d=!0,immediate:p=!0}=t,_=we(0),o=we(0),w=we(0),C=we(0),M=we(0),I=we(0),F=we(0),B=we(0);function N(){const D=Ds(e);if(!D){i&&(_.value=0,o.value=0,w.value=0,C.value=0,M.value=0,I.value=0,F.value=0,B.value=0);return}const j=D.getBoundingClientRect();_.value=j.height,o.value=j.bottom,w.value=j.left,C.value=j.right,M.value=j.top,I.value=j.width,F.value=j.x,B.value=j.y}return Mi(e,N),tn(()=>Ds(e),D=>!D&&N()),d&&qr("scroll",N,{capture:!0,passive:!0}),s&&qr("resize",N,{passive:!0}),hT(()=>{p&&N()}),{height:_,bottom:o,left:w,right:C,top:M,width:I,x:F,y:B,update:N}}var Pk=Object.getOwnPropertySymbols,QG=Object.prototype.hasOwnProperty,eW=Object.prototype.propertyIsEnumerable,tW=(e,t)=>{var i={};for(var s in e)QG.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&Pk)for(var s of Pk(e))t.indexOf(s)<0&&eW.call(e,s)&&(i[s]=e[s]);return i};function sO(e,t,i={}){const s=i,{window:d=Rh}=s,p=tW(s,["window"]);let _;const o=aO(()=>d&&"MutationObserver"in d),w=()=>{_&&(_.disconnect(),_=void 0)},C=tn(()=>Ds(e),I=>{w(),o.value&&d&&I&&(_=new MutationObserver(t),_.observe(I,p))},{immediate:!0}),M=()=>{w(),C()};return V_(M),{isSupported:o,stop:M}}var Rk;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Rk||(Rk={}));var nW=Object.defineProperty,Lk=Object.getOwnPropertySymbols,oW=Object.prototype.hasOwnProperty,rW=Object.prototype.propertyIsEnumerable,Ok=(e,t,i)=>t in e?nW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,iW=(e,t)=>{for(var i in t||(t={}))oW.call(t,i)&&Ok(e,i,t[i]);if(Lk)for(var i of Lk(t))rW.call(t,i)&&Ok(e,i,t[i]);return e};const aW={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};iW({linear:VG},aW);function lO(e,t,i,s={}){var d,p,_;const{clone:o=!1,passive:w=!1,eventName:C,deep:M=!1,defaultValue:I}=s,F=jo(),B=i||(F==null?void 0:F.emit)||((d=F==null?void 0:F.$emit)==null?void 0:d.bind(F))||((_=(p=F==null?void 0:F.proxy)==null?void 0:p.$emit)==null?void 0:_.bind(F==null?void 0:F.proxy));let N=C;t||(t="modelValue"),N=C||N||`update:${t.toString()}`;const D=U=>o?C2(o)?o(U):qG(U):U,j=()=>FG(e[t])?D(e[t]):I;if(w){const U=j(),ne=we(U);return tn(()=>e[t],K=>ne.value=D(K)),tn(ne,K=>{(K!==e[t]||M)&&B(N,K)},{deep:M}),ne}else return te({get(){return j()},set(U){B(N,U)}})}function sW({window:e=Rh}={}){if(!e)return we(!1);const t=we(e.document.hasFocus());return qr(e,"blur",()=>{t.value=!1}),qr(e,"focus",()=>{t.value=!0}),t}function lW(e={}){const{window:t=Rh,initialWidth:i=1/0,initialHeight:s=1/0,listenOrientation:d=!0,includeScrollbar:p=!0}=e,_=we(i),o=we(s),w=()=>{t&&(p?(_.value=t.innerWidth,o.value=t.innerHeight):(_.value=t.document.documentElement.clientWidth,o.value=t.document.documentElement.clientHeight))};return w(),hT(w),qr("resize",w,{passive:!0}),d&&qr("orientationchange",w,{passive:!0}),{width:_,height:o}}class cW extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function ha(e,t){throw new cW(`[${e}] ${t}`)}const Dk={current:0},zk=we(0),cO=2e3,Fk=Symbol("elZIndexContextKey"),uO=Symbol("zIndexContextKey"),qm=e=>{const t=jo()?Un(Fk,Dk):Dk,i=e||(jo()?Un(uO,void 0):void 0),s=te(()=>{const _=y(i);return ao(_)?_:cO}),d=te(()=>s.value+zk.value),p=()=>(t.current++,zk.value=t.current,d.value);return!gr&&Un(Fk),{initialZIndex:s,currentZIndex:d,nextZIndex:p}};var uW={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const dW=e=>(t,i)=>hW(t,i,y(e)),hW=(e,t,i)=>Ji(i,e,e).replace(/\{(\w+)\}/g,(s,d)=>{var p;return`${(p=t==null?void 0:t[d])!=null?p:`{${d}}`}`}),fW=e=>{const t=te(()=>y(e).name),i=vi(e)?e:we(e);return{lang:t,locale:i,t:dW(e)}},dO=Symbol("localeContextKey"),vr=e=>{const t=e||Un(dO,we());return fW(te(()=>t.value||uW))},hO="__epPropKey",ut=e=>e,pW=e=>Vo(e)&&!!e[hO],nu=(e,t)=>{if(!Vo(e)||pW(e))return e;const{values:i,required:s,default:d,type:p,validator:_}=e,w={type:p,required:!!s,validator:i||_?C=>{let M=!1,I=[];if(i&&(I=Array.from(i),Tr(e,"default")&&I.push(d),M||(M=I.includes(C))),_&&(M||(M=_(C))),!M&&I.length>0){const F=[...new Set(I)].map(B=>JSON.stringify(B)).join(", ");N6(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${F}], got value ${JSON.stringify(C)}.`)}return M}:void 0,[hO]:!0};return Tr(e,"default")&&(w.default=d),w},vn=e=>g_(Object.entries(e).map(([t,i])=>[t,nu(i,t)])),Lu=["","default","small","large"],ia=nu({type:String,values:Lu,required:!1}),fO=Symbol("size"),pO=()=>{const e=Un(fO,{});return te(()=>y(e.size)||"")},mO=Symbol("emptyValuesContextKey"),mW=["",void 0,null],gW=void 0,Km=vn({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>Qn(e)?!e():!e}}),m1=(e,t)=>{const i=jo()?Un(mO,we({})):we({}),s=te(()=>e.emptyValues||i.value.emptyValues||mW),d=te(()=>Qn(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:Qn(i.value.valueOnClear)?i.value.valueOnClear():i.value.valueOnClear!==void 0?i.value.valueOnClear:t!==void 0?t:gW),p=_=>s.value.includes(_);return s.value.includes(d.value),{emptyValues:s,valueOnClear:d,isEmptyValue:p}},Em=e=>Object.keys(e),gO=e=>Object.entries(e),Y0=(e,t,i)=>({get value(){return Ji(e,t,i)},set value(s){SG(e,t,s)}}),Ib=we();function g1(e,t=void 0){const i=jo()?Un(mL,Ib):Ib;return e?te(()=>{var s,d;return(d=(s=i.value)==null?void 0:s[e])!=null?d:t}):i}function v1(e,t){const i=g1(),s=rn(e,te(()=>{var o;return((o=i.value)==null?void 0:o.namespace)||Yv})),d=vr(te(()=>{var o;return(o=i.value)==null?void 0:o.locale})),p=qm(te(()=>{var o;return((o=i.value)==null?void 0:o.zIndex)||cO})),_=te(()=>{var o;return y(t)||((o=i.value)==null?void 0:o.size)||""});return pT(te(()=>y(i)||{})),{ns:s,locale:d,zIndex:p,size:_}}const pT=(e,t,i=!1)=>{var s;const d=!!jo(),p=d?g1():void 0,_=(s=t==null?void 0:t.provide)!=null?s:d?or:void 0;if(!_)return;const o=te(()=>{const w=y(e);return p!=null&&p.value?vW(p.value,w):w});return _(mL,o),_(dO,te(()=>o.value.locale)),_(gL,te(()=>o.value.namespace)),_(uO,te(()=>o.value.zIndex)),_(fO,{size:te(()=>o.value.size||"")}),_(mO,te(()=>({emptyValues:o.value.emptyValues,valueOnClear:o.value.valueOnClear}))),(i||!Ib.value)&&(Ib.value=o.value),o},vW=(e,t)=>{const i=[...new Set([...Em(e),...Em(t)])],s={};for(const d of i)s[d]=t[d]!==void 0?t[d]:e[d];return s},_W=(e=[])=>({version:nV,install:(i,s)=>{i[GA]||(i[GA]=!0,e.forEach(d=>i.use(d)),s&&pT(s,i,!0))}}),Fo="update:modelValue",Yr="change",Ga="input",yW=vn({zIndex:{type:ut([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),bW={scroll:({scrollTop:e,fixed:t})=>ao(e)&&ai(t),[Yr]:e=>ai(e)};var xn=(e,t)=>{const i=e.__vccOpts||e;for(const[s,d]of t)i[s]=d;return i};function xW(e,t,i,s){const d=i-t;return e/=s/2,e<1?d/2*e*e*e+t:d/2*((e-=2)*e*e+2)+t}const wh=e=>gr?window.requestAnimationFrame(e):setTimeout(e,16),Gf=e=>gr?window.cancelAnimationFrame(e):clearTimeout(e),vO=(e="")=>e.split(" ").filter(t=>!!t.trim()),nl=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},Jl=(e,t)=>{!e||!t.trim()||e.classList.add(...vO(t))},ps=(e,t)=>{!e||!t.trim()||e.classList.remove(...vO(t))},td=(e,t)=>{var i;if(!gr||!e||!t)return"";let s=Fs(t);s==="float"&&(s="cssFloat");try{const d=e.style[s];if(d)return d;const p=(i=document.defaultView)==null?void 0:i.getComputedStyle(e,"");return p?p[s]:""}catch{return e.style[s]}},_O=(e,t,i)=>{if(!(!e||!t))if(Vo(t))gO(t).forEach(([s,d])=>_O(e,s,d));else{const s=Fs(t);e.style[s]=i}};function ji(e,t="px"){if(!e)return"";if(ao(e)||AG(e))return`${e}${t}`;if(Zn(e))return e}const wW=(e,t)=>{if(!gr)return!1;const i={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],s=td(e,i);return["scroll","auto","overlay"].some(d=>s.includes(d))},mT=(e,t)=>{if(!gr)return;let i=e;for(;i;){if([window,document,document.documentElement].includes(i))return window;if(wW(i,t))return i;i=i.parentNode}return i};let A0;const yO=e=>{var t;if(!gr)return 0;if(A0!==void 0)return A0;const i=document.createElement("div");i.className=`${e}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const s=i.offsetWidth;i.style.overflow="scroll";const d=document.createElement("div");d.style.width="100%",i.appendChild(d);const p=d.offsetWidth;return(t=i.parentNode)==null||t.removeChild(i),A0=s-p,A0};function gT(e,t){if(!gr)return;if(!t){e.scrollTop=0;return}const i=[];let s=t.offsetParent;for(;s!==null&&e!==s&&e.contains(s);)i.push(s),s=s.offsetParent;const d=t.offsetTop+i.reduce((w,C)=>w+C.offsetTop,0),p=d+t.offsetHeight,_=e.scrollTop,o=_+e.clientHeight;d<_?e.scrollTop=d:p>o&&(e.scrollTop=p-e.clientHeight)}function SW(e,t,i,s,d){const p=Date.now();let _;const o=()=>{const C=Date.now()-p,M=xW(C>s?s:C,t,i,s);p1(e)?e.scrollTo(window.pageXOffset,M):e.scrollTop=M,C<s?_=wh(o):Qn(d)&&d()};return o(),()=>{_&&Gf(_)}}const Bk=(e,t)=>p1(t)?e.ownerDocument.documentElement:t,Nk=e=>p1(e)?window.scrollY:e.scrollTop,bO="ElAffix",TW=Ze({name:bO}),CW=Ze({...TW,props:yW,emits:bW,setup(e,{expose:t,emit:i}){const s=e,d=rn("affix"),p=gi(),_=gi(),o=gi(),{height:w}=lW(),{height:C,width:M,top:I,bottom:F,update:B}=kk(_,{windowScroll:!1}),N=kk(p),D=we(!1),j=we(0),U=we(0),ne=te(()=>({height:D.value?`${C.value}px`:"",width:D.value?`${M.value}px`:""})),K=te(()=>{if(!D.value)return{};const oe=s.offset?ji(s.offset):0;return{height:`${C.value}px`,width:`${M.value}px`,top:s.position==="top"?oe:"",bottom:s.position==="bottom"?oe:"",transform:U.value?`translateY(${U.value}px)`:"",zIndex:s.zIndex}}),G=()=>{if(!o.value)return;j.value=o.value instanceof Window?document.documentElement.scrollTop:o.value.scrollTop||0;const{position:oe,target:se,offset:me}=s,de=me+C.value;if(oe==="top")if(se){const ce=N.bottom.value-de;D.value=me>I.value&&N.bottom.value>0,U.value=ce<0?ce:0}else D.value=me>I.value;else if(se){const ce=w.value-N.top.value-de;D.value=w.value-me<F.value&&w.value>N.top.value,U.value=ce<0?-ce:0}else D.value=w.value-me<F.value},J=()=>{B(),i("scroll",{scrollTop:j.value,fixed:D.value})};return tn(D,oe=>i("change",oe)),No(()=>{var oe;s.target?(p.value=(oe=document.querySelector(s.target))!=null?oe:void 0,p.value||ha(bO,`Target does not exist: ${s.target}`)):p.value=document.documentElement,o.value=mT(_.value,!0),B()}),qr(o,"scroll",J),Ha(G),t({update:G,updateRoot:B}),(oe,se)=>(le(),Pe("div",{ref_key:"root",ref:_,class:he(y(d).b()),style:to(y(ne))},[Ve("div",{class:he({[y(d).m("fixed")]:D.value}),style:to(y(K))},[_t(oe.$slots,"default")],6)],6))}});var EW=xn(CW,[["__file","affix.vue"]]);const Ao=(e,t)=>{if(e.install=i=>{for(const s of[e,...Object.values(t??{})])i.component(s.name,s)},t)for(const[i,s]of Object.entries(t))e[i]=s;return e},xO=(e,t)=>(e.install=i=>{e._context=i._context,i.config.globalProperties[t]=e},e),MW=(e,t)=>(e.install=i=>{i.directive(t,e)},e),Li=e=>(e.install=jr,e),IW=Ao(EW),AW=vn({size:{type:ut([Number,String])},color:{type:String}}),kW=Ze({name:"ElIcon",inheritAttrs:!1}),PW=Ze({...kW,props:AW,setup(e){const t=e,i=rn("icon"),s=te(()=>{const{size:d,color:p}=t;return!d&&!p?{}:{fontSize:Hr(d)?void 0:ji(d),"--color":p}});return(d,p)=>(le(),Pe("i",Yo({class:y(i).b(),style:y(s)},d.$attrs),[_t(d.$slots,"default")],16))}});var RW=xn(PW,[["__file","icon.vue"]]);const Gn=Ao(RW);/*! Element Plus Icons Vue v2.3.1 */var LW=Ze({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),fd=LW,OW=Ze({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),Sh=OW,DW=Ze({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),zs=DW,zW=Ze({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),vT=zW,FW=Ze({name:"Back",__name:"back",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),Ve("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),BW=FW,NW=Ze({name:"Calendar",__name:"calendar",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),$W=NW,VW=Ze({name:"CaretRight",__name:"caret-right",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),wO=VW,UW=Ze({name:"CaretTop",__name:"caret-top",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),jW=UW,HW=Ze({name:"Check",__name:"check",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),U_=HW,GW=Ze({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),WW=GW,qW=Ze({name:"CircleCheck",__name:"circle-check",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ve("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),_T=qW,KW=Ze({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),yT=KW,ZW=Ze({name:"CircleClose",__name:"circle-close",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),Ve("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),pd=ZW,YW=Ze({name:"Clock",__name:"clock",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ve("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),Ve("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),SO=YW,XW=Ze({name:"Close",__name:"close",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),Xc=XW,JW=Ze({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),Th=JW,QW=Ze({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),Ch=QW,eq=Ze({name:"Delete",__name:"delete",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),tq=eq,nq=Ze({name:"Document",__name:"document",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),oq=nq,rq=Ze({name:"FullScreen",__name:"full-screen",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),iq=rq,aq=Ze({name:"Hide",__name:"hide",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),Ve("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),sq=aq,lq=Ze({name:"InfoFilled",__name:"info-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),bT=lq,cq=Ze({name:"Loading",__name:"loading",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Iu=cq,uq=Ze({name:"Minus",__name:"minus",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),dq=uq,hq=Ze({name:"MoreFilled",__name:"more-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),$k=hq,fq=Ze({name:"More",__name:"more",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),pq=fq,mq=Ze({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),gq=mq,vq=Ze({name:"Plus",__name:"plus",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),TO=vq,_q=Ze({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),yq=_q,bq=Ze({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),xq=bq,wq=Ze({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),Sq=wq,Tq=Ze({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),Cq=Tq,Eq=Ze({name:"Search",__name:"search",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),Mq=Eq,Iq=Ze({name:"SortDown",__name:"sort-down",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),Aq=Iq,kq=Ze({name:"SortUp",__name:"sort-up",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),Pq=kq,Rq=Ze({name:"StarFilled",__name:"star-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),k0=Rq,Lq=Ze({name:"Star",__name:"star",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),Oq=Lq,Dq=Ze({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),CO=Dq,zq=Ze({name:"View",__name:"view",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),Fq=zq,Bq=Ze({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),_1=Bq,Nq=Ze({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),EO=Nq,$q=Ze({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,i)=>(le(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ve("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),Vq=$q;const Xr=ut([String,Object,Function]),xT={Close:Xc},wT={Close:Xc,SuccessFilled:CO,InfoFilled:bT,WarningFilled:_1,CircleCloseFilled:yT},Eh={success:CO,warning:_1,error:yT,info:bT},y1={validating:Iu,success:_T,error:pd},Uq=["light","dark"],jq=vn({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Em(Eh),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:Uq,default:"light"}}),Hq={close:e=>e instanceof MouseEvent},Gq=Ze({name:"ElAlert"}),Wq=Ze({...Gq,props:jq,emits:Hq,setup(e,{emit:t}){const i=e,{Close:s}=wT,d=aa(),p=rn("alert"),_=we(!0),o=te(()=>Eh[i.type]),w=te(()=>[p.e("icon"),{[p.is("big")]:!!i.description||!!d.default}]),C=te(()=>({"with-description":i.description||d.default})),M=I=>{_.value=!1,t("close",I)};return(I,F)=>(le(),Rt(Ea,{name:y(p).b("fade"),persisted:""},{default:at(()=>[zo(Ve("div",{class:he([y(p).b(),y(p).m(I.type),y(p).is("center",I.center),y(p).is(I.effect)]),role:"alert"},[I.showIcon&&y(o)?(le(),Rt(y(Gn),{key:0,class:he(y(w))},{default:at(()=>[(le(),Rt(Wo(y(o))))]),_:1},8,["class"])):St("v-if",!0),Ve("div",{class:he(y(p).e("content"))},[I.title||I.$slots.title?(le(),Pe("span",{key:0,class:he([y(p).e("title"),y(C)])},[_t(I.$slots,"title",{},()=>[Qo(yn(I.title),1)])],2)):St("v-if",!0),I.$slots.default||I.description?(le(),Pe("p",{key:1,class:he(y(p).e("description"))},[_t(I.$slots,"default",{},()=>[Qo(yn(I.description),1)])],2)):St("v-if",!0),I.closable?(le(),Pe(eo,{key:2},[I.closeText?(le(),Pe("div",{key:0,class:he([y(p).e("close-btn"),y(p).is("customed")]),onClick:M},yn(I.closeText),3)):(le(),Rt(y(Gn),{key:1,class:he(y(p).e("close-btn")),onClick:M},{default:at(()=>[Qe(y(s))]),_:1},8,["class"]))],64)):St("v-if",!0)],2)],2),[[Cr,_.value]])]),_:3},8,["name"]))}});var qq=xn(Wq,[["__file","alert.vue"]]);const Kq=Ao(qq),b1=()=>gr&&/firefox/i.test(window.navigator.userAgent);let Nc;const Zq=`
  height:0 !important;
  visibility:hidden !important;
  ${b1()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Yq=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Xq(e){const t=window.getComputedStyle(e),i=t.getPropertyValue("box-sizing"),s=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),d=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:Yq.map(_=>`${_}:${t.getPropertyValue(_)}`).join(";"),paddingSize:s,borderSize:d,boxSizing:i}}function Vk(e,t=1,i){var s;Nc||(Nc=document.createElement("textarea"),document.body.appendChild(Nc));const{paddingSize:d,borderSize:p,boxSizing:_,contextStyle:o}=Xq(e);Nc.setAttribute("style",`${o};${Zq}`),Nc.value=e.value||e.placeholder||"";let w=Nc.scrollHeight;const C={};_==="border-box"?w=w+p:_==="content-box"&&(w=w-d),Nc.value="";const M=Nc.scrollHeight-d;if(ao(t)){let I=M*t;_==="border-box"&&(I=I+d+p),w=Math.max(I,w),C.minHeight=`${I}px`}if(ao(i)){let I=M*i;_==="border-box"&&(I=I+d+p),w=Math.min(I,w)}return C.height=`${w}px`,(s=Nc.parentNode)==null||s.removeChild(Nc),Nc=void 0,C}const Ri=e=>e,Jq=vn({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),Da=e=>Gc(Jq,e),ST=vn({id:{type:String,default:void 0},size:ia,disabled:Boolean,modelValue:{type:ut([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:ut([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:Xr},prefixIcon:{type:Xr},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:ut([Object,Array,String]),default:()=>Ri({})},autofocus:Boolean,rows:{type:Number,default:2},...Da(["ariaLabel"])}),Qq={[Fo]:e=>Zn(e),input:e=>Zn(e),change:e=>Zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},e9=["class","style"],t9=/^on[A-Z]/,j_=(e={})=>{const{excludeListeners:t=!1,excludeKeys:i}=e,s=te(()=>((i==null?void 0:i.value)||[]).concat(e9)),d=jo();return te(d?()=>{var p;return g_(Object.entries((p=d.proxy)==null?void 0:p.$attrs).filter(([_])=>!s.value.includes(_)&&!(t&&t9.test(_))))}:()=>({}))},Qf=Symbol("formContextKey"),Au=Symbol("formItemContextKey"),Uk={prefix:Math.floor(Math.random()*1e4),current:0},n9=Symbol("elIdInjection"),TT=()=>jo()?Un(n9,Uk):Uk,Oa=e=>{const t=TT(),i=YS();return T2(()=>y(e)||`${i.value}-id-${t.prefix}-${t.current++}`)},Ka=()=>{const e=Un(Qf,void 0),t=Un(Au,void 0);return{form:e,formItem:t}},sc=(e,{formItemContext:t,disableIdGeneration:i,disableIdManagement:s})=>{i||(i=we(!1)),s||(s=we(!1));const d=we();let p;const _=te(()=>{var o;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((o=t.inputIds)==null?void 0:o.length)<=1)});return No(()=>{p=tn([Vr(e,"id"),i],([o,w])=>{const C=o??(w?void 0:Oa().value);C!==d.value&&(t!=null&&t.removeInputId&&(d.value&&t.removeInputId(d.value),!(s!=null&&s.value)&&!w&&C&&t.addInputId(C)),d.value=C)},{immediate:!0})}),kh(()=>{p&&p(),t!=null&&t.removeInputId&&d.value&&t.removeInputId(d.value)}),{isLabeledByFormItem:_,inputId:d}},MO=e=>{const t=jo();return te(()=>{var i,s;return(s=(i=t==null?void 0:t.proxy)==null?void 0:i.$props)==null?void 0:s[e]})},na=(e,t={})=>{const i=we(void 0),s=t.prop?i:MO("size"),d=t.global?i:pO(),p=t.form?{size:void 0}:Un(Qf,void 0),_=t.formItem?{size:void 0}:Un(Au,void 0);return te(()=>s.value||y(e)||(_==null?void 0:_.size)||(p==null?void 0:p.size)||d.value||"")},Za=e=>{const t=MO("disabled"),i=Un(Qf,void 0);return te(()=>t.value||y(e)||(i==null?void 0:i.disabled)||!1)};function Lh(e,{beforeFocus:t,afterFocus:i,beforeBlur:s,afterBlur:d}={}){const p=jo(),{emit:_}=p,o=gi(),w=we(!1),C=F=>{Qn(t)&&t(F)||w.value||(w.value=!0,_("focus",F),i==null||i())},M=F=>{var B;Qn(s)&&s(F)||F.relatedTarget&&((B=o.value)!=null&&B.contains(F.relatedTarget))||(w.value=!1,_("blur",F),d==null||d())},I=()=>{var F,B;(F=o.value)!=null&&F.contains(document.activeElement)&&o.value!==document.activeElement||(B=e.value)==null||B.focus()};return tn(o,F=>{F&&F.setAttribute("tabindex","-1")}),qr(o,"focus",C,!0),qr(o,"blur",M,!0),qr(o,"click",I,!0),{isFocused:w,wrapperRef:o,handleFocus:C,handleBlur:M}}const o9=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e);function H_({afterComposition:e,emit:t}){const i=we(!1),s=o=>{t==null||t("compositionstart",o),i.value=!0},d=o=>{var w;t==null||t("compositionupdate",o);const C=(w=o.target)==null?void 0:w.value,M=C[C.length-1]||"";i.value=!o9(M)},p=o=>{t==null||t("compositionend",o),i.value&&(i.value=!1,oo(()=>e(o)))};return{isComposing:i,handleComposition:o=>{o.type==="compositionend"?p(o):d(o)},handleCompositionStart:s,handleCompositionUpdate:d,handleCompositionEnd:p}}function r9(e){let t;function i(){if(e.value==null)return;const{selectionStart:d,selectionEnd:p,value:_}=e.value;if(d==null||p==null)return;const o=_.slice(0,Math.max(0,d)),w=_.slice(Math.max(0,p));t={selectionStart:d,selectionEnd:p,value:_,beforeTxt:o,afterTxt:w}}function s(){if(e.value==null||t==null)return;const{value:d}=e.value,{beforeTxt:p,afterTxt:_,selectionStart:o}=t;if(p==null||_==null||o==null)return;let w=d.length;if(d.endsWith(_))w=d.length-_.length;else if(d.startsWith(p))w=p.length;else{const C=p[o-1],M=d.indexOf(C,o-1);M!==-1&&(w=M+1)}e.value.setSelectionRange(w,w)}return[i,s]}const i9=Ze({name:"ElInput",inheritAttrs:!1}),a9=Ze({...i9,props:ST,emits:Qq,setup(e,{expose:t,emit:i}){const s=e,d=Ph(),p=j_(),_=aa(),o=te(()=>[s.type==="textarea"?D.b():N.b(),N.m(F.value),N.is("disabled",B.value),N.is("exceed",ot.value),{[N.b("group")]:_.prepend||_.append,[N.m("prefix")]:_.prefix||s.prefixIcon,[N.m("suffix")]:_.suffix||s.suffixIcon||s.clearable||s.showPassword,[N.bm("suffix","password-clear")]:Ce.value&&ve.value,[N.b("hidden")]:s.type==="hidden"},d.class]),w=te(()=>[N.e("wrapper"),N.is("focus",me.value)]),{form:C,formItem:M}=Ka(),{inputId:I}=sc(s,{formItemContext:M}),F=na(),B=Za(),N=rn("input"),D=rn("textarea"),j=gi(),U=gi(),ne=we(!1),K=we(!1),G=we(),J=gi(s.inputStyle),oe=te(()=>j.value||U.value),{wrapperRef:se,isFocused:me,handleFocus:de,handleBlur:ce}=Lh(oe,{beforeFocus(){return B.value},afterBlur(){var yt;s.validateEvent&&((yt=M==null?void 0:M.validate)==null||yt.call(M,"blur").catch(kn=>void 0))}}),pe=te(()=>{var yt;return(yt=C==null?void 0:C.statusIcon)!=null?yt:!1}),ge=te(()=>(M==null?void 0:M.validateState)||""),Re=te(()=>ge.value&&y1[ge.value]),Je=te(()=>K.value?Fq:sq),Me=te(()=>[d.style]),xe=te(()=>[s.inputStyle,J.value,{resize:s.resize}]),Ae=te(()=>ga(s.modelValue)?"":String(s.modelValue)),Ce=te(()=>s.clearable&&!B.value&&!s.readonly&&!!Ae.value&&(me.value||ne.value)),ve=te(()=>s.showPassword&&!B.value&&!!Ae.value&&(!!Ae.value||me.value)),Ne=te(()=>s.showWordLimit&&!!s.maxlength&&(s.type==="text"||s.type==="textarea")&&!B.value&&!s.readonly&&!s.showPassword),We=te(()=>Ae.value.length),ot=te(()=>!!Ne.value&&We.value>Number(s.maxlength)),Oe=te(()=>!!_.suffix||!!s.suffixIcon||Ce.value||s.showPassword||Ne.value||!!ge.value&&pe.value),[Ct,Mt]=r9(j);Mi(U,yt=>{if(Kt(),!Ne.value||s.resize!=="both")return;const kn=yt[0],{width:qn}=kn.contentRect;G.value={right:`calc(100% - ${qn+15+6}px)`}});const zt=()=>{const{type:yt,autosize:kn}=s;if(!(!gr||yt!=="textarea"||!U.value))if(kn){const qn=Vo(kn)?kn.minRows:void 0,Co=Vo(kn)?kn.maxRows:void 0,mo=Vk(U.value,qn,Co);J.value={overflowY:"hidden",...mo},oo(()=>{U.value.offsetHeight,J.value=mo})}else J.value={minHeight:Vk(U.value).minHeight}},Kt=(yt=>{let kn=!1;return()=>{var qn;if(kn||!s.autosize)return;((qn=U.value)==null?void 0:qn.offsetParent)===null||(yt(),kn=!0)}})(zt),$t=()=>{const yt=oe.value,kn=s.formatter?s.formatter(Ae.value):Ae.value;!yt||yt.value===kn||(yt.value=kn)},Le=async yt=>{Ct();let{value:kn}=yt.target;if(s.formatter&&(kn=s.parser?s.parser(kn):kn),!At.value){if(kn===Ae.value){$t();return}i(Fo,kn),i("input",kn),await oo(),$t(),Mt()}},dn=yt=>{i("change",yt.target.value)},{isComposing:At,handleCompositionStart:Ke,handleCompositionUpdate:Be,handleCompositionEnd:Ht}=H_({emit:i,afterComposition:Le}),Ut=()=>{Ct(),K.value=!K.value,setTimeout(Mt)},Nt=()=>{var yt;return(yt=oe.value)==null?void 0:yt.focus()},Et=()=>{var yt;return(yt=oe.value)==null?void 0:yt.blur()},Gt=yt=>{ne.value=!1,i("mouseleave",yt)},ln=yt=>{ne.value=!0,i("mouseenter",yt)},bn=yt=>{i("keydown",yt)},_n=()=>{var yt;(yt=oe.value)==null||yt.select()},jn=()=>{i(Fo,""),i("change",""),i("clear"),i("input","")};return tn(()=>s.modelValue,()=>{var yt;oo(()=>zt()),s.validateEvent&&((yt=M==null?void 0:M.validate)==null||yt.call(M,"change").catch(kn=>void 0))}),tn(Ae,()=>$t()),tn(()=>s.type,async()=>{await oo(),$t(),zt()}),No(()=>{!s.formatter&&s.parser,$t(),oo(zt)}),t({input:j,textarea:U,ref:oe,textareaStyle:xe,autosize:Vr(s,"autosize"),isComposing:At,focus:Nt,blur:Et,select:_n,clear:jn,resizeTextarea:zt}),(yt,kn)=>(le(),Pe("div",{class:he([y(o),{[y(N).bm("group","append")]:yt.$slots.append,[y(N).bm("group","prepend")]:yt.$slots.prepend}]),style:to(y(Me)),onMouseenter:ln,onMouseleave:Gt},[St(" input "),yt.type!=="textarea"?(le(),Pe(eo,{key:0},[St(" prepend slot "),yt.$slots.prepend?(le(),Pe("div",{key:0,class:he(y(N).be("group","prepend"))},[_t(yt.$slots,"prepend")],2)):St("v-if",!0),Ve("div",{ref_key:"wrapperRef",ref:se,class:he(y(w))},[St(" prefix slot "),yt.$slots.prefix||yt.prefixIcon?(le(),Pe("span",{key:0,class:he(y(N).e("prefix"))},[Ve("span",{class:he(y(N).e("prefix-inner"))},[_t(yt.$slots,"prefix"),yt.prefixIcon?(le(),Rt(y(Gn),{key:0,class:he(y(N).e("icon"))},{default:at(()=>[(le(),Rt(Wo(yt.prefixIcon)))]),_:1},8,["class"])):St("v-if",!0)],2)],2)):St("v-if",!0),Ve("input",Yo({id:y(I),ref_key:"input",ref:j,class:y(N).e("inner")},y(p),{minlength:yt.minlength,maxlength:yt.maxlength,type:yt.showPassword?K.value?"text":"password":yt.type,disabled:y(B),readonly:yt.readonly,autocomplete:yt.autocomplete,tabindex:yt.tabindex,"aria-label":yt.ariaLabel,placeholder:yt.placeholder,style:yt.inputStyle,form:yt.form,autofocus:yt.autofocus,role:yt.containerRole,onCompositionstart:y(Ke),onCompositionupdate:y(Be),onCompositionend:y(Ht),onInput:Le,onChange:dn,onKeydown:bn}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),St(" suffix slot "),y(Oe)?(le(),Pe("span",{key:1,class:he(y(N).e("suffix"))},[Ve("span",{class:he(y(N).e("suffix-inner"))},[!y(Ce)||!y(ve)||!y(Ne)?(le(),Pe(eo,{key:0},[_t(yt.$slots,"suffix"),yt.suffixIcon?(le(),Rt(y(Gn),{key:0,class:he(y(N).e("icon"))},{default:at(()=>[(le(),Rt(Wo(yt.suffixIcon)))]),_:1},8,["class"])):St("v-if",!0)],64)):St("v-if",!0),y(Ce)?(le(),Rt(y(Gn),{key:1,class:he([y(N).e("icon"),y(N).e("clear")]),onMousedown:po(y(jr),["prevent"]),onClick:jn},{default:at(()=>[Qe(y(pd))]),_:1},8,["class","onMousedown"])):St("v-if",!0),y(ve)?(le(),Rt(y(Gn),{key:2,class:he([y(N).e("icon"),y(N).e("password")]),onClick:Ut},{default:at(()=>[(le(),Rt(Wo(y(Je))))]),_:1},8,["class"])):St("v-if",!0),y(Ne)?(le(),Pe("span",{key:3,class:he(y(N).e("count"))},[Ve("span",{class:he(y(N).e("count-inner"))},yn(y(We))+" / "+yn(yt.maxlength),3)],2)):St("v-if",!0),y(ge)&&y(Re)&&y(pe)?(le(),Rt(y(Gn),{key:4,class:he([y(N).e("icon"),y(N).e("validateIcon"),y(N).is("loading",y(ge)==="validating")])},{default:at(()=>[(le(),Rt(Wo(y(Re))))]),_:1},8,["class"])):St("v-if",!0)],2)],2)):St("v-if",!0)],2),St(" append slot "),yt.$slots.append?(le(),Pe("div",{key:1,class:he(y(N).be("group","append"))},[_t(yt.$slots,"append")],2)):St("v-if",!0)],64)):(le(),Pe(eo,{key:1},[St(" textarea "),Ve("textarea",Yo({id:y(I),ref_key:"textarea",ref:U,class:[y(D).e("inner"),y(N).is("focus",y(me))]},y(p),{minlength:yt.minlength,maxlength:yt.maxlength,tabindex:yt.tabindex,disabled:y(B),readonly:yt.readonly,autocomplete:yt.autocomplete,style:y(xe),"aria-label":yt.ariaLabel,placeholder:yt.placeholder,form:yt.form,autofocus:yt.autofocus,rows:yt.rows,role:yt.containerRole,onCompositionstart:y(Ke),onCompositionupdate:y(Be),onCompositionend:y(Ht),onInput:Le,onFocus:y(de),onBlur:y(ce),onChange:dn,onKeydown:bn}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),y(Ne)?(le(),Pe("span",{key:0,style:to(G.value),class:he(y(N).e("count"))},yn(y(We))+" / "+yn(yt.maxlength),7)):St("v-if",!0)],64))],38))}});var s9=xn(a9,[["__file","input.vue"]]);const fs=Ao(s9),Zp=4,IO={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},l9=({move:e,size:t,bar:i})=>({[i.size]:t,transform:`translate${i.axis}(${e}%)`}),CT=Symbol("scrollbarContextKey"),c9=vn({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),u9="Thumb",d9=Ze({__name:"thumb",props:c9,setup(e){const t=e,i=Un(CT),s=rn("scrollbar");i||ha(u9,"can not inject scrollbar context");const d=we(),p=we(),_=we({}),o=we(!1);let w=!1,C=!1,M=gr?document.onselectstart:null;const I=te(()=>IO[t.vertical?"vertical":"horizontal"]),F=te(()=>l9({size:t.size,move:t.move,bar:I.value})),B=te(()=>d.value[I.value.offset]**2/i.wrapElement[I.value.scrollSize]/t.ratio/p.value[I.value.offset]),N=oe=>{var se;if(oe.stopPropagation(),oe.ctrlKey||[1,2].includes(oe.button))return;(se=window.getSelection())==null||se.removeAllRanges(),j(oe);const me=oe.currentTarget;me&&(_.value[I.value.axis]=me[I.value.offset]-(oe[I.value.client]-me.getBoundingClientRect()[I.value.direction]))},D=oe=>{if(!p.value||!d.value||!i.wrapElement)return;const se=Math.abs(oe.target.getBoundingClientRect()[I.value.direction]-oe[I.value.client]),me=p.value[I.value.offset]/2,de=(se-me)*100*B.value/d.value[I.value.offset];i.wrapElement[I.value.scroll]=de*i.wrapElement[I.value.scrollSize]/100},j=oe=>{oe.stopImmediatePropagation(),w=!0,document.addEventListener("mousemove",U),document.addEventListener("mouseup",ne),M=document.onselectstart,document.onselectstart=()=>!1},U=oe=>{if(!d.value||!p.value||w===!1)return;const se=_.value[I.value.axis];if(!se)return;const me=(d.value.getBoundingClientRect()[I.value.direction]-oe[I.value.client])*-1,de=p.value[I.value.offset]-se,ce=(me-de)*100*B.value/d.value[I.value.offset];i.wrapElement[I.value.scroll]=ce*i.wrapElement[I.value.scrollSize]/100},ne=()=>{w=!1,_.value[I.value.axis]=0,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",ne),J(),C&&(o.value=!1)},K=()=>{C=!1,o.value=!!t.size},G=()=>{C=!0,o.value=w};ni(()=>{J(),document.removeEventListener("mouseup",ne)});const J=()=>{document.onselectstart!==M&&(document.onselectstart=M)};return qr(Vr(i,"scrollbarElement"),"mousemove",K),qr(Vr(i,"scrollbarElement"),"mouseleave",G),(oe,se)=>(le(),Rt(Ea,{name:y(s).b("fade"),persisted:""},{default:at(()=>[zo(Ve("div",{ref_key:"instance",ref:d,class:he([y(s).e("bar"),y(s).is(y(I).key)]),onMousedown:D},[Ve("div",{ref_key:"thumb",ref:p,class:he(y(s).e("thumb")),style:to(y(F)),onMousedown:N},null,38)],34),[[Cr,oe.always||o.value]])]),_:1},8,["name"]))}});var jk=xn(d9,[["__file","thumb.vue"]]);const h9=vn({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),f9=Ze({__name:"bar",props:h9,setup(e,{expose:t}){const i=e,s=Un(CT),d=we(0),p=we(0),_=we(""),o=we(""),w=we(1),C=we(1);return t({handleScroll:F=>{if(F){const B=F.offsetHeight-Zp,N=F.offsetWidth-Zp;p.value=F.scrollTop*100/B*w.value,d.value=F.scrollLeft*100/N*C.value}},update:()=>{const F=s==null?void 0:s.wrapElement;if(!F)return;const B=F.offsetHeight-Zp,N=F.offsetWidth-Zp,D=B**2/F.scrollHeight,j=N**2/F.scrollWidth,U=Math.max(D,i.minSize),ne=Math.max(j,i.minSize);w.value=D/(B-D)/(U/(B-U)),C.value=j/(N-j)/(ne/(N-ne)),o.value=U+Zp<B?`${U}px`:"",_.value=ne+Zp<N?`${ne}px`:""}}),(F,B)=>(le(),Pe(eo,null,[Qe(jk,{move:d.value,ratio:C.value,size:_.value,always:F.always},null,8,["move","ratio","size","always"]),Qe(jk,{move:p.value,ratio:w.value,size:o.value,vertical:"",always:F.always},null,8,["move","ratio","size","always"])],64))}});var p9=xn(f9,[["__file","bar.vue"]]);const m9=vn({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:ut([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...Da(["ariaLabel","ariaOrientation"])}),g9={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(ao)},v9="ElScrollbar",_9=Ze({name:v9}),y9=Ze({..._9,props:m9,emits:g9,setup(e,{expose:t,emit:i}){const s=e,d=rn("scrollbar");let p,_,o=0,w=0;const C=we(),M=we(),I=we(),F=we(),B=te(()=>{const J={};return s.height&&(J.height=ji(s.height)),s.maxHeight&&(J.maxHeight=ji(s.maxHeight)),[s.wrapStyle,J]}),N=te(()=>[s.wrapClass,d.e("wrap"),{[d.em("wrap","hidden-default")]:!s.native}]),D=te(()=>[d.e("view"),s.viewClass]),j=()=>{var J;M.value&&((J=F.value)==null||J.handleScroll(M.value),o=M.value.scrollTop,w=M.value.scrollLeft,i("scroll",{scrollTop:M.value.scrollTop,scrollLeft:M.value.scrollLeft}))};function U(J,oe){Vo(J)?M.value.scrollTo(J):ao(J)&&ao(oe)&&M.value.scrollTo(J,oe)}const ne=J=>{ao(J)&&(M.value.scrollTop=J)},K=J=>{ao(J)&&(M.value.scrollLeft=J)},G=()=>{var J;(J=F.value)==null||J.update()};return tn(()=>s.noresize,J=>{J?(p==null||p(),_==null||_()):({stop:p}=Mi(I,G),_=qr("resize",G))},{immediate:!0}),tn(()=>[s.maxHeight,s.height],()=>{s.native||oo(()=>{var J;G(),M.value&&((J=F.value)==null||J.handleScroll(M.value))})}),or(CT,Ir({scrollbarElement:C,wrapElement:M})),US(()=>{M.value&&(M.value.scrollTop=o,M.value.scrollLeft=w)}),No(()=>{s.native||oo(()=>{G()})}),Ru(()=>G()),t({wrapRef:M,update:G,scrollTo:U,setScrollTop:ne,setScrollLeft:K,handleScroll:j}),(J,oe)=>(le(),Pe("div",{ref_key:"scrollbarRef",ref:C,class:he(y(d).b())},[Ve("div",{ref_key:"wrapRef",ref:M,class:he(y(N)),style:to(y(B)),tabindex:J.tabindex,onScroll:j},[(le(),Rt(Wo(J.tag),{id:J.id,ref_key:"resizeRef",ref:I,class:he(y(D)),style:to(J.viewStyle),role:J.role,"aria-label":J.ariaLabel,"aria-orientation":J.ariaOrientation},{default:at(()=>[_t(J.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),J.native?St("v-if",!0):(le(),Rt(p9,{key:0,ref_key:"barRef",ref:F,always:J.always,"min-size":J.minSize},null,8,["always","min-size"]))],2))}});var b9=xn(y9,[["__file","scrollbar.vue"]]);const Ou=Ao(b9),ET=Symbol("popper"),AO=Symbol("popperContent"),x9=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],kO=vn({role:{type:String,values:x9,default:"tooltip"}}),w9=Ze({name:"ElPopper",inheritAttrs:!1}),S9=Ze({...w9,props:kO,setup(e,{expose:t}){const i=e,s=we(),d=we(),p=we(),_=we(),o=te(()=>i.role),w={triggerRef:s,popperInstanceRef:d,contentRef:p,referenceRef:_,role:o};return t(w),or(ET,w),(C,M)=>_t(C.$slots,"default")}});var T9=xn(S9,[["__file","popper.vue"]]);const PO=vn({arrowOffset:{type:Number,default:5}}),C9=Ze({name:"ElPopperArrow",inheritAttrs:!1}),E9=Ze({...C9,props:PO,setup(e,{expose:t}){const i=e,s=rn("popper"),{arrowOffset:d,arrowRef:p,arrowStyle:_}=Un(AO,void 0);return tn(()=>i.arrowOffset,o=>{d.value=o}),ni(()=>{p.value=void 0}),t({arrowRef:p}),(o,w)=>(le(),Pe("span",{ref_key:"arrowRef",ref:p,class:he(y(s).e("arrow")),style:to(y(_)),"data-popper-arrow":""},null,6))}});var M9=xn(E9,[["__file","arrow.vue"]]);const RO=vn({virtualRef:{type:ut(Object)},virtualTriggering:Boolean,onMouseenter:{type:ut(Function)},onMouseleave:{type:ut(Function)},onClick:{type:ut(Function)},onKeydown:{type:ut(Function)},onFocus:{type:ut(Function)},onBlur:{type:ut(Function)},onContextmenu:{type:ut(Function)},id:String,open:Boolean}),LO=Symbol("elForwardRef"),I9=e=>{or(LO,{setForwardRef:i=>{e.value=i}})},A9=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),k9='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',P9=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,Hk=e=>Array.from(e.querySelectorAll(k9)).filter(t=>M2(t)&&P9(t)),M2=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},X0=function(e,t,...i){let s;t.includes("mouse")||t.includes("click")?s="MouseEvents":t.includes("key")?s="KeyboardEvent":s="HTMLEvents";const d=document.createEvent(s);return d.initEvent(t,...i),e.dispatchEvent(d),e},OO=e=>!e.getAttribute("aria-owns"),DO=(e,t,i)=>{const{parentNode:s}=e;if(!s)return null;const d=s.querySelectorAll(i),p=Array.prototype.indexOf.call(d,e);return d[p+t]||null},J0=e=>{e&&(e.focus(),!OO(e)&&e.click())},R9="ElOnlyChild",zO=Ze({name:R9,setup(e,{slots:t,attrs:i}){var s;const d=Un(LO),p=A9((s=d==null?void 0:d.setForwardRef)!=null?s:jr);return()=>{var _;const o=(_=t.default)==null?void 0:_.call(t,i);if(!o||o.length>1)return null;const w=FO(o);return w?zo(id(w,i),[[p]]):null}}});function FO(e){if(!e)return null;const t=e;for(const i of t){if(Vo(i))switch(i.type){case Sa:continue;case Um:case"svg":return Gk(i);case eo:return FO(i.children);default:return i}return Gk(i)}return null}function Gk(e){const t=rn("only-child");return Qe("span",{class:t.e("content")},[e])}const L9=Ze({name:"ElPopperTrigger",inheritAttrs:!1}),O9=Ze({...L9,props:RO,setup(e,{expose:t}){const i=e,{role:s,triggerRef:d}=Un(ET,void 0);I9(d);const p=te(()=>o.value?i.id:void 0),_=te(()=>{if(s&&s.value==="tooltip")return i.open&&i.id?i.id:void 0}),o=te(()=>{if(s&&s.value!=="tooltip")return s.value}),w=te(()=>o.value?`${i.open}`:void 0);let C;const M=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return No(()=>{tn(()=>i.virtualRef,I=>{I&&(d.value=Ds(I))},{immediate:!0}),tn(d,(I,F)=>{C==null||C(),C=void 0,El(I)&&(M.forEach(B=>{var N;const D=i[B];D&&(I.addEventListener(B.slice(2).toLowerCase(),D),(N=F==null?void 0:F.removeEventListener)==null||N.call(F,B.slice(2).toLowerCase(),D))}),M2(I)&&(C=tn([p,_,o,w],B=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((N,D)=>{ga(B[D])?I.removeAttribute(N):I.setAttribute(N,B[D])})},{immediate:!0}))),El(F)&&M2(F)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(B=>F.removeAttribute(B))},{immediate:!0})}),ni(()=>{if(C==null||C(),C=void 0,d.value&&El(d.value)){const I=d.value;M.forEach(F=>{const B=i[F];B&&I.removeEventListener(F.slice(2).toLowerCase(),B)}),d.value=void 0}}),t({triggerRef:d}),(I,F)=>I.virtualTriggering?St("v-if",!0):(le(),Rt(y(zO),Yo({key:0},I.$attrs,{"aria-controls":y(p),"aria-describedby":y(_),"aria-expanded":y(w),"aria-haspopup":y(o)}),{default:at(()=>[_t(I.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var D9=xn(O9,[["__file","trigger.vue"]]);const Lw="focus-trap.focus-after-trapped",Ow="focus-trap.focus-after-released",z9="focus-trap.focusout-prevented",Wk={cancelable:!0,bubbles:!1},F9={cancelable:!0,bubbles:!1},qk="focusAfterTrapped",Kk="focusAfterReleased",MT=Symbol("elFocusTrap"),IT=we(),x1=we(0),AT=we(0);let P0=0;const BO=e=>{const t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const d=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||d?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t},Zk=(e,t)=>{for(const i of e)if(!B9(i,t))return i},B9=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},N9=e=>{const t=BO(e),i=Zk(t,e),s=Zk(t.reverse(),e);return[i,s]},$9=e=>e instanceof HTMLInputElement&&"select"in e,rh=(e,t)=>{if(e&&e.focus){const i=document.activeElement;e.focus({preventScroll:!0}),AT.value=window.performance.now(),e!==i&&$9(e)&&t&&e.select()}};function Yk(e,t){const i=[...e],s=e.indexOf(t);return s!==-1&&i.splice(s,1),i}const V9=()=>{let e=[];return{push:s=>{const d=e[0];d&&s!==d&&d.pause(),e=Yk(e,s),e.unshift(s)},remove:s=>{var d,p;e=Yk(e,s),(p=(d=e[0])==null?void 0:d.resume)==null||p.call(d)}}},U9=(e,t=!1)=>{const i=document.activeElement;for(const s of e)if(rh(s,t),document.activeElement!==i)return},Xk=V9(),j9=()=>x1.value>AT.value,R0=()=>{IT.value="pointer",x1.value=window.performance.now()},Jk=()=>{IT.value="keyboard",x1.value=window.performance.now()},H9=()=>(No(()=>{P0===0&&(document.addEventListener("mousedown",R0),document.addEventListener("touchstart",R0),document.addEventListener("keydown",Jk)),P0++}),ni(()=>{P0--,P0<=0&&(document.removeEventListener("mousedown",R0),document.removeEventListener("touchstart",R0),document.removeEventListener("keydown",Jk))}),{focusReason:IT,lastUserFocusTimestamp:x1,lastAutomatedFocusTimestamp:AT}),L0=e=>new CustomEvent(z9,{...F9,detail:e}),Ln={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};let nm=[];const Qk=e=>{e.code===Ln.esc&&nm.forEach(t=>t(e))},G9=e=>{No(()=>{nm.length===0&&document.addEventListener("keydown",Qk),gr&&nm.push(e)}),ni(()=>{nm=nm.filter(t=>t!==e),nm.length===0&&gr&&document.removeEventListener("keydown",Qk)})},W9=Ze({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[qk,Kk,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const i=we();let s,d;const{focusReason:p}=H9();G9(N=>{e.trapped&&!_.paused&&t("release-requested",N)});const _={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},o=N=>{if(!e.loop&&!e.trapped||_.paused)return;const{code:D,altKey:j,ctrlKey:U,metaKey:ne,currentTarget:K,shiftKey:G}=N,{loop:J}=e,oe=D===Ln.tab&&!j&&!U&&!ne,se=document.activeElement;if(oe&&se){const me=K,[de,ce]=N9(me);if(de&&ce){if(!G&&se===ce){const ge=L0({focusReason:p.value});t("focusout-prevented",ge),ge.defaultPrevented||(N.preventDefault(),J&&rh(de,!0))}else if(G&&[de,me].includes(se)){const ge=L0({focusReason:p.value});t("focusout-prevented",ge),ge.defaultPrevented||(N.preventDefault(),J&&rh(ce,!0))}}else if(se===me){const ge=L0({focusReason:p.value});t("focusout-prevented",ge),ge.defaultPrevented||N.preventDefault()}}};or(MT,{focusTrapRef:i,onKeydown:o}),tn(()=>e.focusTrapEl,N=>{N&&(i.value=N)},{immediate:!0}),tn([i],([N],[D])=>{N&&(N.addEventListener("keydown",o),N.addEventListener("focusin",M),N.addEventListener("focusout",I)),D&&(D.removeEventListener("keydown",o),D.removeEventListener("focusin",M),D.removeEventListener("focusout",I))});const w=N=>{t(qk,N)},C=N=>t(Kk,N),M=N=>{const D=y(i);if(!D)return;const j=N.target,U=N.relatedTarget,ne=j&&D.contains(j);e.trapped||U&&D.contains(U)||(s=U),ne&&t("focusin",N),!_.paused&&e.trapped&&(ne?d=j:rh(d,!0))},I=N=>{const D=y(i);if(!(_.paused||!D))if(e.trapped){const j=N.relatedTarget;!ga(j)&&!D.contains(j)&&setTimeout(()=>{if(!_.paused&&e.trapped){const U=L0({focusReason:p.value});t("focusout-prevented",U),U.defaultPrevented||rh(d,!0)}},0)}else{const j=N.target;j&&D.contains(j)||t("focusout",N)}};async function F(){await oo();const N=y(i);if(N){Xk.push(_);const D=N.contains(document.activeElement)?s:document.activeElement;if(s=D,!N.contains(D)){const U=new Event(Lw,Wk);N.addEventListener(Lw,w),N.dispatchEvent(U),U.defaultPrevented||oo(()=>{let ne=e.focusStartEl;Zn(ne)||(rh(ne),document.activeElement!==ne&&(ne="first")),ne==="first"&&U9(BO(N),!0),(document.activeElement===D||ne==="container")&&rh(N)})}}}function B(){const N=y(i);if(N){N.removeEventListener(Lw,w);const D=new CustomEvent(Ow,{...Wk,detail:{focusReason:p.value}});N.addEventListener(Ow,C),N.dispatchEvent(D),!D.defaultPrevented&&(p.value=="keyboard"||!j9()||N.contains(document.activeElement))&&rh(s??document.body),N.removeEventListener(Ow,C),Xk.remove(_)}}return No(()=>{e.trapped&&F(),tn(()=>e.trapped,N=>{N?F():B()})}),ni(()=>{e.trapped&&B(),i.value&&(i.value.removeEventListener("keydown",o),i.value.removeEventListener("focusin",M),i.value.removeEventListener("focusout",I),i.value=void 0)}),{onKeydown:o}}});function q9(e,t,i,s,d,p){return _t(e.$slots,"default",{handleKeydown:e.onKeydown})}var Zm=xn(W9,[["render",q9],["__file","focus-trap.vue"]]),ol="top",rc="bottom",ic="right",rl="left",kT="auto",G_=[ol,rc,ic,rl],Mm="start",v_="end",K9="clippingParents",NO="viewport",Dv="popper",Z9="reference",eP=G_.reduce(function(e,t){return e.concat([t+"-"+Mm,t+"-"+v_])},[]),md=[].concat(G_,[kT]).reduce(function(e,t){return e.concat([t,t+"-"+Mm,t+"-"+v_])},[]),Y9="beforeRead",X9="read",J9="afterRead",Q9="beforeMain",e7="main",t7="afterMain",n7="beforeWrite",o7="write",r7="afterWrite",i7=[Y9,X9,J9,Q9,e7,t7,n7,o7,r7];function ku(e){return e?(e.nodeName||"").toLowerCase():null}function ou(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Im(e){var t=ou(e).Element;return e instanceof t||e instanceof Element}function tc(e){var t=ou(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function PT(e){if(typeof ShadowRoot>"u")return!1;var t=ou(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function a7(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var s=t.styles[i]||{},d=t.attributes[i]||{},p=t.elements[i];!tc(p)||!ku(p)||(Object.assign(p.style,s),Object.keys(d).forEach(function(_){var o=d[_];o===!1?p.removeAttribute(_):p.setAttribute(_,o===!0?"":o)}))})}function s7(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(s){var d=t.elements[s],p=t.attributes[s]||{},_=Object.keys(t.styles.hasOwnProperty(s)?t.styles[s]:i[s]),o=_.reduce(function(w,C){return w[C]="",w},{});!tc(d)||!ku(d)||(Object.assign(d.style,o),Object.keys(p).forEach(function(w){d.removeAttribute(w)}))})}}var $O={name:"applyStyles",enabled:!0,phase:"write",fn:a7,effect:s7,requires:["computeStyles"]};function Cu(e){return e.split("-")[0]}var Ff=Math.max,Ab=Math.min,Am=Math.round;function km(e,t){t===void 0&&(t=!1);var i=e.getBoundingClientRect(),s=1,d=1;if(tc(e)&&t){var p=e.offsetHeight,_=e.offsetWidth;_>0&&(s=Am(i.width)/_||1),p>0&&(d=Am(i.height)/p||1)}return{width:i.width/s,height:i.height/d,top:i.top/d,right:i.right/s,bottom:i.bottom/d,left:i.left/s,x:i.left/s,y:i.top/d}}function RT(e){var t=km(e),i=e.offsetWidth,s=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-s)<=1&&(s=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:s}}function VO(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&PT(i)){var s=t;do{if(s&&e.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function ad(e){return ou(e).getComputedStyle(e)}function l7(e){return["table","td","th"].indexOf(ku(e))>=0}function Oh(e){return((Im(e)?e.ownerDocument:e.document)||window.document).documentElement}function w1(e){return ku(e)==="html"?e:e.assignedSlot||e.parentNode||(PT(e)?e.host:null)||Oh(e)}function tP(e){return!tc(e)||ad(e).position==="fixed"?null:e.offsetParent}function c7(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,i=navigator.userAgent.indexOf("Trident")!==-1;if(i&&tc(e)){var s=ad(e);if(s.position==="fixed")return null}var d=w1(e);for(PT(d)&&(d=d.host);tc(d)&&["html","body"].indexOf(ku(d))<0;){var p=ad(d);if(p.transform!=="none"||p.perspective!=="none"||p.contain==="paint"||["transform","perspective"].indexOf(p.willChange)!==-1||t&&p.willChange==="filter"||t&&p.filter&&p.filter!=="none")return d;d=d.parentNode}return null}function W_(e){for(var t=ou(e),i=tP(e);i&&l7(i)&&ad(i).position==="static";)i=tP(i);return i&&(ku(i)==="html"||ku(i)==="body"&&ad(i).position==="static")?t:i||c7(e)||t}function LT(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Jv(e,t,i){return Ff(e,Ab(t,i))}function u7(e,t,i){var s=Jv(e,t,i);return s>i?i:s}function UO(){return{top:0,right:0,bottom:0,left:0}}function jO(e){return Object.assign({},UO(),e)}function HO(e,t){return t.reduce(function(i,s){return i[s]=e,i},{})}var d7=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,jO(typeof e!="number"?e:HO(e,G_))};function h7(e){var t,i=e.state,s=e.name,d=e.options,p=i.elements.arrow,_=i.modifiersData.popperOffsets,o=Cu(i.placement),w=LT(o),C=[rl,ic].indexOf(o)>=0,M=C?"height":"width";if(!(!p||!_)){var I=d7(d.padding,i),F=RT(p),B=w==="y"?ol:rl,N=w==="y"?rc:ic,D=i.rects.reference[M]+i.rects.reference[w]-_[w]-i.rects.popper[M],j=_[w]-i.rects.reference[w],U=W_(p),ne=U?w==="y"?U.clientHeight||0:U.clientWidth||0:0,K=D/2-j/2,G=I[B],J=ne-F[M]-I[N],oe=ne/2-F[M]/2+K,se=Jv(G,oe,J),me=w;i.modifiersData[s]=(t={},t[me]=se,t.centerOffset=se-oe,t)}}function f7(e){var t=e.state,i=e.options,s=i.element,d=s===void 0?"[data-popper-arrow]":s;d!=null&&(typeof d=="string"&&(d=t.elements.popper.querySelector(d),!d)||!VO(t.elements.popper,d)||(t.elements.arrow=d))}var p7={name:"arrow",enabled:!0,phase:"main",fn:h7,effect:f7,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Pm(e){return e.split("-")[1]}var m7={top:"auto",right:"auto",bottom:"auto",left:"auto"};function g7(e){var t=e.x,i=e.y,s=window,d=s.devicePixelRatio||1;return{x:Am(t*d)/d||0,y:Am(i*d)/d||0}}function nP(e){var t,i=e.popper,s=e.popperRect,d=e.placement,p=e.variation,_=e.offsets,o=e.position,w=e.gpuAcceleration,C=e.adaptive,M=e.roundOffsets,I=e.isFixed,F=_.x,B=F===void 0?0:F,N=_.y,D=N===void 0?0:N,j=typeof M=="function"?M({x:B,y:D}):{x:B,y:D};B=j.x,D=j.y;var U=_.hasOwnProperty("x"),ne=_.hasOwnProperty("y"),K=rl,G=ol,J=window;if(C){var oe=W_(i),se="clientHeight",me="clientWidth";if(oe===ou(i)&&(oe=Oh(i),ad(oe).position!=="static"&&o==="absolute"&&(se="scrollHeight",me="scrollWidth")),oe=oe,d===ol||(d===rl||d===ic)&&p===v_){G=rc;var de=I&&oe===J&&J.visualViewport?J.visualViewport.height:oe[se];D-=de-s.height,D*=w?1:-1}if(d===rl||(d===ol||d===rc)&&p===v_){K=ic;var ce=I&&oe===J&&J.visualViewport?J.visualViewport.width:oe[me];B-=ce-s.width,B*=w?1:-1}}var pe=Object.assign({position:o},C&&m7),ge=M===!0?g7({x:B,y:D}):{x:B,y:D};if(B=ge.x,D=ge.y,w){var Re;return Object.assign({},pe,(Re={},Re[G]=ne?"0":"",Re[K]=U?"0":"",Re.transform=(J.devicePixelRatio||1)<=1?"translate("+B+"px, "+D+"px)":"translate3d("+B+"px, "+D+"px, 0)",Re))}return Object.assign({},pe,(t={},t[G]=ne?D+"px":"",t[K]=U?B+"px":"",t.transform="",t))}function v7(e){var t=e.state,i=e.options,s=i.gpuAcceleration,d=s===void 0?!0:s,p=i.adaptive,_=p===void 0?!0:p,o=i.roundOffsets,w=o===void 0?!0:o,C={placement:Cu(t.placement),variation:Pm(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:d,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,nP(Object.assign({},C,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:_,roundOffsets:w})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,nP(Object.assign({},C,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:w})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var GO={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:v7,data:{}},O0={passive:!0};function _7(e){var t=e.state,i=e.instance,s=e.options,d=s.scroll,p=d===void 0?!0:d,_=s.resize,o=_===void 0?!0:_,w=ou(t.elements.popper),C=[].concat(t.scrollParents.reference,t.scrollParents.popper);return p&&C.forEach(function(M){M.addEventListener("scroll",i.update,O0)}),o&&w.addEventListener("resize",i.update,O0),function(){p&&C.forEach(function(M){M.removeEventListener("scroll",i.update,O0)}),o&&w.removeEventListener("resize",i.update,O0)}}var WO={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:_7,data:{}},y7={left:"right",right:"left",bottom:"top",top:"bottom"};function Q0(e){return e.replace(/left|right|bottom|top/g,function(t){return y7[t]})}var b7={start:"end",end:"start"};function oP(e){return e.replace(/start|end/g,function(t){return b7[t]})}function OT(e){var t=ou(e),i=t.pageXOffset,s=t.pageYOffset;return{scrollLeft:i,scrollTop:s}}function DT(e){return km(Oh(e)).left+OT(e).scrollLeft}function x7(e){var t=ou(e),i=Oh(e),s=t.visualViewport,d=i.clientWidth,p=i.clientHeight,_=0,o=0;return s&&(d=s.width,p=s.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(_=s.offsetLeft,o=s.offsetTop)),{width:d,height:p,x:_+DT(e),y:o}}function w7(e){var t,i=Oh(e),s=OT(e),d=(t=e.ownerDocument)==null?void 0:t.body,p=Ff(i.scrollWidth,i.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),_=Ff(i.scrollHeight,i.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),o=-s.scrollLeft+DT(e),w=-s.scrollTop;return ad(d||i).direction==="rtl"&&(o+=Ff(i.clientWidth,d?d.clientWidth:0)-p),{width:p,height:_,x:o,y:w}}function zT(e){var t=ad(e),i=t.overflow,s=t.overflowX,d=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+d+s)}function qO(e){return["html","body","#document"].indexOf(ku(e))>=0?e.ownerDocument.body:tc(e)&&zT(e)?e:qO(w1(e))}function Qv(e,t){var i;t===void 0&&(t=[]);var s=qO(e),d=s===((i=e.ownerDocument)==null?void 0:i.body),p=ou(s),_=d?[p].concat(p.visualViewport||[],zT(s)?s:[]):s,o=t.concat(_);return d?o:o.concat(Qv(w1(_)))}function I2(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function S7(e){var t=km(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function rP(e,t){return t===NO?I2(x7(e)):Im(t)?S7(t):I2(w7(Oh(e)))}function T7(e){var t=Qv(w1(e)),i=["absolute","fixed"].indexOf(ad(e).position)>=0,s=i&&tc(e)?W_(e):e;return Im(s)?t.filter(function(d){return Im(d)&&VO(d,s)&&ku(d)!=="body"}):[]}function C7(e,t,i){var s=t==="clippingParents"?T7(e):[].concat(t),d=[].concat(s,[i]),p=d[0],_=d.reduce(function(o,w){var C=rP(e,w);return o.top=Ff(C.top,o.top),o.right=Ab(C.right,o.right),o.bottom=Ab(C.bottom,o.bottom),o.left=Ff(C.left,o.left),o},rP(e,p));return _.width=_.right-_.left,_.height=_.bottom-_.top,_.x=_.left,_.y=_.top,_}function KO(e){var t=e.reference,i=e.element,s=e.placement,d=s?Cu(s):null,p=s?Pm(s):null,_=t.x+t.width/2-i.width/2,o=t.y+t.height/2-i.height/2,w;switch(d){case ol:w={x:_,y:t.y-i.height};break;case rc:w={x:_,y:t.y+t.height};break;case ic:w={x:t.x+t.width,y:o};break;case rl:w={x:t.x-i.width,y:o};break;default:w={x:t.x,y:t.y}}var C=d?LT(d):null;if(C!=null){var M=C==="y"?"height":"width";switch(p){case Mm:w[C]=w[C]-(t[M]/2-i[M]/2);break;case v_:w[C]=w[C]+(t[M]/2-i[M]/2);break}}return w}function __(e,t){t===void 0&&(t={});var i=t,s=i.placement,d=s===void 0?e.placement:s,p=i.boundary,_=p===void 0?K9:p,o=i.rootBoundary,w=o===void 0?NO:o,C=i.elementContext,M=C===void 0?Dv:C,I=i.altBoundary,F=I===void 0?!1:I,B=i.padding,N=B===void 0?0:B,D=jO(typeof N!="number"?N:HO(N,G_)),j=M===Dv?Z9:Dv,U=e.rects.popper,ne=e.elements[F?j:M],K=C7(Im(ne)?ne:ne.contextElement||Oh(e.elements.popper),_,w),G=km(e.elements.reference),J=KO({reference:G,element:U,placement:d}),oe=I2(Object.assign({},U,J)),se=M===Dv?oe:G,me={top:K.top-se.top+D.top,bottom:se.bottom-K.bottom+D.bottom,left:K.left-se.left+D.left,right:se.right-K.right+D.right},de=e.modifiersData.offset;if(M===Dv&&de){var ce=de[d];Object.keys(me).forEach(function(pe){var ge=[ic,rc].indexOf(pe)>=0?1:-1,Re=[ol,rc].indexOf(pe)>=0?"y":"x";me[pe]+=ce[Re]*ge})}return me}function E7(e,t){t===void 0&&(t={});var i=t,s=i.placement,d=i.boundary,p=i.rootBoundary,_=i.padding,o=i.flipVariations,w=i.allowedAutoPlacements,C=w===void 0?md:w,M=Pm(s),I=M?o?eP:eP.filter(function(N){return Pm(N)===M}):G_,F=I.filter(function(N){return C.indexOf(N)>=0});F.length===0&&(F=I);var B=F.reduce(function(N,D){return N[D]=__(e,{placement:D,boundary:d,rootBoundary:p,padding:_})[Cu(D)],N},{});return Object.keys(B).sort(function(N,D){return B[N]-B[D]})}function M7(e){if(Cu(e)===kT)return[];var t=Q0(e);return[oP(e),t,oP(t)]}function I7(e){var t=e.state,i=e.options,s=e.name;if(!t.modifiersData[s]._skip){for(var d=i.mainAxis,p=d===void 0?!0:d,_=i.altAxis,o=_===void 0?!0:_,w=i.fallbackPlacements,C=i.padding,M=i.boundary,I=i.rootBoundary,F=i.altBoundary,B=i.flipVariations,N=B===void 0?!0:B,D=i.allowedAutoPlacements,j=t.options.placement,U=Cu(j),ne=U===j,K=w||(ne||!N?[Q0(j)]:M7(j)),G=[j].concat(K).reduce(function(Ct,Mt){return Ct.concat(Cu(Mt)===kT?E7(t,{placement:Mt,boundary:M,rootBoundary:I,padding:C,flipVariations:N,allowedAutoPlacements:D}):Mt)},[]),J=t.rects.reference,oe=t.rects.popper,se=new Map,me=!0,de=G[0],ce=0;ce<G.length;ce++){var pe=G[ce],ge=Cu(pe),Re=Pm(pe)===Mm,Je=[ol,rc].indexOf(ge)>=0,Me=Je?"width":"height",xe=__(t,{placement:pe,boundary:M,rootBoundary:I,altBoundary:F,padding:C}),Ae=Je?Re?ic:rl:Re?rc:ol;J[Me]>oe[Me]&&(Ae=Q0(Ae));var Ce=Q0(Ae),ve=[];if(p&&ve.push(xe[ge]<=0),o&&ve.push(xe[Ae]<=0,xe[Ce]<=0),ve.every(function(Ct){return Ct})){de=pe,me=!1;break}se.set(pe,ve)}if(me)for(var Ne=N?3:1,We=function(Ct){var Mt=G.find(function(zt){var bt=se.get(zt);if(bt)return bt.slice(0,Ct).every(function(Kt){return Kt})});if(Mt)return de=Mt,"break"},ot=Ne;ot>0;ot--){var Oe=We(ot);if(Oe==="break")break}t.placement!==de&&(t.modifiersData[s]._skip=!0,t.placement=de,t.reset=!0)}}var A7={name:"flip",enabled:!0,phase:"main",fn:I7,requiresIfExists:["offset"],data:{_skip:!1}};function iP(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function aP(e){return[ol,ic,rc,rl].some(function(t){return e[t]>=0})}function k7(e){var t=e.state,i=e.name,s=t.rects.reference,d=t.rects.popper,p=t.modifiersData.preventOverflow,_=__(t,{elementContext:"reference"}),o=__(t,{altBoundary:!0}),w=iP(_,s),C=iP(o,d,p),M=aP(w),I=aP(C);t.modifiersData[i]={referenceClippingOffsets:w,popperEscapeOffsets:C,isReferenceHidden:M,hasPopperEscaped:I},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":M,"data-popper-escaped":I})}var P7={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:k7};function R7(e,t,i){var s=Cu(e),d=[rl,ol].indexOf(s)>=0?-1:1,p=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,_=p[0],o=p[1];return _=_||0,o=(o||0)*d,[rl,ic].indexOf(s)>=0?{x:o,y:_}:{x:_,y:o}}function L7(e){var t=e.state,i=e.options,s=e.name,d=i.offset,p=d===void 0?[0,0]:d,_=md.reduce(function(M,I){return M[I]=R7(I,t.rects,p),M},{}),o=_[t.placement],w=o.x,C=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=w,t.modifiersData.popperOffsets.y+=C),t.modifiersData[s]=_}var O7={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:L7};function D7(e){var t=e.state,i=e.name;t.modifiersData[i]=KO({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}var ZO={name:"popperOffsets",enabled:!0,phase:"read",fn:D7,data:{}};function z7(e){return e==="x"?"y":"x"}function F7(e){var t=e.state,i=e.options,s=e.name,d=i.mainAxis,p=d===void 0?!0:d,_=i.altAxis,o=_===void 0?!1:_,w=i.boundary,C=i.rootBoundary,M=i.altBoundary,I=i.padding,F=i.tether,B=F===void 0?!0:F,N=i.tetherOffset,D=N===void 0?0:N,j=__(t,{boundary:w,rootBoundary:C,padding:I,altBoundary:M}),U=Cu(t.placement),ne=Pm(t.placement),K=!ne,G=LT(U),J=z7(G),oe=t.modifiersData.popperOffsets,se=t.rects.reference,me=t.rects.popper,de=typeof D=="function"?D(Object.assign({},t.rects,{placement:t.placement})):D,ce=typeof de=="number"?{mainAxis:de,altAxis:de}:Object.assign({mainAxis:0,altAxis:0},de),pe=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ge={x:0,y:0};if(oe){if(p){var Re,Je=G==="y"?ol:rl,Me=G==="y"?rc:ic,xe=G==="y"?"height":"width",Ae=oe[G],Ce=Ae+j[Je],ve=Ae-j[Me],Ne=B?-me[xe]/2:0,We=ne===Mm?se[xe]:me[xe],ot=ne===Mm?-me[xe]:-se[xe],Oe=t.elements.arrow,Ct=B&&Oe?RT(Oe):{width:0,height:0},Mt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:UO(),zt=Mt[Je],bt=Mt[Me],Kt=Jv(0,se[xe],Ct[xe]),$t=K?se[xe]/2-Ne-Kt-zt-ce.mainAxis:We-Kt-zt-ce.mainAxis,Le=K?-se[xe]/2+Ne+Kt+bt+ce.mainAxis:ot+Kt+bt+ce.mainAxis,dn=t.elements.arrow&&W_(t.elements.arrow),At=dn?G==="y"?dn.clientTop||0:dn.clientLeft||0:0,Ke=(Re=pe==null?void 0:pe[G])!=null?Re:0,Be=Ae+$t-Ke-At,Ht=Ae+Le-Ke,Ut=Jv(B?Ab(Ce,Be):Ce,Ae,B?Ff(ve,Ht):ve);oe[G]=Ut,ge[G]=Ut-Ae}if(o){var Nt,Et=G==="x"?ol:rl,Gt=G==="x"?rc:ic,ln=oe[J],bn=J==="y"?"height":"width",_n=ln+j[Et],jn=ln-j[Gt],yt=[ol,rl].indexOf(U)!==-1,kn=(Nt=pe==null?void 0:pe[J])!=null?Nt:0,qn=yt?_n:ln-se[bn]-me[bn]-kn+ce.altAxis,Co=yt?ln+se[bn]+me[bn]-kn-ce.altAxis:jn,mo=B&&yt?u7(qn,ln,Co):Jv(B?qn:_n,ln,B?Co:jn);oe[J]=mo,ge[J]=mo-ln}t.modifiersData[s]=ge}}var B7={name:"preventOverflow",enabled:!0,phase:"main",fn:F7,requiresIfExists:["offset"]};function N7(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function $7(e){return e===ou(e)||!tc(e)?OT(e):N7(e)}function V7(e){var t=e.getBoundingClientRect(),i=Am(t.width)/e.offsetWidth||1,s=Am(t.height)/e.offsetHeight||1;return i!==1||s!==1}function U7(e,t,i){i===void 0&&(i=!1);var s=tc(t),d=tc(t)&&V7(t),p=Oh(t),_=km(e,d),o={scrollLeft:0,scrollTop:0},w={x:0,y:0};return(s||!s&&!i)&&((ku(t)!=="body"||zT(p))&&(o=$7(t)),tc(t)?(w=km(t,!0),w.x+=t.clientLeft,w.y+=t.clientTop):p&&(w.x=DT(p))),{x:_.left+o.scrollLeft-w.x,y:_.top+o.scrollTop-w.y,width:_.width,height:_.height}}function j7(e){var t=new Map,i=new Set,s=[];e.forEach(function(p){t.set(p.name,p)});function d(p){i.add(p.name);var _=[].concat(p.requires||[],p.requiresIfExists||[]);_.forEach(function(o){if(!i.has(o)){var w=t.get(o);w&&d(w)}}),s.push(p)}return e.forEach(function(p){i.has(p.name)||d(p)}),s}function H7(e){var t=j7(e);return i7.reduce(function(i,s){return i.concat(t.filter(function(d){return d.phase===s}))},[])}function G7(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function W7(e){var t=e.reduce(function(i,s){var d=i[s.name];return i[s.name]=d?Object.assign({},d,s,{options:Object.assign({},d.options,s.options),data:Object.assign({},d.data,s.data)}):s,i},{});return Object.keys(t).map(function(i){return t[i]})}var sP={placement:"bottom",modifiers:[],strategy:"absolute"};function lP(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function FT(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,s=i===void 0?[]:i,d=t.defaultOptions,p=d===void 0?sP:d;return function(_,o,w){w===void 0&&(w=p);var C={placement:"bottom",orderedModifiers:[],options:Object.assign({},sP,p),modifiersData:{},elements:{reference:_,popper:o},attributes:{},styles:{}},M=[],I=!1,F={state:C,setOptions:function(D){var j=typeof D=="function"?D(C.options):D;N(),C.options=Object.assign({},p,C.options,j),C.scrollParents={reference:Im(_)?Qv(_):_.contextElement?Qv(_.contextElement):[],popper:Qv(o)};var U=H7(W7([].concat(s,C.options.modifiers)));return C.orderedModifiers=U.filter(function(ne){return ne.enabled}),B(),F.update()},forceUpdate:function(){if(!I){var D=C.elements,j=D.reference,U=D.popper;if(lP(j,U)){C.rects={reference:U7(j,W_(U),C.options.strategy==="fixed"),popper:RT(U)},C.reset=!1,C.placement=C.options.placement,C.orderedModifiers.forEach(function(me){return C.modifiersData[me.name]=Object.assign({},me.data)});for(var ne=0;ne<C.orderedModifiers.length;ne++){if(C.reset===!0){C.reset=!1,ne=-1;continue}var K=C.orderedModifiers[ne],G=K.fn,J=K.options,oe=J===void 0?{}:J,se=K.name;typeof G=="function"&&(C=G({state:C,options:oe,name:se,instance:F})||C)}}}},update:G7(function(){return new Promise(function(D){F.forceUpdate(),D(C)})}),destroy:function(){N(),I=!0}};if(!lP(_,o))return F;F.setOptions(w).then(function(D){!I&&w.onFirstUpdate&&w.onFirstUpdate(D)});function B(){C.orderedModifiers.forEach(function(D){var j=D.name,U=D.options,ne=U===void 0?{}:U,K=D.effect;if(typeof K=="function"){var G=K({state:C,name:j,instance:F,options:ne}),J=function(){};M.push(G||J)}})}function N(){M.forEach(function(D){return D()}),M=[]}return F}}FT();var q7=[WO,ZO,GO,$O];FT({defaultModifiers:q7});var K7=[WO,ZO,GO,$O,O7,A7,B7,p7,P7],Z7=FT({defaultModifiers:K7});const Y7=["fixed","absolute"],X7=vn({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:ut(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:md,default:"bottom"},popperOptions:{type:ut(Object),default:()=>({})},strategy:{type:String,values:Y7,default:"absolute"}}),YO=vn({...X7,id:String,style:{type:ut([String,Array,Object])},className:{type:ut([String,Array,Object])},effect:{type:ut(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:ut([String,Array,Object])},popperStyle:{type:ut([String,Array,Object])},referenceEl:{type:ut(Object)},triggerTargetEl:{type:ut(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...Da(["ariaLabel"])}),J7={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},Q7=(e,t)=>{const i=we(!1),s=we();return{focusStartRef:s,trapped:i,onFocusAfterReleased:C=>{var M;((M=C.detail)==null?void 0:M.focusReason)!=="pointer"&&(s.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:C=>{e.visible&&!i.value&&(C.target&&(s.value=C.target),i.value=!0)},onFocusoutPrevented:C=>{e.trapping||(C.detail.focusReason==="pointer"&&C.preventDefault(),i.value=!1)},onReleaseRequested:()=>{i.value=!1,t("close")}}},eK=(e,t=[])=>{const{placement:i,strategy:s,popperOptions:d}=e,p={placement:i,strategy:s,...d,modifiers:[...nK(e),...t]};return oK(p,d==null?void 0:d.modifiers),p},tK=e=>{if(gr)return Ds(e)};function nK(e){const{offset:t,gpuAcceleration:i,fallbackPlacements:s}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:s}},{name:"computeStyles",options:{gpuAcceleration:i}}]}function oK(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const rK=(e,t,i={})=>{const s={name:"updateState",enabled:!0,phase:"write",fn:({state:w})=>{const C=iK(w);Object.assign(_.value,C)},requires:["computeStyles"]},d=te(()=>{const{onFirstUpdate:w,placement:C,strategy:M,modifiers:I}=y(i);return{onFirstUpdate:w,placement:C||"bottom",strategy:M||"absolute",modifiers:[...I||[],s,{name:"applyStyles",enabled:!1}]}}),p=gi(),_=we({styles:{popper:{position:y(d).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),o=()=>{p.value&&(p.value.destroy(),p.value=void 0)};return tn(d,w=>{const C=y(p);C&&C.setOptions(w)},{deep:!0}),tn([e,t],([w,C])=>{o(),!(!w||!C)&&(p.value=Z7(w,C,y(d)))}),ni(()=>{o()}),{state:te(()=>{var w;return{...((w=y(p))==null?void 0:w.state)||{}}}),styles:te(()=>y(_).styles),attributes:te(()=>y(_).attributes),update:()=>{var w;return(w=y(p))==null?void 0:w.update()},forceUpdate:()=>{var w;return(w=y(p))==null?void 0:w.forceUpdate()},instanceRef:te(()=>y(p))}};function iK(e){const t=Object.keys(e.elements),i=g_(t.map(d=>[d,e.styles[d]||{}])),s=g_(t.map(d=>[d,e.attributes[d]]));return{styles:i,attributes:s}}const aK=0,sK=e=>{const{popperInstanceRef:t,contentRef:i,triggerRef:s,role:d}=Un(ET,void 0),p=we(),_=we(),o=te(()=>({name:"eventListeners",enabled:!!e.visible})),w=te(()=>{var U;const ne=y(p),K=(U=y(_))!=null?U:aK;return{name:"arrow",enabled:!tO(ne),options:{element:ne,padding:K}}}),C=te(()=>({onFirstUpdate:()=>{N()},...eK(e,[y(w),y(o)])})),M=te(()=>tK(e.referenceEl)||y(s)),{attributes:I,state:F,styles:B,update:N,forceUpdate:D,instanceRef:j}=rK(M,i,C);return tn(j,U=>t.value=U),No(()=>{tn(()=>{var U;return(U=y(M))==null?void 0:U.getBoundingClientRect()},()=>{N()})}),{attributes:I,arrowRef:p,contentRef:i,instanceRef:j,state:F,styles:B,role:d,forceUpdate:D,update:N}},lK=(e,{attributes:t,styles:i,role:s})=>{const{nextZIndex:d}=qm(),p=rn("popper"),_=te(()=>y(t).popper),o=we(ao(e.zIndex)?e.zIndex:d()),w=te(()=>[p.b(),p.is("pure",e.pure),p.is(e.effect),e.popperClass]),C=te(()=>[{zIndex:y(o)},y(i).popper,e.popperStyle||{}]),M=te(()=>s.value==="dialog"?"false":void 0),I=te(()=>y(i).arrow||{});return{ariaModal:M,arrowStyle:I,contentAttrs:_,contentClass:w,contentStyle:C,contentZIndex:o,updateZIndex:()=>{o.value=ao(e.zIndex)?e.zIndex:d()}}},cK=Ze({name:"ElPopperContent"}),uK=Ze({...cK,props:YO,emits:J7,setup(e,{expose:t,emit:i}){const s=e,{focusStartRef:d,trapped:p,onFocusAfterReleased:_,onFocusAfterTrapped:o,onFocusInTrap:w,onFocusoutPrevented:C,onReleaseRequested:M}=Q7(s,i),{attributes:I,arrowRef:F,contentRef:B,styles:N,instanceRef:D,role:j,update:U}=sK(s),{ariaModal:ne,arrowStyle:K,contentAttrs:G,contentClass:J,contentStyle:oe,updateZIndex:se}=lK(s,{styles:N,attributes:I,role:j}),me=Un(Au,void 0),de=we();or(AO,{arrowStyle:K,arrowRef:F,arrowOffset:de}),me&&or(Au,{...me,addInputId:jr,removeInputId:jr});let ce;const pe=(Re=!0)=>{U(),Re&&se()},ge=()=>{pe(!1),s.visible&&s.focusOnShow?p.value=!0:s.visible===!1&&(p.value=!1)};return No(()=>{tn(()=>s.triggerTargetEl,(Re,Je)=>{ce==null||ce(),ce=void 0;const Me=y(Re||B.value),xe=y(Je||B.value);El(Me)&&(ce=tn([j,()=>s.ariaLabel,ne,()=>s.id],Ae=>{["role","aria-label","aria-modal","id"].forEach((Ce,ve)=>{ga(Ae[ve])?Me.removeAttribute(Ce):Me.setAttribute(Ce,Ae[ve])})},{immediate:!0})),xe!==Me&&El(xe)&&["role","aria-label","aria-modal","id"].forEach(Ae=>{xe.removeAttribute(Ae)})},{immediate:!0}),tn(()=>s.visible,ge,{immediate:!0})}),ni(()=>{ce==null||ce(),ce=void 0}),t({popperContentRef:B,popperInstanceRef:D,updatePopper:pe,contentStyle:oe}),(Re,Je)=>(le(),Pe("div",Yo({ref_key:"contentRef",ref:B},y(G),{style:y(oe),class:y(J),tabindex:"-1",onMouseenter:Me=>Re.$emit("mouseenter",Me),onMouseleave:Me=>Re.$emit("mouseleave",Me)}),[Qe(y(Zm),{trapped:y(p),"trap-on-focus-in":!0,"focus-trap-el":y(B),"focus-start-el":y(d),onFocusAfterTrapped:y(o),onFocusAfterReleased:y(_),onFocusin:y(w),onFocusoutPrevented:y(C),onReleaseRequested:y(M)},{default:at(()=>[_t(Re.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var dK=xn(uK,[["__file","content.vue"]]);const XO=Ao(T9),S1=Symbol("elTooltip");function cP(){let e;const t=(s,d)=>{i(),e=window.setTimeout(s,d)},i=()=>window.clearTimeout(e);return V_(()=>i()),{registerTimeout:t,cancelTimeout:i}}const hK=vn({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),fK=({showAfter:e,hideAfter:t,autoClose:i,open:s,close:d})=>{const{registerTimeout:p}=cP(),{registerTimeout:_,cancelTimeout:o}=cP();return{onOpen:M=>{p(()=>{s(M);const I=y(i);ao(I)&&I>0&&_(()=>{d(M)},I)},y(e))},onClose:M=>{o(),p(()=>{d(M)},y(t))}}},wa=vn({...hK,...YO,appendTo:{type:ut([String,Object])},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:ut(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...Da(["ariaLabel"])}),y_=vn({...RO,disabled:Boolean,trigger:{type:ut([String,Array]),default:"hover"},triggerKeys:{type:ut(Array),default:()=>[Ln.enter,Ln.numpadEnter,Ln.space]}}),pK=nu({type:ut(Boolean),default:null}),mK=nu({type:ut(Function)}),gK=e=>{const t=`update:${e}`,i=`onUpdate:${e}`,s=[t],d={[e]:pK,[i]:mK};return{useModelToggle:({indicator:_,toggleReason:o,shouldHideWhenRouteChanges:w,shouldProceed:C,onShow:M,onHide:I})=>{const F=jo(),{emit:B}=F,N=F.props,D=te(()=>Qn(N[i])),j=te(()=>N[e]===null),U=se=>{_.value!==!0&&(_.value=!0,o&&(o.value=se),Qn(M)&&M(se))},ne=se=>{_.value!==!1&&(_.value=!1,o&&(o.value=se),Qn(I)&&I(se))},K=se=>{if(N.disabled===!0||Qn(C)&&!C())return;const me=D.value&&gr;me&&B(t,!0),(j.value||!me)&&U(se)},G=se=>{if(N.disabled===!0||!gr)return;const me=D.value&&gr;me&&B(t,!1),(j.value||!me)&&ne(se)},J=se=>{ai(se)&&(N.disabled&&se?D.value&&B(t,!1):_.value!==se&&(se?U():ne()))},oe=()=>{_.value?G():K()};return tn(()=>N[e],J),w&&F.appContext.config.globalProperties.$route!==void 0&&tn(()=>({...F.proxy.$route}),()=>{w.value&&_.value&&G()}),No(()=>{J(N[e])}),{hide:G,show:K,toggle:oe,hasUpdateHandler:D}},useModelToggleProps:d,useModelToggleEmits:s}},{useModelToggleProps:vK,useModelToggleEmits:_K,useModelToggle:yK}=gK("visible"),bK=vn({...kO,...vK,...wa,...y_,...PO,showArrow:{type:Boolean,default:!0}}),xK=[..._K,"before-show","before-hide","show","hide","open","close"],wK=(e,t)=>fn(e)?e.includes(t):e===t,Yp=(e,t,i)=>s=>{wK(y(e),t)&&i(s)},Ui=(e,t,{checkForDefaultPrevented:i=!0}={})=>d=>{const p=e==null?void 0:e(d);if(i===!1||!p)return t==null?void 0:t(d)},uP=e=>t=>t.pointerType==="mouse"?e(t):void 0,SK=Ze({name:"ElTooltipTrigger"}),TK=Ze({...SK,props:y_,setup(e,{expose:t}){const i=e,s=rn("tooltip"),{controlled:d,id:p,open:_,onOpen:o,onClose:w,onToggle:C}=Un(S1,void 0),M=we(null),I=()=>{if(y(d)||i.disabled)return!0},F=Vr(i,"trigger"),B=Ui(I,Yp(F,"hover",o)),N=Ui(I,Yp(F,"hover",w)),D=Ui(I,Yp(F,"click",G=>{G.button===0&&C(G)})),j=Ui(I,Yp(F,"focus",o)),U=Ui(I,Yp(F,"focus",w)),ne=Ui(I,Yp(F,"contextmenu",G=>{G.preventDefault(),C(G)})),K=Ui(I,G=>{const{code:J}=G;i.triggerKeys.includes(J)&&(G.preventDefault(),C(G))});return t({triggerRef:M}),(G,J)=>(le(),Rt(y(D9),{id:y(p),"virtual-ref":G.virtualRef,open:y(_),"virtual-triggering":G.virtualTriggering,class:he(y(s).e("trigger")),onBlur:y(U),onClick:y(D),onContextmenu:y(ne),onFocus:y(j),onMouseenter:y(B),onMouseleave:y(N),onKeydown:y(K)},{default:at(()=>[_t(G.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var CK=xn(TK,[["__file","trigger.vue"]]);const EK=vn({to:{type:ut([String,Object]),required:!0},disabled:Boolean}),MK=Ze({__name:"teleport",props:EK,setup(e){return(t,i)=>t.disabled?_t(t.$slots,"default",{key:0}):(le(),Rt(H5,{key:1,to:t.to},[_t(t.$slots,"default")],8,["to"]))}});var IK=xn(MK,[["__file","teleport.vue"]]);const Ym=Ao(IK),JO=()=>{const e=YS(),t=TT(),i=te(()=>`${e.value}-popper-container-${t.prefix}`),s=te(()=>`#${i.value}`);return{id:i,selector:s}},AK=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},kK=()=>{const{id:e,selector:t}=JO();return n1(()=>{gr&&(document.body.querySelector(t.value)||AK(e.value))}),{id:e,selector:t}},PK=Ze({name:"ElTooltipContent",inheritAttrs:!1}),RK=Ze({...PK,props:wa,setup(e,{expose:t}){const i=e,{selector:s}=JO(),d=rn("tooltip"),p=we();let _;const{controlled:o,id:w,open:C,trigger:M,onClose:I,onOpen:F,onShow:B,onHide:N,onBeforeShow:D,onBeforeHide:j}=Un(S1,void 0),U=te(()=>i.transition||`${d.namespace.value}-fade-in-linear`),ne=te(()=>i.persistent);ni(()=>{_==null||_()});const K=te(()=>y(ne)?!0:y(C)),G=te(()=>i.disabled?!1:y(C)),J=te(()=>i.appendTo||s.value),oe=te(()=>{var xe;return(xe=i.style)!=null?xe:{}}),se=we(!0),me=()=>{N(),se.value=!0},de=()=>{if(y(o))return!0},ce=Ui(de,()=>{i.enterable&&y(M)==="hover"&&F()}),pe=Ui(de,()=>{y(M)==="hover"&&I()}),ge=()=>{var xe,Ae;(Ae=(xe=p.value)==null?void 0:xe.updatePopper)==null||Ae.call(xe),D==null||D()},Re=()=>{j==null||j()},Je=()=>{B(),_=fT(te(()=>{var xe;return(xe=p.value)==null?void 0:xe.popperContentRef}),()=>{if(y(o))return;y(M)!=="hover"&&I()})},Me=()=>{i.virtualTriggering||I()};return tn(()=>y(C),xe=>{xe?se.value=!1:_==null||_()},{flush:"post"}),tn(()=>i.content,()=>{var xe,Ae;(Ae=(xe=p.value)==null?void 0:xe.updatePopper)==null||Ae.call(xe)}),t({contentRef:p}),(xe,Ae)=>(le(),Rt(y(Ym),{disabled:!xe.teleported,to:y(J)},{default:at(()=>[Qe(Ea,{name:y(U),onAfterLeave:me,onBeforeEnter:ge,onAfterEnter:Je,onBeforeLeave:Re},{default:at(()=>[y(K)?zo((le(),Rt(y(dK),Yo({key:0,id:y(w),ref_key:"contentRef",ref:p},xe.$attrs,{"aria-label":xe.ariaLabel,"aria-hidden":se.value,"boundaries-padding":xe.boundariesPadding,"fallback-placements":xe.fallbackPlacements,"gpu-acceleration":xe.gpuAcceleration,offset:xe.offset,placement:xe.placement,"popper-options":xe.popperOptions,strategy:xe.strategy,effect:xe.effect,enterable:xe.enterable,pure:xe.pure,"popper-class":xe.popperClass,"popper-style":[xe.popperStyle,y(oe)],"reference-el":xe.referenceEl,"trigger-target-el":xe.triggerTargetEl,visible:y(G),"z-index":xe.zIndex,onMouseenter:y(ce),onMouseleave:y(pe),onBlur:Me,onClose:y(I)}),{default:at(()=>[_t(xe.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Cr,y(G)]]):St("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var LK=xn(RK,[["__file","content.vue"]]);const OK=Ze({name:"ElTooltip"}),DK=Ze({...OK,props:bK,emits:xK,setup(e,{expose:t,emit:i}){const s=e;kK();const d=Oa(),p=we(),_=we(),o=()=>{var U;const ne=y(p);ne&&((U=ne.popperInstanceRef)==null||U.update())},w=we(!1),C=we(),{show:M,hide:I,hasUpdateHandler:F}=yK({indicator:w,toggleReason:C}),{onOpen:B,onClose:N}=fK({showAfter:Vr(s,"showAfter"),hideAfter:Vr(s,"hideAfter"),autoClose:Vr(s,"autoClose"),open:M,close:I}),D=te(()=>ai(s.visible)&&!F.value);or(S1,{controlled:D,id:d,open:Vm(w),trigger:Vr(s,"trigger"),onOpen:U=>{B(U)},onClose:U=>{N(U)},onToggle:U=>{y(w)?N(U):B(U)},onShow:()=>{i("show",C.value)},onHide:()=>{i("hide",C.value)},onBeforeShow:()=>{i("before-show",C.value)},onBeforeHide:()=>{i("before-hide",C.value)},updatePopper:o}),tn(()=>s.disabled,U=>{U&&w.value&&(w.value=!1)});const j=U=>{var ne,K;const G=(K=(ne=_.value)==null?void 0:ne.contentRef)==null?void 0:K.popperContentRef,J=(U==null?void 0:U.relatedTarget)||document.activeElement;return G&&G.contains(J)};return xR(()=>w.value&&I()),t({popperRef:p,contentRef:_,isFocusInsideContent:j,updatePopper:o,onOpen:B,onClose:N,hide:I}),(U,ne)=>(le(),Rt(y(XO),{ref_key:"popperRef",ref:p,role:U.role},{default:at(()=>[Qe(CK,{disabled:U.disabled,trigger:U.trigger,"trigger-keys":U.triggerKeys,"virtual-ref":U.virtualRef,"virtual-triggering":U.virtualTriggering},{default:at(()=>[U.$slots.default?_t(U.$slots,"default",{key:0}):St("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Qe(LK,{ref_key:"contentRef",ref:_,"aria-label":U.ariaLabel,"boundaries-padding":U.boundariesPadding,content:U.content,disabled:U.disabled,effect:U.effect,enterable:U.enterable,"fallback-placements":U.fallbackPlacements,"hide-after":U.hideAfter,"gpu-acceleration":U.gpuAcceleration,offset:U.offset,persistent:U.persistent,"popper-class":U.popperClass,"popper-style":U.popperStyle,placement:U.placement,"popper-options":U.popperOptions,pure:U.pure,"raw-content":U.rawContent,"reference-el":U.referenceEl,"trigger-target-el":U.triggerTargetEl,"show-after":U.showAfter,strategy:U.strategy,teleported:U.teleported,transition:U.transition,"virtual-triggering":U.virtualTriggering,"z-index":U.zIndex,"append-to":U.appendTo},{default:at(()=>[_t(U.$slots,"content",{},()=>[U.rawContent?(le(),Pe("span",{key:0,innerHTML:U.content},null,8,["innerHTML"])):(le(),Pe("span",{key:1},yn(U.content),1))]),U.showArrow?(le(),Rt(y(M9),{key:0,"arrow-offset":U.arrowOffset},null,8,["arrow-offset"])):St("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var zK=xn(DK,[["__file","tooltip.vue"]]);const qa=Ao(zK),FK=vn({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:ut(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:ut([Function,Array]),default:jr},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:wa.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...Da(["ariaLabel"])}),BK={[Fo]:e=>Zn(e),[Ga]:e=>Zn(e),[Yr]:e=>Zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>Vo(e)},QO="ElAutocomplete",NK=Ze({name:QO,inheritAttrs:!1}),$K=Ze({...NK,props:FK,emits:BK,setup(e,{expose:t,emit:i}){const s=e,d=j_(),p=Ph(),_=Za(),o=rn("autocomplete"),w=we(),C=we(),M=we(),I=we();let F=!1,B=!1;const N=we([]),D=we(-1),j=we(""),U=we(!1),ne=we(!1),K=we(!1),G=Oa(),J=te(()=>p.style),oe=te(()=>(N.value.length>0||K.value)&&U.value),se=te(()=>!s.hideLoading&&K.value),me=te(()=>w.value?Array.from(w.value.$el.querySelectorAll("input")):[]),de=()=>{oe.value&&(j.value=`${w.value.$el.offsetWidth}px`)},ce=()=>{D.value=-1},pe=async bt=>{if(ne.value)return;const Kt=$t=>{K.value=!1,!ne.value&&(fn($t)?(N.value=$t,D.value=s.highlightFirstItem?0:-1):ha(QO,"autocomplete suggestions must be an array"))};if(K.value=!0,fn(s.fetchSuggestions))Kt(s.fetchSuggestions);else{const $t=await s.fetchSuggestions(bt,Kt);fn($t)&&Kt($t)}},ge=il(pe,s.debounce),Re=bt=>{const Kt=!!bt;if(i(Ga,bt),i(Fo,bt),ne.value=!1,U.value||(U.value=Kt),!s.triggerOnFocus&&!bt){ne.value=!0,N.value=[];return}ge(bt)},Je=bt=>{var Kt;_.value||(((Kt=bt.target)==null?void 0:Kt.tagName)!=="INPUT"||me.value.includes(document.activeElement))&&(U.value=!0)},Me=bt=>{i(Yr,bt)},xe=bt=>{B?B=!1:(U.value=!0,i("focus",bt),s.triggerOnFocus&&!F&&ge(String(s.modelValue)))},Ae=bt=>{setTimeout(()=>{var Kt;if((Kt=M.value)!=null&&Kt.isFocusInsideContent()){B=!0;return}U.value&&We(),i("blur",bt)})},Ce=()=>{U.value=!1,i(Fo,""),i("clear")},ve=async()=>{oe.value&&D.value>=0&&D.value<N.value.length?Ct(N.value[D.value]):s.selectWhenUnmatched&&(i("select",{value:s.modelValue}),N.value=[],D.value=-1)},Ne=bt=>{oe.value&&(bt.preventDefault(),bt.stopPropagation(),We())},We=()=>{U.value=!1},ot=()=>{var bt;(bt=w.value)==null||bt.focus()},Oe=()=>{var bt;(bt=w.value)==null||bt.blur()},Ct=async bt=>{i(Ga,bt[s.valueKey]),i(Fo,bt[s.valueKey]),i("select",bt),N.value=[],D.value=-1},Mt=bt=>{if(!oe.value||K.value)return;if(bt<0){D.value=-1;return}bt>=N.value.length&&(bt=N.value.length-1);const Kt=C.value.querySelector(`.${o.be("suggestion","wrap")}`),Le=Kt.querySelectorAll(`.${o.be("suggestion","list")} li`)[bt],dn=Kt.scrollTop,{offsetTop:At,scrollHeight:Ke}=Le;At+Ke>dn+Kt.clientHeight&&(Kt.scrollTop+=Ke),At<dn&&(Kt.scrollTop-=Ke),D.value=bt,w.value.ref.setAttribute("aria-activedescendant",`${G.value}-item-${D.value}`)},zt=fT(I,()=>{oe.value&&We()});return ni(()=>{zt==null||zt()}),No(()=>{w.value.ref.setAttribute("role","textbox"),w.value.ref.setAttribute("aria-autocomplete","list"),w.value.ref.setAttribute("aria-controls","id"),w.value.ref.setAttribute("aria-activedescendant",`${G.value}-item-${D.value}`),F=w.value.ref.hasAttribute("readonly")}),t({highlightedIndex:D,activated:U,loading:K,inputRef:w,popperRef:M,suggestions:N,handleSelect:Ct,handleKeyEnter:ve,focus:ot,blur:Oe,close:We,highlight:Mt,getData:pe}),(bt,Kt)=>(le(),Rt(y(qa),{ref_key:"popperRef",ref:M,visible:y(oe),placement:bt.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[y(o).e("popper"),bt.popperClass],teleported:bt.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${y(o).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:de,onHide:ce},{content:at(()=>[Ve("div",{ref_key:"regionRef",ref:C,class:he([y(o).b("suggestion"),y(o).is("loading",y(se))]),style:to({[bt.fitInputWidth?"width":"minWidth"]:j.value,outline:"none"}),role:"region"},[Qe(y(Ou),{id:y(G),tag:"ul","wrap-class":y(o).be("suggestion","wrap"),"view-class":y(o).be("suggestion","list"),role:"listbox"},{default:at(()=>[y(se)?(le(),Pe("li",{key:0},[_t(bt.$slots,"loading",{},()=>[Qe(y(Gn),{class:he(y(o).is("loading"))},{default:at(()=>[Qe(y(Iu))]),_:1},8,["class"])])])):(le(!0),Pe(eo,{key:1},nr(N.value,($t,Le)=>(le(),Pe("li",{id:`${y(G)}-item-${Le}`,key:Le,class:he({highlighted:D.value===Le}),role:"option","aria-selected":D.value===Le,onClick:dn=>Ct($t)},[_t(bt.$slots,"default",{item:$t},()=>[Qo(yn($t[bt.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:at(()=>[Ve("div",{ref_key:"listboxRef",ref:I,class:he([y(o).b(),bt.$attrs.class]),style:to(y(J)),role:"combobox","aria-haspopup":"listbox","aria-expanded":y(oe),"aria-owns":y(G)},[Qe(y(fs),Yo({ref_key:"inputRef",ref:w},y(d),{clearable:bt.clearable,disabled:y(_),name:bt.name,"model-value":bt.modelValue,"aria-label":bt.ariaLabel,onInput:Re,onChange:Me,onFocus:xe,onBlur:Ae,onClear:Ce,onKeydown:[ti(po($t=>Mt(D.value-1),["prevent"]),["up"]),ti(po($t=>Mt(D.value+1),["prevent"]),["down"]),ti(ve,["enter"]),ti(We,["tab"]),ti(Ne,["esc"])],onMousedown:Je}),nc({_:2},[bt.$slots.prepend?{name:"prepend",fn:at(()=>[_t(bt.$slots,"prepend")])}:void 0,bt.$slots.append?{name:"append",fn:at(()=>[_t(bt.$slots,"append")])}:void 0,bt.$slots.prefix?{name:"prefix",fn:at(()=>[_t(bt.$slots,"prefix")])}:void 0,bt.$slots.suffix?{name:"suffix",fn:at(()=>[_t(bt.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var VK=xn($K,[["__file","autocomplete.vue"]]);const UK=Ao(VK),jK=vn({size:{type:[Number,String],values:Lu,default:"",validator:e=>ao(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:Xr},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:ut(String),default:"cover"}}),HK={error:e=>e instanceof Event},GK=Ze({name:"ElAvatar"}),WK=Ze({...GK,props:jK,emits:HK,setup(e,{emit:t}){const i=e,s=rn("avatar"),d=we(!1),p=te(()=>{const{size:C,icon:M,shape:I}=i,F=[s.b()];return Zn(C)&&F.push(s.m(C)),M&&F.push(s.m("icon")),I&&F.push(s.m(I)),F}),_=te(()=>{const{size:C}=i;return ao(C)?s.cssVarBlock({size:ji(C)||""}):void 0}),o=te(()=>({objectFit:i.fit}));tn(()=>i.src,()=>d.value=!1);function w(C){d.value=!0,t("error",C)}return(C,M)=>(le(),Pe("span",{class:he(y(p)),style:to(y(_))},[(C.src||C.srcSet)&&!d.value?(le(),Pe("img",{key:0,src:C.src,alt:C.alt,srcset:C.srcSet,style:to(y(o)),onError:w},null,44,["src","alt","srcset"])):C.icon?(le(),Rt(y(Gn),{key:1},{default:at(()=>[(le(),Rt(Wo(C.icon)))]),_:1})):_t(C.$slots,"default",{key:2})],6))}});var qK=xn(WK,[["__file","avatar.vue"]]);const KK=Ao(qK),ZK={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},YK={click:e=>e instanceof MouseEvent},XK=(e,t,i)=>{const s=gi(),d=gi(),p=we(!1),_=()=>{s.value&&(p.value=s.value.scrollTop>=e.visibilityHeight)},o=C=>{var M;(M=s.value)==null||M.scrollTo({top:0,behavior:"smooth"}),t("click",C)},w=iO(_,300,!0);return qr(d,"scroll",w),No(()=>{var C;d.value=document,s.value=document.documentElement,e.target&&(s.value=(C=document.querySelector(e.target))!=null?C:void 0,s.value||ha(i,`target does not exist: ${e.target}`),d.value=s.value),_()}),{visible:p,handleClick:o}},eD="ElBacktop",JK=Ze({name:eD}),QK=Ze({...JK,props:ZK,emits:YK,setup(e,{emit:t}){const i=e,s=rn("backtop"),{handleClick:d,visible:p}=XK(i,t,eD),_=te(()=>({right:`${i.right}px`,bottom:`${i.bottom}px`}));return(o,w)=>(le(),Rt(Ea,{name:`${y(s).namespace.value}-fade-in`},{default:at(()=>[y(p)?(le(),Pe("div",{key:0,style:to(y(_)),class:he(y(s).b()),onClick:po(y(d),["stop"])},[_t(o.$slots,"default",{},()=>[Qe(y(Gn),{class:he(y(s).e("icon"))},{default:at(()=>[Qe(y(jW))]),_:1},8,["class"])])],14,["onClick"])):St("v-if",!0)]),_:3},8,["name"]))}});var eZ=xn(QK,[["__file","backtop.vue"]]);const tZ=Ao(eZ),nZ=vn({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:ut([String,Object,Array])},offset:{type:ut(Array),default:[0,0]},badgeClass:{type:String}}),oZ=Ze({name:"ElBadge"}),rZ=Ze({...oZ,props:nZ,setup(e,{expose:t}){const i=e,s=rn("badge"),d=te(()=>i.isDot?"":ao(i.value)&&ao(i.max)?i.max<i.value?`${i.max}+`:`${i.value}`:`${i.value}`),p=te(()=>{var _,o,w,C,M;return[{backgroundColor:i.color,marginRight:ji(-((o=(_=i.offset)==null?void 0:_[0])!=null?o:0)),marginTop:ji((C=(w=i.offset)==null?void 0:w[1])!=null?C:0)},(M=i.badgeStyle)!=null?M:{}]});return t({content:d}),(_,o)=>(le(),Pe("div",{class:he(y(s).b())},[_t(_.$slots,"default"),Qe(Ea,{name:`${y(s).namespace.value}-zoom-in-center`,persisted:""},{default:at(()=>[zo(Ve("sup",{class:he([y(s).e("content"),y(s).em("content",_.type),y(s).is("fixed",!!_.$slots.default),y(s).is("dot",_.isDot),y(s).is("hide-zero",!_.showZero&&i.value===0),_.badgeClass]),style:to(y(p)),textContent:yn(y(d))},null,14,["textContent"]),[[Cr,!_.hidden&&(y(d)||_.isDot)]])]),_:1},8,["name"])],2))}});var iZ=xn(rZ,[["__file","badge.vue"]]);const tD=Ao(iZ),nD=Symbol("breadcrumbKey"),aZ=vn({separator:{type:String,default:"/"},separatorIcon:{type:Xr}}),sZ=Ze({name:"ElBreadcrumb"}),lZ=Ze({...sZ,props:aZ,setup(e){const t=e,{t:i}=vr(),s=rn("breadcrumb"),d=we();return or(nD,t),No(()=>{const p=d.value.querySelectorAll(`.${s.e("item")}`);p.length&&p[p.length-1].setAttribute("aria-current","page")}),(p,_)=>(le(),Pe("div",{ref_key:"breadcrumb",ref:d,class:he(y(s).b()),"aria-label":y(i)("el.breadcrumb.label"),role:"navigation"},[_t(p.$slots,"default")],10,["aria-label"]))}});var cZ=xn(lZ,[["__file","breadcrumb.vue"]]);const uZ=vn({to:{type:ut([String,Object]),default:""},replace:Boolean}),dZ=Ze({name:"ElBreadcrumbItem"}),hZ=Ze({...dZ,props:uZ,setup(e){const t=e,i=jo(),s=Un(nD,void 0),d=rn("breadcrumb"),p=i.appContext.config.globalProperties.$router,_=we(),o=()=>{!t.to||!p||(t.replace?p.replace(t.to):p.push(t.to))};return(w,C)=>{var M,I;return le(),Pe("span",{class:he(y(d).e("item"))},[Ve("span",{ref_key:"link",ref:_,class:he([y(d).e("inner"),y(d).is("link",!!w.to)]),role:"link",onClick:o},[_t(w.$slots,"default")],2),(M=y(s))!=null&&M.separatorIcon?(le(),Rt(y(Gn),{key:0,class:he(y(d).e("separator"))},{default:at(()=>[(le(),Rt(Wo(y(s).separatorIcon)))]),_:1},8,["class"])):(le(),Pe("span",{key:1,class:he(y(d).e("separator")),role:"presentation"},yn((I=y(s))==null?void 0:I.separator),3))],2)}}});var oD=xn(hZ,[["__file","breadcrumb-item.vue"]]);const fZ=Ao(cZ,{BreadcrumbItem:oD}),pZ=Li(oD),rD=Symbol("buttonGroupContextKey"),mh=({from:e,replacement:t,scope:i,version:s,ref:d,type:p="API"},_)=>{tn(()=>y(_),o=>{},{immediate:!0})},mZ=(e,t)=>{mh({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},te(()=>e.type==="text"));const i=Un(rD,void 0),s=g1("button"),{form:d}=Ka(),p=na(te(()=>i==null?void 0:i.size)),_=Za(),o=we(),w=aa(),C=te(()=>e.type||(i==null?void 0:i.type)||""),M=te(()=>{var N,D,j;return(j=(D=e.autoInsertSpace)!=null?D:(N=s.value)==null?void 0:N.autoInsertSpace)!=null?j:!1}),I=te(()=>e.tag==="button"?{ariaDisabled:_.value||e.loading,disabled:_.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),F=te(()=>{var N;const D=(N=w.default)==null?void 0:N.call(w);if(M.value&&(D==null?void 0:D.length)===1){const j=D[0];if((j==null?void 0:j.type)===Um){const U=j.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(U.trim())}}return!1});return{_disabled:_,_size:p,_type:C,_ref:o,_props:I,shouldAddSpace:F,handleClick:N=>{if(_.value||e.loading){N.stopPropagation();return}e.nativeType==="reset"&&(d==null||d.resetFields()),t("click",N)}}},A2=["default","primary","success","warning","info","danger","text",""],gZ=["button","submit","reset"],k2=vn({size:ia,disabled:Boolean,type:{type:String,values:A2,default:""},icon:{type:Xr},nativeType:{type:String,values:gZ,default:"button"},loading:Boolean,loadingIcon:{type:Xr,default:()=>Iu},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:ut([String,Object]),default:"button"}}),vZ={click:e=>e instanceof MouseEvent};function Wa(e,t){_Z(e)&&(e="100%");var i=yZ(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function D0(e){return Math.min(1,Math.max(0,e))}function _Z(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function yZ(e){return typeof e=="string"&&e.indexOf("%")!==-1}function iD(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function z0(e){return e<=1?"".concat(Number(e)*100,"%"):e}function If(e){return e.length===1?"0"+e:String(e)}function bZ(e,t,i){return{r:Wa(e,255)*255,g:Wa(t,255)*255,b:Wa(i,255)*255}}function dP(e,t,i){e=Wa(e,255),t=Wa(t,255),i=Wa(i,255);var s=Math.max(e,t,i),d=Math.min(e,t,i),p=0,_=0,o=(s+d)/2;if(s===d)_=0,p=0;else{var w=s-d;switch(_=o>.5?w/(2-s-d):w/(s+d),s){case e:p=(t-i)/w+(t<i?6:0);break;case t:p=(i-e)/w+2;break;case i:p=(e-t)/w+4;break}p/=6}return{h:p,s:_,l:o}}function Dw(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*(6*i):i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function xZ(e,t,i){var s,d,p;if(e=Wa(e,360),t=Wa(t,100),i=Wa(i,100),t===0)d=i,p=i,s=i;else{var _=i<.5?i*(1+t):i+t-i*t,o=2*i-_;s=Dw(o,_,e+1/3),d=Dw(o,_,e),p=Dw(o,_,e-1/3)}return{r:s*255,g:d*255,b:p*255}}function hP(e,t,i){e=Wa(e,255),t=Wa(t,255),i=Wa(i,255);var s=Math.max(e,t,i),d=Math.min(e,t,i),p=0,_=s,o=s-d,w=s===0?0:o/s;if(s===d)p=0;else{switch(s){case e:p=(t-i)/o+(t<i?6:0);break;case t:p=(i-e)/o+2;break;case i:p=(e-t)/o+4;break}p/=6}return{h:p,s:w,v:_}}function wZ(e,t,i){e=Wa(e,360)*6,t=Wa(t,100),i=Wa(i,100);var s=Math.floor(e),d=e-s,p=i*(1-t),_=i*(1-d*t),o=i*(1-(1-d)*t),w=s%6,C=[i,_,p,p,o,i][w],M=[o,i,i,_,p,p][w],I=[p,p,o,i,i,_][w];return{r:C*255,g:M*255,b:I*255}}function fP(e,t,i,s){var d=[If(Math.round(e).toString(16)),If(Math.round(t).toString(16)),If(Math.round(i).toString(16))];return s&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function SZ(e,t,i,s,d){var p=[If(Math.round(e).toString(16)),If(Math.round(t).toString(16)),If(Math.round(i).toString(16)),If(TZ(s))];return d&&p[0].startsWith(p[0].charAt(1))&&p[1].startsWith(p[1].charAt(1))&&p[2].startsWith(p[2].charAt(1))&&p[3].startsWith(p[3].charAt(1))?p[0].charAt(0)+p[1].charAt(0)+p[2].charAt(0)+p[3].charAt(0):p.join("")}function TZ(e){return Math.round(parseFloat(e)*255).toString(16)}function pP(e){return bl(e)/255}function bl(e){return parseInt(e,16)}function CZ(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var P2={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function EZ(e){var t={r:0,g:0,b:0},i=1,s=null,d=null,p=null,_=!1,o=!1;return typeof e=="string"&&(e=AZ(e)),typeof e=="object"&&(Yu(e.r)&&Yu(e.g)&&Yu(e.b)?(t=bZ(e.r,e.g,e.b),_=!0,o=String(e.r).substr(-1)==="%"?"prgb":"rgb"):Yu(e.h)&&Yu(e.s)&&Yu(e.v)?(s=z0(e.s),d=z0(e.v),t=wZ(e.h,s,d),_=!0,o="hsv"):Yu(e.h)&&Yu(e.s)&&Yu(e.l)&&(s=z0(e.s),p=z0(e.l),t=xZ(e.h,s,p),_=!0,o="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(i=e.a)),i=iD(i),{ok:_,format:e.format||o,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:i}}var MZ="[-\\+]?\\d+%?",IZ="[-\\+]?\\d*\\.\\d+%?",dh="(?:".concat(IZ,")|(?:").concat(MZ,")"),zw="[\\s|\\(]+(".concat(dh,")[,|\\s]+(").concat(dh,")[,|\\s]+(").concat(dh,")\\s*\\)?"),Fw="[\\s|\\(]+(".concat(dh,")[,|\\s]+(").concat(dh,")[,|\\s]+(").concat(dh,")[,|\\s]+(").concat(dh,")\\s*\\)?"),$c={CSS_UNIT:new RegExp(dh),rgb:new RegExp("rgb"+zw),rgba:new RegExp("rgba"+Fw),hsl:new RegExp("hsl"+zw),hsla:new RegExp("hsla"+Fw),hsv:new RegExp("hsv"+zw),hsva:new RegExp("hsva"+Fw),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function AZ(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(P2[e])e=P2[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=$c.rgb.exec(e);return i?{r:i[1],g:i[2],b:i[3]}:(i=$c.rgba.exec(e),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=$c.hsl.exec(e),i?{h:i[1],s:i[2],l:i[3]}:(i=$c.hsla.exec(e),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=$c.hsv.exec(e),i?{h:i[1],s:i[2],v:i[3]}:(i=$c.hsva.exec(e),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=$c.hex8.exec(e),i?{r:bl(i[1]),g:bl(i[2]),b:bl(i[3]),a:pP(i[4]),format:t?"name":"hex8"}:(i=$c.hex6.exec(e),i?{r:bl(i[1]),g:bl(i[2]),b:bl(i[3]),format:t?"name":"hex"}:(i=$c.hex4.exec(e),i?{r:bl(i[1]+i[1]),g:bl(i[2]+i[2]),b:bl(i[3]+i[3]),a:pP(i[4]+i[4]),format:t?"name":"hex8"}:(i=$c.hex3.exec(e),i?{r:bl(i[1]+i[1]),g:bl(i[2]+i[2]),b:bl(i[3]+i[3]),format:t?"name":"hex"}:!1)))))))))}function Yu(e){return!!$c.CSS_UNIT.exec(String(e))}var aD=function(){function e(t,i){t===void 0&&(t=""),i===void 0&&(i={});var s;if(t instanceof e)return t;typeof t=="number"&&(t=CZ(t)),this.originalInput=t;var d=EZ(t);this.originalInput=t,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(s=i.format)!==null&&s!==void 0?s:d.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),i,s,d,p=t.r/255,_=t.g/255,o=t.b/255;return p<=.03928?i=p/12.92:i=Math.pow((p+.055)/1.055,2.4),_<=.03928?s=_/12.92:s=Math.pow((_+.055)/1.055,2.4),o<=.03928?d=o/12.92:d=Math.pow((o+.055)/1.055,2.4),.2126*i+.7152*s+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=iD(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=hP(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=hP(this.r,this.g,this.b),i=Math.round(t.h*360),s=Math.round(t.s*100),d=Math.round(t.v*100);return this.a===1?"hsv(".concat(i,", ").concat(s,"%, ").concat(d,"%)"):"hsva(".concat(i,", ").concat(s,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=dP(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=dP(this.r,this.g,this.b),i=Math.round(t.h*360),s=Math.round(t.s*100),d=Math.round(t.l*100);return this.a===1?"hsl(".concat(i,", ").concat(s,"%, ").concat(d,"%)"):"hsla(".concat(i,", ").concat(s,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),fP(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),SZ(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),s=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(i,", ").concat(s,")"):"rgba(".concat(t,", ").concat(i,", ").concat(s,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(i){return"".concat(Math.round(Wa(i,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(i){return Math.round(Wa(i,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+fP(this.r,this.g,this.b,!1),i=0,s=Object.entries(P2);i<s.length;i++){var d=s[i],p=d[0],_=d[1];if(t===_)return p}return!1},e.prototype.toString=function(t){var i=!!t;t=t??this.format;var s=!1,d=this.a<1&&this.a>=0,p=!i&&d&&(t.startsWith("hex")||t==="name");return p?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(s=this.toRgbString()),t==="prgb"&&(s=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(s=this.toHexString()),t==="hex3"&&(s=this.toHexString(!0)),t==="hex4"&&(s=this.toHex8String(!0)),t==="hex8"&&(s=this.toHex8String()),t==="name"&&(s=this.toName()),t==="hsl"&&(s=this.toHslString()),t==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l+=t/100,i.l=D0(i.l),new e(i)},e.prototype.brighten=function(t){t===void 0&&(t=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(t/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(t/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(t/100)))),new e(i)},e.prototype.darken=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l-=t/100,i.l=D0(i.l),new e(i)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s-=t/100,i.s=D0(i.s),new e(i)},e.prototype.saturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s+=t/100,i.s=D0(i.s),new e(i)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var i=this.toHsl(),s=(i.h+t)%360;return i.h=s<0?360+s:s,new e(i)},e.prototype.mix=function(t,i){i===void 0&&(i=50);var s=this.toRgb(),d=new e(t).toRgb(),p=i/100,_={r:(d.r-s.r)*p+s.r,g:(d.g-s.g)*p+s.g,b:(d.b-s.b)*p+s.b,a:(d.a-s.a)*p+s.a};return new e(_)},e.prototype.analogous=function(t,i){t===void 0&&(t=6),i===void 0&&(i=30);var s=this.toHsl(),d=360/i,p=[this];for(s.h=(s.h-(d*t>>1)+720)%360;--t;)s.h=(s.h+d)%360,p.push(new e(s));return p},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var i=this.toHsv(),s=i.h,d=i.s,p=i.v,_=[],o=1/t;t--;)_.push(new e({h:s,s:d,v:p})),p=(p+o)%1;return _},e.prototype.splitcomplement=function(){var t=this.toHsl(),i=t.h;return[this,new e({h:(i+72)%360,s:t.s,l:t.l}),new e({h:(i+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var i=this.toRgb(),s=new e(t).toRgb(),d=i.a+s.a*(1-i.a);return new e({r:(i.r*i.a+s.r*s.a*(1-i.a))/d,g:(i.g*i.a+s.g*s.a*(1-i.a))/d,b:(i.b*i.a+s.b*s.a*(1-i.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var i=this.toHsl(),s=i.h,d=[this],p=360/t,_=1;_<t;_++)d.push(new e({h:(s+_*p)%360,s:i.s,l:i.l}));return d},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function nh(e,t=20){return e.mix("#141414",t).toString()}function kZ(e){const t=Za(),i=rn("button");return te(()=>{let s={},d=e.color;if(d){const p=d.match(/var\((.*?)\)/);p&&(d=window.getComputedStyle(window.document.documentElement).getPropertyValue(p[1]));const _=new aD(d),o=e.dark?_.tint(20).toString():nh(_,20);if(e.plain)s=i.cssVarBlock({"bg-color":e.dark?nh(_,90):_.tint(90).toString(),"text-color":d,"border-color":e.dark?nh(_,50):_.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":d,"hover-border-color":d,"active-bg-color":o,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":o}),t.value&&(s[i.cssVarBlockName("disabled-bg-color")]=e.dark?nh(_,90):_.tint(90).toString(),s[i.cssVarBlockName("disabled-text-color")]=e.dark?nh(_,50):_.tint(50).toString(),s[i.cssVarBlockName("disabled-border-color")]=e.dark?nh(_,80):_.tint(80).toString());else{const w=e.dark?nh(_,30):_.tint(30).toString(),C=_.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(s=i.cssVarBlock({"bg-color":d,"text-color":C,"border-color":d,"hover-bg-color":w,"hover-text-color":C,"hover-border-color":w,"active-bg-color":o,"active-border-color":o}),t.value){const M=e.dark?nh(_,50):_.tint(50).toString();s[i.cssVarBlockName("disabled-bg-color")]=M,s[i.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,s[i.cssVarBlockName("disabled-border-color")]=M}}}return s})}const PZ=Ze({name:"ElButton"}),RZ=Ze({...PZ,props:k2,emits:vZ,setup(e,{expose:t,emit:i}){const s=e,d=kZ(s),p=rn("button"),{_ref:_,_size:o,_type:w,_disabled:C,_props:M,shouldAddSpace:I,handleClick:F}=mZ(s,i),B=te(()=>[p.b(),p.m(w.value),p.m(o.value),p.is("disabled",C.value),p.is("loading",s.loading),p.is("plain",s.plain),p.is("round",s.round),p.is("circle",s.circle),p.is("text",s.text),p.is("link",s.link),p.is("has-bg",s.bg)]);return t({ref:_,size:o,type:w,disabled:C,shouldAddSpace:I}),(N,D)=>(le(),Rt(Wo(N.tag),Yo({ref_key:"_ref",ref:_},y(M),{class:y(B),style:y(d),onClick:y(F)}),{default:at(()=>[N.loading?(le(),Pe(eo,{key:0},[N.$slots.loading?_t(N.$slots,"loading",{key:0}):(le(),Rt(y(Gn),{key:1,class:he(y(p).is("loading"))},{default:at(()=>[(le(),Rt(Wo(N.loadingIcon)))]),_:1},8,["class"]))],64)):N.icon||N.$slots.icon?(le(),Rt(y(Gn),{key:1},{default:at(()=>[N.icon?(le(),Rt(Wo(N.icon),{key:0})):_t(N.$slots,"icon",{key:1})]),_:3})):St("v-if",!0),N.$slots.default?(le(),Pe("span",{key:2,class:he({[y(p).em("text","expand")]:y(I)})},[_t(N.$slots,"default")],2)):St("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var LZ=xn(RZ,[["__file","button.vue"]]);const OZ={size:k2.size,type:k2.type},DZ=Ze({name:"ElButtonGroup"}),zZ=Ze({...DZ,props:OZ,setup(e){const t=e;or(rD,Ir({size:Vr(t,"size"),type:Vr(t,"type")}));const i=rn("button");return(s,d)=>(le(),Pe("div",{class:he(y(i).b("group"))},[_t(s.$slots,"default")],2))}});var sD=xn(zZ,[["__file","button-group.vue"]]);const Ta=Ao(LZ,{ButtonGroup:sD}),lD=Li(sD);var cD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){var i=1e3,s=6e4,d=36e5,p="millisecond",_="second",o="minute",w="hour",C="day",M="week",I="month",F="quarter",B="year",N="date",D="Invalid Date",j=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ne={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Je){var Me=["th","st","nd","rd"],xe=Je%100;return"["+Je+(Me[(xe-20)%10]||Me[xe]||Me[0])+"]"}},K=function(Je,Me,xe){var Ae=String(Je);return!Ae||Ae.length>=Me?Je:""+Array(Me+1-Ae.length).join(xe)+Je},G={s:K,z:function(Je){var Me=-Je.utcOffset(),xe=Math.abs(Me),Ae=Math.floor(xe/60),Ce=xe%60;return(Me<=0?"+":"-")+K(Ae,2,"0")+":"+K(Ce,2,"0")},m:function Je(Me,xe){if(Me.date()<xe.date())return-Je(xe,Me);var Ae=12*(xe.year()-Me.year())+(xe.month()-Me.month()),Ce=Me.clone().add(Ae,I),ve=xe-Ce<0,Ne=Me.clone().add(Ae+(ve?-1:1),I);return+(-(Ae+(xe-Ce)/(ve?Ce-Ne:Ne-Ce))||0)},a:function(Je){return Je<0?Math.ceil(Je)||0:Math.floor(Je)},p:function(Je){return{M:I,y:B,w:M,d:C,D:N,h:w,m:o,s:_,ms:p,Q:F}[Je]||String(Je||"").toLowerCase().replace(/s$/,"")},u:function(Je){return Je===void 0}},J="en",oe={};oe[J]=ne;var se="$isDayjsObject",me=function(Je){return Je instanceof ge||!(!Je||!Je[se])},de=function Je(Me,xe,Ae){var Ce;if(!Me)return J;if(typeof Me=="string"){var ve=Me.toLowerCase();oe[ve]&&(Ce=ve),xe&&(oe[ve]=xe,Ce=ve);var Ne=Me.split("-");if(!Ce&&Ne.length>1)return Je(Ne[0])}else{var We=Me.name;oe[We]=Me,Ce=We}return!Ae&&Ce&&(J=Ce),Ce||!Ae&&J},ce=function(Je,Me){if(me(Je))return Je.clone();var xe=typeof Me=="object"?Me:{};return xe.date=Je,xe.args=arguments,new ge(xe)},pe=G;pe.l=de,pe.i=me,pe.w=function(Je,Me){return ce(Je,{locale:Me.$L,utc:Me.$u,x:Me.$x,$offset:Me.$offset})};var ge=function(){function Je(xe){this.$L=de(xe.locale,null,!0),this.parse(xe),this.$x=this.$x||xe.x||{},this[se]=!0}var Me=Je.prototype;return Me.parse=function(xe){this.$d=function(Ae){var Ce=Ae.date,ve=Ae.utc;if(Ce===null)return new Date(NaN);if(pe.u(Ce))return new Date;if(Ce instanceof Date)return new Date(Ce);if(typeof Ce=="string"&&!/Z$/i.test(Ce)){var Ne=Ce.match(j);if(Ne){var We=Ne[2]-1||0,ot=(Ne[7]||"0").substring(0,3);return ve?new Date(Date.UTC(Ne[1],We,Ne[3]||1,Ne[4]||0,Ne[5]||0,Ne[6]||0,ot)):new Date(Ne[1],We,Ne[3]||1,Ne[4]||0,Ne[5]||0,Ne[6]||0,ot)}}return new Date(Ce)}(xe),this.init()},Me.init=function(){var xe=this.$d;this.$y=xe.getFullYear(),this.$M=xe.getMonth(),this.$D=xe.getDate(),this.$W=xe.getDay(),this.$H=xe.getHours(),this.$m=xe.getMinutes(),this.$s=xe.getSeconds(),this.$ms=xe.getMilliseconds()},Me.$utils=function(){return pe},Me.isValid=function(){return this.$d.toString()!==D},Me.isSame=function(xe,Ae){var Ce=ce(xe);return this.startOf(Ae)<=Ce&&Ce<=this.endOf(Ae)},Me.isAfter=function(xe,Ae){return ce(xe)<this.startOf(Ae)},Me.isBefore=function(xe,Ae){return this.endOf(Ae)<ce(xe)},Me.$g=function(xe,Ae,Ce){return pe.u(xe)?this[Ae]:this.set(Ce,xe)},Me.unix=function(){return Math.floor(this.valueOf()/1e3)},Me.valueOf=function(){return this.$d.getTime()},Me.startOf=function(xe,Ae){var Ce=this,ve=!!pe.u(Ae)||Ae,Ne=pe.p(xe),We=function($t,Le){var dn=pe.w(Ce.$u?Date.UTC(Ce.$y,Le,$t):new Date(Ce.$y,Le,$t),Ce);return ve?dn:dn.endOf(C)},ot=function($t,Le){return pe.w(Ce.toDate()[$t].apply(Ce.toDate("s"),(ve?[0,0,0,0]:[23,59,59,999]).slice(Le)),Ce)},Oe=this.$W,Ct=this.$M,Mt=this.$D,zt="set"+(this.$u?"UTC":"");switch(Ne){case B:return ve?We(1,0):We(31,11);case I:return ve?We(1,Ct):We(0,Ct+1);case M:var bt=this.$locale().weekStart||0,Kt=(Oe<bt?Oe+7:Oe)-bt;return We(ve?Mt-Kt:Mt+(6-Kt),Ct);case C:case N:return ot(zt+"Hours",0);case w:return ot(zt+"Minutes",1);case o:return ot(zt+"Seconds",2);case _:return ot(zt+"Milliseconds",3);default:return this.clone()}},Me.endOf=function(xe){return this.startOf(xe,!1)},Me.$set=function(xe,Ae){var Ce,ve=pe.p(xe),Ne="set"+(this.$u?"UTC":""),We=(Ce={},Ce[C]=Ne+"Date",Ce[N]=Ne+"Date",Ce[I]=Ne+"Month",Ce[B]=Ne+"FullYear",Ce[w]=Ne+"Hours",Ce[o]=Ne+"Minutes",Ce[_]=Ne+"Seconds",Ce[p]=Ne+"Milliseconds",Ce)[ve],ot=ve===C?this.$D+(Ae-this.$W):Ae;if(ve===I||ve===B){var Oe=this.clone().set(N,1);Oe.$d[We](ot),Oe.init(),this.$d=Oe.set(N,Math.min(this.$D,Oe.daysInMonth())).$d}else We&&this.$d[We](ot);return this.init(),this},Me.set=function(xe,Ae){return this.clone().$set(xe,Ae)},Me.get=function(xe){return this[pe.p(xe)]()},Me.add=function(xe,Ae){var Ce,ve=this;xe=Number(xe);var Ne=pe.p(Ae),We=function(Ct){var Mt=ce(ve);return pe.w(Mt.date(Mt.date()+Math.round(Ct*xe)),ve)};if(Ne===I)return this.set(I,this.$M+xe);if(Ne===B)return this.set(B,this.$y+xe);if(Ne===C)return We(1);if(Ne===M)return We(7);var ot=(Ce={},Ce[o]=s,Ce[w]=d,Ce[_]=i,Ce)[Ne]||1,Oe=this.$d.getTime()+xe*ot;return pe.w(Oe,this)},Me.subtract=function(xe,Ae){return this.add(-1*xe,Ae)},Me.format=function(xe){var Ae=this,Ce=this.$locale();if(!this.isValid())return Ce.invalidDate||D;var ve=xe||"YYYY-MM-DDTHH:mm:ssZ",Ne=pe.z(this),We=this.$H,ot=this.$m,Oe=this.$M,Ct=Ce.weekdays,Mt=Ce.months,zt=Ce.meridiem,bt=function(Le,dn,At,Ke){return Le&&(Le[dn]||Le(Ae,ve))||At[dn].slice(0,Ke)},Kt=function(Le){return pe.s(We%12||12,Le,"0")},$t=zt||function(Le,dn,At){var Ke=Le<12?"AM":"PM";return At?Ke.toLowerCase():Ke};return ve.replace(U,function(Le,dn){return dn||function(At){switch(At){case"YY":return String(Ae.$y).slice(-2);case"YYYY":return pe.s(Ae.$y,4,"0");case"M":return Oe+1;case"MM":return pe.s(Oe+1,2,"0");case"MMM":return bt(Ce.monthsShort,Oe,Mt,3);case"MMMM":return bt(Mt,Oe);case"D":return Ae.$D;case"DD":return pe.s(Ae.$D,2,"0");case"d":return String(Ae.$W);case"dd":return bt(Ce.weekdaysMin,Ae.$W,Ct,2);case"ddd":return bt(Ce.weekdaysShort,Ae.$W,Ct,3);case"dddd":return Ct[Ae.$W];case"H":return String(We);case"HH":return pe.s(We,2,"0");case"h":return Kt(1);case"hh":return Kt(2);case"a":return $t(We,ot,!0);case"A":return $t(We,ot,!1);case"m":return String(ot);case"mm":return pe.s(ot,2,"0");case"s":return String(Ae.$s);case"ss":return pe.s(Ae.$s,2,"0");case"SSS":return pe.s(Ae.$ms,3,"0");case"Z":return Ne}return null}(Le)||Ne.replace(":","")})},Me.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Me.diff=function(xe,Ae,Ce){var ve,Ne=this,We=pe.p(Ae),ot=ce(xe),Oe=(ot.utcOffset()-this.utcOffset())*s,Ct=this-ot,Mt=function(){return pe.m(Ne,ot)};switch(We){case B:ve=Mt()/12;break;case I:ve=Mt();break;case F:ve=Mt()/3;break;case M:ve=(Ct-Oe)/6048e5;break;case C:ve=(Ct-Oe)/864e5;break;case w:ve=Ct/d;break;case o:ve=Ct/s;break;case _:ve=Ct/i;break;default:ve=Ct}return Ce?ve:pe.a(ve)},Me.daysInMonth=function(){return this.endOf(I).$D},Me.$locale=function(){return oe[this.$L]},Me.locale=function(xe,Ae){if(!xe)return this.$L;var Ce=this.clone(),ve=de(xe,Ae,!0);return ve&&(Ce.$L=ve),Ce},Me.clone=function(){return pe.w(this.$d,this)},Me.toDate=function(){return new Date(this.valueOf())},Me.toJSON=function(){return this.isValid()?this.toISOString():null},Me.toISOString=function(){return this.$d.toISOString()},Me.toString=function(){return this.$d.toUTCString()},Je}(),Re=ge.prototype;return ce.prototype=Re,[["$ms",p],["$s",_],["$m",o],["$H",w],["$W",C],["$M",I],["$y",B],["$D",N]].forEach(function(Je){Re[Je[1]]=function(Me){return this.$g(Me,Je[0],Je[1])}}),ce.extend=function(Je,Me){return Je.$i||(Je(Me,ge,ce),Je.$i=!0),ce},ce.locale=de,ce.isDayjs=me,ce.unix=function(Je){return ce(1e3*Je)},ce.en=oe[J],ce.Ls=oe,ce.p={},ce})})(cD);var FZ=cD.exports;const Mo=eu(FZ),Bw=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],gh=e=>Array.from(Array.from({length:e}).keys()),uD=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),dD=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),mP=function(e,t){const i=_h(e),s=_h(t);return i&&s?e.getTime()===t.getTime():!i&&!s?e===t:!1},gP=function(e,t){const i=fn(e),s=fn(t);return i&&s?e.length!==t.length?!1:e.every((d,p)=>mP(d,t[p])):!i&&!s?mP(e,t):!1},vP=function(e,t,i){const s=xl(t)||t==="x"?Mo(e).locale(i):Mo(e,t).locale(i);return s.isValid()?s:void 0},_P=function(e,t,i){return xl(t)?e:t==="x"?+e:Mo(e).locale(i).format(t)},Nw=(e,t)=>{var i;const s=[],d=t==null?void 0:t();for(let p=0;p<e;p++)s.push((i=d==null?void 0:d.includes(p))!=null?i:!1);return s},F0=e=>fn(e)?e.map(t=>t.toDate()):e.toDate(),BZ=(e,t)=>{const i=e.subtract(1,"month").endOf("month").date();return gh(t).map((s,d)=>i-(t-d-1))},NZ=e=>{const t=e.daysInMonth();return gh(t).map((i,s)=>s+1)},$Z=e=>gh(e.length/7).map(t=>{const i=t*7;return e.slice(i,i+7)}),VZ=vn({selectedDay:{type:ut(Object)},range:{type:ut(Array)},date:{type:ut(Object),required:!0},hideHeader:{type:Boolean}}),UZ={pick:e=>Vo(e)};var hD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){return function(i,s,d){var p=s.prototype,_=function(I){return I&&(I.indexOf?I:I.s)},o=function(I,F,B,N,D){var j=I.name?I:I.$locale(),U=_(j[F]),ne=_(j[B]),K=U||ne.map(function(J){return J.slice(0,N)});if(!D)return K;var G=j.weekStart;return K.map(function(J,oe){return K[(oe+(G||0))%7]})},w=function(){return d.Ls[d.locale()]},C=function(I,F){return I.formats[F]||function(B){return B.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(N,D,j){return D||j.slice(1)})}(I.formats[F.toUpperCase()])},M=function(){var I=this;return{months:function(F){return F?F.format("MMMM"):o(I,"months")},monthsShort:function(F){return F?F.format("MMM"):o(I,"monthsShort","months",3)},firstDayOfWeek:function(){return I.$locale().weekStart||0},weekdays:function(F){return F?F.format("dddd"):o(I,"weekdays")},weekdaysMin:function(F){return F?F.format("dd"):o(I,"weekdaysMin","weekdays",2)},weekdaysShort:function(F){return F?F.format("ddd"):o(I,"weekdaysShort","weekdays",3)},longDateFormat:function(F){return C(I.$locale(),F)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};p.localeData=function(){return M.bind(this)()},d.localeData=function(){var I=w();return{firstDayOfWeek:function(){return I.weekStart||0},weekdays:function(){return d.weekdays()},weekdaysShort:function(){return d.weekdaysShort()},weekdaysMin:function(){return d.weekdaysMin()},months:function(){return d.months()},monthsShort:function(){return d.monthsShort()},longDateFormat:function(F){return C(I,F)},meridiem:I.meridiem,ordinal:I.ordinal}},d.months=function(){return o(w(),"months")},d.monthsShort=function(){return o(w(),"monthsShort","months",3)},d.weekdays=function(I){return o(w(),"weekdays",null,null,I)},d.weekdaysShort=function(I){return o(w(),"weekdaysShort","weekdays",3,I)},d.weekdaysMin=function(I){return o(w(),"weekdaysMin","weekdays",2,I)}}})})(hD);var jZ=hD.exports;const fD=eu(jZ),HZ=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],$w=["sun","mon","tue","wed","thu","fri","sat"],GZ=(e,t)=>{Mo.extend(fD);const i=Mo.localeData().firstDayOfWeek(),{t:s,lang:d}=vr(),p=Mo().locale(d.value),_=te(()=>!!e.range&&!!e.range.length),o=te(()=>{let F=[];if(_.value){const[B,N]=e.range,D=gh(N.date()-B.date()+1).map(ne=>({text:B.date()+ne,type:"current"}));let j=D.length%7;j=j===0?0:7-j;const U=gh(j).map((ne,K)=>({text:K+1,type:"next"}));F=D.concat(U)}else{const B=e.date.startOf("month").day(),N=BZ(e.date,(B-i+7)%7).map(ne=>({text:ne,type:"prev"})),D=NZ(e.date).map(ne=>({text:ne,type:"current"}));F=[...N,...D];const j=7-(F.length%7||7),U=gh(j).map((ne,K)=>({text:K+1,type:"next"}));F=F.concat(U)}return $Z(F)}),w=te(()=>{const F=i;return F===0?$w.map(B=>s(`el.datepicker.weeks.${B}`)):$w.slice(F).concat($w.slice(0,F)).map(B=>s(`el.datepicker.weeks.${B}`))}),C=(F,B)=>{switch(B){case"prev":return e.date.startOf("month").subtract(1,"month").date(F);case"next":return e.date.startOf("month").add(1,"month").date(F);case"current":return e.date.date(F)}};return{now:p,isInRange:_,rows:o,weekDays:w,getFormattedDate:C,handlePickDay:({text:F,type:B})=>{const N=C(F,B);t("pick",N)},getSlotData:({text:F,type:B})=>{const N=C(F,B);return{isSelected:N.isSame(e.selectedDay),type:`${B}-month`,day:N.format("YYYY-MM-DD"),date:N.toDate()}}}},WZ=Ze({name:"DateTable"}),qZ=Ze({...WZ,props:VZ,emits:UZ,setup(e,{expose:t,emit:i}){const s=e,{isInRange:d,now:p,rows:_,weekDays:o,getFormattedDate:w,handlePickDay:C,getSlotData:M}=GZ(s,i),I=rn("calendar-table"),F=rn("calendar-day"),B=({text:N,type:D})=>{const j=[D];if(D==="current"){const U=w(N,D);U.isSame(s.selectedDay,"day")&&j.push(F.is("selected")),U.isSame(p,"day")&&j.push(F.is("today"))}return j};return t({getFormattedDate:w}),(N,D)=>(le(),Pe("table",{class:he([y(I).b(),y(I).is("range",y(d))]),cellspacing:"0",cellpadding:"0"},[N.hideHeader?St("v-if",!0):(le(),Pe("thead",{key:0},[Ve("tr",null,[(le(!0),Pe(eo,null,nr(y(o),j=>(le(),Pe("th",{key:j,scope:"col"},yn(j),1))),128))])])),Ve("tbody",null,[(le(!0),Pe(eo,null,nr(y(_),(j,U)=>(le(),Pe("tr",{key:U,class:he({[y(I).e("row")]:!0,[y(I).em("row","hide-border")]:U===0&&N.hideHeader})},[(le(!0),Pe(eo,null,nr(j,(ne,K)=>(le(),Pe("td",{key:K,class:he(B(ne)),onClick:G=>y(C)(ne)},[Ve("div",{class:he(y(F).b())},[_t(N.$slots,"date-cell",{data:y(M)(ne)},()=>[Ve("span",null,yn(ne.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var yP=xn(qZ,[["__file","date-table.vue"]]);const KZ=(e,t)=>{const i=e.endOf("month"),s=t.startOf("month"),p=i.isSame(s,"week")?s.add(1,"week"):s;return[[e,i],[p.startOf("week"),t]]},ZZ=(e,t)=>{const i=e.endOf("month"),s=e.add(1,"month").startOf("month"),d=i.isSame(s,"week")?s.add(1,"week"):s,p=d.endOf("month"),_=t.startOf("month"),o=p.isSame(_,"week")?_.add(1,"week"):_;return[[e,i],[d.startOf("week"),p],[o.startOf("week"),t]]},YZ=(e,t,i)=>{const{lang:s}=vr(),d=we(),p=Mo().locale(s.value),_=te({get(){return e.modelValue?w.value:d.value},set(j){if(!j)return;d.value=j;const U=j.toDate();t(Ga,U),t(Fo,U)}}),o=te(()=>{if(!e.range||!fn(e.range)||e.range.length!==2||e.range.some(K=>!_h(K)))return[];const j=e.range.map(K=>Mo(K).locale(s.value)),[U,ne]=j;return U.isAfter(ne)?[]:U.isSame(ne,"month")?B(U,ne):U.add(1,"month").month()!==ne.month()?[]:B(U,ne)}),w=te(()=>e.modelValue?Mo(e.modelValue).locale(s.value):_.value||(o.value.length?o.value[0][0]:p)),C=te(()=>w.value.subtract(1,"month").date(1)),M=te(()=>w.value.add(1,"month").date(1)),I=te(()=>w.value.subtract(1,"year").date(1)),F=te(()=>w.value.add(1,"year").date(1)),B=(j,U)=>{const ne=j.startOf("week"),K=U.endOf("week"),G=ne.get("month"),J=K.get("month");return G===J?[[ne,K]]:(G+1)%12===J?KZ(ne,K):G+2===J||(G+1)%11===J?ZZ(ne,K):[]},N=j=>{_.value=j};return{calculateValidatedDateRange:B,date:w,realSelectedDay:_,pickDay:N,selectDate:j=>{const ne={"prev-month":C.value,"next-month":M.value,"prev-year":I.value,"next-year":F.value,today:p}[j];ne.isSame(w.value,"day")||N(ne)},validatedRange:o}},XZ=e=>fn(e)&&e.length===2&&e.every(t=>_h(t)),JZ=vn({modelValue:{type:Date},range:{type:ut(Array),validator:XZ}}),QZ={[Fo]:e=>_h(e),[Ga]:e=>_h(e)},eY="ElCalendar",tY=Ze({name:eY}),nY=Ze({...tY,props:JZ,emits:QZ,setup(e,{expose:t,emit:i}){const s=e,d=rn("calendar"),{calculateValidatedDateRange:p,date:_,pickDay:o,realSelectedDay:w,selectDate:C,validatedRange:M}=YZ(s,i),{t:I}=vr(),F=te(()=>{const B=`el.datepicker.month${_.value.format("M")}`;return`${_.value.year()} ${I("el.datepicker.year")} ${I(B)}`});return t({selectedDay:w,pickDay:o,selectDate:C,calculateValidatedDateRange:p}),(B,N)=>(le(),Pe("div",{class:he(y(d).b())},[Ve("div",{class:he(y(d).e("header"))},[_t(B.$slots,"header",{date:y(F)},()=>[Ve("div",{class:he(y(d).e("title"))},yn(y(F)),3),y(M).length===0?(le(),Pe("div",{key:0,class:he(y(d).e("button-group"))},[Qe(y(lD),null,{default:at(()=>[Qe(y(Ta),{size:"small",onClick:D=>y(C)("prev-month")},{default:at(()=>[Qo(yn(y(I)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),Qe(y(Ta),{size:"small",onClick:D=>y(C)("today")},{default:at(()=>[Qo(yn(y(I)("el.datepicker.today")),1)]),_:1},8,["onClick"]),Qe(y(Ta),{size:"small",onClick:D=>y(C)("next-month")},{default:at(()=>[Qo(yn(y(I)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):St("v-if",!0)])],2),y(M).length===0?(le(),Pe("div",{key:0,class:he(y(d).e("body"))},[Qe(yP,{date:y(_),"selected-day":y(w),onPick:y(o)},nc({_:2},[B.$slots["date-cell"]?{name:"date-cell",fn:at(D=>[_t(B.$slots,"date-cell",Hc(yh(D)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(le(),Pe("div",{key:1,class:he(y(d).e("body"))},[(le(!0),Pe(eo,null,nr(y(M),(D,j)=>(le(),Rt(yP,{key:j,date:D[0],"selected-day":y(w),range:D,"hide-header":j!==0,onPick:y(o)},nc({_:2},[B.$slots["date-cell"]?{name:"date-cell",fn:at(U=>[_t(B.$slots,"date-cell",Hc(yh(U)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var oY=xn(nY,[["__file","calendar.vue"]]);const rY=Ao(oY),iY=vn({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:ut([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),aY=Ze({name:"ElCard"}),sY=Ze({...aY,props:iY,setup(e){const t=rn("card");return(i,s)=>(le(),Pe("div",{class:he([y(t).b(),y(t).is(`${i.shadow}-shadow`)])},[i.$slots.header||i.header?(le(),Pe("div",{key:0,class:he(y(t).e("header"))},[_t(i.$slots,"header",{},()=>[Qo(yn(i.header),1)])],2)):St("v-if",!0),Ve("div",{class:he([y(t).e("body"),i.bodyClass]),style:to(i.bodyStyle)},[_t(i.$slots,"default")],6),i.$slots.footer||i.footer?(le(),Pe("div",{key:1,class:he(y(t).e("footer"))},[_t(i.$slots,"footer",{},()=>[Qo(yn(i.footer),1)])],2)):St("v-if",!0)],2))}});var lY=xn(sY,[["__file","card.vue"]]);const cY=Ao(lY),uY=vn({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),dY={change:(e,t)=>[e,t].every(ao)},pD=Symbol("carouselContextKey"),R2="ElCarouselItem";var Yl=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Yl||{});function L2(e){return Ai(e)&&e.type===eo}function hY(e){return Ai(e)&&e.type===Sa}function fY(e){return Ai(e)&&!L2(e)&&!hY(e)}const pY=e=>{if(!Ai(e))return{};const t=e.props||{},i=(Ai(e.type)?e.type.props:void 0)||{},s={};return Object.keys(i).forEach(d=>{Tr(i[d],"default")&&(s[d]=i[d].default)}),Object.keys(t).forEach(d=>{s[Fs(d)]=t[d]}),s},mY=e=>{if(!fn(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},vh=e=>{const t=fn(e)?e:[e],i=[];return t.forEach(s=>{var d;fn(s)?i.push(...vh(s)):Ai(s)&&((d=s.component)!=null&&d.subTree)?i.push(s,...vh(s.component.subTree)):Ai(s)&&fn(s.children)?i.push(...vh(s.children)):i.push(s)}),i},gY=(e,t,i)=>vh(e.subTree).filter(p=>{var _;return Ai(p)&&((_=p.type)==null?void 0:_.name)===t&&!!p.component}).map(p=>p.component.uid).map(p=>i[p]).filter(p=>!!p),BT=(e,t)=>{const i={},s=gi([]);return{children:s,addChild:_=>{i[_.uid]=_,s.value=gY(e,t,i)},removeChild:_=>{delete i[_],s.value=s.value.filter(o=>o.uid!==_)}}},bP=300,vY=(e,t,i)=>{const{children:s,addChild:d,removeChild:p}=BT(jo(),R2),_=aa(),o=we(-1),w=we(null),C=we(!1),M=we(),I=we(0),F=we(!0),B=we(!0),N=we(!1),D=te(()=>e.arrow!=="never"&&!y(ne)),j=te(()=>s.value.some(zt=>zt.props.label.toString().length>0)),U=te(()=>e.type==="card"),ne=te(()=>e.direction==="vertical"),K=te(()=>e.height!=="auto"?{height:e.height}:{height:`${I.value}px`,overflow:"hidden"}),G=zf(zt=>{ce(zt)},bP,{trailing:!0}),J=zf(zt=>{ve(zt)},bP),oe=zt=>F.value?o.value<=1?zt<=1:zt>1:!0;function se(){w.value&&(clearInterval(w.value),w.value=null)}function me(){e.interval<=0||!e.autoplay||w.value||(w.value=setInterval(()=>de(),e.interval))}const de=()=>{B.value||(N.value=!0),B.value=!1,o.value<s.value.length-1?o.value=o.value+1:e.loop?o.value=0:N.value=!1};function ce(zt){if(B.value||(N.value=!0),B.value=!1,Zn(zt)){const $t=s.value.filter(Le=>Le.props.name===zt);$t.length>0&&(zt=s.value.indexOf($t[0]))}if(zt=Number(zt),Number.isNaN(zt)||zt!==Math.floor(zt))return;const bt=s.value.length,Kt=o.value;zt<0?o.value=e.loop?bt-1:0:zt>=bt?o.value=e.loop?0:bt-1:o.value=zt,Kt===o.value&&pe(Kt),ot()}function pe(zt){s.value.forEach((bt,Kt)=>{bt.translateItem(Kt,o.value,zt)})}function ge(zt,bt){var Kt,$t,Le,dn;const At=y(s),Ke=At.length;if(Ke===0||!zt.states.inStage)return!1;const Be=bt+1,Ht=bt-1,Ut=Ke-1,Nt=At[Ut].states.active,Et=At[0].states.active,Gt=($t=(Kt=At[Be])==null?void 0:Kt.states)==null?void 0:$t.active,ln=(dn=(Le=At[Ht])==null?void 0:Le.states)==null?void 0:dn.active;return bt===Ut&&Et||Gt?"left":bt===0&&Nt||ln?"right":!1}function Re(){C.value=!0,e.pauseOnHover&&se()}function Je(){C.value=!1,me()}function Me(){N.value=!1}function xe(zt){y(ne)||s.value.forEach((bt,Kt)=>{zt===ge(bt,Kt)&&(bt.states.hover=!0)})}function Ae(){y(ne)||s.value.forEach(zt=>{zt.states.hover=!1})}function Ce(zt){zt!==o.value&&(B.value||(N.value=!0)),o.value=zt}function ve(zt){e.trigger==="hover"&&zt!==o.value&&(o.value=zt,B.value||(N.value=!0))}function Ne(){ce(o.value-1)}function We(){ce(o.value+1)}function ot(){se(),e.pauseOnHover||me()}function Oe(zt){e.height==="auto"&&(I.value=zt)}function Ct(){var zt;const bt=(zt=_.default)==null?void 0:zt.call(_);if(!bt)return null;const $t=vh(bt).filter(Le=>Ai(Le)&&Le.type.name===R2);return($t==null?void 0:$t.length)===2&&e.loop&&!U.value?(F.value=!0,$t):(F.value=!1,null)}tn(()=>o.value,(zt,bt)=>{pe(bt),F.value&&(zt=zt%2,bt=bt%2),bt>-1&&t("change",zt,bt)}),tn(()=>e.autoplay,zt=>{zt?me():se()}),tn(()=>e.loop,()=>{ce(o.value)}),tn(()=>e.interval,()=>{ot()});const Mt=gi();return No(()=>{tn(()=>s.value,()=>{s.value.length>0&&ce(e.initialIndex)},{immediate:!0}),Mt.value=Mi(M.value,()=>{pe()}),me()}),ni(()=>{se(),M.value&&Mt.value&&Mt.value.stop()}),or(pD,{root:M,isCardType:U,isVertical:ne,items:s,loop:e.loop,cardScale:e.cardScale,addItem:d,removeItem:p,setActiveItem:ce,setContainerHeight:Oe}),{root:M,activeIndex:o,arrowDisplay:D,hasLabel:j,hover:C,isCardType:U,isTransitioning:N,items:s,isVertical:ne,containerStyle:K,isItemsTwoLength:F,handleButtonEnter:xe,handleTransitionEnd:Me,handleButtonLeave:Ae,handleIndicatorClick:Ce,handleMouseEnter:Re,handleMouseLeave:Je,setActiveItem:ce,prev:Ne,next:We,PlaceholderItem:Ct,isTwoLengthShow:oe,throttledArrowClick:G,throttledIndicatorHover:J}},_Y="ElCarousel",yY=Ze({name:_Y}),bY=Ze({...yY,props:uY,emits:dY,setup(e,{expose:t,emit:i}){const s=e,{root:d,activeIndex:p,arrowDisplay:_,hasLabel:o,hover:w,isCardType:C,items:M,isVertical:I,containerStyle:F,handleButtonEnter:B,handleButtonLeave:N,isTransitioning:D,handleIndicatorClick:j,handleMouseEnter:U,handleMouseLeave:ne,handleTransitionEnd:K,setActiveItem:G,prev:J,next:oe,PlaceholderItem:se,isTwoLengthShow:me,throttledArrowClick:de,throttledIndicatorHover:ce}=vY(s,i),pe=rn("carousel"),{t:ge}=vr(),Re=te(()=>{const xe=[pe.b(),pe.m(s.direction)];return y(C)&&xe.push(pe.m("card")),xe}),Je=te(()=>{const xe=[pe.e("container")];return s.motionBlur&&y(D)&&M.value.length>1&&xe.push(y(I)?`${pe.namespace.value}-transitioning-vertical`:`${pe.namespace.value}-transitioning`),xe}),Me=te(()=>{const xe=[pe.e("indicators"),pe.em("indicators",s.direction)];return y(o)&&xe.push(pe.em("indicators","labels")),s.indicatorPosition==="outside"&&xe.push(pe.em("indicators","outside")),y(I)&&xe.push(pe.em("indicators","right")),xe});return t({activeIndex:p,setActiveItem:G,prev:J,next:oe}),(xe,Ae)=>(le(),Pe("div",{ref_key:"root",ref:d,class:he(y(Re)),onMouseenter:po(y(U),["stop"]),onMouseleave:po(y(ne),["stop"])},[y(_)?(le(),Rt(Ea,{key:0,name:"carousel-arrow-left",persisted:""},{default:at(()=>[zo(Ve("button",{type:"button",class:he([y(pe).e("arrow"),y(pe).em("arrow","left")]),"aria-label":y(ge)("el.carousel.leftArrow"),onMouseenter:Ce=>y(B)("left"),onMouseleave:y(N),onClick:po(Ce=>y(de)(y(p)-1),["stop"])},[Qe(y(Gn),null,{default:at(()=>[Qe(y(Sh))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Cr,(xe.arrow==="always"||y(w))&&(s.loop||y(p)>0)]])]),_:1})):St("v-if",!0),y(_)?(le(),Rt(Ea,{key:1,name:"carousel-arrow-right",persisted:""},{default:at(()=>[zo(Ve("button",{type:"button",class:he([y(pe).e("arrow"),y(pe).em("arrow","right")]),"aria-label":y(ge)("el.carousel.rightArrow"),onMouseenter:Ce=>y(B)("right"),onMouseleave:y(N),onClick:po(Ce=>y(de)(y(p)+1),["stop"])},[Qe(y(Gn),null,{default:at(()=>[Qe(y(zs))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Cr,(xe.arrow==="always"||y(w))&&(s.loop||y(p)<y(M).length-1)]])]),_:1})):St("v-if",!0),Ve("div",{class:he(y(Je)),style:to(y(F)),onTransitionend:y(K)},[Qe(y(se)),_t(xe.$slots,"default")],46,["onTransitionend"]),xe.indicatorPosition!=="none"?(le(),Pe("ul",{key:2,class:he(y(Me))},[(le(!0),Pe(eo,null,nr(y(M),(Ce,ve)=>zo((le(),Pe("li",{key:ve,class:he([y(pe).e("indicator"),y(pe).em("indicator",xe.direction),y(pe).is("active",ve===y(p))]),onMouseenter:Ne=>y(ce)(ve),onClick:po(Ne=>y(j)(ve),["stop"])},[Ve("button",{class:he(y(pe).e("button")),"aria-label":y(ge)("el.carousel.indicator",{index:ve+1})},[y(o)?(le(),Pe("span",{key:0},yn(Ce.props.label),1)):St("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[Cr,y(me)(ve)]])),128))],2)):St("v-if",!0),s.motionBlur?(le(),Pe("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[Ve("defs",null,[Ve("filter",{id:"elCarouselHorizontal"},[Ve("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),Ve("filter",{id:"elCarouselVertical"},[Ve("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):St("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var xY=xn(bY,[["__file","carousel.vue"]]);const wY=vn({name:{type:String,default:""},label:{type:[String,Number],default:""}}),SY=e=>{const t=Un(pD),i=jo(),s=we(),d=we(!1),p=we(0),_=we(1),o=we(!1),w=we(!1),C=we(!1),M=we(!1),{isCardType:I,isVertical:F,cardScale:B}=t;function N(K,G,J){const oe=J-1,se=G-1,me=G+1,de=J/2;return G===0&&K===oe?-1:G===oe&&K===0?J:K<se&&G-K>=de?J+1:K>me&&K-G>=de?-2:K}function D(K,G){var J,oe;const se=y(F)?((J=t.root.value)==null?void 0:J.offsetHeight)||0:((oe=t.root.value)==null?void 0:oe.offsetWidth)||0;return C.value?se*((2-B)*(K-G)+1)/4:K<G?-(1+B)*se/4:(3+B)*se/4}function j(K,G,J){const oe=t.root.value;return oe?((J?oe.offsetHeight:oe.offsetWidth)||0)*(K-G):0}const U=(K,G,J)=>{var oe;const se=y(I),me=(oe=t.items.value.length)!=null?oe:Number.NaN,de=K===G;!se&&!Hr(J)&&(M.value=de||K===J),!de&&me>2&&t.loop&&(K=N(K,G,me));const ce=y(F);o.value=de,se?(C.value=Math.round(Math.abs(K-G))<=1,p.value=D(K,G),_.value=y(o)?1:B):p.value=j(K,G,ce),w.value=!0,de&&s.value&&t.setContainerHeight(s.value.offsetHeight)};function ne(){if(t&&y(I)){const K=t.items.value.findIndex(({uid:G})=>G===i.uid);t.setActiveItem(K)}}return No(()=>{t.addItem({props:e,states:Ir({hover:d,translate:p,scale:_,active:o,ready:w,inStage:C,animating:M}),uid:i.uid,translateItem:U})}),kh(()=>{t.removeItem(i.uid)}),{carouselItemRef:s,active:o,animating:M,hover:d,inStage:C,isVertical:F,translate:p,isCardType:I,scale:_,ready:w,handleItemClick:ne}},TY=Ze({name:R2}),CY=Ze({...TY,props:wY,setup(e){const t=e,i=rn("carousel"),{carouselItemRef:s,active:d,animating:p,hover:_,inStage:o,isVertical:w,translate:C,isCardType:M,scale:I,ready:F,handleItemClick:B}=SY(t),N=te(()=>[i.e("item"),i.is("active",d.value),i.is("in-stage",o.value),i.is("hover",_.value),i.is("animating",p.value),{[i.em("item","card")]:M.value,[i.em("item","card-vertical")]:M.value&&w.value}]),D=te(()=>{const U=`${`translate${y(w)?"Y":"X"}`}(${y(C)}px)`,ne=`scale(${y(I)})`;return{transform:[U,ne].join(" ")}});return(j,U)=>zo((le(),Pe("div",{ref_key:"carouselItemRef",ref:s,class:he(y(N)),style:to(y(D)),onClick:y(B)},[y(M)?zo((le(),Pe("div",{key:0,class:he(y(i).e("mask"))},null,2)),[[Cr,!y(d)]]):St("v-if",!0),_t(j.$slots,"default")],14,["onClick"])),[[Cr,y(F)]])}});var mD=xn(CY,[["__file","carousel-item.vue"]]);const EY=Ao(xY,{CarouselItem:mD}),MY=Li(mD),gD={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:ia,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...Da(["ariaControls"])},vD={[Fo]:e=>Zn(e)||ao(e)||ai(e),change:e=>Zn(e)||ao(e)||ai(e)},Xm=Symbol("checkboxGroupContextKey"),IY=({model:e,isChecked:t})=>{const i=Un(Xm,void 0),s=te(()=>{var p,_;const o=(p=i==null?void 0:i.max)==null?void 0:p.value,w=(_=i==null?void 0:i.min)==null?void 0:_.value;return!Hr(o)&&e.value.length>=o&&!t.value||!Hr(w)&&e.value.length<=w&&t.value});return{isDisabled:Za(te(()=>(i==null?void 0:i.disabled.value)||s.value)),isLimitDisabled:s}},AY=(e,{model:t,isLimitExceeded:i,hasOwnLabel:s,isDisabled:d,isLabeledByFormItem:p})=>{const _=Un(Xm,void 0),{formItem:o}=Ka(),{emit:w}=jo();function C(N){var D,j,U,ne;return[!0,e.trueValue,e.trueLabel].includes(N)?(j=(D=e.trueValue)!=null?D:e.trueLabel)!=null?j:!0:(ne=(U=e.falseValue)!=null?U:e.falseLabel)!=null?ne:!1}function M(N,D){w("change",C(N),D)}function I(N){if(i.value)return;const D=N.target;w("change",C(D.checked),N)}async function F(N){i.value||!s.value&&!d.value&&p.value&&(N.composedPath().some(U=>U.tagName==="LABEL")||(t.value=C([!1,e.falseValue,e.falseLabel].includes(t.value)),await oo(),M(t.value,N)))}const B=te(()=>(_==null?void 0:_.validateEvent)||e.validateEvent);return tn(()=>e.modelValue,()=>{B.value&&(o==null||o.validate("change").catch(N=>void 0))}),{handleChange:I,onClickRoot:F}},kY=e=>{const t=we(!1),{emit:i}=jo(),s=Un(Xm,void 0),d=te(()=>Hr(s)===!1),p=we(!1),_=te({get(){var o,w;return d.value?(o=s==null?void 0:s.modelValue)==null?void 0:o.value:(w=e.modelValue)!=null?w:t.value},set(o){var w,C;d.value&&fn(o)?(p.value=((w=s==null?void 0:s.max)==null?void 0:w.value)!==void 0&&o.length>(s==null?void 0:s.max.value)&&o.length>_.value.length,p.value===!1&&((C=s==null?void 0:s.changeEvent)==null||C.call(s,o))):(i(Fo,o),t.value=o)}});return{model:_,isGroup:d,isLimitExceeded:p}},PY=(e,t,{model:i})=>{const s=Un(Xm,void 0),d=we(!1),p=te(()=>jf(e.value)?e.label:e.value),_=te(()=>{const M=i.value;return ai(M)?M:fn(M)?Vo(p.value)?M.map(ei).some(I=>La(I,p.value)):M.map(ei).includes(p.value):M!=null?M===e.trueValue||M===e.trueLabel:!!M}),o=na(te(()=>{var M;return(M=s==null?void 0:s.size)==null?void 0:M.value}),{prop:!0}),w=na(te(()=>{var M;return(M=s==null?void 0:s.size)==null?void 0:M.value})),C=te(()=>!!t.default||!jf(p.value));return{checkboxButtonSize:o,isChecked:_,isFocused:d,checkboxSize:w,hasOwnLabel:C,actualValue:p}},_D=(e,t)=>{const{formItem:i}=Ka(),{model:s,isGroup:d,isLimitExceeded:p}=kY(e),{isFocused:_,isChecked:o,checkboxButtonSize:w,checkboxSize:C,hasOwnLabel:M,actualValue:I}=PY(e,t,{model:s}),{isDisabled:F}=IY({model:s,isChecked:o}),{inputId:B,isLabeledByFormItem:N}=sc(e,{formItemContext:i,disableIdGeneration:M,disableIdManagement:d}),{handleChange:D,onClickRoot:j}=AY(e,{model:s,isLimitExceeded:p,hasOwnLabel:M,isDisabled:F,isLabeledByFormItem:N});return(()=>{function ne(){var K,G;fn(s.value)&&!s.value.includes(I.value)?s.value.push(I.value):s.value=(G=(K=e.trueValue)!=null?K:e.trueLabel)!=null?G:!0}e.checked&&ne()})(),mh({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},te(()=>d.value&&jf(e.value))),mh({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},te(()=>!!e.trueLabel)),mh({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},te(()=>!!e.falseLabel)),{inputId:B,isLabeledByFormItem:N,isChecked:o,isDisabled:F,isFocused:_,checkboxButtonSize:w,checkboxSize:C,hasOwnLabel:M,model:s,actualValue:I,handleChange:D,onClickRoot:j}},RY=Ze({name:"ElCheckbox"}),LY=Ze({...RY,props:gD,emits:vD,setup(e){const t=e,i=aa(),{inputId:s,isLabeledByFormItem:d,isChecked:p,isDisabled:_,isFocused:o,checkboxSize:w,hasOwnLabel:C,model:M,actualValue:I,handleChange:F,onClickRoot:B}=_D(t,i),N=rn("checkbox"),D=te(()=>[N.b(),N.m(w.value),N.is("disabled",_.value),N.is("bordered",t.border),N.is("checked",p.value)]),j=te(()=>[N.e("input"),N.is("disabled",_.value),N.is("checked",p.value),N.is("indeterminate",t.indeterminate),N.is("focus",o.value)]);return(U,ne)=>(le(),Rt(Wo(!y(C)&&y(d)?"span":"label"),{class:he(y(D)),"aria-controls":U.indeterminate?U.ariaControls:null,onClick:y(B)},{default:at(()=>{var K,G,J,oe;return[Ve("span",{class:he(y(j))},[U.trueValue||U.falseValue||U.trueLabel||U.falseLabel?zo((le(),Pe("input",{key:0,id:y(s),"onUpdate:modelValue":se=>vi(M)?M.value=se:null,class:he(y(N).e("original")),type:"checkbox",indeterminate:U.indeterminate,name:U.name,tabindex:U.tabindex,disabled:y(_),"true-value":(G=(K=U.trueValue)!=null?K:U.trueLabel)!=null?G:!0,"false-value":(oe=(J=U.falseValue)!=null?J:U.falseLabel)!=null?oe:!1,onChange:y(F),onFocus:se=>o.value=!0,onBlur:se=>o.value=!1,onClick:po(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[wb,y(M)]]):zo((le(),Pe("input",{key:1,id:y(s),"onUpdate:modelValue":se=>vi(M)?M.value=se:null,class:he(y(N).e("original")),type:"checkbox",indeterminate:U.indeterminate,disabled:y(_),value:y(I),name:U.name,tabindex:U.tabindex,onChange:y(F),onFocus:se=>o.value=!0,onBlur:se=>o.value=!1,onClick:po(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[wb,y(M)]]),Ve("span",{class:he(y(N).e("inner"))},null,2)],2),y(C)?(le(),Pe("span",{key:0,class:he(y(N).e("label"))},[_t(U.$slots,"default"),U.$slots.default?St("v-if",!0):(le(),Pe(eo,{key:0},[Qo(yn(U.label),1)],64))],2)):St("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var OY=xn(LY,[["__file","checkbox.vue"]]);const DY=Ze({name:"ElCheckboxButton"}),zY=Ze({...DY,props:gD,emits:vD,setup(e){const t=e,i=aa(),{isFocused:s,isChecked:d,isDisabled:p,checkboxButtonSize:_,model:o,actualValue:w,handleChange:C}=_D(t,i),M=Un(Xm,void 0),I=rn("checkbox"),F=te(()=>{var N,D,j,U;const ne=(D=(N=M==null?void 0:M.fill)==null?void 0:N.value)!=null?D:"";return{backgroundColor:ne,borderColor:ne,color:(U=(j=M==null?void 0:M.textColor)==null?void 0:j.value)!=null?U:"",boxShadow:ne?`-1px 0 0 0 ${ne}`:void 0}}),B=te(()=>[I.b("button"),I.bm("button",_.value),I.is("disabled",p.value),I.is("checked",d.value),I.is("focus",s.value)]);return(N,D)=>{var j,U,ne,K;return le(),Pe("label",{class:he(y(B))},[N.trueValue||N.falseValue||N.trueLabel||N.falseLabel?zo((le(),Pe("input",{key:0,"onUpdate:modelValue":G=>vi(o)?o.value=G:null,class:he(y(I).be("button","original")),type:"checkbox",name:N.name,tabindex:N.tabindex,disabled:y(p),"true-value":(U=(j=N.trueValue)!=null?j:N.trueLabel)!=null?U:!0,"false-value":(K=(ne=N.falseValue)!=null?ne:N.falseLabel)!=null?K:!1,onChange:y(C),onFocus:G=>s.value=!0,onBlur:G=>s.value=!1,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[wb,y(o)]]):zo((le(),Pe("input",{key:1,"onUpdate:modelValue":G=>vi(o)?o.value=G:null,class:he(y(I).be("button","original")),type:"checkbox",name:N.name,tabindex:N.tabindex,disabled:y(p),value:y(w),onChange:y(C),onFocus:G=>s.value=!0,onBlur:G=>s.value=!1,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[wb,y(o)]]),N.$slots.default||N.label?(le(),Pe("span",{key:2,class:he(y(I).be("button","inner")),style:to(y(d)?y(F):void 0)},[_t(N.$slots,"default",{},()=>[Qo(yn(N.label),1)])],6)):St("v-if",!0)],2)}}});var yD=xn(zY,[["__file","checkbox-button.vue"]]);const FY=vn({modelValue:{type:ut(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:ia,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),BY={[Fo]:e=>fn(e),change:e=>fn(e)},NY=Ze({name:"ElCheckboxGroup"}),$Y=Ze({...NY,props:FY,emits:BY,setup(e,{emit:t}){const i=e,s=rn("checkbox"),{formItem:d}=Ka(),{inputId:p,isLabeledByFormItem:_}=sc(i,{formItemContext:d}),o=async C=>{t(Fo,C),await oo(),t("change",C)},w=te({get(){return i.modelValue},set(C){o(C)}});return or(Xm,{...Gc(Ca(i),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:w,changeEvent:o}),tn(()=>i.modelValue,()=>{i.validateEvent&&(d==null||d.validate("change").catch(C=>void 0))}),(C,M)=>{var I;return le(),Rt(Wo(C.tag),{id:y(p),class:he(y(s).b("group")),role:"group","aria-label":y(_)?void 0:C.ariaLabel||"checkbox-group","aria-labelledby":y(_)?(I=y(d))==null?void 0:I.labelId:void 0},{default:at(()=>[_t(C.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var bD=xn($Y,[["__file","checkbox-group.vue"]]);const ac=Ao(OY,{CheckboxButton:yD,CheckboxGroup:bD}),VY=Li(yD),xD=Li(bD),wD=vn({modelValue:{type:[String,Number,Boolean],default:void 0},size:ia,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),UY=vn({...wD,border:Boolean}),SD={[Fo]:e=>Zn(e)||ao(e)||ai(e),[Yr]:e=>Zn(e)||ao(e)||ai(e)},TD=Symbol("radioGroupKey"),CD=(e,t)=>{const i=we(),s=Un(TD,void 0),d=te(()=>!!s),p=te(()=>jf(e.value)?e.label:e.value),_=te({get(){return d.value?s.modelValue:e.modelValue},set(I){d.value?s.changeEvent(I):t&&t(Fo,I),i.value.checked=e.modelValue===p.value}}),o=na(te(()=>s==null?void 0:s.size)),w=Za(te(()=>s==null?void 0:s.disabled)),C=we(!1),M=te(()=>w.value||d.value&&_.value!==p.value?-1:0);return mh({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},te(()=>d.value&&jf(e.value))),{radioRef:i,isGroup:d,radioGroup:s,focus:C,size:o,disabled:w,tabIndex:M,modelValue:_,actualValue:p}},jY=Ze({name:"ElRadio"}),HY=Ze({...jY,props:UY,emits:SD,setup(e,{emit:t}){const i=e,s=rn("radio"),{radioRef:d,radioGroup:p,focus:_,size:o,disabled:w,modelValue:C,actualValue:M}=CD(i,t);function I(){oo(()=>t("change",C.value))}return(F,B)=>{var N;return le(),Pe("label",{class:he([y(s).b(),y(s).is("disabled",y(w)),y(s).is("focus",y(_)),y(s).is("bordered",F.border),y(s).is("checked",y(C)===y(M)),y(s).m(y(o))])},[Ve("span",{class:he([y(s).e("input"),y(s).is("disabled",y(w)),y(s).is("checked",y(C)===y(M))])},[zo(Ve("input",{ref_key:"radioRef",ref:d,"onUpdate:modelValue":D=>vi(C)?C.value=D:null,class:he(y(s).e("original")),value:y(M),name:F.name||((N=y(p))==null?void 0:N.name),disabled:y(w),checked:y(C)===y(M),type:"radio",onFocus:D=>_.value=!0,onBlur:D=>_.value=!1,onChange:I,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[nL,y(C)]]),Ve("span",{class:he(y(s).e("inner"))},null,2)],2),Ve("span",{class:he(y(s).e("label")),onKeydown:po(()=>{},["stop"])},[_t(F.$slots,"default",{},()=>[Qo(yn(F.label),1)])],42,["onKeydown"])],2)}}});var GY=xn(HY,[["__file","radio.vue"]]);const WY=vn({...wD}),qY=Ze({name:"ElRadioButton"}),KY=Ze({...qY,props:WY,setup(e){const t=e,i=rn("radio"),{radioRef:s,focus:d,size:p,disabled:_,modelValue:o,radioGroup:w,actualValue:C}=CD(t),M=te(()=>({backgroundColor:(w==null?void 0:w.fill)||"",borderColor:(w==null?void 0:w.fill)||"",boxShadow:w!=null&&w.fill?`-1px 0 0 0 ${w.fill}`:"",color:(w==null?void 0:w.textColor)||""}));return(I,F)=>{var B;return le(),Pe("label",{class:he([y(i).b("button"),y(i).is("active",y(o)===y(C)),y(i).is("disabled",y(_)),y(i).is("focus",y(d)),y(i).bm("button",y(p))])},[zo(Ve("input",{ref_key:"radioRef",ref:s,"onUpdate:modelValue":N=>vi(o)?o.value=N:null,class:he(y(i).be("button","original-radio")),value:y(C),type:"radio",name:I.name||((B=y(w))==null?void 0:B.name),disabled:y(_),onFocus:N=>d.value=!0,onBlur:N=>d.value=!1,onClick:po(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[nL,y(o)]]),Ve("span",{class:he(y(i).be("button","inner")),style:to(y(o)===y(C)?y(M):{}),onKeydown:po(()=>{},["stop"])},[_t(I.$slots,"default",{},()=>[Qo(yn(I.label),1)])],46,["onKeydown"])],2)}}});var ED=xn(KY,[["__file","radio-button.vue"]]);const ZY=vn({id:{type:String,default:void 0},size:ia,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),YY=SD,XY=Ze({name:"ElRadioGroup"}),JY=Ze({...XY,props:ZY,emits:YY,setup(e,{emit:t}){const i=e,s=rn("radio"),d=Oa(),p=we(),{formItem:_}=Ka(),{inputId:o,isLabeledByFormItem:w}=sc(i,{formItemContext:_}),C=I=>{t(Fo,I),oo(()=>t("change",I))};No(()=>{const I=p.value.querySelectorAll("[type=radio]"),F=I[0];!Array.from(I).some(B=>B.checked)&&F&&(F.tabIndex=0)});const M=te(()=>i.name||d.value);return or(TD,Ir({...Ca(i),changeEvent:C,name:M})),tn(()=>i.modelValue,()=>{i.validateEvent&&(_==null||_.validate("change").catch(I=>void 0))}),(I,F)=>(le(),Pe("div",{id:y(o),ref_key:"radioGroupRef",ref:p,class:he(y(s).b("group")),role:"radiogroup","aria-label":y(w)?void 0:I.ariaLabel||"radio-group","aria-labelledby":y(w)?y(_).labelId:void 0},[_t(I.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var MD=xn(JY,[["__file","radio-group.vue"]]);const ID=Ao(GY,{RadioButton:ED,RadioGroup:MD}),QY=Li(MD),eX=Li(ED);var tX=Ze({name:"NodeContent",setup(){return{ns:rn("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:i}=this.$parent,{data:s,label:d}=t,{renderLabelFn:p}=i;return lo("span",{class:e.e("label")},p?p({node:t,data:s}):d)}});const NT=Symbol(),nX=Ze({name:"ElCascaderNode",components:{ElCheckbox:ac,ElRadio:ID,NodeContent:tX,ElIcon:Gn,Check:U_,Loading:Iu,ArrowRight:zs},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const i=Un(NT),s=rn("cascader-node"),d=te(()=>i.isHoverMenu),p=te(()=>i.config.multiple),_=te(()=>i.config.checkStrictly),o=te(()=>{var oe;return(oe=i.checkedNodes[0])==null?void 0:oe.uid}),w=te(()=>e.node.isDisabled),C=te(()=>e.node.isLeaf),M=te(()=>_.value&&!C.value||!w.value),I=te(()=>B(i.expandingNode)),F=te(()=>_.value&&i.checkedNodes.some(B)),B=oe=>{var se;const{level:me,uid:de}=e.node;return((se=oe==null?void 0:oe.pathNodes[me-1])==null?void 0:se.uid)===de},N=()=>{I.value||i.expandNode(e.node)},D=oe=>{const{node:se}=e;oe!==se.checked&&i.handleCheckChange(se,oe)},j=()=>{i.lazyLoad(e.node,()=>{C.value||N()})},U=oe=>{d.value&&(ne(),!C.value&&t("expand",oe))},ne=()=>{const{node:oe}=e;!M.value||oe.loading||(oe.loaded?N():j())},K=()=>{d.value&&!C.value||(C.value&&!w.value&&!_.value&&!p.value?J(!0):ne())},G=oe=>{_.value?(D(oe),e.node.loaded&&N()):J(oe)},J=oe=>{e.node.loaded?(D(oe),!_.value&&N()):j()};return{panel:i,isHoverMenu:d,multiple:p,checkStrictly:_,checkedNodeId:o,isDisabled:w,isLeaf:C,expandable:M,inExpandingPath:I,inCheckedPath:F,ns:s,handleHoverExpand:U,handleExpand:ne,handleClick:K,handleCheck:J,handleSelectCheck:G}}});function oX(e,t,i,s,d,p){const _=Go("el-checkbox"),o=Go("el-radio"),w=Go("check"),C=Go("el-icon"),M=Go("node-content"),I=Go("loading"),F=Go("arrow-right");return le(),Pe("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:he([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[St(" prefix "),e.multiple?(le(),Rt(_,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:po(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(le(),Rt(o,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:po(()=>{},["stop"])},{default:at(()=>[St(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Ve("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(le(),Rt(C,{key:2,class:he(e.ns.e("prefix"))},{default:at(()=>[Qe(w)]),_:1},8,["class"])):St("v-if",!0),St(" content "),Qe(M),St(" postfix "),e.isLeaf?St("v-if",!0):(le(),Pe(eo,{key:3},[e.node.loading?(le(),Rt(C,{key:0,class:he([e.ns.is("loading"),e.ns.e("postfix")])},{default:at(()=>[Qe(I)]),_:1},8,["class"])):(le(),Rt(C,{key:1,class:he(["arrow-right",e.ns.e("postfix")])},{default:at(()=>[Qe(F)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var rX=xn(nX,[["render",oX],["__file","node.vue"]]);const iX=Ze({name:"ElCascaderMenu",components:{Loading:Iu,ElIcon:Gn,ElScrollbar:Ou,ElCascaderNode:rX},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=jo(),i=rn("cascader-menu"),{t:s}=vr(),d=Oa();let p=null,_=null;const o=Un(NT),w=we(null),C=te(()=>!e.nodes.length),M=te(()=>!o.initialLoaded),I=te(()=>`${d.value}-${e.index}`),F=j=>{p=j.target},B=j=>{if(!(!o.isHoverMenu||!p||!w.value))if(p.contains(j.target)){N();const U=t.vnode.el,{left:ne}=U.getBoundingClientRect(),{offsetWidth:K,offsetHeight:G}=U,J=j.clientX-ne,oe=p.offsetTop,se=oe+p.offsetHeight;w.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${oe} L${K} 0 V${oe} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${se} L${K} ${G} V${se} Z" />
        `}else _||(_=window.setTimeout(D,o.config.hoverThreshold))},N=()=>{_&&(clearTimeout(_),_=null)},D=()=>{w.value&&(w.value.innerHTML="",N())};return{ns:i,panel:o,hoverZone:w,isEmpty:C,isLoading:M,menuId:I,t:s,handleExpand:F,handleMouseMove:B,clearHoverZone:D}}});function aX(e,t,i,s,d,p){const _=Go("el-cascader-node"),o=Go("loading"),w=Go("el-icon"),C=Go("el-scrollbar");return le(),Rt(C,{key:e.menuId,tag:"ul",role:"menu",class:he(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:at(()=>{var M;return[(le(!0),Pe(eo,null,nr(e.nodes,I=>(le(),Rt(_,{key:I.uid,node:I,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(le(),Pe("div",{key:0,class:he(e.ns.e("empty-text"))},[Qe(w,{size:"14",class:he(e.ns.is("loading"))},{default:at(()=>[Qe(o)]),_:1},8,["class"]),Qo(" "+yn(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(le(),Pe("div",{key:1,class:he(e.ns.e("empty-text"))},[_t(e.$slots,"empty",{},()=>[Qo(yn(e.t("el.cascader.noData")),1)])],2)):(M=e.panel)!=null&&M.isHoverMenu?(le(),Pe("svg",{key:2,ref:"hoverZone",class:he(e.ns.e("hover-zone"))},null,2)):St("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var sX=xn(iX,[["render",aX],["__file","menu.vue"]]);const $T=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Su=e=>L_(e);let lX=0;const cX=e=>{const t=[e];let{parent:i}=e;for(;i;)t.unshift(i),i=i.parent;return t};let O2=class D2{constructor(t,i,s,d=!1){this.data=t,this.config=i,this.parent=s,this.root=d,this.uid=lX++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:p,label:_,children:o}=i,w=t[o],C=cX(this);this.level=d?0:s?s.level+1:1,this.value=t[p],this.label=t[_],this.pathNodes=C,this.pathValues=C.map(M=>M.value),this.pathLabels=C.map(M=>M.label),this.childrenData=w,this.children=(w||[]).map(M=>new D2(M,i,this)),this.loaded=!i.lazy||this.isLeaf||!xl(w)}get isDisabled(){const{data:t,parent:i,config:s}=this,{disabled:d,checkStrictly:p}=s;return(Qn(d)?d(t,this):!!t[d])||!p&&(i==null?void 0:i.isDisabled)}get isLeaf(){const{data:t,config:i,childrenData:s,loaded:d}=this,{lazy:p,leaf:_}=i,o=Qn(_)?_(t,this):t[_];return Hr(o)?p&&!d?!1:!(fn(s)&&s.length):!!o}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:i,children:s}=this,d=new D2(t,this.config,this);return fn(i)?i.push(t):this.childrenData=[t],s.push(d),d}calcText(t,i){const s=t?this.pathLabels.join(i):this.label;return this.text=s,s}broadcast(t,...i){const s=`onParent${Su(t)}`;this.children.forEach(d=>{d&&(d.broadcast(t,...i),d[s]&&d[s](...i))})}emit(t,...i){const{parent:s}=this,d=`onChild${Su(t)}`;s&&(s[d]&&s[d](...i),s.emit(t,...i))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,i=t.filter(d=>!d.isDisabled),s=i.length?i.every(d=>d.checked):!1;this.setCheckState(s)}setCheckState(t){const i=this.children.length,s=this.children.reduce((d,p)=>{const _=p.checked?1:p.indeterminate?.5:0;return d+_},0);this.checked=this.loaded&&this.children.filter(d=>!d.isDisabled).every(d=>d.loaded&&d.checked)&&t,this.indeterminate=this.loaded&&s!==i&&s>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:i,multiple:s}=this.config;i||!s?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const z2=(e,t)=>e.reduce((i,s)=>(s.isLeaf?i.push(s):(!t&&i.push(s),i=i.concat(z2(s.children,t))),i),[]);class xP{constructor(t,i){this.config=i;const s=(t||[]).map(d=>new O2(d,this.config));this.nodes=s,this.allNodes=z2(s,!1),this.leafNodes=z2(s,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,i){const s=i?i.appendChild(t):new O2(t,this.config);i||this.nodes.push(s),this.allNodes.push(s),s.isLeaf&&this.leafNodes.push(s)}appendNodes(t,i){t.forEach(s=>this.appendNode(s,i))}getNodeByValue(t,i=!1){return!t&&t!==0?null:this.getFlattedNodes(i).find(d=>La(d.value,t)||La(d.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:s,level:d})=>La(t.value,s)&&t.level===d)||null}}const AD=vn({modelValue:{type:ut([Number,String,Array])},options:{type:ut(Array),default:()=>[]},props:{type:ut(Object),default:()=>({})}}),uX={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:jr,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},dX=e=>te(()=>({...uX,...e.props})),wP=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},hX=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():OO(e)&&e.click()},fX=(e,t)=>{const i=t.slice(0),s=i.map(p=>p.uid),d=e.reduce((p,_)=>{const o=s.indexOf(_.uid);return o>-1&&(p.push(_),i.splice(o,1),s.splice(o,1)),p},[]);return d.push(...i),d},SP=e=>[...new Set(e)],Os=e=>!e&&e!==0?[]:fn(e)?e:[e],pX=Ze({name:"ElCascaderPanel",components:{ElCascaderMenu:sX},props:{...AD,border:{type:Boolean,default:!0},renderLabel:Function},emits:[Fo,Yr,"close","expand-change"],setup(e,{emit:t,slots:i}){let s=!1;const d=rn("cascader"),p=dX(e);let _=null;const o=we(!0),w=we([]),C=we(null),M=we([]),I=we(null),F=we([]),B=te(()=>p.value.expandTrigger==="hover"),N=te(()=>e.renderLabel||i.default),D=()=>{const{options:ge}=e,Re=p.value;s=!1,_=new xP(ge,Re),M.value=[_.getNodes()],Re.lazy&&xl(e.options)?(o.value=!1,j(void 0,Je=>{Je&&(_=new xP(Je,Re),M.value=[_.getNodes()]),o.value=!0,me(!1,!0)})):me(!1,!0)},j=(ge,Re)=>{const Je=p.value;ge=ge||new O2({},Je,void 0,!0),ge.loading=!0;const Me=xe=>{const Ae=ge,Ce=Ae.root?null:Ae;xe&&(_==null||_.appendNodes(xe,Ce)),Ae.loading=!1,Ae.loaded=!0,Ae.childrenData=Ae.childrenData||[],Re&&Re(xe)};Je.lazyLoad(ge,Me)},U=(ge,Re)=>{var Je;const{level:Me}=ge,xe=M.value.slice(0,Me);let Ae;ge.isLeaf?Ae=ge.pathNodes[Me-2]:(Ae=ge,xe.push(ge.children)),((Je=I.value)==null?void 0:Je.uid)!==(Ae==null?void 0:Ae.uid)&&(I.value=ge,M.value=xe,!Re&&t("expand-change",(ge==null?void 0:ge.pathValues)||[]))},ne=(ge,Re,Je=!0)=>{const{checkStrictly:Me,multiple:xe}=p.value,Ae=F.value[0];s=!0,!xe&&(Ae==null||Ae.doCheck(!1)),ge.doCheck(Re),se(),Je&&!xe&&!Me&&t("close"),!Je&&!xe&&!Me&&K(ge)},K=ge=>{ge&&(ge=ge.parent,K(ge),ge&&U(ge))},G=ge=>_==null?void 0:_.getFlattedNodes(ge),J=ge=>{var Re;return(Re=G(ge))==null?void 0:Re.filter(Je=>Je.checked!==!1)},oe=()=>{F.value.forEach(ge=>ge.doCheck(!1)),se(),M.value=M.value.slice(0,1),I.value=null,t("expand-change",[])},se=()=>{var ge;const{checkStrictly:Re,multiple:Je}=p.value,Me=F.value,xe=J(!Re),Ae=fX(Me,xe),Ce=Ae.map(ve=>ve.valueByOption);F.value=Ae,C.value=Je?Ce:(ge=Ce[0])!=null?ge:null},me=(ge=!1,Re=!1)=>{const{modelValue:Je}=e,{lazy:Me,multiple:xe,checkStrictly:Ae}=p.value,Ce=!Ae;if(!(!o.value||s||!Re&&La(Je,C.value)))if(Me&&!ge){const Ne=SP(fG(Os(Je))).map(We=>_==null?void 0:_.getNodeByValue(We)).filter(We=>!!We&&!We.loaded&&!We.loading);Ne.length?Ne.forEach(We=>{j(We,()=>me(!1,Re))}):me(!0,Re)}else{const ve=xe?Os(Je):[Je],Ne=SP(ve.map(We=>_==null?void 0:_.getNodeByValue(We,Ce)));de(Ne,Re),C.value=Mb(Je)}},de=(ge,Re=!0)=>{const{checkStrictly:Je}=p.value,Me=F.value,xe=ge.filter(ve=>!!ve&&(Je||ve.isLeaf)),Ae=_==null?void 0:_.getSameNode(I.value),Ce=Re&&Ae||xe[0];Ce?Ce.pathNodes.forEach(ve=>U(ve,!0)):I.value=null,Me.forEach(ve=>ve.doCheck(!1)),Ir(xe).forEach(ve=>ve.doCheck(!0)),F.value=xe,oo(ce)},ce=()=>{gr&&w.value.forEach(ge=>{const Re=ge==null?void 0:ge.$el;if(Re){const Je=Re.querySelector(`.${d.namespace.value}-scrollbar__wrap`),Me=Re.querySelector(`.${d.b("node")}.${d.is("active")}`)||Re.querySelector(`.${d.b("node")}.in-active-path`);gT(Je,Me)}})},pe=ge=>{const Re=ge.target,{code:Je}=ge;switch(Je){case Ln.up:case Ln.down:{ge.preventDefault();const Me=Je===Ln.up?-1:1;J0(DO(Re,Me,`.${d.b("node")}[tabindex="-1"]`));break}case Ln.left:{ge.preventDefault();const Me=w.value[wP(Re)-1],xe=Me==null?void 0:Me.$el.querySelector(`.${d.b("node")}[aria-expanded="true"]`);J0(xe);break}case Ln.right:{ge.preventDefault();const Me=w.value[wP(Re)+1],xe=Me==null?void 0:Me.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`);J0(xe);break}case Ln.enter:case Ln.numpadEnter:hX(Re);break}};return or(NT,Ir({config:p,expandingNode:I,checkedNodes:F,isHoverMenu:B,initialLoaded:o,renderLabelFn:N,lazyLoad:j,expandNode:U,handleCheckChange:ne})),tn([p,()=>e.options],D,{deep:!0,immediate:!0}),tn(()=>e.modelValue,()=>{s=!1,me()},{deep:!0}),tn(()=>C.value,ge=>{La(ge,e.modelValue)||(t(Fo,ge),t(Yr,ge))}),SR(()=>w.value=[]),No(()=>!xl(e.modelValue)&&me()),{ns:d,menuList:w,menus:M,checkedNodes:F,handleKeyDown:pe,handleCheckChange:ne,getFlattedNodes:G,getCheckedNodes:J,clearCheckedNodes:oe,calculateCheckedValue:se,scrollToExpandingNode:ce}}});function mX(e,t,i,s,d,p){const _=Go("el-cascader-menu");return le(),Pe("div",{class:he([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(le(!0),Pe(eo,null,nr(e.menus,(o,w)=>(le(),Rt(_,{key:w,ref_for:!0,ref:C=>e.menuList[w]=C,index:w,nodes:[...o]},{empty:at(()=>[_t(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var gX=xn(pX,[["render",mX],["__file","index.vue"]]);const kD=Ao(gX),sd=vn({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:Lu},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),vX={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},_X=Ze({name:"ElTag"}),yX=Ze({..._X,props:sd,emits:vX,setup(e,{emit:t}){const i=e,s=na(),d=rn("tag"),p=te(()=>{const{type:C,hit:M,effect:I,closable:F,round:B}=i;return[d.b(),d.is("closable",F),d.m(C||"primary"),d.m(s.value),d.m(I),d.is("hit",M),d.is("round",B)]}),_=C=>{t("close",C)},o=C=>{t("click",C)},w=C=>{var M,I,F;(F=(I=(M=C==null?void 0:C.component)==null?void 0:M.subTree)==null?void 0:I.component)!=null&&F.bum&&(C.component.subTree.component.bum=null)};return(C,M)=>C.disableTransitions?(le(),Pe("span",{key:0,class:he(y(p)),style:to({backgroundColor:C.color}),onClick:o},[Ve("span",{class:he(y(d).e("content"))},[_t(C.$slots,"default")],2),C.closable?(le(),Rt(y(Gn),{key:0,class:he(y(d).e("close")),onClick:po(_,["stop"])},{default:at(()=>[Qe(y(Xc))]),_:1},8,["class","onClick"])):St("v-if",!0)],6)):(le(),Rt(Ea,{key:1,name:`${y(d).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:w},{default:at(()=>[Ve("span",{class:he(y(p)),style:to({backgroundColor:C.color}),onClick:o},[Ve("span",{class:he(y(d).e("content"))},[_t(C.$slots,"default")],2),C.closable?(le(),Rt(y(Gn),{key:0,class:he(y(d).e("close")),onClick:po(_,["stop"])},{default:at(()=>[Qe(y(Xc))]),_:1},8,["class","onClick"])):St("v-if",!0)],6)]),_:3},8,["name"]))}});var bX=xn(yX,[["__file","tag.vue"]]);const Rm=Ao(bX),xX=vn({...AD,size:ia,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:ut(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:ut(Function),default:()=>!0},placement:{type:ut(String),values:md,default:"bottom-start"},fallbackPlacements:{type:ut(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:wa.teleported,tagType:{...sd.type,default:"info"},tagEffect:{...sd.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...Km}),wX={[Fo]:e=>!0,[Yr]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>ai(e),expandChange:e=>!!e,removeTag:e=>!!e},ih=new Map;if(gr){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const i of ih.values())for(const{documentHandler:s}of i)s(t,e);e=void 0}})}function TP(e,t){let i=[];return fn(t.arg)?i=t.arg:El(t.arg)&&i.push(t.arg),function(s,d){const p=t.instance.popperRef,_=s.target,o=d==null?void 0:d.target,w=!t||!t.instance,C=!_||!o,M=e.contains(_)||e.contains(o),I=e===_,F=i.length&&i.some(N=>N==null?void 0:N.contains(_))||i.length&&i.includes(o),B=p&&(p.contains(_)||p.contains(o));w||C||M||I||F||B||t.value(s,d)}}const ld={beforeMount(e,t){ih.has(e)||ih.set(e,[]),ih.get(e).push({documentHandler:TP(e,t),bindingFn:t.value})},updated(e,t){ih.has(e)||ih.set(e,[]);const i=ih.get(e),s=i.findIndex(p=>p.bindingFn===t.oldValue),d={documentHandler:TP(e,t),bindingFn:t.value};s>=0?i.splice(s,1,d):i.push(d)},unmounted(e){ih.delete(e)}},SX="ElCascader",TX=Ze({name:SX}),CX=Ze({...TX,props:xX,emits:wX,setup(e,{expose:t,emit:i}){const s=e,d={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:ft})=>{const{modifiersData:un,placement:et}=ft;["right","left","bottom","top"].includes(et)||(un.arrow.x=35)},requires:["arrow"]}]},p=Ph();let _=0,o=0;const w=rn("cascader"),C=rn("input"),{t:M}=vr(),{form:I,formItem:F}=Ka(),{valueOnClear:B}=m1(s),{isComposing:N,handleComposition:D}=H_({afterComposition(ft){var un;const et=(un=ft.target)==null?void 0:un.value;Dt(et)}}),j=we(null),U=we(null),ne=we(null),K=we(null),G=we(null),J=we(!1),oe=we(!1),se=we(!1),me=we(!1),de=we(""),ce=we(""),pe=we([]),ge=we([]),Re=we([]),Je=te(()=>p.style),Me=te(()=>s.disabled||(I==null?void 0:I.disabled)),xe=te(()=>s.placeholder||M("el.cascader.placeholder")),Ae=te(()=>ce.value||pe.value.length>0||N.value?"":xe.value),Ce=na(),ve=te(()=>Ce.value==="small"?"small":"default"),Ne=te(()=>!!s.props.multiple),We=te(()=>!s.filterable||Ne.value),ot=te(()=>Ne.value?ce.value:de.value),Oe=te(()=>{var ft;return((ft=K.value)==null?void 0:ft.checkedNodes)||[]}),Ct=te(()=>!s.clearable||Me.value||se.value||!oe.value?!1:!!Oe.value.length),Mt=te(()=>{const{showAllLevels:ft,separator:un}=s,et=Oe.value;return et.length?Ne.value?"":et[0].calcText(ft,un):""}),zt=te(()=>(F==null?void 0:F.validateState)||""),bt=te({get(){return Mb(s.modelValue)},set(ft){const un=ft??B.value;i(Fo,un),i(Yr,un),s.validateEvent&&(F==null||F.validate("change").catch(et=>void 0))}}),Kt=te(()=>[w.b(),w.m(Ce.value),w.is("disabled",Me.value),p.class]),$t=te(()=>[C.e("icon"),"icon-arrow-down",w.is("reverse",J.value)]),Le=te(()=>w.is("focus",J.value||me.value)),dn=te(()=>{var ft,un;return(un=(ft=j.value)==null?void 0:ft.popperRef)==null?void 0:un.contentRef}),At=ft=>{var un,et,Mn;Me.value||(ft=ft??!J.value,ft!==J.value&&(J.value=ft,(et=(un=U.value)==null?void 0:un.input)==null||et.setAttribute("aria-expanded",`${ft}`),ft?(Ke(),oo((Mn=K.value)==null?void 0:Mn.scrollToExpandingNode)):s.filterable&&kn(),i("visibleChange",ft)))},Ke=()=>{oo(()=>{var ft;(ft=j.value)==null||ft.updatePopper()})},Be=()=>{se.value=!1},Ht=ft=>{const{showAllLevels:un,separator:et}=s;return{node:ft,key:ft.uid,text:ft.calcText(un,et),hitState:!1,closable:!Me.value&&!ft.isDisabled,isCollapseTag:!1}},Ut=ft=>{var un;const et=ft.node;et.doCheck(!1),(un=K.value)==null||un.calculateCheckedValue(),i("removeTag",et.valueByOption)},Nt=()=>{if(!Ne.value)return;const ft=Oe.value,un=[],et=[];if(ft.forEach(Mn=>et.push(Ht(Mn))),ge.value=et,ft.length){ft.slice(0,s.maxCollapseTags).forEach(Lo=>un.push(Ht(Lo)));const Mn=ft.slice(s.maxCollapseTags),Bn=Mn.length;Bn&&(s.collapseTags?un.push({key:-1,text:`+ ${Bn}`,closable:!1,isCollapseTag:!0}):Mn.forEach(Lo=>un.push(Ht(Lo))))}pe.value=un},Et=()=>{var ft,un;const{filterMethod:et,showAllLevels:Mn,separator:Bn}=s,Lo=(un=(ft=K.value)==null?void 0:ft.getFlattedNodes(!s.props.checkStrictly))==null?void 0:un.filter(Rr=>Rr.isDisabled?!1:(Rr.calcText(Mn,Bn),et(Rr,ot.value)));Ne.value&&(pe.value.forEach(Rr=>{Rr.hitState=!1}),ge.value.forEach(Rr=>{Rr.hitState=!1})),se.value=!0,Re.value=Lo,Ke()},Gt=()=>{var ft;let un;se.value&&G.value?un=G.value.$el.querySelector(`.${w.e("suggestion-item")}`):un=(ft=K.value)==null?void 0:ft.$el.querySelector(`.${w.b("node")}[tabindex="-1"]`),un&&(un.focus(),!se.value&&un.click())},ln=()=>{var ft,un;const et=(ft=U.value)==null?void 0:ft.input,Mn=ne.value,Bn=(un=G.value)==null?void 0:un.$el;if(!(!gr||!et)){if(Bn){const Lo=Bn.querySelector(`.${w.e("suggestion-list")}`);Lo.style.minWidth=`${et.offsetWidth}px`}if(Mn){const{offsetHeight:Lo}=Mn,Rr=pe.value.length>0?`${Math.max(Lo,_)-2}px`:`${_}px`;et.style.height=Rr,Ke()}}},bn=ft=>{var un;return(un=K.value)==null?void 0:un.getCheckedNodes(ft)},_n=ft=>{Ke(),i("expandChange",ft)},jn=ft=>{if(!N.value)switch(ft.code){case Ln.enter:case Ln.numpadEnter:At();break;case Ln.down:At(!0),oo(Gt),ft.preventDefault();break;case Ln.esc:J.value===!0&&(ft.preventDefault(),ft.stopPropagation(),At(!1));break;case Ln.tab:At(!1);break}},yt=()=>{var ft;(ft=K.value)==null||ft.clearCheckedNodes(),!J.value&&s.filterable&&kn(),At(!1),i("clear")},kn=()=>{const{value:ft}=Mt;de.value=ft,ce.value=ft},qn=ft=>{var un,et;const{checked:Mn}=ft;Ne.value?(un=K.value)==null||un.handleCheckChange(ft,!Mn,!1):(!Mn&&((et=K.value)==null||et.handleCheckChange(ft,!0,!1)),At(!1))},Co=ft=>{const un=ft.target,{code:et}=ft;switch(et){case Ln.up:case Ln.down:{const Mn=et===Ln.up?-1:1;J0(DO(un,Mn,`.${w.e("suggestion-item")}[tabindex="-1"]`));break}case Ln.enter:case Ln.numpadEnter:un.click();break}},mo=()=>{const ft=pe.value,un=ft[ft.length-1];o=ce.value?0:o+1,!(!un||!o||s.collapseTags&&ft.length>1)&&(un.hitState?Ut(un):un.hitState=!0)},Io=ft=>{const un=ft.target,et=w.e("search-input");un.className===et&&(me.value=!0),i("focus",ft)},Ho=ft=>{me.value=!1,i("blur",ft)},ur=il(()=>{const{value:ft}=ot;if(!ft)return;const un=s.beforeFilter(ft);o_(un)?un.then(Et).catch(()=>{}):un!==!1?Et():Be()},s.debounce),Dt=(ft,un)=>{!J.value&&At(!0),!(un!=null&&un.isComposing)&&(ft?ur():Be())},En=ft=>Number.parseFloat(KG(C.cssVarName("input-height"),ft).value)-2;return tn(se,Ke),tn([Oe,Me,()=>s.collapseTags],Nt),tn(pe,()=>{oo(()=>ln())}),tn(Ce,async()=>{await oo();const ft=U.value.input;_=En(ft)||_,ln()}),tn(Mt,kn,{immediate:!0}),No(()=>{const ft=U.value.input,un=En(ft);_=ft.offsetHeight||un,Mi(ft,ln)}),t({getCheckedNodes:bn,cascaderPanelRef:K,togglePopperVisible:At,contentRef:dn,presentText:Mt}),(ft,un)=>(le(),Rt(y(qa),{ref_key:"tooltipRef",ref:j,visible:J.value,teleported:ft.teleported,"popper-class":[y(w).e("dropdown"),ft.popperClass],"popper-options":d,"fallback-placements":ft.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:ft.placement,transition:`${y(w).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:ft.persistent,onHide:Be},{default:at(()=>[zo((le(),Pe("div",{class:he(y(Kt)),style:to(y(Je)),onClick:()=>At(y(We)?void 0:!0),onKeydown:jn,onMouseenter:et=>oe.value=!0,onMouseleave:et=>oe.value=!1},[Qe(y(fs),{ref_key:"input",ref:U,modelValue:de.value,"onUpdate:modelValue":et=>de.value=et,placeholder:y(Ae),readonly:y(We),disabled:y(Me),"validate-event":!1,size:y(Ce),class:he(y(Le)),tabindex:y(Ne)&&ft.filterable&&!y(Me)?-1:void 0,onCompositionstart:y(D),onCompositionupdate:y(D),onCompositionend:y(D),onFocus:Io,onBlur:Ho,onInput:Dt},{suffix:at(()=>[y(Ct)?(le(),Rt(y(Gn),{key:"clear",class:he([y(C).e("icon"),"icon-circle-close"]),onClick:po(yt,["stop"])},{default:at(()=>[Qe(y(pd))]),_:1},8,["class","onClick"])):(le(),Rt(y(Gn),{key:"arrow-down",class:he(y($t)),onClick:po(et=>At(),["stop"])},{default:at(()=>[Qe(y(fd))]),_:1},8,["class","onClick"]))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),y(Ne)?(le(),Pe("div",{key:0,ref_key:"tagWrapper",ref:ne,class:he([y(w).e("tags"),y(w).is("validate",!!y(zt))])},[(le(!0),Pe(eo,null,nr(pe.value,et=>(le(),Rt(y(Rm),{key:et.key,type:ft.tagType,size:y(ve),effect:ft.tagEffect,hit:et.hitState,closable:et.closable,"disable-transitions":"",onClose:Mn=>Ut(et)},{default:at(()=>[et.isCollapseTag===!1?(le(),Pe("span",{key:0},yn(et.text),1)):(le(),Rt(y(qa),{key:1,disabled:J.value||!ft.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:at(()=>[Ve("span",null,yn(et.text),1)]),content:at(()=>[Ve("div",{class:he(y(w).e("collapse-tags"))},[(le(!0),Pe(eo,null,nr(ge.value.slice(ft.maxCollapseTags),(Mn,Bn)=>(le(),Pe("div",{key:Bn,class:he(y(w).e("collapse-tag"))},[(le(),Rt(y(Rm),{key:Mn.key,class:"in-tooltip",type:ft.tagType,size:y(ve),effect:ft.tagEffect,hit:Mn.hitState,closable:Mn.closable,"disable-transitions":"",onClose:Lo=>Ut(Mn)},{default:at(()=>[Ve("span",null,yn(Mn.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),ft.filterable&&!y(Me)?zo((le(),Pe("input",{key:0,"onUpdate:modelValue":et=>ce.value=et,type:"text",class:he(y(w).e("search-input")),placeholder:y(Mt)?"":y(xe),onInput:et=>Dt(ce.value,et),onClick:po(et=>At(!0),["stop"]),onKeydown:ti(mo,["delete"]),onCompositionstart:y(D),onCompositionupdate:y(D),onCompositionend:y(D),onFocus:Io,onBlur:Ho},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[a1,ce.value]]):St("v-if",!0)],2)):St("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[y(ld),()=>At(!1),y(dn)]])]),content:at(()=>[zo(Qe(y(kD),{ref_key:"cascaderPanelRef",ref:K,modelValue:y(bt),"onUpdate:modelValue":et=>vi(bt)?bt.value=et:null,options:ft.options,props:s.props,border:!1,"render-label":ft.$slots.default,onExpandChange:_n,onClose:et=>ft.$nextTick(()=>At(!1))},{empty:at(()=>[_t(ft.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[Cr,!se.value]]),ft.filterable?zo((le(),Rt(y(Ou),{key:0,ref_key:"suggestionPanel",ref:G,tag:"ul",class:he(y(w).e("suggestion-panel")),"view-class":y(w).e("suggestion-list"),onKeydown:Co},{default:at(()=>[Re.value.length?(le(!0),Pe(eo,{key:0},nr(Re.value,et=>(le(),Pe("li",{key:et.uid,class:he([y(w).e("suggestion-item"),y(w).is("checked",et.checked)]),tabindex:-1,onClick:Mn=>qn(et)},[Ve("span",null,yn(et.text),1),et.checked?(le(),Rt(y(Gn),{key:0},{default:at(()=>[Qe(y(U_))]),_:1})):St("v-if",!0)],10,["onClick"]))),128)):_t(ft.$slots,"empty",{key:1},()=>[Ve("li",{class:he(y(w).e("empty-text"))},yn(y(M)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[Cr,se.value]]):St("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var EX=xn(CX,[["__file","cascader.vue"]]);const MX=Ao(EX),IX=vn({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),AX={"update:checked":e=>ai(e),[Yr]:e=>ai(e)},kX=Ze({name:"ElCheckTag"}),PX=Ze({...kX,props:IX,emits:AX,setup(e,{emit:t}){const i=e,s=rn("check-tag"),d=te(()=>i.disabled),p=te(()=>[s.b(),s.is("checked",i.checked),s.is("disabled",d.value),s.m(i.type||"primary")]),_=()=>{if(d.value)return;const o=!i.checked;t(Yr,o),t("update:checked",o)};return(o,w)=>(le(),Pe("span",{class:he(y(p)),onClick:_},[_t(o.$slots,"default")],2))}});var RX=xn(PX,[["__file","check-tag.vue"]]);const LX=Ao(RX),OX=vn({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:ut([Number,Object]),default:()=>Ri({})},sm:{type:ut([Number,Object]),default:()=>Ri({})},md:{type:ut([Number,Object]),default:()=>Ri({})},lg:{type:ut([Number,Object]),default:()=>Ri({})},xl:{type:ut([Number,Object]),default:()=>Ri({})}}),PD=Symbol("rowContextKey"),DX=Ze({name:"ElCol"}),zX=Ze({...DX,props:OX,setup(e){const t=e,{gutter:i}=Un(PD,{gutter:te(()=>0)}),s=rn("col"),d=te(()=>{const _={};return i.value&&(_.paddingLeft=_.paddingRight=`${i.value/2}px`),_}),p=te(()=>{const _=[];return["span","offset","pull","push"].forEach(C=>{const M=t[C];ao(M)&&(C==="span"?_.push(s.b(`${t[C]}`)):M>0&&_.push(s.b(`${C}-${t[C]}`)))}),["xs","sm","md","lg","xl"].forEach(C=>{ao(t[C])?_.push(s.b(`${C}-${t[C]}`)):Vo(t[C])&&Object.entries(t[C]).forEach(([M,I])=>{_.push(M!=="span"?s.b(`${C}-${M}-${I}`):s.b(`${C}-${I}`))})}),i.value&&_.push(s.is("guttered")),[s.b(),_]});return(_,o)=>(le(),Rt(Wo(_.tag),{class:he(y(p)),style:to(y(d))},{default:at(()=>[_t(_.$slots,"default")]),_:3},8,["class","style"]))}});var FX=xn(zX,[["__file","col.vue"]]);const BX=Ao(FX),CP=e=>ao(e)||Zn(e)||fn(e),NX=vn({accordion:Boolean,modelValue:{type:ut([Array,String,Number]),default:()=>Ri([])}}),$X={[Fo]:CP,[Yr]:CP},RD=Symbol("collapseContextKey"),VX=(e,t)=>{const i=we(ds(e.modelValue)),s=p=>{i.value=p;const _=e.accordion?i.value[0]:i.value;t(Fo,_),t(Yr,_)},d=p=>{if(e.accordion)s([i.value[0]===p?"":p]);else{const _=[...i.value],o=_.indexOf(p);o>-1?_.splice(o,1):_.push(p),s(_)}};return tn(()=>e.modelValue,()=>i.value=ds(e.modelValue),{deep:!0}),or(RD,{activeNames:i,handleItemClick:d}),{activeNames:i,setActiveNames:s}},UX=()=>{const e=rn("collapse");return{rootKls:te(()=>e.b())}},jX=Ze({name:"ElCollapse"}),HX=Ze({...jX,props:NX,emits:$X,setup(e,{expose:t,emit:i}){const s=e,{activeNames:d,setActiveNames:p}=VX(s,i),{rootKls:_}=UX();return t({activeNames:d,setActiveNames:p}),(o,w)=>(le(),Pe("div",{class:he(y(_))},[_t(o.$slots,"default")],2))}});var GX=xn(HX,[["__file","collapse.vue"]]);const WX=Ze({name:"ElCollapseTransition"}),qX=Ze({...WX,setup(e){const t=rn("collapse-transition"),i=d=>{d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom},s={beforeEnter(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.style.height&&(d.dataset.elExistsHeight=d.style.height),d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0},enter(d){requestAnimationFrame(()=>{d.dataset.oldOverflow=d.style.overflow,d.dataset.elExistsHeight?d.style.maxHeight=d.dataset.elExistsHeight:d.scrollHeight!==0?d.style.maxHeight=`${d.scrollHeight}px`:d.style.maxHeight=0,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom,d.style.overflow="hidden"})},afterEnter(d){d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow},enterCancelled(d){i(d)},beforeLeave(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.dataset.oldOverflow=d.style.overflow,d.style.maxHeight=`${d.scrollHeight}px`,d.style.overflow="hidden"},leave(d){d.scrollHeight!==0&&(d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0)},afterLeave(d){i(d)},leaveCancelled(d){i(d)}};return(d,p)=>(le(),Rt(Ea,Yo({name:y(t).b()},Q5(s)),{default:at(()=>[_t(d.$slots,"default")]),_:3},16,["name"]))}});var KX=xn(qX,[["__file","collapse-transition.vue"]]);const T1=Ao(KX),ZX=vn({title:{type:String,default:""},name:{type:ut([String,Number]),default:void 0},icon:{type:Xr,default:zs},disabled:Boolean}),YX=e=>{const t=Un(RD),{namespace:i}=rn("collapse"),s=we(!1),d=we(!1),p=TT(),_=te(()=>p.current++),o=te(()=>{var F;return(F=e.name)!=null?F:`${i.value}-id-${p.prefix}-${y(_)}`}),w=te(()=>t==null?void 0:t.activeNames.value.includes(y(o)));return{focusing:s,id:_,isActive:w,handleFocus:()=>{setTimeout(()=>{d.value?d.value=!1:s.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(y(o)),s.value=!1,d.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(y(o))}}},XX=(e,{focusing:t,isActive:i,id:s})=>{const d=rn("collapse"),p=te(()=>[d.b("item"),d.is("active",y(i)),d.is("disabled",e.disabled)]),_=te(()=>[d.be("item","header"),d.is("active",y(i)),{focusing:y(t)&&!e.disabled}]),o=te(()=>[d.be("item","arrow"),d.is("active",y(i))]),w=te(()=>d.be("item","wrap")),C=te(()=>d.be("item","content")),M=te(()=>d.b(`content-${y(s)}`)),I=te(()=>d.b(`head-${y(s)}`));return{arrowKls:o,headKls:_,rootKls:p,itemWrapperKls:w,itemContentKls:C,scopedContentId:M,scopedHeadId:I}},JX=Ze({name:"ElCollapseItem"}),QX=Ze({...JX,props:ZX,setup(e,{expose:t}){const i=e,{focusing:s,id:d,isActive:p,handleFocus:_,handleHeaderClick:o,handleEnterClick:w}=YX(i),{arrowKls:C,headKls:M,rootKls:I,itemWrapperKls:F,itemContentKls:B,scopedContentId:N,scopedHeadId:D}=XX(i,{focusing:s,isActive:p,id:d});return t({isActive:p}),(j,U)=>(le(),Pe("div",{class:he(y(I))},[Ve("button",{id:y(D),class:he(y(M)),"aria-expanded":y(p),"aria-controls":y(N),"aria-describedby":y(N),tabindex:j.disabled?-1:0,type:"button",onClick:y(o),onKeydown:ti(po(y(w),["stop","prevent"]),["space","enter"]),onFocus:y(_),onBlur:ne=>s.value=!1},[_t(j.$slots,"title",{},()=>[Qo(yn(j.title),1)]),_t(j.$slots,"icon",{isActive:y(p)},()=>[Qe(y(Gn),{class:he(y(C))},{default:at(()=>[(le(),Rt(Wo(j.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),Qe(y(T1),null,{default:at(()=>[zo(Ve("div",{id:y(N),role:"region",class:he(y(F)),"aria-hidden":!y(p),"aria-labelledby":y(D)},[Ve("div",{class:he(y(B))},[_t(j.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[Cr,y(p)]])]),_:3})],2))}});var LD=xn(QX,[["__file","collapse-item.vue"]]);const eJ=Ao(GX,{CollapseItem:LD}),tJ=Li(LD),nJ=vn({color:{type:ut(Object),required:!0},vertical:{type:Boolean,default:!1}});let Vw=!1;function b_(e,t){if(!gr)return;const i=function(p){var _;(_=t.drag)==null||_.call(t,p)},s=function(p){var _;document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",s),document.onselectstart=null,document.ondragstart=null,Vw=!1,(_=t.end)==null||_.call(t,p)},d=function(p){var _;Vw||(p.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",i),document.addEventListener("mouseup",s),document.addEventListener("touchmove",i),document.addEventListener("touchend",s),Vw=!0,(_=t.start)==null||_.call(t,p))};e.addEventListener("mousedown",d),e.addEventListener("touchstart",d,{passive:!1})}const oJ=(e,t)=>{if(!gr||!e||!t)return!1;const i=e.getBoundingClientRect();let s;return t instanceof Element?s=t.getBoundingClientRect():s={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},i.top<s.bottom&&i.bottom>s.top&&i.right>s.left&&i.left<s.right},EP=e=>{let t=0,i=e;for(;i;)t+=i.offsetTop,i=i.offsetParent;return t},F2=(e,t)=>Math.abs(EP(e)-EP(t)),VT=e=>{let t,i;return e.type==="touchend"?(i=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(i=e.touches[0].clientY,t=e.touches[0].clientX):(i=e.clientY,t=e.clientX),{clientX:t,clientY:i}},rJ=e=>{const t=jo(),{t:i}=vr(),s=gi(),d=gi(),p=te(()=>e.color.get("alpha")),_=te(()=>i("el.colorpicker.alphaLabel"));function o(I){var F;I.target!==s.value&&w(I),(F=s.value)==null||F.focus()}function w(I){if(!d.value||!s.value)return;const B=t.vnode.el.getBoundingClientRect(),{clientX:N,clientY:D}=VT(I);if(e.vertical){let j=D-B.top;j=Math.max(s.value.offsetHeight/2,j),j=Math.min(j,B.height-s.value.offsetHeight/2),e.color.set("alpha",Math.round((j-s.value.offsetHeight/2)/(B.height-s.value.offsetHeight)*100))}else{let j=N-B.left;j=Math.max(s.value.offsetWidth/2,j),j=Math.min(j,B.width-s.value.offsetWidth/2),e.color.set("alpha",Math.round((j-s.value.offsetWidth/2)/(B.width-s.value.offsetWidth)*100))}}function C(I){const{code:F,shiftKey:B}=I,N=B?10:1;switch(F){case Ln.left:case Ln.down:I.preventDefault(),I.stopPropagation(),M(-N);break;case Ln.right:case Ln.up:I.preventDefault(),I.stopPropagation(),M(N);break}}function M(I){let F=p.value+I;F=F<0?0:F>100?100:F,e.color.set("alpha",F)}return{thumb:s,bar:d,alpha:p,alphaLabel:_,handleDrag:w,handleClick:o,handleKeydown:C}},iJ=(e,{bar:t,thumb:i,handleDrag:s})=>{const d=jo(),p=rn("color-alpha-slider"),_=we(0),o=we(0),w=we();function C(){if(!i.value||e.vertical)return 0;const ne=d.vnode.el,K=e.color.get("alpha");return ne?Math.round(K*(ne.offsetWidth-i.value.offsetWidth/2)/100):0}function M(){if(!i.value)return 0;const ne=d.vnode.el;if(!e.vertical)return 0;const K=e.color.get("alpha");return ne?Math.round(K*(ne.offsetHeight-i.value.offsetHeight/2)/100):0}function I(){if(e.color&&e.color.value){const{r:ne,g:K,b:G}=e.color.toRgb();return`linear-gradient(to right, rgba(${ne}, ${K}, ${G}, 0) 0%, rgba(${ne}, ${K}, ${G}, 1) 100%)`}return""}function F(){_.value=C(),o.value=M(),w.value=I()}No(()=>{if(!t.value||!i.value)return;const ne={drag:K=>{s(K)},end:K=>{s(K)}};b_(t.value,ne),b_(i.value,ne),F()}),tn(()=>e.color.get("alpha"),()=>F()),tn(()=>e.color.value,()=>F());const B=te(()=>[p.b(),p.is("vertical",e.vertical)]),N=te(()=>p.e("bar")),D=te(()=>p.e("thumb")),j=te(()=>({background:w.value})),U=te(()=>({left:ji(_.value),top:ji(o.value)}));return{rootKls:B,barKls:N,barStyle:j,thumbKls:D,thumbStyle:U,update:F}},aJ="ElColorAlphaSlider",sJ=Ze({name:aJ}),lJ=Ze({...sJ,props:nJ,setup(e,{expose:t}){const i=e,{alpha:s,alphaLabel:d,bar:p,thumb:_,handleDrag:o,handleClick:w,handleKeydown:C}=rJ(i),{rootKls:M,barKls:I,barStyle:F,thumbKls:B,thumbStyle:N,update:D}=iJ(i,{bar:p,thumb:_,handleDrag:o});return t({update:D,bar:p,thumb:_}),(j,U)=>(le(),Pe("div",{class:he(y(M))},[Ve("div",{ref_key:"bar",ref:p,class:he(y(I)),style:to(y(F)),onClick:y(w)},null,14,["onClick"]),Ve("div",{ref_key:"thumb",ref:_,class:he(y(B)),style:to(y(N)),"aria-label":y(d),"aria-valuenow":y(s),"aria-orientation":j.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:y(C)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var cJ=xn(lJ,[["__file","alpha-slider.vue"]]);const uJ=Ze({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=rn("color-hue-slider"),i=jo(),s=we(),d=we(),p=we(0),_=we(0),o=te(()=>e.color.get("hue"));tn(()=>o.value,()=>{F()});function w(B){B.target!==s.value&&C(B)}function C(B){if(!d.value||!s.value)return;const D=i.vnode.el.getBoundingClientRect(),{clientX:j,clientY:U}=VT(B);let ne;if(e.vertical){let K=U-D.top;K=Math.min(K,D.height-s.value.offsetHeight/2),K=Math.max(s.value.offsetHeight/2,K),ne=Math.round((K-s.value.offsetHeight/2)/(D.height-s.value.offsetHeight)*360)}else{let K=j-D.left;K=Math.min(K,D.width-s.value.offsetWidth/2),K=Math.max(s.value.offsetWidth/2,K),ne=Math.round((K-s.value.offsetWidth/2)/(D.width-s.value.offsetWidth)*360)}e.color.set("hue",ne)}function M(){if(!s.value)return 0;const B=i.vnode.el;if(e.vertical)return 0;const N=e.color.get("hue");return B?Math.round(N*(B.offsetWidth-s.value.offsetWidth/2)/360):0}function I(){if(!s.value)return 0;const B=i.vnode.el;if(!e.vertical)return 0;const N=e.color.get("hue");return B?Math.round(N*(B.offsetHeight-s.value.offsetHeight/2)/360):0}function F(){p.value=M(),_.value=I()}return No(()=>{if(!d.value||!s.value)return;const B={drag:N=>{C(N)},end:N=>{C(N)}};b_(d.value,B),b_(s.value,B),F()}),{bar:d,thumb:s,thumbLeft:p,thumbTop:_,hueValue:o,handleClick:w,update:F,ns:t}}});function dJ(e,t,i,s,d,p){return le(),Pe("div",{class:he([e.ns.b(),e.ns.is("vertical",e.vertical)])},[Ve("div",{ref:"bar",class:he(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),Ve("div",{ref:"thumb",class:he(e.ns.e("thumb")),style:to({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var hJ=xn(uJ,[["render",dJ],["__file","hue-slider.vue"]]);const fJ=vn({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:ia,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:wa.teleported,predefine:{type:ut(Array)},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),pJ={[Fo]:e=>Zn(e)||ga(e),[Yr]:e=>Zn(e)||ga(e),activeChange:e=>Zn(e)||ga(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},OD=Symbol("colorPickerContextKey"),MP=function(e,t,i){return[e,t*i/((e=(2-t)*i)<1?e:2-e)||0,e/2]},mJ=function(e){return Zn(e)&&e.includes(".")&&Number.parseFloat(e)===1},gJ=function(e){return Zn(e)&&e.includes("%")},vm=function(e,t){mJ(e)&&(e="100%");const i=gJ(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),i&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},IP={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},eb=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),i=e%16;return`${IP[t]||t}${IP[i]||i}`},AP=function({r:e,g:t,b:i}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+i)?"":`#${eb(e)}${eb(t)}${eb(i)}`},Uw={A:10,B:11,C:12,D:13,E:14,F:15},Sf=function(e){return e.length===2?(Uw[e[0].toUpperCase()]||+e[0])*16+(Uw[e[1].toUpperCase()]||+e[1]):Uw[e[1].toUpperCase()]||+e[1]},vJ=function(e,t,i){t=t/100,i=i/100;let s=t;const d=Math.max(i,.01);i*=2,t*=i<=1?i:2-i,s*=d<=1?d:2-d;const p=(i+t)/2,_=i===0?2*s/(d+s):2*t/(i+t);return{h:e,s:_*100,v:p*100}},kP=(e,t,i)=>{e=vm(e,255),t=vm(t,255),i=vm(i,255);const s=Math.max(e,t,i),d=Math.min(e,t,i);let p;const _=s,o=s-d,w=s===0?0:o/s;if(s===d)p=0;else{switch(s){case e:{p=(t-i)/o+(t<i?6:0);break}case t:{p=(i-e)/o+2;break}case i:{p=(e-t)/o+4;break}}p/=6}return{h:p*360,s:w*100,v:_*100}},zv=function(e,t,i){e=vm(e,360)*6,t=vm(t,100),i=vm(i,100);const s=Math.floor(e),d=e-s,p=i*(1-t),_=i*(1-d*t),o=i*(1-(1-d)*t),w=s%6,C=[i,_,p,p,o,i][w],M=[o,i,i,_,p,p][w],I=[p,p,o,i,i,_][w];return{r:Math.round(C*255),g:Math.round(M*255),b:Math.round(I*255)}};class e_{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const i in t)Tr(t,i)&&(this[i]=t[i]);t.value?this.fromString(t.value):this.doOnChange()}set(t,i){if(arguments.length===1&&typeof t=="object"){for(const s in t)Tr(t,s)&&this.set(s,t[s]);return}this[`_${t}`]=i,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return zv(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const i=(s,d,p)=>{this._hue=Math.max(0,Math.min(360,s)),this._saturation=Math.max(0,Math.min(100,d)),this._value=Math.max(0,Math.min(100,p)),this.doOnChange()};if(t.includes("hsl")){const s=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));if(s.length===4?this._alpha=Number.parseFloat(s[3])*100:s.length===3&&(this._alpha=100),s.length>=3){const{h:d,s:p,v:_}=vJ(s[0],s[1],s[2]);i(d,p,_)}}else if(t.includes("hsv")){const s=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));s.length===4?this._alpha=Number.parseFloat(s[3])*100:s.length===3&&(this._alpha=100),s.length>=3&&i(s[0],s[1],s[2])}else if(t.includes("rgb")){const s=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));if(s.length===4?this._alpha=Number.parseFloat(s[3])*100:s.length===3&&(this._alpha=100),s.length>=3){const{h:d,s:p,v:_}=kP(s[0],s[1],s[2]);i(d,p,_)}}else if(t.includes("#")){const s=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(s))return;let d,p,_;s.length===3?(d=Sf(s[0]+s[0]),p=Sf(s[1]+s[1]),_=Sf(s[2]+s[2])):(s.length===6||s.length===8)&&(d=Sf(s.slice(0,2)),p=Sf(s.slice(2,4)),_=Sf(s.slice(4,6))),s.length===8?this._alpha=Sf(s.slice(6))/255*100:(s.length===3||s.length===6)&&(this._alpha=100);const{h:o,s:w,v:C}=kP(d,p,_);i(o,w,C)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:i,_value:s,_alpha:d,format:p}=this;if(this.enableAlpha)switch(p){case"hsl":{const _=MP(t,i/100,s/100);this.value=`hsla(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(i)}%, ${Math.round(s)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${AP(zv(t,i,s))}${eb(d*255/100)}`;break}default:{const{r:_,g:o,b:w}=zv(t,i,s);this.value=`rgba(${_}, ${o}, ${w}, ${this.get("alpha")/100})`}}else switch(p){case"hsl":{const _=MP(t,i/100,s/100);this.value=`hsl(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(i)}%, ${Math.round(s)}%)`;break}case"rgb":{const{r:_,g:o,b:w}=zv(t,i,s);this.value=`rgb(${_}, ${o}, ${w})`;break}default:this.value=AP(zv(t,i,s))}}}const _J=Ze({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=rn("color-predefine"),{currentColor:i}=Un(OD),s=we(p(e.colors,e.color));tn(()=>i.value,_=>{const o=new e_;o.fromString(_),s.value.forEach(w=>{w.selected=o.compare(w)})}),Ha(()=>{s.value=p(e.colors,e.color)});function d(_){e.color.fromString(e.colors[_])}function p(_,o){return _.map(w=>{const C=new e_;return C.enableAlpha=e.enableAlpha,C.format="rgba",C.fromString(w),C.selected=C.value===o.value,C})}return{rgbaColors:s,handleSelect:d,ns:t}}});function yJ(e,t,i,s,d,p){return le(),Pe("div",{class:he(e.ns.b())},[Ve("div",{class:he(e.ns.e("colors"))},[(le(!0),Pe(eo,null,nr(e.rgbaColors,(_,o)=>(le(),Pe("div",{key:e.colors[o],class:he([e.ns.e("color-selector"),e.ns.is("alpha",_._alpha<100),{selected:_.selected}]),onClick:w=>e.handleSelect(o)},[Ve("div",{style:to({backgroundColor:_.value})},null,4)],10,["onClick"]))),128))],2)],2)}var bJ=xn(_J,[["render",yJ],["__file","predefine.vue"]]);const xJ=Ze({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=rn("color-svpanel"),i=jo(),s=we(0),d=we(0),p=we("hsl(0, 100%, 50%)"),_=te(()=>{const C=e.color.get("hue"),M=e.color.get("value");return{hue:C,value:M}});function o(){const C=e.color.get("saturation"),M=e.color.get("value"),I=i.vnode.el,{clientWidth:F,clientHeight:B}=I;d.value=C*F/100,s.value=(100-M)*B/100,p.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function w(C){const I=i.vnode.el.getBoundingClientRect(),{clientX:F,clientY:B}=VT(C);let N=F-I.left,D=B-I.top;N=Math.max(0,N),N=Math.min(N,I.width),D=Math.max(0,D),D=Math.min(D,I.height),d.value=N,s.value=D,e.color.set({saturation:N/I.width*100,value:100-D/I.height*100})}return tn(()=>_.value,()=>{o()}),No(()=>{b_(i.vnode.el,{drag:C=>{w(C)},end:C=>{w(C)}}),o()}),{cursorTop:s,cursorLeft:d,background:p,colorValue:_,handleDrag:w,update:o,ns:t}}});function wJ(e,t,i,s,d,p){return le(),Pe("div",{class:he(e.ns.b()),style:to({backgroundColor:e.background})},[Ve("div",{class:he(e.ns.e("white"))},null,2),Ve("div",{class:he(e.ns.e("black"))},null,2),Ve("div",{class:he(e.ns.e("cursor")),style:to({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[Ve("div")],6)],6)}var SJ=xn(xJ,[["render",wJ],["__file","sv-panel.vue"]]);const TJ=Ze({name:"ElColorPicker"}),CJ=Ze({...TJ,props:fJ,emits:pJ,setup(e,{expose:t,emit:i}){const s=e,{t:d}=vr(),p=rn("color"),{formItem:_}=Ka(),o=na(),w=Za(),{inputId:C,isLabeledByFormItem:M}=sc(s,{formItemContext:_}),I=we(),F=we(),B=we(),N=we(),D=we(),j=we(),{isFocused:U,handleFocus:ne,handleBlur:K}=Lh(D,{beforeFocus(){return w.value},beforeBlur($t){var Le;return(Le=N.value)==null?void 0:Le.isFocusInsideContent($t)},afterBlur(){Me(!1),ve()}});let G=!0;const J=Ir(new e_({enableAlpha:s.showAlpha,format:s.colorFormat||"",value:s.modelValue})),oe=we(!1),se=we(!1),me=we(""),de=te(()=>!s.modelValue&&!se.value?"transparent":Je(J,s.showAlpha)),ce=te(()=>!s.modelValue&&!se.value?"":J.value),pe=te(()=>M.value?void 0:s.ariaLabel||d("el.colorpicker.defaultLabel")),ge=te(()=>M.value?_==null?void 0:_.labelId:void 0),Re=te(()=>[p.b("picker"),p.is("disabled",w.value),p.bm("picker",o.value),p.is("focused",U.value)]);function Je($t,Le){if(!($t instanceof e_))throw new TypeError("color should be instance of _color Class");const{r:dn,g:At,b:Ke}=$t.toRgb();return Le?`rgba(${dn}, ${At}, ${Ke}, ${$t.get("alpha")/100})`:`rgb(${dn}, ${At}, ${Ke})`}function Me($t){oe.value=$t}const xe=il(Me,100,{leading:!0});function Ae(){w.value||Me(!0)}function Ce(){xe(!1),ve()}function ve(){oo(()=>{s.modelValue?J.fromString(s.modelValue):(J.value="",oo(()=>{se.value=!1}))})}function Ne(){w.value||xe(!oe.value)}function We(){J.fromString(me.value)}function ot(){const $t=J.value;i(Fo,$t),i("change",$t),s.validateEvent&&(_==null||_.validate("change").catch(Le=>void 0)),xe(!1),oo(()=>{const Le=new e_({enableAlpha:s.showAlpha,format:s.colorFormat||"",value:s.modelValue});J.compare(Le)||ve()})}function Oe(){xe(!1),i(Fo,null),i("change",null),s.modelValue!==null&&s.validateEvent&&(_==null||_.validate("change").catch($t=>void 0)),ve()}function Ct(){oe.value&&(Ce(),U.value&&bt())}function Mt($t){$t.preventDefault(),$t.stopPropagation(),Me(!1),ve()}function zt($t){switch($t.code){case Ln.enter:case Ln.numpadEnter:case Ln.space:$t.preventDefault(),$t.stopPropagation(),Ae(),j.value.focus();break;case Ln.esc:Mt($t);break}}function bt(){D.value.focus()}function Kt(){D.value.blur()}return No(()=>{s.modelValue&&(me.value=ce.value)}),tn(()=>s.modelValue,$t=>{$t?$t&&$t!==J.value&&(G=!1,J.fromString($t)):se.value=!1}),tn(()=>[s.colorFormat,s.showAlpha],()=>{J.enableAlpha=s.showAlpha,J.format=s.colorFormat||J.format,J.doOnChange(),i(Fo,J.value)}),tn(()=>ce.value,$t=>{me.value=$t,G&&i("activeChange",$t),G=!0}),tn(()=>J.value,()=>{!s.modelValue&&!se.value&&(se.value=!0)}),tn(()=>oe.value,()=>{oo(()=>{var $t,Le,dn;($t=I.value)==null||$t.update(),(Le=F.value)==null||Le.update(),(dn=B.value)==null||dn.update()})}),or(OD,{currentColor:ce}),t({color:J,show:Ae,hide:Ce,focus:bt,blur:Kt}),($t,Le)=>(le(),Rt(y(qa),{ref_key:"popper",ref:N,visible:oe.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[y(p).be("picker","panel"),y(p).b("dropdown"),$t.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:$t.teleported,transition:`${y(p).namespace.value}-zoom-in-top`,persistent:"",onHide:dn=>Me(!1)},{content:at(()=>[zo((le(),Pe("div",{onKeydown:ti(Mt,["esc"])},[Ve("div",{class:he(y(p).be("dropdown","main-wrapper"))},[Qe(hJ,{ref_key:"hue",ref:I,class:"hue-slider",color:y(J),vertical:""},null,8,["color"]),Qe(SJ,{ref_key:"sv",ref:F,color:y(J)},null,8,["color"])],2),$t.showAlpha?(le(),Rt(cJ,{key:0,ref_key:"alpha",ref:B,color:y(J)},null,8,["color"])):St("v-if",!0),$t.predefine?(le(),Rt(bJ,{key:1,ref:"predefine","enable-alpha":$t.showAlpha,color:y(J),colors:$t.predefine},null,8,["enable-alpha","color","colors"])):St("v-if",!0),Ve("div",{class:he(y(p).be("dropdown","btns"))},[Ve("span",{class:he(y(p).be("dropdown","value"))},[Qe(y(fs),{ref_key:"inputRef",ref:j,modelValue:me.value,"onUpdate:modelValue":dn=>me.value=dn,"validate-event":!1,size:"small",onKeyup:ti(We,["enter"]),onBlur:We},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),Qe(y(Ta),{class:he(y(p).be("dropdown","link-btn")),text:"",size:"small",onClick:Oe},{default:at(()=>[Qo(yn(y(d)("el.colorpicker.clear")),1)]),_:1},8,["class"]),Qe(y(Ta),{plain:"",size:"small",class:he(y(p).be("dropdown","btn")),onClick:ot},{default:at(()=>[Qo(yn(y(d)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[y(ld),Ct]])]),default:at(()=>[Ve("div",Yo({id:y(C),ref_key:"triggerRef",ref:D},$t.$attrs,{class:y(Re),role:"button","aria-label":y(pe),"aria-labelledby":y(ge),"aria-description":y(d)("el.colorpicker.description",{color:$t.modelValue||""}),"aria-disabled":y(w),tabindex:y(w)?-1:$t.tabindex,onKeydown:zt,onFocus:y(ne),onBlur:y(K)}),[y(w)?(le(),Pe("div",{key:0,class:he(y(p).be("picker","mask"))},null,2)):St("v-if",!0),Ve("div",{class:he(y(p).be("picker","trigger")),onClick:Ne},[Ve("span",{class:he([y(p).be("picker","color"),y(p).is("alpha",$t.showAlpha)])},[Ve("span",{class:he(y(p).be("picker","color-inner")),style:to({backgroundColor:y(de)})},[zo(Qe(y(Gn),{class:he([y(p).be("picker","icon"),y(p).is("icon-arrow-down")])},{default:at(()=>[Qe(y(fd))]),_:1},8,["class"]),[[Cr,$t.modelValue||se.value]]),zo(Qe(y(Gn),{class:he([y(p).be("picker","empty"),y(p).is("icon-close")])},{default:at(()=>[Qe(y(Xc))]),_:1},8,["class"]),[[Cr,!$t.modelValue&&!se.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var EJ=xn(CJ,[["__file","color-picker.vue"]]);const MJ=Ao(EJ),IJ=vn({a11y:{type:Boolean,default:!0},locale:{type:ut(Object)},size:ia,button:{type:ut(Object)},experimentalFeatures:{type:ut(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:ut(Object)},zIndex:Number,namespace:{type:String,default:"el"},...Km}),Vc={},AJ=Ze({name:"ElConfigProvider",props:IJ,setup(e,{slots:t}){tn(()=>e.message,s=>{Object.assign(Vc,s??{})},{immediate:!0,deep:!0});const i=pT(e);return()=>_t(t,"default",{config:i==null?void 0:i.value})}}),kJ=Ao(AJ),PJ=Ze({name:"ElContainer"}),RJ=Ze({...PJ,props:{direction:{type:String}},setup(e){const t=e,i=aa(),s=rn("container"),d=te(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:i&&i.default?i.default().some(_=>{const o=_.type.name;return o==="ElHeader"||o==="ElFooter"}):!1);return(p,_)=>(le(),Pe("section",{class:he([y(s).b(),y(s).is("vertical",y(d))])},[_t(p.$slots,"default")],2))}});var LJ=xn(RJ,[["__file","container.vue"]]);const OJ=Ze({name:"ElAside"}),DJ=Ze({...OJ,props:{width:{type:String,default:null}},setup(e){const t=e,i=rn("aside"),s=te(()=>t.width?i.cssVarBlock({width:t.width}):{});return(d,p)=>(le(),Pe("aside",{class:he(y(i).b()),style:to(y(s))},[_t(d.$slots,"default")],6))}});var DD=xn(DJ,[["__file","aside.vue"]]);const zJ=Ze({name:"ElFooter"}),FJ=Ze({...zJ,props:{height:{type:String,default:null}},setup(e){const t=e,i=rn("footer"),s=te(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,p)=>(le(),Pe("footer",{class:he(y(i).b()),style:to(y(s))},[_t(d.$slots,"default")],6))}});var zD=xn(FJ,[["__file","footer.vue"]]);const BJ=Ze({name:"ElHeader"}),NJ=Ze({...BJ,props:{height:{type:String,default:null}},setup(e){const t=e,i=rn("header"),s=te(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,p)=>(le(),Pe("header",{class:he(y(i).b()),style:to(y(s))},[_t(d.$slots,"default")],6))}});var FD=xn(NJ,[["__file","header.vue"]]);const $J=Ze({name:"ElMain"}),VJ=Ze({...$J,setup(e){const t=rn("main");return(i,s)=>(le(),Pe("main",{class:he(y(t).b())},[_t(i.$slots,"default")],2))}});var BD=xn(VJ,[["__file","main.vue"]]);const UJ=Ao(LJ,{Aside:DD,Footer:zD,Header:FD,Main:BD}),jJ=Li(DD),HJ=Li(zD),GJ=Li(FD),WJ=Li(BD);var ND={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},s=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d/,p=/\d\d/,_=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,w={},C=function(j){return(j=+j)+(j>68?1900:2e3)},M=function(j){return function(U){this[j]=+U}},I=[/[+-]\d\d:?(\d\d)?|Z/,function(j){(this.zone||(this.zone={})).offset=function(U){if(!U||U==="Z")return 0;var ne=U.match(/([+-]|\d\d)/g),K=60*ne[1]+(+ne[2]||0);return K===0?0:ne[0]==="+"?-K:K}(j)}],F=function(j){var U=w[j];return U&&(U.indexOf?U:U.s.concat(U.f))},B=function(j,U){var ne,K=w.meridiem;if(K){for(var G=1;G<=24;G+=1)if(j.indexOf(K(G,0,U))>-1){ne=G>12;break}}else ne=j===(U?"pm":"PM");return ne},N={A:[o,function(j){this.afternoon=B(j,!1)}],a:[o,function(j){this.afternoon=B(j,!0)}],Q:[d,function(j){this.month=3*(j-1)+1}],S:[d,function(j){this.milliseconds=100*+j}],SS:[p,function(j){this.milliseconds=10*+j}],SSS:[/\d{3}/,function(j){this.milliseconds=+j}],s:[_,M("seconds")],ss:[_,M("seconds")],m:[_,M("minutes")],mm:[_,M("minutes")],H:[_,M("hours")],h:[_,M("hours")],HH:[_,M("hours")],hh:[_,M("hours")],D:[_,M("day")],DD:[p,M("day")],Do:[o,function(j){var U=w.ordinal,ne=j.match(/\d+/);if(this.day=ne[0],U)for(var K=1;K<=31;K+=1)U(K).replace(/\[|\]/g,"")===j&&(this.day=K)}],w:[_,M("week")],ww:[p,M("week")],M:[_,M("month")],MM:[p,M("month")],MMM:[o,function(j){var U=F("months"),ne=(F("monthsShort")||U.map(function(K){return K.slice(0,3)})).indexOf(j)+1;if(ne<1)throw new Error;this.month=ne%12||ne}],MMMM:[o,function(j){var U=F("months").indexOf(j)+1;if(U<1)throw new Error;this.month=U%12||U}],Y:[/[+-]?\d+/,M("year")],YY:[p,function(j){this.year=C(j)}],YYYY:[/\d{4}/,M("year")],Z:I,ZZ:I};function D(j){var U,ne;U=j,ne=w&&w.formats;for(var K=(j=U.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(ce,pe,ge){var Re=ge&&ge.toUpperCase();return pe||ne[ge]||i[ge]||ne[Re].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Je,Me,xe){return Me||xe.slice(1)})})).match(s),G=K.length,J=0;J<G;J+=1){var oe=K[J],se=N[oe],me=se&&se[0],de=se&&se[1];K[J]=de?{regex:me,parser:de}:oe.replace(/^\[|\]$/g,"")}return function(ce){for(var pe={},ge=0,Re=0;ge<G;ge+=1){var Je=K[ge];if(typeof Je=="string")Re+=Je.length;else{var Me=Je.regex,xe=Je.parser,Ae=ce.slice(Re),Ce=Me.exec(Ae)[0];xe.call(pe,Ce),ce=ce.replace(Ce,"")}}return function(ve){var Ne=ve.afternoon;if(Ne!==void 0){var We=ve.hours;Ne?We<12&&(ve.hours+=12):We===12&&(ve.hours=0),delete ve.afternoon}}(pe),pe}}return function(j,U,ne){ne.p.customParseFormat=!0,j&&j.parseTwoDigitYear&&(C=j.parseTwoDigitYear);var K=U.prototype,G=K.parse;K.parse=function(J){var oe=J.date,se=J.utc,me=J.args;this.$u=se;var de=me[1];if(typeof de=="string"){var ce=me[2]===!0,pe=me[3]===!0,ge=ce||pe,Re=me[2];pe&&(Re=me[2]),w=this.$locale(),!ce&&Re&&(w=ne.Ls[Re]),this.$d=function(Ae,Ce,ve,Ne){try{if(["x","X"].indexOf(Ce)>-1)return new Date((Ce==="X"?1e3:1)*Ae);var We=D(Ce)(Ae),ot=We.year,Oe=We.month,Ct=We.day,Mt=We.hours,zt=We.minutes,bt=We.seconds,Kt=We.milliseconds,$t=We.zone,Le=We.week,dn=new Date,At=Ct||(ot||Oe?1:dn.getDate()),Ke=ot||dn.getFullYear(),Be=0;ot&&!Oe||(Be=Oe>0?Oe-1:dn.getMonth());var Ht,Ut=Mt||0,Nt=zt||0,Et=bt||0,Gt=Kt||0;return $t?new Date(Date.UTC(Ke,Be,At,Ut,Nt,Et,Gt+60*$t.offset*1e3)):ve?new Date(Date.UTC(Ke,Be,At,Ut,Nt,Et,Gt)):(Ht=new Date(Ke,Be,At,Ut,Nt,Et,Gt),Le&&(Ht=Ne(Ht).week(Le).toDate()),Ht)}catch{return new Date("")}}(oe,de,se,ne),this.init(),Re&&Re!==!0&&(this.$L=this.locale(Re).$L),ge&&oe!=this.format(de)&&(this.$d=new Date("")),w={}}else if(de instanceof Array)for(var Je=de.length,Me=1;Me<=Je;Me+=1){me[1]=de[Me-1];var xe=ne.apply(this,me);if(xe.isValid()){this.$d=xe.$d,this.$L=xe.$L,this.init();break}Me===Je&&(this.$d=new Date(""))}else G.call(this,J)}}})})(ND);var qJ=ND.exports;const UT=eu(qJ);var $D={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){return function(i,s){var d=s.prototype,p=d.format;d.format=function(_){var o=this,w=this.$locale();if(!this.isValid())return p.bind(this)(_);var C=this.$utils(),M=(_||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(I){switch(I){case"Q":return Math.ceil((o.$M+1)/3);case"Do":return w.ordinal(o.$D);case"gggg":return o.weekYear();case"GGGG":return o.isoWeekYear();case"wo":return w.ordinal(o.week(),"W");case"w":case"ww":return C.s(o.week(),I==="w"?1:2,"0");case"W":case"WW":return C.s(o.isoWeek(),I==="W"?1:2,"0");case"k":case"kk":return C.s(String(o.$H===0?24:o.$H),I==="k"?1:2,"0");case"X":return Math.floor(o.$d.getTime()/1e3);case"x":return o.$d.getTime();case"z":return"["+o.offsetName()+"]";case"zzz":return"["+o.offsetName("long")+"]";default:return I}});return p.bind(this)(M)}}})})($D);var KJ=$D.exports;const ZJ=eu(KJ);var VD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){var i="week",s="year";return function(d,p,_){var o=p.prototype;o.week=function(w){if(w===void 0&&(w=null),w!==null)return this.add(7*(w-this.week()),"day");var C=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var M=_(this).startOf(s).add(1,s).date(C),I=_(this).endOf(i);if(M.isBefore(I))return 1}var F=_(this).startOf(s).date(C).startOf(i).subtract(1,"millisecond"),B=this.diff(F,i,!0);return B<0?_(this).startOf("week").week():Math.ceil(B)},o.weeks=function(w){return w===void 0&&(w=null),this.week(w)}}})})(VD);var YJ=VD.exports;const XJ=eu(YJ);var UD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){return function(i,s){s.prototype.weekYear=function(){var d=this.month(),p=this.week(),_=this.year();return p===1&&d===11?_+1:d===0&&p>=52?_-1:_}}})})(UD);var JJ=UD.exports;const QJ=eu(JJ);var jD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){return function(i,s,d){s.prototype.dayOfYear=function(p){var _=Math.round((d(this).startOf("day")-d(this).startOf("year"))/864e5)+1;return p==null?_:this.add(p-_,"day")}}})})(jD);var eQ=jD.exports;const tQ=eu(eQ);var HD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){return function(i,s){s.prototype.isSameOrAfter=function(d,p){return this.isSame(d,p)||this.isAfter(d,p)}}})})(HD);var nQ=HD.exports;const oQ=eu(nQ);var GD={exports:{}};(function(e,t){(function(i,s){e.exports=s()})(Ls,function(){return function(i,s){s.prototype.isSameOrBefore=function(d,p){return this.isSame(d,p)||this.isBefore(d,p)}}})})(GD);var rQ=GD.exports;const iQ=eu(rQ),PP=["hours","minutes","seconds"],B2="HH:mm:ss",om="YYYY-MM-DD",aQ={date:om,dates:om,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${om} ${B2}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:om,datetimerange:`${om} ${B2}`},WD=vn({disabledHours:{type:ut(Function)},disabledMinutes:{type:ut(Function)},disabledSeconds:{type:ut(Function)}}),qD=vn({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),jT=vn({id:{type:ut([Array,String])},name:{type:ut([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:ut([String,Object]),default:pd},editable:{type:Boolean,default:!0},prefixIcon:{type:ut([String,Object]),default:""},size:ia,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})},modelValue:{type:ut([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:ut([Date,Array])},defaultTime:{type:ut([Date,Array])},isRange:Boolean,...WD,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:ut([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:ut(String),values:md,default:"bottom"},fallbackPlacements:{type:ut(Array),default:["bottom","top","right","left"]},...Km,...Da(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),sQ=vn({id:{type:ut(Array)},name:{type:ut(Array)},modelValue:{type:ut([Array,String])},startPlaceholder:String,endPlaceholder:String}),lQ=Ze({name:"PickerRangeTrigger",inheritAttrs:!1}),cQ=Ze({...lQ,props:sQ,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(e,{expose:t,emit:i}){const s=j_(),d=rn("date"),p=rn("range"),_=we(),o=we(),{wrapperRef:w,isFocused:C}=Lh(_),M=G=>{i("click",G)},I=G=>{i("mouseenter",G)},F=G=>{i("mouseleave",G)},B=G=>{i("mouseenter",G)},N=G=>{i("startInput",G)},D=G=>{i("endInput",G)},j=G=>{i("startChange",G)},U=G=>{i("endChange",G)};return t({focus:()=>{var G;(G=_.value)==null||G.focus()},blur:()=>{var G,J;(G=_.value)==null||G.blur(),(J=o.value)==null||J.blur()}}),(G,J)=>(le(),Pe("div",{ref_key:"wrapperRef",ref:w,class:he([y(d).is("active",y(C)),G.$attrs.class]),style:to(G.$attrs.style),onClick:M,onMouseenter:I,onMouseleave:F,onTouchstartPassive:B},[_t(G.$slots,"prefix"),Ve("input",Yo(y(s),{id:G.id&&G.id[0],ref_key:"inputRef",ref:_,name:G.name&&G.name[0],placeholder:G.startPlaceholder,value:G.modelValue&&G.modelValue[0],class:y(p).b("input"),onInput:N,onChange:j}),null,16,["id","name","placeholder","value"]),_t(G.$slots,"range-separator"),Ve("input",Yo(y(s),{id:G.id&&G.id[1],ref_key:"endInputRef",ref:o,name:G.name&&G.name[1],placeholder:G.endPlaceholder,value:G.modelValue&&G.modelValue[1],class:y(p).b("input"),onInput:D,onChange:U}),null,16,["id","name","placeholder","value"]),_t(G.$slots,"suffix")],38))}});var uQ=xn(cQ,[["__file","picker-range-trigger.vue"]]);const dQ=Ze({name:"Picker"}),hQ=Ze({...dQ,props:jT,emits:["update:modelValue","change","focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:i}){const s=e,d=Ph(),{lang:p}=vr(),_=rn("date"),o=rn("input"),w=rn("range"),{form:C,formItem:M}=Ka(),I=Un("ElPopperOptions",{}),{valueOnClear:F}=m1(s,null),B=we(),N=we(),D=we(!1),j=we(!1),U=we(null);let ne=!1;const{isFocused:K,handleFocus:G,handleBlur:J}=Lh(N,{beforeFocus(){return s.readonly||ve.value},afterFocus(){D.value=!0},beforeBlur(et){var Mn;return!ne&&((Mn=B.value)==null?void 0:Mn.isFocusInsideContent(et))},afterBlur(){ln(),D.value=!1,ne=!1,s.validateEvent&&(M==null||M.validate("blur").catch(et=>void 0))}}),oe=te(()=>[_.b("editor"),_.bm("editor",s.type),o.e("wrapper"),_.is("disabled",ve.value),_.is("active",D.value),w.b("editor"),Ut?w.bm("editor",Ut.value):"",d.class]),se=te(()=>[o.e("icon"),w.e("close-icon"),Kt.value?"":w.e("close-icon--hidden")]);tn(D,et=>{et?oo(()=>{et&&(U.value=s.modelValue)}):(Gt.value=null,oo(()=>{me(s.modelValue)}))});const me=(et,Mn)=>{(Mn||!gP(et,U.value))&&(i("change",et),s.validateEvent&&(M==null||M.validate("change").catch(Bn=>void 0)))},de=et=>{if(!gP(s.modelValue,et)){let Mn;fn(et)?Mn=et.map(Bn=>_P(Bn,s.valueFormat,p.value)):et&&(Mn=_P(et,s.valueFormat,p.value)),i("update:modelValue",et&&Mn,p.value)}},ce=et=>{i("keydown",et)},pe=te(()=>N.value?Array.from(N.value.$el.querySelectorAll("input")):[]),ge=(et,Mn,Bn)=>{const Lo=pe.value;Lo.length&&(!Bn||Bn==="min"?(Lo[0].setSelectionRange(et,Mn),Lo[0].focus()):Bn==="max"&&(Lo[1].setSelectionRange(et,Mn),Lo[1].focus()))},Re=(et="",Mn=!1)=>{D.value=Mn;let Bn;fn(et)?Bn=et.map(Lo=>Lo.toDate()):Bn=et&&et.toDate(),Gt.value=null,de(Bn)},Je=()=>{j.value=!0},Me=()=>{i("visible-change",!0)},xe=()=>{j.value=!1,D.value=!1,i("visible-change",!1)},Ae=()=>{D.value=!0},Ce=()=>{D.value=!1},ve=te(()=>s.disabled||(C==null?void 0:C.disabled)),Ne=te(()=>{let et;if(Le.value?Ho.value.getDefaultValue&&(et=Ho.value.getDefaultValue()):fn(s.modelValue)?et=s.modelValue.map(Mn=>vP(Mn,s.valueFormat,p.value)):et=vP(s.modelValue,s.valueFormat,p.value),Ho.value.getRangeAvailableTime){const Mn=Ho.value.getRangeAvailableTime(et);La(Mn,et)||(et=Mn,Le.value||de(F0(et)))}return fn(et)&&et.some(Mn=>!Mn)&&(et=[]),et}),We=te(()=>{if(!Ho.value.panelReady)return"";const et=_n(Ne.value);return fn(Gt.value)?[Gt.value[0]||et&&et[0]||"",Gt.value[1]||et&&et[1]||""]:Gt.value!==null?Gt.value:!Oe.value&&Le.value||!D.value&&Le.value?"":et?Ct.value||Mt.value||zt.value?et.join(", "):et:""}),ot=te(()=>s.type.includes("time")),Oe=te(()=>s.type.startsWith("time")),Ct=te(()=>s.type==="dates"),Mt=te(()=>s.type==="months"),zt=te(()=>s.type==="years"),bt=te(()=>s.prefixIcon||(ot.value?SO:$W)),Kt=we(!1),$t=et=>{s.readonly||ve.value||(Kt.value&&(et.stopPropagation(),Ho.value.handleClear?Ho.value.handleClear():de(F.value),me(F.value,!0),Kt.value=!1,xe()),i("clear"))},Le=te(()=>{const{modelValue:et}=s;return!et||fn(et)&&!et.filter(Boolean).length}),dn=async et=>{var Mn;s.readonly||ve.value||(((Mn=et.target)==null?void 0:Mn.tagName)!=="INPUT"||K.value)&&(D.value=!0)},At=()=>{s.readonly||ve.value||!Le.value&&s.clearable&&(Kt.value=!0)},Ke=()=>{Kt.value=!1},Be=et=>{var Mn;s.readonly||ve.value||(((Mn=et.touches[0].target)==null?void 0:Mn.tagName)!=="INPUT"||K.value)&&(D.value=!0)},Ht=te(()=>s.type.includes("range")),Ut=na(),Nt=te(()=>{var et,Mn;return(Mn=(et=y(B))==null?void 0:et.popperRef)==null?void 0:Mn.contentRef}),Et=fT(N,et=>{const Mn=y(Nt),Bn=Ds(N);Mn&&(et.target===Mn||et.composedPath().includes(Mn))||et.target===Bn||Bn&&et.composedPath().includes(Bn)||(D.value=!1)});ni(()=>{Et==null||Et()});const Gt=we(null),ln=()=>{if(Gt.value){const et=bn(We.value);et&&jn(et)&&(de(F0(et)),Gt.value=null)}Gt.value===""&&(de(F.value),me(F.value),Gt.value=null)},bn=et=>et?Ho.value.parseUserInput(et):null,_n=et=>et?Ho.value.formatToString(et):null,jn=et=>Ho.value.isValidValue(et),yt=async et=>{if(s.readonly||ve.value)return;const{code:Mn}=et;if(ce(et),Mn===Ln.esc){D.value===!0&&(D.value=!1,et.preventDefault(),et.stopPropagation());return}if(Mn===Ln.down&&(Ho.value.handleFocusPicker&&(et.preventDefault(),et.stopPropagation()),D.value===!1&&(D.value=!0,await oo()),Ho.value.handleFocusPicker)){Ho.value.handleFocusPicker();return}if(Mn===Ln.tab){ne=!0;return}if(Mn===Ln.enter||Mn===Ln.numpadEnter){(Gt.value===null||Gt.value===""||jn(bn(We.value)))&&(ln(),D.value=!1),et.stopPropagation();return}if(Gt.value){et.stopPropagation();return}Ho.value.handleKeydownInput&&Ho.value.handleKeydownInput(et)},kn=et=>{Gt.value=et,D.value||(D.value=!0)},qn=et=>{const Mn=et.target;Gt.value?Gt.value=[Mn.value,Gt.value[1]]:Gt.value=[Mn.value,null]},Co=et=>{const Mn=et.target;Gt.value?Gt.value=[Gt.value[0],Mn.value]:Gt.value=[null,Mn.value]},mo=()=>{var et;const Mn=Gt.value,Bn=bn(Mn&&Mn[0]),Lo=y(Ne);if(Bn&&Bn.isValid()){Gt.value=[_n(Bn),((et=We.value)==null?void 0:et[1])||null];const Rr=[Bn,Lo&&(Lo[1]||null)];jn(Rr)&&(de(F0(Rr)),Gt.value=null)}},Io=()=>{var et;const Mn=y(Gt),Bn=bn(Mn&&Mn[1]),Lo=y(Ne);if(Bn&&Bn.isValid()){Gt.value=[((et=y(We))==null?void 0:et[0])||null,_n(Bn)];const Rr=[Lo&&Lo[0],Bn];jn(Rr)&&(de(F0(Rr)),Gt.value=null)}},Ho=we({}),ur=et=>{Ho.value[et[0]]=et[1],Ho.value.panelReady=!0},Dt=et=>{i("calendar-change",et)},En=(et,Mn,Bn)=>{i("panel-change",et,Mn,Bn)},ft=()=>{var et;(et=N.value)==null||et.focus()},un=()=>{var et;(et=N.value)==null||et.blur()};return or("EP_PICKER_BASE",{props:s}),t({focus:ft,blur:un,handleOpen:Ae,handleClose:Ce,onPick:Re}),(et,Mn)=>(le(),Rt(y(qa),Yo({ref_key:"refPopper",ref:B,visible:D.value,effect:"light",pure:"",trigger:"click"},et.$attrs,{role:"dialog",teleported:"",transition:`${y(_).namespace.value}-zoom-in-top`,"popper-class":[`${y(_).namespace.value}-picker__popper`,et.popperClass],"popper-options":y(I),"fallback-placements":et.fallbackPlacements,"gpu-acceleration":!1,placement:et.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:Je,onShow:Me,onHide:xe}),{default:at(()=>[y(Ht)?(le(),Rt(uQ,{key:1,id:et.id,ref_key:"inputRef",ref:N,"model-value":y(We),name:et.name,disabled:y(ve),readonly:!et.editable||et.readonly,"start-placeholder":et.startPlaceholder,"end-placeholder":et.endPlaceholder,class:he(y(oe)),style:to(et.$attrs.style),"aria-label":et.ariaLabel,tabindex:et.tabindex,autocomplete:"off",role:"combobox",onClick:dn,onFocus:y(G),onBlur:y(J),onStartInput:qn,onStartChange:mo,onEndInput:Co,onEndChange:Io,onMousedown:dn,onMouseenter:At,onMouseleave:Ke,onTouchstartPassive:Be,onKeydown:yt},{prefix:at(()=>[y(bt)?(le(),Rt(y(Gn),{key:0,class:he([y(o).e("icon"),y(w).e("icon")])},{default:at(()=>[(le(),Rt(Wo(y(bt))))]),_:1},8,["class"])):St("v-if",!0)]),"range-separator":at(()=>[_t(et.$slots,"range-separator",{},()=>[Ve("span",{class:he(y(w).b("separator"))},yn(et.rangeSeparator),3)])]),suffix:at(()=>[et.clearIcon?(le(),Rt(y(Gn),{key:0,class:he(y(se)),onMousedown:po(y(jr),["prevent"]),onClick:$t},{default:at(()=>[(le(),Rt(Wo(et.clearIcon)))]),_:1},8,["class","onMousedown"])):St("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(le(),Rt(y(fs),{key:0,id:et.id,ref_key:"inputRef",ref:N,"container-role":"combobox","model-value":y(We),name:et.name,size:y(Ut),disabled:y(ve),placeholder:et.placeholder,class:he([y(_).b("editor"),y(_).bm("editor",et.type),et.$attrs.class]),style:to(et.$attrs.style),readonly:!et.editable||et.readonly||y(Ct)||y(Mt)||y(zt)||et.type==="week","aria-label":et.ariaLabel,tabindex:et.tabindex,"validate-event":!1,onInput:kn,onFocus:y(G),onBlur:y(J),onKeydown:yt,onChange:ln,onMousedown:dn,onMouseenter:At,onMouseleave:Ke,onTouchstartPassive:Be,onClick:po(()=>{},["stop"])},{prefix:at(()=>[y(bt)?(le(),Rt(y(Gn),{key:0,class:he(y(o).e("icon")),onMousedown:po(dn,["prevent"]),onTouchstartPassive:Be},{default:at(()=>[(le(),Rt(Wo(y(bt))))]),_:1},8,["class","onMousedown"])):St("v-if",!0)]),suffix:at(()=>[Kt.value&&et.clearIcon?(le(),Rt(y(Gn),{key:0,class:he(`${y(o).e("icon")} clear-icon`),onMousedown:po(y(jr),["prevent"]),onClick:$t},{default:at(()=>[(le(),Rt(Wo(et.clearIcon)))]),_:1},8,["class","onMousedown"])):St("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:at(()=>[_t(et.$slots,"default",{visible:D.value,actualVisible:j.value,parsedValue:y(Ne),format:et.format,dateFormat:et.dateFormat,timeFormat:et.timeFormat,unlinkPanels:et.unlinkPanels,type:et.type,defaultValue:et.defaultValue,showNow:et.showNow,onPick:Re,onSelectRange:ge,onSetPickerOption:ur,onCalendarChange:Dt,onPanelChange:En,onMousedown:po(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var KD=xn(hQ,[["__file","picker.vue"]]);const fQ=vn({...qD,datetimeRole:String,parsedValue:{type:ut(Object)}}),ZD=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:i})=>{const s=(_,o,w,C)=>{const M={hour:e,minute:t,second:i};let I=_;return["hour","minute","second"].forEach(F=>{if(M[F]){let B;const N=M[F];switch(F){case"minute":{B=N(I.hour(),o,C);break}case"second":{B=N(I.hour(),I.minute(),o,C);break}default:{B=N(o,C);break}}if(B!=null&&B.length&&!B.includes(I[F]())){const D=w?0:B.length-1;I=I[F](B[D])}}}),I},d={};return{timePickerOptions:d,getAvailableTime:s,onSetOption:([_,o])=>{d[_]=o}}},jw=e=>{const t=(s,d)=>s||d,i=s=>s!==!0;return e.map(t).filter(i)},YD=(e,t,i)=>({getHoursList:(_,o)=>Nw(24,e&&(()=>e==null?void 0:e(_,o))),getMinutesList:(_,o,w)=>Nw(60,t&&(()=>t==null?void 0:t(_,o,w))),getSecondsList:(_,o,w,C)=>Nw(60,i&&(()=>i==null?void 0:i(_,o,w,C)))}),XD=(e,t,i)=>{const{getHoursList:s,getMinutesList:d,getSecondsList:p}=YD(e,t,i);return{getAvailableHours:(C,M)=>jw(s(C,M)),getAvailableMinutes:(C,M,I)=>jw(d(C,M,I)),getAvailableSeconds:(C,M,I,F)=>jw(p(C,M,I,F))}},JD=e=>{const t=we(e.parsedValue);return tn(()=>e.visible,i=>{i||(t.value=e.parsedValue)}),t},pQ=vn({role:{type:String,required:!0},spinnerDate:{type:ut(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:ut(String),default:""},...WD}),mQ=100,gQ=600,kb={beforeMount(e,t){const i=t.value,{interval:s=mQ,delay:d=gQ}=Qn(i)?{}:i;let p,_;const o=()=>Qn(i)?i():i.handler(),w=()=>{_&&(clearTimeout(_),_=void 0),p&&(clearInterval(p),p=void 0)};e.addEventListener("mousedown",C=>{C.button===0&&(w(),o(),document.addEventListener("mouseup",()=>w(),{once:!0}),_=setTimeout(()=>{p=setInterval(()=>{o()},s)},d))})}},vQ=Ze({__name:"basic-time-spinner",props:pQ,emits:["change","select-range","set-option"],setup(e,{emit:t}){const i=e,s=Un("EP_PICKER_BASE"),{isRange:d}=s.props,p=rn("time"),{getHoursList:_,getMinutesList:o,getSecondsList:w}=YD(i.disabledHours,i.disabledMinutes,i.disabledSeconds);let C=!1;const M=we(),I=we(),F=we(),B=we(),N={hours:I,minutes:F,seconds:B},D=te(()=>i.showSeconds?PP:PP.slice(0,2)),j=te(()=>{const{spinnerDate:We}=i,ot=We.hour(),Oe=We.minute(),Ct=We.second();return{hours:ot,minutes:Oe,seconds:Ct}}),U=te(()=>{const{hours:We,minutes:ot}=y(j),{role:Oe,spinnerDate:Ct}=i,Mt=d?void 0:Ct;return{hours:_(Oe,Mt),minutes:o(We,Oe,Mt),seconds:w(We,ot,Oe,Mt)}}),ne=te(()=>{const{hours:We,minutes:ot,seconds:Oe}=y(j);return{hours:Bw(We,23),minutes:Bw(ot,59),seconds:Bw(Oe,59)}}),K=il(We=>{C=!1,oe(We)},200),G=We=>{if(!!!i.amPmMode)return"";const Oe=i.amPmMode==="A";let Ct=We<12?" am":" pm";return Oe&&(Ct=Ct.toUpperCase()),Ct},J=We=>{let ot;switch(We){case"hours":ot=[0,2];break;case"minutes":ot=[3,5];break;case"seconds":ot=[6,8];break}const[Oe,Ct]=ot;t("select-range",Oe,Ct),M.value=We},oe=We=>{de(We,y(j)[We])},se=()=>{oe("hours"),oe("minutes"),oe("seconds")},me=We=>We.querySelector(`.${p.namespace.value}-scrollbar__wrap`),de=(We,ot)=>{if(i.arrowControl)return;const Oe=y(N[We]);Oe&&Oe.$el&&(me(Oe.$el).scrollTop=Math.max(0,ot*ce(We)))},ce=We=>{const ot=y(N[We]),Oe=ot==null?void 0:ot.$el.querySelector("li");return Oe&&Number.parseFloat(td(Oe,"height"))||0},pe=()=>{Re(1)},ge=()=>{Re(-1)},Re=We=>{M.value||J("hours");const ot=M.value,Oe=y(j)[ot],Ct=M.value==="hours"?24:60,Mt=Je(ot,Oe,We,Ct);Me(ot,Mt),de(ot,Mt),oo(()=>J(ot))},Je=(We,ot,Oe,Ct)=>{let Mt=(ot+Oe+Ct)%Ct;const zt=y(U)[We];for(;zt[Mt]&&Mt!==ot;)Mt=(Mt+Oe+Ct)%Ct;return Mt},Me=(We,ot)=>{if(y(U)[We][ot])return;const{hours:Mt,minutes:zt,seconds:bt}=y(j);let Kt;switch(We){case"hours":Kt=i.spinnerDate.hour(ot).minute(zt).second(bt);break;case"minutes":Kt=i.spinnerDate.hour(Mt).minute(ot).second(bt);break;case"seconds":Kt=i.spinnerDate.hour(Mt).minute(zt).second(ot);break}t("change",Kt)},xe=(We,{value:ot,disabled:Oe})=>{Oe||(Me(We,ot),J(We),de(We,ot))},Ae=We=>{const ot=y(N[We]);if(!ot)return;C=!0,K(We);const Oe=Math.min(Math.round((me(ot.$el).scrollTop-(Ce(We)*.5-10)/ce(We)+3)/ce(We)),We==="hours"?23:59);Me(We,Oe)},Ce=We=>y(N[We]).$el.offsetHeight,ve=()=>{const We=ot=>{const Oe=y(N[ot]);Oe&&Oe.$el&&(me(Oe.$el).onscroll=()=>{Ae(ot)})};We("hours"),We("minutes"),We("seconds")};No(()=>{oo(()=>{!i.arrowControl&&ve(),se(),i.role==="start"&&J("hours")})});const Ne=(We,ot)=>{N[ot].value=We??void 0};return t("set-option",[`${i.role}_scrollDown`,Re]),t("set-option",[`${i.role}_emitSelectRange`,J]),tn(()=>i.spinnerDate,()=>{C||se()}),(We,ot)=>(le(),Pe("div",{class:he([y(p).b("spinner"),{"has-seconds":We.showSeconds}])},[We.arrowControl?St("v-if",!0):(le(!0),Pe(eo,{key:0},nr(y(D),Oe=>(le(),Rt(y(Ou),{key:Oe,ref_for:!0,ref:Ct=>Ne(Ct,Oe),class:he(y(p).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":y(p).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:Ct=>J(Oe),onMousemove:Ct=>oe(Oe)},{default:at(()=>[(le(!0),Pe(eo,null,nr(y(U)[Oe],(Ct,Mt)=>(le(),Pe("li",{key:Mt,class:he([y(p).be("spinner","item"),y(p).is("active",Mt===y(j)[Oe]),y(p).is("disabled",Ct)]),onClick:zt=>xe(Oe,{value:Mt,disabled:Ct})},[Oe==="hours"?(le(),Pe(eo,{key:0},[Qo(yn(("0"+(We.amPmMode?Mt%12||12:Mt)).slice(-2))+yn(G(Mt)),1)],64)):(le(),Pe(eo,{key:1},[Qo(yn(("0"+Mt).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),We.arrowControl?(le(!0),Pe(eo,{key:1},nr(y(D),Oe=>(le(),Pe("div",{key:Oe,class:he([y(p).be("spinner","wrapper"),y(p).is("arrow")]),onMouseenter:Ct=>J(Oe)},[zo((le(),Rt(y(Gn),{class:he(["arrow-up",y(p).be("spinner","arrow")])},{default:at(()=>[Qe(y(vT))]),_:1},8,["class"])),[[y(kb),ge]]),zo((le(),Rt(y(Gn),{class:he(["arrow-down",y(p).be("spinner","arrow")])},{default:at(()=>[Qe(y(fd))]),_:1},8,["class"])),[[y(kb),pe]]),Ve("ul",{class:he(y(p).be("spinner","list"))},[(le(!0),Pe(eo,null,nr(y(ne)[Oe],(Ct,Mt)=>(le(),Pe("li",{key:Mt,class:he([y(p).be("spinner","item"),y(p).is("active",Ct===y(j)[Oe]),y(p).is("disabled",y(U)[Oe][Ct])])},[y(ao)(Ct)?(le(),Pe(eo,{key:0},[Oe==="hours"?(le(),Pe(eo,{key:0},[Qo(yn(("0"+(We.amPmMode?Ct%12||12:Ct)).slice(-2))+yn(G(Ct)),1)],64)):(le(),Pe(eo,{key:1},[Qo(yn(("0"+Ct).slice(-2)),1)],64))],64)):St("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):St("v-if",!0)],2))}});var N2=xn(vQ,[["__file","basic-time-spinner.vue"]]);const _Q=Ze({__name:"panel-time-pick",props:fQ,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,s=Un("EP_PICKER_BASE"),{arrowControl:d,disabledHours:p,disabledMinutes:_,disabledSeconds:o,defaultValue:w}=s.props,{getAvailableHours:C,getAvailableMinutes:M,getAvailableSeconds:I}=XD(p,_,o),F=rn("time"),{t:B,lang:N}=vr(),D=we([0,2]),j=JD(i),U=te(()=>Hr(i.actualVisible)?`${F.namespace.value}-zoom-in-top`:""),ne=te(()=>i.format.includes("ss")),K=te(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),G=Ce=>{const ve=Mo(Ce).locale(N.value),Ne=Je(ve);return ve.isSame(Ne)},J=()=>{t("pick",j.value,!1)},oe=(Ce=!1,ve=!1)=>{ve||t("pick",i.parsedValue,Ce)},se=Ce=>{if(!i.visible)return;const ve=Je(Ce).millisecond(0);t("pick",ve,!0)},me=(Ce,ve)=>{t("select-range",Ce,ve),D.value=[Ce,ve]},de=Ce=>{const ve=[0,3].concat(ne.value?[6]:[]),Ne=["hours","minutes"].concat(ne.value?["seconds"]:[]),ot=(ve.indexOf(D.value[0])+Ce+ve.length)%ve.length;pe.start_emitSelectRange(Ne[ot])},ce=Ce=>{const ve=Ce.code,{left:Ne,right:We,up:ot,down:Oe}=Ln;if([Ne,We].includes(ve)){de(ve===Ne?-1:1),Ce.preventDefault();return}if([ot,Oe].includes(ve)){const Ct=ve===ot?-1:1;pe.start_scrollDown(Ct),Ce.preventDefault();return}},{timePickerOptions:pe,onSetOption:ge,getAvailableTime:Re}=ZD({getAvailableHours:C,getAvailableMinutes:M,getAvailableSeconds:I}),Je=Ce=>Re(Ce,i.datetimeRole||"",!0),Me=Ce=>Ce?Mo(Ce,i.format).locale(N.value):null,xe=Ce=>Ce?Ce.format(i.format):null,Ae=()=>Mo(w).locale(N.value);return t("set-picker-option",["isValidValue",G]),t("set-picker-option",["formatToString",xe]),t("set-picker-option",["parseUserInput",Me]),t("set-picker-option",["handleKeydownInput",ce]),t("set-picker-option",["getRangeAvailableTime",Je]),t("set-picker-option",["getDefaultValue",Ae]),(Ce,ve)=>(le(),Rt(Ea,{name:y(U)},{default:at(()=>[Ce.actualVisible||Ce.visible?(le(),Pe("div",{key:0,class:he(y(F).b("panel"))},[Ve("div",{class:he([y(F).be("panel","content"),{"has-seconds":y(ne)}])},[Qe(N2,{ref:"spinner",role:Ce.datetimeRole||"start","arrow-control":y(d),"show-seconds":y(ne),"am-pm-mode":y(K),"spinner-date":Ce.parsedValue,"disabled-hours":y(p),"disabled-minutes":y(_),"disabled-seconds":y(o),onChange:se,onSetOption:y(ge),onSelectRange:me},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Ve("div",{class:he(y(F).be("panel","footer"))},[Ve("button",{type:"button",class:he([y(F).be("panel","btn"),"cancel"]),onClick:J},yn(y(B)("el.datepicker.cancel")),3),Ve("button",{type:"button",class:he([y(F).be("panel","btn"),"confirm"]),onClick:Ne=>oe()},yn(y(B)("el.datepicker.confirm")),11,["onClick"])],2)],2)):St("v-if",!0)]),_:1},8,["name"]))}});var Pb=xn(_Q,[["__file","panel-time-pick.vue"]]);const yQ=vn({...qD,parsedValue:{type:ut(Array)}}),bQ=Ze({__name:"panel-time-range",props:yQ,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,s=(dn,At)=>{const Ke=[];for(let Be=dn;Be<=At;Be++)Ke.push(Be);return Ke},{t:d,lang:p}=vr(),_=rn("time"),o=rn("picker"),w=Un("EP_PICKER_BASE"),{arrowControl:C,disabledHours:M,disabledMinutes:I,disabledSeconds:F,defaultValue:B}=w.props,N=te(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",C),G.value?"has-seconds":""]),D=te(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",C),G.value?"has-seconds":""]),j=te(()=>i.parsedValue[0]),U=te(()=>i.parsedValue[1]),ne=JD(i),K=()=>{t("pick",ne.value,!1)},G=te(()=>i.format.includes("ss")),J=te(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),oe=(dn=!1)=>{t("pick",[j.value,U.value],dn)},se=dn=>{ce(dn.millisecond(0),U.value)},me=dn=>{ce(j.value,dn.millisecond(0))},de=dn=>{const At=dn.map(Be=>Mo(Be).locale(p.value)),Ke=We(At);return At[0].isSame(Ke[0])&&At[1].isSame(Ke[1])},ce=(dn,At)=>{i.visible&&t("pick",[dn,At],!0)},pe=te(()=>j.value>U.value),ge=we([0,2]),Re=(dn,At)=>{t("select-range",dn,At,"min"),ge.value=[dn,At]},Je=te(()=>G.value?11:8),Me=(dn,At)=>{t("select-range",dn,At,"max");const Ke=y(Je);ge.value=[dn+Ke,At+Ke]},xe=dn=>{const At=G.value?[0,3,6,11,14,17]:[0,3,8,11],Ke=["hours","minutes"].concat(G.value?["seconds"]:[]),Ht=(At.indexOf(ge.value[0])+dn+At.length)%At.length,Ut=At.length/2;Ht<Ut?Mt.start_emitSelectRange(Ke[Ht]):Mt.end_emitSelectRange(Ke[Ht-Ut])},Ae=dn=>{const At=dn.code,{left:Ke,right:Be,up:Ht,down:Ut}=Ln;if([Ke,Be].includes(At)){xe(At===Ke?-1:1),dn.preventDefault();return}if([Ht,Ut].includes(At)){const Nt=At===Ht?-1:1,Et=ge.value[0]<Je.value?"start":"end";Mt[`${Et}_scrollDown`](Nt),dn.preventDefault();return}},Ce=(dn,At)=>{const Ke=M?M(dn):[],Be=dn==="start",Ut=(At||(Be?U.value:j.value)).hour(),Nt=Be?s(Ut+1,23):s(0,Ut-1);return Rw(Ke,Nt)},ve=(dn,At,Ke)=>{const Be=I?I(dn,At):[],Ht=At==="start",Ut=Ke||(Ht?U.value:j.value),Nt=Ut.hour();if(dn!==Nt)return Be;const Et=Ut.minute(),Gt=Ht?s(Et+1,59):s(0,Et-1);return Rw(Be,Gt)},Ne=(dn,At,Ke,Be)=>{const Ht=F?F(dn,At,Ke):[],Ut=Ke==="start",Nt=Be||(Ut?U.value:j.value),Et=Nt.hour(),Gt=Nt.minute();if(dn!==Et||At!==Gt)return Ht;const ln=Nt.second(),bn=Ut?s(ln+1,59):s(0,ln-1);return Rw(Ht,bn)},We=([dn,At])=>[zt(dn,"start",!0,At),zt(At,"end",!1,dn)],{getAvailableHours:ot,getAvailableMinutes:Oe,getAvailableSeconds:Ct}=XD(Ce,ve,Ne),{timePickerOptions:Mt,getAvailableTime:zt,onSetOption:bt}=ZD({getAvailableHours:ot,getAvailableMinutes:Oe,getAvailableSeconds:Ct}),Kt=dn=>dn?fn(dn)?dn.map(At=>Mo(At,i.format).locale(p.value)):Mo(dn,i.format).locale(p.value):null,$t=dn=>dn?fn(dn)?dn.map(At=>At.format(i.format)):dn.format(i.format):null,Le=()=>{if(fn(B))return B.map(At=>Mo(At).locale(p.value));const dn=Mo(B).locale(p.value);return[dn,dn.add(60,"m")]};return t("set-picker-option",["formatToString",$t]),t("set-picker-option",["parseUserInput",Kt]),t("set-picker-option",["isValidValue",de]),t("set-picker-option",["handleKeydownInput",Ae]),t("set-picker-option",["getDefaultValue",Le]),t("set-picker-option",["getRangeAvailableTime",We]),(dn,At)=>dn.actualVisible?(le(),Pe("div",{key:0,class:he([y(_).b("range-picker"),y(o).b("panel")])},[Ve("div",{class:he(y(_).be("range-picker","content"))},[Ve("div",{class:he(y(_).be("range-picker","cell"))},[Ve("div",{class:he(y(_).be("range-picker","header"))},yn(y(d)("el.datepicker.startTime")),3),Ve("div",{class:he(y(N))},[Qe(N2,{ref:"minSpinner",role:"start","show-seconds":y(G),"am-pm-mode":y(J),"arrow-control":y(C),"spinner-date":y(j),"disabled-hours":Ce,"disabled-minutes":ve,"disabled-seconds":Ne,onChange:se,onSetOption:y(bt),onSelectRange:Re},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Ve("div",{class:he(y(_).be("range-picker","cell"))},[Ve("div",{class:he(y(_).be("range-picker","header"))},yn(y(d)("el.datepicker.endTime")),3),Ve("div",{class:he(y(D))},[Qe(N2,{ref:"maxSpinner",role:"end","show-seconds":y(G),"am-pm-mode":y(J),"arrow-control":y(C),"spinner-date":y(U),"disabled-hours":Ce,"disabled-minutes":ve,"disabled-seconds":Ne,onChange:me,onSetOption:y(bt),onSelectRange:Me},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Ve("div",{class:he(y(_).be("panel","footer"))},[Ve("button",{type:"button",class:he([y(_).be("panel","btn"),"cancel"]),onClick:Ke=>K()},yn(y(d)("el.datepicker.cancel")),11,["onClick"]),Ve("button",{type:"button",class:he([y(_).be("panel","btn"),"confirm"]),disabled:y(pe),onClick:Ke=>oe()},yn(y(d)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):St("v-if",!0)}});var xQ=xn(bQ,[["__file","panel-time-range.vue"]]);Mo.extend(UT);var wQ=Ze({name:"ElTimePicker",install:null,props:{...jT,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const i=we(),[s,d]=e.isRange?["timerange",xQ]:["time",Pb],p=_=>t.emit("update:modelValue",_);return or("ElPopperOptions",e.popperOptions),t.expose({focus:()=>{var _;(_=i.value)==null||_.focus()},blur:()=>{var _;(_=i.value)==null||_.blur()},handleOpen:()=>{var _;(_=i.value)==null||_.handleOpen()},handleClose:()=>{var _;(_=i.value)==null||_.handleClose()}}),()=>{var _;const o=(_=e.format)!=null?_:B2;return Qe(KD,Yo(e,{ref:i,type:s,format:o,"onUpdate:modelValue":p}),{default:w=>Qe(d,w,null)})}}});const SQ=Ao(wQ),C1=Symbol(),TQ=vn({...jT,type:{type:ut(String),default:"date"}}),CQ=["date","dates","year","years","month","months","week","range"],HT=vn({disabledDate:{type:ut(Function)},date:{type:ut(Object),required:!0},minDate:{type:ut(Object)},maxDate:{type:ut(Object)},parsedValue:{type:ut([Object,Array])},rangeState:{type:ut(Object),default:()=>({endDate:null,selecting:!1})}}),QD=vn({type:{type:ut(String),required:!0,values:HZ},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),GT=vn({unlinkPanels:Boolean,parsedValue:{type:ut(Array)}}),WT=e=>({type:String,values:CQ,default:e}),EQ=vn({...QD,parsedValue:{type:ut([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),Lm=e=>{if(!fn(e))return!1;const[t,i]=e;return Mo.isDayjs(t)&&Mo.isDayjs(i)&&t.isSameOrBefore(i)},qT=(e,{lang:t,unit:i,unlinkPanels:s})=>{let d;if(fn(e)){let[p,_]=e.map(o=>Mo(o).locale(t));return s||(_=p.add(1,i)),[p,_]}else e?d=Mo(e):d=Mo();return d=d.locale(t),[d,d.add(1,i)]},MQ=(e,t,{columnIndexOffset:i,startDate:s,nextEndDate:d,now:p,unit:_,relativeDateGetter:o,setCellMetadata:w,setRowMetadata:C})=>{for(let M=0;M<e.row;M++){const I=t[M];for(let F=0;F<e.column;F++){let B=I[F+i];B||(B={row:M,column:F,type:"normal",inRange:!1,start:!1,end:!1});const N=M*e.column+F,D=o(N);B.dayjs=D,B.date=D.toDate(),B.timestamp=D.valueOf(),B.type="normal",B.inRange=!!(s&&D.isSameOrAfter(s,_)&&d&&D.isSameOrBefore(d,_))||!!(s&&D.isSameOrBefore(s,_)&&d&&D.isSameOrAfter(d,_)),s!=null&&s.isSameOrAfter(d)?(B.start=!!d&&D.isSame(d,_),B.end=s&&D.isSame(s,_)):(B.start=!!s&&D.isSame(s,_),B.end=!!d&&D.isSame(d,_)),D.isSame(p,_)&&(B.type="today"),w==null||w(B,{rowIndex:M,columnIndex:F}),I[F+i]=B}C==null||C(I)}},Rb=(e,t,i)=>{const s=Mo().locale(i).startOf("month").month(t).year(e),d=s.daysInMonth();return gh(d).map(p=>s.add(p,"day").toDate())},x_=(e,t,i,s)=>{const d=Mo().year(e).month(t).startOf("month"),p=Rb(e,t,i).find(_=>!(s!=null&&s(_)));return p?Mo(p).locale(i):d.locale(i)},$2=(e,t,i)=>{const s=e.year();if(!(i!=null&&i(e.toDate())))return e.locale(t);const d=e.month();if(!Rb(s,d,t).every(i))return x_(s,d,t,i);for(let p=0;p<12;p++)if(!Rb(s,p,t).every(i))return x_(s,p,t,i);return e},IQ=vn({...HT,cellClassName:{type:ut(Function)},showWeekNumber:Boolean,selectionMode:WT("date")}),AQ=["changerange","pick","select"],V2=(e="")=>["normal","today"].includes(e),kQ=(e,t)=>{const{lang:i}=vr(),s=we(),d=we(),p=we(),_=we(),o=we([[],[],[],[],[],[]]);let w=!1;const C=e.date.$locale().weekStart||7,M=e.date.locale("en").localeData().weekdaysShort().map(ve=>ve.toLowerCase()),I=te(()=>C>3?7-C:-C),F=te(()=>{const ve=e.date.startOf("month");return ve.subtract(ve.day()||7,"day")}),B=te(()=>M.concat(M).slice(C,C+7)),N=te(()=>kL(y(G)).some(ve=>ve.isCurrent)),D=te(()=>{const ve=e.date.startOf("month"),Ne=ve.day()||7,We=ve.daysInMonth(),ot=ve.subtract(1,"month").daysInMonth();return{startOfMonthDay:Ne,dateCountOfMonth:We,dateCountOfLastMonth:ot}}),j=te(()=>e.selectionMode==="dates"?Os(e.parsedValue):[]),U=(ve,{count:Ne,rowIndex:We,columnIndex:ot})=>{const{startOfMonthDay:Oe,dateCountOfMonth:Ct,dateCountOfLastMonth:Mt}=y(D),zt=y(I);if(We>=0&&We<=1){const bt=Oe+zt<0?7+Oe+zt:Oe+zt;if(ot+We*7>=bt)return ve.text=Ne,!0;ve.text=Mt-(bt-ot%7)+1+We*7,ve.type="prev-month"}else return Ne<=Ct?ve.text=Ne:(ve.text=Ne-Ct,ve.type="next-month"),!0;return!1},ne=(ve,{columnIndex:Ne,rowIndex:We},ot)=>{const{disabledDate:Oe,cellClassName:Ct}=e,Mt=y(j),zt=U(ve,{count:ot,rowIndex:We,columnIndex:Ne}),bt=ve.dayjs.toDate();return ve.selected=Mt.find(Kt=>Kt.isSame(ve.dayjs,"day")),ve.isSelected=!!ve.selected,ve.isCurrent=oe(ve),ve.disabled=Oe==null?void 0:Oe(bt),ve.customClass=Ct==null?void 0:Ct(bt),zt},K=ve=>{if(e.selectionMode==="week"){const[Ne,We]=e.showWeekNumber?[1,7]:[0,6],ot=Ce(ve[Ne+1]);ve[Ne].inRange=ot,ve[Ne].start=ot,ve[We].inRange=ot,ve[We].end=ot}},G=te(()=>{const{minDate:ve,maxDate:Ne,rangeState:We,showWeekNumber:ot}=e,Oe=y(I),Ct=y(o),Mt="day";let zt=1;if(ot)for(let bt=0;bt<6;bt++)Ct[bt][0]||(Ct[bt][0]={type:"week",text:y(F).add(bt*7+1,Mt).week()});return MQ({row:6,column:7},Ct,{startDate:ve,columnIndexOffset:ot?1:0,nextEndDate:We.endDate||Ne||We.selecting&&ve||null,now:Mo().locale(y(i)).startOf(Mt),unit:Mt,relativeDateGetter:bt=>y(F).add(bt-Oe,Mt),setCellMetadata:(...bt)=>{ne(...bt,zt)&&(zt+=1)},setRowMetadata:K}),Ct});tn(()=>e.date,async()=>{var ve;(ve=y(s))!=null&&ve.contains(document.activeElement)&&(await oo(),await J())});const J=async()=>{var ve;return(ve=y(d))==null?void 0:ve.focus()},oe=ve=>e.selectionMode==="date"&&V2(ve.type)&&se(ve,e.parsedValue),se=(ve,Ne)=>Ne?Mo(Ne).locale(y(i)).isSame(e.date.date(Number(ve.text)),"day"):!1,me=(ve,Ne)=>{const We=ve*7+(Ne-(e.showWeekNumber?1:0))-y(I);return y(F).add(We,"day")},de=ve=>{var Ne;if(!e.rangeState.selecting)return;let We=ve.target;if(We.tagName==="SPAN"&&(We=(Ne=We.parentNode)==null?void 0:Ne.parentNode),We.tagName==="DIV"&&(We=We.parentNode),We.tagName!=="TD")return;const ot=We.parentNode.rowIndex-1,Oe=We.cellIndex;y(G)[ot][Oe].disabled||(ot!==y(p)||Oe!==y(_))&&(p.value=ot,_.value=Oe,t("changerange",{selecting:!0,endDate:me(ot,Oe)}))},ce=ve=>!y(N)&&(ve==null?void 0:ve.text)===1&&ve.type==="normal"||ve.isCurrent,pe=ve=>{w||y(N)||e.selectionMode!=="date"||Ae(ve,!0)},ge=ve=>{ve.target.closest("td")&&(w=!0)},Re=ve=>{ve.target.closest("td")&&(w=!1)},Je=ve=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:ve,maxDate:null}),t("select",!0)):(ve>=e.minDate?t("pick",{minDate:e.minDate,maxDate:ve}):t("pick",{minDate:ve,maxDate:e.minDate}),t("select",!1))},Me=ve=>{const Ne=ve.week(),We=`${ve.year()}w${Ne}`;t("pick",{year:ve.year(),week:Ne,value:We,date:ve.startOf("week")})},xe=(ve,Ne)=>{const We=Ne?Os(e.parsedValue).filter(ot=>(ot==null?void 0:ot.valueOf())!==ve.valueOf()):Os(e.parsedValue).concat([ve]);t("pick",We)},Ae=(ve,Ne=!1)=>{const We=ve.target.closest("td");if(!We)return;const ot=We.parentNode.rowIndex-1,Oe=We.cellIndex,Ct=y(G)[ot][Oe];if(Ct.disabled||Ct.type==="week")return;const Mt=me(ot,Oe);switch(e.selectionMode){case"range":{Je(Mt);break}case"date":{t("pick",Mt,Ne);break}case"week":{Me(Mt);break}case"dates":{xe(Mt,!!Ct.selected);break}}},Ce=ve=>{if(e.selectionMode!=="week")return!1;let Ne=e.date.startOf("day");if(ve.type==="prev-month"&&(Ne=Ne.subtract(1,"month")),ve.type==="next-month"&&(Ne=Ne.add(1,"month")),Ne=Ne.date(Number.parseInt(ve.text,10)),e.parsedValue&&!fn(e.parsedValue)){const We=(e.parsedValue.day()-C+7)%7-1;return e.parsedValue.subtract(We,"day").isSame(Ne,"day")}return!1};return{WEEKS:B,rows:G,tbodyRef:s,currentCellRef:d,focus:J,isCurrent:oe,isWeekActive:Ce,isSelectedCell:ce,handlePickDate:Ae,handleMouseUp:Re,handleMouseDown:ge,handleMouseMove:de,handleFocus:pe}},PQ=(e,{isCurrent:t,isWeekActive:i})=>{const s=rn("date-table"),{t:d}=vr(),p=te(()=>[s.b(),{"is-week-mode":e.selectionMode==="week"}]),_=te(()=>d("el.datepicker.dateTablePrompt")),o=te(()=>d("el.datepicker.week"));return{tableKls:p,tableLabel:_,weekLabel:o,getCellClasses:M=>{const I=[];return V2(M.type)&&!M.disabled?(I.push("available"),M.type==="today"&&I.push("today")):I.push(M.type),t(M)&&I.push("current"),M.inRange&&(V2(M.type)||e.selectionMode==="week")&&(I.push("in-range"),M.start&&I.push("start-date"),M.end&&I.push("end-date")),M.disabled&&I.push("disabled"),M.selected&&I.push("selected"),M.customClass&&I.push(M.customClass),I.join(" ")},getRowKls:M=>[s.e("row"),{current:i(M)}],t:d}},RQ=vn({cell:{type:ut(Object)}});var KT=Ze({name:"ElDatePickerCell",props:RQ,setup(e){const t=rn("date-table-cell"),{slots:i}=Un(C1);return()=>{const{cell:s}=e;return _t(i,"default",{...s},()=>{var d;return[Qe("div",{class:t.b()},[Qe("span",{class:t.e("text")},[(d=s==null?void 0:s.renderText)!=null?d:s==null?void 0:s.text])])]})}}});const LQ=Ze({__name:"basic-date-table",props:IQ,emits:AQ,setup(e,{expose:t,emit:i}){const s=e,{WEEKS:d,rows:p,tbodyRef:_,currentCellRef:o,focus:w,isCurrent:C,isWeekActive:M,isSelectedCell:I,handlePickDate:F,handleMouseUp:B,handleMouseDown:N,handleMouseMove:D,handleFocus:j}=kQ(s,i),{tableLabel:U,tableKls:ne,weekLabel:K,getCellClasses:G,getRowKls:J,t:oe}=PQ(s,{isCurrent:C,isWeekActive:M});return t({focus:w}),(se,me)=>(le(),Pe("table",{"aria-label":y(U),class:he(y(ne)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:y(F),onMousemove:y(D),onMousedown:po(y(N),["prevent"]),onMouseup:y(B)},[Ve("tbody",{ref_key:"tbodyRef",ref:_},[Ve("tr",null,[se.showWeekNumber?(le(),Pe("th",{key:0,scope:"col"},yn(y(K)),1)):St("v-if",!0),(le(!0),Pe(eo,null,nr(y(d),(de,ce)=>(le(),Pe("th",{key:ce,"aria-label":y(oe)("el.datepicker.weeksFull."+de),scope:"col"},yn(y(oe)("el.datepicker.weeks."+de)),9,["aria-label"]))),128))]),(le(!0),Pe(eo,null,nr(y(p),(de,ce)=>(le(),Pe("tr",{key:ce,class:he(y(J)(de[1]))},[(le(!0),Pe(eo,null,nr(de,(pe,ge)=>(le(),Pe("td",{key:`${ce}.${ge}`,ref_for:!0,ref:Re=>y(I)(pe)&&(o.value=Re),class:he(y(G)(pe)),"aria-current":pe.isCurrent?"date":void 0,"aria-selected":pe.isCurrent,tabindex:y(I)(pe)?0:-1,onFocus:y(j)},[Qe(y(KT),{cell:pe},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var U2=xn(LQ,[["__file","basic-date-table.vue"]]);const OQ=vn({...HT,selectionMode:WT("month")}),DQ=Ze({__name:"basic-month-table",props:OQ,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const s=e,d=rn("month-table"),{t:p,lang:_}=vr(),o=we(),w=we(),C=we(s.date.locale("en").localeData().monthsShort().map(K=>K.toLowerCase())),M=we([[],[],[]]),I=we(),F=we(),B=te(()=>{var K,G;const J=M.value,oe=Mo().locale(_.value).startOf("month");for(let se=0;se<3;se++){const me=J[se];for(let de=0;de<4;de++){const ce=me[de]||(me[de]={row:se,column:de,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});ce.type="normal";const pe=se*4+de,ge=s.date.startOf("year").month(pe),Re=s.rangeState.endDate||s.maxDate||s.rangeState.selecting&&s.minDate||null;ce.inRange=!!(s.minDate&&ge.isSameOrAfter(s.minDate,"month")&&Re&&ge.isSameOrBefore(Re,"month"))||!!(s.minDate&&ge.isSameOrBefore(s.minDate,"month")&&Re&&ge.isSameOrAfter(Re,"month")),(K=s.minDate)!=null&&K.isSameOrAfter(Re)?(ce.start=!!(Re&&ge.isSame(Re,"month")),ce.end=s.minDate&&ge.isSame(s.minDate,"month")):(ce.start=!!(s.minDate&&ge.isSame(s.minDate,"month")),ce.end=!!(Re&&ge.isSame(Re,"month"))),oe.isSame(ge)&&(ce.type="today"),ce.text=pe,ce.disabled=((G=s.disabledDate)==null?void 0:G.call(s,ge.toDate()))||!1}}return J}),N=()=>{var K;(K=w.value)==null||K.focus()},D=K=>{const G={},J=s.date.year(),oe=new Date,se=K.text;return G.disabled=s.disabledDate?Rb(J,se,_.value).every(s.disabledDate):!1,G.current=Os(s.parsedValue).findIndex(me=>Mo.isDayjs(me)&&me.year()===J&&me.month()===se)>=0,G.today=oe.getFullYear()===J&&oe.getMonth()===se,K.inRange&&(G["in-range"]=!0,K.start&&(G["start-date"]=!0),K.end&&(G["end-date"]=!0)),G},j=K=>{const G=s.date.year(),J=K.text;return Os(s.date).findIndex(oe=>oe.year()===G&&oe.month()===J)>=0},U=K=>{var G;if(!s.rangeState.selecting)return;let J=K.target;if(J.tagName==="SPAN"&&(J=(G=J.parentNode)==null?void 0:G.parentNode),J.tagName==="DIV"&&(J=J.parentNode),J.tagName!=="TD")return;const oe=J.parentNode.rowIndex,se=J.cellIndex;B.value[oe][se].disabled||(oe!==I.value||se!==F.value)&&(I.value=oe,F.value=se,i("changerange",{selecting:!0,endDate:s.date.startOf("year").month(oe*4+se)}))},ne=K=>{var G;const J=(G=K.target)==null?void 0:G.closest("td");if((J==null?void 0:J.tagName)!=="TD"||nl(J,"disabled"))return;const oe=J.cellIndex,me=J.parentNode.rowIndex*4+oe,de=s.date.startOf("year").month(me);if(s.selectionMode==="months"){if(K.type==="keydown"){i("pick",Os(s.parsedValue),!1);return}const ce=x_(s.date.year(),me,_.value,s.disabledDate),pe=nl(J,"current")?Os(s.parsedValue).filter(ge=>(ge==null?void 0:ge.month())!==ce.month()):Os(s.parsedValue).concat([Mo(ce)]);i("pick",pe)}else s.selectionMode==="range"?s.rangeState.selecting?(s.minDate&&de>=s.minDate?i("pick",{minDate:s.minDate,maxDate:de}):i("pick",{minDate:de,maxDate:s.minDate}),i("select",!1)):(i("pick",{minDate:de,maxDate:null}),i("select",!0)):i("pick",me)};return tn(()=>s.date,async()=>{var K,G;(K=o.value)!=null&&K.contains(document.activeElement)&&(await oo(),(G=w.value)==null||G.focus())}),t({focus:N}),(K,G)=>(le(),Pe("table",{role:"grid","aria-label":y(p)("el.datepicker.monthTablePrompt"),class:he(y(d).b()),onClick:ne,onMousemove:U},[Ve("tbody",{ref_key:"tbodyRef",ref:o},[(le(!0),Pe(eo,null,nr(y(B),(J,oe)=>(le(),Pe("tr",{key:oe},[(le(!0),Pe(eo,null,nr(J,(se,me)=>(le(),Pe("td",{key:me,ref_for:!0,ref:de=>j(se)&&(w.value=de),class:he(D(se)),"aria-selected":`${j(se)}`,"aria-label":y(p)(`el.datepicker.month${+se.text+1}`),tabindex:j(se)?0:-1,onKeydown:[ti(po(ne,["prevent","stop"]),["space"]),ti(po(ne,["prevent","stop"]),["enter"])]},[Qe(y(KT),{cell:{...se,renderText:y(p)("el.datepicker.months."+C.value[se.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var j2=xn(DQ,[["__file","basic-month-table.vue"]]);const zQ=vn({...HT,selectionMode:WT("year")}),FQ=Ze({__name:"basic-year-table",props:zQ,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const s=e,d=(G,J)=>{const oe=Mo(String(G)).locale(J).startOf("year"),me=oe.endOf("year").dayOfYear();return gh(me).map(de=>oe.add(de,"day").toDate())},p=rn("year-table"),{t:_,lang:o}=vr(),w=we(),C=we(),M=te(()=>Math.floor(s.date.year()/10)*10),I=we([[],[],[]]),F=we(),B=we(),N=te(()=>{var G;const J=I.value,oe=Mo().locale(o.value).startOf("year");for(let se=0;se<3;se++){const me=J[se];for(let de=0;de<4&&!(se*4+de>=10);de++){let ce=me[de];ce||(ce={row:se,column:de,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),ce.type="normal";const pe=se*4+de+M.value,ge=Mo().year(pe),Re=s.rangeState.endDate||s.maxDate||s.rangeState.selecting&&s.minDate||null;ce.inRange=!!(s.minDate&&ge.isSameOrAfter(s.minDate,"year")&&Re&&ge.isSameOrBefore(Re,"year"))||!!(s.minDate&&ge.isSameOrBefore(s.minDate,"year")&&Re&&ge.isSameOrAfter(Re,"year")),(G=s.minDate)!=null&&G.isSameOrAfter(Re)?(ce.start=!!(Re&&ge.isSame(Re,"year")),ce.end=!!(s.minDate&&ge.isSame(s.minDate,"year"))):(ce.start=!!(s.minDate&&ge.isSame(s.minDate,"year")),ce.end=!!(Re&&ge.isSame(Re,"year"))),oe.isSame(ge)&&(ce.type="today"),ce.text=pe;const Me=ge.toDate();ce.disabled=s.disabledDate&&s.disabledDate(Me)||!1,me[de]=ce}}return J}),D=()=>{var G;(G=C.value)==null||G.focus()},j=G=>{const J={},oe=Mo().locale(o.value),se=G.text;return J.disabled=s.disabledDate?d(se,o.value).every(s.disabledDate):!1,J.today=oe.year()===se,J.current=Os(s.parsedValue).findIndex(me=>me.year()===se)>=0,G.inRange&&(J["in-range"]=!0,G.start&&(J["start-date"]=!0),G.end&&(J["end-date"]=!0)),J},U=G=>{const J=G.text;return Os(s.date).findIndex(oe=>oe.year()===J)>=0},ne=G=>{var J;const oe=(J=G.target)==null?void 0:J.closest("td");if(!oe||!oe.textContent||nl(oe,"disabled"))return;const se=oe.cellIndex,de=oe.parentNode.rowIndex*4+se+M.value,ce=Mo().year(de);if(s.selectionMode==="range")s.rangeState.selecting?(s.minDate&&ce>=s.minDate?i("pick",{minDate:s.minDate,maxDate:ce}):i("pick",{minDate:ce,maxDate:s.minDate}),i("select",!1)):(i("pick",{minDate:ce,maxDate:null}),i("select",!0));else if(s.selectionMode==="years"){if(G.type==="keydown"){i("pick",Os(s.parsedValue),!1);return}const pe=$2(ce.startOf("year"),o.value,s.disabledDate),ge=nl(oe,"current")?Os(s.parsedValue).filter(Re=>(Re==null?void 0:Re.year())!==de):Os(s.parsedValue).concat([pe]);i("pick",ge)}else i("pick",de)},K=G=>{var J;if(!s.rangeState.selecting)return;const oe=(J=G.target)==null?void 0:J.closest("td");if(!oe)return;const se=oe.parentNode.rowIndex,me=oe.cellIndex;N.value[se][me].disabled||(se!==F.value||me!==B.value)&&(F.value=se,B.value=me,i("changerange",{selecting:!0,endDate:Mo().year(M.value).add(se*4+me,"year")}))};return tn(()=>s.date,async()=>{var G,J;(G=w.value)!=null&&G.contains(document.activeElement)&&(await oo(),(J=C.value)==null||J.focus())}),t({focus:D}),(G,J)=>(le(),Pe("table",{role:"grid","aria-label":y(_)("el.datepicker.yearTablePrompt"),class:he(y(p).b()),onClick:ne,onMousemove:K},[Ve("tbody",{ref_key:"tbodyRef",ref:w},[(le(!0),Pe(eo,null,nr(y(N),(oe,se)=>(le(),Pe("tr",{key:se},[(le(!0),Pe(eo,null,nr(oe,(me,de)=>(le(),Pe("td",{key:`${se}_${de}`,ref_for:!0,ref:ce=>U(me)&&(C.value=ce),class:he(["available",j(me)]),"aria-selected":U(me),"aria-label":String(me.text),tabindex:U(me)?0:-1,onKeydown:[ti(po(ne,["prevent","stop"]),["space"]),ti(po(ne,["prevent","stop"]),["enter"])]},[Qe(y(KT),{cell:me},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var H2=xn(FQ,[["__file","basic-year-table.vue"]]);const BQ=Ze({__name:"panel-date-pick",props:EQ,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const i=e,s=(Dt,En,ft)=>!0,d=rn("picker-panel"),p=rn("date-picker"),_=Ph(),o=aa(),{t:w,lang:C}=vr(),M=Un("EP_PICKER_BASE"),I=Un(S1),{shortcuts:F,disabledDate:B,cellClassName:N,defaultTime:D}=M.props,j=Vr(M.props,"defaultValue"),U=we(),ne=we(Mo().locale(C.value)),K=we(!1);let G=!1;const J=te(()=>Mo(D).locale(C.value)),oe=te(()=>ne.value.month()),se=te(()=>ne.value.year()),me=we([]),de=we(null),ce=we(null),pe=Dt=>me.value.length>0?s(Dt,me.value,i.format||"HH:mm:ss"):!0,ge=Dt=>D&&!Ht.value&&!K.value&&!G?J.value.year(Dt.year()).month(Dt.month()).date(Dt.date()):bt.value?Dt.millisecond(0):Dt.startOf("day"),Re=(Dt,...En)=>{if(!Dt)t("pick",Dt,...En);else if(fn(Dt)){const ft=Dt.map(ge);t("pick",ft,...En)}else t("pick",ge(Dt),...En);de.value=null,ce.value=null,K.value=!1,G=!1},Je=async(Dt,En)=>{if(Ne.value==="date"){Dt=Dt;let ft=i.parsedValue?i.parsedValue.year(Dt.year()).month(Dt.month()).date(Dt.date()):Dt;pe(ft)||(ft=me.value[0][0].year(Dt.year()).month(Dt.month()).date(Dt.date())),ne.value=ft,Re(ft,bt.value||En),i.type==="datetime"&&(await oo(),mo())}else Ne.value==="week"?Re(Dt.date):Ne.value==="dates"&&Re(Dt,!0)},Me=Dt=>{const En=Dt?"add":"subtract";ne.value=ne.value[En](1,"month"),ur("month")},xe=Dt=>{const En=ne.value,ft=Dt?"add":"subtract";ne.value=Ae.value==="year"?En[ft](10,"year"):En[ft](1,"year"),ur("year")},Ae=we("date"),Ce=te(()=>{const Dt=w("el.datepicker.year");if(Ae.value==="year"){const En=Math.floor(se.value/10)*10;return Dt?`${En} ${Dt} - ${En+9} ${Dt}`:`${En} - ${En+9}`}return`${se.value} ${Dt}`}),ve=Dt=>{const En=Qn(Dt.value)?Dt.value():Dt.value;if(En){G=!0,Re(Mo(En).locale(C.value));return}Dt.onClick&&Dt.onClick({attrs:_,slots:o,emit:t})},Ne=te(()=>{const{type:Dt}=i;return["week","month","months","year","years","dates"].includes(Dt)?Dt:"date"}),We=te(()=>Ne.value==="dates"||Ne.value==="months"||Ne.value==="years"),ot=te(()=>Ne.value==="date"?Ae.value:Ne.value),Oe=te(()=>!!F.length),Ct=async(Dt,En)=>{Ne.value==="month"?(ne.value=x_(ne.value.year(),Dt,C.value,B),Re(ne.value,!1)):Ne.value==="months"?Re(Dt,En??!0):(ne.value=x_(ne.value.year(),Dt,C.value,B),Ae.value="date",["month","year","date","week"].includes(Ne.value)&&(Re(ne.value,!0),await oo(),mo())),ur("month")},Mt=async(Dt,En)=>{if(Ne.value==="year"){const ft=ne.value.startOf("year").year(Dt);ne.value=$2(ft,C.value,B),Re(ne.value,!1)}else if(Ne.value==="years")Re(Dt,En??!0);else{const ft=ne.value.year(Dt);ne.value=$2(ft,C.value,B),Ae.value="month",["month","year","date","week"].includes(Ne.value)&&(Re(ne.value,!0),await oo(),mo())}ur("year")},zt=async Dt=>{Ae.value=Dt,await oo(),mo()},bt=te(()=>i.type==="datetime"||i.type==="datetimerange"),Kt=te(()=>{const Dt=bt.value||Ne.value==="dates",En=Ne.value==="years",ft=Ne.value==="months",un=Ae.value==="date",et=Ae.value==="year",Mn=Ae.value==="month";return Dt&&un||En&&et||ft&&Mn}),$t=te(()=>B?i.parsedValue?fn(i.parsedValue)?B(i.parsedValue[0].toDate()):B(i.parsedValue.toDate()):!0:!1),Le=()=>{if(We.value)Re(i.parsedValue);else{let Dt=i.parsedValue;if(!Dt){const En=Mo(D).locale(C.value),ft=Co();Dt=En.year(ft.year()).month(ft.month()).date(ft.date())}ne.value=Dt,Re(Dt)}},dn=te(()=>B?B(Mo().locale(C.value).toDate()):!1),At=()=>{const En=Mo().locale(C.value).toDate();K.value=!0,(!B||!B(En))&&pe(En)&&(ne.value=Mo().locale(C.value),Re(ne.value))},Ke=te(()=>i.timeFormat||dD(i.format)),Be=te(()=>i.dateFormat||uD(i.format)),Ht=te(()=>{if(ce.value)return ce.value;if(!(!i.parsedValue&&!j.value))return(i.parsedValue||ne.value).format(Ke.value)}),Ut=te(()=>{if(de.value)return de.value;if(!(!i.parsedValue&&!j.value))return(i.parsedValue||ne.value).format(Be.value)}),Nt=we(!1),Et=()=>{Nt.value=!0},Gt=()=>{Nt.value=!1},ln=Dt=>({hour:Dt.hour(),minute:Dt.minute(),second:Dt.second(),year:Dt.year(),month:Dt.month(),date:Dt.date()}),bn=(Dt,En,ft)=>{const{hour:un,minute:et,second:Mn}=ln(Dt),Bn=i.parsedValue?i.parsedValue.hour(un).minute(et).second(Mn):Dt;ne.value=Bn,Re(ne.value,!0),ft||(Nt.value=En)},_n=Dt=>{const En=Mo(Dt,Ke.value).locale(C.value);if(En.isValid()&&pe(En)){const{year:ft,month:un,date:et}=ln(ne.value);ne.value=En.year(ft).month(un).date(et),ce.value=null,Nt.value=!1,Re(ne.value,!0)}},jn=Dt=>{const En=Mo(Dt,Be.value).locale(C.value);if(En.isValid()){if(B&&B(En.toDate()))return;const{hour:ft,minute:un,second:et}=ln(ne.value);ne.value=En.hour(ft).minute(un).second(et),de.value=null,Re(ne.value,!0)}},yt=Dt=>Mo.isDayjs(Dt)&&Dt.isValid()&&(B?!B(Dt.toDate()):!0),kn=Dt=>fn(Dt)?Dt.map(En=>En.format(i.format)):Dt.format(i.format),qn=Dt=>Mo(Dt,i.format).locale(C.value),Co=()=>{const Dt=Mo(j.value).locale(C.value);if(!j.value){const En=J.value;return Mo().hour(En.hour()).minute(En.minute()).second(En.second()).locale(C.value)}return Dt},mo=async()=>{var Dt;["week","month","year","date"].includes(Ne.value)&&((Dt=U.value)==null||Dt.focus(),Ne.value==="week"&&Ho(Ln.down))},Io=Dt=>{const{code:En}=Dt;[Ln.up,Ln.down,Ln.left,Ln.right,Ln.home,Ln.end,Ln.pageUp,Ln.pageDown].includes(En)&&(Ho(En),Dt.stopPropagation(),Dt.preventDefault()),[Ln.enter,Ln.space,Ln.numpadEnter].includes(En)&&de.value===null&&ce.value===null&&(Dt.preventDefault(),Re(ne.value,!1))},Ho=Dt=>{var En;const{up:ft,down:un,left:et,right:Mn,home:Bn,end:Lo,pageUp:Rr,pageDown:hi}=Ln,Er={year:{[ft]:-4,[un]:4,[et]:-1,[Mn]:1,offset:(Xo,Bi)=>Xo.setFullYear(Xo.getFullYear()+Bi)},month:{[ft]:-4,[un]:4,[et]:-1,[Mn]:1,offset:(Xo,Bi)=>Xo.setMonth(Xo.getMonth()+Bi)},week:{[ft]:-1,[un]:1,[et]:-1,[Mn]:1,offset:(Xo,Bi)=>Xo.setDate(Xo.getDate()+Bi*7)},date:{[ft]:-7,[un]:7,[et]:-1,[Mn]:1,[Bn]:Xo=>-Xo.getDay(),[Lo]:Xo=>-Xo.getDay()+6,[Rr]:Xo=>-new Date(Xo.getFullYear(),Xo.getMonth(),0).getDate(),[hi]:Xo=>new Date(Xo.getFullYear(),Xo.getMonth()+1,0).getDate(),offset:(Xo,Bi)=>Xo.setDate(Xo.getDate()+Bi)}},Nr=ne.value.toDate();for(;Math.abs(ne.value.diff(Nr,"year",!0))<1;){const Xo=Er[ot.value];if(!Xo)return;if(Xo.offset(Nr,Qn(Xo[Dt])?Xo[Dt](Nr):(En=Xo[Dt])!=null?En:0),B&&B(Nr))break;const Bi=Mo(Nr).locale(C.value);ne.value=Bi,t("pick",Bi,!0);break}},ur=Dt=>{t("panel-change",ne.value.toDate(),Dt,Ae.value)};return tn(()=>Ne.value,Dt=>{if(["month","year"].includes(Dt)){Ae.value=Dt;return}else if(Dt==="years"){Ae.value="year";return}else if(Dt==="months"){Ae.value="month";return}Ae.value="date"},{immediate:!0}),tn(()=>Ae.value,()=>{I==null||I.updatePopper()}),tn(()=>j.value,Dt=>{Dt&&(ne.value=Co())},{immediate:!0}),tn(()=>i.parsedValue,Dt=>{if(Dt){if(We.value||fn(Dt))return;ne.value=Dt}else ne.value=Co()},{immediate:!0}),t("set-picker-option",["isValidValue",yt]),t("set-picker-option",["formatToString",kn]),t("set-picker-option",["parseUserInput",qn]),t("set-picker-option",["handleFocusPicker",mo]),(Dt,En)=>(le(),Pe("div",{class:he([y(d).b(),y(p).b(),{"has-sidebar":Dt.$slots.sidebar||y(Oe),"has-time":y(bt)}])},[Ve("div",{class:he(y(d).e("body-wrapper"))},[_t(Dt.$slots,"sidebar",{class:he(y(d).e("sidebar"))}),y(Oe)?(le(),Pe("div",{key:0,class:he(y(d).e("sidebar"))},[(le(!0),Pe(eo,null,nr(y(F),(ft,un)=>(le(),Pe("button",{key:un,type:"button",class:he(y(d).e("shortcut")),onClick:et=>ve(ft)},yn(ft.text),11,["onClick"]))),128))],2)):St("v-if",!0),Ve("div",{class:he(y(d).e("body"))},[y(bt)?(le(),Pe("div",{key:0,class:he(y(p).e("time-header"))},[Ve("span",{class:he(y(p).e("editor-wrap"))},[Qe(y(fs),{placeholder:y(w)("el.datepicker.selectDate"),"model-value":y(Ut),size:"small","validate-event":!1,onInput:ft=>de.value=ft,onChange:jn},null,8,["placeholder","model-value","onInput"])],2),zo((le(),Pe("span",{class:he(y(p).e("editor-wrap"))},[Qe(y(fs),{placeholder:y(w)("el.datepicker.selectTime"),"model-value":y(Ht),size:"small","validate-event":!1,onFocus:Et,onInput:ft=>ce.value=ft,onChange:_n},null,8,["placeholder","model-value","onInput"]),Qe(y(Pb),{visible:Nt.value,format:y(Ke),"parsed-value":ne.value,onPick:bn},null,8,["visible","format","parsed-value"])],2)),[[y(ld),Gt]])],2)):St("v-if",!0),zo(Ve("div",{class:he([y(p).e("header"),(Ae.value==="year"||Ae.value==="month")&&y(p).e("header--bordered")])},[Ve("span",{class:he(y(p).e("prev-btn"))},[Ve("button",{type:"button","aria-label":y(w)("el.datepicker.prevYear"),class:he(["d-arrow-left",y(d).e("icon-btn")]),onClick:ft=>xe(!1)},[_t(Dt.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Th))]),_:1})])],10,["aria-label","onClick"]),zo(Ve("button",{type:"button","aria-label":y(w)("el.datepicker.prevMonth"),class:he([y(d).e("icon-btn"),"arrow-left"]),onClick:ft=>Me(!1)},[_t(Dt.$slots,"prev-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Sh))]),_:1})])],10,["aria-label","onClick"]),[[Cr,Ae.value==="date"]])],2),Ve("span",{role:"button",class:he(y(p).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:ti(ft=>zt("year"),["enter"]),onClick:ft=>zt("year")},yn(y(Ce)),43,["onKeydown","onClick"]),zo(Ve("span",{role:"button","aria-live":"polite",tabindex:"0",class:he([y(p).e("header-label"),{active:Ae.value==="month"}]),onKeydown:ti(ft=>zt("month"),["enter"]),onClick:ft=>zt("month")},yn(y(w)(`el.datepicker.month${y(oe)+1}`)),43,["onKeydown","onClick"]),[[Cr,Ae.value==="date"]]),Ve("span",{class:he(y(p).e("next-btn"))},[zo(Ve("button",{type:"button","aria-label":y(w)("el.datepicker.nextMonth"),class:he([y(d).e("icon-btn"),"arrow-right"]),onClick:ft=>Me(!0)},[_t(Dt.$slots,"next-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(zs))]),_:1})])],10,["aria-label","onClick"]),[[Cr,Ae.value==="date"]]),Ve("button",{type:"button","aria-label":y(w)("el.datepicker.nextYear"),class:he([y(d).e("icon-btn"),"d-arrow-right"]),onClick:ft=>xe(!0)},[_t(Dt.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ch))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[Cr,Ae.value!=="time"]]),Ve("div",{class:he(y(d).e("content")),onKeydown:Io},[Ae.value==="date"?(le(),Rt(U2,{key:0,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ne),date:ne.value,"parsed-value":Dt.parsedValue,"disabled-date":y(B),"cell-class-name":y(N),onPick:Je},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):St("v-if",!0),Ae.value==="year"?(le(),Rt(H2,{key:1,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ne),date:ne.value,"disabled-date":y(B),"parsed-value":Dt.parsedValue,onPick:Mt},null,8,["selection-mode","date","disabled-date","parsed-value"])):St("v-if",!0),Ae.value==="month"?(le(),Rt(j2,{key:2,ref_key:"currentViewRef",ref:U,"selection-mode":y(Ne),date:ne.value,"parsed-value":Dt.parsedValue,"disabled-date":y(B),onPick:Ct},null,8,["selection-mode","date","parsed-value","disabled-date"])):St("v-if",!0)],34)],2)],2),zo(Ve("div",{class:he(y(d).e("footer"))},[zo(Qe(y(Ta),{text:"",size:"small",class:he(y(d).e("link-btn")),disabled:y(dn),onClick:At},{default:at(()=>[Qo(yn(y(w)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[Cr,!y(We)&&Dt.showNow]]),Qe(y(Ta),{plain:"",size:"small",class:he(y(d).e("link-btn")),disabled:y($t),onClick:Le},{default:at(()=>[Qo(yn(y(w)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[Cr,y(Kt)]])],2))}});var NQ=xn(BQ,[["__file","panel-date-pick.vue"]]);const $Q=vn({...QD,...GT,visible:Boolean}),ez=e=>{const{emit:t}=jo(),i=Ph(),s=aa();return p=>{const _=Qn(p.value)?p.value():p.value;if(_){t("pick",[Mo(_[0]).locale(e.value),Mo(_[1]).locale(e.value)]);return}p.onClick&&p.onClick({attrs:i,slots:s,emit:t})}},tz=(e,{defaultValue:t,leftDate:i,rightDate:s,unit:d,onParsedValueChanged:p})=>{const{emit:_}=jo(),{pickerNs:o}=Un(C1),w=rn("date-range-picker"),{t:C,lang:M}=vr(),I=ez(M),F=we(),B=we(),N=we({endDate:null,selecting:!1}),D=G=>{N.value=G},j=(G=!1)=>{const J=y(F),oe=y(B);Lm([J,oe])&&_("pick",[J,oe],G)},U=G=>{N.value.selecting=G,G||(N.value.endDate=null)},ne=G=>{if(fn(G)&&G.length===2){const[J,oe]=G;F.value=J,i.value=J,B.value=oe,p(y(F),y(B))}else K()},K=()=>{const[G,J]=qT(y(t),{lang:y(M),unit:d,unlinkPanels:e.unlinkPanels});F.value=void 0,B.value=void 0,i.value=G,s.value=J};return tn(t,G=>{G&&K()},{immediate:!0}),tn(()=>e.parsedValue,ne,{immediate:!0}),{minDate:F,maxDate:B,rangeState:N,lang:M,ppNs:o,drpNs:w,handleChangeRange:D,handleRangeConfirm:j,handleShortcutClick:I,onSelect:U,onReset:ne,t:C}},B0="month",VQ=Ze({__name:"panel-date-range",props:$Q,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const i=e,s=Un("EP_PICKER_BASE"),{disabledDate:d,cellClassName:p,defaultTime:_,clearable:o}=s.props,w=Vr(s.props,"format"),C=Vr(s.props,"shortcuts"),M=Vr(s.props,"defaultValue"),{lang:I}=vr(),F=we(Mo().locale(I.value)),B=we(Mo().locale(I.value).add(1,B0)),{minDate:N,maxDate:D,rangeState:j,ppNs:U,drpNs:ne,handleChangeRange:K,handleRangeConfirm:G,handleShortcutClick:J,onSelect:oe,onReset:se,t:me}=tz(i,{defaultValue:M,leftDate:F,rightDate:B,unit:B0,onParsedValueChanged:En});tn(()=>i.visible,ft=>{!ft&&j.value.selecting&&(se(i.parsedValue),oe(!1))});const de=we({min:null,max:null}),ce=we({min:null,max:null}),pe=te(()=>`${F.value.year()} ${me("el.datepicker.year")} ${me(`el.datepicker.month${F.value.month()+1}`)}`),ge=te(()=>`${B.value.year()} ${me("el.datepicker.year")} ${me(`el.datepicker.month${B.value.month()+1}`)}`),Re=te(()=>F.value.year()),Je=te(()=>F.value.month()),Me=te(()=>B.value.year()),xe=te(()=>B.value.month()),Ae=te(()=>!!C.value.length),Ce=te(()=>de.value.min!==null?de.value.min:N.value?N.value.format(Oe.value):""),ve=te(()=>de.value.max!==null?de.value.max:D.value||N.value?(D.value||N.value).format(Oe.value):""),Ne=te(()=>ce.value.min!==null?ce.value.min:N.value?N.value.format(ot.value):""),We=te(()=>ce.value.max!==null?ce.value.max:D.value||N.value?(D.value||N.value).format(ot.value):""),ot=te(()=>i.timeFormat||dD(w.value)),Oe=te(()=>i.dateFormat||uD(w.value)),Ct=ft=>Lm(ft)&&(d?!d(ft[0].toDate())&&!d(ft[1].toDate()):!0),Mt=()=>{F.value=F.value.subtract(1,"year"),i.unlinkPanels||(B.value=F.value.add(1,"month")),Ke("year")},zt=()=>{F.value=F.value.subtract(1,"month"),i.unlinkPanels||(B.value=F.value.add(1,"month")),Ke("month")},bt=()=>{i.unlinkPanels?B.value=B.value.add(1,"year"):(F.value=F.value.add(1,"year"),B.value=F.value.add(1,"month")),Ke("year")},Kt=()=>{i.unlinkPanels?B.value=B.value.add(1,"month"):(F.value=F.value.add(1,"month"),B.value=F.value.add(1,"month")),Ke("month")},$t=()=>{F.value=F.value.add(1,"year"),Ke("year")},Le=()=>{F.value=F.value.add(1,"month"),Ke("month")},dn=()=>{B.value=B.value.subtract(1,"year"),Ke("year")},At=()=>{B.value=B.value.subtract(1,"month"),Ke("month")},Ke=ft=>{t("panel-change",[F.value.toDate(),B.value.toDate()],ft)},Be=te(()=>{const ft=(Je.value+1)%12,un=Je.value+1>=12?1:0;return i.unlinkPanels&&new Date(Re.value+un,ft)<new Date(Me.value,xe.value)}),Ht=te(()=>i.unlinkPanels&&Me.value*12+xe.value-(Re.value*12+Je.value+1)>=12),Ut=te(()=>!(N.value&&D.value&&!j.value.selecting&&Lm([N.value,D.value]))),Nt=te(()=>i.type==="datetime"||i.type==="datetimerange"),Et=(ft,un)=>{if(ft)return _?Mo(_[un]||_).locale(I.value).year(ft.year()).month(ft.month()).date(ft.date()):ft},Gt=(ft,un=!0)=>{const et=ft.minDate,Mn=ft.maxDate,Bn=Et(et,0),Lo=Et(Mn,1);D.value===Lo&&N.value===Bn||(t("calendar-change",[et.toDate(),Mn&&Mn.toDate()]),D.value=Lo,N.value=Bn,!(!un||Nt.value)&&G())},ln=we(!1),bn=we(!1),_n=()=>{ln.value=!1},jn=()=>{bn.value=!1},yt=(ft,un)=>{de.value[un]=ft;const et=Mo(ft,Oe.value).locale(I.value);if(et.isValid()){if(d&&d(et.toDate()))return;un==="min"?(F.value=et,N.value=(N.value||F.value).year(et.year()).month(et.month()).date(et.date()),!i.unlinkPanels&&(!D.value||D.value.isBefore(N.value))&&(B.value=et.add(1,"month"),D.value=N.value.add(1,"month"))):(B.value=et,D.value=(D.value||B.value).year(et.year()).month(et.month()).date(et.date()),!i.unlinkPanels&&(!N.value||N.value.isAfter(D.value))&&(F.value=et.subtract(1,"month"),N.value=D.value.subtract(1,"month")))}},kn=(ft,un)=>{de.value[un]=null},qn=(ft,un)=>{ce.value[un]=ft;const et=Mo(ft,ot.value).locale(I.value);et.isValid()&&(un==="min"?(ln.value=!0,N.value=(N.value||F.value).hour(et.hour()).minute(et.minute()).second(et.second())):(bn.value=!0,D.value=(D.value||B.value).hour(et.hour()).minute(et.minute()).second(et.second()),B.value=D.value))},Co=(ft,un)=>{ce.value[un]=null,un==="min"?(F.value=N.value,ln.value=!1,(!D.value||D.value.isBefore(N.value))&&(D.value=N.value)):(B.value=D.value,bn.value=!1,D.value&&D.value.isBefore(N.value)&&(N.value=D.value))},mo=(ft,un,et)=>{ce.value.min||(ft&&(F.value=ft,N.value=(N.value||F.value).hour(ft.hour()).minute(ft.minute()).second(ft.second())),et||(ln.value=un),(!D.value||D.value.isBefore(N.value))&&(D.value=N.value,B.value=ft))},Io=(ft,un,et)=>{ce.value.max||(ft&&(B.value=ft,D.value=(D.value||B.value).hour(ft.hour()).minute(ft.minute()).second(ft.second())),et||(bn.value=un),D.value&&D.value.isBefore(N.value)&&(N.value=D.value))},Ho=()=>{F.value=qT(y(M),{lang:y(I),unit:"month",unlinkPanels:i.unlinkPanels})[0],B.value=F.value.add(1,"month"),D.value=void 0,N.value=void 0,t("pick",null)},ur=ft=>fn(ft)?ft.map(un=>un.format(w.value)):ft.format(w.value),Dt=ft=>fn(ft)?ft.map(un=>Mo(un,w.value).locale(I.value)):Mo(ft,w.value).locale(I.value);function En(ft,un){if(i.unlinkPanels&&un){const et=(ft==null?void 0:ft.year())||0,Mn=(ft==null?void 0:ft.month())||0,Bn=un.year(),Lo=un.month();B.value=et===Bn&&Mn===Lo?un.add(1,B0):un}else B.value=F.value.add(1,B0),un&&(B.value=B.value.hour(un.hour()).minute(un.minute()).second(un.second()))}return t("set-picker-option",["isValidValue",Ct]),t("set-picker-option",["parseUserInput",Dt]),t("set-picker-option",["formatToString",ur]),t("set-picker-option",["handleClear",Ho]),(ft,un)=>(le(),Pe("div",{class:he([y(U).b(),y(ne).b(),{"has-sidebar":ft.$slots.sidebar||y(Ae),"has-time":y(Nt)}])},[Ve("div",{class:he(y(U).e("body-wrapper"))},[_t(ft.$slots,"sidebar",{class:he(y(U).e("sidebar"))}),y(Ae)?(le(),Pe("div",{key:0,class:he(y(U).e("sidebar"))},[(le(!0),Pe(eo,null,nr(y(C),(et,Mn)=>(le(),Pe("button",{key:Mn,type:"button",class:he(y(U).e("shortcut")),onClick:Bn=>y(J)(et)},yn(et.text),11,["onClick"]))),128))],2)):St("v-if",!0),Ve("div",{class:he(y(U).e("body"))},[y(Nt)?(le(),Pe("div",{key:0,class:he(y(ne).e("time-header"))},[Ve("span",{class:he(y(ne).e("editors-wrap"))},[Ve("span",{class:he(y(ne).e("time-picker-wrap"))},[Qe(y(fs),{size:"small",disabled:y(j).selecting,placeholder:y(me)("el.datepicker.startDate"),class:he(y(ne).e("editor")),"model-value":y(Ce),"validate-event":!1,onInput:et=>yt(et,"min"),onChange:et=>kn(et,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),zo((le(),Pe("span",{class:he(y(ne).e("time-picker-wrap"))},[Qe(y(fs),{size:"small",class:he(y(ne).e("editor")),disabled:y(j).selecting,placeholder:y(me)("el.datepicker.startTime"),"model-value":y(Ne),"validate-event":!1,onFocus:et=>ln.value=!0,onInput:et=>qn(et,"min"),onChange:et=>Co(et,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),Qe(y(Pb),{visible:ln.value,format:y(ot),"datetime-role":"start","parsed-value":F.value,onPick:mo},null,8,["visible","format","parsed-value"])],2)),[[y(ld),_n]])],2),Ve("span",null,[Qe(y(Gn),null,{default:at(()=>[Qe(y(zs))]),_:1})]),Ve("span",{class:he([y(ne).e("editors-wrap"),"is-right"])},[Ve("span",{class:he(y(ne).e("time-picker-wrap"))},[Qe(y(fs),{size:"small",class:he(y(ne).e("editor")),disabled:y(j).selecting,placeholder:y(me)("el.datepicker.endDate"),"model-value":y(ve),readonly:!y(N),"validate-event":!1,onInput:et=>yt(et,"max"),onChange:et=>kn(et,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),zo((le(),Pe("span",{class:he(y(ne).e("time-picker-wrap"))},[Qe(y(fs),{size:"small",class:he(y(ne).e("editor")),disabled:y(j).selecting,placeholder:y(me)("el.datepicker.endTime"),"model-value":y(We),readonly:!y(N),"validate-event":!1,onFocus:et=>y(N)&&(bn.value=!0),onInput:et=>qn(et,"max"),onChange:et=>Co(et,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),Qe(y(Pb),{"datetime-role":"end",visible:bn.value,format:y(ot),"parsed-value":B.value,onPick:Io},null,8,["visible","format","parsed-value"])],2)),[[y(ld),jn]])],2)],2)):St("v-if",!0),Ve("div",{class:he([[y(U).e("content"),y(ne).e("content")],"is-left"])},[Ve("div",{class:he(y(ne).e("header"))},[Ve("button",{type:"button",class:he([y(U).e("icon-btn"),"d-arrow-left"]),"aria-label":y(me)("el.datepicker.prevYear"),onClick:Mt},[_t(ft.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Th))]),_:1})])],10,["aria-label"]),Ve("button",{type:"button",class:he([y(U).e("icon-btn"),"arrow-left"]),"aria-label":y(me)("el.datepicker.prevMonth"),onClick:zt},[_t(ft.$slots,"prev-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Sh))]),_:1})])],10,["aria-label"]),ft.unlinkPanels?(le(),Pe("button",{key:0,type:"button",disabled:!y(Ht),class:he([[y(U).e("icon-btn"),{"is-disabled":!y(Ht)}],"d-arrow-right"]),"aria-label":y(me)("el.datepicker.nextYear"),onClick:$t},[_t(ft.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ch))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),ft.unlinkPanels?(le(),Pe("button",{key:1,type:"button",disabled:!y(Be),class:he([[y(U).e("icon-btn"),{"is-disabled":!y(Be)}],"arrow-right"]),"aria-label":y(me)("el.datepicker.nextMonth"),onClick:Le},[_t(ft.$slots,"next-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(zs))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),Ve("div",null,yn(y(pe)),1)],2),Qe(U2,{"selection-mode":"range",date:F.value,"min-date":y(N),"max-date":y(D),"range-state":y(j),"disabled-date":y(d),"cell-class-name":y(p),onChangerange:y(K),onPick:Gt,onSelect:y(oe)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Ve("div",{class:he([[y(U).e("content"),y(ne).e("content")],"is-right"])},[Ve("div",{class:he(y(ne).e("header"))},[ft.unlinkPanels?(le(),Pe("button",{key:0,type:"button",disabled:!y(Ht),class:he([[y(U).e("icon-btn"),{"is-disabled":!y(Ht)}],"d-arrow-left"]),"aria-label":y(me)("el.datepicker.prevYear"),onClick:dn},[_t(ft.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Th))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),ft.unlinkPanels?(le(),Pe("button",{key:1,type:"button",disabled:!y(Be),class:he([[y(U).e("icon-btn"),{"is-disabled":!y(Be)}],"arrow-left"]),"aria-label":y(me)("el.datepicker.prevMonth"),onClick:At},[_t(ft.$slots,"prev-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Sh))]),_:1})])],10,["disabled","aria-label"])):St("v-if",!0),Ve("button",{type:"button","aria-label":y(me)("el.datepicker.nextYear"),class:he([y(U).e("icon-btn"),"d-arrow-right"]),onClick:bt},[_t(ft.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ch))]),_:1})])],10,["aria-label"]),Ve("button",{type:"button",class:he([y(U).e("icon-btn"),"arrow-right"]),"aria-label":y(me)("el.datepicker.nextMonth"),onClick:Kt},[_t(ft.$slots,"next-month",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(zs))]),_:1})])],10,["aria-label"]),Ve("div",null,yn(y(ge)),1)],2),Qe(U2,{"selection-mode":"range",date:B.value,"min-date":y(N),"max-date":y(D),"range-state":y(j),"disabled-date":y(d),"cell-class-name":y(p),onChangerange:y(K),onPick:Gt,onSelect:y(oe)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),y(Nt)?(le(),Pe("div",{key:0,class:he(y(U).e("footer"))},[y(o)?(le(),Rt(y(Ta),{key:0,text:"",size:"small",class:he(y(U).e("link-btn")),onClick:Ho},{default:at(()=>[Qo(yn(y(me)("el.datepicker.clear")),1)]),_:1},8,["class"])):St("v-if",!0),Qe(y(Ta),{plain:"",size:"small",class:he(y(U).e("link-btn")),disabled:y(Ut),onClick:et=>y(G)(!1)},{default:at(()=>[Qo(yn(y(me)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):St("v-if",!0)],2))}});var UQ=xn(VQ,[["__file","panel-date-range.vue"]]);const jQ=vn({...GT}),HQ=["pick","set-picker-option","calendar-change"],GQ=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const{t:s}=vr(),d=()=>{t.value=t.value.subtract(1,"year"),e.value||(i.value=i.value.subtract(1,"year"))},p=()=>{e.value||(t.value=t.value.add(1,"year")),i.value=i.value.add(1,"year")},_=()=>{t.value=t.value.add(1,"year")},o=()=>{i.value=i.value.subtract(1,"year")},w=te(()=>`${t.value.year()} ${s("el.datepicker.year")}`),C=te(()=>`${i.value.year()} ${s("el.datepicker.year")}`),M=te(()=>t.value.year()),I=te(()=>i.value.year()===t.value.year()?t.value.year()+1:i.value.year());return{leftPrevYear:d,rightNextYear:p,leftNextYear:_,rightPrevYear:o,leftLabel:w,rightLabel:C,leftYear:M,rightYear:I}},N0="year",WQ=Ze({name:"DatePickerMonthRange"}),qQ=Ze({...WQ,props:jQ,emits:HQ,setup(e,{emit:t}){const i=e,{lang:s}=vr(),d=Un("EP_PICKER_BASE"),{shortcuts:p,disabledDate:_}=d.props,o=Vr(d.props,"format"),w=Vr(d.props,"defaultValue"),C=we(Mo().locale(s.value)),M=we(Mo().locale(s.value).add(1,N0)),{minDate:I,maxDate:F,rangeState:B,ppNs:N,drpNs:D,handleChangeRange:j,handleRangeConfirm:U,handleShortcutClick:ne,onSelect:K}=tz(i,{defaultValue:w,leftDate:C,rightDate:M,unit:N0,onParsedValueChanged:Ce}),G=te(()=>!!p.length),{leftPrevYear:J,rightNextYear:oe,leftNextYear:se,rightPrevYear:me,leftLabel:de,rightLabel:ce,leftYear:pe,rightYear:ge}=GQ({unlinkPanels:Vr(i,"unlinkPanels"),leftDate:C,rightDate:M}),Re=te(()=>i.unlinkPanels&&ge.value>pe.value+1),Je=(ve,Ne=!0)=>{const We=ve.minDate,ot=ve.maxDate;F.value===ot&&I.value===We||(t("calendar-change",[We.toDate(),ot&&ot.toDate()]),F.value=ot,I.value=We,Ne&&U())},Me=()=>{C.value=qT(y(w),{lang:y(s),unit:"year",unlinkPanels:i.unlinkPanels})[0],M.value=C.value.add(1,"year"),t("pick",null)},xe=ve=>fn(ve)?ve.map(Ne=>Ne.format(o.value)):ve.format(o.value),Ae=ve=>fn(ve)?ve.map(Ne=>Mo(Ne,o.value).locale(s.value)):Mo(ve,o.value).locale(s.value);function Ce(ve,Ne){if(i.unlinkPanels&&Ne){const We=(ve==null?void 0:ve.year())||0,ot=Ne.year();M.value=We===ot?Ne.add(1,N0):Ne}else M.value=C.value.add(1,N0)}return t("set-picker-option",["isValidValue",Lm]),t("set-picker-option",["formatToString",xe]),t("set-picker-option",["parseUserInput",Ae]),t("set-picker-option",["handleClear",Me]),(ve,Ne)=>(le(),Pe("div",{class:he([y(N).b(),y(D).b(),{"has-sidebar":!!ve.$slots.sidebar||y(G)}])},[Ve("div",{class:he(y(N).e("body-wrapper"))},[_t(ve.$slots,"sidebar",{class:he(y(N).e("sidebar"))}),y(G)?(le(),Pe("div",{key:0,class:he(y(N).e("sidebar"))},[(le(!0),Pe(eo,null,nr(y(p),(We,ot)=>(le(),Pe("button",{key:ot,type:"button",class:he(y(N).e("shortcut")),onClick:Oe=>y(ne)(We)},yn(We.text),11,["onClick"]))),128))],2)):St("v-if",!0),Ve("div",{class:he(y(N).e("body"))},[Ve("div",{class:he([[y(N).e("content"),y(D).e("content")],"is-left"])},[Ve("div",{class:he(y(D).e("header"))},[Ve("button",{type:"button",class:he([y(N).e("icon-btn"),"d-arrow-left"]),onClick:y(J)},[_t(ve.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Th))]),_:1})])],10,["onClick"]),ve.unlinkPanels?(le(),Pe("button",{key:0,type:"button",disabled:!y(Re),class:he([[y(N).e("icon-btn"),{[y(N).is("disabled")]:!y(Re)}],"d-arrow-right"]),onClick:y(se)},[_t(ve.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ch))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),Ve("div",null,yn(y(de)),1)],2),Qe(j2,{"selection-mode":"range",date:C.value,"min-date":y(I),"max-date":y(F),"range-state":y(B),"disabled-date":y(_),onChangerange:y(j),onPick:Je,onSelect:y(K)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Ve("div",{class:he([[y(N).e("content"),y(D).e("content")],"is-right"])},[Ve("div",{class:he(y(D).e("header"))},[ve.unlinkPanels?(le(),Pe("button",{key:0,type:"button",disabled:!y(Re),class:he([[y(N).e("icon-btn"),{"is-disabled":!y(Re)}],"d-arrow-left"]),onClick:y(me)},[_t(ve.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Th))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),Ve("button",{type:"button",class:he([y(N).e("icon-btn"),"d-arrow-right"]),onClick:y(oe)},[_t(ve.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ch))]),_:1})])],10,["onClick"]),Ve("div",null,yn(y(ce)),1)],2),Qe(j2,{"selection-mode":"range",date:M.value,"min-date":y(I),"max-date":y(F),"range-state":y(B),"disabled-date":y(_),onChangerange:y(j),onPick:Je,onSelect:y(K)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var KQ=xn(qQ,[["__file","panel-month-range.vue"]]);const ZQ=vn({...GT}),YQ=["pick","set-picker-option","calendar-change"],XQ=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const s=()=>{t.value=t.value.subtract(10,"year"),e.value||(i.value=i.value.subtract(10,"year"))},d=()=>{e.value||(t.value=t.value.add(10,"year")),i.value=i.value.add(10,"year")},p=()=>{t.value=t.value.add(10,"year")},_=()=>{i.value=i.value.subtract(10,"year")},o=te(()=>{const I=Math.floor(t.value.year()/10)*10;return`${I}-${I+9}`}),w=te(()=>{const I=Math.floor(i.value.year()/10)*10;return`${I}-${I+9}`}),C=te(()=>Math.floor(t.value.year()/10)*10+9),M=te(()=>Math.floor(i.value.year()/10)*10);return{leftPrevYear:s,rightNextYear:d,leftNextYear:p,rightPrevYear:_,leftLabel:o,rightLabel:w,leftYear:C,rightYear:M}},RP="year",JQ=Ze({name:"DatePickerYearRange"}),QQ=Ze({...JQ,props:ZQ,emits:YQ,setup(e,{emit:t}){const i=e,{lang:s}=vr(),d=we(Mo().locale(s.value)),p=we(d.value.add(10,"year")),{pickerNs:_}=Un(C1),o=rn("date-range-picker"),w=te(()=>!!Je.length),C=te(()=>[_.b(),o.b(),{"has-sidebar":!!aa().sidebar||w.value}]),M=te(()=>({content:[_.e("content"),o.e("content"),"is-left"],arrowLeftBtn:[_.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),{[_.is("disabled")]:!J.value},"d-arrow-right"]})),I=te(()=>({content:[_.e("content"),o.e("content"),"is-right"],arrowLeftBtn:[_.e("icon-btn"),{"is-disabled":!J.value},"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),"d-arrow-right"]})),F=ez(s),{leftPrevYear:B,rightNextYear:N,leftNextYear:D,rightPrevYear:j,leftLabel:U,rightLabel:ne,leftYear:K,rightYear:G}=XQ({unlinkPanels:Vr(i,"unlinkPanels"),leftDate:d,rightDate:p}),J=te(()=>i.unlinkPanels&&G.value>K.value+1),oe=we(),se=we(),me=we({endDate:null,selecting:!1}),de=Oe=>{me.value=Oe},ce=(Oe,Ct=!0)=>{const Mt=Oe.minDate,zt=Oe.maxDate;se.value===zt&&oe.value===Mt||(t("calendar-change",[Mt.toDate(),zt&&zt.toDate()]),se.value=zt,oe.value=Mt,Ct&&pe())},pe=(Oe=!1)=>{Lm([oe.value,se.value])&&t("pick",[oe.value,se.value],Oe)},ge=Oe=>{me.value.selecting=Oe,Oe||(me.value.endDate=null)},Re=Un("EP_PICKER_BASE"),{shortcuts:Je,disabledDate:Me}=Re.props,xe=Vr(Re.props,"format"),Ae=Vr(Re.props,"defaultValue"),Ce=()=>{let Oe;if(fn(Ae.value)){const Ct=Mo(Ae.value[0]);let Mt=Mo(Ae.value[1]);return i.unlinkPanels||(Mt=Ct.add(10,RP)),[Ct,Mt]}else Ae.value?Oe=Mo(Ae.value):Oe=Mo();return Oe=Oe.locale(s.value),[Oe,Oe.add(10,RP)]};tn(()=>Ae.value,Oe=>{if(Oe){const Ct=Ce();d.value=Ct[0],p.value=Ct[1]}},{immediate:!0}),tn(()=>i.parsedValue,Oe=>{if(Oe&&Oe.length===2)if(oe.value=Oe[0],se.value=Oe[1],d.value=oe.value,i.unlinkPanels&&se.value){const Ct=oe.value.year(),Mt=se.value.year();p.value=Ct===Mt?se.value.add(10,"year"):se.value}else p.value=d.value.add(10,"year");else{const Ct=Ce();oe.value=void 0,se.value=void 0,d.value=Ct[0],p.value=Ct[1]}},{immediate:!0});const ve=Oe=>fn(Oe)?Oe.map(Ct=>Mo(Ct,xe.value).locale(s.value)):Mo(Oe,xe.value).locale(s.value),Ne=Oe=>fn(Oe)?Oe.map(Ct=>Ct.format(xe.value)):Oe.format(xe.value),We=Oe=>Lm(Oe)&&(Me?!Me(Oe[0].toDate())&&!Me(Oe[1].toDate()):!0),ot=()=>{const Oe=Ce();d.value=Oe[0],p.value=Oe[1],se.value=void 0,oe.value=void 0,t("pick",null)};return t("set-picker-option",["isValidValue",We]),t("set-picker-option",["parseUserInput",ve]),t("set-picker-option",["formatToString",Ne]),t("set-picker-option",["handleClear",ot]),(Oe,Ct)=>(le(),Pe("div",{class:he(y(C))},[Ve("div",{class:he(y(_).e("body-wrapper"))},[_t(Oe.$slots,"sidebar",{class:he(y(_).e("sidebar"))}),y(w)?(le(),Pe("div",{key:0,class:he(y(_).e("sidebar"))},[(le(!0),Pe(eo,null,nr(y(Je),(Mt,zt)=>(le(),Pe("button",{key:zt,type:"button",class:he(y(_).e("shortcut")),onClick:bt=>y(F)(Mt)},yn(Mt.text),11,["onClick"]))),128))],2)):St("v-if",!0),Ve("div",{class:he(y(_).e("body"))},[Ve("div",{class:he(y(M).content)},[Ve("div",{class:he(y(o).e("header"))},[Ve("button",{type:"button",class:he(y(M).arrowLeftBtn),onClick:y(B)},[_t(Oe.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Th))]),_:1})])],10,["onClick"]),Oe.unlinkPanels?(le(),Pe("button",{key:0,type:"button",disabled:!y(J),class:he(y(M).arrowRightBtn),onClick:y(D)},[_t(Oe.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ch))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),Ve("div",null,yn(y(U)),1)],2),Qe(H2,{"selection-mode":"range",date:d.value,"min-date":oe.value,"max-date":se.value,"range-state":me.value,"disabled-date":y(Me),onChangerange:de,onPick:ce,onSelect:ge},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),Ve("div",{class:he(y(I).content)},[Ve("div",{class:he(y(o).e("header"))},[Oe.unlinkPanels?(le(),Pe("button",{key:0,type:"button",disabled:!y(J),class:he(y(I).arrowLeftBtn),onClick:y(j)},[_t(Oe.$slots,"prev-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Th))]),_:1})])],10,["disabled","onClick"])):St("v-if",!0),Ve("button",{type:"button",class:he(y(I).arrowRightBtn),onClick:y(N)},[_t(Oe.$slots,"next-year",{},()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Ch))]),_:1})])],10,["onClick"]),Ve("div",null,yn(y(ne)),1)],2),Qe(H2,{"selection-mode":"range",date:p.value,"min-date":oe.value,"max-date":se.value,"range-state":me.value,"disabled-date":y(Me),onChangerange:de,onPick:ce,onSelect:ge},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var eee=xn(QQ,[["__file","panel-year-range.vue"]]);const tee=function(e){switch(e){case"daterange":case"datetimerange":return UQ;case"monthrange":return KQ;case"yearrange":return eee;default:return NQ}};Mo.extend(fD);Mo.extend(ZJ);Mo.extend(UT);Mo.extend(XJ);Mo.extend(QJ);Mo.extend(tQ);Mo.extend(oQ);Mo.extend(iQ);var nee=Ze({name:"ElDatePicker",install:null,props:TQ,emits:["update:modelValue"],setup(e,{expose:t,emit:i,slots:s}){const d=rn("picker-panel");or("ElPopperOptions",Ir(Vr(e,"popperOptions"))),or(C1,{slots:s,pickerNs:d});const p=we();t({focus:()=>{var w;(w=p.value)==null||w.focus()},blur:()=>{var w;(w=p.value)==null||w.blur()},handleOpen:()=>{var w;(w=p.value)==null||w.handleOpen()},handleClose:()=>{var w;(w=p.value)==null||w.handleClose()}});const o=w=>{i("update:modelValue",w)};return()=>{var w;const C=(w=e.format)!=null?w:aQ[e.type]||om,M=tee(e.type);return Qe(KD,Yo(e,{format:C,type:e.type,ref:p,"onUpdate:modelValue":o}),{default:I=>Qe(M,I,{"prev-month":s["prev-month"],"next-month":s["next-month"],"prev-year":s["prev-year"],"next-year":s["next-year"]}),"range-separator":s["range-separator"]})}}});const oee=Ao(nee),ZT=Symbol("elDescriptions");var Fv=Ze({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:Un(ZT,{})}},render(){var e;const t=pY(this.cell),i=(((e=this.cell)==null?void 0:e.dirs)||[]).map(U=>{const{dir:ne,arg:K,modifiers:G,value:J}=U;return[ne,J,K,G]}),{border:s,direction:d}=this.descriptions,p=d==="vertical",_=()=>{var U,ne,K;return((K=(ne=(U=this.cell)==null?void 0:U.children)==null?void 0:ne.label)==null?void 0:K.call(ne))||t.label},o=()=>{var U,ne,K;return(K=(ne=(U=this.cell)==null?void 0:U.children)==null?void 0:ne.default)==null?void 0:K.call(ne)},w=t.span,C=t.rowspan,M=t.align?`is-${t.align}`:"",I=t.labelAlign?`is-${t.labelAlign}`:M,F=t.className,B=t.labelClassName,N=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,D={width:ji(N),minWidth:ji(t.minWidth)},j=rn("descriptions");switch(this.type){case"label":return zo(lo(this.tag,{style:D,class:[j.e("cell"),j.e("label"),j.is("bordered-label",s),j.is("vertical-label",p),I,B],colSpan:p?w:1,rowspan:p?1:C},_()),i);case"content":return zo(lo(this.tag,{style:D,class:[j.e("cell"),j.e("content"),j.is("bordered-content",s),j.is("vertical-content",p),M,F],colSpan:p?w:w*2-1,rowspan:p?C*2-1:C},o()),i);default:{const U=_();return zo(lo("td",{style:D,class:[j.e("cell"),M],colSpan:w,rowspan:C},[ga(U)?void 0:lo("span",{class:[j.e("label"),B]},U),lo("span",{class:[j.e("content"),F]},o())]),i)}}}});const ree=vn({row:{type:ut(Array),default:()=>[]}}),iee=Ze({name:"ElDescriptionsRow"}),aee=Ze({...iee,props:ree,setup(e){const t=Un(ZT,{});return(i,s)=>y(t).direction==="vertical"?(le(),Pe(eo,{key:0},[Ve("tr",null,[(le(!0),Pe(eo,null,nr(i.row,(d,p)=>(le(),Rt(y(Fv),{key:`tr1-${p}`,cell:d,tag:"th",type:"label"},null,8,["cell"]))),128))]),Ve("tr",null,[(le(!0),Pe(eo,null,nr(i.row,(d,p)=>(le(),Rt(y(Fv),{key:`tr2-${p}`,cell:d,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(le(),Pe("tr",{key:1},[(le(!0),Pe(eo,null,nr(i.row,(d,p)=>(le(),Pe(eo,{key:`tr3-${p}`},[y(t).border?(le(),Pe(eo,{key:0},[Qe(y(Fv),{cell:d,tag:"td",type:"label"},null,8,["cell"]),Qe(y(Fv),{cell:d,tag:"td",type:"content"},null,8,["cell"])],64)):(le(),Rt(y(Fv),{key:1,cell:d,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var see=xn(aee,[["__file","descriptions-row.vue"]]);const lee=vn({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:ia,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),cee=Ze({name:"ElDescriptions"}),uee=Ze({...cee,props:lee,setup(e){const t=e,i=rn("descriptions"),s=na(),d=aa();or(ZT,t);const p=te(()=>[i.b(),i.m(s.value)]),_=(w,C,M,I=!1)=>(w.props||(w.props={}),C>M&&(w.props.span=M),I&&(w.props.span=C),w),o=()=>{if(!d.default)return[];const w=vh(d.default()).filter(N=>{var D;return((D=N==null?void 0:N.type)==null?void 0:D.name)==="ElDescriptionsItem"}),C=[];let M=[],I=t.column,F=0;const B=[];return w.forEach((N,D)=>{var j,U,ne;const K=((j=N.props)==null?void 0:j.span)||1,G=((U=N.props)==null?void 0:U.rowspan)||1,J=C.length;if(B[J]||(B[J]=0),G>1)for(let oe=1;oe<G;oe++)B[ne=J+oe]||(B[ne]=0),B[J+oe]++,F++;if(B[J]>0&&(I-=B[J],B[J]=0),D<w.length-1&&(F+=K>I?I:K),D===w.length-1){const oe=t.column-F%t.column;M.push(_(N,oe,I,!0)),C.push(M);return}K<I?(I-=K,M.push(N)):(M.push(_(N,K,I)),C.push(M),I=t.column,M=[])}),C};return(w,C)=>(le(),Pe("div",{class:he(y(p))},[w.title||w.extra||w.$slots.title||w.$slots.extra?(le(),Pe("div",{key:0,class:he(y(i).e("header"))},[Ve("div",{class:he(y(i).e("title"))},[_t(w.$slots,"title",{},()=>[Qo(yn(w.title),1)])],2),Ve("div",{class:he(y(i).e("extra"))},[_t(w.$slots,"extra",{},()=>[Qo(yn(w.extra),1)])],2)],2)):St("v-if",!0),Ve("div",{class:he(y(i).e("body"))},[Ve("table",{class:he([y(i).e("table"),y(i).is("bordered",w.border)])},[Ve("tbody",null,[(le(!0),Pe(eo,null,nr(o(),(M,I)=>(le(),Rt(see,{key:I,row:M},null,8,["row"]))),128))])],2)],2)],2))}});var dee=xn(uee,[["__file","description.vue"]]);const hee=vn({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),nz=Ze({name:"ElDescriptionsItem",props:hee}),fee=Ao(dee,{DescriptionsItem:nz}),pee=Li(nz),YT=e=>{if(!e)return{onClick:jr,onMousedown:jr,onMouseup:jr};let t=!1,i=!1;return{onClick:_=>{t&&i&&e(_),t=i=!1},onMousedown:_=>{t=_.target===_.currentTarget},onMouseup:_=>{i=_.target===_.currentTarget}}},mee=vn({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:ut([String,Array,Object])},zIndex:{type:ut([String,Number])}}),gee={click:e=>e instanceof MouseEvent},vee="overlay";var _ee=Ze({name:"ElOverlay",props:mee,emits:gee,setup(e,{slots:t,emit:i}){const s=rn(vee),d=w=>{i("click",w)},{onClick:p,onMousedown:_,onMouseup:o}=YT(e.customMaskEvent?void 0:d);return()=>e.mask?Qe("div",{class:[s.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:p,onMousedown:_,onMouseup:o},[_t(t,"default")],Yl.STYLE|Yl.CLASS|Yl.PROPS,["onClick","onMouseup","onMousedown"]):lo("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[_t(t,"default")])}});const XT=_ee,oz=Symbol("dialogInjectionKey"),rz=vn({center:Boolean,alignCenter:Boolean,closeIcon:{type:Xr},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),yee={close:()=>!0},iz=(e,t,i,s)=>{let d={offsetX:0,offsetY:0};const p=C=>{const M=C.clientX,I=C.clientY,{offsetX:F,offsetY:B}=d,N=e.value.getBoundingClientRect(),D=N.left,j=N.top,U=N.width,ne=N.height,K=document.documentElement.clientWidth,G=document.documentElement.clientHeight,J=-D+F,oe=-j+B,se=K-D-U+F,me=G-j-ne+B,de=pe=>{let ge=F+pe.clientX-M,Re=B+pe.clientY-I;s!=null&&s.value||(ge=Math.min(Math.max(ge,J),se),Re=Math.min(Math.max(Re,oe),me)),d={offsetX:ge,offsetY:Re},e.value&&(e.value.style.transform=`translate(${ji(ge)}, ${ji(Re)})`)},ce=()=>{document.removeEventListener("mousemove",de),document.removeEventListener("mouseup",ce)};document.addEventListener("mousemove",de),document.addEventListener("mouseup",ce)},_=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",p)},o=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",p)},w=()=>{d={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")};return No(()=>{Ha(()=>{i.value?_():o()})}),ni(()=>{o()}),{resetPosition:w}},E1=(...e)=>t=>{e.forEach(i=>{Qn(i)?i(t):i.value=t})},bee=Ze({name:"ElDialogContent"}),xee=Ze({...bee,props:rz,emits:yee,setup(e,{expose:t}){const i=e,{t:s}=vr(),{Close:d}=xT,{dialogRef:p,headerRef:_,bodyId:o,ns:w,style:C}=Un(oz),{focusTrapRef:M}=Un(MT),I=te(()=>[w.b(),w.is("fullscreen",i.fullscreen),w.is("draggable",i.draggable),w.is("align-center",i.alignCenter),{[w.m("center")]:i.center}]),F=E1(M,p),B=te(()=>i.draggable),N=te(()=>i.overflow),{resetPosition:D}=iz(p,_,B,N);return t({resetPosition:D}),(j,U)=>(le(),Pe("div",{ref:y(F),class:he(y(I)),style:to(y(C)),tabindex:"-1"},[Ve("header",{ref_key:"headerRef",ref:_,class:he([y(w).e("header"),{"show-close":j.showClose}])},[_t(j.$slots,"header",{},()=>[Ve("span",{role:"heading","aria-level":j.ariaLevel,class:he(y(w).e("title"))},yn(j.title),11,["aria-level"])]),j.showClose?(le(),Pe("button",{key:0,"aria-label":y(s)("el.dialog.close"),class:he(y(w).e("headerbtn")),type:"button",onClick:ne=>j.$emit("close")},[Qe(y(Gn),{class:he(y(w).e("close"))},{default:at(()=>[(le(),Rt(Wo(j.closeIcon||y(d))))]),_:1},8,["class"])],10,["aria-label","onClick"])):St("v-if",!0)],2),Ve("div",{id:y(o),class:he(y(w).e("body"))},[_t(j.$slots,"default")],10,["id"]),j.$slots.footer?(le(),Pe("footer",{key:0,class:he(y(w).e("footer"))},[_t(j.$slots,"footer")],2)):St("v-if",!0)],6))}});var wee=xn(xee,[["__file","dialog-content.vue"]]);const az=vn({...rz,appendToBody:Boolean,appendTo:{type:ut([String,Object]),default:"body"},beforeClose:{type:ut(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),sz={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[Fo]:e=>ai(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},JT=(e,t={})=>{vi(e)||ha("[useLockscreen]","You need to pass a ref param to this function");const i=t.ns||rn("popup"),s=te(()=>i.bm("parent","hidden"));if(!gr||nl(document.body,s.value))return;let d=0,p=!1,_="0";const o=()=>{setTimeout(()=>{typeof document>"u"||(ps(document==null?void 0:document.body,s.value),p&&document&&(document.body.style.width=_))},200)};tn(e,w=>{if(!w){o();return}p=!nl(document.body,s.value),p&&(_=document.body.style.width),d=yO(i.namespace.value);const C=document.documentElement.clientHeight<document.body.scrollHeight,M=td(document.body,"overflowY");d>0&&(C||M==="scroll")&&p&&(document.body.style.width=`calc(100% - ${d}px)`),Jl(document.body,s.value)}),V3(()=>o())},lz=(e,t)=>{var i;const d=jo().emit,{nextZIndex:p}=qm();let _="";const o=Oa(),w=Oa(),C=we(!1),M=we(!1),I=we(!1),F=we((i=e.zIndex)!=null?i:p());let B,N;const D=g1("namespace",Yv),j=te(()=>{const Me={},xe=`--${D.value}-dialog`;return e.fullscreen||(e.top&&(Me[`${xe}-margin-top`]=e.top),e.width&&(Me[`${xe}-width`]=ji(e.width))),Me}),U=te(()=>e.alignCenter?{display:"flex"}:{});function ne(){d("opened")}function K(){d("closed"),d(Fo,!1),e.destroyOnClose&&(I.value=!1)}function G(){d("close")}function J(){N==null||N(),B==null||B(),e.openDelay&&e.openDelay>0?{stop:B}=Hf(()=>de(),e.openDelay):de()}function oe(){B==null||B(),N==null||N(),e.closeDelay&&e.closeDelay>0?{stop:N}=Hf(()=>ce(),e.closeDelay):ce()}function se(){function Me(xe){xe||(M.value=!0,C.value=!1)}e.beforeClose?e.beforeClose(Me):oe()}function me(){e.closeOnClickModal&&se()}function de(){gr&&(C.value=!0)}function ce(){C.value=!1}function pe(){d("openAutoFocus")}function ge(){d("closeAutoFocus")}function Re(Me){var xe;((xe=Me.detail)==null?void 0:xe.focusReason)==="pointer"&&Me.preventDefault()}e.lockScroll&&JT(C);function Je(){e.closeOnPressEscape&&se()}return tn(()=>e.modelValue,Me=>{Me?(M.value=!1,J(),I.value=!0,F.value=tO(e.zIndex)?p():F.value++,oo(()=>{d("open"),t.value&&(t.value.scrollTop=0)})):C.value&&oe()}),tn(()=>e.fullscreen,Me=>{t.value&&(Me?(_=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=_)}),No(()=>{e.modelValue&&(C.value=!0,I.value=!0,J())}),{afterEnter:ne,afterLeave:K,beforeLeave:G,handleClose:se,onModalClick:me,close:oe,doClose:ce,onOpenAutoFocus:pe,onCloseAutoFocus:ge,onCloseRequested:Je,onFocusoutPrevented:Re,titleId:o,bodyId:w,closed:M,style:j,overlayDialogStyle:U,rendered:I,visible:C,zIndex:F}},See=Ze({name:"ElDialog",inheritAttrs:!1}),Tee=Ze({...See,props:az,emits:sz,setup(e,{expose:t}){const i=e,s=aa();mh({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},te(()=>!!s.title));const d=rn("dialog"),p=we(),_=we(),o=we(),{visible:w,titleId:C,bodyId:M,style:I,overlayDialogStyle:F,rendered:B,zIndex:N,afterEnter:D,afterLeave:j,beforeLeave:U,handleClose:ne,onModalClick:K,onOpenAutoFocus:G,onCloseAutoFocus:J,onCloseRequested:oe,onFocusoutPrevented:se}=lz(i,p);or(oz,{dialogRef:p,headerRef:_,bodyId:M,ns:d,rendered:B,style:I});const me=YT(K),de=te(()=>i.draggable&&!i.fullscreen);return t({visible:w,dialogContentRef:o,resetPosition:()=>{var pe;(pe=o.value)==null||pe.resetPosition()}}),(pe,ge)=>(le(),Rt(y(Ym),{to:pe.appendTo,disabled:pe.appendTo!=="body"?!1:!pe.appendToBody},{default:at(()=>[Qe(Ea,{name:"dialog-fade",onAfterEnter:y(D),onAfterLeave:y(j),onBeforeLeave:y(U),persisted:""},{default:at(()=>[zo(Qe(y(XT),{"custom-mask-event":"",mask:pe.modal,"overlay-class":pe.modalClass,"z-index":y(N)},{default:at(()=>[Ve("div",{role:"dialog","aria-modal":"true","aria-label":pe.title||void 0,"aria-labelledby":pe.title?void 0:y(C),"aria-describedby":y(M),class:he(`${y(d).namespace.value}-overlay-dialog`),style:to(y(F)),onClick:y(me).onClick,onMousedown:y(me).onMousedown,onMouseup:y(me).onMouseup},[Qe(y(Zm),{loop:"",trapped:y(w),"focus-start-el":"container",onFocusAfterTrapped:y(G),onFocusAfterReleased:y(J),onFocusoutPrevented:y(se),onReleaseRequested:y(oe)},{default:at(()=>[y(B)?(le(),Rt(wee,Yo({key:0,ref_key:"dialogContentRef",ref:o},pe.$attrs,{center:pe.center,"align-center":pe.alignCenter,"close-icon":pe.closeIcon,draggable:y(de),overflow:pe.overflow,fullscreen:pe.fullscreen,"show-close":pe.showClose,title:pe.title,"aria-level":pe.headerAriaLevel,onClose:y(ne)}),nc({header:at(()=>[pe.$slots.title?_t(pe.$slots,"title",{key:1}):_t(pe.$slots,"header",{key:0,close:y(ne),titleId:y(C),titleClass:y(d).e("title")})]),default:at(()=>[_t(pe.$slots,"default")]),_:2},[pe.$slots.footer?{name:"footer",fn:at(()=>[_t(pe.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):St("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[Cr,y(w)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var Cee=xn(Tee,[["__file","dialog.vue"]]);const Eee=Ao(Cee),Mee=vn({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:ut(String),default:"solid"}}),Iee=Ze({name:"ElDivider"}),Aee=Ze({...Iee,props:Mee,setup(e){const t=e,i=rn("divider"),s=te(()=>i.cssVar({"border-style":t.borderStyle}));return(d,p)=>(le(),Pe("div",{class:he([y(i).b(),y(i).m(d.direction)]),style:to(y(s)),role:"separator"},[d.$slots.default&&d.direction!=="vertical"?(le(),Pe("div",{key:0,class:he([y(i).e("text"),y(i).is(d.contentPosition)])},[_t(d.$slots,"default")],2)):St("v-if",!0)],6))}});var kee=xn(Aee,[["__file","divider.vue"]]);const cz=Ao(kee),Pee=vn({...az,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),Ree=sz,Lee=Ze({name:"ElDrawer",inheritAttrs:!1}),Oee=Ze({...Lee,props:Pee,emits:Ree,setup(e,{expose:t}){const i=e,s=aa();mh({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},te(()=>!!s.title));const d=we(),p=we(),_=rn("drawer"),{t:o}=vr(),{afterEnter:w,afterLeave:C,beforeLeave:M,visible:I,rendered:F,titleId:B,bodyId:N,zIndex:D,onModalClick:j,onOpenAutoFocus:U,onCloseAutoFocus:ne,onFocusoutPrevented:K,onCloseRequested:G,handleClose:J}=lz(i,d),oe=te(()=>i.direction==="rtl"||i.direction==="ltr"),se=te(()=>ji(i.size));return t({handleClose:J,afterEnter:w,afterLeave:C}),(me,de)=>(le(),Rt(y(Ym),{to:me.appendTo,disabled:me.appendTo!=="body"?!1:!me.appendToBody},{default:at(()=>[Qe(Ea,{name:y(_).b("fade"),onAfterEnter:y(w),onAfterLeave:y(C),onBeforeLeave:y(M),persisted:""},{default:at(()=>[zo(Qe(y(XT),{mask:me.modal,"overlay-class":me.modalClass,"z-index":y(D),onClick:y(j)},{default:at(()=>[Qe(y(Zm),{loop:"",trapped:y(I),"focus-trap-el":d.value,"focus-start-el":p.value,onFocusAfterTrapped:y(U),onFocusAfterReleased:y(ne),onFocusoutPrevented:y(K),onReleaseRequested:y(G)},{default:at(()=>[Ve("div",Yo({ref_key:"drawerRef",ref:d,"aria-modal":"true","aria-label":me.title||void 0,"aria-labelledby":me.title?void 0:y(B),"aria-describedby":y(N)},me.$attrs,{class:[y(_).b(),me.direction,y(I)&&"open"],style:y(oe)?"width: "+y(se):"height: "+y(se),role:"dialog",onClick:po(()=>{},["stop"])}),[Ve("span",{ref_key:"focusStartRef",ref:p,class:he(y(_).e("sr-focus")),tabindex:"-1"},null,2),me.withHeader?(le(),Pe("header",{key:0,class:he(y(_).e("header"))},[me.$slots.title?_t(me.$slots,"title",{key:1},()=>[St(" DEPRECATED SLOT ")]):_t(me.$slots,"header",{key:0,close:y(J),titleId:y(B),titleClass:y(_).e("title")},()=>[me.$slots.title?St("v-if",!0):(le(),Pe("span",{key:0,id:y(B),role:"heading","aria-level":me.headerAriaLevel,class:he(y(_).e("title"))},yn(me.title),11,["id","aria-level"]))]),me.showClose?(le(),Pe("button",{key:2,"aria-label":y(o)("el.drawer.close"),class:he(y(_).e("close-btn")),type:"button",onClick:y(J)},[Qe(y(Gn),{class:he(y(_).e("close"))},{default:at(()=>[Qe(y(Xc))]),_:1},8,["class"])],10,["aria-label","onClick"])):St("v-if",!0)],2)):St("v-if",!0),y(F)?(le(),Pe("div",{key:1,id:y(N),class:he(y(_).e("body"))},[_t(me.$slots,"default")],10,["id"])):St("v-if",!0),me.$slots.footer?(le(),Pe("div",{key:2,class:he(y(_).e("footer"))},[_t(me.$slots,"footer")],2)):St("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Cr,y(I)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var Dee=xn(Oee,[["__file","drawer.vue"]]);const zee=Ao(Dee),Fee=Ze({inheritAttrs:!1});function Bee(e,t,i,s,d,p){return _t(e.$slots,"default")}var Nee=xn(Fee,[["render",Bee],["__file","collection.vue"]]);const $ee=Ze({name:"ElCollectionItem",inheritAttrs:!1});function Vee(e,t,i,s,d,p){return _t(e.$slots,"default")}var Uee=xn($ee,[["render",Vee],["__file","collection-item.vue"]]);const uz="data-el-collection-item",dz=e=>{const t=`El${e}Collection`,i=`${t}Item`,s=Symbol(t),d=Symbol(i),p={...Nee,name:t,setup(){const o=we(null),w=new Map;or(s,{itemMap:w,getItems:()=>{const M=y(o);if(!M)return[];const I=Array.from(M.querySelectorAll(`[${uz}]`));return[...w.values()].sort((B,N)=>I.indexOf(B.ref)-I.indexOf(N.ref))},collectionRef:o})}},_={...Uee,name:i,setup(o,{attrs:w}){const C=we(null),M=Un(s,void 0);or(d,{collectionItemRef:C}),No(()=>{const I=y(C);I&&M.itemMap.set(I,{ref:I,...w})}),ni(()=>{const I=y(C);M.itemMap.delete(I)})}};return{COLLECTION_INJECTION_KEY:s,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:p,ElCollectionItem:_}},jee=vn({style:{type:ut([String,Array,Object])},currentTabId:{type:ut(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:ut(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:Hee,ElCollectionItem:Gee,COLLECTION_INJECTION_KEY:QT,COLLECTION_ITEM_INJECTION_KEY:Wee}=dz("RovingFocusGroup"),eC=Symbol("elRovingFocusGroup"),hz=Symbol("elRovingFocusGroupItem"),qee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},Kee=(e,t)=>e,Zee=(e,t,i)=>{const s=Kee(e.code);return qee[s]},Yee=(e,t)=>e.map((i,s)=>e[(s+t)%e.length]),tC=e=>{const{activeElement:t}=document;for(const i of e)if(i===t||(i.focus(),t!==document.activeElement))return},LP="currentTabIdChange",OP="rovingFocusGroup.entryFocus",Xee={bubbles:!1,cancelable:!0},Jee=Ze({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:jee,emits:[LP,"entryFocus"],setup(e,{emit:t}){var i;const s=we((i=e.currentTabId||e.defaultCurrentTabId)!=null?i:null),d=we(!1),p=we(!1),_=we(null),{getItems:o}=Un(QT,void 0),w=te(()=>[{outline:"none"},e.style]),C=D=>{t(LP,D)},M=()=>{d.value=!0},I=Ui(D=>{var j;(j=e.onMousedown)==null||j.call(e,D)},()=>{p.value=!0}),F=Ui(D=>{var j;(j=e.onFocus)==null||j.call(e,D)},D=>{const j=!y(p),{target:U,currentTarget:ne}=D;if(U===ne&&j&&!y(d)){const K=new Event(OP,Xee);if(ne==null||ne.dispatchEvent(K),!K.defaultPrevented){const G=o().filter(de=>de.focusable),J=G.find(de=>de.active),oe=G.find(de=>de.id===y(s)),me=[J,oe,...G].filter(Boolean).map(de=>de.ref);tC(me)}}p.value=!1}),B=Ui(D=>{var j;(j=e.onBlur)==null||j.call(e,D)},()=>{d.value=!1}),N=(...D)=>{t("entryFocus",...D)};or(eC,{currentTabbedId:Vm(s),loop:Vr(e,"loop"),tabIndex:te(()=>y(d)?-1:0),rovingFocusGroupRef:_,rovingFocusGroupRootStyle:w,orientation:Vr(e,"orientation"),dir:Vr(e,"dir"),onItemFocus:C,onItemShiftTab:M,onBlur:B,onFocus:F,onMousedown:I}),tn(()=>e.currentTabId,D=>{s.value=D??null}),qr(_,OP,N)}});function Qee(e,t,i,s,d,p){return _t(e.$slots,"default")}var ete=xn(Jee,[["render",Qee],["__file","roving-focus-group-impl.vue"]]);const tte=Ze({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:Hee,ElRovingFocusGroupImpl:ete}});function nte(e,t,i,s,d,p){const _=Go("el-roving-focus-group-impl"),o=Go("el-focus-group-collection");return le(),Rt(o,null,{default:at(()=>[Qe(_,Hc(yh(e.$attrs)),{default:at(()=>[_t(e.$slots,"default")]),_:3},16)]),_:3})}var ote=xn(tte,[["render",nte],["__file","roving-focus-group.vue"]]);const tb=vn({trigger:y_.trigger,effect:{...wa.effect,default:"light"},type:{type:ut(String)},placement:{type:ut(String),default:"bottom"},popperOptions:{type:ut(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:ut([Number,String]),default:0},maxHeight:{type:ut([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,default:"menu"},buttonProps:{type:ut(Object)},teleported:wa.teleported}),fz=vn({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Xr}}),rte=vn({onKeydown:{type:ut(Function)}}),ite=[Ln.down,Ln.pageDown,Ln.home],pz=[Ln.up,Ln.pageUp,Ln.end],ate=[...ite,...pz],{ElCollection:ste,ElCollectionItem:lte,COLLECTION_INJECTION_KEY:cte,COLLECTION_ITEM_INJECTION_KEY:ute}=dz("Dropdown"),M1=Symbol("elDropdown"),{ButtonGroup:dte}=Ta,hte=Ze({name:"ElDropdown",components:{ElButton:Ta,ElButtonGroup:dte,ElScrollbar:Ou,ElDropdownCollection:ste,ElTooltip:qa,ElRovingFocusGroup:ote,ElOnlyChild:zO,ElIcon:Gn,ArrowDown:fd},props:tb,emits:["visible-change","click","command"],setup(e,{emit:t}){const i=jo(),s=rn("dropdown"),{t:d}=vr(),p=we(),_=we(),o=we(null),w=we(null),C=we(null),M=we(null),I=we(!1),F=[Ln.enter,Ln.numpadEnter,Ln.space,Ln.down],B=te(()=>({maxHeight:ji(e.maxHeight)})),N=te(()=>[s.m(J.value)]),D=te(()=>ds(e.trigger)),j=Oa().value,U=te(()=>e.id||j);tn([p,D],([Ae,Ce],[ve])=>{var Ne,We,ot;(Ne=ve==null?void 0:ve.$el)!=null&&Ne.removeEventListener&&ve.$el.removeEventListener("pointerenter",se),(We=Ae==null?void 0:Ae.$el)!=null&&We.removeEventListener&&Ae.$el.removeEventListener("pointerenter",se),(ot=Ae==null?void 0:Ae.$el)!=null&&ot.addEventListener&&Ce.includes("hover")&&Ae.$el.addEventListener("pointerenter",se)},{immediate:!0}),ni(()=>{var Ae,Ce;(Ce=(Ae=p.value)==null?void 0:Ae.$el)!=null&&Ce.removeEventListener&&p.value.$el.removeEventListener("pointerenter",se)});function ne(){K()}function K(){var Ae;(Ae=o.value)==null||Ae.onClose()}function G(){var Ae;(Ae=o.value)==null||Ae.onOpen()}const J=na();function oe(...Ae){t("command",...Ae)}function se(){var Ae,Ce;(Ce=(Ae=p.value)==null?void 0:Ae.$el)==null||Ce.focus()}function me(){}function de(){const Ae=y(w);D.value.includes("hover")&&(Ae==null||Ae.focus()),M.value=null}function ce(Ae){M.value=Ae}function pe(Ae){I.value||(Ae.preventDefault(),Ae.stopImmediatePropagation())}function ge(){t("visible-change",!0)}function Re(Ae){(Ae==null?void 0:Ae.type)==="keydown"&&w.value.focus()}function Je(){t("visible-change",!1)}return or(M1,{contentRef:w,role:te(()=>e.role),triggerId:U,isUsingKeyboard:I,onItemEnter:me,onItemLeave:de}),or("elDropdown",{instance:i,dropdownSize:J,handleClick:ne,commandHandler:oe,trigger:Vr(e,"trigger"),hideOnClick:Vr(e,"hideOnClick")}),{t:d,ns:s,scrollbar:C,wrapStyle:B,dropdownTriggerKls:N,dropdownSize:J,triggerId:U,triggerKeys:F,currentTabId:M,handleCurrentTabIdChange:ce,handlerMainButtonClick:Ae=>{t("click",Ae)},handleEntryFocus:pe,handleClose:K,handleOpen:G,handleBeforeShowTooltip:ge,handleShowTooltip:Re,handleBeforeHideTooltip:Je,onFocusAfterTrapped:Ae=>{var Ce,ve;Ae.preventDefault(),(ve=(Ce=w.value)==null?void 0:Ce.focus)==null||ve.call(Ce,{preventScroll:!0})},popperRef:o,contentRef:w,triggeringElementRef:p,referenceElementRef:_}}});function fte(e,t,i,s,d,p){var _;const o=Go("el-dropdown-collection"),w=Go("el-roving-focus-group"),C=Go("el-scrollbar"),M=Go("el-only-child"),I=Go("el-tooltip"),F=Go("el-button"),B=Go("arrow-down"),N=Go("el-icon"),D=Go("el-button-group");return le(),Pe("div",{class:he([e.ns.b(),e.ns.is("disabled",e.disabled)])},[Qe(I,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(_=e.referenceElementRef)==null?void 0:_.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},nc({content:at(()=>[Qe(C,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:at(()=>[Qe(w,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:at(()=>[Qe(o,null,{default:at(()=>[_t(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:at(()=>[Qe(M,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:at(()=>[_t(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(le(),Rt(D,{key:0},{default:at(()=>[Qe(F,Yo({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:at(()=>[_t(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),Qe(F,Yo({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:at(()=>[Qe(N,{class:he(e.ns.e("icon"))},{default:at(()=>[Qe(B)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):St("v-if",!0)],2)}var pte=xn(hte,[["render",fte],["__file","dropdown.vue"]]);const mte=Ze({components:{ElRovingFocusCollectionItem:Gee},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:i,loop:s,onItemFocus:d,onItemShiftTab:p}=Un(eC,void 0),{getItems:_}=Un(QT,void 0),o=Oa(),w=we(null),C=Ui(B=>{t("mousedown",B)},B=>{e.focusable?d(y(o)):B.preventDefault()}),M=Ui(B=>{t("focus",B)},()=>{d(y(o))}),I=Ui(B=>{t("keydown",B)},B=>{const{code:N,shiftKey:D,target:j,currentTarget:U}=B;if(N===Ln.tab&&D){p();return}if(j!==U)return;const ne=Zee(B);if(ne){B.preventDefault();let G=_().filter(J=>J.focusable).map(J=>J.ref);switch(ne){case"last":{G.reverse();break}case"prev":case"next":{ne==="prev"&&G.reverse();const J=G.indexOf(U);G=s.value?Yee(G,J+1):G.slice(J+1);break}}oo(()=>{tC(G)})}}),F=te(()=>i.value===y(o));return or(hz,{rovingFocusGroupItemRef:w,tabIndex:te(()=>y(F)?0:-1),handleMousedown:C,handleFocus:M,handleKeydown:I}),{id:o,handleKeydown:I,handleFocus:M,handleMousedown:C}}});function gte(e,t,i,s,d,p){const _=Go("el-roving-focus-collection-item");return le(),Rt(_,{id:e.id,focusable:e.focusable,active:e.active},{default:at(()=>[_t(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var vte=xn(mte,[["render",gte],["__file","roving-focus-item.vue"]]);const _te=Ze({name:"DropdownItemImpl",components:{ElIcon:Gn},props:fz,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const i=rn("dropdown"),{role:s}=Un(M1,void 0),{collectionItemRef:d}=Un(ute,void 0),{collectionItemRef:p}=Un(Wee,void 0),{rovingFocusGroupItemRef:_,tabIndex:o,handleFocus:w,handleKeydown:C,handleMousedown:M}=Un(hz,void 0),I=E1(d,p,_),F=te(()=>s.value==="menu"?"menuitem":s.value==="navigation"?"link":"button"),B=Ui(N=>{if([Ln.enter,Ln.numpadEnter,Ln.space].includes(N.code))return N.preventDefault(),N.stopImmediatePropagation(),t("clickimpl",N),!0},C);return{ns:i,itemRef:I,dataset:{[uz]:""},role:F,tabIndex:o,handleFocus:w,handleKeydown:B,handleMousedown:M}}});function yte(e,t,i,s,d,p){const _=Go("el-icon");return le(),Pe(eo,null,[e.divided?(le(),Pe("li",{key:0,role:"separator",class:he(e.ns.bem("menu","item","divided"))},null,2)):St("v-if",!0),Ve("li",Yo({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:o=>e.$emit("clickimpl",o),onFocus:e.handleFocus,onKeydown:po(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:o=>e.$emit("pointermove",o),onPointerleave:o=>e.$emit("pointerleave",o)}),[e.icon?(le(),Rt(_,{key:0},{default:at(()=>[(le(),Rt(Wo(e.icon)))]),_:1})):St("v-if",!0),_t(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var bte=xn(_te,[["render",yte],["__file","dropdown-item-impl.vue"]]);const mz=()=>{const e=Un("elDropdown",{}),t=te(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},xte=Ze({name:"ElDropdownItem",components:{ElDropdownCollectionItem:lte,ElRovingFocusItem:vte,ElDropdownItemImpl:bte},inheritAttrs:!1,props:fz,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:i}){const{elDropdown:s}=mz(),d=jo(),p=we(null),_=te(()=>{var B,N;return(N=(B=y(p))==null?void 0:B.textContent)!=null?N:""}),{onItemEnter:o,onItemLeave:w}=Un(M1,void 0),C=Ui(B=>(t("pointermove",B),B.defaultPrevented),uP(B=>{if(e.disabled){w(B);return}const N=B.currentTarget;N===document.activeElement||N.contains(document.activeElement)||(o(B),B.defaultPrevented||N==null||N.focus())})),M=Ui(B=>(t("pointerleave",B),B.defaultPrevented),uP(w)),I=Ui(B=>{if(!e.disabled)return t("click",B),B.type!=="keydown"&&B.defaultPrevented},B=>{var N,D,j;if(e.disabled){B.stopImmediatePropagation();return}(N=s==null?void 0:s.hideOnClick)!=null&&N.value&&((D=s.handleClick)==null||D.call(s)),(j=s.commandHandler)==null||j.call(s,e.command,d,B)}),F=te(()=>({...e,...i}));return{handleClick:I,handlePointerMove:C,handlePointerLeave:M,textContent:_,propsAndAttrs:F}}});function wte(e,t,i,s,d,p){var _;const o=Go("el-dropdown-item-impl"),w=Go("el-roving-focus-item"),C=Go("el-dropdown-collection-item");return le(),Rt(C,{disabled:e.disabled,"text-value":(_=e.textValue)!=null?_:e.textContent},{default:at(()=>[Qe(w,{focusable:!e.disabled},{default:at(()=>[Qe(o,Yo(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:at(()=>[_t(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var gz=xn(xte,[["render",wte],["__file","dropdown-item.vue"]]);const Ste=Ze({name:"ElDropdownMenu",props:rte,setup(e){const t=rn("dropdown"),{_elDropdownSize:i}=mz(),s=i.value,{focusTrapRef:d,onKeydown:p}=Un(MT,void 0),{contentRef:_,role:o,triggerId:w}=Un(M1,void 0),{collectionRef:C,getItems:M}=Un(cte,void 0),{rovingFocusGroupRef:I,rovingFocusGroupRootStyle:F,tabIndex:B,onBlur:N,onFocus:D,onMousedown:j}=Un(eC,void 0),{collectionRef:U}=Un(QT,void 0),ne=te(()=>[t.b("menu"),t.bm("menu",s==null?void 0:s.value)]),K=E1(_,C,d,I,U),G=Ui(oe=>{var se;(se=e.onKeydown)==null||se.call(e,oe)},oe=>{const{currentTarget:se,code:me,target:de}=oe;if(se.contains(de),Ln.tab===me&&oe.stopImmediatePropagation(),oe.preventDefault(),de!==y(_)||!ate.includes(me))return;const pe=M().filter(ge=>!ge.disabled).map(ge=>ge.ref);pz.includes(me)&&pe.reverse(),tC(pe)});return{size:s,rovingFocusGroupRootStyle:F,tabIndex:B,dropdownKls:ne,role:o,triggerId:w,dropdownListWrapperRef:K,handleKeydown:oe=>{G(oe),p(oe)},onBlur:N,onFocus:D,onMousedown:j}}});function Tte(e,t,i,s,d,p){return le(),Pe("ul",{ref:e.dropdownListWrapperRef,class:he(e.dropdownKls),style:to(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:po(e.handleKeydown,["self"]),onMousedown:po(e.onMousedown,["self"])},[_t(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var vz=xn(Ste,[["render",Tte],["__file","dropdown-menu.vue"]]);const Cte=Ao(pte,{DropdownItem:gz,DropdownMenu:vz}),Ete=Li(gz),Mte=Li(vz),Ite=Ze({name:"ImgEmpty"}),Ate=Ze({...Ite,setup(e){const t=rn("empty"),i=Oa();return(s,d)=>(le(),Pe("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Ve("defs",null,[Ve("linearGradient",{id:`linearGradient-1-${y(i)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ve("linearGradient",{id:`linearGradient-2-${y(i)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ve("stop",{"stop-color":`var(${y(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ve("rect",{id:`path-3-${y(i)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),Ve("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[Ve("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[Ve("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[Ve("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${y(t).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),Ve("polygon",{id:"Rectangle-Copy-14",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),Ve("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[Ve("polygon",{id:"Rectangle-Copy-10",fill:`var(${y(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),Ve("polygon",{id:"Rectangle-Copy-11",fill:`var(${y(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),Ve("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${y(i)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),Ve("polygon",{id:"Rectangle-Copy-13",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),Ve("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${y(i)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),Ve("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[Ve("use",{id:"Mask",fill:`var(${y(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${y(i)}`},null,8,["fill","xlink:href"]),Ve("polygon",{id:"Rectangle-Copy",fill:`var(${y(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${y(i)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),Ve("polygon",{id:"Rectangle-Copy-18",fill:`var(${y(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var kte=xn(Ate,[["__file","img-empty.vue"]]);const Pte=vn({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),Rte=Ze({name:"ElEmpty"}),Lte=Ze({...Rte,props:Pte,setup(e){const t=e,{t:i}=vr(),s=rn("empty"),d=te(()=>t.description||i("el.table.emptyText")),p=te(()=>({width:ji(t.imageSize)}));return(_,o)=>(le(),Pe("div",{class:he(y(s).b())},[Ve("div",{class:he(y(s).e("image")),style:to(y(p))},[_.image?(le(),Pe("img",{key:0,src:_.image,ondragstart:"return false"},null,8,["src"])):_t(_.$slots,"image",{key:1},()=>[Qe(kte)])],6),Ve("div",{class:he(y(s).e("description"))},[_.$slots.description?_t(_.$slots,"description",{key:0}):(le(),Pe("p",{key:1},yn(y(d)),1))],2),_.$slots.default?(le(),Pe("div",{key:0,class:he(y(s).e("bottom"))},[_t(_.$slots,"default")],2)):St("v-if",!0)],2))}});var Ote=xn(Lte,[["__file","empty.vue"]]);const _z=Ao(Ote),Dte=vn({size:{type:String,values:Lu},disabled:Boolean}),zte=vn({...Dte,model:Object,rules:{type:ut(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),Fte={validate:(e,t,i)=>(fn(e)||Zn(e))&&ai(t)&&Zn(i)};function Bte(){const e=we([]),t=te(()=>{if(!e.value.length)return"0";const p=Math.max(...e.value);return p?`${p}px`:""});function i(p){const _=e.value.indexOf(p);return _===-1&&t.value,_}function s(p,_){if(p&&_){const o=i(_);e.value.splice(o,1,p)}else p&&e.value.push(p)}function d(p){const _=i(p);_>-1&&e.value.splice(_,1)}return{autoLabelWidth:t,registerLabelWidth:s,deregisterLabelWidth:d}}const $0=(e,t)=>{const i=ds(t);return i.length>0?e.filter(s=>s.prop&&i.includes(s.prop)):e},Nte="ElForm",$te=Ze({name:Nte}),Vte=Ze({...$te,props:zte,emits:Fte,setup(e,{expose:t,emit:i}){const s=e,d=[],p=na(),_=rn("form"),o=te(()=>{const{labelPosition:K,inline:G}=s;return[_.b(),_.m(p.value||"default"),{[_.m(`label-${K}`)]:K,[_.m("inline")]:G}]}),w=K=>d.find(G=>G.prop===K),C=K=>{d.push(K)},M=K=>{K.prop&&d.splice(d.indexOf(K),1)},I=(K=[])=>{s.model&&$0(d,K).forEach(G=>G.resetField())},F=(K=[])=>{$0(d,K).forEach(G=>G.clearValidate())},B=te(()=>!!s.model),N=K=>{if(d.length===0)return[];const G=$0(d,K);return G.length?G:[]},D=async K=>U(void 0,K),j=async(K=[])=>{if(!B.value)return!1;const G=N(K);if(G.length===0)return!0;let J={};for(const oe of G)try{await oe.validate("")}catch(se){J={...J,...se}}return Object.keys(J).length===0?!0:Promise.reject(J)},U=async(K=[],G)=>{const J=!Qn(G);try{const oe=await j(K);return oe===!0&&await(G==null?void 0:G(oe)),oe}catch(oe){if(oe instanceof Error)throw oe;const se=oe;return s.scrollToError&&ne(Object.keys(se)[0]),await(G==null?void 0:G(!1,se)),J&&Promise.reject(se)}},ne=K=>{var G;const J=$0(d,K)[0];J&&((G=J.$el)==null||G.scrollIntoView(s.scrollIntoViewOptions))};return tn(()=>s.rules,()=>{s.validateOnRuleChange&&D().catch(K=>void 0)},{deep:!0}),or(Qf,Ir({...Ca(s),emit:i,resetFields:I,clearValidate:F,validateField:U,getField:w,addField:C,removeField:M,...Bte()})),t({validate:D,validateField:U,resetFields:I,clearValidate:F,scrollToField:ne,fields:d}),(K,G)=>(le(),Pe("form",{class:he(y(o))},[_t(K.$slots,"default")],2))}});var Ute=xn(Vte,[["__file","form.vue"]]);function Af(){return Af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Af.apply(this,arguments)}function jte(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,w_(e,t)}function G2(e){return G2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},G2(e)}function w_(e,t){return w_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,d){return s.__proto__=d,s},w_(e,t)}function Hte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nb(e,t,i){return Hte()?nb=Reflect.construct.bind():nb=function(d,p,_){var o=[null];o.push.apply(o,p);var w=Function.bind.apply(d,o),C=new w;return _&&w_(C,_.prototype),C},nb.apply(null,arguments)}function Gte(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function W2(e){var t=typeof Map=="function"?new Map:void 0;return W2=function(s){if(s===null||!Gte(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(s))return t.get(s);t.set(s,d)}function d(){return nb(s,arguments,G2(this).constructor)}return d.prototype=Object.create(s.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),w_(d,s)},W2(e)}var Wte=/%[sdj%]/g,qte=function(){};function q2(e){if(!e||!e.length)return null;var t={};return e.forEach(function(i){var s=i.field;t[s]=t[s]||[],t[s].push(i)}),t}function Sl(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];var d=0,p=i.length;if(typeof e=="function")return e.apply(null,i);if(typeof e=="string"){var _=e.replace(Wte,function(o){if(o==="%%")return"%";if(d>=p)return o;switch(o){case"%s":return String(i[d++]);case"%d":return Number(i[d++]);case"%j":try{return JSON.stringify(i[d++])}catch{return"[Circular]"}break;default:return o}});return _}return e}function Kte(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function Ma(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||Kte(t)&&typeof e=="string"&&!e)}function Zte(e,t,i){var s=[],d=0,p=e.length;function _(o){s.push.apply(s,o||[]),d++,d===p&&i(s)}e.forEach(function(o){t(o,_)})}function DP(e,t,i){var s=0,d=e.length;function p(_){if(_&&_.length){i(_);return}var o=s;s=s+1,o<d?t(e[o],p):i([])}p([])}function Yte(e){var t=[];return Object.keys(e).forEach(function(i){t.push.apply(t,e[i]||[])}),t}var zP=function(e){jte(t,e);function t(i,s){var d;return d=e.call(this,"Async Validation Error")||this,d.errors=i,d.fields=s,d}return t}(W2(Error));function Xte(e,t,i,s,d){if(t.first){var p=new Promise(function(F,B){var N=function(U){return s(U),U.length?B(new zP(U,q2(U))):F(d)},D=Yte(e);DP(D,i,N)});return p.catch(function(F){return F}),p}var _=t.firstFields===!0?Object.keys(e):t.firstFields||[],o=Object.keys(e),w=o.length,C=0,M=[],I=new Promise(function(F,B){var N=function(j){if(M.push.apply(M,j),C++,C===w)return s(M),M.length?B(new zP(M,q2(M))):F(d)};o.length||(s(M),F(d)),o.forEach(function(D){var j=e[D];_.indexOf(D)!==-1?DP(j,i,N):Zte(j,i,N)})});return I.catch(function(F){return F}),I}function Jte(e){return!!(e&&e.message!==void 0)}function Qte(e,t){for(var i=e,s=0;s<t.length;s++){if(i==null)return i;i=i[t[s]]}return i}function FP(e,t){return function(i){var s;return e.fullFields?s=Qte(t,e.fullFields):s=t[i.field||e.fullField],Jte(i)?(i.field=i.field||e.fullField,i.fieldValue=s,i):{message:typeof i=="function"?i():i,fieldValue:s,field:i.field||e.fullField}}}function BP(e,t){if(t){for(var i in t)if(t.hasOwnProperty(i)){var s=t[i];typeof s=="object"&&typeof e[i]=="object"?e[i]=Af({},e[i],s):e[i]=s}}return e}var yz=function(t,i,s,d,p,_){t.required&&(!s.hasOwnProperty(t.field)||Ma(i,_||t.type))&&d.push(Sl(p.messages.required,t.fullField))},ene=function(t,i,s,d,p){(/^\s+$/.test(i)||i==="")&&d.push(Sl(p.messages.whitespace,t.fullField))},V0,tne=function(){if(V0)return V0;var e="[a-fA-F\\d:]",t=function(G){return G&&G.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+s+":){7}(?:"+s+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+s+":){6}(?:"+i+"|:"+s+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+s+":){5}(?::"+i+"|(?::"+s+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+s+":){4}(?:(?::"+s+"){0,1}:"+i+"|(?::"+s+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+s+":){3}(?:(?::"+s+"){0,2}:"+i+"|(?::"+s+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+s+":){2}(?:(?::"+s+"){0,3}:"+i+"|(?::"+s+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+s+":){1}(?:(?::"+s+"){0,4}:"+i+"|(?::"+s+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+s+"){0,5}:"+i+"|(?::"+s+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),p=new RegExp("(?:^"+i+"$)|(?:^"+d+"$)"),_=new RegExp("^"+i+"$"),o=new RegExp("^"+d+"$"),w=function(G){return G&&G.exact?p:new RegExp("(?:"+t(G)+i+t(G)+")|(?:"+t(G)+d+t(G)+")","g")};w.v4=function(K){return K&&K.exact?_:new RegExp(""+t(K)+i+t(K),"g")},w.v6=function(K){return K&&K.exact?o:new RegExp(""+t(K)+d+t(K),"g")};var C="(?:(?:[a-z]+:)?//)",M="(?:\\S+(?::\\S*)?@)?",I=w.v4().source,F=w.v6().source,B="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",N="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",D="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",j="(?::\\d{2,5})?",U='(?:[/?#][^\\s"]*)?',ne="(?:"+C+"|www\\.)"+M+"(?:localhost|"+I+"|"+F+"|"+B+N+D+")"+j+U;return V0=new RegExp("(?:^"+ne+"$)","i"),V0},NP={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},$v={integer:function(t){return $v.number(t)&&parseInt(t,10)===t},float:function(t){return $v.number(t)&&!$v.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!$v.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(NP.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(tne())},hex:function(t){return typeof t=="string"&&!!t.match(NP.hex)}},nne=function(t,i,s,d,p){if(t.required&&i===void 0){yz(t,i,s,d,p);return}var _=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=t.type;_.indexOf(o)>-1?$v[o](i)||d.push(Sl(p.messages.types[o],t.fullField,t.type)):o&&typeof i!==t.type&&d.push(Sl(p.messages.types[o],t.fullField,t.type))},one=function(t,i,s,d,p){var _=typeof t.len=="number",o=typeof t.min=="number",w=typeof t.max=="number",C=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,M=i,I=null,F=typeof i=="number",B=typeof i=="string",N=Array.isArray(i);if(F?I="number":B?I="string":N&&(I="array"),!I)return!1;N&&(M=i.length),B&&(M=i.replace(C,"_").length),_?M!==t.len&&d.push(Sl(p.messages[I].len,t.fullField,t.len)):o&&!w&&M<t.min?d.push(Sl(p.messages[I].min,t.fullField,t.min)):w&&!o&&M>t.max?d.push(Sl(p.messages[I].max,t.fullField,t.max)):o&&w&&(M<t.min||M>t.max)&&d.push(Sl(p.messages[I].range,t.fullField,t.min,t.max))},Xp="enum",rne=function(t,i,s,d,p){t[Xp]=Array.isArray(t[Xp])?t[Xp]:[],t[Xp].indexOf(i)===-1&&d.push(Sl(p.messages[Xp],t.fullField,t[Xp].join(", ")))},ine=function(t,i,s,d,p){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(i)||d.push(Sl(p.messages.pattern.mismatch,t.fullField,i,t.pattern));else if(typeof t.pattern=="string"){var _=new RegExp(t.pattern);_.test(i)||d.push(Sl(p.messages.pattern.mismatch,t.fullField,i,t.pattern))}}},si={required:yz,whitespace:ene,type:nne,range:one,enum:rne,pattern:ine},ane=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i,"string")&&!t.required)return s();si.required(t,i,d,_,p,"string"),Ma(i,"string")||(si.type(t,i,d,_,p),si.range(t,i,d,_,p),si.pattern(t,i,d,_,p),t.whitespace===!0&&si.whitespace(t,i,d,_,p))}s(_)},sne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),i!==void 0&&si.type(t,i,d,_,p)}s(_)},lne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(i===""&&(i=void 0),Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),i!==void 0&&(si.type(t,i,d,_,p),si.range(t,i,d,_,p))}s(_)},cne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),i!==void 0&&si.type(t,i,d,_,p)}s(_)},une=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),Ma(i)||si.type(t,i,d,_,p)}s(_)},dne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),i!==void 0&&(si.type(t,i,d,_,p),si.range(t,i,d,_,p))}s(_)},hne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),i!==void 0&&(si.type(t,i,d,_,p),si.range(t,i,d,_,p))}s(_)},fne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(i==null&&!t.required)return s();si.required(t,i,d,_,p,"array"),i!=null&&(si.type(t,i,d,_,p),si.range(t,i,d,_,p))}s(_)},pne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),i!==void 0&&si.type(t,i,d,_,p)}s(_)},mne="enum",gne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p),i!==void 0&&si[mne](t,i,d,_,p)}s(_)},vne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i,"string")&&!t.required)return s();si.required(t,i,d,_,p),Ma(i,"string")||si.pattern(t,i,d,_,p)}s(_)},_ne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i,"date")&&!t.required)return s();if(si.required(t,i,d,_,p),!Ma(i,"date")){var w;i instanceof Date?w=i:w=new Date(i),si.type(t,w,d,_,p),w&&si.range(t,w.getTime(),d,_,p)}}s(_)},yne=function(t,i,s,d,p){var _=[],o=Array.isArray(i)?"array":typeof i;si.required(t,i,d,_,p,o),s(_)},Hw=function(t,i,s,d,p){var _=t.type,o=[],w=t.required||!t.required&&d.hasOwnProperty(t.field);if(w){if(Ma(i,_)&&!t.required)return s();si.required(t,i,d,o,p,_),Ma(i,_)||si.type(t,i,d,o,p)}s(o)},bne=function(t,i,s,d,p){var _=[],o=t.required||!t.required&&d.hasOwnProperty(t.field);if(o){if(Ma(i)&&!t.required)return s();si.required(t,i,d,_,p)}s(_)},t_={string:ane,method:sne,number:lne,boolean:cne,regexp:une,integer:dne,float:hne,array:fne,object:pne,enum:gne,pattern:vne,date:_ne,url:Hw,hex:Hw,email:Hw,required:yne,any:bne};function K2(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var Z2=K2(),q_=function(){function e(i){this.rules=null,this._messages=Z2,this.define(i)}var t=e.prototype;return t.define=function(s){var d=this;if(!s)throw new Error("Cannot configure a schema with no rules");if(typeof s!="object"||Array.isArray(s))throw new Error("Rules must be an object");this.rules={},Object.keys(s).forEach(function(p){var _=s[p];d.rules[p]=Array.isArray(_)?_:[_]})},t.messages=function(s){return s&&(this._messages=BP(K2(),s)),this._messages},t.validate=function(s,d,p){var _=this;d===void 0&&(d={}),p===void 0&&(p=function(){});var o=s,w=d,C=p;if(typeof w=="function"&&(C=w,w={}),!this.rules||Object.keys(this.rules).length===0)return C&&C(null,o),Promise.resolve(o);function M(D){var j=[],U={};function ne(G){if(Array.isArray(G)){var J;j=(J=j).concat.apply(J,G)}else j.push(G)}for(var K=0;K<D.length;K++)ne(D[K]);j.length?(U=q2(j),C(j,U)):C(null,o)}if(w.messages){var I=this.messages();I===Z2&&(I=K2()),BP(I,w.messages),w.messages=I}else w.messages=this.messages();var F={},B=w.keys||Object.keys(this.rules);B.forEach(function(D){var j=_.rules[D],U=o[D];j.forEach(function(ne){var K=ne;typeof K.transform=="function"&&(o===s&&(o=Af({},o)),U=o[D]=K.transform(U)),typeof K=="function"?K={validator:K}:K=Af({},K),K.validator=_.getValidationMethod(K),K.validator&&(K.field=D,K.fullField=K.fullField||D,K.type=_.getType(K),F[D]=F[D]||[],F[D].push({rule:K,value:U,source:o,field:D}))})});var N={};return Xte(F,w,function(D,j){var U=D.rule,ne=(U.type==="object"||U.type==="array")&&(typeof U.fields=="object"||typeof U.defaultField=="object");ne=ne&&(U.required||!U.required&&D.value),U.field=D.field;function K(oe,se){return Af({},se,{fullField:U.fullField+"."+oe,fullFields:U.fullFields?[].concat(U.fullFields,[oe]):[oe]})}function G(oe){oe===void 0&&(oe=[]);var se=Array.isArray(oe)?oe:[oe];!w.suppressWarning&&se.length&&e.warning("async-validator:",se),se.length&&U.message!==void 0&&(se=[].concat(U.message));var me=se.map(FP(U,o));if(w.first&&me.length)return N[U.field]=1,j(me);if(!ne)j(me);else{if(U.required&&!D.value)return U.message!==void 0?me=[].concat(U.message).map(FP(U,o)):w.error&&(me=[w.error(U,Sl(w.messages.required,U.field))]),j(me);var de={};U.defaultField&&Object.keys(D.value).map(function(ge){de[ge]=U.defaultField}),de=Af({},de,D.rule.fields);var ce={};Object.keys(de).forEach(function(ge){var Re=de[ge],Je=Array.isArray(Re)?Re:[Re];ce[ge]=Je.map(K.bind(null,ge))});var pe=new e(ce);pe.messages(w.messages),D.rule.options&&(D.rule.options.messages=w.messages,D.rule.options.error=w.error),pe.validate(D.value,D.rule.options||w,function(ge){var Re=[];me&&me.length&&Re.push.apply(Re,me),ge&&ge.length&&Re.push.apply(Re,ge),j(Re.length?Re:null)})}}var J;if(U.asyncValidator)J=U.asyncValidator(U,D.value,G,D.source,w);else if(U.validator){try{J=U.validator(U,D.value,G,D.source,w)}catch(oe){console.error==null||console.error(oe),w.suppressValidatorError||setTimeout(function(){throw oe},0),G(oe.message)}J===!0?G():J===!1?G(typeof U.message=="function"?U.message(U.fullField||U.field):U.message||(U.fullField||U.field)+" fails"):J instanceof Array?G(J):J instanceof Error&&G(J.message)}J&&J.then&&J.then(function(){return G()},function(oe){return G(oe)})},function(D){M(D)},o)},t.getType=function(s){if(s.type===void 0&&s.pattern instanceof RegExp&&(s.type="pattern"),typeof s.validator!="function"&&s.type&&!t_.hasOwnProperty(s.type))throw new Error(Sl("Unknown rule type %s",s.type));return s.type||"string"},t.getValidationMethod=function(s){if(typeof s.validator=="function")return s.validator;var d=Object.keys(s),p=d.indexOf("message");return p!==-1&&d.splice(p,1),d.length===1&&d[0]==="required"?t_.required:t_[this.getType(s)]||void 0},e}();q_.register=function(t,i){if(typeof i!="function")throw new Error("Cannot register a validator by type, validator is not a function");t_[t]=i};q_.warning=qte;q_.messages=Z2;q_.validators=t_;const xne=["","error","validating","success"],wne=vn({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:ut([String,Array])},required:{type:Boolean,default:void 0},rules:{type:ut([Object,Array])},error:String,validateStatus:{type:String,values:xne},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:Lu}}),$P="ElLabelWrap";var Sne=Ze({name:$P,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const i=Un(Qf,void 0),s=Un(Au);s||ha($P,"usage: <el-form-item><label-wrap /></el-form-item>");const d=rn("form"),p=we(),_=we(0),o=()=>{var M;if((M=p.value)!=null&&M.firstElementChild){const I=window.getComputedStyle(p.value.firstElementChild).width;return Math.ceil(Number.parseFloat(I))}else return 0},w=(M="update")=>{oo(()=>{t.default&&e.isAutoWidth&&(M==="update"?_.value=o():M==="remove"&&(i==null||i.deregisterLabelWidth(_.value)))})},C=()=>w("update");return No(()=>{C()}),ni(()=>{w("remove")}),Ru(()=>C()),tn(_,(M,I)=>{e.updateAll&&(i==null||i.registerLabelWidth(M,I))}),Mi(te(()=>{var M,I;return(I=(M=p.value)==null?void 0:M.firstElementChild)!=null?I:null}),C),()=>{var M,I;if(!t)return null;const{isAutoWidth:F}=e;if(F){const B=i==null?void 0:i.autoLabelWidth,N=s==null?void 0:s.hasLabel,D={};if(N&&B&&B!=="auto"){const j=Math.max(0,Number.parseInt(B,10)-_.value),ne=(s.labelPosition||i.labelPosition)==="left"?"marginRight":"marginLeft";j&&(D[ne]=`${j}px`)}return Qe("div",{ref:p,class:[d.be("item","label-wrap")],style:D},[(M=t.default)==null?void 0:M.call(t)])}else return Qe(eo,{ref:p},[(I=t.default)==null?void 0:I.call(t)])}}});const Tne=Ze({name:"ElFormItem"}),Cne=Ze({...Tne,props:wne,setup(e,{expose:t}){const i=e,s=aa(),d=Un(Qf,void 0),p=Un(Au,void 0),_=na(void 0,{formItem:!1}),o=rn("form-item"),w=Oa().value,C=we([]),M=we(""),I=HG(M,100),F=we(""),B=we();let N,D=!1;const j=te(()=>i.labelPosition||(d==null?void 0:d.labelPosition)),U=te(()=>{if(j.value==="top")return{};const Kt=ji(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return Kt?{width:Kt}:{}}),ne=te(()=>{if(j.value==="top"||d!=null&&d.inline)return{};if(!i.label&&!i.labelWidth&&ce)return{};const Kt=ji(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return!i.label&&!s.label?{marginLeft:Kt}:{}}),K=te(()=>[o.b(),o.m(_.value),o.is("error",M.value==="error"),o.is("validating",M.value==="validating"),o.is("success",M.value==="success"),o.is("required",Me.value||i.required),o.is("no-asterisk",d==null?void 0:d.hideRequiredAsterisk),(d==null?void 0:d.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[o.m("feedback")]:d==null?void 0:d.statusIcon,[o.m(`label-${j.value}`)]:j.value}]),G=te(()=>ai(i.inlineMessage)?i.inlineMessage:(d==null?void 0:d.inlineMessage)||!1),J=te(()=>[o.e("error"),{[o.em("error","inline")]:G.value}]),oe=te(()=>i.prop?Zn(i.prop)?i.prop:i.prop.join("."):""),se=te(()=>!!(i.label||s.label)),me=te(()=>i.for||(C.value.length===1?C.value[0]:void 0)),de=te(()=>!me.value&&se.value),ce=!!p,pe=te(()=>{const Kt=d==null?void 0:d.model;if(!(!Kt||!i.prop))return Y0(Kt,i.prop).value}),ge=te(()=>{const{required:Kt}=i,$t=[];i.rules&&$t.push(...ds(i.rules));const Le=d==null?void 0:d.rules;if(Le&&i.prop){const dn=Y0(Le,i.prop).value;dn&&$t.push(...ds(dn))}if(Kt!==void 0){const dn=$t.map((At,Ke)=>[At,Ke]).filter(([At])=>Object.keys(At).includes("required"));if(dn.length>0)for(const[At,Ke]of dn)At.required!==Kt&&($t[Ke]={...At,required:Kt});else $t.push({required:Kt})}return $t}),Re=te(()=>ge.value.length>0),Je=Kt=>ge.value.filter(Le=>!Le.trigger||!Kt?!0:fn(Le.trigger)?Le.trigger.includes(Kt):Le.trigger===Kt).map(({trigger:Le,...dn})=>dn),Me=te(()=>ge.value.some(Kt=>Kt.required)),xe=te(()=>{var Kt;return I.value==="error"&&i.showMessage&&((Kt=d==null?void 0:d.showMessage)!=null?Kt:!0)}),Ae=te(()=>`${i.label||""}${(d==null?void 0:d.labelSuffix)||""}`),Ce=Kt=>{M.value=Kt},ve=Kt=>{var $t,Le;const{errors:dn,fields:At}=Kt;(!dn||!At)&&console.error(Kt),Ce("error"),F.value=dn?(Le=($t=dn==null?void 0:dn[0])==null?void 0:$t.message)!=null?Le:`${i.prop} is required`:"",d==null||d.emit("validate",i.prop,!1,F.value)},Ne=()=>{Ce("success"),d==null||d.emit("validate",i.prop,!0,"")},We=async Kt=>{const $t=oe.value;return new q_({[$t]:Kt}).validate({[$t]:pe.value},{firstFields:!0}).then(()=>(Ne(),!0)).catch(dn=>(ve(dn),Promise.reject(dn)))},ot=async(Kt,$t)=>{if(D||!i.prop)return!1;const Le=Qn($t);if(!Re.value)return $t==null||$t(!1),!1;const dn=Je(Kt);return dn.length===0?($t==null||$t(!0),!0):(Ce("validating"),We(dn).then(()=>($t==null||$t(!0),!0)).catch(At=>{const{fields:Ke}=At;return $t==null||$t(!1,Ke),Le?!1:Promise.reject(Ke)}))},Oe=()=>{Ce(""),F.value="",D=!1},Ct=async()=>{const Kt=d==null?void 0:d.model;if(!Kt||!i.prop)return;const $t=Y0(Kt,i.prop);D=!0,$t.value=_k(N),await oo(),Oe(),D=!1},Mt=Kt=>{C.value.includes(Kt)||C.value.push(Kt)},zt=Kt=>{C.value=C.value.filter($t=>$t!==Kt)};tn(()=>i.error,Kt=>{F.value=Kt||"",Ce(Kt?"error":"")},{immediate:!0}),tn(()=>i.validateStatus,Kt=>Ce(Kt||""));const bt=Ir({...Ca(i),$el:B,size:_,validateState:M,labelId:w,inputIds:C,isGroup:de,hasLabel:se,fieldValue:pe,addInputId:Mt,removeInputId:zt,resetField:Ct,clearValidate:Oe,validate:ot});return or(Au,bt),No(()=>{i.prop&&(d==null||d.addField(bt),N=_k(pe.value))}),ni(()=>{d==null||d.removeField(bt)}),t({size:_,validateMessage:F,validateState:M,validate:ot,clearValidate:Oe,resetField:Ct}),(Kt,$t)=>{var Le;return le(),Pe("div",{ref_key:"formItemRef",ref:B,class:he(y(K)),role:y(de)?"group":void 0,"aria-labelledby":y(de)?y(w):void 0},[Qe(y(Sne),{"is-auto-width":y(U).width==="auto","update-all":((Le=y(d))==null?void 0:Le.labelWidth)==="auto"},{default:at(()=>[y(se)?(le(),Rt(Wo(y(me)?"label":"div"),{key:0,id:y(w),for:y(me),class:he(y(o).e("label")),style:to(y(U))},{default:at(()=>[_t(Kt.$slots,"label",{label:y(Ae)},()=>[Qo(yn(y(Ae)),1)])]),_:3},8,["id","for","class","style"])):St("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Ve("div",{class:he(y(o).e("content")),style:to(y(ne))},[_t(Kt.$slots,"default"),Qe(tL,{name:`${y(o).namespace.value}-zoom-in-top`},{default:at(()=>[y(xe)?_t(Kt.$slots,"error",{key:0,error:F.value},()=>[Ve("div",{class:he(y(J))},yn(F.value),3)]):St("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var bz=xn(Cne,[["__file","form-item.vue"]]);const Ene=Ao(Ute,{FormItem:bz}),Mne=Li(bz),Ine=vn({urlList:{type:ut(Array),default:()=>Ri([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:ut(String)}}),Ane={close:()=>!0,switch:e=>ao(e),rotate:e=>ao(e)},kne=Ze({name:"ElImageViewer"}),Pne=Ze({...kne,props:Ine,emits:Ane,setup(e,{expose:t,emit:i}){var s;const d=e,p={CONTAIN:{name:"contain",icon:ph(iq)},ORIGINAL:{name:"original",icon:ph(Cq)}},{t:_}=vr(),o=rn("image-viewer"),{nextZIndex:w}=qm(),C=we(),M=we([]),I=u5(),F=we(!0),B=we(d.initialIndex),N=gi(p.CONTAIN),D=we({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),j=we((s=d.zIndex)!=null?s:w()),U=te(()=>{const{urlList:ot}=d;return ot.length<=1}),ne=te(()=>B.value===0),K=te(()=>B.value===d.urlList.length-1),G=te(()=>d.urlList[B.value]),J=te(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!d.infinite&&ne.value)]),oe=te(()=>[o.e("btn"),o.e("next"),o.is("disabled",!d.infinite&&K.value)]),se=te(()=>{const{scale:ot,deg:Oe,offsetX:Ct,offsetY:Mt,enableTransition:zt}=D.value;let bt=Ct/ot,Kt=Mt/ot;const $t=Oe*Math.PI/180,Le=Math.cos($t),dn=Math.sin($t);bt=bt*Le+Kt*dn,Kt=Kt*Le-Ct/ot*dn;const At={transform:`scale(${ot}) rotate(${Oe}deg) translate(${bt}px, ${Kt}px)`,transition:zt?"transform .3s":""};return N.value.name===p.CONTAIN.name&&(At.maxWidth=At.maxHeight="100%"),At});function me(){ce(),i("close")}function de(){const ot=zf(Ct=>{switch(Ct.code){case Ln.esc:d.closeOnPressEscape&&me();break;case Ln.space:Me();break;case Ln.left:Ae();break;case Ln.up:ve("zoomIn");break;case Ln.right:Ce();break;case Ln.down:ve("zoomOut");break}}),Oe=zf(Ct=>{const Mt=Ct.deltaY||Ct.deltaX;ve(Mt<0?"zoomIn":"zoomOut",{zoomRate:d.zoomRate,enableTransition:!1})});I.run(()=>{qr(document,"keydown",ot),qr(document,"wheel",Oe)})}function ce(){I.stop()}function pe(){F.value=!1}function ge(ot){F.value=!1,ot.target.alt=_("el.image.error")}function Re(ot){if(F.value||ot.button!==0||!C.value)return;D.value.enableTransition=!1;const{offsetX:Oe,offsetY:Ct}=D.value,Mt=ot.pageX,zt=ot.pageY,bt=zf($t=>{D.value={...D.value,offsetX:Oe+$t.pageX-Mt,offsetY:Ct+$t.pageY-zt}}),Kt=qr(document,"mousemove",bt);qr(document,"mouseup",()=>{Kt()}),ot.preventDefault()}function Je(){D.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Me(){if(F.value)return;const ot=Em(p),Oe=Object.values(p),Ct=N.value.name,zt=(Oe.findIndex(bt=>bt.name===Ct)+1)%ot.length;N.value=p[ot[zt]],Je()}function xe(ot){const Oe=d.urlList.length;B.value=(ot+Oe)%Oe}function Ae(){ne.value&&!d.infinite||xe(B.value-1)}function Ce(){K.value&&!d.infinite||xe(B.value+1)}function ve(ot,Oe={}){if(F.value)return;const{minScale:Ct,maxScale:Mt}=d,{zoomRate:zt,rotateDeg:bt,enableTransition:Kt}={zoomRate:d.zoomRate,rotateDeg:90,enableTransition:!0,...Oe};switch(ot){case"zoomOut":D.value.scale>Ct&&(D.value.scale=Number.parseFloat((D.value.scale/zt).toFixed(3)));break;case"zoomIn":D.value.scale<Mt&&(D.value.scale=Number.parseFloat((D.value.scale*zt).toFixed(3)));break;case"clockwise":D.value.deg+=bt,i("rotate",D.value.deg);break;case"anticlockwise":D.value.deg-=bt,i("rotate",D.value.deg);break}D.value.enableTransition=Kt}function Ne(ot){var Oe;((Oe=ot.detail)==null?void 0:Oe.focusReason)==="pointer"&&ot.preventDefault()}function We(){d.closeOnPressEscape&&me()}return tn(G,()=>{oo(()=>{const ot=M.value[0];ot!=null&&ot.complete||(F.value=!0)})}),tn(B,ot=>{Je(),i("switch",ot)}),No(()=>{de()}),t({setActiveItem:xe}),(ot,Oe)=>(le(),Rt(y(Ym),{to:"body",disabled:!ot.teleported},{default:at(()=>[Qe(Ea,{name:"viewer-fade",appear:""},{default:at(()=>[Ve("div",{ref_key:"wrapper",ref:C,tabindex:-1,class:he(y(o).e("wrapper")),style:to({zIndex:j.value})},[Qe(y(Zm),{loop:"",trapped:"","focus-trap-el":C.value,"focus-start-el":"container",onFocusoutPrevented:Ne,onReleaseRequested:We},{default:at(()=>[Ve("div",{class:he(y(o).e("mask")),onClick:po(Ct=>ot.hideOnClickModal&&me(),["self"])},null,10,["onClick"]),St(" CLOSE "),Ve("span",{class:he([y(o).e("btn"),y(o).e("close")]),onClick:me},[Qe(y(Gn),null,{default:at(()=>[Qe(y(Xc))]),_:1})],2),St(" ARROW "),y(U)?St("v-if",!0):(le(),Pe(eo,{key:0},[Ve("span",{class:he(y(J)),onClick:Ae},[Qe(y(Gn),null,{default:at(()=>[Qe(y(Sh))]),_:1})],2),Ve("span",{class:he(y(oe)),onClick:Ce},[Qe(y(Gn),null,{default:at(()=>[Qe(y(zs))]),_:1})],2)],64)),St(" ACTIONS "),Ve("div",{class:he([y(o).e("btn"),y(o).e("actions")])},[Ve("div",{class:he(y(o).e("actions__inner"))},[Qe(y(Gn),{onClick:Ct=>ve("zoomOut")},{default:at(()=>[Qe(y(Vq))]),_:1},8,["onClick"]),Qe(y(Gn),{onClick:Ct=>ve("zoomIn")},{default:at(()=>[Qe(y(EO))]),_:1},8,["onClick"]),Ve("i",{class:he(y(o).e("actions__divider"))},null,2),Qe(y(Gn),{onClick:Me},{default:at(()=>[(le(),Rt(Wo(y(N).icon)))]),_:1}),Ve("i",{class:he(y(o).e("actions__divider"))},null,2),Qe(y(Gn),{onClick:Ct=>ve("anticlockwise")},{default:at(()=>[Qe(y(xq))]),_:1},8,["onClick"]),Qe(y(Gn),{onClick:Ct=>ve("clockwise")},{default:at(()=>[Qe(y(Sq))]),_:1},8,["onClick"])],2)],2),St(" CANVAS "),Ve("div",{class:he(y(o).e("canvas"))},[(le(!0),Pe(eo,null,nr(ot.urlList,(Ct,Mt)=>zo((le(),Pe("img",{ref_for:!0,ref:zt=>M.value[Mt]=zt,key:Ct,src:Ct,style:to(y(se)),class:he(y(o).e("img")),crossorigin:ot.crossorigin,onLoad:pe,onError:ge,onMousedown:Re},null,46,["src","crossorigin"])),[[Cr,Mt===B.value]])),128))],2),_t(ot.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var Rne=xn(Pne,[["__file","image-viewer.vue"]]);const xz=Ao(Rne),Lne=vn({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ut([String,Object])},previewSrcList:{type:ut(Array),default:()=>Ri([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:ut(String)}}),One={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>ao(e),close:()=>!0,show:()=>!0},Dne=Ze({name:"ElImage",inheritAttrs:!1}),zne=Ze({...Dne,props:Lne,emits:One,setup(e,{emit:t}){const i=e;let s="";const{t:d}=vr(),p=rn("image"),_=Ph(),o=te(()=>g_(Object.entries(_).filter(([Ce])=>/^(data-|on[A-Z])/i.test(Ce)||["id","style"].includes(Ce)))),w=j_({excludeListeners:!0,excludeKeys:te(()=>Object.keys(o.value))}),C=we(),M=we(!1),I=we(!0),F=we(!1),B=we(),N=we(),D=gr&&"loading"in HTMLImageElement.prototype;let j,U;const ne=te(()=>[p.e("inner"),G.value&&p.e("preview"),I.value&&p.is("loading")]),K=te(()=>{const{fit:Ce}=i;return gr&&Ce?{objectFit:Ce}:{}}),G=te(()=>{const{previewSrcList:Ce}=i;return fn(Ce)&&Ce.length>0}),J=te(()=>{const{previewSrcList:Ce,initialIndex:ve}=i;let Ne=ve;return ve>Ce.length-1&&(Ne=0),Ne}),oe=te(()=>i.loading==="eager"?!1:!D&&i.loading==="lazy"||i.lazy),se=()=>{gr&&(I.value=!0,M.value=!1,C.value=i.src)};function me(Ce){I.value=!1,M.value=!1,t("load",Ce)}function de(Ce){I.value=!1,M.value=!0,t("error",Ce)}function ce(){oJ(B.value,N.value)&&(se(),Re())}const pe=iO(ce,200,!0);async function ge(){var Ce;if(!gr)return;await oo();const{scrollContainer:ve}=i;El(ve)?N.value=ve:Zn(ve)&&ve!==""?N.value=(Ce=document.querySelector(ve))!=null?Ce:void 0:B.value&&(N.value=mT(B.value)),N.value&&(j=qr(N,"scroll",pe),setTimeout(()=>ce(),100))}function Re(){!gr||!N.value||!pe||(j==null||j(),N.value=void 0)}function Je(Ce){if(Ce.ctrlKey){if(Ce.deltaY<0)return Ce.preventDefault(),!1;if(Ce.deltaY>0)return Ce.preventDefault(),!1}}function Me(){G.value&&(U=qr("wheel",Je,{passive:!1}),s=document.body.style.overflow,document.body.style.overflow="hidden",F.value=!0,t("show"))}function xe(){U==null||U(),document.body.style.overflow=s,F.value=!1,t("close")}function Ae(Ce){t("switch",Ce)}return tn(()=>i.src,()=>{oe.value?(I.value=!0,M.value=!1,Re(),ge()):se()}),No(()=>{oe.value?ge():se()}),(Ce,ve)=>(le(),Pe("div",Yo({ref_key:"container",ref:B},y(o),{class:[y(p).b(),Ce.$attrs.class]}),[M.value?_t(Ce.$slots,"error",{key:0},()=>[Ve("div",{class:he(y(p).e("error"))},yn(y(d)("el.image.error")),3)]):(le(),Pe(eo,{key:1},[C.value!==void 0?(le(),Pe("img",Yo({key:0},y(w),{src:C.value,loading:Ce.loading,style:y(K),class:y(ne),crossorigin:Ce.crossorigin,onClick:Me,onLoad:me,onError:de}),null,16,["src","loading","crossorigin"])):St("v-if",!0),I.value?(le(),Pe("div",{key:1,class:he(y(p).e("wrapper"))},[_t(Ce.$slots,"placeholder",{},()=>[Ve("div",{class:he(y(p).e("placeholder"))},null,2)])],2)):St("v-if",!0)],64)),y(G)?(le(),Pe(eo,{key:2},[F.value?(le(),Rt(y(xz),{key:0,"z-index":Ce.zIndex,"initial-index":y(J),infinite:Ce.infinite,"zoom-rate":Ce.zoomRate,"min-scale":Ce.minScale,"max-scale":Ce.maxScale,"url-list":Ce.previewSrcList,crossorigin:Ce.crossorigin,"hide-on-click-modal":Ce.hideOnClickModal,teleported:Ce.previewTeleported,"close-on-press-escape":Ce.closeOnPressEscape,onClose:xe,onSwitch:Ae},{default:at(()=>[Ce.$slots.viewer?(le(),Pe("div",{key:0},[_t(Ce.$slots,"viewer")])):St("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):St("v-if",!0)],64)):St("v-if",!0)],16))}});var Fne=xn(zne,[["__file","image.vue"]]);const Bne=Ao(Fne),Nne=vn({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:ia,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||ao(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),$ne={[Yr]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Ga]:e=>ao(e)||ga(e),[Fo]:e=>ao(e)||ga(e)},Vne=Ze({name:"ElInputNumber"}),Une=Ze({...Vne,props:Nne,emits:$ne,setup(e,{expose:t,emit:i}){const s=e,{t:d}=vr(),p=rn("input-number"),_=we(),o=Ir({currentValue:s.modelValue,userInput:null}),{formItem:w}=Ka(),C=te(()=>ao(s.modelValue)&&s.modelValue<=s.min),M=te(()=>ao(s.modelValue)&&s.modelValue>=s.max),I=te(()=>{const Me=U(s.step);return Hr(s.precision)?Math.max(U(s.modelValue),Me):(Me>s.precision,s.precision)}),F=te(()=>s.controls&&s.controlsPosition==="right"),B=na(),N=Za(),D=te(()=>{if(o.userInput!==null)return o.userInput;let Me=o.currentValue;if(ga(Me))return"";if(ao(Me)){if(Number.isNaN(Me))return"";Hr(s.precision)||(Me=Me.toFixed(s.precision))}return Me}),j=(Me,xe)=>{if(Hr(xe)&&(xe=I.value),xe===0)return Math.round(Me);let Ae=String(Me);const Ce=Ae.indexOf(".");if(Ce===-1||!Ae.replace(".","").split("")[Ce+xe])return Me;const We=Ae.length;return Ae.charAt(We-1)==="5"&&(Ae=`${Ae.slice(0,Math.max(0,We-1))}6`),Number.parseFloat(Number(Ae).toFixed(xe))},U=Me=>{if(ga(Me))return 0;const xe=Me.toString(),Ae=xe.indexOf(".");let Ce=0;return Ae!==-1&&(Ce=xe.length-Ae-1),Ce},ne=(Me,xe=1)=>ao(Me)?j(Me+s.step*xe):o.currentValue,K=()=>{if(s.readonly||N.value||M.value)return;const Me=Number(D.value)||0,xe=ne(Me);oe(xe),i(Ga,o.currentValue),Re()},G=()=>{if(s.readonly||N.value||C.value)return;const Me=Number(D.value)||0,xe=ne(Me,-1);oe(xe),i(Ga,o.currentValue),Re()},J=(Me,xe)=>{const{max:Ae,min:Ce,step:ve,precision:Ne,stepStrictly:We,valueOnClear:ot}=s;Ae<Ce&&ha("InputNumber","min should not be greater than max.");let Oe=Number(Me);if(ga(Me)||Number.isNaN(Oe))return null;if(Me===""){if(ot===null)return null;Oe=Zn(ot)?{min:Ce,max:Ae}[ot]:ot}return We&&(Oe=j(Math.round(Oe/ve)*ve,Ne),Oe!==Me&&xe&&i(Fo,Oe)),Hr(Ne)||(Oe=j(Oe,Ne)),(Oe>Ae||Oe<Ce)&&(Oe=Oe>Ae?Ae:Ce,xe&&i(Fo,Oe)),Oe},oe=(Me,xe=!0)=>{var Ae;const Ce=o.currentValue,ve=J(Me);if(!xe){i(Fo,ve);return}Ce===ve&&Me||(o.userInput=null,i(Fo,ve),Ce!==ve&&i(Yr,ve,Ce),s.validateEvent&&((Ae=w==null?void 0:w.validate)==null||Ae.call(w,"change").catch(Ne=>void 0)),o.currentValue=ve)},se=Me=>{o.userInput=Me;const xe=Me===""?null:Number(Me);i(Ga,xe),oe(xe,!1)},me=Me=>{const xe=Me!==""?Number(Me):"";(ao(xe)&&!Number.isNaN(xe)||Me==="")&&oe(xe),Re(),o.userInput=null},de=()=>{var Me,xe;(xe=(Me=_.value)==null?void 0:Me.focus)==null||xe.call(Me)},ce=()=>{var Me,xe;(xe=(Me=_.value)==null?void 0:Me.blur)==null||xe.call(Me)},pe=Me=>{i("focus",Me)},ge=Me=>{var xe,Ae;o.userInput=null,b1()&&o.currentValue===null&&((xe=_.value)!=null&&xe.input)&&(_.value.input.value=""),i("blur",Me),s.validateEvent&&((Ae=w==null?void 0:w.validate)==null||Ae.call(w,"blur").catch(Ce=>void 0))},Re=()=>{o.currentValue!==s.modelValue&&(o.currentValue=s.modelValue)},Je=Me=>{document.activeElement===Me.target&&Me.preventDefault()};return tn(()=>s.modelValue,(Me,xe)=>{const Ae=J(Me,!0);o.userInput===null&&Ae!==xe&&(o.currentValue=Ae)},{immediate:!0}),No(()=>{var Me;const{min:xe,max:Ae,modelValue:Ce}=s,ve=(Me=_.value)==null?void 0:Me.input;if(ve.setAttribute("role","spinbutton"),Number.isFinite(Ae)?ve.setAttribute("aria-valuemax",String(Ae)):ve.removeAttribute("aria-valuemax"),Number.isFinite(xe)?ve.setAttribute("aria-valuemin",String(xe)):ve.removeAttribute("aria-valuemin"),ve.setAttribute("aria-valuenow",o.currentValue||o.currentValue===0?String(o.currentValue):""),ve.setAttribute("aria-disabled",String(N.value)),!ao(Ce)&&Ce!=null){let Ne=Number(Ce);Number.isNaN(Ne)&&(Ne=null),i(Fo,Ne)}ve.addEventListener("wheel",Je,{passive:!1})}),Ru(()=>{var Me,xe;const Ae=(Me=_.value)==null?void 0:Me.input;Ae==null||Ae.setAttribute("aria-valuenow",`${(xe=o.currentValue)!=null?xe:""}`)}),t({focus:de,blur:ce}),(Me,xe)=>(le(),Pe("div",{class:he([y(p).b(),y(p).m(y(B)),y(p).is("disabled",y(N)),y(p).is("without-controls",!Me.controls),y(p).is("controls-right",y(F))]),onDragstart:po(()=>{},["prevent"])},[Me.controls?zo((le(),Pe("span",{key:0,role:"button","aria-label":y(d)("el.inputNumber.decrease"),class:he([y(p).e("decrease"),y(p).is("disabled",y(C))]),onKeydown:ti(G,["enter"])},[_t(Me.$slots,"decrease-icon",{},()=>[Qe(y(Gn),null,{default:at(()=>[y(F)?(le(),Rt(y(fd),{key:0})):(le(),Rt(y(dq),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(kb),G]]):St("v-if",!0),Me.controls?zo((le(),Pe("span",{key:1,role:"button","aria-label":y(d)("el.inputNumber.increase"),class:he([y(p).e("increase"),y(p).is("disabled",y(M))]),onKeydown:ti(K,["enter"])},[_t(Me.$slots,"increase-icon",{},()=>[Qe(y(Gn),null,{default:at(()=>[y(F)?(le(),Rt(y(vT),{key:0})):(le(),Rt(y(TO),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[y(kb),K]]):St("v-if",!0),Qe(y(fs),{id:Me.id,ref_key:"input",ref:_,type:"number",step:Me.step,"model-value":y(D),placeholder:Me.placeholder,readonly:Me.readonly,disabled:y(N),size:y(B),max:Me.max,min:Me.min,name:Me.name,"aria-label":Me.ariaLabel,"validate-event":!1,onKeydown:[ti(po(K,["prevent"]),["up"]),ti(po(G,["prevent"]),["down"])],onBlur:ge,onFocus:pe,onInput:se,onChange:me},nc({_:2},[Me.$slots.prefix?{name:"prefix",fn:at(()=>[_t(Me.$slots,"prefix")])}:void 0,Me.$slots.suffix?{name:"suffix",fn:at(()=>[_t(Me.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var jne=xn(Une,[["__file","input-number.vue"]]);const wz=Ao(jne),Hne=vn({modelValue:{type:ut(Array)},max:Number,tagType:{...sd.type,default:"info"},tagEffect:sd.effect,trigger:{type:ut(String),default:Ln.enter},draggable:{type:Boolean,default:!1},size:ia,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},ariaLabel:String}),Gne={[Fo]:e=>fn(e)||Hr(e),[Yr]:e=>fn(e)||Hr(e),[Ga]:e=>Zn(e),"add-tag":e=>Zn(e),"remove-tag":e=>Zn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function Wne({props:e,emit:t,formItem:i}){const s=Za(),d=na(),p=gi(),_=we(),o=te(()=>["small"].includes(d.value)?"small":"default"),w=te(()=>{var de;return(de=e.modelValue)!=null&&de.length?void 0:e.placeholder}),C=te(()=>!(e.readonly||s.value)),M=te(()=>{var de,ce;return Hr(e.max)?!1:((ce=(de=e.modelValue)==null?void 0:de.length)!=null?ce:0)>=e.max}),I=de=>{if(M.value){_.value=void 0;return}J.value||t(Ga,de.target.value)},F=de=>{var ce;switch(de.code){case e.trigger:de.preventDefault(),de.stopPropagation(),B();break;case Ln.numpadEnter:e.trigger===Ln.enter&&(de.preventDefault(),de.stopPropagation(),B());break;case Ln.backspace:!_.value&&((ce=e.modelValue)!=null&&ce.length)&&(de.preventDefault(),de.stopPropagation(),N(e.modelValue.length-1));break}},B=()=>{var de,ce;const pe=(de=_.value)==null?void 0:de.trim();if(!pe||M.value)return;const ge=[...(ce=e.modelValue)!=null?ce:[],pe];t(Fo,ge),t(Yr,ge),t("add-tag",pe),_.value=void 0},N=de=>{var ce;const pe=((ce=e.modelValue)!=null?ce:[]).slice(),[ge]=pe.splice(de,1);t(Fo,pe),t(Yr,pe),t("remove-tag",ge)},D=()=>{_.value=void 0,t(Fo,void 0),t(Yr,void 0),t("clear")},j=(de,ce,pe)=>{var ge;const Re=((ge=e.modelValue)!=null?ge:[]).slice(),[Je]=Re.splice(de,1),Me=ce>de&&pe==="before"?-1:ce<de&&pe==="after"?1:0;Re.splice(ce+Me,0,Je),t(Fo,Re),t(Yr,Re)},U=()=>{var de;(de=p.value)==null||de.focus()},ne=()=>{var de;(de=p.value)==null||de.blur()},{wrapperRef:K,isFocused:G}=Lh(p,{beforeFocus(){return s.value},afterBlur(){var de;B(),e.validateEvent&&((de=i==null?void 0:i.validate)==null||de.call(i,"blur").catch(ce=>void 0))}}),{isComposing:J,handleCompositionStart:oe,handleCompositionUpdate:se,handleCompositionEnd:me}=H_({afterComposition:I});return tn(()=>e.modelValue,()=>{var de;e.validateEvent&&((de=i==null?void 0:i.validate)==null||de.call(i,Yr).catch(ce=>void 0))}),{inputRef:p,wrapperRef:K,isFocused:G,isComposing:J,inputValue:_,size:d,tagSize:o,placeholder:w,closable:C,disabled:s,inputLimit:M,handleDragged:j,handleInput:I,handleKeydown:F,handleAddTag:B,handleRemoveTag:N,handleClear:D,handleCompositionStart:oe,handleCompositionUpdate:se,handleCompositionEnd:me,focus:U,blur:ne}}function qne(){const e=we(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function Kne(){const e=gi(),t=we(0),i=11,s=te(()=>({minWidth:`${Math.max(t.value,i)}px`}));return Mi(e,()=>{var p,_;t.value=(_=(p=e.value)==null?void 0:p.getBoundingClientRect().width)!=null?_:0}),{calculatorRef:e,calculatorWidth:t,inputStyle:s}}function Zne({wrapperRef:e,handleDragged:t,afterDragged:i}){const s=rn("input-tag"),d=gi(),p=we(!1);let _,o,w,C;function M(N){return`.${s.e("inner")} .${s.namespace.value}-tag:nth-child(${N+1})`}function I(N,D){_=D,o=e.value.querySelector(M(D)),o&&(o.style.opacity="0.5"),N.dataTransfer.effectAllowed="move"}function F(N,D){if(w=D,N.preventDefault(),N.dataTransfer.dropEffect="move",Hr(_)||_===D){p.value=!1;return}const j=e.value.querySelector(M(D)).getBoundingClientRect(),U=_+1!==D,ne=_-1!==D,K=N.clientX-j.left,G=U?ne?.5:1:-1,J=ne?U?.5:0:1;K<=j.width*G?C="before":K>j.width*J?C="after":C=void 0;const oe=e.value.querySelector(`.${s.e("inner")}`),se=oe.getBoundingClientRect(),me=Number.parseFloat(td(oe,"gap"))/2,de=j.top-se.top;let ce=-9999;if(C==="before")ce=Math.max(j.left-se.left-me,Math.floor(-me/2));else if(C==="after"){const pe=j.right-se.left;ce=pe+(se.width===pe?Math.floor(me/2):me)}_O(d.value,{top:`${de}px`,left:`${ce}px`}),p.value=!!C}function B(N){N.preventDefault(),o&&(o.style.opacity=""),C&&!Hr(_)&&!Hr(w)&&_!==w&&t(_,w,C),p.value=!1,_=void 0,o=null,w=void 0,C=void 0,i==null||i()}return{dropIndicatorRef:d,showDropIndicator:p,handleDragStart:I,handleDragOver:F,handleDragEnd:B}}function Yne({props:e,isFocused:t,hovering:i,disabled:s,inputValue:d,size:p,validateState:_,validateIcon:o,needStatusIcon:w}){const C=Ph(),M=aa(),I=rn("input-tag"),F=rn("input"),B=te(()=>[I.b(),I.is("focused",t.value),I.is("hovering",i.value),I.is("disabled",s.value),I.m(p.value),I.e("wrapper"),C.class]),N=te(()=>[C.style]),D=te(()=>{var ne,K;return[I.e("inner"),I.is("draggable",e.draggable),I.is("left-space",!((ne=e.modelValue)!=null&&ne.length)&&!M.prefix),I.is("right-space",!((K=e.modelValue)!=null&&K.length)&&!U.value)]}),j=te(()=>{var ne;return e.clearable&&!s.value&&!e.readonly&&(((ne=e.modelValue)==null?void 0:ne.length)||d.value)&&(t.value||i.value)}),U=te(()=>M.suffix||j.value||_.value&&o.value&&w.value);return{ns:I,nsInput:F,containerKls:B,containerStyle:N,innerKls:D,showClear:j,showSuffix:U}}const Xne=Ze({name:"ElInputTag",inheritAttrs:!1}),Jne=Ze({...Xne,props:Hne,emits:Gne,setup(e,{expose:t,emit:i}){const s=e,d=j_(),p=aa(),{form:_,formItem:o}=Ka(),{inputId:w}=sc(s,{formItemContext:o}),C=te(()=>{var At;return(At=_==null?void 0:_.statusIcon)!=null?At:!1}),M=te(()=>(o==null?void 0:o.validateState)||""),I=te(()=>M.value&&y1[M.value]),{inputRef:F,wrapperRef:B,isFocused:N,inputValue:D,size:j,tagSize:U,placeholder:ne,closable:K,disabled:G,handleDragged:J,handleInput:oe,handleKeydown:se,handleRemoveTag:me,handleClear:de,handleCompositionStart:ce,handleCompositionUpdate:pe,handleCompositionEnd:ge,focus:Re,blur:Je}=Wne({props:s,emit:i,formItem:o}),{hovering:Me,handleMouseEnter:xe,handleMouseLeave:Ae}=qne(),{calculatorRef:Ce,inputStyle:ve}=Kne(),{dropIndicatorRef:Ne,showDropIndicator:We,handleDragStart:ot,handleDragOver:Oe,handleDragEnd:Ct}=Zne({wrapperRef:B,handleDragged:J,afterDragged:Re}),{ns:Mt,nsInput:zt,containerKls:bt,containerStyle:Kt,innerKls:$t,showClear:Le,showSuffix:dn}=Yne({props:s,hovering:Me,isFocused:N,inputValue:D,disabled:G,size:j,validateState:M,validateIcon:I,needStatusIcon:C});return t({focus:Re,blur:Je}),(At,Ke)=>(le(),Pe("div",{ref_key:"wrapperRef",ref:B,class:he(y(bt)),style:to(y(Kt)),onMouseenter:y(xe),onMouseleave:y(Ae)},[y(p).prefix?(le(),Pe("div",{key:0,class:he(y(Mt).e("prefix"))},[_t(At.$slots,"prefix")],2)):St("v-if",!0),Ve("div",{class:he(y($t))},[(le(!0),Pe(eo,null,nr(At.modelValue,(Be,Ht)=>(le(),Rt(y(Rm),{key:Ht,size:y(U),closable:y(K),type:At.tagType,effect:At.tagEffect,draggable:y(K)&&At.draggable,"disable-transitions":"",onClose:Ut=>y(me)(Ht),onDragstart:Ut=>y(ot)(Ut,Ht),onDragover:Ut=>y(Oe)(Ut,Ht),onDragend:y(Ct),onDrop:po(()=>{},["stop"])},{default:at(()=>[_t(At.$slots,"tag",{value:Be,index:Ht},()=>[Qo(yn(Be),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),Ve("div",{class:he(y(Mt).e("input-wrapper"))},[zo(Ve("input",Yo({id:y(w),ref_key:"inputRef",ref:F,"onUpdate:modelValue":Be=>vi(D)?D.value=Be:null},y(d),{type:"text",minlength:At.minlength,maxlength:At.maxlength,disabled:y(G),readonly:At.readonly,autocomplete:At.autocomplete,tabindex:At.tabindex,placeholder:y(ne),autofocus:At.autofocus,ariaLabel:At.ariaLabel,class:y(Mt).e("input"),style:y(ve),onCompositionstart:y(ce),onCompositionupdate:y(pe),onCompositionend:y(ge),onInput:y(oe),onKeydown:y(se)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[a1,y(D)]]),Ve("span",{ref_key:"calculatorRef",ref:Ce,"aria-hidden":"true",class:he(y(Mt).e("input-calculator")),textContent:yn(y(D))},null,10,["textContent"])],2),zo(Ve("div",{ref_key:"dropIndicatorRef",ref:Ne,class:he(y(Mt).e("drop-indicator"))},null,2),[[Cr,y(We)]])],2),y(dn)?(le(),Pe("div",{key:1,class:he(y(Mt).e("suffix"))},[_t(At.$slots,"suffix"),y(Le)?(le(),Rt(y(Gn),{key:0,class:he([y(Mt).e("icon"),y(Mt).e("clear")]),onMousedown:po(y(jr),["prevent"]),onClick:y(de)},{default:at(()=>[Qe(y(pd))]),_:1},8,["class","onMousedown","onClick"])):St("v-if",!0),y(M)&&y(I)&&y(C)?(le(),Rt(y(Gn),{key:1,class:he([y(zt).e("icon"),y(zt).e("validateIcon"),y(zt).is("loading",y(M)==="validating")])},{default:at(()=>[(le(),Rt(Wo(y(I))))]),_:1},8,["class"])):St("v-if",!0)],2)):St("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var Qne=xn(Jne,[["__file","input-tag.vue"]]);const eoe=Ao(Qne),toe=vn({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:Xr}}),noe={click:e=>e instanceof MouseEvent},ooe=Ze({name:"ElLink"}),roe=Ze({...ooe,props:toe,emits:noe,setup(e,{emit:t}){const i=e,s=rn("link"),d=te(()=>[s.b(),s.m(i.type),s.is("disabled",i.disabled),s.is("underline",i.underline&&!i.disabled)]);function p(_){i.disabled||t("click",_)}return(_,o)=>(le(),Pe("a",{class:he(y(d)),href:_.disabled||!_.href?void 0:_.href,target:_.disabled||!_.href?void 0:_.target,onClick:p},[_.icon?(le(),Rt(y(Gn),{key:0},{default:at(()=>[(le(),Rt(Wo(_.icon)))]),_:1})):St("v-if",!0),_.$slots.default?(le(),Pe("span",{key:1,class:he(y(s).e("inner"))},[_t(_.$slots,"default")],2)):St("v-if",!0),_.$slots.icon?_t(_.$slots,"icon",{key:2}):St("v-if",!0)],10,["href","target"]))}});var ioe=xn(roe,[["__file","link.vue"]]);const aoe=Ao(ioe);let soe=class{constructor(t,i){this.parent=t,this.domNode=i,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,i=>{i.addEventListener("keydown",s=>{let d=!1;switch(s.code){case Ln.down:{this.gotoSubIndex(this.subIndex+1),d=!0;break}case Ln.up:{this.gotoSubIndex(this.subIndex-1),d=!0;break}case Ln.tab:{X0(t,"mouseleave");break}case Ln.enter:case Ln.numpadEnter:case Ln.space:{d=!0,s.currentTarget.click();break}}return d&&(s.preventDefault(),s.stopPropagation()),!1})})}},loe=class{constructor(t,i){this.domNode=t,this.submenu=null,this.submenu=null,this.init(i)}init(t){this.domNode.setAttribute("tabindex","0");const i=this.domNode.querySelector(`.${t}-menu`);i&&(this.submenu=new soe(this,i)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let i=!1;switch(t.code){case Ln.down:{X0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),i=!0;break}case Ln.up:{X0(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),i=!0;break}case Ln.tab:{X0(t.currentTarget,"mouseleave");break}case Ln.enter:case Ln.numpadEnter:case Ln.space:{i=!0,t.currentTarget.click();break}}i&&t.preventDefault()})}},coe=class{constructor(t,i){this.domNode=t,this.init(i)}init(t){const i=this.domNode.childNodes;Array.from(i).forEach(s=>{s.nodeType===1&&new loe(s,t)})}};const uoe=Ze({name:"ElMenuCollapseTransition",setup(){const e=rn("menu");return{listeners:{onBeforeEnter:i=>i.style.opacity="0.2",onEnter(i,s){Jl(i,`${e.namespace.value}-opacity-transition`),i.style.opacity="1",s()},onAfterEnter(i){ps(i,`${e.namespace.value}-opacity-transition`),i.style.opacity=""},onBeforeLeave(i){i.dataset||(i.dataset={}),nl(i,e.m("collapse"))?(ps(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),Jl(i,e.m("collapse"))):(Jl(i,e.m("collapse")),i.dataset.oldOverflow=i.style.overflow,i.dataset.scrollWidth=i.clientWidth.toString(),ps(i,e.m("collapse"))),i.style.width=`${i.scrollWidth}px`,i.style.overflow="hidden"},onLeave(i){Jl(i,"horizontal-collapse-transition"),i.style.width=`${i.dataset.scrollWidth}px`}}}}});function doe(e,t,i,s,d,p){return le(),Rt(Ea,Yo({mode:"out-in"},e.listeners),{default:at(()=>[_t(e.$slots,"default")]),_:3},16)}var hoe=xn(uoe,[["render",doe],["__file","menu-collapse-transition.vue"]]);function Sz(e,t){const i=te(()=>{let d=e.parent;const p=[t.value];for(;d.type.name!=="ElMenu";)d.props.index&&p.unshift(d.props.index),d=d.parent;return p});return{parentMenu:te(()=>{let d=e.parent;for(;d&&!["ElMenu","ElSubMenu"].includes(d.type.name);)d=d.parent;return d}),indexPath:i}}function foe(e){return te(()=>{const i=e.backgroundColor;return i?new aD(i).shade(20).toString():""})}const Tz=(e,t)=>{const i=rn("menu");return te(()=>i.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":foe(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},poe=vn({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:Xr},expandOpenIcon:{type:Xr},collapseCloseIcon:{type:Xr},collapseOpenIcon:{type:Xr}}),Gw="ElSubMenu";var nC=Ze({name:Gw,props:poe,setup(e,{slots:t,expose:i}){const s=jo(),{indexPath:d,parentMenu:p}=Sz(s,te(()=>e.index)),_=rn("menu"),o=rn("sub-menu"),w=Un("rootMenu");w||ha(Gw,"can not inject root menu");const C=Un(`subMenu:${p.value.uid}`);C||ha(Gw,"can not inject sub menu");const M=we({}),I=we({});let F;const B=we(!1),N=we(),D=we(null),j=te(()=>me.value==="horizontal"&&ne.value?"bottom-start":"right-start"),U=te(()=>me.value==="horizontal"&&ne.value||me.value==="vertical"&&!w.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?oe.value?e.expandOpenIcon:e.expandCloseIcon:fd:e.collapseCloseIcon&&e.collapseOpenIcon?oe.value?e.collapseOpenIcon:e.collapseCloseIcon:zs),ne=te(()=>C.level===0),K=te(()=>{const Ne=e.teleported;return Ne===void 0?ne.value:Ne}),G=te(()=>w.props.collapse?`${_.namespace.value}-zoom-in-left`:`${_.namespace.value}-zoom-in-top`),J=te(()=>me.value==="horizontal"&&ne.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),oe=te(()=>w.openedMenus.includes(e.index)),se=te(()=>{let Ne=!1;return Object.values(M.value).forEach(We=>{We.active&&(Ne=!0)}),Object.values(I.value).forEach(We=>{We.active&&(Ne=!0)}),Ne}),me=te(()=>w.props.mode),de=Ir({index:e.index,indexPath:d,active:se}),ce=Tz(w.props,C.level+1),pe=te(()=>{var Ne;return(Ne=e.popperOffset)!=null?Ne:w.props.popperOffset}),ge=te(()=>{var Ne;return(Ne=e.popperClass)!=null?Ne:w.props.popperClass}),Re=te(()=>{var Ne;return(Ne=e.showTimeout)!=null?Ne:w.props.showTimeout}),Je=te(()=>{var Ne;return(Ne=e.hideTimeout)!=null?Ne:w.props.hideTimeout}),Me=()=>{var Ne,We,ot;return(ot=(We=(Ne=D.value)==null?void 0:Ne.popperRef)==null?void 0:We.popperInstanceRef)==null?void 0:ot.destroy()},xe=Ne=>{Ne||Me()},Ae=()=>{w.props.menuTrigger==="hover"&&w.props.mode==="horizontal"||w.props.collapse&&w.props.mode==="vertical"||e.disabled||w.handleSubMenuClick({index:e.index,indexPath:d.value,active:se.value})},Ce=(Ne,We=Re.value)=>{var ot;if(Ne.type!=="focus"){if(w.props.menuTrigger==="click"&&w.props.mode==="horizontal"||!w.props.collapse&&w.props.mode==="vertical"||e.disabled){C.mouseInChild.value=!0;return}C.mouseInChild.value=!0,F==null||F(),{stop:F}=Hf(()=>{w.openMenu(e.index,d.value)},We),K.value&&((ot=p.value.vnode.el)==null||ot.dispatchEvent(new MouseEvent("mouseenter")))}},ve=(Ne=!1)=>{var We;if(w.props.menuTrigger==="click"&&w.props.mode==="horizontal"||!w.props.collapse&&w.props.mode==="vertical"){C.mouseInChild.value=!1;return}F==null||F(),C.mouseInChild.value=!1,{stop:F}=Hf(()=>!B.value&&w.closeMenu(e.index,d.value),Je.value),K.value&&Ne&&((We=C.handleMouseleave)==null||We.call(C,!0))};tn(()=>w.props.collapse,Ne=>xe(!!Ne));{const Ne=ot=>{I.value[ot.index]=ot},We=ot=>{delete I.value[ot.index]};or(`subMenu:${s.uid}`,{addSubMenu:Ne,removeSubMenu:We,handleMouseleave:ve,mouseInChild:B,level:C.level+1})}return i({opened:oe}),No(()=>{w.addSubMenu(de),C.addSubMenu(de)}),ni(()=>{C.removeSubMenu(de),w.removeSubMenu(de)}),()=>{var Ne;const We=[(Ne=t.title)==null?void 0:Ne.call(t),lo(Gn,{class:o.e("icon-arrow"),style:{transform:oe.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&w.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Zn(U.value)?lo(s.appContext.components[U.value]):lo(U.value)})],ot=w.isMenuPopup?lo(qa,{ref:D,visible:oe.value,effect:"light",pure:!0,offset:pe.value,showArrow:!1,persistent:!0,popperClass:ge.value,placement:j.value,teleported:K.value,fallbackPlacements:J.value,transition:G.value,gpuAcceleration:!1},{content:()=>{var Oe;return lo("div",{class:[_.m(me.value),_.m("popup-container"),ge.value],onMouseenter:Ct=>Ce(Ct,100),onMouseleave:()=>ve(!0),onFocus:Ct=>Ce(Ct,100)},[lo("ul",{class:[_.b(),_.m("popup"),_.m(`popup-${j.value}`)],style:ce.value},[(Oe=t.default)==null?void 0:Oe.call(t)])])},default:()=>lo("div",{class:o.e("title"),onClick:Ae},We)}):lo(eo,{},[lo("div",{class:o.e("title"),ref:N,onClick:Ae},We),lo(T1,{},{default:()=>{var Oe;return zo(lo("ul",{role:"menu",class:[_.b(),_.m("inline")],style:ce.value},[(Oe=t.default)==null?void 0:Oe.call(t)]),[[Cr,oe.value]])}})]);return lo("li",{class:[o.b(),o.is("active",se.value),o.is("opened",oe.value),o.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:oe.value,onMouseenter:Ce,onMouseleave:()=>ve(),onFocus:Ce},[ot])}}});const moe=vn({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:ut(Array),default:()=>Ri([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:Xr,default:()=>pq},popperEffect:{type:ut(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),Ww=e=>fn(e)&&e.every(t=>Zn(t)),goe={close:(e,t)=>Zn(e)&&Ww(t),open:(e,t)=>Zn(e)&&Ww(t),select:(e,t,i,s)=>Zn(e)&&Ww(t)&&Vo(i)&&(s===void 0||s instanceof Promise)};var voe=Ze({name:"ElMenu",props:moe,emits:goe,setup(e,{emit:t,slots:i,expose:s}){const d=jo(),p=d.appContext.config.globalProperties.$router,_=we(),o=rn("menu"),w=rn("sub-menu"),C=we(-1),M=we(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),I=we(e.defaultActive),F=we({}),B=we({}),N=te(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),D=()=>{const Me=I.value&&F.value[I.value];if(!Me||e.mode==="horizontal"||e.collapse)return;Me.indexPath.forEach(Ae=>{const Ce=B.value[Ae];Ce&&j(Ae,Ce.indexPath)})},j=(Me,xe)=>{M.value.includes(Me)||(e.uniqueOpened&&(M.value=M.value.filter(Ae=>xe.includes(Ae))),M.value.push(Me),t("open",Me,xe))},U=Me=>{const xe=M.value.indexOf(Me);xe!==-1&&M.value.splice(xe,1)},ne=(Me,xe)=>{U(Me),t("close",Me,xe)},K=({index:Me,indexPath:xe})=>{M.value.includes(Me)?ne(Me,xe):j(Me,xe)},G=Me=>{(e.mode==="horizontal"||e.collapse)&&(M.value=[]);const{index:xe,indexPath:Ae}=Me;if(!(ga(xe)||ga(Ae)))if(e.router&&p){const Ce=Me.route||xe,ve=p.push(Ce).then(Ne=>(Ne||(I.value=xe),Ne));t("select",xe,Ae,{index:xe,indexPath:Ae,route:Ce},ve)}else I.value=xe,t("select",xe,Ae,{index:xe,indexPath:Ae})},J=Me=>{const xe=F.value,Ae=xe[Me]||I.value&&xe[I.value]||xe[e.defaultActive];Ae?I.value=Ae.index:I.value=Me},oe=Me=>{const xe=getComputedStyle(Me),Ae=Number.parseInt(xe.marginLeft,10),Ce=Number.parseInt(xe.marginRight,10);return Me.offsetWidth+Ae+Ce||0},se=()=>{var Me,xe;if(!_.value)return-1;const Ae=Array.from((xe=(Me=_.value)==null?void 0:Me.childNodes)!=null?xe:[]).filter(Mt=>Mt.nodeName!=="#comment"&&(Mt.nodeName!=="#text"||Mt.nodeValue)),Ce=64,ve=getComputedStyle(_.value),Ne=Number.parseInt(ve.paddingLeft,10),We=Number.parseInt(ve.paddingRight,10),ot=_.value.clientWidth-Ne-We;let Oe=0,Ct=0;return Ae.forEach((Mt,zt)=>{Oe+=oe(Mt),Oe<=ot-Ce&&(Ct=zt+1)}),Ct===Ae.length?-1:Ct},me=Me=>B.value[Me].indexPath,de=(Me,xe=33.34)=>{let Ae;return()=>{Ae&&clearTimeout(Ae),Ae=setTimeout(()=>{Me()},xe)}};let ce=!0;const pe=()=>{if(C.value===se())return;const Me=()=>{C.value=-1,oo(()=>{C.value=se()})};ce?Me():de(Me)(),ce=!1};tn(()=>e.defaultActive,Me=>{F.value[Me]||(I.value=""),J(Me)}),tn(()=>e.collapse,Me=>{Me&&(M.value=[])}),tn(F.value,D);let ge;Ha(()=>{e.mode==="horizontal"&&e.ellipsis?ge=Mi(_,pe).stop:ge==null||ge()});const Re=we(!1);{const Me=ve=>{B.value[ve.index]=ve},xe=ve=>{delete B.value[ve.index]};or("rootMenu",Ir({props:e,openedMenus:M,items:F,subMenus:B,activeIndex:I,isMenuPopup:N,addMenuItem:ve=>{F.value[ve.index]=ve},removeMenuItem:ve=>{delete F.value[ve.index]},addSubMenu:Me,removeSubMenu:xe,openMenu:j,closeMenu:ne,handleMenuItemClick:G,handleSubMenuClick:K})),or(`subMenu:${d.uid}`,{addSubMenu:Me,removeSubMenu:xe,mouseInChild:Re,level:0})}No(()=>{e.mode==="horizontal"&&new coe(d.vnode.el,o.namespace.value)}),s({open:xe=>{const{indexPath:Ae}=B.value[xe];Ae.forEach(Ce=>j(Ce,Ae))},close:U,handleResize:pe});const Je=Tz(e,0);return()=>{var Me,xe;let Ae=(xe=(Me=i.default)==null?void 0:Me.call(i))!=null?xe:[];const Ce=[];if(e.mode==="horizontal"&&_.value){const We=vh(Ae),ot=C.value===-1?We:We.slice(0,C.value),Oe=C.value===-1?[]:We.slice(C.value);Oe!=null&&Oe.length&&e.ellipsis&&(Ae=ot,Ce.push(lo(nC,{index:"sub-menu-more",class:w.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>lo(Gn,{class:w.e("icon-more")},{default:()=>lo(e.ellipsisIcon)}),default:()=>Oe})))}const ve=e.closeOnClickOutside?[[ld,()=>{M.value.length&&(Re.value||(M.value.forEach(We=>t("close",We,me(We))),M.value=[]))}]]:[],Ne=zo(lo("ul",{key:String(e.collapse),role:"menubar",ref:_,style:Je.value,class:{[o.b()]:!0,[o.m(e.mode)]:!0,[o.m("collapse")]:e.collapse}},[...Ae,...Ce]),ve);return e.collapseTransition&&e.mode==="vertical"?lo(hoe,()=>Ne):Ne}}});const _oe=vn({index:{type:ut([String,null]),default:null},route:{type:ut([String,Object])},disabled:Boolean}),yoe={click:e=>Zn(e.index)&&fn(e.indexPath)},qw="ElMenuItem",boe=Ze({name:qw,components:{ElTooltip:qa},props:_oe,emits:yoe,setup(e,{emit:t}){const i=jo(),s=Un("rootMenu"),d=rn("menu"),p=rn("menu-item");s||ha(qw,"can not inject root menu");const{parentMenu:_,indexPath:o}=Sz(i,Vr(e,"index")),w=Un(`subMenu:${_.value.uid}`);w||ha(qw,"can not inject sub menu");const C=te(()=>e.index===s.activeIndex),M=Ir({index:e.index,indexPath:o,active:C}),I=()=>{e.disabled||(s.handleMenuItemClick({index:e.index,indexPath:o.value,route:e.route}),t("click",M))};return No(()=>{w.addSubMenu(M),s.addMenuItem(M)}),ni(()=>{w.removeSubMenu(M),s.removeMenuItem(M)}),{parentMenu:_,rootMenu:s,active:C,nsMenu:d,nsMenuItem:p,handleClick:I}}});function xoe(e,t,i,s,d,p){const _=Go("el-tooltip");return le(),Pe("li",{class:he([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",onClick:e.handleClick},[e.parentMenu.type.name==="ElMenu"&&e.rootMenu.props.collapse&&e.$slots.title?(le(),Rt(_,{key:0,effect:e.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:at(()=>[_t(e.$slots,"title")]),default:at(()=>[Ve("div",{class:he(e.nsMenu.be("tooltip","trigger"))},[_t(e.$slots,"default")],2)]),_:3},8,["effect"])):(le(),Pe(eo,{key:1},[_t(e.$slots,"default"),_t(e.$slots,"title")],64))],10,["onClick"])}var Cz=xn(boe,[["render",xoe],["__file","menu-item.vue"]]);const woe={title:String},Soe="ElMenuItemGroup",Toe=Ze({name:Soe,props:woe,setup(){return{ns:rn("menu-item-group")}}});function Coe(e,t,i,s,d,p){return le(),Pe("li",{class:he(e.ns.b())},[Ve("div",{class:he(e.ns.e("title"))},[e.$slots.title?_t(e.$slots,"title",{key:1}):(le(),Pe(eo,{key:0},[Qo(yn(e.title),1)],64))],2),Ve("ul",null,[_t(e.$slots,"default")])],2)}var Ez=xn(Toe,[["render",Coe],["__file","menu-item-group.vue"]]);const Eoe=Ao(voe,{MenuItem:Cz,MenuItemGroup:Ez,SubMenu:nC}),Moe=Li(Cz),Ioe=Li(Ez),Aoe=Li(nC),koe=vn({icon:{type:Xr,default:()=>BW},title:String,content:{type:String,default:""}}),Poe={back:()=>!0},Roe=Ze({name:"ElPageHeader"}),Loe=Ze({...Roe,props:koe,emits:Poe,setup(e,{emit:t}){const i=aa(),{t:s}=vr(),d=rn("page-header"),p=te(()=>[d.b(),{[d.m("has-breadcrumb")]:!!i.breadcrumb,[d.m("has-extra")]:!!i.extra,[d.is("contentful")]:!!i.default}]);function _(){t("back")}return(o,w)=>(le(),Pe("div",{class:he(y(p))},[o.$slots.breadcrumb?(le(),Pe("div",{key:0,class:he(y(d).e("breadcrumb"))},[_t(o.$slots,"breadcrumb")],2)):St("v-if",!0),Ve("div",{class:he(y(d).e("header"))},[Ve("div",{class:he(y(d).e("left"))},[Ve("div",{class:he(y(d).e("back")),role:"button",tabindex:"0",onClick:_},[o.icon||o.$slots.icon?(le(),Pe("div",{key:0,"aria-label":o.title||y(s)("el.pageHeader.title"),class:he(y(d).e("icon"))},[_t(o.$slots,"icon",{},()=>[o.icon?(le(),Rt(y(Gn),{key:0},{default:at(()=>[(le(),Rt(Wo(o.icon)))]),_:1})):St("v-if",!0)])],10,["aria-label"])):St("v-if",!0),Ve("div",{class:he(y(d).e("title"))},[_t(o.$slots,"title",{},()=>[Qo(yn(o.title||y(s)("el.pageHeader.title")),1)])],2)],2),Qe(y(cz),{direction:"vertical"}),Ve("div",{class:he(y(d).e("content"))},[_t(o.$slots,"content",{},()=>[Qo(yn(o.content),1)])],2)],2),o.$slots.extra?(le(),Pe("div",{key:0,class:he(y(d).e("extra"))},[_t(o.$slots,"extra")],2)):St("v-if",!0)],2),o.$slots.default?(le(),Pe("div",{key:1,class:he(y(d).e("main"))},[_t(o.$slots,"default")],2)):St("v-if",!0)],2))}});var Ooe=xn(Loe,[["__file","page-header.vue"]]);const Doe=Ao(Ooe),Mz=Symbol("elPaginationKey"),zoe=vn({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:Xr}}),Foe={click:e=>e instanceof MouseEvent},Boe=Ze({name:"ElPaginationPrev"}),Noe=Ze({...Boe,props:zoe,emits:Foe,setup(e){const t=e,{t:i}=vr(),s=te(()=>t.disabled||t.currentPage<=1);return(d,p)=>(le(),Pe("button",{type:"button",class:"btn-prev",disabled:y(s),"aria-label":d.prevText||y(i)("el.pagination.prev"),"aria-disabled":y(s),onClick:_=>d.$emit("click",_)},[d.prevText?(le(),Pe("span",{key:0},yn(d.prevText),1)):(le(),Rt(y(Gn),{key:1},{default:at(()=>[(le(),Rt(Wo(d.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var $oe=xn(Noe,[["__file","prev.vue"]]);const Voe=vn({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:Xr}}),Uoe=Ze({name:"ElPaginationNext"}),joe=Ze({...Uoe,props:Voe,emits:["click"],setup(e){const t=e,{t:i}=vr(),s=te(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(d,p)=>(le(),Pe("button",{type:"button",class:"btn-next",disabled:y(s),"aria-label":d.nextText||y(i)("el.pagination.next"),"aria-disabled":y(s),onClick:_=>d.$emit("click",_)},[d.nextText?(le(),Pe("span",{key:0},yn(d.nextText),1)):(le(),Rt(y(Gn),{key:1},{default:at(()=>[(le(),Rt(Wo(d.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var Hoe=xn(joe,[["__file","next.vue"]]);const Iz=Symbol("ElSelectGroup"),Jm=Symbol("ElSelect");function Goe(e,t){const i=Un(Jm),s=Un(Iz,{disabled:!1}),d=te(()=>M(ds(i.props.modelValue),e.value)),p=te(()=>{var B;if(i.props.multiple){const N=ds((B=i.props.modelValue)!=null?B:[]);return!d.value&&N.length>=i.props.multipleLimit&&i.props.multipleLimit>0}else return!1}),_=te(()=>e.label||(Vo(e.value)?"":e.value)),o=te(()=>e.value||e.label||""),w=te(()=>e.disabled||t.groupDisabled||p.value),C=jo(),M=(B=[],N)=>{if(Vo(e.value)){const D=i.props.valueKey;return B&&B.some(j=>ei(Ji(j,D))===Ji(N,D))}else return B&&B.includes(N)},I=()=>{!e.disabled&&!s.disabled&&(i.states.hoveringIndex=i.optionsArray.indexOf(C.proxy))},F=B=>{const N=new RegExp($T(B),"i");t.visible=N.test(_.value)||e.created};return tn(()=>_.value,()=>{!e.created&&!i.props.remote&&i.setSelected()}),tn(()=>e.value,(B,N)=>{const{remote:D,valueKey:j}=i.props;if(B!==N&&(i.onOptionDestroy(N,C.proxy),i.onOptionCreate(C.proxy)),!e.created&&!D){if(j&&Vo(B)&&Vo(N)&&B[j]===N[j])return;i.setSelected()}}),tn(()=>s.disabled,()=>{t.groupDisabled=s.disabled},{immediate:!0}),{select:i,currentLabel:_,currentValue:o,itemSelected:d,isDisabled:w,hoverItem:I,updateOption:F}}const Woe=Ze({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=rn("select"),i=Oa(),s=te(()=>[t.be("dropdown","item"),t.is("disabled",y(o)),t.is("selected",y(_)),t.is("hovering",y(F))]),d=Ir({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:p,itemSelected:_,isDisabled:o,select:w,hoverItem:C,updateOption:M}=Goe(e,d),{visible:I,hover:F}=Ca(d),B=jo().proxy;w.onOptionCreate(B),ni(()=>{const D=B.value,{selected:j}=w.states,U=j.some(ne=>ne.value===B.value);oo(()=>{w.states.cachedOptions.get(D)===B&&!U&&w.states.cachedOptions.delete(D)}),w.onOptionDestroy(D,B)});function N(){o.value||w.handleOptionSelect(B)}return{ns:t,id:i,containerKls:s,currentLabel:p,itemSelected:_,isDisabled:o,select:w,hoverItem:C,updateOption:M,visible:I,hover:F,selectOptionClick:N,states:d}}});function qoe(e,t,i,s,d,p){return zo((le(),Pe("li",{id:e.id,class:he(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:po(e.selectOptionClick,["stop"])},[_t(e.$slots,"default",{},()=>[Ve("span",null,yn(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[Cr,e.visible]])}var oC=xn(Woe,[["render",qoe],["__file","option.vue"]]);const Koe=Ze({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=Un(Jm),t=rn("select"),i=te(()=>e.props.popperClass),s=te(()=>e.props.multiple),d=te(()=>e.props.fitInputWidth),p=we("");function _(){var o;p.value=`${(o=e.selectRef)==null?void 0:o.offsetWidth}px`}return No(()=>{_(),Mi(e.selectRef,_)}),{ns:t,minWidth:p,popperClass:i,isMultiple:s,isFitInputWidth:d}}});function Zoe(e,t,i,s,d,p){return le(),Pe("div",{class:he([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:to({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(le(),Pe("div",{key:0,class:he(e.ns.be("dropdown","header"))},[_t(e.$slots,"header")],2)):St("v-if",!0),_t(e.$slots,"default"),e.$slots.footer?(le(),Pe("div",{key:1,class:he(e.ns.be("dropdown","footer"))},[_t(e.$slots,"footer")],2)):St("v-if",!0)],6)}var Yoe=xn(Koe,[["render",Zoe],["__file","select-dropdown.vue"]]);const Xoe=11,Joe=(e,t)=>{const{t:i}=vr(),s=Oa(),d=rn("select"),p=rn("input"),_=Ir({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),o=we(null),w=we(null),C=we(null),M=we(null),I=we(null),F=we(null),B=we(null),N=we(null),D=we(null),j=we(null),U=we(null),ne=we(null),{isComposing:K,handleCompositionStart:G,handleCompositionUpdate:J,handleCompositionEnd:oe}=H_({afterComposition:gt=>Io(gt)}),{wrapperRef:se,isFocused:me,handleBlur:de}=Lh(I,{beforeFocus(){return Ae.value},afterFocus(){e.automaticDropdown&&!ce.value&&(ce.value=!0,_.menuVisibleOnFocus=!0)},beforeBlur(gt){var Yt,In;return((Yt=C.value)==null?void 0:Yt.isFocusInsideContent(gt))||((In=M.value)==null?void 0:In.isFocusInsideContent(gt))},afterBlur(){ce.value=!1,_.menuVisibleOnFocus=!1}}),ce=we(!1),pe=we(),{form:ge,formItem:Re}=Ka(),{inputId:Je}=sc(e,{formItemContext:Re}),{valueOnClear:Me,isEmptyValue:xe}=m1(e),Ae=te(()=>e.disabled||(ge==null?void 0:ge.disabled)),Ce=te(()=>fn(e.modelValue)?e.modelValue.length>0:!xe(e.modelValue)),ve=te(()=>{var gt;return(gt=ge==null?void 0:ge.statusIcon)!=null?gt:!1}),Ne=te(()=>e.clearable&&!Ae.value&&_.inputHovering&&Ce.value),We=te(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),ot=te(()=>d.is("reverse",We.value&&ce.value)),Oe=te(()=>(Re==null?void 0:Re.validateState)||""),Ct=te(()=>y1[Oe.value]),Mt=te(()=>e.remote?300:0),zt=te(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!_.inputValue&&_.options.size===0?!1:e.filterable&&_.inputValue&&_.options.size>0&&bt.value===0?e.noMatchText||i("el.select.noMatch"):_.options.size===0?e.noDataText||i("el.select.noData"):null),bt=te(()=>Kt.value.filter(gt=>gt.visible).length),Kt=te(()=>{const gt=Array.from(_.options.values()),Yt=[];return _.optionValues.forEach(In=>{const ho=gt.findIndex(co=>co.value===In);ho>-1&&Yt.push(gt[ho])}),Yt.length>=gt.length?Yt:gt}),$t=te(()=>Array.from(_.cachedOptions.values())),Le=te(()=>{const gt=Kt.value.filter(Yt=>!Yt.created).some(Yt=>Yt.currentLabel===_.inputValue);return e.filterable&&e.allowCreate&&_.inputValue!==""&&!gt}),dn=()=>{e.filterable&&Qn(e.filterMethod)||e.filterable&&e.remote&&Qn(e.remoteMethod)||Kt.value.forEach(gt=>{var Yt;(Yt=gt.updateOption)==null||Yt.call(gt,_.inputValue)})},At=na(),Ke=te(()=>["small"].includes(At.value)?"small":"default"),Be=te({get(){return ce.value&&zt.value!==!1},set(gt){ce.value=gt}}),Ht=te(()=>{if(e.multiple&&!Hr(e.modelValue))return ds(e.modelValue).length===0&&!_.inputValue;const gt=fn(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||Hr(gt)?!_.inputValue:!0}),Ut=te(()=>{var gt;const Yt=(gt=e.placeholder)!=null?gt:i("el.select.placeholder");return e.multiple||!Ce.value?Yt:_.selectedLabel}),Nt=te(()=>E2?null:"mouseenter");tn(()=>e.modelValue,(gt,Yt)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(_.inputValue="",Et("")),ln(),!La(gt,Yt)&&e.validateEvent&&(Re==null||Re.validate("change").catch(In=>void 0))},{flush:"post",deep:!0}),tn(()=>ce.value,gt=>{gt?Et(_.inputValue):(_.inputValue="",_.previousQuery=null,_.isBeforeHide=!0),t("visible-change",gt)}),tn(()=>_.options.entries(),()=>{var gt;if(!gr)return;const Yt=((gt=o.value)==null?void 0:gt.querySelectorAll("input"))||[];(!e.filterable&&!e.defaultFirstOption&&!Hr(e.modelValue)||!Array.from(Yt).includes(document.activeElement))&&ln(),e.defaultFirstOption&&(e.filterable||e.remote)&&bt.value&&Gt()},{flush:"post"}),tn(()=>_.hoveringIndex,gt=>{ao(gt)&&gt>-1?pe.value=Kt.value[gt]||{}:pe.value={},Kt.value.forEach(Yt=>{Yt.hover=pe.value===Yt})}),Ha(()=>{_.isBeforeHide||dn()});const Et=gt=>{_.previousQuery===gt||K.value||(_.previousQuery=gt,e.filterable&&Qn(e.filterMethod)?e.filterMethod(gt):e.filterable&&e.remote&&Qn(e.remoteMethod)&&e.remoteMethod(gt),e.defaultFirstOption&&(e.filterable||e.remote)&&bt.value?oo(Gt):oo(_n))},Gt=()=>{const gt=Kt.value.filter(co=>co.visible&&!co.disabled&&!co.states.groupDisabled),Yt=gt.find(co=>co.created),In=gt[0],ho=Kt.value.map(co=>co.value);_.hoveringIndex=Mn(ho,Yt||In)},ln=()=>{if(e.multiple)_.selectedLabel="";else{const Yt=fn(e.modelValue)?e.modelValue[0]:e.modelValue,In=bn(Yt);_.selectedLabel=In.currentLabel,_.selected=[In];return}const gt=[];Hr(e.modelValue)||ds(e.modelValue).forEach(Yt=>{gt.push(bn(Yt))}),_.selected=gt},bn=gt=>{let Yt;const In=r_(gt);for(let Oo=_.cachedOptions.size-1;Oo>=0;Oo--){const Eo=$t.value[Oo];if(In?Ji(Eo.value,e.valueKey)===Ji(gt,e.valueKey):Eo.value===gt){Yt={value:gt,currentLabel:Eo.currentLabel,get isDisabled(){return Eo.isDisabled}};break}}if(Yt)return Yt;const ho=In?gt.label:gt??"";return{value:gt,currentLabel:ho}},_n=()=>{_.hoveringIndex=Kt.value.findIndex(gt=>_.selected.some(Yt=>qe(Yt)===qe(gt)))},jn=()=>{_.selectionWidth=w.value.getBoundingClientRect().width},yt=()=>{_.calculatorWidth=F.value.getBoundingClientRect().width},kn=()=>{_.collapseItemWidth=U.value.getBoundingClientRect().width},qn=()=>{var gt,Yt;(Yt=(gt=C.value)==null?void 0:gt.updatePopper)==null||Yt.call(gt)},Co=()=>{var gt,Yt;(Yt=(gt=M.value)==null?void 0:gt.updatePopper)==null||Yt.call(gt)},mo=()=>{_.inputValue.length>0&&!ce.value&&(ce.value=!0),Et(_.inputValue)},Io=gt=>{if(_.inputValue=gt.target.value,e.remote)Ho();else return mo()},Ho=il(()=>{mo()},Mt.value),ur=gt=>{La(e.modelValue,gt)||t(Yr,gt)},Dt=gt=>eO(gt,Yt=>{const In=_.cachedOptions.get(Yt);return In&&!In.disabled&&!In.states.groupDisabled}),En=gt=>{if(e.multiple&&gt.code!==Ln.delete&&gt.target.value.length<=0){const Yt=ds(e.modelValue).slice(),In=Dt(Yt);if(In<0)return;const ho=Yt[In];Yt.splice(In,1),t(Fo,Yt),ur(Yt),t("remove-tag",ho)}},ft=(gt,Yt)=>{const In=_.selected.indexOf(Yt);if(In>-1&&!Ae.value){const ho=ds(e.modelValue).slice();ho.splice(In,1),t(Fo,ho),ur(ho),t("remove-tag",Yt.value)}gt.stopPropagation(),Nr()},un=gt=>{gt.stopPropagation();const Yt=e.multiple?[]:Me.value;if(e.multiple)for(const In of _.selected)In.isDisabled&&Yt.push(In.value);t(Fo,Yt),ur(Yt),_.hoveringIndex=-1,ce.value=!1,t("clear"),Nr()},et=gt=>{var Yt;if(e.multiple){const In=ds((Yt=e.modelValue)!=null?Yt:[]).slice(),ho=Mn(In,gt);ho>-1?In.splice(ho,1):(e.multipleLimit<=0||In.length<e.multipleLimit)&&In.push(gt.value),t(Fo,In),ur(In),gt.created&&Et(""),e.filterable&&!e.reserveKeyword&&(_.inputValue="")}else t(Fo,gt.value),ur(gt.value),ce.value=!1;Nr(),!ce.value&&oo(()=>{Bn(gt)})},Mn=(gt=[],Yt)=>Hr(Yt)?-1:Vo(Yt.value)?gt.findIndex(In=>La(Ji(In,e.valueKey),qe(Yt))):gt.indexOf(Yt.value),Bn=gt=>{var Yt,In,ho,co,Oo;const Eo=fn(gt)?gt[0]:gt;let cr=null;if(Eo!=null&&Eo.value){const rr=Kt.value.filter(qo=>qo.value===Eo.value);rr.length>0&&(cr=rr[0].$el)}if(C.value&&cr){const rr=(co=(ho=(In=(Yt=C.value)==null?void 0:Yt.popperRef)==null?void 0:In.contentRef)==null?void 0:ho.querySelector)==null?void 0:co.call(ho,`.${d.be("dropdown","wrap")}`);rr&&gT(rr,cr)}(Oo=ne.value)==null||Oo.handleScroll()},Lo=gt=>{_.options.set(gt.value,gt),_.cachedOptions.set(gt.value,gt)},Rr=(gt,Yt)=>{_.options.get(gt)===Yt&&_.options.delete(gt)},hi=te(()=>{var gt,Yt;return(Yt=(gt=C.value)==null?void 0:gt.popperRef)==null?void 0:Yt.contentRef}),Er=()=>{_.isBeforeHide=!1,oo(()=>Bn(_.selected))},Nr=()=>{var gt;(gt=I.value)==null||gt.focus()},Xo=()=>{var gt;if(ce.value){ce.value=!1,oo(()=>{var Yt;return(Yt=I.value)==null?void 0:Yt.blur()});return}(gt=I.value)==null||gt.blur()},Bi=gt=>{un(gt)},$s=gt=>{if(ce.value=!1,me.value){const Yt=new FocusEvent("focus",gt);oo(()=>de(Yt))}},Zt=()=>{_.inputValue.length>0?_.inputValue="":ce.value=!1},Ee=()=>{Ae.value||(E2&&(_.inputHovering=!0),_.menuVisibleOnFocus?_.menuVisibleOnFocus=!1:ce.value=!ce.value)},ke=()=>{if(!ce.value)Ee();else{const gt=Kt.value[_.hoveringIndex];gt&&!gt.disabled&&!gt.states.groupDisabled&&et(gt)}},qe=gt=>Vo(gt.value)?Ji(gt.value,e.valueKey):gt.value,mt=te(()=>Kt.value.filter(gt=>gt.visible).every(gt=>gt.disabled)),it=te(()=>e.multiple?e.collapseTags?_.selected.slice(0,e.maxCollapseTags):_.selected:[]),xt=te(()=>e.multiple?e.collapseTags?_.selected.slice(e.maxCollapseTags):[]:[]),qt=gt=>{if(!ce.value){ce.value=!0;return}if(!(_.options.size===0||bt.value===0||K.value)&&!mt.value){gt==="next"?(_.hoveringIndex++,_.hoveringIndex===_.options.size&&(_.hoveringIndex=0)):gt==="prev"&&(_.hoveringIndex--,_.hoveringIndex<0&&(_.hoveringIndex=_.options.size-1));const Yt=Kt.value[_.hoveringIndex];(Yt.disabled===!0||Yt.states.groupDisabled===!0||!Yt.visible)&&qt(gt),oo(()=>Bn(pe.value))}},kt=()=>{if(!w.value)return 0;const gt=window.getComputedStyle(w.value);return Number.parseFloat(gt.gap||"6px")},Wt=te(()=>{const gt=kt();return{maxWidth:`${U.value&&e.maxCollapseTags===1?_.selectionWidth-_.collapseItemWidth-gt:_.selectionWidth}px`}}),Qt=te(()=>({maxWidth:`${_.selectionWidth}px`})),nn=te(()=>({width:`${Math.max(_.calculatorWidth,Xoe)}px`}));return Mi(w,jn),Mi(F,yt),Mi(D,qn),Mi(se,qn),Mi(j,Co),Mi(U,kn),No(()=>{ln()}),{inputId:Je,contentId:s,nsSelect:d,nsInput:p,states:_,isFocused:me,expanded:ce,optionsArray:Kt,hoverOption:pe,selectSize:At,filteredOptionsCount:bt,resetCalculatorWidth:yt,updateTooltip:qn,updateTagTooltip:Co,debouncedOnInputChange:Ho,onInput:Io,deletePrevTag:En,deleteTag:ft,deleteSelected:un,handleOptionSelect:et,scrollToOption:Bn,hasModelValue:Ce,shouldShowPlaceholder:Ht,currentPlaceholder:Ut,mouseEnterEventName:Nt,needStatusIcon:ve,showClose:Ne,iconComponent:We,iconReverse:ot,validateState:Oe,validateIcon:Ct,showNewOption:Le,updateOptions:dn,collapseTagSize:Ke,setSelected:ln,selectDisabled:Ae,emptyText:zt,handleCompositionStart:G,handleCompositionUpdate:J,handleCompositionEnd:oe,onOptionCreate:Lo,onOptionDestroy:Rr,handleMenuEnter:Er,focus:Nr,blur:Xo,handleClearClick:Bi,handleClickOutside:$s,handleEsc:Zt,toggleMenu:Ee,selectOption:ke,getValueKey:qe,navigateOptions:qt,dropdownMenuVisible:Be,showTagList:it,collapseTagList:xt,tagStyle:Wt,collapseTagStyle:Qt,inputStyle:nn,popperRef:hi,inputRef:I,tooltipRef:C,tagTooltipRef:M,calculatorRef:F,prefixRef:B,suffixRef:N,selectRef:o,wrapperRef:se,selectionRef:w,scrollbarRef:ne,menuRef:D,tagMenuRef:j,collapseItemRef:U}};var Qoe=Ze({name:"ElOptions",setup(e,{slots:t}){const i=Un(Jm);let s=[];return()=>{var d,p;const _=(d=t.default)==null?void 0:d.call(t),o=[];function w(C){fn(C)&&C.forEach(M=>{var I,F,B,N;const D=(I=(M==null?void 0:M.type)||{})==null?void 0:I.name;D==="ElOptionGroup"?w(!Zn(M.children)&&!fn(M.children)&&Qn((F=M.children)==null?void 0:F.default)?(B=M.children)==null?void 0:B.default():M.children):D==="ElOption"?o.push((N=M.props)==null?void 0:N.value):fn(M.children)&&w(M.children)})}return _.length&&w((p=_[0])==null?void 0:p.children),La(o,s)||(s=o,i&&(i.states.optionValues=o)),_}}});const ere=vn({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:ia,effect:{type:ut(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:wa.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Xr,default:pd},fitInputWidth:Boolean,suffixIcon:{type:Xr,default:fd},tagType:{...sd.type,default:"info"},tagEffect:{...sd.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:ut(String),values:md,default:"bottom-start"},fallbackPlacements:{type:ut(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:String,...Km,...Da(["ariaLabel"])}),VP="ElSelect",tre=Ze({name:VP,componentName:VP,components:{ElSelectMenu:Yoe,ElOption:oC,ElOptions:Qoe,ElTag:Rm,ElScrollbar:Ou,ElTooltip:qa,ElIcon:Gn},directives:{ClickOutside:ld},props:ere,emits:[Fo,Yr,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const i=te(()=>{const{modelValue:_,multiple:o}=e,w=o?[]:void 0;return fn(_)?o?_:w:o?w:_}),s=Ir({...Ca(e),modelValue:i}),d=Joe(s,t);or(Jm,Ir({props:s,states:d.states,optionsArray:d.optionsArray,handleOptionSelect:d.handleOptionSelect,onOptionCreate:d.onOptionCreate,onOptionDestroy:d.onOptionDestroy,selectRef:d.selectRef,setSelected:d.setSelected}));const p=te(()=>e.multiple?d.states.selected.map(_=>_.currentLabel):d.states.selectedLabel);return{...d,modelValue:i,selectedLabel:p}}});function nre(e,t,i,s,d,p){const _=Go("el-tag"),o=Go("el-tooltip"),w=Go("el-icon"),C=Go("el-option"),M=Go("el-options"),I=Go("el-scrollbar"),F=Go("el-select-menu"),B=o1("click-outside");return zo((le(),Pe("div",{ref:"selectRef",class:he([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[Hv(e.mouseEnterEventName)]:N=>e.states.inputHovering=!0,onMouseleave:N=>e.states.inputHovering=!1},[Qe(o,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:N=>e.states.isBeforeHide=!1},{default:at(()=>{var N;return[Ve("div",{ref:"wrapperRef",class:he([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:po(e.toggleMenu,["prevent"])},[e.$slots.prefix?(le(),Pe("div",{key:0,ref:"prefixRef",class:he(e.nsSelect.e("prefix"))},[_t(e.$slots,"prefix")],2)):St("v-if",!0),Ve("div",{ref:"selectionRef",class:he([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?_t(e.$slots,"tag",{key:0},()=>[(le(!0),Pe(eo,null,nr(e.showTagList,D=>(le(),Pe("div",{key:e.getValueKey(D),class:he(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!e.selectDisabled&&!D.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:to(e.tagStyle),onClose:j=>e.deleteTag(j,D)},{default:at(()=>[Ve("span",{class:he(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:D.currentLabel,value:D.value},()=>[Qo(yn(D.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(le(),Rt(o,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:at(()=>[Ve("div",{ref:"collapseItemRef",class:he(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:to(e.collapseTagStyle)},{default:at(()=>[Ve("span",{class:he(e.nsSelect.e("tags-text"))}," + "+yn(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:at(()=>[Ve("div",{ref:"tagMenuRef",class:he(e.nsSelect.e("selection"))},[(le(!0),Pe(eo,null,nr(e.collapseTagList,D=>(le(),Pe("div",{key:e.getValueKey(D),class:he(e.nsSelect.e("selected-item"))},[Qe(_,{class:"in-tooltip",closable:!e.selectDisabled&&!D.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:j=>e.deleteTag(j,D)},{default:at(()=>[Ve("span",{class:he(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:D.currentLabel,value:D.value},()=>[Qo(yn(D.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):St("v-if",!0)]):St("v-if",!0),Ve("div",{class:he([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[zo(Ve("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":D=>e.states.inputValue=D,type:"text",name:e.name,class:he([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:to(e.inputStyle),tabindex:e.tabindex,role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((N=e.hoverOption)==null?void 0:N.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[ti(po(D=>e.navigateOptions("next"),["stop","prevent"]),["down"]),ti(po(D=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),ti(po(e.handleEsc,["stop","prevent"]),["esc"]),ti(po(e.selectOption,["stop","prevent"]),["enter"]),ti(po(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:po(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[a1,e.states.inputValue]]),e.filterable?(le(),Pe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:he(e.nsSelect.e("input-calculator")),textContent:yn(e.states.inputValue)},null,10,["textContent"])):St("v-if",!0)],2),e.shouldShowPlaceholder?(le(),Pe("div",{key:1,class:he([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?_t(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ve("span",null,yn(e.currentPlaceholder),1)]):(le(),Pe("span",{key:1},yn(e.currentPlaceholder),1))],2)):St("v-if",!0)],2),Ve("div",{ref:"suffixRef",class:he(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(le(),Rt(w,{key:0,class:he([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:at(()=>[(le(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])):St("v-if",!0),e.showClose&&e.clearIcon?(le(),Rt(w,{key:1,class:he([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:at(()=>[(le(),Rt(Wo(e.clearIcon)))]),_:1},8,["class","onClick"])):St("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(le(),Rt(w,{key:2,class:he([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:at(()=>[(le(),Rt(Wo(e.validateIcon)))]),_:1},8,["class"])):St("v-if",!0)],2)],10,["onClick"])]}),content:at(()=>[Qe(F,{ref:"menuRef"},{default:at(()=>[e.$slots.header?(le(),Pe("div",{key:0,class:he(e.nsSelect.be("dropdown","header")),onClick:po(()=>{},["stop"])},[_t(e.$slots,"header")],10,["onClick"])):St("v-if",!0),zo(Qe(I,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:he([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:at(()=>[e.showNewOption?(le(),Rt(C,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):St("v-if",!0),Qe(M,null,{default:at(()=>[_t(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[Cr,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(le(),Pe("div",{key:1,class:he(e.nsSelect.be("dropdown","loading"))},[_t(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(le(),Pe("div",{key:2,class:he(e.nsSelect.be("dropdown","empty"))},[_t(e.$slots,"empty",{},()=>[Ve("span",null,yn(e.emptyText),1)])],2)):St("v-if",!0),e.$slots.footer?(le(),Pe("div",{key:3,class:he(e.nsSelect.be("dropdown","footer")),onClick:po(()=>{},["stop"])},[_t(e.$slots,"footer")],10,["onClick"])):St("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[B,e.handleClickOutside,e.popperRef]])}var ore=xn(tre,[["render",nre],["__file","select.vue"]]);const rre=Ze({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=rn("select"),i=we(null),s=jo(),d=we([]);or(Iz,Ir({...Ca(e)}));const p=te(()=>d.value.some(C=>C.visible===!0)),_=C=>{var M,I;return((M=C.type)==null?void 0:M.name)==="ElOption"&&!!((I=C.component)!=null&&I.proxy)},o=C=>{const M=ds(C),I=[];return M.forEach(F=>{var B,N;_(F)?I.push(F.component.proxy):(B=F.children)!=null&&B.length?I.push(...o(F.children)):(N=F.component)!=null&&N.subTree&&I.push(...o(F.component.subTree))}),I},w=()=>{d.value=o(s.subTree)};return No(()=>{w()}),sO(i,w,{attributes:!0,subtree:!0,childList:!0}),{groupRef:i,visible:p,ns:t}}});function ire(e,t,i,s,d,p){return zo((le(),Pe("ul",{ref:"groupRef",class:he(e.ns.be("group","wrap"))},[Ve("li",{class:he(e.ns.be("group","title"))},yn(e.label),3),Ve("li",null,[Ve("ul",{class:he(e.ns.b("group"))},[_t(e.$slots,"default")],2)])],2)),[[Cr,e.visible]])}var Az=xn(rre,[["render",ire],["__file","option-group.vue"]]);const Wf=Ao(ore,{Option:oC,OptionGroup:Az}),Lb=Li(oC),are=Li(Az),rC=()=>Un(Mz,{}),sre=vn({pageSize:{type:Number,required:!0},pageSizes:{type:ut(Array),default:()=>Ri([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:Lu},appendSizeTo:String}),lre=Ze({name:"ElPaginationSizes"}),cre=Ze({...lre,props:sre,emits:["page-size-change"],setup(e,{emit:t}){const i=e,{t:s}=vr(),d=rn("pagination"),p=rC(),_=we(i.pageSize);tn(()=>i.pageSizes,(C,M)=>{if(!La(C,M)&&fn(C)){const I=C.includes(i.pageSize)?i.pageSize:i.pageSizes[0];t("page-size-change",I)}}),tn(()=>i.pageSize,C=>{_.value=C});const o=te(()=>i.pageSizes);function w(C){var M;C!==_.value&&(_.value=C,(M=p.handleSizeChange)==null||M.call(p,Number(C)))}return(C,M)=>(le(),Pe("span",{class:he(y(d).e("sizes"))},[Qe(y(Wf),{"model-value":_.value,disabled:C.disabled,"popper-class":C.popperClass,size:C.size,teleported:C.teleported,"validate-event":!1,"append-to":C.appendSizeTo,onChange:w},{default:at(()=>[(le(!0),Pe(eo,null,nr(y(o),I=>(le(),Rt(y(Lb),{key:I,value:I,label:I+y(s)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var ure=xn(cre,[["__file","sizes.vue"]]);const dre=vn({size:{type:String,values:Lu}}),hre=Ze({name:"ElPaginationJumper"}),fre=Ze({...hre,props:dre,setup(e){const{t}=vr(),i=rn("pagination"),{pageCount:s,disabled:d,currentPage:p,changeEvent:_}=rC(),o=we(),w=te(()=>{var I;return(I=o.value)!=null?I:p==null?void 0:p.value});function C(I){o.value=I?+I:""}function M(I){I=Math.trunc(+I),_==null||_(I),o.value=void 0}return(I,F)=>(le(),Pe("span",{class:he(y(i).e("jump")),disabled:y(d)},[Ve("span",{class:he([y(i).e("goto")])},yn(y(t)("el.pagination.goto")),3),Qe(y(fs),{size:I.size,class:he([y(i).e("editor"),y(i).is("in-pagination")]),min:1,max:y(s),disabled:y(d),"model-value":y(w),"validate-event":!1,"aria-label":y(t)("el.pagination.page"),type:"number","onUpdate:modelValue":C,onChange:M},null,8,["size","class","max","disabled","model-value","aria-label"]),Ve("span",{class:he([y(i).e("classifier")])},yn(y(t)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var pre=xn(fre,[["__file","jumper.vue"]]);const mre=vn({total:{type:Number,default:1e3}}),gre=Ze({name:"ElPaginationTotal"}),vre=Ze({...gre,props:mre,setup(e){const{t}=vr(),i=rn("pagination"),{disabled:s}=rC();return(d,p)=>(le(),Pe("span",{class:he(y(i).e("total")),disabled:y(s)},yn(y(t)("el.pagination.total",{total:d.total})),11,["disabled"]))}});var _re=xn(vre,[["__file","total.vue"]]);const yre=vn({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),bre=Ze({name:"ElPaginationPager"}),xre=Ze({...bre,props:yre,emits:["change"],setup(e,{emit:t}){const i=e,s=rn("pager"),d=rn("icon"),{t:p}=vr(),_=we(!1),o=we(!1),w=we(!1),C=we(!1),M=we(!1),I=we(!1),F=te(()=>{const G=i.pagerCount,J=(G-1)/2,oe=Number(i.currentPage),se=Number(i.pageCount);let me=!1,de=!1;se>G&&(oe>G-J&&(me=!0),oe<se-J&&(de=!0));const ce=[];if(me&&!de){const pe=se-(G-2);for(let ge=pe;ge<se;ge++)ce.push(ge)}else if(!me&&de)for(let pe=2;pe<G;pe++)ce.push(pe);else if(me&&de){const pe=Math.floor(G/2)-1;for(let ge=oe-pe;ge<=oe+pe;ge++)ce.push(ge)}else for(let pe=2;pe<se;pe++)ce.push(pe);return ce}),B=te(()=>["more","btn-quickprev",d.b(),s.is("disabled",i.disabled)]),N=te(()=>["more","btn-quicknext",d.b(),s.is("disabled",i.disabled)]),D=te(()=>i.disabled?-1:0);Ha(()=>{const G=(i.pagerCount-1)/2;_.value=!1,o.value=!1,i.pageCount>i.pagerCount&&(i.currentPage>i.pagerCount-G&&(_.value=!0),i.currentPage<i.pageCount-G&&(o.value=!0))});function j(G=!1){i.disabled||(G?w.value=!0:C.value=!0)}function U(G=!1){G?M.value=!0:I.value=!0}function ne(G){const J=G.target;if(J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("number")){const oe=Number(J.textContent);oe!==i.currentPage&&t("change",oe)}else J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("more")&&K(G)}function K(G){const J=G.target;if(J.tagName.toLowerCase()==="ul"||i.disabled)return;let oe=Number(J.textContent);const se=i.pageCount,me=i.currentPage,de=i.pagerCount-2;J.className.includes("more")&&(J.className.includes("quickprev")?oe=me-de:J.className.includes("quicknext")&&(oe=me+de)),Number.isNaN(+oe)||(oe<1&&(oe=1),oe>se&&(oe=se)),oe!==me&&t("change",oe)}return(G,J)=>(le(),Pe("ul",{class:he(y(s).b()),onClick:K,onKeyup:ti(ne,["enter"])},[G.pageCount>0?(le(),Pe("li",{key:0,class:he([[y(s).is("active",G.currentPage===1),y(s).is("disabled",G.disabled)],"number"]),"aria-current":G.currentPage===1,"aria-label":y(p)("el.pagination.currentPage",{pager:1}),tabindex:y(D)}," 1 ",10,["aria-current","aria-label","tabindex"])):St("v-if",!0),_.value?(le(),Pe("li",{key:1,class:he(y(B)),tabindex:y(D),"aria-label":y(p)("el.pagination.prevPages",{pager:G.pagerCount-2}),onMouseenter:oe=>j(!0),onMouseleave:oe=>w.value=!1,onFocus:oe=>U(!0),onBlur:oe=>M.value=!1},[(w.value||M.value)&&!G.disabled?(le(),Rt(y(Th),{key:0})):(le(),Rt(y($k),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):St("v-if",!0),(le(!0),Pe(eo,null,nr(y(F),oe=>(le(),Pe("li",{key:oe,class:he([[y(s).is("active",G.currentPage===oe),y(s).is("disabled",G.disabled)],"number"]),"aria-current":G.currentPage===oe,"aria-label":y(p)("el.pagination.currentPage",{pager:oe}),tabindex:y(D)},yn(oe),11,["aria-current","aria-label","tabindex"]))),128)),o.value?(le(),Pe("li",{key:2,class:he(y(N)),tabindex:y(D),"aria-label":y(p)("el.pagination.nextPages",{pager:G.pagerCount-2}),onMouseenter:oe=>j(),onMouseleave:oe=>C.value=!1,onFocus:oe=>U(),onBlur:oe=>I.value=!1},[(C.value||I.value)&&!G.disabled?(le(),Rt(y(Ch),{key:0})):(le(),Rt(y($k),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):St("v-if",!0),G.pageCount>1?(le(),Pe("li",{key:3,class:he([[y(s).is("active",G.currentPage===G.pageCount),y(s).is("disabled",G.disabled)],"number"]),"aria-current":G.currentPage===G.pageCount,"aria-label":y(p)("el.pagination.currentPage",{pager:G.pageCount}),tabindex:y(D)},yn(G.pageCount),11,["aria-current","aria-label","tabindex"])):St("v-if",!0)],42,["onKeyup"]))}});var wre=xn(xre,[["__file","pager.vue"]]);const Is=e=>typeof e!="number",Sre=vn({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>ao(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:ut(Array),default:()=>Ri([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:Xr,default:()=>Sh},nextText:{type:String,default:""},nextIcon:{type:Xr,default:()=>zs},teleported:{type:Boolean,default:!0},small:Boolean,size:ia,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),Tre={"update:current-page":e=>ao(e),"update:page-size":e=>ao(e),"size-change":e=>ao(e),change:(e,t)=>ao(e)&&ao(t),"current-change":e=>ao(e),"prev-click":e=>ao(e),"next-click":e=>ao(e)},UP="ElPagination";var Cre=Ze({name:UP,props:Sre,emits:Tre,setup(e,{emit:t,slots:i}){const{t:s}=vr(),d=rn("pagination"),p=jo().vnode.props||{},_=pO(),o=te(()=>{var J;return e.small?"small":(J=e.size)!=null?J:_.value});mh({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},te(()=>!!e.small));const w="onUpdate:currentPage"in p||"onUpdate:current-page"in p||"onCurrentChange"in p,C="onUpdate:pageSize"in p||"onUpdate:page-size"in p||"onSizeChange"in p,M=te(()=>{if(Is(e.total)&&Is(e.pageCount)||!Is(e.currentPage)&&!w)return!1;if(e.layout.includes("sizes")){if(Is(e.pageCount)){if(!Is(e.total)&&!Is(e.pageSize)&&!C)return!1}else if(!C)return!1}return!0}),I=we(Is(e.defaultPageSize)?10:e.defaultPageSize),F=we(Is(e.defaultCurrentPage)?1:e.defaultCurrentPage),B=te({get(){return Is(e.pageSize)?I.value:e.pageSize},set(J){Is(e.pageSize)&&(I.value=J),C&&(t("update:page-size",J),t("size-change",J))}}),N=te(()=>{let J=0;return Is(e.pageCount)?Is(e.total)||(J=Math.max(1,Math.ceil(e.total/B.value))):J=e.pageCount,J}),D=te({get(){return Is(e.currentPage)?F.value:e.currentPage},set(J){let oe=J;J<1?oe=1:J>N.value&&(oe=N.value),Is(e.currentPage)&&(F.value=oe),w&&(t("update:current-page",oe),t("current-change",oe))}});tn(N,J=>{D.value>J&&(D.value=J)}),tn([D,B],J=>{t("change",...J)},{flush:"post"});function j(J){D.value=J}function U(J){B.value=J;const oe=N.value;D.value>oe&&(D.value=oe)}function ne(){e.disabled||(D.value-=1,t("prev-click",D.value))}function K(){e.disabled||(D.value+=1,t("next-click",D.value))}function G(J,oe){J&&(J.props||(J.props={}),J.props.class=[J.props.class,oe].join(" "))}return or(Mz,{pageCount:N,disabled:te(()=>e.disabled),currentPage:D,changeEvent:j,handleSizeChange:U}),()=>{var J,oe;if(!M.value)return s("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&N.value<=1)return null;const se=[],me=[],de=lo("div",{class:d.e("rightwrapper")},me),ce={prev:lo($oe,{disabled:e.disabled,currentPage:D.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:ne}),jumper:lo(pre,{size:o.value}),pager:lo(wre,{currentPage:D.value,pageCount:N.value,pagerCount:e.pagerCount,onChange:j,disabled:e.disabled}),next:lo(Hoe,{disabled:e.disabled,currentPage:D.value,pageCount:N.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:K}),sizes:lo(ure,{pageSize:B.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:o.value,appendSizeTo:e.appendSizeTo}),slot:(oe=(J=i==null?void 0:i.default)==null?void 0:J.call(i))!=null?oe:null,total:lo(_re,{total:Is(e.total)?0:e.total})},pe=e.layout.split(",").map(Re=>Re.trim());let ge=!1;return pe.forEach(Re=>{if(Re==="->"){ge=!0;return}ge?me.push(ce[Re]):se.push(ce[Re])}),G(se[0],d.is("first")),G(se[se.length-1],d.is("last")),ge&&me.length>0&&(G(me[0],d.is("first")),G(me[me.length-1],d.is("last")),se.push(de)),lo("div",{class:[d.b(),d.is("background",e.background),d.m(o.value)]},se)}}});const Ere=Ao(Cre),Mre=vn({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:A2,default:"primary"},cancelButtonType:{type:String,values:A2,default:"text"},icon:{type:Xr,default:()=>yq},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:wa.teleported,persistent:wa.persistent,width:{type:[String,Number],default:150}}),Ire={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},Are=Ze({name:"ElPopconfirm"}),kre=Ze({...Are,props:Mre,emits:Ire,setup(e,{emit:t}){const i=e,{t:s}=vr(),d=rn("popconfirm"),p=we(),_=()=>{var F,B;(B=(F=p.value)==null?void 0:F.onClose)==null||B.call(F)},o=te(()=>({width:ji(i.width)})),w=F=>{t("confirm",F),_()},C=F=>{t("cancel",F),_()},M=te(()=>i.confirmButtonText||s("el.popconfirm.confirmButtonText")),I=te(()=>i.cancelButtonText||s("el.popconfirm.cancelButtonText"));return(F,B)=>(le(),Rt(y(qa),Yo({ref_key:"tooltipRef",ref:p,trigger:"click",effect:"light"},F.$attrs,{"popper-class":`${y(d).namespace.value}-popover`,"popper-style":y(o),teleported:F.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":F.hideAfter,persistent:F.persistent}),{content:at(()=>[Ve("div",{class:he(y(d).b())},[Ve("div",{class:he(y(d).e("main"))},[!F.hideIcon&&F.icon?(le(),Rt(y(Gn),{key:0,class:he(y(d).e("icon")),style:to({color:F.iconColor})},{default:at(()=>[(le(),Rt(Wo(F.icon)))]),_:1},8,["class","style"])):St("v-if",!0),Qo(" "+yn(F.title),1)],2),Ve("div",{class:he(y(d).e("action"))},[_t(F.$slots,"actions",{confirm:w,cancel:C},()=>[Qe(y(Ta),{size:"small",type:F.cancelButtonType==="text"?"":F.cancelButtonType,text:F.cancelButtonType==="text",onClick:C},{default:at(()=>[Qo(yn(y(I)),1)]),_:1},8,["type","text"]),Qe(y(Ta),{size:"small",type:F.confirmButtonType==="text"?"":F.confirmButtonType,text:F.confirmButtonType==="text",onClick:w},{default:at(()=>[Qo(yn(y(M)),1)]),_:1},8,["type","text"])])],2)],2)]),default:at(()=>[F.$slots.reference?_t(F.$slots,"reference",{key:0}):St("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var Pre=xn(kre,[["__file","popconfirm.vue"]]);const Rre=Ao(Pre),Lre=vn({trigger:y_.trigger,placement:tb.placement,disabled:y_.disabled,visible:wa.visible,transition:wa.transition,popperOptions:tb.popperOptions,tabindex:tb.tabindex,content:wa.content,popperStyle:wa.popperStyle,popperClass:wa.popperClass,enterable:{...wa.enterable,default:!0},effect:{...wa.effect,default:"light"},teleported:wa.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),Ore={"update:visible":e=>ai(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},Dre="onUpdate:visible",zre=Ze({name:"ElPopover"}),Fre=Ze({...zre,props:Lre,emits:Ore,setup(e,{expose:t,emit:i}){const s=e,d=te(()=>s[Dre]),p=rn("popover"),_=we(),o=te(()=>{var j;return(j=y(_))==null?void 0:j.popperRef}),w=te(()=>[{width:ji(s.width)},s.popperStyle]),C=te(()=>[p.b(),s.popperClass,{[p.m("plain")]:!!s.content}]),M=te(()=>s.transition===`${p.namespace.value}-fade-in-linear`),I=()=>{var j;(j=_.value)==null||j.hide()},F=()=>{i("before-enter")},B=()=>{i("before-leave")},N=()=>{i("after-enter")},D=()=>{i("update:visible",!1),i("after-leave")};return t({popperRef:o,hide:I}),(j,U)=>(le(),Rt(y(qa),Yo({ref_key:"tooltipRef",ref:_},j.$attrs,{trigger:j.trigger,placement:j.placement,disabled:j.disabled,visible:j.visible,transition:j.transition,"popper-options":j.popperOptions,tabindex:j.tabindex,content:j.content,offset:j.offset,"show-after":j.showAfter,"hide-after":j.hideAfter,"auto-close":j.autoClose,"show-arrow":j.showArrow,"aria-label":j.title,effect:j.effect,enterable:j.enterable,"popper-class":y(C),"popper-style":y(w),teleported:j.teleported,persistent:j.persistent,"gpu-acceleration":y(M),"onUpdate:visible":y(d),onBeforeShow:F,onBeforeHide:B,onShow:N,onHide:D}),{content:at(()=>[j.title?(le(),Pe("div",{key:0,class:he(y(p).e("title")),role:"title"},yn(j.title),3)):St("v-if",!0),_t(j.$slots,"default",{},()=>[Qo(yn(j.content),1)])]),default:at(()=>[j.$slots.reference?_t(j.$slots,"reference",{key:0}):St("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var Bre=xn(Fre,[["__file","popover.vue"]]);const jP=(e,t)=>{const i=t.arg||t.value,s=i==null?void 0:i.popperRef;s&&(s.triggerRef=e)};var Nre={mounted(e,t){jP(e,t)},updated(e,t){jP(e,t)}};const $re="popover",kz=MW(Nre,$re),Vre=Ao(Bre,{directive:kz}),Ure=vn({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:ut(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:ut([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:ut(Function),default:e=>`${e}%`}}),jre=Ze({name:"ElProgress"}),Hre=Ze({...jre,props:Ure,setup(e){const t=e,i={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},s=rn("progress"),d=te(()=>{const K={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},G=ne(t.percentage);return G.includes("gradient")?K.background=G:K.backgroundColor=G,K}),p=te(()=>(t.strokeWidth/t.width*100).toFixed(1)),_=te(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(p.value)/2}`,10):0),o=te(()=>{const K=_.value,G=t.type==="dashboard";return`
          M 50 50
          m 0 ${G?"":"-"}${K}
          a ${K} ${K} 0 1 1 0 ${G?"-":""}${K*2}
          a ${K} ${K} 0 1 1 0 ${G?"":"-"}${K*2}
          `}),w=te(()=>2*Math.PI*_.value),C=te(()=>t.type==="dashboard"?.75:1),M=te(()=>`${-1*w.value*(1-C.value)/2}px`),I=te(()=>({strokeDasharray:`${w.value*C.value}px, ${w.value}px`,strokeDashoffset:M.value})),F=te(()=>({strokeDasharray:`${w.value*C.value*(t.percentage/100)}px, ${w.value}px`,strokeDashoffset:M.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),B=te(()=>{let K;return t.color?K=ne(t.percentage):K=i[t.status]||i.default,K}),N=te(()=>t.status==="warning"?_1:t.type==="line"?t.status==="success"?_T:pd:t.status==="success"?U_:Xc),D=te(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),j=te(()=>t.format(t.percentage));function U(K){const G=100/K.length;return K.map((oe,se)=>Zn(oe)?{color:oe,percentage:(se+1)*G}:oe).sort((oe,se)=>oe.percentage-se.percentage)}const ne=K=>{var G;const{color:J}=t;if(Qn(J))return J(K);if(Zn(J))return J;{const oe=U(J);for(const se of oe)if(se.percentage>K)return se.color;return(G=oe[oe.length-1])==null?void 0:G.color}};return(K,G)=>(le(),Pe("div",{class:he([y(s).b(),y(s).m(K.type),y(s).is(K.status),{[y(s).m("without-text")]:!K.showText,[y(s).m("text-inside")]:K.textInside}]),role:"progressbar","aria-valuenow":K.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[K.type==="line"?(le(),Pe("div",{key:0,class:he(y(s).b("bar"))},[Ve("div",{class:he(y(s).be("bar","outer")),style:to({height:`${K.strokeWidth}px`})},[Ve("div",{class:he([y(s).be("bar","inner"),{[y(s).bem("bar","inner","indeterminate")]:K.indeterminate},{[y(s).bem("bar","inner","striped")]:K.striped},{[y(s).bem("bar","inner","striped-flow")]:K.stripedFlow}]),style:to(y(d))},[(K.showText||K.$slots.default)&&K.textInside?(le(),Pe("div",{key:0,class:he(y(s).be("bar","innerText"))},[_t(K.$slots,"default",{percentage:K.percentage},()=>[Ve("span",null,yn(y(j)),1)])],2)):St("v-if",!0)],6)],6)],2)):(le(),Pe("div",{key:1,class:he(y(s).b("circle")),style:to({height:`${K.width}px`,width:`${K.width}px`})},[(le(),Pe("svg",{viewBox:"0 0 100 100"},[Ve("path",{class:he(y(s).be("circle","track")),d:y(o),stroke:`var(${y(s).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":K.strokeLinecap,"stroke-width":y(p),fill:"none",style:to(y(I))},null,14,["d","stroke","stroke-linecap","stroke-width"]),Ve("path",{class:he(y(s).be("circle","path")),d:y(o),stroke:y(B),fill:"none",opacity:K.percentage?1:0,"stroke-linecap":K.strokeLinecap,"stroke-width":y(p),style:to(y(F))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(K.showText||K.$slots.default)&&!K.textInside?(le(),Pe("div",{key:2,class:he(y(s).e("text")),style:to({fontSize:`${y(D)}px`})},[_t(K.$slots,"default",{percentage:K.percentage},()=>[K.status?(le(),Rt(y(Gn),{key:1},{default:at(()=>[(le(),Rt(Wo(y(N))))]),_:1})):(le(),Pe("span",{key:0},yn(y(j)),1))])],6)):St("v-if",!0)],10,["aria-valuenow"]))}});var Gre=xn(Hre,[["__file","progress.vue"]]);const Pz=Ao(Gre),Wre=vn({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:ut([Array,Object]),default:()=>Ri(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:ut([Array,Object]),default:()=>[k0,k0,k0]},voidIcon:{type:Xr,default:()=>Oq},disabledVoidIcon:{type:Xr,default:()=>k0},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:ut(Array),default:()=>Ri(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:ia,clearable:Boolean,...Da(["ariaLabel"])}),qre={[Yr]:e=>ao(e),[Fo]:e=>ao(e)},Kre=Ze({name:"ElRate"}),Zre=Ze({...Kre,props:Wre,emits:qre,setup(e,{expose:t,emit:i}){const s=e;function d(xe,Ae){const Ce=We=>Vo(We),ve=Object.keys(Ae).map(We=>+We).filter(We=>{const ot=Ae[We];return(Ce(ot)?ot.excluded:!1)?xe<We:xe<=We}).sort((We,ot)=>We-ot),Ne=Ae[ve[0]];return Ce(Ne)&&Ne.value||Ne}const p=Un(Qf,void 0),_=Un(Au,void 0),o=na(),w=rn("rate"),{inputId:C,isLabeledByFormItem:M}=sc(s,{formItemContext:_}),I=we(s.modelValue),F=we(-1),B=we(!0),N=te(()=>[w.b(),w.m(o.value)]),D=te(()=>s.disabled||(p==null?void 0:p.disabled)),j=te(()=>w.cssVarBlock({"void-color":s.voidColor,"disabled-void-color":s.disabledVoidColor,"fill-color":G.value})),U=te(()=>{let xe="";return s.showScore?xe=s.scoreTemplate.replace(/\{\s*value\s*\}/,D.value?`${s.modelValue}`:`${I.value}`):s.showText&&(xe=s.texts[Math.ceil(I.value)-1]),xe}),ne=te(()=>s.modelValue*100-Math.floor(s.modelValue)*100),K=te(()=>fn(s.colors)?{[s.lowThreshold]:s.colors[0],[s.highThreshold]:{value:s.colors[1],excluded:!0},[s.max]:s.colors[2]}:s.colors),G=te(()=>{const xe=d(I.value,K.value);return Vo(xe)?"":xe}),J=te(()=>{let xe="";return D.value?xe=`${ne.value}%`:s.allowHalf&&(xe="50%"),{color:G.value,width:xe}}),oe=te(()=>{let xe=fn(s.icons)?[...s.icons]:{...s.icons};return xe=ph(xe),fn(xe)?{[s.lowThreshold]:xe[0],[s.highThreshold]:{value:xe[1],excluded:!0},[s.max]:xe[2]}:xe}),se=te(()=>d(s.modelValue,oe.value)),me=te(()=>D.value?Zn(s.disabledVoidIcon)?s.disabledVoidIcon:ph(s.disabledVoidIcon):Zn(s.voidIcon)?s.voidIcon:ph(s.voidIcon)),de=te(()=>d(I.value,oe.value));function ce(xe){const Ae=D.value&&ne.value>0&&xe-1<s.modelValue&&xe>s.modelValue,Ce=s.allowHalf&&B.value&&xe-.5<=I.value&&xe>I.value;return Ae||Ce}function pe(xe){s.clearable&&xe===s.modelValue&&(xe=0),i(Fo,xe),s.modelValue!==xe&&i("change",xe)}function ge(xe){D.value||(s.allowHalf&&B.value?pe(I.value):pe(xe))}function Re(xe){if(D.value)return;let Ae=I.value;const Ce=xe.code;return Ce===Ln.up||Ce===Ln.right?(s.allowHalf?Ae+=.5:Ae+=1,xe.stopPropagation(),xe.preventDefault()):(Ce===Ln.left||Ce===Ln.down)&&(s.allowHalf?Ae-=.5:Ae-=1,xe.stopPropagation(),xe.preventDefault()),Ae=Ae<0?0:Ae,Ae=Ae>s.max?s.max:Ae,i(Fo,Ae),i("change",Ae),Ae}function Je(xe,Ae){if(!D.value){if(s.allowHalf&&Ae){let Ce=Ae.target;nl(Ce,w.e("item"))&&(Ce=Ce.querySelector(`.${w.e("icon")}`)),(Ce.clientWidth===0||nl(Ce,w.e("decimal")))&&(Ce=Ce.parentNode),B.value=Ae.offsetX*2<=Ce.clientWidth,I.value=B.value?xe-.5:xe}else I.value=xe;F.value=xe}}function Me(){D.value||(s.allowHalf&&(B.value=s.modelValue!==Math.floor(s.modelValue)),I.value=s.modelValue,F.value=-1)}return tn(()=>s.modelValue,xe=>{I.value=xe,B.value=s.modelValue!==Math.floor(s.modelValue)}),s.modelValue||i(Fo,0),t({setCurrentValue:Je,resetCurrentValue:Me}),(xe,Ae)=>{var Ce;return le(),Pe("div",{id:y(C),class:he([y(N),y(w).is("disabled",y(D))]),role:"slider","aria-label":y(M)?void 0:xe.ariaLabel||"rating","aria-labelledby":y(M)?(Ce=y(_))==null?void 0:Ce.labelId:void 0,"aria-valuenow":I.value,"aria-valuetext":y(U)||void 0,"aria-valuemin":"0","aria-valuemax":xe.max,tabindex:"0",style:to(y(j)),onKeydown:Re},[(le(!0),Pe(eo,null,nr(xe.max,(ve,Ne)=>(le(),Pe("span",{key:Ne,class:he(y(w).e("item")),onMousemove:We=>Je(ve,We),onMouseleave:Me,onClick:We=>ge(ve)},[Qe(y(Gn),{class:he([y(w).e("icon"),{hover:F.value===ve},y(w).is("active",ve<=I.value)])},{default:at(()=>[ce(ve)?St("v-if",!0):(le(),Pe(eo,{key:0},[zo((le(),Rt(Wo(y(de)),null,null,512)),[[Cr,ve<=I.value]]),zo((le(),Rt(Wo(y(me)),null,null,512)),[[Cr,!(ve<=I.value)]])],64)),ce(ve)?(le(),Pe(eo,{key:1},[(le(),Rt(Wo(y(me)),{class:he([y(w).em("decimal","box")])},null,8,["class"])),Qe(y(Gn),{style:to(y(J)),class:he([y(w).e("icon"),y(w).e("decimal")])},{default:at(()=>[(le(),Rt(Wo(y(se))))]),_:1},8,["style","class"])],64)):St("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),xe.showText||xe.showScore?(le(),Pe("span",{key:0,class:he(y(w).e("text")),style:to({color:xe.textColor})},yn(y(U)),7)):St("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var Yre=xn(Zre,[["__file","rate.vue"]]);const Xre=Ao(Yre),am={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},HP={[am.success]:WW,[am.warning]:_1,[am.error]:yT,[am.info]:bT},Jre=vn({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),Qre=Ze({name:"ElResult"}),eie=Ze({...Qre,props:Jre,setup(e){const t=e,i=rn("result"),s=te(()=>{const d=t.icon,p=d&&am[d]?am[d]:"icon-info",_=HP[p]||HP["icon-info"];return{class:p,component:_}});return(d,p)=>(le(),Pe("div",{class:he(y(i).b())},[Ve("div",{class:he(y(i).e("icon"))},[_t(d.$slots,"icon",{},()=>[y(s).component?(le(),Rt(Wo(y(s).component),{key:0,class:he(y(s).class)},null,8,["class"])):St("v-if",!0)])],2),d.title||d.$slots.title?(le(),Pe("div",{key:0,class:he(y(i).e("title"))},[_t(d.$slots,"title",{},()=>[Ve("p",null,yn(d.title),1)])],2)):St("v-if",!0),d.subTitle||d.$slots["sub-title"]?(le(),Pe("div",{key:1,class:he(y(i).e("subtitle"))},[_t(d.$slots,"sub-title",{},()=>[Ve("p",null,yn(d.subTitle),1)])],2)):St("v-if",!0),d.$slots.extra?(le(),Pe("div",{key:2,class:he(y(i).e("extra"))},[_t(d.$slots,"extra")],2)):St("v-if",!0)],2))}});var tie=xn(eie,[["__file","result.vue"]]);const nie=Ao(tie),oie=["start","center","end","space-around","space-between","space-evenly"],rie=["top","middle","bottom"],iie=vn({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:oie,default:"start"},align:{type:String,values:rie}}),aie=Ze({name:"ElRow"}),sie=Ze({...aie,props:iie,setup(e){const t=e,i=rn("row"),s=te(()=>t.gutter);or(PD,{gutter:s});const d=te(()=>{const _={};return t.gutter&&(_.marginRight=_.marginLeft=`-${t.gutter/2}px`),_}),p=te(()=>[i.b(),i.is(`justify-${t.justify}`,t.justify!=="start"),i.is(`align-${t.align}`,!!t.align)]);return(_,o)=>(le(),Rt(Wo(_.tag),{class:he(y(p)),style:to(y(d))},{default:at(()=>[_t(_.$slots,"default")]),_:3},8,["class","style"]))}});var lie=xn(sie,[["__file","row.vue"]]);const cie=Ao(lie),uie=Ze({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:rn("select")}}});function die(e,t,i,s,d,p){return le(),Pe("div",{class:he(e.ns.be("group","title")),style:to({...e.style,lineHeight:`${e.height}px`})},yn(e.item.label),7)}var hie=xn(uie,[["render",die],["__file","group-item.vue"]]);function fie(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const Rz={label:"label",value:"value",disabled:"disabled",options:"options"};function I1(e){const t=te(()=>({...Rz,...e.props}));return{aliasProps:t,getLabel:_=>Ji(_,t.value.label),getValue:_=>Ji(_,t.value.value),getDisabled:_=>Ji(_,t.value.disabled),getOptions:_=>Ji(_,t.value.options)}}const pie=vn({allowCreate:Boolean,autocomplete:{type:ut(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:Xr,default:pd},effect:{type:ut(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:ut([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:ut(Array),required:!0},placeholder:{type:String},teleported:wa.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})},remote:Boolean,size:ia,props:{type:ut(Object),default:()=>Rz},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:ut(String),values:md,default:"bottom-start"},fallbackPlacements:{type:ut(Array),default:["bottom-start","top-start","right","left"]},tagType:{...sd.type,default:"info"},tagEffect:{...sd.effect,default:"light"},tabindex:{type:[String,Number],default:0},appendTo:String,...Km,...Da(["ariaLabel"])}),mie=vn({data:Array,disabled:Boolean,hovering:Boolean,item:{type:ut(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),gie={[Fo]:e=>!0,[Yr]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},vie={hover:e=>ao(e),select:(e,t)=>!0},iC=Symbol("ElSelectV2Injection"),_ie=Ze({props:mie,emits:vie,setup(e,{emit:t}){const i=Un(iC),s=rn("select"),{hoverItem:d,selectOptionClick:p}=fie(e,{emit:t}),{getLabel:_}=I1(i.props);return{ns:s,hoverItem:d,selectOptionClick:p,getLabel:_}}});function yie(e,t,i,s,d,p){return le(),Pe("li",{"aria-selected":e.selected,style:to(e.style),class:he([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:po(e.selectOptionClick,["stop"])},[_t(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[Ve("span",null,yn(e.getLabel(e.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var bie=xn(_ie,[["render",yie],["__file","option-item.vue"]]),GP=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function xie(e,t){return!!(e===t||GP(e)&&GP(t))}function wie(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!xie(e[i],t[i]))return!1;return!0}function Sie(e,t){t===void 0&&(t=wie);var i=null;function s(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];if(i&&i.lastThis===this&&t(d,i.lastArgs))return i.lastResult;var _=e.apply(this,d);return i={lastResult:_,lastArgs:d,lastThis:this},_}return s.clear=function(){i=null},s}const Lz=()=>{const t=jo().proxy.$props;return te(()=>{const i=(s,d,p)=>({});return t.perfMode?d1(i):Sie(i)})},Y2=50,Ob="itemRendered",Db="scroll",sm="forward",zb="backward",Ql="auto",A1="smart",S_="start",Tu="center",T_="end",Om="horizontal",aC="vertical",Tie="ltr",_m="rtl",C_="negative",sC="positive-ascending",lC="positive-descending",Cie={[Om]:"left",[aC]:"top"},Eie=20,Mie={[Om]:"deltaX",[aC]:"deltaY"},Iie=({atEndEdge:e,atStartEdge:t,layout:i},s)=>{let d,p=0;const _=w=>w<0&&t.value||w>0&&e.value;return{hasReachedEdge:_,onWheel:w=>{Gf(d);const C=w[Mie[i.value]];_(p)&&_(p+C)||(p+=C,b1()||w.preventDefault(),d=wh(()=>{s(p),p=0}))}}},X2=nu({type:ut([Number,Function]),required:!0}),J2=nu({type:Number}),Q2=nu({type:Number,default:2}),Aie=nu({type:String,values:["ltr","rtl"],default:"ltr"}),eS=nu({type:Number,default:0}),Fb=nu({type:Number,required:!0}),Oz=nu({type:String,values:["horizontal","vertical"],default:aC}),Dz=vn({className:{type:String,default:""},containerElement:{type:ut([String,Object]),default:"div"},data:{type:ut(Array),default:()=>Ri([])},direction:Aie,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:ut([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),zz=vn({cache:Q2,estimatedItemSize:J2,layout:Oz,initScrollOffset:eS,total:Fb,itemSize:X2,...Dz}),tS={type:Number,default:6},Fz={type:Number,default:0},Bz={type:Number,default:2},Bf=vn({columnCache:Q2,columnWidth:X2,estimatedColumnWidth:J2,estimatedRowHeight:J2,initScrollLeft:eS,initScrollTop:eS,itemKey:{type:ut(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:Q2,rowHeight:X2,totalColumn:Fb,totalRow:Fb,hScrollbarSize:tS,vScrollbarSize:tS,scrollbarStartGap:Fz,scrollbarEndGap:Bz,role:String,...Dz}),Nz=vn({alwaysOn:Boolean,class:String,layout:Oz,total:Fb,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:tS,startGap:Fz,endGap:Bz,visible:Boolean}),kf=(e,t)=>e<t?sm:zb,E_=e=>e===Tie||e===_m||e===Om,WP=e=>e===_m;let Jp=null;function Bb(e=!1){if(Jp===null||e){const t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";const s=document.createElement("div"),d=s.style;return d.width="100px",d.height="100px",t.appendChild(s),document.body.appendChild(t),t.scrollLeft>0?Jp=lC:(t.scrollLeft=1,t.scrollLeft===0?Jp=C_:Jp=sC),document.body.removeChild(t),Jp}return Jp}function kie({move:e,size:t,bar:i},s){const d={},p=`translate${i.axis}(${e}px)`;return d[i.size]=t,d.transform=p,d.msTransform=p,d.webkitTransform=p,s==="horizontal"?d.height="100%":d.width="100%",d}const nS=Ze({name:"ElVirtualScrollBar",props:Nz,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const i=te(()=>e.startGap+e.endGap),s=rn("virtual-scrollbar"),d=rn("scrollbar"),p=we(),_=we();let o=null,w=null;const C=Ir({isDragging:!1,traveled:0}),M=te(()=>IO[e.layout]),I=te(()=>e.clientSize-y(i)),F=te(()=>({position:"absolute",width:`${Om===e.layout?I.value:e.scrollbarSize}px`,height:`${Om===e.layout?e.scrollbarSize:I.value}px`,[Cie[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),B=te(()=>{const oe=e.ratio,se=e.clientSize;if(oe>=100)return Number.POSITIVE_INFINITY;if(oe>=50)return oe*se/100;const me=se/3;return Math.floor(Math.min(Math.max(oe*se,Eie),me))}),N=te(()=>{if(!Number.isFinite(B.value))return{display:"none"};const oe=`${B.value}px`;return kie({bar:M.value,size:oe,move:C.traveled},e.layout)}),D=te(()=>Math.floor(e.clientSize-B.value-y(i))),j=()=>{window.addEventListener("mousemove",G),window.addEventListener("mouseup",K);const oe=y(_);oe&&(w=document.onselectstart,document.onselectstart=()=>!1,oe.addEventListener("touchmove",G,{passive:!0}),oe.addEventListener("touchend",K))},U=()=>{window.removeEventListener("mousemove",G),window.removeEventListener("mouseup",K),document.onselectstart=w,w=null;const oe=y(_);oe&&(oe.removeEventListener("touchmove",G),oe.removeEventListener("touchend",K))},ne=oe=>{oe.stopImmediatePropagation(),!(oe.ctrlKey||[1,2].includes(oe.button))&&(C.isDragging=!0,C[M.value.axis]=oe.currentTarget[M.value.offset]-(oe[M.value.client]-oe.currentTarget.getBoundingClientRect()[M.value.direction]),t("start-move"),j())},K=()=>{C.isDragging=!1,C[M.value.axis]=0,t("stop-move"),U()},G=oe=>{const{isDragging:se}=C;if(!se||!_.value||!p.value)return;const me=C[M.value.axis];if(!me)return;Gf(o);const de=(p.value.getBoundingClientRect()[M.value.direction]-oe[M.value.client])*-1,ce=_.value[M.value.offset]-me,pe=de-ce;o=wh(()=>{C.traveled=Math.max(e.startGap,Math.min(pe,D.value)),t("scroll",pe,D.value)})},J=oe=>{const se=Math.abs(oe.target.getBoundingClientRect()[M.value.direction]-oe[M.value.client]),me=_.value[M.value.offset]/2,de=se-me;C.traveled=Math.max(0,Math.min(de,D.value)),t("scroll",de,D.value)};return tn(()=>e.scrollFrom,oe=>{C.isDragging||(C.traveled=Math.ceil(oe*D.value))}),ni(()=>{U()}),()=>lo("div",{role:"presentation",ref:p,class:[s.b(),e.class,(e.alwaysOn||C.isDragging)&&"always-on"],style:F.value,onMousedown:po(J,["stop","prevent"]),onTouchstartPrevent:ne},lo("div",{ref:_,class:d.e("thumb"),style:N.value,onMousedown:ne},[]))}}),$z=({name:e,getOffset:t,getItemSize:i,getItemOffset:s,getEstimatedTotalSize:d,getStartIndexForOffset:p,getStopIndexForStartIndex:_,initCache:o,clearCache:w,validateProps:C})=>Ze({name:e??"ElVirtualList",props:zz,emits:[Ob,Db],setup(M,{emit:I,expose:F}){C(M);const B=jo(),N=rn("vl"),D=we(o(M,B)),j=Lz(),U=we(),ne=we(),K=we(),G=we({isScrolling:!1,scrollDir:"forward",scrollOffset:ao(M.initScrollOffset)?M.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:M.scrollbarAlwaysOn}),J=te(()=>{const{total:Oe,cache:Ct}=M,{isScrolling:Mt,scrollDir:zt,scrollOffset:bt}=y(G);if(Oe===0)return[0,0,0,0];const Kt=p(M,bt,y(D)),$t=_(M,Kt,bt,y(D)),Le=!Mt||zt===zb?Math.max(1,Ct):1,dn=!Mt||zt===sm?Math.max(1,Ct):1;return[Math.max(0,Kt-Le),Math.max(0,Math.min(Oe-1,$t+dn)),Kt,$t]}),oe=te(()=>d(M,y(D))),se=te(()=>E_(M.layout)),me=te(()=>[{position:"relative",[`overflow-${se.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:M.direction,height:ao(M.height)?`${M.height}px`:M.height,width:ao(M.width)?`${M.width}px`:M.width},M.style]),de=te(()=>{const Oe=y(oe),Ct=y(se);return{height:Ct?"100%":`${Oe}px`,pointerEvents:y(G).isScrolling?"none":void 0,width:Ct?`${Oe}px`:"100%"}}),ce=te(()=>se.value?M.width:M.height),{onWheel:pe}=Iie({atStartEdge:te(()=>G.value.scrollOffset<=0),atEndEdge:te(()=>G.value.scrollOffset>=oe.value),layout:te(()=>M.layout)},Oe=>{var Ct,Mt;(Mt=(Ct=K.value).onMouseUp)==null||Mt.call(Ct),Ae(Math.min(G.value.scrollOffset+Oe,oe.value-ce.value))});qr(U,"wheel",pe,{passive:!1});const ge=()=>{const{total:Oe}=M;if(Oe>0){const[bt,Kt,$t,Le]=y(J);I(Ob,bt,Kt,$t,Le)}const{scrollDir:Ct,scrollOffset:Mt,updateRequested:zt}=y(G);I(Db,Ct,Mt,zt)},Re=Oe=>{const{clientHeight:Ct,scrollHeight:Mt,scrollTop:zt}=Oe.currentTarget,bt=y(G);if(bt.scrollOffset===zt)return;const Kt=Math.max(0,Math.min(zt,Mt-Ct));G.value={...bt,isScrolling:!0,scrollDir:kf(bt.scrollOffset,Kt),scrollOffset:Kt,updateRequested:!1},oo(Ne)},Je=Oe=>{const{clientWidth:Ct,scrollLeft:Mt,scrollWidth:zt}=Oe.currentTarget,bt=y(G);if(bt.scrollOffset===Mt)return;const{direction:Kt}=M;let $t=Mt;if(Kt===_m)switch(Bb()){case C_:{$t=-Mt;break}case lC:{$t=zt-Ct-Mt;break}}$t=Math.max(0,Math.min($t,zt-Ct)),G.value={...bt,isScrolling:!0,scrollDir:kf(bt.scrollOffset,$t),scrollOffset:$t,updateRequested:!1},oo(Ne)},Me=Oe=>{y(se)?Je(Oe):Re(Oe),ge()},xe=(Oe,Ct)=>{const Mt=(oe.value-ce.value)/Ct*Oe;Ae(Math.min(oe.value-ce.value,Mt))},Ae=Oe=>{Oe=Math.max(Oe,0),Oe!==y(G).scrollOffset&&(G.value={...y(G),scrollOffset:Oe,scrollDir:kf(y(G).scrollOffset,Oe),updateRequested:!0},oo(Ne))},Ce=(Oe,Ct=Ql)=>{const{scrollOffset:Mt}=y(G);Oe=Math.max(0,Math.min(Oe,M.total-1)),Ae(t(M,Oe,Ct,Mt,y(D)))},ve=Oe=>{const{direction:Ct,itemSize:Mt,layout:zt}=M,bt=j.value(w&&Mt,w&&zt,w&&Ct);let Kt;if(Tr(bt,String(Oe)))Kt=bt[Oe];else{const $t=s(M,Oe,y(D)),Le=i(M,Oe,y(D)),dn=y(se),At=Ct===_m,Ke=dn?$t:0;bt[Oe]=Kt={position:"absolute",left:At?void 0:`${Ke}px`,right:At?`${Ke}px`:void 0,top:dn?0:`${$t}px`,height:dn?"100%":`${Le}px`,width:dn?`${Le}px`:"100%"}}return Kt},Ne=()=>{G.value.isScrolling=!1,oo(()=>{j.value(-1,null,null)})},We=()=>{const Oe=U.value;Oe&&(Oe.scrollTop=0)};No(()=>{if(!gr)return;const{initScrollOffset:Oe}=M,Ct=y(U);ao(Oe)&&Ct&&(y(se)?Ct.scrollLeft=Oe:Ct.scrollTop=Oe),ge()}),Ru(()=>{const{direction:Oe,layout:Ct}=M,{scrollOffset:Mt,updateRequested:zt}=y(G),bt=y(U);if(zt&&bt)if(Ct===Om)if(Oe===_m)switch(Bb()){case C_:{bt.scrollLeft=-Mt;break}case sC:{bt.scrollLeft=Mt;break}default:{const{clientWidth:Kt,scrollWidth:$t}=bt;bt.scrollLeft=$t-Kt-Mt;break}}else bt.scrollLeft=Mt;else bt.scrollTop=Mt}),US(()=>{y(U).scrollTop=y(G).scrollOffset});const ot={ns:N,clientSize:ce,estimatedTotalSize:oe,windowStyle:me,windowRef:U,innerRef:ne,innerStyle:de,itemsToRender:J,scrollbarRef:K,states:G,getItemStyle:ve,onScroll:Me,onScrollbarScroll:xe,onWheel:pe,scrollTo:Ae,scrollToItem:Ce,resetScrollTop:We};return F({windowRef:U,innerRef:ne,getItemStyleCache:j,scrollTo:Ae,scrollToItem:Ce,resetScrollTop:We,states:G}),ot},render(M){var I;const{$slots:F,className:B,clientSize:N,containerElement:D,data:j,getItemStyle:U,innerElement:ne,itemsToRender:K,innerStyle:G,layout:J,total:oe,onScroll:se,onScrollbarScroll:me,states:de,useIsScrolling:ce,windowStyle:pe,ns:ge}=M,[Re,Je]=K,Me=Wo(D),xe=Wo(ne),Ae=[];if(oe>0)for(let We=Re;We<=Je;We++)Ae.push(lo(eo,{key:We},(I=F.default)==null?void 0:I.call(F,{data:j,index:We,isScrolling:ce?de.isScrolling:void 0,style:U(We)})));const Ce=[lo(xe,{style:G,ref:"innerRef"},Zn(xe)?Ae:{default:()=>Ae})],ve=lo(nS,{ref:"scrollbarRef",clientSize:N,layout:J,onScroll:me,ratio:N*100/this.estimatedTotalSize,scrollFrom:de.scrollOffset/(this.estimatedTotalSize-N),total:oe}),Ne=lo(Me,{class:[ge.e("window"),B],style:pe,onScroll:se,ref:"windowRef",key:0},Zn(Me)?[Ce]:{default:()=>[Ce]});return lo("div",{key:0,class:[ge.e("wrapper"),de.scrollbarAlwaysOn?"always-on":""]},[Ne,ve])}}),Vz=$z({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:i,layout:s,width:d},p,_,o)=>{const w=E_(s)?d:e,C=Math.max(0,t*i-w),M=Math.min(C,p*i),I=Math.max(0,(p+1)*i-w);switch(_===A1&&(o>=I-w&&o<=M+w?_=Ql:_=Tu),_){case S_:return M;case T_:return I;case Tu:{const F=Math.round(I+(M-I)/2);return F<Math.ceil(w/2)?0:F>C+Math.floor(w/2)?C:F}case Ql:default:return o>=I&&o<=M?o:o<I?I:M}},getStartIndexForOffset:({total:e,itemSize:t},i)=>Math.max(0,Math.min(e-1,Math.floor(i/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:i,layout:s,width:d},p,_)=>{const o=p*i,w=E_(s)?d:e,C=Math.ceil((w+_-o)/i);return Math.max(0,Math.min(t-1,p+C-1))},initCache(){},clearCache:!0,validateProps(){}}),lm=(e,t,i)=>{const{itemSize:s}=e,{items:d,lastVisitedIndex:p}=i;if(t>p){let _=0;if(p>=0){const o=d[p];_=o.offset+o.size}for(let o=p+1;o<=t;o++){const w=s(o);d[o]={offset:_,size:w},_+=w}i.lastVisitedIndex=t}return d[t]},Pie=(e,t,i)=>{const{items:s,lastVisitedIndex:d}=t;return(d>0?s[d].offset:0)>=i?Uz(e,t,0,d,i):Rie(e,t,Math.max(0,d),i)},Uz=(e,t,i,s,d)=>{for(;i<=s;){const p=i+Math.floor((s-i)/2),_=lm(e,p,t).offset;if(_===d)return p;_<d?i=p+1:_>d&&(s=p-1)}return Math.max(0,i-1)},Rie=(e,t,i,s)=>{const{total:d}=e;let p=1;for(;i<d&&lm(e,i,t).offset<s;)i+=p,p*=2;return Uz(e,t,Math.floor(i/2),Math.min(i,d-1),s)},qP=({total:e},{items:t,estimatedItemSize:i,lastVisitedIndex:s})=>{let d=0;if(s>=e&&(s=e-1),s>=0){const o=t[s];d=o.offset+o.size}const _=(e-s-1)*i;return d+_},Lie=$z({name:"ElDynamicSizeList",getItemOffset:(e,t,i)=>lm(e,t,i).offset,getItemSize:(e,t,{items:i})=>i[t].size,getEstimatedTotalSize:qP,getOffset:(e,t,i,s,d)=>{const{height:p,layout:_,width:o}=e,w=E_(_)?o:p,C=lm(e,t,d),M=qP(e,d),I=Math.max(0,Math.min(M-w,C.offset)),F=Math.max(0,C.offset-w+C.size);switch(i===A1&&(s>=F-w&&s<=I+w?i=Ql:i=Tu),i){case S_:return I;case T_:return F;case Tu:return Math.round(F+(I-F)/2);case Ql:default:return s>=F&&s<=I?s:s<F?F:I}},getStartIndexForOffset:(e,t,i)=>Pie(e,i,t),getStopIndexForStartIndex:(e,t,i,s)=>{const{height:d,total:p,layout:_,width:o}=e,w=E_(_)?o:d,C=lm(e,t,s),M=i+w;let I=C.offset+C.size,F=t;for(;F<p-1&&I<M;)F++,I+=lm(e,F,s).size;return F},initCache({estimatedItemSize:e=Y2},t){const i={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return i.clearCacheAfterIndex=(s,d=!0)=>{var p,_;i.lastVisitedIndex=Math.min(i.lastVisitedIndex,s-1),(p=t.exposed)==null||p.getItemStyleCache(-1),d&&((_=t.proxy)==null||_.$forceUpdate())},i},clearCache:!1,validateProps:({itemSize:e})=>{}}),Oie={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var Die=Ze({name:"ElSelectDropdown",props:Oie,setup(e,{slots:t,expose:i}){const s=Un(iC),d=rn("select"),{getLabel:p,getValue:_,getDisabled:o}=I1(s.props),w=we([]),C=we(),M=te(()=>e.data.length);tn(()=>M.value,()=>{var pe,ge;(ge=(pe=s.tooltipRef.value).updatePopper)==null||ge.call(pe)});const I=te(()=>Hr(s.props.estimatedOptionHeight)),F=te(()=>I.value?{itemSize:s.props.itemHeight}:{estimatedSize:s.props.estimatedOptionHeight,itemSize:pe=>w.value[pe]}),B=(pe=[],ge)=>{const{props:{valueKey:Re}}=s;return Vo(ge)?pe&&pe.some(Je=>ei(Ji(Je,Re))===Ji(ge,Re)):pe.includes(ge)},N=(pe,ge)=>{if(Vo(ge)){const{valueKey:Re}=s.props;return Ji(pe,Re)===Ji(ge,Re)}else return pe===ge},D=(pe,ge)=>s.props.multiple?B(pe,_(ge)):N(pe,_(ge)),j=(pe,ge)=>{const{disabled:Re,multiple:Je,multipleLimit:Me}=s.props;return Re||!ge&&(Je?Me>0&&pe.length>=Me:!1)},U=pe=>e.hoveringIndex===pe;i({listRef:C,isSized:I,isItemDisabled:j,isItemHovering:U,isItemSelected:D,scrollToItem:pe=>{const ge=C.value;ge&&ge.scrollToItem(pe)},resetScrollTop:()=>{const pe=C.value;pe&&pe.resetScrollTop()}});const J=pe=>{const{index:ge,data:Re,style:Je}=pe,Me=y(I),{itemSize:xe,estimatedSize:Ae}=y(F),{modelValue:Ce}=s.props,{onSelect:ve,onHover:Ne}=s,We=Re[ge];if(We.type==="Group")return Qe(hie,{item:We,style:Je,height:Me?xe:Ae},null);const ot=D(Ce,We),Oe=j(Ce,ot),Ct=U(ge);return Qe(bie,Yo(pe,{selected:ot,disabled:o(We)||Oe,created:!!We.created,hovering:Ct,item:We,onSelect:ve,onHover:Ne}),{default:Mt=>{var zt;return((zt=t.default)==null?void 0:zt.call(t,Mt))||Qe("span",null,[p(We)])}})},{onKeyboardNavigate:oe,onKeyboardSelect:se}=s,me=()=>{oe("forward")},de=()=>{oe("backward")},ce=pe=>{const{code:ge}=pe,{tab:Re,esc:Je,down:Me,up:xe,enter:Ae,numpadEnter:Ce}=Ln;switch(ge!==Re&&(pe.preventDefault(),pe.stopPropagation()),ge){case Re:case Je:break;case Me:me();break;case xe:de();break;case Ae:case Ce:se();break}};return()=>{var pe,ge,Re,Je;const{data:Me,width:xe}=e,{height:Ae,multiple:Ce,scrollbarAlwaysOn:ve}=s.props,Ne=y(I)?Vz:Lie;return Qe("div",{class:[d.b("dropdown"),d.is("multiple",Ce)],style:{width:`${xe}px`}},[(pe=t.header)==null?void 0:pe.call(t),((ge=t.loading)==null?void 0:ge.call(t))||((Re=t.empty)==null?void 0:Re.call(t))||Qe(Ne,Yo({ref:C},y(F),{className:d.be("dropdown","list"),scrollbarAlwaysOn:ve,data:Me,height:Ae,width:xe,total:Me.length,onKeydown:ce}),{default:We=>Qe(J,We,null)}),(Je=t.footer)==null?void 0:Je.call(t)])}}});function zie(e,t){const{aliasProps:i,getLabel:s,getValue:d}=I1(e),p=we(0),_=we(),o=te(()=>e.allowCreate&&e.filterable);function w(B){const N=D=>s(D)===B;return e.options&&e.options.some(N)||t.createdOptions.some(N)}function C(B){o.value&&(e.multiple&&B.created?p.value++:_.value=B)}function M(B){if(o.value)if(B&&B.length>0){if(w(B))return;const N={[i.value.value]:B,[i.value.label]:B,created:!0,[i.value.disabled]:!1};t.createdOptions.length>=p.value?t.createdOptions[p.value]=N:t.createdOptions.push(N)}else if(e.multiple)t.createdOptions.length=p.value;else{const N=_.value;t.createdOptions.length=0,N&&N.created&&t.createdOptions.push(N)}}function I(B){if(!o.value||!B||!B.created||B.created&&e.reserveKeyword&&t.inputValue===s(B))return;const N=t.createdOptions.findIndex(D=>d(D)===d(B));~N&&(t.createdOptions.splice(N,1),p.value--)}function F(){o.value&&(t.createdOptions.length=0,p.value=0)}return{createNewOption:M,removeNewOption:I,selectNewOption:C,clearAllNewOption:F}}const Fie=11,Bie=(e,t)=>{const{t:i}=vr(),s=rn("select"),d=rn("input"),{form:p,formItem:_}=Ka(),{inputId:o}=sc(e,{formItemContext:_}),{aliasProps:w,getLabel:C,getValue:M,getDisabled:I,getOptions:F}=I1(e),{valueOnClear:B,isEmptyValue:N}=m1(e),D=Ir({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),j=we(-1),U=we(),ne=we(),K=we(),G=we(),J=we(),oe=we(),se=we(),me=we(),de=we(),ce=we(),pe=we(),{isComposing:ge,handleCompositionStart:Re,handleCompositionEnd:Je,handleCompositionUpdate:Me}=H_({afterComposition:cn=>co(cn)}),{wrapperRef:xe,isFocused:Ae,handleBlur:Ce}=Lh(J,{beforeFocus(){return ot.value},afterFocus(){e.automaticDropdown&&!We.value&&(We.value=!0,D.menuVisibleOnFocus=!0)},beforeBlur(cn){var Yn,To;return((Yn=K.value)==null?void 0:Yn.isFocusInsideContent(cn))||((To=G.value)==null?void 0:To.isFocusInsideContent(cn))},afterBlur(){We.value=!1,D.menuVisibleOnFocus=!1}}),ve=we([]),Ne=we([]),We=we(!1),ot=te(()=>e.disabled||(p==null?void 0:p.disabled)),Oe=te(()=>{var cn;return(cn=p==null?void 0:p.statusIcon)!=null?cn:!1}),Ct=te(()=>{const cn=Ne.value.length*e.itemHeight;return cn>e.height?e.height:cn}),Mt=te(()=>e.multiple?fn(e.modelValue)&&e.modelValue.length>0:!N(e.modelValue)),zt=te(()=>e.clearable&&!ot.value&&D.inputHovering&&Mt.value),bt=te(()=>e.remote&&e.filterable?"":fd),Kt=te(()=>bt.value&&s.is("reverse",We.value)),$t=te(()=>(_==null?void 0:_.validateState)||""),Le=te(()=>{if($t.value)return y1[$t.value]}),dn=te(()=>e.remote?300:0),At=te(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!D.inputValue&&ve.value.length===0?!1:e.filterable&&D.inputValue&&ve.value.length>0&&Ne.value.length===0?e.noMatchText||i("el.select.noMatch"):ve.value.length===0?e.noDataText||i("el.select.noData"):null),Ke=cn=>{const Yn=To=>{if(e.filterable&&Qn(e.filterMethod)||e.filterable&&e.remote&&Qn(e.remoteMethod))return!0;const $o=new RegExp($T(cn),"i");return cn?$o.test(C(To)||""):!0};return e.loading?[]:[...D.createdOptions,...e.options].reduce((To,$o)=>{const Ar=F($o);if(fn(Ar)){const yr=Ar.filter(Yn);yr.length>0&&To.push({label:C($o),type:"Group"},...yr)}else(e.remote||Yn($o))&&To.push($o);return To},[])},Be=()=>{ve.value=Ke(""),Ne.value=Ke(D.inputValue)},Ht=te(()=>{const cn=new Map;return ve.value.forEach((Yn,To)=>{cn.set(Xo(M(Yn)),{option:Yn,index:To})}),cn}),Ut=te(()=>{const cn=new Map;return Ne.value.forEach((Yn,To)=>{cn.set(Xo(M(Yn)),{option:Yn,index:To})}),cn}),Nt=te(()=>Ne.value.every(cn=>I(cn))),Et=na(),Gt=te(()=>Et.value==="small"?"small":"default"),ln=()=>{var cn;j.value=((cn=U.value)==null?void 0:cn.offsetWidth)||200},bn=()=>{if(!ne.value)return 0;const cn=window.getComputedStyle(ne.value);return Number.parseFloat(cn.gap||"6px")},_n=te(()=>{const cn=bn();return{maxWidth:`${pe.value&&e.maxCollapseTags===1?D.selectionWidth-D.collapseItemWidth-cn:D.selectionWidth}px`}}),jn=te(()=>({maxWidth:`${D.selectionWidth}px`})),yt=te(()=>({width:`${Math.max(D.calculatorWidth,Fie)}px`})),kn=te(()=>fn(e.modelValue)?e.modelValue.length===0&&!D.inputValue:e.filterable?!D.inputValue:!0),qn=te(()=>{var cn;const Yn=(cn=e.placeholder)!=null?cn:i("el.select.placeholder");return e.multiple||!Mt.value?Yn:D.selectedLabel}),Co=te(()=>{var cn,Yn;return(Yn=(cn=K.value)==null?void 0:cn.popperRef)==null?void 0:Yn.contentRef}),mo=te(()=>{if(e.multiple){const cn=e.modelValue.length;if(e.modelValue.length>0&&Ut.value.has(e.modelValue[cn-1])){const{index:Yn}=Ut.value.get(e.modelValue[cn-1]);return Yn}}else if(e.modelValue&&Ut.value.has(e.modelValue)){const{index:cn}=Ut.value.get(e.modelValue);return cn}return-1}),Io=te({get(){return We.value&&At.value!==!1},set(cn){We.value=cn}}),Ho=te(()=>e.multiple?e.collapseTags?D.cachedOptions.slice(0,e.maxCollapseTags):D.cachedOptions:[]),ur=te(()=>e.multiple?e.collapseTags?D.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:Dt,removeNewOption:En,selectNewOption:ft,clearAllNewOption:un}=zie(e,D),et=()=>{ot.value||(D.menuVisibleOnFocus?D.menuVisibleOnFocus=!1:We.value=!We.value)},Mn=()=>{D.inputValue.length>0&&!We.value&&(We.value=!0),Dt(D.inputValue),Lo(D.inputValue)},Bn=il(Mn,dn.value),Lo=cn=>{D.previousQuery===cn||ge.value||(D.previousQuery=cn,e.filterable&&Qn(e.filterMethod)?e.filterMethod(cn):e.filterable&&e.remote&&Qn(e.remoteMethod)&&e.remoteMethod(cn),e.defaultFirstOption&&(e.filterable||e.remote)&&Ne.value.length?oo(Rr):oo(ho))},Rr=()=>{const cn=Ne.value.filter($o=>!$o.disabled&&$o.type!=="Group"),Yn=cn.find($o=>$o.created),To=cn[0];D.hoveringIndex=Nr(Ne.value,Yn||To)},hi=cn=>{La(e.modelValue,cn)||t(Yr,cn)},Er=cn=>{t(Fo,cn),hi(cn),D.previousValue=e.multiple?String(cn):cn},Nr=(cn=[],Yn)=>{if(!Vo(Yn))return cn.indexOf(Yn);const To=e.valueKey;let $o=-1;return cn.some((Ar,yr)=>Ji(Ar,To)===Ji(Yn,To)?($o=yr,!0):!1),$o},Xo=cn=>Vo(cn)?Ji(cn,e.valueKey):cn,Bi=()=>{ln()},$s=()=>{D.selectionWidth=ne.value.getBoundingClientRect().width},Zt=()=>{D.calculatorWidth=oe.value.getBoundingClientRect().width},Ee=()=>{D.collapseItemWidth=pe.value.getBoundingClientRect().width},ke=()=>{var cn,Yn;(Yn=(cn=K.value)==null?void 0:cn.updatePopper)==null||Yn.call(cn)},qe=()=>{var cn,Yn;(Yn=(cn=G.value)==null?void 0:cn.updatePopper)==null||Yn.call(cn)},mt=cn=>{if(e.multiple){let Yn=e.modelValue.slice();const To=Nr(Yn,M(cn));To>-1?(Yn=[...Yn.slice(0,To),...Yn.slice(To+1)],D.cachedOptions.splice(To,1),En(cn)):(e.multipleLimit<=0||Yn.length<e.multipleLimit)&&(Yn=[...Yn,M(cn)],D.cachedOptions.push(cn),ft(cn)),Er(Yn),cn.created&&Lo(""),e.filterable&&!e.reserveKeyword&&(D.inputValue="")}else D.selectedLabel=C(cn),Er(M(cn)),We.value=!1,ft(cn),cn.created||un();xt()},it=(cn,Yn)=>{let To=e.modelValue.slice();const $o=Nr(To,M(Yn));$o>-1&&!ot.value&&(To=[...e.modelValue.slice(0,$o),...e.modelValue.slice($o+1)],D.cachedOptions.splice($o,1),Er(To),t("remove-tag",M(Yn)),En(Yn)),cn.stopPropagation(),xt()},xt=()=>{var cn;(cn=J.value)==null||cn.focus()},qt=()=>{var cn;if(We.value){We.value=!1,oo(()=>{var Yn;return(Yn=J.value)==null?void 0:Yn.blur()});return}(cn=J.value)==null||cn.blur()},kt=()=>{D.inputValue.length>0?D.inputValue="":We.value=!1},Wt=cn=>eO(cn,Yn=>!D.cachedOptions.some(To=>M(To)===Yn&&I(To))),Qt=cn=>{if(e.multiple&&cn.code!==Ln.delete&&D.inputValue.length===0){cn.preventDefault();const Yn=e.modelValue.slice(),To=Wt(Yn);if(To<0)return;const $o=Yn[To];Yn.splice(To,1);const Ar=D.cachedOptions[To];D.cachedOptions.splice(To,1),En(Ar),Er(Yn),t("remove-tag",$o)}},nn=()=>{let cn;fn(e.modelValue)?cn=[]:cn=B.value,e.multiple?D.cachedOptions=[]:D.selectedLabel="",We.value=!1,Er(cn),t("clear"),un(),xt()},gt=(cn,Yn=void 0)=>{const To=Ne.value;if(!["forward","backward"].includes(cn)||ot.value||To.length<=0||Nt.value||ge.value)return;if(!We.value)return et();Yn===void 0&&(Yn=D.hoveringIndex);let $o=-1;cn==="forward"?($o=Yn+1,$o>=To.length&&($o=0)):cn==="backward"&&($o=Yn-1,($o<0||$o>=To.length)&&($o=To.length-1));const Ar=To[$o];if(I(Ar)||Ar.type==="Group")return gt(cn,$o);D.hoveringIndex=$o,cr($o)},Yt=()=>{if(We.value)~D.hoveringIndex&&Ne.value[D.hoveringIndex]&&mt(Ne.value[D.hoveringIndex]);else return et()},In=cn=>{D.hoveringIndex=cn??-1},ho=()=>{e.multiple?D.hoveringIndex=Ne.value.findIndex(cn=>e.modelValue.some(Yn=>Xo(Yn)===Xo(cn))):D.hoveringIndex=Ne.value.findIndex(cn=>Xo(cn)===Xo(e.modelValue))},co=cn=>{if(D.inputValue=cn.target.value,e.remote)Bn();else return Mn()},Oo=cn=>{if(We.value=!1,Ae.value){const Yn=new FocusEvent("focus",cn);Ce(Yn)}},Eo=()=>(D.isBeforeHide=!1,oo(()=>{~mo.value&&cr(D.hoveringIndex)})),cr=cn=>{de.value.scrollToItem(cn)},rr=(cn,Yn)=>{const To=Xo(cn);if(Ht.value.has(To)){const{option:$o}=Ht.value.get(To);return $o}if(Yn&&Yn.length){const $o=Yn.find(Ar=>Xo(M(Ar))===To);if($o)return $o}return{[w.value.value]:cn,[w.value.label]:cn}},qo=(cn=!1)=>{if(e.multiple)if(e.modelValue.length>0){const Yn=D.cachedOptions.slice();D.cachedOptions.length=0,D.previousValue=e.modelValue.toString();for(const To of e.modelValue){const $o=rr(To,Yn);D.cachedOptions.push($o)}}else D.cachedOptions=[],D.previousValue=void 0;else if(Mt.value){D.previousValue=e.modelValue;const Yn=Ne.value,To=Yn.findIndex($o=>Xo(M($o))===Xo(e.modelValue));~To?D.selectedLabel=C(Yn[To]):(!D.selectedLabel||cn)&&(D.selectedLabel=Xo(e.modelValue))}else D.selectedLabel="",D.previousValue=void 0;un(),ln()};return tn(We,cn=>{cn?Lo(""):(D.inputValue="",D.previousQuery=null,D.isBeforeHide=!0,Dt("")),t("visible-change",cn)}),tn(()=>e.modelValue,(cn,Yn)=>{var To;(!cn||fn(cn)&&cn.length===0||e.multiple&&!La(cn.toString(),D.previousValue)||!e.multiple&&Xo(cn)!==Xo(D.previousValue))&&qo(!0),!La(cn,Yn)&&e.validateEvent&&((To=_==null?void 0:_.validate)==null||To.call(_,"change").catch(Ar=>void 0))},{deep:!0}),tn(()=>e.options,()=>{const cn=J.value;(!cn||cn&&document.activeElement!==cn)&&qo()},{deep:!0,flush:"post"}),tn(()=>Ne.value,()=>de.value&&oo(de.value.resetScrollTop)),Ha(()=>{D.isBeforeHide||Be()}),Ha(()=>{const{valueKey:cn,options:Yn}=e,To=new Map;for(const $o of Yn){const Ar=M($o);let yr=Ar;if(Vo(yr)&&(yr=Ji(Ar,cn)),To.get(yr))break;To.set(yr,!0)}}),No(()=>{qo()}),Mi(U,Bi),Mi(ne,$s),Mi(oe,Zt),Mi(de,ke),Mi(xe,ke),Mi(ce,qe),Mi(pe,Ee),{inputId:o,collapseTagSize:Gt,currentPlaceholder:qn,expanded:We,emptyText:At,popupHeight:Ct,debounce:dn,allOptions:ve,filteredOptions:Ne,iconComponent:bt,iconReverse:Kt,tagStyle:_n,collapseTagStyle:jn,inputStyle:yt,popperSize:j,dropdownMenuVisible:Io,hasModelValue:Mt,shouldShowPlaceholder:kn,selectDisabled:ot,selectSize:Et,needStatusIcon:Oe,showClearBtn:zt,states:D,isFocused:Ae,nsSelect:s,nsInput:d,calculatorRef:oe,inputRef:J,menuRef:de,tagMenuRef:ce,tooltipRef:K,tagTooltipRef:G,selectRef:U,wrapperRef:xe,selectionRef:ne,prefixRef:se,suffixRef:me,collapseItemRef:pe,popperRef:Co,validateState:$t,validateIcon:Le,showTagList:Ho,collapseTagList:ur,debouncedOnInputChange:Bn,deleteTag:it,getLabel:C,getValue:M,getDisabled:I,getValueKey:Xo,handleClear:nn,handleClickOutside:Oo,handleDel:Qt,handleEsc:kt,focus:xt,blur:qt,handleMenuEnter:Eo,handleResize:Bi,resetSelectionWidth:$s,resetCalculatorWidth:Zt,updateTooltip:ke,updateTagTooltip:qe,updateOptions:Be,toggleMenu:et,scrollTo:cr,onInput:co,onKeyboardNavigate:gt,onKeyboardSelect:Yt,onSelect:mt,onHover:In,handleCompositionStart:Re,handleCompositionEnd:Je,handleCompositionUpdate:Me}},Nie=Ze({name:"ElSelectV2",components:{ElSelectMenu:Die,ElTag:Rm,ElTooltip:qa,ElIcon:Gn},directives:{ClickOutside:ld},props:pie,emits:gie,setup(e,{emit:t}){const i=te(()=>{const{modelValue:p,multiple:_}=e,o=_?[]:void 0;return fn(p)?_?p:o:_?o:p}),s=Bie(Ir({...Ca(e),modelValue:i}),t);or(iC,{props:Ir({...Ca(e),height:s.popupHeight,modelValue:i}),expanded:s.expanded,tooltipRef:s.tooltipRef,onSelect:s.onSelect,onHover:s.onHover,onKeyboardNavigate:s.onKeyboardNavigate,onKeyboardSelect:s.onKeyboardSelect});const d=te(()=>e.multiple?s.states.cachedOptions.map(p=>p.label):s.states.selectedLabel);return{...s,modelValue:i,selectedLabel:d}}});function $ie(e,t,i,s,d,p){const _=Go("el-tag"),o=Go("el-tooltip"),w=Go("el-icon"),C=Go("el-select-menu"),M=o1("click-outside");return zo((le(),Pe("div",{ref:"selectRef",class:he([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:I=>e.states.inputHovering=!0,onMouseleave:I=>e.states.inputHovering=!1},[Qe(o,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:I=>e.states.isBeforeHide=!1},{default:at(()=>[Ve("div",{ref:"wrapperRef",class:he([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:po(e.toggleMenu,["prevent"])},[e.$slots.prefix?(le(),Pe("div",{key:0,ref:"prefixRef",class:he(e.nsSelect.e("prefix"))},[_t(e.$slots,"prefix")],2)):St("v-if",!0),Ve("div",{ref:"selectionRef",class:he([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?_t(e.$slots,"tag",{key:0},()=>[(le(!0),Pe(eo,null,nr(e.showTagList,I=>(le(),Pe("div",{key:e.getValueKey(e.getValue(I)),class:he(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!e.selectDisabled&&!e.getDisabled(I),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:to(e.tagStyle),onClose:F=>e.deleteTag(F,I)},{default:at(()=>[Ve("span",{class:he(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:e.getLabel(I),value:e.getValue(I)},()=>[Qo(yn(e.getLabel(I)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(le(),Rt(o,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:at(()=>[Ve("div",{ref:"collapseItemRef",class:he(e.nsSelect.e("selected-item"))},[Qe(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:to(e.collapseTagStyle),"disable-transitions":""},{default:at(()=>[Ve("span",{class:he(e.nsSelect.e("tags-text"))}," + "+yn(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:at(()=>[Ve("div",{ref:"tagMenuRef",class:he(e.nsSelect.e("selection"))},[(le(!0),Pe(eo,null,nr(e.collapseTagList,I=>(le(),Pe("div",{key:e.getValueKey(e.getValue(I)),class:he(e.nsSelect.e("selected-item"))},[Qe(_,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(I),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:F=>e.deleteTag(F,I)},{default:at(()=>[Ve("span",{class:he(e.nsSelect.e("tags-text"))},[_t(e.$slots,"label",{label:e.getLabel(I),value:e.getValue(I)},()=>[Qo(yn(e.getLabel(I)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):St("v-if",!0)]):St("v-if",!0),Ve("div",{class:he([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[zo(Ve("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":I=>e.states.inputValue=I,style:to(e.inputStyle),autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:he([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[ti(po(I=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),ti(po(I=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),ti(po(e.onKeyboardSelect,["stop","prevent"]),["enter"]),ti(po(e.handleEsc,["stop","prevent"]),["esc"]),ti(po(e.handleDel,["stop"]),["delete"])],onClick:po(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","tabindex","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[a1,e.states.inputValue]]),e.filterable?(le(),Pe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:he(e.nsSelect.e("input-calculator")),textContent:yn(e.states.inputValue)},null,10,["textContent"])):St("v-if",!0)],2),e.shouldShowPlaceholder?(le(),Pe("div",{key:1,class:he([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?_t(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ve("span",null,yn(e.currentPlaceholder),1)]):(le(),Pe("span",{key:1},yn(e.currentPlaceholder),1))],2)):St("v-if",!0)],2),Ve("div",{ref:"suffixRef",class:he(e.nsSelect.e("suffix"))},[e.iconComponent?zo((le(),Rt(w,{key:0,class:he([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:at(()=>[(le(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])),[[Cr,!e.showClearBtn]]):St("v-if",!0),e.showClearBtn&&e.clearIcon?(le(),Rt(w,{key:1,class:he([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:po(e.handleClear,["prevent","stop"])},{default:at(()=>[(le(),Rt(Wo(e.clearIcon)))]),_:1},8,["class","onClick"])):St("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(le(),Rt(w,{key:2,class:he([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:at(()=>[(le(),Rt(Wo(e.validateIcon)))]),_:1},8,["class"])):St("v-if",!0)],2)],10,["onClick"])]),content:at(()=>[Qe(C,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},nc({default:at(I=>[_t(e.$slots,"default",Hc(yh(I)))]),_:2},[e.$slots.header?{name:"header",fn:at(()=>[Ve("div",{class:he(e.nsSelect.be("dropdown","header"))},[_t(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:at(()=>[Ve("div",{class:he(e.nsSelect.be("dropdown","loading"))},[_t(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:at(()=>[Ve("div",{class:he(e.nsSelect.be("dropdown","empty"))},[_t(e.$slots,"empty",{},()=>[Ve("span",null,yn(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:at(()=>[Ve("div",{class:he(e.nsSelect.be("dropdown","footer"))},[_t(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[M,e.handleClickOutside,e.popperRef]])}var Vie=xn(Nie,[["render",$ie],["__file","select.vue"]]);const Uie=Ao(Vie),jie=vn({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:ut([Number,Object])}}),Hie=vn({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),Gie=Ze({name:"ElSkeletonItem"}),Wie=Ze({...Gie,props:Hie,setup(e){const t=rn("skeleton");return(i,s)=>(le(),Pe("div",{class:he([y(t).e("item"),y(t).e(i.variant)])},[i.variant==="image"?(le(),Rt(y(gq),{key:0})):St("v-if",!0)],2))}});var Nb=xn(Wie,[["__file","skeleton-item.vue"]]);const qie=(e,t=0)=>{if(t===0)return e;const i=Vo(t)&&!!t.initVal,s=we(i);let d=null;const p=o=>{if(Hr(o)){s.value=e.value;return}d&&clearTimeout(d),d=setTimeout(()=>{s.value=e.value},o)},_=o=>{o==="leading"?ao(t)?p(t):p(t.leading):Vo(t)?p(t.trailing):s.value=!1};return No(()=>_("leading")),tn(()=>e.value,o=>{_(o?"leading":"trailing")}),s},Kie=Ze({name:"ElSkeleton"}),Zie=Ze({...Kie,props:jie,setup(e,{expose:t}){const i=e,s=rn("skeleton"),d=qie(Vr(i,"loading"),i.throttle);return t({uiLoading:d}),(p,_)=>y(d)?(le(),Pe("div",Yo({key:0,class:[y(s).b(),y(s).is("animated",p.animated)]},p.$attrs),[(le(!0),Pe(eo,null,nr(p.count,o=>(le(),Pe(eo,{key:o},[y(d)?_t(p.$slots,"template",{key:o},()=>[Qe(Nb,{class:he(y(s).is("first")),variant:"p"},null,8,["class"]),(le(!0),Pe(eo,null,nr(p.rows,w=>(le(),Rt(Nb,{key:w,class:he([y(s).e("paragraph"),y(s).is("last",w===p.rows&&p.rows>1)]),variant:"p"},null,8,["class"]))),128))]):St("v-if",!0)],64))),128))],16)):_t(p.$slots,"default",Hc(Yo({key:1},p.$attrs)))}});var Yie=xn(Zie,[["__file","skeleton.vue"]]);const Xie=Ao(Yie,{SkeletonItem:Nb}),Jie=Li(Nb),jz=Symbol("sliderContextKey"),Qie=vn({modelValue:{type:ut([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:ia,inputSize:ia,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:ut(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:ut(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:md,default:"top"},marks:{type:ut(Object)},validateEvent:{type:Boolean,default:!0},...Da(["ariaLabel"])}),Kw=e=>ao(e)||fn(e)&&e.every(ao),eae={[Fo]:Kw,[Ga]:Kw,[Yr]:Kw},tae=vn({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:md,default:"top"}}),nae={[Fo]:e=>ao(e)},oae=(e,t,i)=>{const s=we(),d=we(!1),p=te(()=>t.value instanceof Function),_=te(()=>p.value&&t.value(e.modelValue)||e.modelValue),o=il(()=>{i.value&&(d.value=!0)},50),w=il(()=>{i.value&&(d.value=!1)},50);return{tooltip:s,tooltipVisible:d,formatValue:_,displayTooltip:o,hideTooltip:w}},rae=(e,t,i)=>{const{disabled:s,min:d,max:p,step:_,showTooltip:o,precision:w,sliderSize:C,formatTooltip:M,emitChange:I,resetSize:F,updateDragging:B}=Un(jz),{tooltip:N,tooltipVisible:D,formatValue:j,displayTooltip:U,hideTooltip:ne}=oae(e,M,o),K=we(),G=te(()=>`${(e.modelValue-d.value)/(p.value-d.value)*100}%`),J=te(()=>e.vertical?{bottom:G.value}:{left:G.value}),oe=()=>{t.hovering=!0,U()},se=()=>{t.hovering=!1,t.dragging||ne()},me=ot=>{s.value||(ot.preventDefault(),Ce(ot),window.addEventListener("mousemove",ve),window.addEventListener("touchmove",ve),window.addEventListener("mouseup",Ne),window.addEventListener("touchend",Ne),window.addEventListener("contextmenu",Ne),K.value.focus())},de=ot=>{s.value||(t.newPosition=Number.parseFloat(G.value)+ot/(p.value-d.value)*100,We(t.newPosition),I())},ce=()=>{de(-_.value)},pe=()=>{de(_.value)},ge=()=>{de(-_.value*4)},Re=()=>{de(_.value*4)},Je=()=>{s.value||(We(0),I())},Me=()=>{s.value||(We(100),I())},xe=ot=>{let Oe=!0;switch(ot.code){case Ln.left:case Ln.down:ce();break;case Ln.right:case Ln.up:pe();break;case Ln.home:Je();break;case Ln.end:Me();break;case Ln.pageDown:ge();break;case Ln.pageUp:Re();break;default:Oe=!1;break}Oe&&ot.preventDefault()},Ae=ot=>{let Oe,Ct;return ot.type.startsWith("touch")?(Ct=ot.touches[0].clientY,Oe=ot.touches[0].clientX):(Ct=ot.clientY,Oe=ot.clientX),{clientX:Oe,clientY:Ct}},Ce=ot=>{t.dragging=!0,t.isClick=!0;const{clientX:Oe,clientY:Ct}=Ae(ot);e.vertical?t.startY=Ct:t.startX=Oe,t.startPosition=Number.parseFloat(G.value),t.newPosition=t.startPosition},ve=ot=>{if(t.dragging){t.isClick=!1,U(),F();let Oe;const{clientX:Ct,clientY:Mt}=Ae(ot);e.vertical?(t.currentY=Mt,Oe=(t.startY-t.currentY)/C.value*100):(t.currentX=Ct,Oe=(t.currentX-t.startX)/C.value*100),t.newPosition=t.startPosition+Oe,We(t.newPosition)}},Ne=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||ne(),t.isClick||We(t.newPosition),I()},0),window.removeEventListener("mousemove",ve),window.removeEventListener("touchmove",ve),window.removeEventListener("mouseup",Ne),window.removeEventListener("touchend",Ne),window.removeEventListener("contextmenu",Ne))},We=async ot=>{if(ot===null||Number.isNaN(+ot))return;ot<0?ot=0:ot>100&&(ot=100);const Oe=100/((p.value-d.value)/_.value);let Mt=Math.round(ot/Oe)*Oe*(p.value-d.value)*.01+d.value;Mt=Number.parseFloat(Mt.toFixed(w.value)),Mt!==e.modelValue&&i(Fo,Mt),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await oo(),t.dragging&&U(),N.value.updatePopper()};return tn(()=>t.dragging,ot=>{B(ot)}),qr(K,"touchstart",me,{passive:!1}),{disabled:s,button:K,tooltip:N,tooltipVisible:D,showTooltip:o,wrapperStyle:J,formatValue:j,handleMouseEnter:oe,handleMouseLeave:se,onButtonDown:me,onKeyDown:xe,setPosition:We}},iae=Ze({name:"ElSliderButton"}),aae=Ze({...iae,props:tae,emits:nae,setup(e,{expose:t,emit:i}){const s=e,d=rn("slider"),p=Ir({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:s.modelValue}),{disabled:_,button:o,tooltip:w,showTooltip:C,tooltipVisible:M,wrapperStyle:I,formatValue:F,handleMouseEnter:B,handleMouseLeave:N,onButtonDown:D,onKeyDown:j,setPosition:U}=rae(s,p,i),{hovering:ne,dragging:K}=Ca(p);return t({onButtonDown:D,onKeyDown:j,setPosition:U,hovering:ne,dragging:K}),(G,J)=>(le(),Pe("div",{ref_key:"button",ref:o,class:he([y(d).e("button-wrapper"),{hover:y(ne),dragging:y(K)}]),style:to(y(I)),tabindex:y(_)?-1:0,onMouseenter:y(B),onMouseleave:y(N),onMousedown:y(D),onFocus:y(B),onBlur:y(N),onKeydown:y(j)},[Qe(y(qa),{ref_key:"tooltip",ref:w,visible:y(M),placement:G.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":G.tooltipClass,disabled:!y(C),persistent:y(C)},{content:at(()=>[Ve("span",null,yn(y(F)),1)]),default:at(()=>[Ve("div",{class:he([y(d).e("button"),{hover:y(ne),dragging:y(K)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var KP=xn(aae,[["__file","button.vue"]]);const sae=vn({mark:{type:ut([String,Object]),default:void 0}});var lae=Ze({name:"ElSliderMarker",props:sae,setup(e){const t=rn("slider"),i=te(()=>Zn(e.mark)?e.mark:e.mark.label),s=te(()=>Zn(e.mark)?void 0:e.mark.style);return()=>lo("div",{class:t.e("marks-text"),style:s.value},i.value)}});const cae=(e,t,i)=>{const{form:s,formItem:d}=Ka(),p=gi(),_=we(),o=we(),w={firstButton:_,secondButton:o},C=te(()=>e.disabled||(s==null?void 0:s.disabled)||!1),M=te(()=>Math.min(t.firstValue,t.secondValue)),I=te(()=>Math.max(t.firstValue,t.secondValue)),F=te(()=>e.range?`${100*(I.value-M.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),B=te(()=>e.range?`${100*(M.value-e.min)/(e.max-e.min)}%`:"0%"),N=te(()=>e.vertical?{height:e.height}:{}),D=te(()=>e.vertical?{height:F.value,bottom:B.value}:{width:F.value,left:B.value}),j=()=>{p.value&&(t.sliderSize=p.value[`client${e.vertical?"Height":"Width"}`])},U=ge=>{const Re=e.min+ge*(e.max-e.min)/100;if(!e.range)return _;let Je;return Math.abs(M.value-Re)<Math.abs(I.value-Re)?Je=t.firstValue<t.secondValue?"firstButton":"secondButton":Je=t.firstValue>t.secondValue?"firstButton":"secondButton",w[Je]},ne=ge=>{const Re=U(ge);return Re.value.setPosition(ge),Re},K=ge=>{t.firstValue=ge??e.min,J(e.range?[M.value,I.value]:ge??e.min)},G=ge=>{t.secondValue=ge,e.range&&J([M.value,I.value])},J=ge=>{i(Fo,ge),i(Ga,ge)},oe=async()=>{await oo(),i(Yr,e.range?[M.value,I.value]:e.modelValue)},se=ge=>{var Re,Je,Me,xe,Ae,Ce;if(C.value||t.dragging)return;j();let ve=0;if(e.vertical){const Ne=(Me=(Je=(Re=ge.touches)==null?void 0:Re.item(0))==null?void 0:Je.clientY)!=null?Me:ge.clientY;ve=(p.value.getBoundingClientRect().bottom-Ne)/t.sliderSize*100}else{const Ne=(Ce=(Ae=(xe=ge.touches)==null?void 0:xe.item(0))==null?void 0:Ae.clientX)!=null?Ce:ge.clientX,We=p.value.getBoundingClientRect().left;ve=(Ne-We)/t.sliderSize*100}if(!(ve<0||ve>100))return ne(ve)};return{elFormItem:d,slider:p,firstButton:_,secondButton:o,sliderDisabled:C,minValue:M,maxValue:I,runwayStyle:N,barStyle:D,resetSize:j,setPosition:ne,emitChange:oe,onSliderWrapperPrevent:ge=>{var Re,Je;((Re=w.firstButton.value)!=null&&Re.dragging||(Je=w.secondButton.value)!=null&&Je.dragging)&&ge.preventDefault()},onSliderClick:ge=>{se(ge)&&oe()},onSliderDown:async ge=>{const Re=se(ge);Re&&(await oo(),Re.value.onButtonDown(ge))},onSliderMarkerDown:ge=>{C.value||t.dragging||ne(ge)},setFirstValue:K,setSecondValue:G}},uae=(e,t,i,s)=>({stops:te(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const _=(e.max-e.min)/e.step,o=100*e.step/(e.max-e.min),w=Array.from({length:_-1}).map((C,M)=>(M+1)*o);return e.range?w.filter(C=>C<100*(i.value-e.min)/(e.max-e.min)||C>100*(s.value-e.min)/(e.max-e.min)):w.filter(C=>C>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:_=>e.vertical?{bottom:`${_}%`}:{left:`${_}%`}}),dae=e=>te(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((i,s)=>i-s).filter(i=>i<=e.max&&i>=e.min).map(i=>({point:i,position:(i-e.min)*100/(e.max-e.min),mark:e.marks[i]})):[]),hae=(e,t,i,s,d,p)=>{const _=C=>{d(Fo,C),d(Ga,C)},o=()=>e.range?![i.value,s.value].every((C,M)=>C===t.oldValue[M]):e.modelValue!==t.oldValue,w=()=>{var C,M;e.min>e.max&&ha("Slider","min should not be greater than max.");const I=e.modelValue;e.range&&fn(I)?I[1]<e.min?_([e.min,e.min]):I[0]>e.max?_([e.max,e.max]):I[0]<e.min?_([e.min,I[1]]):I[1]>e.max?_([I[0],e.max]):(t.firstValue=I[0],t.secondValue=I[1],o()&&(e.validateEvent&&((C=p==null?void 0:p.validate)==null||C.call(p,"change").catch(F=>void 0)),t.oldValue=I.slice())):!e.range&&ao(I)&&!Number.isNaN(I)&&(I<e.min?_(e.min):I>e.max?_(e.max):(t.firstValue=I,o()&&(e.validateEvent&&((M=p==null?void 0:p.validate)==null||M.call(p,"change").catch(F=>void 0)),t.oldValue=I)))};w(),tn(()=>t.dragging,C=>{C||w()}),tn(()=>e.modelValue,(C,M)=>{t.dragging||fn(C)&&fn(M)&&C.every((I,F)=>I===M[F])&&t.firstValue===C[0]&&t.secondValue===C[1]||w()},{deep:!0}),tn(()=>[e.min,e.max],()=>{w()})},fae=(e,t,i)=>{const s=we();return No(async()=>{e.range?(fn(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(!ao(e.modelValue)||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),qr(window,"resize",i),await oo(),i()}),{sliderWrapper:s}},pae=Ze({name:"ElSlider"}),mae=Ze({...pae,props:Qie,emits:eae,setup(e,{expose:t,emit:i}){const s=e,d=rn("slider"),{t:p}=vr(),_=Ir({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:o,slider:w,firstButton:C,secondButton:M,sliderDisabled:I,minValue:F,maxValue:B,runwayStyle:N,barStyle:D,resetSize:j,emitChange:U,onSliderWrapperPrevent:ne,onSliderClick:K,onSliderDown:G,onSliderMarkerDown:J,setFirstValue:oe,setSecondValue:se}=cae(s,_,i),{stops:me,getStopStyle:de}=uae(s,_,F,B),{inputId:ce,isLabeledByFormItem:pe}=sc(s,{formItemContext:o}),ge=na(),Re=te(()=>s.inputSize||ge.value),Je=te(()=>s.ariaLabel||p("el.slider.defaultLabel",{min:s.min,max:s.max})),Me=te(()=>s.range?s.rangeStartLabel||p("el.slider.defaultRangeStartLabel"):Je.value),xe=te(()=>s.formatValueText?s.formatValueText(Oe.value):`${Oe.value}`),Ae=te(()=>s.rangeEndLabel||p("el.slider.defaultRangeEndLabel")),Ce=te(()=>s.formatValueText?s.formatValueText(Ct.value):`${Ct.value}`),ve=te(()=>[d.b(),d.m(ge.value),d.is("vertical",s.vertical),{[d.m("with-input")]:s.showInput}]),Ne=dae(s);hae(s,_,F,B,i,o);const We=te(()=>{const bt=[s.min,s.max,s.step].map(Kt=>{const $t=`${Kt}`.split(".")[1];return $t?$t.length:0});return Math.max.apply(null,bt)}),{sliderWrapper:ot}=fae(s,_,j),{firstValue:Oe,secondValue:Ct,sliderSize:Mt}=Ca(_),zt=bt=>{_.dragging=bt};return qr(ot,"touchstart",ne,{passive:!1}),qr(ot,"touchmove",ne,{passive:!1}),or(jz,{...Ca(s),sliderSize:Mt,disabled:I,precision:We,emitChange:U,resetSize:j,updateDragging:zt}),t({onSliderClick:K}),(bt,Kt)=>{var $t,Le;return le(),Pe("div",{id:bt.range?y(ce):void 0,ref_key:"sliderWrapper",ref:ot,class:he(y(ve)),role:bt.range?"group":void 0,"aria-label":bt.range&&!y(pe)?y(Je):void 0,"aria-labelledby":bt.range&&y(pe)?($t=y(o))==null?void 0:$t.labelId:void 0},[Ve("div",{ref_key:"slider",ref:w,class:he([y(d).e("runway"),{"show-input":bt.showInput&&!bt.range},y(d).is("disabled",y(I))]),style:to(y(N)),onMousedown:y(G),onTouchstartPassive:y(G)},[Ve("div",{class:he(y(d).e("bar")),style:to(y(D))},null,6),Qe(KP,{id:bt.range?void 0:y(ce),ref_key:"firstButton",ref:C,"model-value":y(Oe),vertical:bt.vertical,"tooltip-class":bt.tooltipClass,placement:bt.placement,role:"slider","aria-label":bt.range||!y(pe)?y(Me):void 0,"aria-labelledby":!bt.range&&y(pe)?(Le=y(o))==null?void 0:Le.labelId:void 0,"aria-valuemin":bt.min,"aria-valuemax":bt.range?y(Ct):bt.max,"aria-valuenow":y(Oe),"aria-valuetext":y(xe),"aria-orientation":bt.vertical?"vertical":"horizontal","aria-disabled":y(I),"onUpdate:modelValue":y(oe)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),bt.range?(le(),Rt(KP,{key:0,ref_key:"secondButton",ref:M,"model-value":y(Ct),vertical:bt.vertical,"tooltip-class":bt.tooltipClass,placement:bt.placement,role:"slider","aria-label":y(Ae),"aria-valuemin":y(Oe),"aria-valuemax":bt.max,"aria-valuenow":y(Ct),"aria-valuetext":y(Ce),"aria-orientation":bt.vertical?"vertical":"horizontal","aria-disabled":y(I),"onUpdate:modelValue":y(se)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):St("v-if",!0),bt.showStops?(le(),Pe("div",{key:1},[(le(!0),Pe(eo,null,nr(y(me),(dn,At)=>(le(),Pe("div",{key:At,class:he(y(d).e("stop")),style:to(y(de)(dn))},null,6))),128))])):St("v-if",!0),y(Ne).length>0?(le(),Pe(eo,{key:2},[Ve("div",null,[(le(!0),Pe(eo,null,nr(y(Ne),(dn,At)=>(le(),Pe("div",{key:At,style:to(y(de)(dn.position)),class:he([y(d).e("stop"),y(d).e("marks-stop")])},null,6))),128))]),Ve("div",{class:he(y(d).e("marks"))},[(le(!0),Pe(eo,null,nr(y(Ne),(dn,At)=>(le(),Rt(y(lae),{key:At,mark:dn.mark,style:to(y(de)(dn.position)),onMousedown:po(Ke=>y(J)(dn.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):St("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),bt.showInput&&!bt.range?(le(),Rt(y(wz),{key:0,ref:"input","model-value":y(Oe),class:he(y(d).e("input")),step:bt.step,disabled:y(I),controls:bt.showInputControls,min:bt.min,max:bt.max,precision:y(We),debounce:bt.debounce,size:y(Re),"onUpdate:modelValue":y(oe),onChange:y(U)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):St("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var gae=xn(mae,[["__file","slider.vue"]]);const vae=Ao(gae),_ae=vn({prefixCls:{type:String}}),ZP=Ze({name:"ElSpaceItem",props:_ae,setup(e,{slots:t}){const i=rn("space"),s=te(()=>`${e.prefixCls||i.b()}__item`);return()=>lo("div",{class:s.value},_t(t,"default"))}}),YP={small:8,default:12,large:16};function yae(e){const t=rn("space"),i=te(()=>[t.b(),t.m(e.direction),e.class]),s=we(0),d=we(0),p=te(()=>{const o=e.wrap||e.fill?{flexWrap:"wrap"}:{},w={alignItems:e.alignment},C={rowGap:`${d.value}px`,columnGap:`${s.value}px`};return[o,w,C,e.style]}),_=te(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return Ha(()=>{const{size:o="small",wrap:w,direction:C,fill:M}=e;if(fn(o)){const[I=0,F=0]=o;s.value=I,d.value=F}else{let I;ao(o)?I=o:I=YP[o||"small"]||YP.small,(w||M)&&C==="horizontal"?s.value=d.value=I:C==="horizontal"?(s.value=I,d.value=0):(d.value=I,s.value=0)}}),{classes:i,containerStyle:p,itemStyle:_}}const bae=vn({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:ut([String,Object,Array]),default:""},style:{type:ut([String,Array,Object]),default:""},alignment:{type:ut(String),default:"center"},prefixCls:{type:String},spacer:{type:ut([Object,String,Number,Array]),default:null,validator:e=>Ai(e)||ao(e)||Zn(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:Lu,validator:e=>ao(e)||fn(e)&&e.length===2&&e.every(ao)}}),xae=Ze({name:"ElSpace",props:bae,setup(e,{slots:t}){const{classes:i,containerStyle:s,itemStyle:d}=yae(e);function p(_,o="",w=[]){const{prefixCls:C}=e;return _.forEach((M,I)=>{L2(M)?fn(M.children)&&M.children.forEach((F,B)=>{L2(F)&&fn(F.children)?p(F.children,`${o+B}-`,w):w.push(Qe(ZP,{style:d.value,prefixCls:C,key:`nested-${o+B}`},{default:()=>[F]},Yl.PROPS|Yl.STYLE,["style","prefixCls"]))}):fY(M)&&w.push(Qe(ZP,{style:d.value,prefixCls:C,key:`LoopKey${o+I}`},{default:()=>[M]},Yl.PROPS|Yl.STYLE,["style","prefixCls"]))}),w}return()=>{var _;const{spacer:o,direction:w}=e,C=_t(t,"default",{key:0},()=>[]);if(((_=C.children)!=null?_:[]).length===0)return null;if(fn(C.children)){let M=p(C.children);if(o){const I=M.length-1;M=M.reduce((F,B,N)=>{const D=[...F,B];return N!==I&&D.push(Qe("span",{style:[d.value,w==="vertical"?"width: 100%":null],key:N},[Ai(o)?o:Qo(o,Yl.TEXT)],Yl.STYLE)),D},[])}return Qe("div",{class:i.value,style:s.value},M,Yl.STYLE|Yl.CLASS)}return C.children}}}),wae=Ao(xae),Sae=vn({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:ut([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:ut([String,Object,Array])}}),Tae=Ze({name:"ElStatistic"}),Cae=Ze({...Tae,props:Sae,setup(e,{expose:t}){const i=e,s=rn("statistic"),d=te(()=>{const{value:p,formatter:_,precision:o,decimalSeparator:w,groupSeparator:C}=i;if(Qn(_))return _(p);if(!ao(p)||Number.isNaN(p))return p;let[M,I=""]=String(p).split(".");return I=I.padEnd(o,"0").slice(0,o>0?o:0),M=M.replace(/\B(?=(\d{3})+(?!\d))/g,C),[M,I].join(I?w:"")});return t({displayValue:d}),(p,_)=>(le(),Pe("div",{class:he(y(s).b())},[p.$slots.title||p.title?(le(),Pe("div",{key:0,class:he(y(s).e("head"))},[_t(p.$slots,"title",{},()=>[Qo(yn(p.title),1)])],2)):St("v-if",!0),Ve("div",{class:he(y(s).e("content"))},[p.$slots.prefix||p.prefix?(le(),Pe("div",{key:0,class:he(y(s).e("prefix"))},[_t(p.$slots,"prefix",{},()=>[Ve("span",null,yn(p.prefix),1)])],2)):St("v-if",!0),Ve("span",{class:he(y(s).e("number")),style:to(p.valueStyle)},yn(y(d)),7),p.$slots.suffix||p.suffix?(le(),Pe("div",{key:1,class:he(y(s).e("suffix"))},[_t(p.$slots,"suffix",{},()=>[Ve("span",null,yn(p.suffix),1)])],2)):St("v-if",!0)],2)],2))}});var Eae=xn(Cae,[["__file","statistic.vue"]]);const Hz=Ao(Eae),Mae=vn({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:ut([Number,Object]),default:0},valueStyle:{type:ut([String,Object,Array])}}),Iae={finish:()=>!0,[Yr]:e=>ao(e)},Aae=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],XP=e=>ao(e)?new Date(e).getTime():e.valueOf(),JP=(e,t)=>{let i=e;const s=/\[([^\]]*)]/g;return Aae.reduce((p,[_,o])=>{const w=new RegExp(`${_}+(?![^\\[\\]]*\\])`,"g");if(w.test(p)){const C=Math.floor(i/o);return i-=C*o,p.replace(w,M=>String(C).padStart(M.length,"0"))}return p},t).replace(s,"$1")},kae=Ze({name:"ElCountdown"}),Pae=Ze({...kae,props:Mae,emits:Iae,setup(e,{expose:t,emit:i}){const s=e;let d;const p=we(0),_=te(()=>JP(p.value,s.format)),o=M=>JP(M,s.format),w=()=>{d&&(Gf(d),d=void 0)},C=()=>{const M=XP(s.value),I=()=>{let F=M-Date.now();i("change",F),F<=0?(F=0,w(),i("finish")):d=wh(I),p.value=F};d=wh(I)};return No(()=>{p.value=XP(s.value)-Date.now(),tn(()=>[s.value,s.format],()=>{w(),C()},{immediate:!0})}),ni(()=>{w()}),t({displayValue:_}),(M,I)=>(le(),Rt(y(Hz),{value:p.value,title:M.title,prefix:M.prefix,suffix:M.suffix,"value-style":M.valueStyle,formatter:o},nc({_:2},[nr(M.$slots,(F,B)=>({name:B,fn:at(()=>[_t(M.$slots,B)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var Rae=xn(Pae,[["__file","countdown.vue"]]);const Lae=Ao(Rae),Oae=vn({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),Dae={[Yr]:(e,t)=>[e,t].every(ao)},zae=Ze({name:"ElSteps"}),Fae=Ze({...zae,props:Oae,emits:Dae,setup(e,{emit:t}){const i=e,s=rn("steps"),{children:d,addChild:p,removeChild:_}=BT(jo(),"ElStep");return tn(d,()=>{d.value.forEach((o,w)=>{o.setIndex(w)})}),or("ElSteps",{props:i,steps:d,addStep:p,removeStep:_}),tn(()=>i.active,(o,w)=>{t(Yr,o,w)}),(o,w)=>(le(),Pe("div",{class:he([y(s).b(),y(s).m(o.simple?"simple":o.direction)])},[_t(o.$slots,"default")],2))}});var Bae=xn(Fae,[["__file","steps.vue"]]);const Nae=vn({title:{type:String,default:""},icon:{type:Xr},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),$ae=Ze({name:"ElStep"}),Vae=Ze({...$ae,props:Nae,setup(e){const t=e,i=rn("step"),s=we(-1),d=we({}),p=we(""),_=Un("ElSteps"),o=jo();No(()=>{tn([()=>_.props.active,()=>_.props.processStatus,()=>_.props.finishStatus],([oe])=>{G(oe)},{immediate:!0})}),ni(()=>{_.removeStep(J.uid)});const w=te(()=>t.status||p.value),C=te(()=>{const oe=_.steps.value[s.value-1];return oe?oe.currentStatus:"wait"}),M=te(()=>_.props.alignCenter),I=te(()=>_.props.direction==="vertical"),F=te(()=>_.props.simple),B=te(()=>_.steps.value.length),N=te(()=>{var oe;return((oe=_.steps.value[B.value-1])==null?void 0:oe.uid)===(o==null?void 0:o.uid)}),D=te(()=>F.value?"":_.props.space),j=te(()=>[i.b(),i.is(F.value?"simple":_.props.direction),i.is("flex",N.value&&!D.value&&!M.value),i.is("center",M.value&&!I.value&&!F.value)]),U=te(()=>{const oe={flexBasis:ao(D.value)?`${D.value}px`:D.value?D.value:`${100/(B.value-(M.value?0:1))}%`};return I.value||N.value&&(oe.maxWidth=`${100/B.value}%`),oe}),ne=oe=>{s.value=oe},K=oe=>{const se=oe==="wait",me={transitionDelay:`${se?"-":""}${150*s.value}ms`},de=oe===_.props.processStatus||se?0:100;me.borderWidth=de&&!F.value?"1px":0,me[_.props.direction==="vertical"?"height":"width"]=`${de}%`,d.value=me},G=oe=>{oe>s.value?p.value=_.props.finishStatus:oe===s.value&&C.value!=="error"?p.value=_.props.processStatus:p.value="wait";const se=_.steps.value[s.value-1];se&&se.calcProgress(p.value)},J=Ir({uid:o.uid,currentStatus:w,setIndex:ne,calcProgress:K});return _.addStep(J),(oe,se)=>(le(),Pe("div",{style:to(y(U)),class:he(y(j))},[St(" icon & line "),Ve("div",{class:he([y(i).e("head"),y(i).is(y(w))])},[y(F)?St("v-if",!0):(le(),Pe("div",{key:0,class:he(y(i).e("line"))},[Ve("i",{class:he(y(i).e("line-inner")),style:to(d.value)},null,6)],2)),Ve("div",{class:he([y(i).e("icon"),y(i).is(oe.icon||oe.$slots.icon?"icon":"text")])},[_t(oe.$slots,"icon",{},()=>[oe.icon?(le(),Rt(y(Gn),{key:0,class:he(y(i).e("icon-inner"))},{default:at(()=>[(le(),Rt(Wo(oe.icon)))]),_:1},8,["class"])):y(w)==="success"?(le(),Rt(y(Gn),{key:1,class:he([y(i).e("icon-inner"),y(i).is("status")])},{default:at(()=>[Qe(y(U_))]),_:1},8,["class"])):y(w)==="error"?(le(),Rt(y(Gn),{key:2,class:he([y(i).e("icon-inner"),y(i).is("status")])},{default:at(()=>[Qe(y(Xc))]),_:1},8,["class"])):y(F)?St("v-if",!0):(le(),Pe("div",{key:3,class:he(y(i).e("icon-inner"))},yn(s.value+1),3))])],2)],2),St(" title & description "),Ve("div",{class:he(y(i).e("main"))},[Ve("div",{class:he([y(i).e("title"),y(i).is(y(w))])},[_t(oe.$slots,"title",{},()=>[Qo(yn(oe.title),1)])],2),y(F)?(le(),Pe("div",{key:0,class:he(y(i).e("arrow"))},null,2)):(le(),Pe("div",{key:1,class:he([y(i).e("description"),y(i).is(y(w))])},[_t(oe.$slots,"description",{},()=>[Qo(yn(oe.description),1)])],2))],2)],6))}});var Gz=xn(Vae,[["__file","item.vue"]]);const Uae=Ao(Bae,{Step:Gz}),jae=Li(Gz),Wz=e=>["",...Lu].includes(e),Hae=vn({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:Wz},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:Xr},activeActionIcon:{type:Xr},activeIcon:{type:Xr},inactiveIcon:{type:Xr},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:ut(Function)},id:String,tabindex:{type:[String,Number]},...Da(["ariaLabel"])}),Gae={[Fo]:e=>ai(e)||Zn(e)||ao(e),[Yr]:e=>ai(e)||Zn(e)||ao(e),[Ga]:e=>ai(e)||Zn(e)||ao(e)},qz="ElSwitch",Wae=Ze({name:qz}),qae=Ze({...Wae,props:Hae,emits:Gae,setup(e,{expose:t,emit:i}){const s=e,{formItem:d}=Ka(),p=na(),_=rn("switch"),{inputId:o}=sc(s,{formItemContext:d}),w=Za(te(()=>s.loading)),C=we(s.modelValue!==!1),M=we(),I=we(),F=te(()=>[_.b(),_.m(p.value),_.is("disabled",w.value),_.is("checked",U.value)]),B=te(()=>[_.e("label"),_.em("label","left"),_.is("active",!U.value)]),N=te(()=>[_.e("label"),_.em("label","right"),_.is("active",U.value)]),D=te(()=>({width:ji(s.width)}));tn(()=>s.modelValue,()=>{C.value=!0});const j=te(()=>C.value?s.modelValue:!1),U=te(()=>j.value===s.activeValue);[s.activeValue,s.inactiveValue].includes(j.value)||(i(Fo,s.inactiveValue),i(Yr,s.inactiveValue),i(Ga,s.inactiveValue)),tn(U,J=>{var oe;M.value.checked=J,s.validateEvent&&((oe=d==null?void 0:d.validate)==null||oe.call(d,"change").catch(se=>void 0))});const ne=()=>{const J=U.value?s.inactiveValue:s.activeValue;i(Fo,J),i(Yr,J),i(Ga,J),oo(()=>{M.value.checked=U.value})},K=()=>{if(w.value)return;const{beforeChange:J}=s;if(!J){ne();return}const oe=J();[o_(oe),ai(oe)].includes(!0)||ha(qz,"beforeChange must return type `Promise<boolean>` or `boolean`"),o_(oe)?oe.then(me=>{me&&ne()}).catch(me=>{}):oe&&ne()},G=()=>{var J,oe;(oe=(J=M.value)==null?void 0:J.focus)==null||oe.call(J)};return No(()=>{M.value.checked=U.value}),t({focus:G,checked:U}),(J,oe)=>(le(),Pe("div",{class:he(y(F)),onClick:po(K,["prevent"])},[Ve("input",{id:y(o),ref_key:"input",ref:M,class:he(y(_).e("input")),type:"checkbox",role:"switch","aria-checked":y(U),"aria-disabled":y(w),"aria-label":J.ariaLabel,name:J.name,"true-value":J.activeValue,"false-value":J.inactiveValue,disabled:y(w),tabindex:J.tabindex,onChange:ne,onKeydown:ti(K,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!J.inlinePrompt&&(J.inactiveIcon||J.inactiveText)?(le(),Pe("span",{key:0,class:he(y(B))},[J.inactiveIcon?(le(),Rt(y(Gn),{key:0},{default:at(()=>[(le(),Rt(Wo(J.inactiveIcon)))]),_:1})):St("v-if",!0),!J.inactiveIcon&&J.inactiveText?(le(),Pe("span",{key:1,"aria-hidden":y(U)},yn(J.inactiveText),9,["aria-hidden"])):St("v-if",!0)],2)):St("v-if",!0),Ve("span",{ref_key:"core",ref:I,class:he(y(_).e("core")),style:to(y(D))},[J.inlinePrompt?(le(),Pe("div",{key:0,class:he(y(_).e("inner"))},[J.activeIcon||J.inactiveIcon?(le(),Rt(y(Gn),{key:0,class:he(y(_).is("icon"))},{default:at(()=>[(le(),Rt(Wo(y(U)?J.activeIcon:J.inactiveIcon)))]),_:1},8,["class"])):J.activeText||J.inactiveText?(le(),Pe("span",{key:1,class:he(y(_).is("text")),"aria-hidden":!y(U)},yn(y(U)?J.activeText:J.inactiveText),11,["aria-hidden"])):St("v-if",!0)],2)):St("v-if",!0),Ve("div",{class:he(y(_).e("action"))},[J.loading?(le(),Rt(y(Gn),{key:0,class:he(y(_).is("loading"))},{default:at(()=>[Qe(y(Iu))]),_:1},8,["class"])):y(U)?_t(J.$slots,"active-action",{key:1},()=>[J.activeActionIcon?(le(),Rt(y(Gn),{key:0},{default:at(()=>[(le(),Rt(Wo(J.activeActionIcon)))]),_:1})):St("v-if",!0)]):y(U)?St("v-if",!0):_t(J.$slots,"inactive-action",{key:2},()=>[J.inactiveActionIcon?(le(),Rt(y(Gn),{key:0},{default:at(()=>[(le(),Rt(Wo(J.inactiveActionIcon)))]),_:1})):St("v-if",!0)])],2)],6),!J.inlinePrompt&&(J.activeIcon||J.activeText)?(le(),Pe("span",{key:1,class:he(y(N))},[J.activeIcon?(le(),Rt(y(Gn),{key:0},{default:at(()=>[(le(),Rt(Wo(J.activeIcon)))]),_:1})):St("v-if",!0),!J.activeIcon&&J.activeText?(le(),Pe("span",{key:1,"aria-hidden":!y(U)},yn(J.activeText),9,["aria-hidden"])):St("v-if",!0)],2)):St("v-if",!0)],10,["onClick"]))}});var Kae=xn(qae,[["__file","switch.vue"]]);const Zae=Ao(Kae),Zw=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},Yae=function(e,t,i,s,d){if(!t&&!s&&(!d||fn(d)&&!d.length))return e;Zn(i)?i=i==="descending"?-1:1:i=i&&i<0?-1:1;const p=s?null:function(o,w){return d?(fn(d)||(d=[d]),d.map(C=>Zn(C)?Ji(o,C):C(o,w,e))):(t!=="$key"&&Vo(o)&&"$value"in o&&(o=o.$value),[Vo(o)?Ji(o,t):o])},_=function(o,w){if(s)return s(o.value,w.value);for(let C=0,M=o.key.length;C<M;C++){if(o.key[C]<w.key[C])return-1;if(o.key[C]>w.key[C])return 1}return 0};return e.map((o,w)=>({value:o,index:w,key:p?p(o,w):null})).sort((o,w)=>{let C=_(o,w);return C||(C=o.index-w.index),C*+i}).map(o=>o.value)},Kz=function(e,t){let i=null;return e.columns.forEach(s=>{s.id===t&&(i=s)}),i},Xae=function(e,t){let i=null;for(let s=0;s<e.columns.length;s++){const d=e.columns[s];if(d.columnKey===t){i=d;break}}return i||ha("ElTable",`No column matching with column-key: ${t}`),i},QP=function(e,t,i){const s=(t.className||"").match(new RegExp(`${i}-table_[^\\s]+`,"gm"));return s?Kz(e,s[0]):null},hs=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(Zn(t)){if(!t.includes("."))return`${e[t]}`;const i=t.split(".");let s=e;for(const d of i)s=s[d];return`${s}`}else if(Qn(t))return t.call(null,e)},Pf=function(e,t){const i={};return(e||[]).forEach((s,d)=>{i[hs(s,t)]={row:s,index:d}}),i};function Jae(e,t){const i={};let s;for(s in e)i[s]=e[s];for(s in t)if(Tr(t,s)){const d=t[s];typeof d<"u"&&(i[s]=d)}return i}function cC(e){return e===""||e!==void 0&&(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function Zz(e){return e===""||e!==void 0&&(e=cC(e),Number.isNaN(e)&&(e=80)),e}function Qae(e){return ao(e)?e:Zn(e)?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function ese(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,i)=>(...s)=>t(i(...s)))}function $b(e,t,i,s,d,p){let _=p??0,o=!1;const w=e.indexOf(t),C=w!==-1,M=d==null?void 0:d.call(null,t,p),I=B=>{B==="add"?e.push(t):e.splice(w,1),o=!0},F=B=>{let N=0;const D=(s==null?void 0:s.children)&&B[s.children];return D&&fn(D)&&(N+=D.length,D.forEach(j=>{N+=F(j)})),N};return(!d||M)&&(ai(i)?i&&!C?I("add"):!i&&C&&I("remove"):I(C?"remove":"add")),!(s!=null&&s.checkStrictly)&&(s!=null&&s.children)&&fn(t[s.children])&&t[s.children].forEach(B=>{$b(e,B,i??!C,s,d,_+1),_+=F(B)+1}),o}function tse(e,t,i="children",s="hasChildren"){const d=_=>!(fn(_)&&_.length);function p(_,o,w){t(_,o,w),o.forEach(C=>{if(C[s]){t(C,null,w+1);return}const M=C[i];d(M)||p(C,M,w+1)})}e.forEach(_=>{if(_[s]){t(_,null,0);return}const o=_[i];d(o)||p(_,o,0)})}const e3=(e,t)=>({content:t,...e,popperOptions:{strategy:"fixed",...e.popperOptions}});let Zl=null;function nse(e,t,i,s){if((Zl==null?void 0:Zl.trigger)===i){nO(Zl.vm.component.props,e3(e,t));return}Zl==null||Zl();const d=s==null?void 0:s.refs.tableWrapper,p=d==null?void 0:d.dataset.prefix,_=Qe(qa,{virtualTriggering:!0,virtualRef:i,appendTo:d,placement:"top",transition:"none",offset:0,hideAfter:0,...e3(e,t)});_.appContext={...s.appContext,...s};const o=document.createElement("div");bh(_,o),_.component.exposed.onOpen();const w=d==null?void 0:d.querySelector(`.${p}-scrollbar__wrap`);Zl=()=>{bh(null,o),w==null||w.removeEventListener("scroll",Zl),Zl=null},Zl.trigger=i,Zl.vm=_,w==null||w.addEventListener("scroll",Zl)}function Yz(e){return e.children?dG(e.children,Yz):[e]}function t3(e,t){return e+t.colSpan}const Xz=(e,t,i,s)=>{let d=0,p=e;const _=i.states.columns.value;if(s){const w=Yz(s[e]);d=_.slice(0,_.indexOf(w[0])).reduce(t3,0),p=d+w.reduce(t3,0)-1}else d=e;let o;switch(t){case"left":p<i.states.fixedLeafColumnsLength.value&&(o="left");break;case"right":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(o="right");break;default:p<i.states.fixedLeafColumnsLength.value?o="left":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(o="right")}return o?{direction:o,start:d,after:p}:{}},uC=(e,t,i,s,d,p=0)=>{const _=[],{direction:o,start:w,after:C}=Xz(t,i,s,d);if(o){const M=o==="left";_.push(`${e}-fixed-column--${o}`),M&&C+p===s.states.fixedLeafColumnsLength.value-1?_.push("is-last-column"):!M&&w-p===s.states.columns.value.length-s.states.rightFixedLeafColumnsLength.value&&_.push("is-first-column")}return _};function n3(e,t){return e+(t.realWidth===null||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const dC=(e,t,i,s)=>{const{direction:d,start:p=0,after:_=0}=Xz(e,t,i,s);if(!d)return;const o={},w=d==="left",C=i.states.columns.value;return w?o.left=C.slice(0,p).reduce(n3,0):o.right=C.slice(_+1).reverse().reduce(n3,0),o},Dm=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function ose(e){const t=jo(),i=we(!1),s=we([]);return{updateExpandRows:()=>{const w=e.data.value||[],C=e.rowKey.value;if(i.value)s.value=w.slice();else if(C){const M=Pf(s.value,C);s.value=w.reduce((I,F)=>{const B=hs(F,C);return M[B]&&I.push(F),I},[])}else s.value=[]},toggleRowExpansion:(w,C)=>{$b(s.value,w,C)&&t.emit("expand-change",w,s.value.slice())},setExpandRowKeys:w=>{t.store.assertRowKey();const C=e.data.value||[],M=e.rowKey.value,I=Pf(C,M);s.value=w.reduce((F,B)=>{const N=I[B];return N&&F.push(N.row),F},[])},isRowExpanded:w=>{const C=e.rowKey.value;return C?!!Pf(s.value,C)[hs(w,C)]:s.value.includes(w)},states:{expandRows:s,defaultExpandAll:i}}}function rse(e){const t=jo(),i=we(null),s=we(null),d=C=>{t.store.assertRowKey(),i.value=C,_(C)},p=()=>{i.value=null},_=C=>{const{data:M,rowKey:I}=e;let F=null;I.value&&(F=(y(M)||[]).find(B=>hs(B,I.value)===C)),s.value=F,t.emit("current-change",s.value,null)};return{setCurrentRowKey:d,restoreCurrentRowKey:p,setCurrentRowByKey:_,updateCurrentRow:C=>{const M=s.value;if(C&&C!==M){s.value=C,t.emit("current-change",s.value,M);return}!C&&M&&(s.value=null,t.emit("current-change",null,M))},updateCurrentRowData:()=>{const C=e.rowKey.value,M=e.data.value||[],I=s.value;if(!M.includes(I)&&I){if(C){const F=hs(I,C);_(F)}else s.value=null;s.value===null&&t.emit("current-change",null,I)}else i.value&&(_(i.value),p())},states:{_currentRowKey:i,currentRow:s}}}function ise(e){const t=we([]),i=we({}),s=we(16),d=we(!1),p=we({}),_=we("hasChildren"),o=we("children"),w=we(!1),C=jo(),M=te(()=>{if(!e.rowKey.value)return{};const K=e.data.value||[];return F(K)}),I=te(()=>{const K=e.rowKey.value,G=Object.keys(p.value),J={};return G.length&&G.forEach(oe=>{if(p.value[oe].length){const se={children:[]};p.value[oe].forEach(me=>{const de=hs(me,K);se.children.push(de),me[_.value]&&!J[de]&&(J[de]={children:[]})}),J[oe]=se}}),J}),F=K=>{const G=e.rowKey.value,J={};return tse(K,(oe,se,me)=>{const de=hs(oe,G);fn(se)?J[de]={children:se.map(ce=>hs(ce,G)),level:me}:d.value&&(J[de]={children:[],lazy:!0,level:me})},o.value,_.value),J},B=(K=!1,G=(J=>(J=C.store)==null?void 0:J.states.defaultExpandAll.value)())=>{var J;const oe=M.value,se=I.value,me=Object.keys(oe),de={};if(me.length){const ce=y(i),pe=[],ge=(Je,Me)=>{if(K)return t.value?G||t.value.includes(Me):!!(G||Je!=null&&Je.expanded);{const xe=G||t.value&&t.value.includes(Me);return!!(Je!=null&&Je.expanded||xe)}};me.forEach(Je=>{const Me=ce[Je],xe={...oe[Je]};if(xe.expanded=ge(Me,Je),xe.lazy){const{loaded:Ae=!1,loading:Ce=!1}=Me||{};xe.loaded=!!Ae,xe.loading=!!Ce,pe.push(Je)}de[Je]=xe});const Re=Object.keys(se);d.value&&Re.length&&pe.length&&Re.forEach(Je=>{const Me=ce[Je],xe=se[Je].children;if(pe.includes(Je)){if(de[Je].children.length!==0)throw new Error("[ElTable]children must be an empty array.");de[Je].children=xe}else{const{loaded:Ae=!1,loading:Ce=!1}=Me||{};de[Je]={lazy:!0,loaded:!!Ae,loading:!!Ce,expanded:ge(Me,Je),children:xe,level:""}}})}i.value=de,(J=C.store)==null||J.updateTableScrollY()};tn(()=>t.value,()=>{B(!0)}),tn(()=>M.value,()=>{B()}),tn(()=>I.value,()=>{B()});const N=K=>{t.value=K,B()},D=(K,G)=>{C.store.assertRowKey();const J=e.rowKey.value,oe=hs(K,J),se=oe&&i.value[oe];if(oe&&se&&"expanded"in se){const me=se.expanded;G=Hr(G)?!se.expanded:G,i.value[oe].expanded=G,me!==G&&C.emit("expand-change",K,G),C.store.updateTableScrollY()}},j=K=>{C.store.assertRowKey();const G=e.rowKey.value,J=hs(K,G),oe=i.value[J];d.value&&oe&&"loaded"in oe&&!oe.loaded?U(K,J,oe):D(K,void 0)},U=(K,G,J)=>{const{load:oe}=C.props;oe&&!i.value[G].loaded&&(i.value[G].loading=!0,oe(K,J,se=>{if(!fn(se))throw new TypeError("[ElTable] data must be an array");i.value[G].loading=!1,i.value[G].loaded=!0,i.value[G].expanded=!0,se.length&&(p.value[G]=se),C.emit("expand-change",K,!0)}))};return{loadData:U,loadOrToggle:j,toggleTreeExpansion:D,updateTreeExpandKeys:N,updateTreeData:B,updateKeyChildren:(K,G)=>{const{lazy:J,rowKey:oe}=C.props;if(J){if(!oe)throw new Error("[Table] rowKey is required in updateKeyChild");p.value[K]&&(p.value[K]=G)}},normalize:F,states:{expandRowKeys:t,treeData:i,indent:s,lazy:d,lazyTreeNodeMap:p,lazyColumnIdentifier:_,childrenColumnName:o,checkStrictly:w}}}const ase=(e,t)=>{const i=t.sortingColumn;return!i||Zn(i.sortable)?e:Yae(e,t.sortProp,t.sortOrder,i.sortMethod,i.sortBy)},ob=e=>{const t=[];return e.forEach(i=>{i.children&&i.children.length>0?t.push.apply(t,ob(i.children)):t.push(i)}),t};function sse(){var e;const t=jo(),{size:i}=Ca((e=t.proxy)==null?void 0:e.$props),s=we(null),d=we([]),p=we([]),_=we(!1),o=we([]),w=we([]),C=we([]),M=we([]),I=we([]),F=we([]),B=we([]),N=we([]),D=[],j=we(0),U=we(0),ne=we(0),K=we(!1),G=we([]),J=we(!1),oe=we(!1),se=we(null),me=we({}),de=we(null),ce=we(null),pe=we(null),ge=we(null),Re=we(null);tn(d,()=>{var Dt;t.state&&(Ce(!1),t.props.tableLayout==="auto"&&((Dt=t.refs.tableHeaderRef)==null||Dt.updateFixedColumnStyle()))},{deep:!0});const Je=()=>{if(!s.value)throw new Error("[ElTable] prop row-key is required")},Me=Dt=>{var En;(En=Dt.children)==null||En.forEach(ft=>{ft.fixed=Dt.fixed,Me(ft)})};let xe;const Ae=()=>{o.value.forEach(et=>{Me(et)}),M.value=o.value.filter(et=>et.fixed===!0||et.fixed==="left"),I.value=o.value.filter(et=>et.fixed==="right"),Hr(xe)&&o.value[0]&&o.value[0].type==="selection"&&(xe=!!o.value[0].fixed),M.value.length>0&&o.value[0]&&o.value[0].type==="selection"&&(o.value[0].fixed?M.value.some(Mn=>Mn.type!=="selection")?xe=void 0:(o.value[0].fixed=xe,xe||M.value.shift()):(o.value[0].fixed=!0,M.value.unshift(o.value[0])));const Dt=o.value.filter(et=>!et.fixed);w.value=[].concat(M.value).concat(Dt).concat(I.value);const En=ob(Dt),ft=ob(M.value),un=ob(I.value);j.value=En.length,U.value=ft.length,ne.value=un.length,C.value=[].concat(ft).concat(En).concat(un),_.value=M.value.length>0||I.value.length>0},Ce=(Dt,En=!1)=>{Dt&&Ae(),En?t.state.doLayout():t.state.debouncedUpdateLayout()},ve=Dt=>G.value.some(En=>La(En,Dt)),Ne=()=>{K.value=!1;const Dt=G.value;G.value=[],Dt.length&&t.emit("selection-change",[])},We=()=>{let Dt;if(s.value){Dt=[];const En=Pf(G.value,s.value),ft=Pf(d.value,s.value);for(const un in En)Tr(En,un)&&!ft[un]&&Dt.push(En[un].row)}else Dt=G.value.filter(En=>!d.value.includes(En));if(Dt.length){const En=G.value.filter(ft=>!Dt.includes(ft));G.value=En,t.emit("selection-change",En.slice())}},ot=()=>(G.value||[]).slice(),Oe=(Dt,En,ft=!0,un=!1)=>{var et,Mn,Bn,Lo;const Rr={children:(Mn=(et=t==null?void 0:t.store)==null?void 0:et.states)==null?void 0:Mn.childrenColumnName.value,checkStrictly:(Lo=(Bn=t==null?void 0:t.store)==null?void 0:Bn.states)==null?void 0:Lo.checkStrictly.value};if($b(G.value,Dt,En,Rr,un?void 0:se.value)){const Er=(G.value||[]).slice();ft&&t.emit("select",Er,Dt),t.emit("selection-change",Er)}},Ct=()=>{var Dt,En;const ft=oe.value?!K.value:!(K.value||G.value.length);K.value=ft;let un=!1,et=0;const Mn=(En=(Dt=t==null?void 0:t.store)==null?void 0:Dt.states)==null?void 0:En.rowKey.value,{childrenColumnName:Bn}=t.store.states,Lo={children:Bn.value,checkStrictly:!1};d.value.forEach((Rr,hi)=>{const Er=hi+et;$b(G.value,Rr,ft,Lo,se.value,Er)&&(un=!0),et+=bt(hs(Rr,Mn))}),un&&t.emit("selection-change",G.value?G.value.slice():[]),t.emit("select-all",(G.value||[]).slice())},Mt=()=>{const Dt=Pf(G.value,s.value);d.value.forEach(En=>{const ft=hs(En,s.value),un=Dt[ft];un&&(G.value[un.index]=En)})},zt=()=>{var Dt;if(((Dt=d.value)==null?void 0:Dt.length)===0){K.value=!1;return}const{childrenColumnName:En}=t.store.states,ft=s.value?Pf(G.value,s.value):void 0;let un=0,et=0;const Mn=Rr=>ft?!!ft[hs(Rr,s.value)]:G.value.includes(Rr),Bn=Rr=>{var hi;for(const Er of Rr){const Nr=se.value&&se.value.call(null,Er,un);if(Mn(Er))et++;else if(!se.value||Nr)return!1;if(un++,(hi=Er[En.value])!=null&&hi.length&&!Bn(Er[En.value]))return!1}return!0},Lo=Bn(d.value||[]);K.value=et===0?!1:Lo},bt=Dt=>{var En;if(!t||!t.store)return 0;const{treeData:ft}=t.store.states;let un=0;const et=(En=ft.value[Dt])==null?void 0:En.children;return et&&(un+=et.length,et.forEach(Mn=>{un+=bt(Mn)})),un},Kt=(Dt,En)=>{fn(Dt)||(Dt=[Dt]);const ft={};return Dt.forEach(un=>{me.value[un.id]=En,ft[un.columnKey||un.id]=En}),ft},$t=(Dt,En,ft)=>{ce.value&&ce.value!==Dt&&(ce.value.order=null),ce.value=Dt,pe.value=En,ge.value=ft},Le=()=>{let Dt=y(p);Object.keys(me.value).forEach(En=>{const ft=me.value[En];if(!ft||ft.length===0)return;const un=Kz({columns:C.value},En);un&&un.filterMethod&&(Dt=Dt.filter(et=>ft.some(Mn=>un.filterMethod.call(null,Mn,et,un))))}),de.value=Dt},dn=()=>{d.value=ase(de.value,{sortingColumn:ce.value,sortProp:pe.value,sortOrder:ge.value})},At=(Dt=void 0)=>{Dt&&Dt.filter||Le(),dn()},Ke=Dt=>{const{tableHeaderRef:En}=t.refs;if(!En)return;const ft=Object.assign({},En.filterPanels),un=Object.keys(ft);if(un.length)if(Zn(Dt)&&(Dt=[Dt]),fn(Dt)){const et=Dt.map(Mn=>Xae({columns:C.value},Mn));un.forEach(Mn=>{const Bn=et.find(Lo=>Lo.id===Mn);Bn&&(Bn.filteredValue=[])}),t.store.commit("filterChange",{column:et,values:[],silent:!0,multi:!0})}else un.forEach(et=>{const Mn=C.value.find(Bn=>Bn.id===et);Mn&&(Mn.filteredValue=[])}),me.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},Be=()=>{ce.value&&($t(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Ht,toggleRowExpansion:Ut,updateExpandRows:Nt,states:Et,isRowExpanded:Gt}=ose({data:d,rowKey:s}),{updateTreeExpandKeys:ln,toggleTreeExpansion:bn,updateTreeData:_n,updateKeyChildren:jn,loadOrToggle:yt,states:kn}=ise({data:d,rowKey:s}),{updateCurrentRowData:qn,updateCurrentRow:Co,setCurrentRowKey:mo,states:Io}=rse({data:d,rowKey:s});return{assertRowKey:Je,updateColumns:Ae,scheduleLayout:Ce,isSelected:ve,clearSelection:Ne,cleanSelection:We,getSelectionRows:ot,toggleRowSelection:Oe,_toggleAllSelection:Ct,toggleAllSelection:null,updateSelectionByRowKey:Mt,updateAllSelected:zt,updateFilters:Kt,updateCurrentRow:Co,updateSort:$t,execFilter:Le,execSort:dn,execQuery:At,clearFilter:Ke,clearSort:Be,toggleRowExpansion:Ut,setExpandRowKeysAdapter:Dt=>{Ht(Dt),ln(Dt)},setCurrentRowKey:mo,toggleRowExpansionAdapter:(Dt,En)=>{C.value.some(({type:un})=>un==="expand")?Ut(Dt,En):bn(Dt,En)},isRowExpanded:Gt,updateExpandRows:Nt,updateCurrentRowData:qn,loadOrToggle:yt,updateTreeData:_n,updateKeyChildren:jn,states:{tableSize:i,rowKey:s,data:d,_data:p,isComplex:_,_columns:o,originColumns:w,columns:C,fixedColumns:M,rightFixedColumns:I,leafColumns:F,fixedLeafColumns:B,rightFixedLeafColumns:N,updateOrderFns:D,leafColumnsLength:j,fixedLeafColumnsLength:U,rightFixedLeafColumnsLength:ne,isAllSelected:K,selection:G,reserveSelection:J,selectOnIndeterminate:oe,selectable:se,filters:me,filteredData:de,sortingColumn:ce,sortProp:pe,sortOrder:ge,hoverRow:Re,...Et,...kn,...Io}}}function oS(e,t){return e.map(i=>{var s;return i.id===t.id?t:((s=i.children)!=null&&s.length&&(i.children=oS(i.children,t)),i)})}function rS(e){e.forEach(t=>{var i,s;t.no=(i=t.getColumnIndex)==null?void 0:i.call(t),(s=t.children)!=null&&s.length&&rS(t.children)}),e.sort((t,i)=>t.no-i.no)}function lse(){const e=jo(),t=sse();return{ns:rn("table"),...t,mutations:{setData(_,o){const w=y(_._data)!==o;_.data.value=o,_._data.value=o,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),y(_.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):w?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(_,o,w,C){const M=y(_._columns);let I=[];w?(w&&!w.children&&(w.children=[]),w.children.push(o),I=oS(M,w)):(M.push(o),I=M),rS(I),_._columns.value=I,_.updateOrderFns.push(C),o.type==="selection"&&(_.selectable.value=o.selectable,_.reserveSelection.value=o.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(_,o){var w;((w=o.getColumnIndex)==null?void 0:w.call(o))!==o.no&&(rS(_._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(_,o,w,C){const M=y(_._columns)||[];if(w)w.children.splice(w.children.findIndex(F=>F.id===o.id),1),oo(()=>{var F;((F=w.children)==null?void 0:F.length)===0&&delete w.children}),_._columns.value=oS(M,w);else{const F=M.indexOf(o);F>-1&&(M.splice(F,1),_._columns.value=M)}const I=_.updateOrderFns.indexOf(C);I>-1&&_.updateOrderFns.splice(I,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(_,o){const{prop:w,order:C,init:M}=o;if(w){const I=y(_.columns).find(F=>F.property===w);I&&(I.order=C,e.store.updateSort(I,w,C),e.store.commit("changeSortCondition",{init:M}))}},changeSortCondition(_,o){const{sortingColumn:w,sortProp:C,sortOrder:M}=_,I=y(w),F=y(C),B=y(M);B===null&&(_.sortingColumn.value=null,_.sortProp.value=null);const N={filter:!0};e.store.execQuery(N),(!o||!(o.silent||o.init))&&e.emit("sort-change",{column:I,prop:F,order:B}),e.store.updateTableScrollY()},filterChange(_,o){const{column:w,values:C,silent:M}=o,I=e.store.updateFilters(w,C);e.store.execQuery(),M||e.emit("filter-change",I),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(_,o){e.store.toggleRowSelection(o),e.store.updateAllSelected()},setHoverRow(_,o){_.hoverRow.value=o},setCurrentRow(_,o){e.store.updateCurrentRow(o)}},commit:function(_,...o){const w=e.store.mutations;if(w[_])w[_].apply(e,[e.store.states].concat(o));else throw new Error(`Action not found: ${_}`)},updateTableScrollY:function(){oo(()=>e.layout.updateScrollY.apply(e.layout))}}}const n_={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function cse(e,t){if(!e)throw new Error("Table is required.");const i=lse();return i.toggleAllSelection=il(i._toggleAllSelection,10),Object.keys(n_).forEach(s=>{Jz(Qz(t,s),s,i)}),use(i,t),i}function use(e,t){Object.keys(n_).forEach(i=>{tn(()=>Qz(t,i),s=>{Jz(s,i,e)})})}function Jz(e,t,i){let s=e,d=n_[t];typeof n_[t]=="object"&&(d=d.key,s=s||n_[t].default),i.states[d].value=s}function Qz(e,t){if(t.includes(".")){const i=t.split(".");let s=e;return i.forEach(d=>{s=s[d]}),s}else return e[t]}class dse{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=we(null),this.scrollX=we(!1),this.scrollY=we(!1),this.bodyWidth=we(null),this.fixedWidth=we(null),this.rightFixedWidth=we(null),this.gutterWidth=0;for(const i in t)Tr(t,i)&&(vi(this[i])?this[i].value=t[i]:this[i]=t[i]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const i=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(i!=null&&i.wrapRef)){let s=!0;const d=this.scrollY.value;return s=i.wrapRef.scrollHeight>i.wrapRef.clientHeight,this.scrollY.value=s,d!==s}return!1}setHeight(t,i="height"){if(!gr)return;const s=this.table.vnode.el;if(t=Qae(t),this.height.value=Number(t),!s&&(t||t===0))return oo(()=>this.setHeight(t,i));ao(t)?(s.style[i]=`${t}px`,this.updateElsHeight()):Zn(t)&&(s.style[i]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(s=>{s.isColumnGroup?t.push.apply(t,s.columns):t.push(s)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let i=t;for(;i.tagName!=="DIV";){if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1}updateColumnsWidth(){if(!gr)return;const t=this.fit,i=this.table.vnode.el.clientWidth;let s=0;const d=this.getFlattenColumns(),p=d.filter(w=>!ao(w.width));if(d.forEach(w=>{ao(w.width)&&w.realWidth&&(w.realWidth=null)}),p.length>0&&t){if(d.forEach(w=>{s+=Number(w.width||w.minWidth||80)}),s<=i){this.scrollX.value=!1;const w=i-s;if(p.length===1)p[0].realWidth=Number(p[0].minWidth||80)+w;else{const C=p.reduce((F,B)=>F+Number(B.minWidth||80),0),M=w/C;let I=0;p.forEach((F,B)=>{if(B===0)return;const N=Math.floor(Number(F.minWidth||80)*M);I+=N,F.realWidth=Number(F.minWidth||80)+N}),p[0].realWidth=Number(p[0].minWidth||80)+w-I}}else this.scrollX.value=!0,p.forEach(w=>{w.realWidth=Number(w.minWidth)});this.bodyWidth.value=Math.max(s,i),this.table.state.resizeState.value.width=this.bodyWidth.value}else d.forEach(w=>{!w.width&&!w.minWidth?w.realWidth=80:w.realWidth=Number(w.width||w.minWidth),s+=w.realWidth}),this.scrollX.value=s>i,this.bodyWidth.value=s;const _=this.store.states.fixedColumns.value;if(_.length>0){let w=0;_.forEach(C=>{w+=Number(C.realWidth||C.width)}),this.fixedWidth.value=w}const o=this.store.states.rightFixedColumns.value;if(o.length>0){let w=0;o.forEach(C=>{w+=Number(C.realWidth||C.width)}),this.rightFixedWidth.value=w}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}notifyObservers(t){this.observers.forEach(s=>{var d,p;switch(t){case"columns":(d=s.state)==null||d.onColumnsChange(this);break;case"scrollable":(p=s.state)==null||p.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:hse}=ac,fse=Ze({name:"ElTableFilterPanel",components:{ElCheckbox:ac,ElCheckboxGroup:hse,ElScrollbar:Ou,ElTooltip:qa,ElIcon:Gn,ArrowDown:fd,ArrowUp:vT},directives:{ClickOutside:ld},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:{type:String}},setup(e){const t=jo(),{t:i}=vr(),s=rn("table-filter"),d=t==null?void 0:t.parent;d.filterPanels.value[e.column.id]||(d.filterPanels.value[e.column.id]=t);const p=we(!1),_=we(null),o=te(()=>e.column&&e.column.filters),w=te(()=>e.column.filterClassName?`${s.b()} ${e.column.filterClassName}`:s.b()),C=te({get:()=>{var J;return(((J=e.column)==null?void 0:J.filteredValue)||[])[0]},set:J=>{M.value&&(typeof J<"u"&&J!==null?M.value.splice(0,1,J):M.value.splice(0,1))}}),M=te({get(){return e.column?e.column.filteredValue||[]:[]},set(J){e.column&&e.upDataColumn("filteredValue",J)}}),I=te(()=>e.column?e.column.filterMultiple:!0),F=J=>J.value===C.value,B=()=>{p.value=!1},N=J=>{J.stopPropagation(),p.value=!p.value},D=()=>{p.value=!1},j=()=>{K(M.value),B()},U=()=>{M.value=[],K(M.value),B()},ne=J=>{C.value=J,K(typeof J<"u"&&J!==null?M.value:[]),B()},K=J=>{e.store.commit("filterChange",{column:e.column,values:J}),e.store.updateAllSelected()};tn(p,J=>{e.column&&e.upDataColumn("filterOpened",J)},{immediate:!0});const G=te(()=>{var J,oe;return(oe=(J=_.value)==null?void 0:J.popperRef)==null?void 0:oe.contentRef});return{tooltipVisible:p,multiple:I,filterClassName:w,filteredValue:M,filterValue:C,filters:o,handleConfirm:j,handleReset:U,handleSelect:ne,isActive:F,t:i,ns:s,showFilterPanel:N,hideFilterPanel:D,popperPaneRef:G,tooltip:_}}});function pse(e,t,i,s,d,p){const _=Go("el-checkbox"),o=Go("el-checkbox-group"),w=Go("el-scrollbar"),C=Go("arrow-up"),M=Go("arrow-down"),I=Go("el-icon"),F=Go("el-tooltip"),B=o1("click-outside");return le(),Rt(F,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:"","append-to":e.appendTo},{content:at(()=>[e.multiple?(le(),Pe("div",{key:0},[Ve("div",{class:he(e.ns.e("content"))},[Qe(w,{"wrap-class":e.ns.e("wrap")},{default:at(()=>[Qe(o,{modelValue:e.filteredValue,"onUpdate:modelValue":N=>e.filteredValue=N,class:he(e.ns.e("checkbox-group"))},{default:at(()=>[(le(!0),Pe(eo,null,nr(e.filters,N=>(le(),Rt(_,{key:N.value,value:N.value},{default:at(()=>[Qo(yn(N.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),Ve("div",{class:he(e.ns.e("bottom"))},[Ve("button",{class:he({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:e.handleConfirm},yn(e.t("el.table.confirmFilter")),11,["disabled","onClick"]),Ve("button",{type:"button",onClick:e.handleReset},yn(e.t("el.table.resetFilter")),9,["onClick"])],2)])):(le(),Pe("ul",{key:1,class:he(e.ns.e("list"))},[Ve("li",{class:he([e.ns.e("list-item"),{[e.ns.is("active")]:e.filterValue===void 0||e.filterValue===null}]),onClick:N=>e.handleSelect(null)},yn(e.t("el.table.clearFilter")),11,["onClick"]),(le(!0),Pe(eo,null,nr(e.filters,N=>(le(),Pe("li",{key:N.value,class:he([e.ns.e("list-item"),e.ns.is("active",e.isActive(N))]),label:N.value,onClick:D=>e.handleSelect(N.value)},yn(N.text),11,["label","onClick"]))),128))],2))]),default:at(()=>[zo((le(),Pe("span",{class:he([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:e.showFilterPanel},[Qe(I,null,{default:at(()=>[_t(e.$slots,"filter-icon",{},()=>[e.column.filterOpened?(le(),Rt(C,{key:0})):(le(),Rt(M,{key:1}))])]),_:3})],10,["onClick"])),[[B,e.hideFilterPanel,e.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var mse=xn(fse,[["render",pse],["__file","filter-panel.vue"]]);function e4(e){const t=jo();n1(()=>{i.value.addObserver(t)}),No(()=>{s(i.value),d(i.value)}),Ru(()=>{s(i.value),d(i.value)}),kh(()=>{i.value.removeObserver(t)});const i=te(()=>{const p=e.layout;if(!p)throw new Error("Can not find table layout.");return p}),s=p=>{var _;const o=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col"))||[];if(!o.length)return;const w=p.getFlattenColumns(),C={};w.forEach(M=>{C[M.id]=M});for(let M=0,I=o.length;M<I;M++){const F=o[M],B=F.getAttribute("name"),N=C[B];N&&F.setAttribute("width",N.realWidth||N.width)}},d=p=>{var _,o;const w=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let M=0,I=w.length;M<I;M++)w[M].setAttribute("width",p.scrollY.value?p.gutterWidth:"0");const C=((o=e.vnode.el)==null?void 0:o.querySelectorAll("th.gutter"))||[];for(let M=0,I=C.length;M<I;M++){const F=C[M];F.style.width=p.scrollY.value?`${p.gutterWidth}px`:"0",F.style.display=p.scrollY.value?"":"none"}};return{tableLayout:i.value,onColumnsChange:s,onScrollableChange:d}}const Du=Symbol("ElTable");function gse(e,t){const i=jo(),s=Un(Du),d=D=>{D.stopPropagation()},p=(D,j)=>{!j.filters&&j.sortable?N(D,j,!1):j.filterable&&!j.sortable&&d(D),s==null||s.emit("header-click",j,D)},_=(D,j)=>{s==null||s.emit("header-contextmenu",j,D)},o=we(null),w=we(!1),C=we({}),M=(D,j)=>{if(gr&&!(j.children&&j.children.length>0)&&o.value&&e.border){w.value=!0;const U=s;t("set-drag-visible",!0);const K=(U==null?void 0:U.vnode.el).getBoundingClientRect().left,G=i.vnode.el.querySelector(`th.${j.id}`),J=G.getBoundingClientRect(),oe=J.left-K+30;Jl(G,"noclick"),C.value={startMouseLeft:D.clientX,startLeft:J.right-K,startColumnLeft:J.left-K,tableLeft:K};const se=U==null?void 0:U.refs.resizeProxy;se.style.left=`${C.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const me=ce=>{const pe=ce.clientX-C.value.startMouseLeft,ge=C.value.startLeft+pe;se.style.left=`${Math.max(oe,ge)}px`},de=()=>{if(w.value){const{startColumnLeft:ce,startLeft:pe}=C.value,Re=Number.parseInt(se.style.left,10)-ce;j.width=j.realWidth=Re,U==null||U.emit("header-dragend",j.width,pe-ce,j,D),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",w.value=!1,o.value=null,C.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",me),document.removeEventListener("mouseup",de),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{ps(G,"noclick")},0)};document.addEventListener("mousemove",me),document.addEventListener("mouseup",de)}},I=(D,j)=>{var U;if(j.children&&j.children.length>0)return;const ne=D.target;if(!El(ne))return;const K=ne==null?void 0:ne.closest("th");if(!(!j||!j.resizable||!K)&&!w.value&&e.border){const G=K.getBoundingClientRect(),J=document.body.style,oe=((U=K.parentNode)==null?void 0:U.lastElementChild)===K;G.width>12&&G.right-D.pageX<8&&!oe?(J.cursor="col-resize",nl(K,"is-sortable")&&(K.style.cursor="col-resize"),o.value=j):w.value||(J.cursor="",nl(K,"is-sortable")&&(K.style.cursor="pointer"),o.value=null)}},F=()=>{gr&&(document.body.style.cursor="")},B=({order:D,sortOrders:j})=>{if(D==="")return j[0];const U=j.indexOf(D||null);return j[U>j.length-2?0:U+1]},N=(D,j,U)=>{var ne;D.stopPropagation();const K=j.order===U?null:U||B(j),G=(ne=D.target)==null?void 0:ne.closest("th");if(G&&nl(G,"noclick")){ps(G,"noclick");return}if(!j.sortable)return;const J=D.currentTarget;if(["ascending","descending"].some(ce=>nl(J,ce)&&!j.sortOrders.includes(ce)))return;const oe=e.store.states;let se=oe.sortProp.value,me;const de=oe.sortingColumn.value;(de!==j||de===j&&de.order===null)&&(de&&(de.order=null),oe.sortingColumn.value=j,se=j.property),K?me=j.order=K:me=j.order=null,oe.sortProp.value=se,oe.sortOrder.value=me,s==null||s.store.commit("changeSortCondition")};return{handleHeaderClick:p,handleHeaderContextMenu:_,handleMouseDown:M,handleMouseMove:I,handleMouseOut:F,handleSortClick:N,handleFilterClick:d}}function vse(e){const t=Un(Du),i=rn("table");return{getHeaderRowStyle:o=>{const w=t==null?void 0:t.props.headerRowStyle;return Qn(w)?w.call(null,{rowIndex:o}):w},getHeaderRowClass:o=>{const w=[],C=t==null?void 0:t.props.headerRowClassName;return Zn(C)?w.push(C):Qn(C)&&w.push(C.call(null,{rowIndex:o})),w.join(" ")},getHeaderCellStyle:(o,w,C,M)=>{var I;let F=(I=t==null?void 0:t.props.headerCellStyle)!=null?I:{};Qn(F)&&(F=F.call(null,{rowIndex:o,columnIndex:w,row:C,column:M}));const B=dC(w,M.fixed,e.store,C);return Dm(B,"left"),Dm(B,"right"),Object.assign({},F,B)},getHeaderCellClass:(o,w,C,M)=>{const I=uC(i.b(),w,M.fixed,e.store,C),F=[M.id,M.order,M.headerAlign,M.className,M.labelClassName,...I];M.children||F.push("is-leaf"),M.sortable&&F.push("is-sortable");const B=t==null?void 0:t.props.headerCellClassName;return Zn(B)?F.push(B):Qn(B)&&F.push(B.call(null,{rowIndex:o,columnIndex:w,row:C,column:M})),F.push(i.e("cell")),F.filter(N=>!!N).join(" ")}}}const t4=e=>{const t=[];return e.forEach(i=>{i.children?(t.push(i),t.push.apply(t,t4(i.children))):t.push(i)}),t},n4=e=>{let t=1;const i=(p,_)=>{if(_&&(p.level=_.level+1,t<p.level&&(t=p.level)),p.children){let o=0;p.children.forEach(w=>{i(w,p),o+=w.colSpan}),p.colSpan=o}else p.colSpan=1};e.forEach(p=>{p.level=1,i(p,void 0)});const s=[];for(let p=0;p<t;p++)s.push([]);return t4(e).forEach(p=>{p.children?(p.rowSpan=1,p.children.forEach(_=>_.isSubColumn=!0)):p.rowSpan=t-p.level+1,s[p.level-1].push(p)}),s};function _se(e){const t=Un(Du),i=te(()=>n4(e.store.states.originColumns.value));return{isGroup:te(()=>{const p=i.value.length>1;return p&&t&&(t.state.isGroup.value=!0),p}),toggleAllSelection:p=>{p.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:i}}var yse=Ze({name:"ElTableHeader",components:{ElCheckbox:ac},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String}},setup(e,{emit:t}){const i=jo(),s=Un(Du),d=rn("table"),p=we({}),{onColumnsChange:_,onScrollableChange:o}=e4(s),w=(s==null?void 0:s.props.tableLayout)==="auto",C=Ir(new Map),M=we(),I=()=>{setTimeout(()=>{C.size>0&&(C.forEach((ce,pe)=>{const ge=M.value.querySelector(`.${pe.replace(/\s/g,".")}`);if(ge){const Re=ge.getBoundingClientRect().width;ce.width=Re}}),C.clear())})};tn(C,I),No(async()=>{await oo(),await oo();const{prop:ce,order:pe}=e.defaultSort;s==null||s.store.commit("sort",{prop:ce,order:pe,init:!0}),I()});const{handleHeaderClick:F,handleHeaderContextMenu:B,handleMouseDown:N,handleMouseMove:D,handleMouseOut:j,handleSortClick:U,handleFilterClick:ne}=gse(e,t),{getHeaderRowStyle:K,getHeaderRowClass:G,getHeaderCellStyle:J,getHeaderCellClass:oe}=vse(e),{isGroup:se,toggleAllSelection:me,columnRows:de}=_se(e);return i.state={onColumnsChange:_,onScrollableChange:o},i.filterPanels=p,{ns:d,filterPanels:p,onColumnsChange:_,onScrollableChange:o,columnRows:de,getHeaderRowClass:G,getHeaderRowStyle:K,getHeaderCellClass:oe,getHeaderCellStyle:J,handleHeaderClick:F,handleHeaderContextMenu:B,handleMouseDown:N,handleMouseMove:D,handleMouseOut:j,handleSortClick:U,handleFilterClick:ne,isGroup:se,toggleAllSelection:me,saveIndexSelection:C,isTableLayoutAuto:w,theadRef:M,updateFixedColumnStyle:I}},render(){const{ns:e,isGroup:t,columnRows:i,getHeaderCellStyle:s,getHeaderCellClass:d,getHeaderRowClass:p,getHeaderRowStyle:_,handleHeaderClick:o,handleHeaderContextMenu:w,handleMouseDown:C,handleMouseMove:M,handleSortClick:I,handleMouseOut:F,store:B,$parent:N,saveIndexSelection:D,isTableLayoutAuto:j}=this;let U=1;return lo("thead",{ref:"theadRef",class:{[e.is("group")]:t}},i.map((ne,K)=>lo("tr",{class:p(K),key:K,style:_(K)},ne.map((G,J)=>{G.rowSpan>U&&(U=G.rowSpan);const oe=d(K,J,ne,G);return j&&G.fixed&&D.set(oe,G),lo("th",{class:oe,colspan:G.colSpan,key:`${G.id}-thead`,rowspan:G.rowSpan,style:s(K,J,ne,G),onClick:se=>{se.currentTarget.classList.contains("noclick")||o(se,G)},onContextmenu:se=>w(se,G),onMousedown:se=>C(se,G),onMousemove:se=>M(se,G),onMouseout:F},[lo("div",{class:["cell",G.filteredValue&&G.filteredValue.length>0?"highlight":""]},[G.renderHeader?G.renderHeader({column:G,$index:J,store:B,_self:N}):G.label,G.sortable&&lo("span",{onClick:se=>I(se,G),class:"caret-wrapper"},[lo("i",{onClick:se=>I(se,G,"ascending"),class:"sort-caret ascending"}),lo("i",{onClick:se=>I(se,G,"descending"),class:"sort-caret descending"})]),G.filterable&&lo(mse,{store:B,placement:G.filterPlacement||"bottom-start",appendTo:N.appendFilterPanelTo,column:G,upDataColumn:(se,me)=>{G[se]=me}},{"filter-icon":()=>G.renderFilterIcon?G.renderFilterIcon({filterOpened:G.filterOpened}):null})])])}))))}});function Yw(e,t,i=.03){return e-t>i}function bse(e){const t=Un(Du),i=we(""),s=we(lo("div")),d=(N,D,j)=>{var U;const ne=t,K=Zw(N);let G;const J=(U=ne==null?void 0:ne.vnode.el)==null?void 0:U.dataset.prefix;K&&(G=QP({columns:e.store.states.columns.value},K,J),G&&(ne==null||ne.emit(`cell-${j}`,D,G,K,N))),ne==null||ne.emit(`row-${j}`,D,G,N)},p=(N,D)=>{d(N,D,"dblclick")},_=(N,D)=>{e.store.commit("setCurrentRow",D),d(N,D,"click")},o=(N,D)=>{d(N,D,"contextmenu")},w=il(N=>{e.store.commit("setHoverRow",N)},30),C=il(()=>{e.store.commit("setHoverRow",null)},30),M=N=>{const D=window.getComputedStyle(N,null),j=Number.parseInt(D.paddingLeft,10)||0,U=Number.parseInt(D.paddingRight,10)||0,ne=Number.parseInt(D.paddingTop,10)||0,K=Number.parseInt(D.paddingBottom,10)||0;return{left:j,right:U,top:ne,bottom:K}},I=(N,D,j)=>{let U=D.target.parentNode;for(;N>1&&(U=U==null?void 0:U.nextSibling,!(!U||U.nodeName!=="TR"));)j(U,"hover-row hover-fixed-row"),N--};return{handleDoubleClick:p,handleClick:_,handleContextMenu:o,handleMouseEnter:w,handleMouseLeave:C,handleCellMouseEnter:(N,D,j)=>{var U;const ne=t,K=Zw(N),G=(U=ne==null?void 0:ne.vnode.el)==null?void 0:U.dataset.prefix;if(K){const Ae=QP({columns:e.store.states.columns.value},K,G);K.rowSpan>1&&I(K.rowSpan,N,Jl);const Ce=ne.hoverState={cell:K,column:Ae,row:D};ne==null||ne.emit("cell-mouse-enter",Ce.row,Ce.column,Ce.cell,N)}if(!j)return;const J=N.target.querySelector(".cell");if(!(nl(J,`${G}-tooltip`)&&J.childNodes.length))return;const oe=document.createRange();oe.setStart(J,0),oe.setEnd(J,J.childNodes.length);const{width:se,height:me}=oe.getBoundingClientRect(),{width:de,height:ce}=J.getBoundingClientRect(),{top:pe,left:ge,right:Re,bottom:Je}=M(J),Me=ge+Re,xe=pe+Je;(Yw(se+Me,de)||Yw(me+xe,ce)||Yw(J.scrollWidth,de))&&nse(j,K.innerText||K.textContent,K,ne)},handleCellMouseLeave:N=>{const D=Zw(N);if(!D)return;D.rowSpan>1&&I(D.rowSpan,N,ps);const j=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",j==null?void 0:j.row,j==null?void 0:j.column,j==null?void 0:j.cell,N)},tooltipContent:i,tooltipTrigger:s}}function xse(e){const t=Un(Du),i=rn("table");return{getRowStyle:(C,M)=>{const I=t==null?void 0:t.props.rowStyle;return Qn(I)?I.call(null,{row:C,rowIndex:M}):I||null},getRowClass:(C,M)=>{const I=[i.e("row")];t!=null&&t.props.highlightCurrentRow&&C===e.store.states.currentRow.value&&I.push("current-row"),e.stripe&&M%2===1&&I.push(i.em("row","striped"));const F=t==null?void 0:t.props.rowClassName;return Zn(F)?I.push(F):Qn(F)&&I.push(F.call(null,{row:C,rowIndex:M})),I},getCellStyle:(C,M,I,F)=>{const B=t==null?void 0:t.props.cellStyle;let N=B??{};Qn(B)&&(N=B.call(null,{rowIndex:C,columnIndex:M,row:I,column:F}));const D=dC(M,e==null?void 0:e.fixed,e.store);return Dm(D,"left"),Dm(D,"right"),Object.assign({},N,D)},getCellClass:(C,M,I,F,B)=>{const N=uC(i.b(),M,e==null?void 0:e.fixed,e.store,void 0,B),D=[F.id,F.align,F.className,...N],j=t==null?void 0:t.props.cellClassName;return Zn(j)?D.push(j):Qn(j)&&D.push(j.call(null,{rowIndex:C,columnIndex:M,row:I,column:F})),D.push(i.e("cell")),D.filter(U=>!!U).join(" ")},getSpan:(C,M,I,F)=>{let B=1,N=1;const D=t==null?void 0:t.props.spanMethod;if(Qn(D)){const j=D({row:C,column:M,rowIndex:I,columnIndex:F});fn(j)?(B=j[0],N=j[1]):typeof j=="object"&&(B=j.rowspan,N=j.colspan)}return{rowspan:B,colspan:N}},getColspanRealWidth:(C,M,I)=>{if(M<1)return C[I].realWidth;const F=C.map(({realWidth:B,width:N})=>B||N).slice(I,I+M);return Number(F.reduce((B,N)=>Number(B)+Number(N),-1))}}}const wse=Ze({name:"TableTdWrapper"}),Sse=Ze({...wse,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(e){return(t,i)=>(le(),Pe("td",{colspan:e.colspan,rowspan:e.rowspan},[_t(t.$slots,"default")],8,["colspan","rowspan"]))}});var Tse=xn(Sse,[["__file","td-wrapper.vue"]]);function Cse(e){const t=Un(Du),i=rn("table"),{handleDoubleClick:s,handleClick:d,handleContextMenu:p,handleMouseEnter:_,handleMouseLeave:o,handleCellMouseEnter:w,handleCellMouseLeave:C,tooltipContent:M,tooltipTrigger:I}=bse(e),{getRowStyle:F,getRowClass:B,getCellStyle:N,getCellClass:D,getSpan:j,getColspanRealWidth:U}=xse(e),ne=te(()=>e.store.states.columns.value.findIndex(({type:se})=>se==="default")),K=(se,me)=>{const de=t.props.rowKey;return de?hs(se,de):me},G=(se,me,de,ce=!1)=>{const{tooltipEffect:pe,tooltipOptions:ge,store:Re}=e,{indent:Je,columns:Me}=Re.states,xe=B(se,me);let Ae=!0;return de&&(xe.push(i.em("row",`level-${de.level}`)),Ae=de.display),lo("tr",{style:[Ae?null:{},F(se,me)],class:xe,key:K(se,me),onDblclick:ve=>s(ve,se),onClick:ve=>d(ve,se),onContextmenu:ve=>p(ve,se),onMouseenter:()=>_(me),onMouseleave:o},Me.value.map((ve,Ne)=>{const{rowspan:We,colspan:ot}=j(se,ve,me,Ne);if(!We||!ot)return null;const Oe=Object.assign({},ve);Oe.realWidth=U(Me.value,ot,Ne);const Ct={store:e.store,_self:e.context||t,column:Oe,row:se,$index:me,cellIndex:Ne,expanded:ce};Ne===ne.value&&de&&(Ct.treeNode={indent:de.level*Je.value,level:de.level},ai(de.expanded)&&(Ct.treeNode.expanded=de.expanded,"loading"in de&&(Ct.treeNode.loading=de.loading),"noLazyChildren"in de&&(Ct.treeNode.noLazyChildren=de.noLazyChildren)));const Mt=`${K(se,me)},${Ne}`,zt=Oe.columnKey||Oe.rawColumnKey||"",bt=ve.showOverflowTooltip&&nO({effect:pe},ge,ve.showOverflowTooltip);return lo(Tse,{style:N(me,Ne,se,ve),class:D(me,Ne,se,ve,ot-1),key:`${zt}${Mt}`,rowspan:We,colspan:ot,onMouseenter:Kt=>w(Kt,se,bt),onMouseleave:C},{default:()=>J(Ne,ve,Ct)})}))},J=(se,me,de)=>me.renderCell(de);return{wrappedRowRender:(se,me)=>{const de=e.store,{isRowExpanded:ce,assertRowKey:pe}=de,{treeData:ge,lazyTreeNodeMap:Re,childrenColumnName:Je,rowKey:Me}=de.states,xe=de.states.columns.value;if(xe.some(({type:Ce})=>Ce==="expand")){const Ce=ce(se),ve=G(se,me,void 0,Ce),Ne=t.renderExpanded;return Ce?Ne?[[ve,lo("tr",{key:`expanded-row__${ve.key}`},[lo("td",{colspan:xe.length,class:`${i.e("cell")} ${i.e("expanded-cell")}`},[Ne({row:se,$index:me,store:de,expanded:Ce})])])]]:(console.error("[Element Error]renderExpanded is required."),ve):[[ve]]}else if(Object.keys(ge.value).length){pe();const Ce=hs(se,Me.value);let ve=ge.value[Ce],Ne=null;ve&&(Ne={expanded:ve.expanded,level:ve.level,display:!0},ai(ve.lazy)&&(ai(ve.loaded)&&ve.loaded&&(Ne.noLazyChildren=!(ve.children&&ve.children.length)),Ne.loading=ve.loading));const We=[G(se,me,Ne)];if(ve){let ot=0;const Oe=(Mt,zt)=>{Mt&&Mt.length&&zt&&Mt.forEach(bt=>{const Kt={display:zt.display&&zt.expanded,level:zt.level+1,expanded:!1,noLazyChildren:!1,loading:!1},$t=hs(bt,Me.value);if($t==null)throw new Error("For nested data item, row-key is required.");if(ve={...ge.value[$t]},ve&&(Kt.expanded=ve.expanded,ve.level=ve.level||Kt.level,ve.display=!!(ve.expanded&&Kt.display),ai(ve.lazy)&&(ai(ve.loaded)&&ve.loaded&&(Kt.noLazyChildren=!(ve.children&&ve.children.length)),Kt.loading=ve.loading)),ot++,We.push(G(bt,me+ot,Kt)),ve){const Le=Re.value[$t]||bt[Je.value];Oe(Le,ve)}})};ve.display=!0;const Ct=Re.value[Ce]||se[Je.value];Oe(Ct,ve)}return We}else return G(se,me,void 0)},tooltipContent:M,tooltipTrigger:I}}const Ese={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var Mse=Ze({name:"ElTableBody",props:Ese,setup(e){const t=jo(),i=Un(Du),s=rn("table"),{wrappedRowRender:d,tooltipContent:p,tooltipTrigger:_}=Cse(e),{onColumnsChange:o,onScrollableChange:w}=e4(i),C=[];return tn(e.store.states.hoverRow,(M,I)=>{var F;const B=t==null?void 0:t.vnode.el,N=Array.from((B==null?void 0:B.children)||[]).filter(U=>U==null?void 0:U.classList.contains(`${s.e("row")}`));let D=M;const j=(F=N[D])==null?void 0:F.childNodes;if(j!=null&&j.length){let U=0;Array.from(j).reduce((K,G,J)=>{var oe,se;return((oe=j[J])==null?void 0:oe.colSpan)>1&&(U=(se=j[J])==null?void 0:se.colSpan),G.nodeName!=="TD"&&U===0&&K.push(J),U>0&&U--,K},[]).forEach(K=>{var G;for(D=M;D>0;){const J=(G=N[D-1])==null?void 0:G.childNodes;if(J[K]&&J[K].nodeName==="TD"&&J[K].rowSpan>1){Jl(J[K],"hover-cell"),C.push(J[K]);break}D--}})}else C.forEach(U=>ps(U,"hover-cell")),C.length=0;!e.store.states.isComplex.value||!gr||wh(()=>{const U=N[I],ne=N[M];U&&!U.classList.contains("hover-fixed-row")&&ps(U,"hover-row"),ne&&Jl(ne,"hover-row")})}),kh(()=>{var M;(M=Zl)==null||M()}),{ns:s,onColumnsChange:o,onScrollableChange:w,wrappedRowRender:d,tooltipContent:p,tooltipTrigger:_}},render(){const{wrappedRowRender:e,store:t}=this,i=t.states.data.value||[];return lo("tbody",{tabIndex:-1},[i.reduce((s,d)=>s.concat(e(d,s.length)),[])])}});function Ise(){const e=Un(Du),t=e==null?void 0:e.store,i=te(()=>t.states.fixedLeafColumnsLength.value),s=te(()=>t.states.rightFixedColumns.value.length),d=te(()=>t.states.columns.value.length),p=te(()=>t.states.fixedColumns.value.length),_=te(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:i,rightFixedLeafCount:s,columnsCount:d,leftFixedCount:p,rightFixedCount:_,columns:t.states.columns}}function Ase(e){const{columns:t}=Ise(),i=rn("table");return{getCellClasses:(p,_)=>{const o=p[_],w=[i.e("cell"),o.id,o.align,o.labelClassName,...uC(i.b(),_,o.fixed,e.store)];return o.className&&w.push(o.className),o.children||w.push(i.is("leaf")),w},getCellStyles:(p,_)=>{const o=dC(_,p.fixed,e.store);return Dm(o,"left"),Dm(o,"right"),o},columns:t}}var kse=Ze({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const{getCellClasses:t,getCellStyles:i,columns:s}=Ase(e);return{ns:rn("table"),getCellClasses:t,getCellStyles:i,columns:s}},render(){const{columns:e,getCellStyles:t,getCellClasses:i,summaryMethod:s,sumText:d}=this,p=this.store.states.data.value;let _=[];return s?_=s({columns:e,data:p}):e.forEach((o,w)=>{if(w===0){_[w]=d;return}const C=p.map(B=>Number(B[o.property])),M=[];let I=!0;C.forEach(B=>{if(!Number.isNaN(+B)){I=!1;const N=`${B}`.split(".")[1];M.push(N?N.length:0)}});const F=Math.max.apply(null,M);I?_[w]="":_[w]=C.reduce((B,N)=>{const D=Number(N);return Number.isNaN(+D)?B:Number.parseFloat((B+N).toFixed(Math.min(F,20)))},0)}),lo(lo("tfoot",[lo("tr",{},[...e.map((o,w)=>lo("td",{key:w,colspan:o.colSpan,rowspan:o.rowSpan,class:i(e,w),style:t(o,w)},[lo("div",{class:["cell",o.labelClassName]},[_[w]])]))])]))}});function Pse(e){return{setCurrentRow:I=>{e.commit("setCurrentRow",I)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(I,F,B=!0)=>{e.toggleRowSelection(I,F,!1,B),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:I=>{e.clearFilter(I)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(I,F)=>{e.toggleRowExpansionAdapter(I,F)},clearSort:()=>{e.clearSort()},sort:(I,F)=>{e.commit("sort",{prop:I,order:F})},updateKeyChildren:(I,F)=>{e.updateKeyChildren(I,F)}}}function Rse(e,t,i,s){const d=we(!1),p=we(null),_=we(!1),o=Ce=>{_.value=Ce},w=we({width:null,height:null,headerHeight:null}),C=we(!1),M={display:"inline-block",verticalAlign:"middle"},I=we(),F=we(0),B=we(0),N=we(0),D=we(0),j=we(0);Ha(()=>{t.setHeight(e.height)}),Ha(()=>{t.setMaxHeight(e.maxHeight)}),tn(()=>[e.currentRowKey,i.states.rowKey],([Ce,ve])=>{!y(ve)||!y(Ce)||i.setCurrentRowKey(`${Ce}`)},{immediate:!0}),tn(()=>e.data,Ce=>{s.store.commit("setData",Ce)},{immediate:!0,deep:!0}),Ha(()=>{e.expandRowKeys&&i.setExpandRowKeysAdapter(e.expandRowKeys)});const U=()=>{s.store.commit("setHoverRow",null),s.hoverState&&(s.hoverState=null)},ne=(Ce,ve)=>{const{pixelX:Ne,pixelY:We}=ve;Math.abs(Ne)>=Math.abs(We)&&(s.refs.bodyWrapper.scrollLeft+=ve.pixelX/5)},K=te(()=>e.height||e.maxHeight||i.states.fixedColumns.value.length>0||i.states.rightFixedColumns.value.length>0),G=te(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),J=()=>{K.value&&t.updateElsHeight(),t.updateColumnsWidth(),requestAnimationFrame(de)};No(async()=>{await oo(),i.updateColumns(),ce(),requestAnimationFrame(J);const Ce=s.vnode.el,ve=s.refs.headerWrapper;e.flexible&&Ce&&Ce.parentElement&&(Ce.parentElement.style.minWidth="0"),w.value={width:I.value=Ce.offsetWidth,height:Ce.offsetHeight,headerHeight:e.showHeader&&ve?ve.offsetHeight:null},i.states.columns.value.forEach(Ne=>{Ne.filteredValue&&Ne.filteredValue.length&&s.store.commit("filterChange",{column:Ne,values:Ne.filteredValue,silent:!0})}),s.$ready=!0});const oe=(Ce,ve)=>{if(!Ce)return;const Ne=Array.from(Ce.classList).filter(We=>!We.startsWith("is-scrolling-"));Ne.push(t.scrollX.value?ve:"is-scrolling-none"),Ce.className=Ne.join(" ")},se=Ce=>{const{tableWrapper:ve}=s.refs;oe(ve,Ce)},me=Ce=>{const{tableWrapper:ve}=s.refs;return!!(ve&&ve.classList.contains(Ce))},de=function(){if(!s.refs.scrollBarRef)return;if(!t.scrollX.value){const Mt="is-scrolling-none";me(Mt)||se(Mt);return}const Ce=s.refs.scrollBarRef.wrapRef;if(!Ce)return;const{scrollLeft:ve,offsetWidth:Ne,scrollWidth:We}=Ce,{headerWrapper:ot,footerWrapper:Oe}=s.refs;ot&&(ot.scrollLeft=ve),Oe&&(Oe.scrollLeft=ve);const Ct=We-Ne-1;ve>=Ct?se("is-scrolling-right"):se(ve===0?"is-scrolling-left":"is-scrolling-middle")},ce=()=>{s.refs.scrollBarRef&&(s.refs.scrollBarRef.wrapRef&&qr(s.refs.scrollBarRef.wrapRef,"scroll",de,{passive:!0}),e.fit?Mi(s.vnode.el,pe):qr(window,"resize",pe),Mi(s.refs.bodyWrapper,()=>{var Ce,ve;pe(),(ve=(Ce=s.refs)==null?void 0:Ce.scrollBarRef)==null||ve.update()}))},pe=()=>{var Ce,ve,Ne,We;const ot=s.vnode.el;if(!s.$ready||!ot)return;let Oe=!1;const{width:Ct,height:Mt,headerHeight:zt}=w.value,bt=I.value=ot.offsetWidth;Ct!==bt&&(Oe=!0);const Kt=ot.offsetHeight;(e.height||K.value)&&Mt!==Kt&&(Oe=!0);const $t=e.tableLayout==="fixed"?s.refs.headerWrapper:(Ce=s.refs.tableHeaderRef)==null?void 0:Ce.$el;e.showHeader&&($t==null?void 0:$t.offsetHeight)!==zt&&(Oe=!0),F.value=((ve=s.refs.tableWrapper)==null?void 0:ve.scrollHeight)||0,N.value=($t==null?void 0:$t.scrollHeight)||0,D.value=((Ne=s.refs.footerWrapper)==null?void 0:Ne.offsetHeight)||0,j.value=((We=s.refs.appendWrapper)==null?void 0:We.offsetHeight)||0,B.value=F.value-N.value-D.value-j.value,Oe&&(w.value={width:bt,height:Kt,headerHeight:e.showHeader&&($t==null?void 0:$t.offsetHeight)||0},J())},ge=na(),Re=te(()=>{const{bodyWidth:Ce,scrollY:ve,gutterWidth:Ne}=t;return Ce.value?`${Ce.value-(ve.value?Ne:0)}px`:""}),Je=te(()=>e.maxHeight?"fixed":e.tableLayout),Me=te(()=>{if(e.data&&e.data.length)return null;let Ce="100%";e.height&&B.value&&(Ce=`${B.value}px`);const ve=I.value;return{width:ve?`${ve}px`:"",height:Ce}}),xe=te(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${N.value+D.value}px)`}:{maxHeight:`${e.maxHeight-N.value-D.value}px`}:{});return{isHidden:d,renderExpanded:p,setDragVisible:o,isGroup:C,handleMouseLeave:U,handleHeaderFooterMousewheel:ne,tableSize:ge,emptyBlockStyle:Me,handleFixedMousewheel:(Ce,ve)=>{const Ne=s.refs.bodyWrapper;if(Math.abs(ve.spinY)>0){const We=Ne.scrollTop;ve.pixelY<0&&We!==0&&Ce.preventDefault(),ve.pixelY>0&&Ne.scrollHeight-Ne.clientHeight>We&&Ce.preventDefault(),Ne.scrollTop+=Math.ceil(ve.pixelY/5)}else Ne.scrollLeft+=Math.ceil(ve.pixelX/5)},resizeProxyVisible:_,bodyWidth:Re,resizeState:w,doLayout:J,tableBodyStyles:G,tableLayout:Je,scrollbarViewStyle:M,scrollbarStyle:xe}}function Lse(e){const t=we(),i=()=>{const d=e.vnode.el.querySelector(".hidden-columns"),p={childList:!0,subtree:!0},_=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{_.forEach(o=>o())}),t.value.observe(d,p)};No(()=>{i()}),kh(()=>{var s;(s=t.value)==null||s.disconnect()})}var Ose={data:{type:Array,default:()=>[]},size:ia,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0}};function o4(e){const t=e.tableLayout==="auto";let i=e.columns||[];t&&i.every(d=>d.width===void 0)&&(i=[]);const s=d=>{const p={key:`${e.tableLayout}_${d.id}`,style:{},name:void 0};return t?p.style={width:`${d.width}px`}:p.name=d.id,p};return lo("colgroup",{},i.map(d=>lo("col",s(d))))}o4.props=["columns","tableLayout"];const Dse=()=>{const e=we(),t=(p,_)=>{const o=e.value;o&&o.scrollTo(p,_)},i=(p,_)=>{const o=e.value;o&&ao(_)&&["Top","Left"].includes(p)&&o[`setScroll${p}`](_)};return{scrollBarRef:e,scrollTo:t,setScrollTop:p=>i("Top",p),setScrollLeft:p=>i("Left",p)}};var o3=!1,Ef,iS,aS,rb,ib,r4,ab,sS,lS,cS,i4,uS,dS,a4,s4;function tl(){if(!o3){o3=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),i=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(uS=/\b(iPhone|iP[ao]d)/.exec(e),dS=/\b(iP[ao]d)/.exec(e),cS=/Android/i.exec(e),a4=/FBAN\/\w+;/i.exec(e),s4=/Mobile/i.exec(e),i4=!!/Win64/.exec(e),t){Ef=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,Ef&&document&&document.documentMode&&(Ef=document.documentMode);var s=/(?:Trident\/(\d+.\d+))/.exec(e);r4=s?parseFloat(s[1])+4:Ef,iS=t[2]?parseFloat(t[2]):NaN,aS=t[3]?parseFloat(t[3]):NaN,rb=t[4]?parseFloat(t[4]):NaN,rb?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),ib=t&&t[1]?parseFloat(t[1]):NaN):ib=NaN}else Ef=iS=aS=ib=rb=NaN;if(i){if(i[1]){var d=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);ab=d?parseFloat(d[1].replace("_",".")):!0}else ab=!1;sS=!!i[2],lS=!!i[3]}else ab=sS=lS=!1}}var hS={ie:function(){return tl()||Ef},ieCompatibilityMode:function(){return tl()||r4>Ef},ie64:function(){return hS.ie()&&i4},firefox:function(){return tl()||iS},opera:function(){return tl()||aS},webkit:function(){return tl()||rb},safari:function(){return hS.webkit()},chrome:function(){return tl()||ib},windows:function(){return tl()||sS},osx:function(){return tl()||ab},linux:function(){return tl()||lS},iphone:function(){return tl()||uS},mobile:function(){return tl()||uS||dS||cS||s4},nativeApp:function(){return tl()||a4},android:function(){return tl()||cS},ipad:function(){return tl()||dS}},zse=hS,Fse=!!(typeof window<"u"&&window.document&&window.document.createElement),Bse={canUseDOM:Fse},l4=Bse,c4;l4.canUseDOM&&(c4=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function Nse(e,t){if(!l4.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,s=i in document;if(!s){var d=document.createElement("div");d.setAttribute(i,"return;"),s=typeof d[i]=="function"}return!s&&c4&&e==="wheel"&&(s=document.implementation.hasFeature("Events.wheel","3.0")),s}var $se=Nse,r3=10,i3=40,a3=800;function u4(e){var t=0,i=0,s=0,d=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),s=t*r3,d=i*r3,"deltaY"in e&&(d=e.deltaY),"deltaX"in e&&(s=e.deltaX),(s||d)&&e.deltaMode&&(e.deltaMode==1?(s*=i3,d*=i3):(s*=a3,d*=a3)),s&&!t&&(t=s<1?-1:1),d&&!i&&(i=d<1?-1:1),{spinX:t,spinY:i,pixelX:s,pixelY:d}}u4.getEventType=function(){return zse.firefox()?"DOMMouseScroll":$se("wheel")?"wheel":"mousewheel"};var Vse=u4;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const Use=function(e,t){if(e&&e.addEventListener){const i=function(s){const d=Vse(s);t&&Reflect.apply(t,this,[s,d])};e.addEventListener("wheel",i,{passive:!0})}},jse={beforeMount(e,t){Use(e,t.value)}};let Hse=1;const Gse=Ze({name:"ElTable",directives:{Mousewheel:jse},components:{TableHeader:yse,TableBody:Mse,TableFooter:kse,ElScrollbar:Ou,hColgroup:o4},props:Ose,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change","scroll"],setup(e){const{t}=vr(),i=rn("table"),s=jo();or(Du,s);const d=cse(s,e);s.store=d;const p=new dse({store:s.store,table:s,fit:e.fit,showHeader:e.showHeader});s.layout=p;const _=te(()=>(d.states.data.value||[]).length===0),{setCurrentRow:o,getSelectionRows:w,toggleRowSelection:C,clearSelection:M,clearFilter:I,toggleAllSelection:F,toggleRowExpansion:B,clearSort:N,sort:D,updateKeyChildren:j}=Pse(d),{isHidden:U,renderExpanded:ne,setDragVisible:K,isGroup:G,handleMouseLeave:J,handleHeaderFooterMousewheel:oe,tableSize:se,emptyBlockStyle:me,handleFixedMousewheel:de,resizeProxyVisible:ce,bodyWidth:pe,resizeState:ge,doLayout:Re,tableBodyStyles:Je,tableLayout:Me,scrollbarViewStyle:xe,scrollbarStyle:Ae}=Rse(e,p,d,s),{scrollBarRef:Ce,scrollTo:ve,setScrollLeft:Ne,setScrollTop:We}=Dse(),ot=il(Re,50),Oe=`${i.namespace.value}-table_${Hse++}`;s.tableId=Oe,s.state={isGroup:G,resizeState:ge,doLayout:Re,debouncedUpdateLayout:ot};const Ct=te(()=>{var bt;return(bt=e.sumText)!=null?bt:t("el.table.sumText")}),Mt=te(()=>{var bt;return(bt=e.emptyText)!=null?bt:t("el.table.emptyText")}),zt=te(()=>n4(d.states.originColumns.value)[0]);return Lse(s),ni(()=>{ot.cancel()}),{ns:i,layout:p,store:d,columns:zt,handleHeaderFooterMousewheel:oe,handleMouseLeave:J,tableId:Oe,tableSize:se,isHidden:U,isEmpty:_,renderExpanded:ne,resizeProxyVisible:ce,resizeState:ge,isGroup:G,bodyWidth:pe,tableBodyStyles:Je,emptyBlockStyle:me,debouncedUpdateLayout:ot,handleFixedMousewheel:de,setCurrentRow:o,getSelectionRows:w,toggleRowSelection:C,clearSelection:M,clearFilter:I,toggleAllSelection:F,toggleRowExpansion:B,clearSort:N,doLayout:Re,sort:D,updateKeyChildren:j,t,setDragVisible:K,context:s,computedSumText:Ct,computedEmptyText:Mt,tableLayout:Me,scrollbarViewStyle:xe,scrollbarStyle:Ae,scrollBarRef:Ce,scrollTo:ve,setScrollLeft:Ne,setScrollTop:We}}});function Wse(e,t,i,s,d,p){const _=Go("hColgroup"),o=Go("table-header"),w=Go("table-body"),C=Go("table-footer"),M=Go("el-scrollbar"),I=o1("mousewheel");return le(),Pe("div",{ref:"tableWrapper",class:he([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:to(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:e.handleMouseLeave},[Ve("div",{class:he(e.ns.e("inner-wrapper"))},[Ve("div",{ref:"hiddenColumns",class:"hidden-columns"},[_t(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?zo((le(),Pe("div",{key:0,ref:"headerWrapper",class:he(e.ns.e("header-wrapper"))},[Ve("table",{ref:"tableHeader",class:he(e.ns.e("header")),style:to(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[Qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Qe(o,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","onSetDragVisible"])],6)],2)),[[I,e.handleHeaderFooterMousewheel]]):St("v-if",!0),Ve("div",{ref:"bodyWrapper",class:he(e.ns.e("body-wrapper"))},[Qe(M,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn,tabindex:e.scrollbarTabindex,onScroll:F=>e.$emit("scroll",F)},{default:at(()=>[Ve("table",{ref:"tableBody",class:he(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:to({width:e.bodyWidth,tableLayout:e.tableLayout})},[Qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(le(),Rt(o,{key:0,ref:"tableHeaderRef",class:he(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):St("v-if",!0),Qe(w,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(le(),Rt(C,{key:1,class:he(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):St("v-if",!0)],6),e.isEmpty?(le(),Pe("div",{key:0,ref:"emptyBlock",style:to(e.emptyBlockStyle),class:he(e.ns.e("empty-block"))},[Ve("span",{class:he(e.ns.e("empty-text"))},[_t(e.$slots,"empty",{},()=>[Qo(yn(e.computedEmptyText),1)])],2)],6)):St("v-if",!0),e.$slots.append?(le(),Pe("div",{key:1,ref:"appendWrapper",class:he(e.ns.e("append-wrapper"))},[_t(e.$slots,"append")],2)):St("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex","onScroll"])],2),e.showSummary&&e.tableLayout==="fixed"?zo((le(),Pe("div",{key:1,ref:"footerWrapper",class:he(e.ns.e("footer-wrapper"))},[Ve("table",{class:he(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:to(e.tableBodyStyles)},[Qe(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Qe(C,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[Cr,!e.isEmpty],[I,e.handleHeaderFooterMousewheel]]):St("v-if",!0),e.border||e.isGroup?(le(),Pe("div",{key:2,class:he(e.ns.e("border-left-patch"))},null,2)):St("v-if",!0)],2),zo(Ve("div",{ref:"resizeProxy",class:he(e.ns.e("column-resize-proxy"))},null,2),[[Cr,e.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var qse=xn(Gse,[["render",Wse],["__file","table.vue"]]);const Kse={selection:"table-column--selection",expand:"table__expand-column"},Zse={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},Yse=e=>Kse[e]||"",Xse={selection:{renderHeader({store:e,column:t}){function i(){return e.states.data.value&&e.states.data.value.length===0}return lo(ac,{disabled:i(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:i,$index:s}){return lo(ac,{disabled:t.selectable?!t.selectable.call(null,e,s):!1,size:i.states.tableSize.value,onChange:()=>{i.commit("rowSelectedChanged",e)},onClick:d=>d.stopPropagation(),modelValue:i.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let i=t+1;const s=e.index;return ao(s)?i=t+s:Qn(s)&&(i=s(t)),lo("div",{},[i])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:i}){const{ns:s}=t,d=[s.e("expand-icon")];return i&&d.push(s.em("expand-icon","expanded")),lo("div",{class:d,onClick:function(_){_.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[lo(Gn,null,{default:()=>[lo(zs)]})]})},sortable:!1,resizable:!1}};function Jse({row:e,column:t,$index:i}){var s;const d=t.property,p=d&&Y0(e,d).value;return t&&t.formatter?t.formatter(e,t,p,i):((s=p==null?void 0:p.toString)==null?void 0:s.call(p))||""}function Qse({row:e,treeNode:t,store:i},s=!1){const{ns:d}=i;if(!t)return s?[lo("span",{class:d.e("placeholder")})]:null;const p=[],_=function(o){o.stopPropagation(),!t.loading&&i.loadOrToggle(e)};if(t.indent&&p.push(lo("span",{class:d.e("indent"),style:{"padding-left":`${t.indent}px`}})),ai(t.expanded)&&!t.noLazyChildren){const o=[d.e("expand-icon"),t.expanded?d.em("expand-icon","expanded"):""];let w=zs;t.loading&&(w=Iu),p.push(lo("div",{class:o,onClick:_},{default:()=>[lo(Gn,{class:{[d.is("loading")]:t.loading}},{default:()=>[lo(w)]})]}))}else p.push(lo("span",{class:d.e("placeholder")}));return p}function s3(e,t){return e.reduce((i,s)=>(i[s]=s,i),t)}function ele(e,t){const i=jo();return{registerComplexWatchers:()=>{const p=["fixed"],_={realWidth:"width",realMinWidth:"minWidth"},o=s3(p,_);Object.keys(o).forEach(w=>{const C=_[w];Tr(t,C)&&tn(()=>t[C],M=>{let I=M;C==="width"&&w==="realWidth"&&(I=cC(M)),C==="minWidth"&&w==="realMinWidth"&&(I=Zz(M)),i.columnConfig.value[C]=I,i.columnConfig.value[w]=I;const F=C==="fixed";e.value.store.scheduleLayout(F)})})},registerNormalWatchers:()=>{const p=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],_={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},o=s3(p,_);Object.keys(o).forEach(w=>{const C=_[w];Tr(t,C)&&tn(()=>t[C],M=>{i.columnConfig.value[w]=M})})}}}function tle(e,t,i){const s=jo(),d=we(""),p=we(!1),_=we(),o=we(),w=rn("table");Ha(()=>{_.value=e.align?`is-${e.align}`:null,_.value}),Ha(()=>{o.value=e.headerAlign?`is-${e.headerAlign}`:_.value,o.value});const C=te(()=>{let G=s.vnode.vParent||s.parent;for(;G&&!G.tableId&&!G.columnId;)G=G.vnode.vParent||G.parent;return G}),M=te(()=>{const{store:G}=s.parent;if(!G)return!1;const{treeData:J}=G.states,oe=J.value;return oe&&Object.keys(oe).length>0}),I=we(cC(e.width)),F=we(Zz(e.minWidth)),B=G=>(I.value&&(G.width=I.value),F.value&&(G.minWidth=F.value),!I.value&&F.value&&(G.width=void 0),G.minWidth||(G.minWidth=80),G.realWidth=Number(G.width===void 0?G.minWidth:G.width),G),N=G=>{const J=G.type,oe=Xse[J]||{};Object.keys(oe).forEach(me=>{const de=oe[me];me!=="className"&&de!==void 0&&(G[me]=de)});const se=Yse(J);if(se){const me=`${y(w.namespace)}-${se}`;G.className=G.className?`${G.className} ${me}`:me}return G},D=G=>{fn(G)?G.forEach(oe=>J(oe)):J(G);function J(oe){var se;((se=oe==null?void 0:oe.type)==null?void 0:se.name)==="ElTableColumn"&&(oe.vParent=s)}};return{columnId:d,realAlign:_,isSubColumn:p,realHeaderAlign:o,columnOrTableParent:C,setColumnWidth:B,setColumnForcedProps:N,setColumnRenders:G=>{e.renderHeader||G.type!=="selection"&&(G.renderHeader=oe=>(s.columnConfig.value.label,_t(t,"header",oe,()=>[G.label]))),t["filter-icon"]&&(G.renderFilterIcon=oe=>_t(t,"filter-icon",oe));let J=G.renderCell;return G.type==="expand"?(G.renderCell=oe=>lo("div",{class:"cell"},[J(oe)]),i.value.renderExpanded=oe=>t.default?t.default(oe):t.default):(J=J||Jse,G.renderCell=oe=>{let se=null;if(t.default){const Re=t.default(oe);se=Re.some(Je=>Je.type!==Sa)?Re:J(oe)}else se=J(oe);const{columns:me}=i.value.store.states,de=me.value.findIndex(Re=>Re.type==="default"),ce=M.value&&oe.cellIndex===de,pe=Qse(oe,ce),ge={class:"cell",style:{}};return G.showOverflowTooltip&&(ge.class=`${ge.class} ${y(w.namespace)}-tooltip`,ge.style={width:`${(oe.column.realWidth||Number(oe.column.width))-1}px`}),D(se),lo("div",ge,[pe,se])}),G},getPropsData:(...G)=>G.reduce((J,oe)=>(fn(oe)&&oe.forEach(se=>{J[se]=e[se]}),J),{}),getColumnElIndex:(G,J)=>Array.prototype.indexOf.call(G,J),updateColumnOrder:()=>{i.value.store.commit("updateColumnOrder",s.columnConfig.value)}}}var nle={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let ole=1;var d4=Ze({name:"ElTableColumn",components:{ElCheckbox:ac},props:nle,setup(e,{slots:t}){const i=jo(),s=we({}),d=te(()=>{let K=i.parent;for(;K&&!K.tableId;)K=K.parent;return K}),{registerNormalWatchers:p,registerComplexWatchers:_}=ele(d,e),{columnId:o,isSubColumn:w,realHeaderAlign:C,columnOrTableParent:M,setColumnWidth:I,setColumnForcedProps:F,setColumnRenders:B,getPropsData:N,getColumnElIndex:D,realAlign:j,updateColumnOrder:U}=tle(e,t,d),ne=M.value;o.value=`${ne.tableId||ne.columnId}_column_${ole++}`,n1(()=>{w.value=d.value!==ne;const K=e.type||"default",G=e.sortable===""?!0:e.sortable,J=Hr(e.showOverflowTooltip)?ne.props.showOverflowTooltip:e.showOverflowTooltip,oe={...Zse[K],id:o.value,type:K,property:e.prop||e.property,align:j,headerAlign:C,showOverflowTooltip:J,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:G,index:e.index,rawColumnKey:i.vnode.key};let pe=N(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);pe=Jae(oe,pe),pe=ese(B,I,F)(pe),s.value=pe,p(),_()}),No(()=>{var K;const G=M.value,J=w.value?G.vnode.el.children:(K=G.refs.hiddenColumns)==null?void 0:K.children,oe=()=>D(J||[],i.vnode.el);s.value.getColumnIndex=oe,oe()>-1&&d.value.store.commit("insertColumn",s.value,w.value?G.columnConfig.value:null,U)}),ni(()=>{const K=s.value.getColumnIndex;(K?K():-1)>-1&&d.value.store.commit("removeColumn",s.value,w.value?ne.columnConfig.value:null,U)}),i.columnId=o.value,i.columnConfig=s},render(){var e,t,i;try{const s=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),d=[];if(fn(s))for(const _ of s)((i=_.type)==null?void 0:i.name)==="ElTableColumn"||_.shapeFlag&2?d.push(_):_.type===eo&&fn(_.children)&&_.children.forEach(o=>{(o==null?void 0:o.patchFlag)!==1024&&!Zn(o==null?void 0:o.children)&&d.push(o)});return lo("div",d)}catch{return lo("div",[])}}});const rle=Ao(qse,{TableColumn:d4}),ile=Li(d4);var M_=(e=>(e.ASC="asc",e.DESC="desc",e))(M_||{}),I_=(e=>(e.CENTER="center",e.RIGHT="right",e))(I_||{}),h4=(e=>(e.LEFT="left",e.RIGHT="right",e))(h4||{});const fS={asc:"desc",desc:"asc"},A_=Symbol("placeholder"),ale=(e,t,i)=>{var s;const d={flexGrow:0,flexShrink:0,...i?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};i||(d.flexShrink=1);const p={...(s=e.style)!=null?s:{},...d,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(p.maxWidth=e.maxWidth),e.minWidth&&(p.minWidth=e.minWidth)),p};function sle(e,t,i){const s=te(()=>y(t).map((j,U)=>{var ne,K;return{...j,key:(K=(ne=j.key)!=null?ne:j.dataKey)!=null?K:U}})),d=te(()=>y(s).filter(j=>!j.hidden)),p=te(()=>y(d).filter(j=>j.fixed==="left"||j.fixed===!0)),_=te(()=>y(d).filter(j=>j.fixed==="right")),o=te(()=>y(d).filter(j=>!j.fixed)),w=te(()=>{const j=[];return y(p).forEach(U=>{j.push({...U,placeholderSign:A_})}),y(o).forEach(U=>{j.push(U)}),y(_).forEach(U=>{j.push({...U,placeholderSign:A_})}),j}),C=te(()=>y(p).length||y(_).length),M=te(()=>y(s).reduce((j,U)=>(j[U.key]=ale(U,y(i),e.fixed),j),{})),I=te(()=>y(d).reduce((j,U)=>j+U.width,0)),F=j=>y(s).find(U=>U.key===j),B=j=>y(M)[j],N=(j,U)=>{j.width=U};function D(j){var U;const{key:ne}=j.currentTarget.dataset;if(!ne)return;const{sortState:K,sortBy:G}=e;let J=M_.ASC;Vo(K)?J=fS[K[ne]]:J=fS[G.order],(U=e.onColumnSort)==null||U.call(e,{column:F(ne),key:ne,order:J})}return{columns:s,columnsStyles:M,columnsTotalWidth:I,fixedColumnsOnLeft:p,fixedColumnsOnRight:_,hasFixedColumns:C,mainColumns:w,normalColumns:o,visibleColumns:d,getColumn:F,getColumnStyle:B,updateColumnWidth:N,onColumnSorted:D}}const lle=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,onMaybeEndReached:d})=>{const p=we({scrollLeft:0,scrollTop:0});function _(B){var N,D,j;const{scrollTop:U}=B;(N=t.value)==null||N.scrollTo(B),(D=i.value)==null||D.scrollToTop(U),(j=s.value)==null||j.scrollToTop(U)}function o(B){p.value=B,_(B)}function w(B){p.value.scrollTop=B,_(y(p))}function C(B){var N,D;p.value.scrollLeft=B,(D=(N=t.value)==null?void 0:N.scrollTo)==null||D.call(N,y(p))}function M(B){var N;o(B),(N=e.onScroll)==null||N.call(e,B)}function I({scrollTop:B}){const{scrollTop:N}=y(p);B!==N&&w(B)}function F(B,N="auto"){var D;(D=t.value)==null||D.scrollToRow(B,N)}return tn(()=>y(p).scrollTop,(B,N)=>{B>N&&d()}),{scrollPos:p,scrollTo:o,scrollToLeft:C,scrollToTop:w,scrollToRow:F,onScroll:M,onVerticalScroll:I}},cle=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,tableInstance:d,ns:p,isScrolling:_})=>{const o=jo(),{emit:w}=o,C=gi(!1),M=we(e.defaultExpandedRowKeys||[]),I=we(-1),F=gi(null),B=we({}),N=we({}),D=gi({}),j=gi({}),U=gi({}),ne=te(()=>ao(e.estimatedRowHeight));function K(ce){var pe;(pe=e.onRowsRendered)==null||pe.call(e,ce),ce.rowCacheEnd>y(I)&&(I.value=ce.rowCacheEnd)}function G({hovered:ce,rowKey:pe}){if(_.value)return;d.vnode.el.querySelectorAll(`[rowkey="${String(pe)}"]`).forEach(Je=>{ce?Je.classList.add(p.is("hovered")):Je.classList.remove(p.is("hovered"))})}function J({expanded:ce,rowData:pe,rowIndex:ge,rowKey:Re}){var Je,Me;const xe=[...y(M)],Ae=xe.indexOf(Re);ce?Ae===-1&&xe.push(Re):Ae>-1&&xe.splice(Ae,1),M.value=xe,w("update:expandedRowKeys",xe),(Je=e.onRowExpand)==null||Je.call(e,{expanded:ce,rowData:pe,rowIndex:ge,rowKey:Re}),(Me=e.onExpandedRowsChange)==null||Me.call(e,xe)}const oe=il(()=>{var ce,pe,ge,Re;C.value=!0,B.value={...y(B),...y(N)},se(y(F),!1),N.value={},F.value=null,(ce=t.value)==null||ce.forceUpdate(),(pe=i.value)==null||pe.forceUpdate(),(ge=s.value)==null||ge.forceUpdate(),(Re=o.proxy)==null||Re.$forceUpdate(),C.value=!1},0);function se(ce,pe=!1){y(ne)&&[t,i,s].forEach(ge=>{const Re=y(ge);Re&&Re.resetAfterRowIndex(ce,pe)})}function me(ce,pe,ge){const Re=y(F);(Re===null||Re>ge)&&(F.value=ge),N.value[ce]=pe}function de({rowKey:ce,height:pe,rowIndex:ge},Re){Re?Re===h4.RIGHT?U.value[ce]=pe:D.value[ce]=pe:j.value[ce]=pe;const Je=Math.max(...[D,U,j].map(Me=>Me.value[ce]||0));y(B)[ce]!==Je&&(me(ce,Je,ge),oe())}return{expandedRowKeys:M,lastRenderedRowIndex:I,isDynamic:ne,isResetting:C,rowHeights:B,resetAfterIndex:se,onRowExpanded:J,onRowHovered:G,onRowsRendered:K,onRowHeightChange:de}},ule=(e,{expandedRowKeys:t,lastRenderedRowIndex:i,resetAfterIndex:s})=>{const d=we({}),p=te(()=>{const o={},{data:w,rowKey:C}=e,M=y(t);if(!M||!M.length)return w;const I=[],F=new Set;M.forEach(N=>F.add(N));let B=w.slice();for(B.forEach(N=>o[N[C]]=0);B.length>0;){const N=B.shift();I.push(N),F.has(N[C])&&fn(N.children)&&N.children.length>0&&(B=[...N.children,...B],N.children.forEach(D=>o[D[C]]=o[N[C]]+1))}return d.value=o,I}),_=te(()=>{const{data:o,expandColumnKey:w}=e;return w?y(p):o});return tn(_,(o,w)=>{o!==w&&(i.value=-1,s(0,!0))}),{data:_,depthMap:d}},dle=(e,t)=>e+t,sb=e=>fn(e)?e.reduce(dle,0):e,qf=(e,t,i={})=>Qn(e)?e(t):e??i,hh=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=ji(e[t])}),e),f4=e=>Ai(e)?t=>lo(e,t):e,hle=(e,{columnsTotalWidth:t,data:i,fixedColumnsOnLeft:s,fixedColumnsOnRight:d})=>{const p=te(()=>{const{fixed:K,width:G,vScrollbarSize:J}=e,oe=G-J;return K?Math.max(Math.round(y(t)),oe):oe}),_=te(()=>y(p)+e.vScrollbarSize),o=te(()=>{const{height:K=0,maxHeight:G=0,footerHeight:J,hScrollbarSize:oe}=e;if(G>0){const se=y(N),me=y(w),ce=y(B)+se+me+oe;return Math.min(ce,G-J)}return K-J}),w=te(()=>{const{rowHeight:K,estimatedRowHeight:G}=e,J=y(i);return ao(G)?J.length*G:J.length*K}),C=te(()=>{const{maxHeight:K}=e,G=y(o);if(ao(K)&&K>0)return G;const J=y(w)+y(B)+y(N);return Math.min(G,J)}),M=K=>K.width,I=te(()=>sb(y(s).map(M))),F=te(()=>sb(y(d).map(M))),B=te(()=>sb(e.headerHeight)),N=te(()=>{var K;return(((K=e.fixedData)==null?void 0:K.length)||0)*e.rowHeight}),D=te(()=>y(o)-y(B)-y(N)),j=te(()=>{const{style:K={},height:G,width:J}=e;return hh({...K,height:G,width:J})}),U=te(()=>hh({height:e.footerHeight})),ne=te(()=>({top:ji(y(B)),bottom:ji(e.footerHeight),width:ji(e.width)}));return{bodyWidth:p,fixedTableHeight:C,mainTableHeight:o,leftTableWidth:I,rightTableWidth:F,headerWidth:_,rowsHeight:w,windowHeight:D,footerHeight:U,emptyStyle:ne,rootStyle:j,headerHeight:B}};function fle(e){const t=we(),i=we(),s=we(),{columns:d,columnsStyles:p,columnsTotalWidth:_,fixedColumnsOnLeft:o,fixedColumnsOnRight:w,hasFixedColumns:C,mainColumns:M,onColumnSorted:I}=sle(e,Vr(e,"columns"),Vr(e,"fixed")),{scrollTo:F,scrollToLeft:B,scrollToTop:N,scrollToRow:D,onScroll:j,onVerticalScroll:U,scrollPos:ne}=lle(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,onMaybeEndReached:Ke}),K=rn("table-v2"),G=jo(),J=gi(!1),{expandedRowKeys:oe,lastRenderedRowIndex:se,isDynamic:me,isResetting:de,rowHeights:ce,resetAfterIndex:pe,onRowExpanded:ge,onRowHeightChange:Re,onRowHovered:Je,onRowsRendered:Me}=cle(e,{mainTableRef:t,leftTableRef:i,rightTableRef:s,tableInstance:G,ns:K,isScrolling:J}),{data:xe,depthMap:Ae}=ule(e,{expandedRowKeys:oe,lastRenderedRowIndex:se,resetAfterIndex:pe}),{bodyWidth:Ce,fixedTableHeight:ve,mainTableHeight:Ne,leftTableWidth:We,rightTableWidth:ot,headerWidth:Oe,rowsHeight:Ct,windowHeight:Mt,footerHeight:zt,emptyStyle:bt,rootStyle:Kt,headerHeight:$t}=hle(e,{columnsTotalWidth:_,data:xe,fixedColumnsOnLeft:o,fixedColumnsOnRight:w}),Le=we(),dn=te(()=>{const Be=y(xe).length===0;return fn(e.fixedData)?e.fixedData.length===0&&Be:Be});function At(Be){const{estimatedRowHeight:Ht,rowHeight:Ut,rowKey:Nt}=e;return Ht?y(ce)[y(xe)[Be][Nt]]||Ht:Ut}function Ke(){const{onEndReached:Be}=e;if(!Be)return;const{scrollTop:Ht}=y(ne),Ut=y(Ct),Nt=y(Mt),Et=Ut-(Ht+Nt)+e.hScrollbarSize;y(se)>=0&&Ut===Ht+y(Ne)-y($t)&&Be(Et)}return tn(()=>e.expandedRowKeys,Be=>oe.value=Be,{deep:!0}),{columns:d,containerRef:Le,mainTableRef:t,leftTableRef:i,rightTableRef:s,isDynamic:me,isResetting:de,isScrolling:J,hasFixedColumns:C,columnsStyles:p,columnsTotalWidth:_,data:xe,expandedRowKeys:oe,depthMap:Ae,fixedColumnsOnLeft:o,fixedColumnsOnRight:w,mainColumns:M,bodyWidth:Ce,emptyStyle:bt,rootStyle:Kt,headerWidth:Oe,footerHeight:zt,mainTableHeight:Ne,fixedTableHeight:ve,leftTableWidth:We,rightTableWidth:ot,showEmpty:dn,getRowHeight:At,onColumnSorted:I,onRowHovered:Je,onRowExpanded:ge,onRowsRendered:Me,onRowHeightChange:Re,scrollTo:F,scrollToLeft:B,scrollToTop:N,scrollToRow:D,onScroll:j,onVerticalScroll:U}}const hC=Symbol("tableV2"),p4=String,K_={type:ut(Array),required:!0},fC={type:ut(Array)},m4={...fC,required:!0},ple=String,l3={type:ut(Array),default:()=>Ri([])},Mf={type:Number,required:!0},g4={type:ut([String,Number,Symbol]),default:"id"},c3={type:ut(Object)},Rf=vn({class:String,columns:K_,columnsStyles:{type:ut(Object),required:!0},depth:Number,expandColumnKey:ple,estimatedRowHeight:{...Bf.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:ut(Function)},onRowHover:{type:ut(Function)},onRowHeightChange:{type:ut(Function)},rowData:{type:ut(Object),required:!0},rowEventHandlers:{type:ut(Object)},rowIndex:{type:Number,required:!0},rowKey:g4,style:{type:ut(Object)}}),Xw={type:Number,required:!0},pC=vn({class:String,columns:K_,fixedHeaderData:{type:ut(Array)},headerData:{type:ut(Array),required:!0},headerHeight:{type:ut([Number,Array]),default:50},rowWidth:Xw,rowHeight:{type:Number,default:50},height:Xw,width:Xw}),lb=vn({columns:K_,data:m4,fixedData:fC,estimatedRowHeight:Rf.estimatedRowHeight,width:Mf,height:Mf,headerWidth:Mf,headerHeight:pC.headerHeight,bodyWidth:Mf,rowHeight:Mf,cache:zz.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Bf.scrollbarAlwaysOn,scrollbarStartGap:Bf.scrollbarStartGap,scrollbarEndGap:Bf.scrollbarEndGap,class:p4,style:c3,containerStyle:c3,getRowHeight:{type:ut(Function),required:!0},rowKey:Rf.rowKey,onRowsRendered:{type:ut(Function)},onScroll:{type:ut(Function)}}),mle=vn({cache:lb.cache,estimatedRowHeight:Rf.estimatedRowHeight,rowKey:g4,headerClass:{type:ut([String,Function])},headerProps:{type:ut([Object,Function])},headerCellProps:{type:ut([Object,Function])},headerHeight:pC.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:ut([String,Function])},rowProps:{type:ut([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:ut([Object,Function])},columns:K_,data:m4,dataGetter:{type:ut(Function)},fixedData:fC,expandColumnKey:Rf.expandColumnKey,expandedRowKeys:l3,defaultExpandedRowKeys:l3,class:p4,fixed:Boolean,style:{type:ut(Object)},width:Mf,height:Mf,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Bf.hScrollbarSize,vScrollbarSize:Bf.vScrollbarSize,scrollbarAlwaysOn:Nz.alwaysOn,sortBy:{type:ut(Object),default:()=>({})},sortState:{type:ut(Object),default:void 0},onColumnSort:{type:ut(Function)},onExpandedRowsChange:{type:ut(Function)},onEndReached:{type:ut(Function)},onRowExpand:Rf.onRowExpand,onScroll:lb.onScroll,onRowsRendered:lb.onRowsRendered,rowEventHandlers:Rf.rowEventHandlers}),gle="ElTableV2Header",vle=Ze({name:gle,props:pC,setup(e,{slots:t,expose:i}){const s=rn("table-v2"),d=Un("tableV2GridScrollLeft"),p=we(),_=te(()=>hh({width:e.width,height:e.height})),o=te(()=>hh({width:e.rowWidth,height:e.height})),w=te(()=>ds(y(e.headerHeight))),C=F=>{const B=y(p);oo(()=>{B!=null&&B.scroll&&B.scroll({left:F})})},M=()=>{const F=s.e("fixed-header-row"),{columns:B,fixedHeaderData:N,rowHeight:D}=e;return N==null?void 0:N.map((j,U)=>{var ne;const K=hh({height:D,width:"100%"});return(ne=t.fixed)==null?void 0:ne.call(t,{class:F,columns:B,rowData:j,rowIndex:-(U+1),style:K})})},I=()=>{const F=s.e("dynamic-header-row"),{columns:B}=e;return y(w).map((N,D)=>{var j;const U=hh({width:"100%",height:N});return(j=t.dynamic)==null?void 0:j.call(t,{class:F,columns:B,headerIndex:D,style:U})})};return Ru(()=>{d!=null&&d.value&&C(d.value)}),i({scrollToLeft:C}),()=>{if(!(e.height<=0))return Qe("div",{ref:p,class:e.class,style:y(_),role:"rowgroup"},[Qe("div",{style:y(o),class:s.e("header")},[I(),M()])])}}});var _le=vle;const yle=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:i,atYStartEdge:s},d)=>{let p=null,_=0,o=0;const w=(M,I)=>{const F=M<=0&&t.value||M>=0&&e.value,B=I<=0&&s.value||I>=0&&i.value;return F&&B};return{hasReachedEdge:w,onWheel:M=>{Gf(p);let I=M.deltaX,F=M.deltaY;Math.abs(I)>Math.abs(F)?F=0:I=0,M.shiftKey&&F!==0&&(I=F,F=0),!(w(_,o)&&w(_+I,o+F))&&(_+=I,o+=F,M.preventDefault(),p=wh(()=>{d(_,o),_=0,o=0}))}}},v4=({name:e,clearCache:t,getColumnPosition:i,getColumnStartIndexForOffset:s,getColumnStopIndexForStartIndex:d,getEstimatedTotalHeight:p,getEstimatedTotalWidth:_,getColumnOffset:o,getRowOffset:w,getRowPosition:C,getRowStartIndexForOffset:M,getRowStopIndexForStartIndex:I,initCache:F,injectToInstance:B,validateProps:N})=>Ze({name:e??"ElVirtualList",props:Bf,emits:[Ob,Db],setup(D,{emit:j,expose:U,slots:ne}){const K=rn("vl");N(D);const G=jo(),J=we(F(D,G));B==null||B(G,J);const oe=we(),se=we(),me=we(),de=we(null),ce=we({isScrolling:!1,scrollLeft:ao(D.initScrollLeft)?D.initScrollLeft:0,scrollTop:ao(D.initScrollTop)?D.initScrollTop:0,updateRequested:!1,xAxisScrollDir:sm,yAxisScrollDir:sm}),pe=Lz(),ge=te(()=>Number.parseInt(`${D.height}`,10)),Re=te(()=>Number.parseInt(`${D.width}`,10)),Je=te(()=>{const{totalColumn:Nt,totalRow:Et,columnCache:Gt}=D,{isScrolling:ln,xAxisScrollDir:bn,scrollLeft:_n}=y(ce);if(Nt===0||Et===0)return[0,0,0,0];const jn=s(D,_n,y(J)),yt=d(D,jn,_n,y(J)),kn=!ln||bn===zb?Math.max(1,Gt):1,qn=!ln||bn===sm?Math.max(1,Gt):1;return[Math.max(0,jn-kn),Math.max(0,Math.min(Nt-1,yt+qn)),jn,yt]}),Me=te(()=>{const{totalColumn:Nt,totalRow:Et,rowCache:Gt}=D,{isScrolling:ln,yAxisScrollDir:bn,scrollTop:_n}=y(ce);if(Nt===0||Et===0)return[0,0,0,0];const jn=M(D,_n,y(J)),yt=I(D,jn,_n,y(J)),kn=!ln||bn===zb?Math.max(1,Gt):1,qn=!ln||bn===sm?Math.max(1,Gt):1;return[Math.max(0,jn-kn),Math.max(0,Math.min(Et-1,yt+qn)),jn,yt]}),xe=te(()=>p(D,y(J))),Ae=te(()=>_(D,y(J))),Ce=te(()=>{var Nt;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:D.direction,height:ao(D.height)?`${D.height}px`:D.height,width:ao(D.width)?`${D.width}px`:D.width},(Nt=D.style)!=null?Nt:{}]}),ve=te(()=>{const Nt=`${y(Ae)}px`;return{height:`${y(xe)}px`,pointerEvents:y(ce).isScrolling?"none":void 0,width:Nt}}),Ne=()=>{const{totalColumn:Nt,totalRow:Et}=D;if(Nt>0&&Et>0){const[yt,kn,qn,Co]=y(Je),[mo,Io,Ho,ur]=y(Me);j(Ob,{columnCacheStart:yt,columnCacheEnd:kn,rowCacheStart:mo,rowCacheEnd:Io,columnVisibleStart:qn,columnVisibleEnd:Co,rowVisibleStart:Ho,rowVisibleEnd:ur})}const{scrollLeft:Gt,scrollTop:ln,updateRequested:bn,xAxisScrollDir:_n,yAxisScrollDir:jn}=y(ce);j(Db,{xAxisScrollDir:_n,scrollLeft:Gt,yAxisScrollDir:jn,scrollTop:ln,updateRequested:bn})},We=Nt=>{const{clientHeight:Et,clientWidth:Gt,scrollHeight:ln,scrollLeft:bn,scrollTop:_n,scrollWidth:jn}=Nt.currentTarget,yt=y(ce);if(yt.scrollTop===_n&&yt.scrollLeft===bn)return;let kn=bn;if(WP(D.direction))switch(Bb()){case C_:kn=-bn;break;case lC:kn=jn-Gt-bn;break}ce.value={...yt,isScrolling:!0,scrollLeft:kn,scrollTop:Math.max(0,Math.min(_n,ln-Et)),updateRequested:!0,xAxisScrollDir:kf(yt.scrollLeft,kn),yAxisScrollDir:kf(yt.scrollTop,_n)},oo(()=>Kt()),$t(),Ne()},ot=(Nt,Et)=>{const Gt=y(ge),ln=(xe.value-Gt)/Et*Nt;Mt({scrollTop:Math.min(xe.value-Gt,ln)})},Oe=(Nt,Et)=>{const Gt=y(Re),ln=(Ae.value-Gt)/Et*Nt;Mt({scrollLeft:Math.min(Ae.value-Gt,ln)})},{onWheel:Ct}=yle({atXStartEdge:te(()=>ce.value.scrollLeft<=0),atXEndEdge:te(()=>ce.value.scrollLeft>=Ae.value-y(Re)),atYStartEdge:te(()=>ce.value.scrollTop<=0),atYEndEdge:te(()=>ce.value.scrollTop>=xe.value-y(ge))},(Nt,Et)=>{var Gt,ln,bn,_n;(ln=(Gt=se.value)==null?void 0:Gt.onMouseUp)==null||ln.call(Gt),(_n=(bn=me.value)==null?void 0:bn.onMouseUp)==null||_n.call(bn);const jn=y(Re),yt=y(ge);Mt({scrollLeft:Math.min(ce.value.scrollLeft+Nt,Ae.value-jn),scrollTop:Math.min(ce.value.scrollTop+Et,xe.value-yt)})});qr(oe,"wheel",Ct,{passive:!1});const Mt=({scrollLeft:Nt=ce.value.scrollLeft,scrollTop:Et=ce.value.scrollTop})=>{Nt=Math.max(Nt,0),Et=Math.max(Et,0);const Gt=y(ce);Et===Gt.scrollTop&&Nt===Gt.scrollLeft||(ce.value={...Gt,xAxisScrollDir:kf(Gt.scrollLeft,Nt),yAxisScrollDir:kf(Gt.scrollTop,Et),scrollLeft:Nt,scrollTop:Et,updateRequested:!0},oo(()=>Kt()),$t(),Ne())},zt=(Nt=0,Et=0,Gt=Ql)=>{const ln=y(ce);Et=Math.max(0,Math.min(Et,D.totalColumn-1)),Nt=Math.max(0,Math.min(Nt,D.totalRow-1));const bn=yO(K.namespace.value),_n=y(J),jn=p(D,_n),yt=_(D,_n);Mt({scrollLeft:o(D,Et,Gt,ln.scrollLeft,_n,yt>D.width?bn:0),scrollTop:w(D,Nt,Gt,ln.scrollTop,_n,jn>D.height?bn:0)})},bt=(Nt,Et)=>{const{columnWidth:Gt,direction:ln,rowHeight:bn}=D,_n=pe.value(t&&Gt,t&&bn,t&&ln),jn=`${Nt},${Et}`;if(Tr(_n,jn))return _n[jn];{const[,yt]=i(D,Et,y(J)),kn=y(J),qn=WP(ln),[Co,mo]=C(D,Nt,kn),[Io]=i(D,Et,kn);return _n[jn]={position:"absolute",left:qn?void 0:`${yt}px`,right:qn?`${yt}px`:void 0,top:`${mo}px`,height:`${Co}px`,width:`${Io}px`},_n[jn]}},Kt=()=>{ce.value.isScrolling=!1,oo(()=>{pe.value(-1,null,null)})};No(()=>{if(!gr)return;const{initScrollLeft:Nt,initScrollTop:Et}=D,Gt=y(oe);Gt&&(ao(Nt)&&(Gt.scrollLeft=Nt),ao(Et)&&(Gt.scrollTop=Et)),Ne()});const $t=()=>{const{direction:Nt}=D,{scrollLeft:Et,scrollTop:Gt,updateRequested:ln}=y(ce),bn=y(oe);if(ln&&bn){if(Nt===_m)switch(Bb()){case C_:{bn.scrollLeft=-Et;break}case sC:{bn.scrollLeft=Et;break}default:{const{clientWidth:_n,scrollWidth:jn}=bn;bn.scrollLeft=jn-_n-Et;break}}else bn.scrollLeft=Math.max(0,Et);bn.scrollTop=Math.max(0,Gt)}},{resetAfterColumnIndex:Le,resetAfterRowIndex:dn,resetAfter:At}=G.proxy;U({windowRef:oe,innerRef:de,getItemStyleCache:pe,scrollTo:Mt,scrollToItem:zt,states:ce,resetAfterColumnIndex:Le,resetAfterRowIndex:dn,resetAfter:At});const Ke=()=>{const{scrollbarAlwaysOn:Nt,scrollbarStartGap:Et,scrollbarEndGap:Gt,totalColumn:ln,totalRow:bn}=D,_n=y(Re),jn=y(ge),yt=y(Ae),kn=y(xe),{scrollLeft:qn,scrollTop:Co}=y(ce),mo=lo(nS,{ref:se,alwaysOn:Nt,startGap:Et,endGap:Gt,class:K.e("horizontal"),clientSize:_n,layout:"horizontal",onScroll:Oe,ratio:_n*100/yt,scrollFrom:qn/(yt-_n),total:bn,visible:!0}),Io=lo(nS,{ref:me,alwaysOn:Nt,startGap:Et,endGap:Gt,class:K.e("vertical"),clientSize:jn,layout:"vertical",onScroll:ot,ratio:jn*100/kn,scrollFrom:Co/(kn-jn),total:ln,visible:!0});return{horizontalScrollbar:mo,verticalScrollbar:Io}},Be=()=>{var Nt;const[Et,Gt]=y(Je),[ln,bn]=y(Me),{data:_n,totalColumn:jn,totalRow:yt,useIsScrolling:kn,itemKey:qn}=D,Co=[];if(yt>0&&jn>0)for(let mo=ln;mo<=bn;mo++)for(let Io=Et;Io<=Gt;Io++){const Ho=qn({columnIndex:Io,data:_n,rowIndex:mo});Co.push(lo(eo,{key:Ho},(Nt=ne.default)==null?void 0:Nt.call(ne,{columnIndex:Io,data:_n,isScrolling:kn?y(ce).isScrolling:void 0,style:bt(mo,Io),rowIndex:mo})))}return Co},Ht=()=>{const Nt=Wo(D.innerElement),Et=Be();return[lo(Nt,{style:y(ve),ref:de},Zn(Nt)?Et:{default:()=>Et})]};return()=>{const Nt=Wo(D.containerElement),{horizontalScrollbar:Et,verticalScrollbar:Gt}=Ke(),ln=Ht();return lo("div",{key:0,class:K.e("wrapper"),role:D.role},[lo(Nt,{class:D.className,style:y(Ce),onScroll:We,ref:oe},Zn(Nt)?ln:{default:()=>ln}),Et,Gt])}}}),{max:Vb,min:_4,floor:y4}=Math,ble={column:"columnWidth",row:"rowHeight"},pS={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Ju=(e,t,i,s)=>{const[d,p,_]=[i[s],e[ble[s]],i[pS[s]]];if(t>_){let o=0;if(_>=0){const w=d[_];o=w.offset+w.size}for(let w=_+1;w<=t;w++){const C=p(w);d[w]={offset:o,size:C},o+=C}i[pS[s]]=t}return d[t]},b4=(e,t,i,s,d,p)=>{for(;i<=s;){const _=i+y4((s-i)/2),o=Ju(e,_,t,p).offset;if(o===d)return _;o<d?i=_+1:s=_-1}return Vb(0,i-1)},xle=(e,t,i,s,d)=>{const p=d==="column"?e.totalColumn:e.totalRow;let _=1;for(;i<p&&Ju(e,i,t,d).offset<s;)i+=_,_*=2;return b4(e,t,y4(i/2),_4(i,p-1),s,d)},u3=(e,t,i,s)=>{const[d,p]=[t[s],t[pS[s]]];return(p>0?d[p].offset:0)>=i?b4(e,t,0,p,i,s):xle(e,t,Vb(0,p),i,s)},x4=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:i,row:s})=>{let d=0;if(i>=e&&(i=e-1),i>=0){const o=s[i];d=o.offset+o.size}const _=(e-i-1)*t;return d+_},w4=({totalColumn:e},{column:t,estimatedColumnWidth:i,lastVisitedColumnIndex:s})=>{let d=0;if(s>e&&(s=e-1),s>=0){const o=t[s];d=o.offset+o.size}const _=(e-s-1)*i;return d+_},wle={column:w4,row:x4},d3=(e,t,i,s,d,p,_)=>{const[o,w]=[p==="row"?e.height:e.width,wle[p]],C=Ju(e,t,d,p),M=w(e,d),I=Vb(0,_4(M-o,C.offset)),F=Vb(0,C.offset-o+_+C.size);switch(i===A1&&(s>=F-o&&s<=I+o?i=Ql:i=Tu),i){case S_:return I;case T_:return F;case Tu:return Math.round(F+(I-F)/2);case Ql:default:return s>=F&&s<=I?s:F>I||s<F?F:I}},Sle=v4({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,i)=>{const s=Ju(e,t,i,"column");return[s.size,s.offset]},getRowPosition:(e,t,i)=>{const s=Ju(e,t,i,"row");return[s.size,s.offset]},getColumnOffset:(e,t,i,s,d,p)=>d3(e,t,i,s,d,"column",p),getRowOffset:(e,t,i,s,d,p)=>d3(e,t,i,s,d,"row",p),getColumnStartIndexForOffset:(e,t,i)=>u3(e,i,t,"column"),getColumnStopIndexForStartIndex:(e,t,i,s)=>{const d=Ju(e,t,s,"column"),p=i+e.width;let _=d.offset+d.size,o=t;for(;o<e.totalColumn-1&&_<p;)o++,_+=Ju(e,t,s,"column").size;return o},getEstimatedTotalHeight:x4,getEstimatedTotalWidth:w4,getRowStartIndexForOffset:(e,t,i)=>u3(e,i,t,"row"),getRowStopIndexForStartIndex:(e,t,i,s)=>{const{totalRow:d,height:p}=e,_=Ju(e,t,s,"row"),o=i+p;let w=_.size+_.offset,C=t;for(;C<d-1&&w<o;)C++,w+=Ju(e,C,s,"row").size;return C},injectToInstance:(e,t)=>{const i=({columnIndex:p,rowIndex:_},o)=>{var w,C;o=Hr(o)?!0:o,ao(p)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,p-1)),ao(_)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,_-1)),(w=e.exposed)==null||w.getItemStyleCache.value(-1,null,null),o&&((C=e.proxy)==null||C.$forceUpdate())},s=(p,_)=>{i({columnIndex:p},_)},d=(p,_)=>{i({rowIndex:p},_)};Object.assign(e.proxy,{resetAfterColumnIndex:s,resetAfterRowIndex:d,resetAfter:i})},initCache:({estimatedColumnWidth:e=Y2,estimatedRowHeight:t=Y2})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),Tle=v4({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:i},s,d,p,_,o)=>{i=Number(i);const w=Math.max(0,e*t-i),C=Math.min(w,s*t),M=Math.max(0,s*t-i+o+t);switch(d==="smart"&&(p>=M-i&&p<=C+i?d=Ql:d=Tu),d){case S_:return C;case T_:return M;case Tu:{const I=Math.round(M+(C-M)/2);return I<Math.ceil(i/2)?0:I>w+Math.floor(i/2)?w:I}case Ql:default:return p>=M&&p<=C?p:M>C||p<M?M:C}},getRowOffset:({rowHeight:e,height:t,totalRow:i},s,d,p,_,o)=>{t=Number(t);const w=Math.max(0,i*e-t),C=Math.min(w,s*e),M=Math.max(0,s*e-t+o+e);switch(d===A1&&(p>=M-t&&p<=C+t?d=Ql:d=Tu),d){case S_:return C;case T_:return M;case Tu:{const I=Math.round(M+(C-M)/2);return I<Math.ceil(t/2)?0:I>w+Math.floor(t/2)?w:I}case Ql:default:return p>=M&&p<=C?p:M>C||p<M?M:C}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:i},s,d)=>{const p=s*e,_=Math.ceil((i+d-p)/e);return Math.max(0,Math.min(t-1,s+_-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:i},s,d)=>{const p=s*e,_=Math.ceil((i+d-p)/e);return Math.max(0,Math.min(t-1,s+_-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),Cle="ElTableV2Grid",Ele=e=>{const t=we(),i=we(),s=we(0),d=te(()=>{const{data:j,rowHeight:U,estimatedRowHeight:ne}=e;if(!ne)return j.length*U}),p=te(()=>{const{fixedData:j,rowHeight:U}=e;return((j==null?void 0:j.length)||0)*U}),_=te(()=>sb(e.headerHeight)),o=te(()=>{const{height:j}=e;return Math.max(0,j-y(_)-y(p))}),w=te(()=>y(_)+y(p)>0),C=({data:j,rowIndex:U})=>j[U][e.rowKey];function M({rowCacheStart:j,rowCacheEnd:U,rowVisibleStart:ne,rowVisibleEnd:K}){var G;(G=e.onRowsRendered)==null||G.call(e,{rowCacheStart:j,rowCacheEnd:U,rowVisibleStart:ne,rowVisibleEnd:K})}function I(j,U){var ne;(ne=i.value)==null||ne.resetAfterRowIndex(j,U)}function F(j,U){const ne=y(t),K=y(i);Vo(j)?(ne==null||ne.scrollToLeft(j.scrollLeft),s.value=j.scrollLeft,K==null||K.scrollTo(j)):(ne==null||ne.scrollToLeft(j),s.value=j,K==null||K.scrollTo({scrollLeft:j,scrollTop:U}))}function B(j){var U;(U=y(i))==null||U.scrollTo({scrollTop:j})}function N(j,U){var ne;(ne=y(i))==null||ne.scrollToItem(j,1,U)}function D(){var j,U;(j=y(i))==null||j.$forceUpdate(),(U=y(t))==null||U.$forceUpdate()}return{bodyRef:i,forceUpdate:D,fixedRowHeight:p,gridHeight:o,hasHeader:w,headerHeight:_,headerRef:t,totalHeight:d,itemKey:C,onItemRendered:M,resetAfterRowIndex:I,scrollTo:F,scrollToTop:B,scrollToRow:N,scrollLeft:s}},Mle=Ze({name:Cle,props:lb,setup(e,{slots:t,expose:i}){const{ns:s}=Un(hC),{bodyRef:d,fixedRowHeight:p,gridHeight:_,hasHeader:o,headerRef:w,headerHeight:C,totalHeight:M,forceUpdate:I,itemKey:F,onItemRendered:B,resetAfterRowIndex:N,scrollTo:D,scrollToTop:j,scrollToRow:U,scrollLeft:ne}=Ele(e);or("tableV2GridScrollLeft",ne),i({forceUpdate:I,totalHeight:M,scrollTo:D,scrollToTop:j,scrollToRow:U,resetAfterRowIndex:N});const K=()=>e.bodyWidth;return()=>{const{cache:G,columns:J,data:oe,fixedData:se,useIsScrolling:me,scrollbarAlwaysOn:de,scrollbarEndGap:ce,scrollbarStartGap:pe,style:ge,rowHeight:Re,bodyWidth:Je,estimatedRowHeight:Me,headerWidth:xe,height:Ae,width:Ce,getRowHeight:ve,onScroll:Ne}=e,We=ao(Me),ot=We?Sle:Tle,Oe=y(C);return Qe("div",{role:"table",class:[s.e("table"),e.class],style:ge},[Qe(ot,{ref:d,data:oe,useIsScrolling:me,itemKey:F,columnCache:0,columnWidth:We?K:Je,totalColumn:1,totalRow:oe.length,rowCache:G,rowHeight:We?ve:Re,width:Ce,height:y(_),class:s.e("body"),role:"rowgroup",scrollbarStartGap:pe,scrollbarEndGap:ce,scrollbarAlwaysOn:de,onScroll:Ne,onItemRendered:B,perfMode:!1},{default:Ct=>{var Mt;const zt=oe[Ct.rowIndex];return(Mt=t.row)==null?void 0:Mt.call(t,{...Ct,columns:J,rowData:zt})}}),y(o)&&Qe(_le,{ref:w,class:s.e("header-wrapper"),columns:J,headerData:oe,headerHeight:e.headerHeight,fixedHeaderData:se,rowWidth:xe,rowHeight:Re,width:Ce,height:Math.min(Oe+y(p),Ae)},{dynamic:t.header,fixed:t.row})])}}});var mC=Mle;function Ile(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Ale=(e,{slots:t})=>{const{mainTableRef:i,...s}=e;return Qe(mC,Yo({ref:i},s),Ile(t)?t:{default:()=>[t]})};var kle=Ale;function Ple(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Rle=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:i,...s}=e;return Qe(mC,Yo({ref:i},s),Ple(t)?t:{default:()=>[t]})};var Lle=Rle;function Ole(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Dle=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:i,...s}=e;return Qe(mC,Yo({ref:i},s),Ole(t)?t:{default:()=>[t]})};var zle=Dle;const Fle=e=>{const{isScrolling:t}=Un(hC),i=we(!1),s=we(),d=te(()=>ao(e.estimatedRowHeight)&&e.rowIndex>=0),p=(w=!1)=>{const C=y(s);if(!C)return;const{columns:M,onRowHeightChange:I,rowKey:F,rowIndex:B,style:N}=e,{height:D}=C.getBoundingClientRect();i.value=!0,oo(()=>{if(w||D!==Number.parseInt(N.height)){const j=M[0],U=(j==null?void 0:j.placeholderSign)===A_;I==null||I({rowKey:F,height:D,rowIndex:B},j&&!U&&j.fixed)}})},_=te(()=>{const{rowData:w,rowIndex:C,rowKey:M,onRowHover:I}=e,F=e.rowEventHandlers||{},B={};return Object.entries(F).forEach(([N,D])=>{Qn(D)&&(B[N]=j=>{D({event:j,rowData:w,rowIndex:C,rowKey:M})})}),I&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:N,hovered:D})=>{const j=B[N];B[N]=U=>{I({event:U,hovered:D,rowData:w,rowIndex:C,rowKey:M}),j==null||j(U)}}),B}),o=w=>{const{onRowExpand:C,rowData:M,rowIndex:I,rowKey:F}=e;C==null||C({expanded:w,rowData:M,rowIndex:I,rowKey:F})};return No(()=>{y(d)&&p(!0)}),{isScrolling:t,measurable:d,measured:i,rowRef:s,eventHandlers:_,onExpand:o}},Ble="ElTableV2TableRow",Nle=Ze({name:Ble,props:Rf,setup(e,{expose:t,slots:i,attrs:s}){const{eventHandlers:d,isScrolling:p,measurable:_,measured:o,rowRef:w,onExpand:C}=Fle(e);return t({onExpand:C}),()=>{const{columns:M,columnsStyles:I,expandColumnKey:F,depth:B,rowData:N,rowIndex:D,style:j}=e;let U=M.map((ne,K)=>{const G=fn(N.children)&&N.children.length>0&&ne.key===F;return i.cell({column:ne,columns:M,columnIndex:K,depth:B,style:I[ne.key],rowData:N,rowIndex:D,isScrolling:y(p),expandIconProps:G?{rowData:N,rowIndex:D,onExpand:C}:void 0})});if(i.row&&(U=i.row({cells:U.map(ne=>fn(ne)&&ne.length===1?ne[0]:ne),style:j,columns:M,depth:B,rowData:N,rowIndex:D,isScrolling:y(p)})),y(_)){const{height:ne,...K}=j||{},G=y(o);return Qe("div",Yo({ref:w,class:e.class,style:G?j:K,role:"row"},s,y(d)),[U])}return Qe("div",Yo(s,{ref:w,class:e.class,style:j,role:"row"},y(d)),[U])}}});var $le=Nle;function Vle(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Ule=(e,{slots:t})=>{const{columns:i,columnsStyles:s,depthMap:d,expandColumnKey:p,expandedRowKeys:_,estimatedRowHeight:o,hasFixedColumns:w,rowData:C,rowIndex:M,style:I,isScrolling:F,rowProps:B,rowClass:N,rowKey:D,rowEventHandlers:j,ns:U,onRowHovered:ne,onRowExpanded:K}=e,G=qf(N,{columns:i,rowData:C,rowIndex:M},""),J=qf(B,{columns:i,rowData:C,rowIndex:M}),oe=C[D],se=d[oe]||0,me=!!p,de=M<0,ce=[U.e("row"),G,{[U.e(`row-depth-${se}`)]:me&&M>=0,[U.is("expanded")]:me&&_.includes(oe),[U.is("fixed")]:!se&&de,[U.is("customized")]:!!t.row}],pe=w?ne:void 0,ge={...J,columns:i,columnsStyles:s,class:ce,depth:se,expandColumnKey:p,estimatedRowHeight:de?void 0:o,isScrolling:F,rowIndex:M,rowData:C,rowKey:oe,rowEventHandlers:j,style:I};return Qe($le,Yo(ge,{onRowExpand:K,onMouseenter:Me=>{pe==null||pe({hovered:!0,rowKey:oe,event:Me,rowData:C,rowIndex:M})},onMouseleave:Me=>{pe==null||pe({hovered:!1,rowKey:oe,event:Me,rowData:C,rowIndex:M})},rowkey:oe}),Vle(t)?t:{default:()=>[t]})};var jle=Ule;const gC=(e,{slots:t})=>{var i;const{cellData:s,style:d}=e,p=((i=s==null?void 0:s.toString)==null?void 0:i.call(s))||"",_=_t(t,"default",e,()=>[p]);return Qe("div",{class:e.class,title:p,style:d},[_])};gC.displayName="ElTableV2Cell";gC.inheritAttrs=!1;var Hle=gC;const Gle=e=>{const{expanded:t,expandable:i,onExpand:s,style:d,size:p}=e,_={onClick:i?()=>s(!t):void 0,class:e.class};return Qe(Gn,Yo(_,{size:p,style:d}),{default:()=>[Qe(zs,null,null)]})};var Wle=Gle;const S4=({columns:e,column:t,columnIndex:i,depth:s,expandIconProps:d,isScrolling:p,rowData:_,rowIndex:o,style:w,expandedRowKeys:C,ns:M,cellProps:I,expandColumnKey:F,indentSize:B,iconSize:N,rowKey:D},{slots:j})=>{const U=hh(w);if(t.placeholderSign===A_)return Qe("div",{class:M.em("row-cell","placeholder"),style:U},null);const{cellRenderer:ne,dataKey:K,dataGetter:G}=t,J=Qn(G)?G({columns:e,column:t,columnIndex:i,rowData:_,rowIndex:o}):Ji(_,K??""),oe=qf(I,{cellData:J,columns:e,column:t,columnIndex:i,rowIndex:o,rowData:_}),se={class:M.e("cell-text"),columns:e,column:t,columnIndex:i,cellData:J,isScrolling:p,rowData:_,rowIndex:o},me=f4(ne),de=me?me(se):_t(j,"default",se,()=>[Qe(Hle,se,null)]),ce=[M.e("row-cell"),t.class,t.align===I_.CENTER&&M.is("align-center"),t.align===I_.RIGHT&&M.is("align-right")],pe=o>=0&&F&&t.key===F,ge=o>=0&&C.includes(_[D]);let Re;const Je=`margin-inline-start: ${s*B}px;`;return pe&&(Vo(d)?Re=Qe(Wle,Yo(d,{class:[M.e("expand-icon"),M.is("expanded",ge)],size:N,expanded:ge,style:Je,expandable:!0}),null):Re=Qe("div",{style:[Je,`width: ${N}px; height: ${N}px;`].join(" ")},null)),Qe("div",Yo({class:ce,style:U},oe,{role:"cell"}),[Re,de])};S4.inheritAttrs=!1;var h3=S4;const qle=vn({class:String,columns:K_,columnsStyles:{type:ut(Object),required:!0},headerIndex:Number,style:{type:ut(Object)}}),Kle=Ze({name:"ElTableV2HeaderRow",props:qle,setup(e,{slots:t}){return()=>{const{columns:i,columnsStyles:s,headerIndex:d,style:p}=e;let _=i.map((o,w)=>t.cell({columns:i,column:o,columnIndex:w,headerIndex:d,style:s[o.key]}));return t.header&&(_=t.header({cells:_.map(o=>fn(o)&&o.length===1?o[0]:o),columns:i,headerIndex:d})),Qe("div",{class:e.class,style:p,role:"row"},[_])}}});var Zle=Kle;function Yle(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const Xle=({columns:e,columnsStyles:t,headerIndex:i,style:s,headerClass:d,headerProps:p,ns:_},{slots:o})=>{const w={columns:e,headerIndex:i},C=[_.e("header-row"),qf(d,w,""),{[_.is("customized")]:!!o.header}],M={...qf(p,w),columnsStyles:t,class:C,columns:e,headerIndex:i,style:s};return Qe(Zle,M,Yle(o)?o:{default:()=>[o]})};var Jle=Xle;const vC=(e,{slots:t})=>_t(t,"default",e,()=>{var i,s;return[Qe("div",{class:e.class,title:(i=e.column)==null?void 0:i.title},[(s=e.column)==null?void 0:s.title])]});vC.displayName="ElTableV2HeaderCell";vC.inheritAttrs=!1;var Qle=vC;const ece=e=>{const{sortOrder:t}=e;return Qe(Gn,{size:14,class:e.class},{default:()=>[t===M_.ASC?Qe(Pq,null,null):Qe(Aq,null,null)]})};var tce=ece;const nce=(e,{slots:t})=>{const{column:i,ns:s,style:d,onColumnSorted:p}=e,_=hh(d);if(i.placeholderSign===A_)return Qe("div",{class:s.em("header-row-cell","placeholder"),style:_},null);const{headerCellRenderer:o,headerClass:w,sortable:C}=i,M={...e,class:s.e("header-cell-text")},I=f4(o),F=I?I(M):_t(t,"default",M,()=>[Qe(Qle,M,null)]),{sortBy:B,sortState:N,headerCellProps:D}=e;let j,U;if(N){const G=N[i.key];j=!!fS[G],U=j?G:M_.ASC}else j=i.key===B.key,U=j?B.order:M_.ASC;const ne=[s.e("header-cell"),qf(w,e,""),i.align===I_.CENTER&&s.is("align-center"),i.align===I_.RIGHT&&s.is("align-right"),C&&s.is("sortable")],K={...qf(D,e),onClick:i.sortable?p:void 0,class:ne,style:_,"data-key":i.key};return Qe("div",Yo(K,{role:"columnheader"}),[F,C&&Qe(tce,{class:[s.e("sort-icon"),j&&s.is("sorting")],sortOrder:U},null)])};var f3=nce;const T4=(e,{slots:t})=>{var i;return Qe("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};T4.displayName="ElTableV2Footer";var oce=T4;const C4=(e,{slots:t})=>{const i=_t(t,"default",{},()=>[Qe(_z,null,null)]);return Qe("div",{class:e.class,style:e.style},[i])};C4.displayName="ElTableV2Empty";var rce=C4;const E4=(e,{slots:t})=>{var i;return Qe("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};E4.displayName="ElTableV2Overlay";var ice=E4;function Bv(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ai(e)}const ace="ElTableV2",sce=Ze({name:ace,props:mle,setup(e,{slots:t,expose:i}){const s=rn("table-v2"),{columnsStyles:d,fixedColumnsOnLeft:p,fixedColumnsOnRight:_,mainColumns:o,mainTableHeight:w,fixedTableHeight:C,leftTableWidth:M,rightTableWidth:I,data:F,depthMap:B,expandedRowKeys:N,hasFixedColumns:D,mainTableRef:j,leftTableRef:U,rightTableRef:ne,isDynamic:K,isResetting:G,isScrolling:J,bodyWidth:oe,emptyStyle:se,rootStyle:me,headerWidth:de,footerHeight:ce,showEmpty:pe,scrollTo:ge,scrollToLeft:Re,scrollToTop:Je,scrollToRow:Me,getRowHeight:xe,onColumnSorted:Ae,onRowHeightChange:Ce,onRowHovered:ve,onRowExpanded:Ne,onRowsRendered:We,onScroll:ot,onVerticalScroll:Oe}=fle(e);return i({scrollTo:ge,scrollToLeft:Re,scrollToTop:Je,scrollToRow:Me}),or(hC,{ns:s,isResetting:G,isScrolling:J}),()=>{const{cache:Ct,cellProps:Mt,estimatedRowHeight:zt,expandColumnKey:bt,fixedData:Kt,headerHeight:$t,headerClass:Le,headerProps:dn,headerCellProps:At,sortBy:Ke,sortState:Be,rowHeight:Ht,rowClass:Ut,rowEventHandlers:Nt,rowKey:Et,rowProps:Gt,scrollbarAlwaysOn:ln,indentSize:bn,iconSize:_n,useIsScrolling:jn,vScrollbarSize:yt,width:kn}=e,qn=y(F),Co={cache:Ct,class:s.e("main"),columns:y(o),data:qn,fixedData:Kt,estimatedRowHeight:zt,bodyWidth:y(oe)+yt,headerHeight:$t,headerWidth:y(de),height:y(w),mainTableRef:j,rowKey:Et,rowHeight:Ht,scrollbarAlwaysOn:ln,scrollbarStartGap:2,scrollbarEndGap:yt,useIsScrolling:jn,width:kn,getRowHeight:xe,onRowsRendered:We,onScroll:ot},mo=y(M),Io=y(C),Ho={cache:Ct,class:s.e("left"),columns:y(p),data:qn,estimatedRowHeight:zt,leftTableRef:U,rowHeight:Ht,bodyWidth:mo,headerWidth:mo,headerHeight:$t,height:Io,rowKey:Et,scrollbarAlwaysOn:ln,scrollbarStartGap:2,scrollbarEndGap:yt,useIsScrolling:jn,width:mo,getRowHeight:xe,onScroll:Oe},Dt=y(I)+yt,En={cache:Ct,class:s.e("right"),columns:y(_),data:qn,estimatedRowHeight:zt,rightTableRef:ne,rowHeight:Ht,bodyWidth:Dt,headerWidth:Dt,headerHeight:$t,height:Io,rowKey:Et,scrollbarAlwaysOn:ln,scrollbarStartGap:2,scrollbarEndGap:yt,width:Dt,style:`--${y(s.namespace)}-table-scrollbar-size: ${yt}px`,useIsScrolling:jn,getRowHeight:xe,onScroll:Oe},ft=y(d),un={ns:s,depthMap:y(B),columnsStyles:ft,expandColumnKey:bt,expandedRowKeys:y(N),estimatedRowHeight:zt,hasFixedColumns:y(D),rowProps:Gt,rowClass:Ut,rowKey:Et,rowEventHandlers:Nt,onRowHovered:ve,onRowExpanded:Ne,onRowHeightChange:Ce},et={cellProps:Mt,expandColumnKey:bt,indentSize:bn,iconSize:_n,rowKey:Et,expandedRowKeys:y(N),ns:s},Mn={ns:s,headerClass:Le,headerProps:dn,columnsStyles:ft},Bn={ns:s,sortBy:Ke,sortState:Be,headerCellProps:At,onColumnSorted:Ae},Lo={row:Er=>Qe(jle,Yo(Er,un),{row:t.row,cell:Nr=>{let Xo;return t.cell?Qe(h3,Yo(Nr,et,{style:ft[Nr.column.key]}),Bv(Xo=t.cell(Nr))?Xo:{default:()=>[Xo]}):Qe(h3,Yo(Nr,et,{style:ft[Nr.column.key]}),null)}}),header:Er=>Qe(Jle,Yo(Er,Mn),{header:t.header,cell:Nr=>{let Xo;return t["header-cell"]?Qe(f3,Yo(Nr,Bn,{style:ft[Nr.column.key]}),Bv(Xo=t["header-cell"](Nr))?Xo:{default:()=>[Xo]}):Qe(f3,Yo(Nr,Bn,{style:ft[Nr.column.key]}),null)}})},Rr=[e.class,s.b(),s.e("root"),{[s.is("dynamic")]:y(K)}],hi={class:s.e("footer"),style:y(ce)};return Qe("div",{class:Rr,style:y(me)},[Qe(kle,Co,Bv(Lo)?Lo:{default:()=>[Lo]}),Qe(Lle,Ho,Bv(Lo)?Lo:{default:()=>[Lo]}),Qe(zle,En,Bv(Lo)?Lo:{default:()=>[Lo]}),t.footer&&Qe(oce,hi,{default:t.footer}),y(pe)&&Qe(rce,{class:s.e("empty"),style:y(se)},{default:t.empty}),t.overlay&&Qe(ice,{class:s.e("overlay")},{default:t.overlay})])}}});var lce=sce;const cce=vn({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:ut(Function)}}),uce=e=>{const t=we(),i=we(0),s=we(0);let d;return No(()=>{d=Mi(t,([p])=>{const{width:_,height:o}=p.contentRect,{paddingLeft:w,paddingRight:C,paddingTop:M,paddingBottom:I}=getComputedStyle(p.target),F=Number.parseInt(w)||0,B=Number.parseInt(C)||0,N=Number.parseInt(M)||0,D=Number.parseInt(I)||0;i.value=_-F-B,s.value=o-N-D}).stop}),ni(()=>{d==null||d()}),tn([i,s],([p,_])=>{var o;(o=e.onResize)==null||o.call(e,{width:p,height:_})}),{sizer:t,width:i,height:s}},dce=Ze({name:"ElAutoResizer",props:cce,setup(e,{slots:t}){const i=rn("auto-resizer"),{height:s,width:d,sizer:p}=uce(e),_={width:"100%",height:"100%"};return()=>{var o;return Qe("div",{ref:p,class:i.b(),style:_},[(o=t.default)==null?void 0:o.call(t,{height:s.value,width:d.value})])}}});var hce=dce;const fce=Ao(lce),pce=Ao(hce),k1=Symbol("tabsRootContextKey"),mce=vn({tabs:{type:ut(Array),default:()=>Ri([])}}),M4="ElTabBar",gce=Ze({name:M4}),vce=Ze({...gce,props:mce,setup(e,{expose:t}){const i=e,s=jo(),d=Un(k1);d||ha(M4,"<el-tabs><el-tab-bar /></el-tabs>");const p=rn("tabs"),_=we(),o=we(),w=()=>{let B=0,N=0;const D=["top","bottom"].includes(d.props.tabPosition)?"width":"height",j=D==="width"?"x":"y",U=j==="x"?"left":"top";return i.tabs.every(ne=>{var K,G;const J=(G=(K=s.parent)==null?void 0:K.refs)==null?void 0:G[`tab-${ne.uid}`];if(!J)return!1;if(!ne.active)return!0;B=J[`offset${Su(U)}`],N=J[`client${Su(D)}`];const oe=window.getComputedStyle(J);return D==="width"&&(N-=Number.parseFloat(oe.paddingLeft)+Number.parseFloat(oe.paddingRight),B+=Number.parseFloat(oe.paddingLeft)),!1}),{[D]:`${N}px`,transform:`translate${Su(j)}(${B}px)`}},C=()=>o.value=w(),M=[],I=()=>{var B;M.forEach(D=>D.stop()),M.length=0;const N=(B=s.parent)==null?void 0:B.refs;if(N){for(const D in N)if(D.startsWith("tab-")){const j=N[D];j&&M.push(Mi(j,C))}}};tn(()=>i.tabs,async()=>{await oo(),C(),I()},{immediate:!0});const F=Mi(_,()=>C());return ni(()=>{M.forEach(B=>B.stop()),M.length=0,F.stop()}),t({ref:_,update:C}),(B,N)=>(le(),Pe("div",{ref_key:"barRef",ref:_,class:he([y(p).e("active-bar"),y(p).is(y(d).props.tabPosition)]),style:to(o.value)},null,6))}});var _ce=xn(vce,[["__file","tab-bar.vue"]]);const yce=vn({panes:{type:ut(Array),default:()=>Ri([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),bce={tabClick:(e,t,i)=>i instanceof Event,tabRemove:(e,t)=>t instanceof Event},p3="ElTabNav",xce=Ze({name:p3,props:yce,emits:bce,setup(e,{expose:t,emit:i}){const s=Un(k1);s||ha(p3,"<el-tabs><tab-nav /></el-tabs>");const d=rn("tabs"),p=ZG(),_=sW(),o=we(),w=we(),C=we(),M=we(),I=we(!1),F=we(0),B=we(!1),N=we(!0),D=te(()=>["top","bottom"].includes(s.props.tabPosition)?"width":"height"),j=te(()=>({transform:`translate${D.value==="width"?"X":"Y"}(-${F.value}px)`})),U=()=>{if(!o.value)return;const me=o.value[`offset${Su(D.value)}`],de=F.value;if(!de)return;const ce=de>me?de-me:0;F.value=ce},ne=()=>{if(!o.value||!w.value)return;const me=w.value[`offset${Su(D.value)}`],de=o.value[`offset${Su(D.value)}`],ce=F.value;if(me-ce<=de)return;const pe=me-ce>de*2?ce+de:me-de;F.value=pe},K=async()=>{const me=w.value;if(!I.value||!C.value||!o.value||!me)return;await oo();const de=C.value.querySelector(".is-active");if(!de)return;const ce=o.value,pe=["top","bottom"].includes(s.props.tabPosition),ge=de.getBoundingClientRect(),Re=ce.getBoundingClientRect(),Je=pe?me.offsetWidth-Re.width:me.offsetHeight-Re.height,Me=F.value;let xe=Me;pe?(ge.left<Re.left&&(xe=Me-(Re.left-ge.left)),ge.right>Re.right&&(xe=Me+ge.right-Re.right)):(ge.top<Re.top&&(xe=Me-(Re.top-ge.top)),ge.bottom>Re.bottom&&(xe=Me+(ge.bottom-Re.bottom))),xe=Math.max(xe,0),F.value=Math.min(xe,Je)},G=()=>{var me;if(!w.value||!o.value)return;e.stretch&&((me=M.value)==null||me.update());const de=w.value[`offset${Su(D.value)}`],ce=o.value[`offset${Su(D.value)}`],pe=F.value;ce<de?(I.value=I.value||{},I.value.prev=pe,I.value.next=pe+ce<de,de-pe<ce&&(F.value=de-ce)):(I.value=!1,pe>0&&(F.value=0))},J=me=>{let de=0;switch(me.code){case Ln.left:case Ln.up:de=-1;break;case Ln.right:case Ln.down:de=1;break;default:return}const ce=Array.from(me.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let ge=ce.indexOf(me.target)+de;ge<0?ge=ce.length-1:ge>=ce.length&&(ge=0),ce[ge].focus({preventScroll:!0}),ce[ge].click(),oe()},oe=()=>{N.value&&(B.value=!0)},se=()=>B.value=!1;return tn(p,me=>{me==="hidden"?N.value=!1:me==="visible"&&setTimeout(()=>N.value=!0,50)}),tn(_,me=>{me?setTimeout(()=>N.value=!0,50):N.value=!1}),Mi(C,G),No(()=>setTimeout(()=>K(),0)),Ru(()=>G()),t({scrollToActiveTab:K,removeFocus:se}),()=>{const me=I.value?[Qe("span",{class:[d.e("nav-prev"),d.is("disabled",!I.value.prev)],onClick:U},[Qe(Gn,null,{default:()=>[Qe(Sh,null,null)]})]),Qe("span",{class:[d.e("nav-next"),d.is("disabled",!I.value.next)],onClick:ne},[Qe(Gn,null,{default:()=>[Qe(zs,null,null)]})])]:null,de=e.panes.map((ce,pe)=>{var ge,Re,Je,Me;const xe=ce.uid,Ae=ce.props.disabled,Ce=(Re=(ge=ce.props.name)!=null?ge:ce.index)!=null?Re:`${pe}`,ve=!Ae&&(ce.isClosable||e.editable);ce.index=`${pe}`;const Ne=ve?Qe(Gn,{class:"is-icon-close",onClick:Oe=>i("tabRemove",ce,Oe)},{default:()=>[Qe(Xc,null,null)]}):null,We=((Me=(Je=ce.slots).label)==null?void 0:Me.call(Je))||ce.props.label,ot=!Ae&&ce.active?0:-1;return Qe("div",{ref:`tab-${xe}`,class:[d.e("item"),d.is(s.props.tabPosition),d.is("active",ce.active),d.is("disabled",Ae),d.is("closable",ve),d.is("focus",B.value)],id:`tab-${Ce}`,key:`tab-${xe}`,"aria-controls":`pane-${Ce}`,role:"tab","aria-selected":ce.active,tabindex:ot,onFocus:()=>oe(),onBlur:()=>se(),onClick:Oe=>{se(),i("tabClick",ce,Ce,Oe)},onKeydown:Oe=>{ve&&(Oe.code===Ln.delete||Oe.code===Ln.backspace)&&i("tabRemove",ce,Oe)}},[We,Ne])});return Qe("div",{ref:C,class:[d.e("nav-wrap"),d.is("scrollable",!!I.value),d.is(s.props.tabPosition)]},[me,Qe("div",{class:d.e("nav-scroll"),ref:o},[Qe("div",{class:[d.e("nav"),d.is(s.props.tabPosition),d.is("stretch",e.stretch&&["top","bottom"].includes(s.props.tabPosition))],ref:w,style:j.value,role:"tablist",onKeydown:J},[e.type?null:Qe(_ce,{ref:M,tabs:[...e.panes]},null),de])])])}}}),wce=vn({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:ut(Function),default:()=>!0},stretch:Boolean}),Jw=e=>Zn(e)||ao(e),Sce={[Fo]:e=>Jw(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>Jw(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>Jw(e),tabAdd:()=>!0},Tce=Ze({name:"ElTabs",props:wce,emits:Sce,setup(e,{emit:t,slots:i,expose:s}){var d;const p=rn("tabs"),_=te(()=>["left","right"].includes(e.tabPosition)),{children:o,addChild:w,removeChild:C}=BT(jo(),"ElTabPane"),M=we(),I=we((d=e.modelValue)!=null?d:"0"),F=async(U,ne=!1)=>{var K,G,J;if(!(I.value===U||Hr(U)))try{await((K=e.beforeLeave)==null?void 0:K.call(e,U,I.value))!==!1&&(I.value=U,ne&&(t(Fo,U),t("tabChange",U)),(J=(G=M.value)==null?void 0:G.removeFocus)==null||J.call(G))}catch{}},B=(U,ne,K)=>{U.props.disabled||(F(ne,!0),t("tabClick",U,K))},N=(U,ne)=>{U.props.disabled||Hr(U.props.name)||(ne.stopPropagation(),t("edit",U.props.name,"remove"),t("tabRemove",U.props.name))},D=()=>{t("edit",void 0,"add"),t("tabAdd")};tn(()=>e.modelValue,U=>F(U)),tn(I,async()=>{var U;await oo(),(U=M.value)==null||U.scrollToActiveTab()}),or(k1,{props:e,currentName:I,registerPane:U=>{o.value.push(U)},sortPane:w,unregisterPane:C}),s({currentName:I});const j=({render:U})=>U();return()=>{const U=i["add-icon"],ne=e.editable||e.addable?Qe("div",{class:[p.e("new-tab"),_.value&&p.e("new-tab-vertical")],tabindex:"0",onClick:D,onKeydown:J=>{[Ln.enter,Ln.numpadEnter].includes(J.code)&&D()}},[U?_t(i,"add-icon"):Qe(Gn,{class:p.is("icon-plus")},{default:()=>[Qe(TO,null,null)]})]):null,K=Qe("div",{class:[p.e("header"),_.value&&p.e("header-vertical"),p.is(e.tabPosition)]},[Qe(j,{render:()=>{const J=o.value.some(oe=>oe.slots.label);return Qe(xce,{ref:M,currentName:I.value,editable:e.editable,type:e.type,panes:o.value,stretch:e.stretch,onTabClick:B,onTabRemove:N},{$stable:!J})}},null),ne]),G=Qe("div",{class:p.e("content")},[_t(i,"default")]);return Qe("div",{class:[p.b(),p.m(e.tabPosition),{[p.m("card")]:e.type==="card",[p.m("border-card")]:e.type==="border-card"}]},[G,K])}}});var Cce=Tce;const Ece=vn({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),I4="ElTabPane",Mce=Ze({name:I4}),Ice=Ze({...Mce,props:Ece,setup(e){const t=e,i=jo(),s=aa(),d=Un(k1);d||ha(I4,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const p=rn("tab-pane"),_=we(),o=te(()=>t.closable||d.props.closable),w=T2(()=>{var B;return d.currentName.value===((B=t.name)!=null?B:_.value)}),C=we(w.value),M=te(()=>{var B;return(B=t.name)!=null?B:_.value}),I=T2(()=>!t.lazy||C.value||w.value);tn(w,B=>{B&&(C.value=!0)});const F=Ir({uid:i.uid,slots:s,props:t,paneName:M,active:w,index:_,isClosable:o});return d.registerPane(F),No(()=>{d.sortPane(F)}),kh(()=>{d.unregisterPane(F.uid)}),(B,N)=>y(I)?zo((le(),Pe("div",{key:0,id:`pane-${y(M)}`,class:he(y(p).b()),role:"tabpanel","aria-hidden":!y(w),"aria-labelledby":`tab-${y(M)}`},[_t(B.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[Cr,y(w)]]):St("v-if",!0)}});var A4=xn(Ice,[["__file","tab-pane.vue"]]);const Ace=Ao(Cce,{TabPane:A4}),kce=Li(A4),Pce=vn({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:Lu,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),Rce=Ze({name:"ElText"}),Lce=Ze({...Rce,props:Pce,setup(e){const t=e,i=na(),s=rn("text"),d=te(()=>[s.b(),s.m(t.type),s.m(i.value),s.is("truncated",t.truncated),s.is("line-clamp",!Hr(t.lineClamp))]);return(p,_)=>(le(),Rt(Wo(p.tag),{class:he(y(d)),style:to({"-webkit-line-clamp":p.lineClamp})},{default:at(()=>[_t(p.$slots,"default")]),_:3},8,["class","style"]))}});var Oce=xn(Lce,[["__file","text.vue"]]);const Dce=Ao(Oce),zce=vn({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:ut(String),default:"light"},clearable:{type:Boolean,default:!0},size:ia,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:ut([String,Object]),default:()=>SO},clearIcon:{type:ut([String,Object]),default:()=>pd},...Km}),nd=e=>{const t=(e||"").split(":");if(t.length>=2){let i=Number.parseInt(t[0],10);const s=Number.parseInt(t[1],10),d=e.toUpperCase();return d.includes("AM")&&i===12?i=0:d.includes("PM")&&i!==12&&(i+=12),{hours:i,minutes:s}}return null},Qw=(e,t)=>{const i=nd(e);if(!i)return-1;const s=nd(t);if(!s)return-1;const d=i.minutes+i.hours*60,p=s.minutes+s.hours*60;return d===p?0:d>p?1:-1},m3=e=>`${e}`.padStart(2,"0"),rm=e=>`${m3(e.hours)}:${m3(e.minutes)}`,Fce=(e,t)=>{const i=nd(e);if(!i)return"";const s=nd(t);if(!s)return"";const d={hours:i.hours,minutes:i.minutes};return d.minutes+=s.minutes,d.hours+=s.hours,d.hours+=Math.floor(d.minutes/60),d.minutes=d.minutes%60,rm(d)},Bce=Ze({name:"ElTimeSelect"}),Nce=Ze({...Bce,props:zce,emits:["change","blur","focus","clear","update:modelValue"],setup(e,{expose:t}){const i=e;Mo.extend(UT);const{Option:s}=Wf,d=rn("input"),p=we(),_=Za(),{lang:o}=vr(),w=te(()=>i.modelValue),C=te(()=>{const U=nd(i.start);return U?rm(U):null}),M=te(()=>{const U=nd(i.end);return U?rm(U):null}),I=te(()=>{const U=nd(i.step);return U?rm(U):null}),F=te(()=>{const U=nd(i.minTime||"");return U?rm(U):null}),B=te(()=>{const U=nd(i.maxTime||"");return U?rm(U):null}),N=te(()=>{const U=[];if(i.start&&i.end&&i.step){let ne=C.value,K;for(;ne&&M.value&&Qw(ne,M.value)<=0;)K=Mo(ne,"HH:mm").locale(o.value).format(i.format),U.push({value:K,disabled:Qw(ne,F.value||"-1:-1")<=0||Qw(ne,B.value||"100:100")>=0}),ne=Fce(ne,I.value)}return U});return t({blur:()=>{var U,ne;(ne=(U=p.value)==null?void 0:U.blur)==null||ne.call(U)},focus:()=>{var U,ne;(ne=(U=p.value)==null?void 0:U.focus)==null||ne.call(U)}}),(U,ne)=>(le(),Rt(y(Wf),{ref_key:"select",ref:p,"model-value":y(w),disabled:y(_),clearable:U.clearable,"clear-icon":U.clearIcon,size:U.size,effect:U.effect,placeholder:U.placeholder,"default-first-option":"",filterable:U.editable,"empty-values":U.emptyValues,"value-on-clear":U.valueOnClear,"onUpdate:modelValue":K=>U.$emit("update:modelValue",K),onChange:K=>U.$emit("change",K),onBlur:K=>U.$emit("blur",K),onFocus:K=>U.$emit("focus",K),onClear:()=>U.$emit("clear")},{prefix:at(()=>[U.prefixIcon?(le(),Rt(y(Gn),{key:0,class:he(y(d).e("prefix-icon"))},{default:at(()=>[(le(),Rt(Wo(U.prefixIcon)))]),_:1},8,["class"])):St("v-if",!0)]),default:at(()=>[(le(!0),Pe(eo,null,nr(y(N),K=>(le(),Rt(y(s),{key:K.value,label:K.value,value:K.value,disabled:K.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var $ce=xn(Nce,[["__file","time-select.vue"]]);const Vce=Ao($ce),Uce=Ze({name:"ElTimeline",setup(e,{slots:t}){const i=rn("timeline");return or("timeline",t),()=>lo("ul",{class:[i.b()]},[_t(t,"default")])}}),jce=vn({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:Xr},hollow:Boolean}),Hce=Ze({name:"ElTimelineItem"}),Gce=Ze({...Hce,props:jce,setup(e){const t=e,i=rn("timeline-item"),s=te(()=>[i.e("node"),i.em("node",t.size||""),i.em("node",t.type||""),i.is("hollow",t.hollow)]);return(d,p)=>(le(),Pe("li",{class:he([y(i).b(),{[y(i).e("center")]:d.center}])},[Ve("div",{class:he(y(i).e("tail"))},null,2),d.$slots.dot?St("v-if",!0):(le(),Pe("div",{key:0,class:he(y(s)),style:to({backgroundColor:d.color})},[d.icon?(le(),Rt(y(Gn),{key:0,class:he(y(i).e("icon"))},{default:at(()=>[(le(),Rt(Wo(d.icon)))]),_:1},8,["class"])):St("v-if",!0)],6)),d.$slots.dot?(le(),Pe("div",{key:1,class:he(y(i).e("dot"))},[_t(d.$slots,"dot")],2)):St("v-if",!0),Ve("div",{class:he(y(i).e("wrapper"))},[!d.hideTimestamp&&d.placement==="top"?(le(),Pe("div",{key:0,class:he([y(i).e("timestamp"),y(i).is("top")])},yn(d.timestamp),3)):St("v-if",!0),Ve("div",{class:he(y(i).e("content"))},[_t(d.$slots,"default")],2),!d.hideTimestamp&&d.placement==="bottom"?(le(),Pe("div",{key:1,class:he([y(i).e("timestamp"),y(i).is("bottom")])},yn(d.timestamp),3)):St("v-if",!0)],2)],2))}});var k4=xn(Gce,[["__file","timeline-item.vue"]]);const Wce=Ao(Uce,{TimelineItem:k4}),qce=Li(k4),P4=vn({nowrap:Boolean});var R4=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(R4||{});const Kce=Object.values(R4),_C=vn({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:ut(Object),default:null}}),Zce=vn({side:{type:ut(String),values:Kce,required:!0}}),Yce=["absolute","fixed"],Xce=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],yC=vn({arrowPadding:{type:ut(Number),default:5},effect:{type:ut(String),default:"light"},contentClass:String,placement:{type:ut(String),values:Xce,default:"bottom"},reference:{type:ut(Object),default:null},offset:{type:Number,default:8},strategy:{type:ut(String),values:Yce,default:"absolute"},showArrow:Boolean,...Da(["ariaLabel"])}),bC=vn({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:ut(Function)},"onUpdate:open":{type:ut(Function)}}),Qp={type:ut(Function)},xC=vn({onBlur:Qp,onClick:Qp,onFocus:Qp,onMouseDown:Qp,onMouseEnter:Qp,onMouseLeave:Qp}),Jce=vn({...bC,..._C,...xC,...yC,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:ut(Object),default:null},teleported:Boolean,to:{type:ut(String),default:"body"}}),P1=Symbol("tooltipV2"),L4=Symbol("tooltipV2Content"),e2="tooltip_v2.open",Qce=Ze({name:"ElTooltipV2Root"}),eue=Ze({...Qce,props:bC,setup(e,{expose:t}){const i=e,s=we(i.defaultOpen),d=we(null),p=te({get:()=>jf(i.open)?s.value:i.open,set:j=>{var U;s.value=j,(U=i["onUpdate:open"])==null||U.call(i,j)}}),_=te(()=>ao(i.delayDuration)&&i.delayDuration>0),{start:o,stop:w}=Hf(()=>{p.value=!0},te(()=>i.delayDuration),{immediate:!1}),C=rn("tooltip-v2"),M=Oa(),I=()=>{w(),p.value=!0},F=()=>{y(_)?o():I()},B=I,N=()=>{w(),p.value=!1};return tn(p,j=>{var U;j&&(document.dispatchEvent(new CustomEvent(e2)),B()),(U=i.onOpenChange)==null||U.call(i,j)}),No(()=>{document.addEventListener(e2,N)}),ni(()=>{w(),document.removeEventListener(e2,N)}),or(P1,{contentId:M,triggerRef:d,ns:C,onClose:N,onDelayOpen:F,onOpen:B}),t({onOpen:B,onClose:N}),(j,U)=>_t(j.$slots,"default",{open:y(p)})}});var tue=xn(eue,[["__file","root.vue"]]);const nue=Ze({name:"ElTooltipV2Arrow"}),oue=Ze({...nue,props:{..._C,...Zce},setup(e){const t=e,{ns:i}=Un(P1),{arrowRef:s}=Un(L4),d=te(()=>{const{style:p,width:_,height:o}=t,w=i.namespace.value;return{[`--${w}-tooltip-v2-arrow-width`]:`${_}px`,[`--${w}-tooltip-v2-arrow-height`]:`${o}px`,[`--${w}-tooltip-v2-arrow-border-width`]:`${_/2}px`,[`--${w}-tooltip-v2-arrow-cover-width`]:_/2-1,...p||{}}});return(p,_)=>(le(),Pe("span",{ref_key:"arrowRef",ref:s,style:to(y(d)),class:he(y(i).e("arrow"))},null,6))}});var g3=xn(oue,[["__file","arrow.vue"]]);const zm=Math.min,Nf=Math.max,Ub=Math.round,U0=Math.floor,Eu=e=>({x:e,y:e}),rue={left:"right",right:"left",bottom:"top",top:"bottom"},iue={start:"end",end:"start"};function mS(e,t,i){return Nf(e,zm(t,i))}function Z_(e,t){return typeof e=="function"?e(t):e}function Kf(e){return e.split("-")[0]}function Y_(e){return e.split("-")[1]}function O4(e){return e==="x"?"y":"x"}function wC(e){return e==="y"?"height":"width"}function Fm(e){return["top","bottom"].includes(Kf(e))?"y":"x"}function SC(e){return O4(Fm(e))}function aue(e,t,i){i===void 0&&(i=!1);const s=Y_(e),d=SC(e),p=wC(d);let _=d==="x"?s===(i?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[p]>t.floating[p]&&(_=jb(_)),[_,jb(_)]}function sue(e){const t=jb(e);return[gS(e),t,gS(t)]}function gS(e){return e.replace(/start|end/g,t=>iue[t])}function lue(e,t,i){const s=["left","right"],d=["right","left"],p=["top","bottom"],_=["bottom","top"];switch(e){case"top":case"bottom":return i?t?d:s:t?s:d;case"left":case"right":return t?p:_;default:return[]}}function cue(e,t,i,s){const d=Y_(e);let p=lue(Kf(e),i==="start",s);return d&&(p=p.map(_=>_+"-"+d),t&&(p=p.concat(p.map(gS)))),p}function jb(e){return e.replace(/left|right|bottom|top/g,t=>rue[t])}function uue(e){return{top:0,right:0,bottom:0,left:0,...e}}function D4(e){return typeof e!="number"?uue(e):{top:e,right:e,bottom:e,left:e}}function Hb(e){const{x:t,y:i,width:s,height:d}=e;return{width:s,height:d,top:i,left:t,right:t+s,bottom:i+d,x:t,y:i}}function v3(e,t,i){let{reference:s,floating:d}=e;const p=Fm(t),_=SC(t),o=wC(_),w=Kf(t),C=p==="y",M=s.x+s.width/2-d.width/2,I=s.y+s.height/2-d.height/2,F=s[o]/2-d[o]/2;let B;switch(w){case"top":B={x:M,y:s.y-d.height};break;case"bottom":B={x:M,y:s.y+s.height};break;case"right":B={x:s.x+s.width,y:I};break;case"left":B={x:s.x-d.width,y:I};break;default:B={x:s.x,y:s.y}}switch(Y_(t)){case"start":B[_]-=F*(i&&C?-1:1);break;case"end":B[_]+=F*(i&&C?-1:1);break}return B}const due=async(e,t,i)=>{const{placement:s="bottom",strategy:d="absolute",middleware:p=[],platform:_}=i,o=p.filter(Boolean),w=await(_.isRTL==null?void 0:_.isRTL(t));let C=await _.getElementRects({reference:e,floating:t,strategy:d}),{x:M,y:I}=v3(C,s,w),F=s,B={},N=0;for(let D=0;D<o.length;D++){const{name:j,fn:U}=o[D],{x:ne,y:K,data:G,reset:J}=await U({x:M,y:I,initialPlacement:s,placement:F,strategy:d,middlewareData:B,rects:C,platform:_,elements:{reference:e,floating:t}});M=ne??M,I=K??I,B={...B,[j]:{...B[j],...G}},J&&N<=50&&(N++,typeof J=="object"&&(J.placement&&(F=J.placement),J.rects&&(C=J.rects===!0?await _.getElementRects({reference:e,floating:t,strategy:d}):J.rects),{x:M,y:I}=v3(C,F,w)),D=-1)}return{x:M,y:I,placement:F,strategy:d,middlewareData:B}};async function TC(e,t){var i;t===void 0&&(t={});const{x:s,y:d,platform:p,rects:_,elements:o,strategy:w}=e,{boundary:C="clippingAncestors",rootBoundary:M="viewport",elementContext:I="floating",altBoundary:F=!1,padding:B=0}=Z_(t,e),N=D4(B),j=o[F?I==="floating"?"reference":"floating":I],U=Hb(await p.getClippingRect({element:(i=await(p.isElement==null?void 0:p.isElement(j)))==null||i?j:j.contextElement||await(p.getDocumentElement==null?void 0:p.getDocumentElement(o.floating)),boundary:C,rootBoundary:M,strategy:w})),ne=I==="floating"?{x:s,y:d,width:_.floating.width,height:_.floating.height}:_.reference,K=await(p.getOffsetParent==null?void 0:p.getOffsetParent(o.floating)),G=await(p.isElement==null?void 0:p.isElement(K))?await(p.getScale==null?void 0:p.getScale(K))||{x:1,y:1}:{x:1,y:1},J=Hb(p.convertOffsetParentRelativeRectToViewportRelativeRect?await p.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:ne,offsetParent:K,strategy:w}):ne);return{top:(U.top-J.top+N.top)/G.y,bottom:(J.bottom-U.bottom+N.bottom)/G.y,left:(U.left-J.left+N.left)/G.x,right:(J.right-U.right+N.right)/G.x}}const hue=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:s,placement:d,rects:p,platform:_,elements:o,middlewareData:w}=t,{element:C,padding:M=0}=Z_(e,t)||{};if(C==null)return{};const I=D4(M),F={x:i,y:s},B=SC(d),N=wC(B),D=await _.getDimensions(C),j=B==="y",U=j?"top":"left",ne=j?"bottom":"right",K=j?"clientHeight":"clientWidth",G=p.reference[N]+p.reference[B]-F[B]-p.floating[N],J=F[B]-p.reference[B],oe=await(_.getOffsetParent==null?void 0:_.getOffsetParent(C));let se=oe?oe[K]:0;(!se||!await(_.isElement==null?void 0:_.isElement(oe)))&&(se=o.floating[K]||p.floating[N]);const me=G/2-J/2,de=se/2-D[N]/2-1,ce=zm(I[U],de),pe=zm(I[ne],de),ge=ce,Re=se-D[N]-pe,Je=se/2-D[N]/2+me,Me=mS(ge,Je,Re),xe=!w.arrow&&Y_(d)!=null&&Je!==Me&&p.reference[N]/2-(Je<ge?ce:pe)-D[N]/2<0,Ae=xe?Je<ge?Je-ge:Je-Re:0;return{[B]:F[B]+Ae,data:{[B]:Me,centerOffset:Je-Me-Ae,...xe&&{alignmentOffset:Ae}},reset:xe}}}),fue=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var i,s;const{placement:d,middlewareData:p,rects:_,initialPlacement:o,platform:w,elements:C}=t,{mainAxis:M=!0,crossAxis:I=!0,fallbackPlacements:F,fallbackStrategy:B="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:D=!0,...j}=Z_(e,t);if((i=p.arrow)!=null&&i.alignmentOffset)return{};const U=Kf(d),ne=Fm(o),K=Kf(o)===o,G=await(w.isRTL==null?void 0:w.isRTL(C.floating)),J=F||(K||!D?[jb(o)]:sue(o)),oe=N!=="none";!F&&oe&&J.push(...cue(o,D,N,G));const se=[o,...J],me=await TC(t,j),de=[];let ce=((s=p.flip)==null?void 0:s.overflows)||[];if(M&&de.push(me[U]),I){const Je=aue(d,_,G);de.push(me[Je[0]],me[Je[1]])}if(ce=[...ce,{placement:d,overflows:de}],!de.every(Je=>Je<=0)){var pe,ge;const Je=(((pe=p.flip)==null?void 0:pe.index)||0)+1,Me=se[Je];if(Me)return{data:{index:Je,overflows:ce},reset:{placement:Me}};let xe=(ge=ce.filter(Ae=>Ae.overflows[0]<=0).sort((Ae,Ce)=>Ae.overflows[1]-Ce.overflows[1])[0])==null?void 0:ge.placement;if(!xe)switch(B){case"bestFit":{var Re;const Ae=(Re=ce.filter(Ce=>{if(oe){const ve=Fm(Ce.placement);return ve===ne||ve==="y"}return!0}).map(Ce=>[Ce.placement,Ce.overflows.filter(ve=>ve>0).reduce((ve,Ne)=>ve+Ne,0)]).sort((Ce,ve)=>Ce[1]-ve[1])[0])==null?void 0:Re[0];Ae&&(xe=Ae);break}case"initialPlacement":xe=o;break}if(d!==xe)return{reset:{placement:xe}}}return{}}}};async function pue(e,t){const{placement:i,platform:s,elements:d}=e,p=await(s.isRTL==null?void 0:s.isRTL(d.floating)),_=Kf(i),o=Y_(i),w=Fm(i)==="y",C=["left","top"].includes(_)?-1:1,M=p&&w?-1:1,I=Z_(t,e);let{mainAxis:F,crossAxis:B,alignmentAxis:N}=typeof I=="number"?{mainAxis:I,crossAxis:0,alignmentAxis:null}:{mainAxis:I.mainAxis||0,crossAxis:I.crossAxis||0,alignmentAxis:I.alignmentAxis};return o&&typeof N=="number"&&(B=o==="end"?N*-1:N),w?{x:B*M,y:F*C}:{x:F*C,y:B*M}}const mue=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var i,s;const{x:d,y:p,placement:_,middlewareData:o}=t,w=await pue(t,e);return _===((i=o.offset)==null?void 0:i.placement)&&(s=o.arrow)!=null&&s.alignmentOffset?{}:{x:d+w.x,y:p+w.y,data:{...w,placement:_}}}}},gue=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:s,placement:d}=t,{mainAxis:p=!0,crossAxis:_=!1,limiter:o={fn:j=>{let{x:U,y:ne}=j;return{x:U,y:ne}}},...w}=Z_(e,t),C={x:i,y:s},M=await TC(t,w),I=Fm(Kf(d)),F=O4(I);let B=C[F],N=C[I];if(p){const j=F==="y"?"top":"left",U=F==="y"?"bottom":"right",ne=B+M[j],K=B-M[U];B=mS(ne,B,K)}if(_){const j=I==="y"?"top":"left",U=I==="y"?"bottom":"right",ne=N+M[j],K=N-M[U];N=mS(ne,N,K)}const D=o.fn({...t,[F]:B,[I]:N});return{...D,data:{x:D.x-i,y:D.y-s,enabled:{[F]:p,[I]:_}}}}}};function R1(){return typeof window<"u"}function Qm(e){return z4(e)?(e.nodeName||"").toLowerCase():"#document"}function Ml(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function zu(e){var t;return(t=(z4(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function z4(e){return R1()?e instanceof Node||e instanceof Ml(e).Node:!1}function Jc(e){return R1()?e instanceof Element||e instanceof Ml(e).Element:!1}function Pu(e){return R1()?e instanceof HTMLElement||e instanceof Ml(e).HTMLElement:!1}function _3(e){return!R1()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ml(e).ShadowRoot}function X_(e){const{overflow:t,overflowX:i,overflowY:s,display:d}=Qc(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+i)&&!["inline","contents"].includes(d)}function vue(e){return["table","td","th"].includes(Qm(e))}function L1(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function CC(e){const t=EC(),i=Jc(e)?Qc(e):e;return i.transform!=="none"||i.perspective!=="none"||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","perspective","filter"].some(s=>(i.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(i.contain||"").includes(s))}function _ue(e){let t=Mh(e);for(;Pu(t)&&!Bm(t);){if(CC(t))return t;if(L1(t))return null;t=Mh(t)}return null}function EC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Bm(e){return["html","body","#document"].includes(Qm(e))}function Qc(e){return Ml(e).getComputedStyle(e)}function O1(e){return Jc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Mh(e){if(Qm(e)==="html")return e;const t=e.assignedSlot||e.parentNode||_3(e)&&e.host||zu(e);return _3(t)?t.host:t}function F4(e){const t=Mh(e);return Bm(t)?e.ownerDocument?e.ownerDocument.body:e.body:Pu(t)&&X_(t)?t:F4(t)}function k_(e,t,i){var s;t===void 0&&(t=[]),i===void 0&&(i=!0);const d=F4(e),p=d===((s=e.ownerDocument)==null?void 0:s.body),_=Ml(d);if(p){const o=vS(_);return t.concat(_,_.visualViewport||[],X_(d)?d:[],o&&i?k_(o):[])}return t.concat(d,k_(d,[],i))}function vS(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function B4(e){const t=Qc(e);let i=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const d=Pu(e),p=d?e.offsetWidth:i,_=d?e.offsetHeight:s,o=Ub(i)!==p||Ub(s)!==_;return o&&(i=p,s=_),{width:i,height:s,$:o}}function MC(e){return Jc(e)?e:e.contextElement}function ym(e){const t=MC(e);if(!Pu(t))return Eu(1);const i=t.getBoundingClientRect(),{width:s,height:d,$:p}=B4(t);let _=(p?Ub(i.width):i.width)/s,o=(p?Ub(i.height):i.height)/d;return(!_||!Number.isFinite(_))&&(_=1),(!o||!Number.isFinite(o))&&(o=1),{x:_,y:o}}const yue=Eu(0);function N4(e){const t=Ml(e);return!EC()||!t.visualViewport?yue:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function bue(e,t,i){return t===void 0&&(t=!1),!i||t&&i!==Ml(e)?!1:t}function Zf(e,t,i,s){t===void 0&&(t=!1),i===void 0&&(i=!1);const d=e.getBoundingClientRect(),p=MC(e);let _=Eu(1);t&&(s?Jc(s)&&(_=ym(s)):_=ym(e));const o=bue(p,i,s)?N4(p):Eu(0);let w=(d.left+o.x)/_.x,C=(d.top+o.y)/_.y,M=d.width/_.x,I=d.height/_.y;if(p){const F=Ml(p),B=s&&Jc(s)?Ml(s):s;let N=F,D=vS(N);for(;D&&s&&B!==N;){const j=ym(D),U=D.getBoundingClientRect(),ne=Qc(D),K=U.left+(D.clientLeft+parseFloat(ne.paddingLeft))*j.x,G=U.top+(D.clientTop+parseFloat(ne.paddingTop))*j.y;w*=j.x,C*=j.y,M*=j.x,I*=j.y,w+=K,C+=G,N=Ml(D),D=vS(N)}}return Hb({width:M,height:I,x:w,y:C})}function IC(e,t){const i=O1(e).scrollLeft;return t?t.left+i:Zf(zu(e)).left+i}function $4(e,t,i){i===void 0&&(i=!1);const s=e.getBoundingClientRect(),d=s.left+t.scrollLeft-(i?0:IC(e,s)),p=s.top+t.scrollTop;return{x:d,y:p}}function xue(e){let{elements:t,rect:i,offsetParent:s,strategy:d}=e;const p=d==="fixed",_=zu(s),o=t?L1(t.floating):!1;if(s===_||o&&p)return i;let w={scrollLeft:0,scrollTop:0},C=Eu(1);const M=Eu(0),I=Pu(s);if((I||!I&&!p)&&((Qm(s)!=="body"||X_(_))&&(w=O1(s)),Pu(s))){const B=Zf(s);C=ym(s),M.x=B.x+s.clientLeft,M.y=B.y+s.clientTop}const F=_&&!I&&!p?$4(_,w,!0):Eu(0);return{width:i.width*C.x,height:i.height*C.y,x:i.x*C.x-w.scrollLeft*C.x+M.x+F.x,y:i.y*C.y-w.scrollTop*C.y+M.y+F.y}}function wue(e){return Array.from(e.getClientRects())}function Sue(e){const t=zu(e),i=O1(e),s=e.ownerDocument.body,d=Nf(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),p=Nf(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let _=-i.scrollLeft+IC(e);const o=-i.scrollTop;return Qc(s).direction==="rtl"&&(_+=Nf(t.clientWidth,s.clientWidth)-d),{width:d,height:p,x:_,y:o}}function Tue(e,t){const i=Ml(e),s=zu(e),d=i.visualViewport;let p=s.clientWidth,_=s.clientHeight,o=0,w=0;if(d){p=d.width,_=d.height;const C=EC();(!C||C&&t==="fixed")&&(o=d.offsetLeft,w=d.offsetTop)}return{width:p,height:_,x:o,y:w}}function Cue(e,t){const i=Zf(e,!0,t==="fixed"),s=i.top+e.clientTop,d=i.left+e.clientLeft,p=Pu(e)?ym(e):Eu(1),_=e.clientWidth*p.x,o=e.clientHeight*p.y,w=d*p.x,C=s*p.y;return{width:_,height:o,x:w,y:C}}function y3(e,t,i){let s;if(t==="viewport")s=Tue(e,i);else if(t==="document")s=Sue(zu(e));else if(Jc(t))s=Cue(t,i);else{const d=N4(e);s={x:t.x-d.x,y:t.y-d.y,width:t.width,height:t.height}}return Hb(s)}function V4(e,t){const i=Mh(e);return i===t||!Jc(i)||Bm(i)?!1:Qc(i).position==="fixed"||V4(i,t)}function Eue(e,t){const i=t.get(e);if(i)return i;let s=k_(e,[],!1).filter(o=>Jc(o)&&Qm(o)!=="body"),d=null;const p=Qc(e).position==="fixed";let _=p?Mh(e):e;for(;Jc(_)&&!Bm(_);){const o=Qc(_),w=CC(_);!w&&o.position==="fixed"&&(d=null),(p?!w&&!d:!w&&o.position==="static"&&!!d&&["absolute","fixed"].includes(d.position)||X_(_)&&!w&&V4(e,_))?s=s.filter(M=>M!==_):d=o,_=Mh(_)}return t.set(e,s),s}function Mue(e){let{element:t,boundary:i,rootBoundary:s,strategy:d}=e;const _=[...i==="clippingAncestors"?L1(t)?[]:Eue(t,this._c):[].concat(i),s],o=_[0],w=_.reduce((C,M)=>{const I=y3(t,M,d);return C.top=Nf(I.top,C.top),C.right=zm(I.right,C.right),C.bottom=zm(I.bottom,C.bottom),C.left=Nf(I.left,C.left),C},y3(t,o,d));return{width:w.right-w.left,height:w.bottom-w.top,x:w.left,y:w.top}}function Iue(e){const{width:t,height:i}=B4(e);return{width:t,height:i}}function Aue(e,t,i){const s=Pu(t),d=zu(t),p=i==="fixed",_=Zf(e,!0,p,t);let o={scrollLeft:0,scrollTop:0};const w=Eu(0);if(s||!s&&!p)if((Qm(t)!=="body"||X_(d))&&(o=O1(t)),s){const F=Zf(t,!0,p,t);w.x=F.x+t.clientLeft,w.y=F.y+t.clientTop}else d&&(w.x=IC(d));const C=d&&!s&&!p?$4(d,o):Eu(0),M=_.left+o.scrollLeft-w.x-C.x,I=_.top+o.scrollTop-w.y-C.y;return{x:M,y:I,width:_.width,height:_.height}}function t2(e){return Qc(e).position==="static"}function b3(e,t){if(!Pu(e)||Qc(e).position==="fixed")return null;if(t)return t(e);let i=e.offsetParent;return zu(e)===i&&(i=i.ownerDocument.body),i}function U4(e,t){const i=Ml(e);if(L1(e))return i;if(!Pu(e)){let d=Mh(e);for(;d&&!Bm(d);){if(Jc(d)&&!t2(d))return d;d=Mh(d)}return i}let s=b3(e,t);for(;s&&vue(s)&&t2(s);)s=b3(s,t);return s&&Bm(s)&&t2(s)&&!CC(s)?i:s||_ue(e)||i}const kue=async function(e){const t=this.getOffsetParent||U4,i=this.getDimensions,s=await i(e.floating);return{reference:Aue(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Pue(e){return Qc(e).direction==="rtl"}const Rue={convertOffsetParentRelativeRectToViewportRelativeRect:xue,getDocumentElement:zu,getClippingRect:Mue,getOffsetParent:U4,getElementRects:kue,getClientRects:wue,getDimensions:Iue,getScale:ym,isElement:Jc,isRTL:Pue};function Lue(e,t){let i=null,s;const d=zu(e);function p(){var o;clearTimeout(s),(o=i)==null||o.disconnect(),i=null}function _(o,w){o===void 0&&(o=!1),w===void 0&&(w=1),p();const{left:C,top:M,width:I,height:F}=e.getBoundingClientRect();if(o||t(),!I||!F)return;const B=U0(M),N=U0(d.clientWidth-(C+I)),D=U0(d.clientHeight-(M+F)),j=U0(C),ne={rootMargin:-B+"px "+-N+"px "+-D+"px "+-j+"px",threshold:Nf(0,zm(1,w))||1};let K=!0;function G(J){const oe=J[0].intersectionRatio;if(oe!==w){if(!K)return _();oe?_(!1,oe):s=setTimeout(()=>{_(!1,1e-7)},1e3)}K=!1}try{i=new IntersectionObserver(G,{...ne,root:d.ownerDocument})}catch{i=new IntersectionObserver(G,ne)}i.observe(e)}return _(!0),p}function Oue(e,t,i,s){s===void 0&&(s={});const{ancestorScroll:d=!0,ancestorResize:p=!0,elementResize:_=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:w=!1}=s,C=MC(e),M=d||p?[...C?k_(C):[],...k_(t)]:[];M.forEach(U=>{d&&U.addEventListener("scroll",i,{passive:!0}),p&&U.addEventListener("resize",i)});const I=C&&o?Lue(C,i):null;let F=-1,B=null;_&&(B=new ResizeObserver(U=>{let[ne]=U;ne&&ne.target===C&&B&&(B.unobserve(t),cancelAnimationFrame(F),F=requestAnimationFrame(()=>{var K;(K=B)==null||K.observe(t)})),i()}),C&&!w&&B.observe(C),B.observe(t));let N,D=w?Zf(e):null;w&&j();function j(){const U=Zf(e);D&&(U.x!==D.x||U.y!==D.y||U.width!==D.width||U.height!==D.height)&&i(),D=U,N=requestAnimationFrame(j)}return i(),()=>{var U;M.forEach(ne=>{d&&ne.removeEventListener("scroll",i),p&&ne.removeEventListener("resize",i)}),I==null||I(),(U=B)==null||U.disconnect(),B=null,w&&cancelAnimationFrame(N)}}const Due=TC,j4=mue,zue=gue,Fue=fue,H4=hue,G4=(e,t,i)=>{const s=new Map,d={platform:Rue,...i},p={...d.platform,_c:s};return due(e,t,{...d,platform:p})},Bue=vn({style:{type:ut([String,Object,Array]),default:()=>({})}}),Nue=Ze({name:"ElVisuallyHidden"}),$ue=Ze({...Nue,props:Bue,setup(e){const t=e,i=te(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(s,d)=>(le(),Pe("span",Yo(s.$attrs,{style:y(i)}),[_t(s.$slots,"default")],16))}});var Vue=xn($ue,[["__file","visual-hidden.vue"]]);vn({});const Uue=e=>{if(!gr)return;if(!e)return e;const t=Ds(e);return t||(vi(e)?t:e)},jue=({middleware:e,placement:t,strategy:i})=>{const s=we(),d=we(),p=we(),_=we(),o=we({}),w={x:p,y:_,placement:t,strategy:i,middlewareData:o},C=async()=>{if(!gr)return;const M=Uue(s),I=Ds(d);if(!M||!I)return;const F=await G4(M,I,{placement:y(t),strategy:y(i),middleware:y(e)});Em(w).forEach(B=>{w[B].value=F[B]})};return No(()=>{Ha(()=>{C()})}),{...w,update:C,referenceRef:s,contentRef:d}},Hue=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(i){const s=y(e);return s?H4({element:s,padding:t}).fn(i):{}}}),Gue=Ze({name:"ElTooltipV2Content"}),Wue=Ze({...Gue,props:{...yC,...P4},setup(e){const t=e,{triggerRef:i,contentId:s}=Un(P1),d=we(t.placement),p=we(t.strategy),_=we(null),{referenceRef:o,contentRef:w,middlewareData:C,x:M,y:I,update:F}=jue({placement:d,strategy:p,middleware:te(()=>{const K=[j4(t.offset)];return t.showArrow&&K.push(Hue({arrowRef:_})),K})}),B=qm().nextZIndex(),N=rn("tooltip-v2"),D=te(()=>d.value.split("-")[0]),j=te(()=>({position:y(p),top:`${y(I)||0}px`,left:`${y(M)||0}px`,zIndex:B})),U=te(()=>{if(!t.showArrow)return{};const{arrow:K}=y(C);return{[`--${N.namespace.value}-tooltip-v2-arrow-x`]:`${K==null?void 0:K.x}px`||"",[`--${N.namespace.value}-tooltip-v2-arrow-y`]:`${K==null?void 0:K.y}px`||""}}),ne=te(()=>[N.e("content"),N.is("dark",t.effect==="dark"),N.is(y(p)),t.contentClass]);return tn(_,()=>F()),tn(()=>t.placement,K=>d.value=K),No(()=>{tn(()=>t.reference||i.value,K=>{o.value=K||void 0},{immediate:!0})}),or(L4,{arrowRef:_}),(K,G)=>(le(),Pe("div",{ref_key:"contentRef",ref:w,style:to(y(j)),"data-tooltip-v2-root":""},[K.nowrap?St("v-if",!0):(le(),Pe("div",{key:0,"data-side":y(D),class:he(y(ne))},[_t(K.$slots,"default",{contentStyle:y(j),contentClass:y(ne)}),Qe(y(Vue),{id:y(s),role:"tooltip"},{default:at(()=>[K.ariaLabel?(le(),Pe(eo,{key:0},[Qo(yn(K.ariaLabel),1)],64)):_t(K.$slots,"default",{key:1})]),_:3},8,["id"]),_t(K.$slots,"arrow",{style:to(y(U)),side:y(D)})],10,["data-side"]))],4))}});var x3=xn(Wue,[["__file","content.vue"]]);const que=vn({setRef:{type:ut(Function),required:!0},onlyChild:Boolean});var Kue=Ze({props:que,setup(e,{slots:t}){const i=we(),s=E1(i,d=>{d?e.setRef(d.nextElementSibling):e.setRef(null)});return()=>{var d;const[p]=((d=t.default)==null?void 0:d.call(t))||[],_=e.onlyChild?mY(p.children):p.children;return Qe(eo,{ref:s},[_])}}});const Zue=Ze({name:"ElTooltipV2Trigger"}),Yue=Ze({...Zue,props:{...P4,...xC},setup(e){const t=e,{onClose:i,onOpen:s,onDelayOpen:d,triggerRef:p,contentId:_}=Un(P1);let o=!1;const w=ne=>{p.value=ne},C=()=>{o=!1},M=Ui(t.onMouseEnter,d),I=Ui(t.onMouseLeave,i),F=Ui(t.onMouseDown,()=>{i(),o=!0,document.addEventListener("mouseup",C,{once:!0})}),B=Ui(t.onFocus,()=>{o||s()}),N=Ui(t.onBlur,i),D=Ui(t.onClick,ne=>{ne.detail===0&&i()}),j={blur:N,click:D,focus:B,mousedown:F,mouseenter:M,mouseleave:I},U=(ne,K,G)=>{ne&&Object.entries(K).forEach(([J,oe])=>{ne[G](J,oe)})};return tn(p,(ne,K)=>{U(ne,j,"addEventListener"),U(K,j,"removeEventListener"),ne&&ne.setAttribute("aria-describedby",_.value)}),ni(()=>{U(p.value,j,"removeEventListener"),document.removeEventListener("mouseup",C)}),(ne,K)=>ne.nowrap?(le(),Rt(y(Kue),{key:0,"set-ref":w,"only-child":""},{default:at(()=>[_t(ne.$slots,"default")]),_:3})):(le(),Pe("button",Yo({key:1,ref_key:"triggerRef",ref:p},ne.$attrs),[_t(ne.$slots,"default")],16))}});var Xue=xn(Yue,[["__file","trigger.vue"]]);const Jue=Ze({name:"ElTooltipV2"}),Que=Ze({...Jue,props:Jce,setup(e){const i=Ca(e),s=Ir(Gc(i,Object.keys(_C))),d=Ir(Gc(i,Object.keys(yC))),p=Ir(Gc(i,Object.keys(bC))),_=Ir(Gc(i,Object.keys(xC)));return(o,w)=>(le(),Rt(tue,Hc(yh(p)),{default:at(({open:C})=>[Qe(Xue,Yo(_,{nowrap:""}),{default:at(()=>[_t(o.$slots,"trigger")]),_:3},16),Qe(y(Ym),{to:o.to,disabled:!o.teleported},{default:at(()=>[o.fullTransition?(le(),Rt(Ea,Hc(Yo({key:0},o.transitionProps)),{default:at(()=>[o.alwaysOn||C?(le(),Rt(x3,Hc(Yo({key:0},d)),{arrow:at(({style:M,side:I})=>[o.showArrow?(le(),Rt(g3,Yo({key:0},s,{style:M,side:I}),null,16,["style","side"])):St("v-if",!0)]),default:at(()=>[_t(o.$slots,"default")]),_:3},16)):St("v-if",!0)]),_:2},1040)):(le(),Pe(eo,{key:1},[o.alwaysOn||C?(le(),Rt(x3,Hc(Yo({key:0},d)),{arrow:at(({style:M,side:I})=>[o.showArrow?(le(),Rt(g3,Yo({key:0},s,{style:M,side:I}),null,16,["style","side"])):St("v-if",!0)]),default:at(()=>[_t(o.$slots,"default")]),_:3},16)):St("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var ede=xn(Que,[["__file","tooltip.vue"]]);const tde=Ao(ede),W4="left-check-change",q4="right-check-change",im=vn({data:{type:ut(Array),default:()=>[]},titles:{type:ut(Array),default:()=>[]},buttonTexts:{type:ut(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:ut(Function)},leftDefaultChecked:{type:ut(Array),default:()=>[]},rightDefaultChecked:{type:ut(Array),default:()=>[]},renderContent:{type:ut(Function)},modelValue:{type:ut(Array),default:()=>[]},format:{type:ut(Object),default:()=>({})},filterable:Boolean,props:{type:ut(Object),default:()=>Ri({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),_S=(e,t)=>[e,t].every(fn)||fn(e)&&ga(t),nde={[Yr]:(e,t,i)=>[e,i].every(fn)&&["left","right"].includes(t),[Fo]:e=>fn(e),[W4]:_S,[q4]:_S},yS="checked-change",ode=vn({data:im.data,optionRender:{type:ut(Function)},placeholder:String,title:String,filterable:Boolean,format:im.format,filterMethod:im.filterMethod,defaultChecked:im.leftDefaultChecked,props:im.props}),rde={[yS]:_S},J_=e=>{const t={label:"label",key:"key",disabled:"disabled"};return te(()=>({...t,...e.props}))},ide=(e,t,i)=>{const s=J_(e),d=te(()=>e.data.filter(M=>Qn(e.filterMethod)?e.filterMethod(t.query,M):String(M[s.value.label]||M[s.value.key]).toLowerCase().includes(t.query.toLowerCase()))),p=te(()=>d.value.filter(M=>!M[s.value.disabled])),_=te(()=>{const M=t.checked.length,I=e.data.length,{noChecked:F,hasChecked:B}=e.format;return F&&B?M>0?B.replace(/\${checked}/g,M.toString()).replace(/\${total}/g,I.toString()):F.replace(/\${total}/g,I.toString()):`${M}/${I}`}),o=te(()=>{const M=t.checked.length;return M>0&&M<p.value.length}),w=()=>{const M=p.value.map(I=>I[s.value.key]);t.allChecked=M.length>0&&M.every(I=>t.checked.includes(I))},C=M=>{t.checked=M?p.value.map(I=>I[s.value.key]):[]};return tn(()=>t.checked,(M,I)=>{if(w(),t.checkChangeByUser){const F=M.concat(I).filter(B=>!M.includes(B)||!I.includes(B));i(yS,M,F)}else i(yS,M),t.checkChangeByUser=!0}),tn(p,()=>{w()}),tn(()=>e.data,()=>{const M=[],I=d.value.map(F=>F[s.value.key]);t.checked.forEach(F=>{I.includes(F)&&M.push(F)}),t.checkChangeByUser=!1,t.checked=M}),tn(()=>e.defaultChecked,(M,I)=>{if(I&&M.length===I.length&&M.every(N=>I.includes(N)))return;const F=[],B=p.value.map(N=>N[s.value.key]);M.forEach(N=>{B.includes(N)&&F.push(N)}),t.checkChangeByUser=!1,t.checked=F},{immediate:!0}),{filteredData:d,checkableData:p,checkedSummary:_,isIndeterminate:o,updateAllChecked:w,handleAllCheckedChange:C}},ade=Ze({name:"ElTransferPanel"}),sde=Ze({...ade,props:ode,emits:rde,setup(e,{expose:t,emit:i}){const s=e,d=aa(),p=({option:K})=>K,{t:_}=vr(),o=rn("transfer"),w=Ir({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),C=J_(s),{filteredData:M,checkedSummary:I,isIndeterminate:F,handleAllCheckedChange:B}=ide(s,w,i),N=te(()=>!xl(w.query)&&xl(M.value)),D=te(()=>!xl(d.default()[0].children)),{checked:j,allChecked:U,query:ne}=Ca(w);return t({query:ne}),(K,G)=>(le(),Pe("div",{class:he(y(o).b("panel"))},[Ve("p",{class:he(y(o).be("panel","header"))},[Qe(y(ac),{modelValue:y(U),"onUpdate:modelValue":J=>vi(U)?U.value=J:null,indeterminate:y(F),"validate-event":!1,onChange:y(B)},{default:at(()=>[Qo(yn(K.title)+" ",1),Ve("span",null,yn(y(I)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),Ve("div",{class:he([y(o).be("panel","body"),y(o).is("with-footer",y(D))])},[K.filterable?(le(),Rt(y(fs),{key:0,modelValue:y(ne),"onUpdate:modelValue":J=>vi(ne)?ne.value=J:null,class:he(y(o).be("panel","filter")),size:"default",placeholder:K.placeholder,"prefix-icon":y(Mq),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):St("v-if",!0),zo(Qe(y(xD),{modelValue:y(j),"onUpdate:modelValue":J=>vi(j)?j.value=J:null,"validate-event":!1,class:he([y(o).is("filterable",K.filterable),y(o).be("panel","list")])},{default:at(()=>[(le(!0),Pe(eo,null,nr(y(M),J=>(le(),Rt(y(ac),{key:J[y(C).key],class:he(y(o).be("panel","item")),value:J[y(C).key],disabled:J[y(C).disabled],"validate-event":!1},{default:at(()=>{var oe;return[Qe(p,{option:(oe=K.optionRender)==null?void 0:oe.call(K,J)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[Cr,!y(N)&&!y(xl)(K.data)]]),zo(Ve("div",{class:he(y(o).be("panel","empty"))},[_t(K.$slots,"empty",{},()=>[Qo(yn(y(N)?y(_)("el.transfer.noMatch"):y(_)("el.transfer.noData")),1)])],2),[[Cr,y(N)||y(xl)(K.data)]])],2),y(D)?(le(),Pe("p",{key:0,class:he(y(o).be("panel","footer"))},[_t(K.$slots,"default")],2)):St("v-if",!0)],2))}});var w3=xn(sde,[["__file","transfer-panel.vue"]]);const lde=e=>{const t=J_(e),i=te(()=>e.data.reduce((p,_)=>(p[_[t.value.key]]=_)&&p,{})),s=te(()=>e.data.filter(p=>!e.modelValue.includes(p[t.value.key]))),d=te(()=>e.targetOrder==="original"?e.data.filter(p=>e.modelValue.includes(p[t.value.key])):e.modelValue.reduce((p,_)=>{const o=i.value[_];return o&&p.push(o),p},[]));return{sourceData:s,targetData:d}},cde=(e,t,i)=>{const s=J_(e),d=(o,w,C)=>{i(Fo,o),i(Yr,o,w,C)};return{addToLeft:()=>{const o=e.modelValue.slice();t.rightChecked.forEach(w=>{const C=o.indexOf(w);C>-1&&o.splice(C,1)}),d(o,"left",t.rightChecked)},addToRight:()=>{let o=e.modelValue.slice();const w=e.data.filter(C=>{const M=C[s.value.key];return t.leftChecked.includes(M)&&!e.modelValue.includes(M)}).map(C=>C[s.value.key]);o=e.targetOrder==="unshift"?w.concat(o):o.concat(w),e.targetOrder==="original"&&(o=e.data.filter(C=>o.includes(C[s.value.key])).map(C=>C[s.value.key])),d(o,"right",t.leftChecked)}}},ude=(e,t)=>({onSourceCheckedChange:(d,p)=>{e.leftChecked=d,p&&t(W4,d,p)},onTargetCheckedChange:(d,p)=>{e.rightChecked=d,p&&t(q4,d,p)}}),dde=Ze({name:"ElTransfer"}),hde=Ze({...dde,props:im,emits:nde,setup(e,{expose:t,emit:i}){const s=e,d=aa(),{t:p}=vr(),_=rn("transfer"),{formItem:o}=Ka(),w=Ir({leftChecked:[],rightChecked:[]}),C=J_(s),{sourceData:M,targetData:I}=lde(s),{onSourceCheckedChange:F,onTargetCheckedChange:B}=ude(w,i),{addToLeft:N,addToRight:D}=cde(s,w,i),j=we(),U=we(),ne=me=>{switch(me){case"left":j.value.query="";break;case"right":U.value.query="";break}},K=te(()=>s.buttonTexts.length===2),G=te(()=>s.titles[0]||p("el.transfer.titles.0")),J=te(()=>s.titles[1]||p("el.transfer.titles.1")),oe=te(()=>s.filterPlaceholder||p("el.transfer.filterPlaceholder"));tn(()=>s.modelValue,()=>{var me;s.validateEvent&&((me=o==null?void 0:o.validate)==null||me.call(o,"change").catch(de=>void 0))});const se=te(()=>me=>{var de;if(s.renderContent)return s.renderContent(lo,me);const ce=(((de=d.default)==null?void 0:de.call(d,{option:me}))||[]).filter(pe=>pe.type!==Sa);return ce.length?ce:lo("span",me[C.value.label]||me[C.value.key])});return t({clearQuery:ne,leftPanel:j,rightPanel:U}),(me,de)=>(le(),Pe("div",{class:he(y(_).b())},[Qe(w3,{ref_key:"leftPanel",ref:j,data:y(M),"option-render":y(se),placeholder:y(oe),title:y(G),filterable:me.filterable,format:me.format,"filter-method":me.filterMethod,"default-checked":me.leftDefaultChecked,props:s.props,onCheckedChange:y(F)},{empty:at(()=>[_t(me.$slots,"left-empty")]),default:at(()=>[_t(me.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Ve("div",{class:he(y(_).e("buttons"))},[Qe(y(Ta),{type:"primary",class:he([y(_).e("button"),y(_).is("with-texts",y(K))]),disabled:y(xl)(w.rightChecked),onClick:y(N)},{default:at(()=>[Qe(y(Gn),null,{default:at(()=>[Qe(y(Sh))]),_:1}),y(Hr)(me.buttonTexts[0])?St("v-if",!0):(le(),Pe("span",{key:0},yn(me.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),Qe(y(Ta),{type:"primary",class:he([y(_).e("button"),y(_).is("with-texts",y(K))]),disabled:y(xl)(w.leftChecked),onClick:y(D)},{default:at(()=>[y(Hr)(me.buttonTexts[1])?St("v-if",!0):(le(),Pe("span",{key:0},yn(me.buttonTexts[1]),1)),Qe(y(Gn),null,{default:at(()=>[Qe(y(zs))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),Qe(w3,{ref_key:"rightPanel",ref:U,data:y(I),"option-render":y(se),placeholder:y(oe),filterable:me.filterable,format:me.format,"filter-method":me.filterMethod,title:y(J),"default-checked":me.rightDefaultChecked,props:s.props,onCheckedChange:y(B)},{empty:at(()=>[_t(me.$slots,"right-empty")]),default:at(()=>[_t(me.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var fde=xn(hde,[["__file","transfer.vue"]]);const pde=Ao(fde),bm="$treeNodeId",S3=function(e,t){!t||t[bm]||Object.defineProperty(t,bm,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},AC=function(e,t){return e?t[e]:t[bm]},bS=(e,t,i)=>{const s=e.value.currentNode;i();const d=e.value.currentNode;s!==d&&t("current-change",d?d.data:null,d)},xS=e=>{let t=!0,i=!0,s=!0;for(let d=0,p=e.length;d<p;d++){const _=e[d];(_.checked!==!0||_.indeterminate)&&(t=!1,_.disabled||(s=!1)),(_.checked!==!1||_.indeterminate)&&(i=!1)}return{all:t,none:i,allWithoutDisable:s,half:!t&&!i}},Vv=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:i,half:s}=xS(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):s?(e.checked=!1,e.indeterminate=!0):i&&(e.checked=!1,e.indeterminate=!1);const d=e.parent;!d||d.level===0||e.store.checkStrictly||Vv(d)},j0=function(e,t){const i=e.store.props,s=e.data||{},d=i[t];if(Qn(d))return d(s,e);if(Zn(d))return s[d];if(Hr(d)){const p=s[t];return p===void 0?"":p}};let mde=0,wS=class cb{constructor(t){this.id=mde++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const i in t)Tr(t,i)&&(this[i]=t[i]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const i=t.props;if(i&&typeof i.isLeaf<"u"){const p=j0(this,"isLeaf");ai(p)&&(this.isLeafByUser=p)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),fn(this.data)||S3(this,this.data),!this.data)return;const s=t.defaultExpandedKeys,d=t.key;d&&s&&s.includes(this.key)&&this.expand(null,t.autoExpandParent),d&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){fn(t)||S3(this,t),this.data=t,this.childNodes=[];let i;this.level===0&&fn(this.data)?i=this.data:i=j0(this,"children")||[];for(let s=0,d=i.length;s<d;s++)this.insertChild({data:i[s]})}get label(){return j0(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return j0(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return t.childNodes[i+1]}return null}get previousSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return i>0?t.childNodes[i-1]:null}return null}contains(t,i=!0){return(this.childNodes||[]).some(s=>s===t||i&&s.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,i,s){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof cb)){if(!s){const d=this.getChildren(!0);d.includes(t.data)||(Hr(i)||i<0?d.push(t.data):d.splice(i,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=Ir(new cb(t)),t instanceof cb&&t.initialize()}t.level=this.level+1,Hr(i)||i<0?this.childNodes.push(t):this.childNodes.splice(i,0,t),this.updateLeafState()}insertBefore(t,i){let s;i&&(s=this.childNodes.indexOf(i)),this.insertChild(t,s)}insertAfter(t,i){let s;i&&(s=this.childNodes.indexOf(i),s!==-1&&(s+=1)),this.insertChild(t,s)}removeChild(t){const i=this.getChildren()||[],s=i.indexOf(t.data);s>-1&&i.splice(s,1);const d=this.childNodes.indexOf(t);d>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(d,1)),this.updateLeafState()}removeChildByData(t){let i=null;for(let s=0;s<this.childNodes.length;s++)if(this.childNodes[s].data===t){i=this.childNodes[s];break}i&&this.removeChild(i)}expand(t,i){const s=()=>{if(i){let d=this.parent;for(;d.level>0;)d.expanded=!0,d=d.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(d=>{d.canFocus=!0})};this.shouldLoadData()?this.loadData(d=>{fn(d)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Vv(this),s())}):s()}doCreateChildren(t,i={}){t.forEach(s=>{this.insertChild(Object.assign({data:s},i),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,i,s,d){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:_,allWithoutDisable:o}=xS(this.childNodes);!this.isLeaf&&!_&&o&&(this.checked=!1,t=!1);const w=()=>{if(i){const C=this.childNodes;for(let F=0,B=C.length;F<B;F++){const N=C[F];d=d||t!==!1;const D=N.disabled?N.checked:d;N.setChecked(D,i,!0,d)}const{half:M,all:I}=xS(C);I||(this.checked=I,this.indeterminate=M)}};if(this.shouldLoadData()){this.loadData(()=>{w(),Vv(this)},{checked:t!==!1});return}else w()}const p=this.parent;!p||p.level===0||s||Vv(p)}getChildren(t=!1){if(this.level===0)return this.data;const i=this.data;if(!i)return null;const s=this.store.props;let d="children";return s&&(d=s.children||"children"),i[d]===void 0&&(i[d]=null),t&&!i[d]&&(i[d]=[]),i[d]}updateChildren(){const t=this.getChildren()||[],i=this.childNodes.map(p=>p.data),s={},d=[];t.forEach((p,_)=>{const o=p[bm];!!o&&i.findIndex(C=>C[bm]===o)>=0?s[o]={index:_,data:p}:d.push({index:_,data:p})}),this.store.lazy||i.forEach(p=>{s[p[bm]]||this.removeChildByData(p)}),d.forEach(({index:p,data:_})=>{this.insertChild({data:_},p)}),this.updateLeafState()}loadData(t,i={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(i).length)){this.loading=!0;const s=p=>{this.childNodes=[],this.doCreateChildren(p,i),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,p)},d=()=>{this.loading=!1};this.store.load(this,s,d)}else t&&t.call(this)}eachNode(t){const i=[this];for(;i.length;){const s=i.shift();i.unshift(...s.childNodes),t(s)}}reInitChecked(){this.store.checkStrictly||Vv(this)}};class gde{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const i in t)Tr(t,i)&&(this[i]=t[i]);this.nodesMap={}}initialize(){if(this.root=new wS({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,i=>{this.root.doCreateChildren(i),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const i=this.filterNodeMethod,s=this.lazy,d=function(p){const _=p.root?p.root.childNodes:p.childNodes;if(_.forEach(o=>{o.visible=i.call(o,t,o.data,o),d(o)}),!p.visible&&_.length){let o=!0;o=!_.some(w=>w.visible),p.root?p.root.visible=o===!1:p.visible=o===!1}t&&p.visible&&!p.isLeaf&&(!s||p.loaded)&&p.expand()};d(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof wS)return t;const i=Vo(t)?AC(this.key,t):t;return this.nodesMap[i]||null}insertBefore(t,i){const s=this.getNode(i);s.parent.insertBefore({data:t},s)}insertAfter(t,i){const s=this.getNode(i);s.parent.insertAfter({data:t},s)}remove(t){const i=this.getNode(t);i&&i.parent&&(i===this.currentNode&&(this.currentNode=null),i.parent.removeChild(i))}append(t,i){const s=jf(i)?this.root:this.getNode(i);s&&s.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],i=this.nodesMap;t.forEach(s=>{const d=i[s];d&&d.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const i=this.key;!t||!t.data||(i?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(s=>{this.deregisterNode(s)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,i=!1){const s=[],d=function(p){(p.root?p.root.childNodes:p.childNodes).forEach(o=>{(o.checked||i&&o.indeterminate)&&(!t||t&&o.isLeaf)&&s.push(o.data),d(o)})};return d(this),s}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(i=>(i||{})[this.key])}getHalfCheckedNodes(){const t=[],i=function(s){(s.root?s.root.childNodes:s.childNodes).forEach(p=>{p.indeterminate&&t.push(p.data),i(p)})};return i(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],i=this.nodesMap;for(const s in i)Tr(i,s)&&t.push(i[s]);return t}updateChildren(t,i){const s=this.nodesMap[t];if(!s)return;const d=s.childNodes;for(let p=d.length-1;p>=0;p--){const _=d[p];this.remove(_.data)}for(let p=0,_=i.length;p<_;p++){const o=i[p];this.append(o,s.data)}}_setCheckedKeys(t,i=!1,s){const d=this._getAllNodes().sort((w,C)=>w.level-C.level),p=Object.create(null),_=Object.keys(s);d.forEach(w=>w.setChecked(!1,!1));const o=w=>{w.childNodes.forEach(C=>{var M;p[C.data[t]]=!0,(M=C.childNodes)!=null&&M.length&&o(C)})};for(let w=0,C=d.length;w<C;w++){const M=d[w],I=M.data[t].toString();if(!_.includes(I)){M.checked&&!p[I]&&M.setChecked(!1,!1);continue}if(M.childNodes.length&&o(M),M.isLeaf||this.checkStrictly){M.setChecked(!0,!1);continue}if(M.setChecked(!0,!0),i){M.setChecked(!1,!1);const B=function(N){N.childNodes.forEach(j=>{j.isLeaf||j.setChecked(!1,!1),B(j)})};B(M)}}}setCheckedNodes(t,i=!1){const s=this.key,d={};t.forEach(p=>{d[(p||{})[s]]=!0}),this._setCheckedKeys(s,i,d)}setCheckedKeys(t,i=!1){this.defaultCheckedKeys=t;const s=this.key,d={};t.forEach(p=>{d[p]=!0}),this._setCheckedKeys(s,i,d)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(i=>{const s=this.getNode(i);s&&s.expand(null,this.autoExpandParent)})}setChecked(t,i,s){const d=this.getNode(t);d&&d.setChecked(!!i,s)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const i=this.currentNode;i&&(i.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,i=!0){const s=t[this.key],d=this.nodesMap[s];this.setCurrentNode(d),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,i=!0){if(this.currentNodeKey=t,t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const s=this.getNode(t);s&&(this.setCurrentNode(s),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const vde=Ze({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=rn("tree"),i=Un("NodeInstance"),s=Un("RootTree");return()=>{const d=e.node,{data:p,store:_}=d;return e.renderContent?e.renderContent(lo,{_self:i,node:d,data:p,store:_}):_t(s.ctx.slots,"default",{node:d,data:p},()=>[lo("span",{class:t.be("node","label")},[d.label])])}}});var _de=xn(vde,[["__file","tree-node-content.vue"]]);function K4(e){const t=Un("TreeNodeMap",null),i={treeNodeExpand:s=>{e.node!==s&&e.node.collapse()},children:[]};return t&&t.children.push(i),or("TreeNodeMap",i),{broadcastExpanded:s=>{if(e.accordion)for(const d of i.children)d.treeNodeExpand(s)}}}const Z4=Symbol("dragEvents");function yde({props:e,ctx:t,el$:i,dropIndicator$:s,store:d}){const p=rn("tree"),_=we({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return or(Z4,{treeNodeDragStart:({event:M,treeNode:I})=>{if(Qn(e.allowDrag)&&!e.allowDrag(I.node))return M.preventDefault(),!1;M.dataTransfer.effectAllowed="move";try{M.dataTransfer.setData("text/plain","")}catch{}_.value.draggingNode=I,t.emit("node-drag-start",I.node,M)},treeNodeDragOver:({event:M,treeNode:I})=>{const F=I,B=_.value.dropNode;B&&B.node.id!==F.node.id&&ps(B.$el,p.is("drop-inner"));const N=_.value.draggingNode;if(!N||!F)return;let D=!0,j=!0,U=!0,ne=!0;Qn(e.allowDrop)&&(D=e.allowDrop(N.node,F.node,"prev"),ne=j=e.allowDrop(N.node,F.node,"inner"),U=e.allowDrop(N.node,F.node,"next")),M.dataTransfer.dropEffect=j||D||U?"move":"none",(D||j||U)&&(B==null?void 0:B.node.id)!==F.node.id&&(B&&t.emit("node-drag-leave",N.node,B.node,M),t.emit("node-drag-enter",N.node,F.node,M)),D||j||U?_.value.dropNode=F:_.value.dropNode=null,F.node.nextSibling===N.node&&(U=!1),F.node.previousSibling===N.node&&(D=!1),F.node.contains(N.node,!1)&&(j=!1),(N.node===F.node||N.node.contains(F.node))&&(D=!1,j=!1,U=!1);const K=F.$el.querySelector(`.${p.be("node","content")}`).getBoundingClientRect(),G=i.value.getBoundingClientRect();let J;const oe=D?j?.25:U?.45:1:-1,se=U?j?.75:D?.55:0:1;let me=-9999;const de=M.clientY-K.top;de<K.height*oe?J="before":de>K.height*se?J="after":j?J="inner":J="none";const ce=F.$el.querySelector(`.${p.be("node","expand-icon")}`).getBoundingClientRect(),pe=s.value;J==="before"?me=ce.top-G.top:J==="after"&&(me=ce.bottom-G.top),pe.style.top=`${me}px`,pe.style.left=`${ce.right-G.left}px`,J==="inner"?Jl(F.$el,p.is("drop-inner")):ps(F.$el,p.is("drop-inner")),_.value.showDropIndicator=J==="before"||J==="after",_.value.allowDrop=_.value.showDropIndicator||ne,_.value.dropType=J,t.emit("node-drag-over",N.node,F.node,M)},treeNodeDragEnd:M=>{const{draggingNode:I,dropType:F,dropNode:B}=_.value;if(M.preventDefault(),M.dataTransfer&&(M.dataTransfer.dropEffect="move"),I&&B){const N={data:I.node.data};F!=="none"&&I.node.remove(),F==="before"?B.node.parent.insertBefore(N,B.node):F==="after"?B.node.parent.insertAfter(N,B.node):F==="inner"&&B.node.insertChild(N),F!=="none"&&(d.value.registerNode(N),d.value.key&&I.node.eachNode(D=>{var j;(j=d.value.nodesMap[D.data[d.value.key]])==null||j.setChecked(D.checked,!d.value.checkStrictly)})),ps(B.$el,p.is("drop-inner")),t.emit("node-drag-end",I.node,B.node,F,M),F!=="none"&&t.emit("node-drop",I.node,B.node,F,M)}I&&!B&&t.emit("node-drag-end",I.node,null,F,M),_.value.showDropIndicator=!1,_.value.draggingNode=null,_.value.dropNode=null,_.value.allowDrop=!0}}),{dragState:_}}const bde=Ze({name:"ElTreeNode",components:{ElCollapseTransition:T1,ElCheckbox:ac,NodeContent:_de,ElIcon:Gn,Loading:Iu},props:{node:{type:wS,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const i=rn("tree"),{broadcastExpanded:s}=K4(e),d=Un("RootTree"),p=we(!1),_=we(!1),o=we(null),w=we(null),C=we(null),M=Un(Z4),I=jo();or("NodeInstance",I),e.node.expanded&&(p.value=!0,_.value=!0);const F=d.props.props.children||"children";tn(()=>{const de=e.node.data[F];return de&&[...de]},()=>{e.node.updateChildren()}),tn(()=>e.node.indeterminate,de=>{D(e.node.checked,de)}),tn(()=>e.node.checked,de=>{D(de,e.node.indeterminate)}),tn(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),tn(()=>e.node.expanded,de=>{oo(()=>p.value=de),de&&(_.value=!0)});const B=de=>AC(d.props.nodeKey,de.data),N=de=>{const ce=e.props.class;if(!ce)return{};let pe;if(Qn(ce)){const{data:ge}=de;pe=ce(ge,de)}else pe=ce;return Zn(pe)?{[pe]:!0}:pe},D=(de,ce)=>{(o.value!==de||w.value!==ce)&&d.ctx.emit("check-change",e.node.data,de,ce),o.value=de,w.value=ce},j=de=>{bS(d.store,d.ctx.emit,()=>{var ce;if((ce=d==null?void 0:d.props)==null?void 0:ce.nodeKey){const ge=B(e.node);d.store.value.setCurrentNodeKey(ge)}else d.store.value.setCurrentNode(e.node)}),d.currentNode.value=e.node,d.props.expandOnClickNode&&ne(),d.props.checkOnClickNode&&!e.node.disabled&&K(null,{target:{checked:!e.node.checked}}),d.ctx.emit("node-click",e.node.data,e.node,I,de)},U=de=>{d.instance.vnode.props.onNodeContextmenu&&(de.stopPropagation(),de.preventDefault()),d.ctx.emit("node-contextmenu",de,e.node.data,e.node,I)},ne=()=>{e.node.isLeaf||(p.value?(d.ctx.emit("node-collapse",e.node.data,e.node,I),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,I)}))},K=(de,ce)=>{e.node.setChecked(ce.target.checked,!d.props.checkStrictly),oo(()=>{const pe=d.store.value;d.ctx.emit("check",e.node.data,{checkedNodes:pe.getCheckedNodes(),checkedKeys:pe.getCheckedKeys(),halfCheckedNodes:pe.getHalfCheckedNodes(),halfCheckedKeys:pe.getHalfCheckedKeys()})})};return{ns:i,node$:C,tree:d,expanded:p,childNodeRendered:_,oldChecked:o,oldIndeterminate:w,getNodeKey:B,getNodeClass:N,handleSelectChange:D,handleClick:j,handleContextMenu:U,handleExpandIconClick:ne,handleCheckChange:K,handleChildNodeExpand:(de,ce,pe)=>{s(ce),d.ctx.emit("node-expand",de,ce,pe)},handleDragStart:de=>{d.props.draggable&&M.treeNodeDragStart({event:de,treeNode:e})},handleDragOver:de=>{de.preventDefault(),d.props.draggable&&M.treeNodeDragOver({event:de,treeNode:{$el:C.value,node:e.node}})},handleDrop:de=>{de.preventDefault()},handleDragEnd:de=>{d.props.draggable&&M.treeNodeDragEnd(de)},CaretRight:wO}}});function xde(e,t,i,s,d,p){const _=Go("el-icon"),o=Go("el-checkbox"),w=Go("loading"),C=Go("node-content"),M=Go("el-tree-node"),I=Go("el-collapse-transition");return zo((le(),Pe("div",{ref:"node$",class:he([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:po(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:po(e.handleDragStart,["stop"]),onDragover:po(e.handleDragOver,["stop"]),onDragend:po(e.handleDragEnd,["stop"]),onDrop:po(e.handleDrop,["stop"])},[Ve("div",{class:he(e.ns.be("node","content")),style:to({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(le(),Rt(_,{key:0,class:he([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:po(e.handleExpandIconClick,["stop"])},{default:at(()=>[(le(),Rt(Wo(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):St("v-if",!0),e.showCheckbox?(le(),Rt(o,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:po(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):St("v-if",!0),e.node.loading?(le(),Rt(_,{key:2,class:he([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:at(()=>[Qe(w)]),_:1},8,["class"])):St("v-if",!0),Qe(C,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Qe(I,null,{default:at(()=>[!e.renderAfterExpand||e.childNodeRendered?zo((le(),Pe("div",{key:0,class:he(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(le(!0),Pe(eo,null,nr(e.node.childNodes,F=>(le(),Rt(M,{key:e.getNodeKey(F),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:F,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[Cr,e.expanded]]):St("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[Cr,e.node.visible]])}var wde=xn(bde,[["render",xde],["__file","tree-node.vue"]]);function Sde({el$:e},t){const i=rn("tree"),s=gi([]),d=gi([]);No(()=>{_()}),Ru(()=>{s.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),tn(d,o=>{o.forEach(w=>{w.setAttribute("tabindex","-1")})}),qr(e,"keydown",o=>{const w=o.target;if(!w.className.includes(i.b("node")))return;const C=o.code;s.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`));const M=s.value.indexOf(w);let I;if([Ln.up,Ln.down].includes(C)){if(o.preventDefault(),C===Ln.up){I=M===-1?0:M!==0?M-1:s.value.length-1;const B=I;for(;!t.value.getNode(s.value[I].dataset.key).canFocus;){if(I--,I===B){I=-1;break}I<0&&(I=s.value.length-1)}}else{I=M===-1?0:M<s.value.length-1?M+1:0;const B=I;for(;!t.value.getNode(s.value[I].dataset.key).canFocus;){if(I++,I===B){I=-1;break}I>=s.value.length&&(I=0)}}I!==-1&&s.value[I].focus()}[Ln.left,Ln.right].includes(C)&&(o.preventDefault(),w.click());const F=w.querySelector('[type="checkbox"]');[Ln.enter,Ln.numpadEnter,Ln.space].includes(C)&&F&&(o.preventDefault(),F.click())});const _=()=>{var o;s.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`)),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const w=e.value.querySelectorAll(`.${i.is("checked")}[role=treeitem]`);if(w.length){w[0].setAttribute("tabindex","0");return}(o=s.value[0])==null||o.setAttribute("tabindex","0")}}const Tde=Ze({name:"ElTree",components:{ElTreeNode:wde},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Xr}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:i}=vr(),s=rn("tree"),d=Un(Jm,null),p=we(new gde({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));p.value.initialize();const _=we(p.value.root),o=we(null),w=we(null),C=we(null),{broadcastExpanded:M}=K4(e),{dragState:I}=yde({props:e,ctx:t,el$:w,dropIndicator$:C,store:p});Sde({el$:w},p);const F=te(()=>{const{childNodes:Ce}=_.value,ve=d?d.hasFilteredOptions!==0:!1;return(!Ce||Ce.length===0||Ce.every(({visible:Ne})=>!Ne))&&!ve});tn(()=>e.currentNodeKey,Ce=>{p.value.setCurrentNodeKey(Ce)}),tn(()=>e.defaultCheckedKeys,Ce=>{p.value.setDefaultCheckedKey(Ce)}),tn(()=>e.defaultExpandedKeys,Ce=>{p.value.setDefaultExpandedKeys(Ce)}),tn(()=>e.data,Ce=>{p.value.setData(Ce)},{deep:!0}),tn(()=>e.checkStrictly,Ce=>{p.value.checkStrictly=Ce});const B=Ce=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");p.value.filter(Ce)},N=Ce=>AC(e.nodeKey,Ce.data),D=Ce=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const ve=p.value.getNode(Ce);if(!ve)return[];const Ne=[ve.data];let We=ve.parent;for(;We&&We!==_.value;)Ne.push(We.data),We=We.parent;return Ne.reverse()},j=(Ce,ve)=>p.value.getCheckedNodes(Ce,ve),U=Ce=>p.value.getCheckedKeys(Ce),ne=()=>{const Ce=p.value.getCurrentNode();return Ce?Ce.data:null},K=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const Ce=ne();return Ce?Ce[e.nodeKey]:null},G=(Ce,ve)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");p.value.setCheckedNodes(Ce,ve)},J=(Ce,ve)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");p.value.setCheckedKeys(Ce,ve)},oe=(Ce,ve,Ne)=>{p.value.setChecked(Ce,ve,Ne)},se=()=>p.value.getHalfCheckedNodes(),me=()=>p.value.getHalfCheckedKeys(),de=(Ce,ve=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");bS(p,t.emit,()=>{M(Ce),p.value.setUserCurrentNode(Ce,ve)})},ce=(Ce,ve=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");bS(p,t.emit,()=>{M(),p.value.setCurrentNodeKey(Ce,ve)})},pe=Ce=>p.value.getNode(Ce),ge=Ce=>{p.value.remove(Ce)},Re=(Ce,ve)=>{p.value.append(Ce,ve)},Je=(Ce,ve)=>{p.value.insertBefore(Ce,ve)},Me=(Ce,ve)=>{p.value.insertAfter(Ce,ve)},xe=(Ce,ve,Ne)=>{M(ve),t.emit("node-expand",Ce,ve,Ne)},Ae=(Ce,ve)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");p.value.updateChildren(Ce,ve)};return or("RootTree",{ctx:t,props:e,store:p,root:_,currentNode:o,instance:jo()}),or(Au,void 0),{ns:s,store:p,root:_,currentNode:o,dragState:I,el$:w,dropIndicator$:C,isEmpty:F,filter:B,getNodeKey:N,getNodePath:D,getCheckedNodes:j,getCheckedKeys:U,getCurrentNode:ne,getCurrentKey:K,setCheckedNodes:G,setCheckedKeys:J,setChecked:oe,getHalfCheckedNodes:se,getHalfCheckedKeys:me,setCurrentNode:de,setCurrentKey:ce,t:i,getNode:pe,remove:ge,append:Re,insertBefore:Je,insertAfter:Me,handleNodeExpand:xe,updateKeyChildren:Ae}}});function Cde(e,t,i,s,d,p){const _=Go("el-tree-node");return le(),Pe("div",{ref:"el$",class:he([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(le(!0),Pe(eo,null,nr(e.root.childNodes,o=>(le(),Rt(_,{key:e.getNodeKey(o),node:o,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(le(),Pe("div",{key:0,class:he(e.ns.e("empty-block"))},[_t(e.$slots,"empty",{},()=>{var o;return[Ve("span",{class:he(e.ns.e("empty-text"))},yn((o=e.emptyText)!=null?o:e.t("el.tree.emptyText")),3)]})],2)):St("v-if",!0),zo(Ve("div",{ref:"dropIndicator$",class:he(e.ns.e("drop-indicator"))},null,2),[[Cr,e.dragState.showDropIndicator]])],2)}var Ede=xn(Tde,[["render",Cde],["__file","tree.vue"]]);const Gb=Ao(Ede),Mde=(e,{attrs:t,emit:i},{select:s,tree:d,key:p})=>{const _=rn("tree-select");return tn(()=>e.data,()=>{e.filterable&&oo(()=>{var w,C;(C=d.value)==null||C.filter((w=s.value)==null?void 0:w.states.inputValue)})},{flush:"post"}),{...Gc(Ca(e),Object.keys(Wf.props)),...t,"onUpdate:modelValue":w=>i(Fo,w),valueKey:p,popperClass:te(()=>{const w=[_.e("popper")];return e.popperClass&&w.push(e.popperClass),w.join(" ")}),filterMethod:(w="")=>{var C;e.filterMethod?e.filterMethod(w):e.remoteMethod?e.remoteMethod(w):(C=d.value)==null||C.filter(w)}}},Ide=Ze({extends:Lb,setup(e,t){const i=Lb.setup(e,t);delete i.selectOptionClick;const s=jo().proxy;return oo(()=>{i.select.states.cachedOptions.get(s.value)||i.select.onOptionCreate(s)}),tn(()=>t.attrs.visible,d=>{i.states.visible=d},{immediate:!0}),i},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function SS(e){return e||e===0}function kC(e){return fn(e)&&e.length}function em(e){return fn(e)?e:SS(e)?[e]:[]}function ub(e,t,i,s,d){for(let p=0;p<e.length;p++){const _=e[p];if(t(_,p,e,d))return s?s(_,p,e,d):_;{const o=i(_);if(kC(o)){const w=ub(o,t,i,s,_);if(w)return w}}}}function db(e,t,i,s){for(let d=0;d<e.length;d++){const p=e[d];t(p,d,e,s);const _=i(p);kC(_)&&db(_,t,i,p)}}const Ade=(e,{attrs:t,slots:i,emit:s},{select:d,tree:p,key:_})=>{tn(()=>e.modelValue,()=>{e.showCheckbox&&oo(()=>{const F=p.value;F&&!La(F.getCheckedKeys(),em(e.modelValue))&&F.setCheckedKeys(em(e.modelValue))})},{immediate:!0,deep:!0});const o=te(()=>({value:_.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),w=(F,B)=>{var N;const D=o.value[F];return Qn(D)?D(B,(N=p.value)==null?void 0:N.getNode(w("value",B))):B[D]},C=em(e.modelValue).map(F=>ub(e.data||[],B=>w("value",B)===F,B=>w("children",B),(B,N,D,j)=>j&&w("value",j))).filter(F=>SS(F)),M=te(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const F=[];return db(e.data.concat(e.cacheData),B=>{const N=w("value",B);F.push({value:N,currentLabel:w("label",B),isDisabled:w("disabled",B)})},B=>w("children",B)),F}),I=()=>{var F;return(F=p.value)==null?void 0:F.getCheckedKeys().filter(B=>{var N;const D=(N=p.value)==null?void 0:N.getNode(B);return!ga(D)&&xl(D.childNodes)})};return{...Gc(Ca(e),Object.keys(Gb.props)),...t,nodeKey:_,expandOnClickNode:te(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:te(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(C):C),renderContent:(F,{node:B,data:N,store:D})=>F(Ide,{value:w("value",N),label:w("label",N),disabled:w("disabled",N),visible:B.visible},e.renderContent?()=>e.renderContent(F,{node:B,data:N,store:D}):i.default?()=>i.default({node:B,data:N,store:D}):void 0),filterNodeMethod:(F,B,N)=>e.filterNodeMethod?e.filterNodeMethod(F,B,N):F?new RegExp($T(F),"i").test(w("label",B)||""):!0,onNodeClick:(F,B,N)=>{var D,j,U,ne;if((D=t.onNodeClick)==null||D.call(t,F,B,N),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||B.isLeaf)){if(!w("disabled",F)){const K=(j=d.value)==null?void 0:j.states.options.get(w("value",F));(U=d.value)==null||U.handleOptionSelect(K)}}else e.expandOnClickNode&&N.proxy.handleExpandIconClick();(ne=d.value)==null||ne.focus()}},onCheck:(F,B)=>{var N;if(!e.showCheckbox)return;const D=w("value",F),j={};db([p.value.store.root],G=>j[G.key]=G,G=>G.childNodes);const U=B.checkedKeys,ne=e.multiple?em(e.modelValue).filter(G=>!(G in j)&&!U.includes(G)):[],K=ne.concat(U);if(e.checkStrictly)s(Fo,e.multiple?K:K.includes(D)?D:void 0);else if(e.multiple){const G=I();s(Fo,ne.concat(G))}else{const G=ub([F],se=>!kC(w("children",se))&&!w("disabled",se),se=>w("children",se)),J=G?w("value",G):void 0,oe=SS(e.modelValue)&&!!ub([F],se=>w("value",se)===e.modelValue,se=>w("children",se));s(Fo,J===e.modelValue||oe?void 0:J)}oo(()=>{var G;const J=em(e.modelValue);p.value.setCheckedKeys(J),(G=t.onCheck)==null||G.call(t,F,{checkedKeys:p.value.getCheckedKeys(),checkedNodes:p.value.getCheckedNodes(),halfCheckedKeys:p.value.getHalfCheckedKeys(),halfCheckedNodes:p.value.getHalfCheckedNodes()})}),(N=d.value)==null||N.focus()},onNodeExpand:(F,B,N)=>{var D;(D=t.onNodeExpand)==null||D.call(t,F,B,N),oo(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&B.checked){const j={},U=p.value.getCheckedKeys();db([p.value.store.root],G=>j[G.key]=G,G=>G.childNodes);const ne=em(e.modelValue).filter(G=>!(G in j)&&!U.includes(G)),K=I();s(Fo,ne.concat(K))}})},cacheOptions:M}};var kde=Ze({props:{data:{type:Array,default:()=>[]}},setup(e){const t=Un(Jm);return tn(()=>e.data,()=>{var i;e.data.forEach(d=>{t.states.cachedOptions.has(d.value)||t.states.cachedOptions.set(d.value,d)});const s=((i=t.selectRef)==null?void 0:i.querySelectorAll("input"))||[];gr&&!Array.from(s).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Pde=Ze({name:"ElTreeSelect",inheritAttrs:!1,props:{...Wf.props,...Gb.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:i,expose:s}=t,d=we(),p=we(),_=te(()=>e.nodeKey||e.valueKey||"value"),o=Mde(e,t,{select:d,tree:p,key:_}),{cacheOptions:w,...C}=Ade(e,t,{select:d,tree:p,key:_}),M=Ir({});return s(M),No(()=>{Object.assign(M,{...Gc(p.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...Gc(d.value,["focus","blur","selectedLabel"])})}),()=>lo(Wf,Ir({...o,ref:I=>d.value=I}),{...i,default:()=>[lo(kde,{data:w.value}),lo(Gb,Ir({...C,ref:I=>p.value=I}))]})}});var Rde=xn(Pde,[["__file","tree-select.vue"]]);const Lde=Ao(Rde),PC=Symbol(),Ode={key:-1,level:-1,data:{}};var Uv=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e.CLASS="",e))(Uv||{}),TS=(e=>(e.ADD="add",e.DELETE="delete",e))(TS||{});const Y4={type:Number,default:26},Dde=vn({data:{type:ut(Array),default:()=>Ri([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:ut(Object),default:()=>Ri({children:"children",label:"label",disabled:"disabled",value:"id",class:""})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:ut(Array),default:()=>Ri([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:ut(Array),default:()=>Ri([])},indent:{type:Number,default:16},itemSize:Y4,icon:{type:Xr},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:ut([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:ut(Function)},perfMode:{type:Boolean,default:!0}}),zde=vn({node:{type:ut(Object),default:()=>Ri(Ode)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:Y4}),Fde=vn({node:{type:ut(Object),required:!0}}),X4="node-click",J4="node-drop",Q4="node-expand",eF="node-collapse",tF="current-change",nF="check",oF="check-change",rF="node-contextmenu",Bde={[X4]:(e,t,i)=>e&&t&&i,[J4]:(e,t,i)=>e&&t&&i,[Q4]:(e,t)=>e&&t,[eF]:(e,t)=>e&&t,[tF]:(e,t)=>e&&t,[nF]:(e,t)=>e&&t,[oF]:(e,t)=>e&&ai(t),[rF]:(e,t,i)=>e&&t&&i},Nde={click:(e,t)=>!!(e&&t),drop:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&ai(t)};function $de(e,t){const i=we(new Set),s=we(new Set),{emit:d}=jo();tn([()=>t.value,()=>e.defaultCheckedKeys],()=>oo(()=>{ne(e.defaultCheckedKeys)}),{immediate:!0});const p=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:K,maxLevel:G}=t.value,J=i.value,oe=new Set;for(let se=G-1;se>=1;--se){const me=K.get(se);me&&me.forEach(de=>{const ce=de.children;if(ce){let pe=!0,ge=!1;for(const Re of ce){const Je=Re.key;if(J.has(Je))ge=!0;else if(oe.has(Je)){pe=!1,ge=!0;break}else pe=!1}pe?J.add(de.key):ge?(oe.add(de.key),J.delete(de.key)):(J.delete(de.key),oe.delete(de.key))}})}s.value=oe},_=K=>i.value.has(K.key),o=K=>s.value.has(K.key),w=(K,G,J=!0)=>{const oe=i.value,se=(me,de)=>{oe[de?TS.ADD:TS.DELETE](me.key);const ce=me.children;!e.checkStrictly&&ce&&ce.forEach(pe=>{pe.disabled||se(pe,de)})};se(K,G),p(),J&&C(K,G)},C=(K,G)=>{const{checkedNodes:J,checkedKeys:oe}=N(),{halfCheckedNodes:se,halfCheckedKeys:me}=D();d(nF,K.data,{checkedKeys:oe,checkedNodes:J,halfCheckedKeys:me,halfCheckedNodes:se}),d(oF,K.data,G)};function M(K=!1){return N(K).checkedKeys}function I(K=!1){return N(K).checkedNodes}function F(){return D().halfCheckedKeys}function B(){return D().halfCheckedNodes}function N(K=!1){const G=[],J=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:oe}=t.value;i.value.forEach(se=>{const me=oe.get(se);me&&(!K||K&&me.isLeaf)&&(J.push(se),G.push(me.data))})}return{checkedKeys:J,checkedNodes:G}}function D(){const K=[],G=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:J}=t.value;s.value.forEach(oe=>{const se=J.get(oe);se&&(G.push(oe),K.push(se.data))})}return{halfCheckedNodes:K,halfCheckedKeys:G}}function j(K){i.value.clear(),s.value.clear(),oo(()=>{ne(K)})}function U(K,G){if(t!=null&&t.value&&e.showCheckbox){const J=t.value.treeNodeMap.get(K);J&&w(J,G,!1)}}function ne(K){if(t!=null&&t.value){const{treeNodeMap:G}=t.value;if(e.showCheckbox&&G&&K)for(const J of K){const oe=G.get(J);oe&&!_(oe)&&w(oe,!0,!1)}}}return{updateCheckedKeys:p,toggleCheckbox:w,isChecked:_,isIndeterminate:o,getCheckedKeys:M,getCheckedNodes:I,getHalfCheckedKeys:F,getHalfCheckedNodes:B,setChecked:U,setCheckedKeys:j}}function Vde(e,t){const i=we(new Set([])),s=we(new Set([])),d=te(()=>Qn(e.filterMethod));function p(o){var w;if(!d.value)return;const C=new Set,M=s.value,I=i.value,F=[],B=((w=t.value)==null?void 0:w.treeNodes)||[],N=e.filterMethod;I.clear();function D(j){j.forEach(U=>{F.push(U),N!=null&&N(o,U.data)?F.forEach(K=>{C.add(K.key)}):U.isLeaf&&I.add(U.key);const ne=U.children;if(ne&&D(ne),!U.isLeaf){if(!C.has(U.key))I.add(U.key);else if(ne){let K=!0;for(const G of ne)if(!I.has(G.key)){K=!1;break}K?M.add(U.key):M.delete(U.key)}}F.pop()})}return D(B),C}function _(o){return s.value.has(o.key)}return{hiddenExpandIconKeySet:s,hiddenNodeKeySet:i,doFilter:p,isForceHiddenExpandIcon:_}}function Ude(e,t){const i=we(new Set(e.defaultExpandedKeys)),s=we(),d=gi(),p=we();tn(()=>e.currentNodeKey,At=>{s.value=At},{immediate:!0}),tn(()=>e.data,At=>{Kt(At)},{immediate:!0});const{isIndeterminate:_,isChecked:o,toggleCheckbox:w,getCheckedKeys:C,getCheckedNodes:M,getHalfCheckedKeys:I,getHalfCheckedNodes:F,setChecked:B,setCheckedKeys:N}=$de(e,d),{doFilter:D,hiddenNodeKeySet:j,isForceHiddenExpandIcon:U}=Vde(e,d),ne=te(()=>{var At;return((At=e.props)==null?void 0:At.value)||Uv.KEY}),K=te(()=>{var At;return((At=e.props)==null?void 0:At.children)||Uv.CHILDREN}),G=te(()=>{var At;return((At=e.props)==null?void 0:At.disabled)||Uv.DISABLED}),J=te(()=>{var At;return((At=e.props)==null?void 0:At.label)||Uv.LABEL}),oe=te(()=>{var At;const Ke=i.value,Be=j.value,Ht=[],Ut=((At=d.value)==null?void 0:At.treeNodes)||[],Nt=[];for(let Et=Ut.length-1;Et>=0;--Et)Nt.push(Ut[Et]);for(;Nt.length;){const Et=Nt.pop();if(!Be.has(Et.key)&&(Ht.push(Et),Et.children&&Ke.has(Et.key)))for(let Gt=Et.children.length-1;Gt>=0;--Gt)Nt.push(Et.children[Gt])}return Ht}),se=te(()=>oe.value.length>0);function me(At){const Ke=new Map,Be=new Map;let Ht=1;function Ut(Et,Gt=1,ln=void 0){var bn;const _n=[];for(const jn of Et){const yt=pe(jn),kn={level:Gt,key:yt,data:jn};kn.label=Re(jn),kn.parent=ln;const qn=ce(jn);kn.disabled=ge(jn),kn.isLeaf=!qn||qn.length===0,qn&&qn.length&&(kn.children=Ut(qn,Gt+1,kn)),_n.push(kn),Ke.set(yt,kn),Be.has(Gt)||Be.set(Gt,[]),(bn=Be.get(Gt))==null||bn.push(kn)}return Gt>Ht&&(Ht=Gt),_n}const Nt=Ut(At);return{treeNodeMap:Ke,levelTreeNodeMap:Be,maxLevel:Ht,treeNodes:Nt}}function de(At){const Ke=D(At);Ke&&(i.value=Ke)}function ce(At){return At[K.value]}function pe(At){return At?At[ne.value]:""}function ge(At){return At[G.value]}function Re(At){return At[J.value]}function Je(At){i.value.has(At.key)?We(At):Ne(At)}function Me(At){const Ke=new Set,Be=d.value.treeNodeMap;At.forEach(Ht=>{let Ut=Be.get(Ht);for(;Ut&&!Ke.has(Ut.key);)Ke.add(Ut.key),Ut=Ut.parent}),i.value=Ke}function xe(At,Ke){t(X4,At.data,At,Ke),Ce(At),e.expandOnClickNode&&Je(At),e.showCheckbox&&e.checkOnClickNode&&!At.disabled&&w(At,!o(At),!0)}function Ae(At,Ke){t(J4,At.data,At,Ke)}function Ce(At){Ct(At)||(s.value=At.key,t(tF,At.data,At))}function ve(At,Ke){w(At,Ke)}function Ne(At){const Ke=i.value;if(d.value&&e.accordion){const{treeNodeMap:Be}=d.value;Ke.forEach(Ht=>{const Ut=Be.get(Ht);At&&At.level===(Ut==null?void 0:Ut.level)&&Ke.delete(Ht)})}Ke.add(At.key),t(Q4,At.data,At)}function We(At){i.value.delete(At.key),t(eF,At.data,At)}function ot(At){return i.value.has(At.key)}function Oe(At){return!!At.disabled}function Ct(At){const Ke=s.value;return Ke!==void 0&&Ke===At.key}function Mt(){var At,Ke;if(s.value)return(Ke=(At=d.value)==null?void 0:At.treeNodeMap.get(s.value))==null?void 0:Ke.data}function zt(){return s.value}function bt(At){s.value=At}function Kt(At){oo(()=>d.value=me(At))}function $t(At){var Ke;const Be=Vo(At)?pe(At):At;return(Ke=d.value)==null?void 0:Ke.treeNodeMap.get(Be)}function Le(At,Ke="auto"){const Be=$t(At);Be&&p.value&&p.value.scrollToItem(oe.value.indexOf(Be),Ke)}function dn(At){var Ke;(Ke=p.value)==null||Ke.scrollTo(At)}return{tree:d,flattenTree:oe,isNotEmpty:se,listRef:p,getKey:pe,getChildren:ce,toggleExpand:Je,toggleCheckbox:w,isExpanded:ot,isChecked:o,isIndeterminate:_,isDisabled:Oe,isCurrent:Ct,isForceHiddenExpandIcon:U,handleNodeClick:xe,handleNodeDrop:Ae,handleNodeCheck:ve,getCurrentNode:Mt,getCurrentKey:zt,setCurrentKey:bt,getCheckedKeys:C,getCheckedNodes:M,getHalfCheckedKeys:I,getHalfCheckedNodes:F,setChecked:B,setCheckedKeys:N,filter:de,setData:Kt,getNode:$t,expandNode:Ne,collapseNode:We,setExpandedKeys:Me,scrollToNode:Le,scrollTo:dn}}var jde=Ze({name:"ElTreeNodeContent",props:Fde,setup(e){const t=Un(PC),i=rn("tree");return()=>{const s=e.node,{data:d}=s;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:s,data:d}):lo("span",{class:i.be("node","label")},[s==null?void 0:s.label])}}});const Hde=Ze({name:"ElTreeNode"}),Gde=Ze({...Hde,props:zde,emits:Nde,setup(e,{emit:t}){const i=e,s=Un(PC),d=rn("tree"),p=te(()=>{var B;return(B=s==null?void 0:s.props.indent)!=null?B:16}),_=te(()=>{var B;return(B=s==null?void 0:s.props.icon)!=null?B:wO}),o=B=>{const N=s==null?void 0:s.props.props.class;if(!N)return{};let D;if(Qn(N)){const{data:j}=B;D=N(j,B)}else D=N;return Zn(D)?{[D]:!0}:D},w=B=>{t("click",i.node,B)},C=B=>{t("drop",i.node,B)},M=()=>{t("toggle",i.node)},I=B=>{t("check",i.node,B)},F=B=>{var N,D,j,U;(j=(D=(N=s==null?void 0:s.instance)==null?void 0:N.vnode)==null?void 0:D.props)!=null&&j.onNodeContextmenu&&(B.stopPropagation(),B.preventDefault()),s==null||s.ctx.emit(rF,B,(U=i.node)==null?void 0:U.data,i.node)};return(B,N)=>{var D,j,U;return le(),Pe("div",{ref:"node$",class:he([y(d).b("node"),y(d).is("expanded",B.expanded),y(d).is("current",B.current),y(d).is("focusable",!B.disabled),y(d).is("checked",!B.disabled&&B.checked),o(B.node)]),role:"treeitem",tabindex:"-1","aria-expanded":B.expanded,"aria-disabled":B.disabled,"aria-checked":B.checked,"data-key":(D=B.node)==null?void 0:D.key,onClick:po(w,["stop"]),onContextmenu:F,onDragover:po(()=>{},["prevent"]),onDragenter:po(()=>{},["prevent"]),onDrop:po(C,["stop"])},[Ve("div",{class:he(y(d).be("node","content")),style:to({paddingLeft:`${(B.node.level-1)*y(p)}px`,height:B.itemSize+"px"})},[y(_)?(le(),Rt(y(Gn),{key:0,class:he([y(d).is("leaf",!!((j=B.node)!=null&&j.isLeaf)),y(d).is("hidden",B.hiddenExpandIcon),{expanded:!((U=B.node)!=null&&U.isLeaf)&&B.expanded},y(d).be("node","expand-icon")]),onClick:po(M,["stop"])},{default:at(()=>[(le(),Rt(Wo(y(_))))]),_:1},8,["class","onClick"])):St("v-if",!0),B.showCheckbox?(le(),Rt(y(ac),{key:1,"model-value":B.checked,indeterminate:B.indeterminate,disabled:B.disabled,onChange:I,onClick:po(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):St("v-if",!0),Qe(y(jde),{node:B.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var Wde=xn(Gde,[["__file","tree-node.vue"]]);const qde=Ze({name:"ElTreeV2"}),Kde=Ze({...qde,props:Dde,emits:Bde,setup(e,{expose:t,emit:i}){const s=e,d=aa(),p=te(()=>s.itemSize);or(PC,{ctx:{emit:i,slots:d},props:s,instance:jo()}),or(Au,void 0);const{t:_}=vr(),o=rn("tree"),{flattenTree:w,isNotEmpty:C,listRef:M,toggleExpand:I,isExpanded:F,isIndeterminate:B,isChecked:N,isDisabled:D,isCurrent:j,isForceHiddenExpandIcon:U,handleNodeClick:ne,handleNodeDrop:K,handleNodeCheck:G,toggleCheckbox:J,getCurrentNode:oe,getCurrentKey:se,setCurrentKey:me,getCheckedKeys:de,getCheckedNodes:ce,getHalfCheckedKeys:pe,getHalfCheckedNodes:ge,setChecked:Re,setCheckedKeys:Je,filter:Me,setData:xe,getNode:Ae,expandNode:Ce,collapseNode:ve,setExpandedKeys:Ne,scrollToNode:We,scrollTo:ot}=Ude(s,i);return t({toggleCheckbox:J,getCurrentNode:oe,getCurrentKey:se,setCurrentKey:me,getCheckedKeys:de,getCheckedNodes:ce,getHalfCheckedKeys:pe,getHalfCheckedNodes:ge,setChecked:Re,setCheckedKeys:Je,filter:Me,setData:xe,getNode:Ae,expandNode:Ce,collapseNode:ve,setExpandedKeys:Ne,scrollToNode:We,scrollTo:ot}),(Oe,Ct)=>(le(),Pe("div",{class:he([y(o).b(),{[y(o).m("highlight-current")]:Oe.highlightCurrent}]),role:"tree"},[y(C)?(le(),Rt(y(Vz),{key:0,ref_key:"listRef",ref:M,"class-name":y(o).b("virtual-list"),data:y(w),total:y(w).length,height:Oe.height,"item-size":y(p),"perf-mode":Oe.perfMode},{default:at(({data:Mt,index:zt,style:bt})=>[(le(),Rt(Wde,{key:Mt[zt].key,style:to(bt),node:Mt[zt],expanded:y(F)(Mt[zt]),"show-checkbox":Oe.showCheckbox,checked:y(N)(Mt[zt]),indeterminate:y(B)(Mt[zt]),"item-size":y(p),disabled:y(D)(Mt[zt]),current:y(j)(Mt[zt]),"hidden-expand-icon":y(U)(Mt[zt]),onClick:y(ne),onToggle:y(I),onCheck:y(G),onDrop:y(K)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(le(),Pe("div",{key:1,class:he(y(o).e("empty-block"))},[_t(Oe.$slots,"empty",{},()=>{var Mt;return[Ve("span",{class:he(y(o).e("empty-text"))},yn((Mt=Oe.emptyText)!=null?Mt:y(_)("el.tree.emptyText")),3)]})],2))],2))}});var Zde=xn(Kde,[["__file","tree.vue"]]);const Yde=Ao(Zde),iF=Symbol("uploadContextKey"),Xde="ElUpload";class Jde extends Error{constructor(t,i,s,d){super(t),this.name="UploadAjaxError",this.status=i,this.method=s,this.url=d}}function T3(e,t,i){let s;return i.response?s=`${i.response.error||i.response}`:i.responseText?s=`${i.responseText}`:s=`fail to ${t.method} ${e} ${i.status}`,new Jde(s,i.status,t.method,e)}function Qde(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const ehe=e=>{typeof XMLHttpRequest>"u"&&ha(Xde,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,i=e.action;t.upload&&t.upload.addEventListener("progress",p=>{const _=p;_.percent=p.total>0?p.loaded/p.total*100:0,e.onProgress(_)});const s=new FormData;if(e.data)for(const[p,_]of Object.entries(e.data))fn(_)&&_.length?s.append(p,..._):s.append(p,_);s.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(T3(i,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(T3(i,e,t));e.onSuccess(Qde(t))}),t.open(e.method,i,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const d=e.headers||{};if(d instanceof Headers)d.forEach((p,_)=>t.setRequestHeader(_,p));else for(const[p,_]of Object.entries(d))ga(_)||t.setRequestHeader(p,String(_));return t.send(s),t},aF=["text","picture","picture-card"];let the=1;const CS=()=>Date.now()+the++,sF=vn({action:{type:String,default:"#"},headers:{type:ut(Object)},method:{type:String,default:"post"},data:{type:ut([Object,Function,Promise]),default:()=>Ri({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:ut(Array),default:()=>Ri([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:aF,default:"text"},httpRequest:{type:ut(Function),default:ehe},disabled:Boolean,limit:Number}),nhe=vn({...sF,beforeUpload:{type:ut(Function),default:jr},beforeRemove:{type:ut(Function)},onRemove:{type:ut(Function),default:jr},onChange:{type:ut(Function),default:jr},onPreview:{type:ut(Function),default:jr},onSuccess:{type:ut(Function),default:jr},onProgress:{type:ut(Function),default:jr},onError:{type:ut(Function),default:jr},onExceed:{type:ut(Function),default:jr},crossorigin:{type:ut(String)}}),ohe=vn({files:{type:ut(Array),default:()=>Ri([])},disabled:{type:Boolean,default:!1},handlePreview:{type:ut(Function),default:jr},listType:{type:String,values:aF,default:"text"},crossorigin:{type:ut(String)}}),rhe={remove:e=>!!e},ihe=Ze({name:"ElUploadList"}),ahe=Ze({...ihe,props:ohe,emits:rhe,setup(e,{emit:t}){const i=e,{t:s}=vr(),d=rn("upload"),p=rn("icon"),_=rn("list"),o=Za(),w=we(!1),C=te(()=>[d.b("list"),d.bm("list",i.listType),d.is("disabled",i.disabled)]),M=I=>{t("remove",I)};return(I,F)=>(le(),Rt(tL,{tag:"ul",class:he(y(C)),name:y(_).b()},{default:at(()=>[(le(!0),Pe(eo,null,nr(I.files,(B,N)=>(le(),Pe("li",{key:B.uid||B.name,class:he([y(d).be("list","item"),y(d).is(B.status),{focusing:w.value}]),tabindex:"0",onKeydown:ti(D=>!y(o)&&M(B),["delete"]),onFocus:D=>w.value=!0,onBlur:D=>w.value=!1,onClick:D=>w.value=!1},[_t(I.$slots,"default",{file:B,index:N},()=>[I.listType==="picture"||B.status!=="uploading"&&I.listType==="picture-card"?(le(),Pe("img",{key:0,class:he(y(d).be("list","item-thumbnail")),src:B.url,crossorigin:I.crossorigin,alt:""},null,10,["src","crossorigin"])):St("v-if",!0),B.status==="uploading"||I.listType!=="picture-card"?(le(),Pe("div",{key:1,class:he(y(d).be("list","item-info"))},[Ve("a",{class:he(y(d).be("list","item-name")),onClick:po(D=>I.handlePreview(B),["prevent"])},[Qe(y(Gn),{class:he(y(p).m("document"))},{default:at(()=>[Qe(y(oq))]),_:1},8,["class"]),Ve("span",{class:he(y(d).be("list","item-file-name")),title:B.name},yn(B.name),11,["title"])],10,["onClick"]),B.status==="uploading"?(le(),Rt(y(Pz),{key:0,type:I.listType==="picture-card"?"circle":"line","stroke-width":I.listType==="picture-card"?6:2,percentage:Number(B.percentage),style:to(I.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):St("v-if",!0)],2)):St("v-if",!0),Ve("label",{class:he(y(d).be("list","item-status-label"))},[I.listType==="text"?(le(),Rt(y(Gn),{key:0,class:he([y(p).m("upload-success"),y(p).m("circle-check")])},{default:at(()=>[Qe(y(_T))]),_:1},8,["class"])):["picture-card","picture"].includes(I.listType)?(le(),Rt(y(Gn),{key:1,class:he([y(p).m("upload-success"),y(p).m("check")])},{default:at(()=>[Qe(y(U_))]),_:1},8,["class"])):St("v-if",!0)],2),y(o)?St("v-if",!0):(le(),Rt(y(Gn),{key:2,class:he(y(p).m("close")),onClick:D=>M(B)},{default:at(()=>[Qe(y(Xc))]),_:2},1032,["class","onClick"])),St(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),St(" This is a bug which needs to be fixed "),St(" TODO: Fix the incorrect navigation interaction "),y(o)?St("v-if",!0):(le(),Pe("i",{key:3,class:he(y(p).m("close-tip"))},yn(y(s)("el.upload.deleteTip")),3)),I.listType==="picture-card"?(le(),Pe("span",{key:4,class:he(y(d).be("list","item-actions"))},[Ve("span",{class:he(y(d).be("list","item-preview")),onClick:D=>I.handlePreview(B)},[Qe(y(Gn),{class:he(y(p).m("zoom-in"))},{default:at(()=>[Qe(y(EO))]),_:1},8,["class"])],10,["onClick"]),y(o)?St("v-if",!0):(le(),Pe("span",{key:0,class:he(y(d).be("list","item-delete")),onClick:D=>M(B)},[Qe(y(Gn),{class:he(y(p).m("delete"))},{default:at(()=>[Qe(y(tq))]),_:1},8,["class"])],10,["onClick"]))],2)):St("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),_t(I.$slots,"append")]),_:3},8,["class","name"]))}});var C3=xn(ahe,[["__file","upload-list.vue"]]);const she=vn({disabled:{type:Boolean,default:!1}}),lhe={file:e=>fn(e)},lF="ElUploadDrag",che=Ze({name:lF}),uhe=Ze({...che,props:she,emits:lhe,setup(e,{emit:t}){Un(iF)||ha(lF,"usage: <el-upload><el-upload-dragger /></el-upload>");const s=rn("upload"),d=we(!1),p=Za(),_=w=>{if(p.value)return;d.value=!1,w.stopPropagation();const C=Array.from(w.dataTransfer.files);t("file",C)},o=()=>{p.value||(d.value=!0)};return(w,C)=>(le(),Pe("div",{class:he([y(s).b("dragger"),y(s).is("dragover",d.value)]),onDrop:po(_,["prevent"]),onDragover:po(o,["prevent"]),onDragleave:po(M=>d.value=!1,["prevent"])},[_t(w.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var dhe=xn(uhe,[["__file","upload-dragger.vue"]]);const hhe=vn({...sF,beforeUpload:{type:ut(Function),default:jr},onRemove:{type:ut(Function),default:jr},onStart:{type:ut(Function),default:jr},onSuccess:{type:ut(Function),default:jr},onProgress:{type:ut(Function),default:jr},onError:{type:ut(Function),default:jr},onExceed:{type:ut(Function),default:jr}}),fhe=Ze({name:"ElUploadContent",inheritAttrs:!1}),phe=Ze({...fhe,props:hhe,setup(e,{expose:t}){const i=e,s=rn("upload"),d=Za(),p=gi({}),_=gi(),o=D=>{if(D.length===0)return;const{autoUpload:j,limit:U,fileList:ne,multiple:K,onStart:G,onExceed:J}=i;if(U&&ne.length+D.length>U){J(D,ne);return}K||(D=D.slice(0,1));for(const oe of D){const se=oe;se.uid=CS(),G(se),j&&w(se)}},w=async D=>{if(_.value.value="",!i.beforeUpload)return M(D);let j,U={};try{const K=i.data,G=i.beforeUpload(D);U=r_(i.data)?Mb(i.data):i.data,j=await G,r_(i.data)&&La(K,U)&&(U=Mb(i.data))}catch{j=!1}if(j===!1){i.onRemove(D);return}let ne=D;j instanceof Blob&&(j instanceof File?ne=j:ne=new File([j],D.name,{type:D.type})),M(Object.assign(ne,{uid:D.uid}),U)},C=async(D,j)=>Qn(D)?D(j):D,M=async(D,j)=>{const{headers:U,data:ne,method:K,withCredentials:G,name:J,action:oe,onProgress:se,onSuccess:me,onError:de,httpRequest:ce}=i;try{j=await C(j??ne,D)}catch{i.onRemove(D);return}const{uid:pe}=D,ge={headers:U||{},withCredentials:G,file:D,data:j,method:K,filename:J,action:oe,onProgress:Je=>{se(Je,D)},onSuccess:Je=>{me(Je,D),delete p.value[pe]},onError:Je=>{de(Je,D),delete p.value[pe]}},Re=ce(ge);p.value[pe]=Re,Re instanceof Promise&&Re.then(ge.onSuccess,ge.onError)},I=D=>{const j=D.target.files;j&&o(Array.from(j))},F=()=>{d.value||(_.value.value="",_.value.click())},B=()=>{F()};return t({abort:D=>{gO(p.value).filter(D?([U])=>String(D.uid)===U:()=>!0).forEach(([U,ne])=>{ne instanceof XMLHttpRequest&&ne.abort(),delete p.value[U]})},upload:w}),(D,j)=>(le(),Pe("div",{class:he([y(s).b(),y(s).m(D.listType),y(s).is("drag",D.drag),y(s).is("disabled",y(d))]),tabindex:y(d)?"-1":"0",onClick:F,onKeydown:ti(po(B,["self"]),["enter","space"])},[D.drag?(le(),Rt(dhe,{key:0,disabled:y(d),onFile:o},{default:at(()=>[_t(D.$slots,"default")]),_:3},8,["disabled"])):_t(D.$slots,"default",{key:1}),Ve("input",{ref_key:"inputRef",ref:_,class:he(y(s).e("input")),name:D.name,disabled:y(d),multiple:D.multiple,accept:D.accept,type:"file",onChange:I,onClick:po(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var E3=xn(phe,[["__file","upload-content.vue"]]);const M3="ElUpload",I3=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},mhe=(e,t)=>{const i=lO(e,"fileList",void 0,{passive:!0}),s=B=>i.value.find(N=>N.uid===B.uid);function d(B){var N;(N=t.value)==null||N.abort(B)}function p(B=["ready","uploading","success","fail"]){i.value=i.value.filter(N=>!B.includes(N.status))}function _(B){i.value=i.value.filter(N=>N!==B)}const o=(B,N)=>{const D=s(N);D&&(console.error(B),D.status="fail",_(D),e.onError(B,D,i.value),e.onChange(D,i.value))},w=(B,N)=>{const D=s(N);D&&(e.onProgress(B,D,i.value),D.status="uploading",D.percentage=Math.round(B.percent))},C=(B,N)=>{const D=s(N);D&&(D.status="success",D.response=B,e.onSuccess(B,D,i.value),e.onChange(D,i.value))},M=B=>{ga(B.uid)&&(B.uid=CS());const N={name:B.name,percentage:0,status:"ready",size:B.size,raw:B,uid:B.uid};if(e.listType==="picture-card"||e.listType==="picture")try{N.url=URL.createObjectURL(B)}catch(D){D.message,e.onError(D,N,i.value)}i.value=[...i.value,N],e.onChange(N,i.value)},I=async B=>{const N=B instanceof File?s(B):B;N||ha(M3,"file to be removed not found");const D=j=>{d(j),_(j),e.onRemove(j,i.value),I3(j)};e.beforeRemove?await e.beforeRemove(N,i.value)!==!1&&D(N):D(N)};function F(){i.value.filter(({status:B})=>B==="ready").forEach(({raw:B})=>{var N;return B&&((N=t.value)==null?void 0:N.upload(B))})}return tn(()=>e.listType,B=>{B!=="picture-card"&&B!=="picture"||(i.value=i.value.map(N=>{const{raw:D,url:j}=N;if(!j&&D)try{N.url=URL.createObjectURL(D)}catch(U){e.onError(U,N,i.value)}return N}))}),tn(i,B=>{for(const N of B)N.uid||(N.uid=CS()),N.status||(N.status="success")},{immediate:!0,deep:!0}),{uploadFiles:i,abort:d,clearFiles:p,handleError:o,handleProgress:w,handleStart:M,handleSuccess:C,handleRemove:I,submit:F,revokeFileObjectURL:I3}},ghe=Ze({name:"ElUpload"}),vhe=Ze({...ghe,props:nhe,setup(e,{expose:t}){const i=e,s=Za(),d=gi(),{abort:p,submit:_,clearFiles:o,uploadFiles:w,handleStart:C,handleError:M,handleRemove:I,handleSuccess:F,handleProgress:B,revokeFileObjectURL:N}=mhe(i,d),D=te(()=>i.listType==="picture-card"),j=te(()=>({...i,fileList:w.value,onStart:C,onProgress:B,onSuccess:F,onError:M,onRemove:I}));return ni(()=>{w.value.forEach(N)}),or(iF,{accept:Vr(i,"accept")}),t({abort:p,submit:_,clearFiles:o,handleStart:C,handleRemove:I}),(U,ne)=>(le(),Pe("div",null,[y(D)&&U.showFileList?(le(),Rt(C3,{key:0,disabled:y(s),"list-type":U.listType,files:y(w),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(I)},nc({append:at(()=>[Qe(E3,Yo({ref_key:"uploadRef",ref:d},y(j)),{default:at(()=>[U.$slots.trigger?_t(U.$slots,"trigger",{key:0}):St("v-if",!0),!U.$slots.trigger&&U.$slots.default?_t(U.$slots,"default",{key:1}):St("v-if",!0)]),_:3},16)]),_:2},[U.$slots.file?{name:"default",fn:at(({file:K,index:G})=>[_t(U.$slots,"file",{file:K,index:G})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):St("v-if",!0),!y(D)||y(D)&&!U.showFileList?(le(),Rt(E3,Yo({key:1,ref_key:"uploadRef",ref:d},y(j)),{default:at(()=>[U.$slots.trigger?_t(U.$slots,"trigger",{key:0}):St("v-if",!0),!U.$slots.trigger&&U.$slots.default?_t(U.$slots,"default",{key:1}):St("v-if",!0)]),_:3},16)):St("v-if",!0),U.$slots.trigger?_t(U.$slots,"default",{key:2}):St("v-if",!0),_t(U.$slots,"tip"),!y(D)&&U.showFileList?(le(),Rt(C3,{key:3,disabled:y(s),"list-type":U.listType,files:y(w),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:y(I)},nc({_:2},[U.$slots.file?{name:"default",fn:at(({file:K,index:G})=>[_t(U.$slots,"file",{file:K,index:G})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):St("v-if",!0)]))}});var _he=xn(vhe,[["__file","upload.vue"]]);const yhe=Ao(_he),bhe=vn({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:ut([String,Array]),default:"Element Plus"},font:{type:ut(Object)},gap:{type:ut(Array),default:()=>[100,100]},offset:{type:ut(Array)}});function xhe(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function whe(e){return Object.keys(e).map(t=>`${xhe(t)}: ${e[t]};`).join(" ")}function She(){return window.devicePixelRatio||1}const The=(e,t)=>{let i=!1;return e.removedNodes.length&&t&&(i=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(i=!0),i},cF=3;function n2(e,t,i=1){const s=document.createElement("canvas"),d=s.getContext("2d"),p=e*i,_=t*i;return s.setAttribute("width",`${p}px`),s.setAttribute("height",`${_}px`),d.save(),[d,s,p,_]}function Che(){function e(t,i,s,d,p,_,o,w){const[C,M,I,F]=n2(d,p,s);if(t instanceof HTMLImageElement)C.drawImage(t,0,0,I,F);else{const{color:We,fontSize:ot,fontStyle:Oe,fontWeight:Ct,fontFamily:Mt,textAlign:zt,textBaseline:bt}=_,Kt=Number(ot)*s;C.font=`${Oe} normal ${Ct} ${Kt}px/${p}px ${Mt}`,C.fillStyle=We,C.textAlign=zt,C.textBaseline=bt;const $t=fn(t)?t:[t];$t==null||$t.forEach((Le,dn)=>{C.fillText(Le??"",I/2,dn*(Kt+cF*s))})}const B=Math.PI/180*Number(i),N=Math.max(d,p),[D,j,U]=n2(N,N,s);D.translate(U/2,U/2),D.rotate(B),I>0&&F>0&&D.drawImage(M,-I/2,-F/2);function ne(We,ot){const Oe=We*Math.cos(B)-ot*Math.sin(B),Ct=We*Math.sin(B)+ot*Math.cos(B);return[Oe,Ct]}let K=0,G=0,J=0,oe=0;const se=I/2,me=F/2;[[0-se,0-me],[0+se,0-me],[0+se,0+me],[0-se,0+me]].forEach(([We,ot])=>{const[Oe,Ct]=ne(We,ot);K=Math.min(K,Oe),G=Math.max(G,Oe),J=Math.min(J,Ct),oe=Math.max(oe,Ct)});const ce=K+U/2,pe=J+U/2,ge=G-K,Re=oe-J,Je=o*s,Me=w*s,xe=(ge+Je)*2,Ae=Re+Me,[Ce,ve]=n2(xe,Ae);function Ne(We=0,ot=0){Ce.drawImage(j,ce,pe,ge,Re,We,ot,ge,Re)}return Ne(),Ne(ge+Je,-Re/2-Me/2),Ne(ge+Je,+Re/2+Me/2),[ve.toDataURL(),xe/s,Ae/s]}return e}const Ehe=Ze({name:"ElWatermark"}),Mhe=Ze({...Ehe,props:bhe,setup(e){const t=e,i={position:"relative"},s=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.color)!=null?pe:"rgba(0,0,0,.15)"}),d=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontSize)!=null?pe:16}),p=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontWeight)!=null?pe:"normal"}),_=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontStyle)!=null?pe:"normal"}),o=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontFamily)!=null?pe:"sans-serif"}),w=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.textAlign)!=null?pe:"center"}),C=te(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.textBaseline)!=null?pe:"hanging"}),M=te(()=>t.gap[0]),I=te(()=>t.gap[1]),F=te(()=>M.value/2),B=te(()=>I.value/2),N=te(()=>{var ce,pe;return(pe=(ce=t.offset)==null?void 0:ce[0])!=null?pe:F.value}),D=te(()=>{var ce,pe;return(pe=(ce=t.offset)==null?void 0:ce[1])!=null?pe:B.value}),j=()=>{const ce={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let pe=N.value-F.value,ge=D.value-B.value;return pe>0&&(ce.left=`${pe}px`,ce.width=`calc(100% - ${pe}px)`,pe=0),ge>0&&(ce.top=`${ge}px`,ce.height=`calc(100% - ${ge}px)`,ge=0),ce.backgroundPosition=`${pe}px ${ge}px`,ce},U=gi(null),ne=gi(),K=we(!1),G=()=>{ne.value&&(ne.value.remove(),ne.value=void 0)},J=(ce,pe)=>{var ge;U.value&&ne.value&&(K.value=!0,ne.value.setAttribute("style",whe({...j(),backgroundImage:`url('${ce}')`,backgroundSize:`${Math.floor(pe)}px`})),(ge=U.value)==null||ge.append(ne.value),setTimeout(()=>{K.value=!1}))},oe=ce=>{let pe=120,ge=64;const Re=t.image,Je=t.content,Me=t.width,xe=t.height;if(!Re&&ce.measureText){ce.font=`${Number(d.value)}px ${o.value}`;const Ae=fn(Je)?Je:[Je],Ce=Ae.map(ve=>{const Ne=ce.measureText(ve);return[Ne.width,Ne.fontBoundingBoxAscent!==void 0?Ne.fontBoundingBoxAscent+Ne.fontBoundingBoxDescent:Ne.actualBoundingBoxAscent+Ne.actualBoundingBoxDescent]});pe=Math.ceil(Math.max(...Ce.map(ve=>ve[0]))),ge=Math.ceil(Math.max(...Ce.map(ve=>ve[1])))*Ae.length+(Ae.length-1)*cF}return[Me??pe,xe??ge]},se=Che(),me=()=>{const pe=document.createElement("canvas").getContext("2d"),ge=t.image,Re=t.content,Je=t.rotate;if(pe){ne.value||(ne.value=document.createElement("div"));const Me=She(),[xe,Ae]=oe(pe),Ce=ve=>{const[Ne,We]=se(ve||"",Je,Me,xe,Ae,{color:s.value,fontSize:d.value,fontStyle:_.value,fontWeight:p.value,fontFamily:o.value,textAlign:w.value,textBaseline:C.value},M.value,I.value);J(Ne,We)};if(ge){const ve=new Image;ve.onload=()=>{Ce(ve)},ve.onerror=()=>{Ce(Re)},ve.crossOrigin="anonymous",ve.referrerPolicy="no-referrer",ve.src=ge}else Ce(Re)}};return No(()=>{me()}),tn(()=>t,()=>{me()},{deep:!0,flush:"post"}),ni(()=>{G()}),sO(U,ce=>{K.value||ce.forEach(pe=>{The(pe,ne.value)&&(G(),me())})},{attributes:!0,subtree:!0,childList:!0}),(ce,pe)=>(le(),Pe("div",{ref_key:"containerRef",ref:U,style:to([i])},[_t(ce.$slots,"default")],4))}});var Ihe=xn(Mhe,[["__file","watermark.vue"]]);const Ahe=Ao(Ihe),khe=vn({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:ut(Object)},targetAreaClickable:{type:Boolean,default:!0}}),Phe=(e,t,i,s,d)=>{const p=we(null),_=()=>{let I;return Zn(e.value)?I=document.querySelector(e.value):Qn(e.value)?I=e.value():I=e.value,I},o=()=>{const I=_();if(!I||!t.value){p.value=null;return}Rhe(I)||I.scrollIntoView(d.value);const{left:F,top:B,width:N,height:D}=I.getBoundingClientRect();p.value={left:F,top:B,width:N,height:D,radius:0}};No(()=>{tn([t,e],()=>{o()},{immediate:!0}),window.addEventListener("resize",o)}),ni(()=>{window.removeEventListener("resize",o)});const w=I=>{var F;return(F=fn(i.value.offset)?i.value.offset[I]:i.value.offset)!=null?F:6},C=te(()=>{var I;if(!p.value)return p.value;const F=w(0),B=w(1),N=((I=i.value)==null?void 0:I.radius)||2;return{left:p.value.left-F,top:p.value.top-B,width:p.value.width+F*2,height:p.value.height+B*2,radius:N}}),M=te(()=>{const I=_();return!s.value||!I||!window.DOMRect?I||void 0:{getBoundingClientRect(){var F,B,N,D;return window.DOMRect.fromRect({width:((F=C.value)==null?void 0:F.width)||0,height:((B=C.value)==null?void 0:B.height)||0,x:((N=C.value)==null?void 0:N.left)||0,y:((D=C.value)==null?void 0:D.top)||0})}}});return{mergedPosInfo:C,triggerTarget:M}},D1=Symbol("ElTour");function Rhe(e){const t=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,{top:s,right:d,bottom:p,left:_}=e.getBoundingClientRect();return s>=0&&_>=0&&d<=t&&p<=i}const Lhe=(e,t,i,s,d,p,_,o)=>{const w=we(),C=we(),M=we({}),I={x:w,y:C,placement:s,strategy:d,middlewareData:M},F=te(()=>{const U=[j4(y(p)),Fue(),zue(),Ohe()];return y(o)&&y(i)&&U.push(H4({element:y(i)})),U}),B=async()=>{if(!gr)return;const U=y(e),ne=y(t);if(!U||!ne)return;const K=await G4(U,ne,{placement:y(s),strategy:y(d),middleware:y(F)});Em(I).forEach(G=>{I[G].value=K[G]})},N=te(()=>{if(!y(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:y(_)};const{overflow:U}=y(M);return{position:y(d),zIndex:y(_),top:y(C)!=null?`${y(C)}px`:"",left:y(w)!=null?`${y(w)}px`:"",maxWidth:U!=null&&U.maxWidth?`${U==null?void 0:U.maxWidth}px`:""}}),D=te(()=>{if(!y(o))return{};const{arrow:U}=y(M);return{left:(U==null?void 0:U.x)!=null?`${U==null?void 0:U.x}px`:"",top:(U==null?void 0:U.y)!=null?`${U==null?void 0:U.y}px`:""}});let j;return No(()=>{const U=y(e),ne=y(t);U&&ne&&(j=Oue(U,ne,B)),Ha(()=>{B()})}),ni(()=>{j&&j()}),{update:B,contentStyle:N,arrowStyle:D}},Ohe=()=>({name:"overflow",async fn(e){const t=await Due(e);let i=0;return t.left>0&&(i=t.left),t.right>0&&(i=t.right),{data:{maxWidth:e.rects.floating.width-i}}}}),Dhe=Ze({name:"ElTourMask",inheritAttrs:!1}),zhe=Ze({...Dhe,props:khe,setup(e){const t=e,{ns:i}=Un(D1),s=te(()=>{var o,w;return(w=(o=t.pos)==null?void 0:o.radius)!=null?w:2}),d=te(()=>{const o=s.value,w=`a${o},${o} 0 0 1`;return{topRight:`${w} ${o},${o}`,bottomRight:`${w} ${-o},${o}`,bottomLeft:`${w} ${-o},${-o}`,topLeft:`${w} ${o},${-o}`}}),p=te(()=>{const o=window.innerWidth,w=window.innerHeight,C=d.value,M=`M${o},0 L0,0 L0,${w} L${o},${w} L${o},0 Z`,I=s.value;return t.pos?`${M} M${t.pos.left+I},${t.pos.top} h${t.pos.width-I*2} ${C.topRight} v${t.pos.height-I*2} ${C.bottomRight} h${-t.pos.width+I*2} ${C.bottomLeft} v${-t.pos.height+I*2} ${C.topLeft} z`:M}),_=te(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return JT(Vr(t,"visible"),{ns:i}),(o,w)=>o.visible?(le(),Pe("div",Yo({key:0,class:y(i).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:o.zIndex,pointerEvents:o.pos&&o.targetAreaClickable?"none":"auto"}},o.$attrs),[(le(),Pe("svg",{style:{width:"100%",height:"100%"}},[Ve("path",{class:he(y(i).e("hollow")),style:to(y(_)),d:y(p)},null,14,["d"])]))],16)):St("v-if",!0)}});var Fhe=xn(zhe,[["__file","mask.vue"]]);const Bhe=["absolute","fixed"],Nhe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],RC=vn({placement:{type:ut(String),values:Nhe,default:"bottom"},reference:{type:ut(Object),default:null},strategy:{type:ut(String),values:Bhe,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),$he={close:()=>!0},Vhe=Ze({name:"ElTourContent"}),Uhe=Ze({...Vhe,props:RC,emits:$he,setup(e,{emit:t}){const i=e,s=we(i.placement),d=we(i.strategy),p=we(null),_=we(null);tn(()=>i.placement,()=>{s.value=i.placement});const{contentStyle:o,arrowStyle:w}=Lhe(Vr(i,"reference"),p,_,s,d,Vr(i,"offset"),Vr(i,"zIndex"),Vr(i,"showArrow")),C=te(()=>s.value.split("-")[0]),{ns:M}=Un(D1),I=()=>{t("close")},F=B=>{B.detail.focusReason==="pointer"&&B.preventDefault()};return(B,N)=>(le(),Pe("div",{ref_key:"contentRef",ref:p,style:to(y(o)),class:he(y(M).e("content")),"data-side":y(C),tabindex:"-1"},[Qe(y(Zm),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":p.value||void 0,onReleaseRequested:I,onFocusoutPrevented:F},{default:at(()=>[_t(B.$slots,"default")]),_:3},8,["focus-trap-el"]),B.showArrow?(le(),Pe("span",{key:0,ref_key:"arrowRef",ref:_,style:to(y(w)),class:he(y(M).e("arrow"))},null,6)):St("v-if",!0)],14,["data-side"]))}});var jhe=xn(Uhe,[["__file","content.vue"]]),Hhe=Ze({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:i}){let s=0;return()=>{var d,p;const _=(d=t.default)==null?void 0:d.call(t),o=[];let w=0;function C(M){fn(M)&&M.forEach(I=>{var F;((F=(I==null?void 0:I.type)||{})==null?void 0:F.name)==="ElTourStep"&&(o.push(I),w+=1)})}return _.length&&C(vh((p=_[0])==null?void 0:p.children)),s!==w&&(s=w,i("update-total",w)),o.length?o[e.current]:null}}});const Ghe=vn({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:Xr},placement:RC.placement,contentStyle:{type:ut([Object])},mask:{type:ut([Boolean,Object]),default:!0},gap:{type:ut(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:ut([Boolean,Object]),default:()=>({block:"center"})},type:{type:ut(String)},appendTo:{type:ut([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),Whe={[Fo]:e=>ai(e),"update:current":e=>ao(e),close:e=>ao(e),finish:()=>!0,change:e=>ao(e)},qhe=Ze({name:"ElTour"}),Khe=Ze({...qhe,props:Ghe,emits:Whe,setup(e,{emit:t}){const i=e,s=rn("tour"),d=we(0),p=we(),_=lO(i,"current",t,{passive:!0}),o=te(()=>{var de;return(de=p.value)==null?void 0:de.target}),w=te(()=>[s.b(),j.value==="primary"?s.m("primary"):""]),C=te(()=>{var de;return((de=p.value)==null?void 0:de.placement)||i.placement}),M=te(()=>{var de,ce;return(ce=(de=p.value)==null?void 0:de.contentStyle)!=null?ce:i.contentStyle}),I=te(()=>{var de,ce;return(ce=(de=p.value)==null?void 0:de.mask)!=null?ce:i.mask}),F=te(()=>!!I.value&&i.modelValue),B=te(()=>ai(I.value)?void 0:I.value),N=te(()=>{var de,ce;return!!o.value&&((ce=(de=p.value)==null?void 0:de.showArrow)!=null?ce:i.showArrow)}),D=te(()=>{var de,ce;return(ce=(de=p.value)==null?void 0:de.scrollIntoViewOptions)!=null?ce:i.scrollIntoViewOptions}),j=te(()=>{var de,ce;return(ce=(de=p.value)==null?void 0:de.type)!=null?ce:i.type}),{nextZIndex:U}=qm(),ne=U(),K=te(()=>{var de;return(de=i.zIndex)!=null?de:ne}),{mergedPosInfo:G,triggerTarget:J}=Phe(o,Vr(i,"modelValue"),Vr(i,"gap"),I,D);tn(()=>i.modelValue,de=>{de||(_.value=0)});const oe=()=>{i.closeOnPressEscape&&(t("update:modelValue",!1),t("close",_.value))},se=de=>{d.value=de},me=aa();return or(D1,{currentStep:p,current:_,total:d,showClose:Vr(i,"showClose"),closeIcon:Vr(i,"closeIcon"),mergedType:j,ns:s,slots:me,updateModelValue(de){t("update:modelValue",de)},onClose(){t("close",_.value)},onFinish(){t("finish")},onChange(){t("change",_.value)}}),(de,ce)=>(le(),Pe(eo,null,[Qe(y(Ym),{to:de.appendTo},{default:at(()=>{var pe,ge;return[Ve("div",Yo({class:y(w)},de.$attrs),[Qe(Fhe,{visible:y(F),fill:(pe=y(B))==null?void 0:pe.color,style:to((ge=y(B))==null?void 0:ge.style),pos:y(G),"z-index":y(K),"target-area-clickable":de.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),de.modelValue?(le(),Rt(jhe,{key:y(_),reference:y(J),placement:y(C),"show-arrow":y(N),"z-index":y(K),style:to(y(M)),onClose:oe},{default:at(()=>[Qe(y(Hhe),{current:y(_),onUpdateTotal:se},{default:at(()=>[_t(de.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):St("v-if",!0)],16)]}),_:3},8,["to"]),St(" just for IDE "),St("v-if",!0)],64))}});var Zhe=xn(Khe,[["__file","tour.vue"]]);const Yhe=vn({target:{type:ut([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:Xr},showArrow:{type:Boolean,default:void 0},placement:RC.placement,mask:{type:ut([Boolean,Object]),default:void 0},contentStyle:{type:ut([Object])},prevButtonProps:{type:ut(Object)},nextButtonProps:{type:ut(Object)},scrollIntoViewOptions:{type:ut([Boolean,Object]),default:void 0},type:{type:ut(String)}}),Xhe={close:()=>!0},Jhe=Ze({name:"ElTourStep"}),Qhe=Ze({...Jhe,props:Yhe,emits:Xhe,setup(e,{emit:t}){const i=e,{Close:s}=xT,{t:d}=vr(),{currentStep:p,current:_,total:o,showClose:w,closeIcon:C,mergedType:M,ns:I,slots:F,updateModelValue:B,onClose:N,onFinish:D,onChange:j}=Un(D1);tn(i,me=>{p.value=me},{immediate:!0});const U=te(()=>{var me;return(me=i.showClose)!=null?me:w.value}),ne=te(()=>{var me,de;return(de=(me=i.closeIcon)!=null?me:C.value)!=null?de:s}),K=me=>{if(me)return bG(me,["children","onClick"])},G=()=>{var me,de;_.value-=1,(me=i.prevButtonProps)!=null&&me.onClick&&((de=i.prevButtonProps)==null||de.onClick()),j()},J=()=>{var me;_.value>=o.value-1?oe():_.value+=1,(me=i.nextButtonProps)!=null&&me.onClick&&i.nextButtonProps.onClick(),j()},oe=()=>{se(),D()},se=()=>{B(!1),N(),t("close")};return(me,de)=>(le(),Pe(eo,null,[y(U)?(le(),Pe("button",{key:0,"aria-label":"Close",class:he(y(I).e("closebtn")),type:"button",onClick:se},[Qe(y(Gn),{class:he(y(I).e("close"))},{default:at(()=>[(le(),Rt(Wo(y(ne))))]),_:1},8,["class"])],2)):St("v-if",!0),Ve("header",{class:he([y(I).e("header"),{"show-close":y(w)}])},[_t(me.$slots,"header",{},()=>[Ve("span",{role:"heading",class:he(y(I).e("title"))},yn(me.title),3)])],2),Ve("div",{class:he(y(I).e("body"))},[_t(me.$slots,"default",{},()=>[Ve("span",null,yn(me.description),1)])],2),Ve("footer",{class:he(y(I).e("footer"))},[Ve("div",{class:he(y(I).b("indicators"))},[y(F).indicators?(le(),Rt(Wo(y(F).indicators),{key:0,current:y(_),total:y(o)},null,8,["current","total"])):(le(!0),Pe(eo,{key:1},nr(y(o),(ce,pe)=>(le(),Pe("span",{key:ce,class:he([y(I).b("indicator"),pe===y(_)?"is-active":""])},null,2))),128))],2),Ve("div",{class:he(y(I).b("buttons"))},[y(_)>0?(le(),Rt(y(Ta),Yo({key:0,size:"small",type:y(M)},K(me.prevButtonProps),{onClick:G}),{default:at(()=>{var ce,pe;return[Qo(yn((pe=(ce=me.prevButtonProps)==null?void 0:ce.children)!=null?pe:y(d)("el.tour.previous")),1)]}),_:1},16,["type"])):St("v-if",!0),y(_)<=y(o)-1?(le(),Rt(y(Ta),Yo({key:1,size:"small",type:y(M)==="primary"?"default":"primary"},K(me.nextButtonProps),{onClick:J}),{default:at(()=>{var ce,pe;return[Qo(yn((pe=(ce=me.nextButtonProps)==null?void 0:ce.children)!=null?pe:y(_)===y(o)-1?y(d)("el.tour.finish"):y(d)("el.tour.next")),1)]}),_:1},16,["type"])):St("v-if",!0)],2)],2)],64))}});var uF=xn(Qhe,[["__file","step.vue"]]);const efe=Ao(Zhe,{TourStep:uF}),tfe=Li(uF),nfe=vn({container:{type:ut([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:ut(String),default:"default"},direction:{type:ut(String),default:"vertical"}}),ofe={change:e=>Zn(e),click:(e,t)=>e instanceof MouseEvent&&(Zn(t)||Hr(t))},dF=Symbol("anchor"),H0=e=>{if(!gr||e==="")return null;if(Zn(e))try{return document.querySelector(e)}catch{return null}return e};function rfe(e){let t=0;const i=(...s)=>{t&&Gf(t),t=wh(()=>{e(...s),t=0})};return i.cancel=()=>{Gf(t),t=0},i}const ife=Ze({name:"ElAnchor"}),afe=Ze({...ife,props:nfe,emits:ofe,setup(e,{expose:t,emit:i}){const s=e,d=we(""),p=we(null),_=we(null),o=we(),w={};let C=!1,M=0;const I=rn("anchor"),F=te(()=>[I.b(),s.type==="underline"?I.m("underline"):"",I.m(s.direction)]),B=me=>{w[me.href]=me.el},N=me=>{delete w[me]},D=me=>{d.value!==me&&(d.value=me,i("change",me))};let j=null;const U=me=>{if(!o.value)return;const de=H0(me);if(!de)return;j&&j(),C=!0;const ce=Bk(de,o.value),pe=F2(de,ce),ge=ce.scrollHeight-ce.clientHeight,Re=Math.min(pe-s.offset,ge);j=SW(o.value,M,Re,s.duration,()=>{setTimeout(()=>{C=!1},20)})},ne=me=>{me&&(D(me),U(me))},K=(me,de)=>{i("click",me,de),ne(de)},G=rfe(()=>{o.value&&(M=Nk(o.value));const me=J();C||Hr(me)||D(me)}),J=()=>{if(!o.value)return;const me=Nk(o.value),de=[];for(const ce of Object.keys(w)){const pe=H0(ce);if(!pe)continue;const ge=Bk(pe,o.value),Re=F2(pe,ge);de.push({top:Re-s.offset-s.bound,href:ce})}de.sort((ce,pe)=>ce.top-pe.top);for(let ce=0;ce<de.length;ce++){const pe=de[ce],ge=de[ce+1];if(ce===0&&me===0)return"";if(pe.top<=me&&(!ge||ge.top>me))return pe.href}},oe=()=>{const me=H0(s.container);!me||p1(me)?o.value=window:o.value=me};qr(o,"scroll",G);const se=te(()=>{if(!p.value||!_.value||!d.value)return{};const me=w[d.value];if(!me)return{};const de=p.value.getBoundingClientRect(),ce=_.value.getBoundingClientRect(),pe=me.getBoundingClientRect();return s.direction==="horizontal"?{left:`${pe.left-de.left}px`,width:`${pe.width}px`,opacity:1}:{top:`${pe.top-de.top+(pe.height-ce.height)/2}px`,opacity:1}});return No(()=>{oe();const me=decodeURIComponent(window.location.hash);H0(me)?ne(me):G()}),tn(()=>s.container,()=>{oe()}),or(dF,{ns:I,direction:s.direction,currentAnchor:d,addLink:B,removeLink:N,handleClick:K}),t({scrollTo:ne}),(me,de)=>(le(),Pe("div",{ref_key:"anchorRef",ref:p,class:he(y(F))},[me.marker?(le(),Pe("div",{key:0,ref_key:"markerRef",ref:_,class:he(y(I).e("marker")),style:to(y(se))},null,6)):St("v-if",!0),Ve("div",{class:he(y(I).e("list"))},[_t(me.$slots,"default")],2)],2))}});var sfe=xn(afe,[["__file","anchor.vue"]]);const lfe=vn({title:String,href:String}),cfe=Ze({name:"ElAnchorLink"}),ufe=Ze({...cfe,props:lfe,setup(e){const t=e,i=we(null),{ns:s,direction:d,currentAnchor:p,addLink:_,removeLink:o,handleClick:w}=Un(dF),C=te(()=>[s.e("link"),s.is("active",p.value===t.href)]),M=I=>{w(I,t.href)};return tn(()=>t.href,(I,F)=>{oo(()=>{F&&o(F),I&&_({href:I,el:i.value})})}),No(()=>{const{href:I}=t;I&&_({href:I,el:i.value})}),ni(()=>{const{href:I}=t;I&&o(I)}),(I,F)=>(le(),Pe("div",{class:he(y(s).e("item"))},[Ve("a",{ref_key:"linkRef",ref:i,class:he(y(C)),href:I.href,onClick:M},[_t(I.$slots,"default",{},()=>[Qo(yn(I.title),1)])],10,["href"]),I.$slots["sub-link"]&&y(d)==="vertical"?(le(),Pe("div",{key:0,class:he(y(s).e("list"))},[_t(I.$slots,"sub-link")],2)):St("v-if",!0)],2))}});var hF=xn(ufe,[["__file","anchor-link.vue"]]);const dfe=Ao(sfe,{AnchorLink:hF}),hfe=Li(hF),ffe=vn({direction:{type:ut(String),default:"horizontal"},options:{type:ut(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:ia,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...Da(["ariaLabel"])}),pfe={[Fo]:e=>Zn(e)||ao(e)||ai(e),[Yr]:e=>Zn(e)||ao(e)||ai(e)},mfe=Ze({name:"ElSegmented"}),gfe=Ze({...mfe,props:ffe,emits:pfe,setup(e,{emit:t}){const i=e,s=rn("segmented"),d=Oa(),p=na(),_=Za(),{formItem:o}=Ka(),{inputId:w,isLabeledByFormItem:C}=sc(i,{formItemContext:o}),M=we(null),I=WG(),F=Ir({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),B=de=>{const ce=N(de);t(Fo,ce),t(Yr,ce)},N=de=>Vo(de)?de.value:de,D=de=>Vo(de)?de.label:de,j=de=>!!(_.value||Vo(de)&&de.disabled),U=de=>i.modelValue===N(de),ne=de=>i.options.find(ce=>N(ce)===de),K=de=>[s.e("item"),s.is("selected",U(de)),s.is("disabled",j(de))],G=()=>{if(!M.value)return;const de=M.value.querySelector(".is-selected"),ce=M.value.querySelector(".is-selected input");if(!de||!ce){F.width=0,F.height=0,F.translateX=0,F.translateY=0,F.focusVisible=!1;return}const pe=de.getBoundingClientRect();F.isInit=!0,i.direction==="vertical"?(F.height=pe.height,F.translateY=de.offsetTop):(F.width=pe.width,F.translateX=de.offsetLeft);try{F.focusVisible=ce.matches(":focus-visible")}catch{}},J=te(()=>[s.b(),s.m(p.value),s.is("block",i.block)]),oe=te(()=>({width:i.direction==="vertical"?"100%":`${F.width}px`,height:i.direction==="vertical"?`${F.height}px`:"100%",transform:i.direction==="vertical"?`translateY(${F.translateY}px)`:`translateX(${F.translateX}px)`,display:F.isInit?"block":"none"})),se=te(()=>[s.e("item-selected"),s.is("disabled",j(ne(i.modelValue))),s.is("focus-visible",F.focusVisible)]),me=te(()=>i.name||d.value);return Mi(M,G),tn(I,G),tn(()=>i.modelValue,()=>{var de;G(),i.validateEvent&&((de=o==null?void 0:o.validate)==null||de.call(o,"change").catch(ce=>void 0))},{flush:"post"}),(de,ce)=>de.options.length?(le(),Pe("div",{key:0,id:y(w),ref_key:"segmentedRef",ref:M,class:he(y(J)),role:"radiogroup","aria-label":y(C)?void 0:de.ariaLabel||"segmented","aria-labelledby":y(C)?y(o).labelId:void 0},[Ve("div",{class:he([y(s).e("group"),y(s).m(i.direction)])},[Ve("div",{style:to(y(oe)),class:he(y(se))},null,6),(le(!0),Pe(eo,null,nr(de.options,(pe,ge)=>(le(),Pe("label",{key:ge,class:he(K(pe))},[Ve("input",{class:he(y(s).e("item-input")),type:"radio",name:y(me),disabled:j(pe),checked:U(pe),onChange:Re=>B(pe)},null,42,["name","disabled","checked","onChange"]),Ve("div",{class:he(y(s).e("item-label"))},[_t(de.$slots,"default",{item:pe},()=>[Qo(yn(D(pe)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):St("v-if",!0)}});var vfe=xn(gfe,[["__file","segmented.vue"]]);const _fe=Ao(vfe),yfe=(e,t)=>{const i=e.toLowerCase();return(t.label||t.value).toLowerCase().includes(i)},bfe=(e,t,i)=>{const{selectionEnd:s}=e;if(s===null)return;const d=e.value,p=ds(t);let _=-1,o;for(let w=s-1;w>=0;--w){const C=d[w];if(C===i||C===`
`||C==="\r"){_=w;continue}if(p.includes(C)){const M=_===-1?s:_;o={pattern:d.slice(w+1,M),start:w+1,end:M,prefix:C,prefixIndex:w,splitIndex:_,selectionEnd:s};break}}return o},xfe=(e,t={debug:!1,useSelectionEnd:!1})=>{const i=e.selectionStart!==null?e.selectionStart:0,s=e.selectionEnd!==null?e.selectionEnd:0,d=t.useSelectionEnd?s:i,p=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(t.debug){const F=document.querySelector("#input-textarea-caret-position-mirror-div");F!=null&&F.parentNode&&F.parentNode.removeChild(F)}const _=document.createElement("div");_.id="input-textarea-caret-position-mirror-div",document.body.appendChild(_);const o=_.style,w=window.getComputedStyle(e),C=e.nodeName==="INPUT";o.whiteSpace=C?"nowrap":"pre-wrap",C||(o.wordWrap="break-word"),o.position="absolute",t.debug||(o.visibility="hidden"),p.forEach(F=>{if(C&&F==="lineHeight")if(w.boxSizing==="border-box"){const B=Number.parseInt(w.height),N=Number.parseInt(w.paddingTop)+Number.parseInt(w.paddingBottom)+Number.parseInt(w.borderTopWidth)+Number.parseInt(w.borderBottomWidth),D=N+Number.parseInt(w.lineHeight);B>D?o.lineHeight=`${B-N}px`:B===D?o.lineHeight=w.lineHeight:o.lineHeight="0"}else o.lineHeight=w.height;else o[F]=w[F]}),b1()?e.scrollHeight>Number.parseInt(w.height)&&(o.overflowY="scroll"):o.overflow="hidden",_.textContent=e.value.slice(0,Math.max(0,d)),C&&_.textContent&&(_.textContent=_.textContent.replace(/\s/g,""));const M=document.createElement("span");M.textContent=e.value.slice(Math.max(0,d))||".",M.style.position="relative",M.style.left=`${-e.scrollLeft}px`,M.style.top=`${-e.scrollTop}px`,_.appendChild(M);const I={top:M.offsetTop+Number.parseInt(w.borderTopWidth),left:M.offsetLeft+Number.parseInt(w.borderLeftWidth),height:Number.parseInt(w.fontSize)*1.5};return t.debug?M.style.backgroundColor="#aaa":document.body.removeChild(_),I.left>=e.clientWidth&&(I.left=e.clientWidth),I},wfe=vn({...ST,options:{type:ut(Array),default:()=>[]},prefix:{type:ut([String,Array]),default:"@",validator:e=>Zn(e)?e.length===1:e.every(t=>Zn(t)&&t.length===1)},split:{type:String,default:" ",validator:e=>e.length===1},filterOption:{type:ut([Boolean,Function]),default:()=>yfe,validator:e=>e===!1?!0:Qn(e)},placement:{type:ut(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:ut(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:ut(Object),default:()=>({})}}),Sfe={[Fo]:e=>Zn(e),search:(e,t)=>Zn(e)&&Zn(t),select:(e,t)=>Zn(e.value)&&Zn(t),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},Tfe=vn({options:{type:ut(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),Cfe={select:e=>Zn(e.value)},Efe=Ze({name:"ElMentionDropdown"}),Mfe=Ze({...Efe,props:Tfe,emits:Cfe,setup(e,{expose:t,emit:i}){const s=e,d=rn("mention"),{t:p}=vr(),_=we(-1),o=we(),w=we(),C=we(),M=(K,G)=>[d.be("dropdown","item"),d.is("hovering",_.value===G),d.is("disabled",K.disabled||s.disabled)],I=K=>{K.disabled||s.disabled||i("select",K)},F=K=>{_.value=K},B=te(()=>s.disabled||s.options.every(K=>K.disabled)),N=te(()=>s.options[_.value]),D=()=>{N.value&&i("select",N.value)},j=K=>{const{options:G}=s;if(G.length===0||B.value)return;K==="next"?(_.value++,_.value===G.length&&(_.value=0)):K==="prev"&&(_.value--,_.value<0&&(_.value=G.length-1));const J=G[_.value];if(J.disabled){j(K);return}oo(()=>U(J))},U=K=>{var G,J,oe,se;const{options:me}=s,de=me.findIndex(pe=>pe.value===K.value),ce=(G=w.value)==null?void 0:G[de];if(ce){const pe=(oe=(J=C.value)==null?void 0:J.querySelector)==null?void 0:oe.call(J,`.${d.be("dropdown","wrap")}`);pe&&gT(pe,ce)}(se=o.value)==null||se.handleScroll()};return tn(()=>s.options,()=>{B.value||s.options.length===0?_.value=-1:_.value=0},{immediate:!0}),t({hoveringIndex:_,navigateOptions:j,selectHoverOption:D,hoverOption:N}),(K,G)=>(le(),Pe("div",{ref_key:"dropdownRef",ref:C,class:he(y(d).b("dropdown"))},[K.$slots.header?(le(),Pe("div",{key:0,class:he(y(d).be("dropdown","header"))},[_t(K.$slots,"header")],2)):St("v-if",!0),zo(Qe(y(Ou),{id:K.contentId,ref_key:"scrollbarRef",ref:o,tag:"ul","wrap-class":y(d).be("dropdown","wrap"),"view-class":y(d).be("dropdown","list"),role:"listbox","aria-label":K.ariaLabel,"aria-orientation":"vertical"},{default:at(()=>[(le(!0),Pe(eo,null,nr(K.options,(J,oe)=>(le(),Pe("li",{id:`${K.contentId}-${oe}`,ref_for:!0,ref_key:"optionRefs",ref:w,key:oe,class:he(M(J,oe)),role:"option","aria-disabled":J.disabled||K.disabled||void 0,"aria-selected":_.value===oe,onMousemove:se=>F(oe),onClick:po(se=>I(J),["stop"])},[_t(K.$slots,"label",{item:J,index:oe},()=>{var se;return[Ve("span",null,yn((se=J.label)!=null?se:J.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[Cr,K.options.length>0&&!K.loading]]),K.loading?(le(),Pe("div",{key:1,class:he(y(d).be("dropdown","loading"))},[_t(K.$slots,"loading",{},()=>[Qo(yn(y(p)("el.mention.loading")),1)])],2)):St("v-if",!0),K.$slots.footer?(le(),Pe("div",{key:2,class:he(y(d).be("dropdown","footer"))},[_t(K.$slots,"footer")],2)):St("v-if",!0)],2))}});var Ife=xn(Mfe,[["__file","mention-dropdown.vue"]]);const Afe=Ze({name:"ElMention",inheritAttrs:!1}),kfe=Ze({...Afe,props:wfe,emits:Sfe,setup(e,{expose:t,emit:i}){const s=e,d=te(()=>Gc(s,Object.keys(ST))),p=rn("mention"),_=Za(),o=Oa(),w=we(),C=we(),M=we(),I=we(!1),F=we(),B=we(),N=te(()=>s.showArrow?s.placement:`${s.placement}-start`),D=te(()=>s.showArrow?["bottom","top"]:["bottom-start","top-start"]),j=te(()=>{const{filterOption:ge,options:Re}=s;return!B.value||!ge?Re:Re.filter(Je=>ge(B.value.pattern,Je))}),U=te(()=>I.value&&(!!j.value.length||s.loading)),ne=te(()=>{var ge;return`${o.value}-${(ge=M.value)==null?void 0:ge.hoveringIndex}`}),K=ge=>{i("update:modelValue",ge),de()},G=ge=>{var Re,Je,Me,xe;if(!(!("code"in ge)||(Re=w.value)!=null&&Re.isComposing))switch(ge.code){case Ln.left:case Ln.right:de();break;case Ln.up:case Ln.down:if(!I.value)return;ge.preventDefault(),(Je=M.value)==null||Je.navigateOptions(ge.code===Ln.up?"prev":"next");break;case Ln.enter:case Ln.numpadEnter:if(!I.value)return;ge.preventDefault(),(Me=M.value)!=null&&Me.hoverOption?(xe=M.value)==null||xe.selectHoverOption():I.value=!1;break;case Ln.esc:if(!I.value)return;ge.preventDefault(),I.value=!1;break;case Ln.backspace:if(s.whole&&B.value){const{splitIndex:Ae,selectionEnd:Ce,pattern:ve,prefixIndex:Ne,prefix:We}=B.value,ot=me();if(!ot)return;const Oe=ot.value,Ct=s.options.find(zt=>zt.value===ve);if((Qn(s.checkIsWhole)?s.checkIsWhole(ve,We):Ct)&&Ae!==-1&&Ae+1===Ce){ge.preventDefault();const zt=Oe.slice(0,Ne)+Oe.slice(Ae+1);i(Fo,zt);const bt=Ne;oo(()=>{ot.selectionStart=bt,ot.selectionEnd=bt,pe()})}}}},{wrapperRef:J}=Lh(w,{beforeFocus(){return _.value},afterFocus(){de()},beforeBlur(ge){var Re;return(Re=C.value)==null?void 0:Re.isFocusInsideContent(ge)},afterBlur(){I.value=!1}}),oe=()=>{de()},se=ge=>{if(!B.value)return;const Re=me();if(!Re)return;const Je=Re.value,{split:Me}=s,xe=Je.slice(B.value.end),Ae=xe.startsWith(Me),Ce=`${ge.value}${Ae?"":Me}`,ve=Je.slice(0,B.value.start)+Ce+xe;i(Fo,ve),i("select",ge,B.value.prefix);const Ne=B.value.start+Ce.length+(Ae?1:0);oo(()=>{Re.selectionStart=Ne,Re.selectionEnd=Ne,Re.focus(),pe()})},me=()=>{var ge,Re;return s.type==="textarea"?(ge=w.value)==null?void 0:ge.textarea:(Re=w.value)==null?void 0:Re.input},de=()=>{setTimeout(()=>{ce(),pe(),oo(()=>{var ge;return(ge=C.value)==null?void 0:ge.updatePopper()})},0)},ce=()=>{const ge=me();if(!ge)return;const Re=xfe(ge),Je=ge.getBoundingClientRect(),Me=w.value.$el.getBoundingClientRect();F.value={position:"absolute",width:0,height:`${Re.height}px`,left:`${Re.left+Je.left-Me.left}px`,top:`${Re.top+Je.top-Me.top}px`}},pe=()=>{const ge=me();if(document.activeElement!==ge){I.value=!1;return}const{prefix:Re,split:Je}=s;if(B.value=bfe(ge,Re,Je),B.value&&B.value.splitIndex===-1){I.value=!0,i("search",B.value.pattern,B.value.prefix);return}I.value=!1};return t({input:w,tooltip:C,dropdownVisible:U}),(ge,Re)=>(le(),Pe("div",{ref_key:"wrapperRef",ref:J,class:he(y(p).b())},[Qe(y(fs),Yo(Yo(y(d),ge.$attrs),{ref_key:"elInputRef",ref:w,"model-value":ge.modelValue,disabled:y(_),role:y(U)?"combobox":void 0,"aria-activedescendant":y(U)?y(ne)||"":void 0,"aria-controls":y(U)?y(o):void 0,"aria-expanded":y(U)||void 0,"aria-label":ge.ariaLabel,"aria-autocomplete":y(U)?"none":void 0,"aria-haspopup":y(U)?"listbox":void 0,onInput:K,onKeydown:G,onMousedown:oe}),nc({_:2},[nr(ge.$slots,(Je,Me)=>({name:Me,fn:at(xe=>[_t(ge.$slots,Me,Hc(yh(xe)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),Qe(y(qa),{ref_key:"tooltipRef",ref:C,visible:y(U),"popper-class":[y(p).e("popper"),ge.popperClass],"popper-options":ge.popperOptions,placement:y(N),"fallback-placements":y(D),effect:"light",pure:"",offset:ge.offset,"show-arrow":ge.showArrow},{default:at(()=>[Ve("div",{style:to(F.value)},null,4)]),content:at(()=>{var Je;return[Qe(Ife,{ref_key:"dropdownRef",ref:M,options:y(j),disabled:y(_),loading:ge.loading,"content-id":y(o),"aria-label":ge.ariaLabel,onSelect:se,onClick:po((Je=w.value)==null?void 0:Je.focus,["stop"])},nc({_:2},[nr(ge.$slots,(Me,xe)=>({name:xe,fn:at(Ae=>[_t(ge.$slots,xe,Hc(yh(Ae)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var Pfe=xn(kfe,[["__file","mention.vue"]]);const Rfe=Ao(Pfe);var Lfe=[IW,Kq,UK,pce,KK,tZ,tD,fZ,pZ,Ta,lD,rY,cY,EY,MY,MX,kD,LX,ac,VY,xD,BX,eJ,tJ,T1,MJ,kJ,UJ,jJ,HJ,GJ,WJ,oee,fee,pee,Eee,cz,zee,Cte,Ete,Mte,_z,Ene,Mne,Gn,Bne,xz,fs,wz,eoe,aoe,Eoe,Moe,Ioe,Aoe,Doe,Ere,Rre,Vre,XO,Pz,ID,eX,QY,Xre,nie,cie,Ou,Wf,Lb,are,Uie,Xie,Jie,vae,wae,Hz,Lae,Uae,jae,Zae,rle,ile,fce,Ace,kce,Rm,Dce,SQ,Vce,Wce,qce,qa,tde,pde,Gb,Lde,Yde,yhe,Ahe,efe,tfe,dfe,hfe,_fe,Rfe];const Xl="ElInfiniteScroll",Ofe=50,Dfe=200,zfe=0,Ffe={delay:{type:Number,default:Dfe},distance:{type:Number,default:zfe},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},LC=(e,t)=>Object.entries(Ffe).reduce((i,[s,d])=>{var p,_;const{type:o,default:w}=d,C=e.getAttribute(`infinite-scroll-${s}`);let M=(_=(p=t[C])!=null?p:C)!=null?_:w;return M=M==="false"?!1:M,M=o(M),i[s]=Number.isNaN(M)?w:M,i},{}),fF=e=>{const{observer:t}=e[Xl];t&&(t.disconnect(),delete e[Xl].observer)},Bfe=(e,t)=>{const{container:i,containerEl:s,instance:d,observer:p,lastScrollTop:_}=e[Xl],{disabled:o,distance:w}=LC(e,d),{clientHeight:C,scrollHeight:M,scrollTop:I}=s,F=I-_;if(e[Xl].lastScrollTop=I,p||o||F<0)return;let B=!1;if(i===e)B=M-(C+I)<=w;else{const{clientTop:N,scrollHeight:D}=e,j=F2(e,s);B=I+C>=j+N+D-w}B&&t.call(d)};function o2(e,t){const{containerEl:i,instance:s}=e[Xl],{disabled:d}=LC(e,s);d||i.clientHeight===0||(i.scrollHeight<=i.clientHeight?t.call(s):fF(e))}const Nfe={async mounted(e,t){const{instance:i,value:s}=t;Qn(s)||ha(Xl,"'v-infinite-scroll' binding value must be a function"),await oo();const{delay:d,immediate:p}=LC(e,i),_=mT(e,!0),o=_===window?document.documentElement:_,w=zf(Bfe.bind(null,e,s),d);if(_){if(e[Xl]={instance:i,container:_,containerEl:o,delay:d,cb:s,onScroll:w,lastScrollTop:o.scrollTop},p){const C=new MutationObserver(zf(o2.bind(null,e,s),Ofe));e[Xl].observer=C,C.observe(e,{childList:!0,subtree:!0}),o2(e,s)}_.addEventListener("scroll",w)}},unmounted(e){if(!e[Xl])return;const{container:t,onScroll:i}=e[Xl];t==null||t.removeEventListener("scroll",i),fF(e)},async updated(e){if(!e[Xl])await oo();else{const{containerEl:t,cb:i,observer:s}=e[Xl];t.clientHeight&&s&&o2(e,i)}}},ES=Nfe;ES.install=e=>{e.directive("InfiniteScroll",ES)};const $fe=ES;function Vfe(e){let t;const i=we(!1),s=Ir({...e,originalPosition:"",originalOverflow:"",visible:!1});function d(F){s.text=F}function p(){const F=s.parent,B=I.ns;if(!F.vLoadingAddClassList){let N=F.getAttribute("loading-number");N=Number.parseInt(N)-1,N?F.setAttribute("loading-number",N.toString()):(ps(F,B.bm("parent","relative")),F.removeAttribute("loading-number")),ps(F,B.bm("parent","hidden"))}_(),M.unmount()}function _(){var F,B;(B=(F=I.$el)==null?void 0:F.parentNode)==null||B.removeChild(I.$el)}function o(){var F;e.beforeClose&&!e.beforeClose()||(i.value=!0,clearTimeout(t),t=setTimeout(w,400),s.visible=!1,(F=e.closed)==null||F.call(e))}function w(){if(!i.value)return;const F=s.parent;i.value=!1,F.vLoadingAddClassList=void 0,p()}const M=aL(Ze({name:"ElLoading",setup(F,{expose:B}){const{ns:N,zIndex:D}=v1("loading");return B({ns:N,zIndex:D}),()=>{const j=s.spinner||s.svg,U=lo("svg",{class:"circular",viewBox:s.svgViewBox?s.svgViewBox:"0 0 50 50",...j?{innerHTML:j}:{}},[lo("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),ne=s.text?lo("p",{class:N.b("text")},[s.text]):void 0;return lo(Ea,{name:N.b("fade"),onAfterLeave:w},{default:at(()=>[zo(Qe("div",{style:{backgroundColor:s.background||""},class:[N.b("mask"),s.customClass,s.fullscreen?"is-fullscreen":""]},[lo("div",{class:N.b("spinner")},[U,ne])]),[[Cr,s.visible]])])})}}})),I=M.mount(document.createElement("div"));return{...Ca(s),setText:d,removeElLoadingChild:_,close:o,handleAfterLeave:w,vm:I,get $el(){return I.$el}}}let G0;const MS=function(e={}){if(!gr)return;const t=Ufe(e);if(t.fullscreen&&G0)return G0;const i=Vfe({...t,closed:()=>{var d;(d=t.closed)==null||d.call(t),t.fullscreen&&(G0=void 0)}});jfe(t,t.parent,i),A3(t,t.parent,i),t.parent.vLoadingAddClassList=()=>A3(t,t.parent,i);let s=t.parent.getAttribute("loading-number");return s?s=`${Number.parseInt(s)+1}`:s="1",t.parent.setAttribute("loading-number",s),t.parent.appendChild(i.$el),oo(()=>i.visible.value=t.visible),t.fullscreen&&(G0=i),i},Ufe=e=>{var t,i,s,d;let p;return Zn(e.target)?p=(t=document.querySelector(e.target))!=null?t:document.body:p=e.target||document.body,{parent:p===document.body||e.body?document.body:p,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:p===document.body&&((i=e.fullscreen)!=null?i:!0),lock:(s=e.lock)!=null?s:!1,customClass:e.customClass||"",visible:(d=e.visible)!=null?d:!0,beforeClose:e.beforeClose,closed:e.closed,target:p}},jfe=async(e,t,i)=>{const{nextZIndex:s}=i.vm.zIndex||i.vm._.exposed.zIndex,d={};if(e.fullscreen)i.originalPosition.value=td(document.body,"position"),i.originalOverflow.value=td(document.body,"overflow"),d.zIndex=s();else if(e.parent===document.body){i.originalPosition.value=td(document.body,"position"),await oo();for(const p of["top","left"]){const _=p==="top"?"scrollTop":"scrollLeft";d[p]=`${e.target.getBoundingClientRect()[p]+document.body[_]+document.documentElement[_]-Number.parseInt(td(document.body,`margin-${p}`),10)}px`}for(const p of["height","width"])d[p]=`${e.target.getBoundingClientRect()[p]}px`}else i.originalPosition.value=td(t,"position");for(const[p,_]of Object.entries(d))i.$el.style[p]=_},A3=(e,t,i)=>{const s=i.vm.ns||i.vm._.exposed.ns;["absolute","fixed","sticky"].includes(i.originalPosition.value)?ps(t,s.bm("parent","relative")):Jl(t,s.bm("parent","relative")),e.fullscreen&&e.lock?Jl(t,s.bm("parent","hidden")):ps(t,s.bm("parent","hidden"))},hb=Symbol("ElLoading"),k3=(e,t)=>{var i,s,d,p;const _=t.instance,o=F=>Vo(t.value)?t.value[F]:void 0,w=F=>{const B=Zn(F)&&(_==null?void 0:_[F])||F;return B&&we(B)},C=F=>w(o(F)||e.getAttribute(`element-loading-${cd(F)}`)),M=(i=o("fullscreen"))!=null?i:t.modifiers.fullscreen,I={text:C("text"),svg:C("svg"),svgViewBox:C("svgViewBox"),spinner:C("spinner"),background:C("background"),customClass:C("customClass"),fullscreen:M,target:(s=o("target"))!=null?s:M?void 0:e,body:(d=o("body"))!=null?d:t.modifiers.body,lock:(p=o("lock"))!=null?p:t.modifiers.lock};e[hb]={options:I,instance:MS(I)}},Hfe=(e,t)=>{for(const i of Object.keys(t))vi(t[i])&&(t[i].value=e[i])},P3={mounted(e,t){t.value&&k3(e,t)},updated(e,t){const i=e[hb];t.oldValue!==t.value&&(t.value&&!t.oldValue?k3(e,t):t.value&&t.oldValue?Vo(t.value)&&Hfe(t.value,i.options):i==null||i.instance.close())},unmounted(e){var t;(t=e[hb])==null||t.instance.close(),e[hb]=null}},Gfe={install(e){e.directive("loading",P3),e.config.globalProperties.$loading=MS},directive:P3,service:MS},pF=["success","info","warning","error"],ls=Ri({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:gr?document.body:void 0}),Wfe=vn({customClass:{type:String,default:ls.customClass},center:{type:Boolean,default:ls.center},dangerouslyUseHTMLString:{type:Boolean,default:ls.dangerouslyUseHTMLString},duration:{type:Number,default:ls.duration},icon:{type:Xr,default:ls.icon},id:{type:String,default:ls.id},message:{type:ut([String,Object,Function]),default:ls.message},onClose:{type:ut(Function),default:ls.onClose},showClose:{type:Boolean,default:ls.showClose},type:{type:String,values:pF,default:ls.type},plain:{type:Boolean,default:ls.plain},offset:{type:Number,default:ls.offset},zIndex:{type:Number,default:ls.zIndex},grouping:{type:Boolean,default:ls.grouping},repeatNum:{type:Number,default:ls.repeatNum}}),qfe={destroy:()=>!0},Wc=nR([]),Kfe=e=>{const t=Wc.findIndex(d=>d.id===e),i=Wc[t];let s;return t>0&&(s=Wc[t-1]),{current:i,prev:s}},Zfe=e=>{const{prev:t}=Kfe(e);return t?t.vm.exposed.bottom.value:0},Yfe=(e,t)=>Wc.findIndex(s=>s.id===e)>0?16:t,Xfe=Ze({name:"ElMessage"}),Jfe=Ze({...Xfe,props:Wfe,emits:qfe,setup(e,{expose:t}){const i=e,{Close:s}=wT,{ns:d,zIndex:p}=v1("message"),{currentZIndex:_,nextZIndex:o}=p,w=we(),C=we(!1),M=we(0);let I;const F=te(()=>i.type?i.type==="error"?"danger":i.type:"info"),B=te(()=>{const se=i.type;return{[d.bm("icon",se)]:se&&Eh[se]}}),N=te(()=>i.icon||Eh[i.type]||""),D=te(()=>Zfe(i.id)),j=te(()=>Yfe(i.id,i.offset)+D.value),U=te(()=>M.value+j.value),ne=te(()=>({top:`${j.value}px`,zIndex:_.value}));function K(){i.duration!==0&&({stop:I}=Hf(()=>{J()},i.duration))}function G(){I==null||I()}function J(){C.value=!1}function oe({code:se}){se===Ln.esc&&J()}return No(()=>{K(),o(),C.value=!0}),tn(()=>i.repeatNum,()=>{G(),K()}),qr(document,"keydown",oe),Mi(w,()=>{M.value=w.value.getBoundingClientRect().height}),t({visible:C,bottom:U,close:J}),(se,me)=>(le(),Rt(Ea,{name:y(d).b("fade"),onBeforeLeave:se.onClose,onAfterLeave:de=>se.$emit("destroy"),persisted:""},{default:at(()=>[zo(Ve("div",{id:se.id,ref_key:"messageRef",ref:w,class:he([y(d).b(),{[y(d).m(se.type)]:se.type},y(d).is("center",se.center),y(d).is("closable",se.showClose),y(d).is("plain",se.plain),se.customClass]),style:to(y(ne)),role:"alert",onMouseenter:G,onMouseleave:K},[se.repeatNum>1?(le(),Rt(y(tD),{key:0,value:se.repeatNum,type:y(F),class:he(y(d).e("badge"))},null,8,["value","type","class"])):St("v-if",!0),y(N)?(le(),Rt(y(Gn),{key:1,class:he([y(d).e("icon"),y(B)])},{default:at(()=>[(le(),Rt(Wo(y(N))))]),_:1},8,["class"])):St("v-if",!0),_t(se.$slots,"default",{},()=>[se.dangerouslyUseHTMLString?(le(),Pe(eo,{key:1},[St(" Caution here, message could've been compromised, never use user's input as message "),Ve("p",{class:he(y(d).e("content")),innerHTML:se.message},null,10,["innerHTML"])],2112)):(le(),Pe("p",{key:0,class:he(y(d).e("content"))},yn(se.message),3))]),se.showClose?(le(),Rt(y(Gn),{key:2,class:he(y(d).e("closeBtn")),onClick:po(J,["stop"])},{default:at(()=>[Qe(y(s))]),_:1},8,["class","onClick"])):St("v-if",!0)],46,["id"]),[[Cr,C.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var Qfe=xn(Jfe,[["__file","message.vue"]]);let epe=1;const mF=e=>{const t=!e||Zn(e)||Ai(e)||Qn(e)?{message:e}:e,i={...ls,...t};if(!i.appendTo)i.appendTo=document.body;else if(Zn(i.appendTo)){let s=document.querySelector(i.appendTo);El(s)||(s=document.body),i.appendTo=s}return ai(Vc.grouping)&&!i.grouping&&(i.grouping=Vc.grouping),ao(Vc.duration)&&i.duration===3e3&&(i.duration=Vc.duration),ao(Vc.offset)&&i.offset===16&&(i.offset=Vc.offset),ai(Vc.showClose)&&!i.showClose&&(i.showClose=Vc.showClose),i},tpe=e=>{const t=Wc.indexOf(e);if(t===-1)return;Wc.splice(t,1);const{handler:i}=e;i.close()},npe=({appendTo:e,...t},i)=>{const s=`message_${epe++}`,d=t.onClose,p=document.createElement("div"),_={...t,id:s,onClose:()=>{d==null||d(),tpe(M)},onDestroy:()=>{bh(null,p)}},o=Qe(Qfe,_,Qn(_.message)||Ai(_.message)?{default:Qn(_.message)?_.message:()=>_.message}:null);o.appContext=i||Nm._context,bh(o,p),e.appendChild(p.firstElementChild);const w=o.component,M={id:s,vnode:o,vm:w,handler:{close:()=>{w.exposed.visible.value=!1}},props:o.component.props};return M},Nm=(e={},t)=>{if(!gr)return{close:()=>{}};const i=mF(e);if(i.grouping&&Wc.length){const d=Wc.find(({vnode:p})=>{var _;return((_=p.props)==null?void 0:_.message)===i.message});if(d)return d.props.repeatNum+=1,d.props.type=i.type,d.handler}if(ao(Vc.max)&&Wc.length>=Vc.max)return{close:()=>{}};const s=npe(i,t);return Wc.push(s),s.handler};pF.forEach(e=>{Nm[e]=(t={},i)=>{const s=mF(t);return Nm({...s,type:e},i)}});function ope(e){for(const t of Wc)(!e||e===t.props.type)&&t.handler.close()}Nm.closeAll=ope;Nm._context=null;const rpe=xO(Nm,"$message"),IS="_trap-focus-children",Lf=[],R3=e=>{if(Lf.length===0)return;const t=Lf[Lf.length-1][IS];if(t.length>0&&e.code===Ln.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const i=e.shiftKey,s=e.target===t[0],d=e.target===t[t.length-1];s&&i&&(e.preventDefault(),t[t.length-1].focus()),d&&!i&&(e.preventDefault(),t[0].focus())}},ipe={beforeMount(e){e[IS]=Hk(e),Lf.push(e),Lf.length<=1&&document.addEventListener("keydown",R3)},updated(e){oo(()=>{e[IS]=Hk(e)})},unmounted(){Lf.shift(),Lf.length===0&&document.removeEventListener("keydown",R3)}},ape=Ze({name:"ElMessageBox",directives:{TrapFocus:ipe},components:{ElButton:Ta,ElFocusTrap:Zm,ElInput:fs,ElOverlay:XT,ElIcon:Gn,...wT},inheritAttrs:!1,props:{buttonSize:{type:String,validator:Wz},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:i,zIndex:s,ns:d,size:p}=v1("message-box",te(()=>e.buttonSize)),{t:_}=i,{nextZIndex:o}=s,w=we(!1),C=Ir({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:ph(Iu),cancelButtonLoadingIcon:ph(Iu),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:o()}),M=te(()=>{const xe=C.type;return{[d.bm("icon",xe)]:xe&&Eh[xe]}}),I=Oa(),F=Oa(),B=te(()=>C.icon||Eh[C.type]||""),N=te(()=>!!C.message),D=we(),j=we(),U=we(),ne=we(),K=we(),G=te(()=>C.confirmButtonClass);tn(()=>C.inputValue,async xe=>{await oo(),e.boxType==="prompt"&&xe!==null&&ge()},{immediate:!0}),tn(()=>w.value,xe=>{var Ae,Ce;xe&&(e.boxType!=="prompt"&&(C.autofocus?U.value=(Ce=(Ae=K.value)==null?void 0:Ae.$el)!=null?Ce:D.value:U.value=D.value),C.zIndex=o()),e.boxType==="prompt"&&(xe?oo().then(()=>{var ve;ne.value&&ne.value.$el&&(C.autofocus?U.value=(ve=Re())!=null?ve:D.value:U.value=D.value)}):(C.editorErrorMessage="",C.validateError=!1))});const J=te(()=>e.draggable),oe=te(()=>e.overflow);iz(D,j,J,oe),No(async()=>{await oo(),e.closeOnHashChange&&window.addEventListener("hashchange",se)}),ni(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",se)});function se(){w.value&&(w.value=!1,oo(()=>{C.action&&t("action",C.action)}))}const me=()=>{e.closeOnClickModal&&pe(C.distinguishCancelAndClose?"close":"cancel")},de=YT(me),ce=xe=>{if(C.inputType!=="textarea")return xe.preventDefault(),pe("confirm")},pe=xe=>{var Ae;e.boxType==="prompt"&&xe==="confirm"&&!ge()||(C.action=xe,C.beforeClose?(Ae=C.beforeClose)==null||Ae.call(C,xe,C,se):se())},ge=()=>{if(e.boxType==="prompt"){const xe=C.inputPattern;if(xe&&!xe.test(C.inputValue||""))return C.editorErrorMessage=C.inputErrorMessage||_("el.messagebox.error"),C.validateError=!0,!1;const Ae=C.inputValidator;if(Qn(Ae)){const Ce=Ae(C.inputValue);if(Ce===!1)return C.editorErrorMessage=C.inputErrorMessage||_("el.messagebox.error"),C.validateError=!0,!1;if(Zn(Ce))return C.editorErrorMessage=Ce,C.validateError=!0,!1}}return C.editorErrorMessage="",C.validateError=!1,!0},Re=()=>{const xe=ne.value.$refs;return xe.input||xe.textarea},Je=()=>{pe("close")},Me=()=>{e.closeOnPressEscape&&Je()};return e.lockScroll&&JT(w),{...Ca(C),ns:d,overlayEvent:de,visible:w,hasMessage:N,typeClass:M,contentId:I,inputId:F,btnSize:p,iconComponent:B,confirmButtonClasses:G,rootRef:D,focusStartRef:U,headerRef:j,inputRef:ne,confirmRef:K,doClose:se,handleClose:Je,onCloseRequested:Me,handleWrapperClick:me,handleInputEnter:ce,handleAction:pe,t:_}}});function spe(e,t,i,s,d,p){const _=Go("el-icon"),o=Go("close"),w=Go("el-input"),C=Go("el-button"),M=Go("el-focus-trap"),I=Go("el-overlay");return le(),Rt(Ea,{name:"fade-in-linear",onAfterLeave:F=>e.$emit("vanish"),persisted:""},{default:at(()=>[zo(Qe(I,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:at(()=>[Ve("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:he(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[Qe(M,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:at(()=>[Ve("div",{ref:"rootRef",class:he([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:to(e.customStyle),tabindex:"-1",onClick:po(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(le(),Pe("div",{key:0,ref:"headerRef",class:he([e.ns.e("header"),{"show-close":e.showClose}])},[Ve("div",{class:he(e.ns.e("title"))},[e.iconComponent&&e.center?(le(),Rt(_,{key:0,class:he([e.ns.e("status"),e.typeClass])},{default:at(()=>[(le(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])):St("v-if",!0),Ve("span",null,yn(e.title),1)],2),e.showClose?(le(),Pe("button",{key:0,type:"button",class:he(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:F=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:ti(po(F=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[Qe(_,{class:he(e.ns.e("close"))},{default:at(()=>[Qe(o)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):St("v-if",!0)],2)):St("v-if",!0),Ve("div",{id:e.contentId,class:he(e.ns.e("content"))},[Ve("div",{class:he(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(le(),Rt(_,{key:0,class:he([e.ns.e("status"),e.typeClass])},{default:at(()=>[(le(),Rt(Wo(e.iconComponent)))]),_:1},8,["class"])):St("v-if",!0),e.hasMessage?(le(),Pe("div",{key:1,class:he(e.ns.e("message"))},[_t(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(le(),Rt(Wo(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(le(),Rt(Wo(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:at(()=>[Qo(yn(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):St("v-if",!0)],2),zo(Ve("div",{class:he(e.ns.e("input"))},[Qe(w,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":F=>e.inputValue=F,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:he({invalid:e.validateError}),onKeydown:ti(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Ve("div",{class:he(e.ns.e("errormsg")),style:to({visibility:e.editorErrorMessage?"visible":"hidden"})},yn(e.editorErrorMessage),7)],2),[[Cr,e.showInput]])],10,["id"]),Ve("div",{class:he(e.ns.e("btns"))},[e.showCancelButton?(le(),Rt(C,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:he([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:F=>e.handleAction("cancel"),onKeydown:ti(po(F=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:at(()=>[Qo(yn(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):St("v-if",!0),zo(Qe(C,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:he([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:F=>e.handleAction("confirm"),onKeydown:ti(po(F=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:at(()=>[Qo(yn(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[Cr,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[Cr,e.visible]])]),_:3},8,["onAfterLeave"])}var lpe=xn(ape,[["render",spe],["__file","index.vue"]]);const P_=new Map,cpe=e=>{let t=document.body;return e.appendTo&&(Zn(e.appendTo)&&(t=document.querySelector(e.appendTo)),El(e.appendTo)&&(t=e.appendTo),El(t)||(t=document.body)),t},upe=(e,t,i=null)=>{const s=Qe(lpe,e,Qn(e.message)||Ai(e.message)?{default:Qn(e.message)?e.message:()=>e.message}:null);return s.appContext=i,bh(s,t),cpe(e).appendChild(t.firstElementChild),s.component},dpe=()=>document.createElement("div"),hpe=(e,t)=>{const i=dpe();e.onVanish=()=>{bh(null,i),P_.delete(d)},e.onAction=p=>{const _=P_.get(d);let o;e.showInput?o={value:d.inputValue,action:p}:o=p,e.callback?e.callback(o,s.proxy):p==="cancel"||p==="close"?e.distinguishCancelAndClose&&p!=="cancel"?_.reject("close"):_.reject("cancel"):_.resolve(o)};const s=upe(e,i,t),d=s.proxy;for(const p in e)Tr(e,p)&&!Tr(d.$props,p)&&(d[p]=e[p]);return d.visible=!0,d};function eg(e,t=null){if(!gr)return Promise.reject();let i;return Zn(e)||Ai(e)?e={message:e}:i=e.callback,new Promise((s,d)=>{const p=hpe(e,t??eg._context);P_.set(p,{options:e,callback:i,resolve:s,reject:d})})}const fpe=["alert","confirm","prompt"],ppe={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};fpe.forEach(e=>{eg[e]=mpe(e)});function mpe(e){return(t,i,s,d)=>{let p="";return Vo(i)?(s=i,p=""):Hr(i)?p="":p=i,eg(Object.assign({title:p,message:t,type:"",...ppe[e]},s,{boxType:e}),d)}}eg.close=()=>{P_.forEach((e,t)=>{t.doClose()}),P_.clear()};eg._context=null;const ah=eg;ah.install=e=>{ah._context=e._context,e.config.globalProperties.$msgbox=ah,e.config.globalProperties.$messageBox=ah,e.config.globalProperties.$alert=ah.alert,e.config.globalProperties.$confirm=ah.confirm,e.config.globalProperties.$prompt=ah.prompt};const gpe=ah,gF=["success","info","warning","error"],vpe=vn({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:Xr},id:{type:String,default:""},message:{type:ut([String,Object,Function]),default:""},offset:{type:Number,default:0},onClick:{type:ut(Function),default:()=>{}},onClose:{type:ut(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...gF,""],default:""},zIndex:Number}),_pe={destroy:()=>!0},ype=Ze({name:"ElNotification"}),bpe=Ze({...ype,props:vpe,emits:_pe,setup(e,{expose:t}){const i=e,{ns:s,zIndex:d}=v1("notification"),{nextZIndex:p,currentZIndex:_}=d,{Close:o}=xT,w=we(!1);let C;const M=te(()=>{const K=i.type;return K&&Eh[i.type]?s.m(K):""}),I=te(()=>i.type&&Eh[i.type]||i.icon),F=te(()=>i.position.endsWith("right")?"right":"left"),B=te(()=>i.position.startsWith("top")?"top":"bottom"),N=te(()=>{var K;return{[B.value]:`${i.offset}px`,zIndex:(K=i.zIndex)!=null?K:_.value}});function D(){i.duration>0&&({stop:C}=Hf(()=>{w.value&&U()},i.duration))}function j(){C==null||C()}function U(){w.value=!1}function ne({code:K}){K===Ln.delete||K===Ln.backspace?j():K===Ln.esc?w.value&&U():D()}return No(()=>{D(),p(),w.value=!0}),qr(document,"keydown",ne),t({visible:w,close:U}),(K,G)=>(le(),Rt(Ea,{name:y(s).b("fade"),onBeforeLeave:K.onClose,onAfterLeave:J=>K.$emit("destroy"),persisted:""},{default:at(()=>[zo(Ve("div",{id:K.id,class:he([y(s).b(),K.customClass,y(F)]),style:to(y(N)),role:"alert",onMouseenter:j,onMouseleave:D,onClick:K.onClick},[y(I)?(le(),Rt(y(Gn),{key:0,class:he([y(s).e("icon"),y(M)])},{default:at(()=>[(le(),Rt(Wo(y(I))))]),_:1},8,["class"])):St("v-if",!0),Ve("div",{class:he(y(s).e("group"))},[Ve("h2",{class:he(y(s).e("title")),textContent:yn(K.title)},null,10,["textContent"]),zo(Ve("div",{class:he(y(s).e("content")),style:to(K.title?void 0:{margin:0})},[_t(K.$slots,"default",{},()=>[K.dangerouslyUseHTMLString?(le(),Pe(eo,{key:1},[St(" Caution here, message could've been compromised, never use user's input as message "),Ve("p",{innerHTML:K.message},null,8,["innerHTML"])],2112)):(le(),Pe("p",{key:0},yn(K.message),1))])],6),[[Cr,K.message]]),K.showClose?(le(),Rt(y(Gn),{key:0,class:he(y(s).e("closeBtn")),onClick:po(U,["stop"])},{default:at(()=>[Qe(y(o))]),_:1},8,["class","onClick"])):St("v-if",!0)],2)],46,["id","onClick"]),[[Cr,w.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var xpe=xn(bpe,[["__file","notification.vue"]]);const Wb={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},AS=16;let wpe=1;const $m=function(e={},t){if(!gr)return{close:()=>{}};(Zn(e)||Ai(e))&&(e={message:e});const i=e.position||"top-right";let s=e.offset||0;Wb[i].forEach(({vm:M})=>{var I;s+=(((I=M.el)==null?void 0:I.offsetHeight)||0)+AS}),s+=AS;const d=`notification_${wpe++}`,p=e.onClose,_={...e,offset:s,id:d,onClose:()=>{Spe(d,i,p)}};let o=document.body;El(e.appendTo)?o=e.appendTo:Zn(e.appendTo)&&(o=document.querySelector(e.appendTo)),El(o)||(o=document.body);const w=document.createElement("div"),C=Qe(xpe,_,Qn(_.message)?_.message:()=>_.message);return C.appContext=Hr(t)?$m._context:t,C.props.onDestroy=()=>{bh(null,w)},bh(C,w),Wb[i].push({vm:C}),o.appendChild(w.firstElementChild),{close:()=>{C.component.exposed.visible.value=!1}}};gF.forEach(e=>{$m[e]=(t={},i)=>((Zn(t)||Ai(t))&&(t={message:t}),$m({...t,type:e},i))});function Spe(e,t,i){const s=Wb[t],d=s.findIndex(({vm:C})=>{var M;return((M=C.component)==null?void 0:M.props.id)===e});if(d===-1)return;const{vm:p}=s[d];if(!p)return;i==null||i(p);const _=p.el.offsetHeight,o=t.split("-")[0];s.splice(d,1);const w=s.length;if(!(w<1))for(let C=d;C<w;C++){const{el:M,component:I}=s[C].vm,F=Number.parseInt(M.style[o],10)-_-AS;I.props.offset=F}}function Tpe(){for(const e of Object.values(Wb))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}$m.closeAll=Tpe;$m._context=null;const Cpe=xO($m,"$notify");var Epe=[$fe,Gfe,rpe,gpe,Cpe,kz],Mpe=_W([...Lfe,...Epe]);const vF=aL(tV);vF.use(Mpe);vF.mount("#app")});export default Ipe();
